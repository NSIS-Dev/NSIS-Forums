<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="description" content="Registry update"><title>Registry update - NSIS Forums</title><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script><link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css"><link rel="stylesheet" href="../css/style.css" type="text/css"></head><body><div class="container"><ol class="breadcrumb"><li><a href="../index.html" class="glyphicon glyphicon-home"></a></li><li><a href="f-65.html">NSIS Discussion</a></li><li class="active">Registry update</li></ol><p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=280502">Registry update</a></p><br><div class="post"><p class="post-meta"><span class="post-author text-primary">chamakits</span><br><span class="post-time small text-muted">1st November 2007 16:26 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>Registry update</strong><br>Hey guys. I'm having some big problems with the registry.<br>The program for which i'm doing an installer, had already been installed into a few of our clients computers. That version however is highly outdated, and the previous installer was...well...hard-coded to work. The thing is, right now, the .ocx and the .dll that it used and still uses have change where they are placed. And here comes my problem. Before just registering my .dll and my .ocx, I want to find if the .dll and the .ocx are already registered. If they are, I want to delete those entries, and write my new ones. If they aren't, then just register them. For example, right now, MSWINSCK.OCX had not been properly registered, because it was already registered in the computer where I was testing, but since it changed folder, the program wouldn't run properly.<br><br>Any help would be greatly appreciated. Thanks in advance.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">kichik</span><br><span class="post-time small text-muted">1st November 2007 19:06 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">If the registry settings are wrong anyway, just delete them and let the new registration process properly recreate them.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">chamakits</span><br><span class="post-time small text-muted">1st November 2007 19:23 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Yeah, but the thing is, these are clients computers.<br>I can't go to them and one by one delete all these entries.<br>I want to be able to search through the registry, find the key, delete it, and register the new one.<br><br>I'm working on a script to do with NSIS, so, I may have it solved, but I'm having some trouble with EnumRegValue and EnumRegKey. But i think i'll get this done soon</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">kichik</span><br><span class="post-time small text-muted">1st November 2007 19:28 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Why would you need to search the registry if you a well defined set of registered controls? If you know what you've registered the last time, you can easily find out what to remove.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">chamakits</span><br><span class="post-time small text-muted">1st November 2007 19:38 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Thats just it.<br>The previous version of the program wasn't done by me.<br>Not only that, but since there wasn't much of a formal installer, the program isn't uniform between all our clients, meaning that in different client's computers, the dlls and ocx's may be somewhere different.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">kichik</span><br><span class="post-time small text-muted">1st November 2007 19:44 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">But you can still tell which registry keys it updates. Running <a href="http://www.microsoft.com/technet/sysinternals/utilities/regmon.mspx" target="_blank">RegMon</a> in the background, while executing the old installer, might be a good start.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">chamakits</span><br><span class="post-time small text-muted">1st November 2007 19:56 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">I know which keys I want to update. What I don't know is where they are registered in the registry, and not even exactly sure where they are located in the computer.<br><br>Hm... If I did a script with NSIS that searches in the folders for those .dlls and .ocx, can i use UnRegDLL knowing their path?</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">kichik</span><br><span class="post-time small text-muted">1st November 2007 19:58 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Yes, you can UnregDLL them once you find them. But I'd recommend you find out using RegMon which registry keys they update first. One of those keys may even tell you where the DLL is located.</p></div><hr><div class="footer"><p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p></div></div><script src="../js/highlight.pack.js" type="text/javascript"></script><script type="text/javascript">//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]></script></body></html>