<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="Can you use variables in File statements" />

  <title>Can you use variables in File statements - NSIS Forums</title>
  <script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script>
  <!-- Bootstrap core CSS -->

  <link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css" />
  <link rel="stylesheet" href="../css/style.css" type="text/css" /><!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!--[if lt IE 9]>
                <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
                <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->
</head>

<body>
  <div class="container">
    <!-- Put navigation bar here -->

    <ol class="breadcrumb">
      <li><a href="../index.html" class="glyphicon glyphicon-home"></a></li>

      <li><a href="f-65.html">NSIS Discussion</a></li>

      <li class="active">Can you use variables in File statements</li>
    </ol>

    <p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=52505">Can you use variables in File statements</a></p><br />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">brainz</span><br />
      <span class="post-time small text-muted">14th June 2001 10:42 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">A quick question ....<br />
      <br />
      I'm trying to use variables as a part of the name of files that are to be installed<br />
      <br />
      So let us change example1.nsi as follows:<br />
      <br />
      ; The name of the installer<br />
      Name "Example1"<br />
      <br />
      ; The file to write<br />
      OutFile "example1.exe"<br />
      <br />
      ; The default installation directory<br />
      InstallDir $PROGRAMFILES\Example1<br />
      <br />
      ; The text to prompt the user to enter a directory<br />
      DirText "This will install the very simple example1 on your computer. Choose a directory"<br />
      <br />
      ; The stuff to install<br />
      Section "ThisNameIsIgnoredSoWhyBother?"<br />
      ; Set output path to the installation directory.<br />
      SetOutPath $INSTDIR<br />
      ;Set $1 to be the location of the files to install<br />
      StrCpy $1 c:\WINNT<br />
      <br />
      ; Put file there<br />
      File $1\notepad.exe<br />
      <br />
      SectionEnd ; end the section<br />
      <br />
      ; eof<br />
      <br />
      When I do the compile step, I get the following :<br />
      <br />
      File: "$1\notepad.exe" -&gt; no files found.<br />
      Usage: File (/r filespec [...]|/oname=outfile one_file_only)<br />
      <br />
      Am I missing something, or is my syntax wrong, or are variables not allowed in the File statement ?<br />
      <br />
      Any help gratefully accepted ...<br />
      <br />
      TIA<br />
      <br />
      tim<br /></p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Edgewize</span><br />
      <span class="post-time small text-muted">14th June 2001 11:57 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">The argument to the File command is the local path to the file when you are building the installer, not the path that will be used when the user runs it. You could try using the /ONAME="blah" flag for File (see the HTML documentation for NSIS) but it may not work across directories. What you really want is to use the SetOutPath command:<br />
      <br />
      SetOutPath $1<br />
      File "c:\windows\notepad.exe"</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">brainz</span><br />
      <span class="post-time small text-muted">14th June 2001 14:31 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Not sure that you understand why I want to use a variable. I understand totally that the argument to File is the local path when the installer is collecting the files to build the install ...<br />
      <br />
      Suppose I have a long list of files that get installed (&gt;10), and for each new build in the development environment, we put them in a new directory, identified by a new build number, so current release compiled code ends up in<br />
      <br />
      c:\files\devt\app\v1.2\release<br />
      <br />
      and then for my next release it ends up in<br />
      <br />
      c:\files\devt\app\v1.3\release<br />
      <br />
      Suppose I keep the nsi script in c:\files\devt\app, then I will have to modify &gt;10 lines which say<br />
      <br />
      v1.2\release\filename1<br />
      v1.2\release\filename2<br />
      v1.2\release\filename3<br />
      v1.2\release\filename4 ...<br />
      <br />
      Whereas if I could use a variable, in the code I could use<br />
      <br />
      StrCpy $1 v1.3\release<br />
      <br />
      and<br />
      <br />
      File $1\filename1<br />
      File $1\filename2<br />
      File $1\filename3<br />
      File $1\filename4 ...<br />
      <br />
      I am trying to reduce the chance of a developer getting a release wrong by ensuring that the script has to be changed in the minimum number of places. I guess a better solution is to put the .nsi file in<br />
      <br />
      c:\files\devt\app\v1.2\release<br />
      <br />
      and then use<br />
      <br />
      File filename1<br />
      File filename2<br />
      File filename3<br />
      File filename4 ...<br />
      <br />
      which is what I will probably do ... but from a code control perspective I'd like to be able to do the above ...<br />
      <br />
      (Note I'm clear that none of this affects where the file ultimately gets installed by the installer that is built !!)<br />
      <br />
      Also from the documentation, it suggests that you might be able to do this, under Variables it says<br />
      <br />
      "The following are variables that are usable in Instructions"<br />
      <br />
      and under "Instructions - General purpose, basic instructions" we find File.<br />
      <br />
      To me this suggest that you might be able to do it.<br />
      <br />
      Perhaps this is a bug, perhaps not ... depends on your view...<br />
      <br />
      Don't take any of this the wrong way Edge, I think NSIS is a great piece of software, and the comments I make are just things I notice that I think are worth comment ...<br />
      <br />
      Keep up the great work ...<br />
      <br />
      thanks<br />
      <br />
      tim<br /></p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Edgewize</span><br />
      <span class="post-time small text-muted">14th June 2001 18:07 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Doh, I understand. The *local* directory name is a variable. I get it now :D<br />
      <br />
      Try the !cd change-local-directory-during-the-compile command. I don't think that variables are expanded while compiling, only while the installer is running, but you could use<br />
      <br />
      !cd "c:\files\devt\app\v1.2\release"<br />
      <br />
      before the File commands, and it should work just fine.<br />
      <br /></p>
    </div>
    <hr />

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]>
  </script>
</body>
</html>
