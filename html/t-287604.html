<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="description" content="RegDLL again"><title>RegDLL again - NSIS Forums</title><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script><link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css"><link rel="stylesheet" href="../css/style.css" type="text/css"></head><body><div class="container"><ol class="breadcrumb"><li><a href="../index.html" class="glyphicon glyphicon-home"></a></li><li><a href="f-65.html">NSIS Discussion</a></li><li class="active">RegDLL again</li></ol><p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=287604">RegDLL again</a></p><br><div class="post"><p class="post-meta"><span class="post-author text-primary">EnCey</span><br><span class="post-time small text-muted">26th February 2008 08:03 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>RegDLL again</strong><br>Hi again :)<br><br>I've searched the forum and found the very useful RegDLL command to call the DllRegisterServer function.<br><br>I'm trying to convert my msi Installter to NSIS and besides the DllRegisterServer function it also registers a type library and COM Class Information.<br>The Actions are called "RegisterTypeLibrary" and "RegisterClassInfo". Now I'm wondering if there are more built-in functions for those msi-actions.<br><br>I'm not sure if the InstallLib command is what I'm looking for to get the same result as my msi installer with the RegisterTypeLibrary action.<br><br>Does anyone know what functions i should use?</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Red Wine</span><br><span class="post-time small text-muted">26th February 2008 08:17 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">See the manual,<br><br>Appendix B: DLL/TLB Library Setup</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">EnCey</span><br><span class="post-time small text-muted">26th February 2008 08:49 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">So the installation of a library in NSIS is the same as a registration of a library in msi?<br>I don't know the effect of a registration/installation of a dll, I just have to make the NSIS installer do the same as the msi, and that's why I have to ask such stupid questions ^^<br>And what about the "RegisterClassInfo" action?<br><br>Sorry, but as to that I'm a real beginner...</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Red Wine</span><br><span class="post-time small text-muted">26th February 2008 09:51 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">I guess the documentation is pretty clear on how one should use the header ;)</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">EnCey</span><br><span class="post-time small text-muted">26th February 2008 10:03 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">I've never said the opposite :)<br>I just wasn't sure if its the InstallLib function I was looking for, because I wanted the dll to be registered and not installed. (Because it is registerng what the msi installer does, and not installing)<br><br>I think the REGDLL libtype is what I'm looking for.<br><br>Unfortunately I get an exception that terminates the installer if I insert this in my script:<br><br>!insertmacro InstallLib REGDLL NOTSHARED NOREBOOT_NOTPROTECTED ${WINCLIENT_FILES}\fsctoolmgr.dll $INSTDIR\fsctoolmgr.dll $INSTDIR<br><br>RegDLL $INSTDIR\fsctoolmgr.dll</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br><span class="post-time small text-muted">26th February 2008 13:18 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">What happens if you try to manually registry the dll with regsvr32?<br><br>Stu</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">EnCey</span><br><span class="post-time small text-muted">26th February 2008 13:35 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">It works with regsvr32.<br>It is definitely not a corrupted DLL, because the msi Installer works too.<br>I've used dependency walker, and the DLL uses nothing special, just windows dlls.<br><br>Is it possible that there are some wrong registry entries?<br>I have installed and uninstalled the App with the msi installer, so perhaps it has left some reg entries ?<br><br>Well and the msi installer registers the dll 3 times: in the Class, SelfReg and TypeLib tables. I have to create an NSIS installer that does exactly the same, so I use Installib and RegDLL.<br>At the moment I've no idea what command I shall use for the 3rd table (Class), and maybe thats the reason. Some registry keys that deny the NSIS registration.<br><br>msdn says the Class table is for registering dlls with COM-server related information, so if somebody has an idea how I can do the same in NSIS, please tell me ;)<br>I've searched for hours and found nothing :/<br><br>â‚¬dit: Oh that could be helpful:<br>the (NSIS) installer creates registry entries (in CLSID and TypeLib), the exception occurs at the end of the installation progress - or it doesn't affect it. I can close the installer with the Finish button, it doesn't hang or so. The app works fine, but I can't yet test if the dll registration part went well, although i think so because there are registry entries.<br><br>Regards, EnCey</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">EnCey</span><br><span class="post-time small text-muted">27th February 2008 07:42 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">I found out that I can use<br>!insertmacro InstallLib TLB ...<br>!insertmacro InstallLib DLL ...<br><br>without errors. But if i try to use REGDLL or REGDLLTLB the "Select Debugger" window appears after the installation (when the finish page is visible).<br>Also I can't use the REGDLL command with this dll, but with another (that doesn't contain a type library).<br>Does anyone know what I'm doing wrong?</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">AaronLS</span><br><span class="post-time small text-muted">20th March 2008 16:47 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">EnCey, did you find a solution for this? What did you ultimately end up doing?<br><br>I'm trying to do the same type of MSI to NSIS conversion and have some COM dll that I want to make sure are registered in the same way they were before.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">EnCey</span><br><span class="post-time small text-muted">20th March 2008 17:36 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">I'm using regsvr32 in my installer.<br>The result is the same as with the msi, although the msi uses SelfReg, TypeLib and a third talbe (I've forgotten its name).</p></div><hr><div class="footer"><p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p></div></div><script src="../js/highlight.pack.js" type="text/javascript"></script><script type="text/javascript">//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]></script></body></html>