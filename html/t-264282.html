<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="[Help]how to detect a program is running?" />

  <title>[Help]how to detect a program is running? - NSIS Forums</title><!-- Bootstrap core CSS -->
  <link rel="stylesheet" type="text/css" href="//netdna.bootstrapcdn.com/bootswatch/3.0.1/readable/bootstrap.min.css" />
  <link rel="stylesheet" href="../css/style.css" type="text/css" /><!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!--[if lt IE 9]>
                <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
                <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->
</head>

<body>
  <div class="container">
    <!-- Put navigation bar here -->

    <ol class="breadcrumb">
      <li><a href="../index.html" class="glyphicon glyphicon-home"></a></li>

      <li><a href="f-65.html">NSIS Discussion</a></li>

      <li class="active">[Help]how to detect a program is running?</li>
    </ol>

    <p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=264282">[Help]how to detect a program is running?</a></p><br />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">JamesKiller</span><br />
      <span class="post-time small text-muted">24th January 2007 18:20 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>[Help]how to detect a program is running?</strong><br />
      Hi All,<br />
      <br />
      I have installed my application (named myApp.exe, it is windows Form application),however, when I try to unistall this application. How can I detect if this program is running, normally we will to do this:<br />
      when uninstalling, if detecting this application is running, we should force to close it.(At least close the window, don't want users to use anymore). Then we delete this file right away, don't wait till reboot the computer.<br />
      <br />
      So how to detect program running in NSIS,if found,how to force to close it down so that we can delete the files right away!<br />
      <br />
      Please help me out so that i can meet the project deadline.<br />
      Thank you very much.<br />
      <br />
      James</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Red Wine</span><br />
      <span class="post-time small text-muted">24th January 2007 18:31 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">A similar recent thread,<br />
      <a href="http://forums.winamp.com/showthread.php?s=&amp;threadid=262969" target="_blank">http://forums.winamp.com/showthread....hreadid=262969</a></p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">JamesKiller</span><br />
      <span class="post-time small text-muted">24th January 2007 18:53 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">But it seems that they are using one plugin dll file, when can i download it to test?</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Red Wine</span><br />
      <span class="post-time small text-muted">24th January 2007 19:12 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Like every nsis plugin at wiki,<br />
      <a href="http://nsis.sourceforge.net/Developer_Center" target="_blank">http://nsis.sourceforge.net/Developer_Center</a></p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">JamesKiller</span><br />
      <span class="post-time small text-muted">24th January 2007 20:08 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Thank you , Red Wine.<br />
      <br />
      One more thing, I can detect the program running, how can I kill it (just force to close the window). Then i can delete the exe and dll files....</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Red Wine</span><br />
      <span class="post-time small text-muted">24th January 2007 20:17 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">I think the idea of the author on the above thread (pop up a custom page or a message box and ask users to terminate the application before uninstall) is the right way to go.<br />
      If you anyway wish to kill it, you may do it either by FindWindow and SendMessage or with NsProcess plugin,<br />
      <a href="http://nsis.sourceforge.net/NsProcess_plugin" target="_blank">http://nsis.sourceforge.net/NsProcess_plugin</a></p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Brummelchen</span><br />
      <span class="post-time small text-muted">24th January 2007 21:17 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><a href="http://forums.winamp.com/showthread.php?s=&amp;threadid=259546" target="_blank">http://forums.winamp.com/showthread....hreadid=259546</a><br />
      humm - forget it... (Update)<br />
      <br />
      "Processes::FindProcess" / "Processes::KillProcess" do it same way, or "fct"</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">JamesKiller</span><br />
      <span class="post-time small text-muted">24th January 2007 22:04 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Yeah. Thank you guys. I have don't this part.....Cheers.<br />
      <br />
      one more stuip question:<br />
      how can i make one function then both install and uninstall can call it.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Red Wine</span><br />
      <span class="post-time small text-muted">24th January 2007 22:11 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">There you are :)<br />
      <a href="http://nsis.sourceforge.net/Macro_vs_Function" target="_blank">http://nsis.sourceforge.net/Macro_vs_Function</a></p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">JamesKiller</span><br />
      <span class="post-time small text-muted">24th January 2007 22:44 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Red Wine,<br />
      <br />
      you are the rock. Thank you very very much.......<br />
      <br />
      James</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Red Wine</span><br />
      <span class="post-time small text-muted">24th January 2007 23:04 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Indeed :) I've been in Woodstock...</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Takhir</span><br />
      <span class="post-time small text-muted">25th January 2007 08:19 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">NsProcess based on the <a href="http://nsis.sourceforge.net/KillProcDLL_Manual" target="_blank">KillProcDLL</a>, so MSDN warning touchs both plug-ins:<br />
      <i>The TerminateProcess function is used to unconditionally cause a process to exit. Use it only in extreme circumstances. The state of global data maintained by dynamic-link libraries (DLLs) may be compromised if TerminateProcess is used rather than ExitProcess.</i><br />
      If your application has window <a href="http://nsis.sourceforge.net/FCT_plug-in" target="_blank">Find-Close-Terminate</a> would be better.</p>
    </div>
    <hr />

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]>
  </script>
</body>
</html>
