<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="Vista security issue/bug? -- RegDLL" />

  <title>Vista security issue/bug? -- RegDLL - NSIS Forums</title><!-- Bootstrap core CSS -->
  <link rel="stylesheet" type="text/css" href="//netdna.bootstrapcdn.com/bootswatch/3.0.1/readable/bootstrap.min.css" />
  <link rel="stylesheet" href="../css/style.css" type="text/css" /><!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!--[if lt IE 9]>
                <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
                <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->
</head>

<body>
  <div class="container">
    <!-- Put navigation bar here -->

    <ol class="breadcrumb">
      <li><a href="../index.html" class="glyphicon glyphicon-home"></a></li>

      <li><a href="f-65.html">NSIS Discussion</a></li>

      <li class="active">Vista security issue/bug? -- RegDLL</li>
    </ol>

    <p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=299802">Vista security issue/bug? -- RegDLL</a></p><br />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">omeara55</span><br />
      <span class="post-time small text-muted">12th November 2008 01:04 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>Vista security issue/bug? -- RegDLL</strong><br />
      Hey everyone... First off, big thanks to all the NSIS contributors -- it's truly great work and we all thank you for your time and effort!<br />
      <br />
      Hopefully, some NSIS gurus here will be able to figure this one out...<br />
      <br />
      My installer is having issues when non-admin users try to install it. Specifically, RegDLL is failing, presumably because regsvr child process isn't inheriting the admin rights of the installer (host) process. The installer uses 'RequestExecutionLevel admin' and the installer properly prompts to authentication when it starts, so the installer process definitely has admin permissions (also verified by the fact it installs files into Program Files).<br />
      <br />
      Is anyone aware of this issue or perhaps what may be going on? Sorry if I missed something obvious or am doing something dumb.<br />
      <br />
      Thanks in advance,<br />
      Andy</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Anders</span><br />
      <span class="post-time small text-muted">12th November 2008 08:08 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">a child process will always inherit its parent rights unless you create a custom and/or restricted token. You could try Process Monitor from sysinternals and see it gives you any clues as to why its failing</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">{_trueparuex^}</span><br />
      <span class="post-time small text-muted">12th November 2008 10:37 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">:confused: RegDLL doesn't use regsvr to register. You could try to test why it's failing by calling regsvr by yourself.<br />
      <br />
      E.g. ExecWait 'regsvr32.exe "$INSTDIR\foo.dll"'<br />
      <br />
      This way you get the error message if it fails to register.<br />
      <br />
      PaR</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">omeara55</span><br />
      <span class="post-time small text-muted">13th November 2008 02:14 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Hey guys, thanks for chiming in with your comments. Trueparuex, your suggestion did the trick! Using ExecWait results in proper registration, indicting there may in fact be a bug inside RegDLL. To be clear, the repro case is calling RegDLL under Vista x64, using an installer marked with 'RequestExecutionLevel admin' , logged in as a standard user (ie a non-admin).<br />
      <br />
      I'm willing to write up and file a bug on this at sourceforge if people here agree that this looks like a legit issue. Thoughts? Thanks again for the workaround, trueparuex!<br />
      <br />
      Andy</p>
    </div>
    <hr />

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]>
  </script>
</body>
</html>
