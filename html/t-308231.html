<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="description" content="Is RequestExecutionLevel a COMPILE-TIME directive?"><title>Is RequestExecutionLevel a COMPILE-TIME directive? - NSIS Forums</title><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script><link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css"><link rel="stylesheet" href="../css/style.css" type="text/css"></head><body><div class="container"><ol class="breadcrumb"><li><a href="../index.html" class="glyphicon glyphicon-home"></a></li><li><a href="f-65.html">NSIS Discussion</a></li><li class="active">Is RequestExecutionLevel a COMPILE-TIME directive?</li></ol><p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=308231">Is RequestExecutionLevel a COMPILE-TIME directive?</a></p><br><div class="post"><p class="post-meta"><span class="post-author text-primary">nsnb</span><br><span class="post-time small text-muted">12th July 2009 14:54 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>Is RequestExecutionLevel a COMPILE-TIME directive?</strong><br>I tried using RequestExecutionLevel in .onInit but the compiler gave me this error:<br></p><blockquote>Error: command RequestExecutionLevel not valid in Function</blockquote>Does this mean that RequestExecutionLevel is a COMPILE-TIME directive?<br><br>If so, what can I do to implement a pretty unique installer that "Requests ExecutionLevel" based on whether the logged in user has Administrator privileges?<br><br>I would like to implement this somewhat "smart" installer that changes its behavior based on the account type (i.e. admin vs. limited). Is this possible without resorting to write the installer entirely in win32 C or C++?</div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">redxii</span><br><span class="post-time small text-muted">13th July 2009 01:05 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">It creates an embedded XML manifest for Vista and later in the .exe, specifying what privileges are required.<br><br>You can look into multiuser.nsh; look in the C:\Program Files\NSIS\Docs\MultiUser folder for usage instructions.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">nsnb</span><br><span class="post-time small text-muted">13th July 2009 15:36 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">redxii, thanks for your answer. I know how to use RequestExecutionLevel and I have been using it successfully in quite a few installers. I just want to confirm my understanding that it is a compile-time directive and that there is no way to tell Vista something like this:<br></p><blockquote>"for the full set of features my installer requires Admin privileges but if you happen to run in a limited account you can still run this installer - for a reduced set of features."</blockquote><blockquote><i>Originally posted by redxii</i><br><b>It creates an embedded XML manifest for Vista and later in the .exe</b></blockquote>So does that mean that RequestExecutionLevel is a <b>COMPILE-TIME</b> directive?<br><br><br>Thanks!</div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Anders</span><br><span class="post-time small text-muted">13th July 2009 16:18 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">yes, it is compile time</p></div><hr><div class="footer"><p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p></div></div><script src="../js/highlight.pack.js" type="text/javascript"></script><script type="text/javascript">//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]></script></body></html>