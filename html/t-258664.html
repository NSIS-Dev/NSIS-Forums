<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="How to call uninstall of redistribute of VC++ on NSIS" />

  <title>How to call uninstall of redistribute of VC++ on NSIS - NSIS Forums</title>
  <script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script>
  <!-- Bootstrap core CSS -->

  <link rel="stylesheet" type="text/css" href="//netdna.bootstrapcdn.com/bootswatch/3.0.1/readable/bootstrap.min.css" />
  <link rel="stylesheet" href="../css/style.css" type="text/css" /><!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!--[if lt IE 9]>
                <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
                <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->
</head>

<body>
  <div class="container">
    <!-- Put navigation bar here -->

    <ol class="breadcrumb">
      <li><a href="../index.html" class="glyphicon glyphicon-home"></a></li>

      <li><a href="f-65.html">NSIS Discussion</a></li>

      <li class="active">How to call uninstall of redistribute of VC++ on NSIS</li>
    </ol>

    <p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=258664">How to call uninstall of redistribute of VC++ on NSIS</a></p><br />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">sunlight112</span><br />
      <span class="post-time small text-muted">31st October 2006 09:39 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>How to call uninstall of redistribute of VC++ on NSIS</strong><br />
      Please help me!<br />
      I have to install vcredist_x86.exe instead of .net framework.<br />
      When I create uninstall, I can not know exactly HKLM of vcredist_x86.exe .<br />
      I also use regshot to find them but the end I can not<br />
      This is one of uninstall content of regshot file which I get it.<br /></p>
      <pre>
<code><br /><b><br />HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Uninstall\{A49F249F-0C91-497F-86DF-B2585E8E76B7}\AuthorizedCDFPrefix: ""<br />HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Uninstall\{A49F249F-0C91-497F-86DF-B2585E8E76B7}\Comments: ""<br />HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Uninstall\{A49F249F-0C91-497F-86DF-B2585E8E76B7}\Contact: ""<br />HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Uninstall\{A49F249F-0C91-497F-86DF-B2585E8E76B7}\DisplayVersion: "8.0.50727.42"<br />HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Uninstall\{A49F249F-0C91-497F-86DF-B2585E8E76B7}\HelpLink: ""<br />HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Uninstall\{A49F249F-0C91-497F-86DF-B2585E8E76B7}\HelpTelephone: ""<br />HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Uninstall\{A49F249F-0C91-497F-86DF-B2585E8E76B7}\InstallDate: "20061031"<br />HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Uninstall\{A49F249F-0C91-497F-86DF-B2585E8E76B7}\InstallLocation: ""<br />HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Uninstall\{A49F249F-0C91-497F-86DF-B2585E8E76B7}\InstallSource: "C:\DOCUME~1\DUONGP~1\LOCALS~1\Temp\IXP000.TMP\"<br />HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Uninstall\{A49F249F-0C91-497F-86DF-B2585E8E76B7}\ModifyPath: "MsiExec.exe /X{A49F249F-0C91-497F-86DF-B2585E8E76B7}"<br />HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Uninstall\{A49F249F-0C91-497F-86DF-B2585E8E76B7}\NoModify: 0x00000001<br />HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Uninstall\{A49F249F-0C91-497F-86DF-B2585E8E76B7}\NoRepair: 0x00000001<br />HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Uninstall\{A49F249F-0C91-497F-86DF-B2585E8E76B7}\Publisher: "Microsoft Corporation"<br />HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Uninstall\{A49F249F-0C91-497F-86DF-B2585E8E76B7}\Readme: ""<br />HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Uninstall\{A49F249F-0C91-497F-86DF-B2585E8E76B7}\Size: ""<br />HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Uninstall\{A49F249F-0C91-497F-86DF-B2585E8E76B7}\EstimatedSize: 0x00001448<br />HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Uninstall\{A49F249F-0C91-497F-86DF-B2585E8E76B7}\UninstallString: "MsiExec.exe /X{A49F249F-0C91-497F-86DF-B2585E8E76B7}"<br />HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Uninstall\{A49F249F-0C91-497F-86DF-B2585E8E76B7}\URLInfoAbout</b></code>: ""<br />HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Uninstall\{A49F249F-0C91-497F-86DF-B2585E8E76B7}\URLUpdateInfo: ""<br />HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Uninstall\{A49F249F-0C91-497F-86DF-B2585E8E76B7}\VersionMajor: 0x00000008<br />HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Uninstall\{A49F249F-0C91-497F-86DF-B2585E8E76B7}\VersionMinor: 0x00000000<br />HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Uninstall\{A49F249F-0C91-497F-86DF-B2585E8E76B7}\WindowsInstaller: 0x00000001<br />HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Uninstall\{A49F249F-0C91-497F-86DF-B2585E8E76B7}\Version: 0x0800C627<br />HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Uninstall\{A49F249F-0C91-497F-86DF-B2585E8E76B7}\Language: 0x00000000<br />HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Uninstall\{A49F249F-0C91-497F-86DF-B2585E8E76B7}\DisplayName: "Microsoft Visual C++ 2005 Redistributable"<br /><br />
</pre><br />
      In my code I also use:<br />
      <b><br />
      Function un.onInit<br />
      !insertmacro MUI_UNGETLANGUAGE<br />
      ReadRegStr $R0 HKLM \<br />
      "SOFTWARE\Microsoft\Windows\CurrentVersion\Uninstall\<font color="red">unvcredist_x86</font>" \<br />
      "UninstallString"<br />
      StrCmp $R0 "" end done<br />
      done:<br />
      ExecWait '$R0_?=$INSDIR'<br />
      IfErrors end<br />
      end:<br />
      FunctionEnd<br />
      <br /></b><br />
      The name of uninstall on VCREDIST_X86, I do not know, so i can not call them, so I only use this <font color="red">unvcredist_x86</font>. I hope it is true.Uninstall vcredist_x86 is not uninstalled when I uninstall my program.<br />
      Please help me!!<br />
      Thank a million!!!!
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
      <span class="post-time small text-muted">31st October 2006 10:13 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">You shouldn't start deleting files and registry keys from your installer. If you've used their installer to install, you should use their uninstaller to uninstall.<br />
      <br />
      The key name under Uninstall is {A49F249F-0C91-497F-86DF-B2585E8E76B7}, as you can easily see from the RegShot log you've posted. You should execute the string there as is. It's not a NSIS uninstaller, so _?= won't work.<br />
      <br />
      Note that these files are used by many applications and not just by yours. You should be absolutely sure that uninstalling this will not cause other programs to suddenly stop functioning. I don't think the uninstaller keeps a reference count and only uninstalls the files once all programs using it are uninstalled. Even if it did, I'm sure there are other programs that skip executing vcredist_x86.exe, if they find the files they need.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">sunlight112</span><br />
      <span class="post-time small text-muted">31st October 2006 11:00 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Thank Kichik for your quickly reply,<br />
      My application is coded on VC++, so I need vcredist_x86 to redistribute these DLL which VC++ to support.Consequently, If I uninstall vcredist_x86, I am sure the other program is not influently.<br />
      I used to think the same way which you give, and I do it but I can not run and display some error and run my uninstall and vcredist_x86 is not uninstalled<br /></p>
      <pre>
<code><b><br />Function un.onInit<br />!insertmacro MUI_UNGETLANGUAGE<br />  ReadRegStr $R0 HKLM \<br />  "SOFTWARE\Microsoft\Windows\CurrentVersion\Uninstall\{A49F249F-0C91-497F-86DF-B2585E8E76B7}" \<br />  "UninstallString"<br />  StrCmp $R0 "" end  done<br />  done:<br /><font color="red">  ExecWait '$R0=$INSDIR'</font><br />  IfErrors end<br />  end:<br />FunctionEnd<br /></b></code>
</pre><br />
      I think I have problems with ExecWait. Actually, I do not know how to call their uninstaller.<br />
      If someone know, please help me!!<br />
      Thank alot,<br />
      I also enclose file error when I use above command
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
      <span class="post-time small text-muted">31st October 2006 11:31 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">How can you be so sure it won't influence other programs? Other programs are built with VC++ as well.<br />
      <br />
      As I said in the last reply, remove _?=. It's not a NSIS uninstaller.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">sunlight112</span><br />
      <span class="post-time small text-muted">1st November 2006 01:23 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>Please help me!!</strong><br />
      Thank kichik a lot,<br />
      <br /></p>

      <blockquote>
        <b><font color="green">Kichik posted</font><br />
        How can you be so sure it won't influence other programs? Other programs are built with VC++ as well.<br />
        <br />
        As I said in the last reply, remove _?=. It's not a NSIS uninstaller.<br /></b>
      </blockquote>I am sure about it because I use to install vcredist_x86.exe in my computer which It does not install .net framework, my application work well. When I uninstall vcredist_x86 on Control Panel --&gt;Add/Remove Program.., the other application still run well. At that time, my application is uninstalled.<br />
      I understand your idea but I do not know how to call uninstall vcredist_x86 :(<br />
      Command <font color="blue"><b>remove _?=</b></font> I see on Wiki link<a href="http://nsis.sourceforge.net/Auto-uninstall_old_before_installing_new" target="_blank">this link</a> which it shows me how to uninstall program on computer.<br />
      I only want to know how to uninstall VC redistribute if we do not know exactly place which uninstall file is put.<br />
      Normally,If I want to uninstall programs, I can find folder which store file uninstall or on Control Panel.<br />
      Although on Control Panel, redistribute is displayed but I do not know place which file uninstall is set on which folder in my computer.<br />
      Thank you for your help,
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
      <span class="post-time small text-muted">1st November 2006 09:27 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">The link you've posted is only for NSIS uninstallers. You are not dealing with a NSIS uninstaller here. Remove _?= and simply ExecEait $R0.<br />
      <br />
      As for the redistributable not being used by other programs, that might be the case on your computer. But what happens if you install two programs that require the redistributables? I'm not talking about your specific case. You have to think about the general case.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">sunlight112</span><br />
      <span class="post-time small text-muted">1st November 2006 11:32 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Thank Kichik for your reply,<br />
      I think your idea may be right on the other case. Because I think when I set up program for user, I must uninstall all applications which I install on that computer. So, I am trying to find a method which I can uninstall vcredist_x86. I think when I call uninstall vcredist_x86,if it supports for the other program on that computer, It will display information and abort this process. At that time, I do not need to uninstall it and finish my uninstall.<br />
      <b>My problem here is I do not know how to call uninstall of vcredist_x86.Actually, I do not know vcredist_x86 's uninstall is stayed where???So I could not call it.</b><br />
      I hope Your idea can help me solve this problem!!!!<br />
      Thank a lot,</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
      <span class="post-time small text-muted">1st November 2006 11:34 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Just use</p>
      <pre>
<code>ExecWait $R0</code>
</pre>No _?=, no nothing. Just that.
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Joost Verburg</span><br />
      <span class="post-time small text-muted">1st November 2006 11:35 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">If you don't want to use the Microsoft installer you can put the run-times in the application folder along with Microsoft.VC80.CRT.manifest with the following contents:<br /></p>
      <pre>
<code>&lt;?xml version="1.0" encoding="UTF-8" standalone="yes"?&gt;<br />&lt;!-- Copyright Â© 1981-2001 Microsoft Corporation --&gt;<br />&lt;assembly xmlns="urn:schemas-microsoft-com:asm.v1" manifestVersion="1.0"&gt;<br />    &lt;noInheritable/&gt;<br />    &lt;assemblyIdentity <br />        type="win32" <br />        name="Microsoft.VC80.CRT" <br />        version="8.0.50608.0" <br />        processorArchitecture="x86" <br />        publicKeyToken="1fc8b3b9a1e18e3b"<br />    /&gt;<br />    &lt;file name="msvcr80.dll"/&gt;<br />    &lt;file name="msvcp80.dll"/&gt;<br />    &lt;file name="msvcm80.dll"/&gt;<br />&lt;/assembly&gt;</code>
</pre>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">sunlight112</span><br />
      <span class="post-time small text-muted">1st November 2006 11:50 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Thank Kichik and Joost Verburg a lot,<br />
      I have one more question.<br />
      May I ask this question wrong forum but it has just appeared on my mind.<br />
      If I used vcredist_x86 (my framework at that time version 2.0) on my installer, in the future, dotnetfx appear version 3.0. The user install vcredist_x86 with new version (overwrite the old version), what happen with my application?<br />
      May my application run with it???<br />
      Sorry, this is a thought which I have just had.<br />
      If you can answer me, I thank your idea too much.<br />
      Once again,<br />
      Thank alot for your hellp,</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Joost Verburg</span><br />
      <span class="post-time small text-muted">1st November 2006 16:19 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">The CRT is unrelated to the .NET framework. You also won't have any version conflicts, the manifests handle all these things.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">sunlight112</span><br />
      <span class="post-time small text-muted">2nd November 2006 01:40 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Thank Joost Verburg for your reply,</p>
    </div>
    <hr />

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]>
  </script>
</body>
</html>
