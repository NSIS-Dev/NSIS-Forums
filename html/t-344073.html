<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="Stop the background installation after uninstalling option selected using nsDialog" />

  <title>Stop the background installation after uninstalling option selected using nsDialog - NSIS Forums</title>
  <script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script>
  <!-- Bootstrap core CSS -->

  <link rel="stylesheet" type="text/css" href="//netdna.bootstrapcdn.com/bootswatch/3.0.1/readable/bootstrap.min.css" />
  <link rel="stylesheet" href="../css/style.css" type="text/css" /><!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!--[if lt IE 9]>
                <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
                <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->
</head>

<body>
  <div class="container">
    <!-- Put navigation bar here -->

    <ol class="breadcrumb">
      <li><a href="../index.html" class="glyphicon glyphicon-home"></a></li>

      <li><a href="f-65.html">NSIS Discussion</a></li>

      <li class="active">Stop the background installation after uninstalling option selected using nsDialog</li>
    </ol>

    <p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=344073">Stop the background installation after uninstalling option selected using nsDialog</a></p><br />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">priyankaB</span><br />
      <span class="post-time small text-muted">13th April 2012 09:50 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>Stop the background installation after uninstalling option selected using nsDialog</strong><br />
      Hi All,<br />
      <br />
      I am into the initial phase of learning the NSIS scripting.<br />
      I would like to know how can I stop the installation, when the user selects uninstall option (on the custom page with options reinstall or uninstall). I do not want the user to install the application after uninstalling. It should simply quit. Code snippet of my Custom Leave function is as below:-<br />
      <br />
      <b>---clip---<br />
      <br />
      Function LeaveCustomCheck<br />
      <br />
      Pop $hwnd<br />
      ${If} $hwnd == $Group1Radio1<br />
      ;Perform Installation<br />
      ${ElseIf} $hwnd == $Group1Radio2<br />
      SetAutoClose true<br />
      BringToFront<br />
      ReadRegStr $R1 HKLM "${PRODUCT_UNINST_KEY}" "UninstallString"<br />
      HideWindow<br />
      ClearErrors<br />
      ExecWait '$R1 _?=$INSTDIR'<br />
      IfErrors no_remove_uninstaller<br />
      IfFileExists "$INSTDIR\uninstall.exe" 0 no_remove_uninstaller<br />
      Delete "$R1"<br />
      RMDir $INSTDIR<br />
      Quit<br />
      ;Call RelGotoPage<br />
      no_remove_uninstaller:<br />
      ${Else}<br />
      MessageBox MB_ICONSTOP "Please select either of the options or press Cancel to exit installer." IDOK<br />
      Abort<br />
      ${EndIf}<br />
      <br />
      FunctionEnd<br />
      <br />
      ---clap---<br /></b><br />
      Once the user selects "Uninstall" radiobutton and presses "Next" button, the uninstallation starts and hides the page behind it. After the uninstallation ends, the page MUI_PAGE_DIRECTORY pops up, to select directory for further installation. I want this script to end once Uninstallation completes.<br />
      <br />
      Would appreciate, if anyone of you can help me with a solution for the same.<br />
      <br />
      Thanks in advance.<br />
      <br />
      -Priyanka</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">MSG</span><br />
      <span class="post-time small text-muted">13th April 2012 10:29 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">You should never install or uninstall anything in a page's leave function - that way you're making changes to the users system before the actual instfiles page comes up!<br />
      <br />
      What you should do is set a variable to install, uninstall or reinstall/modify. Then do:<br />
      section YourSection<br />
      ${If} $Variable == install<br />
      ;install<br />
      ${Else}<br />
      ;uninstall<br />
      ${EndIf}<br />
      sectionend<br />
      <br />
      You could also modify the finish page in its show function, depending on the value of the variable.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">priyankaB</span><br />
      <span class="post-time small text-muted">13th April 2012 16:13 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">I am still confused, if the above specified solution will work. Here is what I am trying to achieve in my script:-<br />
      1. If the application is not installed, then simply install the same without showing Custom Page.<br />
      2. If the application is already installed, then show the custom page (with options reinstall/uninstall) and perform action as selected by the user.<br />
      <br />
      Also, both the install and uninstall sections are different. So, would it be possible to do installation and uninstallation within one section?<br />
      <br />
      Here is my script:-<br />
      ; Script generated by the HM NIS Edit Script Wizard.<br />
      <br /></p>

      <blockquote>
        ; HM NIS Edit Wizard helper defines<br />
        !define PRODUCT_NAME "MITRAC CC TDS-PROG Tool"<br />
        !define PRODUCT_VERSION "2.6.0.6"<br />
        !define PRODUCT_DIR_REGKEY "Software\Microsoft\Windows\CurrentVersion\App Paths\TDSProg.exe "<br />
        !define PRODUCT_UNINST_KEY "Software\Microsoft\Windows\CurrentVersion\Uninstall\${PRODUCT_NAME}"<br />
        !define PRODUCT_UNINST_ROOT_KEY "HKLM"<br />
        !define TEXT_IO_TITLE "MITRAC CC TDS-PROG Tool"<br />
        !define TEXT_IO_SUBTITLE "This Application is already installed. What would you like to do?"<br />
        <br />
        ; MUI 1.67 compatible ------<br />
        !include "MUI.nsh"<br />
        !include "LogicLib.nsh"<br />
        !include "nsDialogs.nsh"<br />
        <br />
        ; MUI Settings<br />
        !define MUI_ABORTWARNING<br />
        !define MUI_HEADERIMAGE<br />
        !define MUI_ICON "TDSProjectToolInstall.ico"<br />
        !define MUI_UNICON "TDSProjectToolUninstall.ico"<br />
        <br />
        ; Language Selection Dialog Settings<br />
        !define MUI_LANGDLL_REGISTRY_ROOT "${PRODUCT_UNINST_ROOT_KEY}"<br />
        !define MUI_LANGDLL_REGISTRY_KEY "${PRODUCT_UNINST_KEY}"<br />
        !define MUI_LANGDLL_REGISTRY_VALUENAME "NSIS:Language"<br />
        <br />
        !insertmacro MUI_RESERVEFILE_INSTALLOPTIONS<br />
        ; Welcome page<br />
        !insertmacro MUI_PAGE_WELCOME<br />
        /*; License page<br />
        !insertmacro MUI_PAGE_LICENSE "..\SoftwareLicence.txt"*/<br />
        ;Overwrite Check<br />
        Page custom ShowCustomCheck LeaveCustomCheck<br />
        ; Directory page<br />
        !insertmacro MUI_PAGE_DIRECTORY<br />
        ; Instfiles page<br />
        !insertmacro MUI_PAGE_INSTFILES<br />
        ; Finish page<br />
        !define MUI_FINISHPAGE_RUN "$INSTDIR\TDSProg.exe "<br />
        !insertmacro MUI_PAGE_FINISH<br />
        <br />
        ; Uninstaller pages<br />
        !insertmacro MUI_UNPAGE_INSTFILES<br />
        <br />
        ; Language files<br />
        !insertmacro MUI_LANGUAGE "English"<br />
        !insertmacro MUI_LANGUAGE "French"<br />
        !insertmacro MUI_LANGUAGE "German"<br />
        <br />
        ; MUI end ------<br />
        <br />
        <br />
        Name "${PRODUCT_NAME} ${PRODUCT_VERSION}"<br />
        <br />
        OutFile "MITRAC_CC_TDS-PROG-Tool_2.6.0.6_install.exe"<br />
        <br />
        InstallDir "$PROGRAMFILES\MITRAC\TDS-PROG2"<br />
        InstallDirRegKey HKLM "${PRODUCT_DIR_REGKEY}" ""<br />
        ShowInstDetails show<br />
        ShowUnInstDetails show<br />
        <br />
        Function .onInit<br />
        <br />
        !insertmacro MUI_LANGDLL_DISPLAY<br />
        <br />
        FunctionEnd<br />
        <br />
        var dialog<br />
        var hwnd<br />
        <br />
        var Group1Radio1<br />
        var Group1Radio2<br />
        var Label<br />
        var Text<br />
        <br />
        Function ShowCustomCheck<br />
        <br />
        ReadRegStr $R0 HKLM "${PRODUCT_UNINST_KEY}" "DisplayName"<br />
        StrCmp $R0 "" lbl_ok 0<br />
        nsDialogs::Create 1018<br />
        Pop $dialog<br />
        !insertmacro MUI_HEADER_TEXT "Already Installed" "Choose the maintenance option to perform."<br />
        ${NSD_CreateLabel} 0 0 100% 20% "$(^Name)is already installed. Select the operation you want to perform and click Next to continue."<br />
        Pop $Label<br />
        <br />
        ${NSD_CreateRadioButton} 10 30 60% 25% "Re-install"<br />
        Pop $Group1Radio1<br />
        ${NSD_AddStyle} $Group1Radio1 ${WS_GROUP}<br />
        ${NSD_OnClick} $Group1Radio1 RadioClick<br />
        <br />
        ${NSD_CreateRadioButton} 10 35% 25% 12% "Un-install"<br />
        Pop $Group1Radio2<br />
        ${NSD_OnClick} $Group1Radio2 RadioClick<br />
        <br />
        nsDialogs::Show<br />
        lbl_ok:<br />
        Return<br />
        FunctionEnd<br />
        <br />
        Function RadioClick<br />
        ;<br />
        FunctionEnd<br />
        <br />
        Function LeaveCustomCheck<br />
        <br />
        Pop $hwnd<br />
        ${If} $hwnd == $Group1Radio1<br />
        ;Perform Installation<br />
        ${ElseIf} $hwnd == $Group1Radio2<br />
        SetAutoClose true<br />
        BringToFront<br />
        ReadRegStr $R1 HKLM "${PRODUCT_UNINST_KEY}" "UninstallString"<br />
        ;HideWindow<br />
        ClearErrors<br />
        ExecWait '$R1 _?=$INSTDIR'<br />
        IfErrors no_remove_uninstaller<br />
        IfFileExists "$INSTDIR\uninstall.exe" 0 no_remove_uninstaller<br />
        Delete "$R1"<br />
        RMDir $INSTDIR<br />
        Quit<br />
        ;Call RelGotoPage<br />
        no_remove_uninstaller:<br />
        ${Else}<br />
        MessageBox MB_ICONSTOP "Please select either of the options or press Cancel to exit installer." IDOK<br />
        Abort<br />
        ${EndIf}<br />
        <br />
        FunctionEnd<br />
        <br />
        Section "MainSection" SEC01<br />
        lbl_inst:<br />
        SetOutPath "$INSTDIR"<br />
        SetOverwrite ifnewer<br />
        File "..\TDSProg\release\TDSProg.exe"<br />
        CreateDirectory "$SMPROGRAMS\MITRAC Tool Suite\MITRAC CC TDS-PROG"<br />
        CreateShortCut "$SMPROGRAMS\MITRAC Tool Suite\MITRAC CC TDS-PROG\TDS-PROG Tool.lnk" "$INSTDIR\TDSProg.exe"<br />
        CreateShortCut "$DESKTOP\TDS-PROG Tool.lnk" "$INSTDIR\TDSProg.exe"<br />
        <br />
        File "..\TDSProg\release\MTScc.dll"<br />
        File "..\TDSProg\release\MTHelpViewer.dll"<br />
        File "..\TDSProg\release\MTResManager.dll"<br />
        File "..\TDSProg\release\MTGrid.dll"<br />
        File "..\TDSProg\release\TDSLib.dll"<br />
        File "..\TDSProg\release\TDSOutput.dll"<br />
        File "..\TDSProg\release\TDSParseDLL.dll"<br />
        File "..\TDSProg\release\TDSParseDLL_Unicode.dll"<br />
        File "..\TDSProg\release\Trace.dll"<br />
        File "..\TDSProg\release\TDSImportInterface.dll"<br />
        File "..\TDSProg\release\TDSXMLExportPlugin.dll"<br />
        File "..\TDSProg\release\olexlsf.tlh"<br />
        File "..\TDSProg\release\olexlsf.tli"<br />
        File "..\service\makedlu\makedlu.exe"<br />
        File "..\service\makedlu\tar.exe"<br />
        File "..\service\makedlu\gzip.exe"<br />
        File "..\service\makedlu\zip.exe"<br />
        File "..\service\xfo40-reg-20090111\REG\Lib\olexlsf.dll"<br />
        Exec "Setenv D:\Program Files\MITRAC\TDS-PROG2"<br />
        Exec "REGSVR32.EXE olexlsf.dll"<br />
        SetOutPath "$INSTDIR\temp"<br />
        File "..\TDSProg\release\temp\exportFile.xls"<br />
        <br />
        SectionEnd<br />
        SetPluginUnload alwaysoff<br />
        <br />
        <br />
        <br />
        Section "SupportDll" SEC02<br />
        SetOutPath "$INSTDIR"<br />
        File "mfc42loc.dll"<br />
        File "QtCore4.dll"<br />
        File "QtGui4.dll"<br />
        File "QtXml4.dll"<br />
        SectionEnd<br />
        <br />
        Section "Help" SEC03<br />
        SetOutPath "$INSTDIR\help\en"<br />
        File "..\TDSProg\help\en\contents.xml"<br />
        File "..\TDSProg\help\en\HelpEnglish.htm"<br />
        File "..\TDSProg\help\en\style.css"<br />
        SetOutPath "$INSTDIR\help\en\HelpEnglish_files"<br />
        File "..\TDSProg\help\en\HelpEnglish_files\image001.png"<br />
        File "..\TDSProg\help\en\HelpEnglish_files\image002.png"<br />
        File "..\TDSProg\help\en\HelpEnglish_files\image003.png"<br />
        File "..\TDSProg\help\en\HelpEnglish_files\image004.png"<br />
        File "..\TDSProg\help\en\HelpEnglish_files\image005.png"<br />
        File "..\TDSProg\help\en\HelpEnglish_files\image006.png"<br />
        File "..\TDSProg\help\en\HelpEnglish_files\image007.png"<br />
        File "..\TDSProg\help\en\HelpEnglish_files\image008.png"<br />
        File "..\TDSProg\help\en\HelpEnglish_files\image009.png"<br />
        File "..\TDSProg\help\en\HelpEnglish_files\image010.png"<br />
        File "..\TDSProg\help\en\HelpEnglish_files\image011.png"<br />
        File "..\TDSProg\help\en\HelpEnglish_files\image012.png"<br />
        File "..\TDSProg\help\en\HelpEnglish_files\image013.png"<br />
        File "..\TDSProg\help\en\HelpEnglish_files\image014.png"<br />
        File "..\TDSProg\help\en\HelpEnglish_files\image015.png"<br />
        File "..\TDSProg\help\en\HelpEnglish_files\image016.png"<br />
        File "..\TDSProg\help\en\HelpEnglish_files\image017.png"<br />
        File "..\TDSProg\help\en\HelpEnglish_files\image018.png"<br />
        File "..\TDSProg\help\en\HelpEnglish_files\image019.png"<br />
        File "..\TDSProg\help\en\HelpEnglish_files\image020.png"<br />
        File "..\TDSProg\help\en\HelpEnglish_files\image021.png"<br />
        File "..\TDSProg\help\en\HelpEnglish_files\image022.png"<br />
        File "..\TDSProg\help\en\HelpEnglish_files\image023.png"<br />
        File "..\TDSProg\help\en\HelpEnglish_files\image024.png"<br />
        File "..\TDSProg\help\en\HelpEnglish_files\image025.png"<br />
        File "..\TDSProg\help\en\HelpEnglish_files\image026.png"<br />
        File "..\TDSProg\help\en\HelpEnglish_files\image027.png"<br />
        File "..\TDSProg\help\en\HelpEnglish_files\image028.png"<br />
        File "..\TDSProg\help\en\HelpEnglish_files\image029.png"<br />
        File "..\TDSProg\help\en\HelpEnglish_files\image030.png"<br />
        File "..\TDSProg\help\en\HelpEnglish_files\image031.png"<br />
        File "..\TDSProg\help\en\HelpEnglish_files\image032.png"<br />
        File "..\TDSProg\help\en\HelpEnglish_files\image033.png"<br />
        File "..\TDSProg\help\en\HelpEnglish_files\image034.png"<br />
        File "..\TDSProg\help\en\HelpEnglish_files\image035.png"<br />
        File "..\TDSProg\help\en\HelpEnglish_files\image036.png"<br />
        File "..\TDSProg\help\en\HelpEnglish_files\image037.png"<br />
        File "..\TDSProg\help\en\HelpEnglish_files\image038.png"<br />
        File "..\TDSProg\help\en\HelpEnglish_files\image039.png"<br />
        File "..\TDSProg\help\en\HelpEnglish_files\image040.png"<br />
        File "..\TDSProg\help\en\HelpEnglish_files\image041.png"<br />
        File "..\TDSProg\help\en\HelpEnglish_files\image042.png"<br />
        File "..\TDSProg\help\en\HelpEnglish_files\image043.png"<br />
        File "..\TDSProg\help\en\HelpEnglish_files\image044.png"<br />
        File "..\TDSProg\help\en\HelpEnglish_files\image045.png"<br />
        File "..\TDSProg\help\en\HelpEnglish_files\image046.png"<br />
        File "..\TDSProg\help\en\HelpEnglish_files\image047.png"<br />
        File "..\TDSProg\help\en\HelpEnglish_files\image048.png"<br />
        File "..\TDSProg\help\en\HelpEnglish_files\image049.png"<br />
        File "..\TDSProg\help\en\HelpEnglish_files\image050.png"<br />
        File "..\TDSProg\help\en\HelpEnglish_files\image051.png"<br />
        File "..\TDSProg\help\en\HelpEnglish_files\image052.png"<br />
        File "..\TDSProg\help\en\HelpEnglish_files\image053.png"<br />
        File "..\TDSProg\help\en\HelpEnglish_files\image054.png"<br />
        File "..\TDSProg\help\en\HelpEnglish_files\image055.png"<br />
        File "..\TDSProg\help\en\HelpEnglish_files\image056.png"<br />
        File "..\TDSProg\help\en\HelpEnglish_files\image057.png"<br />
        File "..\TDSProg\help\en\HelpEnglish_files\image058.png"<br />
        File "..\TDSProg\help\en\HelpEnglish_files\image059.png"<br />
        File "..\TDSProg\help\en\HelpEnglish_files\image060.png"<br />
        File "..\TDSProg\help\en\HelpEnglish_files\image061.png"<br />
        File "..\TDSProg\help\en\HelpEnglish_files\image062.png"<br />
        File "..\TDSProg\help\en\HelpEnglish_files\image063.png"<br />
        File "..\TDSProg\help\en\HelpEnglish_files\image064.png"<br />
        File "..\TDSProg\help\en\HelpEnglish_files\image065.png"<br />
        File "..\TDSProg\help\en\HelpEnglish_files\image066.png"<br />
        File "..\TDSProg\help\en\HelpEnglish_files\image067.png"<br />
        File "..\TDSProg\help\en\HelpEnglish_files\image068.png"<br />
        File "..\TDSProg\help\en\HelpEnglish_files\image069.png"<br />
        File "..\TDSProg\help\en\HelpEnglish_files\image070.png"<br />
        File "..\TDSProg\help\en\HelpEnglish_files\image071.png"<br />
        File "..\TDSProg\help\en\HelpEnglish_files\image072.png"<br />
        File "..\TDSProg\help\en\HelpEnglish_files\image073.png"<br />
        File "..\TDSProg\help\en\HelpEnglish_files\image074.png"<br />
        File "..\TDSProg\help\en\HelpEnglish_files\image075.png"<br />
        File "..\TDSProg\help\en\HelpEnglish_files\image076.png"<br />
        File "..\TDSProg\help\en\HelpEnglish_files\image077.png"<br />
        File "..\TDSProg\help\en\HelpEnglish_files\image078.png"<br />
        File "..\TDSProg\help\en\HelpEnglish_files\image079.png"<br />
        File "..\TDSProg\help\en\HelpEnglish_files\image080.png"<br />
        File "..\TDSProg\help\en\HelpEnglish_files\image081.png"<br />
        File "..\TDSProg\help\en\HelpEnglish_files\image082.png"<br />
        File "..\TDSProg\help\en\HelpEnglish_files\image083.png"<br />
        File "..\TDSProg\help\en\HelpEnglish_files\image084.png"<br />
        File "..\TDSProg\help\en\HelpEnglish_files\image085.png"<br />
        File "..\TDSProg\help\en\HelpEnglish_files\image086.png"<br />
        File "..\TDSProg\help\en\HelpEnglish_files\image087.png"<br />
        File "..\TDSProg\help\en\HelpEnglish_files\image088.png"<br />
        File "..\TDSProg\help\en\HelpEnglish_files\image089.png"<br />
        File "..\TDSProg\help\en\HelpEnglish_files\image090.png"<br />
        File "..\TDSProg\help\en\HelpEnglish_files\image091.png"<br />
        File "..\TDSProg\help\en\HelpEnglish_files\image092.png"<br />
        File "..\TDSProg\help\en\HelpEnglish_files\image093.png"<br />
        File "..\TDSProg\help\en\HelpEnglish_files\image094.png"<br />
        File "..\TDSProg\help\en\HelpEnglish_files\image095.png"<br />
        File "..\TDSProg\help\en\HelpEnglish_files\image096.png"<br />
        File "..\TDSProg\help\en\HelpEnglish_files\image097.png"<br />
        File "..\TDSProg\help\en\HelpEnglish_files\image098.png"<br />
        File "..\TDSProg\help\en\HelpEnglish_files\image099.png"<br />
        File "..\TDSProg\help\en\HelpEnglish_files\image100.png"<br />
        File "..\TDSProg\help\en\HelpEnglish_files\image101.png"<br />
        File "..\TDSProg\help\en\HelpEnglish_files\image102.png"<br />
        File "..\TDSProg\help\en\HelpEnglish_files\image103.png"<br />
        File "..\TDSProg\help\en\HelpEnglish_files\image104.png"<br />
        File "..\TDSProg\help\en\HelpEnglish_files\image105.png"<br />
        File "..\TDSProg\help\en\HelpEnglish_files\image106.png"<br />
        <br />
        SectionEnd<br />
        Section "Help" SEC04<br />
        SetOutPath "$INSTDIR\help\en_ecm"<br />
        File "..\TDSProg\help\en_ecm\contents.xml"<br />
        File "..\TDSProg\help\en_ecm\HelpEnglish.htm"<br />
        File "..\TDSProg\help\en_ecm\style.css"<br />
        SetOutPath "$INSTDIR\help\en_ecm\HelpEnglish_files"<br />
        File "..\TDSProg\help\en_ecm\HelpEnglish_files\image001.png"<br />
        File "..\TDSProg\help\en_ecm\HelpEnglish_files\image002.png"<br />
        File "..\TDSProg\help\en_ecm\HelpEnglish_files\image003.png"<br />
        File "..\TDSProg\help\en_ecm\HelpEnglish_files\image004.png"<br />
        File "..\TDSProg\help\en_ecm\HelpEnglish_files\image005.png"<br />
        File "..\TDSProg\help\en_ecm\HelpEnglish_files\image006.png"<br />
        File "..\TDSProg\help\en_ecm\HelpEnglish_files\image007.png"<br />
        File "..\TDSProg\help\en_ecm\HelpEnglish_files\image008.png"<br />
        File "..\TDSProg\help\en_ecm\HelpEnglish_files\image009.png"<br />
        File "..\TDSProg\help\en_ecm\HelpEnglish_files\image010.png"<br />
        File "..\TDSProg\help\en_ecm\HelpEnglish_files\image011.png"<br />
        File "..\TDSProg\help\en_ecm\HelpEnglish_files\image012.png"<br />
        File "..\TDSProg\help\en_ecm\HelpEnglish_files\image013.png"<br />
        File "..\TDSProg\help\en_ecm\HelpEnglish_files\image014.png"<br />
        File "..\TDSProg\help\en_ecm\HelpEnglish_files\image015.png"<br />
        File "..\TDSProg\help\en_ecm\HelpEnglish_files\image016.png"<br />
        File "..\TDSProg\help\en_ecm\HelpEnglish_files\image017.png"<br />
        File "..\TDSProg\help\en_ecm\HelpEnglish_files\image018.png"<br />
        File "..\TDSProg\help\en_ecm\HelpEnglish_files\image019.png"<br />
        File "..\TDSProg\help\en_ecm\HelpEnglish_files\image020.png"<br />
        File "..\TDSProg\help\en_ecm\HelpEnglish_files\image021.png"<br />
        File "..\TDSProg\help\en_ecm\HelpEnglish_files\image022.png"<br />
        File "..\TDSProg\help\en_ecm\HelpEnglish_files\image023.png"<br />
        File "..\TDSProg\help\en_ecm\HelpEnglish_files\image024.png"<br />
        File "..\TDSProg\help\en_ecm\HelpEnglish_files\image025.png"<br />
        File "..\TDSProg\help\en_ecm\HelpEnglish_files\image026.png"<br />
        File "..\TDSProg\help\en_ecm\HelpEnglish_files\image027.png"<br />
        File "..\TDSProg\help\en_ecm\HelpEnglish_files\image028.png"<br />
        File "..\TDSProg\help\en_ecm\HelpEnglish_files\image029.png"<br />
        File "..\TDSProg\help\en_ecm\HelpEnglish_files\image030.png"<br />
        File "..\TDSProg\help\en_ecm\HelpEnglish_files\image031.png"<br />
        File "..\TDSProg\help\en_ecm\HelpEnglish_files\image032.png"<br />
        File "..\TDSProg\help\en_ecm\HelpEnglish_files\image033.png"<br />
        File "..\TDSProg\help\en_ecm\HelpEnglish_files\image034.png"<br />
        File "..\TDSProg\help\en_ecm\HelpEnglish_files\image035.png"<br />
        File "..\TDSProg\help\en_ecm\HelpEnglish_files\image036.png"<br />
        File "..\TDSProg\help\en_ecm\HelpEnglish_files\image037.png"<br />
        File "..\TDSProg\help\en_ecm\HelpEnglish_files\image038.png"<br />
        File "..\TDSProg\help\en_ecm\HelpEnglish_files\image039.png"<br />
        File "..\TDSProg\help\en_ecm\HelpEnglish_files\image040.png"<br />
        File "..\TDSProg\help\en_ecm\HelpEnglish_files\image041.png"<br />
        File "..\TDSProg\help\en_ecm\HelpEnglish_files\image042.png"<br />
        File "..\TDSProg\help\en_ecm\HelpEnglish_files\image043.png"<br />
        File "..\TDSProg\help\en_ecm\HelpEnglish_files\image044.png"<br />
        File "..\TDSProg\help\en_ecm\HelpEnglish_files\image045.png"<br />
        File "..\TDSProg\help\en_ecm\HelpEnglish_files\image046.png"<br />
        File "..\TDSProg\help\en_ecm\HelpEnglish_files\image047.png"<br />
        File "..\TDSProg\help\en_ecm\HelpEnglish_files\image048.png"<br />
        File "..\TDSProg\help\en_ecm\HelpEnglish_files\image049.png"<br />
        File "..\TDSProg\help\en_ecm\HelpEnglish_files\image050.png"<br />
        File "..\TDSProg\help\en_ecm\HelpEnglish_files\image051.png"<br />
        File "..\TDSProg\help\en_ecm\HelpEnglish_files\image052.png"<br />
        File "..\TDSProg\help\en_ecm\HelpEnglish_files\image053.png"<br />
        File "..\TDSProg\help\en_ecm\HelpEnglish_files\image054.png"<br />
        File "..\TDSProg\help\en_ecm\HelpEnglish_files\image055.png"<br />
        File "..\TDSProg\help\en_ecm\HelpEnglish_files\image056.png"<br />
        File "..\TDSProg\help\en_ecm\HelpEnglish_files\image057.png"<br />
        File "..\TDSProg\help\en_ecm\HelpEnglish_files\image058.png"<br />
        <br />
        <br />
        SetOutPath "$INSTDIR"<br />
        File "..\3EGM080680D9023_EN_D_TDS_PROG_UserManual_Engineering.pdf"<br />
        File "..\3EGM080680D9024_EN_D_TDS_PROG_UserManual_EndCustomer.pdf"<br />
        File "..\3EGM080680D9025_EN_C_TDS_PROG_Tutorial.pdf"<br />
        File "..\3EGM080680D0260_EN__TDS-PROG_ReleaseNote_2_6_0_0.pdf"<br />
        <br />
        SectionEnd<br />
        <br />
        Section -AdditionalIcons<br />
        CreateShortCut "$SMPROGRAMS\MITRAC Tool Suite\MITRAC CC TDS-PROG\TDS User Manual-Engineering.lnk" "$INSTDIR\3EGM080680D9023_EN_D_TDS_PROG_UserManual_Engineering.pdf"<br />
        CreateShortCut "$SMPROGRAMS\MITRAC Tool Suite\MITRAC CC TDS-PROG\TDS User Manual-EndCustomer.lnk" "$INSTDIR\3EGM080680D9024_EN_D_TDS_PROG_UserManual_EndCustomer.pdf"<br />
        CreateShortCut "$SMPROGRAMS\MITRAC Tool Suite\MITRAC CC TDS-PROG\TDS User Guide.lnk" "$INSTDIR\3EGM080680D9025_EN_C_TDS_PROG_Tutorial.pdf"<br />
        CreateShortCut "$SMPROGRAMS\MITRAC Tool Suite\MITRAC CC TDS-PROG\TDS Release Notes.lnk" "$INSTDIR\3EGM080680D0260_EN__TDS-PROG_ReleaseNote_2_6_0_0.pdf"<br />
        CreateShortCut "$SMPROGRAMS\MITRAC Tool Suite\MITRAC CC TDS-PROG\Uninstall.lnk" "$INSTDIR\uninst.exe"<br />
        SectionEnd<br />
        <br />
        Section -RegistrySettings<br />
        WriteRegStr HKCR ".mdp" "" "mdpfile"<br />
        WriteRegStr HKCR "mdpfile" "" "TDS-PROG Tool Project File"<br />
        WriteRegDWORD HKCR "mdpfile" "EditFlags" 0x00000000<br />
        WriteRegDWORD HKCR "mdpfile" "BrowserFlags" 0x00000008<br />
        WriteRegStr HKCR "mdpfile\DefaultIcon" "" "$\"$INSTDIR\TDSProg.exe$\",1"<br />
        WriteRegStr HKCR "mdpfile\shell" "" "Open"<br />
        WriteRegStr HKCR "mdpfile\shell\Open" "" "Open Project with TDS Prog Tool"<br />
        WriteRegStr HKCR "mdpfile\shell\Open\command" "" "$\"$INSTDIR\TDSProg.exe$\" $\"-o$\" $\"%1$\""<br />
        WriteRegStr HKCR "mdpfile\shell\Generate" "" "Generate Files with TDS Prog Tool"<br />
        WriteRegStr HKCR "mdpfile\shell\Generate\command" "" "$\"$INSTDIR\TDSProg.exe$\" $\"-g$\" $\"%1$\""<br />
        WriteRegStr HKCR "mdpfile\shell\Clean" "" "Clean Files with TDS Prog Tool"<br />
        WriteRegStr HKCR "mdpfile\shell\Clean\command" "" "$\"$INSTDIR\TDSProg.exe$\" $\"-c$\" $\"%1$\""<br />
        SectionEnd<br />
        <br />
        Section -Post<br />
        WriteUninstaller "$INSTDIR\uninst.exe"<br />
        WriteRegStr HKLM "${PRODUCT_DIR_REGKEY}" "" "$INSTDIR\TDSProg.exe"<br />
        WriteRegStr ${PRODUCT_UNINST_ROOT_KEY} "${PRODUCT_UNINST_KEY}" "DisplayName" "$(^Name)"<br />
        WriteRegStr ${PRODUCT_UNINST_ROOT_KEY} "${PRODUCT_UNINST_KEY}" "UninstallString" "$INSTDIR\uninst.exe"<br />
        WriteRegStr ${PRODUCT_UNINST_ROOT_KEY} "${PRODUCT_UNINST_KEY}" "DisplayIcon" "$INSTDIR\TDSProg.exe"<br />
        WriteRegStr ${PRODUCT_UNINST_ROOT_KEY} "${PRODUCT_UNINST_KEY}" "DisplayVersion" "${PRODUCT_VERSION}"<br />
        WriteRegStr ${PRODUCT_UNINST_ROOT_KEY} "${PRODUCT_UNINST_KEY}" "URLInfoAbout" "${PRODUCT_WEB_SITE}"<br />
        WriteRegStr ${PRODUCT_UNINST_ROOT_KEY} "${PRODUCT_UNINST_KEY}" "Publisher" "${PRODUCT_PUBLISHER}"<br />
        SectionEnd<br />
        <br />
        <br />
        Function un.onUninstSuccess<br />
        HideWindow<br />
        MessageBox MB_ICONINFORMATION|MB_OK "$(^Name) was successfully removed from your computer."<br />
        FunctionEnd<br />
        <br />
        Function un.onInit<br />
        <br />
        !insertmacro MUI_UNGETLANGUAGE<br />
        MessageBox MB_ICONQUESTION|MB_YESNO|MB_DEFBUTTON2 "Are you sure you want to completely remove $(^Name) and all of its components?" IDYES +2<br />
        Abort<br />
        FunctionEnd<br />
        <br />
        Section Uninstall<br />
        Delete "$INSTDIR\uninst.exe"<br />
        <br />
        Delete "$INSTDIR\3EGM080680D9023_EN_D_TDS_PROG_UserManual_Engineering.pdf"<br />
        Delete "$INSTDIR\3EGM080680D9024_EN_D_TDS_PROG_UserManual_EndCustomer.pdf"<br />
        Delete "$INSTDIR\3EGM080680D9025_EN_C_TDS_PROG_Tutorial.pdf"<br />
        Delete "$INSTDIR\3EGM080680D0260_EN__TDS-PROG_ReleaseNote_2_6_0_0.pdf"<br />
        <br />
        <br />
        Delete "$INSTDIR\help\en\HelpEnglish.htm"<br />
        Delete "$INSTDIR\help\en\contents.xml"<br />
        Delete "$INSTDIR\help\en\style.css"<br />
        Delete "$INSTDIR\help\en\HelpEnglish_files\image001.png"<br />
        Delete "$INSTDIR\help\en\HelpEnglish_files\image002.png"<br />
        Delete "$INSTDIR\help\en\HelpEnglish_files\image003.png"<br />
        Delete "$INSTDIR\help\en\HelpEnglish_files\image004.png"<br />
        Delete "$INSTDIR\help\en\HelpEnglish_files\image005.png"<br />
        Delete "$INSTDIR\help\en\HelpEnglish_files\image006.png"<br />
        Delete "$INSTDIR\help\en\HelpEnglish_files\image007.png"<br />
        Delete "$INSTDIR\help\en\HelpEnglish_files\image008.png"<br />
        Delete "$INSTDIR\help\en\HelpEnglish_files\image009.png"<br />
        Delete "$INSTDIR\help\en\HelpEnglish_files\image010.png"<br />
        Delete "$INSTDIR\help\en\HelpEnglish_files\image011.png"<br />
        Delete "$INSTDIR\help\en\HelpEnglish_files\image012.png"<br />
        Delete "$INSTDIR\help\en\HelpEnglish_files\image013.png"<br />
        Delete "$INSTDIR\help\en\HelpEnglish_files\image014.png"<br />
        Delete "$INSTDIR\help\en\HelpEnglish_files\image015.png"<br />
        Delete "$INSTDIR\help\en\HelpEnglish_files\image016.png"<br />
        Delete "$INSTDIR\help\en\HelpEnglish_files\image017.png"<br />
        Delete "$INSTDIR\help\en\HelpEnglish_files\image018.png"<br />
        Delete "$INSTDIR\help\en\HelpEnglish_files\image019.png"<br />
        Delete "$INSTDIR\help\en\HelpEnglish_files\image020.png"<br />
        Delete "$INSTDIR\help\en\HelpEnglish_files\image021.png"<br />
        Delete "$INSTDIR\help\en\HelpEnglish_files\image022.png"<br />
        Delete "$INSTDIR\help\en\HelpEnglish_files\image023.png"<br />
        Delete "$INSTDIR\help\en\HelpEnglish_files\image024.png"<br />
        Delete "$INSTDIR\help\en\HelpEnglish_files\image025.png"<br />
        Delete "$INSTDIR\help\en\HelpEnglish_files\image026.png"<br />
        Delete "$INSTDIR\help\en\HelpEnglish_files\image027.png"<br />
        Delete "$INSTDIR\help\en\HelpEnglish_files\image028.png"<br />
        Delete "$INSTDIR\help\en\HelpEnglish_files\image029.png"<br />
        Delete "$INSTDIR\help\en\HelpEnglish_files\image030.png"<br />
        Delete "$INSTDIR\help\en\HelpEnglish_files\image031.png"<br />
        Delete "$INSTDIR\help\en\HelpEnglish_files\image032.png"<br />
        Delete "$INSTDIR\help\en\HelpEnglish_files\image033.png"<br />
        Delete "$INSTDIR\help\en\HelpEnglish_files\image034.png"<br />
        Delete "$INSTDIR\help\en\HelpEnglish_files\image035.png"<br />
        Delete "$INSTDIR\help\en\HelpEnglish_files\image036.png"<br />
        Delete "$INSTDIR\help\en\HelpEnglish_files\image037.png"<br />
        Delete "$INSTDIR\help\en\HelpEnglish_files\image038.png"<br />
        Delete "$INSTDIR\help\en\HelpEnglish_files\image039.png"<br />
        Delete "$INSTDIR\help\en\HelpEnglish_files\image040.png"<br />
        Delete "$INSTDIR\help\en\HelpEnglish_files\image041.png"<br />
        Delete "$INSTDIR\help\en\HelpEnglish_files\image042.png"<br />
        Delete "$INSTDIR\help\en\HelpEnglish_files\image043.png"<br />
        Delete "$INSTDIR\help\en\HelpEnglish_files\image044.png"<br />
        Delete "$INSTDIR\help\en\HelpEnglish_files\image045.png"<br />
        Delete "$INSTDIR\help\en\HelpEnglish_files\image046.png"<br />
        Delete "$INSTDIR\help\en\HelpEnglish_files\image047.png"<br />
        Delete "$INSTDIR\help\en\HelpEnglish_files\image048.png"<br />
        Delete "$INSTDIR\help\en\HelpEnglish_files\image049.png"<br />
        Delete "$INSTDIR\help\en\HelpEnglish_files\image050.png"<br />
        Delete "$INSTDIR\help\en\HelpEnglish_files\image051.png"<br />
        Delete "$INSTDIR\help\en\HelpEnglish_files\image052.png"<br />
        Delete "$INSTDIR\help\en\HelpEnglish_files\image053.png"<br />
        Delete "$INSTDIR\help\en\HelpEnglish_files\image054.png"<br />
        Delete "$INSTDIR\help\en\HelpEnglish_files\image055.png"<br />
        Delete "$INSTDIR\help\en\HelpEnglish_files\image056.png"<br />
        Delete "$INSTDIR\help\en\HelpEnglish_files\image057.png"<br />
        Delete "$INSTDIR\help\en\HelpEnglish_files\image058.png"<br />
        Delete "$INSTDIR\help\en\HelpEnglish_files\image059.png"<br />
        Delete "$INSTDIR\help\en\HelpEnglish_files\image060.png"<br />
        Delete "$INSTDIR\help\en\HelpEnglish_files\image061.png"<br />
        Delete "$INSTDIR\help\en\HelpEnglish_files\image062.png"<br />
        Delete "$INSTDIR\help\en\HelpEnglish_files\image063.png"<br />
        Delete "$INSTDIR\help\en\HelpEnglish_files\image064.png"<br />
        Delete "$INSTDIR\help\en\HelpEnglish_files\image065.png"<br />
        Delete "$INSTDIR\help\en\HelpEnglish_files\image066.png"<br />
        Delete "$INSTDIR\help\en\HelpEnglish_files\image067.png"<br />
        Delete "$INSTDIR\help\en\HelpEnglish_files\image068.png"<br />
        Delete "$INSTDIR\help\en\HelpEnglish_files\image069.png"<br />
        Delete "$INSTDIR\help\en\HelpEnglish_files\image070.png"<br />
        Delete "$INSTDIR\help\en\HelpEnglish_files\image071.png"<br />
        Delete "$INSTDIR\help\en\HelpEnglish_files\image072.png"<br />
        Delete "$INSTDIR\help\en\HelpEnglish_files\image073.png"<br />
        Delete "$INSTDIR\help\en\HelpEnglish_files\image074.png"<br />
        Delete "$INSTDIR\help\en\HelpEnglish_files\image075.png"<br />
        Delete "$INSTDIR\help\en\HelpEnglish_files\image076.png"<br />
        Delete "$INSTDIR\help\en\HelpEnglish_files\image077.png"<br />
        Delete "$INSTDIR\help\en\HelpEnglish_files\image078.png"<br />
        Delete "$INSTDIR\help\en\HelpEnglish_files\image079.png"<br />
        Delete "$INSTDIR\help\en\HelpEnglish_files\image080.png"<br />
        Delete "$INSTDIR\help\en\HelpEnglish_files\image081.png"<br />
        Delete "$INSTDIR\help\en\HelpEnglish_files\image082.png"<br />
        Delete "$INSTDIR\help\en\HelpEnglish_files\image083.png"<br />
        Delete "$INSTDIR\help\en\HelpEnglish_files\image084.png"<br />
        Delete "$INSTDIR\help\en\HelpEnglish_files\image085.png"<br />
        Delete "$INSTDIR\help\en\HelpEnglish_files\image086.png"<br />
        Delete "$INSTDIR\help\en\HelpEnglish_files\image087.png"<br />
        Delete "$INSTDIR\help\en\HelpEnglish_files\image088.png"<br />
        Delete "$INSTDIR\help\en\HelpEnglish_files\image089.png"<br />
        Delete "$INSTDIR\help\en\HelpEnglish_files\image090.png"<br />
        Delete "$INSTDIR\help\en\HelpEnglish_files\image091.png"<br />
        Delete "$INSTDIR\help\en\HelpEnglish_files\image092.png"<br />
        Delete "$INSTDIR\help\en\HelpEnglish_files\image093.png"<br />
        Delete "$INSTDIR\help\en\HelpEnglish_files\image094.png"<br />
        Delete "$INSTDIR\help\en\HelpEnglish_files\image095.png"<br />
        Delete "$INSTDIR\help\en\HelpEnglish_files\image096.png"<br />
        Delete "$INSTDIR\help\en\HelpEnglish_files\image097.png"<br />
        Delete "$INSTDIR\help\en\HelpEnglish_files\image098.png"<br />
        Delete "$INSTDIR\help\en\HelpEnglish_files\image099.png"<br />
        Delete "$INSTDIR\help\en\HelpEnglish_files\image100.png"<br />
        Delete "$INSTDIR\help\en\HelpEnglish_files\image101.png"<br />
        Delete "$INSTDIR\help\en\HelpEnglish_files\image102.png"<br />
        Delete "$INSTDIR\help\en\HelpEnglish_files\image103.png"<br />
        Delete "$INSTDIR\help\en\HelpEnglish_files\image104.png"<br />
        Delete "$INSTDIR\help\en\HelpEnglish_files\image105.png"<br />
        Delete "$INSTDIR\help\en\HelpEnglish_files\image106.png"<br />
        <br />
        Delete "$INSTDIR\help\en_ecm\HelpEnglish.htm"<br />
        Delete "$INSTDIR\help\en_ecm\contents.xml"<br />
        Delete "$INSTDIR\help\en_ecm\style.css"<br />
        Delete "$INSTDIR\help\en_ecm\HelpEnglish_files\image001.png"<br />
        Delete "$INSTDIR\help\en_ecm\HelpEnglish_files\image002.png"<br />
        Delete "$INSTDIR\help\en_ecm\HelpEnglish_files\image003.png"<br />
        Delete "$INSTDIR\help\en_ecm\HelpEnglish_files\image004.png"<br />
        Delete "$INSTDIR\help\en_ecm\HelpEnglish_files\image005.png"<br />
        Delete "$INSTDIR\help\en_ecm\HelpEnglish_files\image006.png"<br />
        Delete "$INSTDIR\help\en_ecm\HelpEnglish_files\image007.png"<br />
        Delete "$INSTDIR\help\en_ecm\HelpEnglish_files\image008.png"<br />
        Delete "$INSTDIR\help\en_ecm\HelpEnglish_files\image009.png"<br />
        Delete "$INSTDIR\help\en_ecm\HelpEnglish_files\image010.png"<br />
        Delete "$INSTDIR\help\en_ecm\HelpEnglish_files\image011.png"<br />
        Delete "$INSTDIR\help\en_ecm\HelpEnglish_files\image012.png"<br />
        Delete "$INSTDIR\help\en_ecm\HelpEnglish_files\image013.png"<br />
        Delete "$INSTDIR\help\en_ecm\HelpEnglish_files\image014.png"<br />
        Delete "$INSTDIR\help\en_ecm\HelpEnglish_files\image015.png"<br />
        Delete "$INSTDIR\help\en_ecm\HelpEnglish_files\image016.png"<br />
        Delete "$INSTDIR\help\en_ecm\HelpEnglish_files\image017.png"<br />
        Delete "$INSTDIR\help\en_ecm\HelpEnglish_files\image018.png"<br />
        Delete "$INSTDIR\help\en_ecm\HelpEnglish_files\image019.png"<br />
        Delete "$INSTDIR\help\en_ecm\HelpEnglish_files\image020.png"<br />
        Delete "$INSTDIR\help\en_ecm\HelpEnglish_files\image021.png"<br />
        Delete "$INSTDIR\help\en_ecm\HelpEnglish_files\image022.png"<br />
        Delete "$INSTDIR\help\en_ecm\HelpEnglish_files\image023.png"<br />
        Delete "$INSTDIR\help\en_ecm\HelpEnglish_files\image024.png"<br />
        Delete "$INSTDIR\help\en_ecm\HelpEnglish_files\image025.png"<br />
        Delete "$INSTDIR\help\en_ecm\HelpEnglish_files\image026.png"<br />
        Delete "$INSTDIR\help\en_ecm\HelpEnglish_files\image027.png"<br />
        Delete "$INSTDIR\help\en_ecm\HelpEnglish_files\image028.png"<br />
        Delete "$INSTDIR\help\en_ecm\HelpEnglish_files\image029.png"<br />
        Delete "$INSTDIR\help\en_ecm\HelpEnglish_files\image030.png"<br />
        Delete "$INSTDIR\help\en_ecm\HelpEnglish_files\image031.png"<br />
        Delete "$INSTDIR\help\en_ecm\HelpEnglish_files\image032.png"<br />
        Delete "$INSTDIR\help\en_ecm\HelpEnglish_files\image033.png"<br />
        Delete "$INSTDIR\help\en_ecm\HelpEnglish_files\image034.png"<br />
        Delete "$INSTDIR\help\en_ecm\HelpEnglish_files\image035.png"<br />
        Delete "$INSTDIR\help\en_ecm\HelpEnglish_files\image036.png"<br />
        Delete "$INSTDIR\help\en_ecm\HelpEnglish_files\image037.png"<br />
        Delete "$INSTDIR\help\en_ecm\HelpEnglish_files\image038.png"<br />
        Delete "$INSTDIR\help\en_ecm\HelpEnglish_files\image039.png"<br />
        Delete "$INSTDIR\help\en_ecm\HelpEnglish_files\image040.png"<br />
        Delete "$INSTDIR\help\en_ecm\HelpEnglish_files\image041.png"<br />
        Delete "$INSTDIR\help\en_ecm\HelpEnglish_files\image042.png"<br />
        Delete "$INSTDIR\help\en_ecm\HelpEnglish_files\image043.png"<br />
        Delete "$INSTDIR\help\en_ecm\HelpEnglish_files\image044.png"<br />
        Delete "$INSTDIR\help\en_ecm\HelpEnglish_files\image045.png"<br />
        Delete "$INSTDIR\help\en_ecm\HelpEnglish_files\image046.png"<br />
        Delete "$INSTDIR\help\en_ecm\HelpEnglish_files\image047.png"<br />
        Delete "$INSTDIR\help\en_ecm\HelpEnglish_files\image048.png"<br />
        Delete "$INSTDIR\help\en_ecm\HelpEnglish_files\image049.png"<br />
        Delete "$INSTDIR\help\en_ecm\HelpEnglish_files\image050.png"<br />
        Delete "$INSTDIR\help\en_ecm\HelpEnglish_files\image051.png"<br />
        Delete "$INSTDIR\help\en_ecm\HelpEnglish_files\image052.png"<br />
        Delete "$INSTDIR\help\en_ecm\HelpEnglish_files\image053.png"<br />
        Delete "$INSTDIR\help\en_ecm\HelpEnglish_files\image054.png"<br />
        Delete "$INSTDIR\help\en_ecm\HelpEnglish_files\image055.png"<br />
        Delete "$INSTDIR\help\en_ecm\HelpEnglish_files\image056.png"<br />
        Delete "$INSTDIR\help\en_ecm\HelpEnglish_files\image057.png"<br />
        Delete "$INSTDIR\help\en_ecm\HelpEnglish_files\image058.png"<br />
        <br />
        Delete "$INSTDIR\QtXml4.dll"<br />
        Delete "$INSTDIR\QtGui4.dll"<br />
        Delete "$INSTDIR\QtCore4.dll"<br />
        Delete "$INSTDIR\mfc42loc.dll"<br />
        Delete "$INSTDIR\MTScc.dll"<br />
        Delete "$INSTDIR\MTHelpViewer.dll"<br />
        Delete "$INSTDIR\MTAbout.dll"<br />
        Delete "$INSTDIR\MTGrid.dll"<br />
        Delete "$INSTDIR\MTResManager.dll"<br />
        Delete "$INSTDIR\TDSLib.dll"<br />
        Delete "$INSTDIR\TDSParseDLL.dll"<br />
        Delete "$INSTDIR\TDSParseDLL_Unicode.dll"<br />
        Delete "$INSTDIR\TDSOutput.dll"<br />
        Delete "$INSTDIR\Trace.dll"<br />
        Delete "$INSTDIR\TDSImportInterface.dll"<br />
        Delete "$INSTDIR\olexlsf.tlh"<br />
        Delete "$INSTDIR\olexlsf.tli"<br />
        Delete "$INSTDIR\olexlsf.dll"<br />
        Delete "$INSTDIR\TDSProg.exe"<br />
        Delete "$INSTDIR\olexlsf.dll"<br />
        Delete "$INSTDIR\makedlu.exe"<br />
        Delete "$INSTDIR\tar.exe"<br />
        Delete "$INSTDIR\gzip.exe"<br />
        Delete "$INSTDIR\zip.exe"<br />
        Delete "$INSTDIR\temp\exportFile.xls"<br />
        Delete "$INSTDIR\TDSXMLExportPlugin.dll"<br />
        <br />
        <br />
        Delete "$SMPROGRAMS\MITRAC Tool Suite\MITRAC CC TDS-PROG\Uninstall.lnk"<br />
        Delete "$DESKTOP\TDS-PROG Tool.lnk"<br />
        Delete "$SMPROGRAMS\MITRAC Tool Suite\MITRAC CC TDS-PROG\TDS-PROG Tool.lnk"<br />
        Delete "$SMPROGRAMS\MITRAC Tool Suite\MITRAC CC TDS-PROG\TDS User Manual-Engineering.lnk"<br />
        Delete "$SMPROGRAMS\MITRAC Tool Suite\MITRAC CC TDS-PROG\TDS User Manual-EndCustomer.lnk"<br />
        Delete "$SMPROGRAMS\MITRAC Tool Suite\MITRAC CC TDS-PROG\TDS User Guide.lnk"<br />
        Delete "$SMPROGRAMS\MITRAC Tool Suite\MITRAC CC TDS-PROG\TDS Release Notes.lnk"<br />
        <br />
        <br />
        RMDir "$SMPROGRAMS\MITRAC Tool Suite\TDS-PROG2"<br />
        RMDir "$INSTDIR\help\en\HelpEnglish_files"<br />
        RMDir "$INSTDIR\help\en_ecm\HelpEnglish_files"<br />
        RMDir "$INSTDIR\help\en_ecm"<br />
        RMDir "$INSTDIR\help\en"<br />
        RMDir "$INSTDIR\help"<br />
        RMDir "$INSTDIR\temp"<br />
        RMDir "$INSTDIR"<br />
        <br />
        DeleteRegKey ${PRODUCT_UNINST_ROOT_KEY} "${PRODUCT_UNINST_KEY}"<br />
        DeleteRegKey HKLM "${PRODUCT_DIR_REGKEY}"<br />
        DeleteRegKey HKCR "mdpfile\DefaultIcon"<br />
        DeleteRegKey HKCR "mdpfile\shell\Open\command"<br />
        DeleteRegKey HKCR "mdpfile\shell\Open"<br />
        DeleteRegKey HKCR "mdpfile\shell\Generate\command"<br />
        DeleteRegKey HKCR "mdpfile\shell\Generate"<br />
        DeleteRegKey HKCR "mdpfile\shell\Clean\command"<br />
        DeleteRegKey HKCR "mdpfile\shell\Clean"<br />
        DeleteRegKey HKCR "mdpfile\shell"<br />
        SetAutoClose true<br />
        SectionEnd
      </blockquote>Regards,<br />
      -Priyanka
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">MSG</span><br />
      <span class="post-time small text-muted">13th April 2012 17:22 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">PLEASE use pastebin or an attachment for such huge amounts of code. ~_~<br />
      <br />
      Yes, you can do both install and uninstall in one section, using the very simple code I gave you. Make sure that the default value of $variable is set to install, in case the installer skips the install/uninstall/reinstall page.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
      <span class="post-time small text-muted">13th April 2012 18:00 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Also switch to MUI2.nsh (as you are using nsDialogs).<br />
      <br />
      Stu</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">priyankaB</span><br />
      <span class="post-time small text-muted">17th April 2012 06:23 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">The fix you gave me didn't work and now the uninstall is behaving in a weird manner.<br />
      May be my way of implementing the same is wrong.:(<br />
      Could you please check and verify. I have attached the script with this post.<br />
      <br />
      -Priyanka</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">MSG</span><br />
      <span class="post-time small text-muted">17th April 2012 06:36 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Why are you calling the uninstaller? You can just as simply uninstall the previous version directly from your install section.</p>
    </div>
    <hr />

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]>
  </script>
</body>
</html>
