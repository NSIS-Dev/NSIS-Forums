<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="Check boxes not working" />

  <title>Check boxes not working - NSIS Forums</title><!-- Bootstrap core CSS -->
  <link rel="stylesheet" type="text/css" href="//netdna.bootstrapcdn.com/bootswatch/3.0.1/readable/bootstrap.min.css" />
  <link rel="stylesheet" href="../css/style.css" type="text/css" /><!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!--[if lt IE 9]>
                <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
                <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->
</head>

<body>
  <div class="container">
    <!-- Put navigation bar here -->

    <ol class="breadcrumb">
      <li><a href="../index.html" class="glyphicon glyphicon-home"></a></li>

      <li><a href="f-65.html">NSIS Discussion</a></li>

      <li class="active">Check boxes not working</li>
    </ol>

    <p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=237444">Check boxes not working</a></p><br />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Mike U</span><br />
      <span class="post-time small text-muted">7th February 2006 21:01 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>Check boxes not working</strong><br />
      Hi,<br />
      <br />
      I have tried several scripts with checkboxes including the one below. For some reason when the checkbox is checked, the functions associated with the checkbox are not running.<br />
      Any Ideas??<br />
      <br />
      <br />
      ;Pages<br />
      !insertmacro MUI_PAGE_WELCOME<br />
      !insertmacro MUI_PAGE_LICENSE $(MUILicense)<br />
      !insertmacro MUI_PAGE_COMPONENTS<br />
      !insertmacro MUI_PAGE_DIRECTORY<br />
      !insertmacro MUI_PAGE_INSTFILES<br />
      ; Finish page<br />
      CheckBitmap "${NSISDIR}\Contrib\Graphics\Checks\aquachecks.bmp"<br />
      !define MUI_FINISHPAGE_RUN<br />
      !define MUI_FINISHPAGE_RUN_NOTCHECKED<br />
      !define MUI_FINISHPAGE_RUN_TEXT "Edit Agent.ini Configuration File"<br />
      !define MUI_FINISHPAGE_RUN_FUNCTION "runfile"<br />
      !define MUI_FINISHPAGE_SHOWREADME<br />
      !define MUI_FINISHPAGE_SHOWREADME_NOTCHECKED<br />
      !define MUI_FINISHPAGE_SHOWREADME_TEXT "Edit Default.txt Configuraton File"<br />
      !define MUI_FINISHPAGE_SHOWREADME_FUNCTION "runfile2"<br />
      <br />
      Function "runfile"<br />
      ExecWait "$INSTDIR\${PROJ_NAME}Agent.ini"<br />
      FunctionEnd<br />
      <br />
      Function "runfile2"<br />
      ExecWait "$INSTDIR\${PROJ_NAME}default.txt"<br />
      FunctionEnd<br />
      <br />
      !define MUI_PAGE_CUSTOMFUNCTION_PRE PreFinishPage<br />
      !define MUI_PAGE_CUSTOMFUNCTION_SHOW ShowFinishPage<br />
      !define MUI_PAGE_CUSTOMFUNCTION_LEAVE LeaveFinishPage<br />
      <br />
      Function PreFinishPage<br />
      !insertmacro MUI_INSTALLOPTIONS_WRITE "ioSpecial.ini" "Settings" "NumFields" "6"<br />
      !insertmacro MUI_INSTALLOPTIONS_WRITE "ioSpecial.ini" "Field 6" "Type" "CheckBox"<br />
      !insertmacro MUI_INSTALLOPTIONS_WRITE "ioSpecial.ini" "Field 6" "Text" "Start ${PROJ_NAME} Service"<br />
      !insertmacro MUI_INSTALLOPTIONS_WRITE "ioSpecial.ini" "Field 6" "Left" "120"<br />
      !insertmacro MUI_INSTALLOPTIONS_WRITE "ioSpecial.ini" "Field 6" "Right" "315"<br />
      !insertmacro MUI_INSTALLOPTIONS_WRITE "ioSpecial.ini" "Field 6" "Top" "130"<br />
      !insertmacro MUI_INSTALLOPTIONS_WRITE "ioSpecial.ini" "Field 6" "Bottom" "140"<br />
      !insertmacro MUI_INSTALLOPTIONS_WRITE "ioSpecial.ini" "Field 6" "State" "0"<br />
      ;line above: Initial state of the control: 0=Unchecked, 1=Checked<br />
      FunctionEnd<br />
      <br />
      Function ShowFinishPage<br />
      GetDlgItem $MUI_TEMP1 $MUI_HWND 1205 ;ID for the 6th InstallOptions control<br />
      SetCtlColors $MUI_TEMP1 "" "${MUI_BGCOLOR}"<br />
      FunctionEnd<br />
      <br />
      Function LeaveFinishPage<br />
      !insertmacro MUI_INSTALLOPTIONS_READ $MUI_TEMP1 "ioSpecial.ini" "Field 6" "State"<br />
      StrCmp $MUI_TEMP1 1 Checked Unchecked<br />
      Checked: nsSCM::start /NOUNLOAD "${PROJ_NAME}"<br />
      Goto end<br />
      Unchecked:<br />
      end:<br />
      FunctionEnd<br />
      <br />
      !insertmacro MUI_PAGE_FINISH<br />
      !insertmacro MUI_UNPAGE_CONFIRM<br />
      !insertmacro MUI_UNPAGE_COMPONENTS<br />
      !insertmacro MUI_UNPAGE_INSTFILES</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">dienjd</span><br />
      <span class="post-time small text-muted">7th February 2006 23:03 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Have you tried adding another command to your "Checked" label? There's only one command there, so do you know for sure that there's not a problem with that plugin?<br />
      <br />
      Suggestion:<br />
      ...<br />
      Checked:<br />
      MessageBox MB_OK "checkbox state is ${MUI_TEMP1}"<br />
      nsSCM::start /NOUNLOAD "${PROJ_NAME}"<br />
      Goto end<br />
      ...<br />
      <br />
      If the debug message box displays, then the problem is probably with the plugin call. If not, then the state of the checkbox must not be getting read correctly.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Mike U</span><br />
      <span class="post-time small text-muted">8th February 2006 14:39 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">I have it working now. I forgot the back slash before the files:<br />
      <br />
      Function "runfile"<br />
      ExecWait "$INSTDIR\${PROJ_NAME}<font color="red">\</font>Agent.ini"<br />
      FunctionEnd<br />
      <br />
      Function "runfile2"<br />
      ExecWait "$INSTDIR\${PROJ_NAME}<font color="red">\</font>default.txt"<br />
      FunctionEnd<br />
      <br />
      <br />
      Ahhh the simple things!<br />
      <br />
      A problem I am still having is the 3rd checkbox is to start a service if checked. I have confirmed the check box works properly, but the nsSCM::start /NOUNLOAD "${FILE_NAME}" does not start the service.<br />
      <br />
      I install the service else where in the install as below and it works properly. Why won't the service start? I can also start it manually within the SCM with no problems.<br />
      <br />
      nsSCM::Install /NOUNLOAD "${FILE_NAME}" "${FILE_NAME} service" 16 3 \<br />
      "$INSTDIR\${FILE_NAME}\${FILE_EXEC} /service" "" "" "" ""</p>
    </div>
    <hr />

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]>
  </script>
</body>
</html>
