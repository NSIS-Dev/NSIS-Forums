<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="description" content="Problem with uninstaller (removing itself)"><title>Problem with uninstaller (removing itself) - NSIS Forums</title><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script><link rel="preload" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css" as="style" onload="this.rel='stylesheet'"><link rel="preload" href="../css/style.css" as="style" onload="this.rel='stylesheet'"><noscript><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css"><link rel="stylesheet" href="../css/style.css"></noscript><script>!function(a){"use strict";var b=function(b,c,d){function e(a){return h.body?a():void setTimeout(function(){e(a)})}function f(){i.addEventListener&&i.removeEventListener("load",f),i.media=d||"all"}var g,h=a.document,i=h.createElement("link");if(c)g=c;else{var j=(h.body||h.getElementsByTagName("head")[0]).childNodes;g=j[j.length-1]}var k=h.styleSheets;i.rel="stylesheet",i.href=b,i.media="only x",e(function(){g.parentNode.insertBefore(i,c?g:g.nextSibling)});var l=function(a){for(var b=i.href,c=k.length;c--;)if(k[c].href===b)return a();setTimeout(function(){l(a)})};return i.addEventListener&&i.addEventListener("load",f),i.onloadcssdefined=l,l(f),i};"undefined"!=typeof exports?exports.loadCSS=b:a.loadCSS=b}("undefined"!=typeof global?global:this);!function(a){if(a.loadCSS){var b=loadCSS.relpreload={};if(b.support=function(){try{return a.document.createElement("link").relList.supports("preload")}catch(b){return!1}},b.poly=function(){for(var b=a.document.getElementsByTagName("link"),c=0;c<b.length;c++){var d=b[c];"preload"===d.rel&&"style"===d.getAttribute("as")&&(a.loadCSS(d.href,d,d.getAttribute("media")),d.rel=null)}},!b.support()){b.poly();var c=a.setInterval(b.poly,300);a.addEventListener&&a.addEventListener("load",function(){b.poly(),a.clearInterval(c)}),a.attachEvent&&a.attachEvent("onload",function(){a.clearInterval(c)})}}}(this);</script></head><body><div class="container"><ol class="breadcrumb"><li><a href="../index.html" class="glyphicon glyphicon-home"></a></li><li><a href="f-65.html">NSIS Discussion</a></li><li class="active">Problem with uninstaller (removing itself)</li></ol><p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=332012">Problem with uninstaller (removing itself)</a></p><br><div class="post"><p class="post-meta"><span class="post-author text-primary">DubFX</span><br><span class="post-time small text-muted">29th June 2011 17:57 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>Problem with uninstaller (removing itself)</strong><br>Hi guys,<br><br>I have troubles with my uninstaller.<br>When started it removes all files of $PROGRAMFILES\MyApp and should delete itself and the dir afterwards.<br><br>Now the strange thing ist: The uninstaller does remove itself in a strange way:<br><br>It removes itself, but Windows7 (x64) doesn't recognize this for approx 30 seconds. So the uninstaller fails on removing the directory because it <b>seems not</b> be empty.<br>20-30 seconds after the uninstaller finished the uninstaller is gone in windows explorer view as well. (Refresh doesn't help, but if I try to start the uninstaller again in this period windows says that the file isn't existing.)<br><br>So my trouble is that I can't remove the folder from my uninstaller.<br><br>I see this behaviour only on x64. The same thing on x86 is working as expected.<br>It is not related to $PROGRAMFILES/$PROGRAMFILES32/64 or something, the uninstaller reads the path and files to delete from the registry.<br><br>I already tried to set the uninstaller to $TEMP because it is locking itself? But it didn't help<br><br>Function un.onInit<br>SetOutPath "$TEMP"<br>ClearErrors<br>FunctionEnd<br><br>Thanks in advance from a clueless beginner!<br><br>DubFX</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">drovsky</span><br><span class="post-time small text-muted">9th July 2011 00:39 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">i'm guessing you might have an "error" in the order of the unintall operations, first you make everythin you have to do before the delete/rmdir instructions, and most important, if you are using any EXC instruction in the uninstall, replace it for ExecWait, in this way it will take longer to proced with the actions, but you have ensure that no deleting file is being used in any operation when you make de delete/rmdir instruction</p></div><hr><div class="footer"><p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p></div></div><script src="../js/highlight.pack.js" type="text/javascript"></script><script type="text/javascript">//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]></script></body></html>