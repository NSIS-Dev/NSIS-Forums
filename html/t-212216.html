<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="description" content="Making Desktop Shortcut Optional"><title>Making Desktop Shortcut Optional - NSIS Forums</title><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script><link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css"><link rel="stylesheet" href="../css/style.css" type="text/css"><!--[if lt IE 9]><script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script><script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script><![endif]--></head><body><div class="container"><ol class="breadcrumb"><li><a href="../index.html" class="glyphicon glyphicon-home"></a></li><li><a href="f-65.html">NSIS Discussion</a></li><li class="active">Making Desktop Shortcut Optional</li></ol><p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=212216">Making Desktop Shortcut Optional</a></p><br><div class="post"><p class="post-meta"><span class="post-author text-primary">JWood</span><br><span class="post-time small text-muted">4th April 2005 03:25 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>Making Desktop Shortcut Optional</strong><br>I have a very simple script generated by the HM NIS Wizards (no selectable components or anything like that).<br><br>I works well but I would like the creation of a desktop shortcut to be optional. Right now, it creates a desktop shortcut, which I like. But the user should have the choice of not creating one.<br><br>Does anyone have some simple code for making this process optional?<br><br>Thanks.<br><br>Jonathan</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">hesung</span><br><span class="post-time small text-muted">4th April 2005 05:23 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Add one Section to be selected..<br><br>Section /o "Wanna a destop shortcut"<br>CreateShortCut "$DESKTOP\ShortcutName.lnk" "$INSTDIR\AimName.exe"<br><br>SectionEnd<br><br><br>;;---If the user wanna one, he|her can selete it.<br><br><br>I don't think using HM NIS Wizards is a good idea..The simple is too simple..</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">hesung</span><br><span class="post-time small text-muted">4th April 2005 05:34 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Donnot forget to insert this Page Macro in the Page Options<br><br>!insertmacro MUI_PAGE_COMPONENTS<br><br>If using the HM_NIS you can select the Checkbox"Allow user to select the componnents to install" to add the code<br>......<br>Then add the section.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">JWood</span><br><span class="post-time small text-muted">4th April 2005 21:31 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Thanks, but then the user has the option of not installing the main program files. Also, I really don't care for the layout of the page where you select components. It it hard to add an option or a new page with an option to install the desktop shortcut?<br><br>Thanks.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">glory_man</span><br><span class="post-time small text-muted">5th April 2005 10:16 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"></p><blockquote>Thanks, but then the user has the option of not installing the main program files.</blockquote>You can set "read-only"-attrib for section (include SectionIn R0 inside section) -&gt; user won't be able to change its state.<br><br>Or you can create checkbox on finishpage named "Create desktop shortcut". Example for MUI may be like this:<br><pre>
<code><br>!define MUI_FINISHPAGE_RUN<br>!define MUI_FINISHPAGE_RUN_TEXT "Create desktop shortcut"<br>!define MUI_FINISHPAGE_RUN_FUNCTION "myfunction"<br><br>Function "myfunction"<br>CreateShortCut "$DESKTOP\My_programm.lnk" "$INSTDIR\proga.exe"<br>FunctionEnd<br></code>
</pre>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">glory_man</span><br>
      <span class="post-time small text-muted">5th April 2005 10:49 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">And question by <a href="http://forums.winamp.com/showthread.php?s=&amp;threadid=212298" target="_blank">this</a> thread.<br></p>

      <blockquote>
        The SectionIn RO works but doesn't look right for me.
      </blockquote>Why not?<br>
      <br>
      <br>
      This code will also help you to show the "main programm files"-section as enabled but the user will not be able to modify its state (without setting "read-only"-attrib for section).<br>
      <pre>
<code><br>Function .onSelChange<br>   SectionGetFlags ${SecIndex} $R0<br>   IntOp $R1 $R0 &amp; 0x0001<br>   IntCmp $R0 1 sekok<br>      IntOp $R1 $R0 | 0x0001<br>      SectionSetFlags ${SecIndex} $R1<br>   sekok:<br>FunctionEnd<br></code>
</pre>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">JWood</span><br>
      <span class="post-time small text-muted">5th April 2005 19:39 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Yeah, I think it might look better not being grayed out. However, it still seems funky to me have a screen that asks the user to choose program elements to install and there are only two items, and only one of those items can be modified, and that item doesn't really relate to installing program elements.<br>
      <br>
      From a user-interface standpoint, it seems that it would be far more reasonable to simply display a single checkbox that specifies if a desktop shortcut should be created.<br>
      <br>
      There may be different opinions but I've been programming a long time and that's my opinion.<br>
      <br>
      I'm trying to figure out how to add the checkbox but the docs are seeming pretty lean to me. (Neither custom nor InstallOptions are even in the help index.)<br>
      <br>
      Thanks.</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br>
      <span class="post-time small text-muted">5th April 2005 19:58 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Read <i>glory_man</i> post 3 posts up.<br>
      He has attached code to add a "Create desktop shortcut" check-box to the MUI Finish page.<br>
      <br>
      -Stu</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">JWood</span><br>
      <span class="post-time small text-muted">5th April 2005 20:26 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"></p>

      <blockquote>
        <i>Originally posted by Afrow UK</i><br>
        <b>Read <i>glory_man</i> post 3 posts up.<br>
        He has attached code to add a "Create desktop shortcut" check-box to the MUI Finish page.<br>
        <br>
        -Stu</b>
      </blockquote>Could I get some sort of clue as to which post you are referring to. I'm using my browser to view these posts. As soon as you replied, this thread went to the top of the list so there is no "3 posts up."<br>
      <br>
      And I couldn't find anything with a subject similar to "add a "Create desktop shortcut" check-box to the MUI Finish page."<br>
      <br>
      Sounds like just what I need. Something to go on? Please.
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Pidgeot</span><br>
      <span class="post-time small text-muted">5th April 2005 22:36 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">A post is not the same as a thread. When Afrow says "3 posts up", he means 3 posts above his in this thread.<br>
      <br>
      The code he's referring to is this:<br></p>
      <pre>
<code>!define MUI_FINISHPAGE_RUN<br>!define MUI_FINISHPAGE_RUN_TEXT "Create desktop shortcut"<br>!define MUI_FINISHPAGE_RUN_FUNCTION "myfunction"<br><br>Function "myfunction"<br>CreateShortCut "$DESKTOP\My_programm.lnk" "$INSTDIR\proga.exe"<br>FunctionEnd</code>
</pre><br>
      <br>
      If you need MUI_FINISHPAGE_RUN for something else, you can use a messagebox:<br>
      <br>
      <pre>
<code>MessageBox MB_YESNO|MB_ICONQUESTION "Create desktop shortcut?" IDNO +2<br>CreateShortCut "$DESKTOP\My Program.lnk" "$INSTDIR\program.exe"<br></code>
</pre><br>
      <br>
      Place it in an appropriate section of your installer.
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">JWood</span><br>
      <span class="post-time small text-muted">5th April 2005 23:01 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"></p>

      <blockquote>
        <i>Originally posted by Pidgeot</i><br>
        <b>A post is not the same as a thread. When Afrow says "3 posts up", he means 3 posts above his in this thread.</b>
      </blockquote>Doh! How right you are. My apologies to both you and "Afrow UK". I'm used to using Outlook Express for this type of stuff and just missed those comments.<br>
      <br>
      Thanks!
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">JWood</span><br>
      <span class="post-time small text-muted">5th April 2005 23:02 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"></p>

      <blockquote>
        <i>Originally posted by glory_man</i><br>
        Or you can create checkbox on finishpage named "Create desktop shortcut". Example for MUI may be like this:<br>
        <pre>
<code><br>!define MUI_FINISHPAGE_RUN<br>!define MUI_FINISHPAGE_RUN_TEXT "Create desktop shortcut"<br>!define MUI_FINISHPAGE_RUN_FUNCTION "myfunction"<br><br>Function "myfunction"<br>CreateShortCut "$DESKTOP\My_programm.lnk" "$INSTDIR\proga.exe"<br>FunctionEnd<br></code>
</pre>[/B]
      </blockquote>I apologize for completely missing these comments the first time around. I've got this code working and just trying to decide if that's the way I'll go. Either way, it was an excellent suggestion. Thanks a million!
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">glory_man</span><br>
      <span class="post-time small text-muted">6th April 2005 10:14 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">As I can <a href="http://forums.winamp.com/showthread.php?s=&amp;threadid=212299" target="_blank">see</a> JWood uses MUI_FINISHPAGE_RUN. So defines-code can be modified to the next:<br></p>
      <pre>
<code><br>!define MUI_FINISHPAGE_SHOWREADME<br>!define MUI_FINISHPAGE_SHOWREADME_TEXT "Create desktop shortcut"<br>!define MUI_FINISHPAGE_SHOWREADME_FUNCTION "myfunction"</code>
</pre>
    </div>
    <hr>

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]></script></body></html>