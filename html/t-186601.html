<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="Sample script for a newbie" />

  <title>Sample script for a newbie - NSIS Forums</title><!-- Bootstrap core CSS -->
  <link rel="stylesheet" type="text/css" href="//netdna.bootstrapcdn.com/bootswatch/3.0.1/readable/bootstrap.min.css" />
  <link rel="stylesheet" href="../css/style.css" type="text/css" /><!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!--[if lt IE 9]>
                <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
                <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->
</head>

<body>
  <div class="container">
    <!-- Put navigation bar here -->

    <ol class="breadcrumb">
      <li><a href="../index.html" class="glyphicon glyphicon-home"></a></li>

      <li><a href="f-65.html">NSIS Discussion</a></li>

      <li class="active">Sample script for a newbie</li>
    </ol>

    <p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=186601">Sample script for a newbie</a></p><br />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">joelupo</span><br />
      <span class="post-time small text-muted">14th July 2004 22:51 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>Sample script for a newbie</strong><br />
      I know this is quite simple, but I have a problem with scripts and an example would help me a lot. I installed Venis.<br />
      <br />
      I need a sample script that does the following:<br />
      <br />
      Check if install, update or uninstall.<br />
      <br />
      ModernUI with multi-languages<br />
      <br />
      Install : check for admin rights, ask for a data directory, ask for a program directory, modify the ini file, place the ini file into the default windows directory,create folder, create shortcuts, copy 5 files (4 exe and one dll), regsvr the dll, place file1.exe into the registry to run at startup, start file1 and ask if file2.exe should be run.<br />
      <br />
      Update: stop file1.exe, regsvr -u the dll, replace all files with the new version, regsvr the dll, restart file1.exe<br />
      <br />
      Uninstall: stop the file1.exe, regsvr -u the dll, remove all registry keys, remove the program directory, ask if data directory should be deleted.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">zimsms</span><br />
      <span class="post-time small text-muted">15th July 2004 07:05 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">There are tons of examples in the NSIS distribution. There are also examples in the NSIS Archive.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">joelupo</span><br />
      <span class="post-time small text-muted">15th July 2004 08:05 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Dear zimsms, I am aware that there are a lot of examples in the archive and the distribution, thank you for your incredible astuteness.<br />
      <br />
      I am not a programmer and am running around trying to solve a number of problems at the same time. To learn a new script language just takes away time that I dont have.<br />
      <br />
      Thus the help of some Senior Member, who in a couple of minutes could either point me to the right script or paste me a sample script, would help me a great deal.<br />
      <br />
      Thanks for your help anyway</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
      <span class="post-time small text-muted">15th July 2004 11:01 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">It's not that simple to just 'create' the code for you. If you want what you ask done (which will take some time) you should really do it yourself.<br />
      We can point you out to various things, but I really doubt anyone will want to write you a whole script (and the Install Options dialogue to go with it).<br />
      <br />
      You say that you need two directories to be inputted by the user - This would require an InstallOptions dialogue to be created (see NSIS\Contrib\InstallOptions).<br />
      <br />
      There are no scripts that do exactly as you ask (all installers are unique, none do exactly the same thing), but there will be code in examples that can be modified to do the individual tasks.<br />
      <br />
      Rather than thinking of it as 'one big job' try breaking it down into steps. This is how a programmer works - he/she does not do the whole thing in one go (that would not be possible!)<br />
      <br />
      If you really need to make this installer badly, then again you must do it with your own free will. I don't ask people to write my software or computer games. I have to make them myself along with the help of others if necessary!<br />
      <br />
      NSIS has everything that you need. If you want to find a certain code element, you just need to search the NSIS documentation (NSIS.chm) and you should be going in no time. If you want to ask for help on parts, then we can help you.<br />
      <br />
      -Stu</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">joelupo</span><br />
      <span class="post-time small text-muted">15th July 2004 11:14 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Thanks STu<br />
      <br />
      I basically got everything going except for the part where I run the regsvr of a dll (and also regsvr -u) and the addidition of the registry key under windows "run" for the autostart. How do I add these to the script.<br />
      <br />
      Thanks</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">VegetaSan</span><br />
      <span class="post-time small text-muted">15th July 2004 13:09 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">For registrating/unregistrating files and writing a key to "run" ..you need to use this code:<br />
      <br /></p>
      <pre>
<code><br /><br />Section<br />;registrating<br />RegDll "$VARIABLE\file.ext"<br />;unregistrating<br />UnRegDLL "$VARIABLE\file.ext"<br />;now writing the damn register key<br />WriteRegStr HKLM "Software\Microsoft\Windows\Run" "Appilication" "$VARIABLE\file.ect"<br /><br />SectionEnd<br /></code>
</pre><br />
      <br />
      <b>NOTE: if you write that key to "run" then it will automaticly be checked in "msconfig.exe" under startup</b><br />
      <br />
      you need to replace $VARIABLE to the path that the file is located here are those variables:<br />
      <br />
      <font size="1">$PROGRAMFILES<br />
      The program files directory (usually C:\Program Files but detected at runtime).<br />
      <br />
      $COMMONFILES<br />
      The common files directory. This is a directory for components that are shared across applications (usually C:\Program Files\Common Files but detected at runtime).<br />
      <br />
      $DESKTOP<br />
      The windows desktop directory (usually C:\windows\desktop but detected at runtime). The context of this constant (All Users or Current user) depends on the SetShellVarContext setting. The default is the current user.<br />
      <br />
      $EXEDIR<br />
      The location of the installer executable. (technically you can modify this variable, but it is probably not a good idea)<br />
      <br />
      ${NSISDIR}<br />
      A symbol that contains the path where NSIS is installed. Detected at compile time. Useful if you want to call resources that are in NSIS directory e.g. Icons, UIs...<br />
      <br />
      $WINDIR<br />
      The windows directory (usually C:\windows or C:\winnt but detected at runtime)<br />
      <br />
      $SYSDIR<br />
      The windows system directory (usually C:\windows\system or C:\winnt\system32 but detected at runtime)<br />
      <br />
      $TEMP<br />
      The system temporary directory (usually C:\windows\temp but detected at runtime)<br />
      <br />
      $STARTMENU<br />
      The start menu folder (useful in adding start menu items using CreateShortCut). The context of this constant (All Users or Current user) depends on the SetShellVarContext setting. The default is the current user.<br />
      <br />
      $SMPROGRAMS<br />
      The start menu programs folder (use this whenever you want $STARTMENU\Programs). The context of this constant (All Users or Current user) depends on the SetShellVarContext setting. The default is the current user.<br />
      <br />
      $SMSTARTUP<br />
      The start menu programs / startup folder. The context of this constant (All Users or Current user) depends on the SetShellVarContext setting. The default is the current user.<br />
      <br />
      $QUICKLAUNCH<br />
      The quick launch folder for IE4 active desktop and above. If quick launch is not available, simply returns the same as $TEMP.<br />
      <br />
      $DOCUMENTS<br />
      The documents directory. A typical path for the current user is C:\Documents and Settings\Foo\My Documents. The context of this constant (All Users or Current user) depends on the SetShellVarContext setting. The default is the current user.<br />
      <br />
      $SENDTO<br />
      The directory that contains Send To menu shorcut items.<br />
      <br />
      $RECENT<br />
      The directory that contains shortcuts to the user's recently used documents.<br />
      <br />
      $FAVORITES<br />
      The directory that contains shortcuts to the user's favorite websites, documents, etc. The context of this constant (All Users or Current user) depends on the SetShellVarContext setting. The default is the current user.<br />
      <br />
      $MUSIC<br />
      The user's music files directory. The context of this constant (All Users or Current user) depends on the SetShellVarContext setting. The default is the current user.<br />
      <br />
      $PICTURES<br />
      The user's picture files directory. The context of this constant (All Users or Current user) depends on the SetShellVarContext setting. The default is the current user.<br />
      <br />
      $VIDEOS<br />
      The user's video files directory. The context of this constant (All Users or Current user) depends on the SetShellVarContext setting. The default is the current user.<br />
      <br />
      $NETHOOD<br />
      The directory that contains link objects that may exist in the My Network Places/Network Neighborhood folder.<br />
      <br />
      $FONTS<br />
      The system's fonts directory.<br />
      <br />
      $TEMPLATES<br />
      The document templates directory. The context of this constant (All Users or Current user) depends on the SetShellVarContext setting. The default is the current user.<br />
      <br />
      $APPDATA<br />
      The application data directory. Detection of the current user path requires Internet Explorer 4 and above. Detection of the all users path requires Internet Explorer 5 and above. The context of this constant (All Users or Current user) depends on the SetShellVarContext setting. The default is the current user.<br />
      <br />
      $PRINTHOOD<br />
      The directory that contains link objects that may exist in the Printers folder.<br />
      <br />
      $INTERNET_CACHE<br />
      Internet Explorer's temporary internet files directory.<br />
      <br />
      $COOKIES<br />
      Internet Explorer's cookies directory.<br />
      <br />
      $HISTORY<br />
      Internet Explorer's history directory.<br />
      <br />
      $PROFILE<br />
      The user's profile directory. A typical path is C:\Documents and Settings\Foo.<br />
      <br />
      $ADMINTOOLS<br />
      A directory where administrative tools are kept. The context of this constant (All Users or Current user) depends on the SetShellVarContext setting. The default is the current user.<br />
      <br />
      $RESOURCES<br />
      The resources directory that stores themes and other Windows resources (usually C:\Windows\Resources but detected at runtime)<br />
      <br />
      $RESOURCES_LOCALIZED<br />
      The localized resources directory that stores themes and other Windows resources (usually C:\Windows\Resources\1033 but detected at runtime)<br />
      <br />
      $CDBURN_AREA<br />
      A directory where files awaiting to be burned to CD are stored.<br />
      <br />
      $HWNDPARENT<br />
      The decimal HWND of the parent window.<br />
      <br />
      $PLUGINSDIR<br />
      The path to a temporary folder created upon the first usage of a plugin or a call to InitPluginsDir. This folder is automatically deleted when the installer exits. This makes this folder the ideal folder to hold INI files for InstallOptions, bitmaps for the splash plugin, or any other file that a plugin needs to work.<br /></font><br />
      <br />
      you can also see them in the manual under "variables"<br />
      <br />
      you can also use this : "$PROGRAMFILES\Folder\Folder2<br />
      this is the folder (in my case) "C:\program files\Folder\Folder2"
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">joelupo</span><br />
      <span class="post-time small text-muted">15th July 2004 13:19 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Thanks VegetaSan<br />
      <br />
      that already helps me a lot. Will post the complete script later.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Yathosho</span><br />
      <span class="post-time small text-muted">15th July 2004 13:26 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">no need to copy/paste when you can simply link to the <a href="http://nsis.sourceforge.net/Docs/Chapter4.html#4.2.3" target="_blank">manual</a></p>
    </div>
    <hr />

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]>
  </script>
</body>
</html>
