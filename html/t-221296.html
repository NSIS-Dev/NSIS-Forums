<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="description" content="Embedded Banner plug-in"><title>Embedded Banner plug-in - NSIS Forums</title><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script><link rel="preload" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css" as="style" onload="this.rel='stylesheet'"><link rel="preload" href="../css/style.css" as="style" onload="this.rel='stylesheet'"><noscript><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css"><link rel="stylesheet" href="../css/style.css"></noscript><script>!function(a){"use strict";var b=function(b,c,d){function e(a){return h.body?a():void setTimeout(function(){e(a)})}function f(){i.addEventListener&&i.removeEventListener("load",f),i.media=d||"all"}var g,h=a.document,i=h.createElement("link");if(c)g=c;else{var j=(h.body||h.getElementsByTagName("head")[0]).childNodes;g=j[j.length-1]}var k=h.styleSheets;i.rel="stylesheet",i.href=b,i.media="only x",e(function(){g.parentNode.insertBefore(i,c?g:g.nextSibling)});var l=function(a){for(var b=i.href,c=k.length;c--;)if(k[c].href===b)return a();setTimeout(function(){l(a)})};return i.addEventListener&&i.addEventListener("load",f),i.onloadcssdefined=l,l(f),i};"undefined"!=typeof exports?exports.loadCSS=b:a.loadCSS=b}("undefined"!=typeof global?global:this);!function(a){if(a.loadCSS){var b=loadCSS.relpreload={};if(b.support=function(){try{return a.document.createElement("link").relList.supports("preload")}catch(b){return!1}},b.poly=function(){for(var b=a.document.getElementsByTagName("link"),c=0;c<b.length;c++){var d=b[c];"preload"===d.rel&&"style"===d.getAttribute("as")&&(a.loadCSS(d.href,d,d.getAttribute("media")),d.rel=null)}},!b.support()){b.poly();var c=a.setInterval(b.poly,300);a.addEventListener&&a.addEventListener("load",function(){b.poly(),a.clearInterval(c)}),a.attachEvent&&a.attachEvent("onload",function(){a.clearInterval(c)})}}}(this);</script></head><body><div class="container"><ol class="breadcrumb"><li><a href="../index.html" class="glyphicon glyphicon-home"></a></li><li><a href="f-65.html">NSIS Discussion</a></li><li class="active">Embedded Banner plug-in</li></ol><p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=221296">Embedded Banner plug-in</a></p><br><div class="post"><p class="post-meta"><span class="post-author text-primary">Takhir</span><br><span class="post-time small text-muted">12th July 2005 19:18 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>Embedded Banner plug-in</strong><br>Plug-in shows image (bmp, jpeg, gif are supported) on the bottom of installer' page and plays sound (if necessary :) ). I know this is possible with custom page, may be such plug-in was even wrote earlier (I not found it in archive), but vbgunz' idea looked funny for me and I spent about hour merging 2 other plug-ins code (<a href="http://nsis.sourceforge.net/wiki/AdvSplash_with_gif_and_jpeg" target="_blank">NewAdvSplash</a> and <a href="http://nsis.sourceforge.net/wiki/Marquee_%28text_scroll%29" target="_blank">Marquee</a>). Tested on XP only.<br>'stop' entry point (call) is optional, plug-in can auto-destroy image on the dialog exit. Image is not clickable and it's position is fixed (dialog bottom). Result looks simple for usage (attached). If this will appear to be interesting, I'll create wiki page and upload VS project.<br>Link to file <a href="http://nsis.sourceforge.net/mediawiki/images/7/72/EBanner.zip" target="_blank">http://nsis.sourceforge.net/mediawik...72/EBanner.zip</a></p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Comperio</span><br><span class="post-time small text-muted">13th July 2005 01:23 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">This looks <b>very</b> promising.<br><br>I could even see using this to replace certain message boxes for things like "invalid directory" and such that get called during page leave functions.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Takhir</span><br><span class="post-time small text-muted">13th July 2005 07:19 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">In most cases only 3-rd version looks good. So the question - what features to add to the second build :) ?<br><br>1. Image auto-scale down if it is wider then page 'child dialog' (IMHO scale up may looks ugly). May be this is not important if NSIS dialog size is fixed (or how it works with fixed-size banners on the top of page?), but default dialog size in Windows depends on system font size.<br>2. /align=left or right.<br>3. Better auto-stop on page exit (+ IDABORT). Because I am not sure when Parent window receives WM_CLOSE, may be on the final exit only (plug-in paints on the 'child' dialog window inside parent one).<br>4. May be cross-page 'keep alive' instead of 'auto-stop' on the page change? If Parent window is the same during installation (and we attached plug-in to it's wndproc) it is possible to understand during wm_paint handling that old 'child' window was lost and to find new one. But I am not sure - INSTFILES looks the only good place for big banner.<br>4. And finally - what else?</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Takhir</span><br><span class="post-time small text-muted">13th July 2005 17:25 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><a href="http://nsis.sourceforge.net/mediawiki/images/7/72/EBanner.zip" target="_blank">EBanner plug-in</a> - version 0.2<br>Option /ALIGN={LEFT|RIGHT}<br>Image scale down (if it is too big).<br>Image may be changed without plug-in unload with next 'show' call. Empty string as file name ("") cleares image but not stops sound (if any). The same with 'play' entry point - empty sound file name stops playing (tested with 'winamp media file' :) )</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Comperio</span><br><span class="post-time small text-muted">14th July 2005 00:50 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"></p><blockquote>Image auto-scale down if it is wider then page 'child dialog' (IMHO scale up may looks ugly). May be this is not important if NSIS dialog size is fixed (or how it works with fixed-size banners on the top of page?), but default dialog size in Windows depends on system font size.</blockquote>Scaling images up or down both seem reasonable. But I also agree that scaling up makes images look ugly, so I can accept your approach. (My opinion is that utimately, the developer should have to take some responsibility to ensure that his/her installation make them looks good.)<br><br>One thing that might be cool would be a "fade-in/fade-out" effect for Windows 2000/XP. And along those same lines, perhaps a way to specify the transparency of the entire image. (Thinking along the lines of the AdvSplash plugin). Unfortunately, I'm not much of a full-fledged programmer, so I'll leave it up to whether or not this something you want to tackle.<br><br>Overall, I think this plugin is still very good.</div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Takhir</span><br><span class="post-time small text-muted">14th July 2005 09:31 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">IPicture interface I used in EBanner plug-in paints gif images with transparency ;)<br>Fade-in/out effectes in the AdvSplash based on the 'layered' window attributes, which looks not(?) applicable to child window. Or this not worked in my test and this is why I removed child window at all and now plugin paints directly on the installer page. AplhaBlend is posiible way, but I need to make it working with IPicture hdc. May be later...<br><a href="http://nsis.sourceforge.net/wiki/Embedded_Banner" target="_blank">wiki page</a></p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Takhir</span><br><span class="post-time small text-muted">14th July 2005 16:48 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Version 0.3 uses IImgCtx instead of IPicture to support more image formats. <a href="http://nsis.sourceforge.net/wiki/Embedded_Banner" target="_blank">Updated wiki page</a></p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">grahama</span><br><span class="post-time small text-muted">15th July 2005 00:46 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Wow Takhir :)<br>this is very cool...<br>I was using MSIBANNER, but this looks like a step up....<br>;<br>side note:<br>my girlfriend's brother just climbed to the top of Mt Elbrus located in Russian republics of Karachay-Cherkess and Kabardin-Balkar. Pictures were very cool...<br>g</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Comperio</span><br><span class="post-time small text-muted">15th July 2005 00:57 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Agreed. Very cool!</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Takhir</span><br><span class="post-time small text-muted">15th July 2005 07:06 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Thanks! May be sometimes animation will be supported as well :)</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">jtweather</span><br><span class="post-time small text-muted">29th April 2006 15:36 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Takhir, does the EBanner Plugin work with the InstallOptionsEx Plugin?<br><br>jtweather</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Takhir</span><br><span class="post-time small text-muted">14th May 2006 09:55 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Sorry, I was offline 2 weeks (1000 km bike trip ;) )<br>I guess Yes, AFAIK IOEx uses the same child window for extended controls set. Any case you can use /HWND= parameter to set target window.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">dienjd</span><br><span class="post-time small text-muted">27th June 2006 22:00 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Takhir,<br>I've noticed that images disappear when the installer window loses focus. Any ideas on preventing this?</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Takhir</span><br><span class="post-time small text-muted">28th June 2006 06:59 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">I re-tested last (ebanner.dll June 21, 2006) and previous version (February) on XP and 2003, both included examples (Example.nsi and FullBg.nsi), works correct. WM_PAINT should work both with focus and without this. What precisely you do? Script? Did you tested this on big display intervals (Sleep 10000) ?</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">dienjd</span><br><span class="post-time small text-muted">28th June 2006 18:03 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Takhir,<br>Sorry about that. I thought I was using a recent version of the plug-in, but I just re-downloaded, and the newest version does not have this problem :)</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">desga2</span><br><span class="post-time small text-muted">10th November 2007 18:17 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>png image not showed with the plugin.</strong><br>Hi all people,<br>I have problems to do work EBanner plugin in my Nsis script.<br>The png image isn't showed in preview page (second page) of my installer. This page is make with InstallOptions plugin as custom page.<br><br>If i use a bmp file without EBanner plugin preview image is showed but i like change the image to png file for less installer package size.<br><br>I think that i tried all possibles methods for showed preview image with EBanner plugin without positives results.<br><br>You can download the script files from here:<br><a href="http://two.xthost*******kmeleon/Themes/SkipStone.zip" target="_blank">http://two.xthost*******kmeleon/Themes/SkipStone.zip</a><br><br>Any help is welcome, thanks.</p></div><hr><div class="footer"><p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p></div></div><script type="text/javascript" src="../js/highlight.pack.js" async></script><script type="text/javascript">//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]></script></body></html>