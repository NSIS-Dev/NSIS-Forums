<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="bug report: bzip2 leads to 'corrupt' uninstallers" />

  <title>bug report: bzip2 leads to 'corrupt' uninstallers - NSIS Forums</title><!-- Bootstrap core CSS -->
  <link rel="stylesheet" type="text/css" href="//netdna.bootstrapcdn.com/bootswatch/3.0.1/readable/bootstrap.min.css" />
  <link rel="stylesheet" href="../css/style.css" type="text/css" /><!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!--[if lt IE 9]>
                <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
                <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->
</head>

<body>
  <div class="container">
    <!-- Put navigation bar here -->

    <ol class="breadcrumb">
      <li><a href="../index.html" class="glyphicon glyphicon-home"></a></li>

      <li><a href="f-65.html">NSIS Discussion</a></li>

      <li class="active">bug report: bzip2 leads to 'corrupt' uninstallers</li>
    </ol>

    <p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=149615">bug report: bzip2 leads to 'corrupt' uninstallers</a></p><br />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">psyke</span><br />
      <span class="post-time small text-muted">18th September 2003 06:16 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>bug report: bzip2 leads to 'corrupt' uninstallers</strong><br />
      Hello. :)<br />
      <br />
      I believe I have found a bug with bzip2 compression. (I'm using the latest nightly snapshot). I certainly hope it's a bug, otherwise something is really messed up for me. ;)<br />
      <br />
      Basically, when using bzip2 compression, everything seems to work wonderfully (although the compression doesn't seem all that great but maybe it's my installer data... anyway) except when one goes to uninstall, one is greeted with the dreaded dialog:<br />
      <br /></p>

      <blockquote>
        ---------------------------<br />
        NSIS ERROR<br />
        ---------------------------<br />
        Installer corrupted or incomplete.<br />
        <br />
        This could be the result of a failed download or corruption from a virus.<br />
        <br />
        If desperate, try the /NCRC command line switch (NOT recommended)<br />
        OK
      </blockquote>First I thought it was my fault, but then I found the same thing occurs with Example2.nsi (${NSISDIR}\Examples\Example2.nsi). Without bzip, everything works fine, including uninstall, and with bzip2 the uninstaller is corrupt. I've attached two differently compiled versions of Example2.nsi for you to test.<br />
      <br />
      I hope this information is helpful and that the problem can be resolved. :)<br />
      <br />
      salaam/peace<br />
      <br />
      (this attachment has the crashing example2 - the next post has the one that's fine. i had to split them because one attachment with both was too big.)
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">psyke</span><br />
      <span class="post-time small text-muted">18th September 2003 06:17 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">and here's the working example2, compiled without bzip compression.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
      <span class="post-time small text-muted">18th September 2003 15:03 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Which version of makensis.exe are you using? Open CVS\Entries and look for a number such as 1.241 in the makensis.exe line.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">psyke</span><br />
      <span class="post-time small text-muted">18th September 2003 16:18 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Short answer: <b>/makensis.exe/1.241/Tue Sep 16 19:07:57 2003/-kb/</b><br />
      <br />
      Long answer: I always do a normal install of NSIS (without source) and when I searched through the 'Entries' files in my NSIS install dir I found no reference to makensis.exe. I re-downloaded the latest snapshot, unzipped it, and checked the Entries file in the root CVS directory - that's where I got my short answer above from. ;)<br />
      <br />
      Just to be sure, I re-installed the latest snapshot again, but the problem persists. It seems to affect everything, even NSIS itself refuses to uninstall, complaining about corruption! :P<br />
      <br />
      As a test, I recompiled the NSIS installer without bzip compression and now it uninstalls fine.<br />
      <br />
      By the way, here are the file sizes for the compiled NSIS installer:<br />
      <br />
      nsis20b4.exe 1,719,114 bytes (with zlib)<br />
      nsis20b4.exe 1,511,271 bytes (with bzip2)<br />
      <br />
      does that amount of compression with bzip2 seem about right?</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
      <span class="post-time small text-muted">19th September 2003 12:47 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Thanks, fixed.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">psyke</span><br />
      <span class="post-time small text-muted">19th September 2003 15:22 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Thank you Kichik, I'm glad you were able to fix it. :) I'm surprised no one else seemed to notice the bug though. :weird:</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">clio44</span><br />
      <span class="post-time small text-muted">25th February 2006 01:32 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>help for the non-computer whiz?</strong><br />
      How can a non-computer whiz fix this problem? I try to open the installer for WinAmp and it gives me that message that maybe it has a virus (ooooEEEEoooo) or that it just refuses to open it (jerk). I don't understand how to do the things you guys suggested.....<br />
      <br />
      Any help?<br />
      Thanks,<br />
      Laura :)</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
      <span class="post-time small text-muted">25th February 2006 09:30 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">See <a href="http://nsis.sourceforge.net/Why_do_I_get_NSIS_Error" target="_blank">"Why do I get NSIS Error?"</a> from the FAQ.</p>
    </div>
    <hr />

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]>
  </script>
</body>
</html>
