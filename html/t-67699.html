<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="description" content="NSIS 1.8b, needs testing and love"><title>NSIS 1.8b, needs testing and love - NSIS Forums</title><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script><link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css"><link rel="stylesheet" href="../css/style.css" type="text/css"></head><body><div class="container"><ol class="breadcrumb"><li><a href="../index.html" class="glyphicon glyphicon-home"></a></li><li><a href="f-65.html">NSIS Discussion</a></li><li class="active">NSIS 1.8b, needs testing and love</li></ol><p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=67699">NSIS 1.8b, needs testing and love</a></p><br><div class="post"><p class="post-meta"><span class="post-author text-primary">justin</span><br><span class="post-time small text-muted">5th December 2001 04:50 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>NSIS 1.8b, needs testing and love</strong><br>Hello all.. a couple of days ago I put together NSIS 1.8b, which consists primarily of a few architectural changes as well as some added features.<br><br>These architectural changes let us be more flexible in calls and gotos. To be more specific, you can now get the address of a label or function, and call or goto that address. The address can be stored in a user variable, so you can now do things like callback functions.<br><br>Anyway, I had to change a lot to make this possible, so things need a lot of testing. I've given it some, and all the obvious bugs have been removed, but any help or reassurance would be appreciated.<br><br>I've also just updated it more with 1.8b2, which is on <a href="http://firehose.net/free/nsis/." target="_blank">http://firehose.net/free/nsis/.</a> 1.8b2 adds even more functionality relating to relative jumps, as well as getting the current code address.<br><br>(edit) Also, I updated it so that labels beginning with a `.' are global. Fun.<br><br><br>-Justin</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">DuaneJeffers</span><br><span class="post-time small text-muted">5th December 2001 09:10 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Holy Crap!!!!!!<br><br>Awesome!!!!<br>-Duane</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">AndiG</span><br><span class="post-time small text-muted">5th December 2001 13:18 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Justin,<br><br>I have a small backup installer that does nothing more than creating another installer script and building it.<br><br>It would be nice if this "generator" installer could be output to $temp\gen.exe but trying something like that doesn't compile (at least in 1.7).<br><br>If this can be fixed without bloating things it would be nice.<br><br>Thanks, Andi</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">liquidmotion</span><br><span class="post-time small text-muted">5th December 2001 21:34 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">suh-weet.<br><br>now i guess i have to update slate blue...whahhhh</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">justin</span><br><span class="post-time small text-muted">5th December 2001 22:35 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"></p><blockquote><i>Originally posted by AndiG</i><br><b>Justin,<br><br>I have a small backup installer that does nothing more than creating another installer script and building it.<br><br>It would be nice if this "generator" installer could be output to $temp\gen.exe but trying something like that doesn't compile (at least in 1.7).<br><br>If this can be fixed without bloating things it would be nice.<br><br>Thanks, Andi</b></blockquote>You could have the generating installer write the OutFile command to the script manually, ala:<br><br><pre>
<code><br>SetOutPath $INSTDIR<br>File myfile.nsi<br>FileOpen $R0 $INSTDIR\myfile.nsi a<br>FileWrite $R0 "$\r$\nOutFile $TEMP\gen.exe$\r$\n"<br>FileClose $R0<br>ExecWait ...<br></code>
</pre><br>
      <br>
      Get my drift? Or maybe I misunderstood you...<br>
      <br>
      -Justin
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">AndiG</span><br>
      <span class="post-time small text-muted">6th December 2001 07:29 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Slight misunderstanding: I'm not interested in the generating installer itself (it is writing the final one to a fiel as you assumed), that one should be build in the temp directory like:<br>
      <br>
      Name "Find Files"<br>
      OutFile "%temp%\Find Files.exe"<br>
      Caption "Find Files"<br>
      <br>
      "Failed to obtain setup.exe from the script"</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">nels</span><br>
      <span class="post-time small text-muted">6th December 2001 16:15 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>A few minor problems</strong><br>
      It seems you forgot to add "config.h" in "exehead\resource.h" which is needed by the "NSIS_CONFIG_XPSTYLE_SUPPORT" stuff.<br>
      <br>
      Also in "zlib\infutil.h", the definition of "UPDIN" is not accepted by gcc (again :D). It needs a cast for "z-&gt;total_in+=p-(cast)z-&gt;next_in;". I didn't know which type you used, so change "cast" by what you need.<br>
      <br>
      At last, VC seems to reconstruct the "exehead\resouce.rc" because it deleted the windows.h include, the little tweaks for the windows and added "afxres.h" again (I really don't know why it adds this).<br>
      <br>
      Nels</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">FreeNsisTweaker</span><br>
      <span class="post-time small text-muted">6th December 2001 18:56 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">I've got an idea for a feature-change:<br>
      Is it possible to make it so that the use can choose to create a uninstaller or not? Maybe the UninstallExeName can be included in a section, which the user can disable. This isn't possible yet and that's a pitty I think.</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">eccles</span><br>
      <span class="post-time small text-muted">7th December 2001 22:17 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Effin ell Justin... you've been busy! Macros? You'll be giving us classes next ;)<br>
      <br>
      It's handy being able to modify variables like $EXEDIR and $CMDLINE - will help simplify one of my functions..<br>
      <br>
      Bug - (in the uninstaller only) when finished, the progress bar has not reached 100%.<br>
      <br>
      Idea - Allow labels to be Called directly - sort of having local functions?<br>
      <br>
      --<br>
      Dave</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">nels</span><br>
      <span class="post-time small text-muted">8th December 2001 02:18 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>NSIS 1.8b3</strong><br>
      I tried to compile NSIS 1.8b3 with -&gt; no problem ;)<br>
      <br>
      In fact, only one but it's more a windres issue : it defines WS_POPUP, WS_BORDER and WS_SYSMENU by default, so it causes problem with the child windows. I'll contact the mingw (gcc for win32) team to discuss this.<br>
      <br>
      I attached the gcc Makefiles if somebody wants to try it. These are my first makefiles so please be cool with me :D<br>
      <br>
      Nels</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">nels</span><br>
      <span class="post-time small text-muted">8th December 2001 02:20 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>Sorry</strong><br>
      Here are the makefiles</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">nels</span><br>
      <span class="post-time small text-muted">8th December 2001 02:45 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>Again</strong><br>
      Sorry, it's me again.<br>
      Forget about the windres issue. It's now corrected (in binutils 2.11.92). It means that NSIS compiles with gcc with NO problem ;)</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">justin</span><br>
      <span class="post-time small text-muted">8th December 2001 02:58 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Heh try them with nsis 1.8b4 :)<br>
      <br>
      Cool.. These makefiles don't work for me (some weird error with make), maybe I'm using too old of a cygwin/ming... My make version is 3.77. The error I get is<br>
      <br>
      ', needed by `all'. Stop.target `exehead<br>
      <br>
      <br>
      Strange. Anyway, mind if I distro these makefiles (once they seem to work) in the distro? :)<br>
      <br>
      -Justin</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">nels</span><br>
      <span class="post-time small text-muted">8th December 2001 03:14 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>Compiling with mingw</strong><br>
      I used make 3.79 which is included in the main package.<br>
      <br>
      Here is a small howto:<br>
      1/ Go to <a href="http://sourceforge.net/projects/mingw" target="_blank">http://sourceforge.net/projects/mingw</a> and download 'MinGW-[version].tar.gz' (actual version is 1.1, here is the direct link <a href="http://prdownloads.sourceforge.net/mingw/MinGW-1.1.tar.gz" target="_blank">http://prdownloads.sourceforge.net/m...nGW-1.1.tar.gz</a>).<br>
      2/ Decompress the downloaded file where you want.<br>
      3/ Add the [install_dir]\bin in you path.<br>
      4/ Go to the NSIS source directory.<br>
      5/ Type 'make'.<br>
      6/ You now have you 'makensis.exe'</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">justin</span><br>
      <span class="post-time small text-muted">8th December 2001 09:14 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Cool, after getting mingw32 (I was using stock cygwin before), and updating to the latest binutils, it works. :) I tuned the makefile a bit, too, but we're still at 49kb with gcc vs. 34kb with vc++. Maybe I can find a way of merging the .bss section with the .data section like VC++ does, and save another few kb. If that. Anyway, here are my update makefiles. Nels, can I distribute them with 1.80? :)<br>
      <br>
      -Justin</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">crish</span><br>
      <span class="post-time small text-muted">8th December 2001 10:28 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>unistall error</strong><br>
      i get the following error on uninstall with 1.8b<br>
      <br>
      install corrupted : invalid opcode<br>
      <br>
      (uninstall code was ok in 1.6x)</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Koen van de Sande</span><br>
      <span class="post-time small text-muted">8th December 2001 10:37 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">crish, are you using the new WriteUninstaller command? Because the old UninstallExeName was 'superceded'. No idea what that word exactly means, but things have changed :)</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">F. Heidenreich</span><br>
      <span class="post-time small text-muted">8th December 2001 10:59 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">I get the 'install corrupted : invalid opcode' error too, on uninstalling NSIS 1.8b2.<br>
      Koen, notice that this error occurs on <b>uninstall</b>, not on compiling the script.<br>
      But with 1.8b3 all went fine :)<br>
      <br>
      ~ Florian</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">crish</span><br>
      <span class="post-time small text-muted">8th December 2001 11:11 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">i get the same error on the example2 script<br>
      <br>
      on the nsis site, i found that its ok since b2<br>
      <br>
      but i will try the b3</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">nels</span><br>
      <span class="post-time small text-muted">8th December 2001 11:26 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>gcc makefiles</strong><br></p>

      <blockquote>
        <i>Originally posted by justin</i><br>
        <b>Cool, after getting mingw32 (I was using stock cygwin before), and updating to the latest binutils, it works. :) I tuned the makefile a bit, too, but we're still at 49kb with gcc vs. 34kb with vc++. Maybe I can find a way of merging the .bss section with the .data section like VC++ does, and save another few kb. If that. Anyway, here are my update makefiles. Nels, can I distribute them with 1.80? :)<br>
        <br>
        -Justin</b>
      </blockquote>Of course you can include them, that's why I sent them ;)
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">pjw62</span><br>
      <span class="post-time small text-muted">8th December 2001 19:46 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"></p>

      <blockquote>
        <i>Originally posted by justin</i><br>
        <b>Cool, after getting mingw32 (I was using stock cygwin before), and updating to the latest binutils, it works. :) I tuned the makefile a bit, too, but we're still at 49kb with gcc vs. 34kb with vc++. Maybe I can find a way of merging the .bss section with the .data section like VC++ does, and save another few kb. If that. Anyway, here are my update makefiles. Nels, can I distribute them with 1.80? :)<br>
        <br>
        -Justin</b>
      </blockquote>just out of interest, you can get exactly midway with Borland's compiler - 41.5kb..
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Joost Verburg</span><br>
      <span class="post-time small text-muted">10th December 2001 21:29 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">1.80 can now be found at firehose.net :)<br>
      <br>
      <a href="http://www.firehose.net/free/nsis" target="_blank">http://www.firehose.net/free/nsis</a></p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Smile2Me</span><br>
      <span class="post-time small text-muted">11th December 2001 19:17 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Justin,<br>
      <br>
      two problems have been found in NSIS version 1.80<br>
      please take a look at:<br>
      <br>
      <a href="http://forums.winamp.com/showthread.php?s=&amp;threadid=68347" target="_blank">http://forums.winamp.com/showthread....threadid=68347</a><br>
      <a href="http://forums.winamp.com/showthread.php?s=&amp;threadid=68242" target="_blank">http://forums.winamp.com/showthread....threadid=68242</a><br>
      <br>
      thx, greetz, Hendri.</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Joost Verburg</span><br>
      <span class="post-time small text-muted">11th December 2001 19:54 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">And this one <a href="http://forums.winamp.com/showthread.php?s=&amp;threadid=68275" target="_blank">http://forums.winamp.com/showthread....threadid=68275</a></p>
    </div>
    <hr>

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]></script></body></html>