<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content=".NET Assemblys RegAsm" />

  <title>.NET Assemblys RegAsm - NSIS Forums</title><!-- Bootstrap core CSS -->
  <link rel="stylesheet" type="text/css" href="//netdna.bootstrapcdn.com/bootswatch/3.0.1/readable/bootstrap.min.css" />
  <link rel="stylesheet" href="../css/style.css" type="text/css" /><!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!--[if lt IE 9]>
                <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
                <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->
</head>

<body>
  <div class="container">
    <!-- Put navigation bar here -->

    <ol class="breadcrumb">
      <li><a href="../index.html" class="glyphicon glyphicon-home"></a></li>

      <li><a href="f-65.html">NSIS Discussion</a></li>

      <li class="active">.NET Assemblys RegAsm</li>
    </ol>

    <p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=157791">.NET Assemblys RegAsm</a></p><br />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Haggy</span><br />
      <span class="post-time small text-muted">27th November 2003 15:01 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>.NET Assemblys RegAsm</strong><br />
      Hi!<br />
      <br />
      I'm using the NSIS for the first time.<br />
      <br />
      <br />
      I want to make an Installer which installs severals .NET Assemblys. I've found here how to make it that i can use the gacutil.<br />
      <br />
      But how can I implement that the Nsis register my class by RegASM?<br />
      <br />
      Thank you all for your help<br />
      <br />
      Haggy</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
      <span class="post-time small text-muted">1st December 2003 14:02 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Is RegASM an executable too? If so, just execute it using ExecWait, Exec or the nsExec plug-in.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Haggy</span><br />
      <span class="post-time small text-muted">2nd December 2003 08:38 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Hi<br />
      Yes it is, but I don't know the path of it.<br />
      <br />
      Because it is in the .NET Directory and there in the Directory of the Current version e.g. 1.1.387 and i don' know how to get the current installed version auf .NET Framework, the user has :-/<br />
      <br />
      I don't know too if the regasm and the gacutil were only in the SDK or in the standard framework included.<br />
      <br />
      thank you<br />
      <br />
      Haggy</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
      <span class="post-time small text-muted">2nd December 2003 11:54 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Well, if it's not big, I think you can save yourself the hassle and just include it in the installer. If it is big, you might be able to get the directory of the latest .NET framework using a varient of the following function:<br />
      <br />
      <a href="http://nsis.sourceforge.net/archive/viewpage.php?pageid=24" target="_blank">http://nsis.sourceforge.net/archive/....php?pageid=24</a><br />
      <br />
      Please post your result on the Archive, if you can get that function to give you the directory of the latest version.<br />
      <br />
      BTW, I think gacutil and regasm come only with the SDK, but MSDN will probably know better.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">phallguy</span><br />
      <span class="post-time small text-muted">3rd January 2004 11:00 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>Simple Reg Script solution</strong><br />
      Since COM registration is a registry only based operation you can use the regasm tool on your local machine to generate the registry script that can be used to install your component. You can then use the standard registry manipulation tools in NSIS to update the registry. Simply add the /regfile:output parameter to the command line of the regasm tool to create the script.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
      <span class="post-time small text-muted">3rd January 2004 12:13 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">And to convert from .reg to .nsi you can use this tool:<br />
      <br />
      <a href="http://nsis.sourceforge.net/archive/viewpage.php?pageid=296" target="_blank">http://nsis.sourceforge.net/archive/...php?pageid=296</a></p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">mattwilkinson</span><br />
      <span class="post-time small text-muted">19th December 2005 10:27 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Can I just make the point that if you are using regasm to register your assembly, you should also unregister it in your uninstall section. Therefore if you are using a .reg file, you need to create one for registering and one for unregistering your assembly and package both of them.<br />
      <br />
      Because of this problem I have decided to register my assemblies on the machine using regasm (this gives a double check that the .NET framework is install btw because if regasm is no-where to be found - it needs to be installed)<br />
      <br />
      I have a problem however with the following lines:<br />
      <br />
      ClearErrors<br />
      <br />
      ;find the location of RegAsm<br />
      ReadRegStr $R1 HKLM "Software\Microsoft\Windows\CurrentVersion\Uninstall\Microsoft .NET Framework 2.0" "InstallLocation"<br />
      <br />
      ;execute regasm passing the path to my assembly<br />
      Exec '"$R1RegAsm" "${sInst}${sApp}.exe" /silent /tlb:"$SYSDIR\${sApp}.tlb" /codebase'<br />
      IfErrors 0 +2<br />
      MessageBox MB_OK "Error Registering ${sInst}${sApp}"<br />
      <br />
      The assembly registers ok but even though I am specifying the /silent option, I still get a empty dos style box appearing at this point.<br />
      This will be a particular problem for me because I have around fifty of the these assemblies to register!<br />
      <br />
      Has anyone come across this problem?</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
      <span class="post-time small text-muted">20th December 2005 18:10 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">You can use the nsExec plug-in which is bundled with NSIS, or the <a href="http://nsis.sourceforge.net/ExecDos" target="_blank">ExecDos plug-in</a>.</p>
    </div>
    <hr />

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]>
  </script>
</body>
</html>
