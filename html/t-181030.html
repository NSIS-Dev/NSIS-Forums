<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="description" content="System path"><title>System path - NSIS Forums</title><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script><link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css"><link rel="stylesheet" href="../css/style.css" type="text/css"></head><body><div class="container"><ol class="breadcrumb"><li><a href="../index.html" class="glyphicon glyphicon-home"></a></li><li><a href="f-65.html">NSIS Discussion</a></li><li class="active">System path</li></ol><p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=181030">System path</a></p><br><div class="post"><p class="post-meta"><span class="post-author text-primary">SprinklerHead</span><br><span class="post-time small text-muted">24th May 2004 13:13 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>System path</strong><br>My installer modifies the system path. It adds two directories to the system path. For Windows 9x machines it updates autoexec.bat. For Windows NT based machines it modifies HKLM\System\CurrentControlSet\Control\Session Manager\Environment\. After the system path has been updated, then I register an ocx file.<br><br>My ocx file has dependencies in the two directories I just added to the system path. The problem I am having is that I need the path updated before the installer exits because I need to register that ocx file. After adding these two directories to the system path, I do this:<br><br>SendMessage ${HWND_BROADCAST} ${WM_WININICHANGE} 0 "STR:Environment" /TIMEOUT=5000<br><br>I figured that this would refresh the system path for all running processes. This doesn't seem to be the case however. When I test my installer, I see that the path gets updated before the installer quits but the ocx file still fails to register. When the installer exits, I relaunch it and try installing again. The second time always works because I think the system path info is updated.<br><br>Is there any truth to this?</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">SprinklerHead</span><br><span class="post-time small text-muted">24th May 2004 13:14 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Oh, and I am testing on a Windows 2000 machine. I know on Windows 9x I will need a reboot.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Davion</span><br><span class="post-time small text-muted">24th May 2004 14:48 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">why not creating a dir in $WINDIR<br><br>so you would have $WINDIR\Folder1 and $WINDIR\Folder2<br><br>with which you can work<br><br>registering the Dlls and ocx would look like this:<br><br>RegDLL "$WINDIR\Folder1\FirstOne.DLL"<br><br>this would be a much better way than changing the system path<br>I don't think you are able to do this, too</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">kichik</span><br><span class="post-time small text-muted">25th May 2004 11:30 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Use the second method from the archive for temporary path changes or simply set the output path to the directory you need, assuming it's not more than one.</p></div><hr><div class="footer"><p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p></div></div><script src="../js/highlight.pack.js" type="text/javascript"></script><script type="text/javascript">//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]></script></body></html>