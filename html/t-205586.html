<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="description" content="Problem with uninstalling before installing"><title>Problem with uninstalling before installing - NSIS Forums</title><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script><link rel="preload" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css" as="style" onload="this.rel='stylesheet'"><link rel="preload" href="../css/style.css" as="style" onload="this.rel='stylesheet'"><noscript><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css"><link rel="stylesheet" href="../css/style.css"></noscript><script>!function(a){"use strict";var b=function(b,c,d){function e(a){return h.body?a():void setTimeout(function(){e(a)})}function f(){i.addEventListener&&i.removeEventListener("load",f),i.media=d||"all"}var g,h=a.document,i=h.createElement("link");if(c)g=c;else{var j=(h.body||h.getElementsByTagName("head")[0]).childNodes;g=j[j.length-1]}var k=h.styleSheets;i.rel="stylesheet",i.href=b,i.media="only x",e(function(){g.parentNode.insertBefore(i,c?g:g.nextSibling)});var l=function(a){for(var b=i.href,c=k.length;c--;)if(k[c].href===b)return a();setTimeout(function(){l(a)})};return i.addEventListener&&i.addEventListener("load",f),i.onloadcssdefined=l,l(f),i};"undefined"!=typeof exports?exports.loadCSS=b:a.loadCSS=b}("undefined"!=typeof global?global:this);!function(a){if(a.loadCSS){var b=loadCSS.relpreload={};if(b.support=function(){try{return a.document.createElement("link").relList.supports("preload")}catch(b){return!1}},b.poly=function(){for(var b=a.document.getElementsByTagName("link"),c=0;c<b.length;c++){var d=b[c];"preload"===d.rel&&"style"===d.getAttribute("as")&&(a.loadCSS(d.href,d,d.getAttribute("media")),d.rel=null)}},!b.support()){b.poly();var c=a.setInterval(b.poly,300);a.addEventListener&&a.addEventListener("load",function(){b.poly(),a.clearInterval(c)}),a.attachEvent&&a.attachEvent("onload",function(){a.clearInterval(c)})}}}(this);</script></head><body><div class="container"><ol class="breadcrumb"><li><a href="../index.html" class="glyphicon glyphicon-home"></a></li><li><a href="f-65.html">NSIS Discussion</a></li><li class="active">Problem with uninstalling before installing</li></ol><p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=205586">Problem with uninstalling before installing</a></p><br><div class="post"><p class="post-meta"><span class="post-author text-primary">SoundScape_2910</span><br><span class="post-time small text-muted">22nd January 2005 01:18 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>Problem with uninstalling before installing</strong><br>Hi,<br><br>I have an installer which checks whether a product is already installed or not prior to installing. I have included the following code to achieve that:<br><br>ReadRegStr $Path HKCU "SOFTWARE\Product\ "InstallPath"<br>HideWindow<br>ClearErrors<br>ExecWait $Path\uninst.exe<br>BringToFront<br><br>Problem is the following: The user has the option to uninstall product or proceed without uninstallation. As soon as he hits the "Uninstall" button, the installer window hides and shows up immediately along with the message box of the uninstaller. In other words, the installer does not wait until uninstaller finishes but becomes visible when it is not supposed to be. Any ideas to overcome this problem?<br><br>Thanks in advance! :D</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Anders</span><br><span class="post-time small text-muted">22nd January 2005 03:20 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">the uninstaller copies itself to the temp dir, execs the exe in temp and exits (so it can delete itself). u can manually copy the uninst.exe to temp then exec it with a special command line argument ( "uninst.exe _?=$instdir" if i remember correctly)</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">superwan</span><br><span class="post-time small text-muted">23rd January 2005 15:43 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">just have a look at the nsis script ;)</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">superwan</span><br><span class="post-time small text-muted">25th January 2005 13:46 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">this command<br><br>'uninst.exe _?=$instdir'<br><br>does not work athome :(<br>see ya</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">superwan</span><br><span class="post-time small text-muted">25th January 2005 14:09 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">HideWindow<br>ClearErrors<br>ExecWait '$INSTDIR\setup_KTV_tmp.exe _?=$INSTDIR'<br>IfErrors error<br>Quit<br>BringToFront<br><br>seems to work...</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">kichik</span><br><span class="post-time small text-muted">27th January 2005 14:24 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">It will only work if the uninstaller is a NSIS uninstaller. According to the behavior specified, it doesn't like it is. The following page contains information about how to make other installers wait:<br><br><a href="http://unattended.sourceforge.net/installers.php" target="_blank">http://unattended.sourceforge.net/installers.php</a></p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">SoundScape_2910</span><br><span class="post-time small text-muted">6th February 2005 22:59 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Thanks to everyone who took the time to help me out. Using the "uninst.exe _?=$instdir" command, the problem was solved. Installer window does hide until uninstaller finishes. But another problem surfaced. I have more than one partition in my system and I have set drive C in such a way that a simple user is not allowed to write on it. When I tested my installer using a restricted account, the above command didn't work, i.e. installer window didn't hide. My guess is that since it is not allowed to erite on C, the uninstaller could not be extracted to the TEMP directory. My question is this: is there a way to determine at runtime what the write permissions are for a specific drive or partition? What if a system has only one drive, one partition and a part of it is restricted to a simple user? For example, folders "Program Files" and "Windows" are restricted and all other parts of drive are not. Also, is there a way to determine how many drives/partitions a system has?<br><br>Many thanks in advance. I am waiting for your input on these matters.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">kichik</span><br><span class="post-time small text-muted">10th February 2005 19:35 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">The temporary directory is verified. If it's not writable, the installer won't start. There must be another problem.</p></div><hr><div class="footer"><p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p></div></div><script src="../js/highlight.pack.js" type="text/javascript"></script><script type="text/javascript">//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]></script></body></html>