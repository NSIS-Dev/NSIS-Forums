<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="Could not load: ...\myplugin.dll" />

  <title>Could not load: ...\myplugin.dll - NSIS Forums</title><!-- Bootstrap core CSS -->
  <link rel="stylesheet" type="text/css" href="//netdna.bootstrapcdn.com/bootswatch/3.0.1/readable/bootstrap.min.css" />
  <link rel="stylesheet" href="../css/style.css" type="text/css" /><!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!--[if lt IE 9]>
                <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
                <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->
</head>

<body>
  <div class="container">
    <!-- Put navigation bar here -->

    <ol class="breadcrumb">
      <li><a href="../index.html" class="glyphicon glyphicon-home"></a></li>

      <li><a href="f-65.html">NSIS Discussion</a></li>

      <li class="active">Could not load: ...\myplugin.dll</li>
    </ol>

    <p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=172982">Could not load: ...\myplugin.dll</a></p><br />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">AmoebaMan17</span><br />
      <span class="post-time small text-muted">11th March 2004 17:15 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>Could not load: ...\myplugin.dll</strong><br />
      I have created a plugin that uses ADO to update an MSAccess database at install time, for registration purposes. The installation and plugin works fine on some workstations and doesn't work on others.<br />
      <br />
      The workstations that work have Visual Studio 2003 installed on them.<br />
      <br />
      Does anyone know what conditions will generate the message in the [Details...] button during installation: <b>Could not load:<i>...\myplugin.dll</i></b>?<br />
      <br />
      I am able to create this installer on the machine which can not load the DLL during installation, and since the installer is able to load the DLL at install file creation time, I thought it would work.<br />
      <br />
      Another strange situation is that I am able to create a seperate .EXE file with the same code inside the exported _dllspec function, and that will run on the workstations in question.<br />
      <br />
      So, my guess is that it is some compiler/linker switch that is preventing this from working.<br />
      <br />
      My compiler switches are:<br />
      /O1 /Ob1 /D "WIN32" /D "NDEBUG" /D "_WINDOWS" /D "_USRDLL" /D "REGDEMO_EXPORTS" /D "_MBCS" /D "_WINDLL" /GF /FD /EHsc /MT /GS /Gy /YX"stdafx.h" /Fp"Release/regDemo.pch" /Fo"Release/" /Fd"Release/vc70.pdb" /W3 /nologo /c /TP<br />
      <br />
      My linker switches are:<br />
      /OUT:"Release/regDemo.dll" /VERSION:1.0 /INCREMENTAL:NO /NOLOGO /DLL /NODEFAULTLIB /OPT:NOWIN98 /ENTRY:"_DllMainCRTStartup" /IMPLIB:"Release/regDemo.lib" MSVCRT.lib comsupp.lib kernel32.lib user32.lib gdi32.lib winspool.lib comdlg32.lib advapi32.lib shell32.lib ole32.lib oleaut32.lib uuid.lib odbc32.lib odbccp32.lib<br />
      <br />
      I am a programmer, but I am not an expert in compiling.<br />
      <br />
      Chris</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
      <span class="post-time small text-muted">11th March 2004 20:10 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Your DLL probably requires some runtime DLLs that are not present on those workstations. I would guess msvcr70.dll and some ADO DLLs. You can either distribute those DLLs, put them in $PLUGINSDIR before you call the plug-in or simply not use them and link statically.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">AmoebaMan17</span><br />
      <span class="post-time small text-muted">11th March 2004 20:57 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">:up: :up:<br />
      Thank you 1000 times!! I have been fighting with<br />
      getting anything to work and this fixed it!!<br />
      <br />
      You were exactly right!! It was the msvcr70.dll.<br />
      <br />
      Is there a way to make VS.NET compile with an<br />
      older C Runtime requirement? Do I just need<br />
      to find an older msvcrt.lib file to compile<br />
      against? My program requires Windows 2000 or<br />
      greater, all of which should have msvcrt.dll of<br />
      at least version 6, I assume.<br />
      <br />
      Also, as a lesser important question, how do I<br />
      prevent the horrendous non-word-wrapping from<br />
      happening again during my posts, without manually<br />
      formatting my paragraphs?<br />
      <br />
      Chris</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Joel</span><br />
      <span class="post-time small text-muted">11th March 2004 23:57 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Doesn't Visual Studio .NET come a Win32 Project without the .NET runtime?</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">AmoebaMan17</span><br />
      <span class="post-time small text-muted">12th March 2004 05:06 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">When I created a new project, I chose to create an empty<br />
      Win32 DLL project. I don't think it requires the CLR, but<br />
      I'm not sure. But I also downloaded the source to a<br />
      couple of plugins from the NSIS archive and then just<br />
      inserted my functions in that code, leaving the compiler<br />
      and linker settings alone, and that also wasn't working.<br />
      <br />
      I don't have my VS.NET compiler on this computer, but I<br />
      have my MS VC++ 6.0. I notice that the MSVCRT.LIB that is<br />
      with MS VC++ 6.0 requires msvcrt.dll. So, I am going to<br />
      copy that onto my other computer and hopefully things will<br />
      compile without the requirement of msvcr70.dll.<br />
      <br />
      -chris</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
      <span class="post-time small text-muted">12th March 2004 10:38 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Instead of messing with libraries you can simply link statically. In MSVC 6 it's an option in the project setting. I'm sure that option exists in 7 too.<br />
      <br />
      To create smaller DLLs simply avoid using MSVCRT just like NSIS and all of its plug-ins are doing.<br />
      <br />
      As for the word wrap, the forum software must have gotten confused by the long line of compiler switches. It shouldn't do it, you don't have to break the lines on your own.</p>
    </div>
    <hr />

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]>
  </script>
</body>
</html>
