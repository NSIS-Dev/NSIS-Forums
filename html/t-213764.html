<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="description" content="Please Help"><title>Please Help - NSIS Forums</title><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script><link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css"><link rel="stylesheet" href="../css/style.css" type="text/css"></head><body><div class="container"><ol class="breadcrumb"><li><a href="../index.html" class="glyphicon glyphicon-home"></a></li><li><a href="f-65.html">NSIS Discussion</a></li><li class="active">Please Help</li></ol><p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=213764">Please Help</a></p><br><div class="post"><p class="post-meta"><span class="post-author text-primary">Petkop</span><br><span class="post-time small text-muted">21st April 2005 11:17 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>Please Help</strong><br>Dear All<br><br>I'm new with NSIS. I have a small problem with Icons. I can NOT get any icon to my instalation. I try with all dfiferent icons size. Also if you see any other problem in my script please tell me! All my script is:<br><br><br>; Define your application name<br>!define APPNAME "TouchFinL"<br>!define APPNAMEANDVERSION "TouchFinL V4.23"<br><br>; Main Install settings<br>Name "${APPNAMEANDVERSION}"<br>InstallDir "$PROGRAMFILES\TouchFinL"<br>InstallDirRegKey HKLM "Software\${APPNAME}" ""<br>Icon "C:\XXXInstall\tf.io"<br>OutFile "C:\XXXInstall\Try\TouchFin.exe"<br><br>; Modern interface settings<br>!include "MUI.nsh"<br><br>!define MUI_ABORTWARNING<br>!define MUI_FINISHPAGE_RUN "$INSTDIR\TouchFinL.exe"<br><br>!insertmacro MUI_PAGE_WELCOME<br>!insertmacro MUI_PAGE_LICENSE "..\license.txt"<br>!insertmacro MUI_PAGE_DIRECTORY<br>!insertmacro MUI_PAGE_INSTFILES<br>!insertmacro MUI_PAGE_FINISH<br><br>!insertmacro MUI_UNPAGE_CONFIRM<br>!insertmacro MUI_UNPAGE_INSTFILES<br><br>; Set languages (first is default language)<br>!insertmacro MUI_LANGUAGE "English"<br>!insertmacro MUI_RESERVEFILE_LANGDLL<br><br>!include Library.nsh<br><br>Var ALREADY_INSTALLED<br><br><br>Section "-Install VB6 runtimes"<br><br>;Add code here that sets $ALREADY_INSTALLED to a non-zero value if the application is already installed. For example:<br><br>IfFileExists "$INSTDIR\TouchFinL.exe" 0 new_installation ;Replace MyApp.exe with your application filename<br>StrCpy $ALREADY_INSTALLED 1<br>new_installation:<br><br>!insertmacro InstallLib REGDLL $ALREADY_INSTALLED REBOOT_NOTPROTECTED "..\msvbvm60.dll" "$SYSDIR\msvbvm60.dll" "$SYSDIR"<br>!insertmacro InstallLib REGDLL $ALREADY_INSTALLED REBOOT_PROTECTED "..\oleaut32.dll" "$SYSDIR\oleaut32.dll" "$SYSDIR"<br>!insertmacro InstallLib REGDLL $ALREADY_INSTALLED REBOOT_PROTECTED "..\olepro32.dll" "$SYSDIR\olepro32.dll" "$SYSDIR"<br>!insertmacro InstallLib REGDLL $ALREADY_INSTALLED REBOOT_PROTECTED "..\comcat.dll" "$SYSDIR\comcat.dll" "$SYSDIR"<br>!insertmacro InstallLib DLL $ALREADY_INSTALLED REBOOT_PROTECTED "..\asycfilt.dll" "$SYSDIR\asycfilt.dll" "$SYSDIR"<br>!insertmacro InstallLib TLB $ALREADY_INSTALLED REBOOT_PROTECTED "..\stdole2.tlb" "$SYSDIR\stdole2.tlb" "$SYSDIR"<br><br>!insertmacro InstallLib REGDLL $ALREADY_INSTALLED REBOOT_PROTECTED "..\MSBIND.DLL" "$SYSDIR\MSBIND.DLL" "$SYSDIR"<br>!insertmacro InstallLib REGDLL $ALREADY_INSTALLED REBOOT_PROTECTED "..\MSCOMCT2.OCX" "$SYSDIR\MSCOMCT2.OCX" "$SYSDIR"<br>!insertmacro InstallLib REGDLL $ALREADY_INSTALLED REBOOT_PROTECTED "..\MSCOMCTL.OCX" "$SYSDIR\MSCOMCTL.OCX" "$SYSDIR"<br>!insertmacro InstallLib REGDLL $ALREADY_INSTALLED REBOOT_PROTECTED "..\MSDATGRD.OCX" "$SYSDIR\MSDATGRD.OCX" "$SYSDIR"<br>!insertmacro InstallLib REGDLL $ALREADY_INSTALLED REBOOT_PROTECTED "..\msstdfmt.dll" "$SYSDIR\msstdfmt.dll" "$SYSDIR"<br><br>SectionEnd<br><br>Section "-un.Uninstall VB6 runtimes"<br><br>!insertmacro UnInstallLib REGDLL SHARED NOREMOVE "$SYSDIR\msvbvm60.dll"<br>!insertmacro UnInstallLib REGDLL SHARED NOREMOVE "$SYSDIR\oleaut32.dll"<br>!insertmacro UnInstallLib REGDLL SHARED NOREMOVE "$SYSDIR\olepro32.dll"<br>!insertmacro UnInstallLib REGDLL SHARED NOREMOVE "$SYSDIR\comcat32.dll"<br>!insertmacro UnInstallLib DLL SHARED NOREMOVE "$SYSDIR\asycfilt.dll"<br>!insertmacro UnInstallLib TLB SHARED NOREMOVE "$SYSDIR\stdole2.tlb"<br><br>SectionEnd<br><br>Section "TouchFinL" Section1<br><br>; Set Section properties<br>SetOverwrite on<br><br>; Set Section Files and Shortcuts<br>SetOutPath "$INSTDIR\"<br>File "..\MyPrintTFL.dll" ;Reg OK AppPath Folder<br>RegDLL $INSTDIR\MyPrintTFL.dll<br>File "..\MDAC_TYP.EXE" ;Reg NE AppPath Folder<br>File "..\repHTML.tfz" ;Reg NE AppPath Folder<br>File "..\repPic.tfz" ;Reg NE AppPath Folder<br>File "..\TFDB.tfb" ;Reg NE AppPath Folder<br>File "..\TouchFinL.exe" ;Reg NE AppPath Folder<br>File "..\VB6STKIT.DLL" ;Reg NE System Folder<br>File "..\wininet.dll" ;Reg NE AppPath Folder<br><br>CreateShortCut "$DESKTOP\TouchFinL.lnk" "$INSTDIR\TouchFinL.exe"<br>CreateDirectory "$SMPROGRAMS\TouchFinL"<br>CreateShortCut "$SMPROGRAMS\TouchFinL\TouchFinL.lnk" "$INSTDIR\TouchFinL.exe"<br><br>SectionEnd<br><br>Section -FinishSection<br><br>WriteRegStr HKLM "Software\${APPNAME}" "" "$INSTDIR"<br>WriteRegStr HKLM "Software\Microsoft\Windows\CurrentVersion\Uninstall\${APPNAME}" "DisplayName" "${APPNAME}"<br>WriteRegStr HKLM "Software\Microsoft\Windows\CurrentVersion\Uninstall\${APPNAME}" "UninstallString" "$INSTDIR\uninstall.exe"<br>WriteUninstaller "$INSTDIR\uninstall.exe"<br><br>SectionEnd<br><br>; Modern install component descriptions<br>!insertmacro MUI_FUNCTION_DESCRIPTION_BEGIN<br>!insertmacro MUI_DESCRIPTION_TEXT ${Section1} ""<br>!insertmacro MUI_FUNCTION_DESCRIPTION_END<br><br>;Uninstall section<br><br>UninstallText "This will uninstall TouchFin. Hit next to continue."<br>;UninstallIcon "C:\XXXInstall\Tf32.ico"<br><br>Section Uninstall<br>;Remove from registry...<br>DeleteRegKey HKLM "Software\Microsoft\Windows\CurrentVersion\Uninstall\${APPNAME}"<br>DeleteRegKey HKLM "SOFTWARE\${APPNAME}"<br>; Delete self<br>Delete "$INSTDIR\uninstall.exe"<br>; Delete Shortcuts<br>Delete "$DESKTOP\TouchFinL.lnk"<br>Delete "$SMPROGRAMS\TouchFinL\TouchFinL.lnk"<br>Delete "$SMPROGRAMS\TouchFinL\Uninstall.lnk"<br>; Clean up TouchFinL<br>Delete "$INSTDIR\MDAC_TYP.EXE"<br>Delete "$INSTDIR\MyPrintTFL.dll"<br>Delete "$INSTDIR\TFDB.tfb"<br>Delete "$INSTDIR\TouchFinL.exe"<br>Delete "$INSTDIR\wininet.dll"<br>; Remove remaining directories<br>RMDir "$SMPROGRAMS\TouchFinL"<br>RMDir "$INSTDIR\"<br><br>SectionEnd</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">glory_man</span><br><span class="post-time small text-muted">21st April 2005 11:27 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Use !define MUI_ICON and !define MUI_UNICON to set icons for installer and uninstaller (instead Icon and UnInstallIcon).<br><br>Add:<br>Are you sure - extension of your installer icon is .io?</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Petkop</span><br><span class="post-time small text-muted">21st April 2005 16:05 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Thank You. The extention is .ico.</p></div><hr><div class="footer"><p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p></div></div><script src="../js/highlight.pack.js" type="text/javascript"></script><script type="text/javascript">//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]></script></body></html>