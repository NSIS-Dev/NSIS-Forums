<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content=".Net installation of specific version" />

  <title>.Net installation of specific version - NSIS Forums</title>
  <script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script>
  <!-- Bootstrap core CSS -->

  <link rel="stylesheet" type="text/css" href="//netdna.bootstrapcdn.com/bootswatch/3.0.1/readable/bootstrap.min.css" />
  <link rel="stylesheet" href="../css/style.css" type="text/css" /><!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!--[if lt IE 9]>
                <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
                <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->
</head>

<body>
  <div class="container">
    <!-- Put navigation bar here -->

    <ol class="breadcrumb">
      <li><a href="../index.html" class="glyphicon glyphicon-home"></a></li>

      <li><a href="f-65.html">NSIS Discussion</a></li>

      <li class="active">.Net installation of specific version</li>
    </ol>

    <p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=237435">.Net installation of specific version</a></p><br />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">flakzeus</span><br />
      <span class="post-time small text-muted">7th February 2006 20:03 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>.Net installation of specific version</strong><br />
      Could someone look over this function and tell me what is wrong? Basically I want to check and see if the .Net Framework 2.0 is installed, if it is not then install it. It is working up to the point that if 2.0 is already installed it trys to install it anyways. I modified the example they have on the website just a hair.<br />
      <br />
      Thank you<br />
      <br />
      Function .onInit<br />
      Call GetDotNETVersion<br />
      Pop $0<br />
      ${If} $0 == "not found"<br />
      MessageBox MB_OKCANCEL "We have detected that you do not have Microsoft .NET Framework 2.0 Installed. Press OK to install .NET Framework." IDOK installNET IDCANCEL 0<br />
      Abort<br />
      ${EndIf}<br />
      <br />
      StrCpy $0 $0 "" 1 # skip "v"<br />
      <br />
      ${VersionCompare} $0 "2.0" $1<br />
      ${If} $1 == 2<br />
      MessageBox MB_OKCANCEL "We have detected that you do not have Microsoft .NET Framework 2.0 Installed. Press OK to install .NET Framework." IDOK installNET IDCANCEL 0<br />
      Abort<br />
      ${EndIf}<br />
      installNET:<br />
      SetOutPath "$INSTDIR\bin"<br />
      SetOverwrite ifnewer<br />
      File "c:\Program Files\Progam\bin\dotnetfx.exe"<br />
      ExecWait '"$INSTDIR\bin\dotnetfx.exe"'<br />
      FunctionEnd<br />
      <br />
      Function GetDotNETVersion<br />
      Push $0<br />
      Push $1<br />
      <br />
      System::Call "mscoree::GetCORVersion(w .r0, i ${NSIS_MAX_STRLEN}, *i) i .r1"<br />
      StrCmp $1 "error" 0 +2<br />
      StrCpy $0 "not found"<br />
      <br />
      Pop $1<br />
      Exch $0<br />
      FunctionEnd</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
      <span class="post-time small text-muted">10th February 2006 10:05 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">You overwrite the result of GetDotNETVersion with nothing, if .NET is installed. You should use LogicLib (${If}, ${AndIf}, etc.) for the entire logic of that function.</p>
    </div>
    <hr />

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]>
  </script>
</body>
</html>
