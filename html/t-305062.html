<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="description" content="How do I create a simple installer to copy files to multiple directories?"><title>How do I create a simple installer to copy files to multiple directories? - NSIS Forums</title><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script><link rel="preload" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css" as="style" onload="this.rel='stylesheet'"><link rel="preload" href="../css/style.css" as="style" onload="this.rel='stylesheet'"><noscript><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css"><link rel="stylesheet" href="../css/style.css"></noscript><script>!function(a){"use strict";var b=function(b,c,d){function e(a){return h.body?a():void setTimeout(function(){e(a)})}function f(){i.addEventListener&&i.removeEventListener("load",f),i.media=d||"all"}var g,h=a.document,i=h.createElement("link");if(c)g=c;else{var j=(h.body||h.getElementsByTagName("head")[0]).childNodes;g=j[j.length-1]}var k=h.styleSheets;i.rel="stylesheet",i.href=b,i.media="only x",e(function(){g.parentNode.insertBefore(i,c?g:g.nextSibling)});var l=function(a){for(var b=i.href,c=k.length;c--;)if(k[c].href===b)return a();setTimeout(function(){l(a)})};return i.addEventListener&&i.addEventListener("load",f),i.onloadcssdefined=l,l(f),i};"undefined"!=typeof exports?exports.loadCSS=b:a.loadCSS=b}("undefined"!=typeof global?global:this);!function(a){if(a.loadCSS){var b=loadCSS.relpreload={};if(b.support=function(){try{return a.document.createElement("link").relList.supports("preload")}catch(b){return!1}},b.poly=function(){for(var b=a.document.getElementsByTagName("link"),c=0;c<b.length;c++){var d=b[c];"preload"===d.rel&&"style"===d.getAttribute("as")&&(a.loadCSS(d.href,d,d.getAttribute("media")),d.rel=null)}},!b.support()){b.poly();var c=a.setInterval(b.poly,300);a.addEventListener&&a.addEventListener("load",function(){b.poly(),a.clearInterval(c)}),a.attachEvent&&a.attachEvent("onload",function(){a.clearInterval(c)})}}}(this);</script></head><body><div class="container"><ol class="breadcrumb"><li><a href="../index.html" class="glyphicon glyphicon-home"></a></li><li><a href="f-65.html">NSIS Discussion</a></li><li class="active">How do I create a simple installer to copy files to multiple directories?</li></ol><p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=305062">How do I create a simple installer to copy files to multiple directories?</a></p><br><div class="post"><p class="post-meta"><span class="post-author text-primary">Panarchy</span><br><span class="post-time small text-muted">7th April 2009 08:36 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>How do I create a simple installer to copy files to multiple directories?</strong><br>Hello<br><br>I would like to know how to create a simple installer using NSIS which will, at launch of setup, ask me to choose (from a Drop down list or radio buttons) which Operating System I am installing it on (or could auto-detect this?).<br><br>Firstly, I'll explain what I need done.<br><br>I need 2 files (.exe and .ini) copied to the following directories;<br><br>On Windows (XP, Server 2003 and everything before);[list=1][*]%WINDIR%\servicepackfiles\i386[*]%WINDIR%\system32\dllcache[*]%WINDIR%\system32[*]%WINDIR%[/list=1]On New Windows! (Vista, Win7, Server 2008 etc. including x64);[list=1][*]%WINDIR%[*]%WINDIR% \servicepackfiles\i386[*]%WINDIR% \system32\dllcache[*]%WINDIR%\SysWOW64 - (NOTE: Probably only on Vista x64)[*]%WINDIR%\winsxs\amd64_microsoft-windows-notepad_31bf3856ad364e35_6.0.6001.18000_none_cb3928ff285d2ca9 - (NOTE: Probably only on Vista x64)[*]%WINDIR%\winsxs\amd64_microsoft-windows-notepadwin_31bf3856ad364e35_6.0.6001.18000_none_9ee86862b36a7eff - (NOTE: Probably only on Vista x64)[*]%WINDIR%\winsxs\x86_microsoft-windows-notepad_31bf3856ad364e35_6.0.6001.18000_none_6f1a8d7b6fffbb73[/list=1]Any advice on how I could do this would be truly appreciated.<br><br>Thanks in advance,<br><br>Panarchy</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">sgiusto</span><br><span class="post-time small text-muted">7th April 2009 10:12 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Hello,<br>the SetOutPath command is used to specify the destination folder of files and the constants $WINDIR and $SYSDIR contain the windows and system folder of the system you are installing on.<br>Search nsis site for GetWindowsVersion macro that detects the windows version you are running on.<br>Last but not least RTFM!<br>These are baisc features and are well documented.<br>Regards<br>Stefano</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Panarchy</span><br><span class="post-time small text-muted">7th April 2009 13:07 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Thanks, I'll research what you have described!<br><br>Documentation wasn't simple...</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Panarchy</span><br><span class="post-time small text-muted">7th April 2009 13:35 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Okay, well here is what I've worked out so far.<br><br>Please tell me what I am doing wrong;</p><pre>
<code>Name "Notepad2"<br>OutFile "Notepad2 Setup.exe"<br><br>LicenseText "You must agree to this license before installing."<br>LicenseData "license.txt"<br><br><br>InstallDir "$WINDIR"<br>InstallDir "$WINDIR\servicepackfiles\i386"<br>InstallDir "$WINDIR\system32\dllcache"<br>InstallDir "$WINDIR\system32"<br>DirShow hide ; (make this show to let the user change it)<br>DirText "Select the directory to install myApp in:"<br><br>Section "" ; (default section)<br>SetOutPath "$INSTDIR"<br><br>File /-y notepad.exe<br>File /-y notepad.ini<br><br>SectionEnd ; end of default section<br><br><br>; eof</code>
</pre>Thanks in advance,<br>
      <br>
      Panarchy
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br>
      <span class="post-time small text-muted">7th April 2009 14:54 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">You only use InstallDir once to set the default installation directory for the Directory page. You aren't even using a Directory page so you shouldn't be using it. Just use SetOutPath on the 4 directories with the 2 File instructions after each. Also, what is /-y? There is no such switch for the File instruction.<br>
      <br>
      This is a much better install.<br></p>
      <pre>
<code><br>!include MUI2.nsh<br><br>Name `Notepad2`<br>OutFile `Notepad2 Setup.exe`<br><br>!insertmacro MUI_PAGE_WELCOME<br>!insertmacro MUI_PAGE_LICENSE license.txt<br>!insertmacro MUI_PAGE_INSTFILES<br>!insertmacro MUI_PAGE_FINISH<br><br>!insertmacro MUI_LANGUAGE English<br><br>Section<br><br>  !macro ExtractNotepad2 ToDir<br>    SetOutPath `${ToDir}`<br>    File notepad.exe<br>    File notepad.ini<br>  !macroend<br><br>  !insertmacro ExtractNotepad2 $WINDIR<br>  !insertmacro ExtractNotepad2 $WINDIR\servicepackfiles\i386<br>  !insertmacro ExtractNotepad2 $SYSDIR\dllcache<br>  !insertmacro ExtractNotepad2 $SYSDIR<br><br>SectionEnd</code>
</pre><br>
      <br>
      Stu
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Panarchy</span><br>
      <span class="post-time small text-muted">7th April 2009 15:24 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Sweet!<br>
      <br>
      Nice, smaller, a little harder to understand, but all in all much better then my 1st attempt.<br>
      <br>
      Almost perfect!<br>
      <br>
      Thanks for your help, now I just need to work out how to make it install differently when installed on Vista, Server 2008 &amp; Windows 7.<br>
      <br>
      If you know how I can do so, without creating a separate installer, please tell me!<br>
      <br></p>

      <blockquote>
        [The] GetWindowsVersion macro detects the windows version you are running
      </blockquote>Perhaps this can be used?<br>
      <br>
      Thanks in advance for any extra advice,<br>
      <br>
      Panarchy<br>
      <br>
      PS: Once again, thank you for what you have posted!
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br>
      <span class="post-time small text-muted">7th April 2009 17:12 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">You should just need to add RequestExecutionLevel user or RequestExecutionLevel admin in there.<br>
      Read it up in the manual.<br>
      <br>
      Stu</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Panarchy</span><br>
      <span class="post-time small text-muted">8th April 2009 03:33 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Thanks, I'll do that.<br>
      <br>
      In the meantime, I'm getting some errors with the unedited script you wrote;<br></p>
      <pre>
<code>Error in macro MUI_PAGEDECLARATION_LICENSE on macroline 17<br>Error in macro MUI_PAGE_LICENSE on macroline 6<br>Error in script "C:\Users\Panarchy\Documents\Almost Perfect.nsi" on line 7 -- aborting creation process</code>
</pre><br>
      <br>
      Please tell me how to fix them.<br>
      <br>
      Thanks in advance,<br>
      <br>
      Panarchy<br>
      <br>
      PS: Where should I put notepad.exe and notepad.ini?
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Panarchy</span><br>
      <span class="post-time small text-muted">11th April 2009 15:42 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">*bump*</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Comperio</span><br>
      <span class="post-time small text-muted">11th April 2009 16:27 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">For your last two questions:<br>
      I assume that your MUI error is that the file 'license.txt' does not exist in your MUI folder.<br>
      <br>
      Also, the files notepad.exe and notepad.ini should be in the same folder as your script (unless you specific the full path to the file.) This is explained in the main NSIS help for the FILE command. (a copy of it is found here: <a href="http://nsis.sourceforge.net/Docs/Chapter4.html#4.9.1.5" target="_blank">http://nsis.sourceforge.net/Docs/Chapter4.html#4.9.1.5</a>)<br>
      <br>
      And for usage about WinVer, have a look inside the main header file--WinVer.nsh--found in the includes folder of you NSIS install.<br>
      <br>
      For other help, you should consider spending some time browsing your NSIS installation folder (especially look a the DOCS and EXAMPLES folders--there's some good documentation and examples for MUI that will explain each command in detail.) You might also want to take some time reading through the <a href="http://nsis.sourceforge.net/FAQ" target="_blank">FAQs</a> on the wiki.</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Panarchy</span><br>
      <span class="post-time small text-muted">12th April 2009 00:38 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Thanks, will do.</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Panarchy</span><br>
      <span class="post-time small text-muted">13th April 2009 06:11 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Hello<br>
      <br>
      Okay, everything now works pretty much perfectly, however I would like to customise a few things.<br>
      <br>
      Any idea how I can change the following text?<br>
      <a href="http://i39.tinypic.com/35hrear.jpg" target="_blank">http://i39.tinypic.com/35hrear.jpg</a><br>
      <br>
      Would really appreciate any suggestions.<br>
      <br>
      Thanks in advance,<br>
      <br>
      Panarchy</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Panarchy</span><br>
      <span class="post-time small text-muted">17th April 2009 14:50 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">*bump*</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br>
      <span class="post-time small text-muted">17th April 2009 17:48 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">There is much you can learn by reading the docs.<br>
      !define MUI_LICENSEPAGE_TEXT_BOTTOM `my text`<br>
      BrandingText `my text`<br>
      <br>
      Stu</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Panarchy</span><br>
      <span class="post-time small text-muted">18th April 2009 05:15 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Thanks for your reply.<br>
      <br>
      The BrandingText one works, however this one;<br>
      !define MUI_LICENSEPAGE_TEXT_BOTTOM `my text<br>
      <br>
      Doesn't.<br>
      <br>
      Please tell me how to get the 2nd one to work.<br>
      <br>
      Thanks in advance,<br>
      <br>
      Panarchy<br>
      <br>
      PS: Thanks for the BrandingText one, really appreciate it.`</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br>
      <span class="post-time small text-muted">18th April 2009 13:30 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Have you put the define before inserting the page macros?<br>
      <br>
      Stu</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Panarchy</span><br>
      <span class="post-time small text-muted">18th April 2009 15:29 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Thanks, that did the job.<br>
      <br>
      Would it also be possible to change the following text?;<br>
      <br>
      <a href="http://i40.tinypic.com/2j4c7zm.jpg" target="_blank">http://i40.tinypic.com/2j4c7zm.jpg</a><br>
      <br>
      And also to make the font size bigger (much bigger). Alternatively if you can tell me how to create another page in the wizard, one which I can use as a CAUTION page telling the user that it will replace Notepad with Notepad2.<br>
      <br>
      Thanks in advance for any extra help,<br>
      <br>
      Panarchy<br>
      <br>
      PS: Thanks once again for all you've helped me with!</p>
    </div>
    <hr>

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script type="text/javascript" src="../js/highlight.pack.js" async>
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]></script></body></html>