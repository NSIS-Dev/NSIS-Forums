<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="Plugins don't keep their timestamp, setup.exe differs" />

  <title>Plugins don't keep their timestamp, setup.exe differs - NSIS Forums</title><!-- Bootstrap core CSS -->
  <link rel="stylesheet" type="text/css" href="//netdna.bootstrapcdn.com/bootswatch/3.0.1/readable/bootstrap.min.css" />
  <link rel="stylesheet" href="../css/style.css" type="text/css" /><!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!--[if lt IE 9]>
                <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
                <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->
</head>

<body>
  <div class="container">
    <!-- Put navigation bar here -->

    <ol class="breadcrumb">
      <li><a href="../index.html" class="glyphicon glyphicon-home"></a></li>

      <li><a href="f-65.html">NSIS Discussion</a></li>

      <li class="active">Plugins don't keep their timestamp, setup.exe differs</li>
    </ol>

    <p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=321485">Plugins don't keep their timestamp, setup.exe differs</a></p><br />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">demiller9</span><br />
      <span class="post-time small text-muted">7th August 2010 19:46 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>Plugins don't keep their timestamp, setup.exe differs</strong><br />
      Dlls (plugins) added to the installer do not keep their original timestamp. This causes the resulting setup.exe to differ, even though all the payload files and script that created the exe are identical.<br />
      <br />
      I've looked at the NSIS source, and think the problem is in script.cpp at the line that sets build_datesave to 0</p>
      <pre>
<code><font color="blue">case</font> TOK__PLUGINCOMMAND <br />...<br /><font color="blue">int</font> old_build_datesave=build_datesave;<br />build_datesave=<font color="red">0</font>;<font color="green">// off</font><br />ret=do_add_file(dllPath.c_str(),0,0,&amp;files_added,tempDLL,2,&amp;data_handle); <font color="green">// 2 means no size add</font><br />...<br />build_datesave=old_build_datesave;</code>
</pre><br />
      There may be other code changes needed (I don't know all the details of NSIS operation that well), perhaps to set the timestamp when PLUGINSDIR is written.<br />
      <br />
      I'll submit a bug tracker for this.<br />
      <br />
      Don
    </div>
    <hr />

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]>
  </script>
</body>
</html>
