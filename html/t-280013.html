<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="description" content="Going MORE than Slightly Mad"><title>Going MORE than Slightly Mad - NSIS Forums</title><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script><link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css"><link rel="stylesheet" href="../css/style.css" type="text/css"></head><body><div class="container"><ol class="breadcrumb"><li><a href="../index.html" class="glyphicon glyphicon-home"></a></li><li><a href="f-65.html">NSIS Discussion</a></li><li class="active">Going MORE than Slightly Mad</li></ol><p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=280013">Going MORE than Slightly Mad</a></p><br><div class="post"><p class="post-meta"><span class="post-author text-primary">sharkystar</span><br><span class="post-time small text-muted">26th October 2007 06:34 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>Going MORE than Slightly Mad</strong><br>&nbsp; Hi Guys<br><br>Approximately 12 hours into my installer script, I now have no finger nails on my left hand (from nervous biting), and have been pulling large clumps of hair from my head for the past 2 hours.<br><br>My problem is thus:<br>I am using an HTTP POST request to a server to verify a product key. I have downloaded the PassDialog plugin which works great, except that all the examples simply end by generating a message box with what the user entered. So, I wrote a function to verify if the server response was good or bad. So far so good!<br><br>If the server response is bad I simply call the custom page function to return the user back to the product key page to have another go. Well, this works the first time round, but the second attempt sends the user on to the install page. This is BAD!<br><br>Can someone PLEASE explain to me how I keep this loop going until a good server response is generated?<br><br>At this rate I will be down to the bone on my fingers and will have to wear a hat to work today to cover up all the bald spots....please, please HELP.<br><br>NSI is attached - Thanks</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">pospec</span><br><span class="post-time small text-muted">26th October 2007 07:41 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">I see that you call <font face="courier new">verify</font> function by <font face="courier new">Page Custom verify</font>. Try to do verification in <font face="courier new">SerialPageLeave</font> function and if verification is "BAD" then reload your "SerialPage". Use <a href="http://nsis.sourceforge.net/Go_to_a_NSIS_page" target="_blank">RelGotoPage</a> for reloading pages.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br><span class="post-time small text-muted">26th October 2007 10:54 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">To go back to the serial page, call Abort. Do NOT call the function again. Similarely, you should only use RelGotoPage (WM_NOTIFY_OUTER_NEXT) if you have no other option.<br><br>Stu</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">pospec</span><br><span class="post-time small text-muted">26th October 2007 11:02 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">How simple! I really didn't know about this feature... :rolleyes: Thanks!</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">sharkystar</span><br><span class="post-time small text-muted">26th October 2007 15:41 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Thanks guys for clearing up the Abort vs Call issue. I will use Abort to return to the Serial Page.<br><br>Pospec:<br>Thanks for the advice about the RelGotoPage (WM_NOTIFY_OUTER_NEXT) function. I will give this a go.<br><br>Stu:<br>Can you please clarify something for me...<br>How does the script know it should jump back to the Serial Page simply by calling Abort, and what other options are there to RelGotoPage?<br><br>As far as I can tell, the program flow as it stands is thus:<br>1 Init and Defines<br>2 Standard Welcome Pages<br>3 Custom Serial Pages calling custom functions<br>4 Standard Install Pages which use the Section "Install"<br><br>What I cannot figure out is how to keep the loop going so we stay with the custom functions until a good server response is generated. I seem to be able to do this just once, before the script jumps to the Install section.<br><br>Don't get me wrong, I am an experienced programmer of over ten years, but after using NSIS for only one day, this whole program flow thing has be baffled.....<br><br>Thanks again for your help chaps.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">sharkystar</span><br><span class="post-time small text-muted">26th October 2007 17:19 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Guys<br><br>Thank you so much for your help!<br>After some more learning I have now fixed my script and all is working great.<br><br>Cheers</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br><span class="post-time small text-muted">26th October 2007 17:52 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Just to clarify, when Abort is called in any pages' pre function, it will jump over that page. When Abort is called in any pages' leave function it will go back to the previous page, without reloading it. As custom pages do not have pre functions, calling Abort in their show function has the same effect to skip over the page. You can also simple skip over the InstallOptions/nsDialogs/PassDialog/whatever plug-in call to skip a custom page.<br><br>Stu</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">pospec</span><br><span class="post-time small text-muted">27th October 2007 01:53 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><i>custom pages do not have pre functions</i><br>Really? I am confused if they haven't...<br></p><pre>
<code>MUI_PAGE_CUSTOMFUNCTION_PRE function
<br>&gt;MUI_PAGE_CUSTOMFUNCTION_SHOW function
<br>&gt;MUI_PAGE_CUSTOMFUNCTION_LEAVE function 
</code>
</pre>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Anders</span><br>
      <span class="post-time small text-muted">27th October 2007 02:09 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">custom pages only have create and leave, but you can emulate pre and show in the create function<br>
      <br>
      Function MyCustomPageCreate<br>
      ;PRE code here<br>
      !insertmacro INSTALLOPTIONS_INITDIALOG "ioFile.ini"<br>
      Pop $HWND ;HWND of dialog<br>
      ;SHOW code here<br>
      !insertmacro INSTALLOPTIONS_SHOW<br>
      FunctionEnd<br>
      <br>
      Page Custom MyCustomPageCreate<br>
      <br>
      (If you are using modern ui, you also want to set the header text and stuff probably)</p>
    </div>
    <hr>

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]></script></body></html>