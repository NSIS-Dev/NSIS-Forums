<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="description" content="Online Update"><title>Online Update - NSIS Forums</title><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script><link rel="preload" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css" as="style" onload="this.rel='stylesheet'"><link rel="preload" href="../css/style.css" as="style" onload="this.rel='stylesheet'"><noscript><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css"><link rel="stylesheet" href="../css/style.css"></noscript><script>!function(a){"use strict";var b=function(b,c,d){function e(a){return h.body?a():void setTimeout(function(){e(a)})}function f(){i.addEventListener&&i.removeEventListener("load",f),i.media=d||"all"}var g,h=a.document,i=h.createElement("link");if(c)g=c;else{var j=(h.body||h.getElementsByTagName("head")[0]).childNodes;g=j[j.length-1]}var k=h.styleSheets;i.rel="stylesheet",i.href=b,i.media="only x",e(function(){g.parentNode.insertBefore(i,c?g:g.nextSibling)});var l=function(a){for(var b=i.href,c=k.length;c--;)if(k[c].href===b)return a();setTimeout(function(){l(a)})};return i.addEventListener&&i.addEventListener("load",f),i.onloadcssdefined=l,l(f),i};"undefined"!=typeof exports?exports.loadCSS=b:a.loadCSS=b}("undefined"!=typeof global?global:this);!function(a){if(a.loadCSS){var b=loadCSS.relpreload={};if(b.support=function(){try{return a.document.createElement("link").relList.supports("preload")}catch(b){return!1}},b.poly=function(){for(var b=a.document.getElementsByTagName("link"),c=0;c<b.length;c++){var d=b[c];"preload"===d.rel&&"style"===d.getAttribute("as")&&(a.loadCSS(d.href,d,d.getAttribute("media")),d.rel=null)}},!b.support()){b.poly();var c=a.setInterval(b.poly,300);a.addEventListener&&a.addEventListener("load",function(){b.poly(),a.clearInterval(c)}),a.attachEvent&&a.attachEvent("onload",function(){a.clearInterval(c)})}}}(this);</script></head><body><div class="container"><ol class="breadcrumb"><li><a href="../index.html" class="glyphicon glyphicon-home"></a></li><li><a href="f-65.html">NSIS Discussion</a></li><li class="active">Online Update</li></ol><p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=237749">Online Update</a></p><br><div class="post"><p class="post-meta"><span class="post-author text-primary">NSIS Bee</span><br><span class="post-time small text-muted">11th February 2006 04:38 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>Online Update</strong><br>Is it possible to make a install using NSIS on a CD but then when an update is available the first screen they see tells them "There is a newer version available, click here to update" and it'll download the update instead of installing the old version on the CD? If so, what do I need and any example code would help. Thanks!</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Takhir</span><br><span class="post-time small text-muted">11th February 2006 06:31 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">You can ask server about updates on install start using <a href="http://nsis.sourceforge.net/InetLoad" target="_blank">InetLoad</a> plug-in (included to NSIS distribution NSISdl works in section only). Then you can read available version number from file and display message box followed by next download.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Short Term</span><br><span class="post-time small text-muted">10th March 2006 02:08 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Any example of script please? Or a working generic application that does this, I can't get it to work as Takhir says? Thanks...</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Jamyn</span><br><span class="post-time small text-muted">10th March 2006 03:07 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>Hmmm</strong><br>Not really, because in general, the design of your update mechanisms depend on the components you are trying to update, the OS you will support, etc.<br><br>But a logical outline would be:<br><br>a) Check whether the user is online.<br>a1) if they are not, do you want to prompt to go online, or just skip the update check?<br>a2) if they are, do you want to prompt them to check for updates, or do you want to just go ahead check for updates?<br>a3) If you want to go ahead and check for updates:<br><br>b) Use <a href="http://nsis.sourceforge.net/InetLoad_plug-in" target="_blank">InetLoad</a> or <a href="http://nsis.sourceforge.net/NSISdl_Smooth" target="_blank">NSIS::dl</a> to download an .ini, .xml, or .txt file with current version information from your website.<br><br>c) Compare the internal version number from the copy they currently are running against the version number in the file you downloaded from your website. Preferably you will have the filesize for the new version in the <a href="http://nsis.sourceforge.net/Category:INI%2C_CSV_%26_Registry_Functions" target="_blank">.ini</a>/<a href="http://nsis.sourceforge.net/XML_plug-in" target="_blank">xml</a> as well, for reasons discussed in a sec.<br><br>d) Prompt the user to download a new version. Make sure you save the new version to a writeable medium, in case they are running from CD.<br><br>e) (1) Compare the actual filesize/MD5 whatever against the filesize/<a href="http://nsis.sourceforge.net/MD5_plugin" target="_blank">MD5</a> in the xml file. If they match, the installer you downloaded is probably not corrupt. If they dont, inform the user that their download appears to have failed/been corrupted, and ask them if they want to retry, or just install the old version. Otherwise, if the filesize/MD5 looks good, (2) Hide the window for the old version (on cd), (2) start the new version, (3) exit the old version. Take care not to use the exact same mutex between versions (if you do that sort of thing), or the new copy won't start because your old installer is still running temporarily and has the same mutex.<br><br>Done.<br><br>Now, writing example script to do all those things is not something that most people would write in two or three minutes, so you are unlikely to get a lot of examples here. But the <a href="http://nsis.sourceforge.net/InetLoad_plug-in" target="_blank">InetLoad</a> plugin has plenty of examples, the <a href="http://nsis.sourceforge.net/Category:Internet_Functions" target="_blank">Internet</a> plugins and scripts to detect online status come with some examples, the <a href="http://nsis.sourceforge.net/MD5_plugin" target="_blank">MD5</a> plugin has docs, the <a href="http://nsis.sourceforge.net/XML_plug-in" target="_blank">XML</a> plugin (if you use that) has docs, and if you go with plain .ini files - the <a href="http://nsis.sourceforge.net/Docs/" target="_blank">NSIS manual</a> (and the <a href="http://nsis.sourceforge.net/Developer_Center" target="_blank">NSIS wiki</a>) goes over reading strings from text files.<br><br>Besides - in the process of understanding how to piece together an update system, you'll learn a lot of valuable information about NSIS itself.</p></div><hr><div class="footer"><p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p></div></div><script src="../js/highlight.pack.js" type="text/javascript"></script><script type="text/javascript">//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]></script></body></html>