<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="description" content="Problem with CreateShortCut pointing to Internet pages"><title>Problem with CreateShortCut pointing to Internet pages - NSIS Forums</title><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script><link rel="preload" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css" as="style" onload="this.rel='stylesheet'"><link rel="preload" href="../css/style.css" as="style" onload="this.rel='stylesheet'"><noscript><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css"><link rel="stylesheet" href="../css/style.css"></noscript><script>!function(a){"use strict";var b=function(b,c,d){function e(a){return h.body?a():void setTimeout(function(){e(a)})}function f(){i.addEventListener&&i.removeEventListener("load",f),i.media=d||"all"}var g,h=a.document,i=h.createElement("link");if(c)g=c;else{var j=(h.body||h.getElementsByTagName("head")[0]).childNodes;g=j[j.length-1]}var k=h.styleSheets;i.rel="stylesheet",i.href=b,i.media="only x",e(function(){g.parentNode.insertBefore(i,c?g:g.nextSibling)});var l=function(a){for(var b=i.href,c=k.length;c--;)if(k[c].href===b)return a();setTimeout(function(){l(a)})};return i.addEventListener&&i.addEventListener("load",f),i.onloadcssdefined=l,l(f),i};"undefined"!=typeof exports?exports.loadCSS=b:a.loadCSS=b}("undefined"!=typeof global?global:this);!function(a){if(a.loadCSS){var b=loadCSS.relpreload={};if(b.support=function(){try{return a.document.createElement("link").relList.supports("preload")}catch(b){return!1}},b.poly=function(){for(var b=a.document.getElementsByTagName("link"),c=0;c<b.length;c++){var d=b[c];"preload"===d.rel&&"style"===d.getAttribute("as")&&(a.loadCSS(d.href,d,d.getAttribute("media")),d.rel=null)}},!b.support()){b.poly();var c=a.setInterval(b.poly,300);a.addEventListener&&a.addEventListener("load",function(){b.poly(),a.clearInterval(c)}),a.attachEvent&&a.attachEvent("onload",function(){a.clearInterval(c)})}}}(this);</script></head><body><div class="container"><ol class="breadcrumb"><li><a href="../index.html" class="glyphicon glyphicon-home"></a></li><li><a href="f-65.html">NSIS Discussion</a></li><li class="active">Problem with CreateShortCut pointing to Internet pages</li></ol><p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=58360">Problem with CreateShortCut pointing to Internet pages</a></p><br><div class="post"><p class="post-meta"><span class="post-author text-primary">ametrano</span><br><span class="post-time small text-muted">27th August 2001 11:41 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>Problem with CreateShortCut pointing to Internet pages</strong><br>I have a problem with the following snippet:<br><br>CreateShortCut "$SMPROGRAMS\QuantLib\QuantLib Home Page.lnk" \<br>"http://quantlib.org/index.html"<br><br>When I use the startup menu entry "QuantLib Home Page" I get the followig error:<br>"The file or folder 'quantlib.org/index.html' that this shortcut refers to cannot be found"<br><br>I get the same error with the NSIS installer itself, as it adds a shortcut to the NSIS Home Page that results in:<br>"The file or folder 'nsis/' that this shortcut refers to cannot be found"<br>That shortcut is generated by the following snippet in makensis.nsi:<br><br>CreateShortCut "$SMPROGRAMS\NSIS\NSIS Home Page.lnk" \<br>"http://www.nullsoft.com/free/nsis/"<br><br>thank you in advance for your help<br><br>ciao -- Nando</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">pjw62</span><br><span class="post-time small text-muted">27th August 2001 21:52 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">how very curious.. this works under win2k, but not '98. The easiest solution I could find was to change the likn to `start internet_address`.. BUT, then you dont get the nice icon, and you get a console pop up, which I hate. So you could include .url files in the installer.<br><br>.url files take the format..<br><br>[InternetShortcut]<br>URL=url_goes_here<br><br>e.g.<br>[InternetShortcut]<br>URL=http://www.incomplete.co.uk/nsis.htm<br><br>However, a more desirable solution is to generate these files at run time. Please feel free to use the below script, and please say if you find it useful..<br><br>The delete part is so that an existing link is removed as WriteINIStr concentates enntries/.. while this is not a problem in itself, the user doesn't want to end up with a potential infinitely sized file after an infinite number of installs..<br><br>; file name of URL (_MUST_ be full path otherwise it will be created int he windows directory).<br>strcpy $0 "C:\programs\nsisdll\examples\test.url"<br><br>Delete $0<br>WriteINIStr $0 \<br>"InternetShortcut" "URL" \<br>"http://www.incomplete.co.uk/nsis.htm"</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">DuaneJeffers</span><br><span class="post-time small text-muted">28th August 2001 04:19 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">This works in Win98 and WinME, it might just be your computer. Everything works. And the .url thing will work, but so will the .lnk files. What version of Win32 are you using, and it might be done with/without simple fixes.<br><br>-DJ</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">spaetz</span><br><span class="post-time small text-muted">28th August 2001 12:52 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">It doesn't work on my Win98 computer, but I know how to create these files with NSIS on the fly:<br><br>WriteINIStr "$SMPROGRAMS\Freenet\FN Homepage.url" "InternetShortcut" "URL" "http://www.freenetproject.org"<br><br>Should do the trick...</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">pjw62</span><br><span class="post-time small text-muted">28th August 2001 15:16 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">It doesn't work on my Win98 either.. spaetz.. errm, of course you know how to do it, I just posted that method earlier.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">spaetz</span><br><span class="post-time small text-muted">28th August 2001 15:44 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">oops, I though you had just described the file format and didn't read the post thoroughly enough, my bad. Sorry :-)</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">DuaneJeffers</span><br><span class="post-time small text-muted">29th August 2001 00:31 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Well, I will tell you, it does work for my Win98 and WinME computers. It may just be your guys' computers.<br><br>-DJ</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">pjw62</span><br><span class="post-time small text-muted">29th August 2001 16:16 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">"It may just be your guys' computers." - Win98 comes in several builds, especially once you get installing different internet explorers. It is not my computer, as under win2k pro build 2195 rc3 (final), it works fine.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">ametrano</span><br><span class="post-time small text-muted">11th October 2001 14:07 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>Problem solved</strong><br>Thanks to all who replied.<br><br>I solved the problem thanks to your suggestions. Now the QuantLib open source project ships with the Null Soft Installer (<a href="http://quantlib.org" target="_blank">http://quantlib.org</a>). Here's a snippet from the .nsi file:<br><br>#it doesn't work<br># CreateShortCut "$SMPROGRAMS\QuantLib\QuantLib Home Page.lnk" \<br># "http://quantlib.org/index.html"<br>#this works<br>WriteINIStr "$SMPROGRAMS\QuantLib\QuantLib Home Page.url" \<br>"InternetShortcut" "URL" "http://quantlib.org/"<br><br>I'm using this on WinNT4 patch 6a.<br><br>Since the problem was also with NSIS itself anybody knows how to report this problem to the NSIS developer(s)?<br><br>I would also like to add QuantLib to the list of NSIS users at <a href="http://www.nullsoft.com/free/nsis/users.html," target="_blank">http://www.nullsoft.com/free/nsis/users.html,</a> but I don't know any email address I could use to this effect.<br><br>I haven't understood what pwj62 wrote:<br>&gt; The delete part is so that an existing link is removed as<br>&gt; WriteINIStr concentates enntries/.. while this is not a problem in<br>&gt; itself, the user doesn't want to end up with a potential infinitely<br>&gt; sized file after an infinite number of installs..<br>&gt;<br>&gt;; file name of URL (_MUST_ be full path otherwise it will be<br>&gt; created int he windows directory).<br>&gt; strcpy $0 "C:\programs\nsisdll\examples\test.url"<br>&gt; Delete $0<br>&gt; WriteINIStr $0 \<br>&gt; "InternetShortcut" "URL" \<br>&gt; "http://www.incomplete.co.uk/nsis.htm"<br><br>what's about the delete part? Sorry if this is a naive question.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">ametrano</span><br><span class="post-time small text-muted">11th October 2001 14:16 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">forgot to say I was using NSIS 1.44<br><br>Now updating to 1.55<br><br>ciao -- Nando</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">prodangle</span><br><span class="post-time small text-muted">13th October 2001 15:52 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>Re: Problem solved</strong><br></p><blockquote><i>Originally posted by ametrano</i><br>.................<br><br>I would also like to add QuantLib to the list of NSIS users at <a href="http://www.nullsoft.com/free/nsis/users.html," target="_blank">http://www.nullsoft.com/free/nsis/users.html,</a> but I don't know any email address I could use to this effect.</blockquote>email justin (he's at Nullsoft)</div><hr><div class="footer"><p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p></div></div><script type="text/javascript" src="../js/highlight.pack.js" async></script><script type="text/javascript">//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]></script></body></html>