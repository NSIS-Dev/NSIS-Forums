<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="Unicode string in binary file" />

  <title>Unicode string in binary file - NSIS Forums</title><!-- Bootstrap core CSS -->
  <link rel="stylesheet" type="text/css" href="//netdna.bootstrapcdn.com/bootswatch/3.0.1/readable/bootstrap.min.css" />
  <link rel="stylesheet" href="../css/style.css" type="text/css" /><!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!--[if lt IE 9]>
                <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
                <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->
</head>

<body>
  <div class="container">
    <!-- Put navigation bar here -->

    <ol class="breadcrumb">
      <li><a href="../index.html" class="glyphicon glyphicon-home"></a></li>

      <li><a href="f-65.html">NSIS Discussion</a></li>

      <li class="active">Unicode string in binary file</li>
    </ol>

    <p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=355853">Unicode string in binary file</a></p><br />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">bnicer</span><br />
      <span class="post-time small text-muted">14th February 2013 23:50 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>Unicode string in binary file</strong><br />
      Hello,<br />
      A while ago I built an installer that appended a string of data at the end of the uninstaller file. Something like this:<br />
      <br />
      CUSTDATA:C:\Gallery;1;1033;TIG;0;07022013010946;TN;0;0<br />
      <br />
      It worked fine, but lately I've been thinking about the string. Shouldn't it be converted to unicode, in a unicode installer/uninstaller?<br />
      <br />
      It would make sense, in my view, to convert the string to UTF-8. The problem with UTF-8 is the uninstaller file, that seems to be ansi.<br />
      <br />
      I wonder if there's a way around this. My main worry is that the path data might contain non-Latin-A characters.<br />
      <br />
      Any suggestions would be welcome.<br />
      <br />
      So far I've only tried manually editing text in the uninstaller. Maybe the file can be saved as unicode. Is that possible or advisable or a deadend?<br />
      <br />
      String conversion could be a deadend also when it comes to reading the data for parsing. I'm unsure how FileRead handles UTF-8 in a binary file.<br />
      <br />
      Can anyone help?<br />
      <br />
      Thanks.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
      <span class="post-time small text-muted">3rd March 2013 07:49 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">The <a href="http://www.scratchpaper.com" target="_blank">Unicode fork of NSIS</a> has FileWriteUTF16LE and FileReadUTF16LE. That can solve your situation. The official version of NSIS can only hold ANSI strings (not necessarily latin, but the current codepage), so conversion might not work out.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">bnicer</span><br />
      <span class="post-time small text-muted">9th March 2013 14:00 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">FileWriteUTF16LE is useful for writing the custom string to a UTF-16 file.<br />
      <br />
      I'm just wondering if the user's codepage would convert the custom data string to that system's codepage and would it be safe to write to the uninstaller file.<br />
      <br />
      The codepage converts Latin1 to, for instance Japanese, if the installer is non-unicode. Unicode, in practice, means that Latin1 characters are unchanged. In Japanese 'C:\Gallery' is still 'C:\Gallery', because unicode symbols are in use. If I install with unicode and write 'C:\Gallery' to my data string, the file that I write to must be a unicode file, or else the codepage will convert the string.<br />
      <br />
      It kind of begs the question if 'C:\Gallery' is a valid path in Japanese. I really don't know. I have never worked on a Japanese version of Windows. I'd like to.</p>
    </div>
    <hr />

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]>
  </script>
</body>
</html>
