<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="about KillProcDLL::KillProc" />

  <title>about KillProcDLL::KillProc - NSIS Forums</title><!-- Bootstrap core CSS -->
  <link rel="stylesheet" type="text/css" href="//netdna.bootstrapcdn.com/bootswatch/3.0.1/readable/bootstrap.min.css" />
  <link rel="stylesheet" href="../css/style.css" type="text/css" /><!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!--[if lt IE 9]>
                <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
                <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->
</head>

<body>
  <div class="container">
    <!-- Put navigation bar here -->

    <ol class="breadcrumb">
      <li><a href="../index.html" class="glyphicon glyphicon-home"></a></li>

      <li><a href="f-65.html">NSIS Discussion</a></li>

      <li class="active">about KillProcDLL::KillProc</li>
    </ol>

    <p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=272963">about KillProcDLL::KillProc</a></p><br />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">51819</span><br />
      <span class="post-time small text-muted">17th June 2007 08:30 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>about KillProcDLL::KillProc</strong><br />
      &nbsp; I have tried to use killproc to kill all processes with a name. Inevitably, it kills only one of them with that name. How can I make it kill them all?<br />
      <br />
      Examples:my PC is running 4 programs. I want to use "KillProcDLL::KillProc" to kill all them,when i install/Uninstall.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
      <span class="post-time small text-muted">17th June 2007 09:16 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Perhaps it would be better to use this plugin:<br />
      <a href="http://nsis.sourceforge.net/wiki/Processes_plug-in" target="_blank">http://nsis.sourceforge.net/wiki/Processes_plug-in</a><br />
      Use the FindProcess function in a loop with KillProcess.<br />
      <br />
      Stu</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">51819</span><br />
      <span class="post-time small text-muted">17th June 2007 09:58 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"></p>

      <blockquote>
        <i>Originally posted by Afrow UK</i><br />
        <b>Perhaps it would be better to use this plugin:<br />
        <a href="http://nsis.sourceforge.net/wiki/Processes_plug-in" target="_blank">http://nsis.sourceforge.net/wiki/Processes_plug-in</a><br />
        Use the FindProcess function in a loop with KillProcess.<br />
        <br />
        Stu</b>
      </blockquote>sorry sir.<br />
      I don't konw how to write Use the FindProcess function in a loop with KillProcess.
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
      <span class="post-time small text-muted">17th June 2007 10:22 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"></p>
      <pre>
<code><br />loop:<br />Processes::FindProcess "process_name" ;without ".exe"<br />StrCmp $R0 1 0 done<br /><br />  Processes::KillProcess "process_name" ;without ".exe"<br />  StrCmp $R0 1 loop<br /><br />    MessageBox MB_OKCANCEL|MB_ICONEXCLAMATION "process_name could not be closed.$\r$\nTry again?" IDOK loop<br />    Abort<br /><br />done:<br /></code>
</pre><br />
      <br />
      Stu
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">51819</span><br />
      <span class="post-time small text-muted">17th June 2007 11:46 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"></p>

      <blockquote>
        <i>Originally posted by Afrow UK</i><br />
        <pre>
<b><code><br />loop:<br />Processes::FindProcess "process_name" ;without ".exe"<br />StrCmp $R0 1 0 done<br /><br />  Processes::KillProcess "process_name" ;without ".exe"<br />  StrCmp $R0 1 loop<br /><br />    MessageBox MB_OKCANCEL|MB_ICONEXCLAMATION "process_name could not be closed.$\r$\nTry again?" IDOK loop<br />    Abort<br /><br />done:<br /></code></b>
</pre><b><br />
        <br />
        Stu</b>
      </blockquote>Thank you sir
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Takhir</span><br />
      <span class="post-time small text-muted">17th June 2007 13:51 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">BTW KillProcDLL also returns some value :) To kill them all just use it in loop with "...check out $R0 to get the return value". Plug-in returns 0 if "Process was successfully terminated".</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
      <span class="post-time small text-muted">17th June 2007 14:37 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Ah yes :)<br /></p>
      <pre>
<code><br />loop:<br />KillProcDLL::KillProc "process_name.exe"<br />StrCmp $R0 603 done<br />StrCmp $R0 0 loop<br /><br />    MessageBox MB_OKCANCEL|MB_ICONEXCLAMATION "process_name could not be closed.$\r$\nTry again?" IDOK loop<br />    Abort<br /><br />done:<br /></code>
</pre><br />
      <br />
      Stu
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">vc6</span><br />
      <span class="post-time small text-muted">12th July 2007 03:26 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Hmmm... I was looking for a solution to a similar problem (killing a process before uninstalling (deleting) its .exe) and I luckily found this thread.<br />
      <br />
      However, I am somewhat confused by the code you posted here:<br />
      <br />
      First, the readme.txt that accompanies that plugin demonstrates getting the return code by first popping $R0:<br /></p>
      <pre>
<code>  Processes</code>::KillProcess "process_name"
<br />  Pop $R0
<br /><br />  StrCmp $R0"1" dead_meat why_wont_you_die
<br />    
<br />  dead_meat:
<br />     ...
<br />    
<br /> why_wont_you_die:
<br />    ... 
</pre>However, I tested the code with using the statement Pop $R0 and it seems to work, too. Why? Which is more correct?<br />
      <br />
      Thanks,<br />
      Victor
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
      <span class="post-time small text-muted">12th July 2007 12:16 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">My code is wrong. You need to Pop $R0 with Processes, but KillProcDll simply puts its output into $R0 (without using pushstring internally).<br />
      <br />
      Stu</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">zanz</span><br />
      <span class="post-time small text-muted">24th July 2008 19:38 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">I have an issue where I need to launch an *.exe but need to kill the running process first.<br />
      <br />
      The issue is the timing. Sometimes it takes a few sections to kill the running process and the *.exe gets launched from within the script (while the process has not been killed).<br />
      <br />
      Further, I need to launch the *.exe silently. Using a loop to kill the process is not feasible for this situation (Iâ€™m concerned about a condition failing and my installation getting stuck in a loop â€“ all silently). Is there an alternative? Something similar to ExecWait (where the script would wait to execute the next line until the process has been killed).<br />
      Thanks!</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">LoRd_MuldeR</span><br />
      <span class="post-time small text-muted">24th July 2008 19:45 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">You could try the "KillProc" plugin instead of "KillProcDLL" here:<br />
      <a href="http://nsis.sourceforge.net/KillProc_plug-in" target="_blank">http://nsis.sourceforge.net/KillProc_plug-in</a><br />
      <br />
      It should be able to kill 'em all <a href="http://www.airborneranger.com/forums/style_emoticons/dark/headbang.gif" target="_blank">http://www.airborneranger.com/forums...k/headbang.gif</a></p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">zanz</span><br />
      <span class="post-time small text-muted">25th July 2008 02:07 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">This seems like a good plugin, something I was trying to write.<br />
      I will give it a try in a day or so. Thanks for the pointer!</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">LoRd_MuldeR</span><br />
      <span class="post-time small text-muted">25th July 2008 02:11 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"></p>

      <blockquote>
        <i>Originally posted by zanz</i><br />
        <b>This seems like a good plugin, something I was trying to write.<br />
        I will give it a try in a day or so. Thanks for the pointer!</b>
      </blockquote>Be aware: This was tested on WinXP only, never tested it on Vista...
    </div>
    <hr />

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]>
  </script>
</body>
</html>