<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="Invalid filehandle 123" />

  <title>Invalid filehandle 123 - NSIS Forums</title><!-- Bootstrap core CSS -->
  <link rel="stylesheet" type="text/css" href="//netdna.bootstrapcdn.com/bootswatch/3.0.1/readable/bootstrap.min.css" />
  <link rel="stylesheet" href="../css/style.css" type="text/css" /><!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!--[if lt IE 9]>
                <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
                <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->
</head>

<body>
  <div class="container">
    <!-- Put navigation bar here -->

    <ol class="breadcrumb">
      <li><a href="../index.html" class="glyphicon glyphicon-home"></a></li>

      <li><a href="f-65.html">NSIS Discussion</a></li>

      <li class="active">Invalid filehandle 123</li>
    </ol>

    <p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=249630">Invalid filehandle 123</a></p><br />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Yathosho</span><br />
      <span class="post-time small text-muted">25th June 2006 19:14 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>Invalid filehandle 123</strong><br />
      whenever i'm running my script, i'm getting the error-message "Invalid file handle 123".<br />
      <br />
      i've modified the line 65 of <a href="http://nsis.sourceforge.net/Register_Fonts" target="_blank">FontReg.nsh</a> to<br />
      <br />
      <i>CopyFiles '${FontFile}' '$FONT_DIR\${FontFileName}'</i>.<br />
      <br />
      i checked the input-file for the macro and don't see why this shall not work. any clues?</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Comperio</span><br />
      <span class="post-time small text-muted">26th June 2006 04:34 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Is ${FontFileName} an actual file name?<br />
      <br />
      The reason I ask is that I thought CopyFiles needed a file name and a folder name as parameters. The way I'm reading your example, it looks as if you supplied 2 file names.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
      <span class="post-time small text-muted">26th June 2006 09:57 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">The destination parameter for CopyFiles requires the full path to the file name to be copied as.<br />
      Having a folder name works, but if that folder doesn't exist it will create the file of that folder name instead.<br />
      <br />
      -Stu</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Yathosho</span><br />
      <span class="post-time small text-muted">27th June 2006 18:31 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">thanks for the response, seems like it was a tiny <b>"</b> that caused the mistake :rolleyes:</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Yathosho</span><br />
      <span class="post-time small text-muted">28th June 2006 19:30 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">unfortunately, the errors still occurs. the reason why i replaced that line from <i>FontReg.nsh</i> is, that the font i want to install is stored in a variable.<br />
      <br />
      in order to find the mistake, i replaced the variable with "path/to/font.ttf" and the error-message changes to "MappedFile error: 1006".<br />
      <br />
      i've added a messagebox displaying..<br />
      <br />
      <i>${FontFile}</i>: "C:\MyDir\myfont.ttf"<br />
      <i>$FONT_DIR</i>: C:\MyDir\myfont.ttf<br />
      <i>${FontFileName}</i>: myfont.ttf"<br />
      <br />
      ..please mind the quotes!<br />
      <br />
      i don't understand why they get messed up like this and why i still get this error replacing the variable with a path to my font. any clues?</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Yathosho</span><br />
      <span class="post-time small text-muted">29th June 2006 17:27 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">it's all working now, problem was in the a later fontname macro</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Yathosho</span><br />
      <span class="post-time small text-muted">29th July 2006 23:47 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">once again i'm getting <b>MappedFile error: 1006</b> when using the following script<br /></p>
      <pre>
<code>  GetTempFileName $TempFile<br />  ReadEnvStr $R1 COMSPEC<br />  nsExec::Exec '"$R1" /C dir "$Input\*.ttf" /a-d /b /s /on&gt;$TempFile"'<br />  <br />  StrCpy $FONT_DIR $FONTS<br />  StrCpy "$Counter" "1"<br /><br /> Loop:<br />  ${LineRead} "$TempFile" "$Counter" "$Line" ;${LineRead} "[File]" "[LineNumber]" $var<br />  IfErrors PostEnd<br /><br />  Push $Line<br />  Call TrimNewlines<br />  Pop $Line<br /><br />  Push $Line<br />  Call GetName<br />  Pop $File<br />  <br />  IfFileExists "$Line" 0 +3<br />  MessageBox MB_OK "Yay!"<br />  Goto +3<br />  MessageBox MB_OK "Nay!"<br />  Quit<br /><br />  !insertmacro InstallTTF "$Line"<br />  SendMessage ${HWND_BROADCAST} ${WM_FONTCHANGE} 0 0 /TIMEOUT=5000<br />  <br />  IntOp $Counter $Counter + 1<br />  Goto Loop</code>
</pre><br />
      <br />
      what i don't understand about it, IfFileExists is always reporting "Yay!", but only one font from the $TempFile is being installed. once it's reading line 2 i get that error. what am i doing wrong?!
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
      <span class="post-time small text-muted">30th July 2006 00:24 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Why are you using the dir command to list the font files? Why not use FindFirst, FindNext etc. It would be much easier.<br />
      <br />
      -Stu</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Yathosho</span><br />
      <span class="post-time small text-muted">30th July 2006 00:28 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">good point. i actually used this from another script of mine where i needed a sorted list (a-z) :)</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
      <span class="post-time small text-muted">30th July 2006 00:39 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">It may be safer to use an array (NSISArray) to sort it, but dir exists on all systems to my knowledge. It's still a bit unprofessional though I'd say, as you're relying on another executable for the installer to function correctly.<br />
      <br />
      Here's another thing:<br />
      You're using GetName and Popping $File from it, yet you're using $Line afterwards. Surely you should be using $File?<br />
      <br />
      Congrats if this is fixed. I'm drunk :p<br />
      <br />
      -Stu</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Yathosho</span><br />
      <span class="post-time small text-muted">30th July 2006 01:58 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">it's working, had to change the FontName function</p>
    </div>
    <hr />

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]>
  </script>
</body>
</html>
