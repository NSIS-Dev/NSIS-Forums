<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="How can I uninstall and install again with multi language" />

  <title>How can I uninstall and install again with multi language - NSIS Forums</title>
  <script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script>
  <!-- Bootstrap core CSS -->

  <link rel="stylesheet" type="text/css" href="//netdna.bootstrapcdn.com/bootswatch/3.0.1/readable/bootstrap.min.css" />
  <link rel="stylesheet" href="../css/style.css" type="text/css" /><!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!--[if lt IE 9]>
                <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
                <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->
</head>

<body>
  <div class="container">
    <!-- Put navigation bar here -->

    <ol class="breadcrumb">
      <li><a href="../index.html" class="glyphicon glyphicon-home"></a></li>

      <li><a href="f-65.html">NSIS Discussion</a></li>

      <li class="active">How can I uninstall and install again with multi language</li>
    </ol>

    <p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=259064">How can I uninstall and install again with multi language</a></p><br />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">sunlight112</span><br />
      <span class="post-time small text-muted">7th November 2006 09:31 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>How can I uninstall and install again with multi language</strong><br />
      After finishing install with multi language,I want to check my software is installed or not on computer if user install is again.If is installed, I will uninstall and run new version. I search and see on <a href="http://nsis.sourceforge.net/Auto-uninstall_old_before_installing_new" target="_blank">Wiki</a> . In my installer, I work with many language. If I put it on Init, I can not display many languages which I allow user choose. I think uninstall is finished, id of every language is stored and run my application with the same language which I installed in old version. I put function on this link above on function to call them. But I can not know where I can put it.<br /></p>
      <pre>
<code><font color="green"><font size="2"><br />Function Remove<br />  ReadRegStr $R0 HKLM \<br />  "SOFTWARE\Microsoft\Windows\CurrentVersion\Uninstall\${PRODUCT_NAME}" \<br />  "UninstallString"<br />  StrCmp $R0 "" done<br />       MessageBox MB_OKCANCEL|MB_ICONEXCLAMATION \<br />             "${PRODUCT_NAME} is already installed. $\n$\nClick `OK` to remove the \<br />              previous version or `Cancel` to cancel this upgrade." \<br />       IDOK uninst<br />       Abort<br />;Run the uninstaller<br />uninst:<br />  ClearErrors<br />  Exec '$R0' ;Do not copy the uninstaller to a temp file<br />  IfErrors no_remove_uninstaller<br />  no_remove_uninstaller:<br /><br />  done:<br />FunctionEnd</font><br /></font></code>
</pre><br />
      Please help me!<br />
      My word is very bad, If you do not clear, please tell me!!!<br />
      Thank a million!<br />
      :p
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">sunlight112</span><br />
      <span class="post-time small text-muted">8th November 2006 01:18 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">If someone used to see this problem, please help me!!!<br />
      Your help is very useful for me!<br />
      Thank a lot!</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">sunlight112</span><br />
      <span class="post-time small text-muted">8th November 2006 06:25 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">I want to make clearly about my idea.<br />
      After I install my software, user continue to install my application to update. I must ask them to uninstall old version and install new one.<br />
      My problem is here:<br />
      When user uninstall my program, install program will execute. Because my program use with multi languages. The process install to continue but it does not allow for user to choose language which they want to install.<br />
      I try my best to solve but I can not.<br />
      I need your help too much if you can show me some solutions.<br />
      Thank a lot,</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">sunlight112</span><br />
      <span class="post-time small text-muted">8th November 2006 07:27 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Actually, I do not know exactly where I can put function<font color="red">Call remove</font>.If I put it here, I can not display multi language. However, I do not put it there, I can check old version.<br /></p>
      <pre>
<code><br />Function .onInit<br /><font color="green">  Call Remove </font><br />  !insertmacro MUI_LANGDLL_DISPLAY<br />FunctionEnd<br /><br />Function Remove<br />  ReadRegStr $R0 HKLM \<br />  "SOFTWARE\Microsoft\Windows\CurrentVersion\Uninstall\${PRODUCT_NAME}" \<br />  "UninstallString"<br />  StrCmp $R0 "" done<br />       MessageBox MB_OKCANCEL|MB_ICONEXCLAMATION \<br />             "${PRODUCT_NAME} is already installed. $\n$\nClick `OK` to remove the \<br />              previous version or `Cancel` to cancel this upgrade." \<br />       IDOK uninst<br />       Abort<br />;Run the uninstaller<br />uninst:<br />  ClearErrors<br />  Exec '$R0' ;Do not copy the uninstaller to a temp file<br />  IfErrors no_remove_uninstaller<br />    ;You can either use Delete /REBOOTOK in the uninstaller or add some code<br />    ;here to remove the uninstaller. Use a registry key to check<br />    ;whether the user has chosen to uninstall. If you are using an uninstaller<br />    ;components page, make sure all sections are uninstalled.<br />  no_remove_uninstaller:<br /><br />  done:<br />FunctionEnd<br />[/SIZE]<br /></code>
</pre><br />
      Please help me!!!
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">bholliger</span><br />
      <span class="post-time small text-muted">8th November 2006 08:50 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Hi sunlight112!<br />
      <br />
      I'm really sorry, I've been reading your post twice, but I'm sure, I haven't understand.<br />
      <br />
      I suggest moving the LangDll-Dialog in front. Why is this a problem for you?<br />
      <br /></p>
      <pre>
<code><br />Function .onInit<br />  !insertmacro MUI_LANGDLL_DISPLAY<br />  Call Remove <br />FunctionEnd<br /></code>
</pre><br />
      <br />
      First the installer ask for the language and checks for an existing installation.<br />
      <br />
      Cheers<br />
      <br />
      Bruno
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">sunlight112</span><br />
      <span class="post-time small text-muted">8th November 2006 10:59 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Thank bholliger for your reply,<br />
      I am so sorry about it.<br />
      My problem is : If old program is installed. I want to uninstall old version before I install new version.<br />
      After I finish uninstalling old version, my new program will execute. But my application is installed with multilanguage. If means it allows user to choose many language to install.<br />
      At that time, after uninstall successful, the page welcome is displayed with the same language which I choose to install in old version.<br />
      I only want to know how can I allow user to choose language to install after uninstalling old program.<br />
      My code here:<br /></p>
      <pre>
<code><br />Function .onInit<br /><font color="red">  Call Remove </font><br />  !insertmacro MUI_LANGDLL_DISPLAY<br />FunctionEnd<br /><br />Function Remove<br />  ReadRegStr $R0 HKLM \<br />  "SOFTWARE\Microsoft\Windows\CurrentVersion\Uninstall\${PRODUCT_NAME}" \<br />  "UninstallString"<br />  StrCmp $R0 "" done<br />       MessageBox MB_OKCANCEL|MB_ICONEXCLAMATION \<br />             "${PRODUCT_NAME} is already installed. $\n$\nClick `OK` to remove the \<br />              previous version or `Cancel` to cancel this upgrade." \<br />       IDOK uninst<br />       Abort<br />;Run the uninstaller<br />uninst:<br />  ClearErrors<br />  Exec '$R0' ;Do not copy the uninstaller to a temp file<br />  IfErrors no_remove_uninstaller<br />    ;You can either use Delete /REBOOTOK in the uninstaller or add some code<br />    ;here to remove the uninstaller. Use a registry key to check<br />    ;whether the user has chosen to uninstall. If you are using an uninstaller<br />    ;components page, make sure all sections are uninstalled.<br />  no_remove_uninstaller:<br /><br />  done:<br />FunctionEnd<br /></code>
</pre><br />
      I also try put my code above and under <font color="blue">!insertmacro MUI_LANGDLL_DISPLAY</font>to display many languages for user choose to install.<br />
      I try all my word to explain, if you do not know, I will try it again<br />
      Thank you for your help,
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">glory_man</span><br />
      <span class="post-time small text-muted">8th November 2006 15:36 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Check your uninstaller. If there is no code to delete registry language settings -&gt; language selection dialog will not show.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">bholliger</span><br />
      <span class="post-time small text-muted">8th November 2006 20:21 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Hi sunlight112!<br />
      <br />
      Ah, I guess I'm aware of the problem now. This might help you: Define MUI_LANGDLL_ALWAYSSHOW in your script.<br />
      <br /></p>
      <pre>
<code><br />  !define MUI_LANGDLL_ALWAYSSHOW<br /></code>
</pre><br />
      <br />
      If you set this constant, the dialog will always show, no matter what setting has been saved before.<br />
      <br />
      Furter information:<br />
      <a href="http://nsis.sourceforge.net/Docs/Modern%20UI/Readme.html" target="_blank">http://nsis.sourceforge.net/Docs/Mod...UI/Readme.html</a><br />
      Search for MUI_LANGDLL_ALWAYSSHOW<br />
      <br />
      Cheers<br />
      <br />
      Bruno
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">sunlight112</span><br />
      <span class="post-time small text-muted">9th November 2006 01:27 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Thank glory_man and bholliger very much,<br />
      Now I can do it well. However, I have one question on this field.<br />
      When I run my application, (in case my application is installed already) MessageBox will display to ask user to uninstall old version.<br />
      After user click OK(it means uninstall it). A screen allow user choose language to install new version is appeared and follow it is Uninstall old version is displayed.<br />
      I am worry if user click CANCEL on Uninstall program. The screen chooses language still allow user to install new version(it does not hide when uninstall program is click CANCEL). At that time, user do not need to unintall old version and can continue to install new version although I check it before installing new version.<br />
      How can I check if user click CANCEL on Uninstall screen? I do not allow them to install new version.<br />
      I am sorry about my word.If you do not know, please tell me!<br />
      Thank a lot,</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">bholliger</span><br />
      <span class="post-time small text-muted">9th November 2006 01:34 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Hi sunlight112!<br />
      <br />
      I'm not sure if you can use /S with the uninstaller. Can you try this?<br />
      <br /></p>
      <pre>
<code><br />ExecWait '$R0 /S _?=$INSTDIR'<br /></code>
</pre><br />
      <br />
      Cheers<br />
      <br />
      Bruno
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">sunlight112</span><br />
      <span class="post-time small text-muted">9th November 2006 03:15 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Thank bholliger a lot,<br /></p>
      <pre>
<code><br />Bholliger posted:<br />ExecWait '$R0 /S _?=$INSTDIR'<br /></code>
</pre><br />
      Can you explain your code? I do not understand why we should use this.<br />
      I also try with your code. Your code work well with my idea but it just deletes file " *test.exe, website.link and registry"and not delete my "uninst.exe".And, it also does not display screen uninstall(I know it because uninst.exe is not called)<br />
      Can you tell me why "uninst.exe" is not deleted?<br />
      I also try with this code:<br />
      <font color="green">ExecWait '$R0 _?=$INSTDIR'</font><br />
      The result is the same your code.<br />
      Thank you very much for your help,
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">bholliger</span><br />
      <span class="post-time small text-muted">9th November 2006 06:08 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Hi sunlight112!<br />
      <br />
      The uninstaller is called and executed with ExecWait, this causes the installer to wait until the uninstall is finished. It is called with the uninstall directory, so there's no need to ask for a directory and the uninstall process is performed silently in the background. Because of the fact the installer is overwritten anyway during your upcoming install, there's no need to remove the uninst.exe (Have a look at the wiki [1], the behaviour is explained there).<br />
      <br />
      In the end you have what you requested: The user is not able to cancel the uninstall process. Voila!<br />
      <br />
      Cheers<br />
      <br />
      Bruno<br />
      <br />
      [1] <a href="http://nsis.sourceforge.net/Auto-uninstall_old_before_installing_new" target="_blank">http://nsis.sourceforge.net/Auto-uni...installing_new</a></p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">sunlight112</span><br />
      <span class="post-time small text-muted">9th November 2006 07:51 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Thank bholliger a lot,<br />
      Now I can understand it clearly :)<br />
      Thank you so much,</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">bholliger</span><br />
      <span class="post-time small text-muted">9th November 2006 07:56 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">You're welcome!</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">peeratep</span><br />
      <span class="post-time small text-muted">12th March 2007 08:18 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>continue install</strong><br />
      i want continue install after uninstall successfuly!</p>
    </div>
    <hr />

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]>
  </script>
</body>
</html>
