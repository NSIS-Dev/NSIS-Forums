<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="description" content="Remote Installation of Win32 Services"><title>Remote Installation of Win32 Services - NSIS Forums</title><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script><link rel="preload" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css" as="style" onload="this.rel='stylesheet'"><link rel="preload" href="../css/style.css" as="style" onload="this.rel='stylesheet'"><noscript><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css"><link rel="stylesheet" href="../css/style.css"></noscript><script>!function(a){"use strict";var b=function(b,c,d){function e(a){return h.body?a():void setTimeout(function(){e(a)})}function f(){i.addEventListener&&i.removeEventListener("load",f),i.media=d||"all"}var g,h=a.document,i=h.createElement("link");if(c)g=c;else{var j=(h.body||h.getElementsByTagName("head")[0]).childNodes;g=j[j.length-1]}var k=h.styleSheets;i.rel="stylesheet",i.href=b,i.media="only x",e(function(){g.parentNode.insertBefore(i,c?g:g.nextSibling)});var l=function(a){for(var b=i.href,c=k.length;c--;)if(k[c].href===b)return a();setTimeout(function(){l(a)})};return i.addEventListener&&i.addEventListener("load",f),i.onloadcssdefined=l,l(f),i};"undefined"!=typeof exports?exports.loadCSS=b:a.loadCSS=b}("undefined"!=typeof global?global:this);!function(a){if(a.loadCSS){var b=loadCSS.relpreload={};if(b.support=function(){try{return a.document.createElement("link").relList.supports("preload")}catch(b){return!1}},b.poly=function(){for(var b=a.document.getElementsByTagName("link"),c=0;c<b.length;c++){var d=b[c];"preload"===d.rel&&"style"===d.getAttribute("as")&&(a.loadCSS(d.href,d,d.getAttribute("media")),d.rel=null)}},!b.support()){b.poly();var c=a.setInterval(b.poly,300);a.addEventListener&&a.addEventListener("load",function(){b.poly(),a.clearInterval(c)}),a.attachEvent&&a.attachEvent("onload",function(){a.clearInterval(c)})}}}(this);</script></head><body><div class="container"><ol class="breadcrumb"><li><a href="../index.html" class="glyphicon glyphicon-home"></a></li><li><a href="f-65.html">NSIS Discussion</a></li><li class="active">Remote Installation of Win32 Services</li></ol><p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=103347">Remote Installation of Win32 Services</a></p><br><div class="post"><p class="post-meta"><span class="post-author text-primary">tbednarz</span><br><span class="post-time small text-muted">3rd September 2002 13:01 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>Remote Installation of Win32 Services</strong><br>Hi,<br><br>I am evaluating a software installer tool and need some more information about NSIS. Could anybody please answer the following questions:<br><br><br>a) I need to install Win32 Services on NT an W2K. There are different binaries for each OS since they are compiled with different compiler switches. Can this be done with NSIS? How are security context treated (a service runs as System or under a specific user account)<br><br>b) Can I do remote installs? E.G. I have a central server holding different versions of a service executable. I like to install such an exe to a remote server<br><br>c) Is there support for an unattended mode. This means can I run the installer in the background without any user interactivity?<br><br>d) Is it possible to start the installer from some of my own code? E.G. I have a CORBA based server, that should start a software distribution to a specific server when requested by any of its client which could be a Web Application or a Java based GUI application.<br><br>e) Are there any samples for a Win32 service installation script? (Similar to what Apache is using to install the Windows version of TOMCAT 4.x)<br><br>Many thanks for your support.<br><br>Thomas</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">kichik</span><br><span class="post-time small text-muted">3rd September 2002 13:12 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">1) The <a href="http://www.clantpa.co.uk/nsis/x18servicesV0.0.zip" target="_blank">Service DLL</a>, the <a href="http://www.clantpa.co.uk/nsis/x18sysinfoV0.1.zip" target="_blank">SysInfo DLL</a> and the <a href="http://www.clantpa.co.uk/nsis/hosted/isadmindll.zip" target="_blank">IsAdmin DLL</a> should help you.<br>2) You can copy from network drivers using CopyFiles.<br>3) Yes, silent mode. Use SilentInstall silent and unless you pop a message box the user won't see a thing.<br>4) I don't understand. Do you want to execute it?<br>5) Not that I know of. As far as I know the service itself should know how to install and uninstall itself when registered or unregistered. If this is not the case with your services, than I am sure we can work something out. Just tell me and I will look a solution for you. As far as I know it should be a simple use of WriteRegStr.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">tbednarz</span><br><span class="post-time small text-muted">3rd September 2002 14:26 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"></p><blockquote><i>Originally posted by kichik</i><br><b>and unless you pop a message box the user won't see a thing.<br>4) I don't understand. Do you want to execute it?</b></blockquote>Well this is sort of the key point... We have written a large distributed application which consists of many Win32 servers in a corporate network. We use CORBA as our internal communication protocol. The application has agents that run on NT or W2k and soon .NET servers. These agents are self-distributing. We use a sybase DB server that stores a list of jobs to be executed. These jobs are dynamically generated by other parts of our system when they receive data from other input systems such as a mainframe, UNIX box etc (very complex...) A job record contains beside other things a machine name and the sort of job to execute. We have written middleware that acts as job dispatcher. If a job needs to be dispatched to a specific server process on a specific machine it first needs to check if our server is installed and running there. If not it first has to install it on the remote machine. Then it needs to start the service. Our services are self configuring at start-up. They connect to the database server and retrieve the configuration. Once they are ready, they can receive CORBA calls.<br><br>This is quite a cool system. You can simply install our central services and middleware on one or two servers at a central location. After that, the system distributes itself automatically as required (as soon as there are jobs to be processed on a remote machine). This may happen any time, 24h a day, 365 days a year. Thats why it needs to run unattended. So far we had our own Software distribution system. We developed our own primitive programming language using Sandstones VisualParse++. However the server has become a big beast and there is a lot of functionality built-in we do not need anymore. So I am looking for a very simple solution which allows me to simply remote-install my middleware on large enterprise networks.<br><br>Basically when my dispatcher server realizes that it should dispatch a job to a server that is missing our service, it simply installes it first. To do that, it should grab a predefined software package (can be a zip file) and extract it to a predefined directory on the remote server. Then it should register and start the service. This can be done using some Win32 API's. (A few years ago I have written DLL's to extend the functionality of InstallShield to exactly do that.) When the service starts, it configures itself and notifies the central dispatcher that it is ready to receive jobs and process them.<br><br>So I need a tool that does this remote installation for me. Basically it should handle things like DLL's in use etc. It should be able to extract the correct binary (depending on the target machines OS). It should not automatically reboot a machine (not very nice if hundreds or users are connected to it....) etc. but should send a notification to an administrator that the server needs to be rebooted. Also it should be able to perform server upgrades. Sometimes we release a new version of such a server process. We should be able to upgrade an installed base of existing servers.<br><br>Of course I can change all of my parser logic (was written by a former employee of mine) but that means a time consuming process. So I am looking for something less time-consuming. If NSIS fits to my model I could also spend some hours to extend it if necessary.<br><br>Another alternative is to use Microsofts Setup API. I am simply trying to find out, what is the best solution for me.<br><br><font size="1">edited by kichik, not everything is quote of me :)</font></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Sunjammer</span><br><span class="post-time small text-muted">3rd September 2002 14:30 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">I'm not sure how using WriteRegStr you could specify the password for a service running under a specific user account. AFAIK the Service Control Manager does something fishy with the password so that it can fall back on a previous one if a new one fails. You might find that only the SYSTEM account has the right to manipulate some of the service entries in this case.<br><br>P.S. None of this is certain, just my thoughts based on my own experience with services although I haven't really had to tackle these issues.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">kichik</span><br><span class="post-time small text-muted">6th September 2002 11:16 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"></p><blockquote><i>Originally posted by tbednarz</i><br>Basically when my dispatcher server realizes that it should dispatch a job to a server that is missing our service, it simply installes it first. To do that, it should grab a predefined software package (can be a zip file) and extract it to a predefined directory on the remote server. Then it should register and start the service. This can be done using some Win32 API's. (A few years ago I have written DLL's to extend the functionality of InstallShield to exactly do that.) When the service starts, it configures itself and notifies the central dispatcher that it is ready to receive jobs and process them.</blockquote>I am sorry it took me so long to answer again.<br>I have never done such a thing, so I have no idea how to make a program execute on another computer, but if you can do it using Win32 APIs, you can do it with, just like before, with an extension DLL. Have a look at Contrib\ExDLL for an example extension DLL for NSIS.</div><hr><div class="footer"><p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p></div></div><script src="../js/highlight.pack.js" type="text/javascript"></script><script type="text/javascript">//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]></script></body></html>