<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="Capture Folder Path from Browse Dialog" />

  <title>Capture Folder Path from Browse Dialog - NSIS Forums</title>
  <script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script>
  <!-- Bootstrap core CSS -->

  <link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css" />
  <link rel="stylesheet" href="../css/style.css" type="text/css" /><!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!--[if lt IE 9]>
                <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
                <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->
</head>

<body>
  <div class="container">
    <!-- Put navigation bar here -->

    <ol class="breadcrumb">
      <li><a href="../index.html" class="glyphicon glyphicon-home"></a></li>

      <li><a href="f-65.html">NSIS Discussion</a></li>

      <li class="active">Capture Folder Path from Browse Dialog</li>
    </ol>

    <p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=226475">Capture Folder Path from Browse Dialog</a></p><br />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">rjb2005</span><br />
      <span class="post-time small text-muted">20th September 2005 11:10 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>Capture Folder Path from Browse Dialog</strong><br />
      Hi all,<br />
      <br />
      Hope you can help.<br />
      <br />
      I've created an NSIS script that (when compiled and executed) successfully installs and uninstalls application files and registry settings.<br />
      <br />
      The software I am packaging interfaces with a number of supporting files which may be stored in any location (local or network). Supporting files are manually extracted from a ZIP archive and DO NOT need to be installed as part of this package. I do however need to get the user to specify the location of these files (via directory browse) and append the path to the registry.<br />
      <br />
      At present, I am using code below to capture the folder location but this method has an undesireable quirk...When the user clicks next, the application title is appended to the selected location (e.g. user selects 'c:\required_files', which becomes 'c:\required_files\myapp').<br />
      <br /></p>
      <pre>
<code><br />$MY_LOCATION<br />PageEx directory<br />  DirText "Specify location of required files..." "Source" "Please spcefiy location of required files" <br />  DirVar $MY_LOCATION<br />PageExEnd<br /></code>
</pre><br />
      <br />
      I have looked at creating a custom form with folder browser control but have struggled to get it working.<br />
      <br />
      If anyone has any suggestions or examples, I'd be grateful.<br />
      <br />
      <br />
      Rob.
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Comm@nder21</span><br />
      <span class="post-time small text-muted">20th September 2005 12:54 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">have a look at the installoptionsreadme:<br /></p>

      <blockquote>
        A "DirRequest" control displays a textbox and a browse button. Clicking the browse button will display a directory requester where the user can browse for a directory.
      </blockquote>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">pengyou</span><br />
      <span class="post-time small text-muted">20th September 2005 13:04 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"></p>

      <blockquote>
        When the user clicks next, the application title is appended to the selected location (e.g. user selects 'c:\required_files', which becomes 'c:\required_files\myapp').
      </blockquote>The manual explains how to stop this from happening:<br />
      <br />
      <a href="http://nsis.sourceforge.net/Docs/Chapter4.html#4.8.1.21" target="_blank">http://nsis.sourceforge.net/Docs/Chapter4.html#4.8.1.21</a>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">rjb2005</span><br />
      <span class="post-time small text-muted">20th September 2005 13:28 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">I resolved this issue as pengyou suggested:<br />
      <br />
      By replacing...<br /></p>
      <pre>
<code><br />InstallDir "$PROGRAMFILES\My Folder\MyApp"<br /></code>
</pre><br />
      ...with...<br />
      <pre>
<code><br />InstallDir "$PROGRAMFILES\My Folder\MyApp\"<br /></code>
</pre><br />
      <br />
      All that was needed was a trailing backslash.<br />
      <br />
      Many thanks for your help.<br />
      <br />
      Rob.
    </div>
    <hr />

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]>
  </script>
</body>
</html>
