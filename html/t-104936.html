<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="2.0a7 Bug - Won't work on XP" />

  <title>2.0a7 Bug - Won't work on XP - NSIS Forums</title>
  <script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script>
  <!-- Bootstrap core CSS -->

  <link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css" />
  <link rel="stylesheet" href="../css/style.css" type="text/css" /><!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!--[if lt IE 9]>
                <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
                <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->
</head>

<body>
  <div class="container">
    <!-- Put navigation bar here -->

    <ol class="breadcrumb">
      <li><a href="../index.html" class="glyphicon glyphicon-home"></a></li>

      <li><a href="f-65.html">NSIS Discussion</a></li>

      <li class="active">2.0a7 Bug - Won't work on XP</li>
    </ol>

    <p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=104936">2.0a7 Bug - Won't work on XP</a></p><br />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">okapi</span><br />
      <span class="post-time small text-muted">12th September 2002 20:55 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>2.0a7 Bug - Won't work on XP</strong><br />
      I have an installer built from this version. When I run it on a 2000 machine, it installs fine. When I run it on an XP machine, the installer says it ran fine but it actually did not copy the files to the install directory. I have admin rights on both machines. Anyone aware of this problem? Someone else using this same installer was having this problem on NT, but I have not tried to reproduce it on NT personally.<br />
      <br />
      Thanks,<br />
      Steve</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Joost Verburg</span><br />
      <span class="post-time small text-muted">12th September 2002 21:24 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">I got no problemes at all on Windows XP. Are you using the latest CVS version? Or maybe post a script?</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">okapi</span><br />
      <span class="post-time small text-muted">12th September 2002 22:46 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Tracked down the problem. In the 2.0a7 (and probably in other v2.x but not the v1.x) you need to specify CreateDirectory for the installation directory on XP (and NT it would seem according to the problem). However, in W2K it will make the directory without specifically specifying for it to be made. Whether this is a bug in XP that it doesn't create the directory and should or it's one in W2K as it does create the directory (and maybe shouldn't unless creation is specified), I don't know. One way or the other, there's an inconsistency bug.<br />
      <br />
      Steve</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">rainwater</span><br />
      <span class="post-time small text-muted">12th September 2002 23:08 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Sounds like you are not doing SetOutPath before you do File x.x?</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">okapi</span><br />
      <span class="post-time small text-muted">12th September 2002 23:55 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">No, I do have a SetOutPath. However in 1.x and 2.x on W2K it creates the install directory but (or the output path) but on W2K and NT it does not do this.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">rainwater</span><br />
      <span class="post-time small text-muted">13th September 2002 00:48 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"></p>

      <blockquote>
        <i>Originally posted by okapi</i><br />
        <b>No, I do have a SetOutPath. However in 1.x and 2.x on W2K it creates the install directory but (or the output path) but on W2K and NT it does not do this.</b>
      </blockquote>I cannot reproduce this on XP. Everytime I use SetOutPath the directory is created as it should. Do you have a script?
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Dick4</span><br />
      <span class="post-time small text-muted">13th September 2002 03:43 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">same here...I can't reproduce it either..</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">okapi</span><br />
      <span class="post-time small text-muted">13th September 2002 05:24 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Here's the config (it's split in 2 files for certain reasons).<br />
      <br />
      Steve</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
      <span class="post-time small text-muted">13th September 2002 10:21 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Works here too. Make sure your $INSTDIR is really what you think it is.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">okapi</span><br />
      <span class="post-time small text-muted">13th September 2002 15:37 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Ooops... the ZIP I posted had the CreateDirectory line in there and thus worked. Attached is one that does not have that and thus does not create the install directory on XP (and NT?).<br />
      <br />
      Steve</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Yathosho</span><br />
      <span class="post-time small text-muted">13th September 2002 16:18 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">i'm also having a bug since i have updated to alpha 7.<br />
      <br /></p>

      <blockquote>
        Processing script file: "C:\Programme\NSIS\makensis.exe"<br />
        Invalid command: MZ¬ê<br />
        Error in script "C:\Programme\NSIS\makensis.exe" on line 1 -- aborting creation process
      </blockquote>i had this error on my code, which is why i tried compiling the example by joost.<br />
      <br />
      the odd thing is, that "MZ" doesnt appear in the whole code!
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
      <span class="post-time small text-muted">13th September 2002 16:24 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"></p>

      <blockquote>
        Make sure you run SetCVSShellCommands.exe before you start using the latest version of MakeNSISw from the CVS.
      </blockquote>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Sunjammer</span><br />
      <span class="post-time small text-muted">13th September 2002 19:27 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"></p>

      <blockquote>
        <i>Originally posted by killahbite</i> <b>the odd thing is, that "MZ" doesnt appear in the whole code!</b>
      </blockquote>Can I just explain something, the error message you get with this problem actually tells you what is going wrong, you're just not reading it :)<br />
      <br />
      It says <i>Processing script file: "C:\Programme\NSIS\makensis.exe"</i> and <i>Error in script "C:\Programme\NSIS\makensis.exe"</i>. Both of these errors tell you that it is trying and unsuprisingly failing to compile makensis.exe... makensis.EXE *not* the script file you intended... the MZ stuff is because it tries to read a BINARY file, makensis.exe!!! This was all because makensisw used to need the path to makensis.exe as an argument but no longer does, however the old right mouse button menus installed by 2.0a6 still supply the path to makensis.exe as an argument which gets mistakenly interpreted as the name of the script to compile :D
    </div>
    <hr />

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]>
  </script>
</body>
</html>
