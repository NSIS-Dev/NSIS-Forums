<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="Newbie question" />

  <title>Newbie question - NSIS Forums</title><!-- Bootstrap core CSS -->
  <link rel="stylesheet" type="text/css" href="//netdna.bootstrapcdn.com/bootswatch/3.0.1/readable/bootstrap.min.css" />
  <link rel="stylesheet" href="../css/style.css" type="text/css" /><!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!--[if lt IE 9]>
                <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
                <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->
</head>

<body>
  <div class="container">
    <!-- Put navigation bar here -->

    <ol class="breadcrumb">
      <li><a href="../index.html" class="glyphicon glyphicon-home"></a></li>

      <li><a href="f-65.html">NSIS Discussion</a></li>

      <li class="active">Newbie question</li>
    </ol>

    <p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=326161">Newbie question</a></p><br />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">jzakula</span><br />
      <span class="post-time small text-muted">18th January 2011 23:35 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>Newbie question</strong><br />
      I'm new to NSIS (couple of days). It seems to be a great tool thus far. I seem to have everything working except for one issue. I'm installing a 32 bit legacy app on Windows 7x64. I cannot get the InstallLib macro to write files to $SYSDIR or "$COMMONFILES\Microsoft Shared\VFP".<br />
      <br />
      I think I have set RequestExecutionLevel and used UAC_RunElevated correctly?? from what I found in the examples and forums. The File statement does succeed in creating a file in the SysWOW64 folder, so $SYSDIR is working for it. It also creates the $INSTDIR folder under Program Files x64 and populates the files. There are no error messages; the $SYSDIR files simply do not get created. I seem to be close but I must be missing something simple - either a setting, system variable, or I may not fully understand the coding order required.<br />
      <br />
      I am listing the code (less uninstall) in hopes that someone can look at it and point me in the right direction.<br />
      <br />
      <br />
      ; Script generated by the HM NIS Edit Script Wizard.<br />
      <br />
      ; HM NIS Edit Wizard helper defines<br />
      !define PRODUCT_NAME "KOF Data System"<br />
      !define PRODUCT_VERSION "1.0"<br />
      !define PRODUCT_PUBLISHER "KOF Company"<br />
      !define PRODUCT_WEB_SITE "http://www.zakula.com"<br />
      !define PRODUCT_DIR_REGKEY "Software\Microsoft\Windows\CurrentVersion\App Paths\kfMain.exe"<br />
      !define PRODUCT_UNINST_KEY "Software\Microsoft\Windows\CurrentVersion\Uninstall\${PRODUCT_NAME}"<br />
      !define PRODUCT_UNINST_ROOT_KEY "HKLM"<br />
      !define PRODUCT_STARTMENU_REGVAL "NSIS:StartMenuDir"<br />
      <br />
      ; MUI 1.67 compatible ------<br />
      !include "MUI.nsh"<br />
      <br />
      !include LogicLib.nsh<br />
      <br />
      ; Administrative priveleges<br />
      !include UAC.nsh<br />
      <br />
      ; 64 bit compatibility ------<br />
      !include x64.nsh ; jz<br />
      <br />
      ; DLL/TLB installation routine ------<br />
      !include Library.nsh ; jz<br />
      <br />
      ; MUI Settings<br />
      !define MUI_ABORTWARNING<br />
      !define MUI_ICON "${NSISDIR}\Contrib\Graphics\Icons\modern-install.ico"<br />
      !define MUI_UNICON "${NSISDIR}\Contrib\Graphics\Icons\modern-uninstall.ico"<br />
      <br />
      ; Welcome page<br />
      !insertmacro MUI_PAGE_WELCOME<br />
      <br />
      ; License page<br />
      !define MUI_LICENSEPAGE_CHECKBOX<br />
      !insertmacro MUI_PAGE_LICENSE "g:\kof_setup_9\License.txt"<br />
      <br />
      ; Start menu page<br />
      var ICONS_GROUP<br />
      !define MUI_STARTMENUPAGE_NODISABLE<br />
      !define MUI_STARTMENUPAGE_DEFAULTFOLDER "KOF Data System"<br />
      !define MUI_STARTMENUPAGE_REGISTRY_ROOT "${PRODUCT_UNINST_ROOT_KEY}"<br />
      !define MUI_STARTMENUPAGE_REGISTRY_KEY "${PRODUCT_UNINST_KEY}"<br />
      !define MUI_STARTMENUPAGE_REGISTRY_VALUENAME "${PRODUCT_STARTMENU_REGVAL}"<br />
      !insertmacro MUI_PAGE_STARTMENU Application $ICONS_GROUP<br />
      <br />
      ; Instfiles page<br />
      !insertmacro MUI_PAGE_INSTFILES<br />
      <br />
      ; Finish page<br />
      !define MUI_FINISHPAGE_RUN "$INSTDIR\kfMain.exe"<br />
      !define MUI_FINISHPAGE_SHOWREADME "$INSTDIR\ReadMe.txt"<br />
      !insertmacro MUI_PAGE_FINISH<br />
      <br />
      ; Uninstaller pages<br />
      !insertmacro MUI_UNPAGE_INSTFILES<br />
      <br />
      ; Language files<br />
      !insertmacro MUI_LANGUAGE "English"<br />
      <br />
      ; MUI end ------<br />
      <br />
      Name "${PRODUCT_NAME} ${PRODUCT_VERSION}"<br />
      OutFile "kfSetup.exe"<br />
      InstallDir "$PROGRAMFILES\KOF"<br />
      InstallDirRegKey HKLM "${PRODUCT_DIR_REGKEY}" ""<br />
      BrandingText 'KOF System'<br />
      ShowInstDetails show<br />
      ShowUnInstDetails show<br />
      RequestExecutionLevel none<br />
      BGGradient FF0000 0000FF 00FF00<br />
      Icon 'g:\kof_Setup_9\kof.ico'<br />
      InstProgressFlags 'smooth'<br />
      LicenseBkColor '/windows'<br />
      WindowIcon on<br />
      SetFont Tahoma 10<br />
      <br />
      <br />
      ;;;;;;;;; FUNCTION .ONINIT ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;<br />
      Function .onInit ; jz<br />
      <br />
      ; Try to setup admin priveleges for install process (COPIED EXAMPLE)<br />
      uac_tryagain:<br />
      !insertmacro UAC_RunElevated<br />
      #MessageBox mb_TopMost "0=$0 1=$1 2=$2 3=$3"<br />
      ${Switch} $0<br />
      ${Case} 0<br />
      ${IfThen} $1 = 1 ${|} Quit ${|} ;we are the outer process, the inner process has done its work, we are done<br />
      ${IfThen} $3 &lt;&gt; 0 ${|} ${Break} ${|} ;we are admin, let the show go on<br />
      ${If} $1 = 3 ;RunAs completed successfully, but with a non-admin user<br />
      MessageBox mb_IconExclamation|mb_TopMost|mb_SetForeground "This installer requires admin access, try again" /SD IDNO IDOK uac_tryagain IDNO 0<br />
      ${EndIf}<br />
      ;fall-through and die<br />
      ${Case} 1223<br />
      MessageBox mb_IconStop|mb_TopMost|mb_SetForeground "This installer requires admin privileges, aborting!"<br />
      Quit<br />
      ${Case} 1062<br />
      MessageBox mb_IconStop|mb_TopMost|mb_SetForeground "Logon service not running, aborting!"<br />
      Quit<br />
      ${Default}<br />
      MessageBox mb_IconStop|mb_TopMost|mb_SetForeground "Unable to elevate , error $0"<br />
      Quit<br />
      ${EndSwitch}<br />
      <br />
      <br />
      ; Set up and display splash screen w/fade-in<br />
      SetOutPath $TEMP<br />
      File /oname=$PLUGINSDIR\SplashTmp.bmp "g:\kof_setup_9\KOF_SetupSplash1.bmp"<br />
      advsplash::show 1000 850 500 -1 $PLUGINSDIR\SplashTmp<br />
      <br />
      <br />
      ; To determine the system folders (32 bit or 64 bit) at runtime<br />
      ${EnableX64FSRedirection}<br />
      StrCpy $INSTDIR "$PROGRAMFILES\KOF"<br />
      FunctionEnd<br />
      ;;;;;;;;; FUNCTION .ONINIT ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;<br />
      <br />
      <br />
      ;;;;;;;;; FUNCTION .ONGUIEND ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;<br />
      Function .onGuiEnd ; jz<br />
      ; Run PostgreSql ODBC 8.3 install application, and then delete it<br />
      ExecWait '"msiexec" /i "$INSTDIR\psql_odbc_8_3.msi"' ; PostgreSQL ODBC installer<br />
      ;Delete "$INSTDIR\psql_odbc_8_3.msi"<br />
      <br />
      ; If Chosen by user, display the readme file<br />
      MessageBox MB_YESNO|MB_ICONQUESTION "Do you wish to view the ReadMe file now?" IDNO false<br />
      !system '"$WINDIR\notepad.exe" "$INSTDIR\ReadMe.txt"'<br />
      false:<br />
      <br />
      MessageBox MB_YESNO|MB_ICONQUESTION "The computer must be rebooted for settings to take effect. Do you wish to reboot your computer now?" IDNO false2<br />
      Reboot<br />
      false2:<br />
      FunctionEnd<br />
      ;;;;;;;;; FUNCTION .ONGUIEND ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;<br />
      <br />
      <br />
      <br />
      ;;;;;;; SECTION SEC01 ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;<br />
      Section "MainSection" SEC01<br />
      SetOverwrite ifnewer<br />
      <br />
      ; Copy into $INSTDIR<br />
      SetOutPath "$INSTDIR"<br />
      <br />
      ; Copy app-specific files<br />
      File "g:\kof_setup_9\kfMain.exe"<br />
      File "g:\kof_setup_9\Config.fpw"<br />
      File "g:\kof_setup_9\AppStart.app"<br />
      ; Dummy app to trigger "get updated build" process<br />
      File "g:\kof_setup_9\kf0000.app"<br />
      File "g:\kof_setup_9\AppInfo.ini"<br />
      File "g:\kof_setup_9\ReportOutput.app"<br />
      File "g:\kof_setup_9\ReportPreview.app"<br />
      File "g:\kof_setup_9\ReportBuilder.app"<br />
      File "g:\kof_setup_9\FoxTools.fll"<br />
      File "g:\kof_setup_9\MD5.fll"<br />
      File "g:\kof_setup_9\FoxUser.dbf"<br />
      File "g:\kof_setup_9\FoxUser.fpt"<br />
      File "g:\kof_setup_9\vfpAlert.exe"<br />
      <br />
      ; Copy necessary ODBC driver installation package<br />
      File "g:\kof_setup_9\PostgresOdbcDriver\psql_odbc_8_3.msi"<br />
      <br />
      ; Copy files needed for Dazzle interface is to be shipping computer<br />
      CreateDirectory "$INSTDIR\Dazzle"<br />
      SetOutPath "$INSTDIR\Dazzle"<br />
      File "g:\kof_setup_9\Dazzle\Dazzle_BoundPrint.lyt"<br />
      File "g:\kof_setup_9\Dazzle\Dazzle_FirstClass.lyt"<br />
      File "g:\kof_setup_9\Dazzle\Dazzle_MediaMail.lyt"<br />
      File "g:\kof_setup_9\Dazzle\Dazzle_ParcelPost.lyt"<br />
      File "g:\kof_setup_9\Dazzle\Dazzle_PriorityMail.lyt"<br />
      File "g:\kof_setup_9\Dazzle\Dazzle_APO_FPO_ShipLabel.lyt"<br />
      File "g:\kof_setup_9\Dazzle\Dazzle_Lg_Pri_Intl_ShipLbl.lyt"<br />
      File "g:\kof_setup_9\Dazzle\KofPackage1.lyt"<br />
      File "g:\kof_setup_9\Dazzle\DazzleAddressCodes.txt"<br />
      File "g:\kof_setup_9\Dazzle\DazzlePostalServices.txt"<br />
      File "g:\kof_setup_9\Dazzle\KofDazzle_ReadMe.txt"<br />
      <br />
      ; Copy into $INSTDIR\BarCode_Scanner<br />
      CreateDirectory "$INSTDIR\BarCode_Scanner"<br />
      SetOutPath "$INSTDIR\BarCode_Scanner"<br />
      File "g:\kof_setup_9\BarCode_Scanner\Free3of9.txt"<br />
      File "g:\kof_setup_9\BarCode_Scanner\kf_ScannerSetup.txt"<br />
      File "g:\kof_setup_9\BarCode_Scanner\Xi2000_Manual.pdf"<br />
      File "g:\kof_setup_9\BarCode_Scanner\Xi2000_Spec.pdf"<br />
      <br />
      ; Copy into $FONTS<br />
      SetOutPath "$FONTS"<br />
      File "g:\kof_setup_9\BarCode_Scanner\Free3of9.ttf"<br />
      File "g:\kof_setup_9\BarCode_Scanner\Fre3of9x.ttf"<br />
      <br />
      SetOutPath "$SYSDIR"<br />
      ; Try to use a straight file write to sysdir<br />
      File "g:\kof_setup_9\TestSysDirFile.txt"<br />
      <br />
      ; Install in $COMMONFILES or $SYSDIR<br />
      !insertmacro InstallLib DLL SHARED REBOOT_PROTECTED "g:\kof_setup_9\MsVcr71.dll" $SYSDIR $COMMONFILES<br />
      <br />
      CreateDirectory "$COMMONFILES\Microsoft Shared\VFP"<br />
      !insertmacro InstallLib DLL SHARED REBOOT_PROTECTED "g:\kof_setup_9\GdiPlus.dll" "$COMMONFILES\Microsoft Shared\VFP" $COMMONFILES<br />
      <br />
      !insertmacro InstallLib REGDLL SHARED REBOOT_PROTECTED "g:\kof_setup_9\vfp9R.dll" "$COMMONFILES\Microsoft Shared\VFP" $COMMONFILES<br />
      !insertmacro InstallLib REGDLL SHARED REBOOT_PROTECTED "g:\kof_setup_9\vfp9T.dll" "$COMMONFILES\Microsoft Shared\VFP" $COMMONFILES<br />
      !insertmacro InstallLib DLL SHARED REBOOT_PROTECTED "g:\kof_setup_9\vfp9Renu.dll" "$COMMONFILES\Microsoft Shared\VFP" $COMMONFILES<br />
      <br />
      !insertmacro InstallLib REGEXE SHARED REBOOT_PROTECTED "g:\kof_setup_9\FoxHHelp9.exe" "$COMMONFILES\Microsoft Shared\VFP" $COMMONFILES<br />
      !insertmacro InstallLib DLL SHARED REBOOT_PROTECTED "g:\kof_setup_9\FoxHHelpPs9.dll" "$COMMONFILES\Microsoft Shared\VFP" $COMMONFILES<br />
      <br />
      ; Already available in windows<br />
      ;!insertmacro InstallLib DLL SHARED REBOOT_PROTECTED "g:\kof_setup_9\MsXml3.dll" $SYSDIR $COMMONFILES<br />
      ;!insertmacro InstallLib DLL SHARED REBOOT_PROTECTED "g:\kof_setup_9\MsXml3r.dll" $SYSDIR $COMMONFILES<br />
      <br />
      !insertmacro InstallLib DLL SHARED REBOOT_PROTECTED "g:\kof_setup_9\MsXml3a.dll" $SYSDIR $COMMONFILES<br />
      !insertmacro InstallLib REGDLL SHARED REBOOT_PROTECTED "g:\kof_setup_9\MsXml4.dll" $SYSDIR $COMMONFILES<br />
      !insertmacro InstallLib REGDLL SHARED REBOOT_PROTECTED "g:\kof_setup_9\MsXml4r.dll" $SYSDIR $COMMONFILES<br />
      <br />
      !insertmacro InstallLib REGDLL SHARED REBOOT_PROTECTED "g:\kof_setup_9\Filer.dll" "$COMMONFILES\Microsoft Shared\VFP" $COMMONFILES<br />
      !insertmacro InstallLib DLL NOTSHARED REBOOT_PROTECTED "g:\kof_setup_9\DibApi32.dll" $INSTDIR $COMMONFILES<br />
      <br />
      ; Create the Shortcuts<br />
      !insertmacro MUI_STARTMENU_WRITE_BEGIN Application<br />
      SetShellVarContext all<br />
      CreateDirectory "$SMPROGRAMS\KOF Data System"<br />
      CreateShortCut "$SMPROGRAMS\KOF Data System\KOF.lnk" "$INSTDIR\kfMain.exe"<br />
      CreateShortCut "$DESKTOP\KOF.lnk" "$INSTDIR\kfMain.exe"<br />
      CreateShortCut "$QUICKLAUNCH\KOF.lnk" "$INSTDIR\kfMain.exe"<br />
      SetShellVarContext current<br />
      !insertmacro MUI_STARTMENU_WRITE_END<br />
      <br />
      SectionEnd<br />
      ;;;;;;; SECTION SEC01 ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
      <span class="post-time small text-muted">19th January 2011 00:11 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">In your post, I assume you meant Program Files (x86)? You need to use ${DisableX64FSRedirection} to write to system32/Program Files. Also I would recommend using MUI2.nsh over MUI.nsh (uses nsDialogs and is therefore faster).<br />
      <br />
      Your script isn't too big but in future please attach the script or use pastebin.<br />
      <br />
      Stu</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">jzakula</span><br />
      <span class="post-time small text-muted">19th January 2011 00:37 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Hi Stu,<br />
      <br />
      Thanks, I did mean x86.<br />
      <br />
      I changed<br />
      ${EnableX64FSRedirection}<br />
      to<br />
      ${DisableX64FSRedirection}<br />
      but the 32 bit files still do not show up in the system directory (SysWoW64?) with InstallLib. Is .onInit the right place for this?<br />
      <br />
      Thanks for the prompt response.<br />
      <br />
      Jeff</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
      <span class="post-time small text-muted">19th January 2011 11:09 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">OK sorry if you want to install to SysWOW64 then you do not need to enable or disable file system redirection. Windows will redirect to SysWOW64 anyway. If it is not working then you don't have access to the folder. You need to use RequestExecutionLevel admin.<br />
      <br />
      Edit: Also .onInit would not be the correct place as the Wow64EnableWow64FsRedirection API only works for the current thread. Sections run under a new thread and therefore you'd need to use Wow64EnableWow64FsRedirection again.<br />
      <br />
      Stu</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">jzakula</span><br />
      <span class="post-time small text-muted">19th January 2011 17:45 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Hi Stu,<br />
      <br />
      I'm back again. I cannot seem to get get this thing to work. I've tried what you suggested and a host of other things. The InstallLib macro simply refuses to install any files in any system folders or any "common files" subfolders. The File command has no problem writing these dlls to the folders where InstallLib fails.<br />
      <br />
      What is the special secret to making InstallLib work? Do I need to use SetOutPath to point to the target directory even though the target directory is one of the parameters? Is my syntax somehow incorrect? Do I need to use the File command to copy the file first? How do I know it got registered, etc?<br />
      <br />
      I have attached my code so you can see the InstallLib syntax. I must be doing something really stupid, but I can't seem to see what. This is the only problem I've had, but without this functionality there is no install.<br />
      <br />
      Jeff</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">jzakula</span><br />
      <span class="post-time small text-muted">19th January 2011 17:55 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Sorry, I forgot to attach on the last post.<br />
      <br />
      Jeff</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
      <span class="post-time small text-muted">19th January 2011 20:35 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Do you need to use the UAC plugin? I've been doing fine with RequestionExecutionLevel admin on Windows 7 32/64.<br />
      <br />
      I recommend just writing a basic script which does the bare minimum until you can find out the problem.<br />
      <br />
      Stu</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">jzakula</span><br />
      <span class="post-time small text-muted">19th January 2011 20:47 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">No problem. I'll comment it out and try it.<br />
      <br />
      Also, I'm just about coded up to use the File command to create the files and RegDLL to register them. Is that a feasible way to do the same thing?<br />
      <br />
      Jeff</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
      <span class="post-time small text-muted">19th January 2011 20:59 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">It depends on the library. RegDll is the same as using regsvr32 /s (but does not depend on it).<br />
      <br />
      Stu</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">jzakula</span><br />
      <span class="post-time small text-muted">26th January 2011 18:28 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Hi Stu,<br />
      <br />
      I've been out of the office for a while. The presence of the UAC plugin didn't affect my problem either way. I did, when I got back, get things working in a round-about way. I found a prewritten installer for all the VFP support libraries that I needed. I called that installer from an ExecWait statement. I preceded that with instructions on a notepad window called from ExecWait. I followed that with a .msi to install odbc drivers via ExecWait.<br />
      <br />
      It's not thrilling, but it works. I would still like to know why InstallLib fails for the next time that I need to do something similar.<br />
      <br />
      Thanks for the effort,<br />
      <br />
      Jeff</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
      <span class="post-time small text-muted">26th January 2011 18:56 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Notepad window? If you mean a console window you can hide those using nsExec.<br />
      <br />
      Stu</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">jzakula</span><br />
      <span class="post-time small text-muted">27th January 2011 16:43 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Well, actually it is a Notepad window. I don't need to really hide. I'm using an external installer (exe) for some of the support libraries during the middle of the NSIS install. But it requires to make a few selections on its start screen. So I use ExecWait to display the Notepad window with instructions on what to select, and it informs the user that the install process will continue when he closes the instruction window.<br />
      <br />
      But I have another question. In my script I would like to abstract the path where the compiler finds the source files. This way I could put everything on the local server where there is easy access to the installation executable. Also, edits and recompiles of the script that might be needed will always be where they are going to be used, eliminating the need to remember to copy any files when any change occurs.<br />
      <br />
      Can I just copy my current ${NSISDIR} tree to the server? Will everything work there from any computer, or is an install required because of support files or reg keys? Then I can add my source folders to that tree and and use ${NSISDIR} to find everything. Also, $EXEPATH and $EXEDIR do not presently work. Is this because I move the exe file after it gets compiled to the server where it gets run from desktop computers as a program on a mapped network drive? In fact, maybe this is why InstallLib does not work at runtime?</p>
    </div>
    <hr />

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]>
  </script>
</body>
</html>
