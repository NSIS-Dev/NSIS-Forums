<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="simple installer problems" />

  <title>simple installer problems - NSIS Forums</title><!-- Bootstrap core CSS -->
  <link rel="stylesheet" type="text/css" href="//netdna.bootstrapcdn.com/bootswatch/3.0.1/readable/bootstrap.min.css" />
  <link rel="stylesheet" href="../css/style.css" type="text/css" /><!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!--[if lt IE 9]>
                <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
                <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->
</head>

<body>
  <div class="container">
    <!-- Put navigation bar here -->

    <ol class="breadcrumb">
      <li><a href="../index.html" class="glyphicon glyphicon-home"></a></li>

      <li><a href="f-65.html">NSIS Discussion</a></li>

      <li class="active">simple installer problems</li>
    </ol>

    <p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=356579">simple installer problems</a></p><br />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">NateS</span><br />
      <span class="post-time small text-muted">1st March 2013 18:30 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>simple installer problems</strong><br />
      Hey guys, I have made an installer for a little app and deployed it to users. It works great for me on Win7 x64, where UAC is disabled and I'm admin. However, I'm getting reports that running it does nothing on Win7 x64. Other users say they have to run it with admin privileges.<br />
      <br />
      Can someone please take a quick look at my installer and tell me if I need to add anything to make it work with different Windows security configurations, etc? Here it is:<br />
      <a href="http://paste2.org/p/3021946" target="_blank">http://paste2.org/p/3021946</a><br />
      <br />
      Also I should note that (after installation) when my app runs it needs to be able to write files to the installation directory. Will this be a problem if someone installs it to Program Files as a user that isn't an admin? It is really important that my app do this, I can't just change it to write in the user directory. Will I have to have my app always run as admin? How do I do that?<br />
      <br />
      I hate to have to ask for help, but it really isn't clear to me what I need to do for various Windows setups and I can't possibly test them all myself. Thanks in advance! :)</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Anders</span><br />
      <span class="post-time small text-muted">1st March 2013 19:34 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">You can use the access control plugin but it is not a good idea!<br />
      <br />
      InstallDir "$PROGRAMFILES\Spine"<br />
      InstallDirRegKey HKCU "Software\Spine" ""<br />
      RequestExecutionLevel user<br />
      <br />
      Those 3 lines are a problem, use "RequestExecutionLevel admin"+HKLM+$PROGRAMFILES OR "RequestExecutionLevel user"+HKCU+$LocalAppData\Programs</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">NateS</span><br />
      <span class="post-time small text-muted">1st March 2013 20:18 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">I don't understand your suggestion. This syntax doesn't compile:<br />
      "RequestExecutionLevel admin"+$PROGRAMFILES<br />
      <br />
      I only use HKCU, so I don't think I need HKLM. Ooooh! I just noticed I had "user" and not "admin"! That should help!<br />
      <br />
      What about when my program runs? Can it write to Program Files just fine? If not, what can I do?<br />
      <br />
      Should I change the default installation from Program Files to something else, like $LocalAppData\Programs? This seems weird, as I think Program Files is the default for all installers I've ever seen.<br />
      <br />
      Edit: why is the access control plugin a bad idea?</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Highcoder</span><br />
      <span class="post-time small text-muted">1st March 2013 23:12 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"></p>

      <blockquote>
        Should I change the default installation from Program Files to something else, like $LocalAppData\Programs? This seems weird, as I think Program Files is the default for all installers I've ever seen.<br />
        <br />
        Edit: why is the access control plugin a bad idea?
      </blockquote>It depends... Why your app needs to write to your installdir? Config files? Logs?<br />
      <br />
      For unterstanding: Such things like Logs and settings should not be written to $Programfiles because this is a protected folder. You could normally write to it with admin rights only. This is the folder for the program itself. installed by admin and readable/executable for users. Stuff like Settings Logs (generated and used by the user) etc. should be stored to %localappdata% or %appdata%. They are intended for userdata.<br />
      Under XP 99% of all users had admin rights. So many programmers did not pay attention because it worked anyway. That was the reason for most Compatibility issues of the programs later at the beginning of Windows Vista.<br />
      <br />
      So there are 3 ways to fix that:<br />
      <b>The lazy way:</b> Dont install to $programfiles. Install to $LocalAppData. You dont have to redesign your app.<br />
      <b>The right way as mentioned by Microsoft:</b> Redesign your app. Seperate programfiles and userdata.<br />
      <b>The dirty hack (not recomended as Anders said):</b> grant write access for users to $PROGRAMFILES\Spine with access control plugin. But this is a bad idea because malware can now easily modify your exe and dll files to do bad stuff.<br />
      <br />
      Now itÂ´s your choice ;)
    </div>
    <hr />

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]>
  </script>
</body>
</html>
