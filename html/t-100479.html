<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="description" content="Killing all explorer windows"><title>Killing all explorer windows - NSIS Forums</title><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script><link rel="preload" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css" as="style" onload="this.rel='stylesheet'"><link rel="preload" href="../css/style.css" as="style" onload="this.rel='stylesheet'"><noscript><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css"><link rel="stylesheet" href="../css/style.css"></noscript><script>!function(a){"use strict";var b=function(b,c,d){function e(a){return h.body?a():void setTimeout(function(){e(a)})}function f(){i.addEventListener&&i.removeEventListener("load",f),i.media=d||"all"}var g,h=a.document,i=h.createElement("link");if(c)g=c;else{var j=(h.body||h.getElementsByTagName("head")[0]).childNodes;g=j[j.length-1]}var k=h.styleSheets;i.rel="stylesheet",i.href=b,i.media="only x",e(function(){g.parentNode.insertBefore(i,c?g:g.nextSibling)});var l=function(a){for(var b=i.href,c=k.length;c--;)if(k[c].href===b)return a();setTimeout(function(){l(a)})};return i.addEventListener&&i.addEventListener("load",f),i.onloadcssdefined=l,l(f),i};"undefined"!=typeof exports?exports.loadCSS=b:a.loadCSS=b}("undefined"!=typeof global?global:this);!function(a){if(a.loadCSS){var b=loadCSS.relpreload={};if(b.support=function(){try{return a.document.createElement("link").relList.supports("preload")}catch(b){return!1}},b.poly=function(){for(var b=a.document.getElementsByTagName("link"),c=0;c<b.length;c++){var d=b[c];"preload"===d.rel&&"style"===d.getAttribute("as")&&(a.loadCSS(d.href,d,d.getAttribute("media")),d.rel=null)}},!b.support()){b.poly();var c=a.setInterval(b.poly,300);a.addEventListener&&a.addEventListener("load",function(){b.poly(),a.clearInterval(c)}),a.attachEvent&&a.attachEvent("onload",function(){a.clearInterval(c)})}}}(this);</script></head><body><div class="container"><ol class="breadcrumb"><li><a href="../index.html" class="glyphicon glyphicon-home"></a></li><li><a href="f-65.html">NSIS Discussion</a></li><li class="active">Killing all explorer windows</li></ol><p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=100479">Killing all explorer windows</a></p><br><div class="post"><p class="post-meta"><span class="post-author text-primary">o_cee</span><br><span class="post-time small text-muted">19th August 2002 16:32 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>Killing all explorer windows</strong><br>I guess this has been discussed before, but I can't find anything about this here (seems like stuff gets deleted pretty quick).<br><br>The problem is that I need to replace a .dll file that's used by the shell. In order to release it, all regentries are deleted, but sometimes open explorer windows also needs to be closed in order to delete the file.<br><br>I don't know what to search for when using FindWindow. Or is this better done with an external dll?<br><br>I could really need some help here :)<br><br>o_cee</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">kichik</span><br><span class="post-time small text-muted">19th August 2002 18:26 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Nothing gets deleted around here... Search the forum and you will find it if it has been discussed.<br><br>As far as I know there is no peacful way of restarting explorer. Most things that you think require explorer to be restarted can be done without it, especially in Windows NT and above. Try searching the web, I am sure you will not end up empty ended.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">o_cee</span><br><span class="post-time small text-muted">19th August 2002 22:01 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Well, I really don't need to restart explorer, just close down any active file browsing windows. (The dll is a plugin that acts on files right click menu, thus beeing activated when a file browser is open..)<br><br>No ideas? I don't need to close explorer.exe, not the entire process, just the filebrowsers.. Hope you understand what I mean.<br><br><br>o_cee</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">kichik</span><br><span class="post-time small text-muted">19th August 2002 22:13 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">In that case all you need is a loop that finds any explorer windows (using FindWindow) and then send them WM_CLOSE. To find out the class name of explorer windows use <a href="http://www.gena01.com/win32spy/" target="_blank">Win32Spy</a>. Both Windows XP and 98 explorer class name is "CabinetWClass" so it is a safe bet it is the same in all other versions of windows. I am not sure though that it is not used with any other windows... To find out the value of WM_CLOSE just use WinMessages.NSH. It defines all of Windows messages (SendMessage $R0 ${WM_CLOSE} 0 0).</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">o_cee</span><br><span class="post-time small text-muted">20th August 2002 10:20 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Still don't get it right.<br><br>!Include WinMessages.NSH<br>Name ""<br>OutFile "exrunning.exe"<br>Section "Explorer running?"<br>FindWindow $R0 ExploreWClass<br>IsWindow $R0 ExRunning<br>Abort<br>ExRunning:<br>MessageBox MB_OK "ex running"<br>SendMessage $R0 ${WM_CLOSE} 0 0<br>SectionEnd<br><br>Win32Spy gives me "ExploreWClass" wich also is found by NSIS. But it doesn't accept the close command beeing sent anyway, absolutely nothing happens. Is there some difference with Windows XP?</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">kichik</span><br><span class="post-time small text-muted">20th August 2002 11:35 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Closing explorer windows doesn't work on Windows XP either...<br><br>I will keep looking.<br><br>Have you tried using UnregDll?</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">o_cee</span><br><span class="post-time small text-muted">20th August 2002 15:43 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Yeah, but it still won't del the .dll if any windows are open..<br><br>Thanks for the help<br><br><br>o_cee</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">kichik</span><br><span class="post-time small text-muted">20th August 2002 18:27 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">I am sorry but I have no more ideas... Try searching the web, I have no other suggestions.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">o_cee</span><br><span class="post-time small text-muted">22nd August 2002 15:35 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">I got a suggestion from a friend wich solved it.<br><br>SendMessage $R0 ${WM_SYSCOMMAND} 0xF060 0<br><br>0xF060 is SC_CLOSE.<br><br><br>:)<br><br>o_cee</p></div><hr><div class="footer"><p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p></div></div><script type="text/javascript" src="../js/highlight.pack.js" async></script><script type="text/javascript">//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]></script></body></html>