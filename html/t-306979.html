<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="StartMenu shortcuts, find previous installation/folder" />

  <title>StartMenu shortcuts, find previous installation/folder - NSIS Forums</title><!-- Bootstrap core CSS -->
  <link rel="stylesheet" type="text/css" href="//netdna.bootstrapcdn.com/bootswatch/3.0.1/readable/bootstrap.min.css" />
  <link rel="stylesheet" href="../css/style.css" type="text/css" /><!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!--[if lt IE 9]>
                <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
                <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->
</head>

<body>
  <div class="container">
    <!-- Put navigation bar here -->

    <ol class="breadcrumb">
      <li><a href="../index.html" class="glyphicon glyphicon-home"></a></li>

      <li><a href="f-65.html">NSIS Discussion</a></li>

      <li class="active">StartMenu shortcuts, find previous installation/folder</li>
    </ol>

    <p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=306979">StartMenu shortcuts, find previous installation/folder</a></p><br />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Perky Jacket</span><br />
      <span class="post-time small text-muted">1st June 2009 13:39 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>StartMenu shortcuts, find previous installation/folder</strong><br />
      Hello there!<br />
      <br />
      I know the basics with NSIS and simple setups aren't that problem but now I have to write a little more complex setup so I hope you can help me.<br />
      <br />
      1. I've included the components page and let the user decide there to install shortcuts. I wrote a sectiongroup called ShortCuts and in this group two sections called "Startmenu" and "Desktop".<br />
      <br />
      I want that the page to choose the startmenu folder comes only if the user had checked "Startmenu" before at the components page.<br />
      <br />
      Is it possible? If yes how do I implant it?<br />
      <br />
      2. The application (it's an modification for a game) which is going to be installed with my setup needs an already existing folder (the installed game what the modification is for).<br />
      <br />
      How can I make my setup to search automaticaly the destination folder and if it's not found to let the user search manualy and makes the "next" button only available if it's found?<br />
      <br />
      3. I want that the setup detect any previous installations of the application. If the same setup runs again after installation it should be give the two options of uninstalling the app or repair the app. If the user runs a newer setup (with a newer version of the app) it should detect the previous version (and show it to the user) and should give the option to patch it (maybe radio buttons or a checkbox) or to abort the installation.<br />
      <br />
      How can I manage this?<br />
      <br />
      I know it's just not a short question and maybe there are already answers here in the forum but I don't know which search words fits at best. Tried some but don't find help.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
      <span class="post-time small text-muted">1st June 2009 15:06 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">1. You can skip a page by calling Abort in its pre function. Use LogicLib to determine if a section is selected (search for SectionIsSelected).<br />
      <br />
      2. You should find out if the game has its installation folder stored in the registry somewhere which you can read using ReadRegStr $INSTDIR ...<br />
      <br />
      3. The NSIS installation has a dialog which has two radio buttons to 'Uninstall' and 'Add/Reinstall components' if the same version of NSIS is being reinstalled or 'Uninstall' and 'Do not uninstall' if a different version of NSIS is being installed. You can look at the nsDialogs code in Examples\makensis.nsi. That is probably a more extensive example than you need but the basic nsDialogs code should be the same.<br />
      <br />
      To determine if your product is already installed you will have to either store some information in the registry (like under the Uninstall registry) or you simply determine if your install folder already exists (checking the registry would be best). Again you can skip the page by calling Abort.<br />
      <br />
      Stu</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Perky Jacket</span><br />
      <span class="post-time small text-muted">5th June 2009 00:00 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Thanks for the answers. Need a few days to handle with question/answer #3. But you first two answers helped a lot.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
      <span class="post-time small text-muted">5th June 2009 12:16 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">In addition to #2 if you do find a suitable registry entry, you can just add InstallDirRegKey to your script as opposed to explicitly setting $INSTDIR.<br />
      <br />
      Stu</p>
    </div>
    <hr />

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]>
  </script>
</body>
</html>
