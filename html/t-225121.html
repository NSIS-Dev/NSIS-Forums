<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="description" content="Remembering Components using loops"><title>Remembering Components using loops - NSIS Forums</title><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script><link rel="preload" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css" as="style" onload="this.rel='stylesheet'"><link rel="preload" href="../css/style.css" as="style" onload="this.rel='stylesheet'"><noscript><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css"><link rel="stylesheet" href="../css/style.css"></noscript><script>!function(a){"use strict";var b=function(b,c,d){function e(a){return h.body?a():void setTimeout(function(){e(a)})}function f(){i.addEventListener&&i.removeEventListener("load",f),i.media=d||"all"}var g,h=a.document,i=h.createElement("link");if(c)g=c;else{var j=(h.body||h.getElementsByTagName("head")[0]).childNodes;g=j[j.length-1]}var k=h.styleSheets;i.rel="stylesheet",i.href=b,i.media="only x",e(function(){g.parentNode.insertBefore(i,c?g:g.nextSibling)});var l=function(a){for(var b=i.href,c=k.length;c--;)if(k[c].href===b)return a();setTimeout(function(){l(a)})};return i.addEventListener&&i.addEventListener("load",f),i.onloadcssdefined=l,l(f),i};"undefined"!=typeof exports?exports.loadCSS=b:a.loadCSS=b}("undefined"!=typeof global?global:this);!function(a){if(a.loadCSS){var b=loadCSS.relpreload={};if(b.support=function(){try{return a.document.createElement("link").relList.supports("preload")}catch(b){return!1}},b.poly=function(){for(var b=a.document.getElementsByTagName("link"),c=0;c<b.length;c++){var d=b[c];"preload"===d.rel&&"style"===d.getAttribute("as")&&(a.loadCSS(d.href,d,d.getAttribute("media")),d.rel=null)}},!b.support()){b.poly();var c=a.setInterval(b.poly,300);a.addEventListener&&a.addEventListener("load",function(){b.poly(),a.clearInterval(c)}),a.attachEvent&&a.attachEvent("onload",function(){a.clearInterval(c)})}}}(this);</script></head><body><div class="container"><ol class="breadcrumb"><li><a href="../index.html" class="glyphicon glyphicon-home"></a></li><li><a href="f-65.html">NSIS Discussion</a></li><li class="active">Remembering Components using loops</li></ol><p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=225121">Remembering Components using loops</a></p><br><div class="post"><p class="post-meta"><span class="post-author text-primary">khookhy</span><br><span class="post-time small text-muted">2nd September 2005 23:21 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>Remembering Components using loops</strong><br>I have around 80 components in my installer and it wouldn't be very practical to store each section's flags in the registry manually especially since they are changed very frequently. So I was wondering if it's possible to store/retreive flags using a short loop that applies to all sections in general... I tried using<br>GetDlgItem $0 $HWND_PARENT 120x (with x increasing upon each loop but no luck... and it wouldn't work for retreiving). I would appreciate any help offered. Thank you.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">khookhy</span><br><span class="post-time small text-muted">3rd September 2005 00:51 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">wops... now I see that I can't use GetDlgItem as stated above for the components page. That explains it. Ideas anyone ?</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">deguix</span><br><span class="post-time small text-muted">3rd September 2005 00:57 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Is Function .onSelChange enough to get the components flags using SectionGetFlags? It requires the components checkmarks selection to change. I think it may be not what you are looking for. That's because you said "short loops" so maybe it's time related.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">khookhy</span><br><span class="post-time small text-muted">3rd September 2005 01:19 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">ah good idea... but is there a way to get the id of the section that has been altered ? If so then I can use the following .onSelChange<br><br>SectionGetFlags ${SECID} $R0<br>WriteRegStr HKCU "blablabla" ${SECID} $R0<br><br>Yet this doesn't solve the problem of loading the remembered flags .onInit</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">deguix</span><br><span class="post-time small text-muted">3rd September 2005 01:35 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">You need to use a variable or an array to store the previous flags of all component items. Then, you can compare them all later to see which was or not changed.<br>There is a plug-in called "NSIS Array" that store array items. You can download it from <a href="http://nsis.sourceforge.net/wiki/File:NSISArray.zip" target="_blank">here</a>.<br><br>To change the selection of a component item (section or section group), you can use "SectionSetFlags" instruction. For the initialization of the flags to the implemented correctly, you should use the "PreFunction" of the "components" page. I'm not sure if that instruction works when used with the function ".onInit".</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">khookhy</span><br><span class="post-time small text-muted">3rd September 2005 01:48 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">I'm not familiar with the NSISArray plugin and I read it can store a maximum limit of using 8 arrays at any one time... I would rather try something else (if available)<br><br>I am aware that I need to use SectionSetFlags in the PreComponents function, yet I don't want to have to manually add it for each section because sections change much too often.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">deguix</span><br><span class="post-time small text-muted">3rd September 2005 02:21 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">No, you just need 1 array. You can store there up to 128 items in there (if you choose to use the line: !define ArrayPlugin 128), and this is more than enough for you. Then you could make a loop to process all the items inside and, at the same time, compare with the results of SectionGetFlags.<br><br>I'm not familiar with NSIS Array either, so we're tied :(...<br><br></p><blockquote>I am aware that I need to use SectionSetFlags in the PreComponents function, yet I don't want to have to manually add it for each section because sections change much too often.</blockquote>That's why I told you the solution above, you don't need to use an instruction for every single section. Just make a loop incrementing the section index.<br><br>EDIT:<br><br>If you don't like the plug-in, there are alternatives:<br>- "Array" header example for UseFunc (look at my signature) which is a little slower than using a plug-in directly, but can support an unlimited amount of items until the variable gets to the NSIS string length maximum (1024, or 8192 with special builds). Uses Math plug-in.<br>- Afrow UK's "Array" header using INI files (<a href="http://nsis.sourceforge.net/wiki/File:Array.zip" target="_blank">here</a>). This is very slow, but can have an unlimited number of items. So unlimited, the only limitation is the hard drive free space.</div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">khookhy</span><br><span class="post-time small text-muted">3rd September 2005 02:29 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">I see, cheers for that :) I'm gonna check out the NSISArray examples and give it a go, however, if anyone can supply the proper code for this then please do.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">khookhy</span><br><span class="post-time small text-muted">3rd September 2005 14:55 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">I can't seem to get this... am I supposed to be storing the section names in the array or their flags ? :S</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">deguix</span><br><span class="post-time small text-muted">3rd September 2005 17:13 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Well, you need to store the flags of every section because you need to compare them later so to discover which section changed...</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">khookhy</span><br><span class="post-time small text-muted">3rd September 2005 21:45 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Sorry for asking a bit too much, but won't arrays be cleared the next time the installer is executed ? Either way, I tried using your UseFunc header and got confused at what code to use .onSelChange... Sorry I'm a n00b :/</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">khookhy</span><br><span class="post-time small text-muted">5th September 2005 00:27 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">After further trails, I found out it can't be done how you said. To compare the flags of the altered section .onSelChange you need to know which section has been altered .onSelChange and that I wasn't able to achieve unless I add each section's flags to the array and that isn't what I'm after. Perhaps I'm way off, but if you think it can be done please tell me how. Thanks.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">deguix</span><br><span class="post-time small text-muted">5th September 2005 04:52 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Sorry, you wanted to store the flags in the registry. WriteRegDWORD and ReadRegDWORD are used for writing to and reading from registry, respectively, with numbers. Just treat the items in the registry like in an array: value names should be consecutive or it will be difficult to make a loop.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">NHOCSUNG</span><br><span class="post-time small text-muted">19th September 2005 21:14 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">hi everybody i'm been doing this header for very long time, this is modification of LogicLib, it sound it like "Give Me Section Flags I modify for you"... something like that, my Eng no good so i can't talk much, i needed more suggests form you guys...<br><br>example:<br>${IfSection} 1 "1,0,17,1"<br>Delete "Program_1.exe<br>${EndIfSection}<br><br>Strcpy $R0 "1,0,17,1" ;Section Old Flags<br>Strcpy $R1 "0,1,17,1" ;Section New or Current Flags<br>;$0 -&gt; $4 being used<br><br>${IfSection} ${FlagIsSelected} 2 $R0<br>Delete "temp.tmp"<br>${UnlessSection} ${FlagIsSelected} 2 $R1<br>Delete "Program_2.exe"<br>${EndUnlessSection}<br>${EndIfSection}<br><br>same with exam above<br><br>${Section} 2 $R0 $R1<br>${Repair}<br>Delete "temp.tmp"<br>${Remove}<br>Delete "Program_2.exe"<br>${SectionEnd}<br><br>Can you give me example using Array to get Flags.<br>If you can't don't worry i firgure that out</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">deguix</span><br><span class="post-time small text-muted">19th September 2005 21:31 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">I don't have an opinion, but you should put contributions also in the NSIS Wiki, or your contrib might be lost here in the forums, along with other contrib...</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Instructor</span><br><span class="post-time small text-muted">20th September 2005 07:25 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><a href="http://nsis.sourceforge.net/wiki/RememberComponents" target="_blank">RememberComponents</a> -script for remembering installed and uninstalled components.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">NHOCSUNG</span><br><span class="post-time small text-muted">20th September 2005 17:43 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">I know how to get Sections Flag, what i need to know is how store section flag into Array's variable...</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br><span class="post-time small text-muted">20th September 2005 18:15 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><a href="http://nsis.sourceforge.net/wiki/Arrays_in_NSIS" target="_blank">http://nsis.sourceforge.net/wiki/Arrays_in_NSIS</a><br><br>-Stu</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">NHOCSUNG</span><br><span class="post-time small text-muted">21st September 2005 16:46 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">thanks Afrow UK</p></div><hr><div class="footer"><p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p></div></div><script type="text/javascript" src="../js/highlight.pack.js" async></script><script type="text/javascript">//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]></script></body></html>