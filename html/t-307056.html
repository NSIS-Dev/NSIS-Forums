<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="description" content="RequestExecutionLevel and XP - Help Required"><title>RequestExecutionLevel and XP - Help Required - NSIS Forums</title><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script><link rel="preload" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css" as="style" onload="this.rel='stylesheet'"><link rel="preload" href="../css/style.css" as="style" onload="this.rel='stylesheet'"><noscript><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css"><link rel="stylesheet" href="../css/style.css"></noscript><script>!function(a){"use strict";var b=function(b,c,d){function e(a){return h.body?a():void setTimeout(function(){e(a)})}function f(){i.addEventListener&&i.removeEventListener("load",f),i.media=d||"all"}var g,h=a.document,i=h.createElement("link");if(c)g=c;else{var j=(h.body||h.getElementsByTagName("head")[0]).childNodes;g=j[j.length-1]}var k=h.styleSheets;i.rel="stylesheet",i.href=b,i.media="only x",e(function(){g.parentNode.insertBefore(i,c?g:g.nextSibling)});var l=function(a){for(var b=i.href,c=k.length;c--;)if(k[c].href===b)return a();setTimeout(function(){l(a)})};return i.addEventListener&&i.addEventListener("load",f),i.onloadcssdefined=l,l(f),i};"undefined"!=typeof exports?exports.loadCSS=b:a.loadCSS=b}("undefined"!=typeof global?global:this);!function(a){if(a.loadCSS){var b=loadCSS.relpreload={};if(b.support=function(){try{return a.document.createElement("link").relList.supports("preload")}catch(b){return!1}},b.poly=function(){for(var b=a.document.getElementsByTagName("link"),c=0;c<b.length;c++){var d=b[c];"preload"===d.rel&&"style"===d.getAttribute("as")&&(a.loadCSS(d.href,d,d.getAttribute("media")),d.rel=null)}},!b.support()){b.poly();var c=a.setInterval(b.poly,300);a.addEventListener&&a.addEventListener("load",function(){b.poly(),a.clearInterval(c)}),a.attachEvent&&a.attachEvent("onload",function(){a.clearInterval(c)})}}}(this);</script></head><body><div class="container"><ol class="breadcrumb"><li><a href="../index.html" class="glyphicon glyphicon-home"></a></li><li><a href="f-65.html">NSIS Discussion</a></li><li class="active">RequestExecutionLevel and XP - Help Required</li></ol><p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=307056">RequestExecutionLevel and XP - Help Required</a></p><br><div class="post"><p class="post-meta"><span class="post-author text-primary">kevin_gale</span><br><span class="post-time small text-muted">3rd June 2009 17:46 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>RequestExecutionLevel and XP - Help Required</strong><br>Hi.<br><br>We are converting our installers from Inno Setup to NSIS and one thing that we would like to continue to do is force the user to run the installer with admin privileges (XP &amp; Vista). Currently, this is achieved via the Inno Setup 'PrivilegesRequired' command.<br><br>I know this can be done with NSIS installers when running under Vista via 'RequestExecutionLevel' but is there a way to force the same under XP? Currently, the installer just runs as the current user level and fails while copying files due to locked down privileges.<br><br>We would prefer to do it in such a way that the operating system stops the installer from running as it means that all messages will be localized by the operating system (the way it works with our Inno Setup installers). It is also much nicer than letting the installer run, checking the privileges and then quitting with a message telling the user to re-launch.<br><br>Our installer will be using the Unicode version of NSIS if this makes a difference to the solution.<br><br><br><br>Best Regards,<br>Kev.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Anders</span><br><span class="post-time small text-muted">3rd June 2009 20:12 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">use the UserInfo plugin in .onInit or .onGuiInit</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">kevin_gale</span><br><span class="post-time small text-muted">3rd June 2009 20:19 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Hi Anders.<br><br>Thanks for your reply.<br><br>I guess using this plug-in means that the installer has to actually run before we can detect the authentication level?<br><br>This is something we can do as a last resort but it means translating the message into 11 (soon to be 15+) languages.<br><br>It would be nice if we could embed the relevant manifest so that Windows handles this in the same way as it does for Vista rather than our installer script having to do it.<br><br><br>Regards,<br>Kevin.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Anders</span><br><span class="post-time small text-muted">3rd June 2009 20:32 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">That feature was added to Vista because of UAC, on XP, you are on your own</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">kevin_gale</span><br><span class="post-time small text-muted">4th June 2009 10:24 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Hi Anders.<br><br>Thanks for your reply.<br><br>Is there an official place to post enhancement requests?<br><br>We can live with this limitation for the moment but it would be great if we could address it in a future version.<br><br>Technically, it is possible as Inno Setup does it so I guess it is just a case of someone implementing the relevant code.<br><br><br><br>Cheers,<br>Kev</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Anders</span><br><span class="post-time small text-muted">4th June 2009 10:33 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Other than having to translate the strings, I don't understand what more you want. I guess you could request a generic admin required message to be added to the official language files @ <a href="http://sourceforge.net/tracker/?atid=373088&amp;group_id=22049&amp;func=browse" target="_blank">http://sourceforge.net/tracker/?atid...49&amp;func=browse</a></p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">kevin_gale</span><br><span class="post-time small text-muted">4th June 2009 11:10 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Hi Anders.<br><br>It looks like I was mistaken.<br><br>I was under the impression that XP was handling the alert when running our Inno Setup installer. However, it appears that it is actually Inno Setup doing the checking rather than Windows.<br><br><br>Sorry, for wasting everyone's time.<br><br><br>Kev.</p></div><hr><div class="footer"><p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p></div></div><script src="../js/highlight.pack.js" type="text/javascript"></script><script type="text/javascript">//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]></script></body></html>