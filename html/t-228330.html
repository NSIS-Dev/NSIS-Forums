<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="Renaming files using wildcard" />

  <title>Renaming files using wildcard - NSIS Forums</title><!-- Bootstrap core CSS -->
  <link rel="stylesheet" type="text/css" href="//netdna.bootstrapcdn.com/bootswatch/3.0.1/readable/bootstrap.min.css" />
  <link rel="stylesheet" href="../css/style.css" type="text/css" /><!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!--[if lt IE 9]>
                <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
                <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->
</head>

<body>
  <div class="container">
    <!-- Put navigation bar here -->

    <ol class="breadcrumb">
      <li><a href="../index.html" class="glyphicon glyphicon-home"></a></li>

      <li><a href="f-65.html">NSIS Discussion</a></li>

      <li class="active">Renaming files using wildcard</li>
    </ol>

    <p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=228330">Renaming files using wildcard</a></p><br />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Mordack</span><br />
      <span class="post-time small text-muted">13th October 2005 14:22 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>Renaming files using wildcard</strong><br />
      Noob question here... :)<br />
      <br />
      Is it possible to copy files as a wildcard i.e. h*.txt and then rename them to h*.dat inside of the installer? I can do the first part with the CopyFiles command, but I haven't been able to figure out how to rename them using the same wildcard. The reason is, the source files that I would be copying over, can vary in their names, but they always start with the letter h.<br />
      <br />
      Any ideas?<br />
      <br />
      -M</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
      <span class="post-time small text-muted">13th October 2005 15:02 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">You need to recursively loop through all files in the folder with FindFirst, FindNext and FindClose. You can check if the first character is "h" with StrCpy and StrCmp. You can also use StrCpy to get the last four characters (to check if it is ".txt")<br />
      <br />
      -Stu</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Instructor</span><br />
      <span class="post-time small text-muted">13th October 2005 18:03 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"></p>
      <pre>
<code>Name "Output"<br />OutFile "Output.exe"<br /><br />!include "FileFunc.nsh"<br />!insertmacro Locate<br />!insertmacro GetBaseName<br /><br />Section<br />        StrCpy $R0 "C:\ftp"       #Search in<br />        StrCpy $R1 "C:\ftp_ren"   #Copy to<br /><br />        ${Locate} "$R0" "/L=F /M=h*.txt" "LocateCallback"<br /><br />        IfErrors 0 +2<br />        MessageBox MB_OK "Error"<br />SectionEnd<br /><br />Function LocateCallback<br />        ${GetBaseName} "$R7" $0<br />        CopyFiles /SILENT $R9 $R1<br />        Rename "$R1\$R7" "$R1\$0.dat"<br /><br />        Push 0<br />FunctionEnd</code>
</pre>
    </div>
    <hr />

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]>
  </script>
</body>
</html>
