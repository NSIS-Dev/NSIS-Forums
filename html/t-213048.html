<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="description" content="RegDLL not working with SP2??"><title>RegDLL not working with SP2?? - NSIS Forums</title><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script><link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css"><link rel="stylesheet" href="../css/style.css" type="text/css"></head><body><div class="container"><ol class="breadcrumb"><li><a href="../index.html" class="glyphicon glyphicon-home"></a></li><li><a href="f-65.html">NSIS Discussion</a></li><li class="active">RegDLL not working with SP2??</li></ol><p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=213048">RegDLL not working with SP2??</a></p><br><div class="post"><p class="post-meta"><span class="post-author text-primary">miakki</span><br><span class="post-time small text-muted">13th April 2005 01:59 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>RegDLL not working with SP2??</strong><br>Hi everybody!<br><br>I just installed SP2 on my XP machine, and all of a sudden my BHO (which is an dll) refuses to register.<br><br>There's no warning message or anything, it just doesn't register..<br><br>EDIT: <i>It works great when registering the dll without using the installer "regsvr.exe /i DLL"</i><br><br>What could this be??<br><br>Please help.<br><br>Thanks!</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br><span class="post-time small text-muted">13th April 2005 11:20 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Do you mean "with regsvr.exe" and it doesn't work with RegDLL?<br><br>-Stu</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">miakki</span><br><span class="post-time small text-muted">13th April 2005 15:09 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Hi!<br><br>Yes, it go to start-&gt;run and enter:<br><br>;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;<br>regsvr32 /i C:\thefile.dll<br>;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;<br><br>It works fine!<br><br>But if I have the NSIS script trying to install it nothing happens (however, it does work great on my other machine which have SP1)<br><br>Here the script:<br><br>;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;<br>Function .onInit<br>SetOutPath "$DESKTOP"<br>File "thefile.dll"<br>RegDLL "$DESKTOP\thefile.dll"<br>FunctionEnd<br>;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;<br><br>No error message or anything.. it just doesn't install, but it gets extracted to the desktop.<br><br><br>Any idea??<br><br><br>I've been trying to fix this for hours.. help! :/<br><br><br>Thank you!</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">miakki</span><br><span class="post-time small text-muted">13th April 2005 22:53 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">any help would be highly appreciated, I'm going nuts!<br><br>thanks</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Comperio</span><br><span class="post-time small text-muted">14th April 2005 00:51 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Here are some miscellaneous comments that might help:<br><br>In your example, you say you used Regsvr32 to register the file. You say you used the command:</p><blockquote>regsvr32 /i C:\thefile.dll</blockquote>However, I noticed that in your actual script, you used a slighly different path.<blockquote>RegDLL "$DESKTOP\thefile.dll"</blockquote>. Therefore, my first suggestion would be to change your installer to use the same path as your REGSVR32 test command line and see what happens.<br><br>Another thing you might try is looking for the error flag after calling RegDLL. (According to the documentation, the error flag is raised if the DLL could not be registered. But this does not mean that an physical error will be generated.) Try adding this bit of code directly after calling RegDLL:<br><pre>
<code><br>IfErrors dllFailed dllOk<br>dllFailed:<br>MessageBox MB_ICONEXCLAMATION|MB_OK "DLL Register failed!"<br>Goto end<br>dllok:<br>MessageBox MB_ICONINFORMATION|MB_OK "DLL Register OK."<br>end:<br>FunctionEnd<br></code>
</pre><br>
      This will allow to to detect if there are actually errors or not.<br>
      <br>
      Finally, I'd make sure you that you are logged into the XP box as an administrator. Security seemed to be a driving force behind SP2. You may not have permissions to do the things you once could before. By being logged in as admin, you'll have removed one more thing from the list of "unknowns".<br>
      <br>
      Hope this helps!;)
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">miakki</span><br>
      <span class="post-time small text-muted">14th April 2005 02:49 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Thanks a lot for your help comperio, however, nothing helped :( Actually, I'm even more confused now..<br>
      <br>
      <br>
      I added the code you supplied right after the RegDLL, and nothing happened..<br>
      <br>
      Since I have tested all of this with a silent installer, I didn't know of the fact that the installer simply exit when trying to Reg the dll!<br>
      <br>
      Now why is this?<br>
      <br>
      I checked, and I'm still Administrator..<br>
      <br>
      <br>
      Could it be that there's something wronf with the DLL? But would some issue with the DLL really make the installer exit without any message?<br>
      <br>
      <br>
      <br>
      Gee.. I'm banging my head over here.. =)<br>
      <br>
      <br>
      Thanks!</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">miakki</span><br>
      <span class="post-time small text-muted">14th April 2005 03:22 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">OK, I just solved it:<br>
      <br>
      Applications compressed with the popular application/encryptor teLock, can't be executed/registered by an NSIS installer on SP2.<br>
      <br>
      I think...</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Comperio</span><br>
      <span class="post-time small text-muted">14th April 2005 03:27 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">&lt;&lt;edit&gt;&gt;...<br>
      (I originally replied with more troubleshooting, but then saw that you figured it out, so I deleted my reply...)</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">miakki</span><br>
      <span class="post-time small text-muted">14th April 2005 03:34 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">:)<br>
      <br>
      Thanks anyway! I appreciate it!</p>
    </div>
    <hr>

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]></script></body></html>