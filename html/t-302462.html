<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="description" content="install winpcap from installer"><title>install winpcap from installer - NSIS Forums</title><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script><link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css"><link rel="stylesheet" href="../css/style.css" type="text/css"></head><body><div class="container"><ol class="breadcrumb"><li><a href="../index.html" class="glyphicon glyphicon-home"></a></li><li><a href="f-65.html">NSIS Discussion</a></li><li class="active">install winpcap from installer</li></ol><p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=302462">install winpcap from installer</a></p><br><div class="post"><p class="post-meta"><span class="post-author text-primary">jweinraub</span><br><span class="post-time small text-muted">26th January 2009 21:12 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>install winpcap from installer</strong><br>Hi<br><br>I am trying to install WinpCap from within the installer. I used 7-zip to extract the installer (another NSIS installer), and placed those files into a system and system\drivers folder. Would installing it that way suffice?<br><br>Or should I launch it's own installer?<br><br>Please advise.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Red Wine</span><br><span class="post-time small text-muted">26th January 2009 21:23 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Don't know what is WinpCap but if originally it installs into system folder, probably installs registry entries as well. That you must include in your installer.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">jweinraub</span><br><span class="post-time small text-muted">26th January 2009 21:41 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">So using regdll won't be enough?<br>how do i call an external NSIS installer then?<br><br>it installs essentially four dll files into System32, and a sys file into system32\drivers.<br><br>Looking in registry just one entry for uninstall info, one entry in HKLM software with just the name.<br><br>and under services, a daemon gets installed: expert is:<br><br>Windows Registry Editor Version 5.00<br><br>[HKEY_LOCAL_MACHINE\SYSTEM\ControlSet001\Services\rpcapd]<br>"Type"=dword:00000010<br>"Start"=dword:00000003<br>"ErrorControl"=dword:00000001<br>"ImagePath"=hex(2):22,00,25,00,50,00,72,00,6f,00,67,00,72,00,61,00,6d,00,46,00,\<br>69,00,6c,00,65,00,73,00,25,00,5c,00,57,00,69,00,6e,00,50,00,63,00,61,00,70,\<br>00,5c,00,72,00,70,00,63,00,61,00,70,00,64,00,2e,00,65,00,78,00,65,00,22,00,\<br>20,00,2d,00,64,00,20,00,2d,00,66,00,20,00,22,00,25,00,50,00,72,00,6f,00,67,\<br>00,72,00,61,00,6d,00,46,00,69,00,6c,00,65,00,73,00,25,00,5c,00,57,00,69,00,\<br>6e,00,50,00,63,00,61,00,70,00,5c,00,72,00,70,00,63,00,61,00,70,00,64,00,2e,\<br>00,69,00,6e,00,69,00,22,00,00,00<br>"DisplayName"="Remote Packet Capture Protocol v.0 (experimental)"<br>"ObjectName"="LocalSystem"<br>"Description"="Allows to capture traffic on this machine from a remote machine."<br><br>[HKEY_LOCAL_MACHINE\SYSTEM\ControlSet001\Services\rpcapd\Security]<br>"Security"=hex:01,00,14,80,90,00,00,00,9c,00,00,00,14,00,00,00,30,00,00,00,02,\<br>00,1c,00,01,00,00,00,02,80,14,00,ff,01,0f,00,01,01,00,00,00,00,00,01,00,00,\<br>00,00,02,00,60,00,04,00,00,00,00,00,14,00,fd,01,02,00,01,01,00,00,00,00,00,\<br>05,12,00,00,00,00,00,18,00,ff,01,0f,00,01,02,00,00,00,00,00,05,20,00,00,00,\<br>20,02,00,00,00,00,14,00,8d,01,02,00,01,01,00,00,00,00,00,05,0b,00,00,00,00,\<br>00,18,00,fd,01,02,00,01,02,00,00,00,00,00,05,20,00,00,00,23,02,00,00,01,01,\<br>00,00,00,00,00,05,12,00,00,00,01,01,00,00,00,00,00,05,12,00,00,00</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">jweinraub</span><br><span class="post-time small text-muted">26th January 2009 21:45 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"></p><blockquote><i>Originally posted by Red Wine</i><br><b>Don't know what is WinpCap but if originally it installs into system folder, probably installs registry entries as well. That you must include in your installer.</b></blockquote>WinPCap captures ethernet data, part of Ethereal/Wireshark.</div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Red Wine</span><br><span class="post-time small text-muted">26th January 2009 21:57 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Installing drivers/devices/services etc is more complicated procedure. Most likely you'll find valuable info searching the forum and wiki.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">jweinraub</span><br><span class="post-time small text-muted">26th January 2009 22:01 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Is it possible to just install the installer from my nsis script?<br><br>i prefer this to be auytomated and behind the scenes like how one can do with msi files/ or .net.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">jweinraub</span><br><span class="post-time small text-muted">26th January 2009 22:02 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">This is old, but I found it on winPcap website: <a href="http://www.winpcap.org/pipermail/winpcap-users/2005-August/000235.html" target="_blank">http://www.winpcap.org/pipermail/win...st/000235.html</a></p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">jweinraub</span><br><span class="post-time small text-muted">26th January 2009 22:26 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">It seems a silent installer is impossible.<br><br>So essentially, this is my new question.<br><br>1. How do I determine if winpcap 4.0.2 is isntalled.<br>2. If it is, skip and go on.<br>3. If it isn't launch it's own installer and enduser will use its GUI, when that is done, nsis installer goes on.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Red Wine</span><br><span class="post-time small text-muted">27th January 2009 13:04 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">If winPcap installer is a nsis installer must accept the /S parameter unless the developer strictly disallow it.<br><br>How to determine if winPcap is already installed?<br>Looking for the running service.<br>Looking for registry entries.<br>Looking for specific files into system directory.<br>etc (I guess)</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">jweinraub</span><br><span class="post-time small text-muted">28th January 2009 04:07 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">my understanding the developer disabled silent installs.<br>so i guess launch the installer and allow it to install as normal, or just put the installer on the install disc andlet the enduser install it manually are prolly the best two options..</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">jweinraub</span><br><span class="post-time small text-muted">28th January 2009 15:25 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">is this how the /S is invoked in this case?<br><br>ExecWait `"$EXEDIR\WinpCap\WinPcap_4_0_2.exe" /S` $R0</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">jweinraub</span><br><span class="post-time small text-muted">28th January 2009 22:30 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"></p><pre>
<code><br>   GetDllVersion "$SYSDIR\Packet.dll" $R0 $R1<br>   IntOp $R2 $R0 / 0x00010000<br>   IntOp $R3 $R0 &amp; 0x0000FFFF<br>   IntOp $R4 $R1 / 0x00010000<br>   IntOp $R5 $R1 &amp; 0x0000FFFF<br>   StrCpy $0 "$R2.$R3.$R4.$R5"<br>   MessageBox MB_OK $0<br><br>  ; 4.0.0.1040<br>  ${If} $0 == "4.0.0.1040"<br>  Goto go_on_further<br>  ${Else}<br>  SetDetailsPrint textonly<br>  DetailPrint "Installing WinPcap 4.02..."<br>  SetDetailsPrint none<br>  ExecWait `"$EXEDIR\WinpCap\winpcap-nmap-4.02.exe" /S` $R0<br>  ${EndIf}<br></code>
</pre><br>
      <br>
      Allright, this seems to work on my PC, but it doesn't work on anyone elses machine. If I have winpcap installed it won't install it again, if i don't have it, it will install it.<br>
      <br>
      it does so silently since i got the silent-able version from nmap.<br>
      <br>
      if it isnt there, the file version is 0.0.0.0, but if it is the proper version - it skips it- rather, if it is there, it does indeed show the file version.<br>
      <br>
      not too sure why it isn't going into the else function.
    </div>
    <hr>

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]></script></body></html>