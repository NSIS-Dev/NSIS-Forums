<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="toggle bold on/off" />

  <title>toggle bold on/off - NSIS Forums</title>
  <script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script>
  <!-- Bootstrap core CSS -->

  <link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css" />
  <link rel="stylesheet" href="../css/style.css" type="text/css" /><!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!--[if lt IE 9]>
                <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
                <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->
</head>

<body>
  <div class="container">
    <!-- Put navigation bar here -->

    <ol class="breadcrumb">
      <li><a href="../index.html" class="glyphicon glyphicon-home"></a></li>

      <li><a href="f-65.html">NSIS Discussion</a></li>

      <li class="active">toggle bold on/off</li>
    </ol>

    <p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=270226">toggle bold on/off</a></p><br />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">dev_akm</span><br />
      <span class="post-time small text-muted">26th April 2007 19:13 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>toggle bold on/off</strong><br />
      Does anyone here know how to make a function to toggle SF_BOLD on/off for a SectionGroup without any negative side-effects?<br />
      <br />
      I've tried numerous variations of the suggested SectionGetFlags, IntOp, SectionSetFlags combinations without success.<br />
      <br />
      For example, I have two required main files, one of which has no options and one of which has a lot of options. So, it works great if I do simple code like:<br />
      <br /></p>
      <pre>
<code><br />Function .onSelChange<br />  ${If} ${SectionIsSelected} ${MainFileNoOptions}<br />    !insertmacro UnSelectSection ${OptionGroup}<br />  ${EndIf}<br />FunctionEnd<br /></code>
</pre><br />
      <br />
      This prevents selection of anything in the OptionGroup if MainFileNoOptions is selected. Thus, if MainFileWithOptions is selected, then the test fails and I can pick things from the OptionGroup.<br />
      <br />
      Great, but I'd also like to indicate whether the OptionGroup is active or not by making it bold if you can use it, non-bold if you can't use it. So, if I expand the logic to say something like:<br />
      <br />
      <pre>
<code><br />Function .onSelChange<br />  ${If} ${SectionIsSelected} ${MainFileNoOptions}<br />    !insertmacro UnSelectSection ${OptionGroup}<br />    SectionGetFlags ${OptionGroup} $R0<br />    IntOp $R0 $R0 - ${SF_BOLD}<br />    SectionSetFlags ${OptionGroup} $R0<br />  ${ElseIf} ${SectionIsSelected} ${MainFileWithOptions}<br />    SectionGetFlags ${OptionGroup} $R0<br />    IntOp $R0 $R0 + ${SF_BOLD}<br />    SectionSetFlags ${OptionGroup} $R0<br />  ${EndIf}<br />FunctionEnd<br /></code>
</pre><br />
      <br />
      Then it adds/removes SF_BOLD correctly when I toggle between MainFileNoOptions and MainFileWithOptions, but now OptionGroup stops working correctly (clicking any of the sections inside it merely toggles the bold on/off and nothing can be selected because the SectionSetFlags command is blocking my change attempts).<br />
      <br />
      Any suggestions would be greatly appreciated. Thanks!
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">dev_akm</span><br />
      <span class="post-time small text-muted">26th April 2007 19:38 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">FYI, I also tried this:<br />
      <br /></p>
      <pre>
<code><br />Function .onSelChange<br />  ${If} ${SectionIsSelected} ${MainFileNoOptions}<br />    !insertmacro UnSelectSection ${OptionGroup}<br />    !insertmacro ClearSectionFlag ${OptionGroup} ${SF_BOLD}<br />  ${ElseIf} ${SectionIsSelected} ${MainFileWithOptions}<br />    !insertmacro SetSectionFlag ${OptionGroup} ${SF_BOLD}<br />  ${EndIf}<br />FunctionEnd<br /></code>
</pre><br />
      <br />
      And it works a bit better, but still prevents me from selecting anything in the OptionGroup.
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
      <span class="post-time small text-muted">26th April 2007 21:09 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Don't use plus and minus. Use bitwise or and bitwise and. You have the SetSectionFlag and ClearSectionFlag macros to handle that for you.<br />
      <br />
      Since setting the flags of a section group also sets the flags of its children and there's no way to prevent that, you'd have to remember the flags of those sections manually.</p>
      <pre>
<code>Function .onSelChange<br />  SectionGetFlags ${a} $0<br />  SectionGetFlags ${b} $1<br />  ${If} ${SectionIsSelected} ${MainFileNoOptions}<br />    !insertmacro UnSelectSection ${OptionGroup}<br />    !insertmacro ClearSectionFlag ${OptionGroup} ${SF_BOLD}<br />  ${ElseIf} ${SectionIsSelected} ${MainFileWithOptions}<br />    !insertmacro SetSectionFlag ${OptionGroup} ${SF_BOLD}<br />  ${EndIf}<br />  SectionSetFlags ${a} $0<br />  SectionSetFlags ${b} $1<br />FunctionEnd</code>
</pre>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">dev_akm</span><br />
      <span class="post-time small text-muted">26th April 2007 21:54 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Thanks for the reply.<br />
      <br />
      Sounds like it's more trouble than it's worth, especially since the SectionGroup loses any ability to track the state of the children once you force it to SF_BOLD.<br />
      <br />
      It's really too bad NSIS doesn't use something more like an XHTML DOM<br />
      <br />
      Although I suppose there's probably good reasons for the way the section and sectiongroup properties are handled, it's very cumbersome and frustrating to work with when you're trying to do anything out of the norm.</p>
    </div>
    <hr />

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]>
  </script>
</body>
</html>
