<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="description" content="Weird font question"><title>Weird font question - NSIS Forums</title><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script><link rel="preload" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css" as="style" onload="this.rel='stylesheet'"><link rel="preload" href="../css/style.css" as="style" onload="this.rel='stylesheet'"><noscript><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css"><link rel="stylesheet" href="../css/style.css"></noscript><script>!function(a){"use strict";var b=function(b,c,d){function e(a){return h.body?a():void setTimeout(function(){e(a)})}function f(){i.addEventListener&&i.removeEventListener("load",f),i.media=d||"all"}var g,h=a.document,i=h.createElement("link");if(c)g=c;else{var j=(h.body||h.getElementsByTagName("head")[0]).childNodes;g=j[j.length-1]}var k=h.styleSheets;i.rel="stylesheet",i.href=b,i.media="only x",e(function(){g.parentNode.insertBefore(i,c?g:g.nextSibling)});var l=function(a){for(var b=i.href,c=k.length;c--;)if(k[c].href===b)return a();setTimeout(function(){l(a)})};return i.addEventListener&&i.addEventListener("load",f),i.onloadcssdefined=l,l(f),i};"undefined"!=typeof exports?exports.loadCSS=b:a.loadCSS=b}("undefined"!=typeof global?global:this);!function(a){if(a.loadCSS){var b=loadCSS.relpreload={};if(b.support=function(){try{return a.document.createElement("link").relList.supports("preload")}catch(b){return!1}},b.poly=function(){for(var b=a.document.getElementsByTagName("link"),c=0;c<b.length;c++){var d=b[c];"preload"===d.rel&&"style"===d.getAttribute("as")&&(a.loadCSS(d.href,d,d.getAttribute("media")),d.rel=null)}},!b.support()){b.poly();var c=a.setInterval(b.poly,300);a.addEventListener&&a.addEventListener("load",function(){b.poly(),a.clearInterval(c)}),a.attachEvent&&a.attachEvent("onload",function(){a.clearInterval(c)})}}}(this);</script></head><body><div class="container"><ol class="breadcrumb"><li><a href="../index.html" class="glyphicon glyphicon-home"></a></li><li><a href="f-65.html">NSIS Discussion</a></li><li class="active">Weird font question</li></ol><p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=82514">Weird font question</a></p><br><div class="post"><p class="post-meta"><span class="post-author text-primary">cchian</span><br><span class="post-time small text-muted">27th March 2002 01:13 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>Weird font question</strong><br>&nbsp; Is there a way to use NSIS to code the following?:<br><br>1. Open the Fonts folder<br>2. Open the Arial.ttf font (or any other font)<br>3. Click on Done<br><br>For some reason I still haven't figured out, very few users of our software have a problem printing. The problem is that the text printed is a little larger and/or more spaced out than what it was intended (Looks like it is the bold text which prints slightly oversized). This causes some text to overwrite other text. What I found out is that if you perform the steps listed above, somehow it fixes the problem. Could this be a registry problem I can "fix" with NSIS? The application is written in Visual Fox Pro.<br><br>-Carlos</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Pomflain</span><br><span class="post-time small text-muted">27th March 2002 01:36 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>Hmm...</strong><br>&nbsp; Is this an installer problem, or an application problem? I've run into a similar problem in Win32 programs before, depends on if the person is using Small Fonts or Large Fonts in their display settings. The "solution" was to make things larger on the build system, or to build on a 9x kernel system. Not sure if that's what you mean, but that sounds like the same kind of problem I was having there.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">cchian</span><br><span class="post-time small text-muted">27th March 2002 03:16 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>Re: Hmm...</strong><br>&nbsp;</p><blockquote><i>Originally posted by Pomflain</i><br><b>Is this an installer problem, or an application problem?...</b></blockquote>I don't know if this is an installer or an application problem. The application is built on a 9x system. The problem can occur in any version of Win32. Somehow clicking on a font and then on "Done" fixes it. I am curious to know what exactly happens when you click on Done.</div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Pomflain</span><br><span class="post-time small text-muted">27th March 2002 06:53 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>Re: Re: Hmm...</strong><br>&nbsp;</p><blockquote><i>Originally posted by cchian</i><br><b><br>I don't know if this is an installer or an application problem. The application is built on a 9x system. The problem can occur in any version of Win32. Somehow clicking on a font and then on "Done" fixes it. I am curious to know what exactly happens when you click on Done.</b></blockquote>No I meant in the installer itself, or in your application. I'm going on the presumption you mean in your application.</div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">cchian</span><br><span class="post-time small text-muted">27th March 2002 19:29 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>Re: Re: Re: Hmm...</strong><br>&nbsp;</p><blockquote><i>Originally posted by Pomflain</i><br><b><br><br>No I meant in the installer itself, or in your application. I'm going on the presumption you mean in your application.</b></blockquote>Hi Pomflain, I am not sure what you meant. Can you refrase it for me again?<br><br>Thanks, :)<br><br>Carlos</div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">cchian</span><br><span class="post-time small text-muted">30th March 2002 06:10 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Pomflain,<br><br>Maybe the post by KiCHiK titled Fonts will do the trick. See this tread:<br><a href="http://forums.winamp.com/showthread.php?threadid=79586&amp;referrerid=24442" target="_blank">http://forums.winamp.com/showthread....ferrerid=24442</a></p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Pomflain</span><br><span class="post-time small text-muted">30th March 2002 06:32 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>Re: Re: Re: Re: Hmm...</strong><br>&nbsp;</p><blockquote><i>Originally posted by cchian</i><br><b><br>Hi Pomflain, I am not sure what you meant. Can you refrase it for me again?<br><br>Thanks, :)<br><br>Carlos</b></blockquote>Ok, you said you were having a problem with the printing wherein the text was too large for some users. If those particular users happen to be using the large fonts setting in Control Panel/Display, that could be what the cause of your problem is. I figure you mean in your application since I don't see much reason to be printing something from the installer.<br><br>Thanks for pointing out the other thread, but I don't have any problems like that. I have run into problems with the large/small font issue before and I've seen others have problems, so that's why I mentioned it. It's not something that is particularly obvious.<br><br>Hope that was a bit clearer.</div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Pomflain</span><br><span class="post-time small text-muted">30th March 2002 06:41 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>Re: Re: Re: Re: Hmm...</strong><br>&nbsp;</p><blockquote><i>Originally posted by cchian</i><br><b><br>Hi Pomflain, I am not sure what you meant. Can you refrase it for me again?<br><br>Thanks, :)<br><br>Carlos</b></blockquote>Ok, you said you were having a problem with the printing wherein the text was too large for some users. If those particular users happen to be using the large fonts setting in Control Panel/Display, that could be what the cause of your problem is. I figure you mean in your application since I don't see much reason to be printing something from the installer.<br><br>Thanks for pointing out the other thread, but I don't have any problems like that. I have run into problems with the large/small font issue before and I've seen others have problems, so that's why I mentioned it. It's not something that is particularly obvious.<br><br>Hope that was a bit clearer.</div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">cchian</span><br><span class="post-time small text-muted">30th March 2002 16:21 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>Re: Re: Re: Re: Re: Hmm...</strong><br>&nbsp;</p><blockquote><i>Originally posted by Pomflain</i><br><b><br>Ok, you said you were having a problem with the printing wherein the text was too large for some users. If those particular users happen to be using the large fonts setting in Control Panel/Display, that could be what the cause of your problem is. I figure you mean in your application since I don't see much reason to be printing something from the installer.<br></b></blockquote>Yes, the problem is printing from the application. I am still curious to find out why clicking on the (for example) Arial font and then on Done fixes the printing problem. Fortunately, it is an easy fix, but would be great if our developers could somehow do it behind the scenes (like during installation) so users don't have to contact us with the problem on the first place. I feel users shouldn't have to encounter this issue in the first place. In other words, the problem is in our end and not the users.<br>As a side note, I encountered this same printing problem with a new Windows XP system that has not had its display settings changed from the default.</div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">plaztic</span><br><span class="post-time small text-muted">9th April 2002 15:34 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">There's an application called AutoIt. It's a quite powerful scripting tool. You could automate the whole font session with this.<br><br>I sometimes use it together with NSIS to automate installations, rather install silently.<br><br>Oh, forgot to add the address: <a href="http://www.hiddensoft.com/autoit/" target="_blank">http://www.hiddensoft.com/autoit/</a><br><br>\plaz<br></p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">kichik</span><br><span class="post-time small text-muted">9th April 2002 21:00 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Hi Carlos!<br><br>I believe this NSIS code should do the same trick:<br><br></p><pre>
!include "C:\\Program Files\\NSIS\\WinMessages.nsh"
<br><br>&gt;ExecShell open "$WINDIR\\Fonts\\arial.ttf" SW_SHOWMINIMIZED
<br>loop:
<br>    Sleep 100
<br>    FindWindow$0 "FontViewWClass"
<br>   IntCmp $0 0 loop
<br>        SendMessage$0 ${WM_CLOSE} 0 0
<br>        Goto done
<br>done: 
</pre>KiCHiK<br>
      <br>
      <i>(edit):</i> It is recommended you take the font diretory from the registry (HKCU\Software\Microsoft\CurrentVersion\Explorer\Shell Folders\Fonts).
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">cchian</span><br>
      <span class="post-time small text-muted">10th April 2002 05:25 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Thanks for the tips!<br>
      <br>
      Lately I have been trying to figure out why the simple action of opening the control_panel\fonts\arial.ttf font fixes the problem. I have done a comparison of the registry and have almost concluded that the problem is that the required fonts (arial narrow and variants) are being copied to the fonts directory, but are not being registered with Windows.<br>
      It think I will modify and use Kichik's code to do the trick, I just need to figure out exactly what code I need to write to register the fonts or do the equivalent of just opening and closing the fonts folder silently.<br>
      <br>
      Carlos</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br>
      <span class="post-time small text-muted">10th April 2002 14:16 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">If you want to reregister the font (although Windows does it on its self when it boot) you can use the DLL I have written and uploaded in the post you yourself referenced to.<br>
      <br>
      <a href="http://forums.winamp.com/showthread.php?threadid=79586&amp;referrerid=24442" target="_blank">http://forums.winamp.com/showthread....ferrerid=24442</a><br>
      <br>
      KiCHiK</p>
    </div>
    <hr>

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]></script></body></html>