<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="FileRequest" />

  <title>FileRequest - NSIS Forums</title>
  <script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script>
  <!-- Bootstrap core CSS -->

  <link rel="stylesheet" type="text/css" href="//netdna.bootstrapcdn.com/bootswatch/3.0.1/readable/bootstrap.min.css" />
  <link rel="stylesheet" href="../css/style.css" type="text/css" /><!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!--[if lt IE 9]>
                <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
                <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->
</head>

<body>
  <div class="container">
    <!-- Put navigation bar here -->

    <ol class="breadcrumb">
      <li><a href="../index.html" class="glyphicon glyphicon-home"></a></li>

      <li><a href="f-65.html">NSIS Discussion</a></li>

      <li class="active">FileRequest</li>
    </ol>

    <p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=156432">FileRequest</a></p><br />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Dacore</span><br />
      <span class="post-time small text-muted">16th November 2003 18:49 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>FileRequest</strong><br />
      I created some custom pages for user input. There I use a FileRequest control to let the user enter the path and filename to a log file which is created later on by the installed application<br />
      <br />
      [Field 3]<br />
      Type=FileRequest<br />
      Flags=FILE_EXPLORER|REQ_SAVE|WARN_IF_EXIST|PROMPT_CREATE<br />
      Filter=Comma Delimited Text (*.csv)|*.csv|Text (*.txt)|*.txt<br />
      Left=63<br />
      Right=255<br />
      Top=62<br />
      Bottom=75<br />
      <br />
      When I use the browse button, to create a new file in the specified path, the result I get is the correct path and filename but without an extension. The PROMPT_CREATE flag is also not to executed, whereas WARN_IF_EXIST works as expected.<br />
      How can I get the path and filename to be displayed with the correct extension according to the chosen filter?<br />
      <br />
      I'm using a development snap shot downloaded on 2003-11-08.<br />
      <br />
      Many thanks for this highly useful piece of software. Great work.<br />
      <br />
      Regards</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
      <span class="post-time small text-muted">16th November 2003 19:15 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">On both XP and 98 PROMPT_CREATE only works without REQ_SAVE. Since those two just translate to flags for GetOpenFileName or GetSaveFileName I have to assume this is a Windows bug, feature, documentation bug or whatever you want to call it. I'll update InstallOptions' readme. Thanks.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Dacore</span><br />
      <span class="post-time small text-muted">16th November 2003 20:43 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Yes, without the REQ_SAVE the PROMPT_CREATE works.<br />
      Sadly, it doesn't matter if I use REQ_SAVE or PROMPT_CREATE the result which is displayed in the State field does not contain the extension specified by the filter. Any idea how to get this?<br />
      <br />
      Regards</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
      <span class="post-time small text-muted">16th November 2003 20:51 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Works fine for me. Mind attaching an example installer with source code?</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Dacore</span><br />
      <span class="post-time small text-muted">16th November 2003 21:22 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">I would highly appreciate if you could tell me what I did wrong. Thanks.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
      <span class="post-time small text-muted">16th November 2003 21:54 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Still works fine here. Try <a href="http://forums.winamp.com/showthread.php?s=&amp;threadid=156288" target="_blank">RC1</a>. You'd need to update the icon paths once upgrading as they've moved to Contrib\Graphics.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Dacore</span><br />
      <span class="post-time small text-muted">17th November 2003 20:25 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Thanks for trying my script kichik. I reall don't understand why it works for you. I now use rc2 and asked a friend to download nsis and compile the script for me. It still doesn't work here.<br />
      <br />
      To get straight thta we really talk about the same....I use the browse button to call the save file dialog. the filter is set to *.txt. I enter the filename *without* the extension and confirm the dialog. The path and filename appears in the input box but is missing the extension. I could even specify a filename with *.exe although the filter is set to *.txt. It is like in Word when saving a document, I only type the name and I know it will be saved with the extension *.doc as specified in the file dialog.<br />
      <br />
      Regards</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
      <span class="post-time small text-muted">17th November 2003 23:09 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">The filter parameter only sets filters the user will be able to choose from. It doesn't force him to use those. A user can easily type *.* and hit and enter to get a complete list of all of the files, regardless of the filter.<br />
      <br />
      There is a parameter that auto appends a default extension for this API function. Add a feature request on SourceForge and we'll probably add it. Just not at the moment because we want to get b4 out first.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Pyjamarama</span><br />
      <span class="post-time small text-muted">18th November 2003 08:44 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">The code runs ok.<br />
      I have a question.<br />
      The script came very handy because I wanted to prompt the user to enter the directory of the sqlserver databases.<br />
      Of course with the filerequest the user selects a certain file.<br />
      Is there a way, except string manipulation, that the user can just select a folder using this dialog?<br />
      <br />
      ps how do I get the full path in astring?Does State do the job?<br />
      thanx!!</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
      <span class="post-time small text-muted">18th November 2003 11:19 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">You can use DirRequest instead of FileRequest to get the user to select a directory. If you want to get the directory according to the selected file, you'd have to use string manipulation. But there is a pre-ready function called GetParent in the documentation, so you don't have to reinvent the wheel.<br />
      <br />
      Yes, state contains the full path.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Pyjamarama</span><br />
      <span class="post-time small text-muted">18th November 2003 11:50 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">thank u very much!</p>
    </div>
    <hr />

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]>
  </script>
</body>
</html>
