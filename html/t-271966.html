<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="description" content="Search the hard drive For Delete"><title>Search the hard drive For Delete - NSIS Forums</title><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script><link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css"><link rel="stylesheet" href="../css/style.css" type="text/css"></head><body><div class="container"><ol class="breadcrumb"><li><a href="../index.html" class="glyphicon glyphicon-home"></a></li><li><a href="f-65.html">NSIS Discussion</a></li><li class="active">Search the hard drive For Delete</li></ol><p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=271966">Search the hard drive For Delete</a></p><br><div class="post"><p class="post-meta"><span class="post-author text-primary">didava</span><br><span class="post-time small text-muted">29th May 2007 15:32 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>Search the hard drive For Delete File</strong><br>Hi<br><br><br>${GetDrives} "[Option]" "Function"<br>"[Option]" ; [FDD+HDD+CDROM+NET+RAM]<br>; FDD Floppy Disk Drives<br>; HDD Hard Disk Drives<br>; CDROM CD-ROM Drives<br>; NET Network Drives<br>; RAM RAM Disk Drives<br>;<br>; [ALL]<br>; Find all drives by letter (default)<br>;<br>"Function" ; Callback function when found<br><br>Function "Function"<br>; $9 "drive letter" (a:\ c:\ ...)<br>; $8 "drive type" (FDD HDD ...)<br><br>; $R0-$R9 are not used (save data in them).<br>; ...<br><br>Push $var ; If $var="StopGetDrives" Then exit from function<br>FunctionEnd<br><br>for Example<br><br>${locate::Open} "j:\" "/F=1 /D=1 /S=,Kb /T=,Creation delete/M=*.nsi /SD=NAME /B=1" $R0<br><br>Search For only .nsi file for delete<br><br>THANKS:cry: :cry: :cry:</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">didava</span><br><span class="post-time small text-muted">29th May 2007 16:05 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">plz</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">didava</span><br><span class="post-time small text-muted">29th May 2007 16:37 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">plz hlp<br><br>Name "Locate"<br>OutFile "Locate.exe"<br><br>!include "Locate.nsh"<br>!include "Sections.nsh"<br><br>Page components<br>Page instfiles<br><br>Section "Search and write founded in text file" SearchAndWriteInFile<br>GetTempFileName $1<br>FileOpen $2 $1 w<br><br>${locate::Open} "j:\" "/M=*.nsi /L=F" $R0<br><br><br>loop:<br>${locate::Find} $R0 $R1 $R2 $R3 $R4 $R5 $R6<br><br>RMDir $R0<br>StrCmp $R1 '' close<br>StrCmp $R4 '' 0 +3<br>FileWrite $2 '$R1 $\r$\n'<br>goto +2<br>FileWrite $2 '@del $0 $R1 $\r$\n'<br>goto loop<br><br>close:<br>${locate::Close} $R0<br>${locate::Unload}<br>FileClose $2<br>Exec '"notepad.exe" "$1"'<br><br>SectionEnd</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">didava</span><br><span class="post-time small text-muted">29th May 2007 22:00 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">helllllllllllllllllllllppppppppppppppppppp</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br><span class="post-time small text-muted">29th May 2007 22:30 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">What exactly are you trying to do?<br><br>Stu</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">didava</span><br><span class="post-time small text-muted">29th May 2007 22:42 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">merci Afrow UK<br><br>I WISHING Search the hard drive For Delete File Example nsi file</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br><span class="post-time small text-muted">29th May 2007 22:57 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Please use this:<br><a href="http://babelfish.altavista.com/" target="_blank">http://babelfish.altavista.com/</a><br><br>Stu</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">didava</span><br><span class="post-time small text-muted">29th May 2007 23:06 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">1-Finds files .nsi all hard drive c:\ d:\ e:\ f:\ ....<br>2-delete .nsi files<br>3- end</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">didava</span><br><span class="post-time small text-muted">30th May 2007 00:22 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">helooooo..</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">demiller9</span><br><span class="post-time small text-muted">30th May 2007 04:20 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">I don't mean to offend the original poster, but I don't see a valid use for his request. If there are nsi files on the target system they should not be deleted unless you are uninstalling your own program and the nsi files were put there by your installer. In such a situation you should know where they were installed and not need to search every hard drive.<br><br>I would be furious if some installer I ran deleted all of the nsi files on my computer.<br><br>Don</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">didava</span><br><span class="post-time small text-muted">30th May 2007 09:45 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">no. i am for Example EXPLAINED<br><br>ok for Example .db</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">didava</span><br><span class="post-time small text-muted">30th May 2007 11:22 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">plz.....</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Instructor</span><br><span class="post-time small text-muted">30th May 2007 11:53 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">:)<br></p><pre>
<code>Name "Test"<br>OutFile "Test.exe"<br><br>!include "Locate.nsh"<br>!include "FileFunc.nsh"<br>!insertmacro GetDrives<br><br>Section<br>        ${GetDrives} "HDD" "GetDrivesCallback"<br><br>        ${locate::Unload}<br>SectionEnd<br><br>Function GetDrivesCallback<br>        StrCpy $9 $9 2<br>        ${locate::Open} "$9" "/F=1 /D=0 /M=*.nsi /B=1" $0<br>        StrCmp $0 0 close<br><br>        loop:<br>        ${locate::Find} $0 $1 $2 $3 $4 $5 $6<br>        StrCmp $1 '' close<br><br>        #Your code<br>;       Delete $1<br>        goto loop<br><br>        close:<br>        ${locate::Close} $0<br><br>        Push 0<br>FunctionEnd</code>
</pre>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">didava</span><br>
      <span class="post-time small text-muted">30th May 2007 17:04 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Thanks Instructor , I can test the code vrey good Thanks<br>
      <br>
      But Never not delete file<br>
      <br>
      Example<br>
      <br>
      Name "Test"<br>
      OutFile "Test.exe"<br>
      <br>
      !include "Locate.nsh"<br>
      !include "FileFunc.nsh"<br>
      !insertmacro GetDrives<br>
      <br>
      Section<br>
      ${GetDrives} "HDD" "GetDrivesCallback"<br>
      <br>
      ${locate::Unload}<br>
      SectionEnd<br>
      <br>
      Function GetDrivesCallback<br>
      StrCpy $9 $9 2<br>
      ${locate::Open} "$9" "/F=1 /D=0 /M=*.db /B=1" $0<br>
      StrCmp $0 0 close<br>
      <br>
      loop:<br>
      ${locate::Find} $0 $1 $2 $3 $4 $5 $6<br>
      StrCmp $1 '' close<br>
      <br>
      #Your code<br>
      ; Delete $1<br>
      goto loop<br>
      <br>
      close:<br>
      ${locate::Close} $0<br>
      <br>
      Push 0<br>
      FunctionEnd</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">didava</span><br>
      <span class="post-time small text-muted">30th May 2007 17:27 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Plz hlp</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br>
      <span class="post-time small text-muted">30th May 2007 17:40 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">The ; in front of the Delete means that line is commented out.<br>
      <br>
      Stu</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">didava</span><br>
      <span class="post-time small text-muted">30th May 2007 17:54 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">tanks<br>
      <br>
      so.. plz BENEFICIAL Example .db THANKS AGAIN<br>
      <br>
      Name "Test"<br>
      OutFile "Test.exe"<br>
      <br>
      !include "Locate.nsh"<br>
      !include "FileFunc.nsh"<br>
      !insertmacro GetDrives<br>
      <br>
      Section<br>
      ${GetDrives} "HDD" "GetDrivesCallback"<br>
      <br>
      ${locate::Unload}<br>
      SectionEnd<br>
      <br>
      Function GetDrivesCallback<br>
      StrCpy $9 $9 2<br>
      ${locate::Open} "$9" "/F=1 /D=0 /M=*.db /B=1" $0<br>
      StrCmp $0 0 close<br>
      <br>
      loop:<br>
      ${locate::Find} $0 $1 $2 $3 $4 $5 $6<br>
      StrCmp $1 '' close<br>
      <br>
      Delete $0<br>
      Delete "c:\*.db"<br>
      goto loop<br>
      <br>
      close:<br>
      ${locate::Close} $0<br>
      <br>
      Push 0<br>
      FunctionEnd PLZ Example for me</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">didava</span><br>
      <span class="post-time small text-muted">30th May 2007 18:48 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">PLZ Example for me</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">didava</span><br>
      <span class="post-time small text-muted">30th May 2007 21:55 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">HI<br>
      hellp me</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">didava</span><br>
      <span class="post-time small text-muted">31st May 2007 08:23 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">plz hlp....</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">didava</span><br>
      <span class="post-time small text-muted">31st May 2007 11:59 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">PLZ Example for me</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Comperio</span><br>
      <span class="post-time small text-muted">31st May 2007 14:28 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">All your multiple posts and the whining and crying aren't going to get you answers any faster. In fact, they only serve to do the opposite!! :mad:<br>
      <br>
      Instructor's post should give you what you want. However, as Afrow already stated, you need to remove the semicolon from the Delete statement. In other words, change this:<br></p>
      <pre>
<code> #Your code<br>; Delete $1<br>goto loop</code>
</pre>to this:
      <pre>
<code> #Your code<br>Delete $1<br>goto loop</code>
</pre><br>
      <br>
      You might also need to adjust the parameters of the search ( ${locate::Open}) in order to remove the files you want to remove.<br>
      <br>
      If you are still confused, download and read the docs regarding the <a href="http://nsis.sourceforge.net/Locate_plugin" target="_blank">Locate plugin</a>.
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">didava</span><br>
      <span class="post-time small text-muted">31st May 2007 16:57 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Comperio THANKFUL :o ;) :)</p>
    </div>
    <hr>

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]></script></body></html>