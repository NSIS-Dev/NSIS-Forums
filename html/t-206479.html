<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="description" content="Installation for a pocket pc without Admin privileges"><title>Installation for a pocket pc without Admin privileges - NSIS Forums</title><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script><link rel="preload" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css" as="style" onload="this.rel='stylesheet'"><link rel="preload" href="../css/style.css" as="style" onload="this.rel='stylesheet'"><noscript><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css"><link rel="stylesheet" href="../css/style.css"></noscript><script>!function(a){"use strict";var b=function(b,c,d){function e(a){return h.body?a():void setTimeout(function(){e(a)})}function f(){i.addEventListener&&i.removeEventListener("load",f),i.media=d||"all"}var g,h=a.document,i=h.createElement("link");if(c)g=c;else{var j=(h.body||h.getElementsByTagName("head")[0]).childNodes;g=j[j.length-1]}var k=h.styleSheets;i.rel="stylesheet",i.href=b,i.media="only x",e(function(){g.parentNode.insertBefore(i,c?g:g.nextSibling)});var l=function(a){for(var b=i.href,c=k.length;c--;)if(k[c].href===b)return a();setTimeout(function(){l(a)})};return i.addEventListener&&i.addEventListener("load",f),i.onloadcssdefined=l,l(f),i};"undefined"!=typeof exports?exports.loadCSS=b:a.loadCSS=b}("undefined"!=typeof global?global:this);!function(a){if(a.loadCSS){var b=loadCSS.relpreload={};if(b.support=function(){try{return a.document.createElement("link").relList.supports("preload")}catch(b){return!1}},b.poly=function(){for(var b=a.document.getElementsByTagName("link"),c=0;c<b.length;c++){var d=b[c];"preload"===d.rel&&"style"===d.getAttribute("as")&&(a.loadCSS(d.href,d,d.getAttribute("media")),d.rel=null)}},!b.support()){b.poly();var c=a.setInterval(b.poly,300);a.addEventListener&&a.addEventListener("load",function(){b.poly(),a.clearInterval(c)}),a.attachEvent&&a.attachEvent("onload",function(){a.clearInterval(c)})}}}(this);</script></head><body><div class="container"><ol class="breadcrumb"><li><a href="../index.html" class="glyphicon glyphicon-home"></a></li><li><a href="f-65.html">NSIS Discussion</a></li><li class="active">Installation for a pocket pc without Admin privileges</li></ol><p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=206479">Installation for a pocket pc without Admin privileges</a></p><br><div class="post"><p class="post-meta"><span class="post-author text-primary">psrkumar</span><br><span class="post-time small text-muted">31st January 2005 19:24 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>Installation for a pocket pc without Admin privileges</strong><br>Hi!<br>The desktop OS I have is Windows XP Pro and I am trying to build an installer that installs the application cab files on to a Pocket PC 2003 device. The application is developed with .NET compact framework in C#.<br>I was able to get a decent installer working using NSIS with a sample provided at <a href="http://www.pocketpcdn.com/articles/multicabinstall.html" target="_blank">http://www.pocketpcdn.com/articles/multicabinstall.html</a><br>Our users (clients) are mostly nurses and most of them do not have admin privileges. The installer that I have right now won't run without admin privileges.<br>I tried to find out in the help documentation if there was a way to do it and in the archives too but I didn't find much information related to this scenario.<br>If anyone has any suggestions, resources or keywords that I should be searching with, then please let me know. I can attach the script file that I am using, if it is needed.<br>Thank you for your time.<br><br>Regards,<br>Raj</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">kichik</span><br><span class="post-time small text-muted">1st February 2005 18:12 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Can you pinpoint exactly what requires admin privileges?</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">psrkumar</span><br><span class="post-time small text-muted">1st February 2005 20:29 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Thank you for responding, Kichik.<br>In the installer, some registry keys are created in HKLM\software during installation and for uninstallation. I believe the admin privileges are needed for that. After I built the installer with the same script mentioned above and tried to run it with a Standard user account, then I get errors informing that the installer wasn't able to write to the files (eula.txt, readme.html, .ini files or the .cab files). If I run this installer with an administrative account, things go smoothly and the cab files are deployed to the device.<br>I am attaching the script that I am using for your reference.<br>Hope I answered your question! Thank you for your time.<br><br>Regards,<br>Raj</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">psrkumar</span><br><span class="post-time small text-muted">2nd February 2005 16:20 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>Update</strong><br>I removed the code creating or deleting the registry keys. Instead of using ProgramFiles folder for putting the files, I am using SetOutPath "$TEMP"<br>Now the installer goes on fine till it comes to the point where it is trying to execute CEAppMgr.exe from the Programfiles folder with a .ini file as input. This .ini file is put in the Temp folder.<br>The installer fails at this point. I was running the installer with a 'User' permission (no admin privileges).</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">kichik</span><br><span class="post-time small text-muted">3rd February 2005 18:44 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">It's true that a normal user can't normally write to HKLM, but the errors probably came from trying to install to Program Files.<br><br>What is the error you get from CEAppMgr.exe? Can you run it separately without errors?</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">psrkumar</span><br><span class="post-time small text-muted">3rd February 2005 19:57 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">The error I get is titled CEAPPMGR.exe - "The application failed to initialize properly (0xc0000142). Click OK to terminate the app."<br><br>I used the tools Regmon and Filemon from Sysinternals.com to track what was happening when running the installer. It seems CeAppMgr tries to create some temporary file in the \WINDOWS directory and since the user doesn't have enough permissions, the error appears. The filename looked like c:\WINDOWS\$_hpcst$.hpc. I have no idea what that is.<br><br>From all this, I am inclined to believe that CEAppMgr cannot be run without Admin privileges. For now, we will go with admin installer and maybe later on we will make any changes.<br><br>For the record, NSIS is great! I haven't used a lot of features yet but it is nice.<br><br>Thank you for your time.<br>Regards,<br>Raj</p></div><hr><div class="footer"><p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p></div></div><script src="../js/highlight.pack.js" type="text/javascript"></script><script type="text/javascript">//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]></script></body></html>