<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="Need &quot;SendMessage&quot;-Command Help" />

  <title>Need "SendMessage"-Command Help - NSIS Forums</title><!-- Bootstrap core CSS -->
  <link rel="stylesheet" type="text/css" href="//netdna.bootstrapcdn.com/bootswatch/3.0.2/readable/bootstrap.min.css" /><!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!--[if lt IE 9]>
                <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
                <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->
</head>

<body>
  <div class="container">
    <!-- Put navigation bar here -->

    <ol class="breadcrumb">
      <li><a href="../index.html" class="glyphicon glyphicon-home"></a></li>

      <li><a href="f-65.html">NSIS Discussion</a></li>

      <li class="active">Need "SendMessage"-Command Help</li>
    </ol>

    <p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=107947">Need "SendMessage"-Command Help</a></p><br />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Borg Number One</span><br />
      <span class="post-time small text-muted">2nd October 2002 03:27 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>Need "SendMessage"-Command Help</strong><br />
      &nbsp; Hello World:)<br />
      Closing winamp with NSIS is no problem:<br />
      <br />
      Function CloseWinamp<br />
      Push $0<br />
      loop:<br />
      FindWindow $0 "Winamp v1.x"<br />
      IntCmp $0 0 done<br />
      SendMessage $0 "000E" 0 0<br />
      SendMessage $0 "0002" 0 0<br />
      SendMessage $0 "0082" 0 0<br />
      ;or thisone SendMessage $0 "16" 0 0<br />
      Sleep 100<br />
      Goto loop<br />
      done:<br />
      Pop $0<br />
      FunctionEnd<br />
      <br />
      But I would like to build a little effect with MS-Editor<br />
      Editor should start and Letters should be inserted automatically.<br />
      <br />
      I tried thisone without succes, Notepad starts and nothing else.<br />
      <br />
      Function CloseWinamp<br />
      Exec $WINDIR\Notepad.exe<br />
      Push $0<br />
      loop:<br />
      FindWindow $0 "" "Unbenannt - Editor"<br />
      IntCmp $0 0 done<br />
      <br />
      SendMessage $0 "0100" 48 230001<br />
      ;P WM_KEYDOWN nVirtKey:'H' cRepeat:1 ScanCode:23 fExtended:0 fAltDown:0 fRepeat:0 fUp:0 [wParam:00000048 lParam:00230001]<br />
      00000514<br />
      SendMessage $0 "0102" 68 230001<br />
      ;P WM_CHAR chCharCode:'h' (104) cRepeat:1 ScanCode:23 fExtended:0 fAltDown:0 fRepeat:0 fUp:0 [wParam:00000068 lParam:00230001]<br />
      00000514<br />
      SendMessage $0 "0101" 48 C0230001<br />
      ;P WM_KEYUP nVirtKey:'H' cRepeat:1 ScanCode:23 fExtended:0 fAltDown:0 fRepeat:1 fUp:1 [wParam:00000048 lParam:C0230001]<br />
      <br />
      ; SendMessage $0 "000E" 0 0<br />
      ; SendMessage $0 "0002" 0 0<br />
      ; SendMessage $0 "0082" 0 0<br />
      ; SendMessage $0 "16" 0 0<br />
      Sleep 100<br />
      Goto loop<br />
      done:<br />
      Pop $0<br />
      FunctionEnd<br />
      <br />
      How Can I realize this special effect?</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
      <span class="post-time small text-muted">2nd October 2002 13:01 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">You got two problems in your code:<br />
      1) You send the messages to the notepad window it self and not to its text edit sub-window.<br />
      2) All of your hex numbers are written as normal numbers.<br />
      <br />
      You can also use WinMessages.nsh to make the code more readable, using ${WM_CLOSE} instead of 16 (0x10) for example.<br />
      <br /></p>
      <pre>
<code>
Exec notepad.exe
<br /><br />findloop:
<br />    Sleep 500
<br />    FindWindow$0 "Notepad"
<br />   StrCmp $0 0 findloop
<br /><br />FindWindow$1 "Edit" "" $0
<br /><br />SendMessage$1 ${WM_CHAR} 0x68 0x230001
<br /><br />MessageBox MB_OK "Click OK to close Notepad"
<br /><br />&gt;SendMessage $0 ${WM_CLOSE} 0 0 
<br />&gt;
</code>
</pre>I didn't use WM_KEYDOWN and WM_KEYUP because:<br />

      <blockquote>
        The WM_CHAR message is posted to the window with the keyboard focus when a WM_KEYDOWN message is translated by the TranslateMessage function. The WM_CHAR message contains the character code of the key that was pressed.
      </blockquote>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Borg Number One</span><br />
      <span class="post-time small text-muted">2nd October 2002 23:25 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>Problems to run "Compile with bz2"</strong><br />
      &nbsp; I put yours Into this:<br />
      <br /></p>
      <pre>
<code>
OutFile "Print text to editor.exe"
<br />&gt;Name "Print text to editor"
<br />&gt;;Caption "CD input Plug-in Changer Built by Borg_No.One"
<br />&gt;SilentInstall "silent"
<br />&gt;ShowInstDetails "hide"
<br />&gt;DirShow "hide"
<br />&gt;;InstallDir $PROGRAMFILESWinamp
<br /><br />&gt;Function .onInit
<br /><br />FunctionEnd
<br /><br />Section DoItAll
<br />    Call CloseWinamp
<br />SectionEnd
<br /><br />&gt;Function CloseWinamp
<br />Exec $WINDIRNotepad</code>.exe
<br /><br />findloop:
<br />    Sleep 500
<br />    FindWindow$0 "Notepad"
<br />   StrCmp $0 0 findloop
<br /><br />FindWindow$1 "Edit" "" $0
<br /><br />SendMessage$1 ${WM_CHAR} 0x68 0x230001
<br /><br />MessageBox MB_OK "Click OK to close Notepad"
<br /><br />&gt;SendMessage $0 ${WM_CLOSE} 0 0
<br />Pop$0
<br />FunctionEnd 
<br />&gt;

</pre>And if I want to compile the whole with "Compile with Nsis/ Nsis+Bzip2,<br />
      <br />
      I get following errormessage:<br />
      <br />
      2 warnings:<br />
      unknown variable "{WM_CHAR}" detected, ignoring<br />
      <br />
      unknown variable "{WM_CLOSE}" detected, ignoring<br />
      <br />
      After running the exe only editor starts, withoutany typed char and without closing editor.<br />
      <br />
      Could you test it please?<br />
      What do you mean with unknown file:"WinMessages.nsh"?
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Borg Number One</span><br />
      <span class="post-time small text-muted">2nd October 2002 23:41 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>I know what you mean with Winmessages.nsh</strong><br />
      &nbsp; Hi<br />
      <br />
      I put the content of winmessages into my nsi script file and it works great. Why does not the NSIS-compiler use Winmessages automatically?<br />
      <br />
      Why are "Winmessages.nsh" and all other nsh files not mentioned in any documentation?</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Borg Number One</span><br />
      <span class="post-time small text-muted">3rd October 2002 03:00 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>Hey World try this</strong><br />
      &nbsp; ;"SendMessage $2 ${WM_CHAR} 0x006E 0x310001<br />
      " should close the editor "click no-button", but it does not work, why????<br /></p>
      <pre>
<code>
FindWindow $2 "#3277" "Editor"
<br />&gt;SendMessage $2 ${WM_CHAR} 0x006E    0x310001
<br /><br /><br />SendMessage$0 ${WM_CLOSE} 0 0
<br />Pop$0
<br />FunctionEnd 
<br />&gt;
</code>
</pre>How can NSIS select "no" if Notepad ask me if I want to save changes?
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
      <span class="post-time small text-muted">3rd October 2002 11:09 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"></p>

      <blockquote>
        You can also use WinMessages.nsh to make the code more readable, using ${WM_CLOSE} instead of 16 (0x10) for example.
      </blockquote>Using it means including it like you did in your last code. NSIS doesn't automatically includes this file becuase not all users use it. Like you have probably noticed, you got those warnings because you didn't include it.<br />
      <br />

      <blockquote>
        How can NSIS select "no" if Notepad ask me if I want to save changes?
      </blockquote>You can't. SendMessage will wait until notepad finishes processing it, and this will only happen when the user will click something. You can if you want use the latest CVS version and use SendMessage /TIMEOUT=1.<br />
      <br />
      I have edited some of your posts because they were huge, please post only the relevant parts of your scripts or output instead of all of it at once. If you want to include a big script attach it.
    </div>
    <hr />

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]>
  </script>
</body>
</html>