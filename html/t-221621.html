<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="GetVersion plugin" />

  <title>GetVersion plugin - NSIS Forums</title><!-- Bootstrap core CSS -->
  <link rel="stylesheet" type="text/css" href="//netdna.bootstrapcdn.com/bootswatch/3.0.1/readable/bootstrap.min.css" />
  <link rel="stylesheet" href="../css/style.css" type="text/css" /><!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!--[if lt IE 9]>
                <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
                <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content=" GetVersion plugin" />

  <title>GetVersion plugin - NSIS Forums</title>
  <link rel="stylesheet" type="text/css" href="//netdna.bootstrapcdn.com/bootswatch/3.0.1/readable/bootstrap.min.css" />
  <link rel="stylesheet" href="../css/style.css" type="text/css" />
</head>

<body>
  <div class="container">
    <!-- Put navigation bar here -->

    <ol class="breadcrumb">
      <li><a href="../index.html" class="glyphicon glyphicon-home"></a></li>

      <li><a href="f-65.html">NSIS Discussion</a></li>

      <li class="active">GetVersion plugin</li>
    </ol>

    <p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=221621">GetVersion plugin</a></p><br />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
      <span class="post-time small text-muted">16th July 2005 16:24 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>GetVersion plugin</strong><br />
      A 4kB plugin to get Windows version info:<br />
      name, type, version, server name, service pack name, and service pack build.<br />
      <br />
      <a href="http://nsis.sourceforge.net/wiki/File:GetVersion.zip" target="_blank">http://nsis.sourceforge.net/wiki/File:GetVersion.zip</a><br />
      <br />
      Type is e.g. Home Edition<br />
      <br />
      Edit: I could add other version info stuff later if anyone needs it (i.e. non Windows version stuff).<br />
      <br />
      -Stu</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Joel</span><br />
      <span class="post-time small text-muted">16th July 2005 17:51 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">So... Stu is learning API, huh? ;)<br />
      <br />
      :D :up:</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">onad</span><br />
      <span class="post-time small text-muted">16th July 2005 18:10 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Great, but better call it "GetOSversion" to avoid confusion with get FileVersion data.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
      <span class="post-time small text-muted">16th July 2005 18:56 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">I didn't call it that because I may add other version stuff to it, e.g. IE version or perhaps Microsoft Office etc.<br />
      <br />
      Edit: Just added IEVersion which returns IE version and build.<br />
      <br />
      -Stu</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
      <span class="post-time small text-muted">10th March 2006 13:58 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">New version with support for x64, Longhorn, Vista.<br />
      Also added WindowsPlatformId and WindowsPlatformArchitecture functions.<br />
      <br />
      <a href="http://nsis.sourceforge.net/wiki/File:GetVersion.zip" target="_blank">http://nsis.sourceforge.net/wiki/File:GetVersion.zip</a><br />
      <br />
      -Stu</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Jamyn</span><br />
      <span class="post-time small text-muted">10th March 2006 16:31 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>Thanks</strong><br />
      Thanks for this; it is appreciated.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">sissy</span><br />
      <span class="post-time small text-muted">11th March 2006 09:51 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">stu<br />
      <br />
      Great plugin just one slight problem it reports windows media center editon as XP which it is to a degree but would be nice if it could also detect this.<br />
      <br />
      thanks</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
      <span class="post-time small text-muted">11th March 2006 14:06 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Right I'll look into it.<br />
      <br />
      -Stu</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
      <span class="post-time small text-muted">11th March 2006 15:11 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Please try this out (WindowsType function).<br />
      <a href="http://nsis.sourceforge.net/File:GetVersion.zip" target="_blank">http://nsis.sourceforge.net/File:GetVersion.zip</a><br />
      <br />
      -Stu</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">sissy</span><br />
      <span class="post-time small text-muted">12th March 2006 12:19 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Hi Stu,<br />
      <br />
      Still reports as Windows XP.<br />
      <br />
      Found this, might give a heads up <a href="http://salloway.org.uk/mediacenter/2004/version.htm" target="_blank">http://salloway.org.uk/mediacenter/2004/version.htm</a><br />
      <br />
      Looks like they read the ident key<br />
      <br />
      HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Media Center\Ident key<br />
      <br />
      and depending on the value returned determines the version and any patches.<br />
      <br />
      Hope this helps.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
      <span class="post-time small text-muted">12th March 2006 13:12 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">I did say WindowsType function not WindowsName :p<br />
      <br />
      -Stu</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">o_owd</span><br />
      <span class="post-time small text-muted">16th July 2006 07:03 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">hello,<br />
      i was using a plugin for windows detection but it is outdated. so i turned to GetVersion.<br />
      my software is only for NT platform (NT, 2000, XP, 2003, Vista). can i make a check for this with your plugin ?<br />
      i want the installer to check the platform (9x or NT) and ... i'll do the rest... :)<br />
      <br />
      one more question. what is WindowsPlatformId from your plugin ?<br />
      <br />
      thanks,<br />
      OJi.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
      <span class="post-time small text-muted">16th July 2006 10:32 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">1) GetVersion::WindowsName will return e.g. "Windows 2000"<br />
      2) Each Windows has a different Platform ID, like 1 2 3 etc. You should be able to find something about this on Google.<br />
      <br />
      -Stu</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
      <span class="post-time small text-muted">16th July 2006 10:34 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">I am going to rebuild the plugin just to return 2000 if /short is specified as a parameter.<br />
      <br />
      Edit: Now returns e.g. 2000 instead of Windows 2000.<br />
      <br />
      -Stu</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">o_owd</span><br />
      <span class="post-time small text-muted">16th July 2006 11:09 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">thanks, i will try it.<br />
      <br />
      OJi.<br />
      <br />
      edit - the version from wiki is still from april. please post a reply when you upload the new version.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
      <span class="post-time small text-muted">16th July 2006 11:18 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Uploaded.<br />
      <br />
      By the way, the DLL uses .NET because some of its features are only supported by .NET (i.e. Vista detection).<br />
      So, you might want to test the DLL on a system without Microsoft .NET Framework installed.<br />
      <br />
      -Stu</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">o_owd</span><br />
      <span class="post-time small text-muted">16th July 2006 11:20 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">i will. thanks again.<br />
      <br />
      OJi.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">{_trueparuex^}</span><br />
      <span class="post-time small text-muted">16th July 2006 11:43 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"></p>

      <blockquote>
        <i>Originally posted by Afrow UK</i><br />
        <b>Uploaded.<br />
        <br />
        By the way, the DLL uses .NET because some of its features are only supported by .NET (i.e. Vista detection).<br />
        So, you might want to test the DLL on a system without Microsoft .NET Framework installed.<br />
        <br />
        -Stu</b>
      </blockquote>I tried the plug-in in Windows 2000 pro without .NET and it works. Only thing is that WindowsServerName doesn't return anything, no errors nothing.
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
      <span class="post-time small text-muted">16th July 2006 16:19 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">What would have expected it to return?<br />
      There may be a bug.<br />
      <br />
      -Stu</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">{_trueparuex^}</span><br />
      <span class="post-time small text-muted">16th July 2006 20:24 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"></p>

      <blockquote>
        <i>Originally posted by Afrow UK</i><br />
        <b>What would have expected it to return?<br />
        There may be a bug.<br />
        <br />
        -Stu</b>
      </blockquote>Not sure, but it should return Workstation.
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
      <span class="post-time small text-muted">16th July 2006 21:57 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">What is in "HKLM\SYSTEM\CurrentControlSet\Control\ProductOptions\ProductType"?<br />
      <br />
      -Stu</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">{_trueparuex^}</span><br />
      <span class="post-time small text-muted">17th July 2006 11:20 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">It's "WinNT"</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Comperio</span><br />
      <span class="post-time small text-muted">27th July 2006 15:55 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">FYI:<br />
      I just downloaded your latest version and found that IE detection is returning 6.0 when I have 7.0 installed.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
      <span class="post-time small text-muted">27th July 2006 17:28 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">I may remove that function. You can read the IE version from the registry. Infact there's a function in the NSIS documentation under Useful Scripts which reads from the registry. Does that work?<br />
      <br />
      -Stu</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Comperio</span><br />
      <span class="post-time small text-muted">27th July 2006 17:42 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Yep, that works.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
      <span class="post-time small text-muted">27th July 2006 17:51 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">The plugin function reads the version value from shdocvw.dll<br />
      I guess they have left it as 6.0 or something.<br />
      <br />
      -Stu</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Comperio</span><br />
      <span class="post-time small text-muted">28th July 2006 03:38 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Yep, right you are. I just checked mine and it is version 6.0.2900.2919.<br />
      <br />
      <b>edit:</b><br />
      Just to let you know, I've OK with just reading the registry. I only mentioned the problem because you had a feature that didn't work as designed. ;)</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
      <span class="post-time small text-muted">28th July 2006 10:38 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Thanks :)<br />
      I will remove the function soon.<br />
      <br />
      -Stu</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Hywkar</span><br />
      <span class="post-time small text-muted">14th July 2008 13:44 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Is there an easy way to detect if the operating system is windows server 2000? I tried the latest release and on windows 2000 server it gives me "Windows 2000 version 5.0 (Type : Professional, Server Name : )".<br />
      <br />
      <br /></p>
      <pre>
<code><br /> GetVersion::WindowsName<br /> Pop $0<br /> GetVersion::WindowsType<br /> Pop $1<br /> GetVersion::WindowsServerName<br /> Pop $2<br /> GetVersion::WindowsVersion<br /> Pop $3<br /><br /> DetailPrint "Windows $0 version $3 (Type : $1, Server Name : $2)"<br /></code>
</pre>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">MP_chefkoch</span><br />
      <span class="post-time small text-muted">14th July 2008 16:16 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Hi Stuart,<br />
      <br />
      you posted that you maybe will include more products or version checks.<br />
      <br />
      What do you think about including a version check for .Net, which will work with dotNet 1, 2 and 3.<br />
      <br />
      In wiki is a script which is able to do that and it seems to work like a charme, but maybe it would be cool to have it in this plugin, so no additional scripts are needed.<br />
      <br />
      kind regards<br />
      chefkoch</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">o_owd</span><br />
      <span class="post-time small text-muted">4th November 2008 14:11 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Hey,<br />
      <br />
      Can you update the plugin for windows Server 2008 versions and (maybe) future windows 7 ?<br />
      <br />
      thanks,<br />
      OJi.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">xbarns</span><br />
      <span class="post-time small text-muted">6th January 2009 15:31 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Hi Stuart,<br />
      <br />
      any plans of making this work with the unicode version of NSIS?<br />
      <br />
      I tried and only get nice little "boxes" and some numbers back :)<br />
      <br />
      regards<br />
      xBarns</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">mark.ruys</span><br />
      <span class="post-time small text-muted">27th January 2009 19:05 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"></p>

      <blockquote>
        <i>Originally posted by xbarns</i><br />
        <b>Hi Stuart,<br />
        <br />
        any plans of making this work with the unicode version of NSIS?<br />
        <br />
        I tried and only get nice little "boxes" and some numbers back :)<br />
        <br />
        regards<br />
        xBarns</b>
      </blockquote>I did build a Unicode GetVersion.dll to be used with Jim Park's excellent port. I encountered a problem however: generated installers seem to be running in XP-compatibility mode. As a result, GetVersion will report Windows XP SP2 on a Vista machine. I'll try to contact Jim to figure out how to fix it.<br />
      <br />
      Mark
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
      <span class="post-time small text-muted">27th January 2009 20:09 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">You need to use RequestExecutionLevel to avoid Vista's compatibility hacks. If it doesn't work, there might be a problem with the embedded manifest. Maybe it was converted to UTF-16 as well though it should stay UTF-8.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">mark.ruys</span><br />
      <span class="post-time small text-muted">28th January 2009 07:58 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"></p>

      <blockquote>
        <i>Originally posted by kichik</i><br />
        <b>You need to use RequestExecutionLevel to avoid Vista's compatibility hacks. If it doesn't work, there might be a problem with the embedded manifest. Maybe it was converted to UTF-16 as well though it should stay UTF-8.</b>
      </blockquote>The manifest is all right. For some reason the generated installer ran in Windows XP compatiblity mode. And not for me, but for "all users": right-click icon, properties, compatibility, settings for all users. Ticking that one off, and GetVersion.dll returns Vista again.<br />
      <br />
      I rebuild GetVersion.dll and Processes.dll for Unicode. Now I can roll out our installer with Unicode language strings :)
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">cowwoc</span><br />
      <span class="post-time small text-muted">31st January 2009 02:27 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>What about Vista x64 and Windows7?</strong><br />
      How about adding support for detecting Vista 64-bit and Windows 7?</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Anders</span><br />
      <span class="post-time small text-muted">31st January 2009 08:34 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">you already have a header with 64 bit stuff.<br />
      <br />
      7 is not out yet so we can't be 100% sure what the version number is, probably 6.1.XXXX</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Miguel Ventura</span><br />
      <span class="post-time small text-muted">4th May 2009 15:34 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>Service Pack is localized :( -- improvement suggestion</strong><br />
      Hi<br />
      <br />
      Could you please introduce a function to return the value from <font face="courier new">wServicePackMajor</font> and/or <font face="courier new">wServicePackMinor</font> to complement the existing <font face="courier new"><b>WindowsServicePack</b></font> which uses <font face="courier new">szCSDVersion</font>? It's just that the string in <font face="courier new">szCSDVersion</font> is localized and therefore harder to parse (you have to look for the number assuming that instead of "Service Pack" you can get something else).<br />
      <br />
      Thanks for the great plugin<br />
      <br />
      Best regards,<br />
      Miguel</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
      <span class="post-time small text-muted">4th May 2009 16:07 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">I'm afraid I do not have the tools available to build this plugin at this time (nor can I install them because I am on Vista here).<br />
      <br />
      Stu</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">jweinraub</span><br />
      <span class="post-time small text-muted">9th June 2009 14:38 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">There is a new version of WinVer.nsh that does detect Windows 7. I have the latest build, RC-1 on my laptop. I am willing to test GetVersion on it, as I need to have routines in my installers that detect Windows 7.<br />
      <br />
      Thanks</p>
    </div>
    <hr />
    <!-- Bootstrap core CSS -->
    <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
                <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
                <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->

    <div class="container">
      <!-- Put navigation bar here -->

      <ol class="breadcrumb">
        <li><a href="../index.html" class="glyphicon glyphicon-home"></a></li>

        <li><a href="f-65.html">NSIS Discussion</a></li>

        <li class="active">GetVersion plugin</li>
      </ol>

      <p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=221621">GetVersion plugin</a></p><br />

      <div class="post">
        <p class="post-meta"><span class="post-author text-primary">jweinraub</span><br />
        <span class="post-time small text-muted">9th June 2009 18:48 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

        <p class="post-content">where do i get exdll.h and other dependencies so i can build my own copy so i can try to add win7 items?</p>
      </div>
      <hr />

      <div class="post">
        <p class="post-meta"><span class="post-author text-primary">Anders</span><br />
        <span class="post-time small text-muted">9th June 2009 19:03 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

        <p class="post-content">download the source @ <a href="http://sourceforge.net/project/showfiles.php?group_id=22049&amp;package_id=15374" target="_blank">http://sourceforge.net/project/showf...ckage_id=15374</a><br />
        <br />
        or browse the code directly:<br />
        <a href="http://nsis.svn.sourceforge.net/viewvc/nsis/NSIS/trunk/Contrib/ExDLL/" target="_blank">http://nsis.svn.sourceforge.net/view...Contrib/ExDLL/</a><br />
        <br />
        and<br />
        <br />
        <a href="http://nsis.svn.sourceforge.net/viewvc/nsis/NSIS/trunk/Source/exehead/api.h?revision=5917&amp;view=markup" target="_blank">http://nsis.svn.sourceforge.net/view...17&amp;view=markup</a></p>
      </div>
      <hr />

      <div class="post">
        <p class="post-meta"><span class="post-author text-primary">TJK</span><br />
        <span class="post-time small text-muted">25th June 2009 14:29 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

        <p class="post-content"><strong>GetVersion update for Windows 8 and 2008R2</strong><br />
        Hello<br />
        <br />
        I currently use GetVersion to successfully control the scripts behaviour dependent on the Windows version and architecture.<br />
        <br />
        I see that WinVer.nsh is updated to include the ability to detect Windows 7 and Windows Server 2008 R2 - but since I already use GetVersion I'd prefer to continue using it rather than to switch to WinVer.nsh.<br />
        <br />
        Will GetVersion be similarly updated to detect and report Windows 7 and Windows Server 2008 R2 and if so does anyone have any idea when - or is GetVersion no longer being updated?<br />
        <br />
        Thanks<br />
        <br />
        Tim</p>
      </div>
      <hr />

      <div class="post">
        <p class="post-meta"><span class="post-author text-primary">PadaKwaak</span><br />
        <span class="post-time small text-muted">24th July 2009 01:00 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

        <p class="post-content">TJK, you could, for the while being, identify Windows 7 by checking both WindowsServerName and WindowsVersion.<br />
        The WindowsVersion would report 6.1 for Windows7/Windows Server 2008 R2.<br />
        The WindowsServerName would be blank for Windows 7 &amp; filled in for Windows Server 2008 R2.<br />
        <br />
        I have included the modifications for Windows 7/Windows Server 2008 R2 and compiled it with Visual C++ 2008 Express, which resulted in the DLL being 21kB! Here is the dll &amp; modified source: <a href="http://www.mediafire.com/?sharekey=9a5aa440977959f3e62ea590dc5e5dbbe04e75f6e8ebb871" target="_blank">http://www.mediafire.com/?sharekey=9...4e75f6e8ebb871</a><br />
        <br />
        I haven't tested it for Vista &amp; Windows 7 yet.<br />
        A friend of mine got the following error when he used my dll in Win7 x64 :( "Could not load: C:\Users\ludwig\AppData\Local\Temp\nszCDEE.tmp\GetVersion.dll"<br />
        I guess it has to do with .NetFX.<br />
        <br />
        Regards<br />
        Chris</p>
      </div>
      <hr />

      <div class="post">
        <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
        <span class="post-time small text-muted">24th July 2009 13:46 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

        <p class="post-content">I have updated the plugin.<br />
        <br />
        Stu</p>
      </div>
      <hr />

      <div class="post">
        <p class="post-meta"><span class="post-author text-primary">TJK</span><br />
        <span class="post-time small text-muted">24th July 2009 15:17 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

        <p class="post-content">Thanks</p>
      </div>
      <hr />

      <div class="post">
        <p class="post-meta"><span class="post-author text-primary">Miguel Ventura</span><br />
        <span class="post-time small text-muted">20th August 2009 17:19 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

        <p class="post-content"><strong>still missing locale dependent SP version functions</strong><br />
        Stu please also add functions to get from <font face="courier new">wServicePackMajor</font> and <font face="courier new">wServicePackMinor</font> instead of the localized WindowsServicePack using <font face="courier new">szCSDVersion</font><br />
        <br />
        I've added those functions (I'm attaching them). I'm just not sharing the binary DLL 'cause it gets huge (100+KB) when I compile it here.<br />
        <br />
        Best regards,<br />
        Miguel</p>
      </div>
      <hr />

      <div class="post">
        <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
        <span class="post-time small text-muted">21st August 2009 15:51 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

        <p class="post-content">Thanks, done.<br />
        <br />
        Stu</p>
      </div>
      <hr />

      <div class="post">
        <p class="post-meta"><span class="post-author text-primary">ts1612</span><br />
        <span class="post-time small text-muted">14th September 2009 13:44 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

        <p class="post-content"><strong>Feature wish/idea</strong><br />
        First of all thanks for the very great plugin ;)<br />
        <br />
        When you display the architecture you return just 32 or 64, but not the processor architecture like AMD64, IA64, EM64T, x64. But sometimes it would be important to know things exactly (e.g. if you want to auto install Net Framework 2.0 the installers of MS are depending on the architecture as the installer is different for IA64 and x64).<br />
        <br />
        I totally understand, that in most cases the result 32 or 64 is enough, but why not making an additional function GetVersion::WindowsProcessorArchitecture which shows the processor architectiure string.</p>
      </div>
      <hr />

      <div class="post">
        <p class="post-meta"><span class="post-author text-primary">Speed78</span><br />
        <span class="post-time small text-muted">17th October 2009 15:50 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

        <p class="post-content">Hey Stu,<br />
        <br />
        thank for this plugin. I've updated the download version information and the changelog on the download page.<br />
        <br />
        Kind regards<br />
        <br />
        Rainer</p>
      </div>
      <hr />

      <div class="post">
        <p class="post-meta"><span class="post-author text-primary">th_mi</span><br />
        <span class="post-time small text-muted">20th October 2009 12:33 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

        <p class="post-content">Unfortunately this plugin lacks of detecting the real windows version if the installer is started under compatibility settings.<br />
        <br />
        In this case "GetVersionEx" returns the values of the OS selected in the compatibility settings, not the real installed OS!<br />
        <br />
        See the MSDN:<br />
        Link: <a href="http://msdn.microsoft.com/en-us/library/ms724451(VS.85).aspx" target="_blank">http://msdn.microsoft.com/en-us/libr...51(VS.85).aspx</a><br />
        <br />
        "If compatibility mode is in effect, the GetVersionEx function reports the operating system as it identifies itself, which may not be the operating system that is installed. For example, if compatibility mode is in effect, GetVersionEx reports the operating system that is selected for application compatibility."</p>
      </div>
      <hr />

      <div class="post">
        <p class="post-meta"><span class="post-author text-primary">Anders</span><br />
        <span class="post-time small text-muted">20th October 2009 14:28 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

        <p class="post-content">And this is a fight you will ALWAYS lose, you could check the version of system dll's etc, but in the end, if the OS wanted to, it could lie about those also, that's the whole point of forcing a compatibility setting</p>
      </div>
      <hr />

      <div class="post">
        <p class="post-meta"><span class="post-author text-primary">th_mi</span><br />
        <span class="post-time small text-muted">21st October 2009 11:34 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

        <p class="post-content"></p>

        <blockquote>
          <i>Originally posted by Anders</i><br />
          <b>And this is a fight you will ALWAYS lose</b>
        </blockquote>No! Microsoft itself give the advice to find out the version by checking the OS properties and the version number of i.e. kernel DLL. This is a very save way to find out the real OS.<br />
        And I'm sure this possibility will never be disabled since it will be always necessary to get the real OS version, since Win2000, XP, Vista and Seven hape parts with annoying different behaviour which is handled differently.<br />
        <br />
        The article postet at Monday, February 26, 2007 is very interesting and points out reliable possibilities:<br />
        <br />
        <a href="http://17slon.com/blogs/gabr/2007_02_01_archive.html" target="_blank">http://17slon.com/blogs/gabr/2007_02_01_archive.html</a>
      </div>
      <hr />

      <div class="post">
        <p class="post-meta"><span class="post-author text-primary">gummibrot@gmx.n</span><br />
        <span class="post-time small text-muted">19th May 2010 10:57 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

        <p class="post-content"><strong>Strange results for getVersion</strong><br />
        Hi there,<br />
        <br />
        I tried to use this promising plugin for my installer project, but when I do so, I'm getting some strange results from the functions. See attached file.<br />
        <br />
        I seems that the result string of <b>GetVersion::WindowsType</b> is translated into chinese or some other "cryptic" language thing.<br />
        <br />
        Installer is run in English. But I use unicode version of NSIS to be able to install in Japanese.<br />
        All other strings I use are displayed correctly.<br />
        <br />
        My system setup:<br />
        Windows XP Professional SP3, German<br />
        <br />
        Any ideas?<br />
        <br />
        Thanks,<br />
        Jo</p>
      </div>
      <hr />

      <div class="post">
        <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
        <span class="post-time small text-muted">19th May 2010 11:05 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

        <p class="post-content">The plug-in is not Unicode. It needs rebuilding (among mods). I haven't got the time to do it at the moment.<br />
        <br />
        Stu</p>
      </div>
      <hr />

      <div class="post">
        <p class="post-meta"><span class="post-author text-primary">Anders</span><br />
        <span class="post-time small text-muted">19th May 2010 12:02 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

        <p class="post-content">you could try <a href="http://nsis.sourceforge.net/CallAnsiPlugin_plug-in" target="_blank">http://nsis.sourceforge.net/CallAnsiPlugin_plug-in</a> (Does not work on every plugin, but you can always give it a shot)</p>
      </div>
      <hr />

      <div class="post">
        <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
        <span class="post-time small text-muted">10th July 2010 17:49 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

        <p class="post-content">Finally got around to building a Unicode version along with some other changes. Uploaded v1.2.<br />
        <br />
        Stu</p>
      </div>
      <hr />

      <div class="post">
        <p class="post-meta"><span class="post-author text-primary">pengyou</span><br />
        <span class="post-time small text-muted">11th July 2010 13:16 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

        <p class="post-content">When I tried using version 1.2 of the GetVersion (ANSI) plugin on my Windows 7 Professional 64-bit system <b>GetVersion::WindowsType</b> reported "Business" instead of "Professional"</p>
      </div>
      <hr />

      <div class="post">
        <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
        <span class="post-time small text-muted">11th July 2010 16:18 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

        <p class="post-content">It does that for me too. I am using the correct constant values defined in winnt.h so it must be right.<br />
        <br />
        Stu</p>
      </div>
      <hr />

      <div class="post">
        <p class="post-meta"><span class="post-author text-primary">pengyou</span><br />
        <span class="post-time small text-muted">11th July 2010 17:20 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

        <p class="post-content">I think the plugin should be returning "Professional" when it is run on a Windows 7 Professional system.<br />
        <br />
        I found this on MSDN:<br />
        <br />
        The following table indicates the product types that were introduced in 6.1.0.0, and what they will map to if GetProductInfo is called with version 6.0.0.0 on a 6.1.0.0 system.<br /></p>
        <pre>
<code>New for 6.1.0.0            Value returned with 6.0.0.0<br />PRODUCT_PROFESSIONAL       PRODUCT_BUSINESS<br />PRODUCT_PROFESSIONAL_N     PRODUCT_BUSINESS_N<br />PRODUCT_STARTER_N          PRODUCT_STARTER</code>
</pre><br />
        <br />
        See <a href="http://msdn.microsoft.com/en-us/library/ms724358(VS.85).aspx" target="_blank">http://msdn.microsoft.com/en-us/libr...58(VS.85).aspx</a>
      </div>
      <hr />

      <div class="post">
        <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
        <span class="post-time small text-muted">12th July 2010 16:53 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

        <p class="post-content">Uploaded v1.3.<br />
        <br />
        Stu</p>
      </div>
      <hr />

      <div class="post">
        <p class="post-meta"><span class="post-author text-primary">pengyou</span><br />
        <span class="post-time small text-muted">12th July 2010 18:29 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

        <p class="post-content">Thanks for the new version of the plugin.<br />
        <br />
        GetVersion::WindowsType now reports "Professional" when used on my Windows 7 Professional 64-bit system.</p>
      </div>
      <hr />

      <div class="post">
        <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
        <span class="post-time small text-muted">23rd July 2010 17:38 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

        <p class="post-content">Fixed Unicode build (Visual Studio's fault for not retaining UNICODE define when upgrading the vcproj from 2005 to 2010).<br />
        <br />
        Stu</p>
      </div>
      <hr />

      <div class="post">
        <p class="post-meta"><span class="post-author text-primary">jksoft</span><br />
        <span class="post-time small text-muted">12th October 2010 14:49 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

        <p class="post-content"><strong>Bug in latest version</strong><br />
        I just downloaded the latest version of the GetVersion plugin from the NSIS website and there appears to be a bug. When I do my GetVersion::WindowsType call, it is popping up a message box that says Professional in the title and Professional in the box itself. It looks like some debug code may have been left in. It is version 1.4.0.1.</p>
      </div>
      <hr />

      <div class="post">
        <p class="post-meta"><span class="post-author text-primary">jksoft</span><br />
        <span class="post-time small text-muted">12th October 2010 14:50 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

        <p class="post-content">I guess since you have include the source, I could also recompile it but just wanted to make you aware.</p>
      </div>
      <hr />

      <div class="post">
        <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
        <span class="post-time small text-muted">12th October 2010 16:59 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

        <p class="post-content">Thanks, fixed.<br />
        <br />
        Stu</p>
      </div>
      <hr />

      <div class="post">
        <p class="post-meta"><span class="post-author text-primary">BoscoBilly</span><br />
        <span class="post-time small text-muted">25th March 2011 21:58 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

        <p class="post-content"><strong>Winver returns Vista instaed of 7 on win7 64 bit</strong><br />
        My app needs to run in the compatability mode on win7 64.<br />
        My NSIS installer mis-identifies the OS as Windows Vista 64 bit rather than Win7.<br />
        Is this the same problem mentioned above, wherein CM will set an OS, not necessarily the installed OS, so that winver is mislead?<br />
        Is there a way to detect the correct installed OS at this time?<br />
        Thx.</p>
      </div>
      <hr />

      <div class="post">
        <p class="post-meta"><span class="post-author text-primary">Anders</span><br />
        <span class="post-time small text-muted">26th March 2011 00:26 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

        <p class="post-content">Kernel32::CreateRemoteThreadEx is new in Win7, you could check for it by calling GetProcAddress with the system plugin:<br /></p>
        <pre>
<span style="color: #007700">!include</span><span style="color: #0000BB">LogicLib</span><span style="color: #007700">.</span><span style="color: #0000BB">nsh
<br /><br />System</span><span style="color: #007700">::</span><span style="color: #0000BB">Call</span><span style="color: #DD0000">'Kernel32::LoadLibraryA(m"Kernel32")i.s'
<br /></span><span style="color: #0000BB">System</span><span style="color: #007700">::</span><span style="color: #0000BB">Call</span><span style="color: #DD0000">'Kernel32::GetProcAddress(is,m"CreateRemoteThreadEx")i.r0'
<br /></span><span style="color: #007700">${If}$</span><span style="color: #0000BB">0</span><span style="color: #007700">&lt;&gt;</span><span style="color: #0000BB">0
<br />MessageBoxmb_okSeven</span><span style="color: #007700">+
<br />${EndIf}
</span>
</pre>
      </div>
      <hr />

      <div class="post">
        <p class="post-meta"><span class="post-author text-primary">BoscoBilly</span><br />
        <span class="post-time small text-muted">26th March 2011 00:37 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

        <p class="post-content">Thanks, Anders.<br />
        I'll check this out.</p>
      </div>
      <hr />

      <div class="post">
        <p class="post-meta"><span class="post-author text-primary">sols_HeG</span><br />
        <span class="post-time small text-muted">1st August 2012 08:42 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

        <p class="post-content">Hi there,<br />
        <br />
        are you still working on this PlugIn?<br />
        I would like to check a Windows Server 2012<br />
        <br />
        Great PlugIn bytheway ;)<br />
        <br />
        Greetings from Munich<br />
        heg</p>
      </div>
      <hr />

      <div class="post">
        <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
        <span class="post-time small text-muted">1st August 2012 12:15 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

        <p class="post-content">I will upload the plug-in at some point but I would recommend that you can use this instead anyway... It's an updated version of WinVer.nsh which is bundled with NSIS: <a href="http://www.afrowsoft.co.uk/dl/WinVer.nsh" target="_blank">http://www.afrowsoft.co.uk/dl/WinVer.nsh</a><br />
        <br />
        ${If} ${IsWin2008}<br />
        ...<br />
        <br />
        Edit: Anders has rightly pointed out that as Windows 8 is not out yet the version number could be different in the final product. This may not be likely but use this at your own risk!<br />
        <br />
        Stu</p>
      </div>
      <hr />

      <div class="post">
        <p class="post-meta"><span class="post-author text-primary">NgocHuyPAV</span><br />
        <span class="post-time small text-muted">11th August 2012 04:06 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

        <p class="post-content">Thank Afrow UK. I used GetVersion 6 months ago. It's good! But GetVersion plugin doesn't support Win 8! Can you upgrade for GetVersion plugin? I'm look forward to hearing your answer! Thank you!</p>
      </div>
      <hr />

      <div class="post">
        <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
        <span class="post-time small text-muted">11th August 2012 11:45 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

        <p class="post-content">See the post above yours.<br />
        <br />
        Stu</p>
      </div>
      <hr />

      <div class="footer">
        <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
      </div>
    </div><script src="../js/highlight.pack.js" type="text/javascript">
</script> <script type="text/javascript">
//<![CDATA[
    hljs.initHighlightingOnLoad();
    //]]>
    </script>
  </div>
</body>
</html>
