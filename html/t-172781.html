<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="description" content="Newbie - Error Using NIS Edit 2.0"><title>Newbie - Error Using NIS Edit 2.0 - NSIS Forums</title><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script><link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css"><link rel="stylesheet" href="../css/style.css" type="text/css"><!--[if lt IE 9]><script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script><script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script><![endif]--></head><body><div class="container"><ol class="breadcrumb"><li><a href="../index.html" class="glyphicon glyphicon-home"></a></li><li><a href="f-65.html">NSIS Discussion</a></li><li class="active">Newbie - Error Using NIS Edit 2.0</li></ol><p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=172781">Newbie - Error Using NIS Edit 2.0</a></p><br><div class="post"><p class="post-meta"><span class="post-author text-primary">hatflyer</span><br><span class="post-time small text-muted">10th March 2004 02:57 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>Newbie - Error Using NIS Edit 2.0</strong><br>I barely know what I'm doing, but I tried to use the wizard to create a script file. I clicked all the defaults, yet when compiled, I got the following errors:<br><br>Invalid command: InstallOptions::initDialog<br>Error in macro MUI_INSTALLOPTIONS_INITDIALOG on macroline 5<br>Error in macro MUI_FUNCTION_WELCOMEPAGE on macroline 45<br>Error in macro MUI_PAGE_WELCOME on macroline 23<br>Error in script "C:\Documents and Settings\Owner\Desktop\Untitled 03.nsi" on line 21 -- aborting creation process<br><br>Anyone know why this failed?<br><br>Thanks,<br><br>Matt</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">deguix</span><br><span class="post-time small text-muted">10th March 2004 03:09 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">If you want to know why, please attach the script to fix it.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">hatflyer</span><br><span class="post-time small text-muted">10th March 2004 03:58 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Here it is. BTW, I have Winodws XP if it matters.<br><br>; HM NIS Edit Wizard helper defines<br>!define PRODUCT_NAME "My application"<br>!define PRODUCT_VERSION "1.0"<br>!define PRODUCT_PUBLISHER "My company, Inc."<br>!define PRODUCT_WEB_SITE "http://www.mycompany.com"<br>!define PRODUCT_DIR_REGKEY "Software\Microsoft\Windows\CurrentVersion\App Paths\AppMainExe.exe"<br>!define PRODUCT_UNINST_KEY "Software\Microsoft\Windows\CurrentVersion\Uninstall\${PRODUCT_NAME}"<br>!define PRODUCT_UNINST_ROOT_KEY "HKLM"<br><br>; MUI 1.67 compatible ------<br>!include "MUI.nsh"<br><br>; MUI Settings<br>!define MUI_ABORTWARNING<br>!define MUI_ICON "${NSISDIR}\Contrib\Graphics\Icons\modern-install.ico"<br>!define MUI_UNICON "${NSISDIR}\Contrib\Graphics\Icons\modern-uninstall.ico"<br><br>; Welcome page<br>!insertmacro MUI_PAGE_WELCOME<br>; License page<br>!insertmacro MUI_PAGE_LICENSE "c:\path\to\licence\YourSoftwareLicence.txt"<br>; Directory page<br>!insertmacro MUI_PAGE_DIRECTORY<br>; Instfiles page<br>!insertmacro MUI_PAGE_INSTFILES<br>; Finish page<br>!define MUI_FINISHPAGE_RUN "$INSTDIR\AppMainExe.exe"<br>!insertmacro MUI_PAGE_FINISH<br><br>; Uninstaller pages<br>!insertmacro MUI_UNPAGE_INSTFILES<br><br>; Language files<br>!insertmacro MUI_LANGUAGE "English"<br><br>; MUI end ------<br><br>Name "${PRODUCT_NAME} ${PRODUCT_VERSION}"<br>OutFile "Setup.exe"<br>InstallDir "$PROGRAMFILES\My application"<br>InstallDirRegKey HKLM "${PRODUCT_DIR_REGKEY}" ""<br>ShowInstDetails show<br>ShowUnInstDetails show<br><br>Section "MainSection" SEC01<br>SetOutPath "$INSTDIR"<br>SetOverwrite ifnewer<br>File "c:\path\to\file\AppMainExe.exe"<br>CreateDirectory "$SMPROGRAMS\My application"<br>CreateShortCut "$SMPROGRAMS\My application\My application.lnk" "$INSTDIR\AppMainExe.exe"<br>CreateShortCut "$DESKTOP\My application.lnk" "$INSTDIR\AppMainExe.exe"<br>File "c:\path\to\file\Example.file"<br>SectionEnd<br><br>Section -AdditionalIcons<br>WriteIniStr "$INSTDIR\${PRODUCT_NAME}.url" "InternetShortcut" "URL" "${PRODUCT_WEB_SITE}"<br>CreateShortCut "$SMPROGRAMS\My application\Website.lnk" "$INSTDIR\${PRODUCT_NAME}.url"<br>CreateShortCut "$SMPROGRAMS\My application\Uninstall.lnk" "$INSTDIR\uninst.exe"<br>SectionEnd<br><br>Section -Post<br>WriteUninstaller "$INSTDIR\uninst.exe"<br>WriteRegStr HKLM "${PRODUCT_DIR_REGKEY}" "" "$INSTDIR\AppMainExe.exe"<br>WriteRegStr ${PRODUCT_UNINST_ROOT_KEY} "${PRODUCT_UNINST_KEY}" "DisplayName" "$(^Name)"<br>WriteRegStr ${PRODUCT_UNINST_ROOT_KEY} "${PRODUCT_UNINST_KEY}" "UninstallString" "$INSTDIR\uninst.exe"<br>WriteRegStr ${PRODUCT_UNINST_ROOT_KEY} "${PRODUCT_UNINST_KEY}" "DisplayIcon" "$INSTDIR\AppMainExe.exe"<br>WriteRegStr ${PRODUCT_UNINST_ROOT_KEY} "${PRODUCT_UNINST_KEY}" "DisplayVersion" "${PRODUCT_VERSION}"<br>WriteRegStr ${PRODUCT_UNINST_ROOT_KEY} "${PRODUCT_UNINST_KEY}" "URLInfoAbout" "${PRODUCT_WEB_SITE}"<br>WriteRegStr ${PRODUCT_UNINST_ROOT_KEY} "${PRODUCT_UNINST_KEY}" "Publisher" "${PRODUCT_PUBLISHER}"<br>SectionEnd<br><br><br>Function un.onUninstSuccess<br>HideWindow<br>MessageBox MB_ICONINFORMATION|MB_OK "$(^Name) was successfully removed from your computer."<br>FunctionEnd<br><br>Function un.onInit<br>MessageBox MB_ICONQUESTION|MB_YESNO|MB_DEFBUTTON2 "Are you sure you want to completely remove $(^Name) and all of its components?" IDYES +2<br>Abort<br>FunctionEnd<br><br>Section Uninstall<br>Delete "$INSTDIR\${PRODUCT_NAME}.url"<br>Delete "$INSTDIR\uninst.exe"<br>Delete "$INSTDIR\Example.file"<br>Delete "$INSTDIR\AppMainExe.exe"<br><br>Delete "$SMPROGRAMS\My application\Uninstall.lnk"<br>Delete "$SMPROGRAMS\My application\Website.lnk"<br>Delete "$DESKTOP\My application.lnk"<br>Delete "$SMPROGRAMS\My application\My application.lnk"<br><br>RMDir "$SMPROGRAMS\My application"<br>RMDir "$INSTDIR"<br><br>DeleteRegKey ${PRODUCT_UNINST_ROOT_KEY} "${PRODUCT_UNINST_KEY}"<br>DeleteRegKey HKLM "${PRODUCT_DIR_REGKEY}"<br>SetAutoClose true<br>SectionEnd</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">shantanu_gadgil</span><br><span class="post-time small text-muted">10th March 2004 05:22 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>see what I was saying ... :)</strong><br>The first user says... "..I barely know what I am doing..."<br><br>This was exactly my point (in a previous post about how NSIS Modern is really difficult to learn)<br><br>When I first used NSIS (~version 1.0 something), I thought..."hey cool, an installation software which looks like a programming language". I didn't know the "techinical" word called "script language".<br><br>Anyway, from the classic version 1.98, there is such a huge difference , the user has to kinda re-learn the system... especially the MACROS thing :)<br><br>We really :D really :D need to simplify the scripting method to make newbies feel comfortable !!!<br><br>That is the idea right...convert everyone to the NSIS faith :D ;)<br><br>If not simply the scripting, how about a UI designing software which will run in CONJUNCTION with the NSIS version, like (Innosetup+ISTool)<br><br>I know SB 3.0 is under way !...</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Vytautas</span><br><span class="post-time small text-muted">10th March 2004 05:57 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">It looks like there might be something wrong with your NSIS installation. I would try downloading it again and reinstalling.<br><br>Vytautas</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">hatflyer</span><br><span class="post-time small text-muted">10th March 2004 21:26 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">I think I solved it. The referenced file was not in the right place.<br><br>My other question is - I can generate the file that does indeed load the application on my computer. But this program will be on a CD that others will use to install the software. How do I deal with which drive (e.g. D, or E, or...) that the user will have the CD in so the installation can work? Is that somehow automatically embeded?<br><br>Thanks,</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">deguix</span><br><span class="post-time small text-muted">10th March 2004 23:04 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">You can detect the drives using "Detect Drives" function, see it in my signature. You can use StrCpy $EXEDIR $EXEDIR 2 to compare with the function results.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">hatflyer</span><br><span class="post-time small text-muted">11th March 2004 03:15 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">I downloaded your sample script got an error:<br><br>invalid script: never had OutFile command got an error:<br><br>As I'm new to this, much of your sample went over my head.<br><br>As I said, my installation program works from my desktop (thanks to the wizard help). Is it really that much more work to have it work from a CD drive? Could it be made easier to prompt for the drive name from the user? I guess I'm having trouble seeing how your sample can be incorporated into my script. This is what I have:<br><br>; HM NIS Edit Wizard helper defines<br>!define PRODUCT_NAME "2 Brain Poker"<br>!define PRODUCT_VERSION "2.0"<br>!define PRODUCT_PUBLISHER "Schmitz, Inc."<br>!define PRODUCT_WEB_SITE "http://www.2brainpoker.com"<br>!define PRODUCT_DIR_REGKEY "Software\Microsoft\Windows\CurrentVersion\App Paths\cards1.exe"<br>!define PRODUCT_UNINST_KEY "Software\Microsoft\Windows\CurrentVersion\Uninstall\${PRODUCT_NAME}"<br>!define PRODUCT_UNINST_ROOT_KEY "HKLM"<br><br>; MUI 1.67 compatible ------<br>!include "MUI.nsh"<br><br>; MUI Settings<br>!define MUI_ABORTWARNING<br>!define MUI_ICON "${NSISDIR}\Contrib\Graphics\Icons\modern-install.ico"<br>!define MUI_UNICON "${NSISDIR}\Contrib\Graphics\Icons\modern-uninstall.ico"<br><br>; Welcome page<br>!insertmacro MUI_PAGE_WELCOME<br>; License page<br>!insertmacro MUI_PAGE_LICENSE "license.txt"<br>; Directory page<br>!insertmacro MUI_PAGE_DIRECTORY<br>; Instfiles page<br>!insertmacro MUI_PAGE_INSTFILES<br>; Finish page<br>!define MUI_FINISHPAGE_RUN "$PROGRAMFILES\cards1.exe"<br>!insertmacro MUI_PAGE_FINISH<br><br>; Uninstaller pages<br>!insertmacro MUI_UNPAGE_INSTFILES<br><br>; Language files<br>!insertmacro MUI_LANGUAGE "English"<br><br>; MUI end ------<br><br>Name "${PRODUCT_NAME} ${PRODUCT_VERSION}"<br>OutFile "Setup.exe"<br>InstallDir "$PROGRAMFILES\2 Brain Poker"<br>InstallDirRegKey HKLM "${PRODUCT_DIR_REGKEY}" ""<br>ShowInstDetails show<br>ShowUnInstDetails show<br><br>Section "MainSection" SEC01<br>SetOutPath "$PROGRAMFILES"<br>SetOverwrite ifnewer<br>File "cards1.exe"<br>CreateDirectory "$SMPROGRAMS\2 Brain Poker"<br>CreateShortCut "$SMPROGRAMS\2 Brain Poker\2 Brain Poker.lnk" "$PROGRAMFILES\cards1.exe"<br>CreateShortCut "$DESKTOP\2 Brain Poker.lnk" "$PROGRAMFILES\cards1.exe"<br>File "hodds.txt"<br>File "d.txt"<br>File "hole.txt"<br>SectionEnd<br><br>Section -AdditionalIcons<br>WriteIniStr "$INSTDIR\${PRODUCT_NAME}.url" "InternetShortcut" "URL" "${PRODUCT_WEB_SITE}"<br>CreateShortCut "$SMPROGRAMS\2 Brain Poker\Website.lnk" "$INSTDIR\${PRODUCT_NAME}.url"<br>CreateShortCut "$SMPROGRAMS\2 Brain Poker\Uninstall.lnk" "$INSTDIR\uninst.exe"<br>SectionEnd<br><br>Section -Post<br>WriteUninstaller "$INSTDIR\uninst.exe"<br>WriteRegStr HKLM "${PRODUCT_DIR_REGKEY}" "" "$PROGRAMFILES\cards1.exe"<br>WriteRegStr ${PRODUCT_UNINST_ROOT_KEY} "${PRODUCT_UNINST_KEY}" "DisplayName" "$(^Name)"<br>WriteRegStr ${PRODUCT_UNINST_ROOT_KEY} "${PRODUCT_UNINST_KEY}" "UninstallString" "$INSTDIR\uninst.exe"<br>WriteRegStr ${PRODUCT_UNINST_ROOT_KEY} "${PRODUCT_UNINST_KEY}" "DisplayIcon" "$PROGRAMFILES\cards1.exe"<br>WriteRegStr ${PRODUCT_UNINST_ROOT_KEY} "${PRODUCT_UNINST_KEY}" "DisplayVersion" "${PRODUCT_VERSION}"<br>WriteRegStr ${PRODUCT_UNINST_ROOT_KEY} "${PRODUCT_UNINST_KEY}" "URLInfoAbout" "${PRODUCT_WEB_SITE}"<br>WriteRegStr ${PRODUCT_UNINST_ROOT_KEY} "${PRODUCT_UNINST_KEY}" "Publisher" "${PRODUCT_PUBLISHER}"<br>SectionEnd<br><br><br>Function un.onUninstSuccess<br>HideWindow<br>MessageBox MB_ICONINFORMATION|MB_OK "$(^Name) was successfully removed from your computer."<br>FunctionEnd<br><br>Function un.onInit<br>MessageBox MB_ICONQUESTION|MB_YESNO|MB_DEFBUTTON2 "Are you sure you want to completely remove $(^Name) and all of its components?" IDYES +2<br>Abort<br>FunctionEnd<br><br>Section Uninstall<br>Delete "$INSTDIR\${PRODUCT_NAME}.url"<br>Delete "$INSTDIR\uninst.exe"<br>Delete "$PROGRAMFILES\hole.txt"<br>Delete "$PROGRAMFILES\d.txt"<br>Delete "$PROGRAMFILES\hodds.txt"<br>Delete "$PROGRAMFILES\cards1.exe"<br><br>Delete "$SMPROGRAMS\2 Brain Poker\Uninstall.lnk"<br>Delete "$SMPROGRAMS\2 Brain Poker\Website.lnk"<br>Delete "$DESKTOP\2 Brain Poker.lnk"<br>Delete "$SMPROGRAMS\2 Brain Poker\2 Brain Poker.lnk"<br><br>RMDir "$SMPROGRAMS\2 Brain Poker"<br><br>DeleteRegKey ${PRODUCT_UNINST_ROOT_KEY} "${PRODUCT_UNINST_KEY}"<br>DeleteRegKey HKLM "${PRODUCT_DIR_REGKEY}"<br>SetAutoClose true<br>SectionEnd</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">hatflyer</span><br><span class="post-time small text-muted">11th March 2004 18:08 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Actually, it looks like the installation works from a CD drive automatically, without caring which CD drive it is.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">pepeknamornik</span><br><span class="post-time small text-muted">8th April 2011 19:36 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>you are right</strong><br>Just 1hour ago i was lost... ...errors.. errors and errors from all script where i did copy+paste. ...investigation was needed. Main issue in my opinion are missing detail in tutorial. Macros are described but not explained. ...and it not so difficult. If you need to use macros please make sure you create nsh and save into Include folder. Your script have include File where macro is defined...thats all :)<br>..of course, please make sure output file is defined.<br><br><a href="https://lh6.googleusercontent.com/_am7bVbatnh8/TZ9Ucq3kyBI/AAAAAAAAATc/D621ayOueV0/s1024/using-macro-nsis.jpg" target="_blank">https://lh6.googleusercontent.com/_a...macro-nsis.jpg</a><br><br></p><blockquote><small>Originally posted by shantanu_gadgil</small><br>The first user says... "..I barely know what I am doing..."<br><br>This was exactly my point (in a previous post about how NSIS Modern is really difficult to learn)<br><br>When I first used NSIS (~version 1.0 something), I thought..."hey cool, an installation software which looks like a programming language". I didn't know the "techinical" word called "script language".<br><br>Anyway, from the classic version 1.98, there is such a huge difference , the user has to kinda re-learn the system... especially the MACROS thing :)<br><br>We really :D really :D need to simplify the scripting method to make newbies feel comfortable !!!<br><br>That is the idea right...convert everyone to the NSIS faith :D ;)<br><br>If not simply the scripting, how about a UI designing software which will run in CONJUNCTION with the NSIS version, like (Innosetup+ISTool)<br><br>I know SB 3.0 is under way !...</blockquote></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">MSG</span><br><span class="post-time small text-muted">8th April 2011 20:17 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">pepeknamornik: Please don't reply to threads that were closed seven (!!) years ago.</p></div><hr><div class="footer"><p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p></div></div><script src="../js/highlight.pack.js" type="text/javascript"></script><script type="text/javascript">//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]></script></body></html>