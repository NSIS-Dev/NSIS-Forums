<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="Can't get UMUI_PAGE_ALTERNATIVESTARTMENU to work" />

  <title>Can't get UMUI_PAGE_ALTERNATIVESTARTMENU to work - NSIS Forums</title>
  <script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script>
  <!-- Bootstrap core CSS -->

  <link rel="stylesheet" type="text/css" href="//netdna.bootstrapcdn.com/bootswatch/3.0.1/readable/bootstrap.min.css" />
  <link rel="stylesheet" href="../css/style.css" type="text/css" /><!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!--[if lt IE 9]>
                <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
                <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->
</head>

<body>
  <div class="container">
    <!-- Put navigation bar here -->

    <ol class="breadcrumb">
      <li><a href="../index.html" class="glyphicon glyphicon-home"></a></li>

      <li><a href="f-65.html">NSIS Discussion</a></li>

      <li class="active">Can't get UMUI_PAGE_ALTERNATIVESTARTMENU to work</li>
    </ol>

    <p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=347430">Can't get UMUI_PAGE_ALTERNATIVESTARTMENU to work</a></p><br />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">z01</span><br />
      <span class="post-time small text-muted">27th August 2012 06:46 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>Can't get UMUI_PAGE_ALTERNATIVESTARTMENU to work</strong><br />
      I've been using the UMUI rather successfully, and have my installer almost complete. The one thing I've been unable to do is to get UMUI_PAGE_ALTERNATIVESTARTMENU to work. Specifically, my installer won't even compile when I have that macro in it. I've also tried MUI_PAGE_STARTMENU with essentially identical results. My guess is that I'm missing something basic; for one thing, I'm not quite sure what "page_id" is, and there isn't much documentation on it.<br />
      <br />
      I first tried just putting the following page macro into my list of pages:<br />
      <br />
      !insertmacro UMUI_PAGE_ALTERNATIVESTARTMENU "RTMT" $StartMenuFolder<br />
      <br />
      Here, "RTMT" is the name of my application, and StartMenuFolder is an uninitialized variable. When I try to compile my script, I get the following error messages:<br />
      <br />
      !insertmacro: UMUI_PAGE_ALTERNATIVESTARTMENU<br />
      Usage: StrCpy $(user_var: output) str [maxlen] [startoffset]<br />
      Error in macro UMUI_FUNCTION_ALTERNATIVESTARTMENUPAGE on macroline 64<br />
      Error in macro UMUI_PAGE_ALTERNATIVESTARTMENU on macroline 80<br />
      Error in script "C:\Users\Steve\Documents\SimCity 4\RTMT\Install Main\RTMT_Installer.nsi" on line 91 -- aborting creation process<br />
      <br />
      Looking at the source, the line numbers all make sense, but I don't know what the underlying problem is. Then I read that the Registry defines need to be in place for this to work. OK, so I added them, and now my code looks like this:<br />
      <br />
      !define MUI_STARTMENUPAGE_REGISTRY_ROOT HKCU<br />
      !define MUI_STARTMENUPAGE_REGISTRY_KEY "Software\RTMT"<br />
      !define MUI_STARTMENUPAGE_REGISTRY_VALUENAME "Start Menu Name"<br />
      !define MUI_STARTMENUPAGE_DEFAULTFOLDER "RTMT"<br />
      !insertmacro UMUI_PAGE_ALTERNATIVESTARTMENU "RTMT" $StartMenuFolder<br />
      <br />
      And the error messages I get are identical, although line number 64 is now 29. So then I thought, Well, maybe I need to add the shortcut code. So down in my section, I put the following:<br />
      <br />
      !insertmacro MUI_STARTMENU_WRITE_BEGIN Application<br />
      <br />
      ;Create shortcuts<br />
      CreateDirectory "$SMPROGRAMS\$STARTMENU_FOLDER"<br />
      CreateShortCut "$SMPROGRAMS\$STARTMENU_FOLDER\Uninstall.lnk" "$INSTDIR\Uninstall.exe"<br />
      <br />
      !insertmacro MUI_STARTMENU_WRITE_END<br />
      <br />
      This has no effect at all, and it's obvious why when watching the compilation: The compilation aborts before it ever gets to that code.<br />
      <br />
      So what am I doing wrong? And what is "page_id" supposed to be? I've tried putting everything in there, from constants to variables. The documentation says, "The page ID should be the ID of the page on which the user has selected the folder for the shortcuts you want to write." But I don't know what the means, or how to get said ID. Any help would be greatly appreciated.</p>
    </div>
    <hr />

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]>
  </script>
</body>
</html>
