<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="Can I use NSIS for this?" />

  <title>Can I use NSIS for this? - NSIS Forums</title>
  <script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script>
  <!-- Bootstrap core CSS -->

  <link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css" />
  <link rel="stylesheet" href="../css/style.css" type="text/css" /><!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!--[if lt IE 9]>
                <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
                <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->
</head>

<body>
  <div class="container">
    <!-- Put navigation bar here -->

    <ol class="breadcrumb">
      <li><a href="../index.html" class="glyphicon glyphicon-home"></a></li>

      <li><a href="f-65.html">NSIS Discussion</a></li>

      <li class="active">Can I use NSIS for this?</li>
    </ol>

    <p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=203554">Can I use NSIS for this?</a></p><br />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">zhatka</span><br />
      <span class="post-time small text-muted">31st December 2004 17:18 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>Can I use NSIS for this?</strong><br />
      I currently have a .bat file I use for an unistaller that simply unregisters some dlls, deletes some files, removes directories, then calls to an external .reg file to remove registry keys. It works, but it's ugly.<br />
      <br />
      I was wandering around online last night and stumbled upon NSIS. After spending some time in the documentation, examples, and this forum I was beginning to wonder if I could make an executable with NSIS that would perform these 'uninstall' steps.<br />
      <br />
      So I guess my question is:<br />
      <br />
      Can NSIS be used to just perform 'batch' functions like this?<br />
      <br />
      I just want to make sure I am in the ballpark before I begin studying up and trying to drive a nail with a screwdriver.<br />
      <br />
      Thanks!<br />
      <br />
      Z</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Jnuw</span><br />
      <span class="post-time small text-muted">31st December 2004 19:24 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Yeah, you should be able to do everyting with NSIS, won't need that .reg file either.<br />
      <br />
      Right out of the Help file:<br />
      <br />
      4.9.3.14 UnRegDLL<br />
      dllfile<br />
      Loads the specified DLL and calls DllUnregisterServer. The error flag is set if an error occurs (i.e. it can't load the DLL, initialize OLE, find the entry point, or the function returned anything other than ERROR_SUCCESS (=0)).<br />
      <br />
      <br />
      4.9.1.1 Delete<br />
      [/REBOOTOK] file<br />
      Delete file (which can be a file or wildcard, but should be specified with a full path) from the target system. If /REBOOTOK is specified and the file cannot be deleted then the file is deleted when the system reboots -- if the file will be deleted on a reboot, the reboot flag will be set. The error flag is set if files are found and cannot be deleted. The error flag is not set from trying to delete a file that does not exist.<br />
      <br />
      Delete $INSTDIR\somefile.dat<br />
      <br />
      <br />
      <br />
      4.9.1.8 RMDir<br />
      [/r] [/REBOOTOK] directory_name<br />
      Remove the specified directory (which should be a full path). Without /r, the directory will only be removed if it is completely empty. If /r is specified, the directory will be removed recursively, so all directories and files in the specified directory will be removed. If /REBOOTOK is specified, any file or directory which could not have been removed during the process will be removed on reboot -- if any file or directory will be removed on a reboot, the reboot flag will be set. The error flag is set if any file or directory cannot be removed.<br />
      <br />
      RMDir $INSTDIR<br />
      RMDir $INSTDIR\data<br />
      RMDir /r /REBOOTOK $INSTIDR<br />
      RMDir /REBOOTOK $INSTDIR\DLLs<br />
      <br />
      <br />
      <br />
      4.9.2.3 DeleteRegKey<br />
      [/ifempty] root_key subkey<br />
      Deletes a registry key. If /ifempty is specified, the registry key will only be deleted if it has no subkeys (otherwise, the whole registry tree will be removed). Valid values for root_key are listed under WriteRegStr. The error flag is set if the key could not be removed from the registry (or if it didn't exist to begin with).<br />
      <br />
      DeleteRegKey HKLM "Software\My Company\My Software"<br />
      DeleteRegKey /ifempty HKLM "Software\A key that might have subkeys"</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">zhatka</span><br />
      <span class="post-time small text-muted">1st January 2005 01:36 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">I got all of the commands down. I think where I am having a hard time is with the actual uninstaller bit. From what I am reading, you have your installer, then the option to install an Uninstaller along with the install.<br />
      <br />
      Since I am simply executing an Uninstall routine, should I use the calls for the installer, but use all of the commands listed above to remove the components from the machine?<br />
      <br />
      I think what I am asking is:<br />
      <br />
      Should I just make a basic installer, but use commands that delete the necessary files, and then it finishes?<br />
      <br />
      thanks again....this NSIS is something else.<br />
      <br />
      (/me dives back into the books)</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">zhatka</span><br />
      <span class="post-time small text-muted">1st January 2005 02:09 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">After some thinking....<br />
      <br />
      Where would I be able to see the source (.nsi) for the uninstaller that is normally compiled with an installer?<br />
      <br />
      I am sure this would point me in the right direction. I am digging through the forums and manual now to see if I can find what I am looking for, but figured I would drop a hook here as well.<br />
      <br />
      Thanks</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
      <span class="post-time small text-muted">1st January 2005 13:49 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">The uninstall code would go in:<br />
      Section "Uninstall"<br />
      ...<br />
      SectionEnd<br />
      <br />
      Though like you said, you can just make an installer to do the 'uninstall' routine.<br />
      <br />
      -Stu</p>
    </div>
    <hr />

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]>
  </script>
</body>
</html>
