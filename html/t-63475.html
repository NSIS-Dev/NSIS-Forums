<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="Splash Behaviour?" />

  <title>Splash Behaviour? - NSIS Forums</title>
  <script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script>
  <!-- Bootstrap core CSS -->

  <link rel="stylesheet" type="text/css" href="//netdna.bootstrapcdn.com/bootswatch/3.0.1/readable/bootstrap.min.css" />
  <link rel="stylesheet" href="../css/style.css" type="text/css" /><!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!--[if lt IE 9]>
                <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
                <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->
</head>

<body>
  <div class="container">
    <!-- Put navigation bar here -->

    <ol class="breadcrumb">
      <li><a href="../index.html" class="glyphicon glyphicon-home"></a></li>

      <li><a href="f-65.html">NSIS Discussion</a></li>

      <li class="active">Splash Behaviour?</li>
    </ol>

    <p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=63475">Splash Behaviour?</a></p><br />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">petersa</span><br />
      <span class="post-time small text-muted">23rd October 2001 08:42 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>Splash Behaviour?</strong><br />
      Hi guys,<br />
      <br />
      Does anyone know how to close the splash screen from an NSIS script? A SendMessage command, perhaps? I've tried FindWindow and FindWindowByTitle but they can't find the thing.<br />
      <br />
      Better yet, does anyone know how to make the splash screen ignore a user's mouse clicks, so that it won't close unless NSIS tells it to?<br />
      <br />
      I've attached an example picture file that I'd like to use in one of my installations.<br />
      <br />
      Thanks,<br />
      Alex</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">prodangle</span><br />
      <span class="post-time small text-muted">23rd October 2001 22:27 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Eh, am I correct in saying that you want a "Creating icons" window in a colour other than the user's colour scheme to appear on the screen for a set amount of time, refusing to go away, with that said amount of time being far greater than the time taken to actually create the icons?<br />
      <br />
      Not very user friendly I wouldn't think...</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">justin</span><br />
      <span class="post-time small text-muted">24th October 2001 01:57 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>Re: Splash Behaviour?</strong><br /></p>

      <blockquote>
        <i>Originally posted by petersa</i><br />
        <b>Hi guys,<br />
        <br />
        Does anyone know how to close the splash screen from an NSIS script? A SendMessage command, perhaps? I've tried FindWindow and FindWindowByTitle but they can't find the thing.<br />
        <br />
        Better yet, does anyone know how to make the splash screen ignore a user's mouse clicks, so that it won't close unless NSIS tells it to?<br />
        <br />
        I've attached an example picture file that I'd like to use in one of my installations.<br />
        <br />
        Thanks,<br />
        Alex</b>
      </blockquote>I see you are going for traditional (bloated) installer behaviour. The thing is, NSIS creates icons so quickly, it should only be open for a fraction of a second (as opposed to the many seconds other installers can take, using DDE or whatever they do to make icons)...<br />
      <br />
      -Justin
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">petersa</span><br />
      <span class="post-time small text-muted">27th October 2001 12:23 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Sorry, prodangle, you're incorrect...and I'm not exactly looking for traditional installer behaviour either.<br />
      <br />
      Okay, creating icons = bad example...<br />
      <br />
      I have an installation for a program here that is made up of about 20 files. What I'm making NSIS do is extract these files to a temporary location, running the main setup program, and then killing this temporary folder.<br />
      <br />
      I'm hoping for a way to make a small window pop up while it's extracting these files and starting the installation. Have a look at the attachment.<br />
      <br />
      I'm trying to do something like PackageForTheWeb or WinZip SFX, but I'd rather use NSIS for its speed and size. Still, I'd like this small bitmap to pop up while it's doing something.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">petersa</span><br />
      <span class="post-time small text-muted">27th October 2001 12:27 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Being able to do this would be quite useful considering the installation is 20mb in size and will be run from a CD or Zip disk.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">justin</span><br />
      <span class="post-time small text-muted">27th October 2001 20:14 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Well if you really want to, modify splash.exe to not do anything on a WM_LBUTTONDOWN, then use this in your script:<br /></p>
      <pre>
<code><br />FindWindow $0 "_sp"<br />StrCmp $0 "" no<br />SendMessage $0 16 0 0<br />no:<br /></code>
</pre><br />
      <br />
      Or something.<br />
      <br />
      -Justin
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">petersa</span><br />
      <span class="post-time small text-muted">5th November 2001 04:34 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">The SendMessage line has no effect. The splash window just stays there.<br />
      <br />
      Does anyone know of a free compiler I could use to change the source and recompile the .EXE? I've got no idea how to do it but I'm sure I can work it out. I don't have Visual C++ or whatever it is NSIS is made in.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">prodangle</span><br />
      <span class="post-time small text-muted">5th November 2001 07:51 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Here's splash.exe changed the way Justing suggested. Hope that's a start :)</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">petersa</span><br />
      <span class="post-time small text-muted">7th November 2001 07:19 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Thanks, prodangle, but while I was offline I stumbled across some hidden genius and made my own version:<br />
      <br />
      Armed with the knowledge that WM_TIMER = 0x113 and WM_LBUTTONDOWN = 0x201, I went into a hex editor and searched for '01 13' and '02 01'.<br />
      <br />
      Failing that, I searched for '13 01' and '01 02'. I found those and changed them to WM_CUT, which is 0x300.<br />
      <br />
      Now it checks if it was sent <i>either</i> WM_CUT <i>or</i> WM_CUT, but hey, I'm not a programmer so that makes it okay. :D<br />
      <br />
      So here's a version of SPLASH.EXE that only quits when you tell it to 'Cut!'.<br />
      <br /></p>
      <pre>
<code>  Exec '$TEMP\SPLASH 1 $HWNDPARENT $TEMP\SPLASH'<br />; do the stuff that takes a long time<br />  FindWindow $0 _sp<br />  SendMessage $0 0x300 0 0</code>
</pre>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">pjw62</span><br />
      <span class="post-time small text-muted">7th November 2001 18:22 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"></p>

      <blockquote>
        <i>Originally posted by petersa</i><br />
        <b>The SendMessage line has no effect. The splash window just stays there.<br />
        <br />
        Does anyone know of a free compiler I could use to change the source and recompile the .EXE? I've got no idea how to do it but I'm sure I can work it out. I don't have Visual C++ or whatever it is NSIS is made in.</b>
      </blockquote>Borland have a free compiler which you can use to compile both makensis and the exe head (see other thread). The only problem is that the size optimisations aren't as good.
    </div>
    <hr />

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]>
  </script>
</body>
</html>
