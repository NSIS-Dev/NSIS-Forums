<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="problem with OpenMutexA (getting result)." />

  <title>problem with OpenMutexA (getting result). - NSIS Forums</title>
  <script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script>
  <!-- Bootstrap core CSS -->

  <link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css" />
  <link rel="stylesheet" href="../css/style.css" type="text/css" /><!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!--[if lt IE 9]>
                <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
                <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->
</head>

<body>
  <div class="container">
    <!-- Put navigation bar here -->

    <ol class="breadcrumb">
      <li><a href="../index.html" class="glyphicon glyphicon-home"></a></li>

      <li><a href="f-65.html">NSIS Discussion</a></li>

      <li class="active">problem with OpenMutexA (getting result).</li>
    </ol>

    <p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=268642">problem with OpenMutexA (getting result).</a></p><br />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">MVI</span><br />
      <span class="post-time small text-muted">30th March 2007 11:18 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>problem with OpenMutexA (getting result).</strong><br />
      Greetings...<br />
      <br />
      By the following code:<br /></p>
      <pre>
<code><br />        MessageBox MB_OK "TEST"<br /><br />        CheckApp:<br />                System::Call 'kernel32::OpenMutexA(i 0, i 0, t "{D50A79A4-CFD5-49a0-B94E-BBFA1D974616}") i .r1'<br />                IntCmp $R1 0 +3 <br />                        MessageBox MB_OK "App is running." <br />                        GoTo CheckApp<br /></code>
</pre><br />
      i'm trying to check if my app. is running.<br />
      But I can't see any "App is running." MessageBoxes...<br />
      (App is running and it has mutex with such name. I can see "TEST" MessageBox.)<br />
      <br />
      What I'm doing wrong?<br />
      <br />
      Best regards...
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Red Wine</span><br />
      <span class="post-time small text-muted">30th March 2007 13:02 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">If your app is the running installer, take a look here,<br />
      <br />
      <a href="http://nsis.sourceforge.net/Allow_only_one_installer_instance" target="_blank">http://nsis.sourceforge.net/Allow_on...aller_instance</a></p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">MVI</span><br />
      <span class="post-time small text-muted">30th March 2007 13:53 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">My app not an installer. And I've already saw that code. But my question not about it...</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Red Wine</span><br />
      <span class="post-time small text-muted">30th March 2007 14:04 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Then, perhaps you might want to take a look on this,<br />
      <br />
      <a href="http://nsis.sourceforge.net/FindProcDLL_plug-in" target="_blank">http://nsis.sourceforge.net/FindProcDLL_plug-in</a></p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">MVI</span><br />
      <span class="post-time small text-muted">30th March 2007 14:35 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Thats completely nothing of the kind I neded...<br />
      All that I need, is just point on my error (with correction).<br />
      For example this:<br /></p>
      <pre>
<code><br />        CheckForApp:<br />                System::Call "kernel32::CreateMutexA(i 0, i 0, t "{B1454C40-EAFE-4124-809F-90DEC53E06EC}") ?e"<br />                Pop $R0<br />                StrCmp $R0 0 +3 <br />                        MessageBox MB_OK "Please close App before continue." <br />                        GoTo CheckForApp<br /></code>
</pre><br />
      code (changed from <a href="http://nsis.sourceforge.net/Allow_only_one_installer_instance" target="_blank">http://nsis.sourceforge.net/Allow_on...aller_instance</a>)<br />
      Always shows "Please close App before continue." independently of test application presence...
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Anders</span><br />
      <span class="post-time small text-muted">30th March 2007 14:37 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Your quotes are messed up, escape " or use '<br />
      <br /></p>
      <pre>
<code>System</code><span style="color: #007700">::</span><span style="color: #0000BB">Call</span><span style="color: #DD0000">'kernel32::CreateMutexA(...t"foo")?e'
</span>
</pre>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">MVI</span><br />
      <span class="post-time small text-muted">30th March 2007 15:07 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">in second and third examles of <a href="http://nsis.sourceforge.net/Allow_only_one_installer_instance" target="_blank">http://nsis.sourceforge.net/Allow_on...aller_instance</a> used double-quotes...<br />
      also i've tried and nothing changed...</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Comm@nder21</span><br />
      <span class="post-time small text-muted">30th March 2007 19:10 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">1. you'll need to use the different quotes.<br />
      <br />
      2. you missed to specify an output argument:<br />
      <br />
      System::Call 'kernel32::CreateMutexA(i 0, i 0, t "{B1454C40-EAFE-4124-809F-90DEC53E06EC}") <b>i .n</b> ?e'</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">MVI</span><br />
      <span class="post-time small text-muted">2nd April 2007 09:02 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">I'm actually need help with my first "code"...<br />
      There are single quotes and there is output argument....</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
      <span class="post-time small text-muted">2nd April 2007 11:21 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">And what's the code you've used in your application?</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">MVI</span><br />
      <span class="post-time small text-muted">2nd April 2007 12:15 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">I've created two applications.<br />
      One, fore creating mutex:<br /></p>
      <pre>
<code>        HANDLE mutex = ::CreateMutex(NULL, TRUE, L"{B1454C40-EAFE-4124-809F-90DEC53E06EC}");<br />        while (1)<br />                Sleep(1000);<br /></code>
</pre><br />
      and one, for check this mutex:<br />
      <pre>
<code>        while (1)<br />        {<br />                HANDLE mutex = ::OpenMutex(READ_CONTROL, FALSE, L"{B1454C40-EAFE-4124-809F-90DEC53E06EC}");<br />                if (mutex != 0)<br />                {<br />                        CloseHandle(mutex);<br /><br />                        MessageBox(NULL, L"Please close App before continue.", NULL, MB_OK);<br />                }<br />                else<br />                        Sleep(1000);<br />        }<br /></code>
</pre>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Comm@nder21</span><br />
      <span class="post-time small text-muted">2nd April 2007 19:04 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">if you got problems with your first code, it's missing the error output:<br />
      <br /></p>

      <blockquote>
        System::Call 'kernel32::OpenMutexA(i 0, i 0, t "{D50A79A4-CFD5-49a0-B94E-BBFA1D974616}") i .r1'
      </blockquote>you need the ?e at the end, because r1 won't tell you anything about the mutex. only the call of GetErrorSomethingBla which is done by ?e will give you the info whether the mutex could have been created or not.<br />
      <br />
      <br />
      use the code i submitted previously and it will work (i'm using it all the time with my codes)
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">MVI</span><br />
      <span class="post-time small text-muted">3rd April 2007 08:44 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">I've changed my code:<br /></p>
      <pre>
<code>        CheckForApp:<br />                System::Call 'kernel32::OpenMutexA(i 0x00020000, i 0, t "{B1454C40-EAFE-4124-809F-90DEC53E06EC}") i .r1 ?e'<br />                StrCmp $R1 0 AppNotRunning<br />                        MessageBox MB_OK "Please close App before continue." <br />                        GoTo CheckForApp<br />        AppNotRunning:<br /></code>
</pre><br />
      but MessageBox appears independently of mutex presence...
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
      <span class="post-time small text-muted">3rd April 2007 09:14 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">The error value goes into $1 but you check $R1. Check $1 or change r1 to R1.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">MVI</span><br />
      <span class="post-time small text-muted">3rd April 2007 09:26 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">thanks. now it works.</p>
    </div>
    <hr />

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]>
  </script>
</body>
</html>
