<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="How to use Registry Entry?" />

  <title>How to use Registry Entry? - NSIS Forums</title><!-- Bootstrap core CSS -->
  <link rel="stylesheet" type="text/css" href="//netdna.bootstrapcdn.com/bootswatch/3.0.2/readable/bootstrap.min.css" /><!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!--[if lt IE 9]>
                <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
                <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->
</head>

<body>
  <div class="container">
    <!-- Put navigation bar here -->

    <ol class="breadcrumb">
      <li><a href="../index.html" class="glyphicon glyphicon-home"></a></li>

      <li><a href="f-65.html">NSIS Discussion</a></li>

      <li class="active">How to use Registry Entry?</li>
    </ol>

    <p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=126273">How to use Registry Entry?</a></p><br />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">OYAHHH</span><br />
      <span class="post-time small text-muted">24th February 2003 20:44 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>How to use Registry Entry?</strong><br />
      &nbsp; Hi,<br />
      <br />
      I'm fairly new to NSIS so my apologies if the answer to this question is entirely obvious.<br />
      <br />
      I've spent the last couple of hours reading this forum trying to ascertain an answer to my question to no avail.<br />
      <br />
      I need to read a registry entry containing the installation location of Java.<br />
      <br />
      Then I'd like to use this registry entry to create a shortcut entry that will enable my Java program to run.<br />
      <br />
      In the following code example I read the location and attempt to use it, but neither the FileOpen nor the FileWrite seem to properly use the $1 variable.<br />
      <br />
      Thus, how can I use the $1 variable to create a fully qualified path?<br />
      <br />
      Push $1<br />
      ReadRegStr $1 HKLM \<br />
      "SOFTWARE\JavaSoft\Java Runtime Environment\1.4\JavaHome" JavaHome<br />
      <br />
      FileOpen $2 "$1\testfile.txt" "w"<br />
      FileWrite $2 "HELLO $1"<br />
      FileClose $2<br />
      <br />
      BTW, I have successfully detected if Java is installed and the Java version using the IsNT function examples.<br />
      <br />
      Thus, I know I'm on the right track, i.e. I've correctly used the ReadRegStr function in other instances.<br />
      <br />
      I just need a little push to get me over the top.<br />
      <br />
      Thanks for any and all help.<br />
      <br />
      Regards,<br />
      <br />
      OYAHHH</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Joel</span><br />
      <span class="post-time small text-muted">24th February 2003 21:22 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">you can use this:<br />
      <br /></p>
      <pre>
<code><br />InstallDirRegKey HKLM SOFTWARE\APP TheAppDir<br />;Since The root exists :p<br /></code>
</pre>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">deguix</span><br />
      <span class="post-time small text-muted">25th February 2003 05:45 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"></p>

      <blockquote>
        Thus, how can I use the $1 variable to create a fully qualified path?
      </blockquote>If the variable $1 contain spaces (like c:\program files), should be put between the double quotes ["] (, single quotes ['] or backward single quotes [`]) :<br />
      <br />
      <pre>
<code>ReadRegStr "$1" 
<br />&gt;HKLM "SOFTWARE\\JavaSoft\\Java Runtime Environment\\1.4\\JavaHome" JavaHome 
<br />&gt;
</code>
</pre>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
      <span class="post-time small text-muted">26th February 2003 09:59 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">You don't need to quote the variable if you wish to read into it. You only need to quote variables if there is a path in it with spaces that you wish to execute or use somewhere Windows will use. For example:<br />
      <br /></p>
      <pre>
<code>
ReadEnvStr $1 COMSPEC
<br />Exec '"$1" /C dir &gt; output.txt' 
</code>
</pre>OYAHHH, you have an extra JavaHome in that command. You are trying to read the JavaHome string value from the "SOFTWARE\JavaSoft\Java Runtime Environment\1.4\JavaHome" key, but the JavaHome string value is inside the "SOFTWARE\JavaSoft\Java Runtime Environment\1.4" key.
    </div>
    <hr />

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]>
  </script>
</body>
</html>
