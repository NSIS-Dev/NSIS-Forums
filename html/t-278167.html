<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="How could I select which component to shown during installation" />

  <title>How could I select which component to shown during installation - NSIS Forums</title><!-- Bootstrap core CSS -->
  <link rel="stylesheet" type="text/css" href="//netdna.bootstrapcdn.com/bootswatch/3.0.1/readable/bootstrap.min.css" />
  <link rel="stylesheet" href="../css/style.css" type="text/css" /><!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!--[if lt IE 9]>
                <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
                <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->
</head>

<body>
  <div class="container">
    <!-- Put navigation bar here -->

    <ol class="breadcrumb">
      <li><a href="../index.html" class="glyphicon glyphicon-home"></a></li>

      <li><a href="f-65.html">NSIS Discussion</a></li>

      <li class="active">How could I select which component to shown during installation</li>
    </ol>

    <p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=278167">How could I select which component to shown during installation</a></p><br />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">beonhope</span><br />
      <span class="post-time small text-muted">1st October 2007 10:11 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>How could I select which component to shown during installation</strong><br />
      Hi,<br />
      I would like to select different component to be installed in different verison of Windows.<br />
      <br />
      I had a tried inserting marco inside a section, calling inserting section inside the function.onInit but I just couldn't figure out a way to customize a component page for each windows.<br />
      <br />
      Therefore how can I customize the component selection page according to the information I have? Like maybe control the amount of section?</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
      <span class="post-time small text-muted">1st October 2007 20:41 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">In .onInit, use the macros from Sections.nsh (SelectSection and UnselectSection) according to the detected version of Windows. Those will select and unselect the components according to your desire.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">vc6</span><br />
      <span class="post-time small text-muted">19th November 2007 16:34 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>How do I detect which version of Windows?</strong><br />
      I have a need for doing exactly the same thing as the original poster wrote. In my search for a solution, I found this thread. However, from kichik's answer, I couldn't understand how to detect the version of Windows?<br />
      <br />
      Could you please show me how (or point me to some documentation that shows how)?<br />
      <br />
      Thanks!</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">galevsky</span><br />
      <span class="post-time small text-muted">19th November 2007 16:49 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Read the manual: Appendic C - Useful Scripts, Get Windows version.<br />
      <br />
      Use that function to select/unselect your components. (you can also declare different types of install and let the user choose the good one with InstType, but cannot be used for silent sections)<br />
      <br />
      Gal'</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">vc6</span><br />
      <span class="post-time small text-muted">19th November 2007 18:45 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"></p>

      <blockquote>
        <i>Originally posted by galevsky</i><br />
        Read the manual: Appendic C - Useful Scripts, Get Windows version. Use that function to select/unselect your components. (you can also declare different types of install and let the user choose the good one with InstType, but cannot be used for silent sections)
      </blockquote>Thank you. I now see that in the HTML Help file. I thought that there would be a built-in function in NSIS that would eliminate the need to copy and past that code (makes my script longer and probably harder to read), but if that's the only way to go, I will take it. Thanks! :)
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
      <span class="post-time small text-muted">19th November 2007 18:52 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">You don't need to use that function.<br />
      <br />
      You can do this:<br />
      !include WinVer.nsh<br />
      ...<br />
      ${If} ${AtleastWinXP}<br />
      <br />
      See WinVer.nsh for full list. If you need more advanced information you can use the GetVersion plug-in which calls the GetVersion/GetVersionEx API's.<br />
      <br />
      Stu</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">vc6</span><br />
      <span class="post-time small text-muted">19th November 2007 19:46 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"></p>

      <blockquote>
        <i>Originally posted by Afrow UK</i><br />
        <b>You don't need to use that function.<br />
        <br />
        You can do this:<br />
        !include WinVer.nsh<br />
        ...<br />
        ${If} ${AtleastWinXP}<br />
        <br />
        See WinVer.nsh for full list. If you need more advanced information you can use the GetVersion plug-in which calls the GetVersion/GetVersionEx API's.</b>
      </blockquote>Stu, thank you so much!<br />
      <br />
      In my script just need to know whether a system is Vista and if not, then <b>not</b> install something.<br />
      <br />
      I see that WinVer.nsh has <b>${If} ${AtLeastWinVista}</b>, so that is perfect for me.<br />
      <br />
      Thank you!
    </div>
    <hr />

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]>
  </script>
</body>
</html>
