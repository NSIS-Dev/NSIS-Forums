<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="description" content="using BinFileRead (cls) with NSIS"><title>using BinFileRead (cls) with NSIS - NSIS Forums</title><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script><link rel="preload" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css" as="style" onload="this.rel='stylesheet'"><link rel="preload" href="../css/style.css" as="style" onload="this.rel='stylesheet'"><noscript><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css"><link rel="stylesheet" href="../css/style.css"></noscript><script>!function(a){"use strict";var b=function(b,c,d){function e(a){return h.body?a():void setTimeout(function(){e(a)})}function f(){i.addEventListener&&i.removeEventListener("load",f),i.media=d||"all"}var g,h=a.document,i=h.createElement("link");if(c)g=c;else{var j=(h.body||h.getElementsByTagName("head")[0]).childNodes;g=j[j.length-1]}var k=h.styleSheets;i.rel="stylesheet",i.href=b,i.media="only x",e(function(){g.parentNode.insertBefore(i,c?g:g.nextSibling)});var l=function(a){for(var b=i.href,c=k.length;c--;)if(k[c].href===b)return a();setTimeout(function(){l(a)})};return i.addEventListener&&i.addEventListener("load",f),i.onloadcssdefined=l,l(f),i};"undefined"!=typeof exports?exports.loadCSS=b:a.loadCSS=b}("undefined"!=typeof global?global:this);!function(a){if(a.loadCSS){var b=loadCSS.relpreload={};if(b.support=function(){try{return a.document.createElement("link").relList.supports("preload")}catch(b){return!1}},b.poly=function(){for(var b=a.document.getElementsByTagName("link"),c=0;c<b.length;c++){var d=b[c];"preload"===d.rel&&"style"===d.getAttribute("as")&&(a.loadCSS(d.href,d,d.getAttribute("media")),d.rel=null)}},!b.support()){b.poly();var c=a.setInterval(b.poly,300);a.addEventListener&&a.addEventListener("load",function(){b.poly(),a.clearInterval(c)}),a.attachEvent&&a.attachEvent("onload",function(){a.clearInterval(c)})}}}(this);</script></head><body><div class="container"><ol class="breadcrumb"><li><a href="../index.html" class="glyphicon glyphicon-home"></a></li><li><a href="f-65.html">NSIS Discussion</a></li><li class="active">using BinFileRead (cls) with NSIS</li></ol><p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=308916">using BinFileRead (cls) with NSIS</a></p><br><div class="post"><p class="post-meta"><span class="post-author text-primary">DaveClarke</span><br><span class="post-time small text-muted">26th July 2009 11:17 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>using BinFileRead (cls) with NSIS</strong><br>Hi all,<br><br>I need some advice for something who works good in EXE made with VB6 but doesn't work in EXE made with NSIS.<br><br>I've created an installer that gets external parameter and uses it in the installation<br><br>the download page (.../download.asp?customer_id=12345) is using <b>BinFileRead</b> class that gets the binary data and replaces the matching string.<br><br>However, as I mentioned this works in EXE made with VB6, which looks like this:<br>=========================<br>strURL = "77777"<br>wbBrowser.Navigate "http://.../index.asp?cust_id=" &amp; strURL<br>=========================<br>and when I run the 'download.asp' it uses BinFileRead to search and replace the "77777" with the querystring.<br><br>But, when I'm doing this with NSIS I created it doesn't work.<br>The NSIS looks like that:<br>=================<br>!define strURL "77777"<br>.<br>.<br>.<br>Section " -post"<br>ExecShell "open" '"http://.../index.asp?cust_id=${strURL}"'<br>Quit<br>SectionEnd<br>=================<br><br>Any clue what can I do in here?<br><br>When I'm printing the binary data in the browser, then in the VB exe I can see full URL and the code has been replaced, but in the NSIS I can't find any.<br><br>Thanks for your assistance!</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">DaveClarke</span><br><span class="post-time small text-muted">27th July 2009 13:50 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Ok... I'll try different thing :)<br><br>Which way is the best to open -&gt; replace string -&gt; save binary data inside EXE made with NSIS?<br><br>Means to replace a string on demand while a user downloads the setup.exe<br><br>Thanks...</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br><span class="post-time small text-muted">29th July 2009 02:12 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">You won't see the original string in an NSIS built executable. Even if you could, changing it would result in the self CRC hashing to fail. You need to append your URL on the end of the executable and then read it using:<br><a href="http://nsis.sourceforge.net/ReadCustomerData" target="_blank">http://nsis.sourceforge.net/ReadCustomerData</a><br><br>Stu</p></div><hr><div class="footer"><p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p></div></div><script src="../js/highlight.pack.js" type="text/javascript"></script><script type="text/javascript">//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]></script></body></html>