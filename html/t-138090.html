<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="Help with update program" />

  <title>Help with update program - NSIS Forums</title><!-- Bootstrap core CSS -->
  <link rel="stylesheet" type="text/css" href="//netdna.bootstrapcdn.com/bootswatch/3.0.1/readable/bootstrap.min.css" />
  <link rel="stylesheet" href="../css/style.css" type="text/css" /><!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!--[if lt IE 9]>
                <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
                <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->
</head>

<body>
  <div class="container">
    <!-- Put navigation bar here -->

    <ol class="breadcrumb">
      <li><a href="../index.html" class="glyphicon glyphicon-home"></a></li>

      <li><a href="f-65.html">NSIS Discussion</a></li>

      <li class="active">Help with update program</li>
    </ol>

    <p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=138090">Help with update program</a></p><br />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Merlin73</span><br />
      <span class="post-time small text-muted">6th June 2003 17:19 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>Help with update program</strong><br />
      Hi,<br />
      Could someone please help me write a script? I'm new to NSIS and I've created an install script successfully. But I want to use NSIS to write a program that not only downloads an updated version of my program off the internet, but checks to see if it's a newer version first. I've read the documentation and know how to use NSISdl::download, but don't know how to write the rest of the code. (If it was Delphi I could do it)<br />
      The idea I have is the updater will read the program's ini file to find the version and compare it with an ini file on the website, if the ini file on the web contains a higher version number it will download the program.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
      <span class="post-time small text-muted">6th June 2003 18:07 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">That can be done and I did it with my program - it did exactly what you want to do!<br />
      <br />
      You can either use GetFileTime to compare the program files like so:<br /></p>
      <pre>
<code><br />        GetFileTime "C:\olderfile.exe" $3 $4<br />        GetFileTime "C:\downloadedfile.exe" $5 $6<br /><br />        IntCmp $3 $5 0 skip +2<br />        IntCmp $4 $6 skip skip 0<br /><br />Delete "C:\olderfile.exe"<br />Rename "C:\downloadedfile.exe" "C:\olderfile.exe"<br />skip:<br /></code>
</pre><br />
      <br />
      Or, use:<br />
      <pre>
<code><br />NSISdl::download "http://myweb.server.com/downloadedfile.ini" "C:\downloadedfile.ini"<br /><br />ReadINIStr $0 "C:\olderfile.ini" "File Version" "Version"<br />ReadINIStr $1 "C:\downloadedfile.ini" "File Version" "Version"<br /> IntCmp $0 $1 skip 0 skip<br /><br />NSISdl::download "http://myweb.server.com/downloadedfile.exe" "C:\olderfile.exe"<br />MessageBox MB_OK|MB_ICONINFORMATION "Downloaded file update for olderfile.exe!"<br /><br />skip:<br /></code>
</pre><br />
      <br />
      Hope it helps!<br />
      <br />
      -Stu
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Joel</span><br />
      <span class="post-time small text-muted">6th June 2003 18:07 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">check this old thread:<br />
      <a href="http://forums.winamp.com/showthread.php?s=&amp;threadid=135626" target="_blank">http://forums.winamp.com/showthread....hreadid=135626</a></p>
    </div>
    <hr />

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]>
  </script>
</body>
</html>
