<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="Install Error" />

  <title>Install Error - NSIS Forums</title><!-- Bootstrap core CSS -->
  <link rel="stylesheet" type="text/css" href="//netdna.bootstrapcdn.com/bootswatch/3.0.1/readable/bootstrap.min.css" />
  <link rel="stylesheet" href="../css/style.css" type="text/css" /><!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!--[if lt IE 9]>
                <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
                <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->
</head>

<body>
  <div class="container">
    <!-- Put navigation bar here -->

    <ol class="breadcrumb">
      <li><a href="../index.html" class="glyphicon glyphicon-home"></a></li>

      <li><a href="f-65.html">NSIS Discussion</a></li>

      <li class="active">Install Error</li>
    </ol>

    <p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=211416">Install Error</a></p><br />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">JWood</span><br />
      <span class="post-time small text-muted">26th March 2005 05:57 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>Install Error</strong><br />
      I'm new to this but, with the help of the HM NIS Editor, I was quickly able to get an installation program that works great!<br />
      <br />
      Unfortunately, one tester I have gets an error code at the end of the installation. The program appears to have been fully installed, but the following error appears:<br />
      <br />
      &gt;&gt;&gt;&gt;&gt;<br />
      Microsoft Visual C++ Runtime Library<br />
      <br />
      Runtime Error!<br />
      <br />
      Program: &lt;my Exe&gt;<br />
      <br />
      This application has requested the Runtime to terminate it in an unusual way. Please contact the application's support team for more information.<br />
      <br />
      [OK]<br />
      &lt;&lt;&lt;&lt;&lt;<br />
      <br />
      I have no idea where to start to address this. Can anyone give me any pointers?<br />
      <br />
      Thanks.<br />
      <br />
      Jonathan</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
      <span class="post-time small text-muted">26th March 2005 10:39 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">NSIS itself doesn't use Microsoft Visual C++ Runtime Library, so it must be an error from a DLL you're trying to register. Make sure you're not distributing any DLLs that shouldn't be redistributed, like DLLs from the system directory.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">JWood</span><br />
      <span class="post-time small text-muted">27th March 2005 02:40 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>Installation Error</strong><br />
      Thanks. However, my application contains no DLLs that get registered. All included DLLs export standard C functions and are renamed to have a different extension than DLL. And I'm not distributing any files that I didn't create. My application uses Visual C++ but I do not use asserts to handle run-time errors.<br />
      <br />
      I created a standard script using the HM NIS Editor and really don't understand the script language. The only change I made was to comment out the following line:<br />
      <br />
      ;!insertmacro MUI_PAGE_LICENSE "..\..\..\..\path\to\licence\YourSoftwareLicence.txt"<br />
      <br />
      Because I have no license file. Everything else was created by the Wizards that come with the editor<br />
      <br />
      Everything is working beautifully except for this error on one tester's system. I'm still at a loss.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Anders</span><br />
      <span class="post-time small text-muted">27th March 2005 04:30 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">could the error be in one of the dll's used by windows (comctl32,advapi32 etc.)</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
      <span class="post-time small text-muted">27th March 2005 17:21 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">It's possible the user has some program which has hooked a DLL into the NSIS installer. Ask the user to provide a Dr. Watson log. It should contain a list of all loaded DLLs and some more information about the location of the crash.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">JWood</span><br />
      <span class="post-time small text-muted">29th March 2005 02:57 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">I've now received a report of what could be the same error from another tester (he wasn't able to be as specific as the first tester). Both users are using Windows 2000 SP4. My tester's comments include the following:<br />
      <br />
      "The error only happens when I choose to run setup from my<br />
      power user account, running setup as the administrator. If I run setup as my normal self, no error occurs. If I run set from the administrator account, no error occurs.<br />
      <br />
      When the error happens, the install does not complete successfully. What is missing is the desktop shortcut and Start menu additions."<br />
      <br />
      He says he doesn't have much in the way of debugging help. I'm not even sure what is needed for a Dr Watson log. Does anyone have any more ideas?<br />
      <br />
      Again, I'm not distributing any files I didn't create. The executables consist of one EXE and several DLLs renamed with CYX and CYT extensions. Nothing needs to be registered.<br />
      <br />
      Thanks!</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
      <span class="post-time small text-muted">29th March 2005 18:34 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">See the following MSDN article for information on setting up and working with Dr. Watson:<br />
      <br />
      <a href="http://www.microsoft.com/resources/documentation/windows/xp/all/proddocs/en-us/drwatson_overview.mspx" target="_blank">http://www.microsoft.com/resources/d..._overview.mspx</a></p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Serflaten</span><br />
      <span class="post-time small text-muted">29th March 2005 22:24 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">I am the tester seeing JWood's problem, and the MSDN articles appear to be the same information found in Windows Help. There it states:<br />
      <br />
      ------<br />
      When a program error occurs in Windows, the system searches for a program error handler. A program error handler deals with errors as they arise during the running of a program. If the system does not find a program error handler, the system verifies that the program is not currently being debugged and considers the error to be unhandled. The system then processes unhandled errors by looking in Registry Editor for a program error debugger<br />
      ------<br />
      <br />
      <br />
      Since I see no entry for this in the Dr. Watson log, I have to assume the error is handled, possibly throwing up the 'unusual' error message.<br />
      <br />
      <br />
      Dr. Watson is set up to be the debugger in the registry, that entry looks like:<br />
      <br />
      [HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows NT\CurrentVersion\AeDebug]<br />
      "Auto"="1"<br />
      "Debugger"="drwtsn32 -p %ld -e %ld -g"<br />
      "UserDebuggerHotKey"=dword:00000000<br />
      <br />
      I am thinking a couple big clues include:<br />
      <br />
      - The error only happens when setup is run as the Admin. from my Power User account. (Opposed to running from current account which runs OK)<br />
      - When the error occurs, all the shortcuts are not present. In a normal installation, the shortcuts appear on screen before the exe.<br />
      <br />
      I did not see this mentioned; the error occurs after pressing Finish on the final screen of Setup. The Task Manager shows setup has been removed and &lt;JWood's exe&gt; has been added to its list just prior to the error message. Other than missing shortcuts, all else seems to be in place, the program runs normally....<br />
      <br />
      One other bit o' information. The final screen has a check box asking to launch the program (checked by default). If I uncheck that box (when running as Admin from PwrUser account), I see no error message, nor do I see any shortcuts installed.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
      <span class="post-time small text-muted">29th March 2005 22:33 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Wait wait wait... Does &lt;my Exe&gt; refer to the program itself or the installer? If it's the program itself, JWood should know better than me how to debug his program. The fact the shortcuts are missing is probably a whole different problem.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Serflaten</span><br />
      <span class="post-time small text-muted">29th March 2005 22:40 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"></p>

      <blockquote>
        <i>Originally posted by Anders</i><br />
        <b>could the error be in one of the dll's used by windows (comctl32,advapi32 etc.)</b>
      </blockquote>What might I use to determine that? I have an MSDN Universal Subscription starting from 2004 and thought I might use WnDbg, (from Customer Support Tools) but it appears I'll have to do some major D/L to get that up and running. (I'm on a SLOW dial-up connection....) I ave the FEB Visual Studio 2005 CTP (which I think is going to give me things like SPY++) but have not installed it yet.<br />
      <br />
      Really, I just want to help JWood determine if he needs to address this, and maybe learn a bit about debugging in the process! ;-)<br />
      <br />
      LFS
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Serflaten</span><br />
      <span class="post-time small text-muted">29th March 2005 22:48 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"></p>

      <blockquote>
        <i>Originally posted by Serflaten</i><br />
        <b>... all else seems to be in place, the program runs normally....<br /></b>
      </blockquote>That should read more like; The error stops that process, but launching the program from Explorer seems to proceed normally...
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
      <span class="post-time small text-muted">31st March 2005 19:46 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Looking at the source code for CRT, it seems like the message is generated by <a href="http://msdn.microsoft.com/library/en-us/vclib/html/_crt_abort.asp" target="_blank">abort</a>. According to MSDN, when compiled in debug mode, abort will give an option to debug the application. Dr. Watson or any other debugger can then step in.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">JWood</span><br />
      <span class="post-time small text-muted">3rd April 2005 22:25 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"></p>

      <blockquote>
        <i>Originally posted by kichik</i><br />
        <b>Looking at the source code for CRT, it seems like the message is generated by <a href="http://msdn.microsoft.com/library/en-us/vclib/html/_crt_abort.asp" target="_blank">abort</a>. According to MSDN, when compiled in debug mode, abort will give an option to debug the application. Dr. Watson or any other debugger can then step in.</b>
      </blockquote>That may be. However, I have no idea what software is running when the error occurs. Therefore, I wouldn't begin to know how to compile it in debug mode. As far as I know, none of my software is running during the installation so I wouldn't have any compile options with regards to the error.<br />
      <br />
      My scripts is simple. I used the HM NIS Editor Wizards to generate the script. My EXE was writting in MFC and does not need to be registered (although it may be--but I do not use abort to handle program errors). I have half a dozen DLLs but they were renamed with different extensions and do not need to be registered.<br />
      <br />
      The installation works fine on my system but has failed on two of about 15 testers. Both testers were running similiar configurations.<br />
      <br />
      I like other aspects of the installer but this is extremely frustrating.
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
      <span class="post-time small text-muted">5th April 2005 18:13 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Serflaten said:</p>

      <blockquote>
        I did not see this mentioned; the error occurs after pressing Finish on the final screen of Setup. The Task Manager shows setup has been removed and &lt;JWood's exe&gt; has been added to its list just prior to the error message. Other than missing shortcuts, all else seems to be in place, the program runs normally....
      </blockquote>It's &lt;JWood's exe&gt; that crashes according to him, not the installer.
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">JWood</span><br />
      <span class="post-time small text-muted">5th April 2005 19:34 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"></p>

      <blockquote>
        <i>Originally posted by kichik</i><br />
        <b>It's &lt;JWood's exe&gt; that crashes according to him, not the installer.</b>
      </blockquote>I'm not 100% certain that is what is happening although the error message seems to suggest that.<br />
      <br />
      What I don't understand is why my application is running at that time. If the installer is trying to register it or something, is there a way to control that? My application doesn't need to be registered. Also, I don't use abort() to handle errors. Maybe it is some MS code from the libs causing an error but why is my app even running?
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
      <span class="post-time small text-muted">5th April 2005 20:49 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Your program runs because you've asked for it to run. In the script attached to the other thread, you have MUI_FINISHPAGE_RUN defined. Serflaten also said:</p>

      <blockquote>
        One other bit o' information. The final screen has a check box asking to launch the program (checked by default). If I uncheck that box (when running as Admin from PwrUser account), I see no error message, nor do I see any shortcuts installed.
      </blockquote>According to him, the crash doesn't happen if your application isn't ran.
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">JWood</span><br />
      <span class="post-time small text-muted">5th April 2005 20:57 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Ah... I'm sorry. I missed that.<br />
      <br />
      I'm not sure that clears things up, however. First off, the program runs normally after installation is complete. Why would it only fail when being run from the final Installation page?<br />
      <br />
      Also, doesn't the installer create the desktop shortcut prior to showing the final page? How would a crash then prevent the shortcut from being installed?<br />
      <br />
      Thanks.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
      <span class="post-time small text-muted">5th April 2005 21:10 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"></p>

      <blockquote>
        Why would it only fail when being run from the final Installation page?
      </blockquote>I have no idea. It's your program, you should know better. NSIS just calls CreateProcess.<br />
      <br />
      As I've said to Serflaten, the shortcuts are probably a whole different problem. According to the script attached to the other thread, they are created before the finish page is even created.
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Richard Tamir</span><br />
      <span class="post-time small text-muted">20th May 2007 09:39 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">THE PROBLEM:<br />
      Install Error<br />
      I'm new to this but, with the help of the HM NIS Editor, I was quickly able to get an installation program that works great!<br />
      <br />
      Unfortunately, one tester I have gets an error code at the end of the installation. The program appears to have been fully installed, but the following error appears:<br />
      <br />
      &gt;&gt;&gt;&gt;&gt;<br />
      Microsoft Visual C++ Runtime Library<br />
      <br />
      Runtime Error!<br />
      <br />
      Program: &lt;my Exe&gt;<br />
      <br />
      This application has requested the Runtime to terminate it in an unusual way. Please contact the application's support team for more information.<br />
      <br />
      [OK]<br />
      &lt;&lt;&lt;&lt;&lt;<br />
      <br />
      I have no idea where to start to address this. Can anyone give me any pointers?<br />
      <br />
      Thanks.<br />
      <br />
      Jonathan<br />
      <br />
      THE SOLUTION:<br />
      I spent quite some time on this, even finding that a system restore did not fix it. Here's the trick that works:<br />
      1. uninstall winamp<br />
      2. create a new directory that will receive your new winamp install files; perhaps call it "winampvideo".<br />
      3. since winamp does not delete all files, move anything left after the uninstall to the new directory.<br />
      4. install winamp to the new directory.<br />
      5. VOILA!! It shall work.<br />
      6. don't ask me why, I just fooled around enough to find a way to get it to function.<br />
      7. BTW: many other programs around the internet are getting the same message, and no one has found the cause of the fault, to my knowledge.<br />
      <br />
      RichardTamirATyahoo.com</p>
    </div>
    <hr />

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]>
  </script>
</body>
</html>
