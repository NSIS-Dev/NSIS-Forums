<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="description" content="Program files directory differs with the different windows languages."><title>Program files directory differs with the different windows languages. - NSIS Forums</title><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script><link rel="preload" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css" as="style" onload="this.rel='stylesheet'"><link rel="preload" href="../css/style.css" as="style" onload="this.rel='stylesheet'"><noscript><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css"><link rel="stylesheet" href="../css/style.css"></noscript><script>!function(a){"use strict";var b=function(b,c,d){function e(a){return h.body?a():void setTimeout(function(){e(a)})}function f(){i.addEventListener&&i.removeEventListener("load",f),i.media=d||"all"}var g,h=a.document,i=h.createElement("link");if(c)g=c;else{var j=(h.body||h.getElementsByTagName("head")[0]).childNodes;g=j[j.length-1]}var k=h.styleSheets;i.rel="stylesheet",i.href=b,i.media="only x",e(function(){g.parentNode.insertBefore(i,c?g:g.nextSibling)});var l=function(a){for(var b=i.href,c=k.length;c--;)if(k[c].href===b)return a();setTimeout(function(){l(a)})};return i.addEventListener&&i.addEventListener("load",f),i.onloadcssdefined=l,l(f),i};"undefined"!=typeof exports?exports.loadCSS=b:a.loadCSS=b}("undefined"!=typeof global?global:this);!function(a){if(a.loadCSS){var b=loadCSS.relpreload={};if(b.support=function(){try{return a.document.createElement("link").relList.supports("preload")}catch(b){return!1}},b.poly=function(){for(var b=a.document.getElementsByTagName("link"),c=0;c<b.length;c++){var d=b[c];"preload"===d.rel&&"style"===d.getAttribute("as")&&(a.loadCSS(d.href,d,d.getAttribute("media")),d.rel=null)}},!b.support()){b.poly();var c=a.setInterval(b.poly,300);a.addEventListener&&a.addEventListener("load",function(){b.poly(),a.clearInterval(c)}),a.attachEvent&&a.attachEvent("onload",function(){a.clearInterval(c)})}}}(this);</script></head><body><div class="container"><ol class="breadcrumb"><li><a href="../index.html" class="glyphicon glyphicon-home"></a></li><li><a href="f-65.html">NSIS Discussion</a></li><li class="active">Program files directory differs with the different windows languages.</li></ol><p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=143057">Program files directory differs with the different windows languages.</a></p><br><div class="post"><p class="post-meta"><span class="post-author text-primary">insolit</span><br><span class="post-time small text-muted">21st July 2003 20:17 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>Program files directory differs with the different windows languages.</strong><br>I'd like to know if i can make the installer to detect automatically the program files directory, depending on the operative system language.<br>For example for portuguese versions of windows the program files directory is "programas".<br>I have the installer set to have the default installation folder, into "program files", but i'd like that the installer could automatically detect the operative system and the correspondent program files folder.<br>Hope i've made myself clear.<br>Hope somebody can help me out.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Gunny2k2</span><br><span class="post-time small text-muted">21st July 2003 20:26 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">InstallDir "$PROGRAMFILES\${MUI_PRODUCT}"<br><br>$PROGRAMFILES = means it whould autodect windows program files<br>${MUI_PRODUCT} = means it would make a dir the name of the installer</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">insolit</span><br><span class="post-time small text-muted">21st July 2003 21:06 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">that's exactly what i have but there's having a problem with portuguese operative systems.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br><span class="post-time small text-muted">21st July 2003 21:26 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">If the directory paths have strange characters in them, then you will get problems straight off.<br>This is probably another issue which needs to be fixed.<br><br>Can you please tell us what the default Program Files path is for Portuguese systems?<br><br>-Stu</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">insolit</span><br><span class="post-time small text-muted">21st July 2003 22:15 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">I believe there are no strange caracters, anyway the default path is "programas".<br>By the way here is the installer code i'm using:<br><br><font size="1">[edited by kichik]attach large scripts. attached below :down:[/edit]</font><br><br>Could you tell me if you can notice any problems with these lines?<br>One of the problems that occurs is that the ac3filter is not correctly installed at the first time installation, i've to run the program twice to get ac3filter instalation program running.<br>Another problem is that when people run this installer with windows portuguese operative system, besides it is not correctly detecting the program files instalation folder default, if they don't change manually the name of the folder "program files" to "programas", the files won't even get to be registered or installed.<br>I could really use some help here.<br>Thanks in advance!</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Joel</span><br><span class="post-time small text-muted">21st July 2003 22:38 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Hi dude:<br>attach large scripts, please :) ...<br>$PROGRAMFILES is a runtime variable...<br>depending of the end-user OS language I'll be the<br>path for "Program files"<br>For example:<br>in spanish is :"C:\Archivos de programa\"<br>You can see it yours in this Registry root:<br></p><pre>
<code><br>HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion<br>[ProgramFilesDir]<br>[ProgramFilesPath]<br></code>
</pre>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br>
      <span class="post-time small text-muted">22nd July 2003 08:36 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Open regedit, go to the key Lobo Lunar posted, take a screen shot and attach it here. Also try the latest CVS version, it has an additional check for weird cases.</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">insolit</span><br>
      <span class="post-time small text-muted">22nd July 2003 13:17 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">First of all thanks to all by the great support.<br>
      Kichik i just installed the lateste CVS and nothing strange is detected in the script.<br>
      I have no problems in the installation of my installer, because i have windows english version, besides the fact the ac3filter is not installed in the first installation. In a first installation, the file ac3filter_0_69b.exe, is copied to the specified folder but not ran.<br>
      But I got a printscreen from someone who had problems, because he has portuguese windows version:</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br>
      <span class="post-time small text-muted">22nd July 2003 13:22 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">His registry seems OK, nothing funky. Are you sure what he sees is not an old value that NSIS got using InstallDirRegKey? Trying sending him an installer that just prints $PROGRAMFILES and doesn't use InstallDir or InstallDirRegKey. If that doesn't get the right value for him, I'd like to talk to him in person.<br>
      <br>
      BTW, I have removed the screen shot from your post because it contains the product id. I should have mentioned that there might be sensitive information in there, I'm sorry.</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">insolit</span><br>
      <span class="post-time small text-muted">22nd July 2003 13:51 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Ok, thnks a lot for removing it, i did not pay attention to that.<br>
      This problem occurred to everyone that have run my installer and have windows xp pro portuguese.<br>
      Here's a printscreen of what happens:<br>
      <br>
      <a href="http://pwp.netcabo.pt/matroska/problem2.jpg" target="_blank">http://pwp.netcabo.pt/matroska/problem2.jpg</a><br>
      <br>
      <a href="http://pwp.netcabo.pt/matroska/problem1.jpg" target="_blank">http://pwp.netcabo.pt/matroska/problem1.jpg</a></p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br>
      <span class="post-time small text-muted">22nd July 2003 14:20 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Does it work if you specify a full path for RegDLL ($INSTDIR\dllname.dll)? Does it work if you add "Sleep 1000" between File and RegDLL? Are the files even extracted to the right place? Does the installer using latet CVS version solve any of these for them?</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">insolit</span><br>
      <span class="post-time small text-muted">23rd July 2003 00:13 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Kichik thnks a lot.<br>
      Everything works just great now.<br>
      To complete the installer i'd like to add an uninstallation to the ac3filter.<br>
      But the problem is how can i put the uninstaller of my installer to find the directory where the ac3filter independent installer, installed the program.</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br>
      <span class="post-time small text-muted">23rd July 2003 00:25 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">You could use the Search for file function on the <a href="http://nsis.sourceforge.net/archive/nsisweb.php?page=211&amp;instances=0,11" target="_blank">NSIS Archive</a> to search for the specific ac3filter file?<br>
      <br>
      -Stu</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br>
      <span class="post-time small text-muted">23rd July 2003 13:03 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">insolit, which one solved it?</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">insolit</span><br>
      <span class="post-time small text-muted">23rd July 2003 22:21 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">All problems were solved.<br>
      I have got no further complaints in windows xp portuguese or english installations.<br>
      Now everything's just fine, thanks to you. :)<br>
      Now I'll try to use the search option Afrow UK mentioned, so that I can also uninstall ac3 filter. (Thanks Afrow UK)<br>
      By the way, is there a way to have an uninstall process, so that we could choose the components to uninstall, instead of uninstalling everything?</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br>
      <span class="post-time small text-muted">23rd July 2003 22:28 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">I want to know which solution of the three suggested solved it, not what it solved. I already understand it has solved everything, and am happy that it did, but I would still like to know what solved it.<br>
      <br>
      For now, to show a "components page" in the uninstaller, you can use InstallOptions. Hopefully, tomorrow or the day after you'll be able to show a real components page too.</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">insolit</span><br>
      <span class="post-time small text-muted">24th July 2003 07:59 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Sorry I misunderstood your questions.<br>
      Well both two first options, can individually put the installer doing things correctly.<br>
      About the third choice, as I previously mentioned had no effect.<br>
      And by the way, all files are installed to the correct directory.</p>
    </div>
    <hr>

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script type="text/javascript" src="../js/highlight.pack.js" async>
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]></script></body></html>