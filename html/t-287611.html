<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="description" content="[PLZ HELP] Vista Installer Problem"><title>[PLZ HELP] Vista Installer Problem - NSIS Forums</title><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script><link rel="preload" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css" as="style" onload="this.rel='stylesheet'"><link rel="preload" href="../css/style.css" as="style" onload="this.rel='stylesheet'"><noscript><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css"><link rel="stylesheet" href="../css/style.css"></noscript><script>!function(a){"use strict";var b=function(b,c,d){function e(a){return h.body?a():void setTimeout(function(){e(a)})}function f(){i.addEventListener&&i.removeEventListener("load",f),i.media=d||"all"}var g,h=a.document,i=h.createElement("link");if(c)g=c;else{var j=(h.body||h.getElementsByTagName("head")[0]).childNodes;g=j[j.length-1]}var k=h.styleSheets;i.rel="stylesheet",i.href=b,i.media="only x",e(function(){g.parentNode.insertBefore(i,c?g:g.nextSibling)});var l=function(a){for(var b=i.href,c=k.length;c--;)if(k[c].href===b)return a();setTimeout(function(){l(a)})};return i.addEventListener&&i.addEventListener("load",f),i.onloadcssdefined=l,l(f),i};"undefined"!=typeof exports?exports.loadCSS=b:a.loadCSS=b}("undefined"!=typeof global?global:this);!function(a){if(a.loadCSS){var b=loadCSS.relpreload={};if(b.support=function(){try{return a.document.createElement("link").relList.supports("preload")}catch(b){return!1}},b.poly=function(){for(var b=a.document.getElementsByTagName("link"),c=0;c<b.length;c++){var d=b[c];"preload"===d.rel&&"style"===d.getAttribute("as")&&(a.loadCSS(d.href,d,d.getAttribute("media")),d.rel=null)}},!b.support()){b.poly();var c=a.setInterval(b.poly,300);a.addEventListener&&a.addEventListener("load",function(){b.poly(),a.clearInterval(c)}),a.attachEvent&&a.attachEvent("onload",function(){a.clearInterval(c)})}}}(this);</script></head><body><div class="container"><ol class="breadcrumb"><li><a href="../index.html" class="glyphicon glyphicon-home"></a></li><li><a href="f-65.html">NSIS Discussion</a></li><li class="active">[PLZ HELP] Vista Installer Problem</li></ol><p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=287611">[PLZ HELP] Vista Installer Problem</a></p><br><div class="post"><p class="post-meta"><span class="post-author text-primary">Thalos</span><br><span class="post-time small text-muted">26th February 2008 10:37 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>[PLZ HELP] Vista Installer Problem</strong><br>Hey guys,<br><br>i really got a problem and not much time, so i would really appreciate it if we would find a solution for my problem which isnt as complicatet as other things i found in the forum, i think :)<br><br>The Problem is that our NSIS made Installer, wich is about 450Mb and contains many swf videos, need much time (about 2-4 minutes) till you see the first dialogbox of the installation.<br><br>After inserting the CD with the installer under Vista you first have to wait about 4 minutes. Then the liddle "Please wait while Setup is loading" -Window prompts up, BUT with directly 96% loaded, following from the first Install-dialog.<br><br>So dont misunderstand me, the installation routine works fine and our flash-application is installed correctly. But the initialisation of the installer really hangs up. Is there a way to show this "please wait while setup is loading" -window directly or what is the problem with the script. 'The RequestExecutionLevel admin' and 'SetShellVarContext all' i already inserted to my script.<br><br>I post the Script, perhaps it helps:<br><br>; Script generated by the HM NIS Edit Script Wizard.<br><br>; HM NIS Edit Wizard helper defines<br>!define PRODUCT_KEYNAME "Ratgeber compact"<br>!define PRODUCT_APPNAME "Computer Schritt fuer Schritt"<br>!define PRODUCT_NAME "Ratgeber compact Computer - Schritt fÃ¼r Schritt"<br>!define PRODUCT_PUBLISHER "TH"<br>!define PRODUCT_DIR_REGKEY "Software\Microsoft\Windows\CurrentVersion\App Paths\fspprojectorreglocation1234567890.exe"<br>!define PRODUCT_UNINST_KEY "Software\Microsoft\Windows\CurrentVersion\Uninstall\${PRODUCT_NAME}"<br>!define PRODUCT_UNINST_ROOT_KEY "HKLM"<br>;Bild im Start-Endsreen<br>!define MUI_WELCOMEFINISHPAGE_BITMAP "D:\Arbeit\QVC\Laptop Anwendung\Flash Anwendung\Installerbild\installerbild.bmp"<br>;Startseite Headertext und Leittext<br>!define MUI_WELCOMEPAGE_TITLE "Ratgeber compact Computer - Schritt fÃ¼r Schritt Installation"<br>!define MUI_WELCOMEPAGE_TITLE_3LINES<br>;Endseite Headertext und Leittext<br>!define MUI_FINISHPAGE_RUN_TEXT "Adobe Acrobat Reader installieren"<br>!define MUI_FINISHPAGE_RUN "$INSTDIR\acrobat reader\ar_setup.exe"<br>!define MUI_FINISHPAGE_TITLE "Installation abgeschlossen!"<br>!define MUI_FINISHPAGE_TEXT "Die Ratgeber compact Installation ist nun abgeschlossen. Um das beigefÃ¼gte Handbuch zu lesen, benÃ¶tigen Sie aber noch den Adobe Acrobat Reader (Version 7 oder hÃ¶her). Klicken Sie auf 'Fertigstellen', um die Installation fÃ¼r den Adobe Acrobat Reader zu starten."<br><br>!include "C:\Programme\NSIS\Examples\System\System.nsh"<br>!include "C:\Programme\NSIS\Include\MUI.nsh"<br><br><br><br>; Welcome page<br>!insertmacro MUI_PAGE_WELCOME<br>; Directory page<br>!insertmacro MUI_PAGE_DIRECTORY<br>; Instfiles page<br>!insertmacro MUI_PAGE_INSTFILES<br><br>!insertmacro MUI_PAGE_FINISH<br><br>; Uninstaller pages<br>!insertmacro MUI_UNPAGE_INSTFILES<br><br>; Language files<br>!insertmacro MUI_LANGUAGE "German"<br><br>; MUI end ------<br>Name "${PRODUCT_NAME}"<br>OutFile "ratgeber_setup.exe"<br><br>InstallDir "$PROGRAMFILES\${PRODUCT_KEYNAME}\${PRODUCT_APPNAME}"<br>InstallDirRegKey HKLM "${PRODUCT_DIR_REGKEY}" ""<br>ShowInstDetails show<br>ShowUnInstDetails show<br>RequestExecutionLevel admin<br><br>Section -SETTINGS<br>SetOutPath "$INSTDIR"<br>SetOverwrite ifnewer<br>SectionEnd<br><br>Section "Ratgeber compact Computer - Schritt fÃ¼r Schritt" SEC01<br>SetOutPath "$INSTDIR"<br>SetOverwrite ifnewer<br>SetShellVarContext all<br>File /r "D:\Arbeit\QVC\Laptop Anwendung\Flash Anwendung\Final\"<br>CreateDirectory "$SMPROGRAMS\${PRODUCT_KEYNAME}\${PRODUCT_APPNAME}"<br>CreateShortCut "$SMPROGRAMS\${PRODUCT_KEYNAME}\${PRODUCT_APPNAME}\Ratgeber compact Computer starten.lnk" "$INSTDIR\Ratgeber compact starten.exe"<br>CreateShortCut "$DESKTOP\Ratgeber compact Computer starten.lnk" "$INSTDIR\Ratgeber compact starten.exe"<br>SectionEnd<br><br>;Section "Adobe Acrobat Reader"<br>; SetOutPath "$PROGRAMFILES\Acrobat Reader\"<br>; File "acrobat reader\ar_setup.exe"<br>;ExecWait "acrobat reader\ar_setup.exe"<br>;SectionEnd<br><br>Section -AdditionalIcons<br>SetShellVarContext all<br>CreateShortCut "$SMPROGRAMS\${PRODUCT_KEYNAME}\${PRODUCT_APPNAME}\Ratgeber compact Computer deinstallieren.lnk" "$INSTDIR\Ratgeber compact deinstallieren.exe"<br>SectionEnd<br><br>Section -Post<br>WriteUninstaller "$INSTDIR\Ratgeber compact deinstallieren.exe"<br>WriteRegStr HKLM "${PRODUCT_DIR_REGKEY}" "" "$INSTDIR\Ratgeber compact starten.exe"<br>WriteRegStr ${PRODUCT_UNINST_ROOT_KEY} "${PRODUCT_UNINST_KEY}" "DisplayName" "$(^Name)"<br>WriteRegStr ${PRODUCT_UNINST_ROOT_KEY} "${PRODUCT_UNINST_KEY}" "UninstallString" "$INSTDIR\Ratgeber compact deinstallieren.exe"<br>WriteRegStr ${PRODUCT_UNINST_ROOT_KEY} "${PRODUCT_UNINST_KEY}" "DisplayIcon" "$INSTDIR\Ratgeber compact starten.exe"<br>WriteRegStr ${PRODUCT_UNINST_ROOT_KEY} "${PRODUCT_UNINST_KEY}" "Publisher" "${PRODUCT_PUBLISHER}"<br>SectionEnd<br><br><br>Function un.onUninstSuccess<br>HideWindow<br>MessageBox MB_ICONINFORMATION|MB_OK "$(^Name) wurde erfolgreich von Ihrem System entfernt."<br>FunctionEnd<br><br>Function un.onInit<br>MessageBox MB_ICONQUESTION|MB_YESNO|MB_DEFBUTTON2 "Sind Sie sicher, dass Sie $(^Name) deinstallieren mÃ¶chten?" IDYES +2<br>Abort<br>FunctionEnd<br><br>Section Uninstall<br>Delete "$INSTDIR\"<br>Delete "$INSTDIR\Ratgeber compact deinstallieren.exe"<br>Delete "$INSTDIR\Ratgeber compact starten.exe"<br>Delete "$INSTDIR\rc_laptops_v3.swf"<br>Delete "$INSTDIR\installer.nsi"<br><br><br>Delete "$SMPROGRAMS\${PRODUCT_KEYNAME}\${PRODUCT_APPNAME}\Ratgeber compact Computer deinstallieren.lnk"<br>Delete "$SMPROGRAMS\${PRODUCT_KEYNAME}\${PRODUCT_APPNAME}\Ratgeber compact Computer starten.lnk"<br>Delete "$DESKTOP\Ratgeber compact Computer starten.lnk"<br><br>RMDir "$SMPROGRAMS\${PRODUCT_KEYNAME}\${PRODUCT_APPNAME}"<br>RMDir "$INSTDIR\${PRODUCT_KEYNAME}\${PRODUCT_APPNAME}\pdf\"<br>RMDir "$INSTDIR\${PRODUCT_KEYNAME}\${PRODUCT_APPNAME}\acrobat reader\"<br>RMDir "$INSTDIR\${PRODUCT_KEYNAME}\${PRODUCT_APPNAME}\inhalt\"<br>RMDir /r "$INSTDIR"<br><br>DeleteRegKey ${PRODUCT_UNINST_ROOT_KEY} "${PRODUCT_UNINST_KEY}"<br>DeleteRegKey HKLM "${PRODUCT_DIR_REGKEY}"<br>SetAutoClose true<br>SectionEnd<br><br><br>Thanks to all those who try to help me. As said i really have not much time to get this problem solved, so im thankfull for every answer. :)<br><br>Greetings<br>Thalos</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Thalos</span><br><span class="post-time small text-muted">26th February 2008 12:02 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Hmm, after some testing i still got that kind of problem.<br>I searched the forums und modified my script with some extra commands like "CRCCheck off" and "SetCompress off" which speed up the initialisation of the installer under Windows XP massivly, but in Windows Vista it still hangs. When i insert the cd it needs 3-5 minutes until the autostart dialog prompts up. Is there a way to speed up this check up?<br><br>I tested variuos other application installtations in vista and the initialisation of the cd's is much faster as with my cd.<br><br>Thanks4Help</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Thalos</span><br><span class="post-time small text-muted">26th February 2008 12:37 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Here again my actual Script. Did some changes but the Initilization of the CD in Vista still is a problem.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br><span class="post-time small text-muted">26th February 2008 13:16 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Looks like you're not the first person with this problem:<br><a href="http://forums.winamp.com/showthread.php?threadid=269867&amp;highlight=vista+cd" target="_blank">http://forums.winamp.com/showthread....light=vista+cd</a><br><br>Basically I think your option is not to compress the files in your installer, but have them uncompressed on the CD. You can copy them off using CopyFiles.<br><br>Stu</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Thalos</span><br><span class="post-time small text-muted">26th February 2008 13:40 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Hey Afro UK,<br><br>first of all, thanks for ur answer! :)<br>I searched the forums and found this thread too, but im a beginner in NSIS scripting, so i would really appreciate it if u could help me to bring this CopyFiles command into my script :)<br><br>I modified my Script again and set the<br><br>CRCCheck off<br>SetCompress auto<br>RequestExecutionLevel Admin<br><br>at the beginning of my script.<br>So Data is now compressed but still in Windows Vista it takes a minute of two till the Autostart-Dialog prompts up where i decide to run the "ratgeber_setup.exe". After this everything works fine. But i dont want the user to wait 1-2 minutes...<br><br>If the CopyFiles command would help to solve this problem, you are my hero of the day :)<br><br>I searched the Scripting Reference DB for this command, but the information there doesnt give me information about where to put this in my actual script and what command type i should use.<br><br>So could you help me plz? Where should i put this peace of code in my script?<br><br>Thx4Help</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br><span class="post-time small text-muted">26th February 2008 14:01 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">In a Section; same place where you'd normally have your File instructions.<br><br>Stu</p></div><hr><div class="footer"><p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p></div></div><script src="../js/highlight.pack.js" type="text/javascript"></script><script type="text/javascript">//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]></script></body></html>