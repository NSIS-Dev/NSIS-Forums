<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="Problem with start menu shortcut" />

  <title>Problem with start menu shortcut - NSIS Forums</title>
  <script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script>
  <!-- Bootstrap core CSS -->

  <link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css" />
  <link rel="stylesheet" href="../css/style.css" type="text/css" /><!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!--[if lt IE 9]>
                <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
                <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->
</head>

<body>
  <div class="container">
    <!-- Put navigation bar here -->

    <ol class="breadcrumb">
      <li><a href="../index.html" class="glyphicon glyphicon-home"></a></li>

      <li><a href="f-65.html">NSIS Discussion</a></li>

      <li class="active">Problem with start menu shortcut</li>
    </ol>

    <p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=289493">Problem with start menu shortcut</a></p><br />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kook04</span><br />
      <span class="post-time small text-muted">2nd April 2008 14:44 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>Problem with start menu shortcut</strong><br />
      Please bear with me. I've looked through all existing threads and I've seen information regarding my problem, but so far nothing has helped me fix it.<br />
      <br />
      In my script I am creating a start menu items that points to a batch file. I want to set the "working directory" for the batch file to a directory other than $INSTDIR.<br />
      <br />
      From what I have read on these forums, you do that by calling SetOutPath (and specifying the directory you want to be the working directory) prior to calling CreateShortCut. I'm doing that, but it isn't working. Here is the relevant portion of my script:<br />
      <br />
      Section -StartMenuItems<br />
      <br />
      SetOutPath "$INSTDIR\scripts\"<br />
      CreateDirectory "$SMPROGRAMS\KAST"<br />
      <br />
      CreateShortCut "$SMPROGRAMS\KAST\${SERVER_NAME}.lnk" "$INSTDIR\scripts\StartWatchdogServer.bat" "$INSTDIR\icons\watchdog.ico" "0"<br />
      <br />
      SectionEnd<br />
      <br />
      This creates the start menu group correctly, and creates the menu item, but the "Start In" (i.e., working directory) for the bat file is still $INSDIR<br />
      <br />
      Does anyone have any ideas? This has been holding me up for a while.<br />
      <br />
      Thanks in advance for your help.<br />
      <br />
      -Kennedy</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">l0k1</span><br />
      <span class="post-time small text-muted">2nd April 2008 15:56 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">I think the problem comes from the batch file opening a console window.<br />
      <br />
      Have you try changing the directory from the batch file (CD command) ?</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Red Wine</span><br />
      <span class="post-time small text-muted">2nd April 2008 16:42 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">The working directory is set by SetOutPath instruction. In your case should be "$INSTDIR\scripts\". If you want to point to a different working directory then change the above SetOutPath.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kook04</span><br />
      <span class="post-time small text-muted">3rd April 2008 15:28 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Thank you for your replies. It turns out that the SetOutPath command does work for what I need. I just misunderstood the syntax and was trying to use it a little differently than I thought I was.<br />
      <br />
      Thanks again..<br />
      <br />
      -Kennedy</p>
    </div>
    <hr />

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]>
  </script>
</body>
</html>
