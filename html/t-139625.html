<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="description" content="How to map icons to shortcuts and tell shortcuts to start up minimized?"><title>How to map icons to shortcuts and tell shortcuts to start up minimized? - NSIS Forums</title><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script><link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css"><link rel="stylesheet" href="../css/style.css" type="text/css"><!--[if lt IE 9]><script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script><script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script><![endif]--></head><body><div class="container"><ol class="breadcrumb"><li><a href="../index.html" class="glyphicon glyphicon-home"></a></li><li><a href="f-65.html">NSIS Discussion</a></li><li class="active">How to map icons to shortcuts and tell shortcuts to start up minimized?</li></ol><p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=139625">How to map icons to shortcuts and tell shortcuts to start up minimized?</a></p><br><div class="post"><p class="post-meta"><span class="post-author text-primary">vbgunz</span><br><span class="post-time small text-muted">20th June 2003 14:46 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>How to map icons to shortcuts and tell shortcuts to start up minimized?</strong><br>I suare, from my previous actions on this forum I tried searching for the following. How to create a shortcut linked to a special icon and how to start up that shortcut in minimized mode.<br><br>Currently, I have a lot of batch file shortcuts in the start menu and their icon is the default batch file icon. I would like to replace the default icon with a special one. Is this currently possible? Can someone please point me in the right direction?<br><br>Also, what is the command to tell a shortcut to start up minimized? The batch file shortcuts I would like to start up minimized as their action does do something else on the screen.<br><br>Thank you for any information on this :)</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Joost Verburg</span><br><span class="post-time small text-muted">20th June 2003 15:40 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Please read the CreateShortcut documentation. All info is there.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">vbgunz</span><br><span class="post-time small text-muted">20th June 2003 16:28 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Thank you Joost,<br><br>Unfortunately, the information required could not be found at the link you provided. Thank you very much for the information.<br><br>I am simply trying to link an icon to a shortcut and tell the shortcut to start up minimized. I feel though maybe this information is not critical for a build, it is indeed nice to know.<br><br>I am certain this could all be done on one line such as<br><br>CreateShortCut "$SMPROGRAMS\start.lnk" "$INSTDIR\start.bat" "$ICON=$INSTDIR\icon.ico" /MIN<br><br>Would or could it look something like that?<br><br>Thank you for your time</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Joost Verburg</span><br><span class="post-time small text-muted">20th June 2003 16:46 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">So what kind you find here: <a href="http://nsis.sourceforge.net/Docs/Chapter4.html#4.9.3.4" target="_blank">http://nsis.sourceforge.net/Docs/Chapter4.html#4.9.3.4</a> ?<br><br>It explains everything (SW_SHOWMINIMIZED, icon.file etc.)</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">vbgunz</span><br><span class="post-time small text-muted">20th June 2003 16:55 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Thank you for that link. I just did a Ctrl+F on the page and got stuck here thinking this was it <a href="http://nsis.sourceforge.net/Docs/Chapter4.html#4.9.1.5." target="_blank">http://nsis.sourceforge.net/Docs/Chapter4.html#4.9.1.5.</a><br><br>I am sorry if I seem lame for all of this. Thank you Joost</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">vbgunz</span><br><span class="post-time small text-muted">20th June 2003 17:13 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">I cannot get the following to show up minimized.<br></p><pre>
<code>  CreateShortCut "$DESKTOP\start.lnk" "$INSTDIR\start.bat" [SW_SHOWMINIMIZED]</code>
</pre><br><br>It always starts up on screen... I believe I got the parameter right but something is no doubt wrong...<br><br>Please help</div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Joost Verburg</span><br><span class="post-time small text-muted">20th June 2003 18:12 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"></p><pre>
<code>CreateShortCut "$DESKTOP\start.lnk" "$INSTDIR\start.bat" "" "icon.ico" "" SW_SHOWMINIMIZED</code>
</pre></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">vbgunz</span><br><span class="post-time small text-muted">20th June 2003 19:46 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Boy was that sneaky... Thank you Joost,<br><br>So quotes instead of brackets and all parameters must be divided by two quotes "".<br><br>I would've missed that one for sure. Thank you Joost.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">vbgunz</span><br><span class="post-time small text-muted">20th June 2003 20:48 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">All shortcuts work and have been applied an icon. Excellent information Joost. How can I get the program which the user chooses at the end of installation to start up minimized?<br><br>Thank you</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Joost Verburg</span><br><span class="post-time small text-muted">20th June 2003 21:16 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">You don't have to divede parameters with two quotes. They are just empty parameters (you only have one icon, so you don't need an icon index).<br><br>To run the application that can be selected on the finish page minimized, use MUI_FINISHPAGE_RUN_FUNCTION (see the Modern UI Readme) and add the ExecShell command to the function.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">vbgunz</span><br><span class="post-time small text-muted">21st June 2003 05:29 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">I cannot explain how I tried so many different patterns but I cannot for the life of me get this to run right. Here is just a fraction of what I've tried.<br><br></p><pre>
<code>!define MUI_FINISHPAGE_RUN_FUNCTION "EndLaunch"<br>!define MUI_FINISHPAGE_RUN_FUNCTION 'EndLaunch'<br>!define MUI_FINISHPAGE_RUN_FUNCTION EndLaunch<br>!define MUI_FINISHPAGE_RUN_FUNCTION Function EndLaunch<br>!define MUI_FINISHPAGE_RUN_EndLaunch<br>!define MUI_FINISHPAGE_RUN_FUNCTION ForgetAboutIt</code>
</pre><br>
      <br>
      My function looks like this<br>
      <br>
      Function EndLaunch<br>
      ExecWait "$SMPROGRAMS\Project\Start.lnk"<br>
      FunctionEnd<br>
      <br>
      (I know its an ExecWait function but just for the moment).<br>
      <br>
      Here is the most famous of all the warnings...<br>
      <pre>
<code>1 warning:<br>  install function "EndLaunch" not referenced - zeroing code (304-305) out</code>
</pre><br>
      <br>
      Can someone please help me with this task.
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Joost Verburg</span><br>
      <span class="post-time small text-muted">22nd June 2003 22:13 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">1) Make sure you got the latest development snapshot of NSIS: <a href="http://nsis.sf.net" target="_blank">http://nsis.sf.net</a><br>
      <br>
      2) The syntax is:</p>
      <pre>
<code>!define MUI_FINISHPAGE_RUN ;Run option on Finish page<br>!define MUI_FINISHPAGE_RUN_FUNCTION EndLaunch ;Call a function<br><br>Function EndLaunch <br>  ExecWait "app.exe" <br>FunctionEnd</code>
</pre>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">vbgunz</span><br>
      <span class="post-time small text-muted">23rd June 2003 02:07 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Thank you Joost,<br>
      <br>
      I have NSIS version 2.0b3 and it seems your code does not work with it. I do then need the latest CVS version correct?<br>
      <br>
      Thank you Joost.</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Joost Verburg</span><br>
      <span class="post-time small text-muted">23rd June 2003 10:07 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">This feature has been added about a week ago, so you need the latest CVS version (note that you also have to use the new page macro's and no page defines anymore).</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">vbgunz</span><br>
      <span class="post-time small text-muted">23rd June 2003 20:29 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Thank you Joost,<br>
      <br>
      This thread will sort of point out why I wish to avoid upgrading to the latest development build. <a href="http://forums.winamp.com/showthread.php?s=&amp;threadid=139789" target="_blank">http://forums.winamp.com/showthread....hreadid=139789</a><br>
      <br>
      Is it possible to hack NSIS so to launch ".vbs" scripts instead of .exe or .bat files? I've got a really simple .vbs script which will launch what ever I tell it to completely hidden from screen but NSIS will not launch a .vbs script... Is this hackable?<br>
      <br>
      If I could launch a .vbs with nsExec or ExecWait this will completely take care of the minimize drama as then I could completely hide it from ever showing up upon launch.<br>
      <br>
      I am just trying to avoid upgrading to a development build and learning NSIS all over again while trying to launch files either minimized or hidden from screen.<br>
      <br>
      Thank you Joost</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Joost Verburg</span><br>
      <span class="post-time small text-muted">24th June 2003 00:05 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">What's wrong with nsExec?</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">vbgunz</span><br>
      <span class="post-time small text-muted">24th June 2003 00:36 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">nsExec works for me while in a section for 2.0b3 and only during an installation; before it completes. It is placed directly before "Function un.onUninstSuccess" and seems to be executed last during the installation.</p>
      <pre>
<code>Section "ExecuteBeforeInstallCompletes"<br>        nsExec::Exec "$INSTDIR\Core_Start.bat"<br>SectionEnd</code>
</pre>It is perfect but the Finish page check box will not launch a function or a section in the current build of 2.0b3.<br>
      <br>
      This is most likely the issue in regards to building the script as the latest build 2.0b4 just doesn't like the script which builds perfect in 2.0b3.<br>
      <br>
      The script which builds perfect in 2.0b3 gives me 7 warnings, 1 error and no executable in the latest build. This is why I asked if it was possible to execute a .vbs file the same way I am able to launch a .bat file on the finish page.<br>
      <br>
      I'd really like to somehow use nsExec as it seems like a magical solution but if it is not possible in the current build can I then hack NSIS to launch .vbs files on the finish page checkbox?<br>
      <br>
      I just want to execute a .bat file from the finish page and have it launch in minimize mode or hidden if possible.<br>
      <br>
      Thank you Joost
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">vbgunz</span><br>
      <span class="post-time small text-muted">24th June 2003 02:19 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">I have upgraded my script to work with 2.0b4 and I got it so far to compile with no errors or warnings. I tried the following suggestion...</p>
      <pre>
<code>!define MUI_FINISHPAGE_RUN ;Run option on Finish page<br>!define MUI_FINISHPAGE_RUN_FUNCTION EndLaunch ;Call a function<br><br>Function EndLaunch <br>  ExecWait "app.exe" <br>FunctionEnd</code>
</pre>Though it works and executes the batch file it sort of freezes on average 15 to 20 seconds on screen. The system doesn't go into a full freeze where it doesn't respond but the NSIS window blanks out and stays on screen for about 15 to 20 seconds. If I click on exit I do indeed get a program is not responding dialog box asking to kill it.<br>
      <br>
      Is there a way to tell NSIS to execute the batch file and immediately exit somehow OR show a status screen with a load bar like Windows XP? The kind of load bar I am referring to is the kind which shows a few blips from left to right to signify to the user something is happening and that a freeze did not take place.<br>
      <br>
      I am currently executing only 1 batch file. It has just two lines of instructions in it. 1 line starts a program and the other deletes a few files including itself.<br>
      <br>
      I thought at first maybe deleting itself was the problem so I totally killed the ERASE line but that didn't help at all. It seems it still goes into a 15 second freeze.<br>
      <br>
      Any workaround to this?<br>
      <br>
      Thank you very much :)
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Joost Verburg</span><br>
      <span class="post-time small text-muted">24th June 2003 13:47 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">If you want NSIS to exit, use Exec instead of ExecWait.</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">vbgunz</span><br>
      <span class="post-time small text-muted">24th June 2003 22:20 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">I am sorry Joost, I meant the NSIS screen freezes for about 15 to 20 seconds using the "nsExec" command. I like the nsExec command because it simply hides the dos box. But, it seems nsExec has a problem launching a batch file on the run page...</p>
      <pre>
<code>!define MUI_FINISHPAGE_RUN ;Run option on Finish page<br>!define MUI_FINISHPAGE_RUN_FUNCTION EndLaunch ;Call a function<br><br>Function EndLaunch<br>  nsExec::Exec "$INSTDIR\Core_Start.bat"<br>FunctionEnd</code>
</pre>Using the above piece of code freezes NSIS on screen for about 15 to 20 seconds. The following is the bat files contents
      <pre>
<code>START <a href="http://www.vbgunz.com" target="_blank">http://www.vbgunz.com</a><br>ERASE /Q "Core_Start.bat"</code>
</pre>It is a really simple bat file and I don't understand why NSIS chokes on it and freezes up on screen for 15 to 20 seconds over it.<br>
      <br>
      One solution I've come up with is a programming friend of my mine by the name of Onno Broekmans, created a tiny exe file which when renamed the exact name of a bat file located in the same directory it will execute the bat file and hide it from ever showing up. Currently I use the exe file to launch the bat file instead and NSIS exits immediately with no freeze.
      <pre>
<code>Function EndLaunch<br>  nsExec::Exec "$INSTDIR\Core_Start.exe"<br>FunctionEnd</code>
</pre>The size of the exe file is 40kb and adds only a 30KB overhead to the script. The coolest thing is you can add 40 more of the exe files and the overhead amazingly stays at just 30KB. NSIS is genious on that part. Anyway this small exe takes care of the 15 to 20 second NSIS freeze.<br>
      <br>
      I will upload the tiny application when the Author approves its release.<br>
      <br>
      Thank you Joost.
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Joost Verburg</span><br>
      <span class="post-time small text-muted">24th June 2003 22:55 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Why don't you handle the tasks of the batch file using NSIS code?</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">vbgunz</span><br>
      <span class="post-time small text-muted">24th June 2003 23:33 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Hello Joost,<br>
      <br>
      I only have two task at hand before I feel I complete this NSIS journey.<br>
      <br>
      1. Launch a batch file without showing its dos box on the NSIS run page.<br>
      2. Launch a batch file at uninstall without showing the dos box.<br>
      <br>
      1. Works with the following code but the NSIS run page freezes on screen for about 15 to 20 seconds when calling the bat file.<br></p>
      <pre>
<code>!define MUI_FINISHPAGE_RUN ;Run option on Finish page<br>!define MUI_FINISHPAGE_RUN_FUNCTION EndLaunch ;Call a function<br><br>Function EndLaunch <br> nsExec::Exec "$INSTDIR\Core_Start.bat" <br>FunctionEnd</code>
</pre><br>
      <br>
      It works but not as expected. It will run the bat file without showing the dos box but NSIS stays frozen on screen for 15 to 20 seconds. It is the freeze which presents the problem.<br>
      <br>
      As for my second task, I can only use the "ExecWait" in the uninstall section. It performs its duty and does it well but it is unable to hide the dos box. The work around is I've inserted another exe to hide the dos box and use ExecWait to call the exe.<br>
      <br>
      So without using the 3rd party application to complete the script I will be left with 2 problems.<br>
      <br>
      1. the run page function to nsExec freezes NSIS for 15 to 20 seconds.<br>
      2. I am so far unable to call nsExec from the uninstall section.<br>
      <br>
      Thank you Joost, If I get pass these two problems without involving 3rd party software I feel my installation task are complete using NSIS alone.<br>
      <br>
      Thank you again Joost
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Joost Verburg</span><br>
      <span class="post-time small text-muted">25th June 2003 12:41 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">1) Why not use NSIS code instead of the Core_Start.bat code?<br>
      <br>
      2) Attach the script (uninstaller nsExec)</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">vbgunz</span><br>
      <span class="post-time small text-muted">25th June 2003 17:27 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Hello Joost,<br>
      <br>
      I was unaware of being able to run batch code direct from within NSIS. I currently thought this was a job for nsExec and its counterparts. I would appreciate a link to more information. Thank you Joost.<br>
      <br>
      I will post my script for others to reference in the near future but at the moment here is a snippet of how I try to best apply "nsExec" to the uninstall section.</p>
      <pre>
<code>Function un.onInit<br>  MessageBox...<br>  Abort<br>  nsExec::Exec "$INSTDIR\Core_Shut_Down.bat"<br>FunctionEnd</code>
</pre>and/or
      <pre>
<code>Section Uninstall<br>  nsExec::Exec "$INSTDIR\Core_Shut_Down.bat"<br>  ...<br>  DeleteRegKey HKLM...<br>  SetAutoClose true<br>SectionEnd</code>
</pre>So far I am thinking I must turn the nsExec into a function and call the function from the uninstall but I do not know how to do that at the moment.<br>
      <br>
      Thank you Joost
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Joost Verburg</span><br>
      <span class="post-time small text-muted">25th June 2003 23:18 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">nsExec does work from the uninstaller. Are you sure you did not make another error?<br>
      <br>
      I mean: Use NSIS commands instead of batch file commands, i.e. put Delete in the function instead of the batch command DEL, etc.</p>
    </div>
    <hr>

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]></script></body></html>