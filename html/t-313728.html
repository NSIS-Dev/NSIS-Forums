<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="description" content="Mixing compile and runtime tests"><title>Mixing compile and runtime tests - NSIS Forums</title><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script><link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css"><link rel="stylesheet" href="../css/style.css" type="text/css"><!--[if lt IE 9]><script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script><script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script><![endif]--></head><body><div class="container"><ol class="breadcrumb"><li><a href="../index.html" class="glyphicon glyphicon-home"></a></li><li><a href="f-65.html">NSIS Discussion</a></li><li class="active">Mixing compile and runtime tests</li></ol><p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=313728">Mixing compile and runtime tests</a></p><br><div class="post"><p class="post-meta"><span class="post-author text-primary">abcdgoldfish</span><br><span class="post-time small text-muted">12th October 2009 19:53 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>Mixing compile and runtime tests</strong><br>I am writing an nsh file whose behavior I would like to control based on the presence or absence of an ENV. For example, if the ENV exists, don't display the license page.<br><br>I can detect the presence or absence of the ENV at runtime, say in .onInit. But I have been unable to figure how to use this to control the display of windows since they are compiled in before execution. I've tried using !ifdef based on .onInit code but !ifdef uses values based on compile time.<br><br>Is this even possible? I'm suspecting not but would like to hear from someone more knowledgeable.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">demiller9</span><br><span class="post-time small text-muted">12th October 2009 20:19 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Use the 'pre' function of the License page to check the env variable (or one you set during .onInit) and <a href="http://nsis.sourceforge.net/Docs/Chapter4.html#4.9.4.1" target="_blank">Abort</a> the page. This will go on to the following page and the user will never see the License page.<br></p><pre>
<code>MUI_PAGE_WELCOME<br>MUI_PAGE_CUSTOMFUNCTION_PRE License.Pre<br>MUI_PAGE_LICENSE textfile<br>MUI_PAGE_COMPONENTS<br>...<br>function License.Pre<br>${If} $myVar = 1<br>    Abort<br>${EndIf}<br>functionEnd</code>
</pre>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">MSG</span><br>
      <span class="post-time small text-muted">13th October 2009 08:22 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">abcdgoldfish, do you mean you want to check whether or not the variable has been declared? I don't think there's a command for this. You should probably add a !define VarIsDeclared to the code that declares the var, and then use !ifdef VarIsDeclared in your header file.<br>
      <br>
      Of course, this is only for controlling compile-time behaviour. If you want to change runtime behaviour, such as hiding the license page, then the solution above is what you should do.</p>
    </div>
    <hr>

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]></script></body></html>