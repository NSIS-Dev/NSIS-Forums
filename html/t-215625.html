<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="MUI Component Must be Check. How?" />

  <title>MUI Component Must be Check. How? - NSIS Forums</title>
  <script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script>
  <!-- Bootstrap core CSS -->

  <link rel="stylesheet" type="text/css" href="//netdna.bootstrapcdn.com/bootswatch/3.0.1/readable/bootstrap.min.css" />
  <link rel="stylesheet" href="../css/style.css" type="text/css" /><!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!--[if lt IE 9]>
                <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
                <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->
</head>

<body>
  <div class="container">
    <!-- Put navigation bar here -->

    <ol class="breadcrumb">
      <li><a href="../index.html" class="glyphicon glyphicon-home"></a></li>

      <li><a href="f-65.html">NSIS Discussion</a></li>

      <li class="active">MUI Component Must be Check. How?</li>
    </ol>

    <p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=215625">MUI Component Must be Check. How?</a></p><br />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">MichaelFlya</span><br />
      <span class="post-time small text-muted">10th May 2005 19:46 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>MUI Component Must be Check. How?</strong><br />
      What I want is To not let others Leave the Components Page<br />
      without Selecting atleast one.<br />
      <br />
      <br />
      My Problem Is I am using MUI and The Solutions I keep<br />
      Running accross is for Classic Installer or Non MUI.<br />
      <br />
      I have the Function ready and all the Function Code works.<br />
      I tested it in Different Parts like Putting it in a Section. It<br />
      Didn't Call it till it was Starting to install but it worked .....<br />
      but I Can't get the Components Page to Call it. So how<br />
      would I go about it?<br />
      <br />
      This Is What they Say to put it to Call the Function for<br />
      non MUI.<br />
      <br />
      (componentsLeave Is the Fuction Name)<br />
      <br /></p>
      <pre>
<code><br />Page components "" "" componentsLeave <br /></code>
</pre><br />
      <br />
      But MUI has it this way and Calling ComponentsLeave Isn't<br />
      working.<br />
      <br />
      <pre>
<code><br />  !insertmacro MUI_PAGE_COMPONENTS "" "" componentsLeave <br /></code>
</pre><br />
      <br />
      <br />
      I haven't Yet Found the Answer anywhere and I'm Sure it's<br />
      Simple to Figure out. Any help would be Great.<br />
      <br />
      -MichaelFlya-
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
      <span class="post-time small text-muted">10th May 2005 21:09 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Use MUI_PAGE_CUSTOMFUNCTION_LEAVE. See the MUI readme for more information.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">MichaelFlya</span><br />
      <span class="post-time small text-muted">10th May 2005 23:37 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">I read it for the last few weeks and nothing came about.<br />
      Would you be Willing to Verify what is what?<br />
      <br />
      <br /></p>
      <pre>
<code><br />  !insertmacro MUI_PAGE_CUSTOMFUNCTION_LEAVE function<br />  !insertmacro MUI_PAGE_COMPONENTS "" "" componentsLeave<br /></code>
</pre><br />
      <br />
      or<br />
      <br />
      <pre>
<code><br />  !insertmacro MUI_PAGE_CUSTOMFUNCTION_LEAVE function<br />  !insertmacro MUI_PAGE_COMPONENTS componentsLeave<br /></code>
</pre><br />
      <br />
      or<br />
      <br />
      <pre>
<code><br />  !insertmacro MUI_PAGE_CUSTOMFUNCTION_LEAVE componentsLeave<br />  !insertmacro MUI_PAGE_COMPONENTS "" "" componentsLeave<br /></code>
</pre><br />
      <br />
      or<br />
      <br />
      <pre>
<code><br />  !insertmacro MUI_PAGE_CUSTOMFUNCTION_LEAVE componentsLeave<br />  !insertmacro MUI_PAGE_COMPONENTS componentsLeave<br /></code>
</pre><br />
      <br />
      or Even<br />
      <br />
      <pre>
<code><br />  !insertmacro MUI_PAGE_COMPONENTS<br />  !insertmacro MUI_PAGE_CUSTOMFUNCTION_LEAVE componentsLeave<br /></code>
</pre><br />
      <br />
      or Where does what Go?<br />
      <br />
      <br />
      <br />
      Wait ...<br />
      Actually I now See that.<br />
      <br />
      <pre>
<code><br />!insertmacro MUI_PAGE_CUSTOMFUNCTION_LEAVE componentsLeave<br /></code>
</pre><br />
      <br />
      Should be<br />
      <pre>
<code><br />!define MUI_PAGE_CUSTOMFUNCTION_LEAVE componentsLeave<br /></code>
</pre><br />
      <br />
      But I still Get nowhere.<br />
      <br />
      -MichaelFlya-
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">MichaelFlya</span><br />
      <span class="post-time small text-muted">11th May 2005 00:00 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Great Actually I Have now got it to work Using this. ;)<br />
      <br /></p>
      <pre>
<code><br /><br />  !define MUI_CUSTOMFUNCTION_GUIINIT componentsLeave<br />  !define MUI_PAGE_CUSTOMFUNCTION_LEAVE componentsLeave<br />  !insertmacro MUI_PAGE_COMPONENTS<br /><br /></code>
</pre><br />
      <br />
      <br />
      <br />
      So Thanks Alot kichik !!!!!<br />
      :up: :up: :up: :up: :up: :up: :up: :up: :up: :up:<br />
      <br />
      -MichaelFlya-
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">MichaelFlya</span><br />
      <span class="post-time small text-muted">11th May 2005 00:57 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">One more thing. Hopefully the Last for a bit...<br />
      <br />
      I got it to work with my Uninstaller with this Code:<br />
      <br /></p>
      <pre>
<code><br />  !define MUI_CUSTOMFUNCTION_UNGUIINIT Un.componentsLeave<br />  !define MUI_PAGE_CUSTOMFUNCTION_LEAVE Un.componentsLeave<br />  !insertmacro MUI_UNPAGE_COMPONENTS<br /></code>
</pre><br />
      <br />
      <br />
      If I install all Three It works well if all three<br />
      Components are unchecked However...<br />
      <br />
      I Have a IfFileExists Function Happening that makes the<br />
      Component only show up to Uninstall if one of the files<br />
      are there that would Have been installed. So if SECTION1<br />
      Doesn't Get Installed only SECTION4 and SECTION5 Show up to<br />
      Uninstall. So the Person only sees what they Installed.<br />
      <br />
      The Problem is,<br />
      <br />
      If You only installed two Components and run the Uninstaller,<br />
      it lets You Uncheck the two that Shows up and For some<br />
      Reason you can Run the Uninstaller and get by with not<br />
      Choosing one...<br />
      <br />
      <br />
      This is the Code I use to Keep Someone from Leaving the<br />
      Uninstaller Components page without Choosing one.<br />
      <br />
      <br />
      <pre>
<code><br />Function Un.componentsLeave<br /><br />    SectionGetFlags "${SECTION4}" $0<br />    IntOp $1 $0 &amp; ${SF_SELECTED}<br />    <br />    SectionGetFlags "${SECTION5}" $0<br />    IntOp $0 $0 &amp; ${SF_SELECTED}<br />    IntOp $1 $1 + $0<br />    <br />    SectionGetFlags "${SECTION6}" $0<br />    IntOp $0 $0 &amp; ${SF_SELECTED}<br />    IntOp $1 $1 + $0<br />    StrCmp $1 "0" 0 +3<br />    <br />        MessageBox MB_OK|MB_ICONSTOP "You must select at least one Section."<br />        Abort<br />FunctionEnd<br /><br /></code>
</pre><br />
      <br />
      The Installer Section uses the Same Code... Just I use<br />
      SECTION1, SECTION2, and SECTION3 for the Installer Section<br />
      Names and it all works Perfect...<br />
      <br />
      Here is the Sections so You can Better Understand me.<br />
      <br />
      SECTION1&lt;---Install File1<br />
      SECTION2&lt;---Install File2<br />
      SECTION3&lt;---Install File3<br />
      <br />
      SECTION4&lt;---UnInstall File1<br />
      SECTION5&lt;---UnInstall File2<br />
      SECTION6&lt;---UnInstall File3<br />
      <br />
      <br />
      Can you be of help one more time on the Uninstaller?<br />
      <br />
      -MichaelFlya-
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
      <span class="post-time small text-muted">11th May 2005 16:02 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Seems fine... Attach the complete script.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">MichaelFlya</span><br />
      <span class="post-time small text-muted">11th May 2005 20:12 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">kichik How do you Manage to Say one Sentence and still<br />
      Help me Figure this out ??????? :) Thanks !!!! :D<br />
      <br />
      <br />
      The Problem Was ....<br />
      <br />
      Well I suppose it was the Order of the Functions, Because<br />
      after Rewriting it with the Same Code it has now Worked.<br />
      <br />
      Plus Originally I was using Includes for most of the Script.<br />
      So I would have Default Settings for the Next thing I do.<br />
      <br />
      <br />
      I made this Script real neat and everything. If you like<br />
      it Can you please Have it Included in the Documentation of<br />
      the NSIS Installer in the Example Section. I have no idea<br />
      who Could Get it in there but if it had of been there I<br />
      wouldn't have been here... :)<br />
      <br />
      The Script is Good for Teaching how to Use Components for<br />
      Installer and Uninstaller. Plus it Gives a good Start off for a<br />
      Quick Script Setup.<br />
      <br />
      Thanks kichik And I'll be Back I'm Sure... I have Internet<br />
      Updater for an Installer to Research Next...<br />
      <br />
      Thanks !!!<br />
      <br />
      -MichaelFlya-<br />
      <br />
      PS. Let me know if you or any others could have this Attached<br />
      Script Included in the Example Section of the NSIS for Everyone.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">MichaelFlya</span><br />
      <span class="post-time small text-muted">11th May 2005 22:58 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">I Now See The Problem That Had been Causing all of this.<br />
      <br />
      I use a Catagory Drop Down Bar.. Using this.<br />
      <br /></p>
      <pre>
<code><br />!ifndef NOINSTTYPES<br />  InstType "Install All"<br />  InstType "Un.UnInstall All"<br />!endif<br /></code>
</pre><br />
      And In Place Under Every Installer Section and Uninstaller<br />
      Section I Place this Code.<br />
      <pre>
<code><br />Sectionin 1<br /></code>
</pre><br />
      <br />
      Which If all Three Components are Selected It<br />
      Gives a Message Install All or Uninstall All.<br />
      <br />
      Other Wise Custom.<br />
      <br />
      I didn't Use it for that Example Script I gave Above.<br />
      <br />
      Place that in the Script and You will See. It lets you<br />
      For some reason do what I said It was doing. you can<br />
      Have two Components in the Uninstaller and uncheck<br />
      the two and it will allow you to Uninstall Nothing.<br />
      <br />
      Or Even if one Component is Left it Still Will let you<br />
      Uninstall Nothing.<br />
      <br />
      If you can Clear it up Thanks.. For now I will just not<br />
      Include That Part of the Script for the Uninstaller like<br />
      this.<br />
      <br />
      <pre>
<code><br />!ifndef NOINSTTYPES<br />  InstType "Install All"<br />!endif<br /></code>
</pre><br />
      <br />
      <br />
      -MichaelFlya-
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
      <span class="post-time small text-muted">12th May 2005 10:42 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">You can post the example on the <a href="http://nsis.sf.net/wiki" target="_blank">Wiki</a>.<br />
      <br />
      Adding InstType and SectionIn causes all of the sections to be in the same installation type. Since the user only sees the visible sections, those are the only sections that affect the installation type in the components page. However, the installation type also affects the invisible sections. That means, once the first and only installation type is selected, all of the sections with SectionIn 1 will also be selected, invisible or not. Since your componentsLeave function checks both visible and invisible sections, it allows the user to move on, if one invisible section is selected.<br />
      <br />
      BTW, defining MUI_CUSTOMFUNCTION_GUIINIT is not needed for defining a leave function for the components page. It's a completely different callback function.</p>
    </div>
    <hr />

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]>
  </script>
</body>
</html>
