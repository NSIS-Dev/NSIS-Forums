<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="description" content="How to ask for a second install directory, in MUI"><title>How to ask for a second install directory, in MUI - NSIS Forums</title><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script><link rel="preload" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css" as="style" onload="this.rel='stylesheet'"><link rel="preload" href="../css/style.css" as="style" onload="this.rel='stylesheet'"><noscript><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css"><link rel="stylesheet" href="../css/style.css"></noscript><script>!function(a){"use strict";var b=function(b,c,d){function e(a){return h.body?a():void setTimeout(function(){e(a)})}function f(){i.addEventListener&&i.removeEventListener("load",f),i.media=d||"all"}var g,h=a.document,i=h.createElement("link");if(c)g=c;else{var j=(h.body||h.getElementsByTagName("head")[0]).childNodes;g=j[j.length-1]}var k=h.styleSheets;i.rel="stylesheet",i.href=b,i.media="only x",e(function(){g.parentNode.insertBefore(i,c?g:g.nextSibling)});var l=function(a){for(var b=i.href,c=k.length;c--;)if(k[c].href===b)return a();setTimeout(function(){l(a)})};return i.addEventListener&&i.addEventListener("load",f),i.onloadcssdefined=l,l(f),i};"undefined"!=typeof exports?exports.loadCSS=b:a.loadCSS=b}("undefined"!=typeof global?global:this);!function(a){if(a.loadCSS){var b=loadCSS.relpreload={};if(b.support=function(){try{return a.document.createElement("link").relList.supports("preload")}catch(b){return!1}},b.poly=function(){for(var b=a.document.getElementsByTagName("link"),c=0;c<b.length;c++){var d=b[c];"preload"===d.rel&&"style"===d.getAttribute("as")&&(a.loadCSS(d.href,d,d.getAttribute("media")),d.rel=null)}},!b.support()){b.poly();var c=a.setInterval(b.poly,300);a.addEventListener&&a.addEventListener("load",function(){b.poly(),a.clearInterval(c)}),a.attachEvent&&a.attachEvent("onload",function(){a.clearInterval(c)})}}}(this);</script></head><body><div class="container"><ol class="breadcrumb"><li><a href="../index.html" class="glyphicon glyphicon-home"></a></li><li><a href="f-65.html">NSIS Discussion</a></li><li class="active">How to ask for a second install directory, in MUI</li></ol><p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=264159">How to ask for a second install directory, in MUI</a></p><br><div class="post"><p class="post-meta"><span class="post-author text-primary">Kjh</span><br><span class="post-time small text-muted">22nd January 2007 12:11 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>How to ask for a second install directory, in MUI</strong><br>Hi,<br>my application consists of a few standalone exe as well as a couple of plugin dlls for another application.<br><br>The user should be able to choose the combination of which things they want, either the standalone bits, the plugins for another app, or in the normal case both.<br><br>The MUI_PAGE_DIRECTORY macro is used to ask the user for the main program directory, which is where all the standalone stuff is found.<br><br>For the plugins for the 3rd party app, it checks the registry to find out where the 3pa is installed.<br><br>However in some special cases the 3pa might be installed twice, say 2 different versions, and I would like a second MUI_PAGE_DIRECTORY type window to pop up and let the user either confirm the directory discovered in the registry or supply another one, ideally only if the user chooses the plugins section.<br><br>I am not sure how to do that, and havent found anything in the docs or examples that seems to do that.<br><br>After that I would like to be able to supress the standard MUI_PAGE_DIRECTORY in case the user only selects the plugins and not the standalone exes.<br><br>Basically I am looking for some per-section MUI_PAGE_DIRECTORY rather than a MUI_PAGE_DIRECTORY thats global to all sections.<br><br>Any hints? Thanks.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br><span class="post-time small text-muted">22nd January 2007 13:14 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"></p><pre>
<code>Var INSTDIR2<br><br>!define MUI_PAGE_CUSTOMFUNCTION_PRE Directory2Pre<br>!define MUI_DIRECTORYPAGE_VARIABLE $INSTDIR2<br>!insertmacro MUI_PAGE_DIRECTORY<br><br>Function Directory2Pre<br> ReadRegStr $INSTDIR2 ...<br> StrCmp $INSTDIR2 "" ShowPage<br> IfFileExists $INSTDIR2\*.* 0 ShowPage<br>  Abort<br> ShowPage:<br>FunctionEnd</code>
</pre><br>
      <br>
      Abort when called in a page's PRE function will skip that page.<br>
      <br>
      -Stu
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Kjh</span><br>
      <span class="post-time small text-muted">22nd January 2007 14:05 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Ahh thanks a lot, it looks a lot like the Add-on Custom Install example I was looking at. I have pretty much got what I wanted now, except for 1 small thing, both directory pages appear, even if I have don't select any sections that need INSTDIR2. Is there anyway to suppress a page being shown unless a section actually needs its var?<br>
      <br>
      Thanks a lot you saved me a heap of time.</p>
    </div>
    <hr>

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]></script></body></html>