<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="Big Problem - installer runs only correct if i run it TWICE !!!" />

  <title>Big Problem - installer runs only correct if i run it TWICE !!! - NSIS Forums</title><!-- Bootstrap core CSS -->
  <link rel="stylesheet" type="text/css" href="//netdna.bootstrapcdn.com/bootswatch/3.0.1/readable/bootstrap.min.css" />
  <link rel="stylesheet" href="../css/style.css" type="text/css" /><!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!--[if lt IE 9]>
                <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
                <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->
</head>

<body>
  <div class="container">
    <!-- Put navigation bar here -->

    <ol class="breadcrumb">
      <li><a href="../index.html" class="glyphicon glyphicon-home"></a></li>

      <li><a href="f-65.html">NSIS Discussion</a></li>

      <li class="active">Big Problem - installer runs only correct if i run it TWICE !!!</li>
    </ol>

    <p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=304907">Big Problem - installer runs only correct if i run it TWICE !!!</a></p><br />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">congahonga</span><br />
      <span class="post-time small text-muted">2nd April 2009 12:25 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>Big Problem - installer runs only correct if i run it TWICE !!!</strong><br />
      Hello all,<br />
      <br />
      I got a big problem with an Installer for a special software.<br />
      <br />
      It only works correct if the same installer ist executed TWICE, without changing anything.<br />
      <br />
      I try to describe the situation. On remark before: The software, i am writing an installer for, is OLD, and very complex. We can't change anything, we can only automated the written install process, that is now written on a paper and needs some hours if done by hand.<br />
      <br />
      Situation:<br />
      The installer first unzips a big zip-file, containing the whole system, using Nsisz::Extract.<br />
      <br />
      Then installer creats a database by using 4 existing exe-Files, that have several parameters. This exe-Files consists of encapsuleted sql-code, using a C++ Sql library. This is not the problem. Database is well created by these command, either by a batch file, or by the installer-programm.<br />
      <br />
      Then the created Database (on MSSQL-DB-Server) is filled with same base-date, using another existing exe-command, like above. It can handle several parameters, and the path and name of some text-files that contains the base-info.<br />
      <br />
      This is the command, with some parameters and Data Text-file.<br />
      setsu.exe $2 -s StandardUser -m GKN-2 -d operational -f StandardUser_operational_GKN-2_UDMA.sdo<br />
      <br />
      -f is the text-file name<br />
      <br />
      (by the way: I must use this command, can't write it directly per sql-statements. This is the project-demand)<br />
      <br />
      And now, THIS IS THE PROBLEM ! When i run the NSIS installer - that I wrote - the first time, the Database is correct generated, BUT the base-info, coming out of the text-files isn't putted in. The tables are empty !<br />
      <br />
      If I run the UNCHANGED installer another time, the<br />
      info out of the text-files is correctly putted in the Database ! It doesn't matter if I overwrite the database, or not !<br />
      <br />
      This is a very strange behaviour. Unfortunately it is very difficult to get a log from the exe-files, because Execwait doesn't show the shells.<br />
      <br />
      During the installationprocess itt is the first time, I try to read info from files, all commands before are only parameters, pathes and registry keys.<br />
      <br />
      My question is: Could it be, that the unzipped textfiles, are in the first run of the installer "locked", so that they can't be read. Or that they are not completly there, even they are visible either in windows explorer, or dir-command ?<br />
      <br />
      Does anyone have an idea, why the textfile data is only written in the database if the installer is run TWICE ?<br />
      <br />
      I would be happy for ANY Tipps...</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Animaether</span><br />
      <span class="post-time small text-muted">2nd April 2009 13:20 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">no idea, specifically, but you could use ExecDos instead of ExecWait:<br />
      <a href="http://nsis.sourceforge.net/ExecDos_plug-in" target="_blank">http://nsis.sourceforge.net/ExecDos_plug-in</a><br />
      That will allow you to output the program's stdout (what it would print to screen) to the install detail window, to a file, to the stack for reading, etc.<br />
      <br />
      The program's output may give a clue, at least.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">congahonga</span><br />
      <span class="post-time small text-muted">2nd April 2009 13:24 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>ExitCode -128 in first run</strong><br />
      and 2 in second run !<br />
      <br />
      Strange !<br />
      <br />
      What means -128 ?</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Animaether</span><br />
      <span class="post-time small text-muted">2nd April 2009 14:02 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">well I meant the output it would normally print to screen (i.e. when you run it in DOS); ExecDos can redirect that to a file. That should have more details.<br />
      <br />
      What you're referring to are exit codes, and you'd have to check the documentation for / developers of 'setsu.exe' to see what the exit code values mean.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">congahonga</span><br />
      <span class="post-time small text-muted">7th April 2009 08:48 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>Hmmm....</strong><br />
      I think, the exit-code is from ExecDos...<br />
      Because if I exec a file, which is not there, or make some other things, it occurs to the same exit-codes.<br />
      <br />
      So they must come from ExecDos, needn't they ?</p>
    </div>
    <hr />

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]>
  </script>
</body>
</html>
