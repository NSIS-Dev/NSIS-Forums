<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="Unicode NSIS - Plugins Trouble" />

  <title>Unicode NSIS - Plugins Trouble - NSIS Forums</title><!-- Bootstrap core CSS -->
  <link rel="stylesheet" type="text/css" href="//netdna.bootstrapcdn.com/bootswatch/3.0.1/readable/bootstrap.min.css" />
  <link rel="stylesheet" href="../css/style.css" type="text/css" /><!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!--[if lt IE 9]>
                <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
                <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->
</head>

<body>
  <div class="container">
    <!-- Put navigation bar here -->

    <ol class="breadcrumb">
      <li><a href="../index.html" class="glyphicon glyphicon-home"></a></li>

      <li><a href="f-65.html">NSIS Discussion</a></li>

      <li class="active">Unicode NSIS - Plugins Trouble</li>
    </ol>

    <p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=308789">Unicode NSIS - Plugins Trouble</a></p><br />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">jr_spurs</span><br />
      <span class="post-time small text-muted">23rd July 2009 10:15 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>Unicode NSIS - Plugins Trouble</strong><br />
      Hi everyone,<br />
      <br />
      I am currently using the Unicode NSIS branch and need to get some of the ANSI plugins working within my installer.<br />
      <br />
      I have been beavering away at trying to recompile/recode some existing plugins to get them working with Unicode NSIS.<br />
      <br />
      The three in particular that I need to get working are<br />
      <br />
      FontName - <a href="http://nsis.sourceforge.net/FontName_plug-in" target="_blank">http://nsis.sourceforge.net/FontName_plug-in</a><br />
      ButtonEvent - <a href="http://nsis.sourceforge.net/ButtonEvent_plug-in" target="_blank">http://nsis.sourceforge.net/ButtonEvent_plug-in</a><br />
      dialogsEx - <a href="http://nsis.sourceforge.net/Dialog****plug-in" target="_blank">http://nsis.sourceforge.net/Dialog****plug-in</a><br />
      <br />
      Do you know are there unicode versions of these?<br />
      <br />
      Alternatively does anyone know of any step by step documentation on NSIS plugin development as I seem to be getting the same errors when I try to build the solution in Visual Studio 2005?<br />
      <br />
      I have using the Unicode pluginapi.h and pluginapi.lib files from the Unicode Plugin example when building.<br />
      <br />
      1&gt; Creating library .\Debug/ButtonEvent.lib and object .\Debug/ButtonEvent.exp<br />
      1&gt;ButtonEvent.obj : error LNK2019: unresolved external symbol __RTC_CheckEsp referenced in function "void __cdecl ExecNSISFunc(int)" (?ExecNSISFunc@@YAXH@Z)<br />
      1&gt;ButtonEvent.obj : error LNK2001: unresolved external symbol __RTC_Shutdown<br />
      1&gt;ButtonEvent.obj : error LNK2001: unresolved external symbol __RTC_InitBase<br />
      1&gt;ButtonEvent.obj : error LNK2019: unresolved external symbol _popstring@4 referenced in function _AddEventHandler<br />
      1&gt;ButtonEvent.obj : error LNK2001: unresolved external symbol _g_variables<br />
      1&gt;ButtonEvent.obj : error LNK2001: unresolved external symbol _g_stacktop<br />
      1&gt;ButtonEvent.obj : error LNK2001: unresolved external symbol _g_stringsize<br />
      1&gt;ButtonEvent.obj : error LNK2019: unresolved external symbol _pushstring@4 referenced in function _WhichButtonId<br />
      1&gt;ButtonEvent.obj : error LNK2019: unresolved external symbol ___security_cookie referenced in function _WhichButtonId<br />
      1&gt;ButtonEvent.obj : error LNK2019: unresolved external symbol @__security_check_cookie@4 referenced in function _WhichButtonId<br />
      1&gt;ButtonEvent.obj : error LNK2019: unresolved external symbol @_RTC_CheckStackVars@8 referenced in function _WhichButtonId<br />
      1&gt;LINK : error LNK2001: unresolved external symbol __DllMainCRTStartup@12<br />
      1&gt;.\Debug/ButtonEvent.dll : fatal error LNK1120: 12 unresolved externals<br />
      <br />
      Apolologies for the massive post. Any help here would be greatly appreciated.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">sgiusto</span><br />
      <span class="post-time small text-muted">23rd July 2009 13:04 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Hello,<br />
      I ported my plugin (MSSQL_OLEDB) to 64bit.<br />
      I am using VS2005 too.<br />
      I had to add pluginapi.c to the project instead of using pluginapi.lib (there were some problems with functions decoration, the unicode version is compiled with vs2008).<br />
      All char variables are to be defined TCHAR and all string functions must be modified to be Unicode aware (_sprintf_s or similar).<br />
      If the plugins uses VARIANT or similar it could be a little more tricky.<br />
      Feel free to check the source code of the plugin. That code works both for 32 and 64 bit.<br />
      Stefano</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">jr_spurs</span><br />
      <span class="post-time small text-muted">23rd July 2009 15:17 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Thanks a million sgiustto. Ill give the pluginapi.c a try later.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">gringoloco023</span><br />
      <span class="post-time small text-muted">20th February 2010 12:07 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Did you have any luck in recompiling 'DialogsEx' ?<br />
      <br />
      I would be very interested in a unicode version.<br />
      <br />
      thanx</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Anders</span><br />
      <span class="post-time small text-muted">20th February 2010 16:19 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">The __RTC_CheckEsp and ___security_cookie stuff should be disabled, search the forum for threads about compiling with VS2005<br />
      <br />
      g_stacktop and friends is in the .lib or one of the (nsis) plugin files, can't remember exactly where off the top of my head</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">PerditionC</span><br />
      <span class="post-time small text-muted">22nd February 2010 23:16 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">DialogEx for Unicode can be found at <a href="http://www.fdos.org/win32/nsis/plugins/others/joel/dialogsex.3.zip" target="_blank">http://www.fdos.org/win32/nsis/plugi...ialogsex.3.zip</a><br />
      <br />
      For nsis plugins, generally disable all runtime checks, exceptions, etc, don't include default libs, then enable optimizations, link with pluginapi.c (in unicode nsis source), change most char to TCHAR, check for any calls to windows functions explicitly ending with A, they may be ok or may need to drop the A, wrap character and string constants with _T() or equiv, if it has exdll.h replace it with an include to pluginapi.h, either supply a mini-c-library or replace c library calls with the equiv from standard windows DLLs, eg #define strcpy lstrcpy; after some minor review &amp; fixes, test to ensure everything works as expected and you will have a plugin that can be compiled as ANSI or (by defining UNICODE) as UNICODE.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">gringoloco023</span><br />
      <span class="post-time small text-muted">16th November 2010 16:16 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>Plug-in is lost ?</strong><br />
      As I was searching for the source of the dialogex plug-in for the reason that (I think) I found a bug with the unicode version of ${InputPwdBox}.<br />
      <br />
      I realized that the whole actual plug-in seems to be lost. I am just getting a 404 with either the above link from perditionC or the link from the nsis sourceforge plug-in page.<br />
      <br />
      Can anybody confirm this ?<br />
      <br />
      If so, does anybody have a copy of the source ?</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Anders</span><br />
      <span class="post-time small text-muted">16th November 2010 16:39 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><a href="http://nsis.sourceforge.net/mediawiki/images/c/c6/Joel_plugins_src.7z" target="_blank">http://nsis.sourceforge.net/mediawik...plugins_src.7z</a></p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">gringoloco023</span><br />
      <span class="post-time small text-muted">16th November 2010 18:24 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>Thanx for the ansi source</strong><br />
      and to clarify, the (unicode) script I was using when I thought I found a bug, added the ansi version of the dialogex plug-in which was located in the scripts folder.<br />
      <br />
      So that's solved, no bug.<br />
      <br />
      Still, it's a bit odd that both the ansi &amp; unicode version of this plug-in seem to be lost :(</p>
    </div>
    <hr />

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]>
  </script>
</body>
</html>
