<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="Small bug" />

  <title>Small bug - NSIS Forums</title>
  <script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script>
  <!-- Bootstrap core CSS -->

  <link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css" />
  <link rel="stylesheet" href="../css/style.css" type="text/css" /><!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!--[if lt IE 9]>
                <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
                <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->
</head>

<body>
  <div class="container">
    <!-- Put navigation bar here -->

    <ol class="breadcrumb">
      <li><a href="../index.html" class="glyphicon glyphicon-home"></a></li>

      <li><a href="f-65.html">NSIS Discussion</a></li>

      <li class="active">Small bug</li>
    </ol>

    <p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=195071">Small bug</a></p><br />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
      <span class="post-time small text-muted">29th September 2004 14:02 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>Small bug</strong><br />
      I've found that if you change the text colour of a Label control, and then try and change the text within it the new text appears over the old text and doesn't actually replace it.<br />
      <br />
      Screenshot attached.<br />
      <br />
      A similar thing happens when changing the background colour of e.g. a ListBox control. The background color isn't set for the whole ListBox background, but when you select an item the background colour of that item is set to the new background colour.<br />
      <br />
      I have found a fix for this which is to hide the control and then show it again using ShowWindow (so basically it refreshes the control).<br />
      <br />
      E.g.<br />
      ShowWindow $R0 0<br />
      ShowWindow $R0 5<br />
      <br />
      -Stu</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
      <span class="post-time small text-muted">29th September 2004 14:05 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">If you set the background to transparent and then set the text, Windows has no color to draw over the old text.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">edream</span><br />
      <span class="post-time small text-muted">14th October 2005 00:56 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">I'm trying to add text in ListBox in Leave page. The ListBox is not getting refreshed. If I use abort or MessageBox followed by it, then I can see the refreshed content.<br />
      <br />
      Is there a way I can refresh the newly added text?<br />
      <br />
      I tried ShowWindow {SW_HIDE} and {SW_SHOW}, but the hidden window never comes back. Here is the snippet<br />
      <br />
      Function tempProgressLeave<br />
      <br />
      ; disable back button before showing the progress<br />
      GetDlgItem $0 $HWNDPARENT 3<br />
      EnableWindow $0 0<br />
      <br />
      ; disable next button<br />
      GetDlgItem $0 $HWNDPARENT 1<br />
      EnableWindow $0 0<br />
      <br />
      FindWindow $1 "#32770" "" $HWNDPARENT<br />
      GetDlgItem $0 $1 1202<br />
      StrCpy $2 0<br />
      StrCpy $vard "hello world"<br />
      <br />
      loopd:<br />
      IntOp $2 $2 + 10 ;here the progressbar increases<br />
      ;MessageBOX MB_OK "hello ${SW_SHOW} ${SW_HIDE}"<br />
      ShowWindow $0 ${SW_HIDE}<br />
      SendMessage $0 ${LB_ADDSTRING} "" "STR: $2:$vard"<br />
      ShowWindow $0 ${SW_SHOW}<br />
      IntCmp $2 100 loopd loopd<br />
      <br />
      Sleep 5000<br />
      <br />
      FunctionEnd</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
      <span class="post-time small text-muted">15th October 2005 13:41 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Please attach a complete example.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">edream</span><br />
      <span class="post-time small text-muted">18th October 2005 18:22 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">I have attached the sample script. The script just contains welcome-install-finish page. I had to write custom install page to control the progress bar. I'm able to control the progress bar but not able to refresh the listbox.<br />
      <br />
      could you please take a look at the files and let me know if there is something I am missing ?<br />
      <br />
      Thanks.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
      <span class="post-time small text-muted">20th October 2005 19:45 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">I don't see the code from the first post in your example. Attach an example that contains the code you've tried. Also, there are a lot of missing files. It'd be nicer, if you provide a complete minimal example that I can compile with too much hassle.<br />
      <br />
      BTW, to create a .lnk file, use CreateShortcut. Don't copy premade shortcuts over to the user's computer.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">edream</span><br />
      <span class="post-time small text-muted">21st October 2005 07:26 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">The example I tried is in the zip file. I'm not sure what are the missing files. It requires only the dinst.nsi and the DInstall.ini. both files are bundled in the zip file.<br />
      I copied the zip file in to the separate directory and I'm able to compile. Could you please let me know what the problem you are facing?<br />
      <br />
      I'm not very clear about the createshortcut suggestion.I dont have any such code. Could you please clarify.<br />
      <br />
      Attaching the zip file again.<br />
      <br />
      Thanks.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
      <span class="post-time small text-muted">21st October 2005 09:12 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">It also needs InstallOptionsEx plugin to be present.<br />
      <br />
      -Stu</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">deguix</span><br />
      <span class="post-time small text-muted">21st October 2005 10:45 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">To update the page you can just use this:</p>
      <pre>
<code>   System::Call "User32::UpdateWindow(i)i (r0)"</code>
</pre>Put that line of code after trying to show back the window.<br />
      <br />
      This should be seen as a feature, not bug. You add an item but you have an option to update them when you really need.
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
      <span class="post-time small text-muted">21st October 2005 14:15 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Oops, sorry. I've opened up another script instead of yours.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">edream</span><br />
      <span class="post-time small text-muted">21st October 2005 19:54 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Great! It worked with this change.<br />
      <br />
      System::Call "User32::UpdateWindow(i)i (r0)"<br />
      <br />
      Thanks a lot!</p>
    </div>
    <hr />

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]>
  </script>
</body>
</html>
