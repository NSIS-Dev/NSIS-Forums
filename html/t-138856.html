<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="description" content="Suggestion for UserInfo.nsi"><title>Suggestion for UserInfo.nsi - NSIS Forums</title><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script><link rel="preload" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css" as="style" onload="this.rel='stylesheet'"><link rel="preload" href="../css/style.css" as="style" onload="this.rel='stylesheet'"><noscript><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css"><link rel="stylesheet" href="../css/style.css"></noscript><script>!function(a){"use strict";var b=function(b,c,d){function e(a){return h.body?a():void setTimeout(function(){e(a)})}function f(){i.addEventListener&&i.removeEventListener("load",f),i.media=d||"all"}var g,h=a.document,i=h.createElement("link");if(c)g=c;else{var j=(h.body||h.getElementsByTagName("head")[0]).childNodes;g=j[j.length-1]}var k=h.styleSheets;i.rel="stylesheet",i.href=b,i.media="only x",e(function(){g.parentNode.insertBefore(i,c?g:g.nextSibling)});var l=function(a){for(var b=i.href,c=k.length;c--;)if(k[c].href===b)return a();setTimeout(function(){l(a)})};return i.addEventListener&&i.addEventListener("load",f),i.onloadcssdefined=l,l(f),i};"undefined"!=typeof exports?exports.loadCSS=b:a.loadCSS=b}("undefined"!=typeof global?global:this);!function(a){if(a.loadCSS){var b=loadCSS.relpreload={};if(b.support=function(){try{return a.document.createElement("link").relList.supports("preload")}catch(b){return!1}},b.poly=function(){for(var b=a.document.getElementsByTagName("link"),c=0;c<b.length;c++){var d=b[c];"preload"===d.rel&&"style"===d.getAttribute("as")&&(a.loadCSS(d.href,d,d.getAttribute("media")),d.rel=null)}},!b.support()){b.poly();var c=a.setInterval(b.poly,300);a.addEventListener&&a.addEventListener("load",function(){b.poly(),a.clearInterval(c)}),a.attachEvent&&a.attachEvent("onload",function(){a.clearInterval(c)})}}}(this);</script></head><body><div class="container"><ol class="breadcrumb"><li><a href="../index.html" class="glyphicon glyphicon-home"></a></li><li><a href="f-65.html">NSIS Discussion</a></li><li class="active">Suggestion for UserInfo.nsi</li></ol><p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=138856">Suggestion for UserInfo.nsi</a></p><br><div class="post"><p class="post-meta"><span class="post-author text-primary">Lilla</span><br><span class="post-time small text-muted">13th June 2003 05:14 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>Suggestion for UserInfo.nsi</strong><br>With the latest CVS (downloaded a few hours ago)<br>When running UserInfo.nsi (.exe),<br>under Win98SE, I get the Admin message.<br>This is good, however, it contradicts what is stated<br>in the comments/message of label "Win9x:" (see below)<br><br>Excerpts from UserInfo.nsi<br><br>StrCmp $R2 "Admin" 0 Continue<br>MessageBox MB_OK 'User "$R1" is in the Administrators group'<br><br>... clip...<br><br>Win9x:<br>; This one means you don't need to care about admin or<br>; not admin because Windows 9x doesn't either<br>MessageBox MB_OK "Error! This DLL can't run under Windows 9x!"<br><br><br>Observation:<br>** Win98SE does indeed run this DLL, at least my install does.<br>** My install includes a number of updates, not sure if this is why.<br><br>In any event, you might want to correct the comment/message.<br><br>Lilla</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">kichik</span><br><span class="post-time small text-muted">13th June 2003 10:30 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">I know about this. For some weird reason the functions UserInfo.dll looks are for are there on Windows 98 too but just don't work. So UserInfo.dll, knowing that admin isn't required on Windows 98 anyway, returns admin anyway. You should still check for an empty string because these functions may not be present on Windows 95.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Lilla</span><br><span class="post-time small text-muted">13th June 2003 19:00 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Kichik, thanks for that inforamtion.<br>I'll put the check for empty back in then.<br><br>Lilla</p></div><hr><div class="footer"><p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p></div></div><script src="../js/highlight.pack.js" type="text/javascript"></script><script type="text/javascript">//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]></script></body></html>