<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="description" content="install problem on Windows Server 2003"><title>install problem on Windows Server 2003 - NSIS Forums</title><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script><link rel="preload" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css" as="style" onload="this.rel='stylesheet'"><link rel="preload" href="../css/style.css" as="style" onload="this.rel='stylesheet'"><noscript><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css"><link rel="stylesheet" href="../css/style.css"></noscript><script>!function(a){"use strict";var b=function(b,c,d){function e(a){return h.body?a():void setTimeout(function(){e(a)})}function f(){i.addEventListener&&i.removeEventListener("load",f),i.media=d||"all"}var g,h=a.document,i=h.createElement("link");if(c)g=c;else{var j=(h.body||h.getElementsByTagName("head")[0]).childNodes;g=j[j.length-1]}var k=h.styleSheets;i.rel="stylesheet",i.href=b,i.media="only x",e(function(){g.parentNode.insertBefore(i,c?g:g.nextSibling)});var l=function(a){for(var b=i.href,c=k.length;c--;)if(k[c].href===b)return a();setTimeout(function(){l(a)})};return i.addEventListener&&i.addEventListener("load",f),i.onloadcssdefined=l,l(f),i};"undefined"!=typeof exports?exports.loadCSS=b:a.loadCSS=b}("undefined"!=typeof global?global:this);!function(a){if(a.loadCSS){var b=loadCSS.relpreload={};if(b.support=function(){try{return a.document.createElement("link").relList.supports("preload")}catch(b){return!1}},b.poly=function(){for(var b=a.document.getElementsByTagName("link"),c=0;c<b.length;c++){var d=b[c];"preload"===d.rel&&"style"===d.getAttribute("as")&&(a.loadCSS(d.href,d,d.getAttribute("media")),d.rel=null)}},!b.support()){b.poly();var c=a.setInterval(b.poly,300);a.addEventListener&&a.addEventListener("load",function(){b.poly(),a.clearInterval(c)}),a.attachEvent&&a.attachEvent("onload",function(){a.clearInterval(c)})}}}(this);</script></head><body><div class="container"><ol class="breadcrumb"><li><a href="../index.html" class="glyphicon glyphicon-home"></a></li><li><a href="f-65.html">NSIS Discussion</a></li><li class="active">install problem on Windows Server 2003</li></ol><p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=299376">install problem on Windows Server 2003</a></p><br><div class="post"><p class="post-meta"><span class="post-author text-primary">xlrotor</span><br><span class="post-time small text-muted">31st October 2008 04:59 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>install problem on Windows Server 2003</strong><br>A user today reported that a rather simple installer of mine installed fine for him on a Win XP system, but when he ran it on a Windows Server 2003 system, everything appeared to have gone fine except the application folder in Program Files didn't get created, and so no files were installed.<br><br>Does anyone have a clue as to what might cause this?<br><br>Thanks,<br><br>Brian Murphy<br>Austin, Texas<br><br>Here's the part of the script where the installing is done. I changed "ifnewer" to "try" and sent that to him to try, but I doubt it will matter.<br><br>InstallDir "$PROGRAMFILES\XLRotor Security Key Server"<br>InstallDirRegKey HKLM "${PRODUCT_DIR_REGKEY}" ""<br>ShowInstDetails show<br>ShowUnInstDetails show<br><br>Section "MainSection" SEC01<br>SetOutPath "$INSTDIR"<br>SetOverwrite ifnewer<br><br>File /a /r "Files\*.*"</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Comperio</span><br><span class="post-time small text-muted">31st October 2008 06:53 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Are you dealing with the 64-bit version of 2003 server? If so, then the files were likely installed under the "Program Files (x86)" folder.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">xlrotor</span><br><span class="post-time small text-muted">31st October 2008 12:40 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">I will find out and report back.<br><br>Although, I did ask him to search the entire system for the files, and he said he did and did not find the files.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Comperio</span><br><span class="post-time small text-muted">31st October 2008 16:18 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Another thing that comes to mind is that maybe the user just didn't have the proper permissions. You might change your code just slightly to check for errors. (It won't tell you WHICH error, but would at least alert you to problems during the install):<br></p><pre>
<code><br>!include logiclib.nsh<br>...<br>Section "MainSection" SEC01<br>   ClearErrors<br>   SetOutPath "$INSTDIR"<br>   SetOverwrite ifnewer<br>   File /a /r "Files\*.*"<br>   ${If} ${Errors}<br>      MessageBox MB_OK "Error copying files!"<br>   ${EndIf}<br>SectionEnd</code>
</pre><br>
      (Or, you could change the MessageBox to a DetailPrint command so that problems are at least documented in the install log.)
    </div>
    <hr>

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script type="text/javascript" src="../js/highlight.pack.js" async>
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]></script></body></html>