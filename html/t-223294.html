<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="description" content="ServiceLib.nsh - Can't create a network service"><title>ServiceLib.nsh - Can't create a network service - NSIS Forums</title><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script><link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css"><link rel="stylesheet" href="../css/style.css" type="text/css"><!--[if lt IE 9]><script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script><script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script><![endif]--></head><body><div class="container"><ol class="breadcrumb"><li><a href="../index.html" class="glyphicon glyphicon-home"></a></li><li><a href="f-65.html">NSIS Discussion</a></li><li class="active">ServiceLib.nsh - Can't create a network service</li></ol><p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=223294">ServiceLib.nsh - Can't create a network service</a></p><br><div class="post"><p class="post-meta"><span class="post-author text-primary">jeff_hanna</span><br><span class="post-time small text-muted">3rd August 2005 21:30 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>ServiceLib.nsh - Can't create a network service</strong><br>I've searched through the forums and read the (very slow to respond) WIKI pages. I see that there are many topics regarding Windows services. Unfortunately none of them provide answers to the problems I am having.<br><br>servicelib.nsh doesn't seem to change the service from Local System account to a domain account when I specify a user and a password. The command executes cleanly and successfully, but when I open the Services applet and go to the Log On tab the service is set to "Local System account" and the account, password, and confirm password fields are blank.<br><br>Additionally, the display variable in the parameters doesn't seem to be respected. The display name of the service is the same as the service name.<br><br>The line I am using is:<br><br>!insertmacro SERVICE "create" "Backburner_Srv_200" "path=$ServerPath;interact=0;type=2;user=.\user;password=pass;display=Backburner Server"<br><br>Note: It seems there is a typo in the library's comments type=2 sets the service to auto start while type=3 sets it to manual start. This is the opposite of what is in the comments.<br><br>Any help with this would be greatly appreciated. Creating a network service with a proper user and password is the last hurdle I need to overcome to complete my project.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">kichik</span><br><span class="post-time small text-muted">4th August 2005 22:17 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>Re: ServiceLib.nsh - Can't create a network service</strong><br></p><blockquote><i>Originally posted by jeff_hanna</i><br><b>Note: It seems there is a typo in the library's comments type=2 sets the service to auto start while type=3 sets it to manual start. This is the opposite of what is in the comments.</b></blockquote>Which ServiceLib.nsh is that? <a href="http://nsis.sourceforge.net/wiki/NSIS_Service_Lib" target="_blank">The one on the Wiki</a> mentions nothing about a `type` argument. Is it newer than the Wiki version?<br><br>As for your questions, I have no idea.</div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">jeff_hanna</span><br><span class="post-time small text-muted">5th August 2005 14:49 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>Re: Re: ServiceLib.nsh - Can't create a network service</strong><br></p><blockquote><i>Originally posted by kichik</i><br><b>Which ServiceLib.nsh is that? <a href="http://nsis.sourceforge.net/wiki/NSIS_Service_Lib" target="_blank">The one on the Wiki</a> mentions nothing about a `type` argument. Is it newer than the Wiki version?</b></blockquote>Yes, it is. The library linked on the WIKI page is out of date. See <a href="http://forums.winamp.com/showthread.php?s=&amp;threadid=150873" target="_blank">this discussion</a> for a link to dselkirk's latest release of the library.</div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">kichik</span><br><span class="post-time small text-muted">5th August 2005 14:56 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">That's weird... Both are labeled version 1.2 and the one on the Wiki has a newer date.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">jeff_hanna</span><br><span class="post-time small text-muted">5th August 2005 15:30 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Shrug, yeah it is weird. I started with the one on the WIKI and then found that discussion. The linked file in that discussion has more features and was created as a revision to the first release. The author didn't update the version number or mod date in the file, though. It still shows v1.0<br><br>Anyway, I fixed the display name issue. It seems that the parameters must be seperated with a ; and also end with ;. I didn't have the trailing ; in my line.<br><br>Still can't get user/password info &amp; network service stuff to work, though.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">deguix</span><br><span class="post-time small text-muted">5th August 2005 17:29 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Hmmm... he doesn't answer in the forums since the end of 2003. Maybe contacting him by e-mail about problems?</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">jeff_hanna</span><br><span class="post-time small text-muted">5th August 2005 18:54 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">I tried that a few days ago, dequix. There was no response. I guess at this time we should consider ServiceLib.nsh to be unsupported.<br><br>I found a workaround, though. So things are ok for me. From everything I found about the windows API call CreateService() and the ServiceLib.nsh file it appears as if the create method inside of ServiceLib.nsh is working as expected. Windows (XP) just doesn't seem to respect the user name and switch the service to a network service.<br><br>I found that if I use the DOS command SC immediately after creating the service I can use the config method within SC to set the user/password and WinXP will understand to switch the service to a network service. The command in my installer is:<br><br>nsExec::Exec "sc config backburner_srv_200 obj= .\&lt;usr&gt; password= &lt;pwd&gt;"<br><br>Where &lt;usr&gt; and &lt;pwd&gt; contain the actuall information for my network. If anyone else uses this and they are on a domain then .\&lt;usr&gt; should be changed to &lt;domain&gt;\&lt;usr&gt;<br><br>It's not as clean as having it all happen with ServiceLib.nsh, but it works and is transparent to the user.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">sdelmas</span><br><span class="post-time small text-muted">30th August 2005 23:42 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Did you find a solution to your problem? I have changed the ServiceLib module to fix this (and other issues). If you still need this, I can give you a copy of my file.<br><br>Sven</p></div><hr><div class="footer"><p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p></div></div><script src="../js/highlight.pack.js" type="text/javascript"></script><script type="text/javascript">//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]></script></body></html>