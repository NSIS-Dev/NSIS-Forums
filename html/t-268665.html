<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="Click finish button and try to run App, It keeps hanging.." />

  <title>Click finish button and try to run App, It keeps hanging.. - NSIS Forums</title><!-- Bootstrap core CSS -->
  <link rel="stylesheet" type="text/css" href="//netdna.bootstrapcdn.com/bootswatch/3.0.1/readable/bootstrap.min.css" />
  <link rel="stylesheet" href="../css/style.css" type="text/css" /><!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!--[if lt IE 9]>
                <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
                <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->
</head>

<body>
  <div class="container">
    <!-- Put navigation bar here -->

    <ol class="breadcrumb">
      <li><a href="../index.html" class="glyphicon glyphicon-home"></a></li>

      <li><a href="f-65.html">NSIS Discussion</a></li>

      <li class="active">Click finish button and try to run App, It keeps hanging..</li>
    </ol>

    <p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=268665">Click finish button and try to run App, It keeps hanging..</a></p><br />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">JamesKiller</span><br />
      <span class="post-time small text-muted">30th March 2007 19:32 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>Click finish button and try to run App, It keeps hanging..</strong><br />
      I'm installing application. On the last page of the setup it goes to "Not responding"<br />
      <br />
      In silent mode it just never exits. It keeps hanging and consumes 50% of CPU.<br />
      <br />
      It's reproducible on both Win XP SP2 and Win Vista Business x64<br />
      <br />
      Any thoughts?<br />
      <br />
      <br />
      James</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
      <span class="post-time small text-muted">30th March 2007 19:35 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">The finish page and therefore the application execution are not shown in silent mode so the problem is elsewhere. Do you have code in .onInstSuccess?</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">JamesKiller</span><br />
      <span class="post-time small text-muted">30th March 2007 19:38 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">yeah, I did. I have some code there:<br />
      Function .onInstSuccess<br />
      loop:<br />
      FindWindow $0 "WindowsForms10.Window.8.app.0.33c0d9d" ""<br />
      IsWindow $0 0 loop<br />
      System::Call 'user32::SetForegroundWindow(i r0)'<br />
      FunctionEnd<br />
      <br />
      to catch our application window to bring it up front.<br />
      Any ideas?</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
      <span class="post-time small text-muted">30th March 2007 19:42 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Well, there you go... You have an infinite loop in there. It doesn't stop until the window is found. If the execution failed for some reason or the user closed the application before the installer found the window, it will never end.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">JamesKiller</span><br />
      <span class="post-time small text-muted">30th March 2007 19:58 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">yeah. i found this problem. How can i do. now I just use sleep 2000. and wait for our application window comes up and to catch it...is it ok?????</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
      <span class="post-time small text-muted">30th March 2007 20:08 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">No, you can still enter an infinite loop. If you insist on keeping this loop, the best you can do is set a limit for it. For example, stop it after it tries to find that window and fails for 10 times.</p>
    </div>
    <hr />

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]>
  </script>
</body>
</html>
