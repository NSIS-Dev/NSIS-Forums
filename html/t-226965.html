<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="description" content="multilanguage files"><title>multilanguage files - NSIS Forums</title><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script><link rel="preload" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css" as="style" onload="this.rel='stylesheet'"><link rel="preload" href="../css/style.css" as="style" onload="this.rel='stylesheet'"><noscript><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css"><link rel="stylesheet" href="../css/style.css"></noscript><script>!function(a){"use strict";var b=function(b,c,d){function e(a){return h.body?a():void setTimeout(function(){e(a)})}function f(){i.addEventListener&&i.removeEventListener("load",f),i.media=d||"all"}var g,h=a.document,i=h.createElement("link");if(c)g=c;else{var j=(h.body||h.getElementsByTagName("head")[0]).childNodes;g=j[j.length-1]}var k=h.styleSheets;i.rel="stylesheet",i.href=b,i.media="only x",e(function(){g.parentNode.insertBefore(i,c?g:g.nextSibling)});var l=function(a){for(var b=i.href,c=k.length;c--;)if(k[c].href===b)return a();setTimeout(function(){l(a)})};return i.addEventListener&&i.addEventListener("load",f),i.onloadcssdefined=l,l(f),i};"undefined"!=typeof exports?exports.loadCSS=b:a.loadCSS=b}("undefined"!=typeof global?global:this);!function(a){if(a.loadCSS){var b=loadCSS.relpreload={};if(b.support=function(){try{return a.document.createElement("link").relList.supports("preload")}catch(b){return!1}},b.poly=function(){for(var b=a.document.getElementsByTagName("link"),c=0;c<b.length;c++){var d=b[c];"preload"===d.rel&&"style"===d.getAttribute("as")&&(a.loadCSS(d.href,d,d.getAttribute("media")),d.rel=null)}},!b.support()){b.poly();var c=a.setInterval(b.poly,300);a.addEventListener&&a.addEventListener("load",function(){b.poly(),a.clearInterval(c)}),a.attachEvent&&a.attachEvent("onload",function(){a.clearInterval(c)})}}}(this);</script></head><body><div class="container"><ol class="breadcrumb"><li><a href="../index.html" class="glyphicon glyphicon-home"></a></li><li><a href="f-65.html">NSIS Discussion</a></li><li class="active">multilanguage files</li></ol><p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=226965">multilanguage files</a></p><br><div class="post"><p class="post-meta"><span class="post-author text-primary">uli.kohfink</span><br><span class="post-time small text-muted">26th September 2005 13:36 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>multilanguage files</strong><br>Hello,<br><br>i have to write an installer for the bginfo from sysinernals. i have to copy 3 files (bginfo.exe, bginfo.bgi and bginfo.vbs) from the source to the %ProgramFiles%\BGinfo directory. Because bginfo stores the location of the vbs files hardcoded in the bgi-file i have to write a setup which copies source from c:\programme\bginfo if the os is german and c:\program files if the os is english. how can i implement this? There will be a easy example?<br><br>Thanks a lot;) ;)</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">kichik</span><br><span class="post-time small text-muted">27th September 2005 16:38 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Use $PROGRAMFILES.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Aaron's rod</span><br><span class="post-time small text-muted">27th September 2005 19:32 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Sysinernals typo or fake sysinternals spyware shit?</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Aaron's rod</span><br><span class="post-time small text-muted">27th September 2005 19:38 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">:mad:</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">uli.kohfink</span><br><span class="post-time small text-muted">28th September 2005 07:05 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Forums where users wan't help others and can only write stupid comments i don't like so i will get out of it.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">onad</span><br><span class="post-time small text-muted">28th September 2005 08:48 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Well, as far as I can see there are no stupid comment, both where seriously ment, and Kichik made the helpfull remark "Use $PROGRAMFILES"<br><br>$PROGRAMFILES variable contains the foldername in the GUI language of the OS.<br><br>Success</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">uli.kohfink</span><br><span class="post-time small text-muted">29th September 2005 07:10 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">read the comments before and you must agree me.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Aaron's rod</span><br><span class="post-time small text-muted">29th September 2005 10:35 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">I think I speak for all of us if I say that we don't want to help some dickhead form spyware company.<br><br>All you need to do is prove that you are not some dickhead form spyware company and I will apologize and try to help you.<br><br>Real Sysinternals is already suffering from fake sites that spread programs with exactly same name what probably contains spyware shit. So if you work for real Sysinternals cause you should be grateful that I am sceptical about your motives.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">uli.kohfink</span><br><span class="post-time small text-muted">29th September 2005 11:43 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Okay i think i explained wrong. I use the bginfo from sysinternals and used a custom field which uses a vbs-script to determine the serial number of a pc. For that i wan't to write a setup which copies the needed files to the $PROGRAMFILES\Bginfo directory and starts the program automatically.<br><br>so a Inno-Setup looks like this:<br>[Setup]<br>AppName=BGInfo<br>AppVerName=BGInfo 4.7.0.0<br>AppPublisher=Bryce Cogswell<br>AppPublisherURL=http://www.sysinternals.com<br>AppSupportURL=http://www.sysinternals.com<br>AppUpdatesURL=http://www.sysinternals.com<br>DefaultDirName={pf}\BGInfo<br>DisableDirPage=yes<br>DefaultGroupName=BGInfo<br>DisableProgramGroupPage=yes<br>OutputDir=C:\Software\Tools\BgInfo\Output<br>OutputBaseFilename=setup<br>Compression=lzma<br>SolidCompression=yes<br><br>[Languages]<br>Name: "eng"; MessagesFile: "compiler:Default.isl"<br><br>[Files]<br>Source: "C:\Software\Tools\BgInfo\Bginfo.exe"; DestDir: "{app}"; Flags: ignoreversion<br>Source: "C:\Software\Tools\BgInfo\pcsupport.bgi"; DestDir: "{app}"; Flags: ignoreversion<br>Source: "C:\Software\Tools\BgInfo\pcsupport.vbs"; DestDir: "{app}"; Flags: ignoreversion<br>; NOTE: Don't use "Flags: ignoreversion" on any shared system files<br><br>[Registry]<br>Root:HKLM; SubKey: SOFTWARE\Microsoft\Windows\CurrentVersion\Run; ValueType: string; ValueName: "BGInfo"; ValueData: "{app}\BgInfo\Bginfo.exe {app}\BgInfo\pcsupport.bgi /silent /taskbar"; Flags: uninsdeletevalue<br><br>[InstallDelete]<br>Type: filesandordirs; Name: "{app}"<br><br>[UnInstallDelete]<br>Type: filesandordirs; Name: "{app}"<br><br>but the problem is that running under the Run key.<br>the path of the pcsupport.vbs is stored in the pcsupport.bgi<br><br>so i will be looking for a install script which stores two versions of the source in a zip and automatically installs the right one in depencies of the os.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">NHOCSUNG</span><br><span class="post-time small text-muted">29th September 2005 17:02 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">You need a quote for Reg Key, The quote in Inno maybe ""something""<br><br>If you refer to NSIS<br><br>Just write this anywhere<br><br>WriteRegStr HKLM SOFTWARE\Microsoft\Windows\CurrentVersion\Run "BGInfo" '"{app}\BgInfo\Bginfo.exe" "{app}\BgInfo\pcsupport.bgi" /silent /taskbar';</p></div><hr><div class="footer"><p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p></div></div><script src="../js/highlight.pack.js" type="text/javascript"></script><script type="text/javascript">//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]></script></body></html>