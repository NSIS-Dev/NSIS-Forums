<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="description" content="Activation page component"><title>Activation page component - NSIS Forums</title><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script><link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css"><link rel="stylesheet" href="../css/style.css" type="text/css"><!--[if lt IE 9]><script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script><script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script><![endif]--></head><body><div class="container"><ol class="breadcrumb"><li><a href="../index.html" class="glyphicon glyphicon-home"></a></li><li><a href="f-65.html">NSIS Discussion</a></li><li class="active">Activation page component</li></ol><p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=162857">Activation page component</a></p><br><div class="post"><p class="post-meta"><span class="post-author text-primary">chris_svp</span><br><span class="post-time small text-muted">2nd January 2004 11:38 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>Activation page component</strong><br>Hi all,<br><br>my boss want to add a registration step (like in a good commercial software he said :))during installation, so I think I add to create some kind of activation page between MUI_PAGE_LICENSE and MUI_PAGE_DIRECTORY:<br><br>----------------------------------<br>|Registration X|<br>----------------------------------<br>| |<br>| Name: |<br>| Company: |<br>| Serial Number: |<br>| |<br>| OK Cancel |<br>----------------------------------<br><br>What am I wondering is<br>- someone has already done that ?<br>- and more generally if there is a location (other than the examples directory of course) to find scripts that provide a new functionnality in open source?<br><br>I am using the MUI.<br><br>thanks a lot guys</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">kichik</span><br><span class="post-time small text-muted">2nd January 2004 12:24 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">The Contrib folder contains examples for the plug-ins. Among those plug-ins is InstallOptions which is exactly what you need. Examples\Modern UI\InstallOptions.nsi is also an InstallOptions example.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">chris_svp</span><br><span class="post-time small text-muted">2nd January 2004 14:22 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">thanks, I missed this tuto (the name is not very correlated...)<br><br>My second question is still interrogating me :)<br>It would be very nice if such a location exists</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">kichik</span><br><span class="post-time small text-muted">2nd January 2004 14:30 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Well, that's the Contrib folder. There is also <a href="http://nsis.sf.net/archive" target="_blank">The Archive</a>.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">chris_svp</span><br><span class="post-time small text-muted">2nd January 2004 15:00 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">ah ok :)<br><br>I have another -silly- question, this time on the custom page I create: how do I do multilingual pages?<br><br>I mean how do I, for example, decide the caption of a label in function of the user selected language?<br><br>thanks for your ultra fast answers</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">kichik</span><br><span class="post-time small text-muted">2nd January 2004 15:02 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Write a LangString to the INI using WriteINIStr or the MUI macro (MUI_INSTALLOPTIONS_WRITE, I think).</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">chris_svp</span><br><span class="post-time small text-muted">2nd January 2004 15:31 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">could you be more specific please?<br><br>for example, taking ioB.ini, how do I put a multilingual text for the label?<br><br>//////ioB.ini//////////<br>[Settings]<br>NumFields=1<br><br>[Field 1]<br>Type=label<br>Text=Install Options Page B<br>Left=0<br>Right=-1<br>Top=0<br>Bottom=10<br>////////////////////////<br><br>I tried Text=LangString ${LANG_ENGLISH} "Install Page B"<br>but this doesnot work.<br><br>I believe I misunderstand your answer :(</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">chris_svp</span><br><span class="post-time small text-muted">2nd January 2004 15:33 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">oh my god I did a mistake in typing the msg:<br>I tried<br>Text=LangString ${LANG_ENGLISH} "Install Page B"<br>Text=LangString ${LANG_FRENCH} "Page d'installation B"</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">kichik</span><br><span class="post-time small text-muted">2nd January 2004 15:37 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">You need to write it using WriteINIStr or the MUI macro on runtime. That is, before you show the page, before you call InstallOptions to parse the INI, write the LangString into the text/state field.<br><br>WriteINIStr $PLUGINSDIR\mypage.ini "Field 4" "Text" "$(MyLangString)"</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">jamesgoh</span><br><span class="post-time small text-muted">27th January 2004 01:31 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">I have managed to add in the serial code checking. But I have 2 questions:<br>(1) The serial code page can still be skipped when the installer is executed in DOS using the /S switch. How do I overcome that?<br>(2) I authenticate the serial code using the StrCmp instruction. But StrCmp is non-case sensitive. How do I make a case sensitive comparison?<br><br>Please advice.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Vytautas</span><br><span class="post-time small text-muted">27th January 2004 02:20 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">To use a case sensitive comparison you will have to use the system plugin with the appropriate API call or alternatively write a plugin for NSIS.<br><br>Vytautas</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">opher</span><br><span class="post-time small text-muted">27th January 2004 08:29 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">As to silent (/S switch) run, you can place code in .onInit to check for (= require) the serial code on the command line or otherwise emit a warning and exit.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">chris_svp</span><br><span class="post-time small text-muted">4th February 2004 10:25 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"></p><blockquote><i>Originally posted by jamesgoh</i><br><b>I have managed to add in the serial code checking.</b></blockquote>Can I ask you how you did?<br><br>My problem is that I do not know how to catch the NextButton click (i.e I do not know where to put my code for the checking).</div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Vytautas</span><br><span class="post-time small text-muted">4th February 2004 11:25 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Check the documentation about the leave function you can define for any page in NSIS. You should place your check in that function and if the serial is incorrect use the abort command to prevent the installer from advancing to the next page.<br><br>Vytautas ;)</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Joost Verburg</span><br><span class="post-time small text-muted">4th February 2004 11:33 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">You can disable the Next button if the serial is invalid using EnableWindow, but that alone is not very secure. Therefore you should also check the serial again in the leave funtion and Abort if the serial is invalid.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">chris_svp</span><br><span class="post-time small text-muted">4th February 2004 13:46 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">thanks guys for your quick answers, it helped me a lot (I just missed the leave_function parameter of the Page function). :)<br><br>Now, I have another problem which is the dynamic update of my page (i.e write the registration code after the user click on Generate)<br><br>I join my scripts to this post with a #FIXME in activ.nsi at the place where I want to add this stuff.<br><br>I think that I should use SendMessage but my tries in this area stay unsuccessful.:(<br><br>Thanks again for the previous help.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">kichik</span><br><span class="post-time small text-muted">4th February 2004 14:04 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">You need to use SendMessage &lt;hwnd&gt; ${WM_SETTEXT} 0 "STR:$1". To get the hwnd use GetDlgItem along with the hwnd of the InstallOptions dialog. To get the hwnd of the InstallOptions dialog see the example to set InstallOptions font in the MUI readme.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">chris_svp</span><br><span class="post-time small text-muted">4th February 2004 16:22 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">thank you very much, this is perfectly working now :)</p></div><hr><div class="footer"><p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p></div></div><script src="../js/highlight.pack.js" type="text/javascript"></script><script type="text/javascript">//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]></script></body></html>