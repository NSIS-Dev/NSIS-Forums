<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="ExecShell doesn't work in all computers" />

  <title>ExecShell doesn't work in all computers - NSIS Forums</title><!-- Bootstrap core CSS -->
  <link rel="stylesheet" type="text/css" href="//netdna.bootstrapcdn.com/bootswatch/3.0.1/readable/bootstrap.min.css" />
  <link rel="stylesheet" href="../css/style.css" type="text/css" /><!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!--[if lt IE 9]>
                <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
                <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->
</head>

<body>
  <div class="container">
    <!-- Put navigation bar here -->

    <ol class="breadcrumb">
      <li><a href="../index.html" class="glyphicon glyphicon-home"></a></li>

      <li><a href="f-65.html">NSIS Discussion</a></li>

      <li class="active">ExecShell doesn't work in all computers</li>
    </ol>

    <p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=182096">ExecShell doesn't work in all computers</a></p><br />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">mabrev</span><br />
      <span class="post-time small text-muted">3rd June 2004 07:19 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>ExecShell doesn't work in all computers</strong><br />
      Hi! I'm newbie with NSIS and my problem is that my instalation file works fine in my computer, but it doesn't work in another computers. The problem is in the ExecShell instruction, I try to execute a batch file that is ignored in other computers. Could anybody help me?<br />
      <br />
      I've tried nsExec::Exec but this instrcution is ignored in my computer too.<br />
      <br />
      Thanks in advance and excuse my poor english.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Davion</span><br />
      <span class="post-time small text-muted">3rd June 2004 07:45 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">I don't know for what you use the batch file, but maybe<br />
      Exec or ExecWait could do the job</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">mabrev</span><br />
      <span class="post-time small text-muted">3rd June 2004 08:12 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">No, I can't use Exec or ExecWait. I'm using the batch file for running this command: "mysql-opt -standalone", if I use Exec it appears a black screen that I want to eliminate using ExecShell.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Davion</span><br />
      <span class="post-time small text-muted">3rd June 2004 08:16 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">is the Batch file not executet or does it only not work correctly on the other systems...maybe on other sys your command can't be understand properly</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">mabrev</span><br />
      <span class="post-time small text-muted">3rd June 2004 08:20 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">If I use the same batch file with Exec sentence, the batch works in all computers but a black screen is shown, so the problem isn't the batch file or the command, it must be the ExecShell.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Takhir</span><br />
      <span class="post-time small text-muted">3rd June 2004 13:18 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Two links from 2-nd forum page :)<br />
      <br />
      <a href="http://forums.winamp.com/showthread.php?s=&amp;threadid=179975" target="_blank">http://forums.winamp.com/showthread....hreadid=179975</a><br />
      <a href="http://forums.winamp.com/showthread.php?s=&amp;threadid=181442" target="_blank">http://forums.winamp.com/showthread....hreadid=181442</a><br />
      <br />
      Try SW_HIDE first</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">zimsms</span><br />
      <span class="post-time small text-muted">3rd June 2004 15:23 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Why not use nsExec?<br />
      <br />
      nsExec<br />
      ------<br />
      nsExec will execute command-line based programs and capture the output<br />
      without opening a dos box.<br />
      <br />
      <br />
      Usage<br />
      -----<br />
      nsExec::Exec [/TIMEOUT=x] path<br />
      <br />
      -or-<br />
      <br />
      nsExec::ExecToLog [/TIMEOUT=x] path<br />
      <br />
      -or-<br />
      <br />
      nsExec::ExecToStack [/TIMEOUT=x] path<br />
      <br />
      <br />
      See the documentation, it's all in there.....</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">mabrev</span><br />
      <span class="post-time small text-muted">3rd June 2004 15:47 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"></p>

      <blockquote>
        <i>Originally posted by zimsms</i><br />
        [B]Why not use nsExec?
      </blockquote>I've tried this also, but it doesn't work. I don't know why, but it doesn't do anything. I've seen the documentation, but I don't know if I have to add some code for using it or what it's wrong.<br />
      <br />
      My code is:<br />
      <pre>
<code><br />                SetOutPath $4\mysql\bin<br />                File "mysql.bat"<br />;               Exec 'mysql.bat' ;-- Se arranca el servidor Mysql<br />                ExecShell "open" /S '$4\mysql\bin\mysql.bat' ;-- Se arranca el servidor Mysql<br />;               nsExec::Exec "mysql.bat"<br /></code>
</pre><br />
      <br />
      nsExec doesn't work in any computer, exec works in all and execShell only in my computer.<br />
      <br />
      Somebody could tell me if there is something wrong?
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">zimsms</span><br />
      <span class="post-time small text-muted">3rd June 2004 15:52 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">oh, nsExec works, but since NSIS is a win32 application no matter what you get the prompt back instantly. If you check your process viewer, you will notice your batch file is running.<br />
      <br />
      I had a similar issue, and had to write a C function that waits for the process to end before returning to the user. I also requested that this functionality be added to nsExec, as nsExec::ExecWait. But have not seen it appear in CVS as of yet.<br />
      <br />
      You can read the thread <a href="http://forums.winamp.com/showthread.php?s=&amp;threadid=180398" target="_blank">here</a>.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">mabrev</span><br />
      <span class="post-time small text-muted">3rd June 2004 16:13 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Well, I've checked my process viewer and my problem is opposite to yours, my instalation file is stopped waitting batch file ending. I want to nsExec doesn't wait, how can I do that??</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">zimsms</span><br />
      <span class="post-time small text-muted">3rd June 2004 16:20 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">nsExec::Exec "$4\mysql\bin\mysql.bat"</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Takhir</span><br />
      <span class="post-time small text-muted">3rd June 2004 16:35 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">What about this?<br />
      <br />
      System::Call 'kernel32.dll::WinExec(t "mysql.bat", i 0) i.r0'</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Joost Verburg</span><br />
      <span class="post-time small text-muted">3rd June 2004 16:48 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Is the file associated set correctly?</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">mabrev</span><br />
      <span class="post-time small text-muted">3rd June 2004 16:58 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"></p>

      <blockquote>
        <i>Originally posted by Takhir</i><br />
        <b>What about this?<br />
        <br />
        System::Call 'kernel32.dll::WinExec(t "mysql.bat", i 0) i.r0'</b>
      </blockquote>It works perfectly<br />
      <br />
      Thanks a lot to everybody
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">ccartier</span><br />
      <span class="post-time small text-muted">12th November 2007 09:41 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">System::Call 'kernel32.dll::WinExec(t "c:\temp\mybat.bat", i 0) i.r0' works well to launch a .bat file at the end of the NSIS installation process. Problem: WinExec executes the .bat file from ...\My documents (ie it's there I find .log file after the launch), whereas I'd like to be executed from the .bat repository, ie c:\temp (so as to read a .conf file).<br />
      Is there a way for it? I tried to precede "System::Call ..." with SetOutPath "c:\temp" but this doesn help...<br />
      <br />
      I'll appreciate any comments<br />
      <br />
      Cyril</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
      <span class="post-time small text-muted">12th November 2007 10:56 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">If you need to run the batch file without waiting for it to finish and you cannot get Winexec working, you can make another NSIS executable that runs the batch file itself with nsExec and extract and run that at the end of your main installer with Exec.<br />
      <br />
      The secondary installer code would look like this:<br /></p>
      <pre>
<code>OutFile RunBatch.exe<br />SilentInstall silent<br />Section<br />nsExec::Exec ...<br />SectionEnd</code>
</pre><br />
      Stu
    </div>
    <hr />

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]>
  </script>
</body>
</html>
