<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="description" content="How do i cal and exe to run?"><title>How do i cal and exe to run? - NSIS Forums</title><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script><link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css"><link rel="stylesheet" href="../css/style.css" type="text/css"><!--[if lt IE 9]><script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script><script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script><![endif]--></head><body><div class="container"><ol class="breadcrumb"><li><a href="../index.html" class="glyphicon glyphicon-home"></a></li><li><a href="f-65.html">NSIS Discussion</a></li><li class="active">How do i cal and exe to run?</li></ol><p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=124259">How do i cal and exe to run?</a></p><br><div class="post"><p class="post-meta"><span class="post-author text-primary">logoguy</span><br><span class="post-time small text-muted">7th February 2003 21:22 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>How do i cal and exe to run?</strong><br>&nbsp; I am trying to install a bat and some files to a temp directory and then run the bat and then after the bat has benn completed delete the temp files (i dont mind if they stay there but it would help if they could be deleted).</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">kichik</span><br><span class="post-time small text-muted">7th February 2003 21:34 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">I would go with nsExec. It will wait for the batch and prevent a DOS window from coming up. Depending on what function you call it will log the output to the install log, or push it to the stack.<br><br>For example:<br><br></p><pre>
<code>
GetTempFileName $0
<br>File/oname=$0 mybatch.bat
<br>nsExec</code>::execToLog $0
<br>Delete$0 
<br>&gt;

</pre>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">logoguy</span><br>
      <span class="post-time small text-muted">7th February 2003 21:42 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">okay that was spanish to me. I dont understand i am not a coder (hardware guy) Can you simlify that for me. Ir could you show me the code/command i wouold type into a text file for a nsis script.</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br>
      <span class="post-time small text-muted">7th February 2003 21:48 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">I did exactly that... GetTempFileName etc.</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">logoguy</span><br>
      <span class="post-time small text-muted">7th February 2003 21:50 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">I can see that but am i able to use that in the nsis file and if so how do i place it?</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br>
      <span class="post-time small text-muted">7th February 2003 21:52 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">A section.<br>
      <br>
      For example:<br>
      <br></p>
      <pre>
<code>
Section "run my batch file"
<br>&gt;# copy above code here
<br>&gt;SectionEnd 
<br>&gt;
</code>
</pre>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">logoguy</span><br>
      <span class="post-time small text-muted">7th February 2003 22:05 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">okay did that and here is the ouput from the compiled install<br>
      ---------<br>
      Output folder: C:\temp<br>
      Extract: patch.exe<br>
      Extract: run.bat<br>
      Extract: simcity4-NA.RTP<br>
      Extract: Readme.txt<br>
      Extract: C:\DOCUME~1\CHRIS~1.CHR\LOCALS~1\Temp\nst34.tmp<br>
      Could not find symbol: execToLog<br>
      Completed<br>
      ---------<br>
      <br>
      And here is the script<br>
      ---------<br>
      ; example1.nsi<br>
      ;<br>
      ; This script is perhaps one of the simplest NSIs you can make. All of the<br>
      ; optional settings are left to their default settings. The installer simply<br>
      ; prompts the user asking them where to install, and drops a copy of makensisw.exe<br>
      ; there.<br>
      ;<br>
      <br>
      ; The name of the installer<br>
      Name "Simcity4 patch installer"<br>
      <br>
      ; The file to write<br>
      OutFile "patcher.exe"<br>
      <br>
      ; The default installation directory<br>
      InstallDir C:\temp<br>
      <br>
      ; The text to prompt the user to enter a directory<br>
      DirText "This will place the patch files on your computer. Choose a directory"<br>
      <br>
      ; The stuff to install<br>
      Section "ThisNameIsIgnoredSoWhyBother?"<br>
      ; Set output path to the installation directory.<br>
      SetOutPath $INSTDIR<br>
      ; Put file there<br>
      File patch.exe<br>
      File run.bat<br>
      File simcity4-NA.RTP<br>
      File Readme.txt<br>
      SectionEnd ; end the section<br>
      Section "running batch"<br>
      GetTempFileName $0<br>
      File /oname=$0 run.bat<br>
      nsExec::execToLog $0<br>
      SectionEnd<br>
      <br>
      ; eof<br>
      -------<br>
      <br>
      What am i doing wrong?</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br>
      <span class="post-time small text-muted">7th February 2003 22:09 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">OK, you are probably using b0 and not the latest CVS version. There was a bug that caused NSIS to be syntax sensitive on function names so you'll need to replace nsExec::execToLog with nsExec::ExecToLog.<br>
      <br>
      And please attach large scripts next time, it makes the forum easier to read.</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">logoguy</span><br>
      <span class="post-time small text-muted">7th February 2003 22:16 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">okay it did not post ne errors but it did not give me a a log nor did it pop up run the bat file.</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br>
      <span class="post-time small text-muted">7th February 2003 22:23 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">I don't understand. What do you mean by "pop up run the bat file."? Did it not run the batch file or only didn't pop up something? It is not supposed to pop up anything, it is supposed to copy any output from the batch file to the installer log. If the batch file doesn't have any output it won't nothing in the log. Did the batch file do his job or not?<br>
      <br>
      A possible problem might be that the batch file assumes a certain current directory. The current directory of the installer is the directory in which it started. In the next version (that will hopefully come out tomorrow) there will be an option to change the current directory.<br>
      <br>
      For now, if this is indeed the problem, you dynamically write the batch file from NSIS using FileOpen, FileWrite and FileClose.<br>
      <br>
      But first try to give the batch file a .bat extension. Use:<br>
      <br></p>
      <pre>
<code>
GetTempFileName $0
<br>Delete$0
<br>StrCpy$0 "$0.bat"
<br>&gt;File /oname=$0 mybatch.bat
<br>nsExec</code>::ExecToLog $0
<br>Delete$0 
<br>&gt;

</pre>Instead of the code above.
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">logoguy</span><br>
      <span class="post-time small text-muted">7th February 2003 22:26 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">okay the bat file is being extracted to the dorevtory with the rest of the files (in this i case i have it set to "c:\temp" i think it is not finding th bat to run how do i set the directory of the bat. I am thinking it has something to do with the "gettempfilename"</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br>
      <span class="post-time small text-muted">7th February 2003 22:33 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Can you please attach the batch file? I just want to make sure it is really needed to set the current directory.</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">logoguy</span><br>
      <span class="post-time small text-muted">7th February 2003 22:35 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">umm it is one line, it is a command line app that has to run to open and use this other file that patches simcity4. and what i need to do is just run the bat file in the directory that all the files were extracted to.</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br>
      <span class="post-time small text-muted">7th February 2003 22:39 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">OK, then here is what you should use:<br>
      <br></p>
      <pre>
<code>
GetTempFileName $0
<br>Delete$0
<br>StrCpy$0 "$0.bat"
<br>&gt;FileOpen $1 $0 "w"
<br>&gt;FileWrite $1 "@echo off$\r$\n"
<br>&gt;StrCpy $2 $TEMP 2
<br>FileWrite$1 "$2$\r$\n"
<br>&gt;FileWrite $1 "cd $TEMP$\r$\n"
<br>&gt;FileWrite $1 "simcity4patcher.exe$\r$\n"
<br>&gt;FileClose $1
<br>nsExec</code>::ExecToLog $0
<br>Delete$0 
<br>&gt;

</pre>Replace simcity4patcher.exe with the right file name and you're set.<br>
      <br>
      This piece of code create a new batch file that CDs to the $TEMP directory and launches the file from there. This will make sure it runs from the right current directory.
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">logoguy</span><br>
      <span class="post-time small text-muted">7th February 2003 22:43 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">I am running an exe that has to ahve commands all i need is to launch a file that is extracted. I think ur going a little ober board.</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br>
      <span class="post-time small text-muted">7th February 2003 22:48 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">OK, you can always try to just extract the file, and use ExecWait on it. Earlier you said it was looking for files in his current directory, this way he won't find them. Trying never hurts though :P<br>
      <br>
      Try:<br>
      <br></p>
      <pre>
<code>
SetOutPath $TEMPSimCityPatcher
<br>File patcher</code>.exe
<br>File otherfiles.dat
<br>&gt;#... more files
<br>&gt;ExecWait $TEMPpatcher.exe
<br>RMDir/R $TEMPSimCityPatcher 
<br>&gt;

</pre>If it says it can't find the files you'll have to do it with the code above.
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">logoguy</span><br>
      <span class="post-time small text-muted">7th February 2003 22:53 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Isnt there just a snipet that lets me launch a file from a specific directory (or in this case the one the files were installed to)</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br>
      <span class="post-time small text-muted">7th February 2003 22:57 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Until tomorrow's version that's the code above. Didn't ExecWait work?</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">logoguy</span><br>
      <span class="post-time small text-muted">7th February 2003 22:59 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">okay, got it with the execwait command now how do i log what happend in the commmand promt.</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br>
      <span class="post-time small text-muted">7th February 2003 23:02 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">To get the output into the log use nsExec::ExecToLog instead of ExecWait.</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">logoguy</span><br>
      <span class="post-time small text-muted">7th February 2003 23:20 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">-------<br>
      Output folder: C:\temp<br>
      Extract: patch.exe<br>
      Extract: run.bat<br>
      Extract: simcity4-NA.RTP<br>
      Extract: Readme.txt<br>
      'run.bat' is not recognized as an internal or external command,<br>
      operable program or batch file.<br>
      Completed<br>
      --------<br>
      that is what it gave me when i used the "nsExec::ExecToLog"</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br>
      <span class="post-time small text-muted">7th February 2003 23:22 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Use nsExec::ExecToLog on the exe too, not the batch file.</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">logoguy</span><br>
      <span class="post-time small text-muted">7th February 2003 23:24 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">I am not trying to launch the exe the bat file does that there is not need to launch the exe it will just flach the program and what is used for and exit (it is a command line prog)</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br>
      <span class="post-time small text-muted">7th February 2003 23:29 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Did ExecWait work with the batch file or the exe?<br>
      Why don't you want to run the exe? You said that the batch file only calls the exe anyway, so why not let nsExec do it?<br>
      <br>
      It will all be a lot easier if you ZIP the batch file and the script and attach them here.</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">logoguy</span><br>
      <span class="post-time small text-muted">7th February 2003 23:33 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">the batch it worked great with the batch</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br>
      <span class="post-time small text-muted">7th February 2003 23:35 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Are you sure you have added $TEMP to the batch name? Because according to the error it searches for just run.bat and not $TEMP\run.bat.</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">logoguy</span><br>
      <span class="post-time small text-muted">7th February 2003 23:37 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">i mean the ExecWait worked great witht he patch.</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">logoguy</span><br>
      <span class="post-time small text-muted">7th February 2003 23:38 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">I decided not to put the bat file in a temp dorectory. I decide to just run it from the directory i extracted it too.</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br>
      <span class="post-time small text-muted">7th February 2003 23:39 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">And did you add $TEMP?<br>
      <br>
      Can you please attach the batch file?</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">logoguy</span><br>
      <span class="post-time small text-muted">7th February 2003 23:43 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">The script calls a prompt that runs the exe and a command atached. Cuz the exe cant be run with out the command to do what it has to do with this other file. I am not just calling an exe from the command promt it is a comand line tool that cant be run with out the being in a command prompt or a bat. I no this is all confusing to you i am sorry this seems so vauge.</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">logoguy</span><br>
      <span class="post-time small text-muted">7th February 2003 23:52 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">This is the bat (it is a txt cuz it wont let me upload a file with the bat extension) it is one line.</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br>
      <span class="post-time small text-muted">8th February 2003 00:05 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Good, now that we have the batch file I can tell you you don't need it. Just use:<br>
      <br>
      nsExec::ExecToLog '"$TEMP\patch.exe" "$TEMP\simcity4-NA.RTP"'<br>
      <br>
      NSIS can pass on command line arguments, you don't need no batch file for that. The above line should work.</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">logoguy</span><br>
      <span class="post-time small text-muted">8th February 2003 00:42 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">It is working thank you so much</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">logoguy</span><br>
      <span class="post-time small text-muted">8th February 2003 00:48 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">how do i launch a readme?</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br>
      <span class="post-time small text-muted">8th February 2003 12:26 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Use ExecShell. For example:<br>
      <br>
      ExecShell open "$INSTDIR\readme.html"<br>
      <br>
      If you are using the Modern UI read its readme there is a better way.</p>
    </div>
    <hr>

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]></script></body></html>