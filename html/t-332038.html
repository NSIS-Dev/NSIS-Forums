<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="description" content="Recuperer une valeur de vbscript à nsis"><title>Recuperer une valeur de vbscript à nsis - NSIS Forums</title><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script><link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css"><link rel="stylesheet" href="../css/style.css" type="text/css"></head><body><div class="container"><ol class="breadcrumb"><li><a href="../index.html" class="glyphicon glyphicon-home"></a></li><li><a href="f-65.html">NSIS Discussion</a></li><li class="active">Recuperer une valeur de vbscript à nsis</li></ol><p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=332038">Recuperer une valeur de vbscript à nsis</a></p><br><div class="post"><p class="post-meta"><span class="post-author text-primary">Angel89</span><br><span class="post-time small text-muted">30th June 2011 11:09 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>Recuperer une valeur de vbscript à nsis</strong><br>Bonjour,<br><br>J'ai crée un code en VBscript,et je veux qu'il retourne une valeur true ou false.apres je veux que cette valeur soi recuperé par un fichier nsis (extension .nsi)<br><br>VOila mon code sur le script:<br><br><br>Function trouve()<br>Dim Result<br>Result=False<br>if fso.FolderExists(Chemin) Then<br><br>Result=true<br><br>Else Result=false<br><br>End if<br>Trouve=Result<br>End Function<br><br><br><br><br>à l'excution de mon script, il m'affiche soi vrais soi faut,selon l'existence de mon dossier. Mais est ce que cette valeur peut etre utilisé dans le nsi?<br><br>Genre que le nsi verifie si par exemple retourne true (vrais) il affiche un message ,le dossier existe Sinn,le dossier n'existe pas.<br><br>Par exemple:<br>File "Verifier_exist_dossier.vbs"<br>File "Lancement1.Bat" # c'est lui qui lance le script<br><br>Execwait '$Temp\Lancement1.Bat'<br><br>!if Trouve=False<br>MessageBox MB "Exist"<br>Else MessageBox MB "n'existe pas"<br><br><br>Mais ca ne marche pas le code<br>Meerci de m'aider</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">MSG</span><br><span class="post-time small text-muted">30th June 2011 11:32 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">You can probably get an exitcode / return value from the vbscript launcher. Or you can write to a temporary file, and read that in NSIS. Have you tried googling for something like 'get return value from vbscript'?</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Angel89</span><br><span class="post-time small text-muted">30th June 2011 12:11 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">No! how can i do that please? I'm not professional Developer.Can You write me the code wich i need?</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Angel89</span><br><span class="post-time small text-muted">30th June 2011 12:16 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Je veux que le nsi vérifie si la valeur retourné par le script est vrais ou faux.si la valeur est vrais,il continue l'instalation,sinn il va afficher un message :<br>MessageBox MB_ICONEXCLAMATION "Erreur"</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Angel89</span><br><span class="post-time small text-muted">30th June 2011 12:25 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">moi je fais<br>SetOutPath $Temp<br>SetOverWrite on<br>File "Verifier_exist_dossier.vbs"<br>File "Lancement1.Bat" # c'est lui qui lance le script<br><br>Execwait '$Temp\Lancement1.Bat'<br><br>!if Trouve=False<br>MessageBox MB "Exist"<br>Else MessageBox MB "n'existe pas"<br><br>Mais ca en marche pas</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">jpderuiter</span><br><span class="post-time small text-muted">30th June 2011 13:27 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Please write in english, as most users (if not all :) can read english, but maybe not all can read french.<br><br>To get a return value from a vbs script:<br><a href="http://www.tek-tips.com/faqs.cfm?fid=5755" target="_blank">http://www.tek-tips.com/faqs.cfm?fid=5755</a><br>But the solutions are not pretty.<br>So you better use something else to get what you want.<br>The scipt you posted can simply be done by NSIS with the IfFileExists (Or ${If} ${FileExists} with LogicLib) command.<br><br>The code from your last post will not work indeed, please read the LogicLib documentation</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Angel89</span><br><span class="post-time small text-muted">30th June 2011 13:32 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">the directory is in an xml file,that's why i use a script to get an attribute ...i'm not sure that i can do it with nsis.<br>Sorry for french</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">jpderuiter</span><br><span class="post-time small text-muted">30th June 2011 13:35 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">There are enough possibilities to read xml data:<br><a href="http://www.google.com/search?aq=f&amp;sourceid=chrome&amp;ie=UTF-8&amp;q=nsis+xml" target="_blank">http://www.google.com/search?aq=f&amp;so...F-8&amp;q=nsis+xml</a></p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Angel89</span><br><span class="post-time small text-muted">30th June 2011 13:57 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">when i execute<br>nsisXML::Create<br>nsisXML :: LOAD &lt;i give the directory here&gt; ...i receive this message: Invalid command : nsisXML::Create</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">jpderuiter</span><br><span class="post-time small text-muted">30th June 2011 14:59 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Have you installed the plugin correctly?<br><a href="http://nsis.sourceforge.net/How_can_I_install_a_plugin" target="_blank">http://nsis.sourceforge.net/How_can_I_install_a_plugin</a><br><a href="http://nsis.sourceforge.net/Docs/Chapter2.html#2.6" target="_blank">http://nsis.sourceforge.net/Docs/Chapter2.html#2.6</a></p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Angel89</span><br><span class="post-time small text-muted">30th June 2011 15:32 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Yes! I just installer the plugin.<br>Now how can i get the attribute??<br>this is part of my xml file:<br>&lt; v1&gt;<br>&lt;v2&gt;<br>&lt;v3 chemin= "c:\Dossier" taille=100&gt;<br>&lt;\v3&gt;<br>&lt;\v2&gt;<br>&lt;\v1&gt;<br><br>i want to get the value of the attribute chemin and Test if is present.<br><br>This is my new nsi file wich do the test:<br>outfile test.exe<br>section Test<br>nsisXML::Create<br>nsisXml::Load&lt;$c:\.....&gt;<br>....... I don't know what should i write in the rest<br>Help plz ^^</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">MSG</span><br><span class="post-time small text-muted">30th June 2011 15:56 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">There is an example in the plugin's readme.txt, and in sample.nsi. You can use those to learn how to use the plugin.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Angel89</span><br><span class="post-time small text-muted">30th June 2011 16:49 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">I used the examples! But i don't succed.You don't have another easier way to pars the value of an attribute from an XML File?<br>May Be with Script is easier??</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">MSG</span><br><span class="post-time small text-muted">30th June 2011 21:07 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Well XML files are just plain text files, so you can probably use the macros in textfunc.nsh and wordfunc.nsh to get your value. See the manual: <a href="http://nsis.sourceforge.net/Docs/AppendixE.html" target="_blank">http://nsis.sourceforge.net/Docs/AppendixE.html</a></p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">T.Slappy</span><br><span class="post-time small text-muted">1st July 2011 06:53 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">@Angel89: actually we cannot write whole script for you.<br>Forum is the way to get some clue how to solve a problem.<br>You need to understand a more of XML and NSIS to write working script.<br>If anybody writes script for you and later you change something in xml then you will need to ask on this forum again... that is bad approach<br>Try to understand the problem and learn NSIS or hire someone to write script for you.<br><br>This is only general comment, no offense :)</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Angel89</span><br><span class="post-time small text-muted">1st July 2011 10:43 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Thank You For Your help!<br>I resolved the problem.<br>Good luck</p></div><hr><div class="footer"><p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p></div></div><script src="../js/highlight.pack.js" type="text/javascript"></script><script type="text/javascript">//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]></script></body></html>