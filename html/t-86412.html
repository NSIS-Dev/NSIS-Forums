<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="XPStyle &amp; stripping of useless dialogs and bitmaps" />

  <title>XPStyle &amp; stripping of useless dialogs and bitmaps - NSIS Forums</title>
  <script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script>
  <!-- Bootstrap core CSS -->

  <link rel="stylesheet" type="text/css" href="//netdna.bootstrapcdn.com/bootswatch/3.0.1/readable/bootstrap.min.css" />
  <link rel="stylesheet" href="../css/style.css" type="text/css" /><!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!--[if lt IE 9]>
                <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
                <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->
</head>

<body>
  <div class="container">
    <!-- Put navigation bar here -->

    <ol class="breadcrumb">
      <li><a href="../index.html" class="glyphicon glyphicon-home"></a></li>

      <li><a href="f-65.html">NSIS Discussion</a></li>

      <li class="active">XPStyle &amp; stripping of useless dialogs and bitmaps</li>
    </ol>

    <p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=86412">XPStyle &amp; stripping of useless dialogs and bitmaps</a></p><br />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
      <span class="post-time small text-muted">30th April 2002 09:59 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>XPStyle &amp; stripping of useless dialogs and bitmaps</strong><br />
      Hi!<br />
      <br />
      Since justin didn't want to do it, I did it my self. So here it is, script compile time directive to add WinXP style support and stripping of useless dialogs and bitmaps when using silent mode.<br />
      <br />
      XPStyle disable|enable<br />
      <br />
      XPStyle is disabled by default.<br />
      <br />
      Attached are the changed source files and a new version of my EditPlus syntax file.<br />
      <br />
      I only have one problem with it, when I strip the useless resources manually with a program like <a href="http://www.rpi.net.au/~ajohnson/resourcehacker/" target="_blank">Resource Hacker</a> it reduces about 3 KBs from the header but when I do it with my code it only reduces a KB. Does anyone know what I am doing wrong? The stripping code is in build.cpp.<br />
      <br />
      If I have some more time I will convert more compile time #define's to script compile time directives.<br />
      <br />
      Enjoy,<br />
      KiCHiK<br />
      <br />
      BTW, the road from here to full color icons is short... ;)</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">DuaneJeffers</span><br />
      <span class="post-time small text-muted">3rd May 2002 02:44 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Cool, Good work.<br />
      <br />
      -Duane</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
      <span class="post-time small text-muted">3rd May 2002 13:33 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Bug found...<br />
      <br />
      This patch will ouput corrupted installer if !packhdr is used.<br />
      Sorry about this, I will release a fix with the next patch that will include support for full color icons as well.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
      <span class="post-time small text-muted">3rd May 2002 14:41 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Ok, now this really sucks... It turns out that UpdateResource only works on NT. :(<br />
      <br />
      I <b>will</b> try to do it without those functions...<br />
      <br />
      I will let you know.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">DuaneJeffers</span><br />
      <span class="post-time small text-muted">5th May 2002 06:29 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Well, if it is only going to work on XP, then the NT problem shouldn't matter because the kernel was built on NT.<br />
      <br />
      -Duane</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">pjw62</span><br />
      <span class="post-time small text-muted">5th May 2002 11:13 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">to manipulate resources in PE exe images, you need to use the declarations in winnt.h.<br />
      <br />
      This is how I wrote the resource offset finding code. To update resources is slightly more complicated as you need to update the offsets in the resource table as well as actually delete the data, so window can still find the resources in the exe file. Although I kept it all inline, to find so many resources, you would probably need to process recursively.<br />
      <br />
      It is a good idea though, so I might be able to offer a small bit of help.<br />
      <br />
      Peter.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
      <span class="post-time small text-muted">5th May 2002 20:27 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">We can always use <a href="http://www.geeworks.com/rsrc/" target="_blank">Geeworks Win32 Resource Library</a>! It is only 3000$ :igor: ! Oops... My bad :( it is <b>only</b> 2999$ :p<br />
      <br />
      Well, I guess I will have to write some resource updating functions myself. I have in my hands a Delphi source code of some sort of resource editing program someone sent as an answer in a news-group somewhere in the deep cyberspace :D<br />
      <br />
      If anyone can help, or know an open source resource editing proggie I will really appreciate it because I don't really have the time right now. If no one can help I will have some free time, two months, in about two months.<br />
      <br />
      Ta ta, cheers<br />
      KiCHiK</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">TheSh@dow</span><br />
      <span class="post-time small text-muted">6th May 2002 20:17 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Hi<br />
      <br />
      if ya want NSIS with win xp buttons &amp; progress bars here is a little prog i made<br />
      <a href="http://home.iprimus.com.au/shaun_l/Files/NSIS_WinXp.zip" target="_blank">http://home.iprimus.com.au/shaun_l/Files/NSIS_WinXp.zip</a> (450kb)</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
      <span class="post-time small text-muted">6th May 2002 20:37 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Hi Shadow,<br />
      <br />
      Thanks for your help! But what I want is more than just XP style, I want to be able to edit all of NSIS's resources. Is the source code for this program available? Are you using UpdateResource or did you implement resource editing functions according to the PE structure? Did you write it with C or another language?<br />
      <br />
      TIA<br />
      KiCHiK</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">TheSh@dow</span><br />
      <span class="post-time small text-muted">6th May 2002 20:53 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Hi<br />
      <br />
      i made it with Resource Hacker &amp; upx<br />
      it just extracts the files to a temp folder<br />
      then auto updates the tmp.dat and gives the updated file to makensisw<br />
      i am still learning to program :P<br />
      i got a demo program that came with delphi 6 to view &amp; i think to edit pe files u want it?</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
      <span class="post-time small text-muted">7th May 2002 16:16 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Thanks Shadow!<br />
      <br />
      Well, using Resource Hacker inside NSIS will be kind of messy...<br />
      <br />
      I will be happy if you can send the demo to me so I will have a better starting point. All I will have to do is to translate from Delphi to C, and that will be easier than doing it all from scratch.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">TheSh@dow</span><br />
      <span class="post-time small text-muted">7th May 2002 19:15 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Hi<br />
      <br />
      i dident mean the Resource Hacker is in the output .exe file,<br />
      it just adds the WinXP.manifest into the header file before NSIS compiler adds the compressed file, scripts and all the stuff it dose<br />
      <br />
      <br />
      oh yea here is the source code</p>
    </div>
    <hr />

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]>
  </script>
</body>
</html>
