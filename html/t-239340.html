<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="Execute script after reboot automatically" />

  <title>Execute script after reboot automatically - NSIS Forums</title>
  <script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script>
  <!-- Bootstrap core CSS -->

  <link rel="stylesheet" type="text/css" href="//netdna.bootstrapcdn.com/bootswatch/3.0.1/readable/bootstrap.min.css" />
  <link rel="stylesheet" href="../css/style.css" type="text/css" /><!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!--[if lt IE 9]>
                <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
                <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->
</head>

<body>
  <div class="container">
    <!-- Put navigation bar here -->

    <ol class="breadcrumb">
      <li><a href="../index.html" class="glyphicon glyphicon-home"></a></li>

      <li><a href="f-65.html">NSIS Discussion</a></li>

      <li class="active">Execute script after reboot automatically</li>
    </ol>

    <p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=239340">Execute script after reboot automatically</a></p><br />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Oxyyy</span><br />
      <span class="post-time small text-muted">27th February 2006 14:26 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>Execute script after reboot automatically</strong><br />
      Hi,<br />
      <br />
      I have to execute a part of the installation after a reboot. That means, some files are installed, the system is rebooted and after the reboot the installation process has to be continued.<br />
      <br />
      So my question is: how can I define a NSIS-script that is executed after rebooting?<br />
      <br />
      Oxyyy</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">glory_man</span><br />
      <span class="post-time small text-muted">27th February 2006 15:50 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">You can add your installer in RunOnce key of regestry. Execute your installer with parameter which can tell you about computer's restart.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
      <span class="post-time small text-muted">27th February 2006 16:00 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Or even write a registry key to tell your installer that the PC was just rebooted (remember to remove it afterwards!)<br />
      <br />
      -Stu</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Oxyyy</span><br />
      <span class="post-time small text-muted">27th February 2006 19:38 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"></p>

      <blockquote>
        <i>Originally posted by glory_man</i><br />
        <b>You can add your installer in RunOnce key of regestry. Execute your installer with parameter which can tell you about computer's restart.</b>
      </blockquote>That sounds good but thereI have the problem that the installer can be located somewhere on a network drive that is no longer available after restarting. So it would be necessary to copy the installer itself to e.g. TMP. But is this possible?
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
      <span class="post-time small text-muted">27th February 2006 19:57 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Try CopyFiles on itself. If this doesn't work (I doubt it will) then you need to write another installer to do it. This other installer will contain the following:<br />
      <br /></p>
      <pre>
<code>OutFile "CopyInstaller.exe"<br /><br />Function .onInit<br /> Sleep 1000 #Need to wait a bit until installer closes.<br /> Call GetParameters<br />  Pop $R0<br /> CopyFiles $R0 "$TEMP\setupfile.exe"<br /> Abort<br />FunctionEnd<br /><br />Section<br />SectionEnd</code>
</pre><br />
      <br />
      So you should include this file as any other file, extract it to $TEMP and execute it from there with "$INSTDIR" as the parameter. Ideally the installer should Exec it and then Quit immediately. Also you need the GetParameters function in the script (which you can grab in the docs under Useful Scripts).<br />
      <br />
      -Stu
    </div>
    <hr />

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]>
  </script>
</body>
</html>
