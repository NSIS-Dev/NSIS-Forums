<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="description" content="WinVer.nsh"><title>WinVer.nsh - NSIS Forums</title><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script><link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css"><link rel="stylesheet" href="../css/style.css" type="text/css"><!--[if lt IE 9]><script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script><script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script><![endif]--></head><body><div class="container"><ol class="breadcrumb"><li><a href="../index.html" class="glyphicon glyphicon-home"></a></li><li><a href="f-65.html">NSIS Discussion</a></li><li class="active">WinVer.nsh</li></ol><p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=257994">WinVer.nsh</a></p><br><div class="post"><p class="post-meta"><span class="post-author text-primary">dienjd</span><br><span class="post-time small text-muted">21st October 2006 03:21 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>WinVer.nsh</strong><br>The new header looks really nice! It should make that detection/comparison a whole lot cleaner in scripts. Just wanted to say thanks for the new functionality.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">kichik</span><br><span class="post-time small text-muted">31st October 2006 23:04 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Hopefully this will help users have their installers function longer without a need to update for newer versions of Windows. And of course this is another reason to use LogicLib which is always good to have.<br><br>On another note, Joost has found a bug that caused failure in detection of Windows 98 and Windows ME. AtLeastWin98 didn't catch Windows 98 but caught Windows ME and AtLeastWinME didn't catch ME. IsWin98 and IsWinME didn't work.<br><br>A <a href="http://nsis.cvs.sourceforge.net/nsis/NSIS/Include/WinVer.nsh.diff?r1=1.1&amp;r2=1.2" target="_blank">diff of the fix</a> is available. Once WebCVS will be back up, I'll post a link to the full download as well. This change will be included in 2.22.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">goldy1064</span><br><span class="post-time small text-muted">31st October 2006 23:54 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Another feature that might be helpful, would be to allow a flag passed to all the ReadReg* and WriteReg* that will perform the operation on the actual node instead of the redirected registry node.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Joost Verburg</span><br><span class="post-time small text-muted">1st November 2006 00:01 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">See Include\x64.nsh</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">goldy1064</span><br><span class="post-time small text-muted">1st November 2006 00:31 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">I had seen those. The only thing is that the enable and disable FS redirection only work on the FS and don't work on the registry. To work on the registry, you would need to pass the KEY_WOW64_64KEY flag into the RegCreateKeyEx/RegOpenKeyEx functions dwOptions parameter.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">kichik</span><br><span class="post-time small text-muted">1st November 2006 09:23 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Complete version of the fixed WinVer.nsh available at:<br><br><a href="http://nsis.cvs.sourceforge.net/*checkout*/nsis/NSIS/Include/WinVer.nsh" target="_blank">http://nsis.cvs.sourceforge.net/*che...ude/WinVer.nsh</a></p></div><hr><div class="footer"><p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p></div></div><script src="../js/highlight.pack.js" type="text/javascript"></script><script type="text/javascript">//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]></script></body></html>