<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="n00b in need of some system.dll assistance" />

  <title>n00b in need of some system.dll assistance - NSIS Forums</title>
  <script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script>
  <!-- Bootstrap core CSS -->

  <link rel="stylesheet" type="text/css" href="//netdna.bootstrapcdn.com/bootswatch/3.0.1/readable/bootstrap.min.css" />
  <link rel="stylesheet" href="../css/style.css" type="text/css" /><!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!--[if lt IE 9]>
                <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
                <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->
</head>

<body>
  <div class="container">
    <!-- Put navigation bar here -->

    <ol class="breadcrumb">
      <li><a href="../index.html" class="glyphicon glyphicon-home"></a></li>

      <li><a href="f-65.html">NSIS Discussion</a></li>

      <li class="active">n00b in need of some system.dll assistance</li>
    </ol>

    <p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=146218">n00b in need of some system.dll assistance</a></p><br />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">metatr0n</span><br />
      <span class="post-time small text-muted">18th August 2003 22:06 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>n00b in need of some system.dll assistance</strong><br />
      I've combed over docs/archive/forum as best I can and am still at a loss on how to properly use system.dll. First and foremost, how does one include the dll in the NSIS install script? Once that's accomplished, I assume that you can write functions that call on system.dll for various things (like free memory, cpu type, etc.)? If there's some pre-existing and realistic example script out there, plase direct me towards it. FWIW, I'm trying to get my installer to pick up basic computer information as part of on optional survey.<br />
      <br />
      Overall, I must say I'm very impressed with NSIS, so much that I got my employer to drop WISE.<br />
      <br />
      Thanks in advance.<br />
      <br />
      - Seth</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Joel</span><br />
      <span class="post-time small text-muted">18th August 2003 22:35 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Are you familiar to the <b>API</b> concept?<br />
      If you are Visual Basic, C++ or other programming language<br />
      you'll notice that sometimes you need api calls...</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Joel</span><br />
      <span class="post-time small text-muted">18th August 2003 23:35 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">For example:<br /></p>
      <pre>
<code><br />Declare Function GetSystemMetrics Lib "user32" Alias "GetSystemMetrics" (ByVal nIndex As Long) As Long<br /></code>
</pre><br />
      It's a Visual Basic 6 typical API declaration.<br />
      In system words:<br />
      <pre>
<code><br />System::Call 'user32::GetSystemMetrics(i 43) i .r0'<br /></code>
</pre><br />
      43 will detect the number of buttons in your mouse... :)<br />
      <pre>
<code><br />OutFile "NumberMouseButtons.exe"<br />Name "Number of Mouse Buttons"<br />Caption "Number of Mouse Buttons"<br />XPStyle "on"<br /><br />Function ".onInit"<br />System::Call 'user32::GetSystemMetrics(i 43) i .r0'<br />Messagebox MB_OK "$0"<br />Quit<br />FunctionEnd<br /><br />Section "-boo"<br />;<br />SectionEnd<br /></code>
</pre>
    </div>
    <hr />

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]>
  </script>
</body>
</html>
