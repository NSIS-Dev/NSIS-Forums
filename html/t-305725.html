<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="description" content="Help making a smart installer"><title>Help making a smart installer - NSIS Forums</title><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script><link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css"><link rel="stylesheet" href="../css/style.css" type="text/css"><!--[if lt IE 9]><script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script><script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script><![endif]--></head><body><div class="container"><ol class="breadcrumb"><li><a href="../index.html" class="glyphicon glyphicon-home"></a></li><li><a href="f-65.html">NSIS Discussion</a></li><li class="active">Help making a smart installer</li></ol><p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=305725">Help making a smart installer</a></p><br><div class="post"><p class="post-meta"><span class="post-author text-primary">nsed</span><br><span class="post-time small text-muted">25th April 2009 21:30 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>Help making a smart installer</strong><br>Hello everyone, I have recently started working with NSIS and it has impressed me a great deal. Unfortunately the advanced parts of NSIS is a bit confusing for me which has ended up with me trying to accomplish something without much success. What I am trying to do is make an installer that contains 2 sections, section A and section B that work in a special way (I will try to explain without confusing everyone).<br><br>Now lets take section A, when the installer starts it checks the registry to see if there is a registry key containing the version number, it the key doesn't exist section A automatically selected for installation, but it can be unselected manually. If the key does exists, the installer checks the version number and compares it to the version being installed, should the version being installed be newer then the one installed then section A is automatically select for installation with the possibility to manually unselect it, but if the version being installed is older then the one installed then section A is unselected and disabled so that it can't be manually selected again.<br><br>Section B is exactly the same as section A except for that it is never automatically selected. The only time it is automatically select is if there is a registry key containing the version number and the version being installed is newer then the installed version.<br><br>Lastly the uninstaller has to take this into consideration. It should check if section A and section B is installed and offer to manually select which to uninstall while disable the possibility to uninstall a section if it is not currently installed. If only one is uninstalled while the other one remains installed it should not delete itself. It should only delete itself after no more sections remains installed on the system.<br><br>As mentioned I have been working on this for a long time, but unfortunately my HDD containing all this work stopped working and I was stupid enough to not make any backups so I need to start at the beginning. That's why I decided to ask here first before starting this time so that I can do it right from the beginning. Although I have read the documentation, looked over the wiki, studied scripts and searched both this forum and online I can't seem to find a way to accomplish my goal. The frustrating part is that I feel I got really close and that some of the information I came over such as here <a href="http://nsis.sourceforge.net/Managing_Sections_on_Runtime" target="_blank">http://nsis.sourceforge.net/Managing...ons_on_Runtime</a> and here <a href="http://nsis.sourceforge.net/Two_installations_in_one_installer" target="_blank">http://nsis.sourceforge.net/Two_inst..._one_installer</a> and possible also in this post here <a href="http://forums.winamp.com/showthread.php?s=&amp;threadid=262092" target="_blank">http://forums.winamp.com/showthread....hreadid=262092</a> might contain exactly what I am looking for, but that I am to blind to see it. Any suggestions or help would be greatly appreciated, thanks.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">demiller9</span><br><span class="post-time small text-muted">25th April 2009 23:40 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>Re: Help making a smart installer</strong><br></p><blockquote><i>Originally posted by nsed</i><br><b>Section B ... is never automatically selected. The only time it is automatically select is...</b></blockquote>So Section B is always never automatically selected except sometimes it is? Yeah, you've confused me.<br><br>If you haven't figured this out already, you should be doing <a href="http://nsis.sourceforge.net/Docs/Chapter4.html#4.9.13.1" target="_blank">SectionSetFlags</a> in <a href="http://nsis.sourceforge.net/Docs/Chapter4.html#4.7.2.1.2" target="_blank">.onInit</a> and <a href="http://nsis.sourceforge.net/Docs/Chapter4.html#4.7.2.2.2" target="_blank">un.onInit</a>. You can code the sections to be unselected, and in .onInit select the ones you want or prevent the user from selecting a section by leaving it unselected and setting the read only flag (SF_RO).<br><br>Of course, I recommend using LogicLib, because the native comparison instructions in NSIS are hard to keep straight and relative jumps are tricky (especially if you have macros in your code). With LogicLib your code will read much more like common programming languages.</div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">nsed</span><br><span class="post-time small text-muted">25th April 2009 23:46 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>Re: Re: Help making a smart installer</strong><br></p><blockquote><i>Originally posted by demiller9</i><br>[B]So Section B is always never automatically selected except sometimes it is? Yeah, you've confused me.</blockquote>Thanks for the reply and yes maybe I should have written that differently. What I meant was that unlike section A, section B is only automatically selected when there is a registry key containing the version number and the version being installed is newer then the installed version. Else it is never selected automatically, the rest is exactly like section A.<br><br>I tried to make something usable by using SectionSetFlags and onInit without much success, but I did not know of LogicLib I will take a look into it and see what I can do with it.</div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">nsed</span><br><span class="post-time small text-muted">26th April 2009 01:59 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">I am still really confused as to how I can create the functions that does what I explained earlier. My biggest problem is figuring out the logic behind and I really hope someone can help me out here with some pointers. Thanks.</p></div><hr><div class="footer"><p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p></div></div><script src="../js/highlight.pack.js" type="text/javascript"></script><script type="text/javascript">//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]></script></body></html>