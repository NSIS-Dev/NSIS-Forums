<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="description" content="XP user level install?"><title>XP user level install? - NSIS Forums</title><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script><link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css"><link rel="stylesheet" href="../css/style.css" type="text/css"><!--[if lt IE 9]><script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script><script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script><![endif]--></head><body><div class="container"><ol class="breadcrumb"><li><a href="../index.html" class="glyphicon glyphicon-home"></a></li><li><a href="f-65.html">NSIS Discussion</a></li><li class="active">XP user level install?</li></ol><p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=79968">XP user level install?</a></p><br><div class="post"><p class="post-meta"><span class="post-author text-primary">Pomflain</span><br><span class="post-time small text-muted">21st March 2002 00:45 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>XP user level install?</strong><br>Tried installing from a "restricted" user on my XP box here. It appears the .onInit can run because it detects that an old version is installed, but then can't load the uninstaller. I tried uninstalling it from the add/remove software and it said I lacked the permissions to modify the add/remove settings. What happens if you run an installer that doesn't have anything going on in .onInit is it just quits. Same things happens in the installer if it detects an old version and you say not to uninstall.<br><br>So I'm wondering if there's a way I can detect if the user has the proper access level to run the installer. At least so I can give an error message that says something. Better than just having the installer quit without giving any indication that it even ran at all.<br><br>Any suggestions would be appreciated.<br>Thanks.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">DuaneJeffers</span><br><span class="post-time small text-muted">21st March 2002 00:52 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">If it a restricted user, then they shouldn't be able to install something. They would have to get permission. That is why there is a restricted user that can not download anything and install it.<br><br>-Duane</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Pomflain</span><br><span class="post-time small text-muted">21st March 2002 01:54 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>Yeah</strong><br>However if they run the installer, nothing happens. It runs, but just quits instantly. Not sure why .onInit will run, perhaps it doesn't detect that the program is running until it hits the ShowWindow, not really sure. I'm just wondering if there's a way to detect that they can't install because they don't have permissions so I can give them a dialog telling them such. Otherwise might end up with e-mails saying the installers just quit when the problem is that they are running as a restricted user and never mentioned that.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Pomflain</span><br><span class="post-time small text-muted">21st March 2002 17:48 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>Would this work?</strong><br>In .onInit try to write to the registry, that should fail since the registry should be locked down. Display a message saying that they probably don't have permissions to install the program and prompt them to quit or continue.<br><br>Will that work with the desired effect, or am I going to get some false positives in doing so?<br><br>Thanks.</p></div><hr><div class="footer"><p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p></div></div><script src="../js/highlight.pack.js" type="text/javascript"></script><script type="text/javascript">//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]></script></body></html>