<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="how to detect (and kill) if a process is running for *all* users?" />

  <title>how to detect (and kill) if a process is running for *all* users? - NSIS Forums</title>
  <script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script>
  <!-- Bootstrap core CSS -->

  <link rel="stylesheet" type="text/css" href="//netdna.bootstrapcdn.com/bootswatch/3.0.1/readable/bootstrap.min.css" />
  <link rel="stylesheet" href="../css/style.css" type="text/css" /><!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!--[if lt IE 9]>
                <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
                <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->
</head>

<body>
  <div class="container">
    <!-- Put navigation bar here -->

    <ol class="breadcrumb">
      <li><a href="../index.html" class="glyphicon glyphicon-home"></a></li>

      <li><a href="f-65.html">NSIS Discussion</a></li>

      <li class="active">how to detect (and kill) if a process is running for *all* users?</li>
    </ol>

    <p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=274475">how to detect (and kill) if a process is running for *all* users?</a></p><br />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">bobics</span><br />
      <span class="post-time small text-muted">16th July 2007 23:11 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>how to detect (and kill) if a process is running for *all* users?</strong><br />
      I'm using FindProcDLL to detect if a process is running, but it appears it only detects it for the currently logged in user. In some cases this might be okay, but our app may be running with multiple users logged in (i.e. with Fast User Switching in XP).<br />
      <br />
      At the minimum we'd like to detect if our app is running from another user's account. We may also want to kill the other user's process (which I assume should be pretty straightforward once I have the handle).<br />
      <br />
      TIA,<br />
      bobics</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
      <span class="post-time small text-muted">17th July 2007 17:46 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Have you tried one of the other process detection plug-ins?</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">bobics</span><br />
      <span class="post-time small text-muted">17th July 2007 20:57 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">It took me some time but here are the results.<br />
      <br />
      Of the plugins/sample scripts I tried, only nsProcess::FindProcess detected another user's process (and I think I picked one implementation out of every bucket). In case it might be helpful to anyone else, here's my sample script:<br />
      <br /></p>
      <pre>
<code><br />SetCompressor /solid lzma<br /><br />!include "nsProcess.nsh"<br />!include "FindProcess.nsh"<br /><br />;--- Project Settings --------<br />OutFile "setup.exe"<br /><br />Section<br />SectionEnd<br /><br />Function .onInit<br />        FindProcDLL::FindProc "firefox.exe"<br />        MessageBox MB_OK "FindProcDLL::FindProc = $R0 (found=1)"<br />        <br />        ${nsProcess::FindProcess} "firefox.exe" $0<br />        MessageBox MB_OK "nsProcess::FindProcess = $0 (found=0)"<br />        <br />        Processes::FindProcess "firefox.exe"<br />        MessageBox MB_OK "Processes::FindProcess = $R0 (found=1)"<br />        ;Call listProcesses<br /><br />        FindWindow $0 "MozillaUIWindowClass" ""<br />        MessageBox MB_OK "FindWindow = $0 (found&lt;&gt;0)"<br />        <br />        ${FindProcess} "firefox.exe" $0<br />        MessageBox MB_OK "FindProcess = $0 (found=1)"<br />        <br />        ;I think there's a bug in fct, it just kills the process<br />        fct::fct /MSGONLY /QUESTION "Terminate?" /WC "MozillaUIWindowClass" /WTP "Firefox"<br />        <br />        abort<br />FunctionEnd<br /></code>
</pre>
    </div>
    <hr />

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]>
  </script>
</body>
</html>
