<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="Need Quick Criticism... On a Script." />

  <title>Need Quick Criticism... On a Script. - NSIS Forums</title>
  <script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script>
  <!-- Bootstrap core CSS -->

  <link rel="stylesheet" type="text/css" href="//netdna.bootstrapcdn.com/bootswatch/3.0.1/readable/bootstrap.min.css" />
  <link rel="stylesheet" href="../css/style.css" type="text/css" /><!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!--[if lt IE 9]>
                <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
                <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->
</head>

<body>
  <div class="container">
    <!-- Put navigation bar here -->

    <ol class="breadcrumb">
      <li><a href="../index.html" class="glyphicon glyphicon-home"></a></li>

      <li><a href="f-65.html">NSIS Discussion</a></li>

      <li class="active">Need Quick Criticism... On a Script.</li>
    </ol>

    <p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=133117">Need Quick Criticism... On a Script.</a></p><br />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Tolwyn</span><br />
      <span class="post-time small text-muted">25th April 2003 18:14 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>Need Quick Criticism... On a Script.</strong><br />
      Ok. I was being very careful creating this with the help of HM NIS Edit.<br />
      <br />
      I defined a variable to Hard Code the $Programfiles directory, as I don't want that to change (and don't think I can have the user change it as the files that go here are mutually exclusive of the $INSTDIR folder).<br />
      <br />
      The files are INSTALLING okay.<br />
      I <b>THINK</b> I have the Start Menu shortcuts working okay.<br />
      <br />
      The problem, I think, is that the Uninstaller is not removing the appropriate files deposited into the $INSTDIR folder, nor is it removing the $SMPROGRAMS shortcuts, either (or the folder that the user specified).<br />
      <br />
      Could someone take a quick gander at the script and let me know where I dicked up? :)<br />
      <br />
      The script is to install plane skins into the appropriate folders after the user specifies the game install folder (since I don't know how to populate a variable by checking their Registry for the game, yet).<br />
      <br />
      However, the administrative information files should NOT go into the game folder (that's why I have specified/hardcoded the $PROGRAMFILES\${PGINST} folder for the basic ReadMe, HomePage URL, etc).<br />
      <br />
      Thanks, guys (and gals?)... I apprecaite it in advance.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Tolwyn</span><br />
      <span class="post-time small text-muted">26th April 2003 05:04 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Bump! Please? :)</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Joel</span><br />
      <span class="post-time small text-muted">26th April 2003 15:22 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">I didn't find possible errors.<br />
      Maybe this suggestions.<br />
      1. The "LicenseBkColor 0x00e0e0e0" it's an invalid color format.<br />
      The LicenseBkColor accept rrggbb format. In your case: "e0e0e0"<br />
      2. Instead:<br /></p>
      <pre>
<code><br />Delete "$INSTDIR\Paintschemes\skins\bf109e4\JG77512Bf109E4.bmp"<br />Delete "$INSTDIR\Paintschemes\skins\bf109f4\JG77512Bf109F4.bmp"<br />Delete "$INSTDIR\Paintschemes\skins\bf109g2\JG77512Bf109G2.bmp"<br />Delete "$PROGRAMFILES\${PGINST}\7jg77_readme.txt"<br />Delete "$PROGRAMFILES\${PGINST}\uninst-7jg77skins.exe"<br />Delete "$PROGRAMFILES\${PGINST}\7-JG77 Black Eagles.url"<br />Delete "$SMPROGRAMS\${MUI_STARTMENUPAGE_VARIABLE}\7-JG77.lnk"<br />Delete "$SMPROGRAMS\${MUI_STARTMENUPAGE_VARIABLE}\Uninstall.lnk"<br />Delete "$SMPROGRAMS\${MUI_STARTMENUPAGE_VARIABLE}\Read Me.lnk"<br /></code>
</pre><br />
      Way not:<br />
      <pre>
<code><br />RMDir /r "$INSTDIR\"<br />RMDir /r "$PROGRAMFILES\${PGINST}"<br />RMDir /r "$SMPROGRAMS\${MUI_STARTMENUPAGE_VARIABLE}"<br />;Will remove all with the parameter /r and the folder  <br /></code>
</pre>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Tolwyn</span><br />
      <span class="post-time small text-muted">26th April 2003 16:56 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Since the skins are being installed into a folder that was created by a game, I don't/can't delete the folder, only the specific files installed during this installation.<br />
      <br />
      At any rate, there is an error in the script as the UNINSTALLER is not uninstalling the *.bmp files, or the Start Menu entries. I can't figure out why.<br />
      <br />
      So this would be correct on the color thing:<br />
      LicenseBkColor 0x0e0e0e0<br />
      <br />
      Or just 0xe0e0e0 ?<br />
      Or just e0e0e0 ?<br />
      <br />
      I'm using the Hex color string, but don't know the format.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Joel</span><br />
      <span class="post-time small text-muted">26th April 2003 17:06 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"></p>
      <pre>
<code><br />LicenseBkColor E0E0E0<br /></code>
</pre><br />
      :)<br />
      <br />
      But why, in my opinion, left files behind?<br />
      Delete all the files, folder and sub's in the $INSTDIR.
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Tolwyn</span><br />
      <span class="post-time small text-muted">26th April 2003 17:14 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Uh, because the game has already installed its default skins there.<br />
      Other people have put THERE skins there, etc.<br />
      <br />
      It would be very malignant of me to remove more than only the files that *I* installed.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Joel</span><br />
      <span class="post-time small text-muted">26th April 2003 17:30 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">got it, dude ;)</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">deguix</span><br />
      <span class="post-time small text-muted">26th April 2003 18:35 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">I checked you file at this morning and these are the results:<br />
      <br />
      <b>1)</b>This line below is wrong:<br />
      <br />
      LicenseBkColor 0x00e0e0e0<br />
      <br />
      According to documentation, the form to use is RRGGBB, not 0x00RRGGBB, so is:<br />
      <br />
      LicenseBkColor E0E0E0<br />
      <br />
      So Lobo Lunar is right here.<br />
      <br />
      <b>2)</b>Another line wrong:<br />
      <br />
      WriteIniStr "$PROGRAMFILES\${PGINST}\7-JG77 Black Eagles.url" "InternetShortcut" "URL" "http://www.7jg77.com"<br />
      <br />
      The right way to create shortcuts to webpages is:<br />
      <br />
      CreateShortCut "$PROGRAMFILES\${PGINST}\7-JG77 Black Eagles.url" "http://www.7jg77.com"<br />
      <br />
      <b>3)</b>Instead of (in Section Uninstall):<br />
      <br />
      Delete "$SMPROGRAMS\${MUI_STARTMENUPAGE_VARIABLE}\7-JG77.lnk"<br />
      Delete "$SMPROGRAMS\${MUI_STARTMENUPAGE_VARIABLE}\Uninstall.lnk"<br />
      Delete "$SMPROGRAMS\${MUI_STARTMENUPAGE_VARIABLE}\Read Me.lnk"<br />
      <br />
      Should be:<br />
      <br />
      !insertmacro MUI_STARTMENU_DELETE_BEGIN "$var"<br />
      Delete "$PROGRAMFILES\$var\7jg77_readme.txt"<br />
      Delete "$PROGRAMFILES\$var\uninst-7jg77skins.exe"<br />
      Delete "$PROGRAMFILES\$var\7-JG77 Black Eagles.url"<br />
      !insertmacro MUI_STARTMENU_DELETE_END<br />
      <br />
      If you do this above, remove the lines:<br />
      <br />
      ReadRegStr $0 HKLM "Software\Microsoft\Windows\CurrentVersion\Uninstall\${PGINST}" "NSIS:StartMenuDir" ;in Section Uninstall<br />
      <br />
      and<br />
      <br />
      CreateDirectory "$SMPROGRAMS\${MUI_STARTMENUPAGE_VARIABLE}" ;in Section "Full Installation"<br />
      <br />
      <b>4)</b>And a question: For what you want the Components Page if have only one section that is show?</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Tolwyn</span><br />
      <span class="post-time small text-muted">26th April 2003 18:47 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">For #4:<br />
      <br />
      The script isn't final yet.<br />
      There will be a choice to install 512x512 skins, 1024x1024 skins, Allied skins, Axis Skins, or all.<br />
      <br />
      Just haven't finished the sections yet.<br />
      <br />
      That reminds me...<br />
      Will the uninstaller know what to delete automatically depending upon the installation, or do I have to have different sections for the uninstaller, too?<br />
      <br />
      Is the uninstaller dynamically created based upon the installation?</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">deguix</span><br />
      <span class="post-time small text-muted">26th April 2003 19:04 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"></p>

      <blockquote>
        Is the uninstaller dynamically created based upon the installation?
      </blockquote>No. You have to put what files you want to remove, reg keys to delete...<br />
      <br />

      <blockquote>
        I have to have different sections for the uninstaller, too?
      </blockquote>You cannot have different sections for uninstall yet (planned to this version of NSIS, see TODO.txt in NSIS folder for "to do list").
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
      <span class="post-time small text-muted">27th April 2003 17:09 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Deguix, WriteIniStr works too. Open up a .url file and you'll see this inside of it.<br />
      <br />
      The uninstaller code is compiled ahead but the uninstaller itself is generated dynamically. The exe header is first written, then the precompiled datablock (along with the script, files, headers, etc.) and then the icons are replaced.<br />
      <br />
      Your problem with the uninstall is that $INSTDIR is wrong. $INSTDIR isn't transferred from the installer (unless you script it this way), instead the directory that the uninstaller is in is used as $INSTDIR.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Tolwyn</span><br />
      <span class="post-time small text-muted">28th April 2003 04:29 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Ok.<br />
      Kichik...<br />
      Based upon that information, where should the OUT path be for the uninstaller?</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
      <span class="post-time small text-muted">28th April 2003 14:11 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Wherever you want it to be as long as you make sure you have the right $INSTDIR. That means that if your installer's $INSTDIR is C:\instdir and you put the uninstaller in C:\instdir\uninstall\uninstaller.exe then you'll have to use GetParent to get the right $INSTDIR, or just use Delete ..\file.exe, etc.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Tolwyn</span><br />
      <span class="post-time small text-muted">28th April 2003 19:06 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Oh god my head hurts.</p>
    </div>
    <hr />

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]>
  </script>
</body>
</html>
