<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="How can I make this custom page" />

  <title>How can I make this custom page - NSIS Forums</title>
  <script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script>
  <!-- Bootstrap core CSS -->

  <link rel="stylesheet" type="text/css" href="//netdna.bootstrapcdn.com/bootswatch/3.0.1/readable/bootstrap.min.css" />
  <link rel="stylesheet" href="../css/style.css" type="text/css" /><!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!--[if lt IE 9]>
                <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
                <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->
</head>

<body>
  <div class="container">
    <!-- Put navigation bar here -->

    <ol class="breadcrumb">
      <li><a href="../index.html" class="glyphicon glyphicon-home"></a></li>

      <li><a href="f-65.html">NSIS Discussion</a></li>

      <li class="active">How can I make this custom page</li>
    </ol>

    <p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=219597">How can I make this custom page</a></p><br />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Sp33dy Gonzale$</span><br />
      <span class="post-time small text-muted">23rd June 2005 10:36 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>How can I make this custom page</strong><br />
      Hy I would make me an custom page for my Counter-Strike 1.6 Extension Pack. In this custom page the user should can choose with an File Dir an (how can I make it that he can only chose mp3-files ?) MP3-File who he can hear at the startmenu of counter-Strike 1.6.<br />
      <br />
      The File must be put in in $Installdir\cstrike\media<br />
      and it must be rename in gamestartup.mp3<br />
      <br />
      Could anybody help me ? I don't know what I must do.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
      <span class="post-time small text-muted">23rd June 2005 13:56 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Firstly, in the INI file for the FileRequest, you want:<br />
      Filter=MP3 Files|*.mp3<br />
      <br />
      To get the path selected, in the Page's Leave Function (set with Page pageFunc <b>pageLeaveFunc</b>), read the value from the INI file with MUI_INSTALLOPTIONS_READ.<br />
      Then, to move the file, do:<br />
      !insertmacro MUI_INSTALLOPTIONS_READ $R0 "ini_file.ini" "Field X" "State"<br />
      Rename "$INSTDIR\cstrike\media\gamestartup.mp3" "$INSTDIR\cstrike\media\gamestartup-old.mp3"<br />
      Rename "$R0" "$INSTDIR\cstrike\media\gamestartup.mp3"<br />
      <br />
      -Stu</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Sp33dy Gonzale$</span><br />
      <span class="post-time small text-muted">23rd June 2005 18:19 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Hy Afrow UK<br />
      you're very friendly and help me a lot.<br />
      <br />
      Thank you<br />
      <br />
      I've tried to make the Custom Page like you've write. But I think that I've make something wrong, because there comes always the Error:<br />
      <br />
      Error: resolving create-page function "PageMP3-File" in install pages<br />
      Note: uninstall functions must begin with "un.", and install functions must not<br />
      Error - aborting creation process<br />
      <br />
      <br />
      Could you help me to find what I've make wrong?<br />
      <br />
      Thank you</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
      <span class="post-time small text-muted">23rd June 2005 19:28 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Quite obviously, you're missing the PageMP3-File Function in your script.<br />
      <br />
      You need:<br />
      Function PageMP3-File<br />
      !insertmacro MUI_INSTALLOPTIONS_EXTRACT "MP3-File.ini"<br />
      !insertmacro MUI_INSTALLOPTIONS_DISPLAY "MP3-File.ini"<br />
      FunctionEnd<br />
      <br />
      -Stu</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Sp33dy Gonzale$</span><br />
      <span class="post-time small text-muted">24th June 2005 14:18 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Hy, thank you for the reply. I've added the function but there is still the same error.<br />
      <br />
      I write all the thing who I write in the .nsi in the following code.<br />
      <br />
      Is there something wrong?<br />
      <br /></p>
      <pre>
<code><br /><br />; ReserveFiles<br />ReserveFile "MP3-File.ini"<br /><br /><br /><br />; Pages<br />!insertmacro MUI_PAGE_WELCOME<br />!insertmacro MUI_PAGE_COMPONENTS<br />!insertmacro MUI_PAGE_DIRECTORY<br />!insertmacro MUI_PAGE_INSTFILES<br />Page custom PageMP3-File PageLeaveMP3-File<br />!insertmacro MUI_PAGE_FINISH<br /><br /><br />; Funtions<br />Function .onInit<br /><br />    !insertmacro MUI_INSTALLOPTIONS_EXTRACT "MP3-File.ini"<br />    <br />FunctionEnd<br /><br /><br />; Page MP3-File<br />Function PageMP3-File<br /><br />   <br />   !insertmacro MUI_HEADER_TEXT "MP3-File Einfügen" "Spielmenü Sound ändern"<br />   !insertmacro MUI_INSTALLOPTIONS_DISPLAY "MP3-File.ini"<br />   !insertmacro MUI_INSTALLOPTIONS_READ $R0 "MP3-File.ini" "Field 1" "FileRequest"<br />   Rename "$INSTDIR\cstrike\media\gamestartup.mp3" "$INSTDIR\cstrike\media\gamestartup-old.mp3"<br />   Rename "$R0" "$INSTDIR\cstrike\media\gamestartup.mp3"<br />   <br />FunctionEnd<br /><br /></code>
</pre>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
      <span class="post-time small text-muted">24th June 2005 19:58 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">You still need the Leave function present too!<br />
      Please read about the Page instruction syntax in the NSIS manual.<br /></p>
      <pre>
<code><br />; ReserveFiles<br />ReserveFile "MP3-File.ini"<br /><br />; Pages<br />!insertmacro MUI_PAGE_WELCOME<br />!insertmacro MUI_PAGE_COMPONENTS<br />!insertmacro MUI_PAGE_DIRECTORY<br />!insertmacro MUI_PAGE_INSTFILES<br />Page custom PageMP3-File PageLeaveMP3-File<br />!insertmacro MUI_PAGE_FINISH<br /><br />; Funtions<br />Function .onInit<br /><br />    !insertmacro MUI_INSTALLOPTIONS_EXTRACT "MP3-File.ini"<br />    <br />FunctionEnd<br /><br /><br />; Page MP3-File<br />Function PageMP3-File<br />   <br />   !insertmacro MUI_HEADER_TEXT "MP3-File Einfügen" "Spielmenü Sound ändern"<br />   !insertmacro MUI_INSTALLOPTIONS_DISPLAY "MP3-File.ini"<br />   <br />FunctionEnd<br /><br />Function PageLeaveMP3-File<br /><br />   !insertmacro MUI_INSTALLOPTIONS_READ $R0 "MP3-File.ini" "Field 1" "FileRequest"<br />   Rename "$INSTDIR\cstrike\media\gamestartup.mp3" "$INSTDIR\cstrike\media\gamestartup-old.mp3"<br />   Rename "$R0" "$INSTDIR\cstrike\media\gamestartup.mp3"<br />   <br />FunctionEnd<br /></code>
</pre><br />
      -Stu
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Sp33dy Gonzale$</span><br />
      <span class="post-time small text-muted">25th June 2005 17:49 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Hy thank you the error isn' come more. And the rename of gamestartup.mp3 in gamestartup.mp3 works too. But the transfer from the $R0 in $Installdir\cstrike\media<br />
      doesn't work I've test if it works when I writc<br />
      <br /></p>
      <pre>
<code><br />; Page Leave MP3-File<br />Function PageLeaveMP3-File<br /><br />   !insertmacro MUI_INSTALLOPTIONS_READ $R0 "MP3-File.ini" "Field 1" "FileRequest"<br />   Delete "$INSTDIR\cstrike\media\gamestartup.mp3"<br />   CreateDirectory $INSTDIR\cstrike\media<br />   CopyFiles /silent "$R0" "$INSTDIR\cstrike\media"<br />   Rename "$R0" "gamestartup.mp3"<br /><br />FunctionEnd<br /></code>
</pre><br />
      <br />
      But it isdn't work. What could I do?<br />
      <br />
      Thank you
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
      <span class="post-time small text-muted">25th June 2005 20:15 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Just do:<br />
      <br />
      Delete "$INSTDIR\cstrike\media\gamestartup.mp3"<br />
      CopyFiles /silent "$R0" "$INSTDIR\cstrike\media\gamestartup.mp3"<br />
      <br />
      -Stu</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Sp33dy Gonzale$</span><br />
      <span class="post-time small text-muted">25th June 2005 21:24 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Hy thank you for always answer me very friendly. I've make it now like you have write, but it doesn't works. The old gamestartup.mp3 is deleted but there isn't the new. Could it be that I must write something in the MP3-Page.ini ?<br />
      <br />
      This is it:<br />
      <br />
      [Settings]<br />
      NumFields=3<br />
      CancelEnabled=0<br />
      CancelShow=0<br />
      BackEnabled=0<br />
      <br />
      [Field 1]<br />
      Type=FileRequest<br />
      State=FileRequest<br />
      Left=30<br />
      Right=153<br />
      Top=27<br />
      Bottom=40<br />
      Filter=MP3 Files|*.mp3<br />
      <br />
      [Field 2]<br />
      Type=Label<br />
      Text=Wählen sie eine MP3-Audio Datei, die Sie im Spielmenü von Counter-Strike 1.6 hören wollen.<br />
      Left=4<br />
      Right=197<br />
      Top=2<br />
      Bottom=19<br />
      <br />
      [Field 3]<br />
      Type=Label<br />
      Text=Bei keiner wird die jetzige behalten<br />
      Left=37<br />
      Right=150<br />
      Top=44<br />
      Bottom=52</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
      <span class="post-time small text-muted">25th June 2005 22:21 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Perhaps you should add validation for this:<br />
      <br />
      !insertmacro MUI_INSTALLOPTIONS_READ $R0 "MP3-File.ini" "Field 1" "FileRequest"<br />
      StrCmp $R0 "" +2<br />
      IfFileExists $R0 +2<br />
      Abort<br />
      Delete "$INSTDIR\cstrike\media\gamestartup.mp3"<br />
      CopyFiles /silent "$R0" "$INSTDIR\cstrike\media\gamestartup.mp3"<br />
      <br />
      -Stu</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Sp33dy Gonzale$</span><br />
      <span class="post-time small text-muted">26th June 2005 18:00 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Mmh no it doesn't works. But thank you that you have help me.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
      <span class="post-time small text-muted">26th June 2005 18:07 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Ok, try:<br />
      CopyFiles /silent "$R0" "$INSTDIR\cstrike\media\*"<br />
      <br />
      -Stu</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Sp33dy Gonzale$</span><br />
      <span class="post-time small text-muted">26th June 2005 19:11 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Hy Afrow UK,<br />
      the code<br />
      <br />
      !insertmacro MUI_INSTALLOPTIONS_READ $R0 "MP3-File.ini" "Field 1" "FileRequest"<br />
      StrCmp $R0 "" +2<br />
      IfFileExists $R0 +2<br />
      Abort<br />
      Delete "$INSTDIR\cstrike\media\gamestartup.mp3"<br />
      CopyFiles /silent "$R0" "$INSTDIR\cstrike\media\gamestartup.mp3"<br />
      <br />
      <br />
      hasn't works so I've tested the Code<br />
      <br />
      CopyFiles /silent "$R0" "$INSTDIR\cstrike\media\*"<br />
      <br />
      with this code<br />
      <br />
      Function PageLeaveMP3-File<br />
      <br />
      !insertmacro MUI_INSTALLOPTIONS_READ $R0 "MP3-File.ini" "Field 1" "FileRequest"<br />
      Delete "$INSTDIR\cstrike\media\gamestartup.mp3"<br />
      CopyFiles /silent "$R0" "$INSTDIR\cstrike\media\*"<br />
      <br />
      FunctionEnd<br />
      <br />
      But it isn't works<br />
      <br />
      Thank you Sp33dy</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
      <span class="post-time small text-muted">26th June 2005 19:34 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">I don't see why it can't work, unless the $INSTDIR\cstrike\media folder does not exist. Plus you need the code I posted in case the user does not enter an MP3 file on the custom page (if that happens it will delete their gamestartup.mp3 and not replace it).<br />
      Just keep messing with CopyFiles. I can't help you any further because I can't see anything wrong with the code.<br />
      <br />
      -Stu</p>
    </div>
    <hr />

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]>
  </script>
</body>
</html>
