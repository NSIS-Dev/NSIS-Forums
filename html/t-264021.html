<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="description" content="How to hide Dos window? Help"><title>How to hide Dos window? Help - NSIS Forums</title><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script><link rel="preload" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css" as="style" onload="this.rel='stylesheet'"><link rel="preload" href="../css/style.css" as="style" onload="this.rel='stylesheet'"><noscript><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css"><link rel="stylesheet" href="../css/style.css"></noscript><script>!function(a){"use strict";var b=function(b,c,d){function e(a){return h.body?a():void setTimeout(function(){e(a)})}function f(){i.addEventListener&&i.removeEventListener("load",f),i.media=d||"all"}var g,h=a.document,i=h.createElement("link");if(c)g=c;else{var j=(h.body||h.getElementsByTagName("head")[0]).childNodes;g=j[j.length-1]}var k=h.styleSheets;i.rel="stylesheet",i.href=b,i.media="only x",e(function(){g.parentNode.insertBefore(i,c?g:g.nextSibling)});var l=function(a){for(var b=i.href,c=k.length;c--;)if(k[c].href===b)return a();setTimeout(function(){l(a)})};return i.addEventListener&&i.addEventListener("load",f),i.onloadcssdefined=l,l(f),i};"undefined"!=typeof exports?exports.loadCSS=b:a.loadCSS=b}("undefined"!=typeof global?global:this);!function(a){if(a.loadCSS){var b=loadCSS.relpreload={};if(b.support=function(){try{return a.document.createElement("link").relList.supports("preload")}catch(b){return!1}},b.poly=function(){for(var b=a.document.getElementsByTagName("link"),c=0;c<b.length;c++){var d=b[c];"preload"===d.rel&&"style"===d.getAttribute("as")&&(a.loadCSS(d.href,d,d.getAttribute("media")),d.rel=null)}},!b.support()){b.poly();var c=a.setInterval(b.poly,300);a.addEventListener&&a.addEventListener("load",function(){b.poly(),a.clearInterval(c)}),a.attachEvent&&a.attachEvent("onload",function(){a.clearInterval(c)})}}}(this);</script></head><body><div class="container"><ol class="breadcrumb"><li><a href="../index.html" class="glyphicon glyphicon-home"></a></li><li><a href="f-65.html">NSIS Discussion</a></li><li class="active">How to hide Dos window? Help</li></ol><p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=264021">How to hide Dos window? Help</a></p><br><div class="post"><p class="post-meta"><span class="post-author text-primary">JamesKiller</span><br><span class="post-time small text-muted">19th January 2007 18:52 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>How to hide Dos window? Help</strong><br>Hi,<br><br>I am a newbie of NSIS, when using NSIS, I encounter one problem about DOS black window.<br><br>After I install all the files, I have to run a window service so that my program can call this window service correctly. I use one function in .nsi file something like as follows:<br><br>Function StartService<br>Execwait "net start myServiceName"<br>FunctionEnd<br><br>However, it will show me a black Dos window, i really don't want the black window shows up! I tried to use .bat (Dos batch file)! Same thing!<br><br>Anybody has good suggestions to help me finish my project!<br><br>Thank you.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">kichik</span><br><span class="post-time small text-muted">19th January 2007 18:56 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Use <a href="http://nsis.sourceforge.net/Docs/nsExec/nsExec.txt" target="_blank">nsExec</a>. The <a href="http://nsis.sourceforge.net/Examples/nsExec/test.nsi" target="_blank">usage example</a> can also help.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Brummelchen</span><br><span class="post-time small text-muted">24th January 2007 06:23 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">nsexec is not perfect at all.<br><br>i actually work on a specific script wich starts makensis.exe<br>with nsexec - in most cases it work here, but on another computer<br>in most cases it fails.<br><br>app1 writes a script which is compiled to app2.<br>the script is fine but it isnt compiled - app2 is missing<br>or it contains no data to extract.<br><br>so i start to examine nsexec and found execdos:<br><a href="http://nsis.sourceforge.net/ExecDos_plug-in" target="_blank">http://nsis.sourceforge.net/ExecDos_plug-in</a><br><br>execdos produces no errors - app2 is created.<br><br>so i think nsexec has limitations with a dos box on a actual<br>windows xp - it doesnt wait.<br><br>you know makensis best...<br><br>btw i miss parameters for makensisw - are there any?<br>(need autoclose after execwait).</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">kichik</span><br><span class="post-time small text-muted">24th January 2007 09:26 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Care to elaborate, Brummelchen?</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Brummelchen</span><br><span class="post-time small text-muted">24th January 2007 15:55 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">huh?<br><br>in short again<br><br>- app1 -&gt; script for app2<br>- extract compiler (20 files only)<br>- compile script app2<br>- delete compiler<br><br>i think nsexec doesnt get that makensis hasnt finished<br>so parts of the compiler is deleted while makensis is<br>still working - so failure occurs - no app2.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">kichik</span><br><span class="post-time small text-muted">24th January 2007 15:57 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">I need details. nsExec has always worked fine for me. How and where exactly does it fail?</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Brummelchen</span><br><span class="post-time small text-muted">24th January 2007 15:59 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">see above pls - no app2 or no data in app2 (exe is fine)<br><br>the original script has around 1500 lines now and the created script is fine - no syntax error.<br><br>nsexec fails - execdos works</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">kichik</span><br><span class="post-time small text-muted">24th January 2007 16:04 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Did you make sure nsExec is the problem? Try adding a message box after nsExec returns and see if makensis has actually finished by then.<br><br>I need a way to reproduce this. The script would work best. A minimal version of it, if possible. All 1500 lines if not.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Brummelchen</span><br><span class="post-time small text-muted">24th January 2007 16:17 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">&gt;&gt; Did you make sure nsExec is the problem?<br><br>pretty sure - with a messagebox i get no failure ;)<br>(although the mbox only tells me, that i can grab the outputted<br>script &amp; exe for review - on the users computer same)<br><br>btw the essential part is half of the script - i am not<br>ready for "include" which m8 make it easier for me.<br><br>&gt;&gt; I need a way to reproduce this.<br><br>and i need mail P</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">kichik</span><br><span class="post-time small text-muted">24th January 2007 16:21 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><a href="mailto:kichik@users.sf.net">kichik@users.sf.net</a></p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Brummelchen</span><br><span class="post-time small text-muted">24th January 2007 16:30 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">on the way - you can delete the address now.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">kichik</span><br><span class="post-time small text-muted">24th January 2007 16:34 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">That's OK, let Spam Assassin handle whoever/whatever uses that. It's all over the web anyway. And even if it wasn't, spambots randomize user names anyway.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">JamesKiller</span><br><span class="post-time small text-muted">24th January 2007 20:16 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">nsExec:exec is working fine for me. Thank you for helping me out.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">kichik</span><br><span class="post-time small text-muted">24th January 2007 22:01 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Brummelchen, I still can't reproduce it. I can barely compile it, because of missing files, and then I can't run it because the browse buttons don't work and I can't read the text.<br><br>Can you add some more details on the other computer on which it doesn't work? Also, can you have nsExec run "cmd /C makensis ... &gt; some.log" instead of what it has now and paste the log?<br><br>One thing I did get from the script is the lack of Pop after nsExec. I don't see any important code after it, so the stack corruption shouldn't matter too much. But you should add it in case you'll add more code there.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Brummelchen</span><br><span class="post-time small text-muted">24th January 2007 22:11 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">thats why i added the compiled win-version ;)<br><br>plugins needed: md5, execdos, helpbutton (not really), IO, banner<br><br>&gt;&gt; on the other computer on which it doesn't work?<br><br>No, its far away. I only can get the script and the exe-file.<br>script is fine, but exe only contains header or it doesnt exist.<br>thats all i can barely say.<br>ok, some more i dont mind cause it is like mine:<br>windows xp sp2, nod32 (virusscanner) - meets mine ~70%<br>i have no details about the dos-box (-default.pif)<br><br>i only can say that a message box prevents the failure.<br>after that is the compiler deleted - much time to execute it properly</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">kichik</span><br><span class="post-time small text-muted">24th January 2007 22:25 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">But the compiled version is using ExecDos and not nsExec. And the missing files I'm talking about are not the plug-ins, although it would have been nicer if they were in the archive. There are other missing files including images, executables and header files.<br><br>I see now that the leave function is not the last code in the script after all. So the stack corruption can have an effect after all.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Brummelchen</span><br><span class="post-time small text-muted">24th January 2007 22:33 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">&gt;&gt; But the compiled version is using ExecDos and not nsExec<br><br>gna - right :/<br><br>&gt;&gt; that the leave function is not the last code in the script after all.<br><br>idd - after compiling it returns to the GUI or it quits.<br>it only has that ONE page - no need to go back/forward.<br>so that should be no problem - either the stack behaviour itself is buggy :D<br><br>too bad we cant meet this time.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">kichik</span><br><span class="post-time small text-muted">24th January 2007 22:37 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">There is a problem with the stack because you continue running code after nsExec returns. That code might be affected by the fact the stack doesn't contain what it expects.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Brummelchen</span><br><span class="post-time small text-muted">24th January 2007 22:45 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">hmm, then it is a stack problem - when i put something on the stack<br>and take it back in the right sequence - there cant be any problem!?</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">kichik</span><br><span class="post-time small text-muted">24th January 2007 22:50 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">There can be a problem if something puts another thing on the stack between the time you put the original value and between the time you expect to find that value. That's exactly what happens if you don't Pop nsExec's return value.<br><br>But that's just a problem. I doesn't have to be the problem. To pinpoint the problem I need more details and/or a way to reproduce this.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Brummelchen</span><br><span class="post-time small text-muted">24th January 2007 22:55 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">"nsExec::Exec" needs a pop?<br>i only can read that for the 2 other functions...</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">kichik</span><br><span class="post-time small text-muted">24th January 2007 23:02 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">They all need a Pop. They all return "error", "timeout" or the exit code.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Brummelchen</span><br><span class="post-time small text-muted">25th January 2007 02:41 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Then update the documentation pls...</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">kichik</span><br><span class="post-time small text-muted">25th January 2007 09:05 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">How would you make it clearer? The "return value" section doesn't mention anything about being ExecToStack and ExecToLog specific.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Brummelchen</span><br><span class="post-time small text-muted">25th January 2007 15:19 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">it doesnt help me in my case - but the example only contains<br>the 2 other functions of nsexec and they need pop.<br>"nsExec::Exec" is not discussed.<br>and the doc is also poor about a return value.<br>idd "nsExec::ExecToStack" hast 2 return values - so test.nsi<br>indicates for me that the first function needs NO additional POP.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">kichik</span><br><span class="post-time small text-muted">25th January 2007 15:24 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Fine, I updated test.nsi to include an example of nsExec::Exec as well. It Pops.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Brummelchen</span><br><span class="post-time small text-muted">25th January 2007 15:26 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Thank you - this m8 fix my special problem - i'll give it a try.</p></div><hr><div class="footer"><p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p></div></div><script src="../js/highlight.pack.js" type="text/javascript"></script><script type="text/javascript">//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]></script></body></html>