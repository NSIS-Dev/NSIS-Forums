<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="description" content="I'm trying to have an answer about two directories in one installer until two days !!"><title>I'm trying to have an answer about two directories in one installer until two days !! - NSIS Forums</title><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script><link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css"><link rel="stylesheet" href="../css/style.css" type="text/css"><!--[if lt IE 9]><script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script><script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script><![endif]--></head><body><div class="container"><ol class="breadcrumb"><li><a href="../index.html" class="glyphicon glyphicon-home"></a></li><li><a href="f-65.html">NSIS Discussion</a></li><li class="active">I'm trying to have an answer about two directories in one installer until two days !!</li></ol><p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=216268">I'm trying to have an answer about two directories in one installer until two days !!</a></p><br><div class="post"><p class="post-meta"><span class="post-author text-primary">emdiouf</span><br><span class="post-time small text-muted">17th May 2005 17:04 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>I'm trying to have an answer about two directories in one installer until two days !!</strong><br>Hi,<br>I'm waiting for your help about my question i posted until yesterday; it seems nobody wants to reply to me.<br>Thanks to have a look :<br><br>I'm trying to have in my installer two directories; one for my application and another for my database.<br>I have already posted but nobody answered me yet.<br>I have read in the archive this : <a href="http://nsis.sourceforge.net/archive....php?pageid=553" target="_blank">http://nsis.sourceforge.net/archive....php?pageid=553</a><br><br>That is not exactly what i want and i have adapted it:<br><br>Here is my code that you can test; for the instructions in the sections, i just display messages:<br><br>#begin of my code<br>!include "Sections.nsh"<br><br>Name Test<br>OutFile test.exe<br><br>Page components<br><br>Var ECITIZ_DIR<br>PageEx directory<br>DirText "Ceci installera l'Application"<br>DirVar $ECITIZ_DIR<br>PageCallbacks DirectoryAppliPre "" ""<br>PageExEnd<br><br>Var POSTGRES_DIR<br>PageEx directory<br>DirText "Ceci installera la Base de Données PostgreSQL \ dans le dossier suivant; pour l'installer dans un autre \ dossier,cliquez parcourir et choisissez un autre dossier. \ Cliquez suivant pour continuer." "Installation de \<br>la Base de Données PostgreSQL"<br>DirVar $POSTGRES_DIR<br>PageCallbacks DirectoryBDPre "" ""<br>PageExEnd<br><br>Page instfiles<br><br>!macro SiCocheAlorsVaA TMPVAR SECTION GOTO<br>SectionGetFlags ${SECTION} ${TMPVAR}<br>IntOp ${TMPVAR} ${TMPVAR} &amp; ${SF_SELECTED}<br>IntCmp ${TMPVAR} 1 ${GOTO} +1<br>!macroend<br><br>Function DirectoryAppliPre<br>Push $1<br>StrCpy $ECITIZ_DIR "c:\ecitiz"<br>!insertmacro SiCocheAlorsVaA $1 eCitiz afficherPageAppli<br>!insertmacro SiCocheAlorsVaA $1 examples afficherPageAppli<br>Pop $1<br>Abort<br><br>afficherPageAppli:<br><br>FunctionEnd<br><br>Function DirectoryBDPre<br>Push $1<br>StrCpy $ECITIZ_DIR "c:\postgres"<br>!insertmacro SiCocheAlorsVaA $1 bdd afficherPageDB<br><br>Abort<br><br>afficherPageDB:<br>Pop $1<br>FunctionEnd<br><br>SubSection "e-Citiz"<br>;sous-section d'installation du studio<br>Section "!e-Citiz Studio" eCitiz<br>SetOutPath $INSTDIR<br>MessageBox MB_OK "eCitiz"<br>SectionEnd<br><br>;Sous-section d'installation du bouquet<br>Section /o "!Exemples de Téléprocédures" examples<br>SetOutPath $INSTDIR<br>MessageBox MB_OK "examples"<br>SectionEnd<br><br>Section "!Raccourcis" short<br>MessageBox MB_OK "short"<br>SectionEnd<br><br>SubSectionEnd<br><br><br>SubSection "Base de données"<br># Sous-section d'installation de posgreSQL<br>Section "!PostgreSQL" bdd<br>MessageBox MB_OK "bdd"<br>SectionEnd<br>SubSectionEnd<br><br>SubSection "Adobe Acrobat Reader"<br># Sous-section d'installation de Acrobat Reader<br>Section /o "!Adobe Acrobat Reader" adobe<br>MessageBox MB_OK "adobe"<br>SectionEnd<br>SubSectionEnd<br><br>#end of my code<br><br>a°)What i would like to do:<br>1°)if and only if i select sections with index "eCitiz" or "examples", it displays the page to select the directory for the Application; in all other cases it must not display this page to select the directory for my Application.<br>2°)if and only if i select sections with index "bdd", it displays the page to select the directory for my Data Base; in all other cases it must not display this page to select the directory for my Data Base.<br><br>b°)How it works now :<br>1°)if i select sections with index "eCitiz" or "examples",and i click on next it starts executing instructions in sections "eCitiz" or "examples", without displaying the page to select the directory for the Application.<br>2°)if i select sections with index "bdd",and i clisk on next it starts executing instructions in sections "bdd" , without displaying the page to select the directory for the DataBase.<br><br>3°)if i select the three sections with index "eCitiz", "examples",and "short",and i click on next it displays first the page to select the directory for the Application, and after the page to select the directory for the DataBase even if i have not select the section "bdd"<br><br>4°)if i select the four sections with index "eCitiz", "examples","short",and "bdd",and i click on next, it displays first the page to select the directory for the Application, and after the page to select the directory for the Data Base ;before executing instructions in the sections (here all is rigth).<br><br>I think it is about the two functions "DirectoryAppliPre" and "DirectoryDBPre" or the macro "SiCocheAlorsVaA" ?<br>Is there a bug in NSIS ?<br>All seem to be logic in my code !!!<br>Can somebody tell me what is wrong ?<br><br>Thanks to have a look to my question !!<br><br>:) :)</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">restools</span><br><span class="post-time small text-muted">18th May 2005 13:21 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"></p><pre>
<code><font face="Courier New"><font color="#000000"><font color="#808080"><i>#begin of my code<br><br></i></font><font color="#008000">!include </font><font color="#4A9595">"Sections.nsh"<br><br></font><font color="#0000CC">Name </font>Test<br><font color="#0000CC">OutFile </font>test.exe<br><br><font color="#0000CC">Page </font><font color="#FF8040">components<br><br></font><font color="#0000CC">Var </font>ECITIZ_DIR<br><br><font color="#0000CC">PageEx </font><font color="#FF8040">directory<br>  </font><font color="#0000CC">DirText </font><font color="#4A9595">"Ceci installera l'Application"<br>  </font><font color="#0000CC">DirVar </font><font color="#800000">$ECITIZ_DIR<br>  </font><font color="#0000CC">PageCallbacks </font>DirectoryAppliPre <font color="#4A9595">"" ""<br></font><font color="#0000CC">PageExEnd<br><br>Var </font>POSTGRES_DIR<br><br><font color="#0000CC">PageEx </font><font color="#FF8040">directory<br>  </font><font color="#0000CC">DirText </font><font color="#4A9595">"Ceci installera la Base de Données PostgreSQL \ dans le dossier suivant; pour l'installer dans un autre \ dossier,cliquez parcourir et choisissez un autre dossier. \ Cliquez suivant pour continuer." "Installation de \<br>la Base de Données PostgreSQL"<br>  </font><font color="#0000CC">DirVar </font><font color="#800000">$POSTGRES_DIR<br>  </font><font color="#0000CC">PageCallbacks </font>DirectoryBDPre <font color="#4A9595">"" ""<br></font><font color="#0000CC">PageExEnd<br><br>Page </font><font color="#FF8040">instfiles<br><br></font><font color="#808080"><i>############ first: Section #################  notice<br><br></i></font><font color="#0000CC">SubSection </font><font color="#4A9595">"e-Citiz"<br>  </font><font color="#808080"><i>;sous-section d'installation du studio<br></i></font>  <font color="#0000CC">Section </font><font color="#4A9595">"!e-Citiz Studio" </font>eCitiz<br>    <font color="#0000CC">SetOutPath </font><font color="#800000">$INSTDIR<br>    </font><font color="#0000CC">MessageBox </font><font color="#FF8040">MB_OK </font><font color="#4A9595">"eCitiz"<br>  </font><font color="#0000CC">SectionEnd<br><br>  </font><font color="#808080"><i>;Sous-section d'installation du bouquet<br></i></font>  <font color="#0000CC">Section </font>/o <font color="#4A9595">"!Exemples de Téléprocédures" </font>examples<br>    <font color="#0000CC">SetOutPath </font><font color="#800000">$INSTDIR<br>    </font><font color="#0000CC">MessageBox </font><font color="#FF8040">MB_OK </font><font color="#4A9595">"examples"<br>  </font><font color="#0000CC">SectionEnd<br><br>  Section </font><font color="#4A9595">"!Raccourcis" </font>short<br>    <font color="#0000CC">MessageBox </font><font color="#FF8040">MB_OK </font><font color="#4A9595">"short"<br>  </font><font color="#0000CC">SectionEnd<br><br>SubSectionEnd<br><br><br>SubSection </font><font color="#4A9595">"Base de données"<br></font><font color="#808080"><i># Sous-section d'installation de posgreSQL<br></i></font>  <font color="#0000CC">Section </font><font color="#4A9595">"!PostgreSQL" </font>bdd<br>    <font color="#0000CC">MessageBox </font><font color="#FF8040">MB_OK </font><font color="#4A9595">"bdd"<br>  </font><font color="#0000CC">SectionEnd<br>SubSectionEnd<br><br>SubSection </font><font color="#4A9595">"Adobe Acrobat Reader"<br></font><font color="#808080"><i># Sous-section d'installation de Acrobat Reader<br></i></font>  <font color="#0000CC">Section </font>/o <font color="#4A9595">"!Adobe Acrobat Reader" </font>adobe<br>    <font color="#0000CC">MessageBox </font><font color="#FF8040">MB_OK </font><font color="#4A9595">"adobe"<br>  </font><font color="#0000CC">SectionEnd<br>SubSectionEnd<br><br></font><font color="#808080"><i>############## secondly: function ############## notice<br><br></i></font><font color="#008000">!macro </font>SiCocheAlorsVaA TMPVAR SECTION GOTO<br>  <font color="#0000CC">SectionGetFlags </font><font color="#800000">${${SECTION}} ${TMPVAR}    </font><font color="#808080"><i># &lt;&lt;&lt;&lt;&lt;&lt; advert:  "${${SECTION}}"<br></i></font>  <font color="#0000CC">IntOp </font><font color="#800000">${TMPVAR} ${TMPVAR} </font>&amp; <font color="#800000">${SF_SELECTED}<br>  </font><font color="#0000CC">IntCmp </font><font color="#800000">${TMPVAR} </font><font color="#008080">1 </font><font color="#800000">${GOTO} </font>+<font color="#008080">1<br></font><font color="#008000">!macroend<br><br></font><font color="#0000CC">Function </font>DirectoryAppliPre<br>  <font color="#0000CC">Push </font><font color="#800000">$1<br>  </font><font color="#0000CC">StrCpy </font><font color="#800000">$ECITIZ_DIR </font><font color="#4A9595">"c:\ecitiz"<br>  </font><font color="#008000">!insertmacro </font>SiCocheAlorsVaA <font color="#800000">$1 </font>eCitiz afficherPageAppli<br>  <font color="#008000">!insertmacro </font>SiCocheAlorsVaA <font color="#800000">$1 </font>examples afficherPageAppli<br>  <font color="#0000CC">Pop </font><font color="#800000">$1<br>  </font><font color="#0000CC">Abort<br><br>  </font>afficherPageAppli:<br><br><font color="#0000CC">FunctionEnd<br><br>Function </font>DirectoryBDPre<br>  <font color="#0000CC">Push </font><font color="#800000">$1<br>  </font><font color="#0000CC">StrCpy </font><font color="#800000">$ECITIZ_DIR </font><font color="#4A9595">"c:\postgres"<br>  </font><font color="#008000">!insertmacro </font>SiCocheAlorsVaA <font color="#800000">$1 </font>bdd afficherPageDB<br><br>  <font color="#0000CC">Abort<br><br>  </font>afficherPageDB:<br>    <font color="#0000CC">Pop </font><font color="#800000">$1<br></font><font color="#0000CC">FunctionEnd<br><br></font><font color="#808080"><i>#end of my code<br></i></font></font></font><br></code>
</pre>
    </div>
    <hr>

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]></script></body></html>