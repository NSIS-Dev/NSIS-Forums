<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="description" content="InstallDirRegKey bug?"><title>InstallDirRegKey bug? - NSIS Forums</title><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script><link rel="preload" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css" as="style" onload="this.rel='stylesheet'"><link rel="preload" href="../css/style.css" as="style" onload="this.rel='stylesheet'"><noscript><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css"><link rel="stylesheet" href="../css/style.css"></noscript><script>!function(a){"use strict";var b=function(b,c,d){function e(a){return h.body?a():void setTimeout(function(){e(a)})}function f(){i.addEventListener&&i.removeEventListener("load",f),i.media=d||"all"}var g,h=a.document,i=h.createElement("link");if(c)g=c;else{var j=(h.body||h.getElementsByTagName("head")[0]).childNodes;g=j[j.length-1]}var k=h.styleSheets;i.rel="stylesheet",i.href=b,i.media="only x",e(function(){g.parentNode.insertBefore(i,c?g:g.nextSibling)});var l=function(a){for(var b=i.href,c=k.length;c--;)if(k[c].href===b)return a();setTimeout(function(){l(a)})};return i.addEventListener&&i.addEventListener("load",f),i.onloadcssdefined=l,l(f),i};"undefined"!=typeof exports?exports.loadCSS=b:a.loadCSS=b}("undefined"!=typeof global?global:this);!function(a){if(a.loadCSS){var b=loadCSS.relpreload={};if(b.support=function(){try{return a.document.createElement("link").relList.supports("preload")}catch(b){return!1}},b.poly=function(){for(var b=a.document.getElementsByTagName("link"),c=0;c<b.length;c++){var d=b[c];"preload"===d.rel&&"style"===d.getAttribute("as")&&(a.loadCSS(d.href,d,d.getAttribute("media")),d.rel=null)}},!b.support()){b.poly();var c=a.setInterval(b.poly,300);a.addEventListener&&a.addEventListener("load",function(){b.poly(),a.clearInterval(c)}),a.attachEvent&&a.attachEvent("onload",function(){a.clearInterval(c)})}}}(this);</script></head><body><div class="container"><ol class="breadcrumb"><li><a href="../index.html" class="glyphicon glyphicon-home"></a></li><li><a href="f-65.html">NSIS Discussion</a></li><li class="active">InstallDirRegKey bug?</li></ol><p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=132113">InstallDirRegKey bug?</a></p><br><div class="post"><p class="post-meta"><span class="post-author text-primary">IGx89</span><br><span class="post-time small text-muted">17th April 2003 16:54 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>InstallDirRegKey bug?</strong><br>I'm trying to get NSIS 2.0b3 to save and recall the directory where my program was installed. I'm using the following line:<br></p><pre>
<code>InstallDirRegKey HKLM SOFTWARE\FLMM "Install_Dir"</code>
</pre><br>But for some reason, it doesn't work at all! In previous installers I've made it has worked, though that was when I was using v1.98.</div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">kichik</span><br><span class="post-time small text-muted">17th April 2003 17:07 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Works for me with the NSIS package installer. Are you sure the key is really there? Are you sure the string inside it is valid? Are you sure you are not overriding $INSTDIR somewhere?</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">psyke</span><br><span class="post-time small text-muted">17th April 2003 17:12 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Hey there IGx89,<br><br>I have experienced the same thing. I don't know whether this is a bug or this is how it's supposed to work now, but I got around it by manually setting the $OUTDIR var like so:<br></p><pre>
<code>SetOutPath</code><span style="color: #DD0000">"$INSTDIR"
</span>
</pre>It seems as if somethng like this:<pre>
<code>InstallDirRegKeyHKLMSOFTWAREFLMM</code><span style="color: #DD0000">"Install_Dir"
</span>
</pre>will initialize $INSTDIR (of course you may be using .onVerifyInstDir, etc. too)<br><br>But it seems to me as if those things (InstallDirRegKey, .onVerifyInstDir) set the $INSTDIR variable but not $OUTDIR which gets used by the File command.<br><br>So I just set $OUTDIR manually now, at some point when I'm <i>sure</i> that the $INSTDIR variable is valid.<br><br>Makes sense in a funny sorta way. ;) At least I hope it does.<br><br>edit: kichik is too fast. :o<br>kichik, I'll sit down and see for sure whether or not I need to set the $OUTDIR before I can start using File<br><br>edit again: I'm sorry. After re-reading IGx89's post, I think I may have understood his problem...<br><br>Salaam/Peace.</div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">IGx89</span><br><span class="post-time small text-muted">17th April 2003 17:14 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">I'm sure the key isn't there, because that isn't working :)<br>String inside it? You mean "Install_Dir"?<br><br>I'm also already calling "SetOutPath $INSTDIR" in my main section.<br><br>Here's my complete header code:<br><br>Name "Freelancer Mod Manager"<br>Caption "Freelancer Mod Manager"<br>OutFile FLMMInstaller.exe<br>InstallDir `$PROGRAMFILES\Freelancer Mod Manager`<br>InstallDirRegKey HKLM SOFTWARE\FLMM "Install_Dir"<br>DirText 'Directory selection'<br>XPStyle on<br>AutoCloseWindow false<br>SubCaption 0 " - Release Notes"<br>LicenseText "Freelancer Mod Manager release notes:" "Next &gt;"<br>LicenseData "D:\My Documents\Visual Studio Projects\FLInstaller\Release\Readme.txt"<br>ShowInstDetails show<br>SetDateSave on<br>InstProgressFlags smooth</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">kichik</span><br><span class="post-time small text-muted">17th April 2003 17:21 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">psyke, you always have to set $OUTDIR, with or without SetOutPath (that only adds creation of the directory and a nice output to the user) before File unless you specify a full output path using /oname=.<br><br>IGx89, what exactly do you mean by isn't working?</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">psyke</span><br><span class="post-time small text-muted">17th April 2003 17:22 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">kichik: thanks for the clarification. :)<br>while you were writing that post I looked through the NSIS examples and saw that they all do the 'SetOutPath $INSTDIR' thing - silly me. ;)</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">IGx89</span><br><span class="post-time small text-muted">17th April 2003 23:03 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">I mean that after a successful installation, the key "FLMM" doesn't exist under "HKLM\Software", thus signifying it didn't work. No matter how many times I refresh or reload regedit, it still doesn't show up. But, I noticed another key under HKLM\Software that a previous installer I made had made, that had Install_Dir in it! So, for some reason my old script works (I tested it with both b0 and b3; it worked both times) but the new one I've made doesn't. :(</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">kichik</span><br><span class="post-time small text-muted">18th April 2003 01:13 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">It's not automatically created, you have to create it yourself :)<br>Otherwise it can override important information such as the uninstaller path for example which can be used as the source for InstallDirRegKey. It's not a bug, it's a feature :p</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">IGx89</span><br><span class="post-time small text-muted">18th April 2003 02:22 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">DOH! I've been away from NSIS scripting too long; thanks :)<br><br>Btw, would anyone be interested in a NSIS script I made that retrieves component information from a text file on a web server? It's an auto-installer I made for Wulfram II (<a href="http://www.wulfram.com" target="_blank">http://www.wulfram.com</a>) that checks for new versions of components and downloads and installs them automatically. I haven't touched the script for a few months, so I figure that I might as well share it if anyone's interested :).</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">kichik</span><br><span class="post-time small text-muted">18th April 2003 10:09 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">You can create a page at <a href="http://nsis.sf.net/archive" target="_blank">the Archive</a> where everybody can find it - in the Real World Installers section. I'm sure anybody looking for a good example will find it useful.</p></div><hr><div class="footer"><p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p></div></div><script src="../js/highlight.pack.js" type="text/javascript"></script><script type="text/javascript">//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]></script></body></html>