<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="description" content="ReadRegStr maximum lenght?"><title>ReadRegStr maximum lenght? - NSIS Forums</title><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script><link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css"><link rel="stylesheet" href="../css/style.css" type="text/css"></head><body><div class="container"><ol class="breadcrumb"><li><a href="../index.html" class="glyphicon glyphicon-home"></a></li><li><a href="f-65.html">NSIS Discussion</a></li><li class="active">ReadRegStr maximum lenght?</li></ol><p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=343646">ReadRegStr maximum lenght?</a></p><br><div class="post"><p class="post-meta"><span class="post-author text-primary">MeRuud</span><br><span class="post-time small text-muted">29th March 2012 13:43 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>ReadRegStr maximum lenght?</strong><br>Dear all,<br><br>I am trying to add a check to see if the software is installed or not. If it is installed the installation should abort, if it is not installed the installation should continue as planned.<br><br>I currently have this:<br></p><blockquote>; Check to see if already installed<br>Section -Run<br>ReadRegStr $R0 HKLM SOFTWARE\Microsoft\Windows\CurrentVersion\Uninstall\{BF61699A-6D79-4A97-B879-7A890E5A9A48} InstallLocation<br>IfFileExists $R0 +1 NotInstalled<br>MessageBox MB_OK "Driver is already installed, installer will continue."<br>Quit<br><br>NotInstalled:<br>MessageBox MB_OK "Driver is not already installed, installer will continue."<br>Quit<br>SectionEnd</blockquote>This does not work, register (and its key value) is not recognized.. It simply says that it is not found (but it is definitly there)<br><br>However if I try:<br><blockquote>ReadRegStr $R0 HKLM SOFTWARE\Microsoft\Windows\CurrentVersion\ ProgramFilesDir</blockquote>or<br><blockquote>ReadRegStr $R0 HKLM SOFTWARE\Microsoft\Windows\CurrentVersion\Themes InstallTheme</blockquote>It does work properly.<br><br>I also tried:<br><blockquote>ReadRegStr $R0 HKLM SOFTWARE\Microsoft\Windows\CurrentVersion\Uninstall\AVG InstallLocation</blockquote>Which doesn't work either.<br><br>Is there a maximum lenght of the ReadRegStr? Can I only enter so many subfolders?<br><br>Thanks in advanced,<br>Ruud</div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br><span class="post-time small text-muted">29th March 2012 13:49 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">If there was a maximum length of 90 characters I'm sure you would have heard about it already, so no that is not your problem. Is it perhaps because you are running on Windows x64 and you haven't disabled registry redirection with SetRegView 64?<br><br>Stu</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">MeRuud</span><br><span class="post-time small text-muted">29th March 2012 13:58 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Thanks for your quick reply.<br><br>All my test computers are 32bit, so that can't be the problem.<br>I tried it so far on W7, Vista, and XP (all 32bit). - None seem to work.<br><br>Thanks for the help,<br>Ruud</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">MeRuud</span><br><span class="post-time small text-muted">29th March 2012 14:09 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Here is the full code, I'm currently using.. Maybe I am missing something (but then the others shouldn't work either, right?)<br><br></p><blockquote>; --- MUI 1.66 compatible<br>!include "MUI.nsh"<br><br>; --- General Information<br>Name "App Name"<br>BrandingText "App Branding Text"<br>OutFile "..\OutputFile.exe"<br>InstallDir "$TEMP\Folder"<br><br>; --- Define images and include pages<br>!define MUI_ABORTWARNING<br>!define MUI_WELCOMEFINISHPAGE_BITMAP "USB.bmp"<br>!define MUI_HEADERIMAGE<br>!define MUI_HEADERIMAGE_BITMAP "HEADER.bmp"<br>!insertmacro MUI_PAGE_WELCOME<br>!insertmacro MUI_PAGE_INSTFILES<br>!insertmacro MUI_LANGUAGE "English"<br>!insertmacro MUI_LANGUAGE "Dutch"<br><br>; --- Include Files<br>Section -Files<br>SetOutPath "$INSTDIR"<br>File "USB.bmp"<br>File "HEADER.bmp"<br>anotherFile<br>anotherFile<br>etc..<br>..<br>SectionEnd<br><br>; --- Check to see if already installed, then run<br>Section -Run<br>ReadRegStr $R0 HKLM "SOFTWARE\Microsoft\Windows\CurrentVersion\Uninstall\{BF61699A-6D79-4A97-B879-7A890E5A9A48}" "InstallLocation"<br>IfFileExists $R0 +1 NotInstalled<br>MessageBox MB_OK "Driver is already installed, installer will continue."<br>Quit<br><br>NotInstalled:<br>MessageBox MB_OK "Driver is not already installed, installer will continue."<br>Quit<br>SectionEnd</blockquote></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Anders</span><br><span class="post-time small text-muted">29th March 2012 15:27 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">The limit is probably 1024, try running Process Monitor see what the issue is</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">MeRuud</span><br><span class="post-time small text-muted">29th March 2012 15:48 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Thank you for your reply.<br><br>This is what Process Monitor says:<br></p><blockquote>RegOpenKey<br>HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Uninstall\{BF61699A-6D79-4A97-B879-7A890E5A9A48}<br>SUCCESS<br>Desired Access: Read<br><br>RegQueryValue<br>HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Uninstall\{BF61699A-6D79-4A97-B879-7A890E5A9A48}\InstallLocation<br>SUCCESS<br>Type: REG_SZ, Length: 98, Data: C:\Program Files\ProgramDir<br><br>RegQueryValue<br>HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Uninstall\{BF61699A-6D79-4A97-B879-7A890E5A9A48}\InstallLocation<br>SUCCESS<br>Type: REG_SZ, Length: 98, Data: C:\Program Files\ProgramDir<br><br>RegCloseKey<br>HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Uninstall\{BF61699A-6D79-4A97-B879-7A890E5A9A48}<br>SUCCESS<br><br>CreateFile C:\Program Files\ProgramDir<br>SUCCESS<br>Desired Access: Read Data/List Directory, Synchronize, Disposition: Open, Options: Directory, Synchronous IO Non-Alert, Attributes: n/a, ShareMode: Read, Write, Delete, AllocationSize: n/a, OpenResult: Opened<br><br>CloseFile C:\Program Files\ProgramDir<br>SUCCESS</blockquote>Then it continue with a lot of keyboard layouts..<br><br>So it seems like it actually does recognize / read the key.. But somehow my program does not recognize it?<br><br>Edit01:<br>Btw I changed the real program directory to ProgramDir. Thats why it shows "length: 98", its the length of the orignal program dir.</div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br><span class="post-time small text-muted">29th March 2012 17:36 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Check the read value with a MessageBox.<br><br>Edit: Is there a reason you call Quit in both cases? Is that on purpose?<br><br>Stu</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">pengyou</span><br><span class="post-time small text-muted">29th March 2012 17:43 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">The registry entry holds the name of the directory so you need to check that the directory exists:<br><br>IfFileExists "$R0\*.*" +1 NotInstalled<br><br>or else check that a particular file exists in that directory<br><br>IfFileExists "$R0\somefile.exe" +1 NotInstalled</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">MeRuud</span><br><span class="post-time small text-muted">30th March 2012 08:56 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Thank you guys for all the help.<br>Thank you pengyou, that seems to do the trick.<br><br></p><blockquote><small>Originally posted by Afrow UK</small><br>Is there a reason you call Quit in both cases? Is that on purpose?</blockquote>Currently this how my code will look. I used the message-boxes to test if the function works, now I substituted them to run an .exe<br><br><blockquote>; --- Check to see if already installed<br>Section -Run<br>ReadRegStr $R0 HKLM SOFTWARE\Microsoft\Windows\CurrentVersion\Uninstall\{BF61699A-6D79-4A97-B879-7A890E5A9A48} InstallLocation<br>IfFileExists "$R0\*.*" +1 NotInstalled<br>ExecWait "$INSTDIR\InstallAll\Setup.exe"<br>SetAutoClose true<br>Quit<br><br>NotInstalled:<br>ExecWait "$INSTDIR\install.exe"<br>SetAutoClose true<br>Quit<br>SectionEnd</blockquote>I tested it without calling "Quit", but then the code automatically continues to NotInstalled.<br><blockquote>Installer detects software is already installed.<br>Starts running InstallAll\Setup.exe<br>InstallAll\Setup.exe is finished<br>Automatically continue and start running NotInstalled (thus running install.exe).</blockquote>But all I need now is, if already installed run programA.. if not installed run programB.<br>The docs doesn't say "Quit" is needed, so this issue might occur due to my lack of experience with NSIS. Am I missing something?<br><br>Thanks,<br>Ruud</div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br><span class="post-time small text-muted">30th March 2012 11:55 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">If you need to Quit your installation after then that is fine. You could also just use LogicLib:</p><pre>
<code>${If} ${FileExists} $R0\*.*<br>...<br>${Else}<br>...<br>${EndIf}<br>SetAutoClose true<br>Quit</code>
</pre>Stu
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">MeRuud</span><br>
      <span class="post-time small text-muted">30th March 2012 16:02 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Hi guys...<br>
      Thanks for all the help, but I might have replied a bit to early.<br>
      <br>
      It is still not working probably, the following is going on:<br>
      <br>
      If using:<br></p>
      <pre>
<code>${If} ${FileExists} $R0\*.*<br>or<br>IfFileExists "$R0\*.*" +1 NotInstalled</code>
</pre><br>
      It always runs programB (the program that runs when nothing is detected)<br>
      <br>
      If using:<br>
      <pre>
<code>${If} ${FileExists} $R0<br>or<br>IfFileExists "$R0" +1 NotInstalled</code>
</pre><br>
      It always runs programA (the program that runs when something is detected)<br>
      <br>
      Currently my code looks like this (Thanks to the suggestion of Afrow UK)<br>
      <pre>
<code>; --- Check to see if already installed<br>Section -Run<br>  ReadRegStr $R0 HKLM SOFTWARE\Microsoft\Windows\CurrentVersion\Uninstall\{BF61699A-6D79-4A97-B879-7A890E5A9A48} InstallLocation<br>${If} ${FileExists} $R0\*.*<br>  ExecWait "$INSTDIR\programA\Setup.exe"<br>${Else}<br>  ExecWait "$INSTDIR\programB\install.exe"<br>${EndIf}<br>SetAutoClose true<br>Quit<br>SectionEnd<br></code>
</pre><br>
      <br>
      Maybe I should go for reading a different registry entry? I tried "UninstallString", which generates similair results.<br>
      <br>
      Thanks,<br>
      Ruud
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br>
      <span class="post-time small text-muted">30th March 2012 17:48 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">What is the stored value?<br>
      <br>
      Stu</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">MeRuud</span><br>
      <span class="post-time small text-muted">2nd April 2012 10:15 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Thanks for your help Afrow UK.<br>
      <br>
      Here is a screen of the whole register:<br>
      <a href="http://www.uploadup.com/pt-4W8F.html" target="_blank"></a><a href="http://www.uploadup.com/dt-4W8F.jpg" target="_blank">http://www.uploadup.com/dt-4W8F.jpg</a></p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">MeRuud</span><br>
      <span class="post-time small text-muted">2nd April 2012 10:20 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">I submitted a post a few seconds ago with a screen of the register, but this one has to be moderated so here is a quick overview:<br></p>

      <blockquote>
        DisplayName --- REG_SZ --- 32bit Driver Install<br>
        InstallLocation --- REG_SZ --- C:\Program Files\ ..<br>
        InstallSource --- REG_SZ --- E:\Autoinstall\..<br>
        UninstallString --- REG_EXPAND_SZ --- MsiExec.exe /I..
      </blockquote>Again when using "$R0\*.*" or using "$R0" it claims always to be installed (or not installed).<br>
      <br>
      I added a function to check if its 32 or 64 bit, (which seems to properly function - not tested on 64bit yet), here is the full code:<br>
      <br>
      <pre>
<code>; --- Install to the correct directory on 32 bit or 64 bit machines. <br>Section -Run<br>IfFileExists $WINDIR\SYSWOW64\*.* Is64bit Is32bit<br>Is32bit:<br>     MessageBox MB_OK  "32 bit"<br>     SetRegView 32<br>     GOTO Installation32Bit<br><br>Is64bit:<br>     MessageBox MB_OK  "64 bit"<br>     SetRegView 64<br>     GOTO Installation64Bit<br><br>; --- Check to see if already installed, then run install.<br>Installation32Bit:<br>     ReadRegStr $R0 HKLM SOFTWARE\Microsoft\Windows\CurrentVersion\Uninstall\{32bit} UninstallString<br>     IfFileExists "$R0\*.*" Is32Installed Is32NotInstalled<br>        Is32NotInstalled:<br>                MessageBox MB_OK  "Not Installed"<br>                ExecWait "$INSTDIR\SoftwareA\install.exe"<br>                SetAutoClose true<br>                GOTO End32Bitvs64BitCheck<br>        Is32Installed:<br>                MessageBox MB_OK  "Installed"<br>                ExecWait "$INSTDIR\SoftwareB\Setup.exe"<br>                SetAutoClose true<br>                GOTO End32Bitvs64BitCheck<br><br>Installation64Bit:<br>     ReadRegStr $R1 HKLM SOFTWARE\Microsoft\Windows\CurrentVersion\Uninstall\{64bit} UninstallString<br>     IfFileExists "$R1\*.*" Is64Installed Is64NotInstalled<br>        Is64NotInstalled:<br>                MessageBox MB_OK  "Not Installed"<br>                ExecWait "$INSTDIR\SoftwareA\install.exe"<br>                SetAutoClose true<br>                GOTO End32Bitvs64BitCheck<br>        Is64Installed:<br>                MessageBox MB_OK  "Installed"<br>                ExecWait "$INSTDIR\SoftwareB\Setup.exe"<br>                SetAutoClose true<br>                GOTO End32Bitvs64BitCheck<br><br>; --- When finished quit.<br>End32Bitvs64BitCheck:<br>     Quit<br>SectionEnd</code>
</pre><br>
      <br>
      The code above always claims that the softare is installed.<br>
      UninstallString or InstallLocation generate same, incorrect, results (both using "$R0\*.*" or using "$R0").<br>
      <br>
      Note:<br>
      I changed the string in the above code for the registry-entry, so the post doesn't rip open the forum design. If needed, here they are:<br>
      {32bit} = {BF61699A-6D79-4A97-B879-7A890E5A9A48}<br>
      {64bit} = {51C64AFF-0180-47E0-A535-2D99EBC10F09}
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br>
      <span class="post-time small text-muted">2nd April 2012 12:17 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">When I asked what the value was I meant what is the path stored. Put in a MessageBox to display the value of $R0. I didn't want a screenshot from the registry editor! Plus you have blanked out half the values so it's not much help to us anyway!<br>
      <br>
      As for 32/64 you should use the macro in x64.nsh (${If} ${RunningX64}). Also you need to use SetRegView 64 if the registry key isn't under Wow6432Node on 64-bit Windows (this has no effect/is ignored on 32-bit Windows).<br>
      <br>
      There are only two possible reasons that your code isn't working:<br>
      1. The path is wrong<br>
      2. The path has no read access<br>
      <br>
      Does the path end with a backstroke? Does it have any whitespace on the end? Can you open up cmd and cd to the directory it specifies?<br>
      <br>
      Stu</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">MeRuud</span><br>
      <span class="post-time small text-muted">2nd April 2012 12:39 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">I only blanked out 4 values (the one with the line through it), the rest are all empty.<br>
      <br>
      Full path (direct copy-paste from the registry):<br>
      HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Uninstall\{BF61699A-6D79-4A97-B879-7A890E5A9A48}<br>
      <br>
      $RO - doesn't print anything.<br>
      But using the following it does work / does print something..<br>
      ReadRegStr $R0 HKLM SOFTWARE\Microsoft\Windows\CurrentVersion\<br>
      ReadRegStr $R0 HKLM SOFTWARE\Microsoft\Windows\CurrentVersion\Themes<br>
      <br>
      Using the following (doesn't matter what inside it) doesn't work..<br>
      ReadRegStr $R0 HKLM SOFTWARE\Microsoft\Windows\CurrentVersion\Uninstall\<br>
      <br>
      Thats why my initial quetion about path length.<br>
      But it might be something with permissions; Do I need special permission to acces the Uninstall path? How can I check for read access?<br>
      <br>
      Reg-Values<br></p>

      <blockquote>
        DisplayName --- REG_SZ --- Driver 32bit Driver Install<br>
        InstallLocation --- REG_SZ --- C:\Program Files\Driver\<br>
        InstallSource --- REG_SZ --- E:\Autoinstall\Driver\<br>
        UninstallString --- REG_EXPAND_SZ --- MsiExec.exe /I{BF61699A-6D79-4A97-B879-7A890E5A9A48}
      </blockquote>ProcessMonitor<br>
      -- When computer with program NOT installed<br>

      <blockquote>
        RegOpenKey<br>
        HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Uninstall\{BF61699A-6D79-4A97-B879-7A890E5A9A48}<br>
        NAME NOT FOUND<br>
        Desired Access: Read
      </blockquote>-- When computer with program installed<br>

      <blockquote>
        RegOpenKey<br>
        HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Uninstall\{BF61699A-6D79-4A97-B879-7A890E5A9A48}<br>
        SUCCESS<br>
        Desired Access: Read<br>
        <br>
        RegQueryValue<br>
        HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Uninstall\{BF61699A-6D79-4A97-B879-7A890E5A9A48}\UninstallString<br>
        SUCCESS<br>
        Type: REG_EXPAND_SZ, Length: 106, Data: MsiExec.exe /I{BF61699A-6D79-4A97-B879-7A890E5A9A48}<br>
        <br>
        RegQueryValue<br>
        HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Uninstall\{BF61699A-6D79-4A97-B879-7A890E5A9A48}\UninstallString SUCCESS Type: REG_EXPAND_SZ, Length: 106, Data: MsiExec.exe /I{BF61699A-6D79-4A97-B879-7A890E5A9A48}<br>
        <br>
        RegCloseKey<br>
        HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Uninstall\{BF61699A-6D79-4A97-B879-7A890E5A9A48}<br>
        SUCCESS<br>
        <br>
        CreateFile C:\Users\User\AppData\Local\Temp\Driver\x86\x86Inf\i386\MsiExec.exe \I{BF61699A-6D79-4A97-B879-7A890E5A9A48}\<br>
        PATH NOT FOUND<br>
        Desired Access: Read Data/List Directory, Synchronize, Disposition: Open, Options: Directory, Synchronous IO Non-Alert, Attributes: n/a, ShareMode: Read, Write, Delete, AllocationSize: n/a
      </blockquote>So it seems like it is working properly according to process monitor.<br>
      But why does it try to create a file at the UnistallString? It only has to check if the value exist or not, right?<br>
      <br>
      EDIT01:<br>

      <blockquote>
        <small>Originally posted by Afrow UK</small><br>
        Can you open up cmd and cd to the directory it specifies?
      </blockquote>Haven't tried this, about to try it.
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">MeRuud</span><br>
      <span class="post-time small text-muted">2nd April 2012 13:19 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><b>UPDATE - SOLVED</b><br>
      So my findings conclude that in this case "CreateFile" is the issue.<br>
      "CreateFile" seems to be creating a temp file to check if folder really exist.<br></p>
      <pre>
<code>ReadRegStr $R0 HKLM SOFTWARE\Microsoft\Windows\CurrentVersion\Uninstall\etc.. REGISTRYKEY<br>     IfFileExists "$R1\*.*" Installed NotInstalled<br>        NotInstalled:<br>                MessageBox MB_OK  "Not Installed"<br>                GOTO EndInstall<br>        Installed:<br>                MessageBox MB_OK  "Installed"<br>                GOTO EndInstall</code>
</pre><br>

      <blockquote>
        The following happens when using "InstallLocation:<br>
        1. It read the registry, trying to find the key you identified<br>
        2. It stores the value into a string<br>
        3. It reads the string<br>
        4.a Is there a value in the string? Yes continue 5a<br>
        4.b No value in string? Continue 5b<br>
        5.a. Create a temp file at location of string.<br>
        SUCCES! Go to "Installed".<br>
        5.b. Create a temp file at C:/.<br>
        SUCCES! Go to "Installed".
      </blockquote>

      <blockquote>
        The following happens when using "UninstallString:<br>
        1. It read the registry, trying to find the key you identified<br>
        2. It stores the value into a string<br>
        3. It reads the string<br>
        4.a Is there a value in the string? Yes continue 5a<br>
        4.b No value in string? Continue 5b<br>
        5.a. Can't access temp folder, can't create a temp file.<br>
        FAIL! Go to "NotInstalled"<br>
        5.b. No file to access, can't create a temp file.<br>
        FAIL! Go to "NotInstalled"
      </blockquote>First it tries to find the path gathered from the registry string. Then it tries to create a temp file in that path. This seems to defeat the whole purpose of "IfFileExist". (The fact that the folder exist doesn't necessarily mean that it should be accessible / wirable).<br>
      <br>
      I'm using the following code, which seems to be doing the trick:<br>
      <pre>
<code>ReadRegStr $R0 HKLM SOFTWARE\Microsoft\Windows\CurrentVersion\Uninstall\etc.. REGISTRYKEY<br>        ${If} $R0 == "Value of REGISTRYKEY"<br>                MessageBox MB_OK  "Program Installed"<br>                GOTO EndInstall<br>        ${Else}<br>                MessageBox MB_OK  "Program Not Installed"<br>                GOTO EndInstall<br>        ${EndIf}<br>${EndIf}</code>
</pre><br>

      <blockquote>
        The following happens when using this:<br>
        1. It read the registry, trying to find the key you identified<br>
        2. It stores the value into a string<br>
        3. It reads the string<br>
        4.a Is string equal to required value? Yes<br>
        Display Box<br>
        4.b Is string equal to required value? No<br>
        Display Box
      </blockquote>I am not sure if this is the right way to do it, but it does work.<br>
      This will not work if you don't know the value of they key, or the key is not static.
    </div>
    <hr>

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]></script></body></html>