<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="Select and execute files from a directory" />

  <title>Select and execute files from a directory - NSIS Forums</title><!-- Bootstrap core CSS -->
  <link rel="stylesheet" type="text/css" href="//netdna.bootstrapcdn.com/bootswatch/3.0.1/readable/bootstrap.min.css" />
  <link rel="stylesheet" href="../css/style.css" type="text/css" /><!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!--[if lt IE 9]>
                <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
                <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->
</head>

<body>
  <div class="container">
    <!-- Put navigation bar here -->

    <ol class="breadcrumb">
      <li><a href="../index.html" class="glyphicon glyphicon-home"></a></li>

      <li><a href="f-65.html">NSIS Discussion</a></li>

      <li class="active">Select and execute files from a directory</li>
    </ol>

    <p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=321005">Select and execute files from a directory</a></p><br />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Avvoltoio</span><br />
      <span class="post-time small text-muted">21st July 2010 13:36 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>Select and execute files from a directory</strong><br />
      Hi<br />
      <br />
      I want to do an installer, but i don't know a good solution for some problem. I want to make an installer which get the executable files from a directory next to the installer, what is named "Plugins", and i want it to show that plugins in the components page, the names on the components page would be the executable file names.<br />
      <br />
      My problems: i don't know how to read the file list of a directory, but if it is not possible, i can generate a ini file what the installer will read for the files, so this is not a big deal.<br />
      <br />
      Main problem: on the components page i only can show the section names, and i would enerate sections only when i compile the script, not in runtime.<br />
      If there is no solution for this, can i make a custom page what is very similar to component page?<br />
      <br />
      Thanks every help, and sorry for my bad English.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
      <span class="post-time small text-muted">21st July 2010 13:49 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">You can enumerate the plugins using FindFirst, FindNext and FindClose. You cannot dynamically add sections in NSIS so you will need to create a custom page with your executable list using nsDialogs.<br />
      <br />
      Stu</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">MSG</span><br />
      <span class="post-time small text-muted">21st July 2010 14:03 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">As far as I know sections are defined at compile time, so I don't think there's a way to populate the Components Page's sections list depending on what 'plugins' exist next to the installer. That is assuming of course that you want to do this at runtime. One workaround you can use is create 50 hidden (and disabled) sections, and during runtime enumerate all plugin filenames and rename and un-hide one section for every plugin.<br />
      <br />
      You could also create a fake components page using nsDialogs, and add one fake section for every plugin, but I doubt if that's going to be easier.<br />
      <br />
      <br />
      If you want to populate the list at compile time you can use a vbs script or something to enumerate all plugin filenames and use them to write to an nsh file which you can then !include. There's a post somewhere in these forums that explains how to execute a vbs script during installer compilation.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Avvoltoio</span><br />
      <span class="post-time small text-muted">22nd July 2010 09:57 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>Thanks</strong><br />
      Thanks for the replies :)<br />
      Now i can continue make the installer whith this help :)</p>
    </div>
    <hr />

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]>
  </script>
</body>
</html>
