<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="compiling makensis binary on Linux 64-bit OS" />

  <title>compiling makensis binary on Linux 64-bit OS - NSIS Forums</title>
  <script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script>
  <!-- Bootstrap core CSS -->

  <link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css" />
  <link rel="stylesheet" href="../css/style.css" type="text/css" /><!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!--[if lt IE 9]>
                <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
                <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->
</head>

<body>
  <div class="container">
    <!-- Put navigation bar here -->

    <ol class="breadcrumb">
      <li><a href="../index.html" class="glyphicon glyphicon-home"></a></li>

      <li><a href="f-65.html">NSIS Discussion</a></li>

      <li class="active">compiling makensis binary on Linux 64-bit OS</li>
    </ol>

    <p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=278544">compiling makensis binary on Linux 64-bit OS</a></p><br />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">cyrustransform</span><br />
      <span class="post-time small text-muted">9th October 2007 22:07 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>compiling makensis binary on Linux 64-bit OS</strong><br />
      I have been attempting to get the makensis binary to compile on a Linux 64-bit (Fedora Core 7) operating system with no success. I have not found any posts in these forums or any others regarding similar problems so its time to post. Is it possible to compile the makensis binary on x64 architecture? If so what am I doing wrong or what do I need to change to make it work?<br />
      <br />
      # uname -a<br />
      Linux buildserver10 2.6.22.9-91.fc7 #1 SMP Thu Sep 27 20:47:39 EDT 2007 x86_64 x86_64 x86_64 GNU/Linux<br />
      <br />
      # scons --version<br />
      SCons by Steven Knight et al.:<br />
      script: v0.96.93.D001, 2006/11/06 08:31:54, by knight on roxbury<br />
      engine: v0.96.93.D001, 2006/11/06 08:31:54, by knight on roxbury<br />
      <br />
      # gcc -v<br />
      Using built-in specs.<br />
      Target: x86_64-redhat-linux<br />
      Configured with: ../configure --prefix=/usr --mandir=/usr/share/man --infodir=/usr/share/info --enable-shared --enable-threads=posix --enable-checking=release --with-system-zlib --enable-__cxa_atexit --disable-libunwind-exceptions --enable-languages=c,c++,objc,obj-c++,java,fortran,ada --enable-java-awt=gtk --disable-dssi --enable-plugin --with-java-home=/usr/lib/jvm/java-1.5.0-gcj-1.5.0.0/jre --enable-libgcj-multifile --enable-java-maintainer-mode --with-ecj-jar=/usr/share/java/eclipse-ecj.jar --with-cpu=generic --host=x86_64-redhat-linux<br />
      Thread model: posix<br />
      gcc version 4.1.2 20070925 (Red Hat 4.1.2-27)<br />
      <br />
      # python --version<br />
      Python 2.5<br />
      <br />
      I extracted the file nsis-2.31-src.tar.bz2 to /buildsystem/tools/nsis-2.31-src<br />
      <br />
      Then executed the following command<br />
      # scons SKIPSTUBS=all SKIPPLUGINS=all SKIPUTILS=all SKIPMISC=all NSIS_CONFIG_CONST_DATA_PATH=no PREFIX=/buildsystem/tools/nsis-2.31-src<br />
      <br />
      I have included the full output from the above command in the scons-output.txt file attached to this topic.<br />
      <br />
      The problem I'm running into starts with<br />
      /usr/bin/ld: warning: i386 architecture of input file `build/release/makensis/build.o' is incompatible with i386:x86-64 output</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
      <span class="post-time small text-muted">9th October 2007 23:24 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">The incompatible output warnings seem to come from the lack of -m32 in the linkage. That should be automatically added by the configuration, but yours is cached to not use it. Add <i>--cache=force</i> to your scons call line and attach config.log.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">cyrustransform</span><br />
      <span class="post-time small text-muted">10th October 2007 21:54 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Thank you for the reply. I used --cache-force. It still failed. I deleted my nsis-2.31-src directory, extracted the source download and copied it back over to make sure there wasn't anything left behind that could cause issues. This is the command I ended up running.<br />
      <br />
      # scons SKIPSTUBS=all SKIPPLUGINS=all SKIPUTILS=all SKIPMISC=all NSIS_CONFIG_CONST_DATA_PATH=no PREFIX=/buildsystem/tools/nsis-2.31-src --cache-force<br />
      <br />
      Attached is my config.log</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
      <span class="post-time small text-muted">10th October 2007 23:52 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">It's actually --config<b>=</b>force with an equality sign. But cleaning out the entire directory did the same trick. It was not meant to solve the problem, just show it in config.log, and I think it did. ld hits a segfault when testing for -m32. While strictly speaking it should be considered as a gcc bug, I'd guess testing for -m32 in the compiler prior to checking for it in the linker should solve it. In SCons/Config/gnu try replacing lines 88 and 89.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">cyrustransform</span><br />
      <span class="post-time small text-muted">11th October 2007 01:40 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">I get the following output when I use the = instead of the - in --cache=force. That's why I ended up using --cache-force instead. I thought it was because you are using a newer version of scons but I upgraded to v0.97.D001 and it still does the same thing.<br />
      <br />
      # scons SKIPSTUBS=all SKIPPLUGINS=all SKIPUTILS=all SKIPMISC=all NSIS_CONFIG_CONST_DATA_PATH=no PREFIX=/buildsystem/tools/nsi<br />
      s-2.31-src --cache=force<br />
      usage: scons [OPTION] [TARGET] ...<br />
      <br />
      SCons error: ambiguous option: --cache (--cache-disable, --cache-show, --cache-populate, --cache-debug, --cache-force?)<br />
      <br />
      <br />
      Anyway... Moving on to the good stuff. As you suggested above, I moved line 88--&gt;89 and 89--&gt;88 in nsis-2.31-src/SCons/Config/gnu and I got the result "scons: done building targets." I now have the nsis-2.31-src/build/release/makensis/makensis binary.<br />
      <br />
      Thank you very much! PROBLEM SOLVED.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
      <span class="post-time small text-muted">14th October 2007 22:26 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Weird... Maybe the equality sign is used only on Windows.<br />
      <br />
      Anyway, I've fixed this for the next version of NSIS. You might also want to report this to gcc. It shouldn't segfault.</p>
    </div>
    <hr />

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]>
  </script>
</body>
</html>
