<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="Question about Message Boxes" />

  <title>Question about Message Boxes - NSIS Forums</title><!-- Bootstrap core CSS -->
  <link rel="stylesheet" type="text/css" href="//netdna.bootstrapcdn.com/bootswatch/3.0.1/readable/bootstrap.min.css" />
  <link rel="stylesheet" href="../css/style.css" type="text/css" /><!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!--[if lt IE 9]>
                <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
                <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->
</head>

<body>
  <div class="container">
    <!-- Put navigation bar here -->

    <ol class="breadcrumb">
      <li><a href="../index.html" class="glyphicon glyphicon-home"></a></li>

      <li><a href="f-65.html">NSIS Discussion</a></li>

      <li class="active">Question about Message Boxes</li>
    </ol>

    <p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=328937">Question about Message Boxes</a></p><br />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">TehMuffinMan</span><br />
      <span class="post-time small text-muted">26th March 2011 05:39 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>Question about Message Boxes</strong><br />
      Howdy folks! Brand new here... :)<br />
      <br />
      I am wondering if there is an alternative to being forced to use gotos and labels as the result of buttons in a message box. Instead of using labels I would like to set some flags or something similar. I have been a developer for many years and the thought of using gotos makes me cringe a little bit haha! I am using a MB_YESNOCANCEL message box and once the flags are set I would do some logic on them via LogicLib.nsh.<br />
      <br />
      Thanks for any info!</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">pengyou</span><br />
      <span class="post-time small text-muted">26th March 2011 11:36 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Try reading the manual and the example scripts supplied with NSIS.<br />
      <br />
      Here is a simple example to get you started:<br /></p>
      <pre>
<span style="color: #007700">!include</span><span style="color: #DD0000">"LogicLib.nsh"
<br /><br /></span><span style="color: #0000BB">Name</span><span style="color: #DD0000">"Demo"
<br /></span><span style="color: #0000BB">OutFiledemo</span><span style="color: #007700">.</span><span style="color: #0000BB">exe
<br /><br />RequestExecutionLevel</span><span style="color: #DD0000">"user"
<br /><br /></span><span style="color: #0000BB">ShowInstDetailsshow
<br /><br />Section</span><span style="color: #007700">default
<br /><br />${If}${</span><span style="color: #0000BB">Cmd</span><span style="color: #007700">}`</span><span style="color: #0000BB">MessageBoxMB_YESNO|MB_ICONQUESTION'DisplayMAKENSIShelp?'IDYES</span><span style="color: #007700">`
<br /></span><span style="color: #0000BB">DetailPrint</span><span style="color: #DD0000">"MAKENSISHelp:"
<br /></span><span style="color: #0000BB">DetailPrint</span><span style="color: #DD0000">""
<br /></span><span style="color: #0000BB">nsExec</span><span style="color: #007700">::</span><span style="color: #0000BB">ExecToLog</span><span style="color: #DD0000">'"${NSISDIR}\makensis.exe"/CMDHELP'
<br /></span><span style="color: #0000BB">DetailPrint</span><span style="color: #DD0000">""
<br /></span><span style="color: #007700">${Else}
<br /></span><span style="color: #0000BB">DetailPrint</span><span style="color: #DD0000">""
<br /></span><span style="color: #0000BB">DetailPrint</span><span style="color: #DD0000">"Userdidnotrequestthehelplisting"
<br /></span><span style="color: #0000BB">DetailPrint</span><span style="color: #DD0000">""
<br /></span><span style="color: #007700">${EndIf}
<br /><br /></span><span style="color: #0000BB">SectionEnd
<br /></span>

<!-- php buffer end -->
                
                
                
</pre>
      <hr />
      <pre>
        

                
</pre>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">TehMuffinMan</span><br />
      <span class="post-time small text-muted">26th March 2011 17:03 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Thanks for the info! My apologies, I did look through the manual (but not example scripts) and every mention I could find of MessageBox used labels. I must have missed the part where they work with logical flow statements. I had also googled for hours trying to find this information too so I hope you don't think I was lazy haha :)</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">TehMuffinMan</span><br />
      <span class="post-time small text-muted">26th March 2011 17:06 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">I also need this to work with YESNOCANCEL (so 3 buttons), off to searching the manual again and examples I go! Thanks again for pointing me in the right direction.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">TehMuffinMan</span><br />
      <span class="post-time small text-muted">26th March 2011 17:25 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">How about something like this?<br />
      <br />
      PHP Code:</p>
      <hr />
      <code style="white-space:nowrap"><!-- php buffer start --></code><span style="color: #000000"><span style="color: #007700">!include</span><span style="color: #DD0000">"LogicLib.nsh"<br />
      <br /></span> <span style="color: #0000BB">Name</span><span style="color: #DD0000">"Demo"<br /></span> <span style="color: #0000BB">OutFiledemo</span><span style="color: #007700">.</span><span style="color: #0000BB">exe<br />
      <br />
      RequestExecutionLevel</span><span style="color: #DD0000">"user"<br />
      <br /></span> <span style="color: #0000BB">ShowInstDetailsshow<br />
      <br />
      Section</span><span style="color: #007700">default<br />
      <br />
      ${If}${</span><span style="color: #0000BB">Cmd</span><span style="color: #007700">}`</span><span style="color: #0000BB">MessageBoxMB_YESNOCANCEL|MB_ICONQUESTION'DisplayMAKENSIShelp?'IDYES</span><span style="color: #007700">`<br /></span> <span style="color: #0000BB">DetailPrint</span><span style="color: #DD0000">"MAKENSISHelp:"<br /></span> <span style="color: #0000BB">DetailPrint</span><span style="color: #DD0000">""<br /></span> <span style="color: #0000BB">nsExec</span><span style="color: #007700">::</span><span style="color: #0000BB">ExecToLog</span><span style="color: #DD0000">'"${NSISDIR}\makensis.exe"/CMDHELP'<br /></span> <span style="color: #0000BB">DetailPrint</span><span style="color: #DD0000">""<br /></span> <span style="color: #007700">${ElseIf${</span><span style="color: #0000BB">Cmd</span><span style="color: #007700">}`</span><span style="color: #0000BB">IDNO</span><span style="color: #007700">`}<br /></span> <span style="color: #0000BB">DetailPrint</span><span style="color: #DD0000">""<br /></span> <span style="color: #0000BB">DetailPrint</span><span style="color: #DD0000">"Userdidnotrequestthehelplisting"<br /></span> <span style="color: #0000BB">DetailPrint</span><span style="color: #DD0000">""<br /></span> <span style="color: #007700">${Else}<br />
      {DO</span><span style="color: #0000BB">SOMETHING</span><span style="color: #007700">ELSE</span><span style="color: #0000BB">HERE</span><span style="color: #007700">}<br />
      ${EndIf}<br />
      <br /></span> <span style="color: #0000BB">SectionEnd<br /></span></span> <!-- php buffer end -->
      <hr />
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">pengyou</span><br />
      <span class="post-time small text-muted">26th March 2011 17:27 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">I find "Windows Grep" useful for searching the example files supplied with NSIS.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">TehMuffinMan</span><br />
      <span class="post-time small text-muted">26th March 2011 17:41 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"></p>

      <blockquote>
        <small>Originally posted by pengyou</small><br />
        I find "Windows Grep" useful for searching the example files supplied with NSIS.
      </blockquote>That is exactly what I already did. I looked through all instances of "messagebox" and the only ones I found using LogicLib only had 2 choices like your original example.<br />
      <br />
      I also grepped for instances of ${If} and ${Cmd} together to see if they were possibly used with another command other than messagebox, no dice.<br />
      <br />
      I am not lazy, I know how to search for stuff. This isn't my first rodeo =( I may have seen what I needed and not known it was what I needed.<br />
      <br />
      Sorry for the troubles :(
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">pengyou</span><br />
      <span class="post-time small text-muted">26th March 2011 17:45 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"></p>

      <blockquote>
        ${ElseIf ${Cmd} `IDNO`}
      </blockquote>will not compile for several reasons.<br />
      <br />
      Have you bothered to look at the LogicLib.nsi example script? It shows that LogicLib uses ${ElseIf} for the "if ... elseif ... else ... endif" structure.<br />
      <br />
      The ${If} ${Cmd} structure conditionally executes an inline statement, depending on a true value of the provided NSIS function. Your suggestion uses `IDNO` which is not a function.
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">TehMuffinMan</span><br />
      <span class="post-time small text-muted">26th March 2011 18:15 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"></p>

      <blockquote>
        <small>Originally posted by pengyou</small><br />
        will not compile for several reasons.<br />
        <br />
        Have you bothered to look at the LogicLib.nsi example script? It shows that LogicLib uses ${ElseIf} for the "if ... elseif ... else ... endif" structure.<br />
        <br />
        The ${If} ${Cmd} structure conditionally executes an inline statement, depending on a true value of the provided NSIS function. Your suggestion uses `IDNO` which is not a function.
      </blockquote>Yes I have "bothered" to. I hope by now I would have proved my self knowledgeable and competent... I am not someone looking for an easy answer. I had already spent a day looking for a solution to this. I just explained how I even used wingrep to search through all the example file.<br />
      <br />
      My question was never about how to setup the logic structure, I know how to use ${ElseIf} just fine (in general that is). My question is how to use that logic structure specifically with MessageBox YESNOCANCEL.<br />
      <br />
      There are only 2 examples in LogicLib.nsi that reference MessageBox.<br />
      PHP Code:
      <hr />
      <code style="white-space:nowrap"><!-- php buffer start --></code><span style="color: #000000"><span style="color: #007700">;</span><span style="color: #0000BB">ifcmd</span><span style="color: #007700">..||..|andif/</span><span style="color: #0000BB">unlesscmd<br />
      StrCpy$R2</span><span style="color: #DD0000">""<br /></span> <span style="color: #007700">${</span><span style="color: #0000BB">IfCmd</span><span style="color: #007700">}</span><span style="color: #0000BB">MessageBoxMB_YESNO</span><span style="color: #DD0000">"PleaseclickYes"</span><span style="color: #0000BB">IDYES</span><span style="color: #007700">${||}</span><span style="color: #0000BB">StrCpy$R2$R2A</span><span style="color: #007700">${|}<br />
      ${</span><span style="color: #0000BB">Unless</span><span style="color: #007700">}${</span><span style="color: #0000BB">Cmd</span><span style="color: #007700">}`</span><span style="color: #0000BB">MessageBoxMB_YESNO|MB_DEFBUTTON2"PleaseclickNo"IDYES</span><span style="color: #007700">`<br /></span> <span style="color: #0000BB">StrCpy$R2$R2B<br /></span> <span style="color: #007700">${</span><span style="color: #0000BB">EndUnless</span><span style="color: #007700">}<br />
      ${If}</span><span style="color: #0000BB">$R2</span><span style="color: #007700">==</span><span style="color: #DD0000">"AB"<br /></span> <span style="color: #0000BB">DetailPrint</span><span style="color: #DD0000">"PASSEDIfCmd/IfCmdtest"<br /></span> <span style="color: #007700">${Else}<br /></span> <span style="color: #0000BB">DetailPrint</span><span style="color: #DD0000">"FAILEDIfCmd/IfCmdtest"<br /></span> <span style="color: #007700">${EndIf}</span></span>
      <pre>
<span style="color: #007700">Function</span><span style="color: #0000BB">ComponentsLeave
<br /></span><span style="color: #007700">;</span><span style="color: #0000BB">Sectionflagstests</span><span style="color: #007700">(</span><span style="color: #0000BB">requiressections</span><span style="color: #007700">.</span><span style="color: #0000BB">nshbeincluded</span><span style="color: #007700">)
<br />${</span><span style="color: #0000BB">Unless</span><span style="color: #007700">}${</span><span style="color: #0000BB">SectionIsSelected</span><span style="color: #007700">}${</span><span style="color: #0000BB">TESTS</span><span style="color: #007700">}
<br /></span><span style="color: #0000BB">MessageBoxMB_OK</span><span style="color: #DD0000">"Pleaseselectthecomponent"
<br /></span><span style="color: #0000BB">Abort
<br /></span><span style="color: #007700">${EndIf}
<br /></span><span style="color: #0000BB">FunctionEnd
<br /></span>

<!-- php buffer end -->
                
                
                
</pre>
      <hr />
      <pre>
        
Neither of the above reference using an ${ElseIf}<br /><br />The only example in that script that references ${ElseIf} is the below, and it is just using strings, nothing to do with commands like MessageBox.<br /><br />        PHP Code:
        
                
</pre>
      <hr />
      <pre>
                <code style="white-space:nowrap">
                
                        <!-- php buffer start --></code><span style="color: #000000">
<span style="color: #007700">;if..elseif..else..endif
<br /></span><span style="color: #0000BB">StrCpy$R1A
<br />StrCpy$R2</span><span style="color: #DD0000">""
<br /></span><span style="color: #007700">${If}</span><span style="color: #0000BB">$R1</span><span style="color: #007700">==</span><span style="color: #0000BB">A
<br />StrCpy$R2$R2A
<br /></span><span style="color: #007700">${ElseIf}</span><span style="color: #0000BB">$R1</span><span style="color: #007700">==</span><span style="color: #0000BB">B
<br />StrCpy$R2$R2B
<br /></span><span style="color: #007700">${</span><span style="color: #0000BB">ElseUnless</span><span style="color: #007700">}</span><span style="color: #0000BB">$R1</span><span style="color: #007700">!=</span><span style="color: #0000BB">C
<br />StrCpy$R2$R2C
<br /></span><span style="color: #007700">${Else}
<br /></span><span style="color: #0000BB">StrCpy$R2$R2D
<br /></span><span style="color: #007700">${EndIf}
<br />${If}</span><span style="color: #0000BB">$R1</span><span style="color: #007700">==</span><span style="color: #0000BB">D
<br />StrCpy$R2$R2D
<br /></span><span style="color: #007700">${ElseIf}</span><span style="color: #0000BB">$R1</span><span style="color: #007700">==</span><span style="color: #0000BB">A
<br />StrCpy$R2$R2A
<br /></span><span style="color: #007700">${</span><span style="color: #0000BB">ElseUnless</span><span style="color: #007700">}</span><span style="color: #0000BB">$R1</span><span style="color: #007700">!=</span><span style="color: #0000BB">B
<br />StrCpy$R2$R2B
<br /></span><span style="color: #007700">${Else}
<br /></span><span style="color: #0000BB">StrCpy$R2$R2C
<br /></span><span style="color: #007700">${EndIf}
<br />${If}</span><span style="color: #0000BB">$R1</span><span style="color: #007700">==</span><span style="color: #0000BB">C
<br />StrCpy$R2$R2C
<br /></span><span style="color: #007700">${ElseIf}</span><span style="color: #0000BB">$R1</span><span style="color: #007700">==</span><span style="color: #0000BB">D
<br />StrCpy$R2$R2D
<br /></span><span style="color: #007700">${</span><span style="color: #0000BB">ElseUnless</span><span style="color: #007700">}</span><span style="color: #0000BB">$R1</span><span style="color: #007700">!=</span><span style="color: #0000BB">A
<br />StrCpy$R2$R2A
<br /></span><span style="color: #007700">${Else}
<br /></span><span style="color: #0000BB">StrCpy$R2$R2B
<br /></span><span style="color: #007700">${EndIf}
<br />${If}</span><span style="color: #0000BB">$R1</span><span style="color: #007700">==</span><span style="color: #0000BB">B
<br />StrCpy$R2$R2B
<br /></span><span style="color: #007700">${ElseIf}</span><span style="color: #0000BB">$R1</span><span style="color: #007700">==</span><span style="color: #0000BB">C
<br />StrCpy$R2$R2C
<br /></span><span style="color: #007700">${</span><span style="color: #0000BB">ElseUnless</span><span style="color: #007700">}</span><span style="color: #0000BB">$R1</span><span style="color: #007700">!=</span><span style="color: #0000BB">D
<br />StrCpy$R2$R2D
<br /></span><span style="color: #007700">${Else}
<br /></span><span style="color: #0000BB">StrCpy$R2$R2A
<br /></span><span style="color: #007700">${EndIf}
<br />${If}</span><span style="color: #0000BB">$R2</span><span style="color: #007700">==</span><span style="color: #DD0000">"$R1$R1$R1$R1"
<br /></span><span style="color: #0000BB">DetailPrint</span><span style="color: #DD0000">"PASSEDIf..ElseIf..Else..EndIftest"
<br /></span><span style="color: #007700">${Else}
<br /></span><span style="color: #0000BB">DetailPrint</span><span style="color: #DD0000">"FAILEDIf..ElseIf..Else..EndIftest"
<br /></span><span style="color: #007700">${EndIf}
</span></span>
</pre>What am I missing? Do I have an old example file or something? I promise I am not an idiot! LOL
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">TehMuffinMan</span><br />
      <span class="post-time small text-muted">26th March 2011 18:17 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"></p>

      <blockquote>
        <small>Originally posted by pengyou</small><br />
        will not compile for several reasons.<br />
        <br />
        Have you bothered to look at the LogicLib.nsi example script? It shows that LogicLib uses ${ElseIf} for the "if ... elseif ... else ... endif" structure.<br />
        <br />
        The ${If} ${Cmd} structure conditionally executes an inline statement, depending on a true value of the provided NSIS function. Your suggestion uses `IDNO` which is not a function.
      </blockquote>Also FYI I typoed that, what I had meant was<br />
      <br />
      ${ElseIf} ${Cmd} `IDNO` (which still won't work obviously)<br />
      <br />
      Please excuse the slip of the keyboard, I know how to use ${ElseIf}, this isn't my first NSIS script :)
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">TehMuffinMan</span><br />
      <span class="post-time small text-muted">26th March 2011 19:41 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">For simplicity, this is exactly what I am trying to figure out... (I can ramble some)<br />
      <br />
      Reference the [WHAT GOES HERE]<br />
      <br /></p>
      <pre>
<span style="color: #007700">${If}${</span><span style="color: #0000BB">Cmd</span><span style="color: #007700">}`</span><span style="color: #0000BB">MessageBoxMB_YESNOCANCEL|MB_ICONEXCLAMATION"PRORAMXisalreadyinstalled.ClickYEStoremovetheinstalledversionfoundinC:\ProgramFiles(x86).ClickNOtoskipuninstallandchooseadifferentinstalllocation(notrecommended)orCANCELtoterminatetheinstaller."IDYES</span><span style="color: #007700">`
<br /></span><span style="color: #0000BB">MessageBoxMB_OK</span><span style="color: #DD0000">"Yeswasclicked"
<br /></span><span style="color: #007700">${ElseIf}{</span><span style="color: #0000BB">WHATGOESHERE</span><span style="color: #007700">??}
<br /></span><span style="color: #0000BB">MessageBoxMB_OK</span><span style="color: #DD0000">"Nowasclicked"
<br /></span><span style="color: #007700">${Else}
<br /></span><span style="color: #0000BB">MessageBoxMB_OK</span><span style="color: #DD0000">"Cancelwasclicked"
<br /></span><span style="color: #007700">${EndIf}
</span>
</pre>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
      <span class="post-time small text-muted">26th March 2011 22:34 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">You have to use labels I'm afraid, unless you use nsL (see sticky topic).<br />
      <br />
      Stu</p>
    </div>
    <hr />

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]>
  </script>
</body>
</html>
