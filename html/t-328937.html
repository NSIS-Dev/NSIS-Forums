<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="Question about Message Boxes" />

  <title>Question about Message Boxes - NSIS Forums</title><!-- Bootstrap core CSS -->
  <link rel="stylesheet" type="text/css" href="//netdna.bootstrapcdn.com/bootswatch/3.0.1/readable/bootstrap.min.css" />
  <link rel="stylesheet" href="../css/style.css" type="text/css" /><!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!--[if lt IE 9]>
                <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
                <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->
</head>

<body>
  <div class="container">
    <!-- Put navigation bar here -->

    <ol class="breadcrumb">
      <li><a href="../index.html" class="glyphicon glyphicon-home"></a></li>

      <li><a href="f-65.html">NSIS Discussion</a></li>

      <li class="active">Question about Message Boxes</li>
    </ol>

    <p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=328937">Question about Message Boxes</a></p><br />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">TehMuffinMan</span><br />
      <span class="post-time small text-muted">26th March 2011 05:39 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>Question about Message Boxes</strong><br />
      &nbsp; Howdy folks! Brand new here... :)<br />
      <br />
      I am wondering if there is an alternative to being forced to use gotos and labels as the result of buttons in a message box. Instead of using labels I would like to set some flags or something similar. I have been a developer for many years and the thought of using gotos makes me cringe a little bit haha! I am using a MB_YESNOCANCEL message box and once the flags are set I would do some logic on them via LogicLib.nsh.<br />
      <br />
      Thanks for any info!</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">pengyou</span><br />
      <span class="post-time small text-muted">26th March 2011 11:36 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Try reading the manual and the example scripts supplied with NSIS.<br />
      <br />
      Here is a simple example to get you started:<br /></p>
      <pre>
!include "LogicLib.nsh"
<br /><br />&gt;Name "Demo"
<br />&gt;OutFile demo.exe
<br /><br />RequestExecutionLevel "user"
<br /><br />&gt;ShowInstDetails show
<br /><br />Section default
<br /><br />   ${If} ${Cmd} `MessageBox MB_YESNO|MB_ICONQUESTION 'Display MAKENSIS help?' IDYES`
<br />      DetailPrint "MAKENSIS Help:"
<br />      DetailPrint ""
<br />      nsExec::ExecToLog '"${NSISDIR}\makensis.exe" /CMDHELP'
<br />      DetailPrint ""
<br />  ${Else}
<br />     DetailPrint ""
<br />     DetailPrint "User did not request the help listing"
<br />     DetailPrint ""
<br />  ${EndIf}
<br /><br />&gt;SectionEnd 
<br />&gt;

</pre>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">TehMuffinMan</span><br />
      <span class="post-time small text-muted">26th March 2011 17:03 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Thanks for the info! My apologies, I did look through the manual (but not example scripts) and every mention I could find of MessageBox used labels. I must have missed the part where they work with logical flow statements. I had also googled for hours trying to find this information too so I hope you don't think I was lazy haha :)</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">TehMuffinMan</span><br />
      <span class="post-time small text-muted">26th March 2011 17:06 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">I also need this to work with YESNOCANCEL (so 3 buttons), off to searching the manual again and examples I go! Thanks again for pointing me in the right direction.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">TehMuffinMan</span><br />
      <span class="post-time small text-muted">26th March 2011 17:25 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">How about something like this?<br />
      <br /></p>
      <pre>
<code>
"LogicLib.nsh"
<br /><br />&gt;Name "Demo"
<br />&gt;OutFile demo.exe
<br /><br />RequestExecutionLevel "user"
<br /><br />&gt;ShowInstDetails show
<br /><br />Section default
<br /><br />   ${If} ${</code>Cmd} `MessageBox MB_YESNOCANCEL|MB_ICONQUESTION 'Display MAKENSIS help?' IDYES`
<br />      DetailPrint "MAKENSIS Help:"
<br />      DetailPrint ""
<br />      nsExec::ExecToLog '"${NSISDIR}\makensis.exe" /CMDHELP'
<br />      DetailPrint ""
<br /> ${ElseIf ${Cmd} `IDNO`}
<br />     DetailPrint ""
<br />     DetailPrint "User did not request the help listing"
<br />     DetailPrint ""
<br />  ${Else}
<br />      {DOSOMETHING ELSE HERE}
<br />  ${EndIf}
<br /><br />&gt;SectionEnd 
<br />&gt;

</pre>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">pengyou</span><br />
      <span class="post-time small text-muted">26th March 2011 17:27 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">I find "Windows Grep" useful for searching the example files supplied with NSIS.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">TehMuffinMan</span><br />
      <span class="post-time small text-muted">26th March 2011 17:41 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"></p>

      <blockquote>
        <small>Originally posted by pengyou</small><br />
        I find "Windows Grep" useful for searching the example files supplied with NSIS.
      </blockquote>That is exactly what I already did. I looked through all instances of "messagebox" and the only ones I found using LogicLib only had 2 choices like your original example.<br />
      <br />
      I also grepped for instances of ${If} and ${Cmd} together to see if they were possibly used with another command other than messagebox, no dice.<br />
      <br />
      I am not lazy, I know how to search for stuff. This isn't my first rodeo =( I may have seen what I needed and not known it was what I needed.<br />
      <br />
      Sorry for the troubles :(
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">pengyou</span><br />
      <span class="post-time small text-muted">26th March 2011 17:45 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"></p>

      <blockquote>
        ${ElseIf ${Cmd} `IDNO`}
      </blockquote>will not compile for several reasons.<br />
      <br />
      Have you bothered to look at the LogicLib.nsi example script? It shows that LogicLib uses ${ElseIf} for the "if ... elseif ... else ... endif" structure.<br />
      <br />
      The ${If} ${Cmd} structure conditionally executes an inline statement, depending on a true value of the provided NSIS function. Your suggestion uses `IDNO` which is not a function.
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">TehMuffinMan</span><br />
      <span class="post-time small text-muted">26th March 2011 18:15 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"></p>

      <blockquote>
        <small>Originally posted by pengyou</small><br />
        will not compile for several reasons.<br />
        <br />
        Have you bothered to look at the LogicLib.nsi example script? It shows that LogicLib uses ${ElseIf} for the "if ... elseif ... else ... endif" structure.<br />
        <br />
        The ${If} ${Cmd} structure conditionally executes an inline statement, depending on a true value of the provided NSIS function. Your suggestion uses `IDNO` which is not a function.
      </blockquote>Yes I have "bothered" to. I hope by now I would have proved my self knowledgeable and competent... I am not someone looking for an easy answer. I had already spent a day looking for a solution to this. I just explained how I even used wingrep to search through all the example file.<br />
      <br />
      My question was never about how to setup the logic structure, I know how to use ${ElseIf} just fine (in general that is). My question is how to use that logic structure specifically with MessageBox YESNOCANCEL.<br />
      <br />
      There are only 2 examples in LogicLib.nsi that reference MessageBox.<br />
      <pre>
<code>
  ; ifcmd..||..| and if/unless cmd
<br />  StrCpy $R2 ""
<br /> ${IfCmd} MessageBox MB_YESNO "Please click Yes" IDYES ${||} StrCpy $R2 $R2A ${|}
<br />  ${</code>Unless} ${Cmd} `MessageBox MB_YESNO|MB_DEFBUTTON2 "Please click No" IDYES`
<br />    StrCpy $R2 $R2B
<br /> ${EndUnless}
<br />  ${If}$R2 == "AB"
<br />   DetailPrint "PASSED IfCmd/If Cmd test"
<br />  ${Else}
<br />   DetailPrint "FAILED IfCmd/If Cmd test"
<br />  ${EndIf} 
</pre>
      <pre>
Function ComponentsLeave
<br /> ; Section flags tests (requires sections.nsh be included)
<br />  ${Unless} ${SectionIsSelected} ${TESTS}
<br />   MessageBox MB_OK "Please select the component"
<br />    Abort
<br />  ${EndIf}
<br />&gt;FunctionEnd 
<br />&gt;

</pre>Neither of the above reference using an ${ElseIf}<br />
      <br />
      The only example in that script that references ${ElseIf} is the below, and it is just using strings, nothing to do with commands like MessageBox.<br />
      <br />
      <pre>
<code>
  ; if..elseif..else..endif
<br />  StrCpy $R1 A
<br />  StrCpy $R2 ""
<br /> ${If} $R1 == A
<br />    StrCpy $R2 $R2A
<br /> ${ElseIf} $R1 == B
<br />    StrCpy $R2 $R2B
<br /> ${ElseUnless} $R1 != C
<br />    StrCpy $R2 $R2C
<br />  ${Else}
<br />    StrCpy $R2 $R2D
<br />  ${EndIf}
<br />  ${If}$R1 == D
<br />    StrCpy $R2 $R2D
<br /> ${ElseIf} $R1 == A
<br />    StrCpy $R2 $R2A
<br /> ${ElseUnless} $R1 != B
<br />    StrCpy $R2 $R2B
<br />  ${Else}
<br />    StrCpy $R2 $R2C
<br />  ${EndIf}
<br />  ${If}$R1 == C
<br />    StrCpy $R2 $R2C
<br /> ${ElseIf} $R1 == D
<br />    StrCpy $R2 $R2D
<br /> ${ElseUnless} $R1 != A
<br />    StrCpy $R2 $R2A
<br />  ${Else}
<br />    StrCpy $R2 $R2B
<br />  ${EndIf}
<br />  ${If}$R1 == B
<br />    StrCpy $R2 $R2B
<br /> ${ElseIf} $R1 == C
<br />    StrCpy $R2 $R2C
<br /> ${ElseUnless} $R1 != D
<br />    StrCpy $R2 $R2D
<br />  ${Else}
<br />    StrCpy $R2 $R2A
<br />  ${EndIf}
<br />  ${If}$R2 == "$R1$R1$R1$R1"
<br />   DetailPrint "PASSED If..ElseIf..Else..EndIf test"
<br />  ${Else}
<br />   DetailPrint "FAILED If..ElseIf..Else..EndIf test"
<br />  ${EndIf} 
</code>
</pre>What am I missing? Do I have an old example file or something? I promise I am not an idiot! LOL
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">TehMuffinMan</span><br />
      <span class="post-time small text-muted">26th March 2011 18:17 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"></p>

      <blockquote>
        <small>Originally posted by pengyou</small><br />
        will not compile for several reasons.<br />
        <br />
        Have you bothered to look at the LogicLib.nsi example script? It shows that LogicLib uses ${ElseIf} for the "if ... elseif ... else ... endif" structure.<br />
        <br />
        The ${If} ${Cmd} structure conditionally executes an inline statement, depending on a true value of the provided NSIS function. Your suggestion uses `IDNO` which is not a function.
      </blockquote>Also FYI I typoed that, what I had meant was<br />
      <br />
      ${ElseIf} ${Cmd} `IDNO` (which still won't work obviously)<br />
      <br />
      Please excuse the slip of the keyboard, I know how to use ${ElseIf}, this isn't my first NSIS script :)
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">TehMuffinMan</span><br />
      <span class="post-time small text-muted">26th March 2011 19:41 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">For simplicity, this is exactly what I am trying to figure out... (I can ramble some)<br />
      <br />
      Reference the [WHAT GOES HERE]<br />
      <br /></p>
      <pre>
<code>   ${If} ${Cmd} `MessageBox MB_YESNOCANCEL|MB_ICONEXCLAMATION "PRORAM X is already installed. Click YES to remove the installed version found in C:\Program Files(x86). Click NO to skip uninstall and choose a different install location (not recommended) or CANCEL to terminate the installer." IDYES`
<br />       MessageBox MB_OK "Yes was clicked"
<br />   ${ElseIf} {WHAT GOES HERE??}
<br />       MessageBox MB_OK "No was clicked"
<br />    ${Else}    
<br />       MessageBox MB_OK "Cancel was clicked"
<br />    ${EndIf} 
</code>
</pre>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
      <span class="post-time small text-muted">26th March 2011 22:34 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">You have to use labels I'm afraid, unless you use nsL (see sticky topic).<br />
      <br />
      Stu</p>
    </div>
    <hr />

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]>
  </script>
</body>
</html>