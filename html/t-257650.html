<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="Patching NSIS-Setups on-the-fly when downloading?" />

  <title>Patching NSIS-Setups on-the-fly when downloading? - NSIS Forums</title>
  <script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script>
  <!-- Bootstrap core CSS -->

  <link rel="stylesheet" type="text/css" href="//netdna.bootstrapcdn.com/bootswatch/3.0.1/readable/bootstrap.min.css" />
  <link rel="stylesheet" href="../css/style.css" type="text/css" /><!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!--[if lt IE 9]>
                <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
                <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->
</head>

<body>
  <div class="container">
    <!-- Put navigation bar here -->

    <ol class="breadcrumb">
      <li><a href="../index.html" class="glyphicon glyphicon-home"></a></li>

      <li><a href="f-65.html">NSIS Discussion</a></li>

      <li class="active">Patching NSIS-Setups on-the-fly when downloading?</li>
    </ol>

    <p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=257650">Patching NSIS-Setups on-the-fly when downloading?</a></p><br />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">mstap</span><br />
      <span class="post-time small text-muted">16th October 2006 10:50 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>Patching NSIS-Setups on-the-fly when downloading?</strong><br />
      Hello everyone,<br />
      <br />
      I'm currently programming a software portal for our customers and I'd like to pre-patch the setup with their own serial number.<br />
      <br />
      To realize that, I've put a long string into the according field in the INI-file, let's say "serial=4444444444444444444444". Also, I've turned compression off for this file to be able to recognize it again in my download-program. When downloading the file, the script searches for the string mentioned above and replaces it with the serial number (fully transparent of course, the customer thinks he's downloading a normal executable file - mod_rewrite rocks ;)).<br />
      <br />
      That all works, but now comes the problem: the CRC-checksum does not match of course.<br />
      <br />
      My question: Is there the possibility to disable CRC-checksums for only one file or is there a method to re-build the checksum on the fly (where is it located in the executable and what area is used to generate it?) or are there other methods for replacing parts of the installer (constants or defined or whatever you'd like to call it) automatically?<br />
      <br />
      Thanks in advance,<br />
      Michael</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
      <span class="post-time small text-muted">16th October 2006 11:06 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Write the serial number to the end of the file. That part is ignored by the CRC check. To read it back, use <a href="http://nsis.sourceforge.net/Get_installer_filename" target="_blank">GetModuleFileName</a>, FileOpen, FileSeek, FileRead and FileClose.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">mstap</span><br />
      <span class="post-time small text-muted">16th October 2006 13:57 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Hi kichik,<br />
      <br />
      Thanks for your tip. I found <a href="http://nsis.sourceforge.net/ReadCustomerData" target="_blank">http://nsis.sourceforge.net/ReadCustomerData</a> and it works perfectly :).<br />
      <br />
      Thanks,<br />
      Michael</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">onad</span><br />
      <span class="post-time small text-muted">17th October 2006 10:40 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">A better way is to add an extra field to Version resource information, because even if you sign your application with an MS authenticate certificate you still can modify a value on the fly without breaking the finished application.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
      <span class="post-time small text-muted">17th October 2006 10:58 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">CRC is done on the resource section as well, including the version information.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">onad</span><br />
      <span class="post-time small text-muted">17th October 2006 11:24 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Yes, CRC does, I forgot :( Since I do not use it. OK appending to the end is better sollution I see...</p>
    </div>
    <hr />

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]>
  </script>
</body>
</html>
