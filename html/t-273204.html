<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="Change user to administrator" />

  <title>Change user to administrator - NSIS Forums</title><!-- Bootstrap core CSS -->
  <link rel="stylesheet" type="text/css" href="//netdna.bootstrapcdn.com/bootswatch/3.0.1/readable/bootstrap.min.css" />
  <link rel="stylesheet" href="../css/style.css" type="text/css" /><!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!--[if lt IE 9]>
                <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
                <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->
</head>

<body>
  <div class="container">
    <!-- Put navigation bar here -->

    <ol class="breadcrumb">
      <li><a href="../index.html" class="glyphicon glyphicon-home"></a></li>

      <li><a href="f-65.html">NSIS Discussion</a></li>

      <li class="active">Change user to administrator</li>
    </ol>

    <p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=273204">Change user to administrator</a></p><br />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">hotkebab99</span><br />
      <span class="post-time small text-muted">21st June 2007 15:21 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>Change user to administrator</strong><br />
      Hello,<br />
      I am a French user of NSIS so excuse me for my English ;)<br />
      <br />
      In my society, each person has got an user account on Windows 2000 without administrator rights.<br />
      <br />
      I want to give them a NSIS installer which will modify registry keys so this installer must be running with administrator rights. The problem is that users don't have the right to modify registry keys. Only administrator account got then.<br />
      <br />
      Is it possible in the installer script to give to the installer the administrator password and tell him to use the administrator account with this password ? With this, the installer will run under administrator so registry keys will be modified.<br />
      <br />
      Do you have any solution to my problem ?<br />
      <br />
      Thank you very much !</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">sgiusto</span><br />
      <span class="post-time small text-muted">21st June 2007 21:51 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">ctrl+right click the installer exe and choose execute as?<br />
      or put the installer exe in a cmd file with the runas command?</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">hotkebab99</span><br />
      <span class="post-time small text-muted">25th June 2007 08:55 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"></p>

      <blockquote>
        <i>Originally posted by sgiusto</i><br />
        <b>ctrl+right click the installer exe and choose execute as?<br />
        or put the installer exe in a cmd file with the runas command?</b>
      </blockquote>Of course...<br />
      But the interest is that all users of my company (even those who don't have a lot of knowledge in computer) can receive an installer (a patch for a program for example) and can execute it in administrator mode whitout giving them the admin password.<br />
      How to do that with NSIS ?
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
      <span class="post-time small text-muted">25th June 2007 19:56 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">You're talking about privilege escalation. An ability for every program to do such a thing would result in total chaos, giving everything and everyone administrator privileges on your computer. It'd be considered a serious vulnerability.<br />
      <br />
      If you want to implement such a mechanism, you will have to write a service that'd run on each of your company's computer and have your installers communicate with it for getting administrator privileges. To keep it safe, you'll probably want to digitally sign every installer and verify that signature in your service.<br />
      <br />
      There might be a service already available that does this. I think MSI has such a capability for signed installers.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">helix400</span><br />
      <span class="post-time small text-muted">25th June 2007 20:33 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Heh, you have a tough situation.<br />
      <br />
      The UAC plugin can elevate the NSIS installer process from standard user rights to admnistrator user rights. Provided:<br />
      <br />
      1) An adminstrator account exists with a password. (There must be a password. It cannot work without a password).<br />
      2) You are comfortable giving that adminstrator password to standard users.<br />
      <br />
      <a href="http://nsis.sourceforge.net/UAC_plug-in" target="_blank">http://nsis.sourceforge.net/UAC_plug-in</a><br />
      <br />
      But it sounds like you want to give standard users installers that can have administrator rights without having to type in a password.<br />
      <br />
      If this is the case, then the MSI installer is probably the way to go, as it is designed specifically for these scenarios.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">helix400</span><br />
      <span class="post-time small text-muted">25th June 2007 20:36 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Further, one other option is to set up a system where the users don't update their own software, but rather, YOU deploy the updates to the users for them.<br />
      <br />
      I don't work in large scale, enterprise environments, but I hear people discuss doing this all the time.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">psyki</span><br />
      <span class="post-time small text-muted">17th July 2007 15:18 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">yes, those are MSI packages ;)</p>
    </div>
    <hr />

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]>
  </script>
</body>
</html>
