<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="Review page before installing" />

  <title>Review page before installing - NSIS Forums</title>
  <script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script>
  <!-- Bootstrap core CSS -->

  <link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css" />
  <link rel="stylesheet" href="../css/style.css" type="text/css" /><!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!--[if lt IE 9]>
                <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
                <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->
</head>

<body>
  <div class="container">
    <!-- Put navigation bar here -->

    <ol class="breadcrumb">
      <li><a href="../index.html" class="glyphicon glyphicon-home"></a></li>

      <li><a href="f-65.html">NSIS Discussion</a></li>

      <li class="active">Review page before installing</li>
    </ol>

    <p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=204161">Review page before installing</a></p><br />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">billybillybob</span><br />
      <span class="post-time small text-muted">7th January 2005 11:38 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>Review page before installing</strong><br />
      I would like to make up a review page that lists all the things a user selected during the install - sections, install path, shortcut folder, custom page info. This page would be the last page before installing so a user can look over what they selected before installing.<br />
      <br />
      This was a neat feature on the myinno installer I used before and I miss it. Anyone know of a good way to do this?</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
      <span class="post-time small text-muted">7th January 2005 11:56 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">You can create an InstallOptions page and fill the information in it before you actually show the page. Have a look at Examples\Modern UI\InstallOptions.nsi. In there, before the insertion of the MUI_INSTALLOPTIONS_DISPLAY macro, add some MUI_INSTALLOPTIONS_WRITE macros to change the INI so the page will display the required information.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Seban</span><br />
      <span class="post-time small text-muted">25th September 2012 17:43 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Hello,<br />
      <br />
      I'm trying to create an overview screen to show the install settings, just like described in the op. I used MUI2.nsh to create the standard pages and nsDialogs.nsh to create a custom page:<br />
      <br />
      Function MUI_PAGE_OVERVIEW<br />
      ; Create page<br />
      nsDialogs::Create 1018<br />
      Pop $Dialog<br />
      ${If} $Dialog == error<br />
      Abort<br />
      ${EndIf}<br />
      <br />
      ; Set page- &amp; subtitel<br />
      !insertmacro MUI_HEADER_TEXT $(page_titel) $(page_subtitel)<br />
      <br />
      ; Add controls to page<br />
      ${NSD_CreateLabel} 0 0 100% 12u $(overview_label)<br />
      Pop $Label<br />
      ${NSD_CreateText} 0 13u 100% -13u $(overview_text)<br />
      Pop $Text<br />
      <br />
      ; Show page<br />
      nsDialogs::Show<br />
      FunctionEnd<br />
      <br />
      <br />
      One problem is, I want to write the chosen components into the text field but don't know how to. I tried variables that I assigned in the sections, but they probably are assigned after the custom page function is called.<br />
      <br />
      Is there an easy way to realize this?<br />
      Is what kichik wrote still up to date? I read the InstallOptions plug in is outdated and the post is 7 years old. How is this done nowadays?<br />
      <br />
      Thanks in advance,<br />
      Seban</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
      <span class="post-time small text-muted">25th September 2012 19:30 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Put the function after all sections then you can use ${If} ${SectionIsSelected} to check the section states.<br />
      <br />
      Stu</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Seban</span><br />
      <span class="post-time small text-muted">25th September 2012 21:52 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Hey Afrow, thanks for the quick answer. I'm going to try this tomorrow.<br />
      <br />
      Thanks a lot!</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Seban</span><br />
      <span class="post-time small text-muted">26th September 2012 12:42 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Hi Stu,<br />
      <br />
      I tried this, but it doesn't work. I attached a slimmed down copy of my .nsi file, maybe you or someone else is willing to take a look at it.<br />
      <br />
      The script doesn't copy/delete anything, it just shows two message boxes. ;)<br />
      <br />
      Thanks</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">jpderuiter</span><br />
      <span class="post-time small text-muted">26th September 2012 12:59 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Use ${If} ${SectionIsSelected} as Afrow said instead of setting a global var in a section (what you do is mixing compile time and runtime functions, which you shouldn't).</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Seban</span><br />
      <span class="post-time small text-muted">26th September 2012 13:22 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">I see, I didn't get that {SectionIsSelected} is a special command from LogicLib.nsh.<br />
      <br />
      I got it to work now.<br />
      <br />
      Thank you very much.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">demiller9</span><br />
      <span class="post-time small text-muted">26th September 2012 13:26 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">The sections wont be executed, and the variable won't be assigned, until the InstFiles page is shown and the Install button has been pressed. That's too late to let you use the variable in your Overview page. As they all say, use ${If} ${SectionIsSelected}.<br />
      <br />
      @jpderuiter: Seban is not mixing runtime and compile time instructions. His code is all properly written with runtime instructions.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Seban</span><br />
      <span class="post-time small text-muted">26th September 2012 15:12 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">It's me again :D<br />
      <br />
      I have another problem and can't find a solution (probably because I'm a noob as you may have realized yet):<br />
      In line 126 I use the LangString $(overview_text) to write into the text box. I want to change $(overview_text) depending on the components the user chose. I had some ideas but none of them worked, besides they all seemed very questionable to me in the first place.<br />
      <br />
      How can I fill the text box depending on the chosen components (and in min. 2 different languages)?<br />
      <br />
      I attached the slimmed down .nsi again (the previous problem corrected)<br />
      <br />
      Isn't there a tutorial on how to create such an overview page? Everything else was very easy &amp; well documented so far, but I can't find a how to or a sample for this.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Seban</span><br />
      <span class="post-time small text-muted">25th October 2012 03:00 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Hello,<br />
      <br />
      I created a simple custom summary page for my installer. It shows the destination folder and the chosen components. Maybe someone can use this some day. Keep in mind that this is the first installer I ever created so this might not be perfectly coded, but it works fine in my installer. Nevertheless no warranties and stuff ;) Feel free to post improvements and/or corrections.<br />
      <br />
      <br />
      Add these includes at the top of your script:<br /></p>
      <pre>
<code>!include MUI2.nsh               ; Modern UI<br />!include nsDialogs.nsh          ; Create custom pages<br />!include WinMessages.nsh        ; Have all of Windows messages defined in the script<br />!include LogicLib.nsh           ; Provide macros that allow easy construction of complex logical structures</code>
</pre><br />
      <br />
      Add the page where you want it to be shown, e.g.<br />
      <pre>
<code>!insertmacro MUI_PAGE_DIRECTORY<br />Page custom mui_page_summary<br />!insertmacro MUI_PAGE_INSTFILES</code>
</pre><br />
      <br />
      Create some language strings that you want to display, e.g. I suggest saving them in a .nsh-file and include it to keep the srcipt more readable.<br />
      <pre>
<code>LangString summary_page_title ${LANG_ENGLISH} "Summary"<br />LangString summary_page_subtitle ${LANG_ENGLISH} "Ready to start installing MySoftware."<br />LangString summary_label_path ${LANG_ENGLISH} "MySoftware will be installed to the following location:"<br />LangString summary_text_path ${LANG_ENGLISH} "$INSTDIR"<br />LangString summary_label_components ${LANG_ENGLISH} "The following components will be installed:"<br />LangString summary_Comp1 ${LANG_ENGLISH} "Component 1"<br />LangString summary_Comp2 ${LANG_ENGLISH} "Component 2"<br />LangString summary_Comp3 ${LANG_ENGLISH} "Component 3"<br />LangString summary_label_info ${LANG_ENGLISH} "Click Install to continue."</code>
</pre><br />
      <br />
      Add the following function behind your sections and customize it so it meets your expectations:<br />
      <pre>
<code>; Create custom summary page<br />Function mui_page_summary<br />        ; Variables<br />        Var /GLOBAL Dialog<br />        Var /GLOBAL lblPath<br />        Var /GLOBAL txtPath<br />        Var /GLOBAL lblComponents<br />        Var /GLOBAL chkComp1<br />        Var /GLOBAL lblComp1<br />        Var /GLOBAL chkComp2<br />        Var /GLOBAL lblComp2<br />        Var /GLOBAL chkComp3<br />        Var /GLOBAL lblComp3<br />        Var /GLOBAL lblInfo<br /><br />        ; Create page<br />        nsDialogs::Create 1018<br />        Pop $Dialog<br />        ${If} $Dialog == error<br />                Abort<br />        ${EndIf}<br />        <br />        ; Set page title &amp; subtitle<br />        !insertmacro MUI_HEADER_TEXT $(summary_page_title) $(summary_page_subtitle)<br />        <br />        ; Add controls to page<br />        ; Controls to show destination folder<br />        ${NSD_CreateLabel} 0 0 100% 12u $(summary_label_path)<br />                Pop $lblPath<br />        ${NSD_CreateText} 0 13u 100% 12u $(summary_text_path)<br />                Pop $txtPath<br />                ; Set text control to read-only<br />                SendMessage $txtPath ${EM_SETREADONLY} 1 0              ; Needs WinMessages.nsh<br />                <br />        ; Controls to show components, checkboxes enabled if components are chosen<br />        ${NSD_CreateLabel} 0 31u 100% 12u $(summary_label_components)<br />                Pop $lblComponents<br />                <br />        ${NSD_CreateCheckBox} 1 41u 10u 12u ""<br />                Pop $chkComp1<br />                ${If} ${SectionIsSelected} ${SECTION1}<br />                        ${NSD_Check} $chkComp1<br />                ${EndIf}<br />                ; Disable checkbox (so it can't be checked/unchecked)<br />                EnableWindow $chkComp1 0<br />        ${NSD_CreateLabel} 11u 43u 100% 12u $(summary_Comp1)<br />                Pop $lblComp1<br />                <br />        ${NSD_CreateCheckBox} 1 52u 10u 12u ""<br />                Pop $chkComp2<br />                ${If} ${SectionIsSelected} ${SECTION2}<br />                        ${NSD_Check} $chkComp2<br />                ${EndIf}<br />                EnableWindow $chkComp2 0<br />        ${NSD_CreateLabel} 11u 54u 100% 12u $(summary_Comp2)<br />                Pop $lblComp2<br />                <br />        ${NSD_CreateCheckBox} 1 63u 10u 12u ""<br />                Pop $chkComp3<br />                ${If} ${SectionIsSelected} ${SECTION3}<br />                        ${NSD_Check} $chkComp3<br />                ${EndIf}<br />                EnableWindow $chkComp3 0<br />        ${NSD_CreateLabel} 11u 65u 100% 12u $(summary_Comp3)<br />                Pop $lblComp3<br />                <br />        ; Controls to show info<br />        ${NSD_CreateLabel} 0 -16u 100% 12u $(summary_label_info)<br />                Pop $lblInfo<br />        <br />        ; Show custom page<br />        nsDialogs::Show<br />FunctionEnd</code>
</pre><br />
      <br />
      These following websites have been very helpful:<br />
      <a href="http://nsis.sourceforge.net/Docs/nsDialogs/Readme.html" target="_blank">http://nsis.sourceforge.net/Docs/nsDialogs/Readme.html</a><br />
      <a href="http://nsis.sourceforge.net/NsDialogs_FAQ" target="_blank">http://nsis.sourceforge.net/NsDialogs_FAQ</a><br />
      <a href="http://nsis.sourceforge.net/Docs/Modern%20UI/Readme.html" target="_blank">http://nsis.sourceforge.net/Docs/Mod...UI/Readme.html</a><br />
      <br />
      The code can also be found in the attached .nsi-file.
    </div>
    <hr />

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]>
  </script>
</body>
</html>
