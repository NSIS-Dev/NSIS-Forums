<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="HKCU - Multiuser changes" />

  <title>HKCU - Multiuser changes - NSIS Forums</title>
  <script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script>
  <!-- Bootstrap core CSS -->

  <link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css" />
  <link rel="stylesheet" href="../css/style.css" type="text/css" /><!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!--[if lt IE 9]>
                <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
                <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->
</head>

<body>
  <div class="container">
    <!-- Put navigation bar here -->

    <ol class="breadcrumb">
      <li><a href="../index.html" class="glyphicon glyphicon-home"></a></li>

      <li><a href="f-65.html">NSIS Discussion</a></li>

      <li class="active">HKCU - Multiuser changes</li>
    </ol>

    <p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=221368">HKCU - Multiuser changes</a></p><br />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">DennisFeiock</span><br />
      <span class="post-time small text-muted">13th July 2005 17:30 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>HKCU - Multiuser changes</strong><br />
      I have been trying to think of the best way to resolve a problem I am having.<br />
      <br />
      What I need to do is make registry entries for each user that has logged into the PC.<br />
      <br />
      I can add the entries to the Default User hive (c:\Documents and Settings\Default User\ntuser.dat), but that doesnt help me with adding the changes to all the users that have logged into the PC already.<br />
      <br />
      The only way that I could think of to accomplish this task is to have something along the lines of EnumRegKey, but for a directory, and scan through the Documents and Settings directory. Then, using reg.exe, load the user's HKCU hive and make the necessary changes. Then use reg.exe again to unload the hive. Only problem with this is that I cant find a command that would work like EnumRegKey but for directories.<br />
      <br />
      I just figured there had to be a better way to accomplish what Im going for. Also, while Im thinking about it, is there a way to load a user's ntuser.dat file without scripting in reg.exe and loading it to the HKU hive?<br />
      <br />
      Thanks!<br />
      - DF</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
      <span class="post-time small text-muted">14th July 2005 19:35 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Use <a href="http://nsis.sourceforge.net/wiki/EnumUsersReg" target="_blank">EnumUsersReg</a>.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">DennisFeiock</span><br />
      <span class="post-time small text-muted">14th July 2005 20:34 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Works like a charm. Thanks kichik.<br />
      <br />
      - DF</p>
    </div>
    <hr />

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]>
  </script>
</body>
</html>
