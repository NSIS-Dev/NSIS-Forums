<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="MS redistributable files: the infamous DCOM and co." />

  <title>MS redistributable files: the infamous DCOM and co. - NSIS Forums</title>
  <script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script>
  <!-- Bootstrap core CSS -->

  <link rel="stylesheet" type="text/css" href="//netdna.bootstrapcdn.com/bootswatch/3.0.1/readable/bootstrap.min.css" />
  <link rel="stylesheet" href="../css/style.css" type="text/css" /><!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!--[if lt IE 9]>
                <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
                <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->
</head>

<body>
  <div class="container">
    <!-- Put navigation bar here -->

    <ol class="breadcrumb">
      <li><a href="../index.html" class="glyphicon glyphicon-home"></a></li>

      <li><a href="f-65.html">NSIS Discussion</a></li>

      <li class="active">MS redistributable files: the infamous DCOM and co.</li>
    </ol>

    <p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=133101">MS redistributable files: the infamous DCOM and co.</a></p><br />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">G_J</span><br />
      <span class="post-time small text-muted">25th April 2003 15:03 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>MS redistributable files: the infamous DCOM and co.</strong><br />
      Hi,<br />
      In my installer I need to redistribute some Microsoft installers, such as DCOM95.exe and another .exe that installs a recent version of the Common Controls, and probably some more. Now here's the catch. Microsoft insists on using these executables as the only means of redistributing the DLLs inside them. Fine. Running them with /q even ensures they are silent. However, they often need a reboot, and even when run with /q they may pop up a reboot request dialog right in the middle of your installer. Some years ago I found that by using the undocumented /u switch that is supported in most Microsoft installers, you could make these guys *really* silent. E.g., you execute DCOM95.exe /q /u, and it shuts up until it completes its work and lets your installer run through to completion. However, the plot thickens, because now it's up to you (or, in this case, me :-) to detect whether the executable *wanted* a reboot, so as to set the NSIS reboot flag manually.<br />
      If it wanted a reboot, it must have ordered some post-reboot action; an action which was not possible at install time because one or more files were locked. This is handled differently on the various Microsoft operating systems - basically a new operation is flagged in the Registry or in system .ini files (for older operating systems) with an activity that needs to take place right after a reboot. It seems feasible to detect this, but there may be an easier way to solve this altogether.<br />
      <br />
      My question to this forum is as follows: has any of you had real-world experience of launching such MS redistribution executables from NSIS and has handled the reboot matter well? It seems to be a problem for many NSIS uses, so I'm certain I'm not the only one facing this. I would like to hear your thoughts, and of any of your approaches to solve this, and hope my discussion of the undocumented command line switch would be of help to some of you. Regards, GJ</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
      <span class="post-time small text-muted">25th April 2003 15:08 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Just a hunch because I don't have a lot of time to check this out. Try checking the return value of the process using ExecWait's extra parameter (ExecWait "installer.exe /u /whatever" $0 - $0 will contain the return value).</p>
    </div>
    <hr />

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]>
  </script>
</body>
</html>
