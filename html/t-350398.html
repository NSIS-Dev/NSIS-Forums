<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="Bundle an MSI &amp; a zip file" />

  <title>Bundle an MSI &amp; a zip file - NSIS Forums</title><!-- Bootstrap core CSS -->
  <link rel="stylesheet" type="text/css" href="//netdna.bootstrapcdn.com/bootswatch/3.0.1/readable/bootstrap.min.css" />
  <link rel="stylesheet" href="../css/style.css" type="text/css" /><!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!--[if lt IE 9]>
                <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
                <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->
</head>

<body>
  <div class="container">
    <!-- Put navigation bar here -->

    <ol class="breadcrumb">
      <li><a href="../index.html" class="glyphicon glyphicon-home"></a></li>

      <li><a href="f-65.html">NSIS Discussion</a></li>

      <li class="active">Bundle an MSI &amp; a zip file</li>
    </ol>

    <p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=350398">Bundle an MSI &amp; a zip file</a></p><br />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">vuser</span><br />
      <span class="post-time small text-muted">22nd October 2012 09:06 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>Bundle an MSI &amp; a zip file</strong><br />
      I have never worked with NSIS. I came investigating it because it has good compression.<br />
      <br />
      I have a MSI file( around 4MB ) created using Installshield and a zipped up directory.<br />
      <br />
      I want to create an installer which does the following<br />
      - Invoke the MSI<br />
      - Read the registry to find out where the MSI has been installed to<br />
      - Unzip the zipped up directory to that directory. The unzipping should happen silently - i.e. it shouldn't ask for directory to be unzipped to.<br />
      - Some pack files should be unpacked to jar files using unpack200.exe.<br />
      <br />
      Is something like this possible through NSIS? What's the learning curve to achieve something like this?<br />
      <br />
      So I am assuming any NSIS installer I create would be 12 + 4 + few MBs.<br />
      <br />
      Is something like this doable with NSIS?</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">MSG</span><br />
      <span class="post-time small text-muted">22nd October 2012 10:08 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Yes, this will be easy to accomplish, assuming that the MSI's install directory can be read from registry properly. This means the NSIS installer needs to run at the same level as the MSI installer (admin or userlevel). You can use the File command to install files (forget about zipping anything). Extract unpack2000 to $PLUGINSDIR and run it from there using ExecWait.<br />
      <br />
      <br />
      To learn NSIS, start with examining NSIS\Examples\Example1.nsi and Example2.nsi. Find out what all commands do, using the command reference: <a href="http://nsis.sourceforge.net/Docs/Chapter4.html" target="_blank">http://nsis.sourceforge.net/Docs/Chapter4.html</a><br />
      Once you know what all the commands in those Examples do, and why, you will be well on your way to creating your own installer.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">vuser</span><br />
      <span class="post-time small text-muted">26th October 2012 12:15 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Thank you, MSG. I have gone through the examples now and also checked some basic tutorials on the webpage. Very easy learning curve. Wonderful product.</p>
    </div>
    <hr />

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]>
  </script>
</body>
</html>
