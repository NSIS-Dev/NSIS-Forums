<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="description" content="HM NIS Editor, insertmacro MUI_PAGE_WELCOME, has me stumped."><title>HM NIS Editor, insertmacro MUI_PAGE_WELCOME, has me stumped. - NSIS Forums</title><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script><link rel="preload" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css" as="style" onload="this.rel='stylesheet'"><link rel="preload" href="../css/style.css" as="style" onload="this.rel='stylesheet'"><noscript><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css"><link rel="stylesheet" href="../css/style.css"></noscript><script>!function(a){"use strict";var b=function(b,c,d){function e(a){return h.body?a():void setTimeout(function(){e(a)})}function f(){i.addEventListener&&i.removeEventListener("load",f),i.media=d||"all"}var g,h=a.document,i=h.createElement("link");if(c)g=c;else{var j=(h.body||h.getElementsByTagName("head")[0]).childNodes;g=j[j.length-1]}var k=h.styleSheets;i.rel="stylesheet",i.href=b,i.media="only x",e(function(){g.parentNode.insertBefore(i,c?g:g.nextSibling)});var l=function(a){for(var b=i.href,c=k.length;c--;)if(k[c].href===b)return a();setTimeout(function(){l(a)})};return i.addEventListener&&i.addEventListener("load",f),i.onloadcssdefined=l,l(f),i};"undefined"!=typeof exports?exports.loadCSS=b:a.loadCSS=b}("undefined"!=typeof global?global:this);!function(a){if(a.loadCSS){var b=loadCSS.relpreload={};if(b.support=function(){try{return a.document.createElement("link").relList.supports("preload")}catch(b){return!1}},b.poly=function(){for(var b=a.document.getElementsByTagName("link"),c=0;c<b.length;c++){var d=b[c];"preload"===d.rel&&"style"===d.getAttribute("as")&&(a.loadCSS(d.href,d,d.getAttribute("media")),d.rel=null)}},!b.support()){b.poly();var c=a.setInterval(b.poly,300);a.addEventListener&&a.addEventListener("load",function(){b.poly(),a.clearInterval(c)}),a.attachEvent&&a.attachEvent("onload",function(){a.clearInterval(c)})}}}(this);</script></head><body><div class="container"><ol class="breadcrumb"><li><a href="../index.html" class="glyphicon glyphicon-home"></a></li><li><a href="f-65.html">NSIS Discussion</a></li><li class="active">HM NIS Editor, insertmacro MUI_PAGE_WELCOME, has me stumped.</li></ol><p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=151611">HM NIS Editor, insertmacro MUI_PAGE_WELCOME, has me stumped.</a></p><br><div class="post"><p class="post-meta"><span class="post-author text-primary">Press4Time</span><br><span class="post-time small text-muted">5th October 2003 18:04 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>HM NIS Editor, insertmacro MUI_PAGE_WELCOME, has me stumped.</strong><br>I have spent the last week and a half trying to overcome this HM NIS Edit error message. I have spent substantial time searching for an answer and havn't found one.<br><br>I've installed NSIS version 2.0 Beta 3 and HM NIS Edit 2.0b2<br>When I try to use the wizard I get the following error<br>!insertmacro: MUI_PAGE_WELCOME<br>!insertmacro: macro named "MUI_PAGE_WELCOME" not found!<br><br>I'm begining to think that the HM NIS Edit version numbers correspond with the NSIS version numbers but have not found any information to support my theory. Can anyone confirm what version of NSIS that HM NIS Edit 2.0b2 works with.?<br><br>I have tried several other NSIS editors including the NSIS built-in editor, but I don't have time to learn the NSIS scripting lingo from scratch. And for all my initial teething problems I believe that for a green thumb like me, HM NIS Wizards is my solution.<br><br>My thanks in advance.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Joel</span><br><span class="post-time small text-muted">5th October 2003 18:17 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Did you put <b>!insertmacro MUI_PAGE_WELCOME</b> after <b>!include "MUI.nsh"</b></p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br><span class="post-time small text-muted">5th October 2003 19:07 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">!insertmacro MUI_PAGE_WELCOME is for Modern UI 1.66, and comes with NSIS 2.0b4<br>2.0b3 uses the old !define MUI_WELCOMEPAGE.<br><br>It is highly recommended that you grab the latest development snapshot (2.0b4) from <a href="http://nsis.sourceforge.net/nightly/nsis.zip" target="_blank">http://nsis.sourceforge.net/nightly/nsis.zip</a> which will allow your current code to work properly.<br><br>-Stu</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Press4Time</span><br><span class="post-time small text-muted">5th October 2003 23:06 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">I stepped out for a few.<br>Yes Lobo Lunar, the code was done up right (for 2.0b4).<br>Well Afrow UK, I'll give the NSIS "Beta" release a go.<br>Besides after a quick search of the wizard made script it appears HM NIS doesn't use MUI_WELCOMEPAGE, but the newer form.<br>Thanks for pointing out what must seem like the obvious.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Press4Time</span><br><span class="post-time small text-muted">6th October 2003 01:13 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Yes I can sort of use NSIS.<br>I think this should be directed more at the wizard programmer for HM NIS Edit than anyone else, since it needs some updating.<br>Here's a list of simple things just to get going.<br><br>; !insertmacro MUI_PAGE_LICENSE ;change this to...<br>!insertmacro MUI_PAGE_LICENSE "License.txt"<br><br>; !define MUI_ICON "${NSISDIR}\Contrib\Icons\Setup.ico" ;Old Icon name<br>!define MUI_ICON "${NSISDIR}\Contrib\Graphics\Icons\NAME.ico"<br>; !define MUI_UNICON "${NSISDIR}\Contrib\Icons\normal-uninstall.ico"<br>!define MUI_UNICON "${NSISDIR}\Contrib\Graphics\Icons\NAME.ico"<br><br>; !insertmacro MUI_FUNCTIONS_DESCRIPTION_BEGIN ;The "S"...<br>!insertmacro MUI_FUNCTION_DESCRIPTION_BEGIN<br>; !insertmacro MUI_FUNCTIONS_DESCRIPTION_END ;The "S"...<br>!insertmacro MUI_FUNCTION_DESCRIPTION_END<br><br>And this will finally let me make the "Testing.exe" installer with:<br>3 warnings:<br>!warning: The MUI_PRODUCT and MUI_VERSION defines have been removed. Use a normal Name command now.<br>(macro:MUI_INSERT:7)<br>unknown variable "GROUP.lnk" detected, ignoring (C:\Program Files\A-Testing\test-4.nsi:45)<br>unknown variable "GROUP.lnk" detected, ignoring (C:\Program Files\A-Testing\test-4.nsi:100)<br><br>I'm sure I'll figure out what else needs fixing with some more poking around. :)<br>I'm just learning about the "normal" Name command...<br>name "${PRODUCT} ${VERSION}" ;Define your own software name here.<br><br>Just thought I'd let others (who are new to this) find the solutions quick, and to let Hector know there are now problems with HM NIS wizard 2.0b2 and NSIS 2.0B4.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br><span class="post-time small text-muted">6th October 2003 18:26 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">I'm not sure whether the HM NIS devloper reads these forums very regularely, so maybe you could email him.<br><br>The !insertmacro MUI_PAGE_LICENSE "License.txt" may be a good idea, but the theme with all the other page macros needs to be kept the same to not create confusion (kept without macro values).<br><br>-Stu</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Joost Verburg</span><br><span class="post-time small text-muted">6th October 2003 18:46 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">That's because this is the only required setting.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Press4Time</span><br><span class="post-time small text-muted">6th October 2003 19:55 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Sorry to confuse Afrow UK and others with the script above.<br>The commented out lines were the old style script that no longer works, although the HM NIS wizard still pumps it out that way.<br>I added the correct lines just below each old style script.<br><br>After I'd gotten to the point (as seen above), I quickly gave up on the wizard and just kept the MUI readme.html open while fixing the wizard's errors.<br><br>I will take the time later on to email Hector; who knows, he may already be working on a new release of HM NIS.<br><br>Meanwhile I've been able to follow the Readme files and have since dumped the test program and have started the installation script for distributing my software.<br>The 2.0b4 feels easier to script, probally thanks to those insertmacros.<br><br>My many thanks to all those who created and are still developing NSIS.</p></div><hr><div class="footer"><p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p></div></div><script src="../js/highlight.pack.js" type="text/javascript"></script><script type="text/javascript">//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]></script></body></html>