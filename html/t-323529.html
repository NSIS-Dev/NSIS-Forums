<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="description" content="Icon for a Start Menu item generated by CreateDirectory"><title>Icon for a Start Menu item generated by CreateDirectory - NSIS Forums</title><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script><link rel="preload" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css" as="style" onload="this.rel='stylesheet'"><link rel="preload" href="../css/style.css" as="style" onload="this.rel='stylesheet'"><noscript><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css"><link rel="stylesheet" href="../css/style.css"></noscript><script>!function(a){"use strict";var b=function(b,c,d){function e(a){return h.body?a():void setTimeout(function(){e(a)})}function f(){i.addEventListener&&i.removeEventListener("load",f),i.media=d||"all"}var g,h=a.document,i=h.createElement("link");if(c)g=c;else{var j=(h.body||h.getElementsByTagName("head")[0]).childNodes;g=j[j.length-1]}var k=h.styleSheets;i.rel="stylesheet",i.href=b,i.media="only x",e(function(){g.parentNode.insertBefore(i,c?g:g.nextSibling)});var l=function(a){for(var b=i.href,c=k.length;c--;)if(k[c].href===b)return a();setTimeout(function(){l(a)})};return i.addEventListener&&i.addEventListener("load",f),i.onloadcssdefined=l,l(f),i};"undefined"!=typeof exports?exports.loadCSS=b:a.loadCSS=b}("undefined"!=typeof global?global:this);!function(a){if(a.loadCSS){var b=loadCSS.relpreload={};if(b.support=function(){try{return a.document.createElement("link").relList.supports("preload")}catch(b){return!1}},b.poly=function(){for(var b=a.document.getElementsByTagName("link"),c=0;c<b.length;c++){var d=b[c];"preload"===d.rel&&"style"===d.getAttribute("as")&&(a.loadCSS(d.href,d,d.getAttribute("media")),d.rel=null)}},!b.support()){b.poly();var c=a.setInterval(b.poly,300);a.addEventListener&&a.addEventListener("load",function(){b.poly(),a.clearInterval(c)}),a.attachEvent&&a.attachEvent("onload",function(){a.clearInterval(c)})}}}(this);</script></head><body><div class="container"><ol class="breadcrumb"><li><a href="../index.html" class="glyphicon glyphicon-home"></a></li><li><a href="f-65.html">NSIS Discussion</a></li><li class="active">Icon for a Start Menu item generated by CreateDirectory</li></ol><p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=323529">Icon for a Start Menu item generated by CreateDirectory</a></p><br><div class="post"><p class="post-meta"><span class="post-author text-primary">Sooz24</span><br><span class="post-time small text-muted">27th October 2010 20:41 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>Icon for a Start Menu item generated by CreateDirectory</strong><br>&nbsp; I'm sure there is a simple answer to this...<br><br>I have an install that creates the following entries in the Start Menu<br><br>MyApp<br>Run MyApp<br>Uninstall MyApp<br><br>Both Run MyApp and Uninstall MyApp correctly show their icons. The parent 'MyApp' does not.<br><br>I'm using the following definition<br>CreateDirectory "$SMPROGRAMS\$StartMenuFolder"<br>CreateShortCut "$SMPROGRAMS\$StartMenuFolder\MyApp.lnk" "$INSTDIR\System\MyApp.exe" \<br>" " "$INSTDIR\System\MyApp.ico" "" SW_SHOWMINIMIZED<br>CreateShortCut "$SMPROGRAMS\$StartMenuFolder\Uninstall MyApp.lnk" "$INSTDIR\Uninstall.exe" \<br>" " "$INSTDIR\System\MyApp.ico" ""<br><br>How do I specify the missing icon?</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br><span class="post-time small text-muted">27th October 2010 20:50 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Since when did start menu folders have program specific icons (by default)?<br><br>Stu</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Wizou</span><br><span class="post-time small text-muted">27th October 2010 21:51 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">It is possible by placing a <b>desktop.ini</b> file in your folder. Give the file the attributes "hidden" and "system".<br>Inside desktop.ini, write the following: (with your NSIS script, so you can use the $INSTDIR)<br></p><pre>
<code>[.ShellClassInfo]<br>IconResource=C:\YourPath\MyProgram.exe,0<br></code>
</pre><br>
      (you can use an EXE, DLL or ICO file. See also <a href="http://msdn.microsoft.com/en-us/library/cc144102%28VS.85%29.aspx" target="_blank">http://msdn.microsoft.com/en-us/libr...8VS.85%29.aspx</a>)<br>
      <br>
      Apparently, you must also set the attribute "Read-only" on your folder. (only, not on the files inside)<br>
      <br>
      And please make sure your custom folder icon still looks like a folder, otherwise the user would feel strange..
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Anders</span><br>
      <span class="post-time small text-muted">28th October 2010 00:59 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">I think the attributes you need to set can vary (IIRC there is a registry setting for it) and the page you link to tells you which documented function to call (Or just set system and read-only to be on the safe side)</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">jiake</span><br>
      <span class="post-time small text-muted">28th October 2010 13:23 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Maybe he said that one of the shortcuts created in start menu folder by his installer doesn't have an icon, that likes an executable file without any icon resource. He wants to show the icon he set in script.</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">flizebogen</span><br>
      <span class="post-time small text-muted">31st October 2010 08:14 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Making Icons for folders is a nice thing especially in a corporate environment. This way users can distinguish between start menu entries provided by IT department from the rest.<br>
      <br>
      I ues this construct fairly often, it even works with limited user rights:<br>
      <br></p>
      <pre>
<code>
"!insertmacro PATH_MAKE_SYSTEM_FOLDER"
<br>&gt;!macro PATH_MAKE_SYSTEM_FOLDER pszPath
<br>    System</code>::Call    "shlwapi::PathMakeSystemFolder(t '${pszPath}') i."
<br>&gt;!macroend
<br><br>Section "Make Shortcuts"
<br> WriteINIStr "$SMPROGRAMS\Some Folder\Desktop.ini" ".ShellClassInfo" "IconFile" "$SYSDIR\shell32.dll"
<br> WriteINIStr "$SMPROGRAMS\Some Folder\Desktop.ini" ".ShellClassInfo" "IconIndex" "188"
<br> ${PathMakeSystemFolder} "$SMPROGRAMS\Some Folder"
<br>&gt;SectionEnd 
<br>&gt;

</pre>
    </div>
    <hr>

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]></script></body></html>