<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="Repair option in Add/Remove Programs" />

  <title>Repair option in Add/Remove Programs - NSIS Forums</title><!-- Bootstrap core CSS -->
  <link rel="stylesheet" type="text/css" href="//netdna.bootstrapcdn.com/bootswatch/3.0.1/readable/bootstrap.min.css" />
  <link rel="stylesheet" href="../css/style.css" type="text/css" /><!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!--[if lt IE 9]>
                <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
                <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->
</head>

<body>
  <div class="container">
    <!-- Put navigation bar here -->

    <ol class="breadcrumb">
      <li><a href="../index.html" class="glyphicon glyphicon-home"></a></li>

      <li><a href="f-65.html">NSIS Discussion</a></li>

      <li class="active">Repair option in Add/Remove Programs</li>
    </ol>

    <p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=282734">Repair option in Add/Remove Programs</a></p><br />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">inmedius</span><br />
      <span class="post-time small text-muted">6th December 2007 14:38 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>Repair option in Add/Remove Programs</strong><br />
      Hi All,<br />
      <br />
      I have searched the forums and followed examples from the wiki with no luck.<br />
      <br />
      I am currently in the process of switching our installers from one Manufacturer to NSIS. One of the features that is used a lot is the option to Repair your installation simply by running the installer again. So for example when the user goes in to Add/Remove Programs and selects the program then selects the addition information there is an option in that dialog to repair the install.<br />
      <br />
      I have set the registry settings and the path to the location of the extracted installer.<br />
      <br />
      Any help in getting this working would be much appreciated.<br />
      <br />
      Thanks<br />
      <br />
      David</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
      <span class="post-time small text-muted">6th December 2007 23:37 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><a href="http://nsis.sourceforge.net/Component_Manager" target="_blank">Component Manager</a> should be able to do that.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">inmedius</span><br />
      <span class="post-time small text-muted">10th December 2007 14:45 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Hi<br />
      <br />
      Thanks for your reply but this is not quite what I am looking for.<br />
      <br />
      If you go into the Control Panel and open 'Add/Remove Programs' you get a list of all programs installed on your machine. If you select an item you get an option on the left hand side to see support information. When that box appears there is an option to 'Repair' the product. All this genreally does is, is to run the installer in silent mode and to repair any broken or missing files.<br />
      <br />
      I don't necessarily need an option in the installer to repair I just need a way of running the installer.<br />
      <br />
      Thanks again for your help<br />
      <br />
      David</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
      <span class="post-time small text-muted">11th December 2007 09:25 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Then all you are looking for is in the documentation:<br />
      <br />
      <a href="http://nsis.sourceforge.net/Docs/AppendixD.html#D.2" target="_blank">http://nsis.sourceforge.net/Docs/AppendixD.html#D.2</a><br />
      <br />
      ModifyPath is the string to set.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">inmedius</span><br />
      <span class="post-time small text-muted">11th December 2007 10:31 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Hi kichik<br />
      <br />
      I have set the ModifyPath and the NoRepair option to 0 and still the installer does not launch.<br />
      <br />
      I have attached my script file, If you could have a look that would be much appreciated.<br />
      <br />
      Thanks again for your help<br />
      <br />
      David<br />
      <br />
      I am using NSIS v2.31</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
      <span class="post-time small text-muted">11th December 2007 11:52 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">I'd guess CopyFiles failed. Use a full path instead of just the installer's name. The working directory depends on the user and you can't trust it to be the installer's directory. The user might also rename the installer.<br />
      <br />
      Use $EXEPATH instead.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">inmedius</span><br />
      <span class="post-time small text-muted">11th December 2007 15:03 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Hi<br />
      <br />
      I have changed that value now and double checked that the Installer has been copied to the location specified. I have attached a screen shot of what I am trying to achieve. Simply when I press the 'Repair' button I want to launch the installer.<br />
      <br />
      If I change the NoModify to 0 and NoRepair to 1 I get the Change button appear and the installer loads as expected.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">inmedius</span><br />
      <span class="post-time small text-muted">11th December 2007 15:12 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Hi sorry forgot attachment.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
      <span class="post-time small text-muted">12th December 2007 17:26 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">I don't understand from your last post whether you got it working or not.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">inmedius</span><br />
      <span class="post-time small text-muted">12th December 2007 17:47 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Sorry if I was un clear, I have not managed to get this working using the 'Repair' button.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
      <span class="post-time small text-muted">12th December 2007 17:55 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Seems like it's a MSI only feature. Only MSI installers show this button in the information dialog.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">inmedius</span><br />
      <span class="post-time small text-muted">13th December 2007 09:52 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">OK. This should realy be documented in the documentstion.<br />
      <br />
      Thanks for all your help much appreciated.<br />
      <br />
      David</p>
    </div>
    <hr />

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]>
  </script>
</body>
</html>
