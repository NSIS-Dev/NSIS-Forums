<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="Is this possible with NSIS?" />

  <title>Is this possible with NSIS? - NSIS Forums</title><!-- Bootstrap core CSS -->
  <link rel="stylesheet" type="text/css" href="//netdna.bootstrapcdn.com/bootswatch/3.0.1/readable/bootstrap.min.css" />
  <link rel="stylesheet" href="../css/style.css" type="text/css" /><!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!--[if lt IE 9]>
                <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
                <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->
</head>

<body>
  <div class="container">
    <!-- Put navigation bar here -->

    <ol class="breadcrumb">
      <li><a href="../index.html" class="glyphicon glyphicon-home"></a></li>

      <li><a href="f-65.html">NSIS Discussion</a></li>

      <li class="active">Is this possible with NSIS?</li>
    </ol>

    <p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=248270">Is this possible with NSIS?</a></p><br />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">prnf</span><br />
      <span class="post-time small text-muted">9th June 2006 12:16 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>Is this possible with NSIS?</strong><br />
      Hello,<br />
      <br />
      First of all, let me apologize for such a long question. I'm new to NSIS and would like to hear from you before dwelving into the system.<br />
      We're finishing a new version of our application built using .NET Framework 2.0 and I would like to know if the following is possible with NSIS:<br />
      Our software has an application server for ASP.NET webservices that has to run inside IIS connected to an SQL Server database.<br />
      Then it has the client, which is a .NET WinForms application to be distributed in a LAN Intranet.<br />
      The ASP.NET server must be updated from time to time and this update will also have to run some SQL scripts on the database, and it should have an option to auto-update itself from the Web. It may also be needed to update the server manually with an executable that will do the job. Either way, during the server update process, the new client version will also be put into a specific place on the server. Every Client should check if there is a new version on the server, and automatically update itself before launch. This way, clients (which may only have intranet access) always get the update first.<br />
      I know this is a bit complex, but we have done this with the previous version of our application in Win32 and we don't want to go into developing it again for .NET.<br />
      Is it possible to do this with NSIS?<br />
      Thank you very much for your attention.<br />
      <br />
      Regards,<br />
      paulo</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Comperio</span><br />
      <span class="post-time small text-muted">10th June 2006 18:38 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">NSIS can do just about anything you want it (limited only by your imagination.) It's up to you (the developer) to decide how to implement each task.<br />
      <br />
      Here's a few broad suggestions to get you started:</p>

      <ol style="list-style-type: decimal">
        <li>First, you want your ASP.NET application to be able to update itself from the web. I'd start by looking at the <a href="http://nsis.sourceforge.net/InetLoad_plug-in" target="_blank">InetLoad plugin</a>.<br /></li>

        <li>Next, you say you need your application server to be able to run SQL scripts. I assume you are using MS SQL? If so, I'd look into using <a href="http://msdn2.microsoft.com/en-us/library/ms162806.aspx" target="_blank">osql.exe</a> . This is a command line utility from Microsoft that you can use to issue SQL commands. If you need to hide the DOS screens, you can use nsExec (included with NSIS) or the <a href="http://nsis.sourceforge.net/ExecDos_plug-in" target="_blank">ExecDOS</a> plugin.<br /></li>

        <li>Finally, you say that you'd need the client to automatically update. For this, I'd put a text file (or INI file) in the client's directory on the server. Then, just make a 'helper' exe that checks the file for the version number and compares it to what's on the client and then runs an update if necessary. (There is a nice version compare header included with NSIS. Look at Appendix E in the help file.) The 'helper exe' would be nothing more than an NSIS setup program.</li>
      </ol>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">prnf</span><br />
      <span class="post-time small text-muted">12th June 2006 10:44 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Hello Comperio,<br />
      <br />
      Thank you for reply and advice. It is most needed.<br />
      <br />
      Regards,<br />
      paulo</p>
    </div>
    <hr />

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]>
  </script>
</body>
</html>
