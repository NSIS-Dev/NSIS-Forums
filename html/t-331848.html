<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="description" content="ProgressBar with silent silentMod"><title>ProgressBar with silent silentMod - NSIS Forums</title><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script><link rel="preload" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css" as="style" onload="this.rel='stylesheet'"><link rel="preload" href="../css/style.css" as="style" onload="this.rel='stylesheet'"><noscript><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css"><link rel="stylesheet" href="../css/style.css"></noscript><script>!function(a){"use strict";var b=function(b,c,d){function e(a){return h.body?a():void setTimeout(function(){e(a)})}function f(){i.addEventListener&&i.removeEventListener("load",f),i.media=d||"all"}var g,h=a.document,i=h.createElement("link");if(c)g=c;else{var j=(h.body||h.getElementsByTagName("head")[0]).childNodes;g=j[j.length-1]}var k=h.styleSheets;i.rel="stylesheet",i.href=b,i.media="only x",e(function(){g.parentNode.insertBefore(i,c?g:g.nextSibling)});var l=function(a){for(var b=i.href,c=k.length;c--;)if(k[c].href===b)return a();setTimeout(function(){l(a)})};return i.addEventListener&&i.addEventListener("load",f),i.onloadcssdefined=l,l(f),i};"undefined"!=typeof exports?exports.loadCSS=b:a.loadCSS=b}("undefined"!=typeof global?global:this);!function(a){if(a.loadCSS){var b=loadCSS.relpreload={};if(b.support=function(){try{return a.document.createElement("link").relList.supports("preload")}catch(b){return!1}},b.poly=function(){for(var b=a.document.getElementsByTagName("link"),c=0;c<b.length;c++){var d=b[c];"preload"===d.rel&&"style"===d.getAttribute("as")&&(a.loadCSS(d.href,d,d.getAttribute("media")),d.rel=null)}},!b.support()){b.poly();var c=a.setInterval(b.poly,300);a.addEventListener&&a.addEventListener("load",function(){b.poly(),a.clearInterval(c)}),a.attachEvent&&a.attachEvent("onload",function(){a.clearInterval(c)})}}}(this);</script></head><body><div class="container"><ol class="breadcrumb"><li><a href="../index.html" class="glyphicon glyphicon-home"></a></li><li><a href="f-65.html">NSIS Discussion</a></li><li class="active">ProgressBar with silent silentMod</li></ol><p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=331848">ProgressBar with silent silentMod</a></p><br><div class="post"><p class="post-meta"><span class="post-author text-primary">hanenjom</span><br><span class="post-time small text-muted">24th June 2011 11:54 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>ProgressBar with silent silentMod</strong><br>Hi,<br><br>please i use a silent mode for my installation, but I notied that installation is so silent , i don't have any sign, i would like using progress bar for user.<br><br>in my research I found the progress bar in a page, but my need is just a progress without page to have in idea for the progress installation.<br><br>Please help me.<br><br>Thx.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br><span class="post-time small text-muted">24th June 2011 12:54 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">I would really suggest NOT having a progress bar. It really annoys me when I want to install a 3rd party program or run a 3rd party command line application with a silent switch that <b>isn't silent</b>. The whole point of a silent switch is so that the caller can manage progress while waiting for your process to complete, perhaps with a simple one line message.<br><br>But to answer your question, this can't be done properly (i.e. like the NSIS progress bar) because in silent mode there is no NSIS UI and so no progress messages are sent (PBM_SETPOS). You can still use a plug-in such as Banner or NXS to show a message to the user but again this defeats the purpose of a silent install.<br><br>Stu</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">hanenjom</span><br><span class="post-time small text-muted">24th June 2011 13:51 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>thx</strong><br>thx for you answers</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Anders</span><br><span class="post-time small text-muted">24th June 2011 17:49 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">This is ugly, but it sort of works:<br><br></p><blockquote>!include LogicLib.nsh<br>!include FileFunc.nsh<br><br>Var SilentGUI<br>!define SILENTGUI_INSTJUMP 2 ;page jump from first page to instfiles<br><br>!define SWP_NOMOVE 0x0002<br>!define SWP_NOZORDER 0x0004<br>!define SWP_NOSIZE 0x0001<br>!define SWP_FRAMECHANGED 0x0020<br><br><br><br>Function .onGuiInit<br>${GetParameters} $0<br>ClearErrors<br>${GetOptions} $0 "/SilentGUI" $0<br>${IfNot} ${Errors}<br>StrCpy $SilentGUI 1<br>System::Call 'USER32::SetWindowLong(i $HWNDPARENT,i -16,i 0x800008C8|0x00400000)'<br>SendMessage $HWNDPARENT "0x408" "${SILENTGUI_INSTJUMP}" ""<br>${EndIf}<br>FunctionEnd<br><br>Function InstFilesShow<br>${IfNotThen} $SilentGUI &lt;&gt; 0 ${|} Return ${|}<br>FindWindow $0 "#32770" "" $HWNDPARENT<br>GetDlgItem $9 $0 0x3EC<br>StrCpy $1 ""<br>hideloop:<br>FindWindow $1 "" "" $0 $1<br>ShowWindow $1 0<br>StrCmp $1 0 "" hideloop<br>ShowWindow $9 1<br>System::Call '*(i,i,i,i)i.r0'<br>System::Call 'USER32::GetClientRect(i $9,ir0)'<br>System::Call '*$0(i,i,i,i.r2)i'<br>System::Call 'USER32::GetClientRect(i $HWNDPARENT,ir0)'<br>System::Call '*$0(i,i,i.r1,i)i'<br>IntOp $3 $1 - 25<br>System::Call 'USER32::SetWindowPos(i $9,i,i0,i0,ir3,ir2,i ${SWP_NOZORDER})'<br>System::Free $0<br>IntOp $2 $2 + 25<br>System::Call 'USER32::SetWindowPos(i $HWNDPARENT,i,i,i,ir1,ir2,i ${SWP_NOMOVE}|${SWP_NOZORDER}|${SWP_FRAMECHANGED})'<br>FunctionEnd<br><br>Function InstFilesLeave<br>${If} $SilentGUI &lt;&gt; 0<br>Quit<br>Abort<br>${EndIf}<br>FunctionEnd<br><br>Section<br>Sleep 1000<br>Sleep 1000<br>Sleep 1000<br>Sleep 1000<br>SectionEnd<br><br>Page Components<br>Page Directory<br>Page InstFiles "" InstFilesShow InstFilesLeave</blockquote>Run with setup.exe /silentgui</div><hr><div class="footer"><p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p></div></div><script src="../js/highlight.pack.js" type="text/javascript"></script><script type="text/javascript">//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]></script></body></html>