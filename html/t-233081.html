<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="can't cancel from a custom page" />

  <title>can't cancel from a custom page - NSIS Forums</title><!-- Bootstrap core CSS -->
  <link rel="stylesheet" type="text/css" href="//netdna.bootstrapcdn.com/bootswatch/3.0.1/readable/bootstrap.min.css" />
  <link rel="stylesheet" href="../css/style.css" type="text/css" /><!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!--[if lt IE 9]>
                <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
                <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->
</head>

<body>
  <div class="container">
    <!-- Put navigation bar here -->

    <ol class="breadcrumb">
      <li><a href="../index.html" class="glyphicon glyphicon-home"></a></li>

      <li><a href="f-65.html">NSIS Discussion</a></li>

      <li class="active">can't cancel from a custom page</li>
    </ol>

    <p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=233081">can't cancel from a custom page</a></p><br />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">jhegge</span><br />
      <span class="post-time small text-muted">13th December 2005 17:34 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>can't cancel from a custom page</strong><br />
      I've added a custom page to an installer, to call a function that in turn calls a DLL to check whether a selected port TCP port is open or already bound.<br />
      <br />
      I want the install to stay on that page until either an open port is provided or the user uses the Cancel button to quit the installer.<br />
      <br />
      I have this function partly working:<br />
      <br /></p>
      <pre>
<code><br />Function SetChoosePorts<br /><br />    choose_again:<br />    ;Set up the port config page<br />    !insertmacro MUI_HEADER_TEXT "Manager Port and User Options" "Choose port, user and password"<br />    !insertmacro MUI_INSTALLOPTIONS_DISPLAY "portconfig.ini"<br /> <br />    Call configure<br />    pop $R7<br />    StrCmp $R7 "1" choose_again proceed<br /><br />    proceed:   <br />    return<br />    <br />FunctionEnd<br /></code>
</pre><br />
      <br />
      Not too elegant, but I thought it was sufficient. The trouble is that when a Cancel is selected, I get the warn dialog but selecting Yes still takes me back to the page. Also, pressing Back sends me back to the loop.<br />
      <br />
      How can I break out of the loop correctly?<br />
      <br />
      Thanks
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
      <span class="post-time small text-muted">13th December 2005 17:59 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">You should put the test code in the leave function of the page. This way, the page won't be destroyed until you don't call Abort, and you won't have to worry about recreating the page.</p>
    </div>
    <hr />

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]>
  </script>
</body>
</html>
