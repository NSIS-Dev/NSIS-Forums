<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="windows vista -&gt; nsis using game explorer" />

  <title>windows vista -&gt; nsis using game explorer - NSIS Forums</title><!-- Bootstrap core CSS -->
  <link rel="stylesheet" type="text/css" href="//netdna.bootstrapcdn.com/bootswatch/3.0.2/readable/bootstrap.min.css" /><!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!--[if lt IE 9]>
                <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
                <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->
</head>

<body>
  <div class="container">
    <!-- Put navigation bar here -->

    <ol class="breadcrumb">
      <li><a href="../index.html" class="glyphicon glyphicon-home"></a></li>

      <li><a href="f-65.html">NSIS Discussion</a></li>

      <li class="active">windows vista -&gt; nsis using game explorer</li>
    </ol>

    <p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=258969">windows vista -&gt; nsis using game explorer</a></p><br />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">DOCa Cola</span><br />
      <span class="post-time small text-muted">5th November 2006 22:36 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>windows vista -&gt; nsis using game explorer</strong><br />
      &nbsp; hi, could someone help using the igameexplorer interface from windows vista with nsis' system.dll?<br />
      <br />
      i already have my executable modified with the gdf (game definition file) data as described in the ms directx sdk. now, the next step to take is registering the executable via an api call.<br />
      <br />
      here is what the directx sdk readme states<br /></p>

      <blockquote>
        Once the GDF and related files have been added to a binary resource, it is then possible to integrate the game with Game Explorer. It is strongly advised that games integrate with Game Explorer during the installation process. The outline to the integration process is as follows:[list=1][*]Install ALL files to the user's hard drive. The next step activates parental controls and could potentially lock the user out of the installation directory. [*]Create an instance to the <b>IGameExplorer</b> interface. [*]Call the <b>VerifyAccess</b> method, of the <b>IGameExplorer</b> interface and pass it the path to the GDF. [*]Call the <b>AddGame</b> method, of the <b>IGameExplorer</b> interface and pass it the path to the GDF, the path to the root installation directory, and a unique GUID called the game instance ID. [*]Create shortcuts, which are Game Explorer tasks, by using the game instance ID. Game Explorer tasks are explained in the next section.[/list=1]
      </blockquote>game explorer: <a href="http://windowssdk.msdn.microsoft.com/en-us/library/ms687212.aspx" target="_blank">http://windowssdk.msdn.microsoft.com.../ms687212.aspx</a><br />
      interface reference: <a href="http://windowssdk.msdn.microsoft.com/en-us/library/ms687221.aspx" target="_blank">http://windowssdk.msdn.microsoft.com.../ms687221.aspx</a>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
      <span class="post-time small text-muted">6th November 2006 06:55 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Completely untested.</p>
      <pre>
<code>!include WinVer.nsh<br /><br />!define GDF $INSTDIR\game.exe<br /><br />!define GIS_NOT_INSTALLED 0 # might be wrong value<br />!define GIS_CURRENT_USER 1 # might be wrong value<br />!define GIS_ALL_USERS 2 # might be wrong value<br /><br />${If} ${AtLeastWinVista}<br />  SetOutPath $PLUGINSDIR<br />  File GameuxInstallHelper.dll # from dxsdk<br />  System::Call "GameuxInstallHelper::GenerateGUID(*g .r0)"<br />  System::Call "GameuxInstallHelper::AddToGameExplorer(t '${GDF}', t d, i ${GIS_ALL_USERS}, *g r0)"<br />  System::Call "GameuxInstallHelper::CreateTask(i ${GIS_ALL_USERS}, *g r0, i 0, i 0, t 'Play', t '${GDF}', t '')"<br />  System::Call "GameuxInstallHelper::CreateTask(i ${GIS_ALL_USERS}, *g r0, i 0, i 1, t 'Network Play', t '${GDF}', t '-network')"<br />  System::Call "GameuxInstallHelper::CreateTask(i ${GIS_ALL_USERS}, *g r0, i 0, i 2, t 'Safe Mode', t '${GDF}', t '-safe')"<br />  System::Call "GameuxInstallHelper::CreateTask(i ${GIS_ALL_USERS}, *g r0, i 1, i 0, t 'Supprt', t 'http://nsis.sf.net/', t '')"<br />  System::Call "GameuxInstallHelper::SetupRichSavedGames(t '.ExampleSaveGame', t '${GDF}', t '%1')"<br />  SetOutPath $INSTDIR<br />${EndIf}</code>
</pre>
      <pre>
<code># uninstall<br />${If} ${AtLeastWinVista}<br />  System::Call "GameuxInstallHelper::RetrieveGUIDForApplication(t '${GDF}', *g .r0)"<br />  System::Call "GameuxInstallHelper::RemoveFromGameExplorer(*g .r0)"<br />  System::Call "GameuxInstallHelper::RemoveTasks(*g .r0)"<br />  System::Call "GameuxInstallHelper::RemoveRichSaveGames(t '.ExampleSaveGame')"<br />${EndIf}<br /></code>
</pre>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">dandaman32</span><br />
      <span class="post-time small text-muted">6th November 2006 10:17 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Great. From what I can tell there, Microsoft is now using something even more cryptic than the Registry. Now there's a "games database"?<br />
      <br />
      <font size="1">&lt;sarcastic&gt;</font>*sighs* don't you just love it when Microsoft's APIs insist on doing everything for you?<font size="1">&lt;/sarcastic&gt;</font><br />
      <br />
      -dandaman32</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">DOCa Cola</span><br />
      <span class="post-time small text-muted">6th November 2006 19:26 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">thanks for your help kichik!<br />
      <br />
      works quite well, except one thing. in my case the guid is generated before - in the game definition file editor.<br />
      i tried both, with the sample binary with gdf information and my own binary and both the last parameter of <b>addline</b> could be left empty or even should left empty. i am not much into the gdf thing yet, so i don't know why this last parameter is there anyway as in the vista registry the guid of the is taken anyway.<br />
      the line<br /></p>
      <pre>
<code>  System::Call "GameuxInstallHelper::GenerateGUID(*g .r0)"</code>
</pre><br />
      crashes the installer. as i seem not to require it anyway i left it out, everything else seems to run smooth yet though i didn't try the uninstaller yet but looking at the lines you wrote that could be more a problem than <b>addline</b> cause of the guid thing i do not totally understand ;)<br />
      <br />
      DOCa Cola<br />
      <br />
      edit: @dandaman32<br />
      and yes, quite complicated for a simple link with menu :P
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
      <span class="post-time small text-muted">6th November 2006 21:11 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">GenerateGUID might need an allocated buffer like CoCreateGuid. In which case, its usage should be:</p>
      <pre>
<code>System::Alloc 16<br />System::Call "GameuxInstallHelper::GenerateGUID(i sr0)"</code>
</pre>or even:
      <pre>
<code>System::Call "GameuxInstallHelper::GenerateGUID(g .r0)"</code>
</pre>I'd need the DLL to verify. Could you attach it? Though you're probably correct that it just generates a new GUID. It doesn't take any parameters relating to the game.
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">DOCa Cola</span><br />
      <span class="post-time small text-muted">6th November 2006 22:29 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">here you go. :)<br />
      <br />
      thanks for your time</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
      <span class="post-time small text-muted">6th November 2006 22:44 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">As I thought, it just calls CoCreateGuid. The last usage example I wrote should work. It'd probably have the same effect if you generate the GUID in advance on your computer, but I can't be sure of that. According to MSDN, it's the InstanceID, so it's probably per-computer after all.<br />
      <br />
      MSDN also says:</p>

      <blockquote>
        Callers should store the instanceID returned by this call as it is necessary to call RemoveGame or UpdateGame, and to create tasks for the game within the Game Explorer.<br />
        <br />
        If the call is made to upgrade a legacy title to a supported title the ID returned in pguidInstanceID will be the same as the legacy entry.
      </blockquote>It seems AddGame would return a different GUID then the one passed, if the game is already installed. All `*g r0` instances in the script above should therefore be changed to `gr0` and the first instance, in the call to AddToGameExplorer should be changed to `gr0r0` so that AddToGameExplorer would be able to change the GUID.
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">DOCa Cola</span><br />
      <span class="post-time small text-muted">8th November 2006 11:43 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">great, installing works now without any problems. the uninstaller is the next step.<br />
      <br />
      thanks for your help kichik!</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
      <span class="post-time small text-muted">8th November 2006 17:58 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Mind creating a page on the Wiki with examples and functions/macros for adding games to the Game Explorer?</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">DOCa Cola</span><br />
      <span class="post-time small text-muted">11th November 2006 11:45 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">yea, as soon as i got this 100% running.<br />
      today i played with the uninstaller and couldn't get it working. i forgot to copy the gameuxinstallhelper.dll in the first place but i added it later so the uninstaller part does now look like that<br /></p>
      <pre>
<code>${If} ${AtLeastWinVista}<br />  SetOutPath $PLUGINSDIR<br />  File GameuxInstallHelper.dll # from dxsdk<br />  System::Call "GameuxInstallHelper::RetrieveGUIDForApplication(t '${GDF}', *g .r0)"<br />  System::Call "GameuxInstallHelper::RemoveFromGameExplorer(*g .r0)"<br />  System::Call "GameuxInstallHelper::RemoveTasks(*g .r0)"<br />  System::Call "GameuxInstallHelper::RemoveRichSaveGames(t '.ExampleSaveGame')"<br />  SetOutPath $INSTDIR<br />${EndIf}</code>
</pre><br />
      <br />
      i tested it and the path to ${GDF} is also correct set to the gdf binary.<br />
      Another problem i am experiencing are random crashes sometimes the installer calls the dll functions - both with the installer and uninstaller<br />
      <a href="http://img170.imageshack.us/my.php?image=11112006123647py9.png" target="_blank">http://img170.imageshack.us/my.php?i...6123647py9.png</a>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
      <span class="post-time small text-muted">11th November 2006 11:51 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">You need to convert `*g .r0` to `g .r0` for the first call and to `g r0` for the others, just like with the installer code.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">DOCa Cola</span><br />
      <span class="post-time small text-muted">11th November 2006 12:43 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">damn, i already tried changing the first call but forgot about the others ;) thx i will try it</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">DOCa Cola</span><br />
      <span class="post-time small text-muted">12th November 2006 09:31 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">still no success with<br /></p>
      <pre>
<code>${If} ${AtLeastWinVista}<br />  SetOutPath $PLUGINSDIR<br />  File GameuxInstallHelper.dll # from dxsdk<br />  System::Call "GameuxInstallHelper::RetrieveGUIDForApplication(t '${GDF}', g .r0)"<br />  System::Call "GameuxInstallHelper::RemoveFromGameExplorer(*g r0)"<br />  System::Call "GameuxInstallHelper::RemoveTasks(*g r0)"<br />  System::Call "GameuxInstallHelper::RemoveRichSaveGames(t '.ExampleSaveGame')"<br />  SetOutPath $INSTDIR<br />${EndIf}</code>
</pre><br />
      <br />
      the uninstaller seems to run fine but the game doesn't seem to be removed from the game browser...
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
      <span class="post-time small text-muted">14th November 2006 18:49 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">You still have an asterisk before `g`. It should be `gr0` for the last two calls.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kverity</span><br />
      <span class="post-time small text-muted">5th December 2006 19:51 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>including .dlls in Setup package.</strong><br />
      &nbsp; How can I pack the GameuxInstallHelper.dll into the AppNameSetup.exe?<br />
      <br />
      Is is necessary for our users to only download one file and I need to have the .dll accessible so the calls to the Game Explorer work correctly.<br />
      <br />
      Any help would be appreciated,<br />
      <br />
      Thanks,<br />
      <br />
      Keith</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">necrophilissimo</span><br />
      <span class="post-time small text-muted">8th January 2007 18:26 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Okay, I know I'm asking dumb questions, but has anyone made a tutorial on this subject? :D</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Comm@nder21</span><br />
      <span class="post-time small text-muted">8th January 2007 20:32 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">does the dll not exist on every vista system?<br />
      <br />
      if it does exist on every vista system, you should not include it in your setup but rather check, whether the user has the dll already and then call the functions or don't, if he has no windows vista (because then they're all useless).<br />
      <br />
      if it is not installed on vista by default you should indeed include the dll into your installer.<br />
      <br />
      this is quite simple:<br /></p>
      <pre>
<code><br />SetOutPath $PLUGINSDIR<br />File GameuxInstallHelper.dll<br /></code>
</pre><br />
      you may need to modify your dll calls to:<br />
      <pre>
<code><br />system::call '$PLUGINSDIR\GameuxInstallHelper.dll::blabla()'<br /></code>
</pre>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">ashre</span><br />
      <span class="post-time small text-muted">21st February 2007 21:04 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">I've recently written an installer integrating with Game Explorer, thanks for the help kichik and Doca!<br />
      <br />
      I've put up a wiki page with the code at:<br />
      <br />
      http://nsis.sourceforge.net/Game_explorer<br />
      <br />
      One thing of interest I discovered is that if you try and create a game explorer link for the current user it fails unless you are an administrator as it tries to write to HKLM - this is in conflict with what the documentation says but there's very little other information about Game Explorer at the moment.<br />
      <br />
      --<br />
      Marc Sutton<br />
      www.codev.co.uk</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">THiRD</span><br />
      <span class="post-time small text-muted">14th March 2007 23:28 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">I've been reading through these forums and I have been able to get my game to install in game explorer. My problem is that I can not uninstall the game from Game Explorer now. This is the GameEx code that I am using:<br /></p>
      <pre>
<code><br />!define GDF gdf_wheel.dll<br /><br />!define GIS_NOT_INSTALLED 0 # might be wrong value<br />!define GIS_CURRENT_USER 1 # might be wrong value<br />!define GIS_ALL_USERS 2 # might be wrong value<br /></code>
</pre><br />
      ..Other code omitted<br />
      <br />
      Install Code<br />
      <pre>
<code><br />${If} ${AtLeastWinVista}<br />      SetOutPath $PLUGINSDIR<br />      File GameuxInstallHelper.dll # from dxsdk<br />      System::Call "GameuxInstallHelper::GenerateGUID(*g .r0)"<br />      System::Call "GameuxInstallHelper::AddToGameExplorer(t '${GDF}', t d, i ${GIS_ALL_USERS}, *g r0)"<br />      System::Call "GameuxInstallHelper::CreateTask(i ${GIS_ALL_USERS}, *g r0, i 0, i 0, t 'Play', t '${GDF}', t '')"<br />      SetOutPath $INSTDIR<br />    ${EndIf}<br /></code>
</pre><br />
      <br />
      Uninstall Code<br />
      <pre>
<code><br />${If} ${AtLeastWinVista}<br />      System::Call "GameuxInstallHelper::RetrieveGUIDForApplication(t '${GDF}', *g .r0)"<br />      System::Call "GameuxInstallHelper::RemoveFromGameExplorer(*g .r0)"<br />      System::Call "GameuxInstallHelper::RemoveTasks(*g .r0)"<br />    ${EndIf}<br /></code>
</pre><br />
      <br />
      <br />
      I'm not sure where to go from here I've read the NSIS wiki on game explorer and I still can not get my game removed from game explorer. So my first step is to actually get the game removed then figure out how to set up the installer/uninstaller correctly.
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">ashre</span><br />
      <span class="post-time small text-muted">15th March 2007 09:52 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Hi Third,<br />
      <br />
      You need to use code more like that in the wiki. For a start the defines at the top of your code are incorrect. Also you need to RequestUserLevel admin at the top (it seems that applies even if you are trying to install for a current user).<br />
      <br />
      Also you need to generate a GUID and store it in the registry when you install, then use that value to uninstall. Copying the code from the wiki entry at:<br />
      <br />
      http://nsis.sourceforge.net/Game_explorer<br />
      <br />
      should make it work. Hope that helps,<br />
      <br />
      --<br />
      Marc Sutton<br />
      http://www.codev.co.uk</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">THiRD</span><br />
      <span class="post-time small text-muted">15th March 2007 19:52 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">I tried the code from the wiki, but I think my problem is that I can't get the old game to uninstall from gameEx so the code from the wiki doesn't work. Also I have a gid inside my GDF file do I need to generate one the way you said or should I be able to pull it from the GDF?<br />
      <br />
      Thanks</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">THiRD</span><br />
      <span class="post-time small text-muted">15th March 2007 21:07 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Okay some how i managed to get the old game removed from GameEx I am now using the code from the wiki, but it is not installing GameEx. I have the GameuxInstallHelper.dll and my gdf.dll in the directory with the installer. My script compiles fine it just doesn't seem to be running the GameEx functions.<br />
      <br /></p>
      <pre>
<code><br />!define GDF "gdf_wheel.dll"<br /></code>
</pre><br />
      <br />
      <pre>
<code><br />!define PRODUCT "MyGame"<br />!define FILES "files"<br />!define STUDIO "MyStudio"<br /><br />;Directory selection page<br />InstallDir "$PROGRAMFILES\${STUDIO}\${PRODUCT}"<br /></code>
</pre><br />
      <br />
      <pre>
<code><br />Function GameExplorer<br />  Pop $0<br /> <br />  ; Check if we have Vista or later<br />  ClearErrors<br />  ReadRegStr $0 HKLM "SOFTWARE\Microsoft\Windows NT\CurrentVersion" CurrentVersion<br />  IfErrors finished<br />  StrCpy $0 $0 1<br />  IntCmp $0 6 0 finished<br />  <br />  ; Register with Game Explorer if so<br />  ;SetOutPath $PLUGINSDIR<br />  File "GameuxInstallHelper.dll"<br /> <br />  ; Remove first to avoid duplication<br />  ReadRegStr $0 HKCU "Software\${PRODUCT}" "GameExplorer"<br />  StrCmp $0 '' skipUninstall<br />  System::Call "GameuxInstallHelper::RemoveFromGameExplorer(g r0)"<br />  System::Call "GameuxInstallHelper::RemoveTasks(g r0)"<br />  skipUninstall:<br /> <br />  ; Now add to GE<br />  System::Call "GameuxInstallHelper::GenerateGUID(g .r0)"<br />  WriteRegStr HKCU "Software\${PRODUCT}" "GameExplorer" $0<br />  System::Call "GameuxInstallHelper::AddToGameExplorer(t ${GDF}, t '$INSTDIR\${PRODUCT}.exe', i ${GIS_ALL_USERS}, g r0 r0)"<br />  System::Call "GameuxInstallHelper::CreateTask(i ${GIS_ALL_USERS}, g r0, i 0, i 0, t 'Play', t '$INSTDIR\${PRODUCT}.exe', t '')"<br />  System::Call "GameuxInstallHelper::CreateTask(i ${GIS_ALL_USERS}, g r0, i 1, i 0, t 'Support', t 'http://www.MySite.com/', t '')"<br /> <br /> finished:<br />  Pop $0<br /> FunctionEnd<br /> <br /> Function un.GameExplorer<br />  Push $0<br /> <br />  ; Check if we have Vista or later<br />  ClearErrors<br />  ReadRegStr $0 HKLM "SOFTWARE\Microsoft\Windows NT\CurrentVersion" CurrentVersion<br />  IfErrors finished<br />  StrCpy $0 $0 1<br />  IntCmp $0 6 0 finished<br /> <br />  ; Remove from game explorer<br />  ;SetOutPath $Temp<br />  File "GameuxInstallHelper.dll"<br />  ReadRegStr $0 HKCU "Software\${PRODUCT}" "GameExplorer"<br />  StrCmp $0 '' finished<br />  System::Call "GameuxInstallHelper::RemoveFromGameExplorer(g r0)"<br />  System::Call "GameuxInstallHelper::RemoveTasks(g r0)"<br /> finished:<br /> <br /> Pop $0<br /> FunctionEnd<br /></code>
</pre><br />
      <br />
      Sorry for all of the code just wasn't sure if i was missing something. Like I said, I have the dll's in the same directory as the install script and I also copied them into the directory of the app just to make sure they were found but still no luck.<br />
      <br />
      Thanks
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">oborstad</span><br />
      <span class="post-time small text-muted">5th April 2007 17:44 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Umm.. Does anyone have any ideas why I might be getting empty GUIDs from the System::Call "GameuxInstallHelper::GenerateGUID(g .r0)" line? I'm not getting "", but "{00000000-0000-0000-000000000000}" as a GUID...?<br />
      <br />
      Owen.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Comm@nder21</span><br />
      <span class="post-time small text-muted">5th April 2007 17:48 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">GenerateGUID does not take a GUID as argument, but the POINTER TO AN GUID.<br />
      <br />
      try GenerateGUID(i .r0)</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">oborstad</span><br />
      <span class="post-time small text-muted">5th April 2007 18:06 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><b>GenerateGUID(i .r0)</b> returns simply 0 instead of an empty GUID<br />
      <br />
      Also, this was taken from above and the wiki, so it seems to have worked for others...<br />
      <br />
      Owen.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Comm@nder21</span><br />
      <span class="post-time small text-muted">5th April 2007 21:13 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">you may try GenerateGUID(g r0)</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Comm@nder21</span><br />
      <span class="post-time small text-muted">5th April 2007 21:27 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">untested:<br />
      <br /></p>
      <pre>
<code>System</code>::Call "*(g 0) i .r0" # allocate memory for the GUID
<br />&gt;System::Call "GameuxInstallHelper::GenerateGUID (i .r0)" # pass the pointer to the allocated memory to the function
<br />&gt;System::Call "*$0(g .r1)" # read the new data from the pointer
<br />&gt;System::Free $0 # free the allocated memory
<br />&gt;DetailPrint "$1" # ouput the data 
</pre>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">oborstad</span><br />
      <span class="post-time small text-muted">5th April 2007 21:55 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Your code with GenerateGUID (i r0) (no period), gives me a blank GUID again... (not "", "{00000000-0000-0000-000000000000}") This was the same as simply doing the GenerateGUID(g .r0) (which gave the same thing, all 0's)<br />
      <br />
      I'm wondering if there's something borked on the vista box I'm using... (or flavour, or... sigh)<br />
      <br />
      Owen.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">oborstad</span><br />
      <span class="post-time small text-muted">6th April 2007 00:20 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Well, I found the problem. There are 2 versions of the GameuxInstallHelper. One's a 32 bit dll, one's a 64 bit dll. The 32 bit one works, but if you try to call the 64 bit one, it returns an empty GUID. So. Moral of this story. If you are getting totally weird results, double check you have the right files.<br />
      <br />
      For other people's sanity:<br />
      32 bit version of GameuxInstallerHelper is around 77 k<br />
      64 bit version of GameuxInstallerHelper is around 100 k<br />
      <br />
      Owen.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Welshman101</span><br />
      <span class="post-time small text-muted">8th April 2007 01:07 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">If anyone has an install script/s that succesfully add an entry to game explorer I would appreciate it if they would share it with me as I am currently unable to create one of my own.<br />
      <br />
      I've followed the code in the wiki but for some reason my app does not get added to Game Explorer.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">mauvecloud</span><br />
      <span class="post-time small text-muted">28th March 2008 18:49 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">I was able to add an entry to game explorer using the GUID extracted from the GDF resource beforehand, and code like the following:<br />
      <br /></p>
      <pre>
<code><br />;--------------------------------<br />Function GE_AddGame <br />  SetOutPath $PLUGINSDIR<br />  File "GameuxInstallHelper.dll"<br />  System::Call 'GameuxInstallHelper::AddToGameExplorerStrGUID(t "$INSTDIR\${GDF_BINARY}", t "$INSTDIR\", i 3, t "${GAME_GUID}")'<br />FunctionEnd<br /><br />;--------------------------------<br />Function GE_AddTasks<br />  SetShellVarContext all<br />  System::Call 'GameuxInstallHelper::CreateTaskStrGUID(i 3, t "${GAME_GUID}", i 0, i 0, t "Play", t "$INSTDIR\${GAME_EXE}", t "")'<br />  SetShellVarContext current<br />FunctionEnd<br /><br />;--------------------------------<br />Function un.GE_RemoveGame<br />  SetOutPath $PLUGINSDIR<br />  File "GameuxInstallHelper.dll"<br />  System::Call 'GameuxInstallHelper::RemoveFromGameExplorerStrGUID(t "${GAME_GUID}")'<br />  System::Call 'GameuxInstallHelper::RemoveTasksStrGUID(t "${GAME_GUID}")'<br />FunctionEnd<br /></code>
</pre><br />
      <br />
      Possibly the GUID passed to the functions needs to be the same as in the GDF resource, but if that's the case, what's the point of having a GenerateGUID function in GameuxInstallHelper instead of an ExtractGUID function?
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">oborstad</span><br />
      <span class="post-time small text-muted">28th March 2008 19:09 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"></p>

      <blockquote>
        <i>Originally posted by mauvecloud</i><br />
        Possibly the GUID passed to the functions needs to be the same as in the GDF resource, but if that's the case, what's the point of having a GenerateGUID function in GameuxInstallHelper instead of an ExtractGUID function?
      </blockquote>It doesn't, the GUID that you use for passing into the game explorer <i>should be</i> unique so that you could potentially add multiple versions/installs of the game to the explorer if you really wanted to. The GenerateGUID was failing for me because I had the 64 bit version of the dll instead of the 32 bit version on a 32 bit system.<br />
      <br />
      we use:<br />
      <pre>
<code><br />  System::Call "GameuxInstallHelper::GenerateGUID(g .r0)"<br />  StrCmp $0 '{00000000-0000-0000-0000-000000000000}' finished<br /><br />  System::Call "GameuxInstallHelper::AddToGameExplorer(t 'path_to_gdf_file', t 'path_to_exe', i ${GIS_ALL_USERS}, g r0) i .r4"<br /><br />  System::Call "GameuxInstallHelper::CreateTask(i ${GIS_ALL_USERS}, g r0, i  1, i 0, t 'Play', t 'path_to_exe', t 'arguments') i .r4"<br />  System::Call "GameuxInstallHelper::CreateTask(i ${GIS_ALL_USERS}, g r0, i  0, i 0, t 'Support', t 'path_to_exe', t 'arguments') i .r4"<br /><br />  System::Call "GameuxInstallHelper::SetupRihcSavedGames(t '.save_game_extension', t 'path_to_exe', t 'Save_game_descriptor') i .r4"<br /><br />  System::Call "GameuxInstallHelper::RegisterWithMediaCenter(t 'path_to_gdf_file', t 'path_to_mcl_location', i ${GIS_ALL_USERS}, t 'path_to_exe', t 'args', i 0) i .r4"<br />finished:<br /></code>
</pre><br />
      <br />
      ${GIS_ALL_USERS} = 3, can be 1 for current user instead (HKCU vs LM and for limited user can be 1)<br />
      <br />
      Hope that helps anyone else that is trying to get this up and running.<br />
      <br />
      Owen.
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
      <span class="post-time small text-muted">29th March 2008 16:42 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">There's no need to use GameuxInstallHelper. There are better solutions available.<br />
      <br />
      <a href="http://nsis.sourceforge.net/Game_explorer" target="_blank">http://nsis.sourceforge.net/Game_explorer</a><br />
      <a href="http://nsis.sourceforge.net/Games_plug-in" target="_blank">http://nsis.sourceforge.net/Games_plug-in</a></p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">mauvecloud</span><br />
      <span class="post-time small text-muted">29th March 2008 17:32 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">I fail to see how either of those is better than GameuxInstallHelper. The "Games" plugin looks like it will only work if the GDF is embedded in the EXE, not if it's in a separate DLL, and requires MSVCR80.dll. The "GameExplorer" header doesn't handle Media Center (and also looks a little buggy - I mean, why swap the GDF path and INSTDIR depending on current or all users?), and neither currently supports rich saved games.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
      <span class="post-time small text-muted">29th March 2008 17:47 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">GameExplorer header is smaller, simpler, easier to get and just works. Just look at the length of this GameuxInstallHelper related thread to see what I mean. I've created the GameExplorer headers to help users avoid this DLL.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">mauvecloud</span><br />
      <span class="post-time small text-muted">29th March 2008 19:01 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">I'm doubtful of the "just works" part. I still don't understand the reversal of R0 and R1 depending on ${CONTEXT} in the following snippet:<br /></p>
      <pre>
<code><br />  !if ${CONTEXT} == all<br />    System::Call "$1-&gt;${IGameExplorer_AddGame}(w R0, w R1, i ${GIS_ALL_USERS}, g R2) i .r0"<br />  !else if ${CONTEXT} == user<br />    System::Call "$1-&gt;${IGameExplorer_AddGame}(w R1, w R0, i ${GIS_CURRENT_USER}, g R2) i .r0"<br />  !else<br />    !error "Invalid CONTEXT passed to GameExplorer_AddGame! Must be `user` or `all`."<br />  !endif<br /></code>
</pre><br />
      <br />
      Anyway, I think the clarifications in this thread can be summarized as follows, and maybe added to a wiki page about GameuxInstallHelper:<br />
      1. The correct parameter type to use for the GUID (it's "g", not "i" or "*g" - the System plugin takes care of creating a GUID from the string and passing a pointer to it)<br />
      2. Use the 32-bit version of GameuxInstallHelper.dll, not the 64-bit version (unless maybe you want to only allow the game to be installed on a 64-bit system)<br />
      3. The GUID can be generated during the install, and shouldn't be the same as the gameID in the GDF resource.<br />
      Once those three things are understood, using GameuxInstallHelper is almost as easy as the GameExplorer header or Games plugin.
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
      <span class="post-time small text-muted">29th March 2008 20:38 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">If you're going to create a Wiki page for GameuxInstallHelper, I suggest you put a direct link to the correct version or step by step instructions for its location.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">mauvecloud</span><br />
      <span class="post-time small text-muted">30th March 2008 02:20 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Here you go:<br />
      http://nsis.sourceforge.net/Game_Explorer_with_Helper<br />
      (I haven't figured out yet how this forum decides which links to block, so I'm leaving it as text for now)<br />
      <br />
      For comparison:<br />
      Weaknesses of old Game Explorer header:<br />
      1. No save game support<br />
      2. No media center support<br />
      3. Additional tasks have to be created manually (with long paths to remember)<br />
      4. No support for pre-Vista systems that might get upgraded<br />
      <br />
      Weaknesses of Games plug-in:<br />
      1. Requires msvcr80.dll (612 KB)<br />
      2. Can't handle GDF in separate dll<br />
      3. No save game support<br />
      4. All tasks have to be created manually<br />
      5. No support for pre-Vista systems that might get upgraded<br />
      <br />
      Weaknesses of Game Explorer with Helper header:<br />
      1. Requires GameuxInstallHelper.dll (95 KB)<br />
      2. Doesn't support more than one game per installer</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">oborstad</span><br />
      <span class="post-time small text-muted">30th March 2008 04:29 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"></p>

      <blockquote>
        2. Doesn't support more than one game per installer
      </blockquote>If you change the macro for the adding the game to do a check to see if the dll is already written out, then it should work fine to add multiple games, as long as you make sure to always add them in sequence.<br />
      <pre>
<code><br />  !ifndef GAME_EXPLORER_DLL_EXISTS<br />    !ifdef GAME_EXPLORER_HELPER_PATH<br />      File "/oname=GameuxInstallHelper.dll" "${GAME_EXPLORER_HELPER_PATH}"<br />    !else<br />      File "GameuxInstallHelper.dll"<br />    !endif<br />    !define GAME_EXPLORER_DLL_EXISTS<br />  !endif<br /></code>
</pre><br />
      <br />
      Also, another suggestion, for localization reasons, I'd pull the "Play" task out of the first macro, otherwise the French will see "Play". Or put them in as extra label options. (Same for support), or make them come from language strings $(GameExplorerPlayTask) or something.<br />
      <br />
      Owen.
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">mauvecloud</span><br />
      <span class="post-time small text-muted">30th March 2008 06:29 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Supporting more than one game per installer took a little more than just checking for the dll, due to the way it had been using defines for the play task number and support task number, which wouldn't work if the task adding was done in a function declared before the one that added the game, so I switched to variables, and it should be more robust now.<br />
      <br />
      As far as localization, I see your point, but I don't want to force the use of LangStrings, so I pulled the task adding out of the GameExplorer_AddGame, and GameExplorer_AddPlayTask and GameExplorer_AddSupportTask already allow the task names to be specified separately.</p>
    </div>
    <hr />

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]>
  </script>
</body>
</html>