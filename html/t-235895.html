<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="Problem with Destination Folder's wright permission" />

  <title>Problem with Destination Folder's wright permission - NSIS Forums</title>
  <script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script>
  <!-- Bootstrap core CSS -->

  <link rel="stylesheet" type="text/css" href="//netdna.bootstrapcdn.com/bootswatch/3.0.1/readable/bootstrap.min.css" />
  <link rel="stylesheet" href="../css/style.css" type="text/css" /><!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!--[if lt IE 9]>
                <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
                <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->
</head>

<body>
  <div class="container">
    <!-- Put navigation bar here -->

    <ol class="breadcrumb">
      <li><a href="../index.html" class="glyphicon glyphicon-home"></a></li>

      <li><a href="f-65.html">NSIS Discussion</a></li>

      <li class="active">Problem with Destination Folder's wright permission</li>
    </ol>

    <p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=235895">Problem with Destination Folder's wright permission</a></p><br />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Sujay</span><br />
      <span class="post-time small text-muted">19th January 2006 11:47 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>Problem with Destination Folder's wright permission</strong><br />
      Hi,<br />
      i hv come accross one problem. i made a setup.exe for one application for windows. now i want to check that the destination folder user want to install is having the wright permissions or not. because at one machine there might not hving permission to wright in program files. I want to check this while installing the application and want to give one message to user to choose another folder.<br />
      thanks in advance.<br />
      -- Sujay</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
      <span class="post-time small text-muted">19th January 2006 19:02 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">You can use a method similar to that in the following thread:<br />
      <br />
      <a href="http://forums.winamp.com/showthread.php?s=&amp;threadid=204991&amp;highlight=write+permission" target="_blank">http://forums.winamp.com/showthread....ite+permission</a><br />
      <br />
      Though I'd use GetTempFileName so it won't overwrite any files.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Sujay</span><br />
      <span class="post-time small text-muted">20th January 2006 05:18 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">thanks .<br />
      but can u send me any exmple srcipts to use this. i tried a lot but didnt understand how to do this.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Takhir</span><br />
      <span class="post-time small text-muted">20th January 2006 07:14 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"></p>
      <pre>
<code><br />!define MUI_PAGE_CUSTOMFUNCTION_LEAVE OnDirLeave<br />!insertmacro MUI_PAGE_DIRECTORY<br />Function OnDirLeave<br />  ClearErrors<br />  SetOutPath "$INSTDIR" ; what about IfError creating $INSTDIR?<br />  GetTempFileName $1 "$INSTDIR" ; creates tmp file (or fails)<br />  FileOpen $0 "$1" "w" ; error to open?<br />  FileWriteByte $0 "0"<br />  IfErrors notPossible possible<br />  <br />notPossible:<br />  RMDir "$INSTDIR" ; removes folder if empty<br />  MessageBox MB_OK "Not able to write into this directory!"<br />  Abort<br />possible:<br />  FileClose $0<br />  Delete "$1"<br />FunctionEnd</code>
</pre>
    </div>
    <hr />

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]>
  </script>
</body>
</html>
