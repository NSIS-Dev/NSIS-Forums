<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="description" content="NSIS Error in uninstaller"><title>NSIS Error in uninstaller - NSIS Forums</title><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script><link rel="preload" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css" as="style" onload="this.rel='stylesheet'"><link rel="preload" href="../css/style.css" as="style" onload="this.rel='stylesheet'"><noscript><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css"><link rel="stylesheet" href="../css/style.css"></noscript><script>!function(a){"use strict";var b=function(b,c,d){function e(a){return h.body?a():void setTimeout(function(){e(a)})}function f(){i.addEventListener&&i.removeEventListener("load",f),i.media=d||"all"}var g,h=a.document,i=h.createElement("link");if(c)g=c;else{var j=(h.body||h.getElementsByTagName("head")[0]).childNodes;g=j[j.length-1]}var k=h.styleSheets;i.rel="stylesheet",i.href=b,i.media="only x",e(function(){g.parentNode.insertBefore(i,c?g:g.nextSibling)});var l=function(a){for(var b=i.href,c=k.length;c--;)if(k[c].href===b)return a();setTimeout(function(){l(a)})};return i.addEventListener&&i.addEventListener("load",f),i.onloadcssdefined=l,l(f),i};"undefined"!=typeof exports?exports.loadCSS=b:a.loadCSS=b}("undefined"!=typeof global?global:this);!function(a){if(a.loadCSS){var b=loadCSS.relpreload={};if(b.support=function(){try{return a.document.createElement("link").relList.supports("preload")}catch(b){return!1}},b.poly=function(){for(var b=a.document.getElementsByTagName("link"),c=0;c<b.length;c++){var d=b[c];"preload"===d.rel&&"style"===d.getAttribute("as")&&(a.loadCSS(d.href,d,d.getAttribute("media")),d.rel=null)}},!b.support()){b.poly();var c=a.setInterval(b.poly,300);a.addEventListener&&a.addEventListener("load",function(){b.poly(),a.clearInterval(c)}),a.attachEvent&&a.attachEvent("onload",function(){a.clearInterval(c)})}}}(this);</script></head><body><div class="container"><ol class="breadcrumb"><li><a href="../index.html" class="glyphicon glyphicon-home"></a></li><li><a href="f-65.html">NSIS Discussion</a></li><li class="active">NSIS Error in uninstaller</li></ol><p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=352392">NSIS Error in uninstaller</a></p><br><div class="post"><p class="post-meta"><span class="post-author text-primary">MSG</span><br><span class="post-time small text-muted">22nd November 2012 11:34 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>NSIS Error in uninstaller</strong><br>When I was playing around with the problem in <a href="http://forums.winamp.com/showthread.php?t=352389" target="_blank">this thread</a>, I ran into something rather strange.<br><br>Code:<br><br>outfile "d:\test.exe"<br>page instfiles<br>UninstPage instfiles<br><br>section<br>writeuninstaller "d:\untest.exe"<br>sectionend<br><br>Section "Uninstall"<br>MessageBox MB_OK "Working"<br>SectionEnd<br><br>The installer works fine, but the generated uninstaller throws an NSIS Error ("Error launching installer"). Using NSIS 2.46 and NSIS 2.46-Unicode. Can anyone reproduce?<br><br><br>Edit: Moving untest.txt to a d:\subdir, the uninstaller works fine. This could suggest a permissions issue, but what could the uninstaller be trying to do that would lead to a CRC error?<br>Some details: The Authenticated Users group has everything except Full Control on d:\, while the Users group has only 'read &amp; execute', 'list folder contents' and 'read' access. I'm logged in as a userlevel user.<br><br>Another thing I can imagine is a backslashes issue, something like trying and failing to access d:untest.exe.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Anders</span><br><span class="post-time small text-muted">29th November 2012 16:40 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">allowrootdirinstall true</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">MSG</span><br><span class="post-time small text-muted">30th November 2012 08:38 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Indeed. I'm filing this one as a bug though, because the manual strongly suggests this command is only related to the directory page. In any case, this should not cause the uninstaller to fail launch.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Anders</span><br><span class="post-time small text-muted">30th November 2012 09:03 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">How will the uninstaller end up in the root if the user cannot install there? I'm thinking this is by design. (The uninstaller specific startup code checks the path on purpose)</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">MSG</span><br><span class="post-time small text-muted">30th November 2012 10:01 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">The problem isn't coming up with crazy installation scenarios where the uninstaller might end up in root. If I don't even have a directory page to begin with, and installation to a root proceeds just fine, how am I supposed to realize that uninstallation from a root is not possible without allowrootdirinstall? The problem is that the uninstaller doesn't throw any recognizable error, and fails to launch completely. If it's hardwired to disallow root uninstall, it should say that instead of 'NSIS Error'.</p></div><hr><div class="footer"><p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p></div></div><script src="../js/highlight.pack.js" type="text/javascript"></script><script type="text/javascript">//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]></script></body></html>