<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="description" content="help for dll reg"><title>help for dll reg - NSIS Forums</title><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script><link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css"><link rel="stylesheet" href="../css/style.css" type="text/css"><!--[if lt IE 9]><script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script><script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script><![endif]--></head><body><div class="container"><ol class="breadcrumb"><li><a href="../index.html" class="glyphicon glyphicon-home"></a></li><li><a href="f-65.html">NSIS Discussion</a></li><li class="active">help for dll reg</li></ol><p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=273419">help for dll reg</a></p><br><div class="post"><p class="post-meta"><span class="post-author text-primary">gpseaver</span><br><span class="post-time small text-muted">26th June 2007 04:40 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>help for dll reg</strong><br>i made a NSIS setup installer which contains Dll register,<br>it's ok when i install it locally,<br>then i install it on a vitual machine(vmware 4,winxp), after installed it , run the programme ,it goes wrong , then<br>checked out that the Dlls hadn't been registed .<br><br>here is the code related:<br>Section -Post<br>WriteUninstaller "$INSTDIR\uninst.exe"<br>WriteRegStr ${PRODUCT_UNINST_ROOT_KEY} "${PRODUCT_UNINST_KEY}" "DisplayName" "$(^Name)"<br>WriteRegStr ${PRODUCT_UNINST_ROOT_KEY} "${PRODUCT_UNINST_KEY}" "UninstallString" "$INSTDIR\uninst.exe"<br>WriteRegStr ${PRODUCT_UNINST_ROOT_KEY} "${PRODUCT_UNINST_KEY}" "DisplayVersion" "${PRODUCT_VERSION}"<br>WriteRegStr ${PRODUCT_UNINST_ROOT_KEY} "${PRODUCT_UNINST_KEY}" "URLInfoAbout" "${PRODUCT_WEB_SITE}"<br>WriteRegStr ${PRODUCT_UNINST_ROOT_KEY} "${PRODUCT_UNINST_KEY}" "Publisher" "${PRODUCT_PUBLISHER}"<br>;------------------å†™æ³¨å†Œè¡¨ï¼Œæ³¨å†Œdll<br>regdll "$instdir\pdmftp.dll"<br>regdll "$instdir\rtxsend.dll"<br>regdll "$instdir\ftpsend.ocx"<br>regdll "$instdir\mb.ocx"<br>regdll "$instdir\MSCOMCT2.ocx"<br>WriteRegStr HKCU "Software\pdm" "path" "$instdir\pdm.exe"<br>WriteRegStr HKLM "Software\pdm" "path" "$instdir\pdm.exe"<br>SectionEnd<br><br>sorry for my poor english, i'm a chinese guy ,hehe</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">demiller9</span><br><span class="post-time small text-muted">26th June 2007 05:50 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">I'm just guessing here, but on your box where it seems to work OK, you might have had those controls already registered? Try changing the sequence that you register them, put the ones that depend upon the others after the ones that don't depend upon any others. (I'm thinking that the ocx's might be needed by the pdmftp or rtxsend dlls, and can't register until the ocx's are registered).<br><br>Don</p></div><hr><div class="footer"><p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p></div></div><script src="../js/highlight.pack.js" type="text/javascript"></script><script type="text/javascript">//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]></script></body></html>