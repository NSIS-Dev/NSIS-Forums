<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="description" content="Compile Time Commands"><title>Compile Time Commands - NSIS Forums</title><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script><link rel="preload" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css" as="style" onload="this.rel='stylesheet'"><link rel="preload" href="../css/style.css" as="style" onload="this.rel='stylesheet'"><noscript><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css"><link rel="stylesheet" href="../css/style.css"></noscript><script>!function(a){"use strict";var b=function(b,c,d){function e(a){return h.body?a():void setTimeout(function(){e(a)})}function f(){i.addEventListener&&i.removeEventListener("load",f),i.media=d||"all"}var g,h=a.document,i=h.createElement("link");if(c)g=c;else{var j=(h.body||h.getElementsByTagName("head")[0]).childNodes;g=j[j.length-1]}var k=h.styleSheets;i.rel="stylesheet",i.href=b,i.media="only x",e(function(){g.parentNode.insertBefore(i,c?g:g.nextSibling)});var l=function(a){for(var b=i.href,c=k.length;c--;)if(k[c].href===b)return a();setTimeout(function(){l(a)})};return i.addEventListener&&i.addEventListener("load",f),i.onloadcssdefined=l,l(f),i};"undefined"!=typeof exports?exports.loadCSS=b:a.loadCSS=b}("undefined"!=typeof global?global:this);!function(a){if(a.loadCSS){var b=loadCSS.relpreload={};if(b.support=function(){try{return a.document.createElement("link").relList.supports("preload")}catch(b){return!1}},b.poly=function(){for(var b=a.document.getElementsByTagName("link"),c=0;c<b.length;c++){var d=b[c];"preload"===d.rel&&"style"===d.getAttribute("as")&&(a.loadCSS(d.href,d,d.getAttribute("media")),d.rel=null)}},!b.support()){b.poly();var c=a.setInterval(b.poly,300);a.addEventListener&&a.addEventListener("load",function(){b.poly(),a.clearInterval(c)}),a.attachEvent&&a.attachEvent("onload",function(){a.clearInterval(c)})}}}(this);</script></head><body><div class="container"><ol class="breadcrumb"><li><a href="../index.html" class="glyphicon glyphicon-home"></a></li><li><a href="f-65.html">NSIS Discussion</a></li><li class="active">Compile Time Commands</li></ol><p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=157467">Compile Time Commands</a></p><br><div class="post"><p class="post-meta"><span class="post-author text-primary">Anders</span><br><span class="post-time small text-muted">24th November 2003 21:39 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>Compile Time Commands</strong><br>How could i do this(@ Compile time)?<br><br></p><pre>
<code><br>!define SetupMode "1"<br>...<br>!if ${SetupMode}=="1"<br>!insertmacro DoSomething<br>!else<br>!insertmacro DoTheOtherThing<br>!endif<br></code>
</pre>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br>
      <span class="post-time small text-muted">24th November 2003 21:44 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">If you can get to <a href="http://nsis.sf.net/" target="_blank">http://nsis.sf.net/</a> then you can find the answer in the FAQ on that page. If it's lagging for you too see StrCmp, StrCpy and IntCmp in the manual. Some examples in the Examples directory use those, so you can look at them for usage example.</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Anders</span><br>
      <span class="post-time small text-muted">24th November 2003 22:04 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Isnt StrCmp, StrCpy and IntCmp RunTime only?<br>
      <br>
      What I want is to !include a file only if a define is defined to a certain(sp?) value...</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br>
      <span class="post-time small text-muted">24th November 2003 22:11 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Oh sorry, didn't read that right... I have no ideas for that at the moment, but something with !system would probably do the trick.</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">eccles</span><br>
      <span class="post-time small text-muted">24th November 2003 22:20 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Here's a trick I've used:</p>
      <pre>
<code>!define SetupMode "1"<br>...<br>!define SetupModeIs${SetupMode}<br>!ifdef SetupModeIs1<br>!insertmacro DoSomething<br>!else<br>!insertmacro DoTheOtherThing<br>!endif<br>!undef SetupModeIs${SetupMode}</code>
</pre>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Anders</span><br>
      <span class="post-time small text-muted">24th November 2003 22:26 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">From Help File:<br></p>

      <blockquote>
        !system: This command will execute 'command' using a call to system()
      </blockquote>i dont know what 'system()' is and the only example i could find was in makensis.nsi:<br>

      <blockquote>
        !system '"${NSISDIR}\Bin\InstallCVSData.exe" nooverwrite'<br>
        !echo "Compiling CVS Data Setup..."<br>
        !system '"${NSISDIR}\makensis.exe" /V1 cvsdata.nsi' = 0
      </blockquote>dont know what those lines do but it looks to me like they call an external program...<br>
      <br>
      what I need is a C preprocessor like command...<br>
      <br>
      from a normal StdAfx.h file:<br>

      <blockquote>
        #if _MSC_VER &gt; 1000 <font color="red">&lt;--This is what I need</font><br>
        #pragma once<br>
        #endif // _MSC_VER &gt; 1000
      </blockquote>I'm guessing that this is currently not possible, but could support be added 4 this in the future??
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Joost Verburg</span><br>
      <span class="post-time small text-muted">25th November 2003 15:42 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">It's currently not possible, but if you give more details we might be able to help you with other solutions.</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Anders</span><br>
      <span class="post-time small text-muted">26th November 2003 21:56 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">i guess i have to hack nsis myself then, script.cpp would be the right place to do it right?</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br>
      <span class="post-time small text-muted">26th November 2003 22:00 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Yes, but why not use eccle's method?</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Anders</span><br>
      <span class="post-time small text-muted">26th November 2003 22:08 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">because i want to use stuff like !if ${somedefine} &gt; 4...</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br>
      <span class="post-time small text-muted">26th November 2003 22:14 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">OK, good luck. Submit a patch if you get it working. If you don't you can use !system to call anotehr program that will do this, like perl for example. You can get the program to write a NSH file which you would !include and use.</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Anders</span><br>
      <span class="post-time small text-muted">26th November 2003 22:27 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">what im trying do is create a script file that makes it real easy to create a setup...<br>
      <br>
      this is all i need to create the setup for one of my apps:<br></p>
      <pre>
<code><br>!define APP_NAME "YourApp"<br>!define APP_COMPANY "Nullsoft Fan =)"<br>!define APPFILE_MAIN_SRCTREEPATH "..\Source\ReleaseU\${APPFILE_MAIN_BINNAME}"<br><br>!include "nsw.nsh"<br></code>
</pre><br>
      <br>
      This script will:<br>
      -Install ${APPFILE_MAIN_SRCTREEPATH} in $PROGRAMFILES\${APP_NAME}<br>
      -Create a uninstaller and register this in the registry.<br>
      -Show The License page<br>
      -Copy the license file to $InstDir<br>
      -AutoCreate Shortcut for the main program file in: (Can be disabled on the componentpage (Classic &amp; Modern GUI))<br>
      --The Desktop<br>
      --The QuickLaunch area
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br>
      <span class="post-time small text-muted">26th November 2003 23:50 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">A worthy goal indeed :)</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">azerger</span><br>
      <span class="post-time small text-muted">22nd September 2004 20:23 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Joost or kichik,<br>
      Has this feature ever been added to nsis? It was posted over a year ago and I am trying to do the same thing.<br>
      <br>
      <a href="http://forums.winamp.com/showthread.php?s=&amp;postid=1477361#post1477361" target="_blank">http://forums.winamp.com/showthread....61#post1477361</a><br>
      <br>
      Its seems straight forward to add just a binary compare equals to the compile time !ifdef APP_COMP == "sdfsd" to nsis. Can this be done?<br>
      Was it done?<br>
      Thanks,<br>
      art</p>
    </div>
    <hr>

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]></script></body></html>