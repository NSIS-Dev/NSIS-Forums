<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="description" content="Creating dynamic sections"><title>Creating dynamic sections - NSIS Forums</title><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script><link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css"><link rel="stylesheet" href="../css/style.css" type="text/css"><!--[if lt IE 9]><script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script><script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script><![endif]--></head><body><div class="container"><ol class="breadcrumb"><li><a href="../index.html" class="glyphicon glyphicon-home"></a></li><li><a href="f-65.html">NSIS Discussion</a></li><li class="active">Creating dynamic sections</li></ol><p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=333450">Creating dynamic sections</a></p><br><div class="post"><p class="post-meta"><span class="post-author text-primary">gokussx4</span><br><span class="post-time small text-muted">11th August 2011 20:26 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>Creating dynamic sections</strong><br>Thanks first of all for viewing this thread as I know some of the seniors are thinking "why didn't he just search the forum?"<br><br>Fortunately I have and I don't think the solution of creating a "bunch" of empty sections and changing the name of that section at runtime is a solution for me.<br><br>Though I would think this problem would be one that is quite common I could be mistaken.<br><br>My example is that I want the sections that are available for selection to be based on if a directory or file exists.<br><br>One would hope there would be a insert section command of some sort but that doesn't seem to be the case.<br><br>Are there any solutions for this out there or another idea besides creating empty sections in the script prior to runtime?<br><br>Have a great day! :)</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">MSG</span><br><span class="post-time small text-muted">11th August 2011 20:32 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">There are no other solutions. Sections are defined at compiletime. Your only option is to have a 100 hidden sections, and rename/unhide them at runtime. Why do you think this is not a solution for you?</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">gokussx4</span><br><span class="post-time small text-muted">11th August 2011 20:49 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Thanks for the reply.<br><br>For our particular install case, if a plugin developer creates a new project (which per plugin is simply a dll, pdb and dependency folder) then we want that new plugin to appear by the name of the folder ( or file doesn't really matter) the next time a build occurs. This would allow new plugins to be created and be picked up by the installer without someone having to modify the nsi script.<br><br>Arbitrarily added x number of sections could mean that you reach a limit of the sections and have to modify the script.<br><br>If this is the only solution, though, is there any overhead of creating so many blank sections that will not be used during that time?</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">MSG</span><br><span class="post-time small text-muted">11th August 2011 21:08 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Aha, so you want to create sections depending on files present at compile time? As far as I know there are no compiletime commands in NSIS that allow you to enumerate compiletime files/folders, so you'll need to run an external script/exe that generates nsi code depending on file existence. See this thread: <a href="http://forums.winamp.com/showthread.php?t=332913" target="_blank">http://forums.winamp.com/showthread.php?t=332913</a><br><br>(You can execute exes, vbs scripts, etc during compilation using the !system command.)</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">demiller9</span><br><span class="post-time small text-muted">11th August 2011 21:19 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">My suggestion is to not think of your plugins as equating to NSIS sections.<br><br>Just create a custom page with a treeview control, where each of your plugin folders is shown as an item in the tree. Allow the user to select or unselect them, and then read the tree settings when the page is left (when Next is clicked). Having read the settings, you can process them (when Install is clicked) in one section.<br><br>You don't need dynamic sections at all. Your script will enumerate the parent folder to find the plugins and display all of them in the treeview.<br><br>Don</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">gokussx4</span><br><span class="post-time small text-muted">11th August 2011 22:36 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"></p><blockquote><small>Originally posted by MSG</small><br>Aha, so you want to create sections depending on files present at compile time? As far as I know there are no compiletime commands in NSIS that allow you to enumerate compiletime files/folders, so you'll need to run an external script/exe that generates nsi code depending on file existence. See this thread: <a href="http://forums.winamp.com/showthread.php?t=332913" target="_blank">http://forums.winamp.com/showthread.php?t=332913</a><br><br>(You can execute exes, vbs scripts, etc during compilation using the !system command.)</blockquote><blockquote><small>Originally posted by demiller9</small><br>My suggestion is to not think of your plugins as equating to NSIS sections.<br><br>Just create a custom page with a treeview control, where each of your plugin folders is shown as an item in the tree. Allow the user to select or unselect them, and then read the tree settings when the page is left (when Next is clicked). Having read the settings, you can process them (when Install is clicked) in one section.<br><br>You don't need dynamic sections at all. Your script will enumerate the parent folder to find the plugins and display all of them in the treeview.<br><br>Don</blockquote>This is a great design idea! I like this one the most because it would seem to have less maintenance. Thank you!</div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">gokussx4</span><br><span class="post-time small text-muted">11th August 2011 22:38 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">demiller9,<br><br>Do you have an example link you could provide something that would get me started for a similar solution? I am not well versed in NSIS.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">gokussx4</span><br><span class="post-time small text-muted">11th August 2011 22:40 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Thank you both for your great suggestions! This will definitely help me accomplish my goals with our current installer.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">MSG</span><br><span class="post-time small text-muted">12th August 2011 06:46 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"></p><blockquote><small>Originally posted by demiller9</small><br>You don't need dynamic sections at all. Your script will enumerate the parent folder to find the plugins and display all of them in the treeview.</blockquote>Err... That only works at runtime. He explained he wants to add sections automatically depending on files present during *compiling*.</div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">demiller9</span><br><span class="post-time small text-muted">12th August 2011 07:04 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">I may have misunderstood his desire, but this is what I think he has asked to do: Create an installer that will show an 'unlimited' number of plugin choices (sections, he termed them). I read this to be some-random-app plugins, not NSIS plugins.<br><br>I suggested that the 'sections' are just a custom page with a treeview, and will be processed by a single NSIS section. The plugin files it will install have ALL been included in the installer using a wildcard on the parent folder, and could be temporarily extracted to the target system into the PlugInsDir. In that location the NSIS runtime can enumerate them and create the treeview entries. Extracting them to the PlugInsDir will ensure they will all be deleted when the installer terminates.<br><br>@MSG: your suggestion to use a vbscript to enumerate the plugins at compile time and generate NSIS code is perfectly sound. The generated code would define the sections to show the plugins and, inside the sections, file commands to install them. It will handle as many plugins as it finds. The benefit might be simpler coding (he doesn't need to code a custom page with a treeview); the extra vbscript code is only a small negative.<br><br>Don</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">MSG</span><br><span class="post-time small text-muted">12th August 2011 08:23 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Ah, I see what you mean now. Smart solution, although the temporary extraction at runtime might be a disadvantage, requiring HDD space before installation has begun. Personally I'd go for simple compiletime enumeration (could use an NSIS exe for that, even). But it's an interesting idea, to be sure.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">gokussx4</span><br><span class="post-time small text-muted">12th August 2011 15:40 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">I may not have explained this properly, do excuse me, but I did mean dynamically pull the folders files at the time of compiling the installer. Thanks again both, this has been very helpful.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">bella10388</span><br><span class="post-time small text-muted">16th August 2011 08:38 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Quote:</p><hr>Such a very amazing link!<table cellpadding="6" cellspacing="0" border="0" width="100%"><tr><td class="alt2"><hr>Originally Posted by <strong>MSG</strong> (Post 2794111) Aha, so you want to create sections depending on files present at compile time? As far as I know there are no compiletime commands in NSIS that allow you to enumerate compiletime files/folders, so you'll need to run an external script/exe that generates nsi code depending on file existence. See this thread: <a href="http://forums.winamp.com/showthread.php?t=332913" target="_blank">http://forums.winamp.com/showthread.php?t=332913</a><br><br>(You can execute exes, vbs scripts, etc during compilation using the !system command.)<hr></td></tr></table><br><div class="footer"><p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p></div></div><script src="../js/highlight.pack.js" type="text/javascript"></script><script type="text/javascript">//<![CDATA[
    hljs.initHighlightingOnLoad();
    //]]></script></div></body></html>