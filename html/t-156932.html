<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="Multi-User Install Logic" />

  <title>Multi-User Install Logic - NSIS Forums</title>
  <script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script>
  <!-- Bootstrap core CSS -->

  <link rel="stylesheet" type="text/css" href="//netdna.bootstrapcdn.com/bootswatch/3.0.1/readable/bootstrap.min.css" />
  <link rel="stylesheet" href="../css/style.css" type="text/css" /><!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!--[if lt IE 9]>
                <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
                <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->
</head>

<body>
  <div class="container">
    <!-- Put navigation bar here -->

    <ol class="breadcrumb">
      <li><a href="../index.html" class="glyphicon glyphicon-home"></a></li>

      <li><a href="f-65.html">NSIS Discussion</a></li>

      <li class="active">Multi-User Install Logic</li>
    </ol>

    <p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=156932">Multi-User Install Logic</a></p><br />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">jaschulz</span><br />
      <span class="post-time small text-muted">20th November 2003 19:33 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>Multi-User Install Logic</strong><br />
      Can anyone point me to a document that explains the logic of installing software on a machine with multiple users. For instance, many example NSIS scripts put the software in C:\Program Files\MyApp (or something of the sort) and then makes the install user specific by placing info under the HKCU key in the reg. Okay, suppose two users install my app on the same machine. The second install over-writes the copy of my app already in place in c:\Program Files\MyApp (which is fine assuming that both installs are of the same version number). But now one user decides to uninstall. Doesn't that effectively unstall MyApp for the second user as well? What is the right way to handle this sort of thing?<br />
      <br />
      JAS</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">myne</span><br />
      <span class="post-time small text-muted">20th November 2003 19:43 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">So in that scenario you shouldnt use HKCU, you should use HKLM\software instead. For the startmenu you should use $ALLUSERSPROFILE\startmenu. (cmd &gt; set [enter] - it's a windows variable)<br />
      <br />
      That will make the install into a generic one availiable to all users - I assume this is what you are asking? Ofcourse if one user uninstalls they'll all uninstall<br />
      <br />
      Hope this helps</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">jaschulz</span><br />
      <span class="post-time small text-muted">20th November 2003 19:48 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Well, that's part of what I need to know. Using your info, I can see that I could offer the installer the choice between making the app available to all users, or installing it only for the current user. But I am still left with my question about what happens if two users of the same machine chose the second of these options (i.e. if each of them installs only for himself). In that circumstance, doesn't one user deciding to uninstall effectively unstall for the other user as well?<br />
      <br />
      JAS</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">myne</span><br />
      <span class="post-time small text-muted">20th November 2003 19:54 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Well yes, it would delete the files rendering the program unusable to others. However if they both installed it then one user would still have (useless) start menu shortcuts</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">jaschulz</span><br />
      <span class="post-time small text-muted">20th November 2003 22:47 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">So, I suppose, the only way to avoid this is to have the installer keep a record in the registry of how many users there are. Am I the only one who has ever worried about this?<br />
      <br />
      JAS</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">myne</span><br />
      <span class="post-time small text-muted">21st November 2003 00:40 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">You could just tell your users not to uninstall things without permission...</p>
    </div>
    <hr />

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]>
  </script>
</body>
</html>
