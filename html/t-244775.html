<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="installer crashes on launch" />

  <title>installer crashes on launch - NSIS Forums</title>
  <script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script>
  <!-- Bootstrap core CSS -->

  <link rel="stylesheet" type="text/css" href="//netdna.bootstrapcdn.com/bootswatch/3.0.1/readable/bootstrap.min.css" />
  <link rel="stylesheet" href="../css/style.css" type="text/css" /><!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!--[if lt IE 9]>
                <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
                <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->
</head>

<body>
  <div class="container">
    <!-- Put navigation bar here -->

    <ol class="breadcrumb">
      <li><a href="../index.html" class="glyphicon glyphicon-home"></a></li>

      <li><a href="f-65.html">NSIS Discussion</a></li>

      <li class="active">installer crashes on launch</li>
    </ol>

    <p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=244775">installer crashes on launch</a></p><br />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">jtweather</span><br />
      <span class="post-time small text-muted">27th April 2006 21:59 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>installer crashes on launch</strong><br />
      Hello,<br />
      <br />
      I am a first-time user of NSIS and I have a problem running an installer that I have created. When I execute the installer, I recieve an error message stating that the installer has caused a problem and needs to close. The installer was written and opened on Windows XP Service Pack 2. I am not sure what caused the error or if I have the script file or the configuration files written correctly.<br />
      <br />
      The attached text file includes the contents of the script and configuration files. Additionaly, I had used the InstallOptionsEx plugin as well as the EBanner Plugin in the installer.<br />
      <br />
      Any help in correcting the error message or the script file is greatly appreciated. Thank you for your support.<br />
      <br />
      jtweather</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
      <span class="post-time small text-muted">27th April 2006 22:07 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Don't call both InstallOptionsEx::Dialog and InstallOptionsEx::Show, only InstallOptionsEx::Dialog.<br />
      <br />
      -Stu</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">jtweather</span><br />
      <span class="post-time small text-muted">27th April 2006 22:17 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">I now took out the InstallOptionsEx::Show calls, however, I am still getting the error message when I launch the installer.<br />
      <br />
      jtweather</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
      <span class="post-time small text-muted">27th April 2006 22:23 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Remove the Call pre02 and Call pre03 instructions.<br />
      Not sure what you are trying to do there, but you can't show an InstallOptions dialog in the Leave function of a page.<br />
      <br />
      -Stu</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">jtweather</span><br />
      <span class="post-time small text-muted">27th April 2006 22:36 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">I removed the call pre02 and call pre03 functions. I also removed the leave01 and leave02 callback functions. Unfortunately, I am still getting the error message.<br />
      <br />
      jtweather</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Red Wine</span><br />
      <span class="post-time small text-muted">27th April 2006 22:53 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">I'd suggest try to get an experience on standard InstallOptions 'playing' with bundled examples and then make your modifications and add your personal futures one by one. :-)</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
      <span class="post-time small text-muted">28th April 2006 08:47 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">I guess it must be the ebanner plugin causing the crash then, although the other things I mentioned would probably have crashed your installer as well.<br />
      <br />
      Do the files 'media\audio.wav' 'media\banner.bmp' exist? What I mean by this is do they exist on <b>run time</b>. There's no code there to extract the files from your installer...?<br />
      <br />
      -Stu</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">jtweather</span><br />
      <span class="post-time small text-muted">28th April 2006 20:00 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">The files "audio.wav" and "banner.bmp" do exist on my system. They are located in "media/", which is a subdirectory of the directory that the installer was created in. Can the installer read the files from the subfolder, or do I have to compile the files in the installer?<br />
      <br />
      jtweather</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
      <span class="post-time small text-muted">28th April 2006 20:35 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">They must be extracted at run time with the File instruction.<br />
      You must also specify the full path to the files and not the relative path.<br />
      <br />
      The best place to put these files is in the $PLUGINSDIR folder. Make sure you use InitPluginsDir before using the constant.<br />
      <br />
      -Stu</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">jtweather</span><br />
      <span class="post-time small text-muted">28th April 2006 21:23 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">I added the necessary File instructions and changed all $EXEDIR varibles to $PLUGINSDIR. I recompiled the installer, ran it, and still got the error.<br />
      <br />
      Also, I took notice that, even though I had disabled the Next and Back buttons for the custom pages in the configuration files, the buttons showed up on the page. The attached text file has the modified code that is up to date. Do I still have errors in the modified code, also, are the buttons causing the error?<br />
      <br />
      jtweather</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
      <span class="post-time small text-muted">28th April 2006 22:08 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">It doesn't help using forward strokes (/) in the file paths for the ebanner plugin calls.<br />
      If that doesn't fix it then try commenting the ebanner calls.<br />
      <br />
      -Stu</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">jtweather</span><br />
      <span class="post-time small text-muted">28th April 2006 22:58 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">I changed the forward strokes to backward strokes, and I still get the error. I then thought about commenting the ebanner calls, but I am unsure if that means that I have to add comments to the ebannner calls. Do I have to add comments?<br />
      <br />
      jtweather</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Mr Inches</span><br />
      <span class="post-time small text-muted">29th April 2006 08:17 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">It seems the problem is that the ebanner plugin does not like being unloaded while it is displaying the banner or playing the audio file.<br />
      <br />
      Add the /UNLOAD switch to each of the ebanner plugin calls and the crashes stop.<br />
      <br />
      e.g. instead of<br />
      <br />
      ebanner::play '$PLUGINSDIR/audio.wav'<br />
      ebanner::show '$PLUGINSDIR/banner.bmp'<br />
      <br />
      use<br />
      <br />
      ebanner::play /NOUNLOAD '$PLUGINSDIR/audio.wav'<br />
      ebanner::show /NOUNLOAD '$PLUGINSDIR/banner.bmp'<br />
      <br />
      This behaviour is quite common with plugins, check the readme.txt file that accompanies the ebanner plugin.<br />
      <br />
      Duncan</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Mr Inches</span><br />
      <span class="post-time small text-muted">29th April 2006 08:25 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Amendment to above, don't forget to call ebanner::stop without the /UNLOAD switch when you are done with the banner, so that NSIS can delete the $PLUGINSDIR when your installer exits.<br />
      <br />
      BTW: The smilies are supposed to be "p"s, I think something in the parsing changed them on me!<br />
      <br />
      Duncan</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">galil</span><br />
      <span class="post-time small text-muted">29th April 2006 08:54 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"></p>

      <blockquote>
        <i>Originally posted by Mr Inches</i><br />
        BTW: The smilies are supposed to be "p"s, I think something in the parsing changed them on me!
      </blockquote>Well, you could choose to Edit your post and check the "Disable Smilies in This Post" option :)
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
      <span class="post-time small text-muted">29th April 2006 09:58 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Fixed his post. :)<br />
      <br />
      -Stu</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">jtweather</span><br />
      <span class="post-time small text-muted">29th April 2006 12:27 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">I added the /NOUNLOAD switch to the Ebanner calls. I also changed $EXEDIR to $PLUGINSDIR in the InstallOptionsEx calls. The installer now opens without an error, however, the audio file ('audio.wav') won't play and 'banner.bmp' will not display. How do I get the audio to play and 'banner.bmp' to display now that I have the /NOUNLOAD switch in the code?<br />
      <br />
      Attached is a copy of the code with the changes I made.<br />
      <br />
      jtweather</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
      <span class="post-time small text-muted">29th April 2006 12:33 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">The call to InstallOptionsEx will pause the execution process. No instructions will be executed after the plugin call until you click the Next button.<br />
      <br />
      Move the ebanner plugin calls above the InstallOptionsEx plugin calls.<br />
      <br />
      -Stu</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">jtweather</span><br />
      <span class="post-time small text-muted">29th April 2006 13:15 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">I moved the Ebanner calls, however, 'audio.wav' still won't play and 'banner.bmp' still won't show.<br />
      <br />
      jtweather</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
      <span class="post-time small text-muted">29th April 2006 15:19 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Hmm I can't think of anything more.<br />
      Please attach your newest script.<br />
      <br />
      -Stu</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">jtweather</span><br />
      <span class="post-time small text-muted">29th April 2006 15:22 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">My newest script is attached.<br />
      <br />
      jtweather</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Comperio</span><br />
      <span class="post-time small text-muted">29th April 2006 15:30 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">As I understand, the EBanner plugin only works in the Installation page (within a section) and not in an InstallOptions page. (at least that's how I'm reading it. And the included example seems to show this as well.)<br />
      <br />
      You may want to ask the author (Takhir) or post a message to <a href="http://forums.winamp.com/showthread.php?s=&amp;threadid=221296" target="_blank">this thread</a> for clarification.<br />
      <br />
      Also:<br />
      If you use eBanner, make sure you end it with an eBanner::stop call. This will unload the plugin from memory and prevent a windows error from occuring when the installation is finished (or if you abort your installation prematurely).</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">jtweather</span><br />
      <span class="post-time small text-muted">29th April 2006 15:45 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">The EBanner plugin was working ('audio.wav' was playing) with the InstallOptionsEx pages, until I moved the EBanner calls. I heard 'audio.wav' play prior to recieving the error message.<br />
      <br />
      jtweather</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">jtweather</span><br />
      <span class="post-time small text-muted">29th April 2006 16:01 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Also, I added the Ebanner::stop calls to the script. The audio still doesn't play, although I can hear 10 milliseconds of the audio file when the installer launches. Is there a problem with the configuration files for InstallOptionsEx? If so, is that why the audio won't play?<br />
      <br />
      Attached is a copy of my configuration files for InstallOptionsEx. The attachment is up-to-date.<br />
      <br />
      jtweather</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Comperio</span><br />
      <span class="post-time small text-muted">29th April 2006 20:45 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">I'm not sure how you were getting ebanner to either play a sound or display the image in the installoptions page.<br />
      <br />
      To test, I used your script as a starting point and created my own InstallOptions.INI files. (Basically just INI files with just a group box and an image).<br />
      <br />
      I never got a sound or image in any of the installoptions pages. But, when I inserted the ebanner calls the section, I got both the sound an image.<br />
      <br />
      <br />
      And, I got the same results using the regular InstallOptions as I did using InstallOptionsEX.<br />
      <br />
      Based on this, I believe that eBanner only works in sections, not pages. Whether this is by-design or not remains to be answered. But, I think this proves that the problem has nothign to do with InstallOptionsEX.<br />
      <br />
      My samples (minus the pictures and wav file) are attached if you want to play with them.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">jtweather</span><br />
      <span class="post-time small text-muted">29th April 2006 22:03 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">I used the provided example script to modify my script, but the audio still will not play.<br />
      <br />
      Also, I had the EBanner calls after the InstallOptionsEx call, and I had to wait for the TimeOut feature of InstallOptionsEx to change the first page (Custom Page 1) to the second page (Custom Page 2) before I could hear the audio. The call 'Ebanner::Play $PLUGINSDIR\audio.wav' was located inside the Callback Function 'pre01' which was associated with the first page (Custom Page 1). My initial problem was that the audio was playing on the wrong page and that I had to click Next to make the audio play.<br />
      <br />
      Is there any way I could correct that initial problem so that the audio plays on the right page without clicking Next? Or is there a way that, along with the provided script, I can correct my script that I currently have so that my installer works?<br />
      <br />
      jtweather</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Mr Inches</span><br />
      <span class="post-time small text-muted">30th April 2006 00:54 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Audio is not playing on the first page because you don't have a call to the ebanner::play function in the page's pre01 function.<br />
      <br />
      The reason you need the timeouts to move from page to page is that you have set 'NextEnabled' in each of the first two page INI files to 0, disabling these buttons (Continue in your case).<br />
      <br />
      Set 'NextEnabled' to 1 in each file and you can actually use the Next (Continue) buttons!!<br />
      <br />
      The banner appears to only display on INSTPAGE.<br />
      <br />
      Looking at the Ebanner code for the show function, it probably has to do with how Takhir locates the window to draw it on - I think the code is specifically to locate the Details Log window which doesn't exist until the INSTPAGE is displayed.<br />
      <br />
      However, looking at the InstallOptionsEx documentation, you can embed an Image field directly onto your custom page. Maybe this will do what you want (except move the image).<br />
      <br />
      Duncan</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">jtweather</span><br />
      <span class="post-time small text-muted">30th April 2006 01:53 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">I have my installer running without problems, although the file 'video.avi' is not playing inside the window. I do have the file defined in the InstallOptionsEx configuration file '01-01-01b.ini' as an image. My goal was to have the video play as an an animation on the page. Is that possible with InstallOptionsEx. If not, can I run a gif file as an animation using InstallOptionEx? Or does InstallOptionsEx define an animation as an animated cursor?<br />
      <br />
      jtweather</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Comperio</span><br />
      <span class="post-time small text-muted">30th April 2006 03:21 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Just a guess:<br />
      Is is possible that perhaps your AVI file is not saved in the proper format? (try looking at the avi file's properties in Windows.)<br />
      <br />
      According to the docs, an AVI file must be:<br /></p>

      <blockquote>
        an Audio Video Interleave file without sound with no or with run-length of 8 bits (BI_RLE8) encoding compression
      </blockquote>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">jtweather</span><br />
      <span class="post-time small text-muted">30th April 2006 13:46 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">The AVI file I was using was in the right format. I used the Microsoft RLE Codec to create the 8-bit compressed AVI file. Am I using the right codec to compress the AVI file?<br />
      <br />
      jtweather</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Comperio</span><br />
      <span class="post-time small text-muted">30th April 2006 21:05 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">hmm...<br />
      In testing it here, I'm having similiar issues. Looks like it may be something to do with InstallOptionsEx. You'll probably need to contact the author of the plugin.</p>
    </div>
    <hr />

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]>
  </script>
</body>
</html>
