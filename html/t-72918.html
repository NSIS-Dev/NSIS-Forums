<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="description" content="Close Running Application"><title>Close Running Application - NSIS Forums</title><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script><link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css"><link rel="stylesheet" href="../css/style.css" type="text/css"></head><body><div class="container"><ol class="breadcrumb"><li><a href="../index.html" class="glyphicon glyphicon-home"></a></li><li><a href="f-65.html">NSIS Discussion</a></li><li class="active">Close Running Application</li></ol><p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=72918">Close Running Application</a></p><br><div class="post"><p class="post-meta"><span class="post-author text-primary">Yathosho</span><br><span class="post-time small text-muted">22nd January 2002 23:29 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>Close Running Application</strong><br>&nbsp; i remember the FindWindow command in NSIS 1.4x could detect if a software was running during the installation-process and close it.<br><br>now that the commands changed, i'm in need of help.<br><br>i want my setup to<br><br>1) detect if winamp is running and force the user to close it<br><br>or<br><br>2) close winamp without asking<br><br>if you can help me, please paste the syntax. the makensis.html wasnt a big help for me!<br><br>thx in advance,<br><br>kb</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">rainwater</span><br><span class="post-time small text-muted">22nd January 2002 23:55 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">This is from functions.htm in the nsis distro:<br></p><pre>
<code>
CloseWinamp
<br>  Push$0
<br>  loop:
<br>   FindWindow $0 "Winamp v1.x"
<br>   IntCmp $0 0 done
<br>     SendMessage$0 16 0 0
<br>     Sleep 100
<br>     Goto loop
<br>  done:
<br> Pop $0
<br>FunctionEnd 
<br>&gt;
</code>
</pre>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Yathosho</span><br>
      <span class="post-time small text-muted">23rd January 2002 00:02 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">i remember i tried this before. nothing happening. reading the makensis.html it should be possible with FindWindow/SendMessage, but i have no clue how that works. this function does nothing, but thanks anyhow for the quick reply!</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">rainwater</span><br>
      <span class="post-time small text-muted">23rd January 2002 00:40 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">I just ran it and it closed winamp just like it should. Are you calling the function?</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Yathosho</span><br>
      <span class="post-time small text-muted">23rd January 2002 01:28 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">i did copy+paste =)<br>
      <br>
      what version of nsis did you use? mine is 1.94</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">rainwater</span><br>
      <span class="post-time small text-muted">23rd January 2002 01:40 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">I'm using 1.94<br>
      <br></p>
      <pre>
<code>
Name "CloseWinamp"
<br>&gt;Outfile "closewinamp.exe"
<br><br>&gt;Section -
<br>    Call CloseWinamp
<br>SectionEnd
<br><br>&gt;Function CloseWinamp
<br>  Push$0
<br>  loop:
<br>   FindWindow $0 "Winamp v1.x"
<br>   IntCmp $0 0 done
<br>     SendMessage$0 16 0 0
<br>     Sleep 100
<br>     Goto loop
<br>  done:
<br> Pop $0
<br>FunctionEnd 
<br>&gt;
</code>
</pre>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">F. Heidenreich</span><br>
      <span class="post-time small text-muted">23rd January 2002 05:54 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">This will not work for the current BETA of Winamp. If you want to close a BETA version simply replace</p>
      <pre>
<code>FindWindow*$0*"Winamp*v1.x"</code>
</pre><br>
      with
      <pre>
<code>FindWindow $0 "STUDIO"</code>
</pre><br>
      <br>
      ~ Florian
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">rainwater</span><br>
      <span class="post-time small text-muted">23rd January 2002 15:31 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Doh. It never crossed my mind they might be refering wo Winamp 3. :cool:</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Yathosho</span><br>
      <span class="post-time small text-muted">23rd January 2002 21:51 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">thank you very much! works now, and i added both functions to support both versions =)</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">cchian</span><br>
      <span class="post-time small text-muted">24th January 2002 05:34 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Excuse my ignorance on this topic, but how do you find out the name of the Window you want to close if you did not write the application you are trying to close?<br>
      <br>
      -Carlos</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">F. Heidenreich</span><br>
      <span class="post-time small text-muted">24th January 2002 08:38 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Carlos,<br>
      there is a tool called Spy++ that ships with Visual Studio. With this tool you could identify the window class or window handle of every open window.<br>
      There are similar tools called <a href="http://www.codeproject.com/useritems/windowfinder.asp" target="_blank">Window Finder</a> (which ships with source code) and <a href="http://www.gena01.com/win32spy/" target="_blank">WinSpy</a>.<br>
      <br>
      <a href="http://forums.winamp.com/member.php?s=&amp;action=getinfo&amp;userid=44024" target="_blank">Kichik</a> uploaded the Spy program from the platform SDK at <a href="http://forums.winamp.com/showthread.php?s=&amp;threadid=69348" target="_blank">this</a> thread.<br>
      <br>
      ~ Florian</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">cchian</span><br>
      <span class="post-time small text-muted">24th January 2002 13:57 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Thank you for all those useful links Florian, they worked great!!!<br>
      <br>
      -Carlos</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">benp</span><br>
      <span class="post-time small text-muted">25th January 2002 14:01 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>kill task</strong><br>
      &nbsp; is there an other way to close apps like the above one<br>
      i mean a command like kill (killtask ...)"exename"<br>
      is more simplier than write everytime a function like the findwindow...<br>
      is there a way to implement this command in the next releases of nsis<br>
      <br>
      sorry for my bad english:confused:</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Pomflain</span><br>
      <span class="post-time small text-muted">25th January 2002 14:36 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Just make a function to do that an always pass in "exename" in one of thhe registers. Name the function "killtask" if you want, then just Call killtask</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">benp</span><br>
      <span class="post-time small text-muted">25th January 2002 15:00 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>example</strong><br>
      &nbsp; can you give me an example please???:hang:</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">rainwater</span><br>
      <span class="post-time small text-muted">25th January 2002 16:44 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"></p>
      <pre>
<code>
CloseApplication
<br>  Pop$1
<br>  Push$0
<br>  loop:
<br>   FindWindow $0 $1
<br>    IntCmp$0 0 done
<br>     SendMessage$0 16 0 0
<br>     Sleep 100
<br>     Goto loop
<br>  done:
<br> Pop $0
<br>FunctionEnd
<br><br>&gt;Function .onInit
<br>  Push "Winamp v1.x"
<br>  Call CloseApplication
<br>FunctionEnd 
<br>&gt;
</code>
</pre>Push the class name of the application before calling it, then the closeapplication will close it.
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">benp</span><br>
      <span class="post-time small text-muted">25th January 2002 17:04 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>ah</strong><br>
      &nbsp; ah yes ok thank you :) :) :)</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">benp</span><br>
      <span class="post-time small text-muted">26th January 2002 14:11 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>no</strong><br>
      &nbsp; that way wont work because the task i want to close runs in the background<br>
      i have found the window name but it close only the (invisible) window and not the task<br>
      the task is still shown in taskmon<br>
      <br>
      is there an other way to close this because i can not write over the file<br>
      <br>
      please help :confused: :confused:</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">ksyksy</span><br>
      <span class="post-time small text-muted">28th January 2002 06:11 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>please Tell me!! help me!!</strong><br>
      &nbsp; I can not English Very well.<br>
      <br>
      I want to closeing MYSQL daemon.<br>
      please Tell me. help.<br>
      <br>
      Function CloseWinamp<br>
      Push $0<br>
      loop:<br>
      FindWindow $0 "Winamp v1.x" &lt;== How Can i set...<br>
      IntCmp $0 0 done<br>
      SendMessage $0 16 0 0<br>
      Sleep 100<br>
      Goto loop<br>
      done:<br>
      Pop $0</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">felfert</span><br>
      <span class="post-time small text-muted">28th January 2002 07:09 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">In case of MySQL, you can <b>NOT</b> simply kill the daemon. If you do that, you will probably loose database consitency. Instead, simply run the mysqladmin commandline-tool:<br>
      <br>
      C:\mysql\bin\mysqladmin shutdown<br>
      <br>
      This terminates the server gracefully.<br>
      <br>
      From within your script, this would be:<br>
      <br></p>
      <pre>
<code>
stopMySQL
<br>  ExecWait "C:\\mysql\\bin\\mysqladmin shutdown"
<br>&gt;FunctionEnd 
<br>&gt;
</code>
</pre><b>Note:</b><br>
      Depending on your setup, this probably needs to specify a database admin-user and his password on the commandline.<br>
      <font color="red"><b>See mysql docs</b></font>...<br>
      <br>
      A question:<br>
      Why do you want to shutdown the DB-server?<br>
      Nearly anything can be done <b>without</b> shutting down MySQL.<br>
      <br>
      -Fritz
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">ksyksy</span><br>
      <span class="post-time small text-muted">28th January 2002 07:21 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>Just, I want to Know... Mysql Daemon State.</strong><br>
      &nbsp; How do i know... MySQL Daemon State. (RUNning? OR Not RUNning)<br>
      <br>
      If (MySQL daemon == running) Sending SQL query To MySQL server.<br>
      else message "Please Running MySQL Daemon"<br>
      <br>
      <br>
      &lt;= please teach me. help me.<br>
      How can i know MySQL Daemon State.</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">linuxamp</span><br>
      <span class="post-time small text-muted">13th March 2002 08:59 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>Re: ah</strong><br>
      &nbsp;</p>

      <blockquote>
        <i>Originally posted by benp</i><br>
        <b>that way wont work because the task i want to close runs in the background<br>
        i have found the window name but it close only the (invisible) window and not the task<br>
        the task is still shown in taskmon<br>
        <br>
        is there an other way to close this because i can not write over the file<br></b>
      </blockquote>yes that is true.<br>
      it is March, did you find a way to cloes the running task?:)<br>
      thank you
    </div>
    <hr>

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]></script></body></html>