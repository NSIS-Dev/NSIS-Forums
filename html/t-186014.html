<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="How to ensure installer will work on Win98?" />

  <title>How to ensure installer will work on Win98? - NSIS Forums</title>
  <script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script>
  <!-- Bootstrap core CSS -->

  <link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css" />
  <link rel="stylesheet" href="../css/style.css" type="text/css" /><!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!--[if lt IE 9]>
                <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
                <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->
</head>

<body>
  <div class="container">
    <!-- Put navigation bar here -->

    <ol class="breadcrumb">
      <li><a href="../index.html" class="glyphicon glyphicon-home"></a></li>

      <li><a href="f-65.html">NSIS Discussion</a></li>

      <li class="active">How to ensure installer will work on Win98?</li>
    </ol>

    <p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=186014">How to ensure installer will work on Win98?</a></p><br />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">John P.</span><br />
      <span class="post-time small text-muted">9th July 2004 16:57 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>How to ensure installer will work on Win98?</strong><br />
      Hi.<br />
      <br />
      I have a few installers which install some custom made textures into a game.<br />
      <br />
      The installers work perfectly on WinXP.<br />
      <br />
      The game in question does not officially support Win98(SE), only WinXP and Win2K.<br />
      So I thought everything would be OK with these installers.<br />
      <br />
      But now it turns out that the game community have been able to "hack" the game so that it will play just fine on Win98, and that's when some problems started.<br />
      <br />
      Because apparently, some of my installers won't work on Win98.<br />
      The weird thing to me is, that the most 'advanced' installer, where I use things like checking the registry to see if this and that file has already been installed, and write to and read from HKCU, which as far as I know isn't even a part of Win98 registry, <i>works</i>(although with a lot of error messages - but it does the job regardless, according to 'customers') while the 'simpler' installers does <i>not</i> work, according to 'customers'.<br />
      <br />
      I have no way of checking. Well - actually I still have a Win98 CD laying around, but I'm not going to start dual booting just for this.<br />
      <br />
      I have attached the 'simpler' installer .nsi below.<br />
      <br />
      I've tried to remove the "real names", and made it as simple as possible. So it's not <i>the</i> installer script, but an example with the same commands.<br />
      <br />
      Could it be as simple as the fact that I'm using $WINDIR for the icon?<br />
      Something else like that that won't work on Win98?<br />
      <br />
      <br />
      [edit]I see now that there are a couple of small redundant things, like I never use the VER_NAME, but that's something that's "left behind" from the bigger, more 'advanced' script, and in any event shouldn't be the reason for this problem.[/edit]<br />
      <br />
      <font face="1">attachment removed at user's request</font></p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">RDaneel</span><br />
      <span class="post-time small text-muted">9th July 2004 17:31 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Two things:<br />
      <br />
      1) just checking "known" registry locations to determine which OS is installed or which packages/features are supported/installed can lead to problems... :)<br />
      <br />
      Microsoft has a number of APIs (which themselves have evolved with time) to check this stuff out. Alternatively, NSIS itself presents some of this information in a somewhat abstracted form, so you might look at the set of predefined "$" values available.<br />
      <br />
      2) one of the great uses for VM technology is *exactly* the situation you are in (especially since you say you have a Win98 CD)! I maintain [virtual] installations of 98, NT4, 2000, and XP for just this purpose.<br />
      <br />
      In addition, keeping a virtual installation of your current/development OS around allows you to use it as a "sandbox", or to try out that suspicious program without risking your "real" system.<br />
      <br />
      I have used both VMware and VirtualPC, and have settled on VirtualPC for my own use. Both have free trials available:<br />
      <br />
      <a href="http://www.microsoft.com/windows/virtualpc/default.mspx" target="_blank">http://www.microsoft.com/windows/virtualpc/default.mspx</a><br />
      <br />
      <a href="http://www.vmware.com/landing/ws4_home.html" target="_blank">http://www.vmware.com/landing/ws4_home.html</a></p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">delboy</span><br />
      <span class="post-time small text-muted">10th July 2004 23:29 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Are you sure the problem doesnt lie in the batch file you seem to be running from this installer? my guess is that that is failing, theres nothing in that script that should cause problems... big thing to remember the way that batchfiles are passed arguments and can refer to them changed in NT.<br />
      <br />
      there are two reg keys that will tell you the type of windows you are installing on<br />
      <br />
      HKLM \<br />
      "SOFTWARE\Microsoft\Windows NT\CurrentVersion<br />
      for all flavours of NT (XP and 2k included)<br />
      <br />
      HKLM \<br />
      "SOFTWARE\Microsoft\Windows\CurrentVersion<br />
      for windows 9x</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">John P.</span><br />
      <span class="post-time small text-muted">11th July 2004 12:05 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Yeah - thanks; I have changed the batch files, because a very small amount of people had problems with installing even on XP. I was referring to %TEMP% in the batch file($TEMP in the NSIS script), which caused problems for some.<br />
      <br />
      Now the batch files don't use %TEMP% anymore(and of course neither does the NSIS script).<br />
      <br />
      I haven't actually asked anyone with 98 to test the new installer(will do), but one of the people on XP that had problems are saying that the installer now works well for him.<br />
      <br />
      So I'm guessing perhaps that was the problem on Win98 as well.</p>
    </div>
    <hr />

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]>
  </script>
</body>
</html>
