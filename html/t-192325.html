<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="description" content="variables into file.ini"><title>variables into file.ini - NSIS Forums</title><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script><link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css"><link rel="stylesheet" href="../css/style.css" type="text/css"></head><body><div class="container"><ol class="breadcrumb"><li><a href="../index.html" class="glyphicon glyphicon-home"></a></li><li><a href="f-65.html">NSIS Discussion</a></li><li class="active">variables into file.ini</li></ol><p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=192325">variables into file.ini</a></p><br><div class="post"><p class="post-meta"><span class="post-author text-primary">dilox77</span><br><span class="post-time small text-muted">3rd September 2004 12:03 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>variables into file.ini</strong><br>&nbsp; Hi all,<br>I don't know if it's possible.. but I need to put variables inside InstallOptions file.<br>Another question is:<br>can I read a string of a file and put it into a file.ini during run-time (not compile-time)?<br>I hope so.<br>Bye, thanks in advance</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">kichik</span><br><span class="post-time small text-muted">3rd September 2004 13:09 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Use WriteINIStr and ReadINIStr.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">dilox77</span><br><span class="post-time small text-muted">4th September 2004 01:36 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Perhaps I didn't explain well..<br>I have a custom page with a text field.<br>I want the state (default value) of text be read from a file during runtime.<br>Can I put variables (or lines of codes) into installOptions file?<br>Thanks in advance.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">kichik</span><br><span class="post-time small text-muted">4th September 2004 01:56 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Yes, with WriteINIStr you can write variables too.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">dilox77</span><br><span class="post-time small text-muted">4th September 2004 14:40 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Thanks a lot kichik, with WriteINIStr I change the contents of my custompage installOptions .ini file, but I've to recompile to see modification to take effect.<br>That's what I've understand.. can you explain me better, please?<br>Thank's in advance.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">kichik</span><br><span class="post-time small text-muted">4th September 2004 15:55 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Ah, so you want the InstallOptions file to contain variables and have those parsed when the page is loaded without changes to the script. That's is not possible with InstallOptions. I think <a href="http://forums.winamp.com/showthread.php?s=&amp;threadid=181087" target="_blank">InstallOptionsEx</a> has that option.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">dilox77</span><br><span class="post-time small text-muted">4th September 2004 16:07 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Ok, unfortunately I understood well :(<br>I think this is not possible with InstallOptionsEx too.<br>Thanks.. bye, dilox</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">lewellyn</span><br><span class="post-time small text-muted">10th September 2004 02:55 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Funny thing, I think this functionality is exactly what I'm looking for, as well...<br><br>I need the text of one button to change based off of a registry key value, and a link to either show or not based on a define.<br><br>The only way that looks like it may work for me so far is to have a separate page for each possible combination, using !defines and !ifdefs to make sure the correct one displays. I haven't quite gotten this done yet (lots of redundant work), but am I barking up the wrong tree?<br><br>This just seems like a wholly inelegant (and bloated) way of going about it...<br><br>Suggestions welcome. I think they'd likely help dilox77, as well. :)<br><br>--Matt</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">dilox77</span><br><span class="post-time small text-muted">10th September 2004 13:08 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Yes.. I thought to have a separate page for each possible combinations, but I refuse to have this kind of work..<br>What we need is a function that let you to parse ini file durin' runtime (this will solve problem of events on the page too) but I don't know if it's possible to realize it in C.<br>I hope somebody can!<br>bye, dilox</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">kichik</span><br><span class="post-time small text-muted">10th September 2004 13:33 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">How about including an external file and reading whatever you need from that?</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Comm@nder21</span><br><span class="post-time small text-muted">10th September 2004 13:54 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">maybe u're understanding each other wrong?<br><br>the text of any label on any installoptions page can be set just before it is shown. see the documentation about "installoptions" and the custom functions "pre", "init" and "show".<br>if you want to change the text at runtime, use the "sendmessage" command:<br></p><pre>
<code>SendMessage $HANDLE_OF_YOUR_LABEL${WM_SETTEXT} 0 "STR:YOUR CUSTOM TEXT, even ${Defines}, $(LangStrings) and $Variables are valid" 
</code>
</pre>get the $HANDLE_OF_YOUR_LABEL with this code in the SHOW function of your custom page:<br><pre>
<code>
HWND
<br>&gt;Var HANDLE_OF_YOUR_LABEL
<br>&gt;Function CustomPageShow
<br>FindWindow $HWND"#32770" "" $HWNDPARENT ; get the inner handle
<br>GetDlgItem $HANDLE_OF_YOUR_LABEL $HWND NUMBER_OF_LABEL 
<br>&gt;
</code>
</pre>where the NUMBER_OF_LABEL is calculated this way:<br>

      <blockquote>
        1200 + Field number - 1
      </blockquote>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">lewellyn</span><br>
      <span class="post-time small text-muted">10th September 2004 20:39 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Comm@nder: But how do I change both the text of the button as well as what it does? To be more specific, the particular button I am thinking of needs to say "Install Product" if it's not installed and actually launch the appropriate setup file. Then, if the user has already installed the particluar object, it needs to say "Run Product" and launch the program's executable.<br>
      <br>
      Perhaps what I need is already implemented. Perhaps not. I sure haven't figured it out yet. :( I neglected to mention that what the button actually DOES changes, as well. I apologize for that.</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">dilox77</span><br>
      <span class="post-time small text-muted">10th September 2004 22:18 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Thank's a lot Comm@nder21!<br>
      You solved me a big problem<br>
      :up:<br>
      dilox</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Comm@nder21</span><br>
      <span class="post-time small text-muted">11th September 2004 15:53 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">@lewellyn:<br>
      install it the common way, and include a finishpage on which you can run the product.<br>
      therefor you don't need any custom pages, labels, buttons, etc.<br>
      <br>
      read the modern ui readme about the finish-page's features.<br>
      <br>
      but if you really want to do it you way:<br>
      1. i think you're using a button inside a custom page`, so it has the notify flag, and everything it does stands inside the LEAVE function.<br>
      then just use a variable to store the action:<br></p>
      <pre>
<code>
$action
<br>&gt;Var $adress
<br>&gt;...
<br>&gt;StrCpy $action "install"
<br>&gt;...
<br>Function LEAVE
<br>&gt;...
<br>&gt;buttonaction: ; the button was pressed
<br>GetLabelAddress $adress $action
<br>Call $adress
<br>Abort
<br>install:
<br>;install-code
<br>StrCpy $action run
<br>&gt;Return
<br>&gt;run:
<br>;run-code
<br>StrCpy $action none
<br>&gt;Return
<br>&gt;none:
<br>Return
<br>...
<br>&gt;FunctionEnd 
<br>&gt;
</code>
</pre>(i just had to try out the GetLabelAdress-Call-Return functionality, forgive me :D)
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">lewellyn</span><br>
      <span class="post-time small text-muted">13th September 2004 23:55 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Commander: I'm almost done with a glorious autorun.exe thinger.<br>
      <br>
      Most of the time for our products, I check in .onInit whether a specific registry is set, and run the program's launcher, if so. In this case, the installer takes so long to check the CRC due to the size, that that method is impractical. So, I need a menu to choose whether to install/launch the program depending on whether it is installed.<br>
      <br>
      Look for an archive page with my results soon. It isn't as difficult as first thought. Just need to get it to cooperate fully now... :)</p>
    </div>
    <hr>

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]></script></body></html>