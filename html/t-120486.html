<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="Windows Service" />

  <title>Windows Service - NSIS Forums</title>
  <script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script>
  <!-- Bootstrap core CSS -->

  <link rel="stylesheet" type="text/css" href="//netdna.bootstrapcdn.com/bootswatch/3.0.1/readable/bootstrap.min.css" />
  <link rel="stylesheet" href="../css/style.css" type="text/css" /><!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!--[if lt IE 9]>
                <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
                <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->
</head>

<body>
  <div class="container">
    <!-- Put navigation bar here -->

    <ol class="breadcrumb">
      <li><a href="../index.html" class="glyphicon glyphicon-home"></a></li>

      <li><a href="f-65.html">NSIS Discussion</a></li>

      <li class="active">Windows Service</li>
    </ol>

    <p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=120486">Windows Service</a></p><br />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">treaz</span><br />
      <span class="post-time small text-muted">7th January 2003 16:17 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>Windows Service</strong><br />
      Hi,<br />
      I wish to find out if there is any way I could start a windows service through the installer?<br />
      Basically, I am looking at getting my program (after installation) to start up by itself whenever Windows startup.<br />
      Thanks.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
      <span class="post-time small text-muted">7th January 2003 17:19 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">You don't need a service for that... Either put a shortcut in $SMSTARTUP or write to the registry in the appropriate place as explained at this MSDN page: <a href="http://msdn.microsoft.com/library/default.asp?url=/library/en-us/setupapi/setup/run_and_runonce_registry_keys.asp" target="_blank">http://msdn.microsoft.com/library/de...istry_keys.asp</a></p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Sunjammer</span><br />
      <span class="post-time small text-muted">7th January 2003 18:15 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">If the service is installed you can also start a service using the net command (Windows NT and later only maybe).<br />
      <br />
      net start &lt;servicename&gt;<br />
      net stop &lt;servicename&gt;<br />
      <br />
      Without the angle brackets.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">treaz</span><br />
      <span class="post-time small text-muted">16th January 2003 16:19 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Hi,<br />
      <br />
      As you mentioned the use of net start, may I know how should I create or what command should I include in my .nsi file such that I could use this net start command to start my program?<br />
      <br />
      Thanks.:)</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Sunjammer</span><br />
      <span class="post-time small text-muted">16th January 2003 19:02 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">net is a command present on 2K systems and above and maybe some NT systems too (NT4?) so you just run it like any other system command. net does many things other than manipulate services, net start and net stop are two commands for services that you will want to use.<br />
      <br />
      Here are some examples :<br />
      Exec "net stop servicename"<br />
      ExecWait "net stop servicename"<br />
      nsExec::Exec "net stop servicename"<br />
      nsExec::ExecToLog "net stop servicename"<br />
      nsExec::ExecToStack "net stop servicename"<br />
      <br />
      I'm not sure if this will work:<br />
      <br />
      ExecShell "net stop servicename"</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">treaz</span><br />
      <span class="post-time small text-muted">16th January 2003 20:14 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Hi,<br />
      <br />
      Thanks for your respond but I guess I didnt make myself clear.<br />
      <br />
      I need to know how to register my program to a windows service such that I could use those Exec "net start test" and so on...<br />
      <br />
      I need to know how to register my program in my .nsi file. Not how to use the net command in my script.<br />
      <br />
      Apologise for that confusion. Thanks.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Sunjammer</span><br />
      <span class="post-time small text-muted">16th January 2003 22:12 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">I'm not sure I or anyone can answer that. Is this a program you have written yourself? If so you should have coded a way for the service to register itself. Is it written by someone else? If so they should have provided a means to register it. Is this program actually not designed as a service program but you want to run it as a service anyway? That's a different problem entirely.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">jthompson</span><br />
      <span class="post-time small text-muted">16th January 2003 22:29 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Assuming what you want to "register" as a service is actually designed that way...<br /></p>

      <blockquote>
        Included in the .NET Framework SDK there is a utility named "InstallUtil.exe". This utility is used to execute installers on a given assembly. In part 1 step 2, we discussed how to use the ServiceInstaller and ServiceProcessInstaller to install our service on the desired machine. Executing "InstallUtil.exe" on our Windows Service assembly will (hopefully) install the Windows Service.<br />
        <br />
        To install our service from the command line type:<br />
        <br />
        <br />
        installutil scheduler_net.exe<br />
        <br />
        <br />
        and to uninstall it, add the "/u" parameter:<br />
        <br />
        installutil scheduler_net.exe /u<br />
        <br />
        <br />
        Finally, launch the services plug-in in the Microsoft Management Console and start the service.
      </blockquote>Taken from <a href="http://www.15seconds.com/issue/021015.htm" target="_blank">http://www.15seconds.com/issue/021015.htm</a>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">treaz</span><br />
      <span class="post-time small text-muted">17th January 2003 18:47 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Apparently this is the scenerio:<br />
      <br />
      "this program actually not designed as a service program but I want to run it as a service anyway....."<br />
      <br />
      Would be nice to know if it is possible...Thanks.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Sunjammer</span><br />
      <span class="post-time small text-muted">18th January 2003 02:01 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Try looking into FireDaemon or SrvAny (the latter is an NT Resource Kit tool I think). Both of these programs allow any executable to run as a service, FireDaemon is more user friendly and more capable in my experience.<br />
      <br />
      You must remember however that since the program wasn't designed to work as a service it may not run entirely as expected when using these tools.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">SchmoobeeDrew</span><br />
      <span class="post-time small text-muted">27th January 2003 07:57 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>Windows Service</strong><br />
      How is it possible to reboot a computer and have a Shoutcast relay server auto start?</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Sunjammer</span><br />
      <span class="post-time small text-muted">27th January 2003 08:41 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">You could add a value to the Run or RunOnce keys in the registry.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">SchmoobeeDrew</span><br />
      <span class="post-time small text-muted">27th January 2003 08:48 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>Registrey Keys</strong><br />
      OK, Sunjammer<br />
      how would I do that<br />
      <br />
      thanx for your reply</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Sunjammer</span><br />
      <span class="post-time small text-muted">27th January 2003 09:05 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>How To Do It ...</strong><br />
      The Run and RunOnce keys exist in two places, in the per user configurations in the registry, and in the local machine configuration... I'd suggest you want it in the latter, that is :-<br />
      <br /></p>
      <pre>
<code>HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\RunOnce</code>
</pre><br />
      <br />
      If you want the Shoutcast Relay Server to run *every* time the computer reboots then you'll want to add a value to the Run key, otherwise if it's just the once you want it to happen use the RunOnce key instead :-<br />
      <br />
      <pre>
<code>WriteRegStr HKLM \<br />"SOFTWARE\Microsoft\Windows\CurrentVersion\Run" \<br />"ShoutCastRelayServer" "c:\path\to\relay\server\binary.exe"</code>
</pre><br />
      <br />
      The ShoutCastRelayServer bit is just a name, you can put anything there.<br />
      <br />
      If you need to specify arguments to the shoutcast server you'll need to do it like this:-<br />
      <br />
      <pre>
<code>WriteRegStr HKLM \<br />"SOFTWARE\Microsoft\Windows\CurrentVersion\Run" \<br />"ShoutCastRelayServer" \<br />'"c:\path\to\relay\server\binary.exe" /arg /arg /arg'</code>
</pre>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">SchmoobeeDrew</span><br />
      <span class="post-time small text-muted">27th January 2003 16:16 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>Tools</strong><br />
      Thnx very much SunJammer<br />
      <br />
      Now I have never edited a registry... obviously a backup prior to edit is in order.... any suggestions on tools.... like I use phpmyadmin for database editing, phpedit for script editing.... is there an application to use or just notepad..?<br />
      <br />
      I really want to have all the knowledge possible before jumping into such a fragile area.<br />
      <br />
      many thanx</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
      <span class="post-time small text-muted">27th January 2003 16:28 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Have a look at the NSIS related software section in the archive:<br />
      <a href="http://nsis.sourceforge.net/archive/nsisweb.php?page=8&amp;instances=0" target="_blank">http://nsis.sourceforge.net/archive/...=8&amp;instances=0</a></p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Sunjammer</span><br />
      <span class="post-time small text-muted">27th January 2003 17:15 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Adding a value under the Run or RunOnce keys *should* be safe, unless you are specifying a program that for some reason really causes a problem when starting Windows... but I've never encountered that problem myself.</p>
    </div>
    <hr />

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]>
  </script>
</body>
</html>
