<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="description" content="Cancel button of custom page malfunction"><title>Cancel button of custom page malfunction - NSIS Forums</title><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script><link rel="preload" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css" as="style" onload="this.rel='stylesheet'"><link rel="preload" href="../css/style.css" as="style" onload="this.rel='stylesheet'"><noscript><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css"><link rel="stylesheet" href="../css/style.css"></noscript><script>!function(a){"use strict";var b=function(b,c,d){function e(a){return h.body?a():void setTimeout(function(){e(a)})}function f(){i.addEventListener&&i.removeEventListener("load",f),i.media=d||"all"}var g,h=a.document,i=h.createElement("link");if(c)g=c;else{var j=(h.body||h.getElementsByTagName("head")[0]).childNodes;g=j[j.length-1]}var k=h.styleSheets;i.rel="stylesheet",i.href=b,i.media="only x",e(function(){g.parentNode.insertBefore(i,c?g:g.nextSibling)});var l=function(a){for(var b=i.href,c=k.length;c--;)if(k[c].href===b)return a();setTimeout(function(){l(a)})};return i.addEventListener&&i.addEventListener("load",f),i.onloadcssdefined=l,l(f),i};"undefined"!=typeof exports?exports.loadCSS=b:a.loadCSS=b}("undefined"!=typeof global?global:this);!function(a){if(a.loadCSS){var b=loadCSS.relpreload={};if(b.support=function(){try{return a.document.createElement("link").relList.supports("preload")}catch(b){return!1}},b.poly=function(){for(var b=a.document.getElementsByTagName("link"),c=0;c<b.length;c++){var d=b[c];"preload"===d.rel&&"style"===d.getAttribute("as")&&(a.loadCSS(d.href,d,d.getAttribute("media")),d.rel=null)}},!b.support()){b.poly();var c=a.setInterval(b.poly,300);a.addEventListener&&a.addEventListener("load",function(){b.poly(),a.clearInterval(c)}),a.attachEvent&&a.attachEvent("onload",function(){a.clearInterval(c)})}}}(this);</script></head><body><div class="container"><ol class="breadcrumb"><li><a href="../index.html" class="glyphicon glyphicon-home"></a></li><li><a href="f-65.html">NSIS Discussion</a></li><li class="active">Cancel button of custom page malfunction</li></ol><p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=276890">Cancel button of custom page malfunction</a></p><br><div class="post"><p class="post-meta"><span class="post-author text-primary">fifth8118</span><br><span class="post-time small text-muted">4th September 2007 05:39 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>Cancel button of custom page malfunction</strong><br>Hi,<br>I have a cutom page using the CANCEL button to go to the next page, and using the NEXT button do<br>some extra evaluations in the function before leave. The problem is that if the function before leave<br>includes "Abort", the CANCEL button will not go next page, if not, it's fine. Following is the code, if you mask the Abort in the testPageLeave, the problem disappearred.Can anybody help me to solve this problem? Thanks!<br><br><br>#------------------------------------------------<br>#test.nsi<br>!include "MUI.nsh"<br><br>!define MUI_CUSTOMFUNCTION_ABORT .myuserabort<br><br>Function .onInit<br>InitPluginsDir<br>File /oname=$PLUGINSDIR\test.ini "test.ini"<br>FunctionEnd<br><br>!insertmacro MUI_PAGE_WELCOME<br>Page custom testPageShow testPageLeave<br>!insertmacro MUI_PAGE_FINISH<br><br>!insertmacro MUI_LANGUAGE "English"<br><br>OutFile "test.exe"<br><br>Section "MainSection" SEC01<br>SectionEnd<br><br>Function testPageShow<br>Push $R0<br>InstallOptions::dialog "$PLUGINSDIR\test.ini"<br>Pop $R0<br>Pop $R0<br>FunctionEnd<br><br>Function testPageLeave<br>Abort<br>FunctionEnd<br><br>Function .myuserabort<br>SendMessage $HWNDPARENT "0x408" "1" ""<br>Abort<br>FunctionEnd<br><br>#----------------<br>#test.ini<br>[Settings]<br>NumFields=1<br><br>[Field 1]<br>Type=Label<br>Text=test<br>Left=10<br>Right=28<br>Top=20<br>Bottom=40</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">kichik</span><br><span class="post-time small text-muted">5th September 2007 00:35 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">NSIS processes the Cancel button and not InstallOptions. You can't use the Cancel button for anything else but aborting.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">fifth8118</span><br><span class="post-time small text-muted">5th September 2007 14:36 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">But if I jump 2 pages like:<br>SendMessage $HWNDPARENT "0x408" "2" ""<br>in Function .myuserabort, it works. Or if I mask the "Abort" in Function testPageLeave, then the CANCEL button can go to the next page.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">kichik</span><br><span class="post-time small text-muted">6th September 2007 03:46 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">The destruction process of the installer has already initialized once the Cancel button is pressed. Any problem that occurs after you force it to do something else can be caused by this.</p></div><hr><div class="footer"><p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p></div></div><script type="text/javascript" src="../js/highlight.pack.js" async></script><script type="text/javascript">//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]></script></body></html>