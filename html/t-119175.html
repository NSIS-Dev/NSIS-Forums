<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="description" content="New to NSIS: very simple help"><title>New to NSIS: very simple help - NSIS Forums</title><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script><link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css"><link rel="stylesheet" href="../css/style.css" type="text/css"><!--[if lt IE 9]><script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script><script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script><![endif]--></head><body><div class="container"><ol class="breadcrumb"><li><a href="../index.html" class="glyphicon glyphicon-home"></a></li><li><a href="f-65.html">NSIS Discussion</a></li><li class="active">New to NSIS: very simple help</li></ol><p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=119175">New to NSIS: very simple help</a></p><br><div class="post"><p class="post-meta"><span class="post-author text-primary">robdal</span><br><span class="post-time small text-muted">27th December 2002 08:05 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>New to NSIS: very simple help</strong><br>Hi everybody,<br>I'm totally new to NSIS and I need some help to get started.<br>What I need is very simple indeed:<br>1) no user interface at all<br>2) I need to check if the version of Internet Explorer installed is greater then 5.01. In that case I need to check if the .Net Framework is installed.<br>3) In one case I need to launch an EXE, otherwise I need to launch another one.<br><br>Is there someone who has done already something like this and would like to share with me?<br><br><br>Best Regards<br>Roberto DALMONTE</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">kichik</span><br><span class="post-time small text-muted">27th December 2002 10:56 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Welcome to the NSIS world Roberto :D<br><br>1) Use <a href="http://nsis.sourceforge.net/Docs/Chapter3.html#3.6.1.34%3Cbr%20/%3E" target="_blank">SilentInstall</a><br>2) Use <a href="http://nsis.sourceforge.net/Docs/AppendixB.html#B.6" target="_blank">GetIEVersion</a> to detect IE. Microsoft use this to detect .NET:<br></p><blockquote>The Setup.exe Bootstrapper sample demonstrates the code to use to wrap a setup program to verify if the .NET Framework is installed. The code checks for a specified version number of the .NET Framework in the following registry key.<br><br>HKLM\SOFTWARE\Microsoft\.NETFramework\policy\v1.0<br><br>The version number to check for is obtained from Dotnetfx.exe. The code performs a comparison between the build number in the registry key and the build number of the .NET Framework being hosted by the application. If there is not a matching build number in the registry key in this location, Setup.exe installs the version of the .NET Framework being hosted by the application.<br><br>Note that if you want Setup.exe to check for a build number and language version of the .NET Framework, you must specify the culture name of the language to check for in the settings.ini file. If you do not specify a culture name, Setup.exe checks for the English language version by default. See the Creating the Settings.ini File topic for instructions on specifying a culture name.</blockquote>Taken from <a href="http://msdn.microsoft.com/library/default.asp?url=/library/en-us/dnnetdep/html/dotnetfxref.asp" target="_blank">http://msdn.microsoft.com/library/de...otnetfxref.asp</a>.<br>3) Use <a href="http://nsis.sourceforge.net/Docs/Chapter3.html#3.7.4.17" target="_blank">StrCmp</a> and <a href="http://nsis.sourceforge.net/Docs/Chapter3.html#3.7.1.3" target="_blank">Exec</a>, <a href="http://nsis.sourceforge.net/Docs/Chapter3.html#3.7.1.4" target="_blank">ExecShell</a>, <a href="http://nsis.sourceforge.net/Docs/Chapter3.html#3.7.1.5" target="_blank">ExecWait</a> or nsExec (a plugin).</div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">robdal</span><br><span class="post-time small text-muted">27th December 2002 13:51 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Thank you for your help.<br>By the way, where do I find the "Setup.exe Bootstrapper sample" you mention?</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">kichik</span><br><span class="post-time small text-muted">27th December 2002 14:19 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">That Microsoft link I have taken the quote from.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">robdal</span><br><span class="post-time small text-muted">29th December 2002 10:14 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>Get IE version for Net Framework</strong><br>We managed to write our first nsis script, and it works very nicely.<br><br>Nonetheless, we had to change a bit the GetIEVersion. The problem is that the .Net Framework accepts as a good one the IE5 version that comes with Win2000 sp2(IE 5.01), but requires a greater version of IE if you happen to have Win98 second edition (IE 5.00). So we found a key in the registry in order to check if you need to update IE or not.<br><br>ReadRegStr $R0 HKLM "Software\Microsoft\Internet Explorer\Version Vector" "IE"<br>Strcpy $R0 $R0 4; we need to check for 5.01 or 5.00 so 4 chars<br><br><br>NSIS is excellent.<br>Our best compliments.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">kichik</span><br><span class="post-time small text-muted">29th December 2002 17:21 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"></p><blockquote>NSIS is excellent.</blockquote>I am glad you like it :D<br><br>Would please mind attaching your .NET framework checking function so others can use it too?</div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">robdal</span><br><span class="post-time small text-muted">30th December 2002 07:56 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">I'll explain the purpose of this script:<br>1) We have our own installer (written in C#: SharpInstaller.exe) that is able to perform some checks tailored to our software.<br>2) We need to be sure that our customers have the required Net Framework installed.<br>3) A pre-requisite of the .Net Framework is IE 5.01.<br><br>The script checks for the IE version:<br>1) if we get 6 we jump to the label IEOK.<br>2) if we get 4, 3, 2 or 1 we jump to the label IEKO, if we get 5 we jump to the lbl_IE5.<br>3) In lbl_IE5 we check to see if we got 5.00 (the only case in which a version 5 is not enough) then we jump to lbl_IEKO.<br>4) the lbl_IEKO should launch the installation of IE 6. In our case we launch a program that will take care of that and would give an explanation of what's going on to the user.<br><br>If the user has a good enough version of IE, then we check for the .Net Framework. In our case we check for a very specific subkey, which is the version we distribute (Italian version of .Net Framework). The logic followed is the same for IE: we launch a program that explains something to the user (during the installation of .Net Framework it appears as if the PC is not working and it can last up to 10 minutes in older PC's)<br>I realize that our script is not well written and a bit chaotic, but i guess that a more expert NSIS user might make it more readable.<br><br><br>[attached below]<br><br><br>best regards<br>Roberto DALMONTE</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">kichik</span><br><span class="post-time small text-muted">30th December 2002 14:33 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Thanks.<br><br>Please attach large scripts next time.</p></div><hr><div class="footer"><p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p></div></div><script src="../js/highlight.pack.js" type="text/javascript"></script><script type="text/javascript">//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]></script></body></html>