<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="Norton System Works" />

  <title>Norton System Works - NSIS Forums</title>
  <script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script>
  <!-- Bootstrap core CSS -->

  <link rel="stylesheet" type="text/css" href="//netdna.bootstrapcdn.com/bootswatch/3.0.1/readable/bootstrap.min.css" />
  <link rel="stylesheet" href="../css/style.css" type="text/css" /><!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!--[if lt IE 9]>
                <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
                <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->
</head>

<body>
  <div class="container">
    <!-- Put navigation bar here -->

    <ol class="breadcrumb">
      <li><a href="../index.html" class="glyphicon glyphicon-home"></a></li>

      <li><a href="f-65.html">NSIS Discussion</a></li>

      <li class="active">Norton System Works</li>
    </ol>

    <p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=251408">Norton System Works</a></p><br />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">albie</span><br />
      <span class="post-time small text-muted">18th July 2006 17:27 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>Norton System Works</strong><br />
      Hi,<br />
      <br />
      I'm new to this forum and a rookie NSIS user. :)<br />
      <br />
      <br />
      After creating a short cut I've run Norton<br />
      System Works to check for Errors.<br />
      <br />
      Norton says that there are short cut errors.<br />
      <br />
      \RECYCLER\NPROTECT\00000343.LNK is invalid<br />
      The path C:\GNA\Usb\Uninstall.exe used by this<br />
      short cut is wrong.<br />
      <br />
      Also says the program short cut I've installed is<br />
      also invalid.<br />
      <br />
      Does anyone know why this would be?<br />
      It doesn't seem to effect anything.<br />
      I just want to clean stuff up...<br />
      <br />
      Thanks, Mike</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Comperio</span><br />
      <span class="post-time small text-muted">18th July 2006 20:54 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">The path first path you gave starts with "\recycler..". The recycler is usually the folder windows uses for the recyle bin. Can you verify?<br />
      <br />
      As for the rest of your shortcuts, I'm not sure. Perhaps it's missing an icon resource or some such thing. (I assume the shortcuts work, correct?) Might help to post the actual shortcut commands you used.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">albie</span><br />
      <span class="post-time small text-muted">18th July 2006 22:07 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Thanks for responding!<br />
      <br />
      Here are my short cuts...<br />
      <br />
      CreateShortCut "$DESKTOP\${MUI_PRODUCT}.lnk""$INSTDIR\${MUI_FILE}.exe" ""<br />
      <br />
      # Create Start-Menu Items<br />
      CreateDirectory "$SMPROGRAMS\${MUI_PRODUCT}"<br />
      <br />
      CreateShortCut "$SMPROGRAMS\${MUI_PRODUCT}\Uninstall.lnk" "$INSTDIR\Uninstall.exe" "" "$INSTDIR\Uninstall.exe" 0<br />
      <br />
      CreateShortCut "$SMPROGRAMS\${MUI_PRODUCT}\${MUI_PRODUCT}.lnk" "$INSTDIR\${MUI_FILE}.exe" "" "$INSTDIR\${MUI_FILE}.exe" 0<br />
      <br />
      <br />
      Mike</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Comperio</span><br />
      <span class="post-time small text-muted">19th July 2006 00:53 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">hmmm... I don't see anything wrong with your commands.<br />
      <br />
      Just on a whim, try issuing the following command at the end of your install:<br />
      <br />
      <b><i>System::Call 'shell32::SHChangeNotify(i 0x08000000, i 0, i 0, i 0)'</i></b><br />
      <br />
      (You can also use the ${RefreshShellIcons} call included in FileFunc.nsh. Its usage is explained in NSIS help under Appendix E under the File Functions header section.)</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">albie</span><br />
      <span class="post-time small text-muted">19th July 2006 02:22 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">I tried the system call. Didn't seem to have<br />
      any effect.<br />
      <br />
      ------------------ Compile output -------------------<br />
      File: "System.dll"-&gt;"$PLUGINSDIR\System.dll" [compress] 5942/10240 bytes<br />
      Plugin Command: Call shell32::SHChangeNotify(i 0x08000000, i 0, i 0, i 0)<br />
      <br />
      When you mentioned the Recyle Bin got me thinking.<br />
      I've had a little more time now to do some<br />
      thinking and some experimenting.<br />
      <br />
      I've ran Norton after the install and<br />
      found it had no errors.<br />
      <br />
      Then after the uninstall and that's where<br />
      the problem is. It makes sence now.<br />
      <br />
      I did some searching through the files and<br />
      directories looking for "RECYCLER" or<br />
      "NPROTECT". Thinking that it is something<br />
      I need to remove during the uninstall. But<br />
      I could not find anything. ? Not sure where<br />
      this information or file links are.<br />
      <br />
      This is the delete code.<br />
      <br />
      Delete "$DESKTOP\${ANS_PRODUCT}.lnk"<br />
      Delete "$SMPROGRAMS\${ANS_PRODUCT}\*.*"<br />
      RmDir "$SMPROGRAMS\${ANS_PRODUCT}"<br />
      <br />
      <br />
      Am I missing something in the removal of the<br />
      regular short cuts I've made. Or do I<br />
      remove the contents of the Recycler? Where<br />
      ever that is...<br />
      <br />
      Mike</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">galil</span><br />
      <span class="post-time small text-muted">19th July 2006 03:03 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Don't over-concern yourself with Norton's recycle bin enhancements.</p>
    </div>
    <hr />

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]>
  </script>
</body>
</html>
