<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="Large setup initializing" />

  <title>Large setup initializing - NSIS Forums</title>
  <script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script>
  <!-- Bootstrap core CSS -->

  <link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css" />
  <link rel="stylesheet" href="../css/style.css" type="text/css" /><!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!--[if lt IE 9]>
                <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
                <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->
</head>

<body>
  <div class="container">
    <!-- Put navigation bar here -->

    <ol class="breadcrumb">
      <li><a href="../index.html" class="glyphicon glyphicon-home"></a></li>

      <li><a href="f-65.html">NSIS Discussion</a></li>

      <li class="active">Large setup initializing</li>
    </ol>

    <p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=293302">Large setup initializing</a></p><br />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Winniethepooh</span><br />
      <span class="post-time small text-muted">18th June 2008 18:05 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>Large setup initializing</strong><br />
      Hello all,<br />
      <br />
      When I run my installer (it's a big file: 1.5Gb)on Vista there is a displayed message indicating to wait with a percentage, so it's a good thing. But on XP system, I have to wait a time (around 1 or 2 minutes) before having this message, is there a way to have this message displayed as soon as I have run the setup without any wait time (like on my vista system) ?<br />
      [edit] It's for a wab distribution, so I don't want to use a disk spanning system, I'd like to have only one file to download[/edit]</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">LoRd_MuldeR</span><br />
      <span class="post-time small text-muted">18th June 2008 18:46 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">I think if you see that message at startup it indicates there is something wrong with your installer! Usually your installer should startup (almost) immediately, even if it's very large. Make sure you use "ReserveFile" to reserve all plugins you use and all other files that are extracted "out of order" (not in the order they appear in the script). For example extracting files in your ".onInit" function can cause problem, if that function is located <i>after</i> the install sections in your script. Those files would be extracted immediately when your installer starts up, but they would have been added at the very end of the installer's data block. Obviously it will take a very long time to extract, making the installer startup sloooow! The bigger the installer, the slower it will start up. Reserving those files <i>at the beginning</i> of your installer script (using ReserveFile) solves the problem once and for all...</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Winniethepooh</span><br />
      <span class="post-time small text-muted">18th June 2008 19:07 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">oops, I'm new with NSIS and I didn't use the reservefile. I will add them and test.<br />
      <br />
      Just a question, I knwo that I have to add the picture I use for the setup. But I have alsoo seen that I have to add some of the dll used by NSIS plugin. I have used The modernui plugin and also the advsplash, so what dll have I to add?<br />
      [edit]The AdvSplash.dll I guess, but for the others I don't know...[/edit]</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Winniethepooh</span><br />
      <span class="post-time small text-muted">18th June 2008 19:59 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Argh, it's still not working<br />
      <br />
      I use the LZMA compression (non solid)<br />
      <br />
      And here comes the beginning of my script, if someone can tell me what to add in the reserve file... Many thanks in advance<br />
      <br />
      ReserveFile "e:\zipper\setup makers\ressources\setup_debut.bmp"<br />
      ReserveFile "e:\zipper\setup makers\ressources\setup_background.bmp"<br />
      ReserveFile "e:\zipper\setup makers\ressources\setup_wiz.bmp"<br />
      ReserveFile "e:\zipper\setup makers\ressources\license.rtf"<br />
      ReserveFile "${NSISDIR}\Contrib\Graphics\Icons\win-install.ico"<br />
      ReserveFile "${NSISDIR}\Plugins\AdvSplash.dll"<br />
      ReserveFile "${NSISDIR}\Plugins\BgImage.dll"<br />
      <br />
      !include MUI2.nsh<br />
      <br />
      Var StartMenuFolder<br />
      <br />
      Name "test_project"<br />
      <br />
      OutFile "test_project.exe"<br />
      <br />
      InstallDir $PROGRAMFILES\test_project<br />
      <br />
      InstallDirRegKey HKCU "Software\test\test_project" ""<br />
      <br />
      RequestExecutionLevel user<br />
      <br />
      ;-------------------------------- INIT<br />
      Function .onInit<br />
      <br />
      SetOutPath $TEMP<br />
      File /oname=spltmp.bmp "e:\zipper\setup makers\ressources\setup_debut.bmp"<br />
      <br />
      advsplash::show 2000 600 600 -1 $TEMP\spltmp<br />
      <br />
      Pop $0<br />
      <br />
      Delete $TEMP\spltmp.bmp<br />
      <br />
      FunctionEnd<br />
      ;--------------------------------GuiIninit<br />
      Function ZGUIInit<br />
      <br />
      BgImage::SetBg /NOUNLOAD /FILLSCREEN "e:\zipper\setup makers\ressources\setup_background.bmp"<br />
      CreateFont $R0 "Verdana" 50 700<br />
      BgImage::AddText /NOUNLOAD "E.Y.E" $R0 0 0 0 48 48 798 198<br />
      BgImage::AddText /NOUNLOAD "E.Y.E" $R0 255 255 255 50 50 800 200<br />
      BgImage::Redraw /NOUNLOAD<br />
      <br />
      FunctionEnd<br />
      <br />
      --------------------------------SUCCESS<br />
      Function .onInstSuccess<br />
      SetOutPath $TEMP<br />
      File /oname=spltmp.bmp "e:\zipper\setup makers\ressources\setup_wiz.bmp"<br />
      <br />
      advsplash::show 2000 600 600 -1 $TEMP\spltmp<br />
      <br />
      Pop $0 ; $0 has '1' if the user closed the splash screen early,<br />
      ; '0' if everything closed normally, and '-1' if some error occurred.<br />
      <br />
      Delete $TEMP\spltmp.bmp<br />
      <br />
      FunctionEnd<br />
      <br />
      <br />
      !define MUI_ABORTWARNING<br />
      !define MUI_CUSTOMFUNCTION_GUIINIT ZGuiInit<br />
      !define MUI_PAGE_HEADER_TEXT "Test installation"<br />
      !define MUI_PAGE_HEADER_SUBTEXT "1"<br />
      !define MUI_LICENSEPAGE_BUTTON "I agree"<br />
      !define MUI_FINISHPAGE_RUN "$INSTDIR\Test.exe"<br />
      !define MUI_FINISHPAGE_RUN_TEXT "Run now"<br />
      !define MUI_FINISHPAGE_RUN_NOTCHECKED<br />
      !define MUI_FINISHPAGE_SHOWREADME "$INSTDIR\manual.pdf"<br />
      !define MUI_FINISHPAGE_SHOWREADME_TEXT "manual (PDF format)"<br />
      !define MUI_FINISHPAGE_SHOWREADME_NOTCHECKED<br />
      !define MUI_FINISHPAGE_LINK "http://www.test.com"<br />
      !define MUI_FINISHPAGE_LINK_LOCATION "http://www.test.com"<br />
      !define MUI_UNICON "${NSISDIR}\Contrib\Graphics\Icons\win-uninstall.ico"<br />
      !define MUI_ICON "${NSISDIR}\Contrib\Graphics\Icons\win-install.ico"<br />
      <br />
      !insertmacro MUI_PAGE_LICENSE "e:\zipper\setup makers\ressources\license.rtf"<br />
      !insertmacro MUI_PAGE_DIRECTORY<br />
      !insertmacro MUI_PAGE_STARTMENU Application $StartMenuFolder<br />
      !insertmacro MUI_PAGE_INSTFILES<br />
      !insertmacro MUI_PAGE_FINISH<br />
      <br />
      <br />
      !insertmacro MUI_UNPAGE_CONFIRM<br />
      !insertmacro MUI_UNPAGE_INSTFILES</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
      <span class="post-time small text-muted">18th June 2008 23:15 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Does the Vista message show with CRCCheck off? If so then it's built in to Vista and not something you will have on XP.<br />
      <br />
      One option you have is to have a launcher but you will need two files then of course.<br />
      <br />
      Stu</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Winniethepooh</span><br />
      <span class="post-time small text-muted">18th June 2008 23:52 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Thanks for your answer, having several files is a real problem for me to make my setup downloadable.<br />
      <br />
      The message isn't displayed with the CRCCheck off (so it's the crc message, you can see a screen of the message attached). But I don't understand why it is displayed as soon as I run the exe on vista and some minutes later in XP (tested on several machines).<br />
      <br />
      So is there a difference between the work of the setup on vista and XP?<br />
      How can I fix my problem, so how to make the message being displayed as soon as I run the exe on XP too (with only one file)?<br />
      <br />
      Because at this time, the long waiting time on XP before displaying anything can let thinking the setup is not working (even if it's not the case).</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">demiller9</span><br />
      <span class="post-time small text-muted">19th June 2008 00:20 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">I've seen long delays like you describe caused by the antivirus program. It tries to scan the NSIS installer for viruses, and may take some time before it permits it to execute. You said your installer is 1.5 GB. Do smaller installers open faster? How much memory is in your XP system, and do you have an antivirus program running?<br />
      <br />
      My home XP system did very slow virus checks until I upgraded the memory from .5 GB to 2 GB.<br />
      <br />
      Don</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
      <span class="post-time small text-muted">19th June 2008 00:23 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">In XP it could be down to network unconnectivity (i.e. disconnected mapped drives), anti virus software, lack of disk space, NTFS compression, indexing service etc. Either way in my experience I have never seen a setup take over 1 minute to open as far as I can remember unless it is from over a network.<br />
      <br />
      Stu</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Winniethepooh</span><br />
      <span class="post-time small text-muted">19th June 2008 00:25 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">I have just tred after having disabled my antivirus and I still have the problem. All the XP system on which I have tested have 4Gb</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Winniethepooh</span><br />
      <span class="post-time small text-muted">19th June 2008 00:30 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Sorry I have answered before seeing your answer Afrow. Setup are not run via the network. I will finally tried with a disk spanning setup (as soon as I find how do it with nsis) and will put all files in an autoextractible zip...</p>
    </div>
    <hr />

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]>
  </script>
</body>
</html>
