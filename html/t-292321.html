<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="description" content="Convert string to variable, is it possible?"><title>Convert string to variable, is it possible? - NSIS Forums</title><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script><link rel="preload" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css" as="style" onload="this.rel='stylesheet'"><link rel="preload" href="../css/style.css" as="style" onload="this.rel='stylesheet'"><noscript><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css"><link rel="stylesheet" href="../css/style.css"></noscript><script>!function(a){"use strict";var b=function(b,c,d){function e(a){return h.body?a():void setTimeout(function(){e(a)})}function f(){i.addEventListener&&i.removeEventListener("load",f),i.media=d||"all"}var g,h=a.document,i=h.createElement("link");if(c)g=c;else{var j=(h.body||h.getElementsByTagName("head")[0]).childNodes;g=j[j.length-1]}var k=h.styleSheets;i.rel="stylesheet",i.href=b,i.media="only x",e(function(){g.parentNode.insertBefore(i,c?g:g.nextSibling)});var l=function(a){for(var b=i.href,c=k.length;c--;)if(k[c].href===b)return a();setTimeout(function(){l(a)})};return i.addEventListener&&i.addEventListener("load",f),i.onloadcssdefined=l,l(f),i};"undefined"!=typeof exports?exports.loadCSS=b:a.loadCSS=b}("undefined"!=typeof global?global:this);!function(a){if(a.loadCSS){var b=loadCSS.relpreload={};if(b.support=function(){try{return a.document.createElement("link").relList.supports("preload")}catch(b){return!1}},b.poly=function(){for(var b=a.document.getElementsByTagName("link"),c=0;c<b.length;c++){var d=b[c];"preload"===d.rel&&"style"===d.getAttribute("as")&&(a.loadCSS(d.href,d,d.getAttribute("media")),d.rel=null)}},!b.support()){b.poly();var c=a.setInterval(b.poly,300);a.addEventListener&&a.addEventListener("load",function(){b.poly(),a.clearInterval(c)}),a.attachEvent&&a.attachEvent("onload",function(){a.clearInterval(c)})}}}(this);</script></head><body><div class="container"><ol class="breadcrumb"><li><a href="../index.html" class="glyphicon glyphicon-home"></a></li><li><a href="f-65.html">NSIS Discussion</a></li><li class="active">Convert string to variable, is it possible?</li></ol><p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=292321">Convert string to variable, is it possible?</a></p><br><div class="post"><p class="post-meta"><span class="post-author text-primary">Leanid</span><br><span class="post-time small text-muted">26th May 2008 17:17 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>Convert string to variable, is it possible?</strong><br>I need to access hidden optional section to set it's flag to selected.<br>Since section is hidden it does not have name only variable.<br><br>Problem is I will know name of section only at runtime. I can generate string with name of this section variable, but how I can access it?<br><br>For example I have 2 hidden sections:<br><br>Section /o "" Pool_Conf1<br>SetOutPath $INSTDIR\Pool<br>File /r "${SOURCE}\Pool\*.*"<br>SectionEnd<br><br>Section /o "" Pool_Conf2<br>SetOutPath $INSTDIR\Pool<br>File /r "${SOURCE}\Pool\*.*"<br>SectionEnd<br><br>;I am trying to select it in function called after my custom page<br><br>Function func<br>StrCpy $R1 "Pool_Conf1"<br>;Next line obviously does not work,<br>;but can I convert string value Pool_Config1 to variable ${Pool_Config1}<br>SectionSetFlags ${R1} ${SF_SELECTED}<br>;I want it to be the same as:<br>SectionSetFlags ${Pool_Config1} ${SF_SELECTED}<br><br>FunctionEnd</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Leanid</span><br><span class="post-time small text-muted">26th May 2008 18:06 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Only solution I found to generate function with custom mapping string to variable:<br><br>Function GetConfSection<br>Pop $0<br>StrCpy $1 0<br>StrCmp $0 "Pool_Conf1" 0 +2<br>StrCpy $1 ${Pool_Conf1}<br>StrCmp $0 "Pool_Conf2" 0 +2<br>StrCpy $1 ${Pool_Conf2}<br>Push $1<br>FunctionEnd<br><br>A bit of pain to do, but it works.<br>If there is no easy way to map it with some NSIS function I think that will do for me.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Red Wine</span><br><span class="post-time small text-muted">26th May 2008 18:06 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">What is ${R1} ?<br>You need SectionSetText if you want the section visible in components page.<br><br>See here, might help you,<br><br><a href="http://forums.winamp.com/showthread.php?s=&amp;threadid=292160" target="_blank">http://forums.winamp.com/showthread....hreadid=292160</a></p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Leanid</span><br><span class="post-time small text-muted">26th May 2008 18:33 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">I don't want it to be visible on component page, but I want to select this section later on one of my custom page. In custom page I let user to select string and from that string I know name of variable that holds number of my hidden section. Problem was to access value in that variable by just having string name.<br><br>I did it by creating map function, when by comparing string I return section number and can set flag on it.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">LoRd_MuldeR</span><br><span class="post-time small text-muted">26th May 2008 20:42 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"></p><blockquote>I don't want it to be visible on component page, but I want to select this section later on one of my custom page.</blockquote>I think you can use the "SectionSetFlags" command for that ;)<br><br><pre>
<code>Section test test_section_id<br>SectionEnd<br><br>Function .onInit<br>  # set section 'test' as selected and read-only<br>  IntOp $0 ${SF_SELECTED} | ${SF_RO}<br>  SectionSetFlags ${test_section_id} $0<br>FunctionEnd<br></code>
</pre><br>
      <br>
      Using a section name that begins with a "-" will hide it on the components page...
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Leanid</span><br>
      <span class="post-time small text-muted">27th May 2008 14:25 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">I know all that, but it was not that simple.<br>
      If section has text name you can loop over all section and get section name, compare to your string and set flag. BUT, not for hidden section. Even if you set text name with "-", section become hidden and SectionGetText return empty string, like you did not put any name at all. So there is really no difference use empty string "" or "-something" for hidden section.</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">LoRd_MuldeR</span><br>
      <span class="post-time small text-muted">27th May 2008 14:48 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">I think a section should be accessed by using it's ID, not by using it's caption. At the moment your string contains the caption of the section. Can't you store section's ID instead? Like this:<br>
      <br></p>
      <pre>
<code>Section "" test_section_id<br>  ...<br>  # Do some super secret things in this hidden section<br>  ...<br>SectionEnd<br><br>Function myFunction<br>  StrCpy $1 ${test_section_id}<br>  ...<br>  # Save section id stored in $1<br>  ...<br>FunctionEnd<br><br>Function myFunction2<br>  ...<br>  # Load section id into $1 again<br>  ...<br>  IntOp $0 ${SF_SELECTED} | ${SF_RO}<br>  SectionSetFlags $1 $0<br>FunctionEnd<br></code>
</pre>
    </div>
    <hr>

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]></script></body></html>