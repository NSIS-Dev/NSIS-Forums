<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="Insalling .Net Framework in Silent mode" />

  <title>Insalling .Net Framework in Silent mode - NSIS Forums</title>
  <script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script>
  <!-- Bootstrap core CSS -->

  <link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css" />
  <link rel="stylesheet" href="../css/style.css" type="text/css" /><!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!--[if lt IE 9]>
                <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
                <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->
</head>

<body>
  <div class="container">
    <!-- Put navigation bar here -->

    <ol class="breadcrumb">
      <li><a href="../index.html" class="glyphicon glyphicon-home"></a></li>

      <li><a href="f-65.html">NSIS Discussion</a></li>

      <li class="active">Insalling .Net Framework in Silent mode</li>
    </ol>

    <p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=317931">Insalling .Net Framework in Silent mode</a></p><br />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">watzr</span><br />
      <span class="post-time small text-muted">23rd March 2010 18:04 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>Insalling .Net Framework in Silent mode</strong><br />
      Hi,<br />
      <br />
      I have written an installer which installs .Net Framework while installing other components if still it haven't been installed. I need to do it in Silent mode. so I have followed,<br />
      ExecWait '"$PATH\dotnetfx.exe /q:a /c:\install /l /q\"'.<br />
      <br />
      Even though the installer shows that .Net framework setup is extracting, it doesn't really install .Net Framewrk. Can someone tell me why it's acting like this. When I install .Net Framework in the normal mode it asks to click next buttons, check license agreements, etc. But here in silent mode is there a way to provide hose parameters through the installer written by me?</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
      <span class="post-time small text-muted">23rd March 2010 20:47 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">ExecWait `"$PATH\dotnetfx.exe" /q:a /c:\install /l /q`<br />
      You don't put quotes around the whole string, just the executable path.<br />
      <br />
      Stu</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">hurlee</span><br />
      <span class="post-time small text-muted">24th March 2010 07:10 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>Excuse me</strong><br />
      Hi watzr<br />
      Im sorry to interrupt you. But im new to both .net and nsis. I have developed a vb.net application and wanted to use nsis it s installer.Can you show me how to do this using nsis?I have collected lots of info but i havent been able to do this myself.<br />
      My program prerequisets are :.net framework 3.5,Windows Installer 3.1 and Cards.dll<br />
      Thanks</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">ionut_y</span><br />
      <span class="post-time small text-muted">24th March 2010 10:38 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">for windows installer 3.1 I use this :<br />
      <br /></p>
      <pre>
<code>ExecWait</code><span style="color: #DD0000">'"WindowsInstaller.exe"/Q/O/Z'
</span>
</pre>For a small package of net framework 3.5 for 32 (31.43 MB) you can use this<br />
      <a href="http://www.mediafire.com/?y4yzdzjwvzz" target="_blank">http://www.mediafire.com/?y4yzdzjwvzz</a>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">ionut_y</span><br />
      <span class="post-time small text-muted">24th March 2010 21:52 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">I forgot:the package from link above is silent by default</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">watzr</span><br />
      <span class="post-time small text-muted">30th March 2010 09:06 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Hi hurlee,<br />
      <br />
      If you are asking about executing pre-requisites following is the script I used to do it.<br />
      <br />
      Here I'm checking whether the .net Framework setup is available in the given path and if it's existing, setup will be installed. Otherwise whole installation will quit.<br />
      <br />
      <font face="Courier New">Section "-PreRequisites" ; Hidden section<br />
      <br />
      SectionIn RO ; Read only component<br />
      ClearErrors<br />
      <br />
      IfFileExists "$EXEDIR\Prerequisites\dotnetfx.exe" InstallDotNet NoDotNetFound<br />
      <br />
      NoDotNetFound:<br />
      MessageBox MB_OK "Setup not found."<br />
      Quit<br />
      <br />
      InstallDotNet:<br />
      SetOutPath "$INSTDIR\Prerequisites"<br />
      ExecWait '"$EXEDIR\Prerequisites\dotnetfx.exe" /q:a /c:\install /l /q'<br />
      <br />
      SectionEnd</font><br />
      <br />
      If you have more than one pre-requesites, I think it's better to define separate sections for them. Here I have define PreRequisites section as a hidden and read only one. You can decide that depending on your requirements.<br />
      <br />
      I visited following links to find out parameters necessary for installation in silent mode.<br />
      <a href="http://forums.winamp.com/showthread.php?threadid=267834" target="_blank">http://forums.winamp.com/showthread.php?threadid=267834</a><br />
      <a href="http://blogs.msdn.com/astebner/archive/2007/02/07/update-regarding-silent-install-of-the-vc-8-0-runtime-vcredist-packages.aspx" target="_blank">http://blogs.msdn.com/astebner/archi...-packages.aspx</a></p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">hurlee</span><br />
      <span class="post-time small text-muted">30th March 2010 15:25 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Thanks watzr<br />
      Sorry im not quite get it.<br />
      My application PreRequisites are .netframework 3.5 also it says Windows installer 3.1 and cards.dll do you think this is Prerequisite?(cards.dll?)<br />
      Because my apllication is very small so i just want to include them in it using NSIS. I thought most user dont like downloading from internet.I collected many other methods but still i m not able to do this. It was easy for me to deploy VB 6 application using NSIS .</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">watzr</span><br />
      <span class="post-time small text-muted">31st March 2010 18:01 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Hi hurlee,<br />
      <br />
      <br />
      Pre-requisites should be decided by you depending on your application. If you feel that the given files should be there to work with your application then you can consider them as Pre-requisites. You can run executables using "ExecWait" command, but for DLLs you can copy then to specific directory using "File" command.<br />
      <br />
      If you wants to install your VB.net application with pre-requisites(pardon me if I didnt get your question) first Write sections to install Pre-requisites and then Write a section to install VB.NET application.<br />
      <br />
      Section "-PreRequisites1" ; Hidden section<br />
      <br />
      SetOutPath "$INSTDIR\Prerequisites"<br />
      ExecWait '"$EXEDIR\Prerequisites\setup1.exe" /q:a /c:\install /l /q'<br />
      <br />
      SectionEnd<br />
      <br />
      Section "-PreRequisites2" ; Hidden section<br />
      <br />
      SetOutPath "$INSTDIR\Prerequisites"<br />
      File "&lt;path&gt;\cards.dll"<br />
      <br />
      SectionEnd<br />
      <br />
      In section PreRequisites1 setup11 will be installed in silent mode to a directory called "Prerequisites" in the installation directory.<br />
      <br />
      You can specify "ExeWait" command as follows if you want to install in in normal mode.<br />
      <br />
      ExecWait "$EXEDIR\Prerequisites\setup1.exe"<br />
      <br />
      Above example will execute pre-requisites located in a given directory instead of downloading them. So you have to save those pre-requisites in that directory to accomplish the installation.<br />
      <br />
      Otherwise you can embed pre-requisites to application installer too. But that's not a good idea if your pre-requisites occupy more space.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">hurlee</span><br />
      <span class="post-time small text-muted">2nd April 2010 11:43 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Thanks WATZR<br />
      But can you show me example just using the prerequirements(.netframework 3.5 and windows installer 3.1) Do you think this win installer 3.1 is nessessary?<br />
      My App. will be muushig.exe and it will use the cards.dll<br />
      I really cant make it if i dont see real example.</p>
    </div>
    <hr />

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]>
  </script>
</body>
</html>
