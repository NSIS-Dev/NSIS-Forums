<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="problem with WriteINIStr and DeleteINISec" />

  <title>problem with WriteINIStr and DeleteINISec - NSIS Forums</title><!-- Bootstrap core CSS -->
  <link rel="stylesheet" type="text/css" href="//netdna.bootstrapcdn.com/bootswatch/3.0.1/readable/bootstrap.min.css" />
  <link rel="stylesheet" href="../css/style.css" type="text/css" /><!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!--[if lt IE 9]>
                <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
                <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->
</head>

<body>
  <div class="container">
    <!-- Put navigation bar here -->

    <ol class="breadcrumb">
      <li><a href="../index.html" class="glyphicon glyphicon-home"></a></li>

      <li><a href="f-65.html">NSIS Discussion</a></li>

      <li class="active">problem with WriteINIStr and DeleteINISec</li>
    </ol>

    <p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=252477">problem with WriteINIStr and DeleteINISec</a></p><br />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">OsmanY22</span><br />
      <span class="post-time small text-muted">2nd August 2006 15:54 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>problem with WriteINIStr and DeleteINISec</strong><br />
      Hi...<br />
      <br />
      I have a problem!<br />
      I would like to enter a path in a document. However goes only through a section_name! I would like to however again delete this section_name!<br />
      <br />
      If I use then DeleteINISec, it deletes me not only section_name, but also entry_name.<br />
      <br />
      The reason is: I have a .bat-file, which I would like to change. However it indicates then in the MS-DOS an error, if I open it. Because the section_name is still in it.<br />
      <br />
      <br />
      Can someone please help me??<br />
      <br />
      WriteINIStr "$INSTDIR\ms_oc4j.bat" "SecMAGICK_HOME" "set MAGICK_HOME" "$INSTDIR\bin"<br />
      WriteINIStr "$INSTDIR\ms_oc4j.bat" "SecINSTDIR " "set INSTDIR" $INSTDIR<br />
      <br />
      by</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
      <span class="post-time small text-muted">2nd August 2006 16:02 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Use FileOpen, FileWrite and FileClose to write to batch files.<br />
      Or use ConfigWrite which is in one of the NSIS useful headers.<br />
      <br />
      -Stu</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">OsmanY22</span><br />
      <span class="post-time small text-muted">2nd August 2006 16:08 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">The batch file is exist!<br />
      <br />
      And i want to change some of the lines! Not all!<br />
      <br />
      ConfigWrite doesn't exist on my eclipse installer?!<br />
      <br />
      Why?<br />
      <br />
      <br />
      (my english is not very good ... sorry ;) )</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
      <span class="post-time small text-muted">2nd August 2006 16:13 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">See the NSIS documentation &gt; Useful Headers<br />
      <br />
      -Stu</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">OsmanY22</span><br />
      <span class="post-time small text-muted">2nd August 2006 16:29 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">thx...<br />
      <br />
      but i have another problem:<br />
      the funktion FileOpen, FileWrite and FileClose is very good ... but how can i write in a batch at the 5.line?<br />
      <br />
      <br />
      <br />
      example:<br />
      Text of a batch:<br />
      set PATH=C:\Dokumente und Einstellungen\oy\workspace\Primes\bin<br />
      set MAGICK_CODER_MODULE_PATH=C:\Dokumente und Einstellungen\oy\workspace\Primes\bin\modules\coders<br />
      set MAGICK_HOME=C:\Dokumente und Einstellungen\oy\workspace\Primes\bin<br />
      <br />
      How can i cange "set MAGICK_HOME=C:\Dokumente und Einstellungen\oy\workspace\Primes\bin" to "set MAGICK_HOME=C:\Programm\MAGICKHOME\bin"?<br />
      <br />
      <br />
      I use this function:<br />
      <br />
      ClearErrors<br />
      FileOpen $3 $INSTDIR\ms_oc4j.bat a<br />
      IfErrors done<br />
      FileWrite $3 "set JAVA_HOME=$INSTDIR"<br />
      FileClose $3<br />
      <br />
      <br />
      thx</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
      <span class="post-time small text-muted">2nd August 2006 16:34 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><a href="http://nsis.sourceforge.net/Write_to_text_file_line_number" target="_blank">http://nsis.sourceforge.net/Write_to...le_line_number</a><br />
      <br />
      -Stu</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">OsmanY22</span><br />
      <span class="post-time small text-muted">3rd August 2006 08:53 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">thx a lot!!!!!</p>
    </div>
    <hr />

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]>
  </script>
</body>
</html>
