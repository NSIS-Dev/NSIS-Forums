<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="MUI_FINISHPAGE_RUN runs the application minimized." />

  <title>MUI_FINISHPAGE_RUN runs the application minimized. - NSIS Forums</title><!-- Bootstrap core CSS -->
  <link rel="stylesheet" type="text/css" href="//netdna.bootstrapcdn.com/bootswatch/3.0.1/readable/bootstrap.min.css" />
  <link rel="stylesheet" href="../css/style.css" type="text/css" /><!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!--[if lt IE 9]>
                <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
                <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->
</head>

<body>
  <div class="container">
    <!-- Put navigation bar here -->

    <ol class="breadcrumb">
      <li><a href="../index.html" class="glyphicon glyphicon-home"></a></li>

      <li><a href="f-65.html">NSIS Discussion</a></li>

      <li class="active">MUI_FINISHPAGE_RUN runs the application minimized.</li>
    </ol>

    <p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=234545">MUI_FINISHPAGE_RUN runs the application minimized.</a></p><br />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">lybra</span><br />
      <span class="post-time small text-muted">2nd January 2006 15:24 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>MUI_FINISHPAGE_RUN runs the application minimized.</strong><br />
      I have created an installer using the MUI. At the end of the installation, the user is given the option to run the application, using:<br />
      <br />
      ---<br />
      !define MUI_FINISHPAGE_RUN "$INSTDIR\${MAINPRODUCT_EXE}"<br />
      ---<br />
      <br />
      This works fine, however the application is run minimized. This is quite annoying; you now first have to select the application in the task bar before you can enter your login credentials. When I start the application by double-clicking the icon of the installed file, it runs normally and you can immediately start typing.<br />
      <br />
      I couldn't find any settings in the MUI manual that would cause the application to run minimized, and also no solutions on this forum. Does anyone have a suggestion?</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Takhir</span><br />
      <span class="post-time small text-muted">2nd January 2006 17:15 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">The only idea - your application stores current main window state in registry on exit and restores this on the next run :)<br />
      Can you repeat situation in a short nsi script with any other application (like Notepad.exe)?</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">lybra</span><br />
      <span class="post-time small text-muted">3rd January 2006 08:19 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Hmm... that was indeed a simple test. Why didn't I come up with that?<br />
      <br />
      Anyway, I've tried it with Notepad and that works excellent. So it seems that our application is the cause of the problem. I'll tell the application developers to fix it. :)<br />
      <br />
      Thanks Takhir.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">lybra</span><br />
      <span class="post-time small text-muted">3rd January 2006 15:18 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">I've done some more research and I may have found the cause for my problem.<br />
      <br />
      First of all, the application is not minimized, but just hidden in the background behind some other application.<br />
      <br />
      Second, the problem only occurs if I click on the Finish button immediately after the installation has completed. If I wait a little bit while the Finish Page shows, the problem does not occur.<br />
      <br />
      When the problem occurs, the following happens:<br />
      After I click the Finish button, the installer starts to run our application and closes down. However, our application does not receive focus, but stays hidden behind one other application. A simple Alt+Tab will give it focus.<br />
      <br />
      My explanation (but I could be terribly wrong with this): During a short amount of time, our application has started, but without a GUI. Windows cannot give focus to it (since there is not yet any visible form), so another application receives focus. When the GUI of our application has started, it does not receive focus any more.<br />
      <br />
      This could also explain why the problem does not occur with Notepad: the loading time of (the GUI of) Notepad is very short (it starts in an instant), so Windows can immmediately give focus to it.<br />
      <br />
      However, I am still puzzled why this does not occur if I wait a little longer on the Finish Page.</p>
    </div>
    <hr />

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]>
  </script>
</body>
</html>
