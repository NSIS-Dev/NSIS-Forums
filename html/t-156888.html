<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="using variables in ReadRegStr" />

  <title>using variables in ReadRegStr - NSIS Forums</title><!-- Bootstrap core CSS -->
  <link rel="stylesheet" type="text/css" href="//netdna.bootstrapcdn.com/bootswatch/3.0.1/readable/bootstrap.min.css" />
  <link rel="stylesheet" href="../css/style.css" type="text/css" /><!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!--[if lt IE 9]>
                <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
                <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->
</head>

<body>
  <div class="container">
    <!-- Put navigation bar here -->

    <ol class="breadcrumb">
      <li><a href="../index.html" class="glyphicon glyphicon-home"></a></li>

      <li><a href="f-65.html">NSIS Discussion</a></li>

      <li class="active">using variables in ReadRegStr</li>
    </ol>

    <p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=156888">using variables in ReadRegStr</a></p><br />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">cosmic66</span><br />
      <span class="post-time small text-muted">20th November 2003 09:41 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>using variables in ReadRegStr</strong><br />
      I would like to use my own variables in ReadRegStr:<br />
      <br />
      <font face="courier new">Var Test1<br />
      Var Test2<br />
      [...]<br />
      StrCpy $Test1 "HKLM"<br />
      StrCpy $Test2 "SYSTEM\CurrentControlSet\Control\Session Manager\Environment"<br /></font><br />
      <br />
      Why does the following not work?<br />
      <font face="courier new"><br />
      ReadRegStr $1 $Test1 $Test2 "PATH"<br /></font><br />
      <br />
      Whereas the following works:<br />
      <font face="courier new"><br />
      ReadRegStr $1 "HKLM" $Test2 "PATH"<br /></font><br />
      <br />
      <br />
      Thanks!</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
      <span class="post-time small text-muted">20th November 2003 09:59 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">ReadRegStr doesn't process the root key on runtime. If you want to make it change on runtime you'd have to add another line of ReadRegStr. Same goes for all other registry instructions.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">cosmic66</span><br />
      <span class="post-time small text-muted">20th November 2003 10:24 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">I would like to do the following:<br />
      <br />
      In the function .onInit I check if the user has administration<br />
      rights, if so, I would like to register the environment variables<br />
      for all users, otherwise they are registered for the current user<br />
      (thus I have to use different root_key and sub_key for reading and writing the registry keys).<br />
      <br />
      How could I achieve that?</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
      <span class="post-time small text-muted">20th November 2003 10:36 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">A simple comparsion. Assuming $0 is set to "admin" if the user can write to HKLM you can use:<br />
      <br />
      StrCmp $0 "admin" goHKLM<br />
      WriteRegStr HKCU ....<br />
      Goto done<br />
      goHKLM:<br />
      WriteRegStr HKLM ....<br />
      done:</p>
    </div>
    <hr />

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]>
  </script>
</body>
</html>
