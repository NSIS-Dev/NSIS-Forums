<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="Dialup Internet &amp; E-Mail" />

  <title>Dialup Internet &amp; E-Mail - NSIS Forums</title><!-- Bootstrap core CSS -->
  <link rel="stylesheet" type="text/css" href="//netdna.bootstrapcdn.com/bootswatch/3.0.1/readable/bootstrap.min.css" />
  <link rel="stylesheet" href="../css/style.css" type="text/css" /><!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!--[if lt IE 9]>
                <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
                <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->
</head>

<body>
  <div class="container">
    <!-- Put navigation bar here -->

    <ol class="breadcrumb">
      <li><a href="../index.html" class="glyphicon glyphicon-home"></a></li>

      <li><a href="f-65.html">NSIS Discussion</a></li>

      <li class="active">Dialup Internet &amp; E-Mail</li>
    </ol>

    <p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=142280">Dialup Internet &amp; E-Mail</a></p><br />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Vytautas</span><br />
      <span class="post-time small text-muted">15th July 2003 13:37 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>Dialup Internet &amp; E-Mail</strong><br />
      Does anyone know of a way of creating &amp; deleting dialup internet accounts using NSIS? It would also be nice to do the same to e-mail accounts in Outlook Express.<br />
      <br />
      Also is there a way to check and disable "File &amp; Printer Sharing" for dialup networking adapter?<br />
      <br />
      Vytautas</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">n0On3</span><br />
      <span class="post-time small text-muted">16th July 2003 11:58 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Some time ago I found one program that could backup/restore dial-up accounts easily. you can found one utility that can do that and use it through nsis.<br />
      <br />
      I don't use outlook, so I can't help on this.<br />
      <br />
      Maybe there's a registry tweak to disable that sharing.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Vytautas</span><br />
      <span class="post-time small text-muted">17th July 2003 14:32 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">I was thinking more along the lines of an API call or adding registry entries to add a dailup account and/or e-mail account.<br />
      <br />
      Vytautas</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
      <span class="post-time small text-muted">17th July 2003 16:12 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">RasCreatePhonebookEntry is the closest function I could find. Dial-up uses RAS, so that's where your answer probably is. As for Outlook [Express], afaik it doesn't have any API. But you can probably create the right registry keys and folders. In Windows XP the folders are in Documents and Settings\USER\Local Settings\Application Data\Identities\{xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx}. Look for {xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx} in the registry and you'll find the right registry key. As for File &amp; Sharing, I have no idea... Maybe a VBScript would do the trick.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Vytautas</span><br />
      <span class="post-time small text-muted">18th July 2003 06:00 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">I found that I can create an email account by creating several reg entries in this key "HKEY_CURRENT_USER\Software\Microsoft\Internet Account Manager\Accounts\xxxxxxxx". I have two questions about this:<br />
      <br />
      1) Is there a way of getting the next available subfolder in the registry, i.e. it uses hex numbers.<br />
      <br />
      2) The 'pop3 password2' value seemed to be somehow encrypted, is there a API call to encrypt a password so that it can be written to the registry?<br />
      <br />
      Vytautas</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
      <span class="post-time small text-muted">18th July 2003 11:22 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">That hex number is a GUID, you have to generate a new one using CoCreateGuid. It'll probably be easier to use uuidgen.exe (a utility by Microsoft) to convert it to a string you can use in the registry.<br />
      <br />
      As for the password, no idea. It's probably using CryptoAPI and might even use the CryptEncryptMessage function, but I am not sure.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Vytautas</span><br />
      <span class="post-time small text-muted">18th July 2003 12:36 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">kichik are you sure that it is GUID, it seems very short for it as its only 8 chars long and seems to be sequential. Note that it is in the "HKEY_CURRENT_USER" and not in "HKEY_LOCAL_MACHINE".<br />
      <br />
      As for the password thanks for the hint, I'll try to compare the results from those API functions with the results generated from within outlook express.<br />
      <br />
      Vytautas<br />
      <br />
      BTW where could i find more info about RAS.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
      <span class="post-time small text-muted">18th July 2003 12:43 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Are you sure you're looking at the right place? My Outlook Express account information is in HKEY_CURRENT_USER\Identities\{<i>guid</i>}\Software\Microsoft\Outlook Express.<br />
      <br />
      You can find more information about RAS in MSDN.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Vytautas</span><br />
      <span class="post-time small text-muted">18th July 2003 12:50 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Which version of windows are you running? I tried Win2k and WinXP and found that "HKEY_CURRENT_USER\Identities\{guid}\Software\Microsoft\Outlook Express" location contains setting for Outlook Express and that "HKEY_CURRENT_USER\Software\Microsoft\Internet Account Manager\Accounts\xxxxxxxx" contains the actual e-mail account settings such as pop3 &amp; smtp servers, username, etc.<br />
      <br />
      Vytautas</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
      <span class="post-time small text-muted">18th July 2003 13:52 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">I'm using XP and the account information is in a key called "Internet Account Manager", just as yours, but under the same key as the above Outlook Express key.<br />
      <br />
      I have multiple users on this computer, and had multiple OE users (identities) on this user, so that's must be why it's not in the same place.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Vytautas</span><br />
      <span class="post-time small text-muted">18th July 2003 22:28 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Yes the multiple OE identities would explain that, so under the second key do you have just the GUID or are there other keys after that, i.e. "00000001".<br />
      <br />
      Also is there a way to enumerate keys in a specified branch of the registry and/or check if a specified <b>key</b> exists.<br />
      <br />
      Vytautas</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
      <span class="post-time small text-muted">18th July 2003 22:32 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Under Internet Account Manager it's exactly as you've described.<br />
      <br />
      To enumerate a key use EnumRegKey and EnumRegValue.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">pengyou</span><br />
      <span class="post-time small text-muted">19th July 2003 11:48 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">OE stores account data in two different places, depending upon the identity involved. There is an original "Main Identity" which is usually created when OE is installed. If other identities are created, their account data is stored separately from that of the original "Main Identity".<br />
      <br />
      I found a helpful description here: <a href="http://insideoe.tomsterdam.com/files/regkeys.htm" target="_blank">http://insideoe.tomsterdam.com/files/regkeys.htm</a></p>
    </div>
    <hr />

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]>
  </script>
</body>
</html>
