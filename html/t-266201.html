<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="description" content="Installer freezes after SHNotifyChange"><title>Installer freezes after SHNotifyChange - NSIS Forums</title><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script><link rel="preload" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css" as="style" onload="this.rel='stylesheet'"><link rel="preload" href="../css/style.css" as="style" onload="this.rel='stylesheet'"><noscript><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css"><link rel="stylesheet" href="../css/style.css"></noscript><script>!function(a){"use strict";var b=function(b,c,d){function e(a){return h.body?a():void setTimeout(function(){e(a)})}function f(){i.addEventListener&&i.removeEventListener("load",f),i.media=d||"all"}var g,h=a.document,i=h.createElement("link");if(c)g=c;else{var j=(h.body||h.getElementsByTagName("head")[0]).childNodes;g=j[j.length-1]}var k=h.styleSheets;i.rel="stylesheet",i.href=b,i.media="only x",e(function(){g.parentNode.insertBefore(i,c?g:g.nextSibling)});var l=function(a){for(var b=i.href,c=k.length;c--;)if(k[c].href===b)return a();setTimeout(function(){l(a)})};return i.addEventListener&&i.addEventListener("load",f),i.onloadcssdefined=l,l(f),i};"undefined"!=typeof exports?exports.loadCSS=b:a.loadCSS=b}("undefined"!=typeof global?global:this);!function(a){if(a.loadCSS){var b=loadCSS.relpreload={};if(b.support=function(){try{return a.document.createElement("link").relList.supports("preload")}catch(b){return!1}},b.poly=function(){for(var b=a.document.getElementsByTagName("link"),c=0;c<b.length;c++){var d=b[c];"preload"===d.rel&&"style"===d.getAttribute("as")&&(a.loadCSS(d.href,d,d.getAttribute("media")),d.rel=null)}},!b.support()){b.poly();var c=a.setInterval(b.poly,300);a.addEventListener&&a.addEventListener("load",function(){b.poly(),a.clearInterval(c)}),a.attachEvent&&a.attachEvent("onload",function(){a.clearInterval(c)})}}}(this);</script></head><body><div class="container"><ol class="breadcrumb"><li><a href="../index.html" class="glyphicon glyphicon-home"></a></li><li><a href="f-65.html">NSIS Discussion</a></li><li class="active">Installer freezes after SHNotifyChange</li></ol><p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=266201">Installer freezes after SHNotifyChange</a></p><br><div class="post"><p class="post-meta"><span class="post-author text-primary">Brett Embery</span><br><span class="post-time small text-muted">20th February 2007 03:26 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>Installer freezes after SHNotifyChange</strong><br>Hello all,<br><br>My first post to the forum :) I've done a search about this and came up with not too much information or similar problems..<br><br>I've been having some problems with (it seems) SHNotifyChange locking the installer on some systems. The installer will successfully install all required files, shortcuts and file associations, until shell refresh where the installer's user interface locks up or spins waiting.<br><br>I am unable to reproduce it on mine, so I am unable to confirm my suspects, however we've had many people report it. (see attached screen shot)<br><br>The code I'm interested in is :<br><br>&lt;snip&gt;<br><br>;Call RefreshShellIcons<br>!define SHCNE_ASSOCCHANGED 0x08000000<br>!define SHCNF_IDLIST 0<br><br>Function RefreshShellIcons<br>; By jerome tremblay - april 2003<br>System::Call 'shell32.dll::SHChangeNotify(i, i, i, i) v \<br>(${SHCNE_ASSOCCHANGED}, ${SHCNF_IDLIST}, 0, 0)'<br>FunctionEnd<br><br>;Refresh the shell icons after changing file associations<br>Call RefreshShellIcons<br><br>;Force Desktop Refresh<br>; magic numbers :<br>; 65535 = HWND_BROADCAST<br>; 26 = WM_SETTINGCHANGE<br>SendMessage 65535 26 0 0<br>&lt;/snip&gt;<br><br>Has anyone had similar problems ?<br>Are there any known issues with shell notification ?<br><br>Would love to hear any feedback/suggestions.<br><br>Thanks!</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Anders</span><br><span class="post-time small text-muted">20th February 2007 06:01 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">try using 0x2000 (SHCNF_FLUSHNOWAIT) as the flags for SHChangeNotify</p></div><hr><div class="footer"><p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p></div></div><script type="text/javascript" src="../js/highlight.pack.js" async></script><script type="text/javascript">//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]></script></body></html>