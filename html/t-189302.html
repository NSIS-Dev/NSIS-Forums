<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="script help" />

  <title>script help - NSIS Forums</title><!-- Bootstrap core CSS -->
  <link rel="stylesheet" type="text/css" href="//netdna.bootstrapcdn.com/bootswatch/3.0.1/readable/bootstrap.min.css" />
  <link rel="stylesheet" href="../css/style.css" type="text/css" /><!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!--[if lt IE 9]>
                <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
                <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->
</head>

<body>
  <div class="container">
    <!-- Put navigation bar here -->

    <ol class="breadcrumb">
      <li><a href="../index.html" class="glyphicon glyphicon-home"></a></li>

      <li><a href="f-65.html">NSIS Discussion</a></li>

      <li class="active">script help</li>
    </ol>

    <p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=189302">script help</a></p><br />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">more frustrated</span><br />
      <span class="post-time small text-muted">8th August 2004 11:26 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>script help</strong><br />
      ok, I searched, I read, and I still don't understand. I used Venis wizard to create my script, and I looked at the font reg plug in. I just don't understand how, where to place the script. No matter how I do it it comes out wrong. I just made a skin for another program (not Winamp), and it requires a font. I know that I could just have a reboot prompt at the end of the install, but I would rather not. Also some users may be using XP, 98, ME or 2000, so I need the installer to find the font folder and the reg key. If someone could just modify this script and post it I would be greatful.<br />
      <br />
      ; Script generated with the Venis Install Wizard<br />
      <br />
      ; Define your application name<br />
      !define APPNAME "test"<br />
      !define APPNAMEANDVERSION "test 1.0"<br />
      <br />
      ; Main Install settings<br />
      Name "${APPNAMEANDVERSION}"<br />
      InstallDir "C:\Program Files\test\"<br />
      OutFile "..\..\Program Files\Venis\test.exe"<br />
      <br />
      ; Modern interface settings<br />
      !include "MUI.nsh"<br />
      <br />
      !define MUI_ABORTWARNING<br />
      <br />
      !insertmacro MUI_PAGE_WELCOME<br />
      !insertmacro MUI_PAGE_LICENSE "EULA.txt"<br />
      !insertmacro MUI_PAGE_COMPONENTS<br />
      !insertmacro MUI_PAGE_DIRECTORY<br />
      !insertmacro MUI_PAGE_INSTFILES<br />
      <br />
      !define MUI_FINISHPAGE_LINK "Visit my website for the latest news."<br />
      !define MUI_FINISHPAGE_LINK_LOCATION "http://www.test.net/test.html"<br />
      <br />
      !define MUI_FINISHPAGE_RUN "C:\Program Files\test\test.exe"<br />
      <br />
      !insertmacro MUI_PAGE_FINISH<br />
      <br />
      ; Set languages (first is default language)<br />
      !insertmacro MUI_LANGUAGE "English"<br />
      !insertmacro MUI_RESERVEFILE_LANGDLL<br />
      <br />
      Section "test" Section1<br />
      <br />
      ; Set Section properties<br />
      SetOverwrite on<br />
      <br />
      ; Set Section Files and Shortcuts<br />
      SetOutPath "$INSTDIR\"<br />
      File "..\..\Program Files\test\test.exe"<br />
      File "..\..\Program Files\test\test.jpg"<br />
      File "..\..\Program Files\test\test1.jpg"<br />
      <br />
      SectionEnd<br />
      <br />
      Section "test font" Section2<br />
      <br />
      ; Set Section properties<br />
      SetOverwrite on<br />
      <br />
      ; Set Section Files and Shortcuts<br />
      SetOutPath "C:\Windows\Fonts\"<br />
      File "..\..\My Documents\test font\test.TTF"<br />
      <br />
      SectionEnd<br />
      <br />
      ; Modern install component descriptions<br />
      !insertmacro MUI_FUNCTION_DESCRIPTION_BEGIN<br />
      !insertmacro MUI_DESCRIPTION_TEXT ${Section1} "test"<br />
      !insertmacro MUI_DESCRIPTION_TEXT ${Section2} "Required font!"<br />
      !insertmacro MUI_FUNCTION_DESCRIPTION_END<br />
      <br />
      BrandingText "me"<br />
      <br />
      ; eof<br />
      <br />
      Thanks</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">more frustrated</span><br />
      <span class="post-time small text-muted">8th August 2004 23:13 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">No one can help me?:(</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">more frustrated</span><br />
      <span class="post-time small text-muted">10th August 2004 16:42 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Its hard to imaging that no one here is willing to take a moment to help me. I dont understand the script and I'm not a programmer. I really dont feel like taking a course on scripting when this is probably the only time I will ever use it.<br />
      <br />
      Please take a moment to help, please.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Joel</span><br />
      <span class="post-time small text-muted">10th August 2004 17:02 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Attaching script...<br />
      <br />
      Look, this is simple:<br />
      1. Read the DOCs about the constants of Windows, Program files, etc...<br />
      <br />
      2. The font isn't apply that easy, search the web archive for the font installer, more or less.<br />
      <br />
      3. Try to post exactly the error, that way we can guide without the hole script editing...<br />
      <br />
      Just, as you posted, take a time to see the examples, readmes, FAQ, etc., then you can mastering the power of NSIS.<br />
      <br />
      Hope that I helped... :winamp: :)</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">more frustrated</span><br />
      <span class="post-time small text-muted">10th August 2004 18:06 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"></p>

      <blockquote>
        <i>Originally posted by Lobo Lunar</i><br />
        <b>Attaching script...<br />
        <br />
        Look, this is simple:<br />
        1. Read the DOCs about the constants of Windows, Program files, etc...<br />
        <br />
        2. The font isn't apply that easy, search the web archive for the font installer, more or less.<br />
        <br />
        3. Try to post exactly the error, that way we can guide without the hole script editing...<br />
        <br />
        Just, as you posted, take a time to see the examples, readmes, FAQ, etc., then you can mastering the power of NSIS.<br />
        <br />
        Hope that I helped... :winamp: :)</b>
      </blockquote>1. I don't understand all that, Its over my head. Its seems everything is geared towards those who already understand the script language. I dont understand the terms or the definitions of the terms. Push the stack means nothing to me. While I'm sure its easy for you it's definitely not easy for me.<br />
      <br />
      2. I have found the font plugin, but again there's nothing that tells me how to use it. It seems once again that it's geared for those who know the script language. There are two parts that must be edited in some way and placed some where in the script, but no indication where they go or what changes must be made.<br />
      <br />
      3. I cant get an error for you because as I stated before I don't know how I need to change the font plugin script, or where to place it within my script.<br />
      <br />
      As for taking some time to learn for myself. Well I have tried. I have probably spent ten hours trying to figure this out for myself. I have search, and read the docs., I have not seen an example on how the font plugin works in a complete script, so without that I am just stabing in the dark.<br />
      <br />
      This is really over my head, I just wanted to make an installer for a skin that I made, and to have it install and register the font, so that users dont have to install the font manually, or reboot.
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
      <span class="post-time small text-muted">10th August 2004 18:49 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Plugin calls are done on run-time, therefore they go in a Section or a Function.<br />
      <br />
      So, call the Font plugin in a Section preferably after you extract the font!<br />
      <br />
      -Stu</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">more frustrated</span><br />
      <span class="post-time small text-muted">10th August 2004 19:56 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">ok, this is what from the font register fonts page.<br />
      <br /></p>

      <blockquote>
        Save this script as a NSIS Include file in the Include directory of NSIS so that then you can easily get font registration functionality in any script by simply including this file. (Suggested file name: FontReg.nsh)
      </blockquote>(actually I had to change it to FontReg.nsi before I could include it) Is that correct?<br />
      <br />
      I did that and added !include FontReg.nsi in section 2 after DetailPrint. Am I on the right track so far? Now I get an error.<br />
      "!include: error in script: "C:\PROGRAM FILES\NSIS\Include\FontReg.nsi" on line 1<br />
      Error in script "stdin" on line 53 -- aborting creation process"<br />
      <br />
      Line 1 is "var FONT_DIR", what should it be?
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Joel</span><br />
      <span class="post-time small text-muted">10th August 2004 20:55 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"></p>

      <blockquote>
        I did that and added !include FontReg.nsi in section 2 after DetailPrint
      </blockquote>
      <pre>
<code><br />!include<br /></code>
</pre><br />
      Must go out-side from the sections.<br />
      Look, contact me by pm (private message) I can help you by MSN... :) If you want.....
    </div>
    <hr />

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]>
  </script>
</body>
</html>
