<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="Uninstaller by section" />

  <title>Uninstaller by section - NSIS Forums</title>
  <script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script>
  <!-- Bootstrap core CSS -->

  <link rel="stylesheet" type="text/css" href="//netdna.bootstrapcdn.com/bootswatch/3.0.1/readable/bootstrap.min.css" />
  <link rel="stylesheet" href="../css/style.css" type="text/css" /><!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!--[if lt IE 9]>
                <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
                <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->
</head>

<body>
  <div class="container">
    <!-- Put navigation bar here -->

    <ol class="breadcrumb">
      <li><a href="../index.html" class="glyphicon glyphicon-home"></a></li>

      <li><a href="f-65.html">NSIS Discussion</a></li>

      <li class="active">Uninstaller by section</li>
    </ol>

    <p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=313397">Uninstaller by section</a></p><br />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">cosmos38240</span><br />
      <span class="post-time small text-muted">5th October 2009 12:37 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>Uninstaller by section</strong><br />
      Hello,<br />
      <br />
      I would like to have a uninstaller on each section.<br />
      Example :<br />
      <br />
      Section 1 "Section1"<br />
      ...<br />
      Software1<br />
      ...<br />
      WriteUninstaller "$Variable\Uninst1.exe"<br />
      End Section<br />
      <br />
      Section 2 "Section2"<br />
      ...<br />
      Software2<br />
      ...<br />
      WriteUninstaller "$Variable\Uninst2.exe"<br />
      End Section<br />
      <br />
      When I want to launch the Uninst1.exe then un.Section1 is executed but also the un.Section2.<br />
      <br />
      And I don't want that how is it possible to change that please ?<br />
      <br />
      Thank you,<br />
      MichaÃ«l</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">cosmos38240</span><br />
      <span class="post-time small text-muted">6th October 2009 09:45 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Nobody has got an idea or a workaround ?<br />
      I'm just starting to discover NSIS so i am perhaps on a wrong way :)<br />
      <br />
      Thx<br />
      MichaÃ«l</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">MSG</span><br />
      <span class="post-time small text-muted">6th October 2009 10:03 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">There is no simple way to do this. The most straight-forward method I can think of is writing somewhere (registry, ini file) which sections were installed, and then reading that info in your uninstaller.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">TrifonovS</span><br />
      <span class="post-time small text-muted">6th October 2009 10:03 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Hi,<br />
      I made an installer that installs a package, containing 3 different applications. It is clear that it must be possible to uninstall only one of them. My idea is the following. I create only one uninstaller, but it accepts a parameter from the command line. The parameter is the name of the application that must be uninstalled (or several names). When I write the uninstall information to the registry, I put also the corresponding parameter that must be passed to the uninstaller. In function un.onInit you have to check and get the parameters on from the command line. You can do this with the macro un.GetParameters from FileFunc.nsh. Everything works without any problems.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">MSG</span><br />
      <span class="post-time small text-muted">6th October 2009 10:21 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">There is one problem with this approach: The user might run uninstall.exe manually, in which case no parameters would be supplied.<br />
      <br />
      Since you're already writing to the registry, you might as well create some regkeys of your own, to identify which applications have been installed and which haven't.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">TrifonovS</span><br />
      <span class="post-time small text-muted">6th October 2009 10:43 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">If the unuinstaller is started manually, it shows a component dialog (I forgot to tell that in another case it is started in silent mode). In this dialog you can see all supported applications and these once which are already uninstalled are inactive. So you can select manually what do you want to uninstall. After the last application is uninstalled, the uninstaller can delete itself too... It works so...</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">cosmos38240</span><br />
      <span class="post-time small text-muted">6th October 2009 12:50 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Hi Msg and TrifonovS,<br />
      <br />
      Thank you very much for your advice, it is very helpfull for me.<br />
      <br />
      I have now an idea of what to do :)</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">cosmos38240</span><br />
      <span class="post-time small text-muted">6th October 2009 13:53 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">I didn't see that it was possible to have page for uninstall ...<br />
      <br />
      So I have just put<br />
      !insertmacro MUI_UNPAGE_COMPONENTS<br />
      <br />
      And the Section "un.Section1" is executed.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">TrifonovS</span><br />
      <span class="post-time small text-muted">6th October 2009 14:58 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Yes, the most of the pages that can be used in the installer have uninstaller versions...</p>
    </div>
    <hr />

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]>
  </script>
</body>
</html>
