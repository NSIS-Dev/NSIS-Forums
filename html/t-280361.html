<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="description" content="ExecShell not detecting program already installed"><title>ExecShell not detecting program already installed - NSIS Forums</title><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script><link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css"><link rel="stylesheet" href="../css/style.css" type="text/css"></head><body><div class="container"><ol class="breadcrumb"><li><a href="../index.html" class="glyphicon glyphicon-home"></a></li><li><a href="f-65.html">NSIS Discussion</a></li><li class="active">ExecShell not detecting program already installed</li></ol><p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=280361">ExecShell not detecting program already installed</a></p><br><div class="post"><p class="post-meta"><span class="post-author text-primary">chamakits</span><br><span class="post-time small text-muted">30th October 2007 20:16 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>ExecShell not detecting program already installed</strong><br>I'm currently having a problem with ExecShell.<br><br>The thing is, the progamming i'm making an installer for depends on SQL Server 2005 and SQL Manager.<br><br>My installer installs SQL Server 2005 silently, and SQL Manager as well. When SQL Server gets installed, the sqlcmd command can be accessed, because the SQL Server installer automatically includes its ..Tools\Binn folder into the path. However, i'm trying to access sqlcmd through NSIS and its just not working. I made an .exe that was solely in charge of using sqlcmd for a couple of commands, and when the window pops up with the .exe running, the message appears that "sqlcmd is not a valid command...", as if sqlcmd wasn't available through the system path. However, when I execute the program after the whole instalation is through, it works perfectly.<br>Anybody has any idea why this could be happening?<br><br>PS. I THINK, that it could be that it takes it a while to include sqlcmd into the path, so i should maybe wait a bit after the SQL server 2005 installer is done. Is there any way to wait an amount of x seconds with the NSIS installer? I'm already waiting for the whole installer to finish with ExecWait, but is there a way to wait more?<br><br>Thanks in advance.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br><span class="post-time small text-muted">30th October 2007 20:38 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Sleep [milliseconds]<br><br>Perhaps you need to set a different working directory first with SetOutPath.<br><br>Stu</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">demiller9</span><br><span class="post-time small text-muted">30th October 2007 22:19 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Environment variables are loaded when the program (your NSIS installer) starts and won't be updated when the SQLServer installer changes them. You probably need to use the complete path for the sqlcmd you want to run.<br><br>It executes OK after the whole installer is done because you start a new program that gets the current environment variables which now include ...\Tools\Binn.<br><br>Don</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">chamakits</span><br><span class="post-time small text-muted">1st November 2007 16:12 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">I don't believe the setout path affects it really, because i'm trying to execute something thats a system variable, and I'll try the whole path to see my Luck with that.</p></div><hr><div class="footer"><p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p></div></div><script src="../js/highlight.pack.js" type="text/javascript"></script><script type="text/javascript">//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]></script></body></html>