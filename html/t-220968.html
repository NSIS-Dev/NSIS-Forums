<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="description" content="Derive testbox content from file"><title>Derive testbox content from file - NSIS Forums</title><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script><link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css"><link rel="stylesheet" href="../css/style.css" type="text/css"></head><body><div class="container"><ol class="breadcrumb"><li><a href="../index.html" class="glyphicon glyphicon-home"></a></li><li><a href="f-65.html">NSIS Discussion</a></li><li class="active">Derive testbox content from file</li></ol><p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=220968">Derive testbox content from file</a></p><br><div class="post"><p class="post-meta"><span class="post-author text-primary">TonyT</span><br><span class="post-time small text-muted">8th July 2005 15:17 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>Derive testbox content from file</strong><br>Hi<br><br>My installer writes a text file during the .onInit and I would like to populate a textbox in the UI with the content of this file.<br><br>Any ideas on how I can do this?<br><br>Thanks</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">kichik</span><br><span class="post-time small text-muted">8th July 2005 15:22 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">If the text box is in an InstallOptions page, simply write the text you want into the INI file. If it's in a normal page, use send WM_SETTEXT using SendMessage. Search the examples that come with NSIS for WM_SETTEXT. They contain a couple of usage examples.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">TonyT</span><br><span class="post-time small text-muted">8th July 2005 15:37 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Unfortunately, I don't actually know the text at compile time. The text will vary from PC to PC.<br><br>What I'm actually doing in .onInit is piping the output of an exe into the text file as I thought this might be a way to populate my textbox in the UI.<br><br>Is there a way of piping the output directly into the INI file?</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">kichik</span><br><span class="post-time small text-muted">8th July 2005 15:40 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">You can read the file using FileOpen, FileRead and FileClose and then write it to INI file using WriteINIStr.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br><span class="post-time small text-muted">8th July 2005 16:01 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">If you're writing the text file in .onInit you might as well write to the INI file too. That will save you having to read from the file again. Just make sure you extract the INI file first.<br><br>-Stu</p></div><hr><div class="footer"><p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p></div></div><script src="../js/highlight.pack.js" type="text/javascript"></script><script type="text/javascript">//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]></script></body></html>