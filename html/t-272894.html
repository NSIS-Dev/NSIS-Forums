<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="description" content="Finding an executable. ${Locate}"><title>Finding an executable. ${Locate} - NSIS Forums</title><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script><link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css"><link rel="stylesheet" href="../css/style.css" type="text/css"><!--[if lt IE 9]><script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script><script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script><![endif]--></head><body><div class="container"><ol class="breadcrumb"><li><a href="../index.html" class="glyphicon glyphicon-home"></a></li><li><a href="f-65.html">NSIS Discussion</a></li><li class="active">Finding an executable. ${Locate}</li></ol><p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=272894">Finding an executable. ${Locate}</a></p><br><div class="post"><p class="post-meta"><span class="post-author text-primary">lordnuada</span><br><span class="post-time small text-muted">15th June 2007 23:49 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>Finding an executable. ${Locate}</strong><br>Good afternoon,<br><br>The task I'm trying to accomplish cannot be as difficult as it seems. It's just an installer that looks for a file name, anywhere on the System, and makes thats the default install path. I looked at the InstallDirRegKey function and it doesn't work for me, as there is no key.<br><br>Trying to get the ${Locate} thing work for me is failing me every way i can think of. I am not a professional programmer, but I do hobby stuff. Unfourtantley I can't find a single good example of the Locate function/macro being used that is complete code, just often Peusydo Code. Can somebody please, just show me an example or link me to an example where a there is a script that searches for a file, then changes the $INSTDIR to match that? I also want to append a directory to the returned path. For example, it should return (example: C:\programname\file.exe) i want to add \Data\Reports to that, so the default install string would be C:\programname\Data\Reports. Does anybody have any examples of that, that work. Thanks.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Red Wine</span><br><span class="post-time small text-muted">16th June 2007 00:09 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">"Anywhere on the System" could be a long delay on script execution.<br><br>1st use ${GetDrives} (see the examples in nsis documentation) and then ${Locate} the file on the discovered drives, (also pretty plain examples in documentation).<br><br>You should add all the above in function .onInit if you want to change the $INSTDIR.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">lordnuada</span><br><span class="post-time small text-muted">16th June 2007 00:27 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"></p><blockquote><i>Originally posted by Red Wine</i><br><b>"Anywhere on the System" could be a long delay on script execution.<br><br>1st use ${GetDrives} (see the examples in nsis documentation) and then ${Locate} the file on the discovered drives, (also pretty plain examples in documentation).<br><br>You should add all the above in function .onInit if you want to change the $INSTDIR.</b></blockquote>The examples are NOT good in the documentation, i have been going off them for about 2 hours. Thats why I'm here asking. I have found how to search for a file and get it into a variable name, but i still cant find how to append something too it.<br><br>${Locate} "C:\" "/L=FD /M=Program.exe " "FoundRB"<br>IfErrors 0 +2<br>MessageBox MB_OK "Error" IDOK +2<br>MessageBox MB_OK "$$R0=$R0"<br><br>Function FoundRB<br>StrCpy $R0 $R8<br>****StrCpy $R0 $R0 "\Data\Reports\"<br>StrCpy $0 StopLocate<br><br>Push $0<br>FunctionEnd<br><br><br><br>I can get it to find the file, but i want to take that 'found path' and add \data\reports onto it, but StrCpy instructions don't show how to append or merge or add, or combine or whatever you want to call sticking 2 strings together. I have tried every variation I could think of (as shown above with (****)) Nothing works.<br><br>So that way, when the $R0 variable gets returned, it will be c:\programlocation\Data\Reports as the install path. Also, i tried even getting the .onInit to work and it gives nothing but errors about trying to use ${Locate} in it.</div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">demiller9</span><br><span class="post-time small text-muted">16th June 2007 00:44 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Append text to a register:<br>StrCpy $R0 "$R0\Data\Reports\"</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">lordnuada</span><br><span class="post-time small text-muted">16th June 2007 00:46 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"></p><blockquote><i>Originally posted by demiller9</i><br><b>Append text to a register:<br>StrCpy $R0 "$R0\Data\Reports\"</b><hr></blockquote></div><hr>Yes, thank you that worked. I had just figured that out before checking back here :)<br><div class="post"><p class="post-meta"><span class="post-author text-primary">lordnuada</span><br><span class="post-time small text-muted">16th June 2007 01:02 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">I have got this working now, however it only searches C:\<br><br>Function .onInit<br>${Locate} "C:\" "/L=FD /M=program.exe " "FoundRB"<br>StrCpy $INSTDIR $R0<br>FunctionEnd<br><br>Function FoundRB<br>StrCpy $R0 $R8<br>StrCpy $R0 "$R0\Data\Reports\"<br>StrCpy $0 StopLocate<br>Push $0<br>FunctionEnd<br><br>The one thing I notice is, however, it appears to be 'frozen' at the start (as it is searching the HDD). Is there a way to pop up a quick box , or text line , stating 'Searching for Installed Product'.. or something of that type.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Red Wine</span><br><span class="post-time small text-muted">16th June 2007 10:04 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">${Locate} "C:\" is not good enough, you'd need a combination with the function ${GetDrives} if you want to search on every HDD available.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">lordnuada</span><br><span class="post-time small text-muted">20th June 2007 22:47 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>Example?</strong><br>Quote:</p><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br><span class="post-time small text-muted">20th June 2007 23:03 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">It's not too hard. GetDrives has a callback function (basically a function that it calls lol) and in that function you can call Locate, like shown in this thread:<br><a href="http://forums.winamp.com/showthread.php?threadid=264471" target="_blank">http://forums.winamp.com/showthread.php?threadid=264471</a><br><br>Stu</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">lordnuada</span><br><span class="post-time small text-muted">20th June 2007 23:24 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"></p><blockquote><i>Originally posted by Afrow UK</i><br><b>It's not too hard. GetDrives has a callback function (basically a function that it calls lol) and in that function you can call Locate, like shown in this thread:<br><a href="http://forums.winamp.com/showthread.php?threadid=264471" target="_blank">http://forums.winamp.com/showthread.php?threadid=264471</a><br><br>Stu</b></blockquote>Thanks for the help. Since I'm doing this from the .onInit section, it just make the section too cumbersome, I will just have it search C: and if it's not there they can always click browse :)<br><br>Thanks again for all your help.</div><hr><div class="footer"><p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p></div><script src="../js/highlight.pack.js" type="text/javascript"></script><script type="text/javascript">//<![CDATA[
      hljs.initHighlightingOnLoad();
      //]]></script><table cellpadding="6" cellspacing="0" border="0" width="100%"><tr><td class="alt2"><hr><i>Originally posted by Red Wine</i><br><b>${Locate} "C:\" is not good enough, you'd need a combination with the function ${GetDrives} if you want to search on every HDD available.</b> I have looked at the ${GetDrives} examples, and I don't see how I can embed the variables into the ${Locate} method? Could you give a brief example?<br><br>Thanks,</td></tr></table></div></div></body></html>