<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="Changing default button fuctions in nsDialogPage" />

  <title>Changing default button fuctions in nsDialogPage - NSIS Forums</title><!-- Bootstrap core CSS -->
  <link rel="stylesheet" type="text/css" href="//netdna.bootstrapcdn.com/bootswatch/3.0.1/readable/bootstrap.min.css" />
  <link rel="stylesheet" href="../css/style.css" type="text/css" /><!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!--[if lt IE 9]>
                <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
                <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->
</head>

<body>
  <div class="container">
    <!-- Put navigation bar here -->

    <ol class="breadcrumb">
      <li><a href="../index.html" class="glyphicon glyphicon-home"></a></li>

      <li><a href="f-65.html">NSIS Discussion</a></li>

      <li class="active">Changing default button fuctions in nsDialogPage</li>
    </ol>

    <p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=304663">Changing default button fuctions in nsDialogPage</a></p><br />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">RG2</span><br />
      <span class="post-time small text-muted">27th March 2009 00:27 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>Changing default button fuctions in nsDialogPage</strong><br />
      Hey guys<br />
      <br />
      Ok, so I am a super n00b at this...so bear with me.<br />
      <br />
      What I am aiming to do is create a single custom page which has two buttons - each of them point to a different installer (the other installers already work - I didn't make them though).<br />
      <br />
      I have looked at a few tutorials and have managed to make a blank custom page using 'Page custom nsDialogsPage'. This gives me a blank page with two buttons - Cancel and Quit. I have figured out how to add the code for the other two buttons I want which point to the other installers.<br />
      <br />
      My question is...how do I change the function or text of the two default buttons - Cancel and Quit? It would be nice to keep the Quit button and change the text of the Cancel button to 'More'. Also, I would like the 'More' button to open a webpage, but I don't want the webpage to open when I click on the red X in the upper corner of the window.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Animaether</span><br />
      <span class="post-time small text-muted">27th March 2009 01:41 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">You can get those buttons using...<br /></p>
      <pre>
<code><br />GetDlgItem $0 $HWNDPARENT 3 ; Back Button<br />GetDlgItem $1 $HWNDPARENT 1 ; Next/Close Button<br />GetDlgItem $2 $HWNDPARENT 2 ; Cancel Button<br /></code>
</pre><br />
      <br />
      You can change the text on them using...<br />
      <pre>
<code><br />SendMessage $0 ${WM_SETTEXT} 0 "STR:Your Text Here"<br /></code>
</pre><br />
      <br />
      You can hide them using..<br />
      <pre>
<code><br />ShowWindow $0 ${SW_HIDE} ; ${SW_SHOW}<br /></code>
</pre><br />
      <br />
      Disable using..<br />
      <pre>
<code><br />EnableWindow $0 0 ; 1<br /></code>
</pre><br />
      <br />
      But you can't really modify their behavior.<br />
      If the 'Quit' button you mention is actually the 'Next' button, you could just create another custom page after the one you've already made, and launch the webpage in that new custom page.<br />
      The red X is hooked up to the Cancel button, which you could re-label Quit if you'd like.
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">RG2</span><br />
      <span class="post-time small text-muted">27th March 2009 02:55 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Ok, awesome. Thanks for the reply!<br />
      <br />
      After I posted this I mucked around a bit more and came to the conclusion you mentioned - to hook up the Next button to open a blank page which launches the webpage. So, yay for figuring that out.<br />
      <br />
      After the code to launch the webpage I added a Call to relauch my original page so my installer would stop closing on me. So now the fuction for the 'Next' button looks like this:<br />
      <br />
      Function Next<br />
      ExecShell "open" "http://www.yahoo.com"<br />
      Call nsDialogsWelcome<br />
      FunctionEnd<br />
      <br />
      When this runs the webpage opens and the original installer page opens (like I want it to), but the 'Next' and Quit buttons are now gone and replaced by a single Back button. Clicking this Back button takes me to the original installer page, but minus the 'next' and quit buttons. All I want is for the original installer window to remain up when the 'Next' button is clicked and for a webpage to open. Am I coding this completely wrong to do what I want?</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Animaether</span><br />
      <span class="post-time small text-muted">27th March 2009 03:37 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">my mistake - better off using this:<br /></p>
      <pre>
<code><br />!addplugindir "."<br />!addincludedir "."<br /><br />!include "nsDialogs.nsh"<br />!include "winmessages.nsh"<br />!include "logiclib.nsh"<br /><br />; !include "MUI2.nsh"<br /><br />OutFile "test.exe"<br /><br />var dialog<br />var hwnd<br />var null<br /><br />Page Custom page.custom page.custom.next<br /><br />Function page.custom<br />        nsDialogs::Create 1018<br />        Pop $dialog<br /><br />        ${NSD_CreateButton} 0 0 50% 10% "A"<br />            Pop $hwnd<br />                ${NSD_OnClick} $hwnd page.custom.buttonA.onclick<br />        ${NSD_CreateButton} 50% 0 50% 10% "B"<br />            Pop $hwnd<br />            ${NSD_OnClick} $hwnd page.custom.buttonB.onclick<br /><br />        GetDlgItem $0 $HWNDPARENT 3 ; Back Button<br />        GetDlgItem $1 $HWNDPARENT 1 ; Next/Close Button<br />        GetDlgItem $2 $HWNDPARENT 2 ; Cancel Button<br /><br />        ${NSD_SetText} $1 "More Info..."<br /><br />        nsDialogs::Show<br />FunctionEnd<br />Function page.custom.buttonA.onclick<br />        MessageBox MB_OK "A"<br />FunctionEnd<br />Function page.custom.buttonB.onclick<br />        MessageBox MB_OK "B"<br />FunctionEnd<br /><br />Function page.custom.next<br />        ExecShell "open" "http://www.winamp.com/"<br />        Abort<br />FunctionEnd<br /><br />Section<br />SectionEnd<br /><br />; !insertmacro MUI_LANGUAGE "English"<br /></code>
</pre><br />
      So that 'page.custom.next' is called in the first Custom Page's 'leave' callback. 'page.custom.next' then calls 'Abort' to prevent the Next click from actually moving on to the next page / closing the installer (if the last page).
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">RG2</span><br />
      <span class="post-time small text-muted">27th March 2009 05:42 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Thanks Animaether...That is exactly what I am looking for!! That was also a much easier way to do what I wanted. There was easily double that code on my end to get the same effect.<br />
      <br />
      I do have another question. I copy n pasted your example and complied it and the installer did not close when clicking the More Info button (YAY). When I re-edited my code to match yours the More Info button closed the installer (BOO).<br />
      <br />
      I am curious as to what exactly tells the installer not to close when that button is clicked. From what you are saying it sounds like that 'Abort' call in the Next function should do that.<br />
      <br />
      My next function looks like this:<br />
      <br />
      Function page.custom.next<br />
      ExecShell "open" "http://www.yahoo.com"<br />
      Abort<br />
      FunctionEnd<br />
      <br />
      Same as yours, but just pointing to Yahoo. Is there some sort of parameter that is critical to call outside of this function in order to get my desired effect? Now, I am just curious.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">RG2</span><br />
      <span class="post-time small text-muted">27th March 2009 05:55 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">It looks like I jsut answered my own question. I started playing around with my code and I had this setup on my end.<br />
      <br />
      Page custom page.custom<br />
      Page custom page.custom.next<br />
      <br />
      And you had:<br />
      <br />
      Page custom page.custom page.custom.next<br />
      <br />
      <br />
      I changed mine to look like yours and the installer no longer closed when clicking the More Info button (YAY). Why is that? Is it because I do not want to go to a second page therefor I do not define a second page? I assumed the 'page.custom.next' was defining a 2nd page.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Animaether</span><br />
      <span class="post-time small text-muted">27th March 2009 07:30 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">it -was- defining a 2nd page (with that second "Page custom page.custom.next" line), but now we're just re-using it (with different code inside that function) as the first page's 'leave' function.<br />
      <br />
      A custom page basically has 2 functions... 1 function to create it, and another when the user leaves it by pressing the Next button (or 'close' if it's so-labeled.. still the same button).<br />
      <br />
      If you don't need another page - then there's no real use in creating one; just handle it in the current page's leave function :)</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">RG2</span><br />
      <span class="post-time small text-muted">27th March 2009 07:38 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Interesting...good to know! Thanks a lot for the help! :D</p>
    </div>
    <hr />

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]>
  </script>
</body>
</html>
