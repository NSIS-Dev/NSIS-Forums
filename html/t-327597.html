<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="Running a hidden app on finish" />

  <title>Running a hidden app on finish - NSIS Forums</title><!-- Bootstrap core CSS -->
  <link rel="stylesheet" type="text/css" href="//netdna.bootstrapcdn.com/bootswatch/3.0.1/readable/bootstrap.min.css" />
  <link rel="stylesheet" href="../css/style.css" type="text/css" /><!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!--[if lt IE 9]>
                <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
                <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->
</head>

<body>
  <div class="container">
    <!-- Put navigation bar here -->

    <ol class="breadcrumb">
      <li><a href="../index.html" class="glyphicon glyphicon-home"></a></li>

      <li><a href="f-65.html">NSIS Discussion</a></li>

      <li class="active">Running a hidden app on finish</li>
    </ol>

    <p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=327597">Running a hidden app on finish</a></p><br />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Collector9999</span><br />
      <span class="post-time small text-muted">20th February 2011 01:01 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>Running a hidden app on finish</strong><br />
      I have a hidden app that does nothing more than call DOSBox with the "-conf" parameter. This launcher works fine when executing on its own but will not even start when called from the run of the MUI2 finish page. Its process never shows in the task manager. It also works from the run of the finish page with no changes to the script if I compile the launcher to run unhidden.<br />
      <br />
      Obviously, there are a number of workarounds, but I would like to know how to use a hidden for the finish run or at least why it does not work.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">jiake</span><br />
      <span class="post-time small text-muted">20th February 2011 13:41 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">If you want to run an application with arguments, you must define like this:<br />
      !define MUI_FINISHPAGE_RUN "$INSTDIR\YourApp.exe"<br />
      !define MUI_FINISHPAGE_RUN_PARAMETERS "-conf"<br />
      But not:<br />
      !define MUI_FINISHPAGE_RUN "$INSTDIR\YourApp.exe -conf"<br />
      <br />
      If the process is always running, maybe it is a service. You may try the <a href="http://nsis.sourceforge.net/Services_plug-in" target="_blank">Services</a>, <a href="http://nsis.sourceforge.net/NSIS_Simple_Service_Plugin" target="_blank">SimpleSC</a> or <a href="http://nsis.sourceforge.net/NsSCM_plug-in" target="_blank">NsSCM</a> plugin.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Collector9999</span><br />
      <span class="post-time small text-muted">21st February 2011 04:47 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">No, the NSIS script is right. I have been writing NSIS installers for years now. The parameter is passed by the EXE to be run after the installer finishes, and not from the NSIS script. It is the EXE itself that is set to run hidden, not by NSIS. As I said, If I recompile the application (not the installer) to run not hidden it works. If I compile it to run as a hidden EXE, the process does not even start. It does work independent of the installer as well as from OnInstSuccess.<br />
      <br />
      The question remains, why does the exe executed by the finish page run start if it compiled to run not hidden, but does not start when compiled to run hidden. As I had first posted, there are a number workarounds that will do what I want, but I just want to know why a hidden app will not start from the finish page run.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">jiake</span><br />
      <span class="post-time small text-muted">21st February 2011 12:54 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Run it in a Section, use IfSilent to determine wether to install.<br />
      Section -Hidden<br />
      IfSilent 0 +2<br />
      Exec '"$PATH\YouApp.exe" -args'<br />
      SectionEnd<br />
      Define a function to replace running default application.<br />
      !define MUI_FINISHPAGE_RUN<br />
      !define MUI_FINISHPAGE_RUN_TEXT "Run ApplicationName"<br />
      !define MUI_FINISHPAGE_RUN_FUNCTION FuncName<br />
      Function FuncName<br />
      IfSilent +2<br />
      Exec '"$PATH\YouApp.exe" -args'<br />
      FunctionEnd<br />
      Now you installer would run it on both mormal and silent mode.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">demiller9</span><br />
      <span class="post-time small text-muted">21st February 2011 15:08 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Your explanation is making it sound too mysterious. NSIS doesn't know if you compiled your program to appear or remain hidden, so why (how) would it do something different for the two versions of the program? The finish page Run functions work fine for the programs I run that don't have a UI. There must be something failing in the hidden version of your program.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Highcoder</span><br />
      <span class="post-time small text-muted">21st February 2011 15:18 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">oO<br />
      <br />
      if you run your installer silent you have no Finish-page. So you can´t execute something on finishpage in silent mode because it doesn´t appear.<br />
      <br />
      So as jiake wrote you have to modify your script. For GUI install you can leave the execution on the finishpage. But for silent mode you have to put it in a section or in .OnInstSuccess with "IfSilent".</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Collector9999</span><br />
      <span class="post-time small text-muted">21st February 2011 19:57 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">There is nothing hidden in the installer and it is not set to run silent. The only thing that is hidden is completely independent of NSIS. It is a file that gets installed by the installer that has been compiled completely separate from NSIS to run silent.<br />
      <br />
      As I said, if that file is compiled to run not hidden the NSIS/MUI2 run on finish works. When it compiled to run hidden the NSIS/MUI2 run on finish does not work <i>with no changes to the NSIS script</i>. The process never starts. Additionally, the file works as expected outside of the installer.</p>
    </div>
    <hr />

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]>
  </script>
</body>
</html>
