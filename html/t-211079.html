<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="description" content="GetFileSize, &amp; MUI_UnWelcomePage_Title_3Lines..."><title>GetFileSize, &amp; MUI_UnWelcomePage_Title_3Lines... - NSIS Forums</title><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script><link rel="preload" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css" as="style" onload="this.rel='stylesheet'"><link rel="preload" href="../css/style.css" as="style" onload="this.rel='stylesheet'"><noscript><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css"><link rel="stylesheet" href="../css/style.css"></noscript><script>!function(a){"use strict";var b=function(b,c,d){function e(a){return h.body?a():void setTimeout(function(){e(a)})}function f(){i.addEventListener&&i.removeEventListener("load",f),i.media=d||"all"}var g,h=a.document,i=h.createElement("link");if(c)g=c;else{var j=(h.body||h.getElementsByTagName("head")[0]).childNodes;g=j[j.length-1]}var k=h.styleSheets;i.rel="stylesheet",i.href=b,i.media="only x",e(function(){g.parentNode.insertBefore(i,c?g:g.nextSibling)});var l=function(a){for(var b=i.href,c=k.length;c--;)if(k[c].href===b)return a();setTimeout(function(){l(a)})};return i.addEventListener&&i.addEventListener("load",f),i.onloadcssdefined=l,l(f),i};"undefined"!=typeof exports?exports.loadCSS=b:a.loadCSS=b}("undefined"!=typeof global?global:this);!function(a){if(a.loadCSS){var b=loadCSS.relpreload={};if(b.support=function(){try{return a.document.createElement("link").relList.supports("preload")}catch(b){return!1}},b.poly=function(){for(var b=a.document.getElementsByTagName("link"),c=0;c<b.length;c++){var d=b[c];"preload"===d.rel&&"style"===d.getAttribute("as")&&(a.loadCSS(d.href,d,d.getAttribute("media")),d.rel=null)}},!b.support()){b.poly();var c=a.setInterval(b.poly,300);a.addEventListener&&a.addEventListener("load",function(){b.poly(),a.clearInterval(c)}),a.attachEvent&&a.attachEvent("onload",function(){a.clearInterval(c)})}}}(this);</script></head><body><div class="container"><ol class="breadcrumb"><li><a href="../index.html" class="glyphicon glyphicon-home"></a></li><li><a href="f-65.html">NSIS Discussion</a></li><li class="active">GetFileSize, &amp; MUI_UnWelcomePage_Title_3Lines...</li></ol><p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=211079">GetFileSize, &amp; MUI_UnWelcomePage_Title_3Lines...</a></p><br><div class="post"><p class="post-meta"><span class="post-author text-primary">Poulpos</span><br><span class="post-time small text-muted">22nd March 2005 06:00 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>GetFileSize, &amp; MUI_UnWelcomePage_Title_3Lines...</strong><br>Hi guys !<br><br>Well just a few questions I couldn't figure out properly (even with the Manual, but my undestanding of technical issues in a foreign language (ie: non-french) isn't always so good)<br><br>I'm working on a NSIS installer for Exact Audio Copy that would release the full program with documentation, and of course lots of external encoders...<br>But some of them (AAC encoders, mostly Nero-based like nEncode, NeroFrontEnd, etc) needs to use common files (dll &amp; exe)<br><br>So I try to figure out how to manage these common files installation / uninstallation (overwrite if newer files only, uninstall files only if no other codecs nees them)<br><br>The "GetDLLVersion" works fine on dll or exe files, but some of them just don't include version information...<br>So If VersionInfo is missing, let's try a Size comparison.<br><br>1. Get the size of a file : I was just surprised to see that there isn't such GetFileSize command in NSIS, which would be really nice easy &amp; fast for each case where MD5 comparison isn't needed.<br>But I found Henri Adriaens' very usefull script that seems to do well <a href="http://forums.winamp.com/showthread.php?postid=1490392#post1490392" target="_blank">Get a file's size</a><br><br>2. The MUI Uninstaller : it seems that there is no equivalent of "MUI_WELCOMEPAGE_TITLE_3LINES" for the uninstaller, which is a pity : my title is too long on welcome &amp; finish pages... Do I have to create my own UI with RessourceHacker (that's the name I guess) ?<br><br>3. How to stop being a f***g n00b ?<br>I mean, as far as I have absolutely no experience in programming (few VBA and PHP bases, and only HTML real knowledge), my code seems always too litteral (a huge list of Flow Control Instructions based on If, StrComp, Goto...)<br>I'm looking for the equivalent of PHP's If, ElseIf, ElseIf...<br><br>But I can't find any proper tutorial that would help me to access to a more "algorithmic" way of thinking my code, which could make it faster, and give more than that sucking 2-or-3 choices only per comparison (IfYes IfNot IfElse)<br>I mean, there are such tutorials, but they're frequently just out of my own analysis capacity (did I mentionned computing wasn't my cursus ?)<br><br>Well that's it. If you got a Tip for my UNWELCOMEFINISH_PAGE_TITLE_3LINES I'd be really happy (an ugly title ins't technically disturbing, but remains... an ugly title)<br><br>Poulpos<br><a href="mailto:poulpos@caramail.com">poulpos@caramail.com</a></p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Takhir</span><br><span class="post-time small text-muted">22nd March 2005 07:23 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">NSIS Archive link may help in most cases <a href="http://nsis.sourceforge.net/archive/browse.php" target="_blank">http://nsis.sourceforge.net/archive/browse.php</a><br>1. <a href="http://nsis.sourceforge.net/archive/nsisweb.php?page=672&amp;instances=0,11,211" target="_blank">http://nsis.sourceforge.net/archive/...ances=0,11,211</a> also can give file size without file open/close.<br>2. Forum search <a href="http://forums.winamp.com/showthread.php?s=&amp;threadid=195740&amp;highlight=3LINES" target="_blank">http://forums.winamp.com/showthread....ghlight=3LINES</a> (the same info is in Manual "Page Settings apply to a single page and should be set before inserting a page macro." but it was not easy to understand without sample for me too :(</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Poulpos</span><br><span class="post-time small text-muted">22nd March 2005 15:17 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>Thanx !</strong><br>Haaaaa, nice !<br><br>Thanks, it works great for the uninstaller welcome page. I still do not understand why there is no kind of<br>!define MUI_UNWELCOMEPAGE_TITLE_3LINES, but it doesn't matter : works great like that.<br><br>The script to get a file's version is working fine, but I already use the one from NSIS doc which is nice.<br>I was just wondering "Why isn't there any GetFileSize built-in function ?" cause it's usefull, and should be a part of NSIS. (Why being able to get the local time of a file, but not its size with a NSIS built-in commands ?)<br><br>Anyway, thanx a lot, it helped.<br><br>Poulpos<br><a href="mailto:poulpos@caramail.com">poulpos@caramail.com</a></p></div><hr><div class="footer"><p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p></div></div><script src="../js/highlight.pack.js" type="text/javascript"></script><script type="text/javascript">//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]></script></body></html>