<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="description" content="Advanced Uninstall Log NSIS header"><title>Advanced Uninstall Log NSIS header - NSIS Forums</title><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script><link rel="preload" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css" as="style" onload="this.rel='stylesheet'"><link rel="preload" href="../css/style.css" as="style" onload="this.rel='stylesheet'"><noscript><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css"><link rel="stylesheet" href="../css/style.css"></noscript><script>!function(a){"use strict";var b=function(b,c,d){function e(a){return h.body?a():void setTimeout(function(){e(a)})}function f(){i.addEventListener&&i.removeEventListener("load",f),i.media=d||"all"}var g,h=a.document,i=h.createElement("link");if(c)g=c;else{var j=(h.body||h.getElementsByTagName("head")[0]).childNodes;g=j[j.length-1]}var k=h.styleSheets;i.rel="stylesheet",i.href=b,i.media="only x",e(function(){g.parentNode.insertBefore(i,c?g:g.nextSibling)});var l=function(a){for(var b=i.href,c=k.length;c--;)if(k[c].href===b)return a();setTimeout(function(){l(a)})};return i.addEventListener&&i.addEventListener("load",f),i.onloadcssdefined=l,l(f),i};"undefined"!=typeof exports?exports.loadCSS=b:a.loadCSS=b}("undefined"!=typeof global?global:this);!function(a){if(a.loadCSS){var b=loadCSS.relpreload={};if(b.support=function(){try{return a.document.createElement("link").relList.supports("preload")}catch(b){return!1}},b.poly=function(){for(var b=a.document.getElementsByTagName("link"),c=0;c<b.length;c++){var d=b[c];"preload"===d.rel&&"style"===d.getAttribute("as")&&(a.loadCSS(d.href,d,d.getAttribute("media")),d.rel=null)}},!b.support()){b.poly();var c=a.setInterval(b.poly,300);a.addEventListener&&a.addEventListener("load",function(){b.poly(),a.clearInterval(c)}),a.attachEvent&&a.attachEvent("onload",function(){a.clearInterval(c)})}}}(this);</script></head><body><div class="container"><ol class="breadcrumb"><li><a href="../index.html" class="glyphicon glyphicon-home"></a></li><li><a href="f-65.html">NSIS Discussion</a></li><li class="active">Advanced Uninstall Log NSIS header</li></ol><p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=264971">Advanced Uninstall Log NSIS header</a></p><br><div class="post"><p class="post-meta"><span class="post-author text-primary">Red Wine</span><br><span class="post-time small text-muted">3rd February 2007 12:41 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>Advanced Uninstall Log NSIS header</strong><br>Advanced Uninstall Log is a macro system provided in a NSIS header that<br>is able to monitor an installation and build an uninstall log file which<br>is used by the uninstaller to uninstall files/directories that have been<br>added within specific installation blocks.<br><br>This means that files which have been installed outside these blocks,<br>or added later either by the user or application's activities, ignored<br>by the uninstaller.<br><br>Moreover files that might exist into the target directory prior the current<br>installation, ignored as well.<br><br>More informations and download links including 2 detailed examples of usage, at wiki:<br><br><a href="http://nsis.sf.net/Advanced_Uninstall_Log_NSIS_Header" target="_blank">http://nsis.sf.net/Advanced_Uninstall_Log_NSIS_Header</a></p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">zeeh3</span><br><span class="post-time small text-muted">3rd February 2007 22:28 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Cool, Red Wine. My suggestion is to enable multilanguage support for the messages.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Red Wine</span><br><span class="post-time small text-muted">4th February 2007 11:21 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"></p><blockquote><i>Originally posted by zeeh3</i><br><b>Cool, Red Wine. My suggestion is to enable multilanguage support for the messages.</b></blockquote>Thanks! I'm a bit dry of ideas on how to enable multilingual support and keep the high automation of the header at the same time, I'm tended to implement the same technique that I've implemented <a href="http://nsis.sourceforge.net/Readme_Page_Based_on_MUI_License_Page" target="_blank">here</a> , but I'd like to wait a little for a possible better suggestion.</div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Comm@nder21</span><br><span class="post-time small text-muted">4th February 2007 15:09 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">you definetly should wait for nsis 2.24, where a whole bunch of preprocessor enhancements will make life easier :)<br><br>btw: this lib looks nice!</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Red Wine</span><br><span class="post-time small text-muted">4th February 2007 18:06 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"></p><blockquote><i>Originally posted by Comm@nder21</i><br><b>you definetly should wait for nsis 2.24, where a whole bunch of preprocessor enhancements will make life easier :)<br><br>btw: this lib looks nice!</b></blockquote>It is true that I never claim that I know the inner works of the development team, yet I'm unable to figure how the 2.24 release would make my life easier according to enable multilingual support for 4 message boxes.</div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">TobbeSweden</span><br><span class="post-time small text-muted">29th November 2007 14:21 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Thanks for writing this header Red Wine!<br><br>I needed to be able to localize the messages boxes it shows, so I made some modifications.<br><br>If you don't need to make any localizations it will work just as it did before. But if you do need to change the strings it shows this is the way to do it with my version:<br><br></p><pre>
<code>!define UNINSTALLOG_LOCALIZE ;if you define this you have to provide language strings to use<br><br>LangString UNLOG_HEADER ${LANG_ENGLISH} "=========== Uninstaller Log please do not edit this file ==========="<br>LangString UNLOG_DAT_NOT_FOUND ${LANG_ENGLISH} "${UNINST_DAT} not found, unable to perform uninstall."<br>LangString UNLOG_DEL_FILE ${LANG_ENGLISH} 'Delete File "$R9"?'<br>LangString UNLOG_DEL_DIR ${LANG_ENGLISH} 'Delete Directory "$R9"?'<br>LangString UNLOG_EMPTY_DIR ${LANG_ENGLISH} "Previous installation detected at $0.$\nRequired file ${UNINSTALL_LOG}.dat is missing.$\n$\nIt is highly recommended to select an empty directory and perform a fresh installation."<br>LangString UNLOG_ERROR_LOG ${LANG_ENGLISH} "Error in log ${UNINSTALL_LOG}."<br>LangString UNLOG_ERROR_CREATE ${LANG_ENGLISH} "Error creating ${UNINSTALL_LOG}."</code>
</pre><br>
      <br>
      If UNINSTALLOG_LOCALIZE isn't defined the english language strings above will be used.<br>
      <br>
      This is the full header after my modifications:<br>
      http://pastebin.com/f8fa1474
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Red Wine</span><br>
      <span class="post-time small text-muted">30th November 2007 17:11 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Nice job TobbeSweden :)<br>
      <br>
      You may want to add your modified header in wiki as well.</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">TobbeSweden</span><br>
      <span class="post-time small text-muted">1st December 2007 01:18 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Done. http://nsis.sourceforge.net/Advanced_Uninstall_Log_NSIS_Header#Modifications<br>
      <br>
      Feel free to edit/move anything you like</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">HenrikG</span><br>
      <span class="post-time small text-muted">5th December 2007 15:46 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Hi!<br>
      <br>
      I ran into a problem with the example script ""Advanced Uninstall Log Demo". At uninstall there was a problem with removing empty directories. The code below prevented the uninstaller from hanging, but the real solution was to upgrade from Nsis 2.10 to Nsis 3.3 :) which solved the problem!<br>
      <br></p>
      <pre>
<code><br>!macro UNINSTALL.LOG_UNINSTALL_UNATTENDED<br>  Function un._LocateCallBack_Function_Unattended<br>    ....<br><br>isdir:<br>    RmDir "$R9"<br>    IfErrors +1 isdir2<br>    MessageBox MB_ICONEXCLAMATION|MB_OK "Could not remove directory $R9" /SD IDOK             <br>    goto end<br>isdir2:<br>    IntOp $unlog_tmp_1 $unlog_tmp_1 + 1<br>    goto end<br></code>
</pre><br>
      <br>
      I was going to ask for help, but this turned into an advice for people having similar problems with RmDir: Upgrade Nsis!<br>
      <br>
      Thanks for the script Red Wine! Though I would have liked some more comments in the source code... (AdvUninstLog.nsh)<br>
      <br>
      Best regards<br>
      /Henrik
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">high1</span><br>
      <span class="post-time small text-muted">30th December 2007 20:01 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>Unicode version</strong><br>
      Hey, Red Wine. First, I want to say thanks for your header - it should come with NSIS by default, if you ask me.<br>
      And now, the question... The header is working with experimental version of unicode NSIS, but it produces an ANSI file etc. - would it take much to create a version which is working properly with unicode? A lot of changes or ...?</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Red Wine</span><br>
      <span class="post-time small text-muted">31st December 2007 09:15 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>Re: Unicode version</strong><br></p>

      <blockquote>
        <i>Originally posted by high1</i><br>
        <b>Hey, Red Wine. First, I want to say thanks for your header - it should come with NSIS by default, if you ask me.<br>
        And now, the question... The header is working with experimental version of unicode NSIS, but it produces an ANSI file etc. - would it take much to create a version which is working properly with unicode? A lot of changes or ...?</b>
      </blockquote>Hey, high1, thanks for your comments!<br>
      Feel free to modify it the way it suits your preferences and don't forget to contribute at wiki please :)<br>
      <br>
      Happy new year!
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">high1</span><br>
      <span class="post-time small text-muted">15th February 2008 20:07 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">With some tinkering and a lot of help from Jim who is responsible for the NSIS Unicode patch, I got the header working. Modifying the header is trivial, and includes replacing FileRead and FileWrite calls with FileReadUTF16LE and FileWriteUTF16LE. You also need to write a BOM at the begging of the file to make it unicode. But the header uses FileJoin macro from TextFunc header, and it can not deal with unicode files, so I had to replace the call for FileJoin with a custom macro inside the header - FileJoinUTF. It is a modification of FileJoin and all the credits go to it's author. Here is the patched header :</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Tintera</span><br>
      <span class="post-time small text-muted">14th April 2008 15:55 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Thank you for the header. Looks good. Does anyone tryed it with the add / remove features section in installer?</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Government-Man</span><br>
      <span class="post-time small text-muted">31st August 2008 22:55 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Please tell me how to customize uninstall program's directory and name using this header?<br>
      <br>
      And is there someone who can explain me when these error messages appear? :)</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">sphynx07</span><br>
      <span class="post-time small text-muted">11th November 2008 10:02 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Just want to ask, what if i only want to pop-up the dialog that is only for directory excluding for the files pop-up dialog using this AdvUninstLog.nsh. thanks</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Red Wine</span><br>
      <span class="post-time small text-muted">12th November 2008 12:07 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"></p>

      <blockquote>
        <i>Originally posted by sphynx07</i><br>
        <b>Just want to ask, what if i only want to pop-up the dialog that is only for directory excluding for the files pop-up dialog using this AdvUninstLog.nsh. thanks</b>
      </blockquote>You'd need to edit header's code...
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">sphynx07</span><br>
      <span class="post-time small text-muted">13th November 2008 10:38 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Thanks Red Wine.<br>
      I tried it but for no luck i could not get it. sigh...<br>
      What i wanted to do with my uninstaller is that, the message box detection for newly created folder/directory will only pop up ignoring the files inside it and once the user wants to delete the folder the uninstaller will then also automatically delete the file/s inside it.<br>
      Can you please help me on this.<br>
      Please advice...<br>
      <br>
      Thanks!</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Red Wine</span><br>
      <span class="post-time small text-muted">13th November 2008 12:39 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">I understand what you're trying to achieve though as I suggested above you'd need to work with the existing code or write a new one.</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">xbarns</span><br>
      <span class="post-time small text-muted">4th February 2009 23:01 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Hi all,<br>
      <br>
      i have (as usual) a little problem.<br>
      <br>
      Even though all the necessary files are recorded in uninstall.dat they are not removed completely.<br>
      <br>
      I have a folder $InstDir\bin that is only partially emptied even though all files are recorded and should have been removed.<br>
      <br>
      Is there a way to log what gets deleted and what not (and maybe why?).<br>
      <br>
      The $InstDir\bin folder gets filled by different sections in between which other folders get created and filled. All other folders get removed nicely only bin stays (with quite a lot of files). Once i changed the Uninstall.dat to only contain the files that are in \bin and it worked nice, later i tried sorting so all \bin files are together in one section instead of being distributed over the uninstall.dat but that did not work either. I also tried to find out if those files are special in any way like special characters or so, but nope i couldn't find anything.<br>
      <br>
      Right at the beginning when i started implementing it it seemed to work nice, only a couple files were left but now....<br>
      <br>
      Strange but its late and i guess i can't think right either, any help is appreciated.<br>
      <br>
      Thanks for reading :)</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">TobbeSweden</span><br>
      <span class="post-time small text-muted">5th February 2009 06:50 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Are the files in use when you try to delete them? Since you're talking about a bin directory, maybe the program you're trying to delete is still running?</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">xbarns</span><br>
      <span class="post-time small text-muted">5th February 2009 09:22 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Well there might be one or two files still in use, but there are well over 100 left that do not get deleted.</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">cool-zer0</span><br>
      <span class="post-time small text-muted">6th April 2009 15:54 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Hello,<br>
      <br>
      I have a problem and I hope you can help me.<br>
      <br>
      My Problem is that the uninstall-process is to slow, can<br>
      I do something to speed it up.<br>
      <br>
      regards<br>
      cool-zer0</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Red Wine</span><br>
      <span class="post-time small text-muted">6th April 2009 23:54 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Most likely it is due to the mentioned disadvantage of the header (especially noticeable when dealing with too many files on old-slower machines) which needs some effort to eliminate it.<br>
      <br>
      <a href="http://nsis.sourceforge.net/Advanced_Uninstall_Log_NSIS_Header#Disadvantage" target="_blank">http://nsis.sourceforge.net/Advanced...r#Disadvantage</a></p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Red Wine</span><br>
      <span class="post-time small text-muted">8th April 2009 12:39 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Since latest version of <a href="http://forums.winamp.com/showthread.php?s=&amp;threadid=277381" target="_blank">Unicode NSIS</a> is able to parse an ansi script as unicode (doesn't need to convert the script prior to compile), I merged the above patch from high1 in one multi-functional header.<br>
      <br>
      This means there's only one header (which itself is ansi), who's able to utilize both NSIS flavors hence produce ansi or unicode uninstall.dat respectively.</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">jr_spurs</span><br>
      <span class="post-time small text-muted">23rd July 2009 10:08 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Hi Red Wine,<br>
      <br>
      Thanks for coding up this header. Its definitely a great addition to an already excellent product.<br>
      <br>
      However I am also having issues with the speed of the uninstall. I am uninstalling about 50mbs of an applicaiton which includes up to 2000 files.<br>
      <br>
      Do you think this header is just not suited to the characteristics of my application. Alternatively is there any code that I can change in the header file myself that might speed up the uninstall.<br>
      <br>
      BTW I am using the Unicode NSIS branch and I have used your latest script attached in this thread.<br>
      <br>
      Thanks for your help in advance.</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">HaMsTeYr</span><br>
      <span class="post-time small text-muted">10th August 2009 14:39 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">It IS really an excellent header, and same with jr_spurs, i as well am having problems with the speed of uninstalling...<br>
      <br>
      You're having difficulty with 50 mb? i have a 4gb++ installation to handle xD<br>
      <br>
      The uninstaller has been running for close to 2 hours now, and its still nowhere near done hahaha<br>
      <br>
      It would be nice if something could be done to speed this up...</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">trobertson</span><br>
      <span class="post-time small text-muted">11th August 2009 21:56 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">From my own experiments it seems only files added inside $INSTDIR get removed. During my install process I install files in many different places, but only the ones in $INSTDIR get removed during uninstall even though all "File ..." calls are wrapped in the required UNINSTALL.LOG... macros. Is this normal/correct?</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">HaMsTeYr</span><br>
      <span class="post-time small text-muted">11th August 2009 22:01 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">i'm not pro at NSIS, but did you check Uninstall.dat in INSTDIR post install to make sure that the directories were logged correctly?<br>
      <br>
      From what i can tell about the script, there shouldn't be limitations in install directories differing from INSTDIR</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Hawkeye64</span><br>
      <span class="post-time small text-muted">23rd August 2009 15:29 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>File capture</strong><br>
      I am trying to understand this script as I am relatively new to NSIS. There seems to be some "magic" happening here that I am trying to understand.<br>
      <br>
      Before capturing files, you insert the macro "UNINSTALL.LOG_OPEN_INSTALL". Then call your "File [options] [folder]". The macro contains "${uninstall.log_install} "${EXCLU_LIST}" "${UNINST_DAT}" "$OUTDIR"".<br>
      <br>
      Exactly what I am trying to figure out is how all this work? How does the code in the macro get the information it needs?<br>
      <br>
      Is it that NSIS creates the "exclude.tmp" file in the $PLUGINSDIR, when using the "File" command, and this script then leverages it?</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">isawen</span><br>
      <span class="post-time small text-muted">15th January 2010 13:39 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>Uninstaller details</strong><br>
      Hi guys,<br>
      <br>
      I am encountering the following issue. The Uninstaller details list is empty when executing the uninstaller. I have set <font color="red">ShowUninstDetails show</font> but the list only displays the shortcut and installation folder deletion.<br>
      <br>
      Is there any reason for this behavior?<br>
      I'm missing something maybe?<br>
      <br>
      Best regards,<br>
      Isawen</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">isawen</span><br>
      <span class="post-time small text-muted">1st February 2010 12:45 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>Re: Uninstaller details</strong><br></p>

      <blockquote>
        <i>Originally posted by isawen</i><br>
        <b>Hi guys,<br>
        <br>
        I am encountering the following issue. The Uninstaller details list is empty when executing the uninstaller. I have set <font color="red">ShowUninstDetails show</font> but the list only displays the shortcut and installation folder deletion.<br>
        <br>
        Is there any reason for this behavior?<br>
        I'm missing something maybe?<br>
        <br>
        Best regards,<br>
        Isawen</b>
      </blockquote>I've figured out the solution and you could see it at the following address: http://forums.winamp.com/showthread.php?postid=2625204#post2625204<br>
      <br>
      Hope this will be usefull for somebody.
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">dorakey</span><br>
      <span class="post-time small text-muted">10th August 2010 14:05 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"></p>

      <blockquote>
        <small>Originally posted by HaMsTeYr</small><br>
        It IS really an excellent header, and same with jr_spurs, i as well am having problems with the speed of uninstalling...<br>
        <br>
        You're having difficulty with 50 mb? i have a 4gb++ installation to handle xD<br>
        <br>
        The uninstaller has been running for close to 2 hours now, and its still nowhere near done hahaha<br>
        <br>
        It would be nice if something could be done to speed this up...
      </blockquote>Yes .. the uninstall log is great but extremely slow when uninstalling large numbers of files. Have any way to speed it up? :)
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">HaMsTeYr</span><br>
      <span class="post-time small text-muted">10th August 2010 21:34 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"></p>

      <blockquote>
        <small>Originally posted by dorakey</small><br>
        Yes .. the uninstall log is great but extremely slow when uninstalling large numbers of files. Have any way to speed it up? :)
      </blockquote>On that note, and since this is an old thread, yes, yes i do have a way to speed it up. I actually went in and rewrote the code into something a lot simpler, and so far i've not encountered any major problems with it.<br>
      <br>
      Its just a makeshift rewriting though, but if you're interested in it i can upload it.
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">dorakey</span><br>
      <span class="post-time small text-muted">11th August 2010 04:23 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"></p>

      <blockquote>
        <small>Originally posted by HaMsTeYr</small><br>
        On that note, and since this is an old thread, yes, yes i do have a way to speed it up. I actually went in and rewrote the code into something a lot simpler, and so far i've not encountered any major problems with it.<br>
        <br>
        Its just a makeshift rewriting though, but if you're interested in it i can upload it.
      </blockquote>Yes, please do upload it, thanks ! :up:
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">HaMsTeYr</span><br>
      <span class="post-time small text-muted">11th August 2010 04:46 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Here it is, to use it:<br>
      Add<br>
      !include AdvUninstLog2.nsh<br>
      <br>
      and since its a very makeshift modification, you can only use these macros<br>
      <br>
      !insertmacro UNATTENDED_UNINSTALL<br>
      <br>
      Section ""<br>
      !insertmacro UNINSTALL.LOG_OPEN_INSTALL<br>
      File "SomeFile"<br>
      !insertmacro UNINSTALL.LOG_CLOSE_INSTALL<br>
      SectionEnd<br>
      <br>
      Function .onInit<br>
      !insertmacro UNINSTALL.LOG_PREPARE_INSTALL<br>
      FunctionEnd<br>
      <br>
      Function .onInstSuccess<br>
      !insertmacro UNINSTALL.LOG_UPDATE_INSTALL<br>
      FunctionEnd<br>
      <br>
      Section "Uninstall"<br>
      !insertmacro UNINSTALL.NEW_UNINSTALL "$OUTDIR"<br>
      SectionEnd<br>
      <br>
      For the uninstall section, i don't think the OUTDIR should matter much as i've coded it such that it looks for the whole directory from the root drive.<br>
      <br>
      Anyway, those are the ones i'm using at the moment and they work well for me. Give them a shot :)</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">dorakey</span><br>
      <span class="post-time small text-muted">11th August 2010 07:44 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"></p>

      <blockquote>
        <small>Originally posted by HaMsTeYr</small><br>
        Here it is, to use it:<br>
        Add<br>
        !include AdvUninstLog2.nsh<br>
        <br>
        and since its a very makeshift modification, you can only use these macros<br>
        <br>
        !insertmacro UNATTENDED_UNINSTALL<br>
        <br>
        Section ""<br>
        !insertmacro UNINSTALL.LOG_OPEN_INSTALL<br>
        File "SomeFile"<br>
        !insertmacro UNINSTALL.LOG_CLOSE_INSTALL<br>
        SectionEnd<br>
        <br>
        Function .onInit<br>
        !insertmacro UNINSTALL.LOG_PREPARE_INSTALL<br>
        FunctionEnd<br>
        <br>
        Function .onInstSuccess<br>
        !insertmacro UNINSTALL.LOG_UPDATE_INSTALL<br>
        FunctionEnd<br>
        <br>
        Section "Uninstall"<br>
        !insertmacro UNINSTALL.NEW_UNINSTALL "$OUTDIR"<br>
        SectionEnd<br>
        <br>
        For the uninstall section, i don't think the OUTDIR should matter much as i've coded it such that it looks for the whole directory from the root drive.<br>
        <br>
        Anyway, those are the ones i'm using at the moment and they work well for me. Give them a shot :)
      </blockquote>I have tried it and the uninstall speed is normal now, thanks a lot! :)<br>
      <br>
      :up::up::up:
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">HaMsTeYr</span><br>
      <span class="post-time small text-muted">11th August 2010 07:57 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">No problem at all. It was bugging me as well, a damn good plugin limited by its uninstall speed. At any rate i'm glad it helped.</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">moatra</span><br>
      <span class="post-time small text-muted">24th January 2012 23:41 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Hamster, your changes were amazing for speed. I had a couple of problems with the original PRODUCT_UNINST_ROOT and PRODUCT_UNINST_KEY being replaced with INST_DIR_REG_ROOT and INSTDIR_REG_KEY, so I reverted that. I also updated the script so that it pays attention to the name defined inside the UNINSTALL_LOG var. I also noticed that it had problems removing folder outside of the base install directory (Such as those added to My Documents $DOCUMENTS), so I improved the uninstall loop to track any directories encountered. Since the default $INSTDIR sometimes is not recorded in the log, you may need to do a manual</p>
      <pre>
<code>push $INSTDIR<br>Call un.RemoveEmptyDirs</code>
</pre>in your uninstall section
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Denteroth</span><br>
      <span class="post-time small text-muted">4th March 2012 03:40 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"></p>

      <blockquote>
        <small>Originally posted by HaMsTeYr</small><br>
        Here it is, to use it:<br>
        Add<br>
        !include AdvUninstLog2.nsh<br>
        <br>
        and since its a very makeshift modification, you can only use these macros<br>
        <br>
        !insertmacro UNATTENDED_UNINSTALL<br>
        <br>
        Section ""<br>
        !insertmacro UNINSTALL.LOG_OPEN_INSTALL<br>
        File "SomeFile"<br>
        !insertmacro UNINSTALL.LOG_CLOSE_INSTALL<br>
        SectionEnd<br>
        <br>
        Function .onInit<br>
        !insertmacro UNINSTALL.LOG_PREPARE_INSTALL<br>
        FunctionEnd<br>
        <br>
        Function .onInstSuccess<br>
        !insertmacro UNINSTALL.LOG_UPDATE_INSTALL<br>
        FunctionEnd<br>
        <br>
        Section "Uninstall"<br>
        !insertmacro UNINSTALL.NEW_UNINSTALL "$OUTDIR"<br>
        SectionEnd<br>
        <br>
        For the uninstall section, i don't think the OUTDIR should matter much as i've coded it such that it looks for the whole directory from the root drive.<br>
        <br>
        Anyway, those are the ones i'm using at the moment and they work well for me. Give them a shot :)
      </blockquote>I've noticed that most elements of the interactivity have been removed from your script... as well as any verification for the files having been changed.<br>
      <br>
      Any plans to implement more in regards to those aspects? (Final install directory will not be removed if unlisted files are present. :( )
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">HaMsTeYr</span><br>
      <span class="post-time small text-muted">4th March 2012 03:48 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">I removed a lot of elements, to keep it simple and fast. I hated the fact that it would take forever just for the installer to search for existing files back and forth, so I chopped it down to a few simple commands.<br>
      <br>
      TBH though, I made those changed for my purposes, but they're not too difficult to modify. You could try making these modifications yourself, and see how you go, or if you detail it just a little bit more, maybe I'll help :P maybe. xD</p>
    </div>
    <hr>

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]></script></body></html>