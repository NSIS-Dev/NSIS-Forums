<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="description" content="BgImage.dll and Windows 98"><title>BgImage.dll and Windows 98 - NSIS Forums</title><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script><link rel="preload" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css" as="style" onload="this.rel='stylesheet'"><link rel="preload" href="../css/style.css" as="style" onload="this.rel='stylesheet'"><noscript><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css"><link rel="stylesheet" href="../css/style.css"></noscript><script>!function(a){"use strict";var b=function(b,c,d){function e(a){return h.body?a():void setTimeout(function(){e(a)})}function f(){i.addEventListener&&i.removeEventListener("load",f),i.media=d||"all"}var g,h=a.document,i=h.createElement("link");if(c)g=c;else{var j=(h.body||h.getElementsByTagName("head")[0]).childNodes;g=j[j.length-1]}var k=h.styleSheets;i.rel="stylesheet",i.href=b,i.media="only x",e(function(){g.parentNode.insertBefore(i,c?g:g.nextSibling)});var l=function(a){for(var b=i.href,c=k.length;c--;)if(k[c].href===b)return a();setTimeout(function(){l(a)})};return i.addEventListener&&i.addEventListener("load",f),i.onloadcssdefined=l,l(f),i};"undefined"!=typeof exports?exports.loadCSS=b:a.loadCSS=b}("undefined"!=typeof global?global:this);!function(a){if(a.loadCSS){var b=loadCSS.relpreload={};if(b.support=function(){try{return a.document.createElement("link").relList.supports("preload")}catch(b){return!1}},b.poly=function(){for(var b=a.document.getElementsByTagName("link"),c=0;c<b.length;c++){var d=b[c];"preload"===d.rel&&"style"===d.getAttribute("as")&&(a.loadCSS(d.href,d,d.getAttribute("media")),d.rel=null)}},!b.support()){b.poly();var c=a.setInterval(b.poly,300);a.addEventListener&&a.addEventListener("load",function(){b.poly(),a.clearInterval(c)}),a.attachEvent&&a.attachEvent("onload",function(){a.clearInterval(c)})}}}(this);</script></head><body><div class="container"><ol class="breadcrumb"><li><a href="../index.html" class="glyphicon glyphicon-home"></a></li><li><a href="f-65.html">NSIS Discussion</a></li><li class="active">BgImage.dll and Windows 98</li></ol><p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=136630">BgImage.dll and Windows 98</a></p><br><div class="post"><p class="post-meta"><span class="post-author text-primary">DOCa Cola</span><br><span class="post-time small text-muted">25th May 2003 23:07 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>BgImage.dll and Windows 98</strong><br>Hm, i hope this time it's a real bug and not me :D<br>I wonder if the BgImage.dll example was tested under windows 98. on windows xp it runs fine. when i start the example under windows 98 it showes up correctly up to the mike the lama message. after i clicked ok on that one the installer crashes with an windows 98 crash box...does this error only occurs on my pc? notice, it's a fresh install of windows 98 (i run it in a vmware box actually, but i don't think thats the problem)<br><br>DOCa Cola</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">kichik</span><br><span class="post-time small text-muted">25th May 2003 23:13 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Yep, it was tested on both Windows 98 and Windows XP. I had a lot of issues with Windows 98... Make sure it's not VMWare that's causing this.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">DOCa Cola</span><br><span class="post-time small text-muted">25th May 2003 23:22 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">ok, thx. i can't test it anyway cause i have no real pc with win98 installed, but would be good to know that my installer runs everywhere without problems. :)<br><br>DOCa Cola</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">kichik</span><br><span class="post-time small text-muted">25th May 2003 23:24 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">I'll test it tomorrow on another Windows 98 machine just to make sure, but even if it works it would be nice to know what happens with VMWare. So... What's the exact error and after/before which command does it appear?</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">DOCa Cola</span><br><span class="post-time small text-muted">25th May 2003 23:26 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">i will test that now with a messagebox before every command and tell you what happens...</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">DOCa Cola</span><br><span class="post-time small text-muted">25th May 2003 23:35 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">thats line 81 in the example<br></p><pre>
<code>        # clear everything<br>        BgImage::Clear /NOUNLOAD<br>        # Clear doesn't return any value<br>        # set another gradient</code>
</pre><br>
      at this point the installer fails<br>
      <br>
      <br>
      With this command the typical windows error screen appears (the one with the close and details button and the red X)<br>
      With the detail error message (sorry, i have a german windows 98)<br>
      BGIMAGE TEST verursachte einen Fehler durch eine ung√ºltige Seite<br>
      in Modul BGIMAGE.DLL bei 0167:10001573.<br>
      ...<br>
      and so on (means something like bgimage test caused an error through a invalid page in module bgimage.dll at ...)<br>
      the installer window with background stays in back until i press the close button on the error box and no graphical errors appear when i move the error box arround.<br>
      <br>
      DOCa Cola<br>
      <br>
      EDIT: erm, there are graphical errors, the error box leaves 'ghosts' on the background
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br>
      <span class="post-time small text-muted">26th May 2003 16:04 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Can you please try the attached BgImage.dll? I have added some more thread safety features.</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">DOCa Cola</span><br>
      <span class="post-time small text-muted">26th May 2003 17:03 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">the example runs fine until finish, then it crashes (on unload) i am trying to find the command causing this<br>
      <br>
      Edit: after crash the background stays and the desktop is not redrawn, i have first to clean it by opening a window</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">DOCa Cola</span><br>
      <span class="post-time small text-muted">26th May 2003 17:09 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">hm, its that BgImage::Destroy function in .onguiend. i have uncommented it and the installer closes fine but of course the dll stays in the plugins dir then.<br>
      <br>
      DOCa Cola</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br>
      <span class="post-time small text-muted">26th May 2003 17:31 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">What's the offset (0167:10001573 in the last error message) shown in the error message for the attached BgImage.dll?</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">DOCa Cola</span><br>
      <span class="post-time small text-muted">26th May 2003 17:33 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">its 0167:100014ef<br>
      <br>
      DOCa Cola</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br>
      <span class="post-time small text-muted">26th May 2003 17:37 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Hmm... Clear again... I'll check.</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br>
      <span class="post-time small text-muted">26th May 2003 17:53 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Plesae test this one.</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">DOCa Cola</span><br>
      <span class="post-time small text-muted">26th May 2003 17:57 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">this one runs fine now. but i noticed that there was a slight delay on playing the test sound under windows xp (don't know about vmware win98 cause have no soundcard installed there)</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br>
      <span class="post-time small text-muted">26th May 2003 17:58 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">It happens here too and has happened in earlier versions too, probably a Windows XP issue. Last time I tested it, it happened only with the files the example uses, maybe they're special for Windows XP, who knows :)</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">DOCa Cola</span><br>
      <span class="post-time small text-muted">26th May 2003 18:01 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">ah, i see, thx for the improved stability :)</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br>
      <span class="post-time small text-muted">26th May 2003 18:02 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">New version uploaded to CVS.</p>
    </div>
    <hr>

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]></script></body></html>