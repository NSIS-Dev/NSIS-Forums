<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="After install, starting app launches windows installer" />

  <title>After install, starting app launches windows installer - NSIS Forums</title><!-- Bootstrap core CSS -->
  <link rel="stylesheet" type="text/css" href="//netdna.bootstrapcdn.com/bootswatch/3.0.1/readable/bootstrap.min.css" />
  <link rel="stylesheet" href="../css/style.css" type="text/css" /><!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!--[if lt IE 9]>
                <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
                <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->
</head>

<body>
  <div class="container">
    <!-- Put navigation bar here -->

    <ol class="breadcrumb">
      <li><a href="../index.html" class="glyphicon glyphicon-home"></a></li>

      <li><a href="f-65.html">NSIS Discussion</a></li>

      <li class="active">After install, starting app launches windows installer</li>
    </ol>

    <p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=308333">After install, starting app launches windows installer</a></p><br />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">chrisairpac</span><br />
      <span class="post-time small text-muted">14th July 2009 15:02 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>After install, starting app launches windows installer</strong><br />
      I have a problem that occurs after a customer installs on some variants of Windows. When they launch the installed app, it starts a windows installer instead of the app. Usually, they can cancel and the app runs fine.<br />
      <br />
      What I think is going on is I haven't registered all DLL's/OCX's and some Win variants try to resume the install.<br />
      <br />
      Any input/suggestions would be greatly appreciated.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
      <span class="post-time small text-muted">14th July 2009 15:37 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Try deleting from the MSI database using <a href="http://support.microsoft.com/kb/290301" target="_blank">Windows Installer Cleanup</a> and then see if the app runs. If it fails to run it might tell you what needs fixing.<br />
      <br />
      Stu</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">chrisairpac</span><br />
      <span class="post-time small text-muted">14th July 2009 16:01 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Stu,<br />
      <br />
      I am unable to recreate the problem on my PC's (XP SP2, Vista 32bit Home Basic, Vista 64bit Home Premium) and asking my customers to run cleanup utility may be problematic.<br />
      <br />
      My current solution is to use a different installer which fixes the problem.<br />
      <br />
      Thanks for the tip. I'll run the cleanup utility on my systems to see if any clues emerge.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">XiMaker</span><br />
      <span class="post-time small text-muted">15th July 2009 06:40 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">I've had this problem too - the cause is that you have some installed files that are set as required - if the file gets deleted by the user or virus scanner then Windows Installer will try to repair the required file by running the install again to allow the user to fix the missing file. by using Windows install cleanup you can remove the Windows Installer Information about the install but leave the installed program intact. this way the system will not try to repair itself - the only problem is that you also lose the uninstall ability.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">chrisairpac</span><br />
      <span class="post-time small text-muted">15th July 2009 20:02 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">I'm sure the files aren't being deleted by the user since they run the install then immediately try to run the program. I send these customers a new install using Advanced Installer and everything works fine. I do think the problem is related to missing or unregistered files. I use the following to register DLL's:<br />
      <br />
      !insertmacro InstallLib REGDLL NOTSHARED REBOOT_NOTPROTECTED "any.dll" "$SYSDIR\any.dll" $SYSDIR</p>
    </div>
    <hr />

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]>
  </script>
</body>
</html>
