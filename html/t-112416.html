<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="description" content="Trial Installations"><title>Trial Installations - NSIS Forums</title><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script><link rel="preload" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css" as="style" onload="this.rel='stylesheet'"><link rel="preload" href="../css/style.css" as="style" onload="this.rel='stylesheet'"><noscript><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css"><link rel="stylesheet" href="../css/style.css"></noscript><script>!function(a){"use strict";var b=function(b,c,d){function e(a){return h.body?a():void setTimeout(function(){e(a)})}function f(){i.addEventListener&&i.removeEventListener("load",f),i.media=d||"all"}var g,h=a.document,i=h.createElement("link");if(c)g=c;else{var j=(h.body||h.getElementsByTagName("head")[0]).childNodes;g=j[j.length-1]}var k=h.styleSheets;i.rel="stylesheet",i.href=b,i.media="only x",e(function(){g.parentNode.insertBefore(i,c?g:g.nextSibling)});var l=function(a){for(var b=i.href,c=k.length;c--;)if(k[c].href===b)return a();setTimeout(function(){l(a)})};return i.addEventListener&&i.addEventListener("load",f),i.onloadcssdefined=l,l(f),i};"undefined"!=typeof exports?exports.loadCSS=b:a.loadCSS=b}("undefined"!=typeof global?global:this);!function(a){if(a.loadCSS){var b=loadCSS.relpreload={};if(b.support=function(){try{return a.document.createElement("link").relList.supports("preload")}catch(b){return!1}},b.poly=function(){for(var b=a.document.getElementsByTagName("link"),c=0;c<b.length;c++){var d=b[c];"preload"===d.rel&&"style"===d.getAttribute("as")&&(a.loadCSS(d.href,d,d.getAttribute("media")),d.rel=null)}},!b.support()){b.poly();var c=a.setInterval(b.poly,300);a.addEventListener&&a.addEventListener("load",function(){b.poly(),a.clearInterval(c)}),a.attachEvent&&a.attachEvent("onload",function(){a.clearInterval(c)})}}}(this);</script></head><body><div class="container"><ol class="breadcrumb"><li><a href="../index.html" class="glyphicon glyphicon-home"></a></li><li><a href="f-65.html">NSIS Discussion</a></li><li class="active">Trial Installations</li></ol><p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=112416">Trial Installations</a></p><br><div class="post"><p class="post-meta"><span class="post-author text-primary">Jacob Metro</span><br><span class="post-time small text-muted">1st November 2002 22:59 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>Trial Installations</strong><br><font size="3">How do I allow a user to install one portion of a program, let him/her play with the program, and then allow him/her to choose if he/she wants to install another component now or not?</font><br><br>Okay,<br>I love Nullsoft. Ya'll are awesome.<br><br>Using KiCHiK's example "one-section" I have set up a installer which brings up 10 choices. The user selects one (and only one) of these choices. The installer installs the choice and runs the app (myapp) using ExecWait. The user looks around at the app and uses the choice they made. The user exits myapp upon which the installer asks MB_YESNO "you want to install another now?" On YES, the installer opens another instance of itself and closes the old instance. On NO, the installer QUITs.<br><br>This works fine for the first or second time, at the third time on NO and CLOSE though AutoWindowClose is TRUE, the installer (which has reached 100% complete and says "COMPLETE") opens myapp which is outside the logical order at this point.<br><br>On closing, my logic uses MB_YESNO again, I choose NO and number three installer closes.<br><br>Repeating the same, open myapp out of order and NO to MB_YESNO after exit myapp the remaining two installers close perfectly.<br><br>Here's the brief (this is not raw code, this is interpreted code)version of KiCHiK's script modified.<br><br><br>ComponentText "choose"<br>Sections 0-10 (including required components)<br>.onInit remembers which one is selected<br>.onSelChange turns off the old selection and turns on the new one<br><br>Function CALLEDBYSECTIONS 1-10<br>ExecWait myapp<br>onexit MB_YESNO "another?" IDYES goto ShowIT<br>If NO goto STOPIT<br><br>ShowIT:<br>ExecWait Installer.exe<br>goto STOPIT<br><br>STOPIT:<br>QUIT<br><br>FunctionEnd<br><br><br>This works once or twice, but definately not on the third one. So, I put MessageBox's at each logical crux so this I couldn't get lost in this simple program.<br>The first time, all MB_OK's show up fine. The second and third times, "NO" MB_OK's show up.<br><br><br>What do you guys think? Am I crazy? Is this a bug or am I thinking incorrectly about this?<br><br>Let me KNOW, share with me your knowledge and experience<br>jacob<br><br>a working copy of trial is attached, i stripped everything but the essentials (still does the same thing, by the way)</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Jacob Metro</span><br><span class="post-time small text-muted">1st November 2002 23:58 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>Moderator - Please Kill this thread</strong><br>Moderator,<br>Please cancel this thread unless you think this forum will be able to answer my question pretty well. I didn't realize that the developers at sourceforge.net/tracker would answer my query as fast as they have.<br>Thanks,<br>jacob</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Aus</span><br><span class="post-time small text-muted">2nd November 2002 00:35 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">threads automatically expire after 30 days if no one posts to them. there's no need to thwack it really... someone might want to answer it also in the meantime.<br><br>--aus</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Jacob Metro</span><br><span class="post-time small text-muted">2nd November 2002 00:46 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>Thanks</strong><br>Thanks,<br>jmetro</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">kichik</span><br><span class="post-time small text-muted">4th November 2002 16:02 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">That's what happens when you post at two places...<br><br>You can either use the solution I gave you at SourceForge (auto close the window) or you can use the new paging system. What you could do is ask the user weather he wants to install another part of your software, and if he does start backing up in the dialogs using the pre-functions and Abort. When you get to the starting page you stop with the Aborts, and vialloa, you have a new installation.<br><br>This was actually possible with the old paging system too, just Abort -3 or something.... ;)</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Jacob Metro</span><br><span class="post-time small text-muted">4th November 2002 16:34 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>AUTOWINDOWCLOSE</strong><br>I like your solution on SourceForge. It seems to work perfectly now.<br>thanks so much for your patience.<br>jacob</p></div><hr><div class="footer"><p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p></div></div><script type="text/javascript" src="../js/highlight.pack.js" async></script><script type="text/javascript">//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]></script></body></html>