<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="ExecWait in separate thread" />

  <title>ExecWait in separate thread - NSIS Forums</title><!-- Bootstrap core CSS -->
  <link rel="stylesheet" type="text/css" href="//netdna.bootstrapcdn.com/bootswatch/3.0.1/readable/bootstrap.min.css" />
  <link rel="stylesheet" href="../css/style.css" type="text/css" /><!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!--[if lt IE 9]>
                <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
                <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->
</head>

<body>
  <div class="container">
    <!-- Put navigation bar here -->

    <ol class="breadcrumb">
      <li><a href="../index.html" class="glyphicon glyphicon-home"></a></li>

      <li><a href="f-65.html">NSIS Discussion</a></li>

      <li class="active">ExecWait in separate thread</li>
    </ol>

    <p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=344968">ExecWait in separate thread</a></p><br />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">samiz</span><br />
      <span class="post-time small text-muted">18th May 2012 07:58 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>ExecWait in separate thread</strong><br />
      Hi,<br />
      <br />
      My installer does heavy processing/DB interaction by calling a separate exe. I am using ExecWait to call that exe but the issue is that NSIS installer GUI shows 'Not Responding' in its title bar after some time (specially if you click once or twice on NSIS UI). Can I call ExecWait so that it does not block NSIS GUI thread?<br />
      <br />
      Thanks,</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
      <span class="post-time small text-muted">18th May 2012 11:53 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">First you should specify why you are performing a lengthy process execution in page callbacks? Are you modifying the database? If so then you should be doing this in a Section. The user's machine should never be modified until they have clicked Install.<br />
      <br />
      If you must run it before the user clicks Install then you are out of luck. NSIS does not support threading as its instructions are not atomic - they will not work correctly in multiple threads (trust me I have tried).<br />
      <br />
      Are you displaying a Banner while it does its work? The installer may become unresponsive but a Banner will still display a message.<br />
      <br />
      Stu</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Anders</span><br />
      <span class="post-time small text-muted">18th May 2012 16:52 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">You could try <a href="http://nsis.sourceforge.net/BgWorker_plug-in" target="_blank">http://nsis.sourceforge.net/BgWorker_plug-in</a> but as Afrow said, not everything in NSIS is thread safe...</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">samiz</span><br />
      <span class="post-time small text-muted">29th May 2012 05:50 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Thanks for ur replies. Can I call macros in BGWorker (instead of functions).</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Anders</span><br />
      <span class="post-time small text-muted">29th May 2012 09:38 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Yes and no, macros work at compile time, not run time...</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">samiz</span><br />
      <span class="post-time small text-muted">29th May 2012 09:42 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">I want to pass parameters to that function. Previously I had done it using macros. Any idea how to do this in BGWorker case?<br />
      <br />
      Thanks,</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Anders</span><br />
      <span class="post-time small text-muted">29th May 2012 11:47 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">The stack and/or registers will probably work...</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">LoRd_MuldeR</span><br />
      <span class="post-time small text-muted">29th May 2012 23:51 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"></p>

      <blockquote>
        <small>Originally posted by samiz</small><br />
        Can I call ExecWait so that it does not block NSIS GUI thread?
      </blockquote>If you want a <i>non-blocking</i> version of ExecWait(), why not simply use Exec()?<br />
      <br />
      Am I right that you want to create the process asynchronously and then wait for its termination at a later point?<br />
      <br />
      In that case ExecShellWait() from my StdUtils plug-in may be possible way to go:<br />
      <a href="http://nsis.sourceforge.net/StdUtils_plug-in#ExecShellWait" target="_blank">http://nsis.sourceforge.net/StdUtils...#ExecShellWait</a><br />
      <br />
      (It splits creating the process and waiting for its termination into two separate commands)
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
      <span class="post-time small text-muted">30th May 2012 13:29 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">He wants to use ExecWait but without blocking the window message loop.<br />
      <br />
      Stu</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">samiz</span><br />
      <span class="post-time small text-muted">10th April 2013 12:49 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>BgWorker not working</strong><br />
      Hi,<br />
      <br />
      I had successfully incorporated bgworker::callandwait in my code but on one machine (win 7 32 bit) the method I pass isnt being called.<br />
      <br />
      This is happening on a specific machine only.<br />
      <br />
      Any idea why?</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Anders</span><br />
      <span class="post-time small text-muted">11th April 2013 01:45 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Maybe you could give us some more information? Example code?</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">samiz</span><br />
      <span class="post-time small text-muted">11th April 2013 08:24 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Function ConfigurationStart<br />
      GetFunctionAddress $0 Extract<br />
      messagebox mb_ok "$0"<br />
      BgWorker::CallAndWait<br />
      messagebox mb_ok "done"<br />
      FunctionEnd<br />
      <br />
      <br />
      Function Extract<br />
      messagebox mb_ok "Extracting..."<br />
      FunctionEnd<br />
      <br />
      <br />
      This is sample code which I am using. "Extracting..." never gets displayed.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">samiz</span><br />
      <span class="post-time small text-muted">17th April 2013 07:54 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">any soln?</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">T.Slappy</span><br />
      <span class="post-time small text-muted">19th April 2013 08:59 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">There is no problem in the code you posted, it worked for me.<br />
      This code is not working only on some specific machine?</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">samiz</span><br />
      <span class="post-time small text-muted">22nd April 2013 11:53 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Yes its happening on a particular machine. Otherwise works fine.</p>
    </div>
    <hr />

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]>
  </script>
</body>
</html>
