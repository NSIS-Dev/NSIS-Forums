<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="description" content="Suggestions for makensis.nsi"><title>Suggestions for makensis.nsi - NSIS Forums</title><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script><link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css"><link rel="stylesheet" href="../css/style.css" type="text/css"><!--[if lt IE 9]><script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script><script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script><![endif]--></head><body><div class="container"><ol class="breadcrumb"><li><a href="../index.html" class="glyphicon glyphicon-home"></a></li><li><a href="f-65.html">NSIS Discussion</a></li><li class="active">Suggestions for makensis.nsi</li></ol><p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=138262">Suggestions for makensis.nsi</a></p><br><div class="post"><p class="post-meta"><span class="post-author text-primary">deguix</span><br><span class="post-time small text-muted">8th June 2003 11:32 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>Suggestions for makensis.nsi</strong><br><b>1)</b><br><br>!define VER_MAJOR 2<br>!define VER_MINOR 0b4<br><br>...<br><br>!define VERSION "2.0b4 (CVS)"<br><br>Is not better to put this below, because when you change the version, only need to change in the VER_MAJOR and VER_MINOR defines:<br><br>!define VERSION "${VER_MAJOR}.${VER_MINOR} (CVS)"<br><br><b>2)</b> Adding the effect, to show a custom text next to the progress bar when installing some type of files, or creating shortcuts... Example:<br><br>Section "NSIS Development System (required)" SecCore<br><b><font color="red">SetDetailsPrint textonly<br>DetailPrint "Installing files..."</font></b> ; (or "Installing NSIS Development System (required) files"<br><b><font color="red">SetDetailsPrint listonly</font></b><br><br>SectionIn 1 2 3 RO<br>SetOutPath $INSTDIR<br>RMDir /r $SMPROGRAMS\NSIS<br><br>...<br><br>!ifndef NO_STARTMENUSHORTCUTS<br>IfFileExists $SMPROGRAMS\NSIS "" nofunshit<br><br><b><font color="red">SetDetailsPrint textonly<br>DetailPrint "Creating shortcuts..."<br>SetDetailsPrint listonly</font></b><br><br>IfFileExists $INSTDIR\Examples 0 +2<br>CreateShortCut "$SMPROGRAMS\NSIS\NSIS Examples Directory.lnk" "$INSTDIR\Examples"</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">kichik</span><br><span class="post-time small text-muted">9th June 2003 00:27 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">If you have the code ready can you please submit <a href="http://sourceforge.net/tracker/?atid=373087&amp;group_id=22049&amp;func=browse" target="_blank">a patch</a>?</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">deguix</span><br><span class="post-time small text-muted">10th June 2003 09:52 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">I will submit wednesday or thursday, because the time give to me is little, thanks for the chance!</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Joel</span><br><span class="post-time small text-muted">10th June 2003 18:53 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Maybe it's me...<br>but with the current CVS, makensis.nsi<br>doesn't compile the VersionInfo.nsi...</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Joost Verburg</span><br><span class="post-time small text-muted">10th June 2003 20:30 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Lobo Lunar: fixed</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">deguix</span><br><span class="post-time small text-muted">12th June 2003 09:39 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">I have more suggestions:<br><br><b>For StartMenu.nsi:</b><br><br>If you create a shortcut folder like "$SMPROGRAMS\Company\Games\My Game\" using the StartMenu dll, you will work only on the My Game folder, and remove it, but the Company and the Games folder, will be not deleted after the uninstallation (if not exist shortcuts)?<br><br>This code in red is a solution for this:<br><br>...<br><br>RMDir "$SMPROGRAMS\${TEMP}" ;Only if empty, so it won't delete other shortcuts<br><br><font color="red">StartMenuLoop:<br>Push ${TEMP}<br>Call un.GetParent<br>Pop ${TEMP}<br>StrCmp $R9 "" +3 0<br>RMDir "$SMPROGRAMS\${TEMP}"<br>Goto StartMenuLoop</font><br><br>!insertmacro MUI_STARTMENU_DELETE_END<br><br>...<br><br>(${TEMP}= a the var that you use for the Start Menu Folder)<br><br>It will remove the My Game, Games and the Company folders (if not exist any shortcuts), and any parent folder that exists, (except the SMPrograms)! But it requires the GetParent Function.<br><br><b>For MakeLangID.exe:</b><br><br>- Add these "SubLang"s to the program:<br><br>SubLang_Kashmiri<br>SubLang_Nepali<br>SubLang_Serbian<br><br>Because the "Lang"s don't have a "sublang" default compared to other languages that have the default. I.e.:<br><br>Lang_Spanish - have<br>SubLang_Spanish (that is the default sublang)<br><br>- Remove these "SubLang"s from the program:<br><br>SubLang_Korean<br>SubLang_Lithuanian<br><br>Because these languages don't have more than one sublang. I.e.:<br><br>Lang_Korean<br>SubLang_Korean (is the default one, don't have more sublangs)<br><br><b>For Everyone:</b><br><br>I made a list with all available languages to use with NSIS (based on MakeLangID.exe), that I attached here. It detects the real system language. If is the English from UK, Australia, US... Is Spanish from Argentina, Uruguay, Costa Rica, Spain... This is not dependent of Modern UI Language Files, so you can use it normaly with any UI.<br><br>Use $(LangName) to you use the result.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">kichik</span><br><span class="post-time small text-muted">12th June 2003 16:19 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">The start menu code is a nice idea. I'll add it.<br><br>As for MakeLangID, the list is an exact copy of what Microsoft has defined in their .h files. I have not changed anything to maintain full compatibility.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">virtlink</span><br><span class="post-time small text-muted">13th June 2003 11:57 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Maybe a little bit offtopic, but:<br><br>What always bothers me, is the very long 'Creating shortcut' line.<br>Example (something like):<br>"Creating shortcut: C:\Documents and Settings\Daniel\Start Menu\Programs\NSIS\Shortcut.lnk"<br>It doesn't fit in the window, and it looks awfull. In Microsof programs, this is solved my removing the midsection of the url:<br>"Creating shortcut: C:\Documents and Settings\...\NSIS\Shortcut.lnk"</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Sunjammer</span><br><span class="post-time small text-muted">13th June 2003 12:19 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><a href="http://search.microsoft.com/gomsuri.asp?n=1&amp;c=rp_Results&amp;siteid=us&amp;target=http://support.microsoft.com/default.aspx?scid=kb%3Ben-us%3B249678" target="_blank">This MSDN page</a> details how to create such ellipsis shortened text.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">deguix</span><br><span class="post-time small text-muted">15th June 2003 16:38 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><b>For System.nsh (System Plugin):</b><br><br>; Is it DRIVE_FIXED?<br>System::Call '${sysGetDriveType} (i r1) .r3'<br><font color="red">IntCmp $3 ${DRIVE_FIXED} 0 enumnext</font><br><br>The comment question says that this code will detect the drives that are fixed (Hard Disk), but it detects the fixed, remote, cdrom, or ram disk drives. So replacing the IntCmp by StrCmp will detect ONLY the hard disks, that is the objective here.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">kichik</span><br><span class="post-time small text-muted">15th June 2003 18:25 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Done, thanks.</p></div><hr><div class="footer"><p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p></div></div><script src="../js/highlight.pack.js" type="text/javascript"></script><script type="text/javascript">//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]></script></body></html>