<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="description" content="ExeHead &amp; Ole request"><title>ExeHead &amp; Ole request - NSIS Forums</title><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script><link rel="preload" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css" as="style" onload="this.rel='stylesheet'"><link rel="preload" href="../css/style.css" as="style" onload="this.rel='stylesheet'"><noscript><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css"><link rel="stylesheet" href="../css/style.css"></noscript><script>!function(a){"use strict";var b=function(b,c,d){function e(a){return h.body?a():void setTimeout(function(){e(a)})}function f(){i.addEventListener&&i.removeEventListener("load",f),i.media=d||"all"}var g,h=a.document,i=h.createElement("link");if(c)g=c;else{var j=(h.body||h.getElementsByTagName("head")[0]).childNodes;g=j[j.length-1]}var k=h.styleSheets;i.rel="stylesheet",i.href=b,i.media="only x",e(function(){g.parentNode.insertBefore(i,c?g:g.nextSibling)});var l=function(a){for(var b=i.href,c=k.length;c--;)if(k[c].href===b)return a();setTimeout(function(){l(a)})};return i.addEventListener&&i.addEventListener("load",f),i.onloadcssdefined=l,l(f),i};"undefined"!=typeof exports?exports.loadCSS=b:a.loadCSS=b}("undefined"!=typeof global?global:this);!function(a){if(a.loadCSS){var b=loadCSS.relpreload={};if(b.support=function(){try{return a.document.createElement("link").relList.supports("preload")}catch(b){return!1}},b.poly=function(){for(var b=a.document.getElementsByTagName("link"),c=0;c<b.length;c++){var d=b[c];"preload"===d.rel&&"style"===d.getAttribute("as")&&(a.loadCSS(d.href,d,d.getAttribute("media")),d.rel=null)}},!b.support()){b.poly();var c=a.setInterval(b.poly,300);a.addEventListener&&a.addEventListener("load",function(){b.poly(),a.clearInterval(c)}),a.attachEvent&&a.attachEvent("onload",function(){a.clearInterval(c)})}}}(this);</script></head><body><div class="container"><ol class="breadcrumb"><li><a href="../index.html" class="glyphicon glyphicon-home"></a></li><li><a href="f-65.html">NSIS Discussion</a></li><li class="active">ExeHead &amp; Ole request</li></ol><p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=147977">ExeHead &amp; Ole request</a></p><br><div class="post"><p class="post-meta"><span class="post-author text-primary">brainsucker</span><br><span class="post-time small text-muted">3rd September 2003 03:07 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>ExeHead &amp; Ole request</strong><br>I've just finished new System version, with support of GUID &amp; WCHAR params, and fast VTable calling (i.e. COM ready).<br>The only problem is that ExeHead subsequent calls to OleInitialize(NULL) and OleUninitialize() kill all my chances to work with COM. Actually, only two calls to each function needed (one at main app thread, and second at install_thread). Currently the same two x2 calls are placed at RegisterDll and CreateShortcut functions. I've compiled modified version for System debugging and it works fine. Could you make the same available to public, please?<br><br>p.s. the size situation could be balanced: if only NSIS_SUPPORT_CREATESHORTCUT defined - run functions at installer thread only. if NSIS_SUPPORT_ACTIVEXREG defined - run them at main thread too. or something like that. Thanx.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">brainsucker</span><br><span class="post-time small text-muted">3rd September 2003 03:09 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">btw, new style CreateGUID: ;)<br>System::Call 'ole32::CoCreateGuid(g .r0)'</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">brainsucker</span><br><span class="post-time small text-muted">3rd September 2003 13:03 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Major system upgrade. As I said before some exehead adaptation needed to use new "-&gt;" calling method. All other changes could be used right now.<br><br>release 4, 3 september 2003.<br>1. Division by zero fatal error at Int64Op killed.<br>2. bool type removed (use int instead).<br>3. GUID (g) and LPWSTR (w) types added.<br>4. Memory cleanup after using t (string), g (guid) and w (unicode string) added.<br>5. Automatic A-letter at proc name discovery.<br>6. COM optimized: new proc specification "x-&gt;y", where x is interface ptr, and y is vtable member index. For such procs Interface pointer passed as first arg automaticaly.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">kichik</span><br><span class="post-time small text-muted">4th September 2003 19:17 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Done.</p></div><hr><div class="footer"><p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p></div></div><script src="../js/highlight.pack.js" type="text/javascript"></script><script type="text/javascript">//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]></script></body></html>