<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="SendMessage" />

  <title>SendMessage - NSIS Forums</title><!-- Bootstrap core CSS -->
  <link rel="stylesheet" type="text/css" href="//netdna.bootstrapcdn.com/bootswatch/3.0.1/readable/bootstrap.min.css" />
  <link rel="stylesheet" href="../css/style.css" type="text/css" /><!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!--[if lt IE 9]>
                <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
                <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->
</head>

<body>
  <div class="container">
    <!-- Put navigation bar here -->

    <ol class="breadcrumb">
      <li><a href="../index.html" class="glyphicon glyphicon-home"></a></li>

      <li><a href="f-65.html">NSIS Discussion</a></li>

      <li class="active">SendMessage</li>
    </ol>

    <p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=69348">SendMessage</a></p><br />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Smile2Me</span><br />
      <span class="post-time small text-muted">20th December 2001 08:05 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>SendMessage</strong><br />
      dear all,<br />
      <br />
      I want to do the following:<br />
      <br />
      Matlab is some sort of command-prompt mathematics program and I want to install a plugin into this program. This can only be done by Matlab itself, so you should type the command and Enter and then it's installed.<br />
      Is it possible to automate this using SendMessage? And if so, can anyone give me a link to a site where I can find more codes for possible messages the the matlabwindow, because I'm not experienced in c-programming...<br />
      <br />
      thx a lot all, greetz, Hendri.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
      <span class="post-time small text-muted">20th December 2001 19:43 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Did you try to use:<br />
      X:\whatever\matlab\matlab.exe &lt; installplugin.txt<br />
      <br />
      when installplugin.txt is the commands you need to enter to matlab?</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Smile2Me</span><br />
      <span class="post-time small text-muted">21st December 2001 08:54 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">thx, i tried, but it didn't work...<br />
      but maybe there are other possibilities for the command line, so thx for your idea, greetz,<br />
      <br />
      Hendri,</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Smile2Me</span><br />
      <span class="post-time small text-muted">21st December 2001 12:59 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">well, matlab does not support command-line arguments at startup, so if anyone knows a way how to use SendMessage for this problem, this would bevery helpfull.<br />
      <br />
      Thx, greetz, Hendri.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
      <span class="post-time small text-muted">21st December 2001 13:15 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Oops... If you DID read this message before I changed it, please ignore it. It was a mistake.<br />
      <br />
      And now that I think about it, you just can't do it with SendMessage. SendMessage only works on windows, and if you say that Matlab is command prompt program then you just can't do it. :(<br />
      <br />
      Here is a quote from MSDN:<br /></p>

      <blockquote>
        The SendMessage function sends the specified message <b>to a window or windows</b>. The function calls the <b>window procedure</b> for the specified <b>window</b> and does not return until the <b>window procedure</b> has processed the message.
      </blockquote>Sorry... :(
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Smile2Me</span><br />
      <span class="post-time small text-muted">21st December 2001 16:44 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">kichik, thx for your reply...<br />
      I realize that it's indeed not possible with SendMessage. I will take a look at the website of Matlab. Maybe they can give me a hint on how to interact with Matlab....<br />
      <br />
      Thx anyway, greetz, Hendri.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">eccles</span><br />
      <span class="post-time small text-muted">21st December 2001 21:51 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Mmm, but a command prompt is just another window, so it should be possible.<br />
      <br />
      Try this..</p>
      <pre>
<code>Name "Test"<br />OutFile "test.exe"<br /><br />; Send a simple command to a Command Prompt window (works in Win2K)<br />Section<br />  FindWindow $R0 "" "Command Prompt"<br />; or, more generic -<br />; FindWindow $R0 "ConsoleWindowClass"<br />  IntCmp $R0 0 NoWindow<br />  MessageBox MB_ICONINFORMATION|MB_OK "Window found ($R0)"<br />  Push $R0<br />  Push "dir$\r"<br />  Call SendChars<br />  Return<br />NoWindow:<br />  MessageBox MB_ICONEXCLAMATION|MB_OK "No window found!"<br />SectionEnd<br /><br />; SendChars:<br />;   Send a stream of WM_CHAR messages to a window to simulate user input<br />; Usage:<br />;   Push &lt;window-handle&gt;<br />;   Push &lt;message&gt;<br />;   Call SendChars<br />Function SendChars<br />  Exch $R0 ; Get string<br />  Exch<br />  Exch $R1 ; Get hwnd<br />  Push $R2<br />  Push $R3<br />  StrCpy $R2 0 ; Char index<br />loop:<br />  StrCpy $R3 $R0 1 $R2 ; Get next char<br />  StrCmp $R3 "" done<br />  Push $R3<br />  Call CharToAscii ; Convert it to ASCII<br />  Pop $R3<br />  SendMessage $R1 258 $R3 0 ; Send a WM_CHAR message<br />  IntOp $R2 $R2 + 1<br />  Goto loop<br />done:<br />  Pop $R3<br />  Pop $R2<br />  Pop $R1<br />  Pop $R0<br />FunctionEnd<br /><br />; CharToAscii:<br />;   Convert a character to it's ascii code<br />; Usage:<br />;   Push &lt;character&gt;<br />;   Call CharToAscii<br />;   Pop &lt;ascii-code&gt;<br />;<br />; Surely there must be a simpler way of doing this!<br />; Am I missing something obvious??<br />Function CharToAscii<br />  Exch $R0 ; Get character<br />  Push $R1<br />  Push $R2<br />  StrCpy $R1 255 ; ASCII code test counter<br />loop:<br />  IntFmt $R2 "%c" $R1 ; Convert current test counter to it's char<br />  StrCmp $R2 $R0 done ; Have we found it yet? (note - not case sensitive)<br />  IntOp $R1 $R1 - 1 ; Next code<br />  IntCmp $R1 0 "" "" loop<br />done:<br />  Pop $R2<br />  Exch<br />  Pop $R0<br />  Exch $R1<br />FunctionEnd</code>
</pre>--<br />
      Dave.
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
      <span class="post-time small text-muted">21st December 2001 22:09 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>Nice!</strong><br />
      I haven't though about it like this. Good work :cool:<br />
      Will it work on full screened command prompts?</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">eccles</span><br />
      <span class="post-time small text-muted">21st December 2001 22:29 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Just tried - yep, seems to :)<br />
      <br />
      Hopefully this Matlab app has a unique, consistent, window title (as ConsoleWindowClass on its own could find anything!)<br />
      <br />
      --<br />
      Dave.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Smile2Me</span><br />
      <span class="post-time small text-muted">22nd December 2001 06:44 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Dave,<br />
      <br />
      thx a lot for your reply, but it doesn't work yet... :(<br />
      <br />
      The problem is, that my program is compatible to two Matlab versions: 5 and 6. 5 only has a window called "Matlab command window" and the program should be able to find this window, but i couldn't test this because I do not have Matlab 5. Matlab 6 has a child (see the picture). The child has a name "Command window" and the test.nsi is not able to find this window. (it can find the main Matlab though...)<br />
      <br />
      Can you help me out here?<br />
      <br />
      thx, Hendri.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Smile2Me</span><br />
      <span class="post-time small text-muted">22nd December 2001 07:09 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">hi dave,<br />
      <br />
      I found out (at least I think), that Matlab is not really a command prompt program, but it only looks like that. This is because above functions work <b>really well</b> for the DOS-window, but cannot add anything to a Matlab window. Please, take a look at the picture i posted earlier, maybe this might give you a clue how to do this...<br />
      <br />
      Thx a lot, Hendri.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">eccles</span><br />
      <span class="post-time small text-muted">22nd December 2001 13:31 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Ok, I see what you mean.<br />
      <br />
      Try this, if it doesn't work then maybe there's another window between the main window and the Command Window, but this has no name (that you can see) so you'd have to find out the window class name. To do that I use a tool which comes with Visual Studio, but I'm sure there must be freeware utilities that can do that too...</p>
      <pre>
<code>Section<br />  ; Look for Matlab 5 window<br />  FindWindow $R0 "" "Matlab command window"<br />  IntCmp $R0 0 "" FoundWindow FoundWindow<br />  ; Look for Matlab 6 window (main window)<br />  FindWindow $R0 "" "MATLAB"<br />  IntCmp $R0 0 NoWindow<br />  ; Now look for the command window (child window) inside it<br />  FindWindow $R0 "" "Command Window" $R0<br />  IntCmp $R0 0 NoWindow<br />FoundWindow:<br />  MessageBox MB_ICONINFORMATION|MB_OK "Window found ($R0)"<br />  Push $R0<br />  Push "dir$\r"<br />  Call SendChars<br />  Return<br />NoWindow:<br />  MessageBox MB_ICONEXCLAMATION|MB_OK "No window found!"<br />SectionEnd</code>
</pre>Good luck! And Happy Christmas to all... :)<br />
      <br />
      --<br />
      Dave.
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Smile2Me</span><br />
      <span class="post-time small text-muted">23rd December 2001 00:42 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Dave,<br />
      <br />
      thx a lot for your reply and the code, but it's still not able to find the Matlab command window using Matlab 6. In Matlab 5 it finds the window, but does not add anything behind the command prompt...<br />
      <br />
      So I guess Matlab uses some strange unknown construction for it's windows...<br />
      <br />
      And I guess that I will have to think about another solution on how to do the thing i mentioned above. Or construct erverything in a completely other way...<br />
      <br />
      I also posted this thread at <a href="http://www.mathworks.com" target="_blank">www.mathworks.com</a> (Matlab web-site) but they didn't even give a response....<br />
      <br />
      So thx a lot all (especially Dave!!!), if you know another way of doing this, please let me know, thx, greetz,<br />
      <br />
      Hendri.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">petersa</span><br />
      <span class="post-time small text-muted">24th December 2001 11:43 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">You might be interested in downloading <a href="http://www.hiddensoft.com/autoit/" target="_blank">AutoIt</a>. It allows you to write small scripts that activate windows, send keystrokes, mouse clicks, all sorts of stuff, and it allows you to compile your scripts into small EXE files.<br />
      <br />
      My favourite utility before I discovered NSIS!<br />
      <br />
      Sure, it's not the most practical solution, but it's better than nothing.<br />
      <br />
      Feel free to PM me if you need help writing a script for it.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Smile2Me</span><br />
      <span class="post-time small text-muted">24th December 2001 13:39 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Petersa,<br />
      <br />
      thx for your reply, I just downloaded the program and I will certainly try it.<br />
      <br />
      Have a nice christmas time, greetz,<br />
      Hendri.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Smile2Me</span><br />
      <span class="post-time small text-muted">25th December 2001 23:44 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Petersa,<br />
      <br />
      I tried AutoIt, but I couldn't get it to work. Even the example program's (after translating the neccessary command's to Dutch :)) didn't work (eg: adding lines to notepad). I also tried to apply this to Matlab but did also not work unfortunately....<br />
      <br />
      I've given up, I think... :(<br />
      <br />
      Thx all anyway. I will be considering your inputs, maybe, I can get some of it to work later on.<br />
      <br />
      THX, greetz, Hendri.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
      <span class="post-time small text-muted">26th December 2001 14:31 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Well, as I see it all you need to do is to discover Matlab command window class name. After you do that Dave's code will work.<br />
      <br />
      To discover the class name of the command window use Microsoft Spy++ (included with Visual C++) or Spy (included with Microsoft SDK). I am sure there is a freeware that displays this kind of information for all windows somewhere out there but I don't know it. Don't give up, search for it if you don't have Visual C++ or you don't want to download Microsoft SDK.<br />
      <br />
      KiCHiK</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Smile2Me</span><br />
      <span class="post-time small text-muted">26th December 2001 14:42 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">kichik, thx for your idea!<br />
      I'll start a search for Spy for I do not have C++<br />
      <br />
      If you know some page, please tell me...<br />
      <br />
      Thx a lot, greetz, Hendri.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
      <span class="post-time small text-muted">26th December 2001 15:29 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">I have found just the prog for you. It tells you the class name of the window you are pointing with the mouse. It doesn't shows all messages sent to all windows like Spy++ but it should do the trick.<br />
      <br />
      <a href="http://www.gena01.com/win32spy/" target="_blank">WinSpy</a><br />
      <br />
      Enjoy! :D</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Smile2Me</span><br />
      <span class="post-time small text-muted">26th December 2001 15:48 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Kichik,<br />
      <br />
      thx for this URL, it indeed is the program I was looking for. So I found out that Matlab 6 has a SunAwtFrame class window with Caption "Matlab", my installer found the window (!!!) but it's not able to send some characters to it... (I use SendChars posted as a reply to my first thread)... Do you know what's missing now :( ???<br />
      <br />
      Thx, greetz, Hendri.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Smile2Me</span><br />
      <span class="post-time small text-muted">26th December 2001 15:52 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Well I mean, (i hope this was clear...) that nothing happens to the window, no characters appear in the window, nothing is being executed...<br />
      <br />
      thx, Hendri.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
      <span class="post-time small text-muted">26th December 2001 16:26 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Attached is Spy from Microsoft Platform SDK (it's a free download but a long one with all the other stuff).<br />
      <br />
      In the Spy menu click on Select window and select the window needed from Matlab. Then click Start!, type something in Matlab and notice what messages it gets.<br />
      <br />
      You should use the exact same messages in your NSIS script.<br />
      <br />
      If you get too many messages start filtering them with Options-&gt;Messages.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Smile2Me</span><br />
      <span class="post-time small text-muted">26th December 2001 17:26 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">"Cannot load HOOK.DLL" is the message I get when clicking 'Start!'<br />
      <br />
      Can you also post this dll (and maybe other files the spy uses???)<br />
      <br />
      Thx a lot, greetz, Hendri.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
      <span class="post-time small text-muted">26th December 2001 17:39 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Oops... :rolleyes:<br />
      <br />
      Well I have reupped it in the same reply (2 up) with hook.dll. I also checked that it doesn't need anything else but hook.dll.<br />
      <br />
      KiCHiK</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Smile2Me</span><br />
      <span class="post-time small text-muted">26th December 2001 22:16 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">thx kichik,<br />
      <br />
      i already gave it a try using notepad but i got indeed a lot of messages from one window. I will try to sort this out using the options menu...<br />
      <br />
      Thanks a lot, greetz, Hendri.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">eccles</span><br />
      <span class="post-time small text-muted">29th December 2001 19:56 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Hi Hendri,<br />
      <br />
      How's it going, working yet?<br />
      <br />
      If not, maybe what Matlab's after are messages to fool it into thinking it has keyboard focus...<br /></p>
      <pre>
<code>Function SendChars<br />  Exch $R0 ; Get string<br />  Exch<br />  Exch $R1 ; Get hwnd<br />  Push $R2<br />  Push $R3<br />  SendMessage $R1 ${WM_SETFOCUS} 0 0<br />  StrCpy $R2 0 ; Char index<br />loop:<br />  StrCpy $R3 $R0 1 $R2 ; Get next char<br />  StrCmp $R3 "" done<br />  Push $R3<br />  Call CharToAscii ; Convert it to ASCII<br />  Pop $R3<br />  SendMessage $R1 ${WM_CHAR} $R3 0<br />  IntOp $R2 $R2 + 1<br />  Goto loop<br />done:<br />  SendMessage $R1 ${WM_KILLFOCUS} 0 0<br />  Pop $R3<br />  Pop $R2<br />  Pop $R1<br />  Pop $R0<br />FunctionEnd</code>
</pre>btw, see <a href="http://forums.winamp.com/showthread.php?s=&amp;threadid=70118" target="_blank">KiCHik's Windows Messages thread</a> for the header file for the !defines used. Very handy!<br />
      <br />
      Other than that, I'm not sure what else to suggest :( Maybe experiment with other windows messages, described at <a href="http://msdn.microsoft.com/library/default.asp?url=/library/en-us/winui/keybinpt_4iib.asp?frame=true" target="_blank">MSDN</a>.<br />
      <br />
      Good luck!<br />
      Dave.
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Smile2Me</span><br />
      <span class="post-time small text-muted">29th December 2001 20:15 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Hi Dave,<br />
      <br />
      thx i'll try. I indeed downloaded Kichik's package. I also used some spy to determine what messages to send to Matlab. But I do not understand this output. I press for example 'd' and one time the spy tells me that this is in fact produced by the messages key_down, char and key_up and another time it's produced by char, char and key_up...<br />
      <br />
      So I can't figure out what to send...<br />
      <br />
      But I tried to send 'dir\n' using SendChar and using the first construction (key_down, char, key_up) for each character and Matlab interpreted these messages as:<br />
      49[Enter]<br />
      <br />
      So, again really stuck. Is this a strange thing of Matlab, you think, or am I just doing the wrong thing????<br />
      <br />
      Thx in advance, i didn't try above yet, i'll do it right away, thx,<br />
      <br />
      greetz, Hendri.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
      <span class="post-time small text-muted">29th December 2001 20:35 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">From MSDN:<br />
      <br /></p>

      <blockquote>
        The WM_CHAR message is posted to the window with the keyboard focus when a WM_KEYDOWN message is translated by the <b>TranslateMessage</b> function. WM_CHAR contains the character code of the key that was pressed.
      </blockquote>Correct me if I am wrong but this means that you don't need to send WM_KEYDOWN and WM_KEYUP. All that it does is to send to the window WM_CHAR so you can skip it and just send WM_CHAR.<br />
      <br />
      And if you already got it to send 49[Enter] keep trying, you are on the right track :up:.<br />
      <br />
      KiCHiK<br />
      <br />
      PS<br />
      I am glad you like my header file :)
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Smile2Me</span><br />
      <span class="post-time small text-muted">30th December 2001 18:09 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Kichik,<br />
      <br />
      I think i should use Key_down and up...<br />
      I first tried without, but that resulted in just no response from Matlab, so i think i should use it...<br />
      <br />
      Indeed i'm on the right track, i hope, so i'll keep trying, maybe someone has another idea what's going on with Matlab, because in a simple Dos-Window, there is no problem with just sending WM_CHAR...<br />
      <br />
      Thx, greetz, Hendri.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Smile2Me</span><br />
      <span class="post-time small text-muted">30th December 2001 18:12 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Bye the way, trying to send 'dir\n' resulted in '49[Enter]' so on the right track... I don't know. There seems to be something wrong...<br />
      <br />
      Hendri.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">futuris</span><br />
      <span class="post-time small text-muted">30th December 2001 20:54 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>Possible source of problem!</strong><br />
      &gt; Matlab 6 has a SunAwtFrame class window with Caption "Matlab"<br />
      <br />
      "SunAwtFrame" means that MatLab written in Java! It means, that it will not (most likely) react to Windows messages.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
      <span class="post-time small text-muted">31st December 2001 12:08 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Smile2Me, have you tried sending the lParam and wParam as shown on Spy?<br />
      <br />
      And does [Enter] means a line break or does it actually show [Enter]?</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Smile2Me</span><br />
      <span class="post-time small text-muted">1st January 2002 21:07 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Kichik,<br />
      <br />
      [Enter] means a line break indeed, but also that the command entered will be executed. In Matlab 49[Enter] means that it will assign the value 49 to the variable 'ans'...<br />
      <br />
      But I think I replicated the messages given by Spy completely, but I'll check on this again, thx...<br />
      <br />
      Happy NewYear to you all!!!<br />
      <br />
      Greetz, Hendri.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
      <span class="post-time small text-muted">1st January 2002 21:33 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">I still think you are on the right track.<br />
      <br />
      As you can see by the "table" below the values you sent with WM_KEYUP/DOWN/CHAR were just shifted some to the digits zone. The difference between d and i is the same as 4 and 9. All we are missing now is the r :)<br />
      <br /></p>
      <pre>
<code><br />4 5678 9<br />d efgh i<br /></code>
</pre><br />
      <br />
      Did you try to use spy to see what messages are being sent from the installer and then compare them to the messages you sent manually?<br />
      <br />
      KiCHiK
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Smile2Me</span><br />
      <span class="post-time small text-muted">2nd January 2002 13:35 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Kichik,<br />
      <br />
      bright point!!!<br />
      I'll check the function CharToAscii as it seems that there is something wrong there...<br />
      <br />
      Yeah, i spied the messages from installler to Matlab and everything looked ok to me... (just the messages i send where reported, nothing strange...)<br />
      <br />
      But i also discovered some functions in Matlab to do the job i posted this thread for (in the end, I wanted to protect my M-files (just textfiles with commands) from being viewed or changed). Matlab offers a service for that. So finding some dll's of Matlab give me the opportunity to code my files...<br />
      <br />
      So the goal is achieved!!!<br />
      <br />
      But i'll keep trying to get the messages to work because i think i'll need it later on for other installer features...<br />
      <br />
      So at this point thx all for the helping replies!!!<br />
      <br />
      Kichik, i'll work on it, and i'll post my result here!!!<br />
      <br />
      THX ALL, greetz, Hendri.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Smile2Me</span><br />
      <span class="post-time small text-muted">14th January 2002 17:07 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Some old topic information:<br />
      <br />
      I gave up, but did the thing in another way, as you might have read...<br />
      <br />
      But I've got a new question on SendMessage.<br />
      <br />
      Please help me at:<br />
      <a href="http://forums.winamp.com/showthread.php?s=&amp;threadid=71924" target="_blank">http://forums.winamp.com/showthread....threadid=71924</a><br />
      <br />
      Thx all, greetz, Hendri.</p>
    </div>
    <hr />

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]>
  </script>
</body>
</html>
