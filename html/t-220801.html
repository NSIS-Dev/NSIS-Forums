<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="description" content="MUI - Conditional custom and Components page"><title>MUI - Conditional custom and Components page - NSIS Forums</title><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script><link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css"><link rel="stylesheet" href="../css/style.css" type="text/css"></head><body><div class="container"><ol class="breadcrumb"><li><a href="../index.html" class="glyphicon glyphicon-home"></a></li><li><a href="f-65.html">NSIS Discussion</a></li><li class="active">MUI - Conditional custom and Components page</li></ol><p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=220801">MUI - Conditional custom and Components page</a></p><br><div class="post"><p class="post-meta"><span class="post-author text-primary">DennisFeiock</span><br><span class="post-time small text-muted">6th July 2005 16:23 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>MUI - Conditional custom and Components page</strong><br>I have been working on an application portal and ended up in a bit of a predicament.<br><br>I am using a MUI interface with a custom page containing a text field and a password field. I only want the custom page to come up if a registry value does not exist. If it does exist, I want it to go straight to the components page.<br><br>The second part that I am needing help with is that I want the sections under the Component page altered by data that is read and verified by a seperate function of the installer. I need sections created/checked/disabled(RO)/hidden depending on the data that is provided. Using SectionSetFlags, I can do everything but create dynamic sections and make the sections visable or hidden.<br><br>Thanks for any help you might provide.<br><br>- DF</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br><span class="post-time small text-muted">6th July 2005 16:28 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Look at this:<br><a href="http://forums.winamp.com/showthread.php?threadid=220709" target="_blank">http://forums.winamp.com/showthread.php?threadid=220709</a><br>and<br><a href="http://forums.winamp.com/showthread.php?threadid=220713" target="_blank">http://forums.winamp.com/showthread.php?threadid=220713</a><br><br>-Stu</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">DennisFeiock</span><br><span class="post-time small text-muted">6th July 2005 16:51 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Thanks again Afro UK. I got the first part of skipping a custom MUI page based on a registry key.<br><br>The second part is still a problem though. I looked at your second link, and in that case, x-nem wanted to skip custom pages based on if a component was selected to install or not.<br><br>What I am looking at doing is using an INI file to specify the components. Like so:<br><br>[1]<br>Name=MyApp<br>Location=\\blah\subfolder\blah.exe<br>Required=Yes<br><br>[2]<br>...<br><br>So I would need to use a loop to read out the components to be displayed (as well as what to execute) on the first Components page.<br><br>Thanks again<br>- DF</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br><span class="post-time small text-muted">6th July 2005 16:56 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">You cannot dynamically add components. There's a fixed amount (set with Section's) on compile-time.<br><br>-Stu</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">DennisFeiock</span><br><span class="post-time small text-muted">6th July 2005 17:02 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Ok, last question.<br><br>Is there a way to hide a section from the components page? I didnt see an option like that with SectionSetFlags.<br><br>- DF<br><br>edit: Besides hard-coding it into the section syntax.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br><span class="post-time small text-muted">6th July 2005 17:06 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">You just need to set the section name to "" with SectionSetText<br><br>-Stu</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">DennisFeiock</span><br><span class="post-time small text-muted">6th July 2005 17:09 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Awsome. Thanks a ton Afrow UK. Your the best. :D<br><br>- DF</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">DennisFeiock</span><br><span class="post-time small text-muted">6th July 2005 22:27 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Gah! Thought I was all done. I am having a problem with the SetSectionText command.<br><br>This is the scenario right now:<br>There are 2 sections, MyApp and AnotherApp, in that order. Both components are hidden by default. My functions display and enable AnotherApp. With using the .onSelChange function, when I check and uncheck the box, it enables and disables both components.<br><br>Any suggestions?<br><br>- DF</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br><span class="post-time small text-muted">6th July 2005 23:14 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Sorry, what's the actual question / problem.<br><br>Edit: Or rather, what do you need it to do instead.<br><br>-Stu</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">DennisFeiock</span><br><span class="post-time small text-muted">7th July 2005 13:25 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Ok, heres what Im trying to do.<br><br>By default, I hide all my sections. In this case, there are only 2.<br><br>So I got something like this:<br><br>Section "-MyApp" MyApp<br>DetailPrint "Blah1"<br>SectionEnd<br><br>Section "-AnotherApp" AnotherApp<br>DetailPrint "Blah2"<br>SectionEnd<br><br>---<br>Then I have a function reading an ini file and making the sections visible as needed.<br><br>For the test I was running, MyApp was going to stay hidden, and AnotherApp was going to appear. The syntax I am using is this:<br><br>SetSectionText AnotherApp "AnotherApp"<br><br>This makes only AnotherApp be displayed on the componets page. So, that works so far.<br><br>To test this, I made the following function.<br><br>Function .onSelChange<br>SectionGetFlags MyApp $0<br>MessageBox MB_OK "MyApp: $0"<br>SectionGetFlags AnotherApp $0<br>MessageBox MB_OK "AnotherApp: $0"<br>FunctionEnd<br><br>Now, when I check the AnotherApp box on the components page, I get MyApp Flags = 1 and AnotherApp Flags = 1. When I uncheck the box, I get MyApp = 0 and AnotherApp = 0.<br><br>So the one checkbox that is being displayed is really controlling both MyApp and AnotherApp.<br><br>What Im going to try to do this morning (USA) is take out my functions. I have a lot of other things going on in the background and it could be causing problems.<br><br>- DF</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">DennisFeiock</span><br><span class="post-time small text-muted">7th July 2005 14:01 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Just finished with my testing. The problem seems to be with how the Section Flags really work. Even if the SectionGetFlags = 1, then that doesnt necessarily mean that it will run the install for that app. Same with 0 and not running the specified section.<br><br>Maybe I am just trying to use the Section Flags in a way that they arent meant to be used. Attached is my concept nsi. Under the .onInit function, I am setting AnotherApp Section Flags to 1.<br>If I do that, then the MyApp checkbox on the components page is checked and so is the AnotherApp checkbox.<br>If AnotherApp Section Flags is set to 0, then the MyApp Checkbox on the components page is UNchecked and AnotherApp checkbox is still checked.<br><br>What I am needing to do is have the ability to control which checkboxes are checked and which ones arent. I thought SectionSetFlags could do that, but maybe Im missing something?<br><br>- DF</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br><span class="post-time small text-muted">7th July 2005 15:23 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Ideally you should use the SetSectionFlag and ClearSectionFlag macros in Sections.nsh:<br><br>!include Sections.nsh<br><br>Function .onInit<br>!insertmacro SetSectionFlag ${secID} ${SF_SELECTED}<br>FunctionEnd<br><br>Edit: And to check if a Section is selected, use the SectionIsSelected macro.<br><br>-Stu</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Joost Verburg</span><br><span class="post-time small text-muted">7th July 2005 15:23 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Section flags are combinations of different settings. Use the Section.nsh macros to check whether a section is selected or not.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">DennisFeiock</span><br><span class="post-time small text-muted">7th July 2005 15:56 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Ok, got another one. Sorry for all the questions...<br><br>When using the macro:<br><br>!insertmacro SetSectionFlag ${secID} ${SF_SELECTED}<br><br>is there a way to use a variable for the SectionID?<br><br>Thanks again,<br><br>- DF<br><br>[EDIT]<br>That and I just noticed that I cant use plain numbers instead of the SF_SELECTED. How would I control RO/RW (setflags bit would be 17) using the macro?<br><br>Nevermind the above statement... no coffee... :(</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br><span class="post-time small text-muted">7th July 2005 16:07 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">SF_SELECTED and SF_RO are plain numbers. They're defines in Sections.nsh<br><br>The SectionID is also just a plain number. The first Section will have an index of 0 (also SectionGroup and SectionGroupEnd's take up section slots).<br><br>-Stu</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">DennisFeiock</span><br><span class="post-time small text-muted">7th July 2005 16:17 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Alright! Got everything working. Hopefully for sure this time. Thanks again for all the help. :up:<br><br>- DF</p></div><hr><div class="footer"><p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p></div></div><script src="../js/highlight.pack.js" type="text/javascript"></script><script type="text/javascript">//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]></script></body></html>