<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="description" content="Display Animated GIF images for Custom Pages"><title>Display Animated GIF images for Custom Pages - NSIS Forums</title><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script><link rel="preload" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css" as="style" onload="this.rel='stylesheet'"><link rel="preload" href="../css/style.css" as="style" onload="this.rel='stylesheet'"><noscript><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css"><link rel="stylesheet" href="../css/style.css"></noscript><script>!function(a){"use strict";var b=function(b,c,d){function e(a){return h.body?a():void setTimeout(function(){e(a)})}function f(){i.addEventListener&&i.removeEventListener("load",f),i.media=d||"all"}var g,h=a.document,i=h.createElement("link");if(c)g=c;else{var j=(h.body||h.getElementsByTagName("head")[0]).childNodes;g=j[j.length-1]}var k=h.styleSheets;i.rel="stylesheet",i.href=b,i.media="only x",e(function(){g.parentNode.insertBefore(i,c?g:g.nextSibling)});var l=function(a){for(var b=i.href,c=k.length;c--;)if(k[c].href===b)return a();setTimeout(function(){l(a)})};return i.addEventListener&&i.addEventListener("load",f),i.onloadcssdefined=l,l(f),i};"undefined"!=typeof exports?exports.loadCSS=b:a.loadCSS=b}("undefined"!=typeof global?global:this);!function(a){if(a.loadCSS){var b=loadCSS.relpreload={};if(b.support=function(){try{return a.document.createElement("link").relList.supports("preload")}catch(b){return!1}},b.poly=function(){for(var b=a.document.getElementsByTagName("link"),c=0;c<b.length;c++){var d=b[c];"preload"===d.rel&&"style"===d.getAttribute("as")&&(a.loadCSS(d.href,d,d.getAttribute("media")),d.rel=null)}},!b.support()){b.poly();var c=a.setInterval(b.poly,300);a.addEventListener&&a.addEventListener("load",function(){b.poly(),a.clearInterval(c)}),a.attachEvent&&a.attachEvent("onload",function(){a.clearInterval(c)})}}}(this);</script></head><body><div class="container"><ol class="breadcrumb"><li><a href="../index.html" class="glyphicon glyphicon-home"></a></li><li><a href="f-65.html">NSIS Discussion</a></li><li class="active">Display Animated GIF images for Custom Pages</li></ol><p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=245291">Display Animated GIF images for Custom Pages</a></p><br><div class="post"><p class="post-meta"><span class="post-author text-primary">baskaran.vishnu</span><br><span class="post-time small text-muted">3rd May 2006 12:03 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>Display Animated GIF images for Custom Pages</strong><br>Hi,<br><br>I am having difficulties to display an animated GIF Image for a custom page,<br><br>At the moment, based on the design of my custom page, clicking the Next Button installs a hidden based application. During that process, I would like to show to an Animated GIF indicating installation in progress.<br><br>I am currently using a Bannner Image using the EBanner plugins. The banner works excellent. However, this plugin does not support animated GIFs.<br><br>I have tried using another plugin, AnimGif, however, I am having difficulties running this plugin for my custom page.<br><br>I would be grateful for any advice or references on this issue.<br><br>Thank you</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">zeeh3</span><br><span class="post-time small text-muted">4th May 2006 02:02 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Attach your script.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">baskaran.vishnu</span><br><span class="post-time small text-muted">4th May 2006 10:18 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>Attached Scripts</strong><br>Hi,<br><br>I have posted the Scripts as shown below;<br><br>/* Start Scripts */<br><br>/*Initialized code for the custom page at the beginning of the scripts */<br>#Custom Page Intialization<br>Page custom ShowMSQLCheckPage CheckMSQLPage<br><br># Extract the Custom INI file<br>!insertmacro MUI_INSTALLOPTIONS_EXTRACT_AS "DispForms\Check MSQL.ini" "CheckMSQL"<br><br>/* Initialize a GIF image to the Plugins Directory */<br>Function .onInit<br>InitPluginsDir<br>File /oname=$PLUGINSDIR\sample.gif "C:\sample.gif"<br><br>!insertmacro MUI_INSTALLOPTIONS_EXTRACT_AS "DispForms\Check MSQL.ini" "CheckMSQL"<br>FunctionEnd<br><br><br>/* Custom Page Functions */<br>Function ShowMSQLCheckPage<br><br># Display the page.<br>!insertmacro<br>!insertmacro MUI_INSTALLOPTIONS_INITDIALOG "CheckMSQL"<br>Pop $R0 # HWND<br>GetDlgItem $R1 $R0 1200 ; 1200 + Field # - 1<br>GetDlgItem $R2 $R0 1201 ; 1200 + Field # - 1<br><br>SetCtlColors $R0 3D66AB 3D66AB<br>SetCtlColors $R1 FFFFFF 3D66AB<br>SetCtlColors $R2 FFFFFF 3D66AB<br><br>!insertmacro MUI_INSTALLOPTIONS_SHOW<br>continue:<br><br>Return<br>FunctionEnd<br><br>Function CheckMSQLPage<br><br>newadvsplash::show /NOUNLOAD 2000 600 400 -1 /BANNER /NOCANCEL "$PLUGINSDIR\sample.gif"<br>newadvsplash::hwnd /NOUNLOAD<br>Pop $0<br>AnimGif::play /NOUNLOAD /hwnd=$0 /bgcol=0xffffff "$PLUGINSDIR\sample.gif"<br><br>sleep 5000<br>newadvsplash::wait ; waits or exits immediately if 'show' already finished<br>newadvsplash::stop<br>AnimGif::stop<br><br>FunctionEnd<br><br>/* End of Scripts */<br><br>From the codes above, the custom page calls on two functions to show the Main page(With some Text Display from the custom ini file) followed by the action to show the animated GIF Image when user clicks on the 'Next' button of the custom page. I can't seem to get the GIF Image displayed based on this condition. In fact the Installer hangs and I have to forcefully exit the Installer.exe file.<br><br>The weird thing is that when I remove '/Banner' from the newadvsplash::show command line, the Flash Image is displayed but the GIF Image does not seem to show its animation movement. It seems as if the AnimGif::play command doesn't execute.<br><br>Besides that, if I execute the newadvsplash::show (with '/Banner'),newadvsplash::hwnd and AnimGif::play commands in Function .onInit, the Animated Image with its splash screen feature is displayed during startup of the Installer.exe. It's as if that these functions work in the Function .oninit but not in custom based functions<br><br>I am using the AnimGif.dll along with the newadvsplash.dll plugins to run this method.<br><br>Would appreciate any help on this.<br><br>Thanks<br><br>(PS: I have attached the sample.gif Animated Image as a reference)</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">baskaran.vishnu</span><br><span class="post-time small text-muted">5th May 2006 08:56 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Hi,<br><br>If you need any added details based on the scripts above, please inform me. I would help in any way possible.<br><br>I would truly appreciate it if anyone could assist me with the problem above.<br><br>Thanks</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Takhir</span><br><span class="post-time small text-muted">14th May 2006 11:17 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>newadvsplash patch</strong><br>Please test attached dll version.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">hbatista</span><br><span class="post-time small text-muted">3rd April 2007 18:49 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Hi, reviving this old thread...<br>I'm also trying to use the newadvsplash plugin to display animated GIF banners when navigating between pages, i.e. pressing the 'Next' button displays an animated 'please wait' banner, and the next page hides the banner.<br><br>The plugin version that's on the wiki didn't work, but the special version in the last reply does work!<br>But... there's still a problem... it only works the first time! Any second calls to newadvsplash::show freeze the installer.<br><br>Please help...<br><br>Thanks</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Takhir</span><br><span class="post-time small text-muted">3rd April 2007 20:05 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Not freezes in my tests using May 14, 2006 version. Script attached. I'll compare sources and add lost&amp;found version to wiki tomorrow :)</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">hbatista</span><br><span class="post-time small text-muted">4th April 2007 10:17 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Thanks Takhir, I tried your script and it does indeed work.<br><br>But in attachment is a little example I cooked up that has the freezing problem.<br>It has two InstallOptions pages, and simulates a slow operation at the beginning of them where I'd like to show a banner, on the first page it works, on the second it freezes.<br><br>Can you take a look at it?<br>Thank you very much for your help!</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Takhir</span><br><span class="post-time small text-muted">4th April 2007 12:53 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">SetPluginUnload manual<br>helped me in your test. Is alwaysoff a default? But this is my fault too.. AnimGif not makes a full clean up on serial 'show' requests, and may hang. This is why I used 'stop' with unload.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">hbatista</span><br><span class="post-time small text-muted">4th April 2007 14:57 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Tried using 'SetPluginUnload manual' but still no luck here ('manual' is the default anyway) :(<br><br>I'm using stop with unload too, but it doesn't seem to help...</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Takhir</span><br><span class="post-time small text-muted">4th April 2007 15:07 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">script and binaries attatched - opens second page and second gif. I put new version to <a href="http://nsis.sourceforge.net/File:NewAdvSplash.zip" target="_blank">wiki</a> but it has a minimum changes compare to version linked above.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">hbatista</span><br><span class="post-time small text-muted">4th April 2007 16:08 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">OK, I see now what causes it to freeze, SetPluginUnload has nothing to do with it, your version worked because you changed the 'delay' value from 120000 to 1200 ms.<br>It appears the plugin does not like to have 'stop' called before the delay value expires.<br>I have to use a big value because I just want the banner to show for as much time as is necessary, not just a fixed delay...<br><br>Thanks for your patience<br><br>ps: by the way, the new version you uploaded to the wiki appears to be the same as the old one...</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">hbatista</span><br><span class="post-time small text-muted">4th April 2007 18:28 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Got it working!<br>Fiddled a bit with the source code, the wiki version does not seem to be the most recent (e.g. it doesn't have the '/BANNER' parsing code), but modified it anyway.<br><br>The problem seems to be that because the thread never ended ('stop' doesn't wait), it never unregistered the window class. So on the second call to 'show', the register failed. I added an unregister in the 'stop' method and the thing is now working.<br><br>In attach there's the modified source, modified lines have an '//hbatista' comment. Takhir, can you integrate this into the official plugin version?<br><br>Thanks</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Takhir</span><br><span class="post-time small text-muted">5th April 2007 07:38 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Thanks for your help, hbatista!<br>RegisterClass really works in the application scope, not dll load/unload :). I added your code to wiki.<br>Few comments.<br>1. /BANNER mode presents in code beginning 06-25-2005, may be if-else parsing looks a bit ugly, but it works - sets modal = false.<br>2. 04-04-2007 wiki version sets hParent=NULL for banner mode only, I guess this is a corect way.<br>Please test wiki version. Just for possible proxy issues - latest files in zip should have Apr. 5 date.<br>And thank you again!</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">hbatista</span><br><span class="post-time small text-muted">5th April 2007 09:33 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Thanks Takhir,<br>for some reason when I click the most recent version of the wiki file, the zip I get has files with date 2006-03-04...<br>when clicking the revisions I get the expected file dates.<br><br>Will try later, maybe it's some cache thing?...</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">hbatista</span><br><span class="post-time small text-muted">5th April 2007 10:24 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Duh... browser cache... :)<br>Tried it, it's working fine!<br><br>Thanks again!</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">zbd</span><br><span class="post-time small text-muted">18th July 2007 02:57 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">I'm having some trouble using the AnimGif plugin.<br><br>I've managed to get the image onto my custom page, however, it isn't displaying properly, it kind of flashes bits here and there.<br><br>Has anyone else experienced this?<br>I've tried a couple of different gifs.<br>I've also tried a few versions of the plugin.<br><br>Here's some of the code I'm using.<br><br></p><pre>
<code><br>AnimGif::play /NOUNLOAD /VALIGN=CENTER /HWND=$HWNDPARENT "$EXEDIR\sample.gif"<br><br>!insertmacro MUI_INSTALLOPTIONS_DISPLAY "searching"<br><br>Sleep 2000<br>Sleep 2000<br>AnimGif::stop     ; terminates all<br>Sleep 1000<br></code>
</pre><br>
      <br>
      If I'm doing everything else properly, it may be that i'm using a WANSIS skin, it may be causing some problems.<br>
      <br>
      Any pointers much appreciated.
    </div>
    <hr>

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script type="text/javascript" src="../js/highlight.pack.js" async>
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]></script></body></html>