<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="description" content="How to &quot;recurse&quot; a project with so many subdirectories and files?"><title>How to "recurse" a project with so many subdirectories and files? - NSIS Forums</title><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script><link rel="preload" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css" as="style" onload="this.rel='stylesheet'"><link rel="preload" href="../css/style.css" as="style" onload="this.rel='stylesheet'"><noscript><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css"><link rel="stylesheet" href="../css/style.css"></noscript><script>!function(a){"use strict";var b=function(b,c,d){function e(a){return h.body?a():void setTimeout(function(){e(a)})}function f(){i.addEventListener&&i.removeEventListener("load",f),i.media=d||"all"}var g,h=a.document,i=h.createElement("link");if(c)g=c;else{var j=(h.body||h.getElementsByTagName("head")[0]).childNodes;g=j[j.length-1]}var k=h.styleSheets;i.rel="stylesheet",i.href=b,i.media="only x",e(function(){g.parentNode.insertBefore(i,c?g:g.nextSibling)});var l=function(a){for(var b=i.href,c=k.length;c--;)if(k[c].href===b)return a();setTimeout(function(){l(a)})};return i.addEventListener&&i.addEventListener("load",f),i.onloadcssdefined=l,l(f),i};"undefined"!=typeof exports?exports.loadCSS=b:a.loadCSS=b}("undefined"!=typeof global?global:this);!function(a){if(a.loadCSS){var b=loadCSS.relpreload={};if(b.support=function(){try{return a.document.createElement("link").relList.supports("preload")}catch(b){return!1}},b.poly=function(){for(var b=a.document.getElementsByTagName("link"),c=0;c<b.length;c++){var d=b[c];"preload"===d.rel&&"style"===d.getAttribute("as")&&(a.loadCSS(d.href,d,d.getAttribute("media")),d.rel=null)}},!b.support()){b.poly();var c=a.setInterval(b.poly,300);a.addEventListener&&a.addEventListener("load",function(){b.poly(),a.clearInterval(c)}),a.attachEvent&&a.attachEvent("onload",function(){a.clearInterval(c)})}}}(this);</script></head><body><div class="container"><ol class="breadcrumb"><li><a href="../index.html" class="glyphicon glyphicon-home"></a></li><li><a href="f-65.html">NSIS Discussion</a></li><li class="active">How to "recurse" a project with so many subdirectories and files?</li></ol><p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=139628">How to "recurse" a project with so many subdirectories and files?</a></p><br><div class="post"><p class="post-meta"><span class="post-author text-primary">vbgunz</span><br><span class="post-time small text-muted">20th June 2003 15:14 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>How to "recurse" a project with so many subdirectories and files?</strong><br>Currently I only use NSIS to configure 80 files but in comparison to INNO on the same 80 files, INNOs size weighs in at a wopping 600KB while NSIS weighs in at half that = 300KB.<br><br>I originally didn't wish to compile all files and folders in my project as INNO would end up at 46MB but if on a smaller scale NSIS is able to cut that size down to half then where possibly looking at an installation of about 23MB with NSIS (3MB better than WinRAR, 23 Better than INNO).<br><br>I've searched for how to include a sub-directory but unfortunately I came up empty except for this link <a href="http://nsis.sourceforge.net/archive/viewpage.php?pageid=270" target="_blank">http://nsis.sourceforge.net/archive/...php?pageid=270</a> but I think even this link is way off my topic...<br><br>Isn't there a really simple way to include a directory and all sub directories within it? I would really like to test and see if NSIS is able to dramatically cut down the whole setup size.<br><br>I tried a few things in which I cannot say exactly as I've tried them earlier before fully heading for a configuration installation only. But after a simple comparison so far, I am very curious if NSIS can possibly crush the size.<br><br>Thank you in advance. Thank you very much.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Sunjammer</span><br><span class="post-time small text-muted">20th June 2003 15:25 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Sure there is a simple way. The documentation for the <a href="http://nsis.sourceforge.net/Docs/Chapter4.html#4.9.1.5" target="_blank">File Instruction</a> says:-</p><blockquote>If the /r switch is used, files and directories are added recursively. If is no trailing wildcard (e.g. File /r C:\whatever\mydir), then the whole tree of mydir will go in $OUTDIR\mydir. To put it in $OUTDIR, use File /r C:\whatever\mydir\*.*</blockquote></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">vbgunz</span><br><span class="post-time small text-muted">20th June 2003 15:53 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Thank you Sunjammer,<br><br>I tried it and here is the results.<br><br>INNO 46MB<br>NSIS 42MB<br><br>Though their is only a 4MB difference their is no doubt a huge difference in the speed in which NSIS does its unpackaging.<br><br>INNO takes more than five minutes.<br>NSIS takes less than one minute.<br><br>This was tested on my 1.2GHz notebook. I didn't compare times to the exact second and it is just a rough estimate with as little exaggeration as possible.<br><br>Currently I use WinRAR to package up the beef of my project and bury NSIS inside of it which only takes care of the configuration files. Is their any tricks in getting NSIS to package lighter?<br><br>Just curious, thanks again in advance :)</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Joost Verburg</span><br><span class="post-time small text-muted">20th June 2003 16:05 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">You can use NSIS for the compression and the BZIP2 compression method.<br><br>If you include already compressed files, turn off the NSIS compression.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">vbgunz</span><br><span class="post-time small text-muted">25th June 2003 18:01 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Thank you Joost,<br><br>I just now applied the bZIP2 compression and here are the new results.<br><br>9,200 files average with a dry weight of 130MB.<br><br></p><pre>
<code>Inno 3.0.6.3   -  46MB Extracts at over 5 minutes<br>NSIS 2.0b4      -  33MB Extracts in under 1 minute</code>
</pre>It is pretty obvious NSIS is the winner hands down in these two fields. Is their anyway to tell NSIS which files not to compress (e.g. *.exe)?<br>
      <br>
      I am really trying to get the compression to right under 30MB or even 31MB as then that will match the WinRAR EXE feature with a recovery option of 10.<br>
      <br>
      BTW, Does NSIS have a recovery option? I noticed upon launching the 33MB file it did a verification which was really cool. I am really just curious if NSIS has a native and hidden option for recovery.<br>
      <br>
      Thank you Joost
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br>
      <span class="post-time small text-muted">25th June 2003 18:40 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">What about 7zip?<br>
      You would have to use the command-line 7zip program (<a href="http://www.7zip.org" target="_blank">www.7zip.org</a> (site is down :()) , there would be no extraction process, but it's a great compression method!<br>
      <br>
      -Stu</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">vbgunz</span><br>
      <span class="post-time small text-muted">25th June 2003 19:54 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">I knew about 7zip for a while and do agree it being great if not the best compression on the globe at the moment. I was hoping though, using just one EXE (NSIS) I can somehow crush my installation to its max.<br>
      <br>
      I believe I reached that threshold though with NSIS and here is a another comparison tested on a 1.2GHz, 512RAM, Athlon XP system.</p>
      <pre>
<code>Inno 3.0.6.3   -  46MB Extracts at over 5 minutes<br>NSIS 2.0b4     -  33MB Extracts in under 1 minute<br>7ZIP 2.30Beta  -  24MB Extracts in under 1 minute</code>
</pre>One thing which I didn't compare was the speeds in which all packages compress. Here is a rough estimate...
      <pre>
<code>Inno 3.0.6.3   -  9,200 Files 130MB compression takes 20 minutes<br>NSIS 2.0b4     -  9,200 Files 130MB Compression takes but a few minutes<br>7ZIP 2.30Beta  -  9,200 Files 130MB Compression takes 15 minutes</code>
</pre>Come to think about it and NSIS leads except in the fact its final compressed size is not as awesome as 7ZIP. It is obvious 7ZIP wins in the final compressed arena but is their a dark horse solution involving NSIS alone?<br>
      <br>
      Afrow UK, I like 7ZIP indeed I do but how would 7ZIP be applied with NSIS? Do I simply 7ZIP first and then wrap it with NSIS? Can NSIS pass parameters to 7ZIP and hide it from displaying? Can NSIS unwrap the 7ZIP directly as according to install?<br>
      <br>
      I would indeed like to save 9MB across the wire but can you offer me an idea about how best to make it look as NSIS as possible without putting 2 24MB files on the users system? (e.g NSIS extracts everything) and not another executable for the user to execute.<br>
      <br>
      Thank you Afrow UK, 7ZIP does sound like a good temporary solution until NSIS is able to conquer it. I look forward to reading your reply. Thanks again :)
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">n0On3</span><br>
      <span class="post-time small text-muted">25th June 2003 22:28 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">I remember kichik was working implementing 7zip to NSIS. But I remember he told us he had to manually rewrite all code to C.<br>
      <br>
      You can pack the 7zip uncompressor and execute it with nsEXEC so it won't show a dos window.<br>
      <br>
      So, you unpack the un7zipper and the .7z file to a temp folder and send with nsEXEC a command line. This would double the time (one minute to unpack the .7z file from nsis and another to un7zip it), but you'll have one single exe to give away :weird:<br>
      <br>
      btw, the website for 7zip is <a href="http://www.7-zip.org" target="_blank">www.7-zip.org</a>, I always forget the dash too.:rolleyes:</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br>
      <span class="post-time small text-muted">25th June 2003 23:04 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">lol thanks :)<br>
      I used the 7-zip command line app (7za) to make up just standard zip files for people that want to zip up their Quake2 D-Day maps and then upload them to the web.<br>
      I should have used a smaller command-line app, but it doesn't matter because the installer exe was still only 300kb<br>
      <br>
      If you would like to look at my app, it's here: <a href="http://dynamic.gamespy.com/~dday/ib3/ikonboard.cgi?s=3efa1a7a50bcffff;act=ST;f=2;t=983" target="_blank">http://dynamic.gamespy.com/~dday/ib3...t=ST;f=2;t=983</a><br>
      <br>
      -Stu</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">vbgunz</span><br>
      <span class="post-time small text-muted">26th June 2003 22:40 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">ok its official, I've 7zipped the meat of the package with "7za.exe" thanks Afrow UK and n0On3 and zlibbed it up with NSIS. Believe it or not it takes NSIS just "One Second" to extract it and the entire installer stills takes under one minute to finish on my machine.<br>
      <br>
      That is in a word breathtaking. My installer currently stands at 24MB instead of 33MB and still extracts just as fast. In another word, amazing.<br>
      <br>
      Just one question for you 7ZIP heads out there. 7za.exe is the right program which should run on most Window platforms correct?<br>
      <br>
      Thats it, I should be done with NSIS and am very happy with the outcome. Truly amazing. I will post my source back to NSIS as my project is open source anyway. Hopefully it can help others :)<br>
      <br>
      Thank you to everyone :)</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Joost Verburg</span><br>
      <span class="post-time small text-muted">27th June 2003 12:27 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Yep, 7-zip supports all Win32 versions.</p>
    </div>
    <hr>

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script type="text/javascript" src="../js/highlight.pack.js" async>
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]></script></body></html>