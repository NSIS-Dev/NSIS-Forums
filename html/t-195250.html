<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="description" content="Compiling NSIS 2.01 on Solaris"><title>Compiling NSIS 2.01 on Solaris - NSIS Forums</title><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script><link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css"><link rel="stylesheet" href="../css/style.css" type="text/css"><!--[if lt IE 9]><script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script><script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script><![endif]--></head><body><div class="container"><ol class="breadcrumb"><li><a href="../index.html" class="glyphicon glyphicon-home"></a></li><li><a href="f-65.html">NSIS Discussion</a></li><li class="active">Compiling NSIS 2.01 on Solaris</li></ol><p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=195250">Compiling NSIS 2.01 on Solaris</a></p><br><div class="post"><p class="post-meta"><span class="post-author text-primary">NichDieMama</span><br><span class="post-time small text-muted">1st October 2004 09:18 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>Compiling NSIS 2.01 on Solaris</strong><br>Hi!<br><br>Has anyone successfully compiled NSIS 2.01 on Solaris? I did compile it on Linux, but on Solaris I got lots of errors:<br><br>ld: Software Generation Utilities - Solaris Link Editors: 5.9-1.375<br>gmake -C exehead<br>ld: Software Generation Utilities - Solaris Link Editors: 5.9-1.375<br>gmake[1]: Entering directory `/hox/user/dspilker/src/NSIS/NSIS/Source/exehead'<br>gmake[1]: Nothing to be done for `all'.<br>gmake[1]: Leaving directory `/hox/user/dspilker/src/NSIS/NSIS/Source/exehead'<br>g++ -Wall -O3 -DCOMPRESS_MF_BT -c -o 7zGuids.o 7zip/7zGuids.cpp<br>gcc -Wall -O3 -DCOMPRESS_MF_BT -c -o bzlib.o bzip2/bzlib.c<br>g++ -Wall -O3 -DCOMPRESS_MF_BT -c -o CRC.o 7zip/Common/CRC.cpp<br>gcc -Wall -O3 -DCOMPRESS_MF_BT -c -o crc32.o crc32.c<br>g++ -Wall -O3 -DCOMPRESS_MF_BT -c -o DialogTemplate.o DialogTemplate.cpp<br>g++ -Wall -O3 -DCOMPRESS_MF_BT -c -o Alloc.o 7zip/Common/Alloc.cpp<br>g++ -Wall -O3 -DCOMPRESS_MF_BT -c -o makenssi.o makenssi.cpp<br>In file included from build.h:8,<br>from makenssi.cpp:43:<br>strlist.h: In method `void MMapFile::release()':<br>strlist.h:767: ANSI C++ forbids implicit conversion from `void *' in argument passing<br>strlist.h: In method `void MMapFile::release(void *, int)':<br>strlist.h:780: ANSI C++ forbids implicit conversion from `void *' in argument passing<br>strlist.h: In method `void MMapFile::flush(int)':<br>strlist.h:790: ANSI C++ forbids implicit conversion from `void *' in argument passing<br>In file included from build.h:30,<br>from makenssi.cpp:43:<br>clzma.h: In method `HANDLE CLZMA::CreateEvent(void *, int, int, char *)':<br>clzma.h:64: implicit declaration of function `int pthread_cond_init(...)'<br>clzma.h:69: implicit declaration of function `int pthread_mutex_init(...)'<br>clzma.h: In method `BOOL CLZMA::SetEvent(long unsigned int)':<br>clzma.h:81: implicit declaration of function `int pthread_mutex_lock(...)'<br>clzma.h:84: implicit declaration of function `int pthread_cond_signal(...)'<br>clzma.h:85: implicit declaration of function `int pthread_mutex_unlock(...)'<br>clzma.h: In method `BOOL CLZMA::CloseHandle(long unsigned int)':<br>clzma.h:103: implicit declaration of function `int pthread_cond_destroy(...)'<br>clzma.h:105: implicit declaration of function `int pthread_mutex_destroy(...)'<br>clzma.h: In method `DWORD CLZMA::WaitForSingleObject(long unsigned int, long unsigned int)':<br>clzma.h:118: `PTHREAD_MUTEX_INITIALIZER' undeclared (first use this function)<br>clzma.h:118: (Each undeclared identifier is reported only once<br>clzma.h:118: for each function it appears in.)<br>clzma.h:119: implicit declaration of function `int pthread_cond_wait(...)'<br>clzma.h: In method `int CLZMA::End()':<br>clzma.h:245: implicit declaration of function `int pthread_join(...)'<br>clzma.h: In method `int CLZMA::Compress(int)':<br>clzma.h:319: implicit declaration of function `int pthread_create(...)'<br>gmake: *** [makenssi.o] Error 1</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">kichik</span><br><span class="post-time small text-muted">1st October 2004 12:19 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">For the pthread errors, add #include &lt;pthread.h&gt; on the top of clzma.h.<br><br>I have tried to reproduce the other error on three different solaris computers, but none showed that error. Can you attach (don't copy and paste, it might be very large) the output of `man munmap`?</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">NichDieMama</span><br><span class="post-time small text-muted">1st October 2004 13:06 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Hi!<br><br>Thanks for your quick reply. I did that include and came to the munmap problem. I had a look at mmap.h and casted the first argument to caddr_t which seems to work fine. I attached my 'man munmap' nevertheless plus mmap.h. Now I am running into a problem in script.cpp:<br><br>ld: Software Generation Utilities - Solaris Link Editors: 5.9-1.375<br>gmake -C exehead<br>ld: Software Generation Utilities - Solaris Link Editors: 5.9-1.375<br>gmake[1]: Entering directory `/hox/user/dspilker/src/NSIS/NSIS/Source/exehead'<br>gmake[1]: Nothing to be done for `all'.<br>gmake[1]: Leaving directory `/hox/user/dspilker/src/NSIS/NSIS/Source/exehead'<br>g++ -Wall -O3 -DCOMPRESS_MF_BT -c -o 7zGuids.o 7zip/7zGuids.cpp<br>gcc -Wall -O3 -DCOMPRESS_MF_BT -c -o blocksort.o bzip2/blocksort.c<br>g++ -Wall -O3 -DCOMPRESS_MF_BT -c -o build.o build.cpp<br>gcc -Wall -O3 -DCOMPRESS_MF_BT -c -o bzlib.o bzip2/bzlib.c<br>gcc -Wall -O3 -DCOMPRESS_MF_BT -c -o compress.o bzip2/compress.c<br>g++ -Wall -O3 -DCOMPRESS_MF_BT -c -o CRC.o 7zip/Common/CRC.cpp<br>gcc -Wall -O3 -DCOMPRESS_MF_BT -c -o crc32.o crc32.c<br>gcc -Wall -O3 -DCOMPRESS_MF_BT -c -o deflate.o zlib/deflate.c<br>g++ -Wall -O3 -DCOMPRESS_MF_BT -c -o DialogTemplate.o DialogTemplate.cpp<br>g++ -Wall -O3 -DCOMPRESS_MF_BT -c -o exedata.o exedata.cpp<br>gcc -Wall -O3 -DCOMPRESS_MF_BT -c -o huffman.o bzip2/huffman.c<br>g++ -Wall -O3 -DCOMPRESS_MF_BT -c -o lang.o lang.cpp<br>g++ -Wall -O3 -DCOMPRESS_MF_BT -c -o LZInWindow.o 7zip/7zip/Compress/LZ/LZInWindow.cpp<br>g++ -Wall -O3 -DCOMPRESS_MF_BT -c -o LZMAEncoder.o 7zip/7zip/Compress/LZMA/LZMAEncoder.cpp<br>g++ -Wall -O3 -DCOMPRESS_MF_BT -c -o Alloc.o 7zip/Common/Alloc.cpp<br>g++ -Wall -O3 -DCOMPRESS_MF_BT -c -o makenssi.o makenssi.cpp<br>g++ -Wall -O3 -DCOMPRESS_MF_BT -c -o OutBuffer.o 7zip/7zip/Common/OutBuffer.cpp<br>g++ -Wall -O3 -DCOMPRESS_MF_BT -c -o Plugins.o Plugins.cpp<br>g++ -Wall -O3 -DCOMPRESS_MF_BT -c -o RangeCoderBit.o 7zip/7zip/Compress/RangeCoder/RangeCoderBit.cpp<br>g++ -Wall -O3 -DCOMPRESS_MF_BT -c -o ResourceEditor.o ResourceEditor.cpp<br>g++ -Wall -O3 -DCOMPRESS_MF_BT -c -o ResourceVersionInfo.o ResourceVersionInfo.cpp<br>g++ -Wall -O3 -DCOMPRESS_MF_BT -c -o script.o script.cpp<br>script.cpp: In method `char * CEXEBuild::set_timestamp_predefine(char *)':<br>script.cpp:87: implicit declaration of function `int ctime_r(...)'<br>gmake: *** [script.o] Error 1</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">kichik</span><br><span class="post-time small text-muted">1st October 2004 13:21 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">ctime_r is defined in time.h which is already included. ctime_r conforms with POSIX.1 (1996), so it's a pretty basic function that should be in any POSIX compliant platform. But I guess I could convert it to ctime which is defined in ANSI-C. Try replacing that block of code with:</p><pre>
<code>definedlist.add("__TIMESTAMP__",ctime(&amp;st.st_mtime));</code>
</pre>As for munmap, is there any define that can be checked so caddr_t can be used?</div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">NichDieMama</span><br><span class="post-time small text-muted">1st October 2004 17:19 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Hi!<br><br>Thanks! Your code did it. Since I am a Java programmer I do not have that much clue about C or C++ programming. The functions with the caddr_t argument are defined in the else part of an #if (_POSIX_C_SOURCE &gt; 2) || defined(_XPG4_2). I am not sure which values are hold by those variables.<br><br>I had to remove the -Wl option in LDFLAGS to make the linker happy. But when running makensis, it core dumped. Any ideas? Could you compile and link it successfully? Which gcc version are you using?<br><br>MakeNSIS v2.01 - Copyright 1999-2004 Nullsoft, Inc.<br><br>Portions Copyright (C) 1995-1998 Jean-loup Gailly and Mark Adler (zlib).<br>Portions Copyright (C) 1996-2002 Julian R Seward (bzip2).<br>Portions Copyright (C) 1999-2003 Igor Pavlov (lzma).<br><br>Contributors: nnop@newmail.ru, Ryan Geiss, Andras Varga, Drew Davidson, Peter Windridge, Dave Laundon, Robert Rainwater, Yaroslav Faybishenko, Jeff Doozan, Amir Szekely, Ximon Eighteen, et al.<br><br>Processing config:<br>Processing plugin dlls: "/hox/user/appbuild/opt/thirdparty/nullsoft/nsis/Plugins/*.dll"<br>Segmentation Fault (core dumped)</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">kichik</span><br><span class="post-time small text-muted">1st October 2004 17:30 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Looks like the big endian problem... Are you using Sparc? According to <a href="http://mindprod.com/jgloss/endian.html" target="_blank">this</a> page, Sparc has a little endian mode. Try looking for little endian switch for gcc.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">NichDieMama</span><br><span class="post-time small text-muted">2nd October 2004 14:57 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Hi!<br><br>My gcc does not support -mlittle-endian for Sparc CPUs. I tried -D__LITTLE_ENDIAN__ and/or -D__LITTLE_ENDIAN_DATA__ which showed not effect. I also tried -m32 and -m64 which also didn't help. Further ideas?</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">kichik</span><br><span class="post-time small text-muted">2nd October 2004 15:01 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Are you running on 32 or 64 bit Sparc?</p></div><hr><div class="footer"><p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p></div></div><script src="../js/highlight.pack.js" type="text/javascript"></script><script type="text/javascript">//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]></script></body></html>