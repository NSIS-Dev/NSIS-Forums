<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="WriteRegStr ignored in script" />

  <title>WriteRegStr ignored in script - NSIS Forums</title>
  <script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script>
  <!-- Bootstrap core CSS -->

  <link rel="stylesheet" type="text/css" href="//netdna.bootstrapcdn.com/bootswatch/3.0.1/readable/bootstrap.min.css" />
  <link rel="stylesheet" href="../css/style.css" type="text/css" /><!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!--[if lt IE 9]>
                <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
                <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->
</head>

<body>
  <div class="container">
    <!-- Put navigation bar here -->

    <ol class="breadcrumb">
      <li><a href="../index.html" class="glyphicon glyphicon-home"></a></li>

      <li><a href="f-65.html">NSIS Discussion</a></li>

      <li class="active">WriteRegStr ignored in script</li>
    </ol>

    <p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=342621">WriteRegStr ignored in script</a></p><br />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">jbillen</span><br />
      <span class="post-time small text-muted">25th February 2012 06:54 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>WriteRegStr ignored in script</strong><br />
      I have several sections similar to below. The command WriteReg used to work (as I see using Regedit), but the script, which compiles successfully, now seems to ignore these lines. Is there something that would prevent writing to the Registry. I'm logged in as an administrator and can edit the Registry using .reg files or Regedit.<br />
      <br />
      <br />
      Section ""<br />
      WriteRegStr HKCR "QKPfile" "" "Quikplot input"<br />
      WriteRegStr HKCR "QKPfile\Shell" "" ""<br />
      WriteRegStr HKCR "QKPfile\Shell\Print" "" ""<br />
      WriteRegStr HKCR "QKPfile\Shell\Print\command" "" 'Notepad.exe /p "%1"'<br />
      WriteRegStr HKCR "QKPfile\Shell\Open" "" ""<br />
      WriteRegStr HKCR "QKPfile\Shell\Open\command" "" '$INSTDIR\Quikplot.exe "%1"'<br />
      WriteRegStr HKCR "QKPfile\Shell\Edit" "" ""<br />
      WriteRegStr HKCR "QKPfile\Shell\Edit\command" "" 'Notepad.exe "%1"'<br />
      WriteRegStr HKCR ".QKP" "AlwaysShowExt" ""<br />
      WriteRegStr HKCR ".QKP" "" "QKPfile"<br />
      SectionEnd</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Anders</span><br />
      <span class="post-time small text-muted">25th February 2012 08:46 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Why would it ignore the lines?<br />
      <br />
      Is this 64 bit windows? Either way, fire up Process Monitor and try to figure out the problem...<br />
      <br />
      ...also<br />
      * The verbs should not have empty strings, set a string or don't write anything at all<br />
      * '$INSTDIR\Quikplot.exe "%1"' should be '"$INSTDIR\Quikplot.exe" "%1"'<br />
      * Why are you setting AlwaysShowExt? Respect the users settings please...</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">jbillen</span><br />
      <span class="post-time small text-muted">25th February 2012 18:55 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Is s 64-bit Windows, but I don't think that should be a problem because it did work at one time. I'll take your advice about the AlwaysShowExt. Thanks for tip on Process Manager. I don't understand your first bullet.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">jbillen</span><br />
      <span class="post-time small text-muted">25th February 2012 20:45 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">I downloaded Process Monitor (not Manager as mentioned earlier) from CNET and ran the installer made from the script. Some of the WriteRegStr commands result is "SUCCESS", but RegCreateKey commands say "ACCESS DENIED Desired Access: Set Value". The RegQueryKey commands result in "SUCCESS."<br />
      <br />
      There are some other Registry command evidently generated by the installer that say, for example "RegOpenKey HKCU\Software\Classes\QKPfile\Shell\Open NAME NOT FOUND Desired Access: Maximum Allowed". I am not sure if this is important.<br />
      <br />
      Why when logged in as an administrator should I see ACCESS DENIED?</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Anders</span><br />
      <span class="post-time small text-muted">25th February 2012 21:45 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Do you have "RequestExecutionLevel admin" in your script?<br />
      RegCreateKey should not fail. Try deleting the key in regedit...<br />
      <br />
      Don't do WriteRegStr HKCR "QKPfile\Shell\Open" "" "" etc</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">jbillen</span><br />
      <span class="post-time small text-muted">25th February 2012 23:28 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">That's how I was testing the script: first delete the key in regedit. The "RequestExecutionLevel admin" statement solved the problem. Thanks a lot for the help.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Anders</span><br />
      <span class="post-time small text-muted">26th February 2012 07:50 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Well then you did not run as admin before (Maybe you need to read about UAC on MSDN)<br />
      <br />
      You should use <a href="http://pastebin.com/EvMkyLLt" target="_blank">http://pastebin.com/EvMkyLLt</a> to make sure.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">jbillen</span><br />
      <span class="post-time small text-muted">26th February 2012 19:19 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">I saw the script in the link you supplied and I read about UAC is Wikipedia. I see why the statement "RequestExecutionLevel admin" is needed.<br />
      <br />
      I started using NSIS just recently after using InstallShield for a long time, so I probably have quite a few things to learn. For one, I do not see how to access this message from the forums/winamp.com homepage without searching for something in the post. I was only able to start the original post by clicking on a link in one of kichik's replys. I would appreciate it if you could point me in right direction.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Anders</span><br />
      <span class="post-time small text-muted">26th February 2012 19:35 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><a href="http://forums.winamp.com/" target="_blank">http://forums.winamp.com/</a> scroll down to "Developer Center" and click "NSIS Discussion" but I just type "nsis forum" in the addressbar and firefox+google does the rest...</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">jbillen</span><br />
      <span class="post-time small text-muted">26th February 2012 19:55 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Thanks. That will keep me from stumbling around...</p>
    </div>
    <hr />

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]>
  </script>
</body>
</html>
