<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="library.nsh on Posix without cross-tools" />

  <title>library.nsh on Posix without cross-tools - NSIS Forums</title><!-- Bootstrap core CSS -->
  <link rel="stylesheet" type="text/css" href="//netdna.bootstrapcdn.com/bootswatch/3.0.1/readable/bootstrap.min.css" />
  <link rel="stylesheet" href="../css/style.css" type="text/css" /><!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!--[if lt IE 9]>
                <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
                <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->
</head>

<body>
  <div class="container">
    <!-- Put navigation bar here -->

    <ol class="breadcrumb">
      <li><a href="../index.html" class="glyphicon glyphicon-home"></a></li>

      <li><a href="f-65.html">NSIS Discussion</a></li>

      <li class="active">library.nsh on Posix without cross-tools</li>
    </ol>

    <p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=315820">library.nsh on Posix without cross-tools</a></p><br />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">vtsaran</span><br />
      <span class="post-time small text-muted">29th December 2009 08:05 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>library.nsh on Posix without cross-tools</strong><br />
      Hello all,<br />
      Perhaps I do not how to search, but I could not find anywhere an answer to my question (pretty strange, I admit). :)<br />
      <br />
      I am trying to compile an NSIS script that utilizes library.nsh header with installlib macros on a Posix system using the previously-compiled and working 2.45 version of "makensis". For reasons beyond my control I do not use cross compiler, eg mingw, or any other similar tools.<br />
      Prior to my using library.nsh in my installation script, I was able to successfully compile by simply skipping all the plugins, utilities etc (skipplugins, skiputils etc). However, since I started using installlib macros, my compilation fails with references to minor_version and major_version calls. I know that Appendix that describes the library says that DLL version checkes are required in order for the header to compile, but I am wondering if there is any work-around for this limitation on Posix systems (I use CentOS if that matters).<br />
      Also, I can successfully compile the script on Windows, so I know it is working fine.<br />
      <br />
      Again, I am using NSIS 2.45.<br />
      <br />
      Any advice would be much appreciated.<br />
      Vic</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
      <span class="post-time small text-muted">29th December 2009 10:34 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">I am a bit confused. You are talking both about compiling a script and compiling makensis in the same context. I'll assume MINOR|MAJOR_VESRION you're missing is when building LibraryLocal.exe that's used by Library.nsh.<br />
      <br />
      First off, it's no shame not to use cross compiler. It's even preferable. Build only what needs to be built native to work, and use the pre-built zip for everything else. It's always smaller, faster and better tested.<br />
      <br />
      Next, I don't know how exactly you got errors about missing version definition and I won't know without seeing the error itself. That said, simply pass the version information to avoid it.</p>
      <pre>
<code>scons VERSION=2.46 VER_MAJOR=2 VER_MINOR=46 VER_REVISION=0 VER_BUILD=0 SKIP...</code>
</pre>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">vtsaran</span><br />
      <span class="post-time small text-muted">29th December 2009 21:24 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Hi,<br />
      Apologies for confusing you and everyone else. Indeed, I am trying to recompile the "makensis" file so that I can compile the .nsi script which utilizes library.nsh header.<br />
      <br />
      When I attempt to compile the script with my current version of "makensis" (version 2.45), this is what I get:<br />
      <br />
      sh: LibraryLocal: command not found<br />
      warning: unknown variable/constant "{LIBRARY_VERSION_HIGH}" detected, ignoring (<br />
      macro:InstallLib:120)<br />
      warning: unknown variable/constant "{LIBRARY_VERSION_LOW}" detected, ignoring (m<br />
      acro:InstallLib:121)<br />
      !undef: "LIBRARY_VERSION_HIGH" not defined!<br />
      Error in macro InstallLib on macroline 125<br />
      <br />
      I tried recompiling the "makensis" passing version, version_major, version_minor, version_rev etc constants to the scons, but this did not help any.<br />
      <br />
      Am I missing the LibraryLocal component?<br />
      <br />
      I am a bit lost, so any pointers would be much appreciated.<br />
      <br />
      Thanks,<br />
      Vic</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">vtsaran</span><br />
      <span class="post-time small text-muted">29th December 2009 23:56 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Disregard my previous message. After an extensive search in the forums, I found that one has to compile the LibraryLocal using scons with a "LibraryLocal" target. Afterwards, copy "LibraryLocal" from your build/release/LibraryLocal folder into /usr/bin or wherever convenient.<br />
      <br />
      All seems to work now.<br />
      Vic</p>
    </div>
    <hr />

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]>
  </script>
</body>
</html>
