<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="Finding WA3 and closing prob." />

  <title>Finding WA3 and closing prob. - NSIS Forums</title><!-- Bootstrap core CSS -->
  <link rel="stylesheet" type="text/css" href="//netdna.bootstrapcdn.com/bootswatch/3.0.1/readable/bootstrap.min.css" />
  <link rel="stylesheet" href="../css/style.css" type="text/css" /><!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!--[if lt IE 9]>
                <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
                <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->
</head>

<body>
  <div class="container">
    <!-- Put navigation bar here -->

    <ol class="breadcrumb">
      <li><a href="../index.html" class="glyphicon glyphicon-home"></a></li>

      <li><a href="f-65.html">NSIS Discussion</a></li>

      <li class="active">Finding WA3 and closing prob.</li>
    </ol>

    <p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=87330">Finding WA3 and closing prob.</a></p><br />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">bballer182</span><br />
      <span class="post-time small text-muted">10th May 2002 17:00 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>Finding WA3 and closing prob.</strong><br />
      OK I have found the function for closing WA 1.x and 2.x, and it works fine for closing those apps. But my problem is that when i was using NSIS 1.97 and the function above i was also closing WA3 which is what i wanted it to do, so thats fine, but when i recompiled all of my scripts with 1.98, and it gets to the install screen it freezes it WA3 is running. When i close WA3 it will continue the install just fine.<br />
      <br />
      So what i was wondering is if the was code floating out there that could close WA3 also. Or is that all i have to do is create a new function with the WA3 window name, to close it.<br />
      <br />
      <br />
      please help me.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Smile2Me</span><br />
      <span class="post-time small text-muted">10th May 2002 18:02 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>Re: Finding WA3 and closing prob.</strong><br /></p>

      <blockquote>
        <i>Originally posted by bballer182</i><br />
        <b>Or is that all i have to do is create a new function with the WA3 window name, to close it.</b>
      </blockquote>I guess that's it! Just in the same way to close any program: FindWindow, SendMessage routine.<br />
      <br />
      Good luck,<br />
      -Hendri.
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">bballer182</span><br />
      <span class="post-time small text-muted">12th May 2002 01:15 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">the problem is i don't know how to do it. I don't even know the WA3 window name is?</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Smile2Me</span><br />
      <span class="post-time small text-muted">12th May 2002 09:47 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">You should use some spy software to find out.<br />
      <br />
      -Hendri.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">bballer182</span><br />
      <span class="post-time small text-muted">15th May 2002 02:17 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">OK i figured out the problem using Nocarr's(thanks dude) little utility to find the window name, and it works fine when WA3 isn't minimized in the systray.<br />
      <br />
      Is there a way to close a proccess? Because WA3 is listed as a process in the task manager.<br />
      <br />
      If you want it check it out in my sig.<br />
      <br />
      -justin</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">bballer182</span><br />
      <span class="post-time small text-muted">17th May 2002 03:18 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>HELP ME PLEASE!!!</strong><br />
      HELP ME PLEASE<br />
      <br />
      <br />
      Is there a way to close a proccess? Because WA3 is listed as a process in the task manager.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">bballer182</span><br />
      <span class="post-time small text-muted">22nd May 2002 02:17 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Smile2Me do you know?</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
      <span class="post-time small text-muted">22nd May 2002 12:25 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">You can always use TerminateProcess, but something tells me there is a better way to do this...<br />
      How about searching for the main WindowProc and sending it WM_CLOSE, WM_CLOSE, or WM_COMMAND pretending to be a menu command of exit?<br />
      <br />
      Doesn't WA3 SDK say anything about this?</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">bballer182</span><br />
      <span class="post-time small text-muted">22nd May 2002 16:46 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"></p>

      <blockquote>
        <i>Originally posted by kichik</i><br />
        <b><br />
        How about searching for the main WindowProc and sending it WM_CLOSE, WM_CLOSE, or WM_COMMAND pretending to be a menu command of exit?<br />
        <br />
        Doesn't WA3 SDK say anything about this?</b>
      </blockquote>Thats a good idea; sending a menu command of exit. I'll try. :winamp: ;) :) :D :cool:
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">bballer182</span><br />
      <span class="post-time small text-muted">22nd May 2002 22:31 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">One problem with that is that i don't know how to work the sdk, i don't even know c++ or basic or anything. The only language that i know is English, NSIS, and a tiny bit of HTML.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Smile2Me</span><br />
      <span class="post-time small text-muted">23rd May 2002 09:48 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Sorry, I don't know how to kill a process in the SysTray. Check MSDN for this. Sorry, I do not have time for this. If you find something that might be useful, post it and maybe some of us can help you program it into a dll or exe.<br />
      <br />
      Sorry for my late reply. I forgot to check this thread.<br />
      <br />
      Good luck,<br />
      -Hendri.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">bballer182</span><br />
      <span class="post-time small text-muted">24th May 2002 05:08 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">OK i found the page your probably looking for but this is an app to shut it down. I hope this is what your looking for<br />
      <br />
      <a href="http://msdn.microsoft.com/library/default.asp?url=/library/en-us/vbcon/html/vbwlkWalkthroughManagingNTProcesses.asp" target="_blank">http://msdn.microsoft.com/library/de...TProcesses.asp</a></p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">bballer182</span><br />
      <span class="post-time small text-muted">25th May 2002 06:16 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Wow i can't belive how active this forum is. I can remember about 6 months ago when a person could post something and about a week later some one might have passed over the forum to answer the question. so i have to move this back to the top so it can get read again.<br />
      <br />
      I think this is the place but i have no idea what to do with it.<br />
      <br />
      <a href="http://msdn.microsoft.com/library/default.asp?url=/library/en-us/vbcon/html/vbwlkWalkthroughManagingNTProcesses.asp" target="_blank">http://msdn.microsoft.com/library/de...TProcesses.asp</a></p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
      <span class="post-time small text-muted">25th May 2002 10:56 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">If you insist... I thought someone will give you the correct answer by now, but if you insist I will give you my answer which I am not so sure about.<br />
      <br />
      Option 1: Call TerminateProcess - Very brutal and unwanted. Only possible with an extension DLL or a change to NSIS code.<br />
      Option 2: Find the main window of Winamp 3 and destroy it - The more welcomed way, but harder. The main window of Winamp 3 could not be found with the utility above, you need Spy for it to show you all of the windows and their classes. Just open up spy and list all available windows and search for windows of Winamp 3 and try closing them one by one until one closes the Winamp 3 process as well. There must be a better way to find it but I don't know about one.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">bballer182</span><br />
      <span class="post-time small text-muted">27th May 2002 03:06 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">To Justin<br />
      <br />
      This sounds like a good idea to add KillWinProcess or KillProcess because some apps (WA3) when in the minmized mode do not have windows.<br />
      <br />
      I will also ask over at the Winamp 3 discussion Forum. to see if anyone there has any ideas.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">X-Fixer</span><br />
      <span class="post-time small text-muted">27th May 2002 05:30 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">I have no problems with the following code:<br /></p>
      <pre>
<code><br />Name "Kill WA3"<br />AllowRootDirInstall false<br />OutFile "wa3kill.exe"<br />Caption "WA3 Killer"<br />ShowInstDetails show<br /><br />Function KillWA3<br />    FindWindow $0 "STUDIO"<br />    IsWindow $0 Found<br />    DetailPrint "WinAmp3 is not running."<br />    goto Done<br />Found:<br />    SendMessage $0 16 0 0<br />    DetailPrint $0<br />Done:<br />FunctionEnd<br /><br />Section "crap"<br />    Call KillWA3<br />SectionEnd<br /></code>
</pre><br />
      <br />
      It closes 1 instance of Winamp3, even if it's minimized.<br />
      <br />
      Issues figured out while coding.<br />
      1. NSIS understands WM_CLOSES but has it equal to 0.<br />
      2. Winamp3 windows ignore WM_DESTROY and WM_QUIT.<br />
      3. Winamp3 does not destroy it's windows on minimize (so they are still here), but their order is changed, so FindWindow returns handle not to the main window (this window ignore WM_CLOSE, so if you make loop like in functions.html your installer will freeze). So you can search by title (but this will only work for some specific beta). Also, FindWindow with wildcards would be cool.
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">bballer182</span><br />
      <span class="post-time small text-muted">27th May 2002 06:49 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Thank you my friend!:D :) That worked like a champ!<br />
      <br />
      I still think i maybe useful to have KillProcess in NSIS.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">X-Fixer</span><br />
      <span class="post-time small text-muted">27th May 2002 08:24 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"></p>

      <blockquote>
        <i>Originally posted by bballer182</i><br />
        <b>I still think i maybe useful to have KillProcess in NSIS.</b>
      </blockquote>WinAPI function TerminateProcess() is very bad and suggested only as the last chance to close application (e.g. it doesn't respond to messages, or "softly" hanged). I will prefer EnumWindows and FindWindow with wildcards. Though it's pretty easy to add KillProcess and some GetProcess() functions to NSIS.
    </div>
    <hr />

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]>
  </script>
</body>
</html>
