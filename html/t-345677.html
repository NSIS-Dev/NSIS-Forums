<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="Adapt the manifest of the setup application" />

  <title>Adapt the manifest of the setup application - NSIS Forums</title><!-- Bootstrap core CSS -->
  <link rel="stylesheet" type="text/css" href="//netdna.bootstrapcdn.com/bootswatch/3.0.1/readable/bootstrap.min.css" />
  <link rel="stylesheet" href="../css/style.css" type="text/css" /><!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!--[if lt IE 9]>
                <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
                <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->
</head>

<body>
  <div class="container">
    <!-- Put navigation bar here -->

    <ol class="breadcrumb">
      <li><a href="../index.html" class="glyphicon glyphicon-home"></a></li>

      <li><a href="f-65.html">NSIS Discussion</a></li>

      <li class="active">Adapt the manifest of the setup application</li>
    </ol>

    <p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=345677">Adapt the manifest of the setup application</a></p><br />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">SunToo</span><br />
      <span class="post-time small text-muted">20th June 2012 07:55 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>Adapt the manifest of the setup application</strong><br />
      Hi,<br />
      is there any way to adapt the manifest of a setup application created by NSIS?<br />
      <br />
      I would like to extend the manifest with an additional element of type<br />
      <br />
      &lt;supportedOS Id="{...}"&gt; to support Windows 8.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Anders</span><br />
      <span class="post-time small text-muted">20th June 2012 21:51 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">You could probably use resource hacker and !packhdr but I don't think there is any point, Win7 compatibility should be enough...</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Anders</span><br />
      <span class="post-time small text-muted">21st June 2012 00:36 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><a href="http://msdn.microsoft.com/en-us/library/windows/desktop/dd371711%28v=vs.85%29.aspx" target="_blank">Win7</a><br />
      <a href="http://msdn.microsoft.com/en-us/library/windows/desktop/hh848036%28v=vs.85%29.aspx" target="_blank">Win8</a><br />
      <br />
      The only reason we added the Win7 guid to the manifest is for PCA.<br />
      The Win8 guid will change the IShellLink interface we use to create shortcuts so we would have to think about possible compatibility issues. The only benefit is theme support in high contrast mode, not a big deal IMHO.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">SunToo</span><br />
      <span class="post-time small text-muted">26th June 2012 12:59 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Hi Anders,<br />
      <br />
      thank you for your help. Your solution works great. There's just one disadvantage: The size of the resulting setup executable increased considerable (I used UPX for compression and tried different options).<br />
      <br />
      Regarding the required manifest support for Windows 8 I disagree. The PCA is involved if the manifest doesn't contain the supportedOS key for Windows 8. And in that case there are a lot of situations that cause the PCA to show an error dialog or just to change the behavior of your app (see <a href="http://msdn.microsoft.com/library/hh848074(v=vs.85).aspx" target="_blank">http://msdn.microsoft.com/library/hh...(v=vs.85).aspx</a>). E.g., if the PCA detects that your setup checks the OS versions, shows a message box and aborts it informs the user that a problem occurred because Microsoft has the opinion a program should never abort because of the OS version. I could reproduce such a behavior. But in the monitored case the message box and the termination had nothing to do with the OS check performed before. Fortunately I could see that the PCA is involved. But in many cases the PCA changes the app behavior silently.<br />
      So I think it is a good idea to upgrade the manifest.</p>
    </div>
    <hr />

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]>
  </script>
</body>
</html>
