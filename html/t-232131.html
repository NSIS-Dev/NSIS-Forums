<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="Detect pending reboot" />

  <title>Detect pending reboot - NSIS Forums</title>
  <script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script>
  <!-- Bootstrap core CSS -->

  <link rel="stylesheet" type="text/css" href="//netdna.bootstrapcdn.com/bootswatch/3.0.1/readable/bootstrap.min.css" />
  <link rel="stylesheet" href="../css/style.css" type="text/css" /><!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!--[if lt IE 9]>
                <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
                <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->
</head>

<body>
  <div class="container">
    <!-- Put navigation bar here -->

    <ol class="breadcrumb">
      <li><a href="../index.html" class="glyphicon glyphicon-home"></a></li>

      <li><a href="f-65.html">NSIS Discussion</a></li>

      <li class="active">Detect pending reboot</li>
    </ol>

    <p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=232131">Detect pending reboot</a></p><br />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">musachy</span><br />
      <span class="post-time small text-muted">28th November 2005 22:00 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>Detect pending reboot</strong><br />
      I have a setup that removes a previous installation of itself and installs again. So the scenario is this, you run the setup, it detects/uninstalls the previous installation, but it needs to reboot, even selecting "Reboot Now", it does not reboot, and goes on with the installation of the new one. Is there any way to avoid this, or detect a pending reboot from one setup to another?</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">robotmp3</span><br />
      <span class="post-time small text-muted">29th November 2005 09:55 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Probably check rebootflag<br />
      From Help:<br />
      <br />
      IfRebootFlag 0 noreboot<br />
      MessageBox MB_YESNO "A reboot is required to finish the installation. Do you wish to reboot now?" IDNO noreboot<br />
      Reboot<br />
      noreboot:</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">musachy</span><br />
      <span class="post-time small text-muted">29th November 2005 14:10 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">That was the first thing I tried, it didn't detect that a reboot was pending.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">smatte</span><br />
      <span class="post-time small text-muted">29th November 2005 17:03 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">If you use an other exe to uninstall the previous installation, you'll need to create a file in your uninstaller or a registry key to tell your installer that a reboot is needed.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">goldy1064</span><br />
      <span class="post-time small text-muted">29th November 2005 17:05 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Just try creating a value in the RunOnce key, this way it will be removed after the reboot and if you check for it after your uninstaller runs, you'll be fine.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">musachy</span><br />
      <span class="post-time small text-muted">29th November 2005 18:27 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Writing a key to RunOnce is a good solution for me, it seems like it is working. Thanks!</p>
    </div>
    <hr />

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]>
  </script>
</body>
</html>
