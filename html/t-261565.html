<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="InstallLib problem/query/issue" />

  <title>InstallLib problem/query/issue - NSIS Forums</title><!-- Bootstrap core CSS -->
  <link rel="stylesheet" type="text/css" href="//netdna.bootstrapcdn.com/bootswatch/3.0.1/readable/bootstrap.min.css" />
  <link rel="stylesheet" href="../css/style.css" type="text/css" /><!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!--[if lt IE 9]>
                <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
                <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->
</head>

<body>
  <div class="container">
    <!-- Put navigation bar here -->

    <ol class="breadcrumb">
      <li><a href="../index.html" class="glyphicon glyphicon-home"></a></li>

      <li><a href="f-65.html">NSIS Discussion</a></li>

      <li class="active">InstallLib problem/query/issue</li>
    </ol>

    <p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=261565">InstallLib problem/query/issue</a></p><br />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">cpeel2300</span><br />
      <span class="post-time small text-muted">11th December 2006 15:54 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>InstallLib problem/query/issue</strong><br />
      Hi all - long time NSIS user, first time poster...<br />
      <br />
      I have query regarding the InstallLib macro which is causing me some problems. I have an installer which simply copies and registers a number of ActiveX DLLs, TLBs and various other bits and pieces.<br />
      <br />
      Everything works fine if no applications have any of the DLLs locked, however things seem to go wrong if even one of the DLLs is in use. I've only just noticed this as I've just put together version 3.0 of the installer and new DLLs which can't already be on the user's PC were being copied but weren't being registered.<br />
      <br />
      I'm no NSIS guru so taking a look at Library.nsh didn't really help but it seems that the macro simply adds _all_ files to the NSIS.Library.RegTool.v2 registry key once any one of them fails.<br />
      <br />
      Is this by design? It's causing me a lot of problems as I'm happy for the user to have to reboot if DLL's A, B and C are already installed and in use but it's frustrating to make them reboot when new DLLs X and Y are installed and can't have already been in use.<br />
      <br />
      Would really appreciate some help on this one!<br />
      <br />
      Thanks in advance<br />
      <br />
      Chris</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
      <span class="post-time small text-muted">12th December 2006 18:37 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">It's by design, in case the DLL files depend on each other. If B depends on A but A is to be replaced at reboot, B might fail registering due to the old version of A. So, when the reboot flag is set, which means some DLL should be replaced at reboot, the Library macros set all DLL files to be registered at reboot.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">cpeel2300</span><br />
      <span class="post-time small text-muted">13th December 2006 18:05 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Thanks for the reply!<br />
      <br />
      Is there any way to avoid this? I appreciate it's a bit unusual but it would really help me out. I'm no good as NSIS macro programming but am happy to give it a try if someone can point me in the right direction.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
      <span class="post-time small text-muted">14th December 2006 19:47 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">You can remove the IfReboot check in Library.nsh. You were able to understand what happens there, changing it is just one small step forward.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">cpeel2300</span><br />
      <span class="post-time small text-muted">15th December 2006 10:06 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Thanks - will take a look at the macro and see how I get on :)</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">onad</span><br />
      <span class="post-time small text-muted">15th December 2006 12:54 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">For some DLL's to unload it is an option to kill explorer shell, uninstall the DLL and restart the explorer shell again, tricky but possible. No reboot needed for install of some ActiveX dll's this way.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">BuilderBob</span><br />
      <span class="post-time small text-muted">25th August 2008 13:11 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Hi people, I've just wasted 3 hours on this :). If the reboot flag is on for whatever reason, dll will be registered at startup. It messed up my manual "Rename-&gt;Delete renamed file on reboot-&gt;Copy new file and register" from <a href="http://forums.winamp.com/showthread.php?s=&amp;threadid=292661" target="_blank">my old thread</a>.<br />
      <br />
      I rename a busy dll and then delete it. This sets the reboot flag, so when I call InstallLib it will do it on reboot even if it doesn't have to.<br />
      <br />
      Can you please document it? It was fun reading and adding debug messages inside Library.nsh, but I could have checked my facebook instead ;).</p>
    </div>
    <hr />

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]>
  </script>
</body>
</html>
