<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="description" content="Deleting changed files in Vista"><title>Deleting changed files in Vista - NSIS Forums</title><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script><link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css"><link rel="stylesheet" href="../css/style.css" type="text/css"><!--[if lt IE 9]><script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script><script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script><![endif]--></head><body><div class="container"><ol class="breadcrumb"><li><a href="../index.html" class="glyphicon glyphicon-home"></a></li><li><a href="f-65.html">NSIS Discussion</a></li><li class="active">Deleting changed files in Vista</li></ol><p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=264757">Deleting changed files in Vista</a></p><br><div class="post"><p class="post-meta"><span class="post-author text-primary">reprobate</span><br><span class="post-time small text-muted">31st January 2007 17:19 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>Deleting changed files in Vista</strong><br>We're installing some files into \ProgramData that are subsequently changed by the application. The installer runs as admin, hence the files are owned by Administrator.<br><br>When we run the uninstaller, the directory entry for these files is not removed. No error the Delete instruction.<br><br>Files that were not modified are deleted ok. Files that were not installed but were subsequently created by the app are deleted ok. It's only the data files that are installed, then modified, that are a problem.<br><br>Windows Explorer doesn't see the files, or the install directory, for that matter. But my cheap old explorer replacement finds them alright, as does Windows GetFileAttributes. If you try to open the file, you get a NOT FOUND error, so it seems it's just a directory entry problem.<br><br>Rebooting, even if you specify Delete /REBOOT, does not do the trick.<br><br>Anyone have a clue as to what is going on? Thanks!</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">onad</span><br><span class="post-time small text-muted">31st January 2007 20:36 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Do not install to ProgramData yourself but use API's of OS to get the folder to use. Because of Vista's virtualization the files will land up in the ProgramData then.<br><br>Best is first learn about Vista and Virtualization for backwards compatibility.</p></div><hr><div class="footer"><p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p></div></div><script src="../js/highlight.pack.js" type="text/javascript"></script><script type="text/javascript">//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]></script></body></html>