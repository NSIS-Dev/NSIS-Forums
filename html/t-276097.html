<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="description" content="Pre Compression of files"><title>Pre Compression of files - NSIS Forums</title><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script><link rel="preload" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css" as="style" onload="this.rel='stylesheet'"><link rel="preload" href="../css/style.css" as="style" onload="this.rel='stylesheet'"><noscript><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css"><link rel="stylesheet" href="../css/style.css"></noscript><script>!function(a){"use strict";var b=function(b,c,d){function e(a){return h.body?a():void setTimeout(function(){e(a)})}function f(){i.addEventListener&&i.removeEventListener("load",f),i.media=d||"all"}var g,h=a.document,i=h.createElement("link");if(c)g=c;else{var j=(h.body||h.getElementsByTagName("head")[0]).childNodes;g=j[j.length-1]}var k=h.styleSheets;i.rel="stylesheet",i.href=b,i.media="only x",e(function(){g.parentNode.insertBefore(i,c?g:g.nextSibling)});var l=function(a){for(var b=i.href,c=k.length;c--;)if(k[c].href===b)return a();setTimeout(function(){l(a)})};return i.addEventListener&&i.addEventListener("load",f),i.onloadcssdefined=l,l(f),i};"undefined"!=typeof exports?exports.loadCSS=b:a.loadCSS=b}("undefined"!=typeof global?global:this);!function(a){if(a.loadCSS){var b=loadCSS.relpreload={};if(b.support=function(){try{return a.document.createElement("link").relList.supports("preload")}catch(b){return!1}},b.poly=function(){for(var b=a.document.getElementsByTagName("link"),c=0;c<b.length;c++){var d=b[c];"preload"===d.rel&&"style"===d.getAttribute("as")&&(a.loadCSS(d.href,d,d.getAttribute("media")),d.rel=null)}},!b.support()){b.poly();var c=a.setInterval(b.poly,300);a.addEventListener&&a.addEventListener("load",function(){b.poly(),a.clearInterval(c)}),a.attachEvent&&a.attachEvent("onload",function(){a.clearInterval(c)})}}}(this);</script></head><body><div class="container"><ol class="breadcrumb"><li><a href="../index.html" class="glyphicon glyphicon-home"></a></li><li><a href="f-65.html">NSIS Discussion</a></li><li class="active">Pre Compression of files</li></ol><p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=276097">Pre Compression of files</a></p><br><div class="post"><p class="post-meta"><span class="post-author text-primary">99999999</span><br><span class="post-time small text-muted">18th August 2007 05:17 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>Pre Compression of files</strong><br>Okay I have a system, which builds installers for around 2000 targets. The targets are independent installers, and each of them has different files, and they range from the typical of 20mb to 1.5gb.<br><br>The problem is that 99.9% of the build process, is putting the installer together. What I would prefer is if it would be possible to build a .zip file or use makensis, to compress the files ahead of time, so that I could include a zip file for these file each time, and only those files which changed each time, would be required to be recompressed.<br><br>The issue is that while I don't need to build these all everyday, I do need to build them in batches from time to time. As a result, it can take a couple days to complete all the builds on 4 super speedy boxes.<br><br>And I need to do the batched builds, quite a few times, as it usually includes testing of changes to the installer, and the installer builds.<br><br>So something of this nature would reduce the build time significantly, and would make my job much easier. Is there any method of doing this currently with NSIS?</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">michaelcsikos</span><br><span class="post-time small text-muted">18th August 2007 08:25 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">I don't know of a way of doing what you describe, but if you are mainly rebuilding the installer for testing only, just don't bother compressing (SetCompress off).<br><br>Otherwise, if the files for a particular installer have not changed, and the NSIS script has not changed since the last build, the installer does not need to be rebuilt. Perhaps you could write a clever script or program to detect this and skip those builds (if installer exe's modified date is later than the NSIS script and every file to be included). Obviously, this would require some work to begin with, but it could potentially save you many hours.<br><br>Are all the files local to the build machines?</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">99999999</span><br><span class="post-time small text-muted">19th August 2007 05:55 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"></p><blockquote><i>Originally posted by michaelcsikos</i><br><b>I don't know of a way of doing what you describe, but if you are mainly rebuilding the installer for testing only, just don't bother compressing (SetCompress off).<br><br>...<br><br>Are all the files local to the build machines?</b></blockquote>Yeah I've tried it with compress off, however this still doesn't help a great deal, because so many of the targets have huge numbers of files, (80mb of 4k files sometimes, textures and such,) so really problem is reading, adding each of those each time.<br><br>Most of the time, the testing involved is not the build system, but the installers being built, and of course each one of them can be somewhat unique. Each one has a hooks file, which is tied into the main installer script, and allows for customization of the scripts.<br><br>The files are local to the build machine, after being checked out.<br><br>The ideal system, would include a method of pre-compression of these files, and then checking in that single pre-compressed block (and it would speed up the checkin/checkout,) then the tool we use to put targets into the system, would be responsible for doing the compression once.<br><br>This would also reduce threats of virus infecting those files.</div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">michaelcsikos</span><br><span class="post-time small text-muted">20th August 2007 01:26 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Have you tried pre-compressing using zip2exe in the NSIS\Bin directory? You could compress your textures and then uncompress them to the $INSTDIR silently in your main script.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">99999999</span><br><span class="post-time small text-muted">20th August 2007 03:29 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"></p><blockquote><i>Originally posted by michaelcsikos</i><br><b>Have you tried pre-compressing using zip2exe in the NSIS\Bin directory? You could compress your textures and then uncompress them to the $INSTDIR silently in your main script.</b></blockquote>No I hadn't thought of doing it that way, primarily because from what I could tell we would have to extrapolate the entire zip file container to disk, and then decompress the items from it. I'll look though and see if that is the way it works.</div><hr><div class="footer"><p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p></div></div><script src="../js/highlight.pack.js" type="text/javascript"></script><script type="text/javascript">//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]></script></body></html>