<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="ShowModelessHTMLDialog - crash on close" />

  <title>ShowModelessHTMLDialog - crash on close - NSIS Forums</title>
  <script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script>
  <!-- Bootstrap core CSS -->

  <link rel="stylesheet" type="text/css" href="//netdna.bootstrapcdn.com/bootswatch/3.0.1/readable/bootstrap.min.css" />
  <link rel="stylesheet" href="../css/style.css" type="text/css" /><!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!--[if lt IE 9]>
                <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
                <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->
</head>

<body>
  <div class="container">
    <!-- Put navigation bar here -->

    <ol class="breadcrumb">
      <li><a href="../index.html" class="glyphicon glyphicon-home"></a></li>

      <li><a href="f-65.html">NSIS Discussion</a></li>

      <li class="active">ShowModelessHTMLDialog - crash on close</li>
    </ol>

    <p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=297728">ShowModelessHTMLDialog - crash on close</a></p><br />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Ivan Andreevich</span><br />
      <span class="post-time small text-muted">22nd September 2008 23:56 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>ShowModelessHTMLDialog - crash on close</strong><br />
      I've never worked with NSIS (or with Windows API for that matter) before the current project, so bear with me.<br />
      <br />
      I have an NSIS installer which displays an HTML file in a dialog, created via ShowModelessHTMLDialog (http://msdn.microsoft.com/en-us/library/aa741862(VS.85).aspx) in a custom plugin, while another file is downloaded via NSISdl in the main window.<br />
      <br />
      The problem is that if I close this modeless dialog, the application "..has encountered a problem and needs to close". Meanwhile, the background download completes while the error message is up, by the way. So there is no other side-effects other than this crash message in the app.<br />
      <br />
      If I use ShowHTMLDialog (http://msdn.microsoft.com/en-us/library/aa741858(VS.85).aspx) instead, there is no crash on close. However, that's not what I need, since the background download will not start until the window is closed, and that defeats the purpose.<br />
      <br />
      I also tried calling my function, and creating the modeless dialog outside of NSIS as a separate EXE. In that case, no crash occurs.<br />
      <br />
      This leads me to believe that something NSIS-related is going on here. Any idea about what could be happening?<br />
      <br />
      Thanks,<br />
      Ivan</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Ivan Andreevich</span><br />
      <span class="post-time small text-muted">25th September 2008 01:05 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">So far, I've switched to using IWebBrowser2 interface and just running an external IE window, customized to my needs. It works without crashing, but it's obviously not the same thing. It might work for what I need, not entirely sure.<br />
      <br />
      However, I think that the crash I am experiencing with the ShowModelessHTMLDialog could actually be an NSIS bug.</p>
    </div>
    <hr />

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]>
  </script>
</body>
</html>
