<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="description" content="Reading from a file at compile time"><title>Reading from a file at compile time - NSIS Forums</title><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script><link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css"><link rel="stylesheet" href="../css/style.css" type="text/css"><!--[if lt IE 9]><script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script><script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script><![endif]--></head><body><div class="container"><ol class="breadcrumb"><li><a href="../index.html" class="glyphicon glyphicon-home"></a></li><li><a href="f-65.html">NSIS Discussion</a></li><li class="active">Reading from a file at compile time</li></ol><p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=357660">Reading from a file at compile time</a></p><br><div class="post"><p class="post-meta"><span class="post-author text-primary">miraz.zaidi</span><br><span class="post-time small text-muted">20th March 2013 07:21 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>Reading from a file at compile time</strong><br>This may be very simple thing but I couldn't find it anywhere.<br><br>I want to read some values from a file (config.json) into some variables when I compile my nsis script.<br>How can I possibly do that?<br><br>Another question is I want to hit a url without opening any browser window, I tried 'execshell ' it did the task but opened the url in default browser window which I dont want. what other options do I have?<br><br>Thanks in advance.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">MSG</span><br><span class="post-time small text-muted">20th March 2013 07:43 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">use !system or !execute to run an (NSIS) exe, which reads the file using normal runtime commands and writes to an .nsh file that contains !define Foo "string 1" !define Bar "string 2". Then just !include that .nsh file in your real .nsi.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">miraz.zaidi</span><br><span class="post-time small text-muted">20th March 2013 07:58 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Thanks. So I must use another exe. That will work. But I wish there was some other way , I really dont want to use an extra exe.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">MSG</span><br><span class="post-time small text-muted">20th March 2013 12:14 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">You could even compile a second nsi file into that exe during compilation, to automate everything.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br><span class="post-time small text-muted">20th March 2013 13:01 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Use the nsJSON plug-in in a small script (ParseJSON.nsi) which will read the json file and output an nsh file (with !defines):</p><pre>
<code>OutFile ParseJSON.exe<br>SilentInstall silent<br>RequestExecutionLevel user<br><br>Section<br>  FileOpen $R0 $EXEDIR\Const.nsh w<br>  nsJSON:: ...<br>  FileWrite $R0 '!define ....'<br>  FileClose $R0<br>SectionEnd</code>
</pre>Then you can put this in your main script:
      <pre>
<code>!system `"${NSISDIR}\makensis.exe" ParseJSON.nsi`<br>!system `ParseJSON.exe`<br>!system `del ParseJSON.exe`<br>!include ParseJSON.nsh</code>
</pre>Personally I just use an nsh file containing !defines for compile time configuration for basic installers.<br>
      <br>
      Stu
    </div>
    <hr>

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]></script></body></html>