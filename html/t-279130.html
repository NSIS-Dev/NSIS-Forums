<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="description" content="Backup Utility written in NSIS Script"><title>Backup Utility written in NSIS Script - NSIS Forums</title><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script><link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css"><link rel="stylesheet" href="../css/style.css" type="text/css"><!--[if lt IE 9]><script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script><script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script><![endif]--></head><body><div class="container"><ol class="breadcrumb"><li><a href="../index.html" class="glyphicon glyphicon-home"></a></li><li><a href="f-65.html">NSIS Discussion</a></li><li class="active">Backup Utility written in NSIS Script</li></ol><p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=279130">Backup Utility written in NSIS Script</a></p><br><div class="post"><p class="post-meta"><span class="post-author text-primary">Quib</span><br><span class="post-time small text-muted">16th October 2007 20:44 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>Backup Utility written in NSIS Script</strong><br>Well, I spent a good two days (probably 20 hours, which is pretty gross considering it's sorta simple) on this and then the better part of a week testing and wanted to get some feedback on it from folks who know how spiffy NSIS really is.<br><br>Queue'eM - Backup / Synchronize / Archive<br><br>I had three goals when making this:<br>1) simple, config-file-driven utility to backup files from my flash drive to my computer<br>2) protect files in regards to deletion by not including file deletion as part of the utility<br>3) figure out some way to use the stupid archive file flag attribute<br><br>The project started off as a silent NSIS ''installer'' but I quickly realized I really wanted a progress bar. So, I just removed the silent attribute, tweaked some dialogs and changed all my Abort's into Quit's. NSIS did the rest of the work for me since it provides a status bar and a dialog pane to list operations as they occur.<br><br>Anyhow, I wrote up a decent document for the program which is included in the attached zip, so read that for operating instructions. The NSIS script is also included and at the top explains which plugins, etc. it needs to operate so you can compile it yourself so you don't have to trust some random fellow's executable.<br><br>I'm mainly looking for feedback about performance, testing on other versions of windows (I only have XP SP2 and 98SE machines), efficiency and format of the NSIS Script, and bug reporting (what happens if a file path is really really really long for example, and it could use more testing when copying to and from network shares).<br><br>Oh, and the name Queue'eM is a cross of my initials with ''Queue Them'' as in, ''line them up to be copied.'' It also adheres to the 8.3 naming convention (well, ignoring the capitalization).<br><br>QM</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Backland</span><br><span class="post-time small text-muted">17th October 2007 08:45 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Thanks for sharing!</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">kichik</span><br><span class="post-time small text-muted">17th October 2007 20:53 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">You can use <a href="http://nsis.sourceforge.net/LogicLib" target="_blank">LogicLib</a> to make the switches and comparisons a bit simpler. You could also create a function that recurses over a directory and copies the files depending on the result of another function. The other function can be a parameter for the first function, thus saving you from repeating the scan code so many times. To get a function's address, use GetFunctionAddress. To call it later, simply use Call with the variable containing the address.<br><br>You should definitly <a href="http://nsis.sourceforge.net/Starting_a_new_page" target="_blank">create</a> a Wiki page containing this as an example.</p></div><hr><div class="footer"><p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p></div></div><script src="../js/highlight.pack.js" type="text/javascript"></script><script type="text/javascript">//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]></script></body></html>