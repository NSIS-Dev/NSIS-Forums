<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="&quot;no disk&quot; browse problem" />

  <title>"no disk" browse problem - NSIS Forums</title>
  <script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script>
  <!-- Bootstrap core CSS -->

  <link rel="stylesheet" type="text/css" href="//netdna.bootstrapcdn.com/bootswatch/3.0.1/readable/bootstrap.min.css" />
  <link rel="stylesheet" href="../css/style.css" type="text/css" /><!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!--[if lt IE 9]>
                <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
                <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->
</head>

<body>
  <div class="container">
    <!-- Put navigation bar here -->

    <ol class="breadcrumb">
      <li><a href="../index.html" class="glyphicon glyphicon-home"></a></li>

      <li><a href="f-65.html">NSIS Discussion</a></li>

      <li class="active">"no disk" browse problem</li>
    </ol>

    <p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=232884">"no disk" browse problem</a></p><br />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">AndyM</span><br />
      <span class="post-time small text-muted">9th December 2005 18:05 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>"no disk" browse problem</strong><br />
      Hello. I am getting this error message when I click the 'Browse' button on a MUI_PAGE_DIRECTORY page:<br />
      <br />
      "There is no disk in the drive. Please insert into drive \Device\Harddisk1\DR1."<br />
      <br />
      It keeps popping up over and over again whenever D: is in the view.<br />
      <br />
      - NSIS 2.11 on Windows 2000<br />
      - I have searched the forum and FAQ and cannot find a solution<br />
      - I have a ZIP drive installed, but haven't used it in years<br />
      - I have not had this problem with other Windows programs - only my installer<br />
      - I am not a 'native Windows' developer or user - maybe I don't understand something about Windows and users are used to this annoyance?<br />
      <br />
      Secondary question: How do I change the text "Select the folder to install NNN in:" in the browse window?<br />
      <br />
      Thank you for your help!<br />
      <br />
      - Andy</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
      <span class="post-time small text-muted">9th December 2005 18:36 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Second question answer:<br />
      <a href="http://forums.winamp.com/showthread.php?s=&amp;postid=1822969#post1821600" target="_blank">http://forums.winamp.com/showthread....69#post1821600</a><br />
      (a few topics down)<br />
      <br />
      -Stu</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">AndyM</span><br />
      <span class="post-time small text-muted">9th December 2005 19:21 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Hey - thanks for the quick response. I tried this:<br />
      <br />
      DirText "" "" "" "Select a directory for your projects."<br />
      <br />
      And that worked great - except that it changed both MUI_PAGE_DIRECTORY pages. How do I make it change just on my second MUI_PAGE_DIRECTORY page?<br />
      <br />
      Thanks!<br />
      <br />
      - Andy</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
      <span class="post-time small text-muted">9th December 2005 19:57 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Oh sorry, I thought you meant for a custom InstallOptions page.<br />
      To change that text, I think you use !define MUI_DIRECTORYPAGE_TEXT_DESTINATION before each !insertmacro MUI_PAGE_DIRECTORY.<br />
      <br />
      -Stu</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">AndyM</span><br />
      <span class="post-time small text-muted">9th December 2005 20:04 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"></p>

      <blockquote>
        To change that text, I think you use !define MUI_DIRECTORYPAGE_TEXT_DESTINATION before each !insertmacro MUI_PAGE_DIRECTORY.
      </blockquote>No - that changes the name of the frame around the path and browse button...<br />
      <br />
      The previous solution would work if there were a way to set/save state of the DirText, but I don't think that can be done...<br />
      <br />
      - Andy
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Takhir</span><br />
      <span class="post-time small text-muted">10th December 2005 06:54 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">First question may come from not existing default installation folder (wrong registry value or script default, 4.8.1.21 and 22 of Manual). You can check this using IfFileExists in the dir's page show function.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">AndyM</span><br />
      <span class="post-time small text-muted">12th December 2005 02:40 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">[Now that I have the registration thing sorted, I can reply...]<br />
      <br />
      Takhir,<br />
      <br />
      Thanks for the response. The directory definitely exists. I created the installer using EclipseNSIS and modified it for my project. I've checked the default dir and everything looks in order.<br />
      <br />
      - Andy</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">AndyM</span><br />
      <span class="post-time small text-muted">19th December 2005 17:45 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">[Bump]<br />
      <br />
      Anyone have any thoughts on either issue?<br />
      <br />
      Thanks.<br />
      <br />
      - Andy</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
      <span class="post-time small text-muted">20th December 2005 18:32 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Do you get that only with your installer? Does it happen with the NSIS paclage installer? Maybe it's some broken shell link that the browse dialog shows... If not, attach the script, not much can be said without it.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">AndyM</span><br />
      <span class="post-time small text-muted">20th December 2005 21:44 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"></p>

      <blockquote>
        <i>Originally posted by kichik</i><br />
        <b>Does it happen with the NSIS package installer?</b>
      </blockquote>Yes it happens with the NSIS installer as well. If I click Browse it comes up with C: open which takes up the whole viewing area. If I then scroll down, right when it's about to display the D: drive it starts giving me that error. I can click 'Cancel' to make it go away, but then whenever I move the scroll bar it comes up again if D: is visible in the viewing area.<br />
      <br />
      - Andy
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
      <span class="post-time small text-muted">23rd December 2005 11:59 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Does it happen with browse dialogs in other applications? I could call SetErrorMode to suppress the message, but I don't think that'd be the right thing to do in this case. Seems to me like something is wrong on your machine. Is the ZIP drive on D:? I have a ZIP drive, and I don't get this message when browsing for a folder. Maybe there's a driver problem that interferes with the detection of an inserted ZIP disk and causes this error.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
      <span class="post-time small text-muted">23rd December 2005 12:47 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Try this. Just a small VB.NET app that will show a folder browse dialog and catch any errors made in a message box.<br />
      <br />
      -Stu</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">AndyM</span><br />
      <span class="post-time small text-muted">23rd December 2005 15:21 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Thanks for the replies.<br />
      <br />
      <b>kichik -</b> It does not happen in other browse dialogs that I can find. I've tried several installers and it seems like only the NSIS ones are choking. I really only use a handful of apps and haven't seen it within any of those either.<br />
      <br />
      The ZIP drive is D: and I only started seeing this when I started with NSIS. It is certainly possible that it's a driver issue, although I have everything as up-to-date as possible.<br />
      <br />
      <b>Afrow UK -</b> After finding and dowloading mscoree.dll [is this a .NET thing? - don't have it], I get the following when I run the program:<br />
      <br />
      "The Application failed to initialize properly (0xc0000022)..."<br />
      <br />
      Thanks guys. If it's just me with the problem then that's OK. I would just hate to have a customer get this if it's a more general problem.<br />
      <br />
      Happy Hanukkah/Happy Kwanzaa/Merry Christmas/Festive Festivus!<br />
      <br />
      <i>- Andy</i></p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
      <span class="post-time small text-muted">23rd December 2005 15:39 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Have you got MS .NET Framework installed?<br />
      <a href="http://www.microsoft.com/downloads/details.aspx?familyid=262D25E3-F589-4842-8157-034D1E7CF3A3&amp;displaylang=en" target="_blank">http://www.microsoft.com/downloads/d...displaylang=en</a><br />
      <br />
      -Stu</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">AndyM</span><br />
      <span class="post-time small text-muted">23rd December 2005 15:47 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"></p>

      <blockquote>
        <i>Originally posted by Afrow UK</i><br />
        <b>Have you got MS .NET Framework installed?<br /></b>
      </blockquote>No I don't. [And I don't really want to...]<br />
      <br />
      Is it possible to build the test app without it?<br />
      <br />
      - Andy
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
      <span class="post-time small text-muted">23rd December 2005 15:52 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">No because it is written in VB.NET as I have already said.<br />
      You'll have to install it one day anyway because a hell of a lot of people are writing VB.NET, C# and C/C++ 7<br />
      <br />
      -Stu</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
      <span class="post-time small text-muted">23rd December 2005 15:56 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">For the purpose of this simple test, you can run drwtsn32.exe and click on the first browse button. It uses the directory browsing dialog.<br />
      <br />
      Even better, the Windows file find dialog has a browse button which uses the same method as well.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">AndyM</span><br />
      <span class="post-time small text-muted">23rd December 2005 16:39 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"></p>

      <blockquote>
        <i>Originally posted by Afrow UK</i><br />
        <b>No because it is written in VB.NET as I have already said.<br />
        You'll have to install it one day anyway because a hell of a lot of people are writing VB.NET, C# and C/C++ 7</b>
      </blockquote>Sorry - I obviously wasn't paying attention. I don't expect to have to install .NET stuff because I use the machine for only one thing: compiling/testing our Windows 2000 app.<br />
      <br />
      <b>kichik -</b> the Windows find Browse dialog does not give me this error. I used "Search for Files or Folders..." and Look in: Browse. No problemo.<br />
      <br />
      - Andy
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
      <span class="post-time small text-muted">23rd December 2005 18:08 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Then it's probably the SHGetPathFromIDList call. The attached example should trigger the error message.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">AndyM</span><br />
      <span class="post-time small text-muted">23rd December 2005 22:33 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><b>kichik -</b> I'm away from my PC for the next week or so. I will try it when I get back and let you know!<br />
      <br />
      Thanks for the help.<br />
      <br />
      - Andy</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">AndyM</span><br />
      <span class="post-time small text-muted">31st December 2005 23:20 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><b>kichik -</b> Yep - that test reproduces my problem.<br />
      <br />
      <i>- Andy</i></p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
      <span class="post-time small text-muted">3rd January 2006 19:29 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Great. Now lets see if SetErrorMode makes it go away.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">AndyM</span><br />
      <span class="post-time small text-muted">3rd January 2006 19:52 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Nope - that didn't fix it.<br />
      <br />
      <i>- Andy</i></p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
      <span class="post-time small text-muted">3rd January 2006 20:07 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">That's weird. I'm afraid there's nothing more I can do. SetErrorMode usually suffices. Did you try another driver?</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">AndyM</span><br />
      <span class="post-time small text-muted">3rd January 2006 20:17 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">OK. Thanks for the help. I will try to find a new driver.<br />
      <br />
      <i>- Andy</i></p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">AndyM</span><br />
      <span class="post-time small text-muted">4th January 2006 19:49 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">FWIW I updated to the latest Iomega drivers and I still have the problem.<br />
      <br />
      <i>- Andy</i></p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
      <span class="post-time small text-muted">5th January 2006 17:50 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Maybe it's some background program?</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">AndyM</span><br />
      <span class="post-time small text-muted">6th January 2006 17:11 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">I have a very simple setup. I have no idea how to track this down [remember I'm not a Windows guy :-)]. If I ever figure it out or it "Just Goes Away"(tm), I'll let you know here.<br />
      <br />
      Thanks again.<br />
      <br />
      <i>- Andy</i></p>
    </div>
    <hr />

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]>
  </script>
</body>
</html>
