<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="description" content="Add, Remove, Repair from Install executable"><title>Add, Remove, Repair from Install executable - NSIS Forums</title><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script><link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css"><link rel="stylesheet" href="../css/style.css" type="text/css"></head><body><div class="container"><ol class="breadcrumb"><li><a href="../index.html" class="glyphicon glyphicon-home"></a></li><li><a href="f-65.html">NSIS Discussion</a></li><li class="active">Add, Remove, Repair from Install executable</li></ol><p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=241048">Add, Remove, Repair from Install executable</a></p><br><div class="post"><p class="post-meta"><span class="post-author text-primary">kelek</span><br><span class="post-time small text-muted">16th March 2006 21:20 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>Add, Remove, Repair from Install executable</strong><br>One of the nice things about InstallShield is it's ability to detect, when executing the installation executable, if a previous installation exists, and then bring you to the add/remove/repair selection. If there is no existing installation, it continues as normal.<br><br>So for example, lets say I run the installation for program X. Right after it's installed, I can re-run the installation program to uninstall program X, without having to go through Control Panel, or the Start Menu Program Groups, etc.<br><br>Is there any way to do this with NSIS? I've looked into Thrash's add/remove programs, but that just customizes the menu from the Add/Remove programs in control panel and for the uninstall script.<br><br>This involves 'branching' into two different sets of pages, depending on if it detected an installation. As far as I know, that's not possible, since you can't use function calls to customize the page layout.<br><br>I thought about doing stuff in .onInit, but I think it sets the page layout before doing .onInit, so it won't matter. Any ideas?<br><br>Another idea, which seems a bit complex, would be to have an installation package which automatically packages two different installation packages. Then, if it detects the installation, it runs one, and if it doesn't, it runs the other. However, this would result in a 2x size bloat/overhead in file size.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">JasonFriday13</span><br><span class="post-time small text-muted">16th March 2006 21:32 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">I found <a href="http://nsis.sourceforge.net/Component_Manager" target="_blank">this</a> a few days ago. I think it may help.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">kelek</span><br><span class="post-time small text-muted">16th March 2006 21:55 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">I found this too, but unfortunately it's under the GPL. Is there any version of this that is under the NSIS 'as-is' license, including commercial?</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">dienjd</span><br><span class="post-time small text-muted">16th March 2006 21:59 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">What about detecting your app in .onInit and then displaying a confirmation MessageBox that executes the UninstallString and exits if the user chooses to uninstall?<br><br>Or you should be able to have a custom page to handle the confirmation, which would get skipped if your app isn't detected--isn't that functionally the same as what InstallShield can do?</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">goldy1064</span><br><span class="post-time small text-muted">16th March 2006 22:46 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Why not just detecting if a previous version is installed in .onInit and then display a custom page. From this custom page, have the add/remove/repair options. When next is selected, launch something else (or another custom page(s)). When a previous version isn't detected, just use Abort in the Pre functions of your custom pages.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">kelek</span><br><span class="post-time small text-muted">17th March 2006 03:41 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">The other problem is that I'm not sure how to have radio button functionality in a custom page. Sections.nsh support for radio buttons only applies to normal sections, not sections within a custom page.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Comperio</span><br><span class="post-time small text-muted">17th March 2006 03:54 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Use the "group" flag to group radio buttons together.<br><br>Hint: I've found that it's usually a good idea to have the radio buttons as the last 3 options on the page to make the group work properly.<br><br>See the InstallOptions doc for more info.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">kelek</span><br><span class="post-time small text-muted">17th March 2006 03:59 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">By the way, thanks for the tips. I have a custom page where I skip all of the !insertmacro stuff for the page if it doesn't detect an installation, and an empty custom page seems to get skipped, which is good. I also rediscovered that there's a type RadioButton for .ini files. Thanks!</p></div><hr><div class="footer"><p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p></div></div><script src="../js/highlight.pack.js" type="text/javascript"></script><script type="text/javascript">//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]></script></body></html>