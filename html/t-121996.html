<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="description" content="Version checking"><title>Version checking - NSIS Forums</title><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script><link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css"><link rel="stylesheet" href="../css/style.css" type="text/css"><!--[if lt IE 9]><script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script><script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script><![endif]--></head><body><div class="container"><ol class="breadcrumb"><li><a href="../index.html" class="glyphicon glyphicon-home"></a></li><li><a href="f-65.html">NSIS Discussion</a></li><li class="active">Version checking</li></ol><p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=121996">Version checking</a></p><br><div class="post"><p class="post-meta"><span class="post-author text-primary">galil</span><br><span class="post-time small text-muted">19th January 2003 13:03 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>Version checking</strong><br>I need to implement a following feature for my installer:<br><br>Check for version string in registry, and if<br>a)it's &lt; than current (old version of me detected) - do normal install (simply overwrite old files).<br>b)not found (I wasn't installed before) - do backup and proceed with install.<br>c)it's the same as current (user already has me installed) - start with uninstall page instead.<br><br>I quess the check has to be done using user variables? But how do they work? I kinda tried to stay away from that stuff before. Or is there a simple way?<br>And I don't know how to put all this into one function. Should it be .onGUIInit ? And how to call those different types of install?<br><br>Uhh...my head hurts :))</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Sunjammer</span><br><span class="post-time small text-muted">19th January 2003 13:18 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Once you have read your version string from the registry you might find this useful: http://nsis.sourceforge.net/archive/viewpage.php?pageid=57</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">galil</span><br><span class="post-time small text-muted">23rd January 2003 03:25 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Ok, here's my yet another problem:<br><br>I made a script to check for a correct version<br><br></p><blockquote>Function .onVerifyInstDir<br>IfFileExists $INSTDIR\exefile.exe exe_found<br>Abort<br>exe_found:<br>Push "$INSTDIR\exefile.exe"<br>Call FileSize<br>Pop $0<br>StrCmp $0 2748447 exe_ok<br>Abort<br>exe_ok:<br>IfFileExists $INSTDIR\Data\data.dat dat_found<br>Abort<br>dat_found:<br>FunctionEnd</blockquote>It works, but I'm not quite happy how. The check works in the InstallationFolder window. It grays out the "install" button, but before that it lets the user to select wrong folder. So it could be pretty confusing. I'd like it to prevent the user from selecting the wrong dir somehow. Any help?</div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">kichik</span><br><span class="post-time small text-muted">23rd January 2003 09:46 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">It does prevent him from the selecting the wrong directory. It will only allow the user to click install when he points to the directory where exefile.exe file is 2748447 bytes and data.dat exists. What's wrong with that?</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">galil</span><br><span class="post-time small text-muted">23rd January 2003 11:36 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Nothing wrong, it just could confuse the user. I wanted to "gray out" the ok button of the "browse for folder" window (like Windows does, when you don't select the correct folder).<br>Oh well. I quess I'm just too picky, right?</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">kichik</span><br><span class="post-time small text-muted">23rd January 2003 11:40 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">But it does. When you use Abort from .onVerifyInstDir it grays out the OK button (next/install in this case).</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">galil</span><br><span class="post-time small text-muted">23rd January 2003 12:11 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">No no, I had in mind that folder-tree window that pops up when you click browse.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">kichik</span><br><span class="post-time small text-muted">23rd January 2003 12:13 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Oh... That can be done. Add it to the feature requests in SF (<a href="http://nsis.sf.net/" target="_blank">http://nsis.sf.net/</a> -&gt; Project Page).</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">galil</span><br><span class="post-time small text-muted">23rd January 2003 12:31 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">I'd do it, if I only could describe it in short and using tech speech :o<br>My babblings about "graying out some stuff in that pops ups" won't make much sense I guess...<br>Though this could be really usefull (maybe not that common, but still usefull) feature, imho.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">virtlink</span><br><span class="post-time small text-muted">24th January 2003 13:58 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">There's nothing wrong with your babbelings :), it's just that KiCHiK never reads a post completely. It happens most of the time ;)!</p></div><hr><div class="footer"><p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p></div></div><script src="../js/highlight.pack.js" type="text/javascript"></script><script type="text/javascript">//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]></script></body></html>