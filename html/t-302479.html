<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="description" content="FCT plugin - msgonly"><title>FCT plugin - msgonly - NSIS Forums</title><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script><link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css"><link rel="stylesheet" href="../css/style.css" type="text/css"><!--[if lt IE 9]><script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script><script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script><![endif]--></head><body><div class="container"><ol class="breadcrumb"><li><a href="../index.html" class="glyphicon glyphicon-home"></a></li><li><a href="f-65.html">NSIS Discussion</a></li><li class="active">FCT plugin - msgonly</li></ol><p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=302479">FCT plugin - msgonly</a></p><br><div class="post"><p class="post-meta"><span class="post-author text-primary">vicky1981</span><br><span class="post-time small text-muted">27th January 2009 11:11 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>FCT plugin - msgonly</strong><br>Hello,<br><br>I would like to identify whether my application is currently running while i am uninstalling it. I don't want to kill/close the application, but rather notify the user to close it.<br><br>I found that FCT plugin suits my needs. However, I have a problem. Eventhough I am using /MSGONLY parameter (Not attempts to terminate the process), it is still terminating the application. what is wrong with my code?<br><br>How can I know that FCT identified a running instance of my application? Return value should be &gt;0?<br><br></p><pre>
<code>fct::fct /WC "SunAwtFrame" /WTP "partial application name" /MSGONLY <br>Pop $0 <br>StrCmp $0 1 0 OK1 <br>MessageBox MB_OK "The application you are trying to uninstall is running. Close it and try again." <br>Abort ok1:</code>
</pre><br>
      <br>
      Thanks in advance
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Red Wine</span><br>
      <span class="post-time small text-muted">27th January 2009 12:45 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Speaking about your application I guess you know the window class/title so you may simply use the FindWindow instruction,<br>
      <br>
      <a href="http://nsis.sourceforge.net/Docs/Chapter4.html#4.9.14.5" target="_blank">http://nsis.sourceforge.net/Docs/Chapter4.html#4.9.14.5</a><br>
      <br>
      Just search the forum, you'll find loads of examples.</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">vicky1981</span><br>
      <span class="post-time small text-muted">27th January 2009 13:00 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Hello,<br>
      <br>
      FindWindow doesn't suit my needs because my application's class name is "SunAWTFrame" and most of the java application using JFrame tend to have the same. And title is only partial i.e. only some part of the title is constant and the remaining part changes (project name).</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Red Wine</span><br>
      <span class="post-time small text-muted">27th January 2009 13:11 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Takhir added a function in wiki which involve system plugin, did you check it?<br>
      <br>
      You may replace the part of killing the process with interactive messages.<br>
      <br>
      <a href="http://nsis.sourceforge.net/Find_and_Close_or_Terminate" target="_blank">http://nsis.sourceforge.net/Find_and_Close_or_Terminate</a></p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">vicky1981</span><br>
      <span class="post-time small text-muted">27th January 2009 13:24 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">thanks for the quick replies.....<br>
      <br>
      "Find and Close or Terminate" macro won't work as it needs unique &amp; complete class name or unique &amp; complete class title.</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Red Wine</span><br>
      <span class="post-time small text-muted">27th January 2009 13:45 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">You're welcome.<br>
      Same issue huh?<br>
      I'm sure I've seen here several related threads, so what do you say, are you going to dig the forum? :)<br>
      <br>
      Here's the result of a very quick search,<br>
      <br>
      <a href="http://forums.winamp.com/showthread.php?s=&amp;threadid=248179" target="_blank">http://forums.winamp.com/showthread....hreadid=248179</a></p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">vicky1981</span><br>
      <span class="post-time small text-muted">27th January 2009 14:00 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Actually i searched the forum before posting...<br>
      <br>
      Hopefully Takhir will find this post &amp; reply :-)</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Takhir</span><br>
      <span class="post-time small text-muted">27th January 2009 14:41 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">'Close or Terminate' means that plug-in first sends WM_CLOSE to application and then (optionaly) terminates application. 'Find only' mode not supported in current version (may be in next release? :) ). But you can try to find application by file name, for example <a href="http://nsis.sourceforge.net/KillProc_plug-in" target="_blank">http://nsis.sourceforge.net/KillProc_plug-in</a><br>
      Also - plug-in returns number of not closed/terminated processes.</p>
    </div>
    <hr>

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]></script></body></html>