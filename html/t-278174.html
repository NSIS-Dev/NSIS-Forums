<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="description" content="Problem with Vista/RequestExecutionLevel"><title>Problem with Vista/RequestExecutionLevel - NSIS Forums</title><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script><link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css"><link rel="stylesheet" href="../css/style.css" type="text/css"><!--[if lt IE 9]><script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script><script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script><![endif]--></head><body><div class="container"><ol class="breadcrumb"><li><a href="../index.html" class="glyphicon glyphicon-home"></a></li><li><a href="f-65.html">NSIS Discussion</a></li><li class="active">Problem with Vista/RequestExecutionLevel</li></ol><p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=278174">Problem with Vista/RequestExecutionLevel</a></p><br><div class="post"><p class="post-meta"><span class="post-author text-primary">jory99</span><br><span class="post-time small text-muted">1st October 2007 12:35 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>Problem with Vista/RequestExecutionLevel</strong><br>Hi Forum,<br><br>I am currently porting our Windows XP installer to Vista. I am using 'RequestExecutionLevel admin' to make it run using appropriate privileges.<br><br>The problem is, when I use this the shortcuts get installed for the privileged account (local administrator in this case) rather than the account of the desktop user that started the installer. Is there a way around this?<br><br>I have also tried using an installer without 'RequestExecutionLevel admin', but then I get a notification at the end saying that the installation was not correct.<br><br>Thanks in advance for any help.<br>Jonas</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Anders</span><br><span class="post-time small text-muted">1st October 2007 16:50 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">use "SetShellVarContext all" before you create the shortcuts (this will put them in the "all users" startmenu, if you don't want a all users type install, you could use the UAC plugin and executecodesegment, but its not pretty)</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">jory99</span><br><span class="post-time small text-muted">2nd October 2007 13:03 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Thanks Anders,<br><br>I would prefer not to install for all users, so I'll look into your tip re UAC plugin!<br><br>Thanks for your help.<br>Jonas</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Anders</span><br><span class="post-time small text-muted">2nd October 2007 13:21 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Its not really about what you prefer, with vista and an installer running as admin, the installer might not be running as the user you think it is running as (It could be elevated with an admin account, different from the user's explorer.exe etc.) So unless you are installing a driver or something that really needs admin rights, you might want to try to make it work as a normal user</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">smatte</span><br><span class="post-time small text-muted">2nd October 2007 18:22 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">You should read about bootstrapping. You'll have to split your installer to have an installer running as user that start an other installer as admin to install files.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Anders</span><br><span class="post-time small text-muted">2nd October 2007 18:35 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"></p><blockquote><i>Originally posted by smatte</i><br><b>You should read about bootstrapping. You'll have to split your installer to have an installer running as user that start an other installer as admin to install files.</b></blockquote>This is exactly what the UAC plugin does</div><hr><div class="footer"><p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p></div></div><script src="../js/highlight.pack.js" type="text/javascript"></script><script type="text/javascript">//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]></script></body></html>