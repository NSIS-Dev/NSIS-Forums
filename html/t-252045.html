<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="description" content="Help ! Writing into an Custom Page Input Box"><title>Help ! Writing into an Custom Page Input Box - NSIS Forums</title><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script><link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css"><link rel="stylesheet" href="../css/style.css" type="text/css"></head><body><div class="container"><ol class="breadcrumb"><li><a href="../index.html" class="glyphicon glyphicon-home"></a></li><li><a href="f-65.html">NSIS Discussion</a></li><li class="active">Help ! Writing into an Custom Page Input Box</li></ol><p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=252045">Help ! Writing into an Custom Page Input Box</a></p><br><div class="post"><p class="post-meta"><span class="post-author text-primary">baskaran.vishnu</span><br><span class="post-time small text-muted">27th July 2006 10:05 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>Help ! Writing into an Custom Page Input Box</strong><br>Hi,<br><br>I have a question regarding writing into an input field of a custom page.<br><br>I have a custom page with an input box with the codes as seen below;<br><b><br>var \GLOBAL PORTNO #Global variable to hold the Port Number<br>Page Custom AddOptionShow AddOptionCheck<br><br>Function .onInit<br><br>!insermacro MUI_INSTALLOPTIONS_EXTRACT_AS "Forms\AddOption.ini" "AddOps"<br><br>FunctionEnd<br><br>Function AddOptionShow<br>!insertmacro MUI_INSTALLOPTIONS_INITDIALOG "AddOps"<br>!insertmacro MUI_INSTALLOPTIONS_SHOW<br>FunctionEnd<br><br>Function AddOptionCheck<br>/* Link the function to the AddOption.ini */<br>!insertmacro MUI_INSTALLOPTIONS_READ $PORTNO "AddOps" "Field 2" "State"<br><br>${if} $PORTNO == "" #Empty/Blank Port Number<br>MessageBox MB_OK "Error: Port Number Must Not be empty !"<br><br>/* Write back a default Port Number into the Input Box */<br>!insertmacro MUI_INSTALLOPTIONS_WRITE "AddOps" "Field 2" "8080"<br>Abort #Back to the Port page<br><br>${else}<br>MessageBox MB_OK "Success! Port Number entered is: $PORT"<br>goto END<br>${endif}<br><br>END:<br>FunctionEnd<br></b><br><br>Based on the codes above, Function AddOptionShow initializes and displays the custom page. Function AddOptionCheck checks the keyed in Port number. If the Port Number is NULL (Blank field), I would get a returned error message and the installer would enter back a default Port number of "8080" into the Port input field<br><br>However, the '!insertmacro MUI_INSTALLOPTIONS_WRITE "AddOps" "Field 2" "8080"' <b>does not seem to write 8080 into the Port Input field.</b><br><br>Is there a way which i could write back into the input box after displaying the error message ?<br><br>Thanks very much for any ideas or help.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br><span class="post-time small text-muted">27th July 2006 10:32 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">InstallOptions doesn't read the INI file again when you call Abort in the Leave function. If it did, you'd notice a bit of a pause before the dialog was shown. The dialog is still in memory in the Leave function, so you can modify the dialog with SendMessage.<br><br>Examples\InstallOptions\testnotify.nsi is a good example.<br>Check its Leave function where it uses EnableWindow, SendMessage etc to modify the dialog controls.<br><br>-Stu</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">y2kanily2k</span><br><span class="post-time small text-muted">28th July 2006 12:49 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Hey, You can try like this<br><br>!insertmacro MUI_INSTALLOPTIONS_WRITE "AddOps" "Field 2" "State" "8080"<br><br>The above will work good.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br><span class="post-time small text-muted">28th July 2006 12:54 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">He was missing "State" yes, but it will still not work. Read my message above.<br><br>-Stu</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">baskaran.vishnu</span><br><span class="post-time small text-muted">14th August 2006 05:04 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Hi,<br><br>Sorry for my late reply. Thanks Afrow on your guide.<br><br>I was able to use the <b>SendMessage</b> command in NSIS to actually send back a default Port Number to the specific Input box.<br><br>But, I would also like to bring your attention to focus issue for the input box. At the moment, when the custom page loads, I would set focus to the Port Number input box to make it easier for the to directly key in the port number, instead of having to drag the mouse cursor into the input box. The sample code is as shown below;<br><br><b><br>var \GLOBAL PORTNO #Global variable to hold the Port Number<br>Page Custom AddOptionShow AddOptionCheck<br><br>Function .onInit<br><br>!insermacro MUI_INSTALLOPTIONS_EXTRACT_AS "Forms\AddOption.ini" "AddOps"<br><br>FunctionEnd<br><br>Function AddOptionShow<br>!insertmacro MUI_INSTALLOPTIONS_INITDIALOG "AddOps"<br><br>/* Set Focus for the Port Number field */<br>Push "$PLUGINSDIR\AddOps"<br>Push "$R0"<br>Push "2" #the field number of the Port Number Input Box<br>Call SetFocus #Function to Set Focus to a specific Input Box<br>!insertmacro MUI_INSTALLOPTIONS_SHOW<br>FunctionEnd<br><br>Function AddOptionCheck<br>/* Link the function to the AddOption.ini */<br>!insertmacro MUI_INSTALLOPTIONS_READ $PORTNO "AddOps" "Field 2" "State"<br><br>${if} $PORTNO == "" #Empty/Blank Port Number<br>MessageBox MB_OK "Error: Port Number Must Not be empty !"<br><br>/* Write back a default Port Number and SetFocus into the Input Box */<br>!insertmacro MUI_INSTALLOPTIONS_READ $R1 "AddOps" "Field 2" "HWND"<br>SendMessage $R1 ${WM_SETFOCUS} 0 0<br>SendMessage $R1 ${WM_SETTEXT} 0 "STR:8080"<br><br>Abort #Back to the Port page<br><br>${else}<br>MessageBox MB_OK "Success! Port Number entered is: $PORT"<br>goto END<br>${endif}<br><br>END:<br>FunctionEnd<br></b><br><br>From the code above, During the custom page loadup, I have used the SetFocus function to set focus into the InputField of the Port Number (<a href="http://nsis.sourceforge.net/Set_Focus_to_a_Control" target="_blank">http://nsis.sourceforge.net/Set_Focus_to_a_Control</a>)<br><br>Once the Next button is pressed, if the Port Number is empty, the error message would be displayed followed by the SendMessage command to populate the PortNumber Input box with a default value (8080) as well as Set Focus into it. This works, the number 8080 is loaded into the Input box and the cursor has been focused into it. <b>But, I can't seem to type into the Port Number box anymore !</b><br><br>I have tried typing some extra numbers into it, but nothing gets typed into it despite the cursor being focused into the PortNumber input box. <b>If I were to remove the 'SendMessage $R1 ${WM_SETFOCUS} 0 0' command, I could type into the PortNumber Input box.</b><br><br>I am not sure where I have gone wrong. Thanks a million for any available help.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br><span class="post-time small text-muted">14th August 2006 10:45 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">You need a Pop $R0 after<br>!insertmacro MUI_INSTALLOPTIONS_INITDIALOG<br>See the usage example on that page.<br><br>You may also need to call that function again instead of a basic SendMessage with ${WM_SETFOCUS}.<br><br>-Stu</p></div><hr><div class="footer"><p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p></div></div><script src="../js/highlight.pack.js" type="text/javascript"></script><script type="text/javascript">//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]></script></body></html>