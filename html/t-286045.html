<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="make a custom plugin ?" />

  <title>make a custom plugin ? - NSIS Forums</title><!-- Bootstrap core CSS -->
  <link rel="stylesheet" type="text/css" href="//netdna.bootstrapcdn.com/bootswatch/3.0.1/readable/bootstrap.min.css" />
  <link rel="stylesheet" href="../css/style.css" type="text/css" /><!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!--[if lt IE 9]>
                <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
                <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->
</head>

<body>
  <div class="container">
    <!-- Put navigation bar here -->

    <ol class="breadcrumb">
      <li><a href="../index.html" class="glyphicon glyphicon-home"></a></li>

      <li><a href="f-65.html">NSIS Discussion</a></li>

      <li class="active">make a custom plugin ?</li>
    </ol>

    <p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=286045">make a custom plugin ?</a></p><br />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">arfgh</span><br />
      <span class="post-time small text-muted">31st January 2008 18:07 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>make a custom plugin ?</strong><br />
      i need to use some plugin in my program<br />
      Exactly is the FindProc. But this one is copyrighted and bytheway i got the decission to make my own plugin to find the process.<br />
      <br />
      The nsis plugins are simple dlls ? or i must know something more to make them ?<br />
      <br />
      example: This dll i told is usage like this:<br />
      <br />
      FindProcDLL::FindProc "process_name.exe"<br />
      <br />
      and the result come in the $R0 variable.<br />
      What i must do in my dll to return th result on this variable ?</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Joel</span><br />
      <span class="post-time small text-muted">31st January 2008 19:12 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">setuservariable function will return stuff on nsis stack. I assuming that you already familiar with some c or c++ background and you have read exdll @ nsis source code.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">arfgh</span><br />
      <span class="post-time small text-muted">31st January 2008 19:37 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">well<br />
      i can make normal dlls using also vb6.<br />
      But i dont know if the structure of the nsis dll plugins must have some special.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
      <span class="post-time small text-muted">1st February 2008 08:48 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">You can't write plug-ins in VB. You'll need to learn a bit of C/C++ or Delphi. Other option is to write a VB6 executable but you'd have to install the VB6 run times first.<br />
      <br />
      Stu</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">arfgh</span><br />
      <span class="post-time small text-muted">1st February 2008 13:31 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">sorry afrow UK, but VB6 is able to produce normal dlls as C/C++ do. The limitation to produce activex dlls was for the past.<br />
      <br />
      i only need some documentation to know the special things on the dll to give the result of the built in dll function to the variable R0 as do this other plugin i related.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
      <span class="post-time small text-muted">1st February 2008 14:54 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Yes you can create dll's in VB6 but whether you can call them using the calling convention and whether you can access the information that is passed to the dll is another matter.<br />
      <br />
      If you are able to, it will be helpful to others.<br />
      <br />
      Stu</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Joel</span><br />
      <span class="post-time small text-muted">1st February 2008 14:55 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"></p>

      <blockquote>
        <i>Originally posted by arfgh</i><br />
        <b>sorry afrow UK, but VB6 is able to produce normal dlls as C/C++ do. The limitation to produce activex dlls was for the past.<br />
        <br />
        i only need some documentation to know the special things on the dll to give the result of the built in dll function to the variable R0 as do this other plugin i related.</b>
      </blockquote>Now, that's very wrong, VB doesn't create "normall" dlls, because the dllmain entry points directly to visual basic 6 runtime, meaning only vb 6 apps can use them. But I think that there are some wrappers that can call you vb6 activex from C.<br />
      As I told you setuservariable, from exdll.h, has the "C" function to return values to the stack, like $R0.<br />
      I repeat, you can't use vb's dll directly with nsis as pointed by stu.
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">arfgh</span><br />
      <span class="post-time small text-muted">1st February 2008 15:21 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">ok, i go to repeat.<br />
      <br />
      VB6 by default only is able to create activex DLLs.<br />
      But doing a simple modification to the linker, is able to produce normal dlls as in C !<br />
      <br />
      for that reason must be possible to create plugin for nsis using vb6.<br />
      <br />
      I just need only the info or documentation to know how to give the result of the function on the r0 variable as do for example the plugin called FindProcDll.<br />
      <br />
      can someon help ?</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">arfgh</span><br />
      <span class="post-time small text-muted">6th February 2008 00:40 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">at finaly nobody can tell me why i cant do that ?<br />
      <br />
      i am able to load my dll from the c++ with<br />
      <br />
      hDLL = LoadLibrary("test.dll");<br />
      <br />
      <br />
      Then why i cant use it with nsis ?</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Anders</span><br />
      <span class="post-time small text-muted">6th February 2008 00:48 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">use <a href="http://www.dependencywalker.com/" target="_blank">http://www.dependencywalker.com/</a> to make sure the exported function's name is correnct (no name mangling)<br />
      <br />
      also, exports must use the _cdecl calling convention</p>
    </div>
    <hr />

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]>
  </script>
</body>
</html>
