<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="If app is running (extended)" />

  <title>If app is running (extended) - NSIS Forums</title><!-- Bootstrap core CSS -->
  <link rel="stylesheet" type="text/css" href="//netdna.bootstrapcdn.com/bootswatch/3.0.1/readable/bootstrap.min.css" />
  <link rel="stylesheet" href="../css/style.css" type="text/css" /><!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!--[if lt IE 9]>
                <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
                <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->
</head>

<body>
  <div class="container">
    <!-- Put navigation bar here -->

    <ol class="breadcrumb">
      <li><a href="../index.html" class="glyphicon glyphicon-home"></a></li>

      <li><a href="f-65.html">NSIS Discussion</a></li>

      <li class="active">If app is running (extended)</li>
    </ol>

    <p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=200228">If app is running (extended)</a></p><br />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">joshhh</span><br />
      <span class="post-time small text-muted">25th November 2004 22:08 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>If app is running (extended)</strong><br />
      I know that i can detect my app useing FindProc and kill by KillProc plugins. But i want to make following: make simple dialog to colse my application. My app uses /quit key to exit.<br />
      <br /></p>
      <pre>
<code><br />sample of what i want to see:<br />1)FindProc find my app<br />2)tell "app is running" "close?" YES|NO<br />3)If YES try to colse it useing "app.exe /quit" key or KillProc. For "/quit" key i think plugin must detect full path to "*.exe", don't know is it possible?<br />4)If NO go to 1'st page of installer<br />5)FindProc don't find my app =&gt; goto 1'st page of installer<br /></code>
</pre><br />
      <br />
      any suggestions? or samples?
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">joshhh</span><br />
      <span class="post-time small text-muted">30th November 2004 21:16 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"></p>
      <pre>
<code>Section /o      $(ITEM_Closeif) Closeif<br /><br />  FindProcDLL::FindProc "app.exe"  <br />  StrCmp $R0 1 found notfound<br /><br />found:<br />  MessageBox MB_YESNO $(infobox) IDYES true IDNO ;done<br /><br />true:<br />  KillProcDLL::KillProc "app.exe"<br />  Sleep 2000<br /><br />;  Goto done:<br /><br />notfound:<br />;MessageBox MB_OK "App not running." IDOK ;done<br />;done:<br /><br />SectionEnd</code>
</pre>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Takhir</span><br />
      <span class="post-time small text-muted">1st December 2004 09:35 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><i>-&gt; Warning:<br />
      According to MSDN (MicroSoft Developers Network):<br />
      <br />
      The TerminateProcess function is used to unconditionally cause a process to exit. Use it only in extreme circumstances. The state of global data maintained by dynamic-link libraries (DLLs) may be compromised if TerminateProcess is used rather than ExitProcess.<br />
      <br />
      So use this DLL carefully as your LAST and EXTREME option :)<br /></i><br />
      KillProc as a first step - it's like a tooth removing on any pain.. Current data will be lost, application files (exe, dll and opened i/o files) may stay marked in system as "in use" - possible problems with deletion without reboot.. WM_CLOSE for a non-dos apps is a good idea as a first step :)</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">joshhh</span><br />
      <span class="post-time small text-muted">5th December 2004 11:28 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">My app doesnt read or write anything(system monitor) thats why I can Kill it with no problem.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
      <span class="post-time small text-muted">5th December 2004 12:17 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">You should be using WM_CLOSE rather than the KillProc dll. Like Takhir says, you should only use KillProc dll as a last resort. You should use SendMessage ... first, then check if the program is running and <i>then</i> use KillProc if necessary.<br />
      <br />
      -Stu</p>
    </div>
    <hr />

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]>
  </script>
</body>
</html>
