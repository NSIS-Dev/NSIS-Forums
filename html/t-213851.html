<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="description" content="outsourcing functions to own &quot;units&quot; ?"><title>outsourcing functions to own "units" ? - NSIS Forums</title><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script><link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css"><link rel="stylesheet" href="../css/style.css" type="text/css"><!--[if lt IE 9]><script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script><script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script><![endif]--></head><body><div class="container"><ol class="breadcrumb"><li><a href="../index.html" class="glyphicon glyphicon-home"></a></li><li><a href="f-65.html">NSIS Discussion</a></li><li class="active">outsourcing functions to own "units" ?</li></ol><p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=213851">outsourcing functions to own "units" ?</a></p><br><div class="post"><p class="post-meta"><span class="post-author text-primary">Huette</span><br><span class="post-time small text-muted">22nd April 2005 09:03 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>outsourcing functions to own "units" ?</strong><br>Hi!<br>is there any documentation about outsourcing my own functions to external "units"?<br>i would like to use some functions in different projects, so it would be nice to write them in one "unit" and include it to the different projects. possible? didn't find anything about that in this forum or help / readmes.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">glory_man</span><br><span class="post-time small text-muted">22nd April 2005 11:52 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">If you mean parts of code writen in NSIS then you can use .nsh -file (NSIS header file). Put your functions in it and add this file to your script with !include command.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Huette</span><br><span class="post-time small text-muted">22nd April 2005 12:19 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">yes, that's what i mean. sounds easy. i'll try.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Huette</span><br><span class="post-time small text-muted">28th April 2005 14:18 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">today i continued to work on my script and i got a strange error, when i try to work with functions in external nsh files:<br><br>!include: closed: "C:\Programme\NSIS\Include\CustFunctions.nsh"<br><br>Processed 1 file, writing output:<br>Error: invalid script: never had OutFile command<br>Error - aborting creation process<br><br>...i copied a function from my mainscript and saved it in a nsh-file (included Function/FunctionEnd. - nothing else above or below). when i comment the line<br>!include "CustFunctions.nsh" and the function i copied is still in my mainscript everything works fine. But when i comment the function and activate the !include-line, i got that outfile-error.<br>my include line follows the !include "mui.nsh" - line.<br>What am i doing wrong? Anybody got an idea?</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">rasermar</span><br><span class="post-time small text-muted">28th April 2005 14:35 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">this should not work:<br></p><pre>
<code>!include: closed: "C:\Programme\NSIS\Include\CustFunctions.nsh"</code>
</pre><br><br>try this instead:<br><pre>
<code>!include "C:\Programme\NSIS\Include\CustFunctions.nsh"</code>
</pre><br><br>The call to the functions on the included file can be done as ordinary.<br><br>And review the documentation this is explained there.<br><br>regards.</div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br><span class="post-time small text-muted">28th April 2005 15:18 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"></p><blockquote><i>Originally posted by rasermar</i><br><b>this should not work:<br></b><pre>
<b><code>!include: closed: "C:\Programme\NSIS\Include\CustFunctions.nsh"</code></b>
</pre><b><br><br>try this instead:<br></b><pre>
<b><code>!include "C:\Programme\NSIS\Include\CustFunctions.nsh"</code></b>
</pre><b><br><br>The call to the functions on the included file can be done as ordinary.<br><br>And review the documentation this is explained there.<br><br>regards.</b></blockquote>rasermar, he copied that from the compiler window (it's compiler output) where it's closed his !include after reading it.<br><br>The error is there... You're missing the OutFile command.<br><br>-Stu</div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Huette</span><br><span class="post-time small text-muted">28th April 2005 16:26 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">you got it afrow =) it's the error-message, not my sourcecode<br><br>but the error-message doesn't make any sense imho. i got the outfile command in my mainscript....and if i don't use that function of my nsh-file, but exactly the same of my mainscript, it works.<br><br>i am not sure, but i think it already worked with the outsourced code on last friday and i didn't change any code since that day. could it be caused by some changes in preferences or something like that? tomorrow i will look into it more exactly.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Comm@nder21</span><br><span class="post-time small text-muted">28th April 2005 16:28 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">the out file command should be close to the beginning of the script.<br>any function should be after it i think.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Huette</span><br><span class="post-time small text-muted">29th April 2005 10:58 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">well, i'm a bit confused, but now it works again. i just set the outfile-command to some different places. the order was var-lines, !include-lines, outfile-line. then i set the outfile-line above the !include-lines and compiled the script. i just got a few zeroing-code-warnings (why? no idea). then i saved both scripts and opened them again. suddenly they were working. after that i set the lines to their old positions and it still works...<br><br>sounds like a nsis-bug...but i'm not sure...maybe i overlooked something...<br><br>(sry, if my english is kinda bad - just overlook ;) )</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Huette</span><br><span class="post-time small text-muted">29th April 2005 11:49 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">i found out the cause of that problem. i try to subcribe. last week i tried to add another function (not that one i'm talkin about above) from my mainscript (there it was working correct) to my secondary-script. apparently i got an error (maybe the same) that day, deleted the function, added it back to my mainsript and stopped working. with the second function in the secondary-script i must have temporary made some chaos in nsis and nothing worked, though the function was in my main-script again. the second function is:<br><br>Function "FillLbl" ;keine RÃ¼ckgabe<br>FindWindow $2 "#32770" "" $HWNDPARENT<br>GetDlgItem $2 $2 $1<br>CreateFont $3 "Arial" 8 0<br>SendMessage $2 ${WM_SETFONT} $3 0<br>SendMessage $2 ${WM_SETTEXT} 0 "STR:$0"<br>FunctionEnd<br><br>i think the exchange of the variables could be the problem....no idea...</p></div><hr><div class="footer"><p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p></div></div><script src="../js/highlight.pack.js" type="text/javascript"></script><script type="text/javascript">//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]></script></body></html>