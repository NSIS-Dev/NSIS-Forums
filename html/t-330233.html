<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="ARP registry - quotes or no quotes" />

  <title>ARP registry - quotes or no quotes - NSIS Forums</title><!-- Bootstrap core CSS -->
  <link rel="stylesheet" type="text/css" href="//netdna.bootstrapcdn.com/bootswatch/3.0.1/readable/bootstrap.min.css" />
  <link rel="stylesheet" href="../css/style.css" type="text/css" /><!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!--[if lt IE 9]>
                <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
                <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->
</head>

<body>
  <div class="container">
    <!-- Put navigation bar here -->

    <ol class="breadcrumb">
      <li><a href="../index.html" class="glyphicon glyphicon-home"></a></li>

      <li><a href="f-65.html">NSIS Discussion</a></li>

      <li class="active">ARP registry - quotes or no quotes</li>
    </ol>

    <p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=330233">ARP registry - quotes or no quotes</a></p><br />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">MSG</span><br />
      <span class="post-time small text-muted">2nd May 2011 06:55 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>ARP registry - quotes or no quotes</strong><br />
      This has bothered me for some time now. In the wiki: <a href="http://nsis.sourceforge.net/Add_uninstall_information_to_Add/Remove_Programs" target="_blank">http://nsis.sourceforge.net/Add_unin...emove_Programs</a><br />
      Some guy says that "you should always quote the path to make sure spaces in the path will not disrupt Windows to find the uninstaller." So the wiki example ends up with this:<br />
      WriteRegStr HKLM "Software\Microsoft\Windows\CurrentVersion\Uninstall\ImageMaker" "UninstallString" "$\"$INSTDIR\uninstall.exe$\""<br />
      <br />
      As far as I can judge this is just plain wrong. I never quote the path, and it works just fine. Is there some legacy reason why one would add quotes to the regstring? Because if not, I'm going to delete this erroneous info from the wiki.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
      <span class="post-time small text-muted">2nd May 2011 09:51 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">You should add quotes in case the path contains spaces. ExecWait in the docs explains why.<br />
      <br />
      Stu</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Smurge</span><br />
      <span class="post-time small text-muted">2nd May 2011 10:57 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Windows itself does not need any "" on path or any value in the registry, as far as i know.<br />
      <br />
      I have tested an installation without "" after the "InstallPath" and used ()+´á# and space in the install path. It deinstalled without error.<br />
      Maybe it depends on the app itself if "" is needed or not. e.g. for switches or functions of the .exe!?<br />
      <br />
      ExecWait starts an application outside the installer. This have nothing to do with the Registry entry.<br />
      I guess it need quotesin this case, because it calls the .exe similar as cmd.exe does...<br />
      <br />
      bye</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Anders</span><br />
      <span class="post-time small text-muted">2nd May 2011 11:27 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"></p>

      <blockquote>
        <small>Originally posted by Smurge</small><br />
        Windows itself does not need any "" on path or any value in the registry, as far as i know.
      </blockquote>You know this is not true, but lets stick to uninstall in this thread...<br />
      <br />

      <blockquote>
        <small>Originally posted by Smurge</small><br />
        I have tested ...
      </blockquote>But did you test on Win95 and NT4? I'm sure it tells you to use quotes for a reason.
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
      <span class="post-time small text-muted">2nd May 2011 11:35 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Add/remove programs handles the path fine on newer OSs with or without quotes probably because it has to deal with the people who have not used them. But one issue goes to your own installer which may want to read the registry value to uninstall a previously installed version. If you've missed quotes from the path and then add /S, it could fail.<br />
      <br /></p>

      <blockquote>
        ExecWait starts an application outside the installer. This have nothing to do with the Registry entry.
      </blockquote>Well of course, but ExecWait uses the CreateProcess API which recommends you should use quotes:

      <blockquote>
        If you are using a long file name that contains a space, use quoted strings to indicate where the file name ends and the arguments begin; otherwise, the file name is ambiguous. For example, consider the string "c:\program files\sub dir\program name". This string can be interpreted in a number of ways. The system tries to interpret the possibilities in the following order:<br />
        <br />
        c:\program.exe files\sub dir\program name<br />
        c:\program files\sub.exe dir\program name<br />
        c:\program files\sub dir\program.exe name<br />
        c:\program files\sub dir\program name.exe
      </blockquote>Stu
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Smurge</span><br />
      <span class="post-time small text-muted">2nd May 2011 11:42 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"></p>

      <blockquote>
        But did you test on Win95 and NT4? I'm sure it tells you to use quotes for a reason.
      </blockquote>ähm, i tested it on 98SE. I thought this is the oldest version anyone will use... but maybe im wrong ;)
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
      <span class="post-time small text-muted">2nd May 2011 11:50 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"></p>

      <blockquote>
        <small>Originally posted by Smurge</small><br />
        ähm, i tested it on 98SE. I thought this is the oldest version anyone will use... but maybe im wrong ;)
      </blockquote>You're arguing with Microsoft, not us lol.<br />
      <br />
      Stu
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">MSG</span><br />
      <span class="post-time small text-muted">2nd May 2011 18:56 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Stu, thanks for clearing that up, I had not thought of the parameter ambiguity problem. And even without params, if it's officially required by MS then the wiki info is technically correct.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Anders</span><br />
      <span class="post-time small text-muted">2nd May 2011 20:41 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">I could not actually find MS docs that state that the path should be quoted but MSDN is 2000+ these days, and the uninstall info is MSI specific :(</p>
    </div>
    <hr />

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]>
  </script>
</body>
</html>
