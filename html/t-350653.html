<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="description" content="Create shortcut problrm in windows 8"><title>Create shortcut problrm in windows 8 - NSIS Forums</title><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script><link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css"><link rel="stylesheet" href="../css/style.css" type="text/css"><!--[if lt IE 9]><script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script><script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script><![endif]--></head><body><div class="container"><ol class="breadcrumb"><li><a href="../index.html" class="glyphicon glyphicon-home"></a></li><li><a href="f-65.html">NSIS Discussion</a></li><li class="active">Create shortcut problrm in windows 8</li></ol><p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=350653">Create shortcut problrm in windows 8</a></p><br><div class="post"><p class="post-meta"><span class="post-author text-primary">winman2004</span><br><span class="post-time small text-muted">26th October 2012 07:18 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>Create shortcut problrm in windows 8</strong><br>I am using NSIS to create my application.It is working fine in windows xp,vista and windows 7.<br>but in windows 8 shortcut of my application in desktop is not creating.But in other OS it's creating shortcut in desktop properly.Why does it doesnt create shortcut in windows 8 OS?Is there any solution to solve this?</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">winman2004</span><br><span class="post-time small text-muted">26th October 2012 14:57 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">I want to add some more details for above problem.I was trying to find out the error of creating shortcut.I did a small testing with CreateShortcuts.<br>Below is a part of coding.<br><br>!macro CreateShortcuts<br>Messagebox MB_OK "$Desktop"<br>CreateShortCut "$Desktop\nvt.lnk" "$INSTDIR\Database2.mdb"<br>CreateShortCut "$INSTDIR\nvt.lnk" "$INSTDIR\Database2.mdb"<br>copyfiles "$Desktop\test\test.txt" "$Desktop"<br>!macroend<br><br>The Messagebox MB_OK "$Desktop" displays output as "D:\Desktop" which is proper in my case.<br>But CreateShortCut "$Desktop\nvt.lnk" "$INSTDIR\Database2.mdb" creates a shortcut in C:\Documents and Settings\winman\Desktop path only in windows 8.but in other OS(xp etc) the shortcut is created in D:\desktop<br>here is some interesting thing<br>copyfiles "$Desktop\test\test.txt" "$Desktop" copies file from D:\Desktop\test\test.txt to D:\desktop in both windows 8 and other OS.<br>So how this copyfiles and createshortcut behave differently for $Desktop at same time?<br>So is the problem of creating shortcut is a problem with NSIS or something else.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Anders</span><br><span class="post-time small text-muted">26th October 2012 17:40 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">NSIS uses the documented CSIDL_DESKTOPDIRECTORY constant to get the folder.<br><br>Could you run <a href="http://pastebin.com/gztsZbyi" target="_blank">http://pastebin.com/gztsZbyi</a> and paste the output?</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Anders</span><br><span class="post-time small text-muted">26th October 2012 18:14 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">NSIS uses the normal COM shortcut interface to create the shortcut, I suspect Windows is trying to "help" by tweaking the PIDL stored in the shortcut...</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">winman2004</span><br><span class="post-time small text-muted">27th October 2012 08:11 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Thank u Andres for replying me.. I tried running what u have told(<a href="http://pastebin.com/gztsZbyi" target="_blank">http://pastebin.com/gztsZbyi</a>). when i run this nsistest.exe is created in D:\Desktop in both windows 8 and windows xp. So what does it mean?Is it problem with createshortcut or something else?</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">MSG</span><br><span class="post-time small text-muted">27th October 2012 09:39 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">winman: Please paste the install log here. Anders needs the text printed there with the detailprint commands.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">winman2004</span><br><span class="post-time small text-muted">27th October 2012 10:31 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">this was the log of installation(for this <a href="http://pastebin.com/gztsZbyi" target="_blank">http://pastebin.com/gztsZbyi</a> )<br>$Desktop=D:\Desktop<br>shfolder(0)<br>SHGetFolderPathA=D:\Desktop<br>SHGetFolderPathW=D:\Desktop<br>shell32(0)<br>SHGetSpecialFolderLocation=D:\Desktop<br>SHGetSpecialFolderPathA=D:\Desktop<br>SHGetSpecialFolderPathW=D:\Desktop<br>SHGetFolderPathA=D:\Desktop<br>SHGetFolderPathW=D:\Desktop<br>shfolder(0x10)<br>SHGetFolderPathA=D:\Desktop<br>SHGetFolderPathW=D:\Desktop<br>shell32(0x10)<br>SHGetSpecialFolderLocation=D:\Desktop<br>SHGetSpecialFolderPathA=D:\Desktop<br>SHGetSpecialFolderPathW=D:\Desktop<br>SHGetFolderPathA=D:\Desktop<br>SHGetFolderPathW=D:\Desktop<br>SHGetKnownFolderPath=D:\Desktop<br>Done (NSIS v2.46, Win 6.2.9200 SP=0 IsWow64=0)</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Anders</span><br><span class="post-time small text-muted">29th October 2012 21:57 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Could you please run <a href="http://pastebin.com/PUFCS1gZ" target="_blank">http://pastebin.com/PUFCS1gZ</a> and paste the output?</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">winman2004</span><br><span class="post-time small text-muted">2nd November 2012 06:55 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">I tested <a href="http://pastebin.com/PUFCS1gZ" target="_blank">http://pastebin.com/PUFCS1gZ</a> in windows 8 and output was<br>Output folder: F:\Users\winman\AppData\Local\Temp<br>$Desktop=D:\Desktop<br>SHGetFolderPathA:SHGFP_TYPE_DEFAULT=F:\Users\winman\Desktop<br>Saved 1="D:\Desktop\test_1.lnk"|hr=0|exists=YES|lastop=0<br>Saved 2="D:\Desktop\test_2.lnk"|hr=0|exists=YES|lastop=0<br>Saved 3="D:\Desktop\test_3.lnk"|hr=0|exists=YES|lastop=0<br>Saved 4="D:\Desktop\test_4.lnk"|hr=0|exists=YES|lastop=0<br>Create shortcut: D:\Desktop\test_0.lnk<br>Saved normal, error=NO<br>Done (NSIS v2.46, Win 6.2.9200 SP=0 IsWow64=0)<br><br>Also i got nsistest.exe and shortcuts test_0,test_1,test_2,test_3,test_4. All in D:\desktop itself..</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Anders</span><br><span class="post-time small text-muted">2nd November 2012 07:18 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">You should try adding requestexecutionlevel to your script and see if that fixes it...</p></div><hr><div class="footer"><p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p></div></div><script src="../js/highlight.pack.js" type="text/javascript"></script><script type="text/javascript">//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]></script></body></html>