<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="description" content="Execwait doesnt working in Windows 7"><title>Execwait doesnt working in Windows 7 - NSIS Forums</title><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script><link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css"><link rel="stylesheet" href="../css/style.css" type="text/css"></head><body><div class="container"><ol class="breadcrumb"><li><a href="../index.html" class="glyphicon glyphicon-home"></a></li><li><a href="f-65.html">NSIS Discussion</a></li><li class="active">Execwait doesnt working in Windows 7</li></ol><p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=343089">Execwait doesnt working in Windows 7</a></p><br><div class="post"><p class="post-meta"><span class="post-author text-primary">udaymahajan</span><br><span class="post-time small text-muted">12th March 2012 14:35 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>Execwait doesnt working in Windows 7</strong><br>Hi,<br>I want to call an exe to execute using nsis.<br>To execute the exe i have used code as follow<br><br>SetOutPath $INSTDIR\SoundBite<br>File Files\DotNetInstall.bat<br>File Files\dotNetFx40_Full_x86_x64.exe<br>Execwait '"$INSTDIR\SoundBite\dotNetFx40_Full_x86_x64.exe" /norestart'<br><br>after compiling .nsi file it creates an exe file.<br>But executing that .exe file it doesnt start the dotNetFx40_Full_x86_x64.exe (setup file)<br>same its working in Windows XP but doesnt working in Windows 7.<br><br>So please suggest me how can I execute the same in windows 7.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">LoRd_MuldeR</span><br><span class="post-time small text-muted">12th March 2012 14:51 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Your syntax looks correct. But does your installer use "RequestExecutionLevel admin" ???<br><br>If not, then it's probably UAC which is causing the problem here! ExecWait is implemented via CreateProcess(), which will simply <i>fail</i> if the calling application is not elevated and tries to run an executable that needs elevation (which the .NET installer probably does!). Alternatively you may want to try ExecShell, which will not fail but trigger an UAC Dialog in that case. ExecShell doesn't support waiting though. Therefore I have implemented an ExecShell function with Wait-capability in my StdUtils plug-in. This will allow you to run an elevated process (e.g. the .NET installer) from a <i>non</i>-elevated NSIS installer and still wait for it. I use that in my Auto Updater tool, for example...<br><br><b>See here:</b><br><a href="http://nsis.sourceforge.net/StdUtils_plug-in#ExecShellWait" target="_blank">http://nsis.sourceforge.net/StdUtils...#ExecShellWait</a></p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">MSG</span><br><span class="post-time small text-muted">12th March 2012 15:21 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">(Keep in mind that 'requestexecutionlevel admin' is NOT sufficient to get administrator access in your installer. You need to manually confirm admin access in .onInit using UserInfo plugin.)</p></div><hr><div class="footer"><p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p></div></div><script src="../js/highlight.pack.js" type="text/javascript"></script><script type="text/javascript">//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]></script></body></html>