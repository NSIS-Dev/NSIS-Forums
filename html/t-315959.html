<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="description" content="Silent install for .NET framework 2.0"><title>Silent install for .NET framework 2.0 - NSIS Forums</title><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script><link rel="preload" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css" as="style" onload="this.rel='stylesheet'"><link rel="preload" href="../css/style.css" as="style" onload="this.rel='stylesheet'"><noscript><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css"><link rel="stylesheet" href="../css/style.css"></noscript><script>!function(a){"use strict";var b=function(b,c,d){function e(a){return h.body?a():void setTimeout(function(){e(a)})}function f(){i.addEventListener&&i.removeEventListener("load",f),i.media=d||"all"}var g,h=a.document,i=h.createElement("link");if(c)g=c;else{var j=(h.body||h.getElementsByTagName("head")[0]).childNodes;g=j[j.length-1]}var k=h.styleSheets;i.rel="stylesheet",i.href=b,i.media="only x",e(function(){g.parentNode.insertBefore(i,c?g:g.nextSibling)});var l=function(a){for(var b=i.href,c=k.length;c--;)if(k[c].href===b)return a();setTimeout(function(){l(a)})};return i.addEventListener&&i.addEventListener("load",f),i.onloadcssdefined=l,l(f),i};"undefined"!=typeof exports?exports.loadCSS=b:a.loadCSS=b}("undefined"!=typeof global?global:this);!function(a){if(a.loadCSS){var b=loadCSS.relpreload={};if(b.support=function(){try{return a.document.createElement("link").relList.supports("preload")}catch(b){return!1}},b.poly=function(){for(var b=a.document.getElementsByTagName("link"),c=0;c<b.length;c++){var d=b[c];"preload"===d.rel&&"style"===d.getAttribute("as")&&(a.loadCSS(d.href,d,d.getAttribute("media")),d.rel=null)}},!b.support()){b.poly();var c=a.setInterval(b.poly,300);a.addEventListener&&a.addEventListener("load",function(){b.poly(),a.clearInterval(c)}),a.attachEvent&&a.attachEvent("onload",function(){a.clearInterval(c)})}}}(this);</script></head><body><div class="container"><ol class="breadcrumb"><li><a href="../index.html" class="glyphicon glyphicon-home"></a></li><li><a href="f-65.html">NSIS Discussion</a></li><li class="active">Silent install for .NET framework 2.0</li></ol><p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=315959">Silent install for .NET framework 2.0</a></p><br><div class="post"><p class="post-meta"><span class="post-author text-primary">jdt2oo7</span><br><span class="post-time small text-muted">2nd January 2010 21:51 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>Silent install for .NET framework 2.0</strong><br>Hi all,<br><br>I am having trouble install .NET framework 2.0 silently.<br><br>I have verified using command prompt and successfully install .NET framework 2.0 using:<br>dotnetfx.exe /q:a /c:â€install.exe /qâ€<br><br>But when I use it in script, it doesn't run the installation:<br>ExecWait '"$EXEDIR\Products\Microsoft Redistribute\dotnetfx.exe" /q:a /c:â€install.exe /qâ€' $ExitCode5<br><br>"Products\Microsoft Redistribute" is where I run dotnetfx.exe from.<br><br>I also add quotation mark as suggested in another thread:<br>ExecWait '"Products\Microsoft Redistribute\dotnetfx.exe" /q:a /c:$\â€install.exe /q$\â€' $ExitCode5<br><br>I have tried this also:<br>ExecWait '"$EXEDIR\Products\Microsoft Redistribute\dotnetfx.exe" /q' $ExitCode5<br><br>If you have any idea what is wrong, please let me know. This is so time consuming :(<br><br>I previously had posted question about Silent install for VS C++ 2008 SP1 Redistributable Package (x86), and that is working.<br><br><a href="http://forums.winamp.com/showthread.php?s=&amp;threadid=315810" target="_blank">http://forums.winamp.com/showthread....hreadid=315810</a></p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">meaningoflights</span><br><span class="post-time small text-muted">6th January 2010 02:20 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">!macro NET_INSTALL installer_path<br>;Check for framework 2.0â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€“<br>StrCpy $1 â€œ0?<br>ReadRegDword $1 HKLM â€œSOFTWARE\Microsoft\NET Framework Setup\NDP\v2.0.50727? â€œInstallâ€<br>${If} $1 != â€œ1?<br>${If} ${RunningX64}<br>StrCpy $9 â€˜â€${installer_path}\netfx64.exeâ€ /q /c:â€install.exe /qb /noaspupgradeâ€â€˜<br>${Else}<br>StrCpy $9 â€˜â€${installer_path}\dotnetfx2.0.exeâ€ /q /c:â€install.exe /qb /noaspupgradeâ€â€˜<br>${EndIf}<br>SetDetailsPrint both<br>DetailPrint â€œInstalling .Net Frameworkâ€<br>SetDetailsPrint none<br>!insertmacro EXEC_SUBINSTALLER â€œMicrosoft .Net Framework 2.0? $9<br>${EndIf}<br>!macroend</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">jdt2oo7</span><br><span class="post-time small text-muted">6th January 2010 02:50 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Thanks for your reply , meaningoflights.<br><br>I tried:<br>ExecWait '"$EXEDIR\Products\Microsoft Redistribute\dotnetfx.exe" /q /c:â€install.exe /qb /noaspupgradeâ€'<br><br>but it gave me "syntax error".<br><br>I wonder how you use it in:<br>!insertmacro EXEC_SUBINSTALLER â€œMicrosoft .Net Framework 2.0? $9<br><br>Thanks!</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">meaningoflights</span><br><span class="post-time small text-muted">6th January 2010 03:26 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">ok use this, I attached it as a ZIP so the characters dont get affected by html encoding:</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">jdt2oo7</span><br><span class="post-time small text-muted">6th January 2010 04:45 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Cool, seem to work when I use your Macro.<br><br>I am still seeing the extracting window and "Microsoft .NET Framework 2.0" window. Is there anyway we can hide those?<br><br>Thanks a lot!</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">meaningoflights</span><br><span class="post-time small text-muted">6th January 2010 05:02 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Looking at the command line parameters for the dotnetfx.exe there isn't a option to hide the extraction window:<br><br>---------------------------<br>Microsoft .NET Framework 2.0<br>---------------------------<br>Command line options:<br><br>/Q -- Quiet modes for package,<br><br>/T:&lt;full path&gt; -- Specifies temporary working folder,<br><br>/C -- Extract files only to the folder when used also with /T.<br><br>/C:&lt;Cmd&gt; -- Override Install Command defined by author.<br><br>---------------------------<br>OK<br>---------------------------<br><br>In my installer I download dotnetfx.exe from the Microsoft site (either x86 or the x64 installer), but if you really want to hide the extraction window and can package your app with dotnetfx.exe then here's a method:<br><br>1. Use Winzip or winrar to extract the dotnetfx.exe to a folder and include that folder in your install package.<br><br>2. Inside the folder you'll see install.msi which you can run with command parameters, eg:<br><br><br>---------------------------<br>Usage<br>---------------------------<br>Usage:<br><br>/l &lt;logname.txt&gt; :Name of verbose msi log<br><br>/lang &lt;xxxx&gt; :4-digit language code<br><br>/q :Quiet install mode<br><br>/qu :Quiet uninstall mode<br><br>/? :Show the Usage dialog<br>---------------------------<br>OK<br>---------------------------</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">jdt2oo7</span><br><span class="post-time small text-muted">6th January 2010 05:04 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">I guess I can live with the extract window, because we don't want to include .NET in our installer. Again, thanks for your help... I've been struggle with this the last few days.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">meaningoflights</span><br><span class="post-time small text-muted">6th January 2010 05:35 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">your welcome, let us know if you need anymore help :)<br><br><br>ps As per the dotnexfx 2.0 system requirements:<br><a href="http://www.microsoft.com/downloads/details.aspx?FamilyID=0856EACB-4362-4B0D-8EDD-AAB15C5E04F5&amp;displaylang=en" target="_blank">http://www.microsoft.com/downloads/d...displaylang=en</a><br><br>You should check that Windows Installer 3.1 or above is installed before installing .net 2.0..., I think its upto WindowsInstaller v4.5 these days...<br><br><br>===============================================<br><br>;THIS IS THE SWITCH TO COMPILE FOR INTERNET OR FULL SETUP - comment out the !define and change the Output file name<br><br>!define IS_INTERNET_RELEASE<br>OutFile "XXX Setup using Internet.exe"<br><br>---------------------------------------------<br><br>;The call to the function to check if MSI 3.1 or above is installed, if not to download and install it:<br><br>Call UpdateMSIVersion<br><br>---------------------------------------------<br><br>;The function<br>Function UpdateMSIVersion<br>GetDllVersion "$SYSDIR\MSI.dll" $R0 $R1<br>IntOp $R2 $R0 / 0x00010000<br>IntOp $R3 $R0 &amp; 0x0000FFFF<br><br>IntCmp $R2 3 0 InstallMSI RightMSI<br>IntCmp $R3 1 RightMSI InstallMSI RightMSI<br><br>RightMSI:<br>Push 0<br>Goto ExitFunction<br><br>InstallMSI:<br><br>!ifdef IS_INTERNET_RELEASE<br>DetailPrint "Downloading MSI Installer"<br>DetailPrint "Pausing installation while downloading MSI Installer"<br>;NSISDL::download "http://download.microsoft.com/download/1/4/7/147ded26-931c-4daf-9095-ec7baf996f46/WindowsInstaller-KB893803-v2-x86.exe" "$INSTDIR\WindowsInstaller-KB893803-v2-x86.exe"<br><br>InetLoad::load /POPUP "MSI Installer" /RESUME "Internet Connection Error. Please make sure you are connected to the Internet. You must be connected to the Internet to install XXX. Please make sure your firewall or anti virus software is not preventing the XXX installation from connecting to the Internet. Retry?" "http://download.microsoft.com/download/1/4/7/147ded26-931c-4daf-9095-ec7baf996f46/WindowsInstaller-KB893803-v2-x86.exe" "$$INSTDIR\WindowsInstaller-KB893803-v2-x86.exe"<br>Pop $0 # return value = exit code, "OK" if OK<br><br>${If} $0 != "OK"<br>nsislog::log "$INSTDIR\install.log" "Failed to download Windows Installer 3.1: $0"<br>MessageBox MB_YESNO "MSI Installer - Download Status: $0. Do you wish to continue?" IDYES go1<br>Abort<br>go1:<br>${EndIf}<br>DetailPrint "Completed download"<br>!endif<br>DetailPrint "Updating Windows Installer..."<br>nsislog::log "$INSTDIR\install.log" "Installing Windows Installer 3.1"<br>ExecWait "$INSTDIR\WindowsInstaller-KB893803-v2-x86.exe /quiet /norestart"<br>Push 1<br>Goto ExitFunction<br>ExitFunction:<br>FunctionEnd</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">amselon</span><br><span class="post-time small text-muted">13th January 2010 12:06 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">ExecWait '$INSTDIR\dotnetfx.exe /q:a /c:"install /q"'<br>or<br>ExecWait '$INSTDIR\dotnetfx.exe /q /c:"install /l c:\log_.txt /q"'<br>or<br>ExecWait '$INSTDIR\dotnetfx.exe /q /c:"install /q"'</p></div><hr><div class="footer"><p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p></div></div><script src="../js/highlight.pack.js" type="text/javascript"></script><script type="text/javascript">//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]></script></body></html>