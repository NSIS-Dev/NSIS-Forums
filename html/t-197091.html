<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="adding a field into MUI_PAGE_DIRECTORY" />

  <title>adding a field into MUI_PAGE_DIRECTORY - NSIS Forums</title>
  <script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script>
  <!-- Bootstrap core CSS -->

  <link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css" />
  <link rel="stylesheet" href="../css/style.css" type="text/css" /><!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!--[if lt IE 9]>
                <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
                <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->
</head>

<body>
  <div class="container">
    <!-- Put navigation bar here -->

    <ol class="breadcrumb">
      <li><a href="../index.html" class="glyphicon glyphicon-home"></a></li>

      <li><a href="f-65.html">NSIS Discussion</a></li>

      <li class="active">adding a field into MUI_PAGE_DIRECTORY</li>
    </ol>

    <p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=197091">adding a field into MUI_PAGE_DIRECTORY</a></p><br />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">wiki</span><br />
      <span class="post-time small text-muted">22nd October 2004 19:02 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>adding a field into MUI_PAGE_DIRECTORY</strong><br />
      Is there an easy way to add a field to the install folder page? I'm just starting to use MUI and didn't see anything obvious. What I would like to do is to display a text field or a number field below the folder selection page. Any help is appreciated!</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Joel</span><br />
      <span class="post-time small text-muted">22nd October 2004 19:07 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">InstallOptions can be easier...</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">wiki</span><br />
      <span class="post-time small text-muted">22nd October 2004 19:24 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">I can define the field using InstallOptions, but how do I duplicate the folder selection and the browser button functionalities?</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Joel</span><br />
      <span class="post-time small text-muted">22nd October 2004 19:59 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">For the folder dialog, use <i>DirRequest</i><br />
      <br />
      See InstallOptions docs.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">wiki</span><br />
      <span class="post-time small text-muted">2nd November 2004 15:56 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"></p>

      <blockquote>
        <i>Originally posted by Lobo Lunar</i><br />
        <b>For the folder dialog, use <i>DirRequest</i><br />
        <br />
        See InstallOptions docs.</b>
      </blockquote>OK, I looked at InstallOptions example test.nsi, and used the part for DirRequest. Now I have 2 questions:<br />
      <br />
      1. State=C:\Program Files\default_install_dir, can I use some variable like $INSTDIR so it's not dependent of the C drive?<br />
      <br />
      2. How do I show 'Browse' inside the browse button? Now it's showing only "..."<br />
      <br />
      Thanks for the help
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">deguix</span><br />
      <span class="post-time small text-muted">2nd November 2004 21:34 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"></p>

      <blockquote>
        1. State=C:\Program Files\default_install_dir, can I use some variable like $INSTDIR so it's not dependent of the C drive?
      </blockquote>You have to write the folder name to the INI file with WriteINIStr everytime you need to show the page.<br />
      <br />

      <blockquote>
        2. How do I show 'Browse' inside the browse button? Now it's showing only "..."
      </blockquote>It's not possible only with InstallOptions. You would need to use <i>SendMessage</i> and use <i>System</i> plugin to call <i>SetWindowLong</i> to set text and adjust the browse button.<br />
      <br />
      <br />
      1. There is a plugin called InstallOptionsEx (see my signature) which enables you to just write a common variable ($0-$9, $R0-$R9) to the INI file. The plugin automatically gets its contents when you reserve or show a page. (I plan to put the support for $INSTDIR in the future)<br />
      <br />
      2. InstallOptionsEx also have the DirRequest control separated into <i>Text</i> + <i>Button</i> w/ <i>DIRREQUEST</i> flag so you can customize every aspect of the two controls, even use different notifications for each one.
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">wiki</span><br />
      <span class="post-time small text-muted">5th November 2004 01:40 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Thanks very much, major dude. I'll play around with your InstallOptionsEx.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">wiki</span><br />
      <span class="post-time small text-muted">5th November 2004 03:07 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Ok, for the browse button, how do I make the folder selection to show?<br />
      <br />
      my test.ini looks like this:<br />
      <br />
      [Settings]<br />
      <br />
      [Field 1]<br />
      Type=label<br />
      Text=Select Destination Folder<br />
      Left=0<br />
      Right=-20<br />
      Top=0<br />
      Bottom=16<br />
      <br />
      [Field 2]<br />
      Type=Text<br />
      Left=0<br />
      Right=-40<br />
      Top=20<br />
      Bottom=32<br />
      Width=180<br />
      MaxLen=260<br />
      State=C:\Program Files\Netscape\Netscape10<br />
      <br />
      <br />
      [Field 3]<br />
      Type=Button<br />
      Text=Browse<br />
      Left=200<br />
      Right=-1<br />
      Top=20<br />
      Bottom=32<br />
      Flags=DIRREQUEST<br />
      State=???<br />
      ListItems=Text above the tree view<br />
      <br />
      What should I use for State? And do I need to code to put what the user selects from the Browse button into the Text field (Field 2)?</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">deguix</span><br />
      <span class="post-time small text-muted">5th November 2004 12:15 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"></p>

      <blockquote>
        What should I use for State?
      </blockquote>Just put the number <i>2</i>.<br />
      <br />

      <blockquote>
        And do I need to code to put what the user selects from the Browse button into the Text field (Field 2)?
      </blockquote>Absolutely not. This is done by the plugin itself. The only thing it depends on is the Field number where it outputs text.<br />
      <br />
      And you also have to put the notification <i>ONCLICK</i> on the <i>Notify</i> INI value name or it won't execute. Like for example:<br />
      <br />
      Notify=ONCLICK<br />
      <br />
      Remove the <i>Width</i> or <i>Right</i> INI value name from Field 2. Width has an higher priority in the latest version, so it will be used, even if <i>Right</i> is set. (I should fix this on the next version)
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">wiki</span><br />
      <span class="post-time small text-muted">5th November 2004 12:50 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Umm, the straight question related to the test.ini above is, why doesn't the browse button show the folder selection window when I click it? I can see that the default install folder is displayed in the text box, I can even use WriteINIStr to set it to $INSTDIR, but the browse button does nothing (this is on Win2K).</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">wiki</span><br />
      <span class="post-time small text-muted">5th November 2004 12:52 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Sorry, deguix, I saw your last post just when I submitted my post. You can ignore my last question.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">wiki</span><br />
      <span class="post-time small text-muted">5th November 2004 17:16 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">One more question, please. I was able to put the folder selection controls on the same page as an (optional) zip code field. However, the back button doesn't show up, the buttons i see are Install and Cancel, whereas I expect to see Back, Next, Cancel. As soon as a folder is selected by clicking the Browse button, it goes to install.<br />
      I also noticed my INI file is updated with State=0 right below "Settings". Is that a clue? I have none right now :)<br />
      <br />
      Here's a snippet of the code for my pages:<br />
      <br />
      Page custom WelcomePage<br />
      <br />
      !insertmacro MUI_PAGE_LICENSE "license.txt"<br />
      <br />
      Page custom SetCustom ValidateCustom ": Select Folder and US zip code"<br />
      !insertmacro MUI_PAGE_INSTFILES<br />
      !insertmacro MUI_UNPAGE_INSTFILES</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">deguix</span><br />
      <span class="post-time small text-muted">5th November 2004 22:15 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"></p>

      <blockquote>
        the back button doesn't show up
      </blockquote>You can enable that on the <i>Settings</i> INI section with <i>BackEnabled=1</i>.<br />
      <br />

      <blockquote>
        I also noticed my INI file is updated with State=0 right below "Settings".
      </blockquote>There should appear also a <i>Notify</i> INI value on <i>Settings</i> INI section. That's because you used a notification (ONCLICK).<br />
      <br />
      Thanks for warning me of those. One person doing everything is really difficult and bugs generally escape from my hands. I'll be going to fix both of them on the next version.
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">deguix</span><br />
      <span class="post-time small text-muted">6th November 2004 11:20 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"></p>

      <blockquote>
        You can enable that on the Settings INI section with BackEnabled=1.
      </blockquote>Whooops! It's <i>BackShow=1</i> to show the back button. <i>BackEnabled=1</i> only enables the button if it's already visible.<br />
      <br />

      <blockquote>
        There should appear also a Notify INI value on Settings INI section. That's because you used a notification (ONCLICK).
      </blockquote>In this case it wasn't appearing... Another thing to take care of.
    </div>
    <hr />

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]>
  </script>
</body>
</html>
