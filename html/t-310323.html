<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="description" content="Finish Page"><title>Finish Page - NSIS Forums</title><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script><link rel="preload" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css" as="style" onload="this.rel='stylesheet'"><link rel="preload" href="../css/style.css" as="style" onload="this.rel='stylesheet'"><noscript><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css"><link rel="stylesheet" href="../css/style.css"></noscript><script>!function(a){"use strict";var b=function(b,c,d){function e(a){return h.body?a():void setTimeout(function(){e(a)})}function f(){i.addEventListener&&i.removeEventListener("load",f),i.media=d||"all"}var g,h=a.document,i=h.createElement("link");if(c)g=c;else{var j=(h.body||h.getElementsByTagName("head")[0]).childNodes;g=j[j.length-1]}var k=h.styleSheets;i.rel="stylesheet",i.href=b,i.media="only x",e(function(){g.parentNode.insertBefore(i,c?g:g.nextSibling)});var l=function(a){for(var b=i.href,c=k.length;c--;)if(k[c].href===b)return a();setTimeout(function(){l(a)})};return i.addEventListener&&i.addEventListener("load",f),i.onloadcssdefined=l,l(f),i};"undefined"!=typeof exports?exports.loadCSS=b:a.loadCSS=b}("undefined"!=typeof global?global:this);!function(a){if(a.loadCSS){var b=loadCSS.relpreload={};if(b.support=function(){try{return a.document.createElement("link").relList.supports("preload")}catch(b){return!1}},b.poly=function(){for(var b=a.document.getElementsByTagName("link"),c=0;c<b.length;c++){var d=b[c];"preload"===d.rel&&"style"===d.getAttribute("as")&&(a.loadCSS(d.href,d,d.getAttribute("media")),d.rel=null)}},!b.support()){b.poly();var c=a.setInterval(b.poly,300);a.addEventListener&&a.addEventListener("load",function(){b.poly(),a.clearInterval(c)}),a.attachEvent&&a.attachEvent("onload",function(){a.clearInterval(c)})}}}(this);</script></head><body><div class="container"><ol class="breadcrumb"><li><a href="../index.html" class="glyphicon glyphicon-home"></a></li><li><a href="f-65.html">NSIS Discussion</a></li><li class="active">Finish Page</li></ol><p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=310323">Finish Page</a></p><br><div class="post"><p class="post-meta"><span class="post-author text-primary">shazia.parveen</span><br><span class="post-time small text-muted">19th August 2009 06:53 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>Finish Page</strong><br>&nbsp; Hi,<br>I am making setup using NSIS and i want to add photos or images in the Finsh page. How to do that, can anyone help me..<br>Thanks</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">f0rt</span><br><span class="post-time small text-muted">19th August 2009 19:31 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">If you use the Modern User Interface (MUI) then this could be achieved just by setting the MUI_WELCOMEFINISHPAGE_BITMAP define to the path of your bitmap file (recommended size: 164x314 pixels).<br><br>E. g. with Examples\Modern UI\WelcomeFinish.nsi the modification would look like:<br></p><pre>
<code>
;--------------------------------
<br>;Interface Settings
<br><br> !define MUI_ABORTWARNING
<br> !define MUI_WELCOMEFINISHPAGE_BITMAP your_favorite_bitmap.bmp 
<br>&gt;
</code>
</pre>For the uninstaller you would use the define MUI_UNWELCOMEFINISHPAGE_BITMAP. You might also consider the defines MUI_WELCOMEFINISHPAGE_BITMAP_NOSTRETCH and MUI_UNWELCOMEFINISHPAGE_BITMAP_NOSTRETCH.<br>
      <br>
      Detailed information is available in Docs\Modern UI 2\Readme.html.
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">shazia.parveen</span><br>
      <span class="post-time small text-muted">24th August 2009 07:37 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Thanks for the reply,<br>
      i Am using Modern User Interface (MUI) for setup but by using<br>
      !define MUI_ABORTWARNING<br>
      !define MUI_WELCOMEFINISHPAGE_BITMAP our_favorite_bitmap.bmp<br>
      By this we can change welcome as well as finish page, but i want to add some images only on finish page for making Nsis set up..</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">File077</span><br>
      <span class="post-time small text-muted">25th August 2009 02:45 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Simply place the define image line above the finish page macro. At that point the welcome page macro will already have been defined, and inserted, and won't use the image.</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">shazia.parveen</span><br>
      <span class="post-time small text-muted">25th August 2009 08:15 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>finish page (right side)</strong><br>
      &nbsp; Thanks for the reply,<br>
      Sorry for some confusion, I want to display images(photos) on the right side of the finish page , suppose i want to display photos of some developer which where involved in the completion of project , and need there photos to be displayed to the right hand side of the finish page, for help i am attaching a file please go through it and help me . I want to display photos on shown area of the attached file, i.e on the right side of the file...</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">f0rt</span><br>
      <span class="post-time small text-muted">25th August 2009 17:18 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">If you'd like to have different images on the welcome and finish page then you have the option to define either a custom welcome or finish page.<br>
      <br>
      The following example illustrate how this could be done:<br></p>
      <pre>
<code>
"MUI2.nsh"
<br><br>&gt;OutFile "nsFinish.exe"
<br>&gt;Name    "nsFinish"
<br><br>&gt;InstallDir "$TEMPDIR"
<br>&gt;BrandingText " "
<br><br>&gt;!insertmacro MUI_PAGE_WELCOME
<br>&gt;!insertmacro MUI_PAGE_DIRECTORY
<br>&gt;!insertmacro MUI_PAGE_INSTFILES
<br>Page custom nsDialogsFinish
<br><br>&gt;!insertmacro MUI_LANGUAGE English
<br><br>&gt;Var DIALOG
<br>&gt;Var HEADLINE
<br>&gt;Var TEXT
<br>&gt;Var IMAGECTL
<br>&gt;Var IMAGE
<br><br>&gt;Function .onInit
<br>   InitPluginsDir
<br>   File/oname=$PLUGINSDIRfinish.bmp "${NSISDIR}\\Contrib\\Graphics\\Wizard\\orange-nsis.bmp"
<br>&gt;FunctionEnd
<br><br>&gt;Function nsDialogsFinish
<br><br>   nsDialogs</code>::Create 1044
<br>   Pop $DIALOG
<br><br>  ${NSD_CreateBitmap} 0 0 109u 193u ""
<br>   Pop $IMAGECTL
<br><br>   StrCpy$0 $PLUGINSDIRfinish.bmp
<br>  ${NSD_SetImage} $IMAGECTL $0 $IMAGE
<br><br>  ${NSD_CreateLabel} 120u 10u -130u 20u "Finish!"
<br>   Pop $HEADLINE
<br><br>  ${NSD_CreateLabel} 120u 32u -130u -32u "This is the end.$\\r$\\n$\\r$\\nHit the Close button."
<br>   Pop $TEXT
<br><br>   nsDialogs::Show
<br><br>  ${NSD_FreeImage} $IMAGE
<br><br>FunctionEnd
<br><br>Section
<br>SectionEnd 
<br>&gt;

</pre>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">shazia.parveen</span><br>
      <span class="post-time small text-muted">25th August 2009 17:48 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>finish page (right side)</strong><br>
      &nbsp; thanks very much for reply,<br>
      i have tried this code its working for the finish page left hand side , but if i need to display the image on the right side only , for more help i am attaching a file please go through it..</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">f0rt</span><br>
      <span class="post-time small text-muted">27th August 2009 22:27 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">The custom finish page reassembling your desired layout extensively uses nsDialogs. Therefore it is highly recommended to read and comprehend the nsDialogs documentation [Docs\nsDialogs\Readme.html].<br>
      <br>
      The ${NSD_Create*} macros have the first parameters in common. These first parameters are x, y, width and height. The values for these parameters could either be given in dialog units (e.g. 120u) or pixels (e.g. 150). Consequently the controls could be freely placed.<br>
      <br>
      So here is the script:<br>
      <br></p>
      <pre>
<code>
"MUI2.nsh"
<br><br>&gt;OutFile      "nsFinish.exe"
<br>&gt;Name         "nsFinish"
<br>&gt;InstallDir   "$TEMPDIR"
<br>&gt;BrandingText " "
<br><br>&gt;; Background color
<br>&gt;!define BG_COLOR 0xffffff 
<br><br>&gt;!insertmacro MUI_PAGE_WELCOME
<br>&gt;!insertmacro MUI_PAGE_DIRECTORY
<br>&gt;!insertmacro MUI_PAGE_INSTFILES
<br>Page custom nsDialogsFinish
<br><br>&gt;!insertmacro MUI_LANGUAGE English
<br><br>&gt;; Convenience macro to perform the same operation on several images
<br>&gt;!macro ForEachImage MACRO
<br>  !insertmacro ${MACRO} "nsis.bmp"
<br>  !insertmacro ${MACRO} "orange.bmp"
<br>&gt;!macroend
<br><br>&gt;; Add image file
<br>&gt;!macro AddImage IMAGE
<br>   File/oname=$PLUGINSDIR${IMAGE}  "${NSISDIR}\\Contrib\\Graphics\\Header\\${IMAGE}"
<br>&gt;!macroend
<br><br>&gt;; $0 := first x-position to place image
<br>&gt;; Pushes image handle onto stack
<br>&gt;!macro CreateAndSetImage IMAGE
<br>  ${NSD_CreateBitmap} $0 -57 150 57 ""
<br>  Exch $1
<br>   Push$2
<br>  ${NSD_SetImage} $1 "$PLUGINSDIR\\${IMAGE}" $2
<br>   Exch
<br>   Pop$1
<br>   Exch$2
<br>   IntOp$0 $0 + 160
<br>&gt;!macroend
<br><br>&gt;; Release image handle
<br>&gt;!macro FreeImage IMAGE
<br>   Exch$0
<br>  ${NSD_FreeImage} $0
<br>   Pop$0
<br>&gt;!macroend
<br><br>&gt;Function .onInit
<br>   Push$0
<br>   InitPluginsDir
<br>   File/oname=$PLUGINSDIRfinish.bmp "${NSISDIR}\\Contrib\\Graphics\\Wizard\\orange-nsis.bmp"
<br>  !insertmacro ForEachImage AddImage
<br>FunctionEnd
<br><br>&gt;Function nsDialogsFinish
<br>   Push$0
<br>   Push$1
<br><br>   nsDialogs</code>::Create 1044
<br>   Pop$0
<br>   SetCtlColors$0 "" ${BG_COLOR}
<br><br>   ${NSD_CreateBitmap} 0 0 165 315 ""
<br>  Pop $0
<br><br>  ${NSD_SetImage} $0 $PLUGINSDIRfinish.bmp $1
<br>   Push$1
<br><br>  ; Initialize x-Position for placement of first image
<br>   StrCpy$0 180
<br>  !insertmacro ForEachImage CreateAndSetImage
<br>  ; Image handles pushed onto stack
<br><br>  ${NSD_CreateLabel} 120u 10u -130u 20u "Finish!"
<br>  Pop $0
<br>   SetCtlColors$0 "" ${BG_COLOR}
<br><br>   ${NSD_CreateLabel} 120u 32u -130u -32u "This is the end.$\\r$\\n$\\r$\\nHit the Close button."
<br>  Pop $0
<br>   SetCtlColors$0 "" ${BG_COLOR}
<br><br>   ; Hide branding text control
<br>   GetDlgItem$0 $HWNDPARENT 1028
<br>   ShowWindow$0 ${SW_HIDE}
<br><br>   ; Hide separator
<br>   GetDlgItem$0 $HWNDPARENT 1256
<br>   ShowWindow$0 ${SW_HIDE}
<br><br>  nsDialogs::Show
<br><br>   Pop$0
<br>  ${NSD_FreeImage} $0
<br><br>  ; Release image handles previously pushed onto stack
<br>  !insertmacro ForEachImage FreeImage
<br><br>   Pop$1
<br>   Pop$0
<br>FunctionEnd
<br><br>Section
<br>SectionEnd 
<br>&gt;

</pre>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">shazia.parveen</span><br>
      <span class="post-time small text-muted">28th August 2009 08:45 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Thanks so much for the reply,<br>
      you have send me two different code after running the codes the results coming are the same, the images are not coming on the right side as i have attached the file above post, need some more help...</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">dfranklin72</span><br>
      <span class="post-time small text-muted">8th September 2009 11:16 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">you just need to define the second image on the wright.<br>
      <br>
      have a play with this.<br>
      <br>
      <br>
      !include "MUI2.nsh"<br>
      <br>
      OutFile "nsFinish.exe"<br>
      Name "nsFinish"<br>
      InstallDir "$TEMPDIR"<br>
      BrandingText " "<br>
      <br>
      ; Background color<br>
      !define BG_COLOR 0xffffff<br>
      <br>
      !insertmacro MUI_PAGE_WELCOME<br>
      !insertmacro MUI_PAGE_DIRECTORY<br>
      !insertmacro MUI_PAGE_INSTFILES<br>
      Page custom nsDialogsFinish<br>
      <br>
      !insertmacro MUI_LANGUAGE English<br>
      <br>
      ; Convenience macro to perform the same operation on several images<br>
      !macro ForEachImage MACRO<br>
      !insertmacro ${MACRO} "nsis.bmp"<br>
      !insertmacro ${MACRO} "orange.bmp"<br>
      !macroend<br>
      <br>
      ; Add image file<br>
      !macro AddImage IMAGE<br>
      File /oname=$PLUGINSDIR${IMAGE} "${NSISDIR}\Contrib\Graphics\Header\${IMAGE}"<br>
      !macroend<br>
      <br>
      ; $0 := first x-position to place image<br>
      ; Pushes image handle onto stack<br>
      !macro CreateAndSetImage IMAGE<br>
      ${NSD_CreateBitmap} $0 -57 150 57 ""<br>
      Exch $1<br>
      Push $2<br>
      ${NSD_SetImage} $1 "$PLUGINSDIR\${IMAGE}" $2<br>
      Exch<br>
      Pop $1<br>
      Exch $2<br>
      IntOp $0 $0 + 160<br>
      !macroend<br>
      <br>
      ; Release image handle<br>
      !macro FreeImage IMAGE<br>
      Exch $0<br>
      ${NSD_FreeImage} $0<br>
      Pop $0<br>
      !macroend<br>
      <br>
      Function .onInit<br>
      Push $0<br>
      InitPluginsDir<br>
      File /oname=$PLUGINSDIRfinish.bmp "${NSISDIR}\Contrib\Graphics\Wizard\orange-nsis.bmp"<br>
      File /oname=$PLUGINSDIRfinish2.bmp "${NSISDIR}\Contrib\Graphics\Wizard\win.bmp"<br>
      !insertmacro ForEachImage AddImage<br>
      FunctionEnd<br>
      <br>
      Function nsDialogsFinish<br>
      Push $0<br>
      Push $1<br>
      <br>
      nsDialogs::Create 1044<br>
      Pop $0<br>
      SetCtlColors $0 "" ${BG_COLOR}<br>
      <br>
      ${NSD_CreateBitmap} 0 0 30% 315 ""<br>
      Pop $0<br>
      <br>
      ${NSD_SetImage} $0 $PLUGINSDIRfinish.bmp $1<br>
      Push $1<br>
      <br>
      ${NSD_CreateBitmap} 30% 200 70% 315 ""<br>
      Pop $1<br>
      <br>
      ${NSD_SetImage} $1 $PLUGINSDIRfinish2.bmp $2<br>
      Push $2<br>
      <br>
      ; Initialize x-Position for placement of first image<br>
      StrCpy $0 180<br>
      !insertmacro ForEachImage CreateAndSetImage<br>
      ; Image handles pushed onto stack<br>
      <br>
      ${NSD_CreateLabel} 120u 10u -130u 20u "Finish!"<br>
      Pop $0<br>
      SetCtlColors $0 "" ${BG_COLOR}<br>
      <br>
      ${NSD_CreateLabel} 120u 32u -130u -32u "This is the end.$\r$\n$\r$\nHit the Close button."<br>
      Pop $0<br>
      SetCtlColors $0 "" ${BG_COLOR}<br>
      <br>
      ; Hide branding text control<br>
      GetDlgItem $0 $HWNDPARENT 1028<br>
      ShowWindow $0 ${SW_HIDE}<br>
      <br>
      ; Hide separator<br>
      GetDlgItem $0 $HWNDPARENT 1256<br>
      ShowWindow $0 ${SW_HIDE}<br>
      <br>
      nsDialogs::Show<br>
      <br>
      Pop $0<br>
      ${NSD_FreeImage} $0<br>
      <br>
      ; Release image handles previously pushed onto stack<br>
      !insertmacro ForEachImage FreeImage<br>
      <br>
      Pop $1<br>
      Pop $0<br>
      FunctionEnd<br>
      <br>
      Section<br>
      SectionEnd</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">shazia.parveen</span><br>
      <span class="post-time small text-muted">8th September 2009 15:25 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Thanks for the reply ,will do in our code and will see the<br>
      result , i think it is surely a awesome help .</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Naaryan</span><br>
      <span class="post-time small text-muted">27th December 2012 13:02 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>How to use NSD_Create* on Finish page</strong><br>
      &nbsp; Hi,<br>
      <br>
      I am trying to create hyperlink control another than the default provided by NSIS but when i use ${NSD_CreateLink} in my script. it's compiled successfully but on finish page it does not render any control even the title and sub title text.<br>
      <br>
      Please suggest, How would i use ${NSD_Create* } on finish page or any alternative of this.<br>
      <br>
      Your response is awaited.<br>
      <br>
      Regards,<br>
      Naaryan</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">MSG</span><br>
      <span class="post-time small text-muted">28th December 2012 23:50 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">The nsDialogs macros and/or commands should be used in the finish page's SHOW function. You can use pastebin to show us a (minimal) example of what you're doing, then we can maybe explain what you're doing wrong.</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br>
      <span class="post-time small text-muted">30th December 2012 13:01 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Also make sure you have included <i>MUI2.nsh</i> rather than <i>MUI.nsh</i>.<br>
      <br>
      Stu</p>
    </div>
    <hr>

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]></script></body></html>