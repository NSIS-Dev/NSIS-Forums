<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="Vista and Desktop EXE Deletion" />

  <title>Vista and Desktop EXE Deletion - NSIS Forums</title>
  <script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script>
  <!-- Bootstrap core CSS -->

  <link rel="stylesheet" type="text/css" href="//netdna.bootstrapcdn.com/bootswatch/3.0.1/readable/bootstrap.min.css" />
  <link rel="stylesheet" href="../css/style.css" type="text/css" /><!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!--[if lt IE 9]>
                <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
                <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->
</head>

<body>
  <div class="container">
    <!-- Put navigation bar here -->

    <ol class="breadcrumb">
      <li><a href="../index.html" class="glyphicon glyphicon-home"></a></li>

      <li><a href="f-65.html">NSIS Discussion</a></li>

      <li class="active">Vista and Desktop EXE Deletion</li>
    </ol>

    <p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=277498">Vista and Desktop EXE Deletion</a></p><br />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">zenkick</span><br />
      <span class="post-time small text-muted">18th September 2007 04:17 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>Vista and Desktop EXE Deletion</strong><br />
      Under Vista, I'm attempting to perform a:<br />
      <br />
      Delete "$DESKTOP\foo.exe"<br />
      <br />
      But it appears that it doesn't work.<br />
      <br />
      I have:<br />
      <br />
      RequestExecutionLevel admin<br />
      <br />
      set, and it doesn't matter if I change the context<br />
      <br />
      SetShellVarContext all<br />
      <br />
      which should default to the local user if there aren't perms.<br />
      <br />
      I'm using the most recent 2.30 release.<br />
      <br />
      Suggestions?</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Joel</span><br />
      <span class="post-time small text-muted">18th September 2007 04:36 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">maybe foo.exe is in used</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">zenkick</span><br />
      <span class="post-time small text-muted">18th September 2007 05:36 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">no, foo.exe is not in use.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Anders</span><br />
      <span class="post-time small text-muted">18th September 2007 15:15 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">use<br />
      <br />
      MessageBox mb_ok "$DESKTOP\foo.exe"<br />
      <br />
      and make sure the path is correct<br />
      <br /></p>

      <blockquote>
        which should default to the local user if there aren't perms.
      </blockquote>Where did you read this? As far as I know, it only gives the user's path for older systems (From helpfile "The all users folder may not be supported on all OSes. If the all users folder is not found, the current user folder will be used.")
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Wizou</span><br />
      <span class="post-time small text-muted">19th September 2007 09:49 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">open a command box<br />
      and type "del " followed by the path displayed by the messagebox for $DESKTOP\foo.exe (enclosed in quotes)<br />
      <br />
      what does it say ?<br />
      <br />
      <br />
      or maybe it's a shortcut... foo.exe.lnk ?</p>
    </div>
    <hr />

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]>
  </script>
</body>
</html>
