<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="nsExec::Exec still flashes screen" />

  <title>nsExec::Exec still flashes screen - NSIS Forums</title>
  <script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script>
  <!-- Bootstrap core CSS -->

  <link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css" />
  <link rel="stylesheet" href="../css/style.css" type="text/css" /><!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!--[if lt IE 9]>
                <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
                <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->
</head>

<body>
  <div class="container">
    <!-- Put navigation bar here -->

    <ol class="breadcrumb">
      <li><a href="../index.html" class="glyphicon glyphicon-home"></a></li>

      <li><a href="f-65.html">NSIS Discussion</a></li>

      <li class="active">nsExec::Exec still flashes screen</li>
    </ol>

    <p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=255907">nsExec::Exec still flashes screen</a></p><br />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">saschagottfried</span><br />
      <span class="post-time small text-muted">21st September 2006 09:55 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>nsExec::Exec still flashes screen</strong><br />
      Hi,<br />
      <br />
      I have to invoke an executable during my install procedure. First I used ExecWait but, that started a DOS console. After searching I here I found that using nsExec::Exec should be more convenient. But the installer window is still losing/gaining focus and my taskbar does something like flashing. This is annoying to the user.<br />
      <br />
      How to make it run in the background AND not noticable to the user in front of the machine? Any recommendations??? Thanks!<br />
      <br />
      [CODE]<br />
      ;function call to updata data<br />
      ;ExecWait '"$TEMP\datcmp.exe" /M=$TEMP\datcmp.ini' $6<br />
      nsExec::Exec /TIMEOUT=1000 '"$TEMP\datcmp.exe" /M=$TEMP\datcmp.ini'<br />
      [CODE]</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
      <span class="post-time small text-muted">21st September 2006 11:01 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">You could try the ExecDos plugin which is on the Wiki.<br />
      <br />
      -Stu</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">saschagottfried</span><br />
      <span class="post-time small text-muted">9th October 2006 16:42 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Hi Stu,<br />
      <br />
      after replacing ExecWait with nsExec and now replacing it with ExecDos as you proposed, I can reply that there is still some kind of flashing in the screen. NSIS installer window is still loosing focus while calling this. You can see the evolution of my calls to different plugins...<br />
      <br />
      ;function call to compare indexfiles<br />
      ;ExecWait '"$TEMP\datcmp.exe" /M=$TEMP\datcmp.ini' $6<br />
      ;nsExec::Exec /TIMEOUT=1000 '"$TEMP\datcmp.exe" /M=$TEMP\datcmp.ini'<br />
      ExecDos::exec /NOUNLOAD /ASYNC '"$TEMP\datcmp.exe" /M=$TEMP\datcmp.ini' "$TEMP\execdos.log"<br />
      Pop $0 # thread handle for wait<br />
      ;BringToFront ;using this did not changed anything :-(<br />
      # you can add some installation code here to execute while application is running.<br />
      ExecDos::wait $0<br />
      <br />
      <br />
      I am using BGImage plugin to make the installation use the full screen, showing a backround image and a color gradient. With this enabled I can see the taskbar flashing "through".<br />
      <br />
      Please give some more advise. Thanks in advance.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Takhir</span><br />
      <span class="post-time small text-muted">9th October 2006 19:50 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">This might happen if datcmp.exe starts third process that gains focus.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">saschagottfried</span><br />
      <span class="post-time small text-muted">10th October 2006 09:48 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Updates:<br />
      <br />
      I noticed that some installers like NVIDIA, MSI tools and the old installer I am replacing right now (done with WISE Installmanager 1.5) work with fullscreen background image or gradient BUT the taskbar stays in foreground during the installation. My new NSIS installer and some others completely cover it. Does anybody know how this option is called?<br />
      <br />
      I looked throught the docs of plugin BGImage, but couldn't find anything about such an option. Help !!!<br />
      <br />
      My Code:<br />
      <br />
      Function CustomGUIInit<br />
      Push $R1<br />
      Push $R2<br />
      BgImage::SetReturn /NOUNLOAD on<br />
      <br />
      BgImage::SetBg /NOUNLOAD /GRADIENT 255 255 255 0 30 100<br />
      Pop $R1<br />
      Strcmp $R1 success 0 error<br />
      File /oname=$PLUGINSDIR\bgimage.bmp vde71-splash.bmp<br />
      System::call "user32::GetSystemMetrics(i 0)i.R1"<br />
      System::call "user32::GetSystemMetrics(i 1)i.R2"<br />
      IntOp $R1 $R1 - 480<br />
      IntOp $R1 $R1 / 2<br />
      IntOp $R2 $R2 - 320<br />
      IntOp $R2 $R2 / 2<br />
      BGImage::AddImage /NOUNLOAD $PLUGINSDIR\bgimage.bmp $R1 $R2<br />
      CreateFont $R1 "Arial" 18 700<br />
      ;BGImage::AddText /NOUNLOAD "$(^SetupCaption)" $R1 0 64 128 16 8 500 100<br />
      BGImage::AddText /NOUNLOAD "VDE-Vorschriftenwerk auf DVD - Version 7.1$\r$\nSetup" $R1 0 64 128 30 30 550 100<br />
      Pop $R1<br />
      Strcmp $R1 success 0 error<br />
      BGImage::Redraw /NOUNLOAD<br />
      Goto done<br />
      error:<br />
      MessageBox MB_OK|MB_ICONSTOP $R1<br />
      done:<br />
      Pop $R2<br />
      Pop $R1<br />
      FunctionEnd</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">JasonFriday13</span><br />
      <span class="post-time small text-muted">11th October 2006 00:00 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">I might have to add an option to the BGImage plugin to show the taskbar (not that hard). It will probably be in the next few days.</p>
    </div>
    <hr />

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]>
  </script>
</body>
</html>
