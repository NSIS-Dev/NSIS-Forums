<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="description" content="Questions about VB deployment &amp; shared files"><title>Questions about VB deployment &amp; shared files - NSIS Forums</title><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script><link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css"><link rel="stylesheet" href="../css/style.css" type="text/css"></head><body><div class="container"><ol class="breadcrumb"><li><a href="../index.html" class="glyphicon glyphicon-home"></a></li><li><a href="f-65.html">NSIS Discussion</a></li><li class="active">Questions about VB deployment &amp; shared files</li></ol><p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=71598">Questions about VB deployment &amp; shared files</a></p><br><div class="post"><p class="post-meta"><span class="post-author text-primary">malachii</span><br><span class="post-time small text-muted">11th January 2002 18:31 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>Questions about VB deployment &amp; shared files</strong><br>Hello Folks...<br><br>I've noticed a few threads discussing VB deployment with the NSIS installer. I know keeping track of all the DLLs is a pain, but I'm not worried about that. I'm worried about the "correct way to install VB DLLs".<br><br>There are two ways to go about doing this so far as I know. You can run the VB runtime distributable form microsoft, or you can do it yourself in your own NSIS script (manually).<br><br>The microsoft runtime distributable includes the basic VB dependencies, but not the tons, and tons of others like the tabbed dialog OCX, XML, etc... For that reason I'm more keen on doing the install myself in an NSIS script, since I have to handle all those others correctly anyhow.<br><br>So what is the process for those files? Here's my best guess. By the way, I'm not sure what a "shared dll" is technically. I know there is some registry tweaking involved for "reference counting" of some sort. The NSIS docs have a script to do that, but again, I'm not sure on the process.<br><br>The following process I assume is correct for the XML, TabbedDialog, and VB Runtime DLLs....<br><br>1. Copy the correct files into the system32 directory (using IfNewer)<br>2. Register the files you copied into the system32<br>3. Perform that "shared dll" voodoo on them all.<br><br>During the UNinstall you would... (not sure about this)<br><br>1. Perform the "shared dll" voodoo, and if the share count reaches 0, unregister and delete the DLL?<br><br>Also LAST question.<br><br>How does NSIS handle shared DLLs that are currently IN USE by the system (locked), like the OLDAUT dlls often are?<br><br>Thanks!<br><br>Mal.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Koen van de Sande</span><br><span class="post-time small text-muted">11th January 2002 19:25 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">The OLEAUT ones: you can use /REBOOTOK to replace them (once you find you can't replace them). A while ago I found that it was smaller to use the microsoft distro than to use your own script and compress the files, but that was before bzip2, so perhaps it's now smaller to use that solution instead. If you look for a VB post by me, you'll probably find a script which more or less covers what you want (but not reference counting) - and it doesn't use the new GetDLLVer commands yet, so it doesn't work anymore. Perhaps you'd better start from scratch -:(</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">malachii</span><br><span class="post-time small text-muted">11th January 2002 20:34 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">The docs say that /REBOOTOK is only for DELETE and RENAME commands. How do I COPY with /REBOOTOK, and what does it do? Does it perform this action after reboot instead?<br><br>If I can get around this problem of locked OLEAUT files, then all should be well... I think.<br><br>Thanks again,<br><br>Mal.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Koen van de Sande</span><br><span class="post-time small text-muted">12th January 2002 09:35 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Forgot to say:<br>Copy the DLL file to a temporary folder first, and then use Rename /REBOOTOK to replace the old one once the computer reboots. Note that with these OLEAUT &amp; OLEPRO files, you must check the version first! Installing an old version over a new one is fairly dramatic for your user (programs will stop working)!</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">petersa</span><br><span class="post-time small text-muted">12th January 2002 10:21 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">You can rename <i>across directories</i>?</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Koen van de Sande</span><br><span class="post-time small text-muted">12th January 2002 16:01 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Yes, I believe you can (normally, you can rename accross drives too), as the Windows Move command is used IIRC.<br>However, I'm not sure if the /REBOOTOK and accross directory is a good idea. Perhaps it's better to put them both in the System dir and then rename, because I think /REBOOTOK cannot rename across drives and if the temp dir is not on the same drive as Windows...</p></div><hr><div class="footer"><p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p></div></div><script src="../js/highlight.pack.js" type="text/javascript"></script><script type="text/javascript">//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]></script></body></html>