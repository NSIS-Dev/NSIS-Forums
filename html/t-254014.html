<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="Install directory issue on PocketPC" />

  <title>Install directory issue on PocketPC - NSIS Forums</title><!-- Bootstrap core CSS -->
  <link rel="stylesheet" type="text/css" href="//netdna.bootstrapcdn.com/bootswatch/3.0.1/readable/bootstrap.min.css" />
  <link rel="stylesheet" href="../css/style.css" type="text/css" /><!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!--[if lt IE 9]>
                <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
                <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->
</head>

<body>
  <div class="container">
    <!-- Put navigation bar here -->

    <ol class="breadcrumb">
      <li><a href="../index.html" class="glyphicon glyphicon-home"></a></li>

      <li><a href="f-65.html">NSIS Discussion</a></li>

      <li class="active">Install directory issue on PocketPC</li>
    </ol>

    <p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=254014">Install directory issue on PocketPC</a></p><br />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">briforge</span><br />
      <span class="post-time small text-muted">24th August 2006 16:41 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>Install directory issue on PocketPC</strong><br />
      So far, the NSIS product is fantastic compared to the VS 'solution' for installing an app. I actually got the NSIS install to work, and a mutiple-CAB installation at that, with the core CF cab, SqlCE cab, and OpenNETCF cab.<br />
      <br />
      But I have 2 issues :<br />
      <br />
      1) The program is being installed to the wrong directory. In the Project Propeties, the Output File Folder is \Windows\Start Menu\Programs\Games. When I install it on the Emulator, it installs to the right directory. But when installing it on my actual device, it ends up in the Programs directory. In the install script, I currently have<br />
      <br />
      InstallDir "$STARTMENU\Programs\Games\"<br />
      <br />
      Any tips on how to get this into the Games directory? I've noticed that if you look at it through the File Explorer, the path is /My Device/Program Files/MyGame.<br />
      <br />
      2) The program icon is missing, when viewing the Programs. On the Emulator, the icon is displaying fine.<br />
      <br />
      I've attached my .nsi file if anyone wants to take a look<br />
      <br />
      Thanks for any help.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
      <span class="post-time small text-muted">25th August 2006 13:42 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">There seems to be a little bit of confusion. The NSIS installer runs on the PC, so $STARTMENU is the path to the start menu on the PC, not the Pocket PC. How does it matter if you install the files to the emulator or the device?<br />
      <br />
      Maybe the script will shed more light on this. Try attaching it again.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">briforge</span><br />
      <span class="post-time small text-muted">30th August 2006 20:48 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Ok, trying to attach the .nsi file again...it may have got lost when I previewed my post...<br />
      <br />
      Someone suggested changing the [Shortcuts] line in my .inf file, but I did that and it didn't work.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
      <span class="post-time small text-muted">30th August 2006 22:36 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Still seems like the wrong direction to me. I don't see how NSIS's InstallDir can affect CEAppMgr.exe's decisions as to where to put files on the Pocket PC. Sounds to me like you should be looking into your CABs instead of the NSIS script.</p>
    </div>
    <hr />

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]>
  </script>
</body>
</html>
