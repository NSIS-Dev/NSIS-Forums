<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="Vista &quot;program files&quot; sub directory permissions" />

  <title>Vista "program files" sub directory permissions - NSIS Forums</title>
  <script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script>
  <!-- Bootstrap core CSS -->

  <link rel="stylesheet" type="text/css" href="//netdna.bootstrapcdn.com/bootswatch/3.0.1/readable/bootstrap.min.css" />
  <link rel="stylesheet" href="../css/style.css" type="text/css" /><!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!--[if lt IE 9]>
                <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
                <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->
</head>

<body>
  <div class="container">
    <!-- Put navigation bar here -->

    <ol class="breadcrumb">
      <li><a href="../index.html" class="glyphicon glyphicon-home"></a></li>

      <li><a href="f-65.html">NSIS Discussion</a></li>

      <li class="active">Vista "program files" sub directory permissions</li>
    </ol>

    <p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=310384">Vista "program files" sub directory permissions</a></p><br />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Nizar</span><br />
      <span class="post-time small text-muted">20th August 2009 10:19 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>Vista "program files" sub directory permissions</strong><br />
      Hello all,<br />
      Recently i had a problem, Trying to install my own software under "Program files\mysoftware" and create sub folders and files, I'm trying to grant full access to these files and folders to the ordinary vista user account.<br />
      <br />
      Here is a snapshot on what i did:<br />
      <br />
      RequestExecutionLevel user<br />
      <br />
      GetFunctionAddress $0 GrantFullAccess<br />
      UAC::ExecCodeSegment $0<br />
      <br />
      <br />
      Function GrantFullAccess<br />
      AccessControl::GrantOnFile "$PROGRAMFILES\MySoftware\data\*.*" "(BU)" "FullAccess"<br />
      AccessControl::GrantOnFile "$DOCUMENTS\MySoftware\*.*" "(BU)" "FullAccess"<br />
      AccessControl::GrantOnFile "$PROFILE\.MySoftware\*.*" "(BU)" "FullAccess"<br />
      FunctionEnd<br />
      <br />
      <br />
      <br />
      Now, when installing the software, and see the permission for the users, the logged in user don't have full access to the folders inside "program files".<br />
      <br />
      <br />
      Please help,<br />
      <br />
      THanks</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Anders</span><br />
      <span class="post-time small text-muted">20th August 2009 15:04 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Why are you using the UAC plugin here? UAC::ExecCodeSegment will cause that function to NOT run as admin.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Nizar</span><br />
      <span class="post-time small text-muted">20th August 2009 15:25 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>I don't know</strong><br />
      Hello Andres<br />
      Actually I'm new to NSIS, I found an example, or to be more specific, i collected the script from snippets from the web.<br />
      Can you please tell me what should i do?<br />
      <br />
      Thanks in advance</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Anders</span><br />
      <span class="post-time small text-muted">20th August 2009 20:46 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Just don't use the UAC plugin. Put the AccessControl calls in a normal section</p>
    </div>
    <hr />

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]>
  </script>
</body>
</html>
