<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="description" content="just want to add to registry not install a program"><title>just want to add to registry not install a program - NSIS Forums</title><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script><link rel="preload" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css" as="style" onload="this.rel='stylesheet'"><link rel="preload" href="../css/style.css" as="style" onload="this.rel='stylesheet'"><noscript><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css"><link rel="stylesheet" href="../css/style.css"></noscript><script>!function(a){"use strict";var b=function(b,c,d){function e(a){return h.body?a():void setTimeout(function(){e(a)})}function f(){i.addEventListener&&i.removeEventListener("load",f),i.media=d||"all"}var g,h=a.document,i=h.createElement("link");if(c)g=c;else{var j=(h.body||h.getElementsByTagName("head")[0]).childNodes;g=j[j.length-1]}var k=h.styleSheets;i.rel="stylesheet",i.href=b,i.media="only x",e(function(){g.parentNode.insertBefore(i,c?g:g.nextSibling)});var l=function(a){for(var b=i.href,c=k.length;c--;)if(k[c].href===b)return a();setTimeout(function(){l(a)})};return i.addEventListener&&i.addEventListener("load",f),i.onloadcssdefined=l,l(f),i};"undefined"!=typeof exports?exports.loadCSS=b:a.loadCSS=b}("undefined"!=typeof global?global:this);!function(a){if(a.loadCSS){var b=loadCSS.relpreload={};if(b.support=function(){try{return a.document.createElement("link").relList.supports("preload")}catch(b){return!1}},b.poly=function(){for(var b=a.document.getElementsByTagName("link"),c=0;c<b.length;c++){var d=b[c];"preload"===d.rel&&"style"===d.getAttribute("as")&&(a.loadCSS(d.href,d,d.getAttribute("media")),d.rel=null)}},!b.support()){b.poly();var c=a.setInterval(b.poly,300);a.addEventListener&&a.addEventListener("load",function(){b.poly(),a.clearInterval(c)}),a.attachEvent&&a.attachEvent("onload",function(){a.clearInterval(c)})}}}(this);</script></head><body><div class="container"><ol class="breadcrumb"><li><a href="../index.html" class="glyphicon glyphicon-home"></a></li><li><a href="f-65.html">NSIS Discussion</a></li><li class="active">just want to add to registry not install a program</li></ol><p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=223707">just want to add to registry not install a program</a></p><br><div class="post"><p class="post-meta"><span class="post-author text-primary">fieryidris</span><br><span class="post-time small text-muted">10th August 2005 17:24 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>just want to add to registry not install a program</strong><br>i have been struggling with trying to create a simple interface that will just add / delete registry keys to personalise a program but i am not very computery and although i have managed to use the HM NIS edit wizard to make myself a ini file that using the C:\Program Files\NSIS\Examples\InstallOptions testlink.exe ends up looking similar to what i want to do i am not sure how to actually make it up properly so it works.<br><br>i do not need the install button at the bottom of the page but i dont know how to get rid of it.<br><br>i would also like to use the modern ui but i am not sure how to combine them together, and anyway that can wait until i understand how to make it work properly how it is at the moment.<br><br>this is the ini file (testlink.ini)<br><br>; Ini file generated by the HM NIS Edit IO designer.<br>[Settings]<br>NumFields=5<br><br>[Field 1]<br>Type=Button<br>Text=exit<br>State=quit<br>Left=214<br>Right=264<br>Top=108<br>Bottom=123<br><br>[Field 2]<br>Type=Button<br>Text=website<br>State=http://www.awebsite.com<br>Left=24<br>Right=74<br>Top=105<br>Bottom=121<br><br>[Field 3]<br>Type=Link<br>Text=add something to the registry<br>State=WriteRegStr HKCU ""Software\My Company\My Software" "String Value" "dead beef"..WriteRegStr HKCU "Software\My Company\My Software" "String Value" "dead beef"<br>TxtColor=0xFF00FF<br>Left=98<br>Right=211<br>Top=12<br>Bottom=30<br><br>[Field 4]<br>Type=Link<br>Text=add something to the registry and something else<br>State=WriteRegStr HKCU ""Software\My Company\My Software" "String Value" "dead beef"..WriteRegStr HKCU "Software\My Company\My Software" "String Value" "dead beef"<br>TxtColor=0xFF00FF<br>Left=78<br>Right=240<br>Top=44<br>Bottom=62<br><br>[Field 5]<br>Type=Link<br>Text=remove something from the registry<br>State=DeleteRegKey HKCU "Software\My Company\My Software"<br>TxtColor=0x0000FF<br>Left=94<br>Right=211<br>Top=71<br>Bottom=89<br><br><br><br>am i doing it all completely wrong or what? please dont get too complicated on me my head is already about to explode as it is.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br><span class="post-time small text-muted">10th August 2005 18:34 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">As NSIS was not made for simple applications, it's bound to be complicated. It would be much easier to use Visual Basic to create a program to do this.<br><br>In NSIS though, you need to firstly use Resource Hacker to remove the Next button (IDD 105). You can't delete the button though, only hide it (otherwise makensis won't let you compile).<br><br>To make links actually do something, you need the Flags=NOTIFY setting. You then in the page's Leave function need to read from Settings-&gt;State in the INI file with ReadINIStr to determine which link field number was clicked on.<br><br>Don't bother with MUI here. You can simply use XPStyle on instead.<br><br>-Stu</p></div><hr><div class="footer"><p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p></div></div><script src="../js/highlight.pack.js" type="text/javascript"></script><script type="text/javascript">//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]></script></body></html>