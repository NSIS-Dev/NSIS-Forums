<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="DeleteRegKey in Win7" />

  <title>DeleteRegKey in Win7 - NSIS Forums</title>
  <script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script>
  <!-- Bootstrap core CSS -->

  <link rel="stylesheet" type="text/css" href="//netdna.bootstrapcdn.com/bootswatch/3.0.1/readable/bootstrap.min.css" />
  <link rel="stylesheet" href="../css/style.css" type="text/css" /><!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!--[if lt IE 9]>
                <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
                <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->
</head>

<body>
  <div class="container">
    <!-- Put navigation bar here -->

    <ol class="breadcrumb">
      <li><a href="../index.html" class="glyphicon glyphicon-home"></a></li>

      <li><a href="f-65.html">NSIS Discussion</a></li>

      <li class="active">DeleteRegKey in Win7</li>
    </ol>

    <p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=324661">DeleteRegKey in Win7</a></p><br />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">abcdgoldfish</span><br />
      <span class="post-time small text-muted">7th December 2010 12:15 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>DeleteRegKey in Win7</strong><br />
      I want to delete a registry key in Win7 but NSIS always looks in the Wow6432Node hive. For example if I have the following keys:<br />
      HKLM "Software\Product\badKey"<br />
      HKLM "Software\Wow6432Node\Product\badKey"<br />
      <br />
      The following will remove HKLM "Software\Wow6432Node\Product\badKey":<br />
      DeleteRegKey HKLM "SOFTWARE\Product\badKey"<br />
      DeleteRegKey HKLM "SOFTWARE\Wow6432Node\Product\badKey"<br />
      <br />
      Neither removes HKLM "Software\Product\badKey", which is the key I want to delete.<br />
      <br />
      I have RequestExecutionLevel admin in my script. Without this no keys are deleted.<br />
      <br />
      Why can't the script delete this key? Adding a backslash at the end of the key string doesn't help either, i.e., "Software\Product\badKey\".<br />
      <br />
      I'd appreciate any help.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Yathosho</span><br />
      <span class="post-time small text-muted">7th December 2010 14:02 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><a href="http://nsis.sourceforge.net/Docs/Chapter4.html#4.9.7.6" target="_blank">SetRegView</a>?</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">abcdgoldfish</span><br />
      <span class="post-time small text-muted">7th December 2010 15:09 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Perfect! You have saved my bacon. Thanks.<br />
      <br />
      Now that I see how close SetRegView (4.9.7.6) was to DeleteRegKey (4.9.2.3) in the NSIS User Manual, it sure would have saved me time and anguish if the manual had reference links. Otherwise it's hard to find things that you don't even know you should be looking for.<br />
      <br />
      Not being an ingrate. Just looking for ways to improve the awesomeness that is NSIS.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
      <span class="post-time small text-muted">7th December 2010 16:17 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">You are welcome to submitting a patch.<br />
      <br />
      Stu</p>
    </div>
    <hr />

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]>
  </script>
</body>
</html>
