<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="description" content="Integrated .Net Framework, not download it"><title>Integrated .Net Framework, not download it - NSIS Forums</title><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script><link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css"><link rel="stylesheet" href="../css/style.css" type="text/css"></head><body><div class="container"><ol class="breadcrumb"><li><a href="../index.html" class="glyphicon glyphicon-home"></a></li><li><a href="f-65.html">NSIS Discussion</a></li><li class="active">Integrated .Net Framework, not download it</li></ol><p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=301688">Integrated .Net Framework, not download it</a></p><br><div class="post"><p class="post-meta"><span class="post-author text-primary">typingcat</span><br><span class="post-time small text-muted">4th January 2009 12:57 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>Integrated .Net Framework, not download it</strong><br>Hello. I'm a new user of NSIS. I have created a simple application that uses WinPCap in C#. So, my application requires both .NET Framework and WinPCap installed. Other than that my application doesn't need any special setup, no sytem file change, no registry entry, no anything.<br><br>I've searched Google for this, but all the search results were about downloading the .NET Framework from Microsoft's web site then installing. For I'm going to distribute my application in a CD, I want the .Net Framework integrated inside the setup file in order to save user's downloading time.<br><br>I need to know how to integrate the .NET Framework into the setup file, but not copy it to the Program files folder. I tried to do it myself, but the .Net Framework setup file was also copied to the Program Files folder.<br><br>If you have some free time, would you give me a simple code that does:<br>1. Integrate the .NET Framework setup file into my setup file.<br>2. Execute the .NET Framework setup quitely before installing (I already know how to check if .NET is installed so you may skip the code to check if it is installed or not)<br>3. Not copy the .NET Framework setup file to the Program Files folder.<br><br>If you teach me the code above, I think I myself can then apply the code to do the same thing for WinPCap. Thank you for your help.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Joel</span><br><span class="post-time small text-muted">4th January 2009 17:19 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"></p><blockquote>1. Integrate the .NET Framework setup file into my setup file.</blockquote>Use NSIS' File instruction to add the executable into the installfer.<br><blockquote>2. Execute the .NET Framework setup quitely before installing (I already know how to check if .NET is installed so you may skip the code to check if it is installed or not)</blockquote>You need to know which are the params of the .net installer to do it quitely...According <a href="http://sojoe*******2006/11/01/silent-install-of-ms-net-framework-version-2/" target="_blank">to this site</a>, you need to pass something like <b>/q:a /c:"install.exe /q"</b>...use this with NSIS' instructions Exec, ExecWait or ExecShell.<br><blockquote>3. Not copy the .NET Framework setup file to the Program Files folder.</blockquote>Ok, you can use $PLUGISDIR to output the .net installer, at the end of the nsis installer, $PLUGINSDIR is deleted.</div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">vbguy</span><br><span class="post-time small text-muted">4th January 2009 22:22 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Do NOT include the .NET Framework as an installer file. Who wants to wait a minute and a half while your installer decompresses a pre-compressed .NET installer?<br><br>It's insanity.<br><br>What you should do is add the .NET installer to the CD in the same path as your installer. Then use $EXEPATH to find it and execute it.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br><span class="post-time small text-muted">4th January 2009 23:47 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Yes if you are using a CD, just put it in a sub-folder and execute it with ExecWait:<br><br>ExecWait `"$EXEDIR\DotNET\setup.exe" /q:a /c:"install.exe /q"` $R0<br><br>Notice the use of double quotes. Also note the $R0 on the end... that will receive the exit code of the setup (0 on success, if anything else you could show a message box).<br><br>Stu</p></div><hr><div class="footer"><p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p></div></div><script src="../js/highlight.pack.js" type="text/javascript"></script><script type="text/javascript">//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]></script></body></html>