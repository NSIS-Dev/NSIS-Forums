<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="Disable/enable options in Custom page" />

  <title>Disable/enable options in Custom page - NSIS Forums</title>
  <script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script>
  <!-- Bootstrap core CSS -->

  <link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css" />
  <link rel="stylesheet" href="../css/style.css" type="text/css" /><!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!--[if lt IE 9]>
                <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
                <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->
</head>

<body>
  <div class="container">
    <!-- Put navigation bar here -->

    <ol class="breadcrumb">
      <li><a href="../index.html" class="glyphicon glyphicon-home"></a></li>

      <li><a href="f-65.html">NSIS Discussion</a></li>

      <li class="active">Disable/enable options in Custom page</li>
    </ol>

    <p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=143893">Disable/enable options in Custom page</a></p><br />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">ingig</span><br />
      <span class="post-time small text-muted">28th July 2003 17:04 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>Disable/enable options in Custom page</strong><br />
      Hi, can't seem to find this on the board so here it goes.<br />
      <br />
      What I'm trying to do is change my options to Enabled in my custom page after the user has choosen from a droplist.<br />
      <br />
      the custom page looks like this<br />
      <br />
      "Select Datastorage type"<br />
      Type=droplist<br />
      ListItems=CSV|ODBC<br />
      <br />
      When the user selects ODBC I want to enable these boxes<br />
      <br />
      [Field 9]<br />
      Type=droplist<br />
      ListItems=MSSQL|MySQL<br />
      ...<br />
      <br />
      [Field 11]<br />
      Type=text<br />
      Left=0<br />
      ...<br />
      <br />
      I figured out that I could just load up a new custom page if the user selects ODBC, but this would be nicer :)<br />
      <br />
      So if there are any way to do this please let me know.<br />
      <br />
      thx<br />
      ingig</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
      <span class="post-time small text-muted">28th July 2003 17:39 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">InstallOptions are not dynamic in that changes made by the user on the page are instantly taken.<br />
      It is only after the user exists the InstallOptions page that the changes are written to the IO ini file.<br />
      <br />
      The only way to do this would to have 3 seperate IO pages, 1 with your main selection box, then the two others as sub pages which are shown depending on the users' selection.<br />
      <br />
      -Stu</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
      <span class="post-time small text-muted">28th July 2003 17:41 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Ok, so when the user selects ODBC you will need to show up a new page afterwards.<br />
      <br />
      Else, skip that page using Abort<br />
      <br />
      -Stu</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">ingig</span><br />
      <span class="post-time small text-muted">28th July 2003 17:51 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Ok, thanks for the info.<br />
      <br />
      Do you know if the dynamic thing is planned?<br />
      <br />
      ingig</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
      <span class="post-time small text-muted">28th July 2003 18:01 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">I'm not sure.<br />
      It would be a nice feature though... but a tonne of new code would have to be written!<br />
      <br />
      -Stu</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">pengyou</span><br />
      <span class="post-time small text-muted">28th July 2003 18:42 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">It is easy to make dynamic changes to a custom page using a single INI file if the fields are carefully arranged. When I need to do this in my installers, I make sure that the "dynamic" fields are all at the end of the list of fields - then I can turn these fields on or off simply by changing the NumFields value in the INI file.<br />
      <br />
      Suppose I have a custom page with 10 fields and sometimes I want to hide two of them. First I design the INI file so that these two fields are numbers 9 and 10. The function that displays the custom page is arranged like this skeleton:</p>
      <pre>
<code>Function MyCustomPage<br /><br />        ; Hide last two fields<br />        WriteINIStr "$PLUGINSDIR\ioA.ini" "Settings" "NumFields" "8"<br /><br />loop:<br />        ; Display the custom page<br />        InstallOptions::dialog "$PLUGINSDIR\ioA.ini"<br />        <br />        ; check stuff (eg user data input/selections),<br />        ; $R0 set to "no" if the hidden fields are to remain hidden<br /><br />        StrCmp $R0 "no" exit<br /><br />        ; Now make the two hidden fields visible and display the modified page<br /><br />        WriteINIStr "$PLUGINSDIR\ioA.ini" "Settings" "NumFields" "10"<br />        Goto loop<br /><br />exit:<br />FunctionEnd</code>
</pre>This idea can be easily extended to do more than just turn some fields on or off. All you have to do is make the appropriate changes to the custom page's INI file then call InstallOptions::dialog again to display the modified custom page. I have found this a useful way to improve the user interface to my installer.
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
      <span class="post-time small text-muted">28th July 2003 19:11 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">That's a good idea.<br />
      I write DISABLED to my controls if they want to be diabled, or if it is a ListBox (in one case) I changed the control completely to a Text control (because DISABLED doesn't work on ListBox's)<br />
      <br />
      What he wanted was say, you click "use blah" then straight away (without clicking Next) another part would lighten up from being disabled containing options for "blah".<br />
      <br />
      -Stu</p>
    </div>
    <hr />

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]>
  </script>
</body>
</html>
