<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="wscript.exe problem when run javascript" />

  <title>wscript.exe problem when run javascript - NSIS Forums</title>
  <script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script>
  <!-- Bootstrap core CSS -->

  <link rel="stylesheet" type="text/css" href="//netdna.bootstrapcdn.com/bootswatch/3.0.1/readable/bootstrap.min.css" />
  <link rel="stylesheet" href="../css/style.css" type="text/css" /><!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!--[if lt IE 9]>
                <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
                <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->
</head>

<body>
  <div class="container">
    <!-- Put navigation bar here -->

    <ol class="breadcrumb">
      <li><a href="../index.html" class="glyphicon glyphicon-home"></a></li>

      <li><a href="f-65.html">NSIS Discussion</a></li>

      <li class="active">wscript.exe problem when run javascript</li>
    </ol>

    <p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=337949">wscript.exe problem when run javascript</a></p><br />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">NOCaut</span><br />
      <span class="post-time small text-muted">22nd November 2011 11:24 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>wscript.exe problem when run javascript</strong><br />
      test.js<br />
      <br /></p>
      <pre>
<code>function SetHomePage()<br />    netscape.security.PrivilegeManager.enablePrivilege ('UniversalBrowserRead');<br /><br />    var m_tb_prefs = Components.classes***91;"@mozilla.org/preferences-service;1"***93;.getService(Components.interfaces.nsIPrefBranch);<br />        var res = false;<br /><br />            curHomePage = m_tb_prefs.getCharPref('browser.startup.homepage');<br />            m_tb_prefs.setCharPref('browser.startup.homepage', 'http://www.4shared.com/');<br />            m_tb_prefs.setIntPref('browser.startup.page', 1);        <br />}<br /><br />SetHomePage()</code>
</pre>and run
      <pre>
<code>Exec 'wscript.exe "c:\test.js"'</code>
</pre>Error: "netscape is undefined"
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Anders</span><br />
      <span class="post-time small text-muted">22nd November 2011 12:21 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">The NSIS forum is not the correct place to post javascript questions!<br />
      <br />
      ...wscript is windows scripting host and not a general web browser, you cannot access browser specific objects with it.<br />
      <br />
      Who would want 4shared.com as their homepage anyway? All this seems a bit fishy to me, you should just let the user set their homepage.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">NOCaut</span><br />
      <span class="post-time small text-muted">22nd November 2011 12:23 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">I get url: <a href="http://www.4shared.com/" target="_blank">http://www.4shared.com/</a> for example.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">NOCaut</span><br />
      <span class="post-time small text-muted">22nd November 2011 12:25 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">i want know i can change *.js file using nsis?</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Anders</span><br />
      <span class="post-time small text-muted">22nd November 2011 12:30 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"></p>

      <blockquote>
        <small>Originally posted by NOCaut</small><br />
        I get url: <a href="http://www.4shared.com/" target="_blank">http://www.4shared.com/</a> for example.
      </blockquote>Use example.com next time you need a general URL.<br />
      <br />
      My point still stands, you cannot set the homepage this way. Setting the users homepage like this is usually done by spyware like applications, if you don't have evil intentions you should just let the user set the homepage.
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Anders</span><br />
      <span class="post-time small text-muted">22nd November 2011 12:34 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"></p>

      <blockquote>
        <small>Originally posted by NOCaut</small><br />
        i want know i can change *.js file using nsis?
      </blockquote>If you are rolling out Firefox in a domain environment I believe there are better ways of dealing with this than editing .js files that belong to the user. You should take a look at the unofficial Firefox MSI installers or edit the profile defaults in \FireFox\defaults\profile
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">NOCaut</span><br />
      <span class="post-time small text-muted">22nd November 2011 13:33 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">ok thanks</p>
    </div>
    <hr />

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]>
  </script>
</body>
</html>
