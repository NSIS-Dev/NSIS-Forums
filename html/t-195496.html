<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="description" content="reinstaller"><title>reinstaller - NSIS Forums</title><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script><link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css"><link rel="stylesheet" href="../css/style.css" type="text/css"></head><body><div class="container"><ol class="breadcrumb"><li><a href="../index.html" class="glyphicon glyphicon-home"></a></li><li><a href="f-65.html">NSIS Discussion</a></li><li class="active">reinstaller</li></ol><p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=195496">reinstaller</a></p><br><div class="post"><p class="post-meta"><span class="post-author text-primary">superwan</span><br><span class="post-time small text-muted">3rd October 2004 18:26 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>reinstaller</strong><br>hello<br><br>i've succesfully created a great installer for a great gpl tvonpc software : K!TV (<a href="http://www.kastortv.org" target="_blank">www.kastortv.org</a>)<br><br><br>this installer has an advanced function : an uninstaller which can completely reinstall the software<br><br><br><br>for that, i had to use the same "file" commands in the uninstall section as in the install section<br><br><br><br>BUT the command "file" has a bug...<br><br>when I'm using for example :<br>"file k!tv.exe", in the installer section,<br><br>I have to write in the uninstaller section :<br>"file k!tv.exe"<br>(because the uninstaller can reinstall...)<br><br>as a consequence, the bug makes that "k!tv.exe" is copyied two times in my setup.exe...<br><br>all my files are copyed two times un my setup.exe !!<br><br>---&gt; my setup.exe is 2 times bigger than it should be...<br><br><br><br>I should create a function "copy files for install and reinstall", and then my files would be copyied only once,<br>BUT<br>the functions can't be the same for the uninstaller and for the installer........<br><br><br><br>have You any idea how to avoid this problem ???</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br><span class="post-time small text-muted">3rd October 2004 19:49 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Use the installer not the uninstaller to reinstall.<br><br>-Stu</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">superwan</span><br><span class="post-time small text-muted">3rd October 2004 20:29 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">thanks for your answer, but is this a solution ????<br><br><br>i'm telling you that i don't find any chocolate ice cream and you're answering me that i juste have to buy a vanilla ice cream...<br><br>this is nonsense<br><br>my installer can reinstall too... (like the nsis installer)<br><br>but what happens if i have deleted my installer, and i want to reinstall my software ?<br><br><br><br><br><br><br>ps : what does "-stu" mean ?</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Yathosho</span><br><span class="post-time small text-muted">3rd October 2004 23:19 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">are you sure, that you are using the uninstall-section properly? have a look at the examples as comparison. if you still insist using the same .exe to install/uninstall, have a look at <a href="http://nsis.sourceforge.net/archive/viewpage.php?pageid=476" target="_blank">this</a>.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br><span class="post-time small text-muted">4th October 2004 20:24 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">It is not nonsense. Think of it logically. If you want the installer and uninstaller to install, then both exe's need the files stored in them to do the install!<br><br>The link Yathosho pointed to is probably your best solution, as NSIS does not compress the same files only once if you specify them twice (it will always compress them twice).<br><br>And Stu is my name (Stuart)<br><br>-Stu</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">superwan</span><br><span class="post-time small text-muted">4th October 2004 20:46 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">ok hello stuart<br><br>and thank you both (stuart and yathosho) to answer my questions ;) this is nice of you ;)<br><br><br><br>well...<br><br>what you said me to do, is to make a "reninstaller - uninstaller" in the installer<br><br>that's what I did...<br><br>(<a href="http://www.kastortv.org" target="_blank">http://www.kastortv.org</a> if you want to try the exe file :<br>- install it once it's ok<br>- if you try to reinstall it, you have the choice to uninstall and/or reinstall ;) )<br><br>thank you for your links, but that's already what i did :D<br><br><br>(and it's nice)<br><br><br>but if you think logically...<br><br>the uninstaller should be able to repair (and to reinstall) the installation...<br><br>stuart says : "If you want the installer and uninstaller to install, then both exe's need the files stored in them to do the install"<br><br><br>in fact, you don't need to store the files twice, if you create the uninstaller during the installation, and not during compiling the setup.exe<br><br>and you the developpers can change it, can't you ? :D<br><br><br><br>see you ;)</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">superwan</span><br><span class="post-time small text-muted">5th October 2004 15:46 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">arf :(</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br><span class="post-time small text-muted">5th October 2004 18:54 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Yes you do have to store the files twice, in both the installer and uninstaller like I said. But no you can't tell NSIS to compress the files once and then copy them into the uninstaller because that would require a large overhead to move the compressed file data from the installer exe into the uninstaller exe.<br><br>The only thing that I can think of is that your main installer has a command-line switch that will make it do the reinstall (so your uninstaller will Exec it and voila you get a reinstallation!)<br>Without the switch the installer will just run as normal.<br><br>However, you still have a problem if the user deletes the installer so :(<br><br>-Stu</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">superwan</span><br><span class="post-time small text-muted">6th October 2004 08:35 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">yee :(<br><br>and as i said to you, that'"s already what i have done... a reinstaller in the installer<br><br>well, ok...<br><br>thank you afrow stuart and yathosho ;)<br><br>see ya ;)</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">kichik</span><br><span class="post-time small text-muted">10th October 2004 14:47 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">If you use File with the same file twice, the datablock optimizer will make sure the file is not included twice. However, the installer and the uninstaller do not share the same datablock, so this case can't be optimized.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">goofee691</span><br><span class="post-time small text-muted">11th October 2004 18:33 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>i know how to do this</strong><br>rather than useing the file command just resrve the files then just call on them this should work i hope<br><br>im lookin gnow to see if it does</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">goofee691</span><br><span class="post-time small text-muted">11th October 2004 18:36 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">no unfotunatly it doesent</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Takhir</span><br><span class="post-time small text-muted">12th October 2004 11:51 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Create multi-file distribution (normally NSIS creates single exe package). Use CopyFile instead of File. A lot of forum posts. May be 2 files: Installer/Uninstaller and compressed files archive. This is not very good for Inet downloads, but "WinZipSE for software distribution" on the first step might work fine. And I saw NSIS selfextractor forum thread somewhere :)</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Takhir</span><br><span class="post-time small text-muted">12th October 2004 13:26 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Another variant - don't use Uninstall section at all. Finally you need to copy a whole package to $INSTDIR and create link to this file called Uninstall or Setup. On .inInit you need to decide where you are. For example, if you see your package already installed on the comp, offer to user Uninstall/Repair. Otherwise make a simple Install. But you need to implement Uninstall functionality somewhere in Install section.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">superwan</span><br><span class="post-time small text-muted">4th January 2005 16:46 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Hello Hello :)<br>I've found the solution :D<br>to a very interesting problem (takhir wasn't far... and its solution is perhaps good... mine works, I tested it ;) )<br><br><br>The question was :<br>how to make an uninstaller which can reinstall everything if you ask him to do it, without double-ing the size of the final setup.exe<br><br><br><br><br>1) don't copy any file during the installation...<br>2) just copy the uninstaller<br>3) once it is installed, do an execwait which launches the uninstaller, and "say" to it that you are installing<br>4) make your uninstaller behave like an installer, copying all the files...<br>5) when you launch the uninstall, the uninstaller can install the files too if you ask him to do it<br><br><br>only one command "file" per file installed<br>so no size double-ing ;)<br><br><br><br>see ya ;)</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">RobGrant</span><br><span class="post-time small text-muted">5th January 2005 13:47 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">What about not creating a standard uninstaller, but instead include the makensis.exe and anything else needed and a script to make an (un|re)installer.<br><br>At the end of your install (with all of your files deployed on the target hard drive) you use those same files to create your (un|re)installer using makensis.exe, with your script as a guide.<br><br>Does that make sense?</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">superwan</span><br><span class="post-time small text-muted">5th January 2005 18:11 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">this surely make sense :D<br><br>like i said 10:04:2004 :<br>"in fact, you don't need to store the files twice, if you create the uninstaller during the installation, and not during compiling the setup.exe"<br><br>which is the most easy to do ?<br>Well in fact I'm hardly working on my technic to launch uninstaller during installation...<br>therefore I won't try your solution, but thx :D</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">superwan</span><br><span class="post-time small text-muted">6th February 2005 01:45 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">hello hello<br><br>my installer-uninstaller-reinstaller is complete youpeee<br><br><br><br><br>well, this works fine :)<br><br>I wanted to thx every forumer of the nsis forum... this foruml is great, people are patient, and you all really, really helped me with talent<br><br><br>What I wanted to do is done... doing an installer and an uninstaller which can reinstall parts or every components of my software, without double-ing the size of the setup.exe<br><br>isn't it great ? :D<br><br>if some one wants my script, mail me... <a href="mailto:eronpatapon@ifrance.com">eronpatapon@ifrance.com</a><br><br>see ya ;)</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">deepesh</span><br><span class="post-time small text-muted">8th February 2005 09:55 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>WoW</strong><br>Wow1 Thank You, what a gr8 thread.<br><br>Deepesh Agarwal,<br><a href="http://www.freeware-alternative.uni.cc" target="_blank">http://www.freeware-alternative.uni.cc</a></p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">superwan</span><br><span class="post-time small text-muted">12th February 2005 12:27 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">hello hello<br><br>I'm releasing the code of my script<br><br><a href="http://eronpatapon.free.fr/IRUscript_inst_reinst_uninst.rar" target="_blank">click here</a><br><br><br>the full script (not really cleared, but fully working, no bug inside, perhaps one or two ahaha who knows)<br><br><br>It isn't as hard to understand as it seems...<br><br>I give too the installer (i've removed all "file" commands)<br><br><br><br><br><br>see ya<br><br>and ask your questions in this topic</p></div><hr><div class="footer"><p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p></div></div><script src="../js/highlight.pack.js" type="text/javascript"></script><script type="text/javascript">//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]></script></body></html>