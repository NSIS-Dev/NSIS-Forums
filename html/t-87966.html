<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="description" content="How to update system DLLs?"><title>How to update system DLLs? - NSIS Forums</title><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script><link rel="preload" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css" as="style" onload="this.rel='stylesheet'"><link rel="preload" href="../css/style.css" as="style" onload="this.rel='stylesheet'"><noscript><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css"><link rel="stylesheet" href="../css/style.css"></noscript><script>!function(a){"use strict";var b=function(b,c,d){function e(a){return h.body?a():void setTimeout(function(){e(a)})}function f(){i.addEventListener&&i.removeEventListener("load",f),i.media=d||"all"}var g,h=a.document,i=h.createElement("link");if(c)g=c;else{var j=(h.body||h.getElementsByTagName("head")[0]).childNodes;g=j[j.length-1]}var k=h.styleSheets;i.rel="stylesheet",i.href=b,i.media="only x",e(function(){g.parentNode.insertBefore(i,c?g:g.nextSibling)});var l=function(a){for(var b=i.href,c=k.length;c--;)if(k[c].href===b)return a();setTimeout(function(){l(a)})};return i.addEventListener&&i.addEventListener("load",f),i.onloadcssdefined=l,l(f),i};"undefined"!=typeof exports?exports.loadCSS=b:a.loadCSS=b}("undefined"!=typeof global?global:this);!function(a){if(a.loadCSS){var b=loadCSS.relpreload={};if(b.support=function(){try{return a.document.createElement("link").relList.supports("preload")}catch(b){return!1}},b.poly=function(){for(var b=a.document.getElementsByTagName("link"),c=0;c<b.length;c++){var d=b[c];"preload"===d.rel&&"style"===d.getAttribute("as")&&(a.loadCSS(d.href,d,d.getAttribute("media")),d.rel=null)}},!b.support()){b.poly();var c=a.setInterval(b.poly,300);a.addEventListener&&a.addEventListener("load",function(){b.poly(),a.clearInterval(c)}),a.attachEvent&&a.attachEvent("onload",function(){a.clearInterval(c)})}}}(this);</script></head><body><div class="container"><ol class="breadcrumb"><li><a href="../index.html" class="glyphicon glyphicon-home"></a></li><li><a href="f-65.html">NSIS Discussion</a></li><li class="active">How to update system DLLs?</li></ol><p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=87966">How to update system DLLs?</a></p><br><div class="post"><p class="post-meta"><span class="post-author text-primary">ivank</span><br><span class="post-time small text-muted">17th May 2002 04:56 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>How to update system DLLs?</strong><br>What is the right way to update system DLLs that are constantly in use, such as mfc42.dll?<br><br>Note that I need to update the DLL only if the version of the DLL in my install is newer than the version currently present on the target computer. Comparison by creation date instead of version will probably do too.<br><br>SetOverwrite has "ifnewer" mode, but does not have "rebootOK" flag.<br>"Rename" has "rebootOK" flag, but lacks "ifnewer" mode.<br><br>Generally it would be nice to have some kind of "smartReplace" option for overwrite that would do this:<br><br>1. Check if taret file already exists.<br>2. If it does, check creation dates. If target is younger than the source, don't replace.<br>3. If target is in use, copy source to temporary directory and do rename /rebootOK. Otherwise just replace the target with the source.<br><br>I guess this can be done manually for each DLL, but it requires a bunch of commands. And it is even more difficult to put it into a function that takes file name as a parameter and does the rest automatically.<br><br>Maybe somebody already wrote such a function? ;)<br>Please advise.<br><br>With best regards<br>Ivan</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">kichik</span><br><span class="post-time small text-muted">17th May 2002 09:55 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">In your functions.html file there is a function that does excatly that, and in the forums there a lot of improvements for it. Search for it.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">ivank</span><br><span class="post-time small text-muted">17th May 2002 15:20 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">What function do you have in mind?<br><br>I looked in Functions.html and did not find anything like this.<br>UpgradeDLL macro comes close, but this is not it. It deals with a COM server DLL, and it won't update it if DLL cannot be overwritten.<br><br>Although, that macro gave me some ideas.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">kichik</span><br><span class="post-time small text-muted">17th May 2002 15:30 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">UpgradeDLL on the forums does excatly what you have requested. It checks the version, reaplces if needed, and if needed replaces after reboot.<br><br>And functions.html does contain the UpgradeDLL macro.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">glenncarr</span><br><span class="post-time small text-muted">11th June 2002 22:11 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"></p><blockquote><i>UpgradeDLL on the forums does excatly what you have requested. It checks the version, reaplces if needed, and if needed replaces after reboot</i></blockquote>:weird: What exactly in the macro causes the replacement at reboot? I would have expected something to modify the "Runonce" registry key.</div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">kichik</span><br><span class="post-time small text-muted">12th June 2002 14:01 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Hmm.... Nothing :)<br><br>The modified macro on the forums does that.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">glenncarr</span><br><span class="post-time small text-muted">12th June 2002 14:41 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">OK, so I'm new to these forums and I apologize for not knowing this... but, is there a central repository in the forums for these updated macros? I.e., where is the latest, most up-to-date version of UpgradeDLL ?<br><br>:o</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">kichik</span><br><span class="post-time small text-muted">12th June 2002 14:52 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Just sort the search results by date.<br>Some people did try to make such centeral repositories but non lasted (as far as I know of...).</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">glenncarr</span><br><span class="post-time small text-muted">12th June 2002 15:16 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">One more question... why won't searching for "UpgradeDLL" return any results? :igor:<br><br>Am I doing something stupid?</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Smile2Me</span><br><span class="post-time small text-muted">12th June 2002 17:33 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Try searching for Upgrade and find o.o.<br><a href="http://forums.winamp.com/showthread.php?s=&amp;threadid=76578&amp;highlight=upgrade" target="_blank">http://forums.winamp.com/showthread....hlight=upgrade</a><br><br>-Hendri.</p></div><hr><div class="footer"><p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p></div></div><script type="text/javascript" src="../js/highlight.pack.js" async></script><script type="text/javascript">//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]></script></body></html>