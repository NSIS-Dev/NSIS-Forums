<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="description" content="Two Problems"><title>Two Problems - NSIS Forums</title><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script><link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css"><link rel="stylesheet" href="../css/style.css" type="text/css"></head><body><div class="container"><ol class="breadcrumb"><li><a href="../index.html" class="glyphicon glyphicon-home"></a></li><li><a href="f-65.html">NSIS Discussion</a></li><li class="active">Two Problems</li></ol><p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=135518">Two Problems</a></p><br><div class="post"><p class="post-meta"><span class="post-author text-primary">sgt-d</span><br><span class="post-time small text-muted">15th May 2003 20:52 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>Two Problems</strong><br>1) MUI_FINISHPAGE_RUN<br><br>this works:<br>!define MUI_FINISHPAGE_RUN "$INSTDIR\test1.exe"<br><br>but this does not:<br>!define MUI_FINISHPAGE_RUN "$INSTDIR\subfolder1\subfolder2\test2.exe"<br><br>which doesn't make sense to me at all. why not? we have a full qualifying path, so it should work.<br><br>2) CreateShortCut<br><br>will not work:<br><br>CreateShortCut "$SMPROGRAMS\${MUI_STARTMENUPAGE_VARIABLE}\MyApp.lnk" "$INSTDIR\system\myapp.exe" /command_line_switch_for_myapp<br><br>there is no way to pass any command line arguments to myapp.exe during the creation of my shortcuts. i've tried everything i can think of, but nsis keeps assuming too many things. it either adds my /switch inside the quotes (which won't work, ex: "c:\myapp.exe /test") or it tries assuming that my /switch is another nsis parameter, such as an icon or hotkey.<br><br>i need workarounds, hax, fixes, anything that works!<br><br>thanks!</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Sunjammer</span><br><span class="post-time small text-muted">16th May 2003 02:08 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">This works fine for me :-</p><pre>
<code>CreateShortCut "${NSISDIR}\blah.lnk" "${NSISDIR}\makensisw.exe" "/?"</code>
</pre></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">dajvid</span><br><span class="post-time small text-muted">16th May 2003 02:11 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Hi,<br><br>In regards to your second problem with CreateShortcut, it sounds like your command line switch contains spaces in it. For example:<br><br>CreateShortCut "$SMPROGRAMS\${MUI_STARTMENUPAGE_VARIABLE}\MyApp.lnk" "$INSTDIR\system\myapp.exe" /whoop C:\Tick Tock\bing.txt<br><br>will consider:<br><br>"/whoop" as the command line switch,<br>"C:\Tick" as the icon file, and<br>"Tock\bing.txt" as the icon_index_number.<br><br>(I know hard coding file locations is bad practice, I'm just trying to illustrate how spaces in paths can also delimit parameters)<br><br>Wrap your command line switches in quotes (don't forget to escape them if necessary) and that should bring joy into your life. For example:<br><br>CreateShortCut "$SMPROGRAMS\${MUI_STARTMENUPAGE_VARIABLE}\MyApp.lnk" "$INSTDIR\system\myapp.exe" "/whoop \$"C:\Tick Tock\bing.txt\$""<br><br>(Don't know about your first problem - for a stab in the dark, could it relate to escaping quotes? All I can say is that from my recent conversion to MUI, when I define MUI symbols, I can't use statements like<br><br>!define MUI_FINISHPAGE_RUN '"wrapping quotes"'<br><br>anymore, but I can use<br><br>!define MUI_FINISHPAGE_RUN "\$"wrapping quotes\$""<br><br>Other than that, I can't see why your exact example wouldn't work. Would it help if you post the exact line from your script which is failing?)<br><br>Ta,<br>Dave.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">sgt-d</span><br><span class="post-time small text-muted">16th May 2003 05:09 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Item #2 CreateShortcut is working fine, I had an extra set of quotes after the command line parameter that was throwing it off. And if I create a shortcut to a long filename path, it does it correctly (in the created shortcut) by encasing the path and exe in quotes, but not the extra params:<br><br>"c:\a long filename path test\myapp.exe" /ahh<br><br>Item #1 MUI_FINISHPAGE_RUN is not working, no matter what I try. I think I've expired all of the possibilities here:<br><br>!define MUI_FINISHPAGE_RUN $INSTDIR\subfolder1\subfolder2\myapp.exe<br><br>!define MUI_FINISHPAGE_RUN '$INSTDIR\subfolder1\subfolder2\myapp.exe'<br><br>!define MUI_FINISHPAGE_RUN "$INSTDIR\subfolder1\subfolder2\myapp.exe"<br><br>!define MUI_FINISHPAGE_RUN `$INSTDIR\subfolder1\subfolder2\myapp.exe`<br><br>!define MUI_FINISHPAGE_RUN "$\"$INSTDIR\subfolder1\subfolder2\myapp.exe$\""<br><br>No matter what I try, the app I want to run cannot and will not run, ever. It just can't be in a subfolder or a series of subfolders --- it's like it absolutely has got to be in the same folder as $INSTDIR.<br><br>i need a workaround or a fix! :/</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">cvx_borg</span><br><span class="post-time small text-muted">16th May 2003 10:02 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">is the file you want to run already there? i had this problem when copied some files in .oninstsuccess and wanted to display it like that. you have to move the copying into a section in this case.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">sgt-d</span><br><span class="post-time small text-muted">16th May 2003 15:25 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">my mui defines are all at the top of my nsis script, including the finish page. the files are all copied in my first section.<br><br>i don't know, it just doesn't make sense. the path is 100% correct, i've even checked it with a messagebox, but it just will not run myapp.exe when i click finish unless myapp.exe is in $INSTDIR -- it can't be anywhere else on my hard drive. way too restrictive.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">kichik</span><br><span class="post-time small text-muted">16th May 2003 15:48 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Attach the script and I'll have a look.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">sgt-d</span><br><span class="post-time small text-muted">16th May 2003 16:51 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">ok, god i'm stupid. nested folders work fine for the finish page.<br><br>here's my real problem though, and i can't figure out a way to do it.<br><br>i don't just want to run the exe on the finish page, i want to change directories... into the same folder as the exe that i am attempting to run.<br><br>on finish i need to run a starter exe 2 subfolders deep, to execute some commands and then it automatically cd's up 2 folders back to $INSTDIR and runs the real exe.<br><br>well, the finish page runs my starter exe, but since it is in $INSTDIR and hasn't changed into the subfolders, when the starter exe is done, it tries going up two folders above $INSTDIR -- and the real exe can't be found then.<br><br>if that makes sense at all. you can tell i'm out of coffee. so, is there a way to change directories for the finish page run command?<br><br>and wouldn't it be a better idea anyway to automatically chdir into the same folder as the exe we want to run?</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">kichik</span><br><span class="post-time small text-muted">16th May 2003 17:09 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Exec and ExecWait start the program with $OUTDIR as the working directory. Set it using SetOutPath or just copy a value in to it.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">sgt-d</span><br><span class="post-time small text-muted">16th May 2003 19:17 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">ok, how do i tell MUI_FINISHPAGE_RUN to use $OUTDIR? i mean, i added SetOutPath in like 20 places (at the end of each section) hoping it would work, but MUI_FINISHPAGE_RUN seems to only rely on $INSTDIR. so, when i click finish, i can run an exe from anywhere on my harddrive, but it never changes to the same directory that the contains that exe.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">kichik</span><br><span class="post-time small text-muted">16th May 2003 19:37 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">The MUI never uses SetOutPath and NSIS doesn't change $OUTDIR unless you use SetOutPath or copy something into it so the last directory set as $OUTDIR will be used. Use SetOutPath in the finish page's pre function or the last section.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">sgt-d</span><br><span class="post-time small text-muted">16th May 2003 20:20 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">ok, i give up. i have setoutpath at the end of every section (16 total) yet MUI_FINISHPAGE_RUN still fails to change directories to $OUTPATH, or somehow it is being reset to $INSDIR --- and i don't see an example of a finish page's pre function anywhere so i guess i'll have to try something else instead. :(</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">sgt-d</span><br><span class="post-time small text-muted">16th May 2003 20:26 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">!define MUI_CUSTOMFUNCTION_FINISH_PRE myFinishPre<br><br>Function myFinishPre<br>SetOutPath "$INSTDIR\system\mpp"<br>FunctionEnd<br><br>annoying... this fails too. it just will not chdir to the folder of the exe being run.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">kichik</span><br><span class="post-time small text-muted">16th May 2003 20:47 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Works fine for me and it doesn't relay on any change I have made to the latest CVS version. It should even work on 1.98 (executing a program at the end using .onInstSuccess for example). Try setting MUI_FINISHPAGE_RUN to the attached program, it'll tell you the working directory. Maybe it will help you see where the problem is.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">sgt-d</span><br><span class="post-time small text-muted">16th May 2003 21:15 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">ok, i feel stupid. :p~<br><br>!define MUI_CUSTOMFUNCTION_FINISH_PRE myFinishPre<br><br>Function myFinishPre<br>SetOutPath "$INSTDIR\system\mpp"<br>FunctionEnd<br><br>this worked, but in all of my previous attempts i forgot to change this:<br><br>!define MUI_FINISHPAGE_RUN $OUTDIR\subfolder1\subfolder2\myapp.exe<br><br>back to $INSTDIR<br><br>it seems to work now. ugh. sorry for the bs. i wish i had seen MUI_CUSTOMFUNCTION_FINISH_PRE sooner.<br><br>thanks kichik!<br><br>oh, i also tested your file, it works also. mine reports the current folder too, which is how i saw it failing.<br><br>anyway, thanks again! :)</p></div><hr><div class="footer"><p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p></div></div><script src="../js/highlight.pack.js" type="text/javascript"></script><script type="text/javascript">//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]></script></body></html>