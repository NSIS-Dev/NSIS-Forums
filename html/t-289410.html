<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="ExecWait for a VBScript" />

  <title>ExecWait for a VBScript - NSIS Forums</title>
  <script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script>
  <!-- Bootstrap core CSS -->

  <link rel="stylesheet" type="text/css" href="//netdna.bootstrapcdn.com/bootswatch/3.0.1/readable/bootstrap.min.css" />
  <link rel="stylesheet" href="../css/style.css" type="text/css" /><!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!--[if lt IE 9]>
                <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
                <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->
</head>

<body>
  <div class="container">
    <!-- Put navigation bar here -->

    <ol class="breadcrumb">
      <li><a href="../index.html" class="glyphicon glyphicon-home"></a></li>

      <li><a href="f-65.html">NSIS Discussion</a></li>

      <li class="active">ExecWait for a VBScript</li>
    </ol>

    <p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=289410">ExecWait for a VBScript</a></p><br />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">jb53403</span><br />
      <span class="post-time small text-muted">31st March 2008 21:49 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>ExecWait for a VBScript</strong><br />
      Hi all,<br />
      <br />
      I have a short VBScript that enables an Excel add-in, and it runs beautifully when I double-click the icon. I want my NSIS-made installer to execute the VBS, but the it doesn't seem to be working. What could be wrong?<br />
      <br />
      Below are the relevant lines of my NSIS script.<br />
      <br />
      Section<br />
      CreateDirectory "C:\dir\"<br />
      SetOutPath "C:\dir\"<br />
      File /r "C:\dir\install_xla.vbs"<br />
      File /r "C:\dir\theExcelAddIn.xla"<br />
      ExecWait "C:\dir\install_xla.vbs"<br />
      SectionEnd<br />
      <br />
      Thanks for any help you can give!</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Anders</span><br />
      <span class="post-time small text-muted">31st March 2008 22:05 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">If you don't need to wait, ExecShell would work, if not:<br />
      <br />
      ExecWait '"$sysdir\wscript.exe" "C:\dir\install_xla.vbs"' or something like that (.vbs is not a executable format, you need to invoke its script parser)<br />
      <br />
      Windows could be set to use the console version as the default, if you really want to have it behave as the host system no matter what, the UAC plugin has ExecShellWait (the default action could be to edit the script aswell, so it might not be the best option)</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">jb53403</span><br />
      <span class="post-time small text-muted">31st March 2008 23:46 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Sweet, that's just what I needed to know! Thanks for the help.</p>
    </div>
    <hr />

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]>
  </script>
</body>
</html>
