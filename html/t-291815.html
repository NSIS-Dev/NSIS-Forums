<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="Billboarding images" />

  <title>Billboarding images - NSIS Forums</title><!-- Bootstrap core CSS -->
  <link rel="stylesheet" type="text/css" href="//netdna.bootstrapcdn.com/bootswatch/3.0.1/readable/bootstrap.min.css" />
  <link rel="stylesheet" href="../css/style.css" type="text/css" /><!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!--[if lt IE 9]>
                <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
                <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->
</head>

<body>
  <div class="container">
    <!-- Put navigation bar here -->

    <ol class="breadcrumb">
      <li><a href="../index.html" class="glyphicon glyphicon-home"></a></li>

      <li><a href="f-65.html">NSIS Discussion</a></li>

      <li class="active">Billboarding images</li>
    </ol>

    <p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=291815">Billboarding images</a></p><br />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">xplct0</span><br />
      <span class="post-time small text-muted">15th May 2008 01:40 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>Billboarding images</strong><br />
      Newbie question #2:<br />
      <br />
      I am interested in placing marketing images during program installation. As of now, to simply display images, I am making use of<br />
      <a href="http://nsis.sourceforge.net/ModernUI_Mod_to_Display_Images_while_installing_files" target="_blank">http://nsis.sourceforge.net/ModernUI...stalling_files</a><br />
      <br />
      And the process by which I am billboarding is as follows:<br />
      <br />
      !insertmacro DisplayImage 'c:\Bilboard0.bmp'<br />
      CopyFiles /SILENT 'C:\Users\david.DOMAIN\Desktop\COMPANY\Main\Build\Sound\01\*' "$INSTDIR\Sound"<br />
      <br />
      !insertmacro DisplayImage 'c:\Bilboard1.bmp'<br />
      CopyFiles /SILENT 'C:\Users\david.DOMAIN\Desktop\COMPANY\Main\Build\Sound\02\*' "$INSTDIR\Sound"<br />
      <br />
      So my question is related to the process by which these files should be split apart. As far as I understand, the function CopyFiles makes use of os functionality to literally copy files from location A to location B. If I am wrong in this respect, is it possible for me to register some sort of callback for notification on events ( FunctionCallOnTenPercentComplete() ), or maybe even a callback that gets called on some sort of interval( FunctionCallOncePerFrame() or FunctionCallOnceEveryTenSeconds() )?<br />
      Ideally, I would like to examine the copy progress of an entire directory, and display a billboard based on a percentage completed.<br />
      <br />
      Option number 2, is to dynamically figure out how to subdivide our assets into temp folders of specified size, and somehow automate the setup in NSIS. I really need some advice on how to best accomplish this if anyone would be so kind, because I'm willing to bet I'm missing the practical option here.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
      <span class="post-time small text-muted">15th May 2008 18:21 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">I know no available solution but to manually split.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">xplct0</span><br />
      <span class="post-time small text-muted">17th May 2008 00:24 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Alrighty, thanks.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">xplct0</span><br />
      <span class="post-time small text-muted">19th May 2008 22:18 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">I noticed that you are able to make win32 dll calls. I'm looking at solving this issue by making use of CopyFilesEx.<br />
      <br />
      CopyFileEx Function:<br />
      Copies an existing file to a new file, notifying the application of its progress through a callback function.<br />
      <br />
      But first I'm having some issues figuring out how to manually call functions in general. I'm starting out with duplicating the functionality of MessageBox, but I've run into a few quirks.<br />
      <br />
      Here's the function definition:<br />
      int MessageBox( HWND hWnd, // handle to owner window<br />
      <br />
      LPCTSTR lpText, // text in message box<br />
      <br />
      LPCTSTR lpCaption, // message box title<br />
      <br />
      UINT uType // message box style );<br />
      <br />
      <br />
      And here's my attempt to invoke it from NSIS:<br />
      <br />
      strcpy $R0 "title"<br />
      strcpy $R1 "text"<br />
      System::Call "user32::MessageBoxA(i, t, t, i) (0, $R0, $R1, 1)"<br />
      <br />
      The message box pops up, however both the title and the text are empty. I'm not sure if "" automatically appends '\0'. On the same note, I'm not sure what NSIS uses for NULL.<br />
      <br />
      Looking through the tutorial, I find myself very confused about:<br />
      System::Call 'YourDllName::YourDllFunction(i, *i, t) i(.r0, r1, .r2) .r3'<br />
      <br />
      I haven't seen anything in the documentation that says what '.r0' means. (I know what $r0 is...)<br />
      <br />
      I'm doubly confused when later, we see the example:<br />
      (function definition)<br />
      int CmGetHotSyncExecPath(TCHAR *pPath, int *piSize);<br />
      (nsis declaration)<br />
      CmGetHotSyncExecPath(t, *i) i<br />
      (nsis invocation)<br />
      System::Call 'CondMgr::CmGetHotSyncExecPath(t, *i) i(.r0, r1r1).r2'<br />
      <br />
      What is r1r1??? And once again, what is '.r0'?</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">xplct0</span><br />
      <span class="post-time small text-muted">19th May 2008 22:21 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Here's the link for the above example:<br />
      <a href="http://nsis.sourceforge.net/Calling_an_external_DLL_using_the_System.dll_plugin#Using_System.dll::Call" target="_blank">http://nsis.sourceforge.net/Calling_...stem.dll::Call</a></p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">xplct0</span><br />
      <span class="post-time small text-muted">20th May 2008 04:06 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">If anyone is interested, I found a way to display images based on a %copy complete (of single files). This is just sandbox code, but here's the entire script:<br />
      <br /></p>
      <pre>
<code><br />!include 'MUI.nsh'<br />!include 'Image.nsh'<br /><br />!define AppName `Sand`<br />Name '${AppName}'<br />OutFile 'Sandbox.exe'<br />InstallDir '$PROGRAMFILES\${AppName}'<br /><br />!insertmacro MUI_PAGE_WELCOME<br />!insertmacro MUI_PAGE_DIRECTORY<br />!insertmacro MUI_PAGE_INSTFILES<br />!insertmacro MUI_PAGE_FINISH<br />!insertmacro MUI_LANGUAGE "English"<br /><br />#Dumpstate::debug<br /># Fix the rukus vista has been causing with shortcut removals.<br />RequestExecutionLevel admin<br /><br />Section 'CD_ONE'<br />    <br />    strcpy $9 'ladeda'<br />    SetPluginUnload alwaysoff<br />    System::Get "(l,l.R1,l,l,i,i,i,i,i)isr1"<br />    pop $0<br />    System::Call 'kernel32::CopyFileEx(t "c:\from\test.txt", t "c:\to\test.txt",k r0,i,i,i)i.r9'<br />    <br />    loop:<br />        StrCmp $1 "callback1" 0 done<br />    <br />        IntCmp $R1 40000000 0 lessthan40mb morethan40mb<br />        lessthan40mb:<br />          strcmp $9 '0' doneCmp +1<br />          !insertmacro DisplayImage 'c:\Bilboard0.bmp'<br />          strcpy $9 '0'<br />          Goto doneCmp<br />          <br />        morethan40mb:<br />          strcmp $9 '1' doneCmp +1<br />          !insertmacro DisplayImage 'c:\Bilboard1.bmp'<br />          strcpy $9 '1'<br />          Goto doneCmp<br />        doneCmp:<br />        <br />        Push 0 # return value of the callback<br />        StrCpy $1 "" # clear $R0 in case there are no more callback calls<br />        System::Call $0 # tell system to return from the callback<br />        <br />        Goto loop<br />    done:<br />    SetPluginUnload manual<br />    System::Free $0<br /> <br />SectionEnd<br /><br /><br /></code>
</pre>
    </div>
    <hr />

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]>
  </script>
</body>
</html>
