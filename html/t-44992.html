<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="description" content="FindWindow *boggle*"><title>FindWindow *boggle* - NSIS Forums</title><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script><link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css"><link rel="stylesheet" href="../css/style.css" type="text/css"></head><body><div class="container"><ol class="breadcrumb"><li><a href="../index.html" class="glyphicon glyphicon-home"></a></li><li><a href="f-65.html">NSIS Discussion</a></li><li class="active">FindWindow *boggle*</li></ol><p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=44992">FindWindow *boggle*</a></p><br><div class="post"><p class="post-meta"><span class="post-author text-primary">polaughlin</span><br><span class="post-time small text-muted">20th March 2001 04:42 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Alright, so I admit: I'm an amateur programmer. Right now I'm using Visual Basic 6. I'm wondering if anyone has used VB and FindWindow to detect whether their application is running or not.<br><br>Maybe I'm missing something here. Could someone explain how FindWindow works and what exactly a WindowClass is? I feel really stupid asking these questions but I gotta learn somehow :-D.<br><br>Thanks all,<br><br>P</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">spaetz</span><br><span class="post-time small text-muted">20th March 2001 08:04 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Doesn't VB use the CreateWindowEx function of the WIN32 API? Three you have to specify one parameter: the ClassName. It is like the template of a Window.<br><br>You can e.g. you the free util atm (Another Task Manager) <a href="http://atm.idic.caos.it/higheng.html" target="_blank">http://atm.idic.caos.it/higheng.html</a> (it's like 80kb or so IIRC), to choose a process and get a list of its Windows and ClassNames, if you are not sure.<br><br>Winamp2 will e.g. use the ClassName "Winamp v1.x" for it's main Window. Other programms (like ICQ) have just a cryptic name AFX:40000 (or similar) for their class.<br><br>HTH<br>Sebastian</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">polaughlin</span><br><span class="post-time small text-muted">20th March 2001 22:14 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Unfortunately, it appears that VB automatically assigns windowclass names to an application. Is there anyway that FindWindow could also accept a Window Title? For example, if I wanted to find Internet Explorer with NSIS, I could just do:<br><br>FindWindow prompt "Microsoft Internet Explorer" "bleh bleh bleh"<br><br>If not, has anyone been able to use FindWindow with their VB application?</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Jay</span><br><span class="post-time small text-muted">20th March 2001 22:45 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">I know that the MFC FindWindow function in Visual C++ can do a find Window on a Window Title so I am sure that it can be put into the NSIS source code if you need it to do that.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">spanky</span><br><span class="post-time small text-muted">21st March 2001 00:42 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">All VB programs will have the same classname.<br><br>ThunderRT6Form &gt;&gt; For VB 6<br>ThunderRT5Form &gt;&gt; For VB 5<br><br>.. and so on.<br><br>Unless Justin updates NSIS to have an option to read the window title you're out of luck.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Jay</span><br><span class="post-time small text-muted">21st March 2001 04:19 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>FindWindowTitle Function added</strong><br>I decided that it would be useful to find windows based on title so I added to my own personal version, if you want it download it from <a href="http://www.shoutclub.com/nsis/" target="_blank">http://www.shoutclub.com/nsis/</a><br><br>Justin feel free to modify it for your version the source code is included and is just below your FindWindow Function.<br><br>To use the function just put this in your script<br><br>FindWindowTitle &lt;mode&gt; &lt;Window title&gt; &lt;Message Prompt&gt;<br><br>Let me know how it works out, this is the first time I have modified this code and it appears to work fine on my system.<br><br>Jay</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">polaughlin</span><br><span class="post-time small text-muted">21st March 2001 04:29 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Thanks! Works great.<br><br>By the way, it appears that your change also affected the FindWindow command. I was able to use FindWindow and FindWindowTitle interchangeably.<br><br>P</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Jay</span><br><span class="post-time small text-muted">21st March 2001 04:37 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">hmmm I am not able to duplicate that here, if I do a search for a window title with FindWindow, it doesn't appear to work only FindWindowTitle can find a window by title.<br><br>FindWindow will only search for windows by class, at least that the only way I can do it here.<br><br>Does FindWindow work with class names still?<br><br>Can you give me an example of what you are trying to do?</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">polaughlin</span><br><span class="post-time small text-muted">21st March 2001 04:41 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">I've tried it with my application, and other applications. FindWindow works with both Window Title and WindowClass name.<br><br>:-P</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">polaughlin</span><br><span class="post-time small text-muted">21st March 2001 04:45 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Sorry, what I'm doing is this:<br><br>for ICQ:<br><br>(windowclass name)<br>FindWindow prompt "#32770" "bleh bleh bleh"<br><br>I get the message box with Retry, Abort, and Ignore<br><br>(window title)<br>FindWindow prompt "11136292" "bleh"<br><br>same thing<br><br>If I do:<br><br>FindWindow prompt "sdfkjsdfkljsdfl" "bleh"<br><br>no message box<br><br>However, this does not work with FindWindowTitle. It will only accept Window Titles.<br></p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Jay</span><br><span class="post-time small text-muted">21st March 2001 04:56 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">ok I found the bug<br><br>Bad switch statement on my part<br><br>it would probably be a good idea to download this new version. I am not sure what adverse effects the other version could have on other commands.<br><br>download from same location as above<br><a href="http://www.shoutclub.com/nsis/" target="_blank">http://www.shoutclub.com/nsis/</a></p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">polaughlin</span><br><span class="post-time small text-muted">21st March 2001 05:00 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Thanks again. I applied the previous tests to the new version and it seems to work great.<br><br>P</p></div><hr><div class="footer"><p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p></div></div><script src="../js/highlight.pack.js" type="text/javascript"></script><script type="text/javascript">//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]></script></body></html>