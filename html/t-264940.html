<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="description" content="Trying to refresh IE post install"><title>Trying to refresh IE post install - NSIS Forums</title><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script><link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css"><link rel="stylesheet" href="../css/style.css" type="text/css"></head><body><div class="container"><ol class="breadcrumb"><li><a href="../index.html" class="glyphicon glyphicon-home"></a></li><li><a href="f-65.html">NSIS Discussion</a></li><li class="active">Trying to refresh IE post install</li></ol><p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=264940">Trying to refresh IE post install</a></p><br><div class="post"><p class="post-meta"><span class="post-author text-primary">muddlethrough</span><br><span class="post-time small text-muted">2nd February 2007 20:22 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>Trying to refresh IE post install</strong><br>I'm trying to figure out a way to reloading the web page that my install came from once the install has finished. The only options seem to be to use either:<br>ExecShell "open" "url"<br>or<br>Exec '"$PROGRAMFILES\Internet Explorer\iexplore.exe" "url"'<br>but the first opens the default browser or picks a window from the default browser (may not be the window that the install was launched from) to load in. The second forces IE but opens in a new window everytime.<br><br>This only applies to Internet Explorer but there could be people using Firefox with an IE view etc.<br><br>To be honest this seems like too much to be asking but I thought I would throw it open for discussion. Any suggestions?</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Red Wine</span><br><span class="post-time small text-muted">2nd February 2007 20:36 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">I guess this is something the page should do instead of the installer, e.g. within a java script check if your application is installed by checking on registry records, file existence, or whatever, and according to the result of this check show/hide the install link or even show a different page.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">muddlethrough</span><br><span class="post-time small text-muted">2nd February 2007 20:42 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Yes I did think of that and I tried setting a cookie in the installation and looking for that in the browser but the loop that the javascript goes into (continually looking for the cookie) freezes the browser, plus I couldn't figure out how to load the install and then run a javascript function. Maybe this is my poor javascript skills!?</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Red Wine</span><br><span class="post-time small text-muted">2nd February 2007 20:49 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Unfortunately my java script skills are more poor.<br>What I had in mind was something like microsoft's windows update pages, implemented in java, thus suitable for all browsers instead of IE.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">muddlethrough</span><br><span class="post-time small text-muted">2nd February 2007 21:14 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Thank you very much for your suggestions.<br><br>Let me explain further what it is I am trying to do. The UI designers have decided that the ActiveX control (only valid for IE) that we use as part of our site is difficult to install - the nasty yellow bar thing! So my install is supposed to be replacing the the standard ActiveX install with a downloadable executable which will install and register the ActiveX at the click of a button. This all works fine - woo hoo! The standard IE ActiveX install would load the ActiveX as part of the whole process, but if I'm not using that anymore then I need to instruct the browser somehow to load the control after installation. Manual refresh works fine as it can detect whether the control is installed on page reload. Yahoo does it somehow!</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Red Wine</span><br><span class="post-time small text-muted">2nd February 2007 21:41 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">I believe you're just a tick away to achieve it, most likely, soon, other users of this forum will post the way to catch this tick ;)</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">dandaman32</span><br><span class="post-time small text-muted">2nd February 2007 22:08 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Use setTimeout() to check for the cookie once every 3-5 seconds.<br><br></p><pre>
<code>function chkCookie()<br>{<br>  if(document.cookie.indexOf('cookieName'))<br>  {<br>    window.reload();<br>  }<br>  else<br>  {<br>    setTimeout('chkCookie();', 3000);<br>  }<br>}<br>chkCookie();</code>
</pre><br>
      And to those of you who have been wondering where I've been the past several months...I've been learning PHP and Javascript :-)<br>
      <br>
      -dandaman32
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">muddlethrough</span><br>
      <span class="post-time small text-muted">2nd February 2007 22:53 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">That actually seems like it should work, thanks. I made one amendment:<br>
      <br>
      function chkCookie()<br>
      {<br>
      if(document.cookie.indexOf('cookieName') &gt;= 0)<br>
      {<br>
      window.reload();<br>
      }<br>
      else<br>
      {<br>
      setTimeout('chkCookie();', 3000);<br>
      }<br>
      }<br>
      <br>
      Now I just need to figure out my cookie domain issues - but i don't think you guys can help with that one.<br>
      <br>
      Thank you again.</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">onad</span><br>
      <span class="post-time small text-muted">4th February 2007 23:06 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">One can still use DDE to send commands to the browserwindows.<br>
      See old netscape documentation, but it works ain IE and Firefox none the less.</p>
    </div>
    <hr>

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]></script></body></html>