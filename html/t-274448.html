<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="description" content="NET Framework 2.0 after NET Framework 1.1"><title>NET Framework 2.0 after NET Framework 1.1 - NSIS Forums</title><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script><link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css"><link rel="stylesheet" href="../css/style.css" type="text/css"></head><body><div class="container"><ol class="breadcrumb"><li><a href="../index.html" class="glyphicon glyphicon-home"></a></li><li><a href="f-65.html">NSIS Discussion</a></li><li class="active">NET Framework 2.0 after NET Framework 1.1</li></ol><p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=274448">NET Framework 2.0 after NET Framework 1.1</a></p><br><div class="post"><p class="post-meta"><span class="post-author text-primary">dtomhawk</span><br><span class="post-time small text-muted">16th July 2007 10:58 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>NET Framework 2.0 after NET Framework 1.1</strong><br>Hi all.<br><br>The problem:<br><br>IS:<br>The user has NET Framework 1.1 installed<br><br>MUST:<br>NET Framework 2.0 must be downloaded and installed.<br>Application 'ABC-Example' must be installed.<br><br>THE PROBLEM:<br>The installation script downloads NET Framework 2.0 and tries to install it. During the NET Framework 2.0 installation comes the error message: 'The following application must be closed: ABC-Example Installation' with the buttons: "Abort, Retry, Ignore". If I press 'Ignore' the installation proceeds successfully.<br><br>THE QUESTION:<br>How could I avoid the error message ? The installation script works in general, but it looks not pretty.<br><br>Sorry the screenshot is in german, but I hope the general situation is understandable.<br><br>Thanks</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Red Wine</span><br><span class="post-time small text-muted">16th July 2007 12:08 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Weird... I would say these,<br>When download is finished a message box that informs users they should run the installer again after framework installation. After the message box Exec "framework_installer" and terminate your ABC installer.<br>Or, try to execute framework installer in quiet mode and show a banner while it's running.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">dtomhawk</span><br><span class="post-time small text-muted">16th July 2007 12:21 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>Need another way</strong><br>Thank you 'Red Wine' for the answer, but I am trying to make "one click" installation. It is quiet important that the user presses the mouse buttons as seldom as possible.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Red Wine</span><br><span class="post-time small text-muted">16th July 2007 12:43 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">That's a weird situation, I can't think why the halted ABC installer bothers the framework installation and causes that message to appear.<br><br>Did you try the workaround to execute framework installer in silent mode? I think it uses the switch /Q for that.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">dtomhawk</span><br><span class="post-time small text-muted">16th July 2007 13:05 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>Error message</strong><br>To 'Red Wine':<br>Framework in silent mode would be unacceptable because the user must agree with NET Framework 2.0 license.<br><br>I suppose that NET Framework 2.0 updates some dlls, they are being used (direct or indirect) in NSIS Installer and NET Framework 1.1. It is strange that it goes without any problem if there are no NET Frameworks installed.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">kichik</span><br><span class="post-time small text-muted">16th July 2007 19:45 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">You're probably using <a href="http://nsis.sourceforge.net/Get_.NET_Version" target="_blank">GetDotNETVersion</a> which uses mscoree.dll to query the installed version of .NET. Old versions of the function didn't unload the DLL after usage, so the .NET installer would flag them as blocking. Upgrade your .NET detection script to add the "?u" flag to the System::Call line and everything should be fine.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">dtomhawk</span><br><span class="post-time small text-muted">17th July 2007 09:09 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>Thanks</strong><br>To 'kichik':<br>Great thanks ! You are right !!! I was so stupid and didn't proof the GetDOTNetVersion I have and the latest published version.<br><br>Thank you.</p></div><hr><div class="footer"><p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p></div></div><script src="../js/highlight.pack.js" type="text/javascript"></script><script type="text/javascript">//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]></script></body></html>