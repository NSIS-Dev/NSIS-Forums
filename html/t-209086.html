<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="description" content="New plugin"><title>New plugin - NSIS Forums</title><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script><link rel="preload" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css" as="style" onload="this.rel='stylesheet'"><link rel="preload" href="../css/style.css" as="style" onload="this.rel='stylesheet'"><noscript><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css"><link rel="stylesheet" href="../css/style.css"></noscript><script>!function(a){"use strict";var b=function(b,c,d){function e(a){return h.body?a():void setTimeout(function(){e(a)})}function f(){i.addEventListener&&i.removeEventListener("load",f),i.media=d||"all"}var g,h=a.document,i=h.createElement("link");if(c)g=c;else{var j=(h.body||h.getElementsByTagName("head")[0]).childNodes;g=j[j.length-1]}var k=h.styleSheets;i.rel="stylesheet",i.href=b,i.media="only x",e(function(){g.parentNode.insertBefore(i,c?g:g.nextSibling)});var l=function(a){for(var b=i.href,c=k.length;c--;)if(k[c].href===b)return a();setTimeout(function(){l(a)})};return i.addEventListener&&i.addEventListener("load",f),i.onloadcssdefined=l,l(f),i};"undefined"!=typeof exports?exports.loadCSS=b:a.loadCSS=b}("undefined"!=typeof global?global:this);!function(a){if(a.loadCSS){var b=loadCSS.relpreload={};if(b.support=function(){try{return a.document.createElement("link").relList.supports("preload")}catch(b){return!1}},b.poly=function(){for(var b=a.document.getElementsByTagName("link"),c=0;c<b.length;c++){var d=b[c];"preload"===d.rel&&"style"===d.getAttribute("as")&&(a.loadCSS(d.href,d,d.getAttribute("media")),d.rel=null)}},!b.support()){b.poly();var c=a.setInterval(b.poly,300);a.addEventListener&&a.addEventListener("load",function(){b.poly(),a.clearInterval(c)}),a.attachEvent&&a.attachEvent("onload",function(){a.clearInterval(c)})}}}(this);</script></head><body><div class="container"><ol class="breadcrumb"><li><a href="../index.html" class="glyphicon glyphicon-home"></a></li><li><a href="f-65.html">NSIS Discussion</a></li><li class="active">New plugin</li></ol><p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=209086">New plugin</a></p><br><div class="post"><p class="post-meta"><span class="post-author text-primary">hgerstung</span><br><span class="post-time small text-muted">28th February 2005 09:17 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>New plugin</strong><br>Hi y'all!<br><br>I released my first plugin for NSIS (so be careful, it's a newbies work) called UserMgr. It can be found in the plugin section of the NSIS Archive and adds some functionality to NSIS when it comes to creating/deleting user accounts and adding/removing user privileges to accounts. Some user group related functions are included, too.<br><br>I would appreciate any feedback / comments if you are willing to use this thing for your installer and surprisingly get it to work (or not).<br><br>Kind regards,<br>Heiko<br><br><a href="http://nsis.sourceforge.net/archive/nsisweb.php?page=917&amp;instances=0" target="_blank">The Archive page for UserMgr</a></p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">flizebogen</span><br><span class="post-time small text-muted">28th February 2005 13:42 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Can you put a list of privileges online?</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Joel</span><br><span class="post-time small text-muted">28th February 2005 14:05 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">mmm, sounds cool, good work, dude :up:</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">hgerstung</span><br><span class="post-time small text-muted">28th February 2005 15:17 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">@flizebogen:<br><br></p><blockquote><i>Originally posted by flizebogen</i><br><b>Can you put a list of privileges online?</b></blockquote>That's tricky, I did not find a complete list on the web. But I added a list (incomplete) at the bottom of the archive page (<a href="http://nsis.sourceforge.net/archive/nsisweb.php?page=917&amp;instances=0" target="_blank">here</a>), this can be used for a start.<br><br>HTH<br><br>@Joelito: :cool: Thanks dude! :cool:<br><br>Kind regards,<br>Heiko</div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Apazman123</span><br><span class="post-time small text-muted">29th April 2005 18:54 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>UserMgr::AddToGroup - Issue</strong><br>I am trying to use this plugin to create a user and add them to the "Administrators" Group. I can add the user successfully, however when I try to Add that user to a group I get an ERROR 2220 Which is "The group name could not be found. " I have double and triple checked the spelling. I also tried to add it to the "Guests" group. I still got the same error. It seems like adding a user to a group may not work? Here is the code I am trying to use.<br><br>UserMgr::AddToGroup "progsvc" "Administrators"<br>Pop $0<br>MessageBox MB_OK "AddToGroup Result : $0"</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">hgerstung</span><br><span class="post-time small text-muted">30th April 2005 19:40 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>Re: UserMgr::AddToGroup - Issue</strong><br></p><blockquote><i>Originally posted by Apazman123</i><br><b>I am trying to use this plugin to create a user and add them to the "Administrators" Group. I can add the user successfully, however when I try to Add that user to a group I get an ERROR 2220 Which is "The group name could not be found. " I have double and triple checked the spelling. I also tried to add it to the "Guests" group. I still got the same error. It seems like adding a user to a group may not work? Here is the code I am trying to use.<br><br>UserMgr::AddToGroup "progsvc" "Administrators"<br>Pop $0<br>MessageBox MB_OK "AddToGroup Result : $0"</b></blockquote>Hi!<br><br>The AddToGroup function is not working properly, there is a problem with the string format I use, it's some UNICODE struggling and I was not able to solve this. But I'll try to check things again on Monday, so please stay tuned :-)<br><br>Sorry for the inconvenience!<br><br>Kind regards,<br>Heiko</div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Apazman123</span><br><span class="post-time small text-muted">2nd May 2005 18:43 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>Thanks for the help</strong><br>I really appreciate the help. It's a cool plugin and makes things really easy for setting up a web and/or application servers.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">RobGrant</span><br><span class="post-time small text-muted">3rd May 2005 09:12 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">I use some user manipulation stuff in my company's installer - the syntax I use to add someone to a group is this:<br><br></p><pre>
<code><br>  ExecWait 'net localgroup group_name "user_name" /add'<br></code>
</pre><br>
      <br>
      And to remove:<br>
      <br>
      <pre>
<code><br>  ExecWait 'net localgroup group_name "user_name" /delete'<br></code>
</pre><br>
      <br>
      And mate, if your work (which I'm about to try) adds/removes the SeServiceLogonRight property correctly, then you've saved me lots of time, thanks! (I can add it easily, but can't remove it)<br>
      <br>
      -rob-
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">hgerstung</span><br>
      <span class="post-time small text-muted">3rd May 2005 09:21 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Hi !<br>
      <br>
      I just wanted to tell you that I'm still working on that AddToGroup issue ... But maybe you can use Rob's way as a workaround until the plugin is able to do that.<br>
      <br></p>

      <blockquote>
        <i>Originally posted by RobGrant</i><br>
        <b>I use some user manipulation stuff in my company's installer - the syntax I use to add someone to a group is this:<br>
        <br></b>
        <pre>
<b><code><br>  ExecWait 'net localgroup group_name "user_name" /add'<br></code></b>
</pre><b><br>
        <br>
        And to remove:<br>
        <br></b>
        <pre>
<b><code><br>  ExecWait 'net localgroup group_name "user_name" /delete'<br></code></b>
</pre><b><br>
        <br>
        And mate, if your work (which I'm about to try) adds/removes the SeServiceLogonRight property correctly, then you've saved me lots of time, thanks! (I can add it easily, but can't remove it)<br>
        <br>
        -rob-</b>
      </blockquote>Please note that there are a bunch of "SeDenyxxLogonRight" privileges which I needed to add in order to avoid an account from being able to logon interactively. That's a cute security model, isn't it?<br>
      <br>
      Kind regards,<br>
      Heiko
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Apazman123</span><br>
      <span class="post-time small text-muted">3rd May 2005 23:45 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>Thanks for the help - still got a bit more to go</strong><br>
      Thanks Rob and Heiko for the cmd lines. Worked like a charm. Now I have another issue. I am trying to add the following options to the user:<br>
      <br>
      -Password Never expires<br>
      -User cannot change Password<br>
      <br>
      Any Ideas?</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">UnregBryan</span><br>
      <span class="post-time small text-muted">28th September 2005 12:48 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>AddToGroup problem</strong><br>
      Hi all. 28 September 05<br>
      <br>
      Just ran into the problem of AddToGroup problem, but as none of the messages are dated do not know if this problem has been outstanding for a year or a day! Can someone please give me a time scale for a solution - thanks.<br>
      <br>
      Tried ...<br>
      ExecWait 'net localgroup administrators "TagUser" /add'<br>
      <br>
      But get system error 1788 "the trusted relationship..". I'm adding a user to Administrators. Any solution here?<br>
      <br>
      Many thanks<br>
      Bryan<br>
      <br>
      <br></p>

      <blockquote>
        <i>Originally posted by hgerstung</i><br>
        <b>Hi !<br>
        <br>
        I just wanted to tell you that I'm still working on that AddToGroup issue ... But maybe you can use Rob's way as a workaround until the plugin is able to do that.<br>
        <br>
        <br>
        <br>
        Please note that there are a bunch of "SeDenyxxLogonRight" privileges which I needed to add in order to avoid an account from being able to logon interactively. That's a cute security model, isn't it?<br>
        <br>
        Kind regards,<br>
        Heiko</b>
      </blockquote>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">hgerstung</span><br>
      <span class="post-time small text-muted">28th September 2005 13:03 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Hi!<br>
      <br>
      First:<br>
      The time and date of a post can be found on the left side of the line directly below the message text (where the "profile", "pm", "search" etc. buttons reside)<br>
      <br>
      Second:<br>
      As you see (by now), the last post you quoted was from March 2005, so it's been a while..<br>
      <br>
      I was not able to resolve this in the meantime as I simply do not have enough time to go after it (sorry).<br>
      <br>
      Maybe someone else can help out with the commandline workaround. If this does not work, my plugin has no chance either..<br>
      <br>
      Kind regards,<br>
      Heiko</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">ThierryThelliez</span><br>
      <span class="post-time small text-muted">28th October 2005 19:07 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">I have the same need here. Right now I am thinking of using NTRights.exe from the resource toolkit.<br>
      <br>
      <a href="http://support.microsoft.com/?kbid=279664" target="_blank">http://support.microsoft.com/?kbid=279664</a><br>
      <br>
      (I hope it will work for W2K3)<br>
      <br>
      Your plugin would be really useful.<br>
      <br>
      Thierry</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Jamyn Shanley</span><br>
      <span class="post-time small text-muted">26th February 2006 12:42 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>Interesting</strong><br>
      Just tried this plugin tonight; I wanted to add a user account to run a service in the background. I must say, thank you for writing this plugin. I think it will be very useful.<br>
      <br>
      A couple notes:<br>
      <br>
      1) The plugin does add the user and set the password. However, the user does not appear in the Control Panel -&gt; Users list. (testing with WindowsXP SP2). This could be abused, obviously; hopefully this could be fixed.<br>
      <br>
      In comparison, when using the "net user" command, the user appears in "Control Panel -&gt; Users" immediately.<br>
      <br>
      2) Is there a way to "update" a user with this plugin, instead of just add/remove? I would like to be able to reset the password on the account if it exists (the password for the account is randomly generated during any install, and I need that password for the task scheduler).<br>
      <br>
      Example:<br>
      <br></p>
      <pre>
<code><br>Function AddUser <br>    UserMgr::GetUserInfo ${RUNAS} EXISTS<br>    StrCmp "$0" "OK" user_modify user_add<br>    user_modify:<br>    # FIXME: Previous password is random and unknown,<br>    # so we need to reset it here.<br>    Goto user_done<br>    user_add:<br>        UserMgr::CreateAccount "${RUNAS}" "$RandomPassword" "${NAME} User"<br>        Pop $0<br>        DetailPrint "User: ${RUNAS} does not exist. Creating account (result: $0)"<br>        UserMgr::AddToGroup  "${RUNAS}" "Guests"<br>        Pop $0<br>        DetailPrint "User: ${RUNAS} - applying account restrictions (result: $0)"        <br>        # FIXME: Remove interactive login permissions, etc.<br>        # Lock the account down as much as possible.<br>    Goto user_done<br>    user_done:<br>FunctionEnd<br></code>
</pre>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">hgerstung</span><br>
      <span class="post-time small text-muted">27th February 2006 10:49 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Hi!<br>
      <br>
      The account can be found in the "extended" user manager applet, you can reach this by using the "Advanced.." button (I am not sure how exactly it is labelled, as my system is a german language XP). The cause of this could be a group membership (but I do not know exactly), maybe it appears if you add it to the Users group?<br>
      <br>
      Unfortunately the modification of a user account is not implemented. You could delete and re-create the user but this could of course cause problems with settings and files and so on.<br>
      <br>
      Kind regards,<br>
      Heiko</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Jamyn Shanley</span><br>
      <span class="post-time small text-muted">8th March 2006 19:57 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>Example Code?</strong><br>
      I found some interesting code for PostgreSQL's msi-based installer. I may be wrong, but the following code from their installer seems to deal with user and group permissions, etc. Maybe it will help present new ideas for the current plugin?<br>
      <br>
      <a href="http://pgfoundry.org/frs/?group_id=1000007&amp;release_id=440" target="_blank">installer source</a><br>
      <br>
      file: pginstaller-rel8_1_2-src\pginst\ca\user.c<br>
      <br>
      I am not really capable of translating this information into the current plugin; I apologize. And maybe this information will not prove to be useful. But maybe it will :)<br>
      <br>
      -J</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">jpderuiter</span><br>
      <span class="post-time small text-muted">31st December 2007 15:00 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Hello Heiko,<br>
      <br>
      I know it has been a while since the last post, but I have made a patch for your UserMgr plugin.<br>
      <br>
      These are the changes:<br>
      <br>
      - I used NetLocalGroupAddMembers instead of NetGroupAddUser in the AddToGroup function to make it work.(Thanks to the article of CancerFace (http://nsis.sourceforge.net/User_Management_using_API_calls))<br>
      <br>
      - I added the function CreateAccountEx to be able to add a fullname of a user (Shown in the Welcome Screen) and add flags to the user (Password never expires etc.):<br>
      <br></p>
      <pre>
<code><br>UserMgr::CreateAccountEx USERID PASSWORD COMMENT FULLNAME USERCOMMENT FLAGS<br>where FLAGS can be one or more of the following, seperated by '|':<br>UF_ACCOUNTDISABLE      The user's account is disabled.<br>UF_PASSWD_NOTREQD      No password is required.<br>UF_PASSWD_CANT_CHANGE  The user cannot change the password.<br>UF_DONT_EXPIRE_PASSWD  The password will never expire on the account.<br></code>
</pre><br>
      - I added the function BuiltAccountEnv. This function creates the User Environment (Documents and settings\{User} folder, User Registry Hive etc. to be able to do something there without the need to login as the new created user first:<br>
      <br>
      <pre>
<code><br>UserMgr::BuiltAccountEnv USERID PASSWORD<br></code>
</pre><br>
      - I added the function RegLoadUserHive. This function loads the User Registry hive in HKEY_USERS\{USERID} to be able to add keys and values to the HKEY_CURRENT_USER of this user:<br>
      <br>
      <pre>
<code><br>UserMgr::RegLoadUserHive USERID<br></code>
</pre><br>
      - I added the function RegUnLoadUserHive. This function unloads the User Registry hive:<br>
      <br>
      <pre>
<code><br>UserMgr::RegUnLoadUserHive USERID<br></code>
</pre><br>
      I guess the last two functions should be in a Registry Plugin, but since I only found a Plugin with Macro's (which I dislike...) I added it here.<br>
      If you don't want it in the plugin, I can remove it.<br>
      <br>
      NOTE: The Platform SDK is needed for this project to compile (The February 2003 build is the last version which work with VC6) (http://www.microsoft.com/msdownload/platformsdk/sdkupdate/psdk-full.htm)<br>
      <br>
      Best regards,<br>
      Jan Pieter de Ruiter
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br>
      <span class="post-time small text-muted">31st December 2007 18:20 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">You should add the new version to the Wiki page. To upload files, see:<br>
      <br>
      <a href="http://nsis.sourceforge.net/Uploading_files" target="_blank">http://nsis.sourceforge.net/Uploading_files</a></p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">jpderuiter</span><br>
      <span class="post-time small text-muted">1st January 2008 00:12 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>UserMgr plugin</strong><br>
      Yes I know,<br>
      <br>
      but since it's Heiko's plugin I wanted to ask his opinion first.<br>
      <br>
      JP</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">hgerstung</span><br>
      <span class="post-time small text-muted">2nd January 2008 20:55 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Jan Pieter,<br>
      <br>
      awesome work! Please do not hesitate to update the Wiki, that's what it's for! And please do not forget to give yourself the due credit.<br>
      <br>
      Thanks a lot for working on this,<br>
      <br>
      Cheers,<br>
      Heiko</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">jpderuiter</span><br>
      <span class="post-time small text-muted">2nd January 2008 21:43 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">I have made two additions for the plugin:<br>
      <br>
      - PASSWORD added as possible FIELD for the SetUserInfo function. With this field the user password can be changed (Admin rights needed)<br>
      <br>
      - The function ChangeUserPassword is added to be able to change a user password (Admin rights not needed)<br>
      <br>
      I have also updated the Wiki page:<br>
      http://nsis.sourceforge.net/UserMgr_plug-in<br>
      You can find the updated plugin there.<br>
      <br>
      Regards,<br>
      JP</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">jpderuiter</span><br>
      <span class="post-time small text-muted">15th January 2008 00:50 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Hello,<br>
      <br>
      I have uploaded a new version:<br>
      <br>
      - Fixed a small bug in GetUserInfo function<br>
      <br>
      - Fixed 2 small bugs in SetUserInfo function<br>
      <br>
      - Added GetCurrentUserName function<br>
      <br>
      - Added GetLocalizedStdAccountName function<br>
      (e.g. "NT AUTHORITY\SYSTEM" for "S-1-5-18" on a English system and "NT-AUTORITÃ„T\NETZWERKDIENST" for "S-1-5-20" on a German system)<br>
      The most often used SID's are defined in the included SpecialGroupsSIDs.nsh<br>
      <br>
      - Added IsMemberOfGroup function<br>
      <br>
      Best regards,<br>
      jpderuiter</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">jpderuiter</span><br>
      <span class="post-time small text-muted">15th January 2008 17:06 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Whoops, found a small (localization) bug in RegLoadUserHive.<br>
      <br>
      I uploaded a new version on the wiki page.<br>
      <br>
      JP</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">jpderuiter</span><br>
      <span class="post-time small text-muted">1st February 2008 17:25 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Hello,<br>
      <br>
      I have uploaded a new version:<br>
      <br>
      - Fixed a bug in SetUserInfo function<br>
      <br>
      - Added HasPrivilege function<br>
      <br>
      Best regards,<br>
      jpderuiter</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Margon</span><br>
      <span class="post-time small text-muted">21st June 2008 12:12 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Hi,<br>
      First of all, sorry for my English.<br>
      <br>
      I tried to use plugin in Russian Windows XP and found little localization problem: when i tried to work with user name in russian language function "swprintf" can't convert ANSI string to UNICODE in russian locale. I'l tried to use MultiByteToWideChar instead them and all works.<br>
      IMHO, all functins<br>
      "swprintf(UNICODE_variable, L"%S", ANSI_variable)"<br>
      must be replaced to something like<br>
      MultiByteToWideChar(CP_ACP,0,UNICODE_variable,-1,ANSI_variable,sizeof(UNICODE_variable));<br>
      <br>
      Best regards, Dmitriy.<br>
      P.S.: Sorry for my English.Once again:)</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Wizou</span><br>
      <span class="post-time small text-muted">25th June 2008 09:57 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">@jpderuiter: you should really think about opening a new forum topic for your plugin, because this one lacks a decent title..</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kc7bfi</span><br>
      <span class="post-time small text-muted">19th September 2008 13:15 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>Missing ZIP</strong><br>
      The UserMgr.zip link does not seem to be working</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">pengyou</span><br>
      <span class="post-time small text-muted">19th September 2008 14:52 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"></p>

      <blockquote>
        The UserMgr.zip link does not seem to be working
      </blockquote>The NSIS site is hosted by SourceForge who are currently migrating to a new datacentre. As a result some features on the NSIS wiki, including downloads, are not working properly at the moment. For more information see this topic:<br>
      <br>
      <a href="http://forums.winamp.com/showthread.php?threadid=297527" target="_blank">http://forums.winamp.com/showthread.php?threadid=297527</a>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Ivan Andreevich</span><br>
      <span class="post-time small text-muted">21st January 2009 20:27 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">I am logged in as 'mshome\ivan', but<br></p>
      <pre>
<code>UserMgr::GetCurrentUserName</code>
</pre><br>
      returns only 'ivan'. I am creating a service which uses network log on permissions. This action fails when domain is not specified.<br>
      <br>
      Any way to grab the full username, including the domain?<br>
      <br>
      Actually this <a href="http://nsis.sourceforge.net/NSISUser_plug-in" target="_blank">http://nsis.sourceforge.net/NSISUser_plug-in</a> kind of does what I need, but I would still prefer to be able to do the above.
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">jpderuiter</span><br>
      <span class="post-time small text-muted">22nd January 2009 00:23 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>UserMgr Plugin</strong><br>
      Hello Ivan,<br>
      <br>
      I uploaded a new version of the plugin, which has a new Function "GetCurrentDomain".<br>
      This function will return the domainname you are currently logged in to (in your case "mshome").<br>
      <br>
      Best regards,<br>
      jpderuiter</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">jpderuiter</span><br>
      <span class="post-time small text-muted">22nd January 2009 08:19 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">BTW:<br>
      <br>
      I started a new thread about the UserMgr Plugin with a more decent title:<br>
      <a href="http://forums.winamp.com/showthread.php?s=&amp;threadid=302322" target="_blank">http://forums.winamp.com/showthread....hreadid=302322</a></p>
    </div>
    <hr>

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script type="text/javascript" src="../js/highlight.pack.js" async>
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]></script></body></html>