<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="description" content=".NET 2.0 Installer asking to close NSIS setup"><title>.NET 2.0 Installer asking to close NSIS setup - NSIS Forums</title><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script><link rel="preload" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css" as="style" onload="this.rel='stylesheet'"><link rel="preload" href="../css/style.css" as="style" onload="this.rel='stylesheet'"><noscript><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css"><link rel="stylesheet" href="../css/style.css"></noscript><script>!function(a){"use strict";var b=function(b,c,d){function e(a){return h.body?a():void setTimeout(function(){e(a)})}function f(){i.addEventListener&&i.removeEventListener("load",f),i.media=d||"all"}var g,h=a.document,i=h.createElement("link");if(c)g=c;else{var j=(h.body||h.getElementsByTagName("head")[0]).childNodes;g=j[j.length-1]}var k=h.styleSheets;i.rel="stylesheet",i.href=b,i.media="only x",e(function(){g.parentNode.insertBefore(i,c?g:g.nextSibling)});var l=function(a){for(var b=i.href,c=k.length;c--;)if(k[c].href===b)return a();setTimeout(function(){l(a)})};return i.addEventListener&&i.addEventListener("load",f),i.onloadcssdefined=l,l(f),i};"undefined"!=typeof exports?exports.loadCSS=b:a.loadCSS=b}("undefined"!=typeof global?global:this);!function(a){if(a.loadCSS){var b=loadCSS.relpreload={};if(b.support=function(){try{return a.document.createElement("link").relList.supports("preload")}catch(b){return!1}},b.poly=function(){for(var b=a.document.getElementsByTagName("link"),c=0;c<b.length;c++){var d=b[c];"preload"===d.rel&&"style"===d.getAttribute("as")&&(a.loadCSS(d.href,d,d.getAttribute("media")),d.rel=null)}},!b.support()){b.poly();var c=a.setInterval(b.poly,300);a.addEventListener&&a.addEventListener("load",function(){b.poly(),a.clearInterval(c)}),a.attachEvent&&a.attachEvent("onload",function(){a.clearInterval(c)})}}}(this);</script></head><body><div class="container"><ol class="breadcrumb"><li><a href="../index.html" class="glyphicon glyphicon-home"></a></li><li><a href="f-65.html">NSIS Discussion</a></li><li class="active">.NET 2.0 Installer asking to close NSIS setup</li></ol><p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=262097">.NET 2.0 Installer asking to close NSIS setup</a></p><br><div class="post"><p class="post-meta"><span class="post-author text-primary">soundken</span><br><span class="post-time small text-muted">19th December 2006 19:50 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>.NET 2.0 Installer asking to close NSIS setup</strong><br>I have a customer using my installer on a Windows XP machine (has Internet Explorer 6.0).<br><br>The NSIS installer checks for .NET installed and using NSIS::download, downloads the .NET 2.0 installer and starts the installer running with an ExecWait.<br><br>The .NET 2.0 installer goes through an initial step of "Validating Install" and seems to be checking for IE 5.01.<br><br>At that point, the .NET 2.0 installer opens a dialog box titled "Files In Use" and suggests that the user stop the NSIS installer program before continuing.<br><br>Does NSIS use any files that .NET 2.0 needs to install or having to do with IE?<br><br>This doesn't happen on every Windows XP machine that needs 2.0 installed, and I don't have access to this customer's machine.<br><br>The code segment that does the download and install is:<br><br>Section "" SEC01 ;dotnetfx.exe<br>SectionIn RO<br>${If} $NETRegistry == ""<br>!define DOTNET_URL "http://download.microsoft.com/download/5/6/7/567758a3-759e-473e-bf8f-52154438565a/dotnetfx.exe"<br>DetailPrint "Beginning download of latest .NET Framework version."<br>NSISDL::download ${DOTNET_URL} "$TEMP\dotnetfx.exe"<br>DetailPrint "Completed download."<br>Pop $R0<br>StrCmp $R0 "success" +3<br>MessageBox MB_OK "Download failed: $R0"<br>Quit<br>try_install_again:<br>DetailPrint "Pausing installation while downloaded .NET Framework installer runs."<br>ExecWait "$TEMP\dotnetfx.exe"<br>!insertmacro CheckDotNET<br>${If} $NETRegistry == ""<br>MessageBox MB_RETRYCANCEL|MB_DEFBUTTON1 ".NET did not get installed. Do you want to try again?" IDRETRY +2<br>Abort "You have chosen to cancel the installation."<br>goto try_install_again<br>${EndIf}<br>DetailPrint "Completed .NET Framework install/update. Cleaning temporary files..."<br>Delete "$TEMP\dotnetfx.exe"<br>DetailPrint "Completed cleaning temporary files."<br>${EndIf}<br>SectionEnd<br><br>Thanks for your help.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Red Wine</span><br><span class="post-time small text-muted">19th December 2006 23:02 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">My guess is that a running proccess on target uses those "Files In Use" files.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">soundken</span><br><span class="post-time small text-muted">19th December 2006 23:05 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">The "Files In Use" dialog only listed my NSIS installer as the application that should be stopped. So it seems like that is the only running process that the .NET installer was complaining about.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Red Wine</span><br><span class="post-time small text-muted">19th December 2006 23:15 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">As far as I know NSIS has nothing to do with this. Besides why this happens only on the specific target? Maybe you should manually unload all loaded plugins by your installer?</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">soundken</span><br><span class="post-time small text-muted">19th December 2006 23:25 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">It looks like by defualt plugins are unloaded. You have to explicitly say /NOUNLOAD. Are there any others steps I need to do to unload the plugins? Specifically NSISDL and whatever plugin ExecWait uses?</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Red Wine</span><br><span class="post-time small text-muted">19th December 2006 23:34 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">SetPluginUnload is the instruction, I guess you need to try all possible ways just to be sure that the fault is not from your side.<br>Another thing is to provide your customer with an installer that executes downloaded .Net installer and then quits (no ExecWait) and ask them to once .Net is successfully installed re-run your installer to complete the intallation and drop you a note if worked by this way.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">kichik</span><br><span class="post-time small text-muted">22nd December 2006 11:16 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Did you use GetCORVersion to get the installed .NET version? By default, the System plug-in doesn't unload DLLs it calls. For that, you must add ?u to the end of the call line. I've updated my <a href="http://nsis.sourceforge.net/Get_.NET_Version" target="_blank">script</a> on the wiki.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">soundken</span><br><span class="post-time small text-muted">28th December 2006 16:42 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Yes, I am using GetCORVersion. I've added the ?u to the call.<br><br>Thanks.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">onad</span><br><span class="post-time small text-muted">3rd January 2007 12:31 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Hi soundken,<br><br>does the "Thanks" mean you got it working by adding "?u" ?</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">soundken</span><br><span class="post-time small text-muted">3rd January 2007 16:04 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">We were never able to reproduce the problem, so I can't verify that this worked.</p></div><hr><div class="footer"><p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p></div></div><script type="text/javascript" src="../js/highlight.pack.js" async></script><script type="text/javascript">//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]></script></body></html>