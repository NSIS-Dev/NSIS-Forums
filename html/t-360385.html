<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="description" content="MUI_FINISHPAGE_RUN not working for some programs"><title>MUI_FINISHPAGE_RUN not working for some programs - NSIS Forums</title><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script><link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css"><link rel="stylesheet" href="../css/style.css" type="text/css"><!--[if lt IE 9]><script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script><script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script><![endif]--></head><body><div class="container"><ol class="breadcrumb"><li><a href="../index.html" class="glyphicon glyphicon-home"></a></li><li><a href="f-65.html">NSIS Discussion</a></li><li class="active">MUI_FINISHPAGE_RUN not working for some programs</li></ol><p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=360385">MUI_FINISHPAGE_RUN not working for some programs</a></p><br><div class="post"><p class="post-meta"><span class="post-author text-primary">mattcoz</span><br><span class="post-time small text-muted">29th April 2013 22:27 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>MUI_FINISHPAGE_RUN not working for some programs</strong><br>This is very strange. I have my installer set up to run a program using MUI_FINISHPAGE_RUN, but it doesn't run. If I change to a different program, it runs fine. The file is definitely there, and I can run the program afterwards. The one caveat here is that the program is a Java application that I wrapped using launch4j. Is it possible that it is launching in the same Java process as the installer and then that Java process is ending when the installer ends? If this is the case, does anyone know a way around it?</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Anders</span><br><span class="post-time small text-muted">30th April 2013 06:08 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Does it need UAC elevation? You could try using the run function define and then use ExecShell in this function...</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">mattcoz</span><br><span class="post-time small text-muted">30th April 2013 18:19 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Thanks, gave that a try and it didn't help. I also tried ExecWait thinking it would keep the Java process open. I ended up figuring it out though, and it was weird. The problem had something to do with the working directory. I had to use SetOutPath to reset it to the directory that I installed the program to. Not sure why, but it works now.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Anders</span><br><span class="post-time small text-muted">30th April 2013 18:23 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Java apps tend to be picky about their working dir, this is not a good thing! It should be treated as a bug in your app or the java launcher...</p></div><hr><div class="footer"><p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p></div></div><script src="../js/highlight.pack.js" type="text/javascript"></script><script type="text/javascript">//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]></script></body></html>