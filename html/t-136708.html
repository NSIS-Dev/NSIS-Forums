<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="NSIS dialog problem" />

  <title>NSIS dialog problem - NSIS Forums</title>
  <script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script>
  <!-- Bootstrap core CSS -->

  <link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css" />
  <link rel="stylesheet" href="../css/style.css" type="text/css" /><!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!--[if lt IE 9]>
                <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
                <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->
</head>

<body>
  <div class="container">
    <!-- Put navigation bar here -->

    <ol class="breadcrumb">
      <li><a href="../index.html" class="glyphicon glyphicon-home"></a></li>

      <li><a href="f-65.html">NSIS Discussion</a></li>

      <li class="active">NSIS dialog problem</li>
    </ol>

    <p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=136708">NSIS dialog problem</a></p><br />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">weebib</span><br />
      <span class="post-time small text-muted">26th May 2003 19:49 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>NSIS dialog problem</strong><br />
      Hello to all,<br />
      <br />
      I just completed my first install with NSIS. It is almost working. I still have a small problem though.<br />
      <br />
      My program is a Java program so I have to verify/install the correct version of the JRE. To that effect, I have created a custom page which calls the function SetCustomJRE. After various verifications (is there a JRE installed, if not is there a JDK installed, if so is the version number compatible...), the installer eventually prompts the user with the custom page, thus displaying the problem message. The user just has to press Next to install a JRE. (So to answer future questions, there has been at least one window displayed at that time.)<br />
      <br />
      Once the next button is pressed, I launch the download process of the correct JRE (sun's package j2re-1_4_1_02-windows-i586-i.exe).<br />
      <br />
      What happens is that the download succeeds but no window appears. As I am still testing, I put the corresponding file on a web server within my local area network. Still, the file is 10MB so it really takes a few seconds during which the user does know what is going on.<br />
      <br />
      Any help welcome,<br />
      Thanks in advance,<br />
      <br />
      Weebib</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
      <span class="post-time small text-muted">26th May 2003 20:01 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Welcome to the forum.<br />
      <br />
      NSISdl is not designed to run from within custom page's creator functions. It can only be used in sections unless used in silent mode (NSISdl::download_quiet).<br />
      <br />
      You'd have to move the download code into a section and leave some information in parameters for that section so it can know what to download.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">weebib</span><br />
      <span class="post-time small text-muted">26th May 2003 20:16 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Thank you for your quick answer.<br />
      <br />
      I was actually afraid you'd say that.<br />
      <br />
      So let me see if I get it right :<br />
      - I need to create a section in which I will place the download code<br />
      - When I have determined that a download is necessary I put a flag in a global variable such as $9 for instance.<br />
      - In my SetCustomJRE, I test the value of $9 and run the download if necessary.<br />
      <br />
      My only trouble is to know when this section will be called. How can I ensure it will run before the License page for example, or at least run before the actual installation of my program since the success of the JRE installation is necessary.<br />
      <br />
      Thanks in advance,<br />
      Weebib</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
      <span class="post-time small text-muted">26th May 2003 20:26 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">You have two options:<br />
      <br />
      1) Create another installer that will show the custom page, download JRE and install it. Call this installer from .onInit of the main installer.<br />
      <br />
      2) Put two instfiles pages, and add a hidden section (Section "" or Section "-namedoesntmatter"). In the pre function of the first instfiles page disable every section but the hidden JRE section and then it will be the only one that will execute, and in the pre function of the components page disable that hidden section and re-enable all of the others. If you don't have a components page do it in the pre function of the second instfiles page or any other script block that is executed before the second instilfes page starts executing sections.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
      <span class="post-time small text-muted">26th May 2003 20:44 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">On second thought, it would be better to set the sections back to normal on the leave function of the first instfiles so if you have pages before the components page/second instfiles the user's selection won't be overridden.<br />
      <br />
      Example attached.</p>
    </div>
    <hr />

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]>
  </script>
</body>
</html>
