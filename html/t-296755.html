<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="HideWindow Doesn't work!" />

  <title>HideWindow Doesn't work! - NSIS Forums</title><!-- Bootstrap core CSS -->
  <link rel="stylesheet" type="text/css" href="//netdna.bootstrapcdn.com/bootswatch/3.0.1/readable/bootstrap.min.css" />
  <link rel="stylesheet" href="../css/style.css" type="text/css" /><!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!--[if lt IE 9]>
                <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
                <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->
</head>

<body>
  <div class="container">
    <!-- Put navigation bar here -->

    <ol class="breadcrumb">
      <li><a href="../index.html" class="glyphicon glyphicon-home"></a></li>

      <li><a href="f-65.html">NSIS Discussion</a></li>

      <li class="active">HideWindow Doesn't work!</li>
    </ol>

    <p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=296755">HideWindow Doesn't work!</a></p><br />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Jennifer K</span><br />
      <span class="post-time small text-muted">1st September 2008 12:10 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>HideWindow Doesn't work!</strong><br />
      I wrote an installer based on the makensis.nsi example.<br />
      <br />
      Function PageLeaveReinstall was copied verbatim, unmodified (except for the registry path for "UninstallString").<br />
      <br />
      But HideWindow inside that function doesn't work!<br />
      <br /></p>
      <pre>
<span style="color: #007700">Function</span><span style="color: #0000BB">PageLeaveReinstall
<br /><br /></span><span style="color: #007700">${</span><span style="color: #0000BB">NSD_GetState</span><span style="color: #007700">}</span><span style="color: #0000BB">$R2$R1
<br /><br />StrCmp$R0</span><span style="color: #DD0000">"1"</span><span style="color: #0000BB">0</span><span style="color: #007700">+</span><span style="color: #0000BB">2
<br />StrCmp$R1</span><span style="color: #DD0000">"1"</span><span style="color: #0000BB">reinst_uninstallreinst_done
<br /><br />StrCmp$R0</span><span style="color: #DD0000">"2"</span><span style="color: #0000BB">0</span><span style="color: #007700">+</span><span style="color: #0000BB">3
<br />StrCmp$R1</span><span style="color: #DD0000">"1"</span><span style="color: #0000BB">reinst_donereinst_uninstall
<br /><br />reinst_uninstall</span><span style="color: #007700">:
<br /></span><span style="color: #0000BB">ReadRegStr$R1HKLM</span><span style="color: #DD0000">"Software\Microsoft\Windows\CurrentVersion\Uninstall\NSIS""UninstallString"
<br /><br /></span><span style="color: #007700">;</span><span style="color: #0000BB">Rununinstaller
<br />HideWindow
<br /><br />ClearErrors
<br />ExecWait</span><span style="color: #DD0000">'$R1_?=$INSTDIR'
<br /><br /></span><span style="color: #0000BB">IfErrorsno_remove_uninstaller
<br />IfFileExists</span><span style="color: #DD0000">"$INSTDIR\makensis.exe"</span><span style="color: #0000BB">no_remove_uninstaller
<br /><br />Delete$R1
<br />RMDir$INSTDIR
<br /><br />no_remove_uninstaller</span><span style="color: #007700">:
<br /><br /></span><span style="color: #0000BB">StrCmp$R0</span><span style="color: #DD0000">"2"</span><span style="color: #0000BB">0</span><span style="color: #007700">+</span><span style="color: #0000BB">2
<br />Quit
<br /><br />BringToFront
<br /><br />reinst_done</span><span style="color: #007700">:
<br /><br /></span><span style="color: #0000BB">FunctionEnd
<br /></span>

<!-- php buffer end -->
                
                
                
</pre>
      <hr />
      <pre>
        
When I click the "Uninstall before installing" radio button, the uninstaller wizard comes up but if I drag it, the installer wizard becomes visible and I can click it and even see how it completes installation before the poor uninstaller even has a chance to start.<br /><br />Is this a known bug in nsis?<br /><br />Tx,<br />Jen
                
</pre>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Jennifer K</span><br />
      <span class="post-time small text-muted">1st September 2008 16:35 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>I think I solved the problem?</strong><br />
      First let me correct a mistake in my listing above. Instead of<br />
      PHP Code:</p>
      <hr />
      <code style="white-space:nowrap"><!-- php buffer start --></code><span style="color: #000000"><span style="color: #0000BB">ExecWait</span><span style="color: #DD0000">'$R1_?=$INSTDIR'</span> I actually wrote<br /></span>
      <pre>
<code>ExecWait</code><span style="color: #DD0000">'$R1'
</span>
</pre>and that was the problem.<br />
      <br />
      As soon as I fixed my code to be <i>exactly</i> what was in makensis.nsi:<br />
      <pre>
<code>ExecWait</code><span style="color: #DD0000">'$R1_?=$INSTDIR'
</span>
</pre>It started behaving as I wanted: Install doesn't start running before Uninstall is complete.<br />
      <br />
      This is weird. I don't understand this _? thing: I read the entire 4.9.1.4 ExecWait documentation and didn't find any hint as to what it does.<br />
      <br />
      What does _? do?<br />
      <br />
      Tx,<br />
      Jen
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Comperio</span><br />
      <span class="post-time small text-muted">1st September 2008 21:11 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">It's all in <a href="http://nsis.sourceforge.net/Docs/Chapter3.html#3.2.2" target="_blank">help file</a>:<br /></p>

      <blockquote>
        _?= sets $INSTDIR. It also stops the uninstaller from copying itself to the temporary directory and running from there. It can be used along with ExecWait to wait for the uninstaller to finish. It must be the last parameter used in the command line and must not contain any quotes, even if the path contains spaces.
      </blockquote>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Jennifer K</span><br />
      <span class="post-time small text-muted">1st September 2008 21:39 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Thanks! I did search the NSIS User Manual but couldn't find any mention of it. Apparently the CHM search and index capabilities are not that great.<br />
      <br />
      Now, the help file says that _?= sets $INSTDIR. This is understandable in a statement like<br /></p>
      <pre>
<code>ExecWait</code><span style="color: #DD0000">'$R1_?=$INSTDIR'
</span>
</pre>But what happens if I write
      <pre>
<code>ExecWait</code><span style="color: #DD0000">'$R1_?=$MYBELOVEDVARIABLE'
</span>
</pre>Will it also set $INSTDIR or will it set $MYBELOVEDVARIABLE?<br />
      <br />
      Also, where does the weird syntax '_?=' come from?<br />
      Is it an assignment to special variable named '_?' ?<br />
      Or is it simply an atomic construct to be used as is?<br />
      <br />
      Tx,<br />
      Jen
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
      <span class="post-time small text-muted">5th September 2008 11:50 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">The second will not set $MYBELOVEDVARIABLE. Think about it, the executed installer will not even know the command line came from $MYBELOVEDVARIABLE as it will be replaced with its content.</p>
    </div>
    <hr />

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]>
  </script>
</body>
</html>
