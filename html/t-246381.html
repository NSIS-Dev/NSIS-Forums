<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="description" content="Forcing InstallLib to replace dll?"><title>Forcing InstallLib to replace dll? - NSIS Forums</title><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script><link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css"><link rel="stylesheet" href="../css/style.css" type="text/css"><!--[if lt IE 9]><script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script><script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script><![endif]--></head><body><div class="container"><ol class="breadcrumb"><li><a href="../index.html" class="glyphicon glyphicon-home"></a></li><li><a href="f-65.html">NSIS Discussion</a></li><li class="active">Forcing InstallLib to replace dll?</li></ol><p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=246381">Forcing InstallLib to replace dll?</a></p><br><div class="post"><p class="post-meta"><span class="post-author text-primary">Ian Goldby</span><br><span class="post-time small text-muted">17th May 2006 14:05 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>Forcing InstallLib to replace dll?</strong><br>Is there any way to force InstallLib to replace a DLL even if the replacement does not have a newer version number than the original? This is <i>not</i> a shared DLL, by the way.<br><br>In my case, a DLL file version may be unchanged in the new release of the software, but the product version has changed. NSIS doesn't normally try to replace a DLL if the file version is not newer than the existing one. But it doesn't take into account that the product version has increased. The result is that after installation, the old DLL with the old product version is still on the disk.<br><br>So I'd like InstallLib to replace the file if the file version is greater than <b>or equal</b> to the existing dll. Is this possible?</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Red Wine</span><br><span class="post-time small text-muted">17th May 2006 17:23 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">See in NSIS manual 4.9.3.5 GetDLLVersion with the given example.<br>Once you get the version, you can use IntCmp to compare it with a defined version and do what you wish to do, either in case when they are equal, or in cases when the installed version is less/more.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Ian Goldby</span><br><span class="post-time small text-muted">18th May 2006 09:05 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Yes, that's how InstallLib does it (except that it uses IntCmpU as the version numbers are unsigned integers).<br><br>I was hoping to use InstallLib, because it does extra things like registering DLLs, copy-on-boot, etc.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Red Wine</span><br><span class="post-time small text-muted">18th May 2006 12:34 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">According to dll's everything you can do with InstallLib you can do it also with GetDllVersion/RegDll/UnRegDll/Reboot Flag etc.<br>BTW, is it necessary to register a non shared dll?</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Ian Goldby</span><br><span class="post-time small text-muted">18th May 2006 15:02 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"></p><blockquote>According to dll's everything you can do with InstallLib you can do it also with GetDllVersion/RegDll/UnRegDll/Reboot Flag etc.</blockquote>Does File automatically replace DLLs that are in use next time you reboot?<br><br><blockquote>According to dll's everything you can do with InstallLib you can do it also with GetDllVersion/RegDll/UnRegDll/Reboot Flag etc.</blockquote>By register, I mean call the DLL's DLLRegisterServer entry point - i.e. what regsvr32 does. But I don't want to call regsvr32 if there is a built in NSIS function that does this for me - i.e. InstallLib.<br><br>I think my best course of action will be to copy the InstallLib macro and modify it for my purposes. Seems like an ugly hack of last resort though...</div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Red Wine</span><br><span class="post-time small text-muted">18th May 2006 17:26 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"></p><blockquote>I think my best course of action will be to copy the InstallLib macro and modify it for my purposes. Seems like an ugly hack of last resort though...</blockquote>If you insist in "automatically", this is probably a good try :-)<br>If you prefer to write your own customised code from scratch, then the other method would be more suitable :-)</div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Ian Goldby</span><br><span class="post-time small text-muted">19th May 2006 16:04 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Well, it turned out to be easy to modify the CmpIntU lines in Library.nsh to achieve what I wanted.<br><br>Thanks for your help.</p></div><hr><div class="footer"><p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p></div></div><script src="../js/highlight.pack.js" type="text/javascript"></script><script type="text/javascript">//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]></script></body></html>