<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="description" content="Defining order of Shortcut menu item appearence"><title>Defining order of Shortcut menu item appearence - NSIS Forums</title><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script><link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css"><link rel="stylesheet" href="../css/style.css" type="text/css"><!--[if lt IE 9]><script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script><script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script><![endif]--></head><body><div class="container"><ol class="breadcrumb"><li><a href="../index.html" class="glyphicon glyphicon-home"></a></li><li><a href="f-65.html">NSIS Discussion</a></li><li class="active">Defining order of Shortcut menu item appearence</li></ol><p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=114720">Defining order of Shortcut menu item appearence</a></p><br><div class="post"><p class="post-meta"><span class="post-author text-primary">kishore</span><br><span class="post-time small text-muted">18th November 2002 22:18 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>Defining order of Shortcut menu item appearence</strong><br>Hi,<br><br>I'm using NSIS version 1.98 on Windows 2000 to create installation program for my application. While creating shortcuts using CreateShortCut' directive in the script, I'm not able to define the order in which they appear on the Windows start menu. These short cuts appear in random order on different machine. In otherwords, following directive in .nsi file:<br><br>CreateShortCut "$SMPROGRAMS\Test\S1.lnk" "notepad s1.txt"<br>CreateShortCut "$SMPROGRAMS\Test\S2.lnk" "notepad s2.txt" CreateShortCut "$SMPROGRAMS\Test\S3.lnk" "notepad s3.txt"<br>CreateShortCut "$SMPROGRAMS\Test\S4.lnk" "notepad s4.txt"<br><br>The above directives cause the short cut menus to appear in random order as shown below. Also, this order is different on different machines.<br><br>Start -&gt; Test -&gt; S3<br>-&gt; S1<br>-&gt; S4<br>-&gt; S4<br><br>Can anyone please let me know how I could define the order in which they appear on the Windows start menu.<br><br>Thanks,<br><br>Kishore.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">n0On3</span><br><span class="post-time small text-muted">19th November 2002 02:45 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">In Win98SE there's a registry branch (HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Explorer\MenuOrder\Start Menu) where windows stores items' positions. You can define as you like, export the branch you want, and then import that branch during installation with thi line: ExecWait "REGEDIT.EXE /S 1.REG"</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">kishore</span><br><span class="post-time small text-muted">19th November 2002 14:53 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"></p><blockquote><i>Originally posted by n0On3</i><br><b>In Win98SE there's a registry branch (HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Explorer\MenuOrder\Start Menu) where windows stores items' positions. You can define as you like, export the branch you want, and then import that branch during installation with thi line: ExecWait "REGEDIT.EXE /S 1.REG"</b></blockquote>Thanks a lot for the reply. Since, I'm new to both windows and NSIS, It will be very helpful if you can give me the detailed steps for the example I had initially posted with the question.<br><br>Thanks,<br><br>Kishore.</div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">kishore</span><br><span class="post-time small text-muted">19th November 2002 15:54 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"></p><blockquote><i>Originally posted by n0On3</i><br><b>In Win98SE there's a registry branch (HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Explorer\MenuOrder\Start Menu) where windows stores items' positions. You can define as you like, export the branch you want, and then import that branch during installation with thi line: ExecWait "REGEDIT.EXE /S 1.REG"</b></blockquote>Hello n0On3,<br><br>Following is the snippet of the nsi script used in my installation.<br><br>;Script Begin<br><br>CreateShortCut "$SMPROGRAMS\Test\S1.lnk" "notepad s1.txt"<br>CreateShortCut "$SMPROGRAMS\Test\S2.lnk" "notepad s2.txt" CreateShortCut "$SMPROGRAMS\Test\S3.lnk" "notepad s3.txt"<br>CreateShortCut "$SMPROGRAMS\Test\S4.lnk" "notepad s4.txt"<br>ExecWait 'RegEdit /s /e "$INSTDIR\1.reg" "HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Explorer\MenuOrder\Start Menu"'<br><br>ExecWait 'RegEdit /s "$INSTDIR\1.reg"'<br><br>;Script End<br><br>But, the order still seems to be random. Is this what I'm supposed to do ? Please let me know.<br><br>Thanks,<br><br>Kishore.</div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">virtlink</span><br><span class="post-time small text-muted">19th November 2002 18:13 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">You can't set the order of the items in the Start-Menu. However, if you have Windows ME or higher, you can, as a user, sort the items by name.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">n0On3</span><br><span class="post-time small text-muted">19th November 2002 19:32 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">virtlink, well you can't set the order, but you can import the branch where windows saves the order, methinks.<br><br><br>I don't know why you use the "/e" switch.<br><br>before using this: ExecWait 'RegEdit /s "$INSTDIR\1.reg"'<br><br>you have to create '1.reg' with the information you want. To do it, create the start menu group the way you want it to be installed, and launch regedit go to that branch I gave you look for your start groug and export the branch of that group to that 1.reg file.<br><br>If you have any trouble you can post your working script to check it with my computer.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">dëëjayz</span><br><span class="post-time small text-muted">11th September 2003 22:08 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">This solution is working on windows 2000, but doesn't seem to work on XP... Any clue to do the same on XP? haven't test on Win Nt4, but will do the test soon.<br><br>Thank you.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">n0On3</span><br><span class="post-time small text-muted">12th September 2003 10:45 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">You can use Registry Shot to find what really changes in the registry when changing the order of items.<br><br>You'll have to do it by yourself, because I don't have a wxp around.<br><br>good luck :)</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">dëëjayz</span><br><span class="post-time small text-muted">12th September 2003 16:05 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Thanks!<br><br>BTW&lt; the file you sent was not working.. old version I guess!<br><br>Here a more recent file of regshot.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">virtlink</span><br><span class="post-time small text-muted">12th September 2003 16:09 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Yeah, the n0On's version didn't accept Windows XP as a valid OS, since it doesn't support NT systems, and recognizes XP as one.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">dëëjayz</span><br><span class="post-time small text-muted">12th September 2003 20:52 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Okay, I've done a switch between XP, 2000 and NT 4.0 for the ordering items... Something like this:<br><br>Call GetWindowsVersion<br>Pop $R0<br>StrCmp $R0 "2000" 0 +2<br>ExecWait 'RegEdit /s "$PLUGINSDIR\2000 Client.reg"'<br>StrCmp $R0 "XP" 0 +2<br>ExecWait 'RegEdit /s "$PLUGINSDIR\XP Client.reg"'<br>StrCmp $R0 "NT 4.0" 0 +2<br>ExecWait 'RegEdit /s "$PLUGINSDIR\NT 4.0 Client.reg"'<br><br>Does work fine, but for the current user... If I logoff and logon another user, doesn't get the menu items ordered correctly... I've tried to edit the reg file by changing the HKCU for HKLM, but none of these windows version will work... Only work in current user who've done the installation.<br><br>Is there any way to make it applied to another user?</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">n0On3</span><br><span class="post-time small text-muted">12th September 2003 23:51 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">hehe, it seems I have to update my computer, the OS, and regshot too. :rolleyes:</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">dëëjayz</span><br><span class="post-time small text-muted">15th September 2003 14:36 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Isn't a good opportunity? ;) eheheh</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Andrikos</span><br><span class="post-time small text-muted">18th June 2004 13:11 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">This is my solution for right sort order:<br><br>CreateShortCut "$SMPROGRAMS\...<br>Sleep 10<br>CreateShortCut "$SMPROGRAMS\...<br>Sleep 10<br>CreateShortCut "$SMPROGRAMS\...</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">zimsms</span><br><span class="post-time small text-muted">18th June 2004 13:25 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Try:<br><br>4.9.7.3 SetShellVarContext current|all<br><br>before your createshortcut calls for setting the appropriate location.</p></div><hr><div class="footer"><p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p></div></div><script src="../js/highlight.pack.js" type="text/javascript"></script><script type="text/javascript">//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]></script></body></html>