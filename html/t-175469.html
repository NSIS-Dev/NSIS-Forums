<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="description" content="Selective Uninstalling"><title>Selective Uninstalling - NSIS Forums</title><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script><link rel="preload" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css" as="style" onload="this.rel='stylesheet'"><link rel="preload" href="../css/style.css" as="style" onload="this.rel='stylesheet'"><noscript><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css"><link rel="stylesheet" href="../css/style.css"></noscript><script>!function(a){"use strict";var b=function(b,c,d){function e(a){return h.body?a():void setTimeout(function(){e(a)})}function f(){i.addEventListener&&i.removeEventListener("load",f),i.media=d||"all"}var g,h=a.document,i=h.createElement("link");if(c)g=c;else{var j=(h.body||h.getElementsByTagName("head")[0]).childNodes;g=j[j.length-1]}var k=h.styleSheets;i.rel="stylesheet",i.href=b,i.media="only x",e(function(){g.parentNode.insertBefore(i,c?g:g.nextSibling)});var l=function(a){for(var b=i.href,c=k.length;c--;)if(k[c].href===b)return a();setTimeout(function(){l(a)})};return i.addEventListener&&i.addEventListener("load",f),i.onloadcssdefined=l,l(f),i};"undefined"!=typeof exports?exports.loadCSS=b:a.loadCSS=b}("undefined"!=typeof global?global:this);!function(a){if(a.loadCSS){var b=loadCSS.relpreload={};if(b.support=function(){try{return a.document.createElement("link").relList.supports("preload")}catch(b){return!1}},b.poly=function(){for(var b=a.document.getElementsByTagName("link"),c=0;c<b.length;c++){var d=b[c];"preload"===d.rel&&"style"===d.getAttribute("as")&&(a.loadCSS(d.href,d,d.getAttribute("media")),d.rel=null)}},!b.support()){b.poly();var c=a.setInterval(b.poly,300);a.addEventListener&&a.addEventListener("load",function(){b.poly(),a.clearInterval(c)}),a.attachEvent&&a.attachEvent("onload",function(){a.clearInterval(c)})}}}(this);</script></head><body><div class="container"><ol class="breadcrumb"><li><a href="../index.html" class="glyphicon glyphicon-home"></a></li><li><a href="f-65.html">NSIS Discussion</a></li><li class="active">Selective Uninstalling</li></ol><p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=175469">Selective Uninstalling</a></p><br><div class="post"><p class="post-meta"><span class="post-author text-primary">Zettai</span><br><span class="post-time small text-muted">5th April 2004 22:29 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>Selective Uninstalling</strong><br>I'm not quite sure how to impliment this, so here I am asking :)<br><br><br>I currently have a meta-installer that, when they are selected as components for installation, runs individual installers for each component.<br><br>Now, when it comes to uninstalling, I'd like to be able to have the user:<br><br>1) Be able to select which components to uninstall and have the uninstaller find the location for each component's uninstaller by looking in the registry and run each uninstaller exe for each component.<br><br>2) Have the uninstaller not be deleted unless all elements are selected for uninstallation. Either that or ask a question at the beginning of the uninstaller asking if the user wants to remove all or just some of the components.<br><br>I've found things like MUI_UNPAGE_COMPONENTS but I can't make out how it actually works nor if I can do what I want to do.<br><br>Any help you be greatly appreciated.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Joost Verburg</span><br><span class="post-time small text-muted">5th April 2004 22:56 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">You can use sections for the uninstaller just like the uninstaller. Use the un. prefix for the section name.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Zettai</span><br><span class="post-time small text-muted">8th April 2004 11:52 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">OK, good. I've got sections working in the uninstaller.<br><br>I do have one last problem though - is there any way of only having the sections that were installed to be shown in the uninstaller?<br><br>I can check reg entries to see if a section was installed, but I've no idea how to choose which sections will appear on my components list :(</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Yathosho</span><br><span class="post-time small text-muted">8th April 2004 11:58 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">example from one of my scripts<br><br></p><pre>
<code>!include "Sections.nsh"<br><br>Function .onInit<br>  ReadRegStr $NSIS HKLM "Software\NSIS" ""<br>  IfFileExists "$NSIS\NSIS.chm" +1 PostNSIS2<br>  !insertmacro UnSelectSection "${NSIS2}"<br>  PostNSIS2:<br>FunctionEnd</code>
</pre><br>
      <br>
      whereas NSIS2 is my section
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Zettai</span><br>
      <span class="post-time small text-muted">8th April 2004 14:07 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">That looks great but I can't get it to work for unselecting more than one section in a row without strange results :(</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">o_owd</span><br>
      <span class="post-time small text-muted">8th April 2004 14:54 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">have a look at this.<br>
      <br>
      i am not using separate installers, but this works. it's not the best solution but for me it's working. this is MY solution. maybe it's a little outdated...</p>
    </div>
    <hr>

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script type="text/javascript" src="../js/highlight.pack.js" async>
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]></script></body></html>