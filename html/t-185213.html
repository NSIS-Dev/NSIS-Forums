<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="Checking dialog checkboxes" />

  <title>Checking dialog checkboxes - NSIS Forums</title><!-- Bootstrap core CSS -->
  <link rel="stylesheet" type="text/css" href="//netdna.bootstrapcdn.com/bootswatch/3.0.1/readable/bootstrap.min.css" />
  <link rel="stylesheet" href="../css/style.css" type="text/css" /><!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!--[if lt IE 9]>
                <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
                <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->
</head>

<body>
  <div class="container">
    <!-- Put navigation bar here -->

    <ol class="breadcrumb">
      <li><a href="../index.html" class="glyphicon glyphicon-home"></a></li>

      <li><a href="f-65.html">NSIS Discussion</a></li>

      <li class="active">Checking dialog checkboxes</li>
    </ol>

    <p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=185213">Checking dialog checkboxes</a></p><br />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
      <span class="post-time small text-muted">1st July 2004 13:52 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>Checking dialog checkboxes</strong><br />
      This is a checkbox control on an exe dialog (not InstallOptions)<br />
      <br />
      Is there a WindowsMessage to do this, because I'd rather not have to use the System plugin with BM_SETCHECK (<a href="http://www.minigui.com/api_ref/group__ctrl__button__msgs.html#a1" target="_blank">http://www.minigui.com/api_ref/group...__msgs.html#a1</a>)<br />
      <br />
      Cheers<br />
      <br />
      -Stu</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">deguix</span><br />
      <span class="post-time small text-muted">1st July 2004 19:18 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Did you forget SendMessage NSIS command? It does exactly the same thing as using SendMessage from System plugin (except it can't get parameters from "wparam" and "lparam", it just set).</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">rsegal</span><br />
      <span class="post-time small text-muted">1st July 2004 20:43 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Yeh SendMessage will do it. I'ved used it for working with checkboxes as follows...<br />
      <br /></p>
      <pre>
<code>SendMessage$R1</code><span style="color: #007700">${</span><span style="color: #0000BB">BM_SETCHECK</span><span style="color: #007700">}</span><span style="color: #0000BB">10
<br /></span>

<!-- php buffer end -->
                
                
                
</pre>
      <hr />
      <pre>
        
To set the checkbox state.  I believe changing the 1 to 0 will turn the checkbox off.<br /><br />
        
</pre>
      <pre>
<code>SendMessage$R1</code><span style="color: #007700">${</span><span style="color: #0000BB">BM_GETSTATE</span><span style="color: #007700">}</span><span style="color: #0000BB">00$R2
<br /></span>
</pre>
      <pre>

        
To get the checkbox state and $R2 will contain either 1 or 0 depending on if the checkbox is checked or not.
                
</pre>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
      <span class="post-time small text-muted">1st July 2004 22:03 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Yes, but wheres the BM_SETCHECK define? It's not in WinMessages.nsh (not the one that I have anyhow)<br />
      <br />
      -Stu</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">rsegal</span><br />
      <span class="post-time small text-muted">1st July 2004 22:18 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">No it isn't you have to add it. It's in some windows header file if you really want to look it up. Just type in BM_SETCHECK in any source file in visual studio and select "go to definition". That'll give you the value or just copy the following...<br />
      <br />
      !define BM_GETSTATE 0x00F2<br />
      !define BM_SETCHECK 0x00F1</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
      <span class="post-time small text-muted">1st July 2004 22:23 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">That's what I've been trying to find (must reinstall VB!)<br />
      <br />
      Thanks<br />
      <br />
      -Stu</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">bluenet</span><br />
      <span class="post-time small text-muted">3rd July 2004 02:00 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Thanks rsegal.Now I have another question: how can I send message to change a droplist box state?A sample ini file like this<br /></p>
      <pre>
<span style="color: #007700">***91;</span><span style="color: #0000BB">Settings</span><span style="color: #007700">***93;
<br /></span><span style="color: #0000BB">NumFields</span><span style="color: #007700">=</span><span style="color: #0000BB">1
<br /><br /></span><span style="color: #007700">***91;</span><span style="color: #0000BB">Field1</span><span style="color: #007700">***93;
<br /></span><span style="color: #0000BB">Type</span><span style="color: #007700">=</span><span style="color: #0000BB">Droplist
<br />Text</span><span style="color: #007700">=</span><span style="color: #0000BB">Droplist
<br />State</span><span style="color: #007700">=</span><span style="color: #0000BB">1
<br />ListItems</span><span style="color: #007700">=</span><span style="color: #0000BB">1</span><span style="color: #007700">|</span><span style="color: #0000BB">2</span><span style="color: #007700">|</span><span style="color: #0000BB">3
<br />Left</span><span style="color: #007700">=</span><span style="color: #0000BB">77
<br />Right</span><span style="color: #007700">=</span><span style="color: #0000BB">174
<br />Top</span><span style="color: #007700">=</span><span style="color: #0000BB">27
<br />Bottom</span><span style="color: #007700">=</span><span style="color: #0000BB">119
<br /></span>
</pre>Default state is "1",I want to send a message cause it change to "2".
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">deguix</span><br />
      <span class="post-time small text-muted">3rd July 2004 06:40 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"></p>
      <pre>
<span style="color: #007700">!</span><span style="color: #0000BB">defineCB_FINDSTRINGEXACT0x0158
<br /></span><span style="color: #007700">!</span><span style="color: #0000BB">defineCB_SETCURSEL0x014E
<br /><br />SendMessage$hCtrl</span><span style="color: #007700">${</span><span style="color: #0000BB">CB_FINDSTRINGEXACT</span><span style="color: #007700">}-</span><span style="color: #0000BB">1</span><span style="color: #DD0000">"Stringtobeselected"</span><span style="color: #007700">$</span><span style="color: #0000BB">0
<br />SendMessage$hCtrl</span><span style="color: #007700">${</span><span style="color: #0000BB">CB_SETCURSEL</span><span style="color: #007700">}$</span><span style="color: #0000BB">0</span><span style="color: #DD0000">""
</span>
</pre>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">bluenet</span><br />
      <span class="post-time small text-muted">3rd July 2004 11:49 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">I test deguix's code,but not work.These is my code<br />
      PHP Code:</p>
      <hr />
      <code style="white-space:nowrap"><!-- php buffer start --></code><span style="color: #000000"><span style="color: #0000BB">Name</span><span style="color: #DD0000">"Test"<br /></span> <span style="color: #0000BB">OutFile</span><span style="color: #DD0000">".\test.exe"<br /></span> <span style="color: #0000BB">Caption</span><span style="color: #DD0000">"Test"<br /></span> <span style="color: #0000BB">SetCompressorlzma<br />
      ShowInstDetailsshow<br /></span> <span style="color: #007700">!include</span><span style="color: #0000BB">MUI</span><span style="color: #007700">.</span><span style="color: #0000BB">nsh<br />
      <br />
      PagecustomSetCustomLeaveCustom<br />
      <br /></span> <span style="color: #007700">!</span><span style="color: #0000BB">insertmacroMUI_PAGE_INSTFILES<br /></span> <span style="color: #007700">!</span><span style="color: #0000BB">insertmacroMUI_LANGUAGEEnglish<br />
      <br />
      Section<br />
      SectionEnd<br />
      <br /></span> <span style="color: #007700">Function</span><span style="color: #0000BB">SetCustom<br />
      InstallOptions</span><span style="color: #007700">::</span><span style="color: #0000BB">initDialog</span><span style="color: #007700">/</span><span style="color: #0000BB">NOUNLOAD</span><span style="color: #DD0000">"$PLUGINSDIR\test2.ini"<br /></span> <span style="color: #0000BB">Pop</span><span style="color: #007700">$</span><span style="color: #0000BB">9<br />
      InstallOptions</span><span style="color: #007700">::</span><span style="color: #0000BB">show<br />
      FunctionEnd<br />
      <br /></span> <span style="color: #007700">;--------------------------------------<br />
      !</span><span style="color: #0000BB">defineCB_FINDSTRINGEXACT0x0158<br /></span> <span style="color: #007700">!</span><span style="color: #0000BB">defineCB_SETCURSEL0x014E<br />
      <br /></span> <span style="color: #007700">Function</span><span style="color: #0000BB">LeaveCustom<br />
      ReadINIStr$R0</span><span style="color: #DD0000">"$PLUGINSDIR\test2.ini"</span><span style="color: #0000BB">SettingsState<br />
      StrCmp$R00validate<br />
      StrCmp$R02droplist<br />
      Abort<br />
      <br />
      droplist</span><span style="color: #007700">:<br /></span> <span style="color: #0000BB">ReadINIStr</span><span style="color: #007700">$</span><span style="color: #0000BB">1</span><span style="color: #DD0000">"$PLUGINSDIR\test2.ini""Field2"</span><span style="color: #0000BB">State<br />
      GetDlgItem$R1</span><span style="color: #007700">$</span><span style="color: #0000BB">91200<br />
      SendMessage$R1</span><span style="color: #007700">${</span><span style="color: #0000BB">CB_FINDSTRINGEXACT</span><span style="color: #007700">}-</span><span style="color: #0000BB">1</span><span style="color: #007700">$</span><span style="color: #0000BB">1</span><span style="color: #007700">$</span><span style="color: #0000BB">0<br />
      SendMessage$R1</span><span style="color: #007700">${</span><span style="color: #0000BB">CB_SETCURSEL</span><span style="color: #007700">}$</span><span style="color: #0000BB">0</span><span style="color: #DD0000">""<br /></span> <span style="color: #007700">;</span><span style="color: #0000BB">EnableWindow$R10<br />
      Abort<br />
      <br />
      validate</span><span style="color: #007700">:<br /></span> <span style="color: #0000BB">FunctionEnd<br />
      <br /></span> <span style="color: #007700">Function.</span><span style="color: #0000BB">onInit<br />
      InitPluginsDir<br />
      File</span><span style="color: #DD0000">"/oname=$PLUGINSDIR\test2.ini"".\test2.ini"<br /></span> <span style="color: #0000BB">FunctionEnd<br /></span> And these is my ini file<br /></span>
      <pre>
<span style="color: #007700">;</span><span style="color: #0000BB">InifilegeneratedbytheHMNISEditIOdesigner</span><span style="color: #007700">.
<br />***91;</span><span style="color: #0000BB">Settings</span><span style="color: #007700">***93;
<br /></span><span style="color: #0000BB">NumFields</span><span style="color: #007700">=</span><span style="color: #0000BB">2
<br /><br /></span><span style="color: #007700">***91;</span><span style="color: #0000BB">Field1</span><span style="color: #007700">***93;
<br /></span><span style="color: #0000BB">Type</span><span style="color: #007700">=</span><span style="color: #0000BB">Droplist
<br />Text</span><span style="color: #007700">=</span><span style="color: #0000BB">Droplist
<br />State</span><span style="color: #007700">=</span><span style="color: #0000BB">1
<br />ListItems</span><span style="color: #007700">=</span><span style="color: #0000BB">1</span><span style="color: #007700">|</span><span style="color: #0000BB">2</span><span style="color: #007700">|</span><span style="color: #0000BB">3
<br />Left</span><span style="color: #007700">=</span><span style="color: #0000BB">61
<br />Right</span><span style="color: #007700">=</span><span style="color: #0000BB">218
<br />Top</span><span style="color: #007700">=</span><span style="color: #0000BB">6
<br />Bottom</span><span style="color: #007700">=</span><span style="color: #0000BB">100
<br /><br /></span><span style="color: #007700">***91;</span><span style="color: #0000BB">Field2</span><span style="color: #007700">***93;
<br /></span><span style="color: #0000BB">Type</span><span style="color: #007700">=</span><span style="color: #0000BB">Droplist
<br />Text</span><span style="color: #007700">=</span><span style="color: #0000BB">Droplist
<br />Flags</span><span style="color: #007700">=</span><span style="color: #0000BB">NOTIFY
<br />State</span><span style="color: #007700">=</span><span style="color: #0000BB">1
<br />ListItems</span><span style="color: #007700">=</span><span style="color: #0000BB">1</span><span style="color: #007700">|</span><span style="color: #0000BB">2</span><span style="color: #007700">|</span><span style="color: #0000BB">3
<br />Left</span><span style="color: #007700">=</span><span style="color: #0000BB">62
<br />Right</span><span style="color: #007700">=</span><span style="color: #0000BB">220
<br />Top</span><span style="color: #007700">=</span><span style="color: #0000BB">60
<br />Bottom</span><span style="color: #007700">=</span><span style="color: #0000BB">151
<br /></span>
</pre>I want droplist 2 control droplist 1.What wrong for me?
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">deguix</span><br />
      <span class="post-time small text-muted">3rd July 2004 19:32 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">I thought it would not work because of that <i>-1</i> I put for <i>${CB_FINDSTRINGEXACT}</i>. MSDN says that if <i>wparam</i> is <i>-1</i> it would search the whole list, but that doesn't happen. Put <i>0</i> on its place.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">bluenet</span><br />
      <span class="post-time small text-muted">3rd July 2004 23:54 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">I replaceed -1 with 0,but still not work.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">deguix</span><br />
      <span class="post-time small text-muted">4th July 2004 07:31 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Hmmm... Aparently there is a problem with <i>SendMessage</i> from NSIS. Everytime I change the number in <i>wparam</i> and/or <i>lparam</i> it should return the correct index of the item (it now returns 0). This is the correct (tested this time):<br />
      <br /></p>
      <pre>
<code>!define CB_FINDSTRINGEXACT          0x0158 <br />!define CB_SETCURSEL                0x014E <br /><br />  System::Call 'user32::SendMessageA(i R1, i ${CB_FINDSTRINGEXACT}, i -1, t r1)i .r0'<br />  System::Call 'user32::SendMessageA(i R1, i ${CB_SETCURSEL}, i r0,)'</code>
</pre>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">bluenet</span><br />
      <span class="post-time small text-muted">4th July 2004 10:18 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">I got a idear to do it<br />
      <br /></p>
      <pre>
<span style="color: #007700">!</span><span style="color: #0000BB">defineCB_GETCURSEL0x0147
<br /></span><span style="color: #007700">!</span><span style="color: #0000BB">defineCB_SETCURSEL0x014E
<br />GetDlgItem$R1$HWND1201
<br />SendMessage$R1</span><span style="color: #007700">${</span><span style="color: #0000BB">CB_GETCURSEL</span><span style="color: #007700">}-</span><span style="color: #0000BB">10$R2
<br />GetDlgItem$R1$HWND1200
<br />SendMessage$R1</span><span style="color: #007700">${</span><span style="color: #0000BB">CB_SETCURSEL</span><span style="color: #007700">}</span><span style="color: #0000BB">$R20
<br /></span>
</pre>
    </div>
    <hr />

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]>
  </script>
</body>
</html>
