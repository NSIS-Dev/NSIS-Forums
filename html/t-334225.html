<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="$DOCUMENTS not pointing to the correct folder in Windows 7" />

  <title>$DOCUMENTS not pointing to the correct folder in Windows 7 - NSIS Forums</title><!-- Bootstrap core CSS -->
  <link rel="stylesheet" type="text/css" href="//netdna.bootstrapcdn.com/bootswatch/3.0.1/readable/bootstrap.min.css" />
  <link rel="stylesheet" href="../css/style.css" type="text/css" /><!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!--[if lt IE 9]>
                <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
                <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->
</head>

<body>
  <div class="container">
    <!-- Put navigation bar here -->

    <ol class="breadcrumb">
      <li><a href="../index.html" class="glyphicon glyphicon-home"></a></li>

      <li><a href="f-65.html">NSIS Discussion</a></li>

      <li class="active">$DOCUMENTS not pointing to the correct folder in Windows 7</li>
    </ol>

    <p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=334225">$DOCUMENTS not pointing to the correct folder in Windows 7</a></p><br />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">alex001</span><br />
      <span class="post-time small text-muted">30th August 2011 17:07 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>$DOCUMENTS not pointing to the correct folder in Windows 7</strong><br />
      Hello,<br />
      i try to install some file to a standard's user My Documents folder in Windows 7.<br />
      <br />
      The problem is that the files are installed in the My Documents folder of the administrator instead !!<br />
      <br />
      Is not the constant $DOCUMENTS working in Windows 7 correctly ?<br />
      <br />
      Thank you<br />
      Alex</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">MSG</span><br />
      <span class="post-time small text-muted">30th August 2011 17:43 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">requestexecutionlevel user<br />
      <br />
      <br />
      (Reason: Win7 auto-elevates NSIS installers if they don't have a manifest.)</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">alex001</span><br />
      <span class="post-time small text-muted">30th August 2011 19:00 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">ok thanks for the quick answer</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">alex001</span><br />
      <span class="post-time small text-muted">31st August 2011 09:14 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Hello,<br />
      that is not a solution. Now i cannot install any application to Program Files etc.<br />
      <br />
      Admin level is required.<br />
      <br />
      Isn't there another workaround ?</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">MSG</span><br />
      <span class="post-time small text-muted">31st August 2011 11:09 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">If your installer is running at admin level (which is necessary if you want to install to $PROGRAMFILES), you have no business writing to a user's documents folder. An installer that requires admin access should always install for all users (this is simply how Windows is designed). Therefore you should be using the allusers Documents folder (simply use setshellvarcontext all for this).<br />
      <br />
      Conversely, if you want to do stuff at userlevel (such as writing to one user's documents), the whole install should be executed at userlevel. This means you should install to $APPDATA or $LOCALAPPDATA instead of $PROGRAMFILES, and write to HKCU instead of HKLM.<br />
      <br />
      <br />
      <br />
      Edit: And note that for proper Win7 compatibility, you should add requestexecutionlevel (admin or user) to your installer in any case.</p>
    </div>
    <hr />

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]>
  </script>
</body>
</html>
