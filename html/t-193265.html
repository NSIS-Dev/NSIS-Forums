<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="ExtractDLLEx Plugin" />

  <title>ExtractDLLEx Plugin - NSIS Forums</title>
  <script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script>
  <!-- Bootstrap core CSS -->

  <link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css" />
  <link rel="stylesheet" href="../css/style.css" type="text/css" /><!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!--[if lt IE 9]>
                <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
                <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->
</head>

<body>
  <div class="container">
    <!-- Put navigation bar here -->

    <ol class="breadcrumb">
      <li><a href="../index.html" class="glyphicon glyphicon-home"></a></li>

      <li><a href="f-65.html">NSIS Discussion</a></li>

      <li class="active">ExtractDLLEx Plugin</li>
    </ol>

    <p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=193265">ExtractDLLEx Plugin</a></p><br />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">mumpitzstuff</span><br />
      <span class="post-time small text-muted">12th September 2004 00:42 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>ExtractDLLEx Plugin</strong><br />
      Hello,<br />
      <br />
      i enhanced the original ExtractDLL Plugin from Tim Kosse with the following features:<br />
      <br />
      - added LZMA compression<br />
      - added file container support to add more than one file to the compressed file (like zip)<br />
      - added wildcard support (* and ?)<br />
      - added relative path support<br />
      <br />
      Have fun with the plugin...<br />
      <br />
      Achim Winkler<br />
      <br />
      <a href="http://www.lkcc.org/achim" target="_blank">Homepage</a><br />
      <a href="http://www.lkcc.org/achim/download/extractdllex.zip" target="_blank">Download</a></p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
      <span class="post-time small text-muted">12th September 2004 13:34 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Could you create an NSIS Archive page for this?<br />
      <br />
      <a href="http://nsis.sourceforge.net/archive/nsisweb.php" target="_blank">http://nsis.sourceforge.net/archive/nsisweb.php</a><br />
      <br />
      -Stu</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">ImmortAlex</span><br />
      <span class="post-time small text-muted">13th September 2004 04:50 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Plugin depends on msvcr71.dll. My W2K Prof SP4 doesn't contains this dll. (Yes, I found it in some other program, but anyway...)</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">dujuan</span><br />
      <span class="post-time small text-muted">13th September 2004 04:52 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">hello, I am a beginner,<br />
      Can somebody tell me how to ues ExtractDLLEx.dll ?<br />
      <br />
      I have read readme.txt, but I still don't know the meaning of "Call the function "extract" with CallInstDLL"</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">ImmortAlex</span><br />
      <span class="post-time small text-muted">13th September 2004 05:10 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">1. Copy extractdllex.dll into NSIS\Plugins directory.<br />
      2. In your script write:<br /></p>
      <pre>
<code><br />Push "name_of_compressed_file"<br />Push "name_of_file_to_extract"<br />extractdllex::extract<br />Pop $0<br /></code>
</pre><br />
      After that you'll have result code ("success" or error text) in $0.<br />
      <br />
      ... And I found that plugin doesn't support masks in name of file to extract :(
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">mumpitzstuff</span><br />
      <span class="post-time small text-muted">13th September 2004 08:12 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"></p>

      <blockquote>
        And I found that plugin doesn't support masks in name of file to extract :(
      </blockquote>This feature is only needed for the compression of files! How should the plugin extract files with masks??? Thats impossible.<br />
      <br />
      Achim
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">ImmortAlex</span><br />
      <span class="post-time small text-muted">13th September 2004 08:44 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">I want to use some archiver for backup when install over pervious installation and restore when uninstall.<br />
      When I install I can use CompressFile.exe to create backup file, contains all installation directory, but when I uninstall I can't use extractdllex for restore previous state because I can't extract *.*<br />
      That's all. I think I will use full version of 7-zip, or something else GPL-ed.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">mumpitzstuff</span><br />
      <span class="post-time small text-muted">13th September 2004 08:56 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"></p>

      <blockquote>
        <b>Plugin depends on msvcr71.dll. My W2K Prof SP4 doesn't contains this dll. (Yes, I found it in some other program, but anyway...)</b>
      </blockquote>you are right. i will fix that next days and will release a new version. thx for the tip!<br />
      <br />
      achim
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">mumpitzstuff</span><br />
      <span class="post-time small text-muted">13th September 2004 09:03 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"></p>

      <blockquote>
        When I install I can use CompressFile.exe to create backup file, contains all installation directory, but when I uninstall I can't use extractdllex for restore previous state because I can't extract *.*.
      </blockquote>thats not correct. if you create a backup with compressfile.exe (this needs lzma.exe!) with the following command:<br />
      <br />
      compressfile test.7z test.* /test/test.*<br />
      <br />
      and you have a directory structure like:<br />
      <br />
      test.exe<br />
      test.ext<br />
      test.dat<br />
      /test/test.exe<br />
      /test/text.ext<br />
      /test/test.dat<br />
      <br />
      all 6 files gets compressed into test.7z! now copy the test.7z to the directory where you want to extract the files and call the extract function to get your 6 files including the directory structure back!<br />
      <br />
      achim
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">ImmortAlex</span><br />
      <span class="post-time small text-muted">13th September 2004 09:21 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">What should I push as name of file to extract? "*.*" or something else?</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">mumpitzstuff</span><br />
      <span class="post-time small text-muted">13th September 2004 09:23 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>DLL based on msvcrt.dll</strong><br />
      Hello,<br />
      <br />
      try this files if you do not have msvcr71.dll installed (like on most systems...)<br />
      <br />
      Achim</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">dujuan</span><br />
      <span class="post-time small text-muted">13th September 2004 14:40 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"></p>

      <blockquote>
        <i>Originally posted by mumpitzstuff</i><br />
        <b>thats not correct. if you create a backup with compressfile.exe (this needs lzma.exe!) with the following command:<br />
        <br />
        compressfile test.7z test.* /test/test.*<br />
        <br />
        and you have a directory structure like:<br />
        <br />
        test.exe<br />
        test.ext<br />
        test.dat<br />
        /test/test.exe<br />
        /test/text.ext<br />
        /test/test.dat<br />
        <br />
        all 6 files gets compressed into test.7z! now copy the test.7z to the directory where you want to extract the files and call the extract function to get your 6 files including the directory structure back!<br />
        <br />
        achim</b>
      </blockquote>After I get test.7z , I write my script:<br />
      <br />
      ExtractDLLEx::extract "e:\web\*.*" "e:\test.7z"<br />
      <br />
      But there is something wrong, there is no file at the folder "e:\web" at the result.
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">mumpitzstuff</span><br />
      <span class="post-time small text-muted">13th September 2004 15:09 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">hi,<br />
      <br />
      okay my explanation was wrong.<br />
      <br />
      the follwoing:<br />
      <br />
      ExtractDLLEx::extract "e:\web\*.*" "e:\test.7z"<br />
      <br />
      should be:<br />
      <br />
      Push "test.7z"<br />
      Push "update.tmp"<br />
      <br />
      ExtractDll::extract<br />
      <br />
      update.tmp is only the temporary filename for the decompression. after decompression the temp file gets splitted to the original files!<br />
      <br />
      achim</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">dujuan</span><br />
      <span class="post-time small text-muted">13th September 2004 16:46 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">I am so foolish that I don't know how to decompression the temp file(update.tmp). Can you tell me ?<br />
      <br />
      Please don't kick me...</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">mumpitzstuff</span><br />
      <span class="post-time small text-muted">13th September 2004 18:03 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">okay you have the compressed test.7z file created with compressfile.exe. now write a little script where you call exactly this:<br />
      <br />
      Push "test.7z"<br />
      Push "update.tmp"<br />
      <br />
      ExtractDLLEx::extract<br />
      <br />
      now create a exe file (let me call it update.exe) from your script and put the update.exe and test.7z into the same directory. you should create a new directory to see that something changed. execute the update.exe file and the file or files you compressed before should be uncompressed to this directory.<br />
      i do not know how i can make it more clear...<br />
      <br />
      to get the result of the unpacking process you can enhance the script:<br />
      <br />
      Push "test.7z"<br />
      Push "update.tmp"<br />
      <br />
      ExtractDll::extract<br />
      <br />
      ;get the result<br />
      Pop $0<br />
      StrCmp $0 success SUCCESS<br />
      MessageBox MB_OK|MB_ICONSTOP "$0"<br />
      <br />
      SUCCESS:<br />
      <br />
      <br />
      i hope this helps.<br />
      <br />
      achim</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">dujuan</span><br />
      <span class="post-time small text-muted">14th September 2004 01:47 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Thank you very much!<br />
      <br />
      I think my explanation was wrong.<br />
      <br />
      my step:<br />
      1.Create update.exe<br />
      2.Put update.exe and test.7z in the same directory<br />
      3.Execute update.exe, and get update.tmp<br />
      <br />
      I think update.tmp is a file container. How can I get the 6 original file in the update.tmp ?</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">mumpitzstuff</span><br />
      <span class="post-time small text-muted">14th September 2004 06:15 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">you get the files like i described it before with the extract command!!!!!!!! the extract command unpack the filecontainer to update.tmp and split the filecontainer to the original files!!!! it is not needed to do more.<br />
      <br />
      achim</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">mumpitzstuff</span><br />
      <span class="post-time small text-muted">14th September 2004 07:28 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">the following is the pack/unpack sequence:<br /></p>
      <pre>
<code><br />; batch file to compress files<br />CompressFile.exe test.7z test.* test/test.txt<br /><br /><br />       test.exe      test.dat    test/test.txt<br />               \        |        /<br />                \       |       /<br />                 \      |      /<br />                  \     |     /<br />CompressFile.exe   \    |    /<br />                    pack.tmp (hardcoded in CompressFile)<br />                        |<br />                        |<br />                     test.7z<br />--------------------------------------------------------<br />                     test.7z   <br />                        |<br />                        |<br />                    update.tmp (temporary file!)<br />ExtractDLLEx.dll    /   |   \<br />                   /    |    \<br />                  /     |     \<br />                 /      |      \<br />                /       |       \<br />        test.exe     test.dat    test/test.txt<br />        <br /><br />; nsis script to unpack files<br />Push "test.7z"<br />Push "update.tmp"<br />  <br />ExtractDllEx::extract<br />  <br />;get the result<br />Pop $0<br />StrCmp $0 success SUCCESS<br />  MessageBox MB_OK|MB_ICONSTOP "$0"<br />  <br />SUCCESS:<br /></code>
</pre><br />
      <br />
      thats all i can say about it. i do not have more options to explain it...<br />
      <br />
      achim
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">dujuan</span><br />
      <span class="post-time small text-muted">14th September 2004 11:12 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">I apologize for my dumpishness.<br />
      <br />
      when I execute update.exe, therer is one error:<br />
      Could not open splitted destination file.<br />
      <br />
      my OS : Windows XP pro + SP2<br />
      my sources file and nsis script:</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">mumpitzstuff</span><br />
      <span class="post-time small text-muted">14th September 2004 11:49 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">ahhhh now i see the problem. .. in relative paths is not supported at this time! the files you want to compress should be in the same directory like compressfile.exe or in subdirectories created in the same directory like compressfile.exe!!!<br />
      <br />
      achim</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">dujuan</span><br />
      <span class="post-time small text-muted">14th September 2004 12:07 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Success!<br />
      <br />
      Thank you very much!!!</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">mumpitzstuff</span><br />
      <span class="post-time small text-muted">15th September 2004 11:25 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>some bugfixes and crc support</strong><br />
      Hello,<br />
      <br />
      here is a new version of the plugin. Have fun!<br />
      <br />
      Achim</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">dujuan</span><br />
      <span class="post-time small text-muted">15th September 2004 13:27 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Good!<br />
      <br />
      Does this new verion depend on msvcr71.dll ?</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">mumpitzstuff</span><br />
      <span class="post-time small text-muted">15th September 2004 15:57 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">this version depends on msvcrt.dll. this file should be included in every windows version down to win95.<br />
      <br />
      achim</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Yathosho</span><br />
      <span class="post-time small text-muted">16th September 2004 19:38 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">would it be much work, to make it work the other way round? a plugin that creates 7z archives?</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">mumpitzstuff</span><br />
      <span class="post-time small text-muted">17th September 2004 11:11 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">hello,<br />
      <br />
      to pack lzma is not so easy because there is no simple c interface for it. i tried it already and got a file of round 100kb. thats to much in my opinion but also to much work to make it smaller. at this time you can use compressfile and lzma.exe together to pack files...<br />
      <br />
      achim</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">dujuan</span><br />
      <span class="post-time small text-muted">17th September 2004 16:43 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">hello,<br />
      <br />
      When I execute update.exe(created from script), the filecontainer(update.tmp) will be splitted to the original files at the same directory.<br />
      my question: how to split filecontainer to the original files to the <b>special</b> directory?</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Yathosho</span><br />
      <span class="post-time small text-muted">18th September 2004 17:49 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"></p>

      <blockquote>
        <i>Originally posted by mumpitzstuff</i><br />
        <b>hello,<br />
        <br />
        to pack lzma is not so easy because there is no simple c interface for it. i tried it already and got a file of round 100kb. thats to much in my opinion but also to much work to make it smaller. at this time you can use compressfile and lzma.exe together to pack files...<br />
        <br />
        achim</b>
      </blockquote>so far i was using 7za.exe to do that, but as this is capable of packing and extracting, the filesize is quite big. where exactly can i get lzma.exe?
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">dujuan</span><br />
      <span class="post-time small text-muted">19th September 2004 02:05 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><a href="http://www.7-zip.org/sdk.html" target="_blank">Download LZMA SDK 4.06</a></p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">mumpitzstuff</span><br />
      <span class="post-time small text-muted">20th September 2004 11:02 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"></p>

      <blockquote>
        <i>Originally posted by dujuan</i><br />
        how to split filecontainer to the original files to the <b>special</b> directory?
      </blockquote>thats not supported at this time. but i will see what i can do...<br />
      <br />
      achim
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">mumpitzstuff</span><br />
      <span class="post-time small text-muted">21st September 2004 10:17 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">hello,<br />
      <br />
      i found a simple solution for your problem...<br />
      <br />
      1.) create a packed file e.g. test.7z<br />
      <br />
      2.) create a compiled nsis script (test.exe) where you set the variable SetOutPath to the directory you want to unpack the files (e.g. c:\unpacked) and call the extract function of the plugin after it.<br />
      <br />
      3.) copy test.7z to the same directory like SetOutPath e.g. c:\unpacked\test.7z<br />
      <br />
      4.) now copy test.exe to any directory you want e.g. c:\packed and execute test.exe<br />
      <br />
      5.) the files from c:\packed\test.7z should be unpacked in c:\unpacked\*.* now<br />
      <br />
      Function Test<br />
      <br />
      SetOutPath "c:\unpacked"<br />
      <br />
      ;path not needed<br />
      Push "c:\unpacked\test.7z"<br />
      Push "c:\unpacked\update.tmp"<br />
      <br />
      ExtractDllEx::extract<br />
      <br />
      ;get the result<br />
      Pop $0<br />
      StrCmp $0 success SUCCESS<br />
      MessageBox MB_OK|MB_ICONSTOP "$0"<br />
      Delete "update.tmp"<br />
      <br />
      Quit<br />
      <br />
      SUCCESS:<br />
      ;Delete temp files<br />
      Delete "update.tmp"<br />
      <br />
      FunctionEnd<br />
      <br />
      achim</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">dujuan</span><br />
      <span class="post-time small text-muted">22nd September 2004 03:37 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Good!<br />
      thx!</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">RoMZERO</span><br />
      <span class="post-time small text-muted">3rd November 2004 21:28 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">why the plugin dont work with files compressed with 7-zip ?<br />
      <br />
      i'm use 7-zip 4.10</p>
    </div>
    <hr />

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]>
  </script>
</body>
</html>
