<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="Installation on WinNT4.0: All User!!" />

  <title>Installation on WinNT4.0: All User!! - NSIS Forums</title>
  <script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script>
  <!-- Bootstrap core CSS -->

  <link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css" />
  <link rel="stylesheet" href="../css/style.css" type="text/css" /><!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!--[if lt IE 9]>
                <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
                <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->
</head>

<body>
  <div class="container">
    <!-- Put navigation bar here -->

    <ol class="breadcrumb">
      <li><a href="../index.html" class="glyphicon glyphicon-home"></a></li>

      <li><a href="f-65.html">NSIS Discussion</a></li>

      <li class="active">Installation on WinNT4.0: All User!!</li>
    </ol>

    <p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=58791">Installation on WinNT4.0: All User!!</a></p><br />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Chris64</span><br />
      <span class="post-time small text-muted">31st August 2001 15:58 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>Installation on WinNT4.0: All User!!</strong><br />
      Hi all,<br />
      I have the following problem: On a WinNT4-PC: If the admin installs my program a link in the startmenu of the admin is created. How can I detect in my script, if the admin of the WinNT-system is logged in and tries to install my program and then to let choose him, if he wants to create a shortcut in the AllUser-startmenu or the startmenu of the admin. Hopefully somebody can help me.<br />
      <br />
      General: If this option is actually not supported in NSIS, the developers should include this. ;) All well-known installer can this and NSIS should support it, too :)<br />
      <br />
      Regards<br />
      Christian</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">DuaneJeffers</span><br />
      <span class="post-time small text-muted">1st September 2001 07:37 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">First off, NSIS is developed by one guy, Justin Frankel. If you don't know who this is, then you are in the wrong forums.<br />
      <br />
      1)From what I know, all NT functions are not added into NSIS for many reasons. This was originally for people who develop programs for Win98 and WinME/2000. This is supposed to be a small complex installer and something that was not suppost to take up much space.<br />
      <br />
      -DJ</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">pjw62</span><br />
      <span class="post-time small text-muted">1st September 2001 13:20 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Use a MessageBox;<br />
      <br />
      MessageBox MB_YESNO "Put links in the ALLUsers menu?" IDYES AllUsers<br />
      ; code for admin menu<br />
      AllUsers:<br />
      ; code for AllUsers<br />
      <br />
      for just the local machine or machines that dont have a set start menu copied by script on login, I think it would be safe to GetParent dir of the admin's start menu a few times, then append the all users directory and start menu.. unless you just read the value from the registry (sorry, dont know key off hand).<br />
      <br />
      You would need to put it in your script because as Duane says, no one wants a huge exe header wasting precious clock cycles deciding whether it is running on winnt or not.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">prodangle</span><br />
      <span class="post-time small text-muted">3rd September 2001 01:53 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">calm down chris64, try to be a bit nicer. No need for the mention of rival installers<br />
      <br />
      :D :D :D<br />
      <br />
      You could always cheat and send the link to "C:\Documents and Settings\All Users "should work in 99% of cases but it is a bit messy<br />
      I dont know whether a "$STARTMENU\..\..\All Users" (going 2 dirs back from the current user's Sm and then into AllUsers) thing would work, but even if it does this could be messy if that users SM isn't in the standard place - I can't be bothered trying it right now but it might be worth a shot<br />
      <br />
      in a multiuser win9x system there is also an All Users folder in $WINDIR\All Users\Start Menu btw<br />
      <br />
      (sorry for promoting messy tacky scripting here - Ive never done anything like that myself - honest)</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Someonebutnotme</span><br />
      <span class="post-time small text-muted">4th September 2001 13:40 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"></p>

      <blockquote>
        <i>Originally posted by DuaneJeffers</i><br />
        <b>First off, NSIS is developed by one guy, Justin Frankel. If you don't know who this is, then you are in the wrong forums.</b>
      </blockquote>Jesus H Christ man, everyone is welcome whether or not they know if Justin creates this by himself.
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Gonzotek</span><br />
      <span class="post-time small text-muted">10th September 2001 15:17 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">And, while Justin is the primary developer, others have contributed to the code and are credited with those contributions. So developer*S* would indeed be the correct usage. If someone else figured out an elegant and workable solution to his problem, what would be wrong with that?<br />
      <br />
      -=Gonzotek=-</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Chris64</span><br />
      <span class="post-time small text-muted">17th October 2001 14:14 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>Do nobody use NSIS with WinNT?</strong><br />
      Hello all, :)<br />
      Do nobody use NSIS with Windows NT 4.0? I cannot imagine that! ;) How do you solve this problem? I think to display a message-box and ask the user is not the best solution, because many *normal* win9x would be VERY confused, if they would be confronted with a NT-question!... Most of the *normal* users of win9x don't know what a "All user" and a "User"-startmenu is!<br />
      Can somebody give me an advise how to solve this problem? Otherwise I am not able to use this nice, small NSIS-installer ;) And I really like the small size !!! :)<br />
      <br />
      Regards<br />
      Christian</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">nsfis</span><br />
      <span class="post-time small text-muted">18th October 2001 07:36 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Instead of $SMPROGRAMS I find out the right directory for All users this way:<br />
      <br />
      ReadRegStr $9 HKLM "Software\Microsoft\Windows\CurrentVersion\Explorer\Shell Folders" "Common Programs"</p>
    </div>
    <hr />

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]>
  </script>
</body>
</html>
