<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="Custom Page Help" />

  <title>Custom Page Help - NSIS Forums</title><!-- Bootstrap core CSS -->
  <link rel="stylesheet" type="text/css" href="//netdna.bootstrapcdn.com/bootswatch/3.0.1/readable/bootstrap.min.css" />
  <link rel="stylesheet" href="../css/style.css" type="text/css" /><!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!--[if lt IE 9]>
                <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
                <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->
</head>

<body>
  <div class="container">
    <!-- Put navigation bar here -->

    <ol class="breadcrumb">
      <li><a href="../index.html" class="glyphicon glyphicon-home"></a></li>

      <li><a href="f-65.html">NSIS Discussion</a></li>

      <li class="active">Custom Page Help</li>
    </ol>

    <p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=221969">Custom Page Help</a></p><br />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Venu</span><br />
      <span class="post-time small text-muted">20th July 2005 13:11 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>Custom Page Help</strong><br />
      Hi all,<br />
      <br />
      I have one custom page to display the list of installed driver with version number.<br />
      <br />
      How can I define macro for this custom page, so that whenever I execute the setup.exe then depending on the availability of driver in the system I can display the proper message.<br />
      <br />
      As custom page has "MUI_HEADER_TEXT" macro, with this macro I am able to change the header text in runtime.<br />
      <br />
      How can I define same type of macro for displaying the message on the body of the custom page.<br />
      <br />
      Please suggest me.<br />
      <br />
      Venu</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Joel</span><br />
      <span class="post-time small text-muted">20th July 2005 14:06 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">1. Read the InstallOptions documentation about how to create a custome page and add a Text or Static control on it.<br />
      <br />
      2. Read about <i>IfFileExists</i> and <i>GetDllVersion</i> to detect the driver and get its proper version.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Venu</span><br />
      <span class="post-time small text-muted">21st July 2005 06:50 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Thanks for ur reply.<br />
      <br />
      I am able to create custom page and able to display it also and even able to get the installed driver version using GetDLLVersion. but my problem goes like this..<br />
      <br />
      As I have to first check for installed driver, if the prior installation of driver found, then on the Custom Page Header I want to disply the message as "Prior Installation of driver 'A' found" otherwise "Prior Installation of driver 'B' found", and if there is no driver installed doesnot display the page. All these things I am able to do because there is a MACRO "MUI_HEADER_TEXT" for custom page so<br />
      <br />
      code<br />
      -----<br />
      Function CustomPage<br />
      InstallOptions::initDialog /NOUNLOAD "$PLUGINSDIR\test.ini"<br />
      Pop $hwnd<br />
      IfFileExists "$WINDIR\System32\Driver\driver1.sys" 0 next<br />
      !insertmacro MUI_HEADER_TEXT "Already Installed" "Prior Installation of Driver 1 Found"<br />
      Goto Done<br />
      next:<br />
      IfFileExists "$WINDIR\System32\Driver\driver2.sys" 0 next<br />
      !insertmacro MUI_HEADER_TEXT "Already Installed" "Prior Installation of Driver 2 Found"<br />
      Done:<br />
      InstallOptions::show<br />
      Pop $0<br />
      FunctionEnd<br />
      ---------<br />
      <br />
      Now on the same page, if prior installation exists, I want to display the version of the driver on the body of the custom page. as there is no macro available for this I am writing into the .ini file as:<br />
      <br />
      ----------------<br />
      Function .onInit<br />
      Call GetDrvVersion ;this initializes the "$VersionNumber"<br />
      WriteINIStr "$EXEDIR\CustomPage.ini" 'Field 2' State '$VersionNumber'<br />
      <br />
      InitPluginsDir<br />
      File /oname=$PLUGINSDIR\test.ini "CustomPage.ini"<br />
      FunctionEnd<br />
      -----------------<br />
      <br />
      But the version number of the driver on the custom page only gets changed when I compile the script two times. because in first compilation it updates the CustomPage.ini and in second Compilation and execution its updates the page.<br />
      <br />
      So my question is can we have some macro like "MUI_HEADER_TEXT" to display text on the body of custome page, which actually doesnot need any compilation.<br />
      <br />
      Thanks &amp; Regards<br />
      Venu</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Venu</span><br />
      <span class="post-time small text-muted">21st July 2005 10:39 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">I want to represent my problem in another way.<br />
      <br />
      As I have custom page, and there is "Label" I have defined on the custom page. My installer supports 6 different languages, I am able to change the Header of the custom Page according to languages choosen by user with "MUI_HEADER_TEXT" macro.<br />
      <br />
      But how to change the text of "Label" field. I tried by modifying the .ini[custom page] file but it doesn't work out.<br />
      <br />
      Can I define some macros for custom pages to display text on the body of the page, not as a header.<br />
      <br />
      Please help me, its badly needed for the project.<br />
      <br />
      Thanks and Regards<br />
      Venu</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
      <span class="post-time small text-muted">21st July 2005 12:11 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Logically, this code will not work:<br /></p>
      <pre>
<code><br />Function .onInit<br />Call GetDrvVersion ;this initializes the "$VersionNumber"<br />WriteINIStr "$EXEDIR\CustomPage.ini" 'Field 2' State '$VersionNumber'<br /><br />InitPluginsDir<br />File /oname=$PLUGINSDIR\test.ini "CustomPage.ini"<br />FunctionEnd<br /></code>
</pre><br />
      You are writing to "$EXEDIR\CustomPage.ini" <b>before it exists</b> and then <b>overwriting it</b> with another file being extracted!<br />
      <br />
      Should be:<br />
      <pre>
<code><br />Function .onInit<br /> InitPluginsDir<br />  File /oname=$PLUGINSDIR\test.ini "CustomPage.ini"<br /> Call GetDrvVersion ;this initializes the "$VersionNumber"<br />  WriteINIStr "$PLUGINSDIR\test.ini" "Field 2" "State" "$VersionNumber"<br />FunctionEnd<br /></code>
</pre><br />
      <br />
      -Stu
    </div>
    <hr />

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]>
  </script>
</body>
</html>
