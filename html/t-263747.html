<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="Looking for some guidance" />

  <title>Looking for some guidance - NSIS Forums</title>
  <script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script>
  <!-- Bootstrap core CSS -->

  <link rel="stylesheet" type="text/css" href="//netdna.bootstrapcdn.com/bootswatch/3.0.1/readable/bootstrap.min.css" />
  <link rel="stylesheet" href="../css/style.css" type="text/css" /><!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!--[if lt IE 9]>
                <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
                <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->
</head>

<body>
  <div class="container">
    <!-- Put navigation bar here -->

    <ol class="breadcrumb">
      <li><a href="../index.html" class="glyphicon glyphicon-home"></a></li>

      <li><a href="f-65.html">NSIS Discussion</a></li>

      <li class="active">Looking for some guidance</li>
    </ol>

    <p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=263747">Looking for some guidance</a></p><br />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">soylentyellow</span><br />
      <span class="post-time small text-muted">15th January 2007 23:43 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>Looking for some guidance</strong><br />
      My previous experience with NSIS involved moinor maintainence on someones existing installer. Now that I'm starting one from scratch, I could use a few pointers.<br />
      <br />
      For my environment I went with the Eclipse NSIS plugin, its working nicely. HM NIS Edit was throwing errors and crashing on the example scripts, sad because I liked it a lot before.<br />
      <br />
      Here are some things I'm trying to do...<br />
      -Start one or two external installers that are on CDs<br />
      From reading the user manual it looks like I should use ExecWait.<br />
      Edit: This is assuming I know which drive is the cd drive. Should I just prompt the user to simplify things?<br />
      <br />
      -Install one ActiveX control<br />
      Found this on the wiki <a href="http://nsis.sourceforge.net/ActiveX_Dll_Component_Register" target="_blank">http://nsis.sourceforge.net/ActiveX_...onent_Register</a><br />
      <br />
      -Change the resolution to 1024x768<br />
      Found this on the wiki too <a href="http://nsis.sourceforge.net/ChangeRes_plug-in" target="_blank">http://nsis.sourceforge.net/ChangeRes_plug-in</a><br />
      <br />
      -Disable the screen saver<br />
      <br />
      -Disable power management<br />
      <br />
      -Set the IP address<br />
      Is there a plugin for this?<br />
      <br />
      -Make sure the date/time are correct<br />
      I found <a href="http://nsis.sourceforge.net/Time_plugin" target="_blank">THIS</a> any suggestions on how to get the correct time regardless of current system time?<br />
      <br />
      -Enable automatic login<br />
      The comps I am making this for are in "welcome screen mode" for lack for better term that I know. They should have only one acount but that account will have a password. There is probably a registry key for this but I'm not sure where to start looking.<br />
      <br />
      <br />
      Thanks for any advice you can spare :)</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Red Wine</span><br />
      <span class="post-time small text-muted">16th January 2007 05:30 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"></p>

      <blockquote>
        This is assuming I know which drive is the cd drive. Should I just prompt the user to simplify things?
      </blockquote>If your installer resides on the same media you could use $EXEDIR, otherwise there are a couple of plugins at wiki dealing with CD drives, e.g.<br />
      <a href="http://nsis.sourceforge.net/EnumCDs_plug-in" target="_blank">http://nsis.sourceforge.net/EnumCDs_plug-in</a><br />
      <a href="http://nsis.sourceforge.net/CDRom_plug-in" target="_blank">http://nsis.sourceforge.net/CDRom_plug-in</a><br />
      <br />

      <blockquote>
        -Disable the screen saver<br />
        <br />
        -Disable power management
      </blockquote>These info are stored to the registry.<br />
      <br />

      <blockquote>
        -Set the IP address<br />
        Is there a plugin for this?
      </blockquote>What do you mean set?<br />
      <a href="http://nsis.sourceforge.net/IP_plug-in" target="_blank">http://nsis.sourceforge.net/IP_plug-in</a><br />
      <a href="http://nsis.sourceforge.net/Internet_plug-in" target="_blank">http://nsis.sourceforge.net/Internet_plug-in</a><br />
      <br />
      <br />

      <blockquote>
        -Enable automatic login
      </blockquote>ain't that simple to by bass user's password.
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">soylentyellow</span><br />
      <span class="post-time small text-muted">16th January 2007 16:14 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">thank you for the help :D<br />
      <br />
      managed to dig up a few more answers, in case anyone else has the same questions<br />
      <br />
      it looks like the screensaver can be disabled in the registry here <a href="http://articles.techrepublic.com.com/5100-10877_11-5572452.html" target="_blank">http://articles.techrepublic.com.com...1-5572452.html</a><br />
      <br />
      as for setting the IP address and other network information quickly the netsh command thats build in to windows is the way to do, you can edit the registry but it gets messy<br />
      for example: netsh interface ip set address "Local Area Connection 2" static 192.168.1.10 255.255.255.0 192.168.1.1 1<br />
      <br />
      for the automatic logon function Im not trying to "bypass" the users password just make it so they never have to take the time to log in again. While Im still not sure of a way that is attractive for end users to accomplish this it can be done relatively easily through the registry.<br />
      <a href="http://support.microsoft.com/kb/310584" target="_blank">http://support.microsoft.com/kb/310584</a></p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Red Wine</span><br />
      <span class="post-time small text-muted">16th January 2007 16:57 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"></p>

      <blockquote>
        as for setting the IP address and other network information quickly the netsh command thats build in to windows is the way to do, you can edit the registry but it gets messy<br />
        for example: netsh interface ip set address "Local Area Connection 2" static 192.168.1.10 255.255.255.0 192.168.1.1 1
      </blockquote>Cute! I'm happy because most likely I'd never use any of your installers on my machine :D<br />
      <br />

      <blockquote>
        for the automatic logon function Im not trying to "bypass" the users password just make it so they never have to take the time to log in again. While Im still not sure of a way that is attractive for end users to accomplish this it can be done relatively easily through the registry.<br />
        <a href="http://support.microsoft.com/kb/310584" target="_blank">http://support.microsoft.com/kb/310584</a>
      </blockquote>Gee! What's become my intelligence! Now I got your point! Your going to pop up a custom page asking users something like "please enter your windows logon user name and password in the fields bellow to enable automatically logon" :D
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">soylentyellow</span><br />
      <span class="post-time small text-muted">16th January 2007 20:48 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">the users would be doing the same thing manually otherwise :p<br />
      <br />
      Edit: er, their systems would be imaged to behave like this<br />
      <br />
      Edit2(hah): sorry I never explained that this installer is not really for users to just install on their home computers for example but rather for industrial touch panels that are owned by a company in a very specific environment where users should never have to log in or worry about a screensaver because its their job to hit the stop button on the screen to keep someone from getting their arm cut off but a piece of machinery... just to give you a reasoning for the somewhat odd requirements I'm working with :p</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">soylentyellow</span><br />
      <span class="post-time small text-muted">16th January 2007 21:01 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">and yes it looks like Im going to have to become well-versed in custom pages to make all this happen :cry:</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">demiller9</span><br />
      <span class="post-time small text-muted">16th January 2007 22:30 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>auto logon</strong><br />
      The 'automatic logon' key is in HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Winlogon. You should set DefaultDomainName, DefaultUserName, and AutoAdminLogon. (The last one gets set to 1). If these values aren't correct when the system boots, it will prompt for correct values. (If your browser wraps the line containing the registry key, note that the key after Microsoft is 'Windows NT' with a space).<br />
      <br />
      Don</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Red Wine</span><br />
      <span class="post-time small text-muted">16th January 2007 22:44 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">I've posted some sample code the other day dealing with registry and demonstrating the creation of custom page that you may download and examine as a starting point hopefully helpful for you.<br />
      Get it in the following forum thread,<br />
      <a href="http://forums.winamp.com/showthread.php?s=&amp;threadid=262263" target="_blank">http://forums.winamp.com/showthread....hreadid=262263</a><br />
      <br />
      Anyway if you intend to install windows on a workstation through this procedure, it might be better idea to use unattended installation.<br />
      If I remember correctly, one is able to manage all these within an customized unattended installation, (disable screensaver, power management, desktop settings, enable auto logon, allow users only to set up their user name and password, set up network settings, almost everything I guess).<br />
      Moreover you may install drivers and other required software within unattended.<br />
      This what I can't get is the meaning of adding user name and password when autologon is enabled.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">soylentyellow</span><br />
      <span class="post-time small text-muted">17th January 2007 15:18 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">thanks I'll put this to use<br />
      <br />
      another question, I have been using the components page to ask which version of the app should be deployed, should I use a custom page with radial buttons instead because only one should ever be installed</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Red Wine</span><br />
      <span class="post-time small text-muted">17th January 2007 15:33 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"></p>

      <blockquote>
        another question, I have been using the components page to ask which version of the app should be deployed, should I use a custom page with radial buttons instead because only one should ever be installed
      </blockquote>It's up to your preference, with nsis you're always can do it the way you like. :)<br />
      BTW the custom page with radio buttons already discussed a few threads below.<br />
      <br />
      <a href="http://forums.winamp.com/showthread.php?s=&amp;threadid=263822" target="_blank">http://forums.winamp.com/showthread....hreadid=263822</a>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">soylentyellow</span><br />
      <span class="post-time small text-muted">19th January 2007 21:47 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Will this plugin...<br />
      <a href="http://nsis.sourceforge.net/ActiveX_Dll_Component_Register" target="_blank">http://nsis.sourceforge.net/ActiveX_...onent_Register</a><br />
      <br />
      ...allow me to register OCX files too?</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Red Wine</span><br />
      <span class="post-time small text-muted">19th January 2007 21:53 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">I couldn't say for the plugin, I haven't test it, I'd say NSIS allows you see the documentation,<br />
      <a href="http://nsis.sourceforge.net/Docs/AppendixB.html#B" target="_blank">http://nsis.sourceforge.net/Docs/AppendixB.html#B</a></p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">soylentyellow</span><br />
      <span class="post-time small text-muted">25th January 2007 18:15 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">I think Im doing something wrong with this function for a custom page, it always behaves like the first button was pressed<br />
      <br />
      Function InstallInTouch<br />
      !insertmacro MUI_INSTALLOPTIONS_READ $0 "$PLUGINSDIR\InstallInTouch.ini" "Settings" "State"<br />
      StrCmp $0 0 validate ; Next button?<br />
      StrCmp $0 1 verify ; verify button?<br />
      StrCmp $0 2 install ; install button?<br />
      StrCmp $0 3 skip ; skip button?<br />
      <br />
      verify:<br />
      MessageBox MB_OK "Verify Button Pressed"<br />
      goto done<br />
      <br />
      install:<br />
      MessageBox MB_OK "Install Button Pressed"<br />
      goto done<br />
      <br />
      skip:<br />
      MessageBox MB_OK "Skip Button Pressed"<br />
      goto done<br />
      <br />
      validate:<br />
      MessageBox MB_OK "Next Button Pressed"<br />
      <br />
      done:<br />
      FunctionEnd<br />
      <br />
      <br />
      InstallInTouch.ini follows<br />
      <br />
      ; Auto-generated by EclipseNSIS InstallOptions Script Wizard<br />
      ; Jan 17, 2007 11:46:36 AM<br />
      [Settings]<br />
      NumFields=4<br />
      <br />
      [Field 1]<br />
      Type=Button<br />
      Flags=NOTIFY<br />
      Left=63<br />
      Top=22<br />
      Right=113<br />
      Bottom=37<br />
      Text=Verify<br />
      <br />
      [Field 2]<br />
      Type=Button<br />
      Flags=NOTIFY<br />
      Left=63<br />
      Top=65<br />
      Right=113<br />
      Bottom=81<br />
      Text=Install<br />
      <br />
      [Field 3]<br />
      Type=Button<br />
      Flags=NOTIFY<br />
      Left=63<br />
      Top=109<br />
      Right=113<br />
      Bottom=125<br />
      Text=Skip<br />
      <br />
      <br />
      I just have a messagebox for each button to make sure I can get basic stuff right before adding real behavior.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">soylentyellow</span><br />
      <span class="post-time small text-muted">25th January 2007 18:17 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">I think it's just not getting caught by any of the StrCmp statements, what gives?</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
      <span class="post-time small text-muted">25th January 2007 18:25 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">When using MUI_INSTALLOPTIONS_READ, you shouldn't pass $PLUGINSDIR\your.ini. The macro adds $PLUGINSDIR on its own.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">soylentyellow</span><br />
      <span class="post-time small text-muted">25th January 2007 18:54 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">thank you :D</p>
    </div>
    <hr />

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]>
  </script>
</body>
</html>
