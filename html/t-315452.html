<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="Problem copying file to $APPDATA" />

  <title>Problem copying file to $APPDATA - NSIS Forums</title>
  <script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script>
  <!-- Bootstrap core CSS -->

  <link rel="stylesheet" type="text/css" href="//netdna.bootstrapcdn.com/bootswatch/3.0.1/readable/bootstrap.min.css" />
  <link rel="stylesheet" href="../css/style.css" type="text/css" /><!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!--[if lt IE 9]>
                <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
                <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->
</head>

<body>
  <div class="container">
    <!-- Put navigation bar here -->

    <ol class="breadcrumb">
      <li><a href="../index.html" class="glyphicon glyphicon-home"></a></li>

      <li><a href="f-65.html">NSIS Discussion</a></li>

      <li class="active">Problem copying file to $APPDATA</li>
    </ol>

    <p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=315452">Problem copying file to $APPDATA</a></p><br />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">dr_legg</span><br />
      <span class="post-time small text-muted">18th December 2009 09:35 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>Problem copying file to $APPDATA</strong><br />
      I'm trying to copy a file into the $APPDATA folder but it's not working.<br />
      <br />
      I have the following:<br />
      <br />
      SetShellVarContext all<br />
      <br />
      CopyFiles "$INSTDIR\Configuration.xml" "$APPDATA\MyApp\Configuration\Configuration.xml"<br />
      <br />
      The folder exists, as does the file so why doesn't it work?<br />
      <br />
      Thanks<br />
      Clegg</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">MSG</span><br />
      <span class="post-time small text-muted">18th December 2009 09:51 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">You probably don't have write permissions in the directory. Try running as admin.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">dr_legg</span><br />
      <span class="post-time small text-muted">18th December 2009 09:54 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">I am logged on to my machine as an administrator - I can copy files manually to this directory with no problem.<br />
      <br />
      Is this what you meant or do I need to set something in the installer?<br />
      <br />
      Thanks</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">MSG</span><br />
      <span class="post-time small text-muted">19th December 2009 12:55 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Hmm. First order of business would probably be to isolate the cause of the problem. Create a skeleton installer that only tries to copy the file:<br />
      <br />
      Outfile "test.exe"<br />
      requestexecutionlevel admin<br />
      Section<br />
      SetShellVarContext all<br />
      SetOutPath "$APPDATA\MyApp\Configuration"<br />
      CopyFiles "$EXEDIR\Configuration.xml" "$APPDATA\MyApp\Configuration\Configuration.xml"<br />
      SectionEnd<br />
      <br />
      If that works, the problem lies elsewhere in your installer. If if doesn't work... Well, I'm not sure why it wouldn't work. But at least you'll know it's caused by either the folder creation or file copying commands.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">dr_legg</span><br />
      <span class="post-time small text-muted">23rd December 2009 10:49 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Many thanks for the reply - i've discovered the problem and as per usual it's my own stupid fault!<br />
      <br />
      The application has a folder in the Program Files directory as well as $APPDATA - I copied and pasted the one from Program Files and it's ever so slightly different which caused the error<br />
      <br />
      ....\Provider\App2.0\AppAgent\ as opposed to<br />
      ....\Provider\App2.0\App Agent\<br />
      <br />
      it's a 3rd party app so I can't make them both the same but at least I know what the problem is now.<br />
      <br />
      Thanks for all your help and sorry for wasting your time.<br />
      <br />
      Clegg</p>
    </div>
    <hr />

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]>
  </script>
</body>
</html>
