<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="Vista Permissions in C:\ProgramData" />

  <title>Vista Permissions in C:\ProgramData - NSIS Forums</title>
  <script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script>
  <!-- Bootstrap core CSS -->

  <link rel="stylesheet" type="text/css" href="//netdna.bootstrapcdn.com/bootswatch/3.0.1/readable/bootstrap.min.css" />
  <link rel="stylesheet" href="../css/style.css" type="text/css" /><!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!--[if lt IE 9]>
                <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
                <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->
</head>

<body>
  <div class="container">
    <!-- Put navigation bar here -->

    <ol class="breadcrumb">
      <li><a href="../index.html" class="glyphicon glyphicon-home"></a></li>

      <li><a href="f-65.html">NSIS Discussion</a></li>

      <li class="active">Vista Permissions in C:\ProgramData</li>
    </ol>

    <p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=292673">Vista Permissions in C:\ProgramData</a></p><br />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">xcabur</span><br />
      <span class="post-time small text-muted">3rd June 2008 14:43 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>Vista Permissions in C:\ProgramData</strong><br />
      Hello together<br />
      <br />
      I need your help again and i hope you can help me.<br />
      I'm not sure that it is a problem from nsis but maybe you have an idea how I can do it.<br />
      <br />
      I have an Access Database which needs permissions to right in his tables. My NSIS Setup install the DB and other files under vista in the %programdata% directory. Because the whole %programfiles% directory is read only under vista.<br />
      <br />
      When I start the Setup the UAC appears and the files will correct install. But when I want rename the installed files a message appear and notifiy me that the file is write-protected when I force this process (choose continue) the file will renamed.<br />
      This problem exits with the Database, PDF, or any other installed Files. When I open the DB he open as read only.<br />
      <br />
      When I delete this files and I copy the files manual in the same directory. I can rename the files. The NTFS Permissions aren't the problem. The System was restarted.<br />
      <br />
      I think windows mark the files with read-only permissions because they will created by setup.<br />
      <br />
      Has anybody an idea how i can install files in the %programdata% directory without this read-only problems?<br />
      <br />
      Thanks for help</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">tictox</span><br />
      <span class="post-time small text-muted">4th June 2008 11:34 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">I have been on a learning curve myself concerning vista UAC issues..<br />
      <br />
      basically<br />
      <br />
      To write to program files , your application needs to be run as Administrator , to achieve this your application needs a manifest file which grants this permission.<br />
      <br />
      I was not the developer of some of my applications exe files and so i used a external manifest file to do this..<br />
      <br />
      <br />
      IF you have previously installed your application without any manifest , and plan to now use a manifest , windows will not read the file unless you change you exe's time stamp , I did this by simply opening the exe in notepad scolling to the end , click to type , press spacebar and then backspace and save , which alters the timestamp.<br />
      <br />
      I had to give admin rights to my update manager exe as it copies files to program files..<br />
      <br />
      if you want to see whether UAC is creating virtual directories for your application you can run %LOCALAPPDATA%\VirtualStore and look in the program files folder .. technically you dont want vista creating this for your app , and is a sure sign that you have not handled UAC correctly .. im still learning all this myself , please reseach everything I have stated yourself and get other opinions<br />
      <br />
      hope that is some help<br />
      <br />
      Ian</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">xcabur</span><br />
      <span class="post-time small text-muted">4th June 2008 14:01 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">First of all thanks for your help.<br />
      But I don't want install my Tools into the Programfiles directory but into the programdata directory it's euqally to the alusersprofile directory.<br />
      Normaly the ProgramData Directory isn't watch by vista UAC who ever I run the Setup anyway with administratur rights.<br />
      <br />
      But the Files are read only. When I copy the files manuel (not with a setup) in the same directory then I have no problems.<br />
      <br />
      Have you got an idea?<br />
      <br />
      This is the Notification:<br />
      <br />
      <a href="http://www.administrator.de/images/articles/8e5c2b4276c1c7f25b53e5f3454351d6-programdata.jpg" target="_blank">http://www.administrator.de/images/a...rogramdata.jpg</a></p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">xcabur</span><br />
      <span class="post-time small text-muted">4th June 2008 14:56 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">ok, I have find out that the install root directory hast set the write-protected flag. But I can't uncheck it. When I call the Preferences again the flag is set again. How can I uncheck it or why is the flag not set when I creat the directory manual?</p>
    </div>
    <hr />

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]>
  </script>
</body>
</html>
