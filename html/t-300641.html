<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="Change nsis error of UAC plugin on XP when user check &quot;Protect my computer[...]&quot;" />

  <title>Change nsis error of UAC plugin on XP when user check "Protect my computer[...]" - NSIS Forums</title>
  <script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script>
  <!-- Bootstrap core CSS -->

  <link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css" />
  <link rel="stylesheet" href="../css/style.css" type="text/css" /><!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!--[if lt IE 9]>
                <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
                <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->
</head>

<body>
  <div class="container">
    <!-- Put navigation bar here -->

    <ol class="breadcrumb">
      <li><a href="../index.html" class="glyphicon glyphicon-home"></a></li>

      <li><a href="f-65.html">NSIS Discussion</a></li>

      <li class="active">Change nsis error of UAC plugin on XP when user check "Protect my computer[...]"</li>
    </ol>

    <p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=300641">Change nsis error of UAC plugin on XP when user check "Protect my computer[...]"</a></p><br />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">BuilderBob</span><br />
      <span class="post-time small text-muted">4th December 2008 14:32 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>Change nsis error of UAC plugin on XP when user check "Protect my computer[...]"</strong><br />
      Hello,<br />
      <br />
      When using the UAC plugin on XP with non-admin user, user is prompted to choose between run as current user and run as admin. If user chooses to run as current user there's a checkbox "<b>Protect my computer and data from unauthorized program activity</b>". With this checked, I get the error: "NSIS Error", "<b>Error launching installer</b>".<br />
      <br />
      Instead of this message I want to show user a friendly message that explains they must run as admin. Is this possible? Where is that error message come from, nsis internals or the UAC plugin?<br />
      <br />
      Thanks!</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Anders</span><br />
      <span class="post-time small text-muted">4th December 2008 20:29 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">This message comes from nsis because checking that checkbox really locks down the process so it can't even access the temp folder (The same thing would happen if you right click on a nsis install that does not even use the UAC plugin and choose Run as...) I'm already hacking that dialog a bit (selecting other user as default and unchecking that checkbox) but I'm not going to hide it, if you really want to hide that thing, add code in MSRunAsDlgMod_ShellProc and recompile the plugin...</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">BuilderBob</span><br />
      <span class="post-time small text-muted">7th December 2008 09:07 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Hi Anders, thank you for your reply.<br />
      <br />
      I am trying to display a friendly message instead of the "NSIS Error" message. I don't want to hide the elevation dialog. If users get a choice to keep running as a regular user they should at least know what the error is and why the installer isn't doing anything.<br />
      <br />
      So is the "NSIS Error" message comes from the UAC plugin code or nsis itself? I would feel comfortable compiling the UAC plugin but not so much the core of nsis.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">BuilderBob</span><br />
      <span class="post-time small text-muted">7th December 2008 10:43 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">The error happens when ForkSelf calls ShellExecuteEx, so it probably comes from the newly run installer, and is probably an internal nsis error. Is there a way to display a different error message, or hide this one?<br />
      <br />
      EDIT: I also set the installer as silent.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Anders</span><br />
      <span class="post-time small text-muted">7th December 2008 18:12 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">You can hide the checkbox, not the whole dialog. That error has to happen, there is no way around it, to use a plugin, you need write access to $temp, and if that checkbox is checked, you will not get write access, its that easy. So, tell your users not to check it, or just hide the checkbox</p>
    </div>
    <hr />

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]>
  </script>
</body>
</html>
