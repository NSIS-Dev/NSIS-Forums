<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="ExecWait --&gt; then pass text to launched exe..." />

  <title>ExecWait --&gt; then pass text to launched exe... - NSIS Forums</title>
  <script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script>
  <!-- Bootstrap core CSS -->

  <link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css" />
  <link rel="stylesheet" href="../css/style.css" type="text/css" /><!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!--[if lt IE 9]>
                <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
                <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->
</head>

<body>
  <div class="container">
    <!-- Put navigation bar here -->

    <ol class="breadcrumb">
      <li><a href="../index.html" class="glyphicon glyphicon-home"></a></li>

      <li><a href="f-65.html">NSIS Discussion</a></li>

      <li class="active">ExecWait --&gt; then pass text to launched exe...</li>
    </ol>

    <p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=192179">ExecWait --&gt; then pass text to launched exe...</a></p><br />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Jnuw</span><br />
      <span class="post-time small text-muted">2nd September 2004 02:02 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>ExecWait --&gt; then pass text to launched exe...</strong><br />
      Hello all.<br />
      <br />
      I'm very new to NSIS, but I already love it. I seemed to be stumped on my current challenge though. I am using ExecWait to launch an exe that will automatically do some database editing. Currently this exe simply requires a user to enter a username and password. I would like to eliminate that user touch, and after launching the exe, pass in the text: &lt;username&gt;&lt;tab&gt;&lt;password&gt;&lt;enter&gt; . Can someone point me in the right direction? Thanks much all.<br />
      <br />
      Jnuw</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Gurleen</span><br />
      <span class="post-time small text-muted">2nd September 2004 07:10 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">What if you just pass the the parameters after the execWait<br />
      like this<br />
      ExecWait 'databaseHandler.exe username password'<br />
      <br />
      WEll this thing works when you call execWait with .msi<br />
      <br />
      ExecWait '${INSTALLERDLL}\msxml.msi /qn'<br />
      <br />
      In the above command we are running msxml.msi with command line parameters . So you can pass the parameters to your program. Now it depends on your program how it handles these command line parameters.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Takhir</span><br />
      <span class="post-time small text-muted">2nd September 2004 08:59 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">For DOS applications it is possible to launch application with redirected i/o . NSIS nsExec plugin hides console window and handles application's output. I also wrote a simple plugin using string parameter as stdin <a href="http://forums.winamp.com/showthread.php?s=&amp;threadid=181442&amp;highlight=stdin" target="_blank">http://forums.winamp.com/showthread....ighlight=stdin</a><br />
      You can also set "Ignore default libs" in plugin project to decrease dll size (like this done in other plugins).</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Jnuw</span><br />
      <span class="post-time small text-muted">2nd September 2004 21:10 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Thanks guys for the responses. Unfortunately this exe does not accept parameters, and is not a DOS app. I didn’t write it, and can’t change it to use parms. This is what it looks like:<br />
      <br />
      <a href="http://webpages.charter.net/orum/1.jpg" target="_blank">http://webpages.charter.net/orum/1.jpg</a><br />
      <br />
      So after launching it, I just need to send or pipe (like in a DOS batch file) a user name, then tab down and enter the password and hit enter. Would SendMessage work for this? Thanks all.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Comm@nder21</span><br />
      <span class="post-time small text-muted">3rd September 2004 15:40 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">yes, sendmessage would work.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Takhir</span><br />
      <span class="post-time small text-muted">3rd September 2004 16:29 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">MSDN declares the only message for interprocess communication - WM_COPYDATA (Platform SDK/Windows Base Services/Interprocess Communication). This should work always. But in real life other messages work too (but without any warranties &amp;&amp; with some security limitations &amp;&amp; inside the same virtual desktop) - you can find few samples of WM_CLOSE usage in this forum.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Jnuw</span><br />
      <span class="post-time small text-muted">3rd September 2004 16:36 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"></p>

      <blockquote>
        <i>Originally posted by Comm@nder21</i><br />
        <b>yes, sendmessage would work.</b>
      </blockquote>Thanks Comm@ander21. The exe I’m working with, pictured above, is called Mod.exe. I'm having some trouble figuring out the syntax of the send message command. Could someone lend a hand please?<br />
      <br />
      SendMessage HWND msg wparam lparam [user_var(return value)] [/TIMEOUT=time_in_ms]<br />
      <br />
      I read that "HWND" is the Windows Handle, which in this case would be Mod.exe. Past that I’m not sure how to pass the username, then a tab, then the password, then an &lt;enter&gt; to the exe. Any advice would be appreciated, thanks all.<br />
      <br />
      Thanks.<br />
      Jnuw
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Jnuw</span><br />
      <span class="post-time small text-muted">29th September 2004 21:57 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Bump. Any know the syntax of the send message command? Thanks.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
      <span class="post-time small text-muted">30th September 2004 09:50 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">The window handle is not Mod.exe. You can get the window handle using FindWindow. Once you got the main window's handle, you'd need to find the text field handles. To do that, you'd use GetDlgItem. If it's not a dialog, you'd need FindWindow again.<br />
      <br />
      Once you have the text fields' window handles you can send them WM_SETTEXT:</p>
      <pre>
<code>!include WinMessages.nsh<br />SendMessage $TEXT_HWND ${WM_SETTEXT} 0 "STR:some text"</code>
</pre>Then, once the text fields are full, you'd want to press the button. Assuming that is a dialog and that the continue button is the OK button, you'd send the main window a WM_COMMAND message:
      <pre>
<code>!include WinMessages.nsh<br />SendMessage $MAIN_HWND ${WM_COMMAND} 1 0</code>
</pre>A few possible problems:

      <ul>
        <li>You can't use ExecWait because the script will not continue to execute all of the SendMessage instructions until that program is closed.</li>

        <li>If you use Exec, you can't know for sure if the window has already been created and destroyed. Every loop you write might end up an infinite loop.</li>
      </ul>To work around those, you need to write a plug-in or some System.dll code that will give you the process handle so you can wait on it until the window is created.<br />
      <br />
      The best solution for this is to find a way to pass those parameters in a sane way. If you can't find one, you might want to try <a href="http://www.hiddensoft.com/AutoIt3/" target="_blank">AutoIt</a> first.
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Jnuw</span><br />
      <span class="post-time small text-muted">30th September 2004 15:17 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">kichik, thank you so much for your explanation. You bring up some very good points there as far as possible problems. I will check out these options, and post back with the results. Thanks again.</p>
    </div>
    <hr />

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]>
  </script>
</body>
</html>
