<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="description" content="LockedList Plugin on Win2k"><title>LockedList Plugin on Win2k - NSIS Forums</title><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script><link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css"><link rel="stylesheet" href="../css/style.css" type="text/css"></head><body><div class="container"><ol class="breadcrumb"><li><a href="../index.html" class="glyphicon glyphicon-home"></a></li><li><a href="f-65.html">NSIS Discussion</a></li><li class="active">LockedList Plugin on Win2k</li></ol><p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=325120">LockedList Plugin on Win2k</a></p><br><div class="post"><p class="post-meta"><span class="post-author text-primary">LoRd_MuldeR</span><br><span class="post-time small text-muted">22nd December 2010 00:31 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>LockedList Plugin on Win2k</strong><br>Hello.<br><br>I'm using the LockedList plug-in in my installer. And so far it seems to work fine on Windows XP as well as on Windows 7. However I noticed that on Windows 2000 there is a problem: It seems every single process is mistakenly detected as conflicting! So is the LockedList plug-in not compatible with Win2k? From the documentation it would seem the plug-in works even on Windows NT 4.0, but apparently this is not the case. Or am I missing something?<br><br><a href="http://img141.imageshack.us/img141/3361/lockedlistwin2kerror.png" target="_blank">http://img141.imageshack.us/img141/3...win2kerror.png</a><br><br><br>Here is the code I use:<br></p><pre>
<code>Function LockedListShow<br>  !insertmacro MUI_HEADER_TEXT "$(LAMEXP_LANG_LOCKEDLIST_HEADER)" "$(LAMEXP_LANG_LOCKEDLIST_TEXT)"<br>  LockedList::AddModule "\LameXP.exe"<br>  LockedList::AddModule "\Uninstall.exe"<br>  LockedList::AddModule "\Au_.exe"<br>  LockedList::Dialog /heading "$(LAMEXP_LANG_LOCKEDLIST_HEADING)"<br>     /noprograms "$(LAMEXP_LANG_LOCKEDLIST_NOPROG)"<br>     /searching  "$(LAMEXP_LANG_LOCKEDLIST_SEARCH)"<br>     /colheadings "$(LAMEXP_LANG_LOCKEDLIST_COLHDR1)" "$(LAMEXP_LANG_LOCKEDLIST_COLHDR2)"<br>  Pop $R0<br>FunctionEnd</code>
</pre><br>
      <br>
      I'm using the Unicode version, if that matters.<br>
      <br>
      Thanks in advance! ;)
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br>
      <span class="post-time small text-muted">22nd December 2010 11:18 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">I'm afraid I don't have a Windows 2000 machine to try this on. Can you debug?<br>
      <br>
      Edit: Also which version of the plug-in?<br>
      <br>
      Stu</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">LoRd_MuldeR</span><br>
      <span class="post-time small text-muted">22nd December 2010 12:38 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"></p>

      <blockquote>
        <small>Originally posted by Afrow UK</small><br>
        I'm afraid I don't have a Windows 2000 machine to try this on. Can you debug?
      </blockquote>I have a Win2k VM running, as some users still insist using such old OS :rolleyes:<br>
      <br>
      If you tell me what I can do to help debugging, I'll see what I can do...<br>
      <br>

      <blockquote>
        <small>Originally posted by Afrow UK</small><br>
        Edit: Also which version of the plug-in?
      </blockquote>LockedList.dll v2.2 by Afrow UK<br>
      Last build: 19th October 2010
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br>
      <span class="post-time small text-muted">22nd December 2010 15:52 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Ideally if you can, install VS2010 on the VM and attach the built installer executable to the VS debugger (while using a debug build of the DLL). You can use breakpoints then.<br>
      <br>
      Stu</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">LoRd_MuldeR</span><br>
      <span class="post-time small text-muted">22nd December 2010 16:59 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"></p>

      <blockquote>
        <small>Originally posted by Afrow UK</small><br>
        Ideally if you can, install VS2010 on the VM and attach the built installer executable to the VS debugger (while using a debug build of the DLL). You can use breakpoints then.<br>
        <br>
        Stu
      </blockquote>Can't it be built with VS2008 ???<br>
      <br>
      I haven't updated my "production" system to VS2010 yet and I don't want to dirty my "test" system with VS2010. I even doubt it will install on a Win2k system! Moreover VS2010 is a quite huge download. And the last time I downloaded the DVD ISO from the MSDN-AA site, which took hours, it was broken (setup always failed with integrity check failure).<br>
      <br>
      Another idea: Can't you just throw in a few OutputDebugString()'s at the critical positions and I capture the output on my Win2k system using <a href="http://technet.microsoft.com/en-us/sysinternals/bb896647" target="_blank">DbgView</a>?<br>
      <br>
      Regards,<br>
      MuldeR.
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br>
      <span class="post-time small text-muted">22nd December 2010 17:09 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">I think I've only included the vcxproj file in the source code which is for VS2010. I'm afraid I'm very busy with work at the moment but if you want to modify the source file I will rebuild and attach the dll here.<br>
      <br>
      Stu</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">LoRd_MuldeR</span><br>
      <span class="post-time small text-muted">22nd December 2010 17:21 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Let me try this:<br>
      <a href="http://www.codeproject.com/Tips/87570/Converting-VS2010-Solution-to-VS2008.aspx" target="_blank">http://www.codeproject.com/Tips/8757...to-VS2008.aspx</a></p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">LoRd_MuldeR</span><br>
      <span class="post-time small text-muted">22nd December 2010 18:02 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Hm, I managed to compile LockedList.dll with VS2008, but my DLL doesn't work.<br>
      <br>
      The dialog simply doesn't show up. Instead I get a blank page :confused:<br>
      <br>
      However this simple macro should do to the job:<br>
      <br></p>
      <pre>
<code>#define DEBUG_PRINT(FORMAT,...)                             \<br>{                                                           \<br>    char *buffer = new char[1024];                          \<br>    if(sprintf_s(buffer, 1024, FORMAT, __VA_ARGS__) &gt; 0)    \<br>    {                                                       \<br>        OutputDebugStringA(buffer);                         \<br>    }                                                       \<br>    delete [] buffer;                                       \<br>}</code>
</pre><br>
      <br>
      Use like this:<br>
      <br>
      <pre>
<code>BOOL WINAPI DllMain(HINSTANCE hInst, ULONG ul_reason_for_call, LPVOID lpReserved)<br>{<br>  g_hInstance = hInst;<br>  DEBUG_PRINT("LockedList says hello (code %d)", 42);<br>  return TRUE;<br>}</code>
</pre><br>
      <br>
      If you include some DEBUG_PRINT's at the critical places, I'll send you the log...
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br>
      <span class="post-time small text-muted">24th December 2010 15:18 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Can you try with SilentSearch and see what file paths you get. They should be an empty string, which is what I already test for (and exclude) as of v2.2. I am confused as to why they still get added.<br>
      <br>
      Stu</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">LoRd_MuldeR</span><br>
      <span class="post-time small text-muted">24th December 2010 15:20 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"></p>

      <blockquote>
        <small>Originally posted by Afrow UK</small><br>
        Can you try with SilentSearch and see what file paths you get. They should be an empty string, which is what I already test for (and exclude) as of v2.2. I am confused as to why they still get added.<br>
        <br>
        Stu
      </blockquote>Will try...
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">LoRd_MuldeR</span><br>
      <span class="post-time small text-muted">24th December 2010 15:38 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Okay, here is my test script:<br>
      <a href="http://pastie.org/1403194" target="_blank">http://pastie.org/1403194</a><br>
      <br>
      And here the result I get on Win2k:<br>
      <a href="http://pastie.org/1403196" target="_blank">http://pastie.org/1403196</a><br>
      <br>
      -&gt; All paths are empty, as you had expected. And I definitely use v2.2.</p>
    </div>
    <hr>

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]></script></body></html>