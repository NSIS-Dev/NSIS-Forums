<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="Run another setup before installing my own code" />

  <title>Run another setup before installing my own code - NSIS Forums</title>
  <script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script>
  <!-- Bootstrap core CSS -->

  <link rel="stylesheet" type="text/css" href="//netdna.bootstrapcdn.com/bootswatch/3.0.1/readable/bootstrap.min.css" />
  <link rel="stylesheet" href="../css/style.css" type="text/css" /><!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!--[if lt IE 9]>
                <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
                <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->
</head>

<body>
  <div class="container">
    <!-- Put navigation bar here -->

    <ol class="breadcrumb">
      <li><a href="../index.html" class="glyphicon glyphicon-home"></a></li>

      <li><a href="f-65.html">NSIS Discussion</a></li>

      <li class="active">Run another setup before installing my own code</li>
    </ol>

    <p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=126733">Run another setup before installing my own code</a></p><br />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">znsr</span><br />
      <span class="post-time small text-muted">28th February 2003 20:49 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>Run another setup before installing my own code</strong><br />
      Hi, I just use NSIS since yesterday. I have one simple problem:<br />
      <br />
      When we distribute our own application, we have to install<br />
      some 3rd party software on the computer (the order of installation<br />
      is not critical). Since these software all come with their<br />
      own setup file, I like to know how to run these setup files<br />
      within my own *.sni file. So I just need to have my setup program<br />
      to start other set-up programs.<br />
      <br />
      Thank you very much!</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Sunjammer</span><br />
      <span class="post-time small text-muted">28th February 2003 21:46 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">You can run external programs using one of several commands:- Exec, ExecShell, ExecWait, nsExec::Exec, nsExec::ExecToLog, nsExec::ExecToStack. The first three Exec commands may produce a dos command prompt window, the latter three will not. In fact the very last two can capture text output from the program u launch and show it in the detail window or add it to the stack for you to retrieve.<br />
      <br />
      You may want to find out how to run your other setup programs silently so it looks like you just have your nsis installer running. <a href="http://unattended.sourceforge.net/installers.html" target="_blank">This page might help</a>.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">znsr</span><br />
      <span class="post-time small text-muted">28th February 2003 22:43 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Thanks!<br />
      <br />
      I have used the following function to run StartMenu.exe which<br />
      is one of examples given in ModernUI of NSIS. But I wonder if there<br />
      is any other approach I can use.<br />
      <br />
      I am not sure if I can run silently since there is a license page<br />
      in other 3rd party software setup program waiting for input from user.<br />
      <br />
      Function .onInstSuccess<br />
      <br />
      MessageBox MB_YESNO "Done with shapes.exe, install modern.exe?" IDNO NoInstall<br />
      Exec StartMenu.exe<br />
      NoInstall:<br />
      <br />
      FunctionEnd</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
      <span class="post-time small text-muted">28th February 2003 22:53 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">If you use ExecWait you won't have to ask the user to press OK when finished with the installation. ExecWait can also get you the return code of the installer process so you can figure out if it was installed according to it. NSIS installers return 0 on success, non-zero on failure.<br />
      <br />
      If the installer doesn't wait for the other installer even though you have used ExecWait then you should read path Sunjammer linked to, it contains information about several installers and how to make them really silent and work with ExecWait.</p>
    </div>
    <hr />

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]>
  </script>
</body>
</html>
