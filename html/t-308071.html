<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="INI file" />

  <title>INI file - NSIS Forums</title>
  <script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script>
  <!-- Bootstrap core CSS -->

  <link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css" />
  <link rel="stylesheet" href="../css/style.css" type="text/css" /><!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!--[if lt IE 9]>
                <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
                <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->
</head>

<body>
  <div class="container">
    <!-- Put navigation bar here -->

    <ol class="breadcrumb">
      <li><a href="../index.html" class="glyphicon glyphicon-home"></a></li>

      <li><a href="f-65.html">NSIS Discussion</a></li>

      <li class="active">INI file</li>
    </ol>

    <p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=308071">INI file</a></p><br />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">xma</span><br />
      <span class="post-time small text-muted">8th July 2009 08:44 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>INI file</strong><br />
      Hi evryone,<br />
      I am trying to add components to the page directory of the installer.<br />
      <br />
      I use ressource hacker to add groupbox, bouton, etc..<br />
      <br />
      Now those components are visible when i launch this installer but i can t use them in my code to specify their use.<br />
      <br />
      For exemple, I would like my button to be a dirRequest.<br />
      <br />
      I think I have to declare them in a file .ini but I don't know where I can get the ini file for the default installation pages in order to add field for the components<br />
      <br />
      If someone can help me it will be greatfull<br />
      <br />
      Thank you</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">jpderuiter</span><br />
      <span class="post-time small text-muted">8th July 2009 14:12 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">You have to use the ButtonEvent Plugin: <a href="http://nsis.sourceforge.net/ButtonEvent_plug-in" target="_blank">http://nsis.sourceforge.net/ButtonEvent_plug-in</a><br />
      <br />
      Read the readme in the zip for more info.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">xma</span><br />
      <span class="post-time small text-muted">8th July 2009 17:57 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Thanks for your reply :)<br />
      I was reading doc of ButtonEvent. I don't think i can't make this button become a DirRerquest like the one which is already exist in the directory page.<br />
      I am newbie and maybe I am not doing the right thing to obtain what i want.<br />
      <br />
      I just need to add another directory request in the default MUI_PAGE_DIRECTORY.<br />
      <br />
      Do you have any ideas to do that because i am looking evrywhere and i can't get a solution to my problem ?<br />
      <br />
      Thank you</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
      <span class="post-time small text-muted">8th July 2009 22:14 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Easier just to add another MUI_PAGE_DIRECTORY.<br />
      <br />
      Stu</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">jpderuiter</span><br />
      <span class="post-time small text-muted">8th July 2009 22:24 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">OK, if you just need a second directory page, you can do three things:</p>

      <ol style="list-style-type: decimal">
        <li>Use two Directory pages: (<a href="http://nsis.sourceforge.net/Two_installations_in_one_installer" target="_blank">http://nsis.sourceforge.net/Two_inst..._one_installer</a>)</li>

        <li>Add a textbox and a browse button with resource hacker, add a callbackfunction for the browse button, and call the DialogsEx plug-in (<a href="http://nsis.sourceforge.net/Dialog****plug-in" target="_blank">http://nsis.sourceforge.net/Dialog****plug-in</a>) in this callback to show a folder browse dialog box.</li>

        <li>Don't use the standard Directory page, and create your own custom page with two nsDialogs DirRequest controls.</li>
      </ol>JP
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
      <span class="post-time small text-muted">8th July 2009 22:40 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">That example with two directory pages is probably more than you need as it also has two components and instfiles pages. To have two directory pages you just need to specify a different variable to use for the second using !define MUI_DIRECTORYPAGE_VARIABLE INSTDIR2 (say).<br />
      <br />
      Stu</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">xma</span><br />
      <span class="post-time small text-muted">9th July 2009 09:55 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Thanks for your reply i really appreciate :)<br />
      <br />
      I know that we can add another MUI_PAGE_DIRECTORY but really want to put the two DirRequest in the same page.<br />
      <br />
      So i might use the second solution of JP but I am not familiar to callback function and plugin.<br />
      <br />
      If i use this plugin does the path of the folder will appear in the textbox? will INSTDIR2 be automatically the variable for the second DirRequest ?<br />
      <br />
      I'm going to have a look of the plugin and try to use it.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">jpderuiter</span><br />
      <span class="post-time small text-muted">9th July 2009 11:59 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">With the callback function I meant using the ButtonEvent Plugin I mentioned before.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">xma</span><br />
      <span class="post-time small text-muted">9th July 2009 12:42 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Ok, as I'm not very familiar with plugin i decide to create my own custom directory page to replace the default MUI_DIRECTORY_PAGE.<br />
      <br />
      Now I would like to know how can I insert a default path to each DirRequest (Like $InstDIR before)<br />
      <br />
      I tried with MUI_INSTALLATIONS_WRITE but it doesn't seem to work.<br />
      <br />
      Do you have any idea ?<br />
      Thank you</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">MSG</span><br />
      <span class="post-time small text-muted">9th July 2009 12:55 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Assuming you're using nsDialogs to create your custom page: You can set the default path in the dir request creation macro, like this:<br />
      <br />
      ${NSD_CreateDirRequest} 10u 85u 210u 12u "YOUR DEFAULT GOES HERE"</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">jpderuiter</span><br />
      <span class="post-time small text-muted">9th July 2009 12:56 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">You can set the root of a DirRequest in an InstallOptions ini file with</p>
      <pre>
<code>!insertmacro MUI_INSTALLOPTIONS_WRITE "CustomDialog.ini" "Field 1" "Root" "c:\Program Files\xyz"</code>
</pre>(Note the MUI_INSTALLOPTIONS_WRITE instead of MUI_INSTALLATIONS_WRITE).<br />
      <br />
      However, I recommend using nsDialogs instead of InstallOptions .
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">xma</span><br />
      <span class="post-time small text-muted">9th July 2009 13:51 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">I am using IstallOptions... Sorry<br />
      <br />
      I have tried to put a Root parameter but i still can't see the path in the TextBox !<br />
      <br />
      However I would like to put a variable instad of "C:\...\" like INSTDIR for exemple. I need to switch the both default path if the user is admin or not.<br />
      <br />
      Thanks again for your help :)</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">xma</span><br />
      <span class="post-time small text-muted">9th July 2009 15:28 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">If I have understand,<br />
      MUI_INSTALLOPTIONS_WRITE allow to write dynamicly in the ini file :<br />
      <br />
      !insertmacro MUI_INSTALLOPTIONS_WRITE "NewDirectoryPage.ini" "Field 2" "Text" "$INSTDIR"<br />
      <br />
      !insertmacro MUI_INSTALLOPTIONS_DISPLAY "NewDirectoryPage"<br />
      <br />
      So after this instruction the textbox of the DirRequest should show my INSTDIR value... but it doesn't happen.<br />
      <br />
      Do you have any explaination ?<br />
      <br />
      I extract the ini file in my function .oninit</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
      <span class="post-time small text-muted">9th July 2009 16:49 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">You have some inconsistencies here. Are you extracting as NewDirectoryPage.ini or NewDirectoryPage? You are writing to NewDirectoryPage.ini but showing NewDirectoryPage.<br />
      <br />
      Stu</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">xma</span><br />
      <span class="post-time small text-muted">9th July 2009 17:30 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Exactly I was writing the wrong file... Hard day...<br />
      Thank you</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">jpderuiter</span><br />
      <span class="post-time small text-muted">9th July 2009 17:54 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">And you should set the "State" field to $INSTDIR instead of the "Text" field.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">xma</span><br />
      <span class="post-time small text-muted">10th July 2009 09:50 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Thanks JP i changed that.<br />
      So now in my DirRequest textbox i have $PROGRAMFILES or $APPDATA depending on the user status. But the user can still change the directory and i can't get dynamicly the path he entered. I would like his choice become the $INSTDIR variable. I tried with this :<br />
      <br />
      !insertmacro MUI_INSTALLOPTIONS_READ $INSTDIR "NewDirectoryPage" "Field 2" "State"<br />
      <br />
      but that doesn't change anything.<br />
      <br />
      Is there a way to do this ?</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
      <span class="post-time small text-muted">10th July 2009 10:25 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">That will work if done from the leave function. If that is what you are doing then post some code. You can also put in some message boxes to pause the installer then you can look in %TEMP%\ns???.tmp\* to find your INI file.<br />
      <br />
      Stu</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">xma</span><br />
      <span class="post-time small text-muted">10th July 2009 10:37 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Thanks<br />
      Exactly what i tried and it works now !!</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">xma</span><br />
      <span class="post-time small text-muted">13th July 2009 10:42 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">I really want to thank you for your help :)!<br />
      I put this discussion to resolve</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">xma</span><br />
      <span class="post-time small text-muted">13th July 2009 10:44 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">[RESOLVE]<i>Originally posted by xma</i><br />
      <b>I really want to thank you for your help :)!<br />
      I put this discussion to resolve</b> [/QUOTE]</p>
    </div>
    <hr />

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]>
  </script>
</body>
</html>
