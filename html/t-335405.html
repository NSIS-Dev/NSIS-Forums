<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="Hide a string in registry by XOR'ing it" />

  <title>Hide a string in registry by XOR'ing it - NSIS Forums</title>
  <script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script>
  <!-- Bootstrap core CSS -->

  <link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css" />
  <link rel="stylesheet" href="../css/style.css" type="text/css" /><!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!--[if lt IE 9]>
                <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
                <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->
</head>

<body>
  <div class="container">
    <!-- Put navigation bar here -->

    <ol class="breadcrumb">
      <li><a href="../index.html" class="glyphicon glyphicon-home"></a></li>

      <li><a href="f-65.html">NSIS Discussion</a></li>

      <li class="active">Hide a string in registry by XOR'ing it</li>
    </ol>

    <p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=335405">Hide a string in registry by XOR'ing it</a></p><br />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">eveningnick</span><br />
      <span class="post-time small text-muted">29th September 2011 23:56 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>Hide a string in registry by XOR'ing it</strong><br />
      hello!<br />
      Could you please advice me how to hide a string-password that i'm saving in the system registry from a NSIS installer? I don't want to store it as a plain text. So i was hoping i could encode or encrypt it<br />
      I don't know how to do it in nsis. In C i'd just wrote some loop that iterates throuh the string and does something to it so i can be reversed later to its original state.<br />
      There are no examples on the internet for NSIS, and the only suitable function i know in NSIS that could be used for encryption - xor - does not operate on strings (the password i need to 'hide' is a string) but only on integers.<br />
      <br />
      Forgive me my impudence, but could you post some example routine that takes a string as its input and outputs a transformed symbol by symbol string?<br />
      <br />
      Thank you!</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
      <span class="post-time small text-muted">30th September 2011 00:18 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">How about storing a hash of the password rather than the password itself?<br />
      <br />
      Stu</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">eveningnick</span><br />
      <span class="post-time small text-muted">30th September 2011 10:42 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Stu,<br />
      <br />
      Hashing sounds nice but it seems to be even more complicated than simple XORing of the string.<br />
      NSIS script unfortunately isn't like a C program.<br />
      <br />
      My problem is that, despite knowing how to do that in C, I don't even where to start with NSIS scripting. There are no examples on this topic (all I found were related to decorating a string like adding quotation marks).<br />
      <br />
      There are no loops (like for(; ;) in C), and the symbols are not treated by their ascii codes in a NSIS script.<br />
      <br />
      If there are existing routines for hashing a string and you are aware of them, I'd be thankful if you shared. If there are none, could you at least point me on how this kind of string processing is done usually?<br />
      Thank you!</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
      <span class="post-time small text-muted">30th September 2011 11:56 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Search Google for "NSIS hash" or "NSIS sha1". You can do loops in NSIS using Goto or LogicLib. Again, search.<br />
      <br />
      Edit: And if you know C so well then you can write a plug-in or write a DLL and call it with the System plug-in.<br />
      <br />
      Stu</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">T.Slappy</span><br />
      <span class="post-time small text-muted">30th September 2011 12:52 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"></p>

      <blockquote>
        <small>Originally posted by eveningnick</small><br />
        Stu,<br />
        <br />
        Hashing sounds nice but it seems to be even more complicated than simple XORing of the string.<br />
        NSIS script unfortunately isn't like a C program.<br />
        <br />
        My problem is that, despite knowing how to do that in C, I don't even where to start with NSIS scripting. There are no examples on this topic (all I found were related to decorating a string like adding quotation marks).<br />
        <br />
        There are no loops (like for(; ;) in C), and the symbols are not treated by their ascii codes in a NSIS script.<br />
        <br />
        If there are existing routines for hashing a string and you are aware of them, I'd be thankful if you shared. If there are none, could you at least point me on how this kind of string processing is done usually?<br />
        Thank you!
      </blockquote>This is big mistake! NSIS language is very similar to C! In headers [logic, win, etc] you have many functionality. Of course some stuff is very hard to achieve, but with scripts and system plug-in you can do what you want.<br />
      Loops [for, while] are of course supported!<br />
      Try to implement simple Caesar cipher <a href="http://en.wikipedia.org/wiki/Caesar_cipher" target="_blank">http://en.wikipedia.org/wiki/Caesar_cipher</a> in NSIS - it is only few lines of code.
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">eveningnick</span><br />
      <span class="post-time small text-muted">30th September 2011 15:13 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"></p>

      <blockquote>
        <small>Originally posted by Afrow UK</small><br />
        Search Google for "NSIS hash" or "NSIS sha1". You can do loops in NSIS using Goto or LogicLib. Again, search.<br />
        <br />
        Edit: And if you know C so well then you can write a plug-in or write a DLL and call it with the System plug-in.<br />
        <br />
        Stu
      </blockquote>i've tried this one: <a href="http://nsis.sourceforge.net/Crypto_plug-in" target="_blank">http://nsis.sourceforge.net/Crypto_plug-in</a><br />
      getting an error "<b>CryptAcquireContext=0x80090016</b>" on my Windows 7.<br />
      Well fine, there's a note on the website "it may be broken". Apparently it is :).<br />
      <br />
      Tried also md5dll plugin:<br />
      <br />
      md5dll::GetMD5String "md5me"<br />
      Pop $0<br />
      MessageBox MB_OK "$0"<br />
      <br />
      which displays only one symbol instead of 16-bytes (I was expecting 32 symbols, 2 symbols per hex code of every byte of the hash). But i get a message box with text something like "c".<br />
      Why does it happen? Should I convert this $0 into a string representation explicitly?
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">LoRd_MuldeR</span><br />
      <span class="post-time small text-muted">30th September 2011 15:30 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">NSIS doesn't need explicit conversions.<br />
      <br />
      I did not use the MD5 plug-in before, but maybe the first <b>pop</b> doesn't give you the hash? (Just guessing)</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
      <span class="post-time small text-muted">30th September 2011 16:25 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">If you are using Unicode NSIS you need to use a Unicode build of the plug-in. Also, how about: <a href="http://nsis.sourceforge.net/NsisCrypt_plug-in" target="_blank">http://nsis.sourceforge.net/NsisCrypt_plug-in</a><br />
      <br />
      Stu</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">eveningnick</span><br />
      <span class="post-time small text-muted">30th September 2011 16:26 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">i finally used another plugin (nsis crypto) which returns md5 hash in base 64. Nothing else worked.<br />
      Thanks everyone.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">eveningnick</span><br />
      <span class="post-time small text-muted">30th September 2011 16:27 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"></p>

      <blockquote>
        <small>Originally posted by Afrow UK</small><br />
        If you are using Unicode NSIS you need to use a Unicode build of the plug-in. Also, how about: <a href="http://nsis.sourceforge.net/NsisCrypt_plug-in" target="_blank">http://nsis.sourceforge.net/NsisCrypt_plug-in</a><br />
        <br />
        Stu
      </blockquote>Yes, that's what I used.<br />
      Thx Stu
    </div>
    <hr />

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]>
  </script>
</body>
</html>
