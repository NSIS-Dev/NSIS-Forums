<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="description" content="MUI installer initial directory &amp; other queries"><title>MUI installer initial directory &amp; other queries - NSIS Forums</title><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script><link rel="preload" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css" as="style" onload="this.rel='stylesheet'"><link rel="preload" href="../css/style.css" as="style" onload="this.rel='stylesheet'"><noscript><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css"><link rel="stylesheet" href="../css/style.css"></noscript><script>!function(a){"use strict";var b=function(b,c,d){function e(a){return h.body?a():void setTimeout(function(){e(a)})}function f(){i.addEventListener&&i.removeEventListener("load",f),i.media=d||"all"}var g,h=a.document,i=h.createElement("link");if(c)g=c;else{var j=(h.body||h.getElementsByTagName("head")[0]).childNodes;g=j[j.length-1]}var k=h.styleSheets;i.rel="stylesheet",i.href=b,i.media="only x",e(function(){g.parentNode.insertBefore(i,c?g:g.nextSibling)});var l=function(a){for(var b=i.href,c=k.length;c--;)if(k[c].href===b)return a();setTimeout(function(){l(a)})};return i.addEventListener&&i.addEventListener("load",f),i.onloadcssdefined=l,l(f),i};"undefined"!=typeof exports?exports.loadCSS=b:a.loadCSS=b}("undefined"!=typeof global?global:this);!function(a){if(a.loadCSS){var b=loadCSS.relpreload={};if(b.support=function(){try{return a.document.createElement("link").relList.supports("preload")}catch(b){return!1}},b.poly=function(){for(var b=a.document.getElementsByTagName("link"),c=0;c<b.length;c++){var d=b[c];"preload"===d.rel&&"style"===d.getAttribute("as")&&(a.loadCSS(d.href,d,d.getAttribute("media")),d.rel=null)}},!b.support()){b.poly();var c=a.setInterval(b.poly,300);a.addEventListener&&a.addEventListener("load",function(){b.poly(),a.clearInterval(c)}),a.attachEvent&&a.attachEvent("onload",function(){a.clearInterval(c)})}}}(this);</script></head><body><div class="container"><ol class="breadcrumb"><li><a href="../index.html" class="glyphicon glyphicon-home"></a></li><li><a href="f-65.html">NSIS Discussion</a></li><li class="active">MUI installer initial directory &amp; other queries</li></ol><p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=150505">MUI installer initial directory &amp; other queries</a></p><br><div class="post"><p class="post-meta"><span class="post-author text-primary">red-oct</span><br><span class="post-time small text-muted">26th September 2003 14:03 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>MUI installer initial directory &amp; other queries</strong><br>Hi there, im new to all this. (a.k.a being a cabbage :igor: )<br>Im using the MUI installer, What im trying to do is use the installer to copy a bunch of files to the users selected directory.<br><br>The problem with this is that I want the installer to look in the directory it is in and copy the files from there to the chosen destination folder.<br><br>What i have so far is:<br><br>;Installer Sections<br><br>Section "jag.exe" SecCopyUI<br><br>;Add your stuff here<br><br>SectionIn RO<br>SetOutPath "$INSTDIR"<br>File "C:\jag.exe"<br>File "C:\readme.txt"<br><br>So obviously the installer can only copy the files if they are in the C:\ root firectory. Could someone tell me what the command is for it to use the directory the installer is located in?<br><br>Also for the MUI_FINISHPAGE I want to add an extra check box option in addition to "Run program"that will have "View Readme".<br><br>How do I do this? Yes I know that this must be blatantly obvious, but some simple steps on how to do so would be great please.<br><br>Thanks in advance for trying to help a hopeless newbie.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Joost Verburg</span><br><span class="post-time small text-muted">26th September 2003 14:42 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">* Add a directory page, use InstallDir and in the section, use SetOutPath.<br><br>* A finish page 'Show Readme' option is available. Please see the Modern UI Readme.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">red-oct</span><br><span class="post-time small text-muted">26th September 2003 15:34 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Wow, thanks for the prompt reply!<br>Okay let me see if im getting this right, but doesnt SetOutPath refer to the path that the user chooses for the installation files?<br>This is the code I have:<br>;Configuration<br><br>;General<br>OutFile "JAG-Installer.exe"<br><br>;Folder selection page<br>InstallDir "$PROGRAMFILES\${MUI_PRODUCT}"<br><br>;Remember install folder<br>InstallDirRegKey HKCU "Software\${MUI_PRODUCT}" ""<br><br>Because I need the command that will tell the installer to look in the directory its being run for the files that it has to copy. If im wrong,would the code look like this?<br><br><br><b>InstallDir "SetOutPath"</b><br><br>Thanks for the help with the readme, I thought that I would have to manually insert a check box and what not in the ini file. That would have been a mission. Thanks for your help Joost</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">kichik</span><br><span class="post-time small text-muted">26th September 2003 17:19 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">To get the directory the installer resides in use $EXEDIR. This variable is a runtime variable, which means it will only have a value on runtime.<br><br>SetOutPath is a command that sets $OUTDIR (and creates the directory if needed). $OUTDIR is the directory files will be extracted to using the File instruction, unless /oname was used and then the path specified there will be used. Therefore, InstallDir "SetOutPath" isn't what you're looking for. It will in fact result in an empty $INSTDIR.<br><br>If you want to copy files from the installer's directory (for example, if the installer is on a CD along with some other files) use something like this:<br><br>CopyFiles $EXEDIR\myFile.dat $INSTDIR<br><br>This will copy myFile to the installation directory chosen by the user (if you used a directory page) or the default directory if the user chose not to change the installation directory or you didn't use a directory selection page.<br><br>If you want to compress files from the directory the script is into the installer you don't have to use a full path. The working directory is automatically set to the directory in which the script is so you shouldn't worry about where it really is.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">red-oct</span><br><span class="post-time small text-muted">27th September 2003 03:17 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Thanks for that kichik. That was exactly what I was looking for.<br>Unfortuntely this has now caused another problem in MUI_DIRECTORYPAGE. It no longer shows a proper value for space required. It shows 0.0 kb.<br><br>Is there anyway to get it to read the entire directory that the install files are located, add up all the file sizes and display the total in the MUI_DIRECTORYPAGE for space required?<br><br>Thanks again for the invaluable help kichik :)</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">kichik</span><br><span class="post-time small text-muted">27th September 2003 10:27 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">You can use <a href="http://nsis.sourceforge.net/Docs/Chapter4.html#4.6.1.1" target="_blank">AddSize</a> or <a href="http://nsis.sourceforge.net/Docs/Chapter4.html#4.9.13.7" target="_blank">SectionGet/SetSize</a> if you're using the latest CVS version. AddSize is a compile command. You'd probably want to write an external program that would create an include file with AddSize in it, according to the size it will calculate. You can execute this program using !system and then include the file using !include.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">red-oct</span><br><span class="post-time small text-muted">28th September 2003 03:45 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Okay ive decided to go with the SetSize command, since I know the size of the files and they're not really going to change.<br>Heres the question. What file is the present command for 'space required' located in? I had a look through the NSIS directory and subdirectories but couldn't find anything.<br><br>Just wanted to know so that I could just replace the present space command with SetSpace.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">kichik</span><br><span class="post-time small text-muted">28th September 2003 12:31 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">SectionGetSize and SectionSetSize are both runtime commands. If the file sizes are not going to change AddSize will be much simpler. If you know the size of the files just add a line such as this to the appropriate section:<br><br>AddSize 25984</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">red-oct</span><br><span class="post-time small text-muted">28th September 2003 13:13 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Where does it go though? Its for the MUI_DIRECTORY page so where do i add it in? Can I just add it into the main .nsi file?</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">kichik</span><br><span class="post-time small text-muted">28th September 2003 13:28 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">It goes in a section. The directory page calculates the sum of all selected sections and displays that. Here's an example:<br><br>Section "Install bla"<br>AddSize 4531<br>CopyFiles this.dat $INSTDIR<br>SectionEnd</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">red-oct</span><br><span class="post-time small text-muted">28th September 2003 14:31 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">You cannot imagine what a great help youve been kichik! If youre even in New Zealand give me a yell :)</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">kichik</span><br><span class="post-time small text-muted">28th September 2003 14:45 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Will do :)</p></div><hr><div class="footer"><p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p></div></div><script type="text/javascript" src="../js/highlight.pack.js" async></script><script type="text/javascript">//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]></script></body></html>