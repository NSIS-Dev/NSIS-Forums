<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="description" content="Can't register dll and ocx"><title>Can't register dll and ocx - NSIS Forums</title><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script><link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css"><link rel="stylesheet" href="../css/style.css" type="text/css"><!--[if lt IE 9]><script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script><script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script><![endif]--></head><body><div class="container"><ol class="breadcrumb"><li><a href="../index.html" class="glyphicon glyphicon-home"></a></li><li><a href="f-65.html">NSIS Discussion</a></li><li class="active">Can't register dll and ocx</li></ol><p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=221853">Can't register dll and ocx</a></p><br><div class="post"><p class="post-meta"><span class="post-author text-primary">Romka</span><br><span class="post-time small text-muted">19th July 2005 09:32 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>Can't register dll and ocx</strong><br>Please help!<br>I try to register DLL and OCX:<br><br><font size="1">!insertmacro InstallLib REGDLL $ALREADY_INSTALLED REBOOT_NOTPROTECTED msvcr70.dll $SYSDIR\msvcr70.dll $SYSDIR</font><br><br>Compile log:<br><br><font size="1">!insertmacro: InstallLib<br>warning: unknown variable/constant "ALREADY_INSTALLED" detected, ignoring (macro:InstallLib:49)<br>!insertmacro: end of InstallLib<br>SectionEnd</font><br><br>Installation log:<br><br><font size="1">Can’t find symbol: DllRegisterServer</font><br><br>DLL copy into sysdir but not register. What I do wrong?</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Instructor</span><br><span class="post-time small text-muted">19th July 2005 10:35 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"></p><pre>
<code><font color="darkblue">Var ALREADY_INSTALLED</font><br>!insertmacro InstallLib REGDLL $ALREADY_INSTALLED REBOOT_NOTPROTECTED msvcr70.dll $SYSDIR\msvcr70.dll $SYSDIR</code>
</pre>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">deguix</span><br>
      <span class="post-time small text-muted">19th July 2005 12:00 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">"Var" instruction has to be outside sections and functions and prefferably at the top of your script.</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Romka</span><br>
      <span class="post-time small text-muted">19th July 2005 15:36 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Thanks!<br>
      Var ALREADY_INSTALLED is working.:)<br>
      But Installation log:<br>
      Can’t find symbol: DllRegisterServer:(<br>
      One more questions please!:rolleyes:<br>
      I can’t find in user manual how to register fonts files(*.ttf).</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br>
      <span class="post-time small text-muted">19th July 2005 20:46 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">That means the DLL shouldn't be registered. For fonts, search the forum and the wiki.</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Comperio</span><br>
      <span class="post-time small text-muted">20th July 2005 05:15 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">In your first example, you mention the file 'msvcr70.dll'.<br>
      <br>
      This is a file included with MS .NET Framework, which I'm fairly certain is protected by Windows File Protection. This means that the only way you'd be able to install it is via Microsoft's own installation (or Windows installer merge module).<br>
      <br>
      Or I could be wrong...</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">JCD29</span><br>
      <span class="post-time small text-muted">15th November 2005 23:44 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">you can use : upgradeDLL<br>
      !insertmacro UpgradeDLL XXX.dll "$PROGRAMFILES\XXX.dll" "$INSTDIR\Temp"<br>
      <br>
      this macro exists in example given by the NSIS installer</p>
    </div>
    <hr>

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]></script></body></html>