<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="Custom Page refreshes slow" />

  <title>Custom Page refreshes slow - NSIS Forums</title>
  <script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script>
  <!-- Bootstrap core CSS -->

  <link rel="stylesheet" type="text/css" href="//netdna.bootstrapcdn.com/bootswatch/3.0.1/readable/bootstrap.min.css" />
  <link rel="stylesheet" href="../css/style.css" type="text/css" /><!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!--[if lt IE 9]>
                <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
                <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->
</head>

<body>
  <div class="container">
    <!-- Put navigation bar here -->

    <ol class="breadcrumb">
      <li><a href="../index.html" class="glyphicon glyphicon-home"></a></li>

      <li><a href="f-65.html">NSIS Discussion</a></li>

      <li class="active">Custom Page refreshes slow</li>
    </ol>

    <p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=257825">Custom Page refreshes slow</a></p><br />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">carlosfocker</span><br />
      <span class="post-time small text-muted">18th October 2006 18:18 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>Custom Page refreshes slow</strong><br />
      I got an interesting one for you. I am running a sql script that query's a record in a table located by default in the master database. I pop the response back to see if it was successful. This is used to verify that SQL is install and running. (This does work well for me but If anyone knows a better way to do this please inform). The sa password and sql server name is retrieved from the user using a custom page. Once the user leaves that page the sql script is ran using a function called componentsLeave:<br />
      <br />
      -------------------------------------<br />
      nsExec::ExecToStack "$SYSDIR\cmd.exe /c osql.exe /c -U $SqlUser -P $SqlPass -S $SQLSVR -i \ $PLUGINSDIR\SqlTest.sql"<br />
      <br />
      Pop $0<br />
      <br />
      ${If} $0 = 1<br />
      <br />
      MessageBox MB_OK "Unable to connect to SQL Server. Please check the username and$\npassword, or \ verify that SQL Server is working properly."<br />
      <br />
      abort<br />
      ${EndIf}<br />
      ---------------------------------------------------<br />
      <br />
      The problem is that the page seems to freeze or become stuck for sometimes up to a minute. If the user clicks away from the installer and then clicks agian on the installer, the page refreshes faster. Kind of weird. Any ideas?</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
      <span class="post-time small text-muted">18th October 2006 18:20 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Nope. You can display a banner though with the Banner plugin.<br />
      <br />
      -Stu</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">carlosfocker</span><br />
      <span class="post-time small text-muted">18th October 2006 20:30 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">I tried MXSBanner but doesn't seem to work in a function. When you destroy the banner it crashes the installer. EBanner seems to be for images(which i want to avoid using)and is for use in a section. Any suggestion on displaying a message(no buttons) in a the componentsLeave function thats run after the user clicks next.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
      <span class="post-time small text-muted">18th October 2006 21:08 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">The standard Banner plugin is included with NSIS.<br />
      <br />
      -Stu</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">carlosfocker</span><br />
      <span class="post-time small text-muted">18th October 2006 21:29 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">your right, im srry. That documentation is hard to locate sometimes :). thank you</p>
    </div>
    <hr />

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]>
  </script>
</body>
</html>
