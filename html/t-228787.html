<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="Calling third-party dll using Next button on custom page" />

  <title>Calling third-party dll using Next button on custom page - NSIS Forums</title>
  <script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script>
  <!-- Bootstrap core CSS -->

  <link rel="stylesheet" type="text/css" href="//netdna.bootstrapcdn.com/bootswatch/3.0.1/readable/bootstrap.min.css" />
  <link rel="stylesheet" href="../css/style.css" type="text/css" /><!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!--[if lt IE 9]>
                <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
                <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->
</head>

<body>
  <div class="container">
    <!-- Put navigation bar here -->

    <ol class="breadcrumb">
      <li><a href="../index.html" class="glyphicon glyphicon-home"></a></li>

      <li><a href="f-65.html">NSIS Discussion</a></li>

      <li class="active">Calling third-party dll using Next button on custom page</li>
    </ol>

    <p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=228787">Calling third-party dll using Next button on custom page</a></p><br />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">MishaWTW</span><br />
      <span class="post-time small text-muted">19th October 2005 08:27 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>Calling third-party dll using Next button on custom page</strong><br />
      Hi. I've created custom page with some edit controls and want to call function from my DLL when Next button is pressed. Then strange things happen. If there is no controls with NOTIFY flag on my page, but Next (which "has" NOTIFY always), installer freezes/crashes while calling the function. If I add some button with NOTIFY flag, it's all ok. It doesn't matter, if I use that added button, or no.<br />
      NSIS 2.09<br />
      <br />
      There is my custom page leave function:<br />
      <br />
      Function leaveserver<br />
      ReadINIStr $1 "$PLUGINSDIR\setup.ini" "Settings" "State"<br />
      StrCmp $1 0 Exit<br />
      Abort<br />
      Exit:<br />
      Call CheckSQL<br />
      StrCmp $1 0 +2 +1<br />
      Abort<br />
      FunctionEnd<br />
      <br />
      ...and CheckSQL func...<br />
      <br />
      Function CheckSQL<br />
      SetPluginUnload alwaysoff<br />
      SetOutPath $TEMP<br />
      Delete $TEMP\InstallDll.dll<br />
      IfFileExists $TEMP\InstallDll.dll +2 +1<br />
      File DLL\InstallDll.dll ; copy dll there<br />
      ReadINIStr $1 "$PLUGINSDIR\setup.ini" "Field 5" "State"<br />
      ReadINIStr $2 "$PLUGINSDIR\setup.ini" "Field 6" "State"<br />
      ReadINIStr $3 "$PLUGINSDIR\setup.ini" "Field 1" "State"<br />
      System::Call '$TEMP\InstallDll::Mess(t,t,t) i(r1,r2,r3).r1'<br />
      SetPluginUnload manual<br />
      System::Free 0<br />
      FunctionEnd<br />
      <br />
      Current workaround: Added button with NOTIFY flag, disabled and hidden below edit control.<br />
      ps: Sorry for my buggy English.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
      <span class="post-time small text-muted">20th October 2005 19:22 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Can you attach a complete minimal example and more information? I can't reproduce the problem. Maybe it also happens with some plug-ins that come with the default package?</p>
    </div>
    <hr />

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]>
  </script>
</body>
</html>
