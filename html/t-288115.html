<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="How to create my own plugin for NSIS" />

  <title>How to create my own plugin for NSIS - NSIS Forums</title><!-- Bootstrap core CSS -->
  <link rel="stylesheet" type="text/css" href="//netdna.bootstrapcdn.com/bootswatch/3.0.1/readable/bootstrap.min.css" />
  <link rel="stylesheet" href="../css/style.css" type="text/css" /><!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!--[if lt IE 9]>
                <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
                <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->
</head>

<body>
  <div class="container">
    <!-- Put navigation bar here -->

    <ol class="breadcrumb">
      <li><a href="../index.html" class="glyphicon glyphicon-home"></a></li>

      <li><a href="f-65.html">NSIS Discussion</a></li>

      <li class="active">How to create my own plugin for NSIS</li>
    </ol>

    <p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=288115">How to create my own plugin for NSIS</a></p><br />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Pawel</span><br />
      <span class="post-time small text-muted">7th March 2008 19:03 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>How to create my own plugin for NSIS</strong><br />
      Hello,<br />
      I wanna ask you how to create own plugin for NSIS. I want to write it in Delphi. I found an example in NSIS\src\Contrib\ExDLL folder, but unfortunately I don't understand it well (it doeasnt do what I want, as I understand only shows messagebox with user variable).<br />
      <br />
      Maybe I will write what I want to do. I want to create a plugin that will show (on a custom page), a page with Treeview, with checkboxes. If I check some node it will write info about it to ini file.<br />
      <br />
      How can I display in custom page a standard window with treeview component, using delphi plugin?<br />
      Please, if someone of you use delphi, give me some advice.<br />
      Regards,<br />
      -Pawel</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
      <span class="post-time small text-muted">7th March 2008 20:16 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">You can use <a href="http://nsis.sf.net/EmbeddedLists_plug-in" target="_blank">EmbeddedLists plug-in</a> for tree views.<br />
      Writing to the log on the other hand is something you need to do on page leave.<br />
      <br />
      Stu</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Pawel</span><br />
      <span class="post-time small text-muted">7th March 2008 20:37 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"></p>

      <blockquote>
        <i>Originally posted by Afrow UK</i><br />
        <b>You can use <a href="http://nsis.sf.net/EmbeddedLists_plug-in" target="_blank">EmbeddedLists plug-in</a> for tree views.<br />
        Writing to the log on the other hand is something you need to do on page leave.<br />
        <br />
        Stu</b>
      </blockquote>Hello Stu,<br />
      I have tested your embeddedlists plugin. But, I want to create something that we can see on MUI_PAGE_COMPONENTS -<br />
      the combobox and treeview. On this treeview I have to show items with checkboxes - to do system files associations - if user select (select checkbox) some node, it will be written to ini file and then parsed.<br />
      <br />
      As I understand it is impossible to do with your plugin, because I can display only treeview - I want some more (info text, treeview, combobox).<br />
      Am I wrong?<br />
      Regards,<br />
      -Pawel
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
      <span class="post-time small text-muted">7th March 2008 21:03 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">That's right, it only shows a tree view. Another option is to try InstallOptionsEx. nsDialogs will also allow you work but you'd need to do a bit of work using SendMessage in your NSIS script. Otherwise, writing your own plug-in is the way forward.<br />
      <br />
      Stu</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Pawel</span><br />
      <span class="post-time small text-muted">10th March 2008 21:14 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">OK, I am using InstallOptionsEx. But I have problems with treeview items.<br />
      <br />
      I am creating treview on custom page using this code in ini file:<br />
      <br /></p>
      <pre>
<span style="color: #007700">***91;</span><span style="color: #0000BB">Field4</span><span style="color: #007700">***93;
<br /></span><span style="color: #0000BB">Type</span><span style="color: #007700">=</span><span style="color: #0000BB">TreeView
<br />Left</span><span style="color: #007700">=</span><span style="color: #0000BB">10
<br />Right</span><span style="color: #007700">=-</span><span style="color: #0000BB">10
<br />Top</span><span style="color: #007700">=</span><span style="color: #0000BB">37
<br />Bottom</span><span style="color: #007700">=-</span><span style="color: #0000BB">9
<br />Flags</span><span style="color: #007700">=</span><span style="color: #0000BB">CHECKBOXES</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">showcheckboxysontreeview
<br />StateImageList</span><span style="color: #007700">=</span><span style="color: #0000BB">simple</span><span style="color: #007700">.</span><span style="color: #0000BB">bmp</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">bitmap</span><span style="color: #007700">for</span><span style="color: #0000BB">checkboxes
<br />ListItems</span><span style="color: #007700">=</span><span style="color: #0000BB">ParentItem_1</span><span style="color: #007700">{</span><span style="color: #0000BB">ChildItem_1</span><span style="color: #007700">{</span><span style="color: #0000BB">ChildItem_1_1</span><span style="color: #007700">|</span><span style="color: #0000BB">ChildItem_1_2</span><span style="color: #007700">}|</span><span style="color: #0000BB">ChildItem_2</span><span style="color: #007700">{</span><span style="color: #0000BB">ChildItem_2_1</span><span style="color: #007700">|</span><span style="color: #0000BB">ChildItem_2_2</span><span style="color: #007700">}}</span><span style="color: #0000BB">ParentItem_2</span><span style="color: #007700">{</span><span style="color: #0000BB">ChildItem_1</span><span style="color: #007700">{</span><span style="color: #0000BB">ChildItem_1_1</span><span style="color: #007700">|</span><span style="color: #0000BB">ChildItem_1_2</span><span style="color: #007700">}|</span><span style="color: #0000BB">ChildItem_2</span><span style="color: #007700">{</span><span style="color: #0000BB">ChildItem_2_1</span><span style="color: #007700">|</span><span style="color: #0000BB">ChildItem_2_2</span><span style="color: #007700">}}
<br /></span><span style="color: #0000BB">State</span><span style="color: #007700">=</span><span style="color: #0000BB">4</span><span style="color: #007700">{</span><span style="color: #0000BB">4</span><span style="color: #007700">{</span><span style="color: #0000BB">1</span><span style="color: #007700">|</span><span style="color: #0000BB">0</span><span style="color: #007700">}|</span><span style="color: #0000BB">4</span><span style="color: #007700">{</span><span style="color: #0000BB">0</span><span style="color: #007700">|</span><span style="color: #0000BB">1</span><span style="color: #007700">}}</span><span style="color: #0000BB">4</span><span style="color: #007700">{</span><span style="color: #0000BB">4</span><span style="color: #007700">{</span><span style="color: #0000BB">1</span><span style="color: #007700">|</span><span style="color: #0000BB">1</span><span style="color: #007700">}|</span><span style="color: #0000BB">4</span><span style="color: #007700">{</span><span style="color: #0000BB">0</span><span style="color: #007700">|</span><span style="color: #0000BB">0</span><span style="color: #007700">}}
</span>
</pre>Using this I want to have this tree:<br />
      <pre>
<code>ParentItem_1</code><span style="color: #007700">-&gt;</span><span style="color: #0000BB">nocheckbox</span><span style="color: #007700">(</span><span style="color: #0000BB">4</span><span style="color: #007700">)
<br /></span><span style="color: #0000BB">ChildItem_1</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">nocheckbox</span><span style="color: #007700">(</span><span style="color: #0000BB">4</span><span style="color: #007700">)
<br /></span><span style="color: #0000BB">ChildItem_1_1</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">selectedcheckbox</span><span style="color: #007700">(</span><span style="color: #0000BB">1</span><span style="color: #007700">)
<br /></span><span style="color: #0000BB">ChildItem_1_2</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">unselectedcheckbox</span><span style="color: #007700">(</span><span style="color: #0000BB">0</span><span style="color: #007700">)
<br /></span><span style="color: #0000BB">ChildItem_2</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">nocheckbox</span><span style="color: #007700">(</span><span style="color: #0000BB">4</span><span style="color: #007700">)
<br /></span><span style="color: #0000BB">ChildItem_2_1</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">unselectedcheckbox</span><span style="color: #007700">(</span><span style="color: #0000BB">0</span><span style="color: #007700">)
<br /></span><span style="color: #0000BB">ChildItem_2_2</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">selectedcheckbox</span><span style="color: #007700">(</span><span style="color: #0000BB">1</span><span style="color: #007700">)
<br /></span><span style="color: #0000BB">ParentItem_2</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">nocheckbox</span><span style="color: #007700">(</span><span style="color: #0000BB">4</span><span style="color: #007700">)
<br /></span><span style="color: #0000BB">ChildItem_1</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">nocheckbox</span><span style="color: #007700">(</span><span style="color: #0000BB">4</span><span style="color: #007700">)
<br /></span><span style="color: #0000BB">ChildItem_1_1</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">selectedcheckbox</span><span style="color: #007700">(</span><span style="color: #0000BB">1</span><span style="color: #007700">)
<br /></span><span style="color: #0000BB">ChildItem_1_2</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">selectedcheckbox</span><span style="color: #007700">(</span><span style="color: #0000BB">1</span><span style="color: #007700">)
<br /></span><span style="color: #0000BB">ChildItem_2</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">nocheckbox</span><span style="color: #007700">(</span><span style="color: #0000BB">4</span><span style="color: #007700">)
<br /></span><span style="color: #0000BB">ChildItem_2_1</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">unselectedcheckbox</span><span style="color: #007700">(</span><span style="color: #0000BB">0</span><span style="color: #007700">)
<br /></span><span style="color: #0000BB">ChildItem_2_2</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">unselectedcheckbox</span><span style="color: #007700">(</span><span style="color: #0000BB">0</span><span style="color: #007700">)
</span>
</pre>It is a tree view with 3 levels. I got problems with checkboxys. It doeasn't work correctly for me. Am I writing correctly the definition ListItems=... ?<br />
      <br />
      In help I see this information:<br />
      <br />
      { - Starts a new tree level. The item to the left of this character is the parent item.<br />
      | - Separates an item from another.<br />
      } - Ends a tree level.<br />
      <br />
      Example:<br />
      ListItems=MyParentItem{MyChildItem1|MyChildItem2}<br />
      State=MyParentItem{MyChildItem2}<br />
      <br />
      If CHECKBOXES is specified, it specifies the state of all items checkboxes with state flags (not item names). In this case, you have to follow the exact same structure of the items as on ListItems INI value name. Example:<br />
      ListItems=MyParentItem{MyChildItem1|MyChildItem2}<br />
      State=0{11|4}<br />
      Item state flags have to be joined with "bitwise OR" before writing to the INI file. Example:<br />
      11 = 0x0B = Checked + Read-Only + Bold.<br />
      <br />
      Then put it like this in the State INI value:<br />
      State=0{11|4}<br />
      <br />
      <br />
      <br />
      Please, can someone of you check my Listitems line and write correctly 3 levels treeview with checkboxys (only on 3 level)?<br />
      The second problem is how to detect that user selected for example 3 node and checked checkbox?<br />
      <br />
      Thanks for any help.<br />
      -Pawel
    </div>
    <hr />

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]>
  </script>
</body>
</html>
