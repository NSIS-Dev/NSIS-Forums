<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="upgrading msvcrt.dll" />

  <title>upgrading msvcrt.dll - NSIS Forums</title>
  <script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script>
  <!-- Bootstrap core CSS -->

  <link rel="stylesheet" type="text/css" href="//netdna.bootstrapcdn.com/bootswatch/3.0.1/readable/bootstrap.min.css" />
  <link rel="stylesheet" href="../css/style.css" type="text/css" /><!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!--[if lt IE 9]>
                <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
                <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->
</head>

<body>
  <div class="container">
    <!-- Put navigation bar here -->

    <ol class="breadcrumb">
      <li><a href="../index.html" class="glyphicon glyphicon-home"></a></li>

      <li><a href="f-65.html">NSIS Discussion</a></li>

      <li class="active">upgrading msvcrt.dll</li>
    </ol>

    <p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=68361">upgrading msvcrt.dll</a></p><br />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">jamesrf</span><br />
      <span class="post-time small text-muted">11th December 2001 15:32 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>upgrading msvcrt.dll</strong><br />
      Hi guys,<br />
      <br />
      To those that it may concern: Good work chaps!<br />
      <br />
      My question: What is the definitive way of upgrading dlls such as msvcrt.dll and mfc42.dll? Don't the dlls need to be copied to the system directory on reboot, and then registered? The thread about CompareDLLVersions was useful but petered out at the end.<br />
      <br />
      I would be very grateful to whoever gives me the answer!<br />
      <br />
      Cheers,<br />
      James:p</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Edgewize</span><br />
      <span class="post-time small text-muted">11th December 2001 16:43 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">To be perfectly honest, this is a bit of a pain regardless of what installer you use. There are all sorts of version conflicts and possible future scenarios that make replacing MSVCRT.DLL a very dangerous proposition.<br />
      <br />
      I just link statically when I build. You would think that it defeats the purpose of having these libraries, but it doesn't increase EXE size very much unless you rely heavily on MFC.<br />
      <br />
      That said, I think that Microsoft has a self-extracting redistributable binary somewhere. You can just include that whole self-extracting EXE in your NSIS project and ExecWait it. There is some command-line flag to make it quiet (ie, no message boxes)... try passing it /? and see what it says.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Joost Verburg</span><br />
      <span class="post-time small text-muted">11th December 2001 18:11 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Hi!<br />
      <br />
      I just found the solution for my DLL problemes (CompareDLLVersion topic).<br />
      <br />
      Renaming the files will be done before runonce in the registery, so you should:<br />
      <br />
      File DLLNAME.TMP<br />
      Rename /REBOOTOK DLLNAME.TMP DLLNAME.DLL<br />
      <br />
      Add to runonce in the registry (see my topic): regsvr32.exe /s DLLNAME.DLL (/s makes it silent, without messagebox) :)<br />
      <br />
      To check if the DLL on the system is older, see the GetLocalDLLVersion, GetDLLVersion info in my topic.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">F. Heidenreich</span><br />
      <span class="post-time small text-muted">12th December 2001 09:27 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">I think the best solution for DLL-Hell with system dlls (like mfc42.dll or msvcrt.dll) is to copy your versions of the dlls in your program directory. The programm directory is the first place the system searches for them.<br />
      <br />
      ~ Florian</p>
    </div>
    <hr />

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]>
  </script>
</body>
</html>
