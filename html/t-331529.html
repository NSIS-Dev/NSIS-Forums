<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="description" content="Hotkey Function Request"><title>Hotkey Function Request - NSIS Forums</title><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script><link rel="preload" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css" as="style" onload="this.rel='stylesheet'"><link rel="preload" href="../css/style.css" as="style" onload="this.rel='stylesheet'"><noscript><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css"><link rel="stylesheet" href="../css/style.css"></noscript><script>!function(a){"use strict";var b=function(b,c,d){function e(a){return h.body?a():void setTimeout(function(){e(a)})}function f(){i.addEventListener&&i.removeEventListener("load",f),i.media=d||"all"}var g,h=a.document,i=h.createElement("link");if(c)g=c;else{var j=(h.body||h.getElementsByTagName("head")[0]).childNodes;g=j[j.length-1]}var k=h.styleSheets;i.rel="stylesheet",i.href=b,i.media="only x",e(function(){g.parentNode.insertBefore(i,c?g:g.nextSibling)});var l=function(a){for(var b=i.href,c=k.length;c--;)if(k[c].href===b)return a();setTimeout(function(){l(a)})};return i.addEventListener&&i.addEventListener("load",f),i.onloadcssdefined=l,l(f),i};"undefined"!=typeof exports?exports.loadCSS=b:a.loadCSS=b}("undefined"!=typeof global?global:this);!function(a){if(a.loadCSS){var b=loadCSS.relpreload={};if(b.support=function(){try{return a.document.createElement("link").relList.supports("preload")}catch(b){return!1}},b.poly=function(){for(var b=a.document.getElementsByTagName("link"),c=0;c<b.length;c++){var d=b[c];"preload"===d.rel&&"style"===d.getAttribute("as")&&(a.loadCSS(d.href,d,d.getAttribute("media")),d.rel=null)}},!b.support()){b.poly();var c=a.setInterval(b.poly,300);a.addEventListener&&a.addEventListener("load",function(){b.poly(),a.clearInterval(c)}),a.attachEvent&&a.attachEvent("onload",function(){a.clearInterval(c)})}}}(this);</script></head><body><div class="container"><ol class="breadcrumb"><li><a href="../index.html" class="glyphicon glyphicon-home"></a></li><li><a href="f-65.html">NSIS Discussion</a></li><li class="active">Hotkey Function Request</li></ol><p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=331529">Hotkey Function Request</a></p><br><div class="post"><p class="post-meta"><span class="post-author text-primary">jwhough</span><br><span class="post-time small text-muted">14th June 2011 03:23 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>Hotkey Function Request</strong><br>Hi,<br><br>I was wondering if someone could make a basic plugin that would call a function whenever a hotkey is pressed. I've scoured the web in search of a solution and thought I found one with <a href="http://nsis.sourceforge.net/NsDialogs_FAQ" target="_blank">this</a> but it only worked when the window was open. I want a system-wide hotkey function that will work, including when the installer is minimized with NotifyIcon. I also looked at <a href="http://forums.winamp.com/showthread.php?t=310224" target="_blank">this other topic</a> but I couldn't follow it. I would have posted in the Feature Requests tracker, but I was thinking I could get it faster if asked here.<br><br>Thanks in advance,<br>jw</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">MSG</span><br><span class="post-time small text-muted">14th June 2011 06:48 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">As interesting as this idea is, are you sure that this is necessary? An installer is only run once, during installation. What's the added value of global hotkey support in something the user only uses one time in their OS lifetime? Considering that the hotkey support has to be explained to the user (adding to user confusion) and that this introduces one more point for things to go wrong (it's not a trivial affair so cross-OS support may be a problem), why bother introducing such a feature when its use is only very very small?</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">T.Slappy</span><br><span class="post-time small text-muted">14th June 2011 07:01 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Maybe he means something like pressing Enter to continue on next page?<br>This is already implemented, so as standard Ctrl+C for text etc...</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">MSG</span><br><span class="post-time small text-muted">14th June 2011 12:00 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">He asks for global hotkeys specifically, so not what you're thinking about.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">jwhough</span><br><span class="post-time small text-muted">14th June 2011 22:26 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>Not an installer</strong><br>I probably should have specified that I'm not writing an installer, but a whole program in NSIS. Here's some (outdated) screenshots:<br><a href="http://www.mediafire.com/imageview.php?quickkey=kxgaeo1j8b08daa&amp;thumb=4" target="_blank">First One</a><br><a href="http://www.mediafire.com/imageview.php?quickkey=2rw99z6kbtmtlwq&amp;thumb=4" target="_blank">Second One</a><br><br>I know NSIS isn't the best language to do this kind of stuff, but the only other language I know is Java, but I don't know how to do much with it. I just feel more comfortable with NSIS.<br><br>Oh, and I forgot to mention, could this be in ANSI? I'd do Unicode, but some of the plugins are ANSI only.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">T.Slappy</span><br><span class="post-time small text-muted">15th June 2011 08:44 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"></p><blockquote><small>Originally posted by jwhough</small><br>I probably should have specified that I'm not writing an installer, but a whole program in NSIS. Here's some (outdated) screenshots:<br><a href="http://www.mediafire.com/imageview.php?quickkey=kxgaeo1j8b08daa&amp;thumb=4" target="_blank">First One</a><br><a href="http://www.mediafire.com/imageview.php?quickkey=2rw99z6kbtmtlwq&amp;thumb=4" target="_blank">Second One</a><br><br>I know NSIS isn't the best language to do this kind of stuff, but the only other language I know is Java, but I don't know how to do much with it. I just feel more comfortable with NSIS.<br><br>Oh, and I forgot to mention, could this be in ANSI? I'd do Unicode, but some of the plugins are ANSI only.</blockquote>Actually this is quit normal idea, I made also several tools with NSIS :)<br>It is like new-simple-script-programming language.</div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">MSG</span><br><span class="post-time small text-muted">15th June 2011 12:26 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Using NSIS to create a memory-resident background app is... Well, kind of silly. But yeah, whatever rocks your boat I guess. My point remains that a global hotkey plugin is probably much more trouble than it's worth, because NSIS is for making installers and installers shouldn't need it.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Anders</span><br><span class="post-time small text-muted">15th June 2011 15:11 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Well there is a tray plugin so it is not like we already don't have "useless" plugins.<br><br>Anyway, your best option is to write a new plugin, the other option is to use the subclass plugin, but that requires a bit of work and win32 knowledge.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">jwhough</span><br><span class="post-time small text-muted">15th June 2011 17:13 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">I was able, however to register a hotkey using the System plugin:<br></p><pre>
<code><br>GetDlgItem $0 $HWNDPARENT 1<br>MessageBox MB_OK "$0" ; returns random numeber<br><br>System::Call 'User32::RegisterHotKey(l $0, i 1, t MOD_ALT, t 0x42) i .r2'<br>MessageBox MB_OK "$2" ; returns nonzero (good) (1 for me)<br><br>; Store whatever's pressed then do stuff<br><br>;(other stuff)<br><br>; And then:<br>        <br>System::Call 'User32::UnregisterHotKey(l $0, i 1) i .r2'<br>MessageBox MB_OK "$2" ; returns nonzero (good) (1 for me)<br></code>
</pre><br>
      <br>
      All I need to do is figure out how to catch whenever somebody activates the hotkey.
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">jwhough</span><br>
      <span class="post-time small text-muted">15th June 2011 17:41 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Scratch everything.<br>
      <br>
      I decided I'll just write a script in autohotkey, which I'm teaching myself atm.<br>
      <br>
      And if anyone by chance started this, thanks, but I think I'll manage ;)</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">T.Slappy</span><br>
      <span class="post-time small text-muted">16th June 2011 07:21 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"></p>

      <blockquote>
        <small>Originally posted by MSG</small><br>
        Using NSIS to create a memory-resident background app is... Well, kind of silly. But yeah, whatever rocks your boat I guess. My point remains that a global hotkey plugin is probably much more trouble than it's worth, because NSIS is for making installers and installers shouldn't need it.
      </blockquote>Yeah, it is a really silly :)<br>
      This reminds me some game made with Startcraft 2 editor.<br>
      The game was a FPS, it is fantastic what can be done with simple tools....<br>
      Also few years ago I saw a chess built on Quake engine, it was totally useless but awesome!
    </div>
    <hr>

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script type="text/javascript" src="../js/highlight.pack.js" async>
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]></script></body></html>