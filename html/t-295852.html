<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="React on on Custom page" />

  <title>React on on Custom page - NSIS Forums</title><!-- Bootstrap core CSS -->
  <link rel="stylesheet" type="text/css" href="//netdna.bootstrapcdn.com/bootswatch/3.0.1/readable/bootstrap.min.css" />
  <link rel="stylesheet" href="../css/style.css" type="text/css" /><!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!--[if lt IE 9]>
                <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
                <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->
</head>

<body>
  <div class="container">
    <!-- Put navigation bar here -->

    <ol class="breadcrumb">
      <li><a href="../index.html" class="glyphicon glyphicon-home"></a></li>

      <li><a href="f-65.html">NSIS Discussion</a></li>

      <li class="active">React on on Custom page</li>
    </ol>

    <p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=295852">React on on Custom page</a></p><br />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">monti0505</span><br />
      <span class="post-time small text-muted">12th August 2008 17:39 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>React on on Custom page</strong><br />
      Hello,<br />
      <br />
      I created a custom page which looks like that:<br />
      <br /></p>
      <pre>
<code><br />; Ini file generated by the HM NIS Edit IO designer.<br />[Settings]<br />NumFields=6<br /><br />[Field 1]<br />Type=Groupbox<br />Text=Licence<br />Left=16<br />Right=227<br />Top=3<br />Bottom=78<br /><br />[Field 2]<br />Type=RadioButton<br />Text=Demo<br />Left=26<br />Right=102<br />Top=32<br />Bottom=42<br /><br />[Field 3]<br />Type=RadioButton<br />Text=Single<br />Left=26<br />Right=102<br />Top=46<br />Bottom=57<br /><br />[Field 4]<br />Type=Text<br />Left=72<br />Right=202<br />Top=60<br />Bottom=73<br /><br />[Field 5]<br />Type=Label<br />Text=Lizenzcode:<br />Left=26<br />Right=70<br />Top=62<br />Bottom=70<br /><br />[Field 6]<br />Type=RadioButton<br />Text=Floating<br />Left=26<br />Right=102<br />Top=17<br />Bottom=27<br /><br /><br /></code>
</pre><br />
      <br />
      In my Installer I want that the textfield is only enabled wenn the Radiobutton with Single is clicked.<br />
      <br />
      I tried to change color for test purposes but nothing happend:<br />
      <br />
      <pre>
<code><br />!include LogicLib.nsh<br />Page custom licInfoDlg  MyCustomLeave<br /><br /><br />Function MyCustomLeave<br />  # Get control window handle.<br />  !insertmacro INSTALLOPTIONS_READ $R0 "licInfoDlg.ini" "Field 1" "HWND"<br />  # Check if text has been entered in field 1.<br />  !insertmacro INSTALLOPTIONS_READ $R1 "licInfoDlg.ini" "Field 4" "State"<br />  # Make field background red!<br />  ${If} $R1 == ""<br />    SetCtlColors $R1 0x000000 0xFF0000<br />    Abort # Go back to page.<br />  # Reset field colours.<br />  ${Else}<br />    SetCtlColors $R1 0x000000 0xFFFFFF<br />  ${EndIf}<br />FunctionEnd<br /></code>
</pre><br />
      <br />
      This is of course not the whole code but the main for the Custom Page.<br />
      How can I implement that the textfield becomes enabled or disabled when a special Radio button is clicked?<br />
      <br />
      I looked for a tutorial but the one on NSIS Page did not help me.<br />
      <br />
      I hope you can give me an Idea or or a code snippet how to make the script work.
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Comperio</span><br />
      <span class="post-time small text-muted">12th August 2008 17:59 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">You need to add the notify flag to the radio buttons and then create a callback function to enable/disable the text field.<br />
      <br />
      A good example included with NSIS:<br />
      ${NSISDIR}\Examples\InstallOptions\testnotify.nsi</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">monti0505</span><br />
      <span class="post-time small text-muted">13th August 2008 08:59 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Thank you for the tipp. Its a good example script.<br />
      <br />
      <br />
      Regards</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">monti0505</span><br />
      <span class="post-time small text-muted">14th August 2008 11:58 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Hi all,<br />
      <br />
      i changed my script to as it is done in the example script.<br />
      But the textfield 4 still is not disabled when another radiobutton than the Radiobutton 3 is clicked.<br />
      <br />
      I want to become the field disabled when NOT radiobutton 3 is clicked.<br />
      <br />
      Can someone tell me why it does not function? I do not found the failure. The script can be compiled. So there can not be an syntax error or somethink like that.<br />
      <br />
      Here you can see the code:<br />
      <br /></p>
      <pre>
<code><br />; Ini file generated by the HM NIS Edit IO designer.<br />[Settings]<br />NumFields=6<br /><br />[Field 1]<br />Type=Groupbox<br />Text=Licence<br />Left=16<br />Right=227<br />Top=3<br />Bottom=78<br /><br />[Field 2]<br />Type=RadioButton<br />Text=Demo<br />Left=26<br />Right=102<br />Top=32<br />Bottom=41<br />Flags=NOTIFY<br /><br />[Field 3]<br />Type=RadioButton<br />Text=Single<br />Left=26<br />Right=102<br />Top=46<br />Bottom=57<br />Flags=NOTIFY<br />State=1<br /><br />[Field 4]<br />Type=Text<br />Left=72<br />Right=202<br />Top=60<br />Bottom=73<br />Flags=<br /><br />[Field 5]<br />Type=Label<br />Text=Lizenzcode:<br />Left=26<br />Right=70<br />Top=62<br />Bottom=70<br /><br />[Field 6]<br />Type=RadioButton<br />Text=Floating<br />Left=26<br />Right=102<br />Top=17<br />Bottom=27<br />Flags=NOTIFY<br /><br /><br /></code>
</pre><br />
      <br />
      <br />
      The part of the script where the field should be disabled:<br />
      <pre>
<code><br />Page custom licInfoDlg  MyCustomLeave<br /><br />Function MyCustomLeave<br />  # Get control window handle.<br />  ReadINIStr $0 "licinfodlg.ini" "Settings" "State"<br />  StrCmp $0 3 Single  ; <br />  <br />  <br />  Single:<br />  ReadINIStr $0 "licinfodlg.ini" "Field 3" "State"<br />  ReadINIStr $1 "licinfodlg.ini" "Field 4" "HWND"<br />  EnableWindow $1 $0<br />  ReadINIStr $1 "licinfodlg.ini" "Field 4" "HWND2"<br />  EnableWindow $1 $0<br />  <br />   StrCmp $0 0 0 +3<br /><br />     WriteINIStr "licinfodlg.ini" "Field 4" "Flags" "DISABLED"<br />     Goto +2<br /><br />     WriteINIStr "licinfodlg.ini" "Field 4" "Flags" ""<br />     Abort<br />  <br />  <br />FunctionEnd<br /><br /></code>
</pre><br />
      <br />
      I hope someone can help me.
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">monti0505</span><br />
      <span class="post-time small text-muted">14th August 2008 13:03 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Hello all,<br />
      <br />
      i modified the code a little bit to test what the cause could be:<br />
      <br /></p>
      <pre>
<code><br />Function MyCustomLeave<br />  # Get control window handle.<br />  ReadINIStr $0 "licinfodlg.ini" "Settings" "State"<br />  StrCmp $0 0 done  ; Next button?<br />  StrCmp $0 3 Single  ; "Install support for X"?<br />  <br />  <br />  Single:<br />  ReadINIStr $0 "licinfodlg.ini" "Field 3" "State"<br />  ReadINIStr $1 "licinfodlg.ini" "Field 4" "HWND"<br />  EnableWindow $1 $0<br />  ReadINIStr $1 "licinfodlg.ini" "Field 4" "HWND2"<br />  EnableWindow $1 $0<br />  <br />   StrCmp $0 0 +2<br />  <br />         MessageBox MB_ICONEXCLAMATION|MB_OK "You must select at least one install option!" ;WriteINIStr "licinfodlg.ini" "Field 4" "Flags" "DISABLED"<br />      Abort ;Goto +2<br />      <br />     ;WriteINIStr "licinfodlg.ini" "Field 4" "Flags" ""<br />     Abort<br />  <br />  done:<br /> <br />  <br />FunctionEnd<br /></code>
</pre><br />
      In this case the MessageBox appears<br />
      <br />
      But when I replace the " MessageBox MB_ICONEXCLAMATION|MB_OK "You must select at least one install option!"<br />
      <br />
      with<br />
      <br />
      "WriteINIStr "licinfodlg.ini" "Field 4" "Flags" "DISABLED" "<br />
      <br />
      the field4 is still enabled. What does I have to do to disable the fierld4 when on radiobutton Single is clicked???
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Comperio</span><br />
      <span class="post-time small text-muted">14th August 2008 20:29 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">EnableWindow should have 2 paramaters: The first is the HWND of the control, the 2nd is a one (1) or zero (0).<br />
      <br />
      Setting the flags is good only for when returning to the page (like if the user goes back, it will remember the state).<br />
      <br />
      Also, use include LogicLib.nsh to make things easier.<br />
      <br />
      Have a look at the attached. (I didn't test, so hopefully, I got it right. But there should be enough comments for you to understand.)<br />
      <br />
      EDIT: Since you already had a radio button with the state set, there would never be a situation in which no selection was made. But, I did add a check to verify that if the 3rd option was checked, it must have something in the box before proceeding.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">monti0505</span><br />
      <span class="post-time small text-muted">15th August 2008 09:10 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Hi!<br />
      <br />
      Thank you for the example script.<br />
      <br />
      I have done this now (its not the whole script):<br />
      <br /></p>
      <pre>
<code><br />   !insertmacro INSTALLOPTIONS_READ $R1 "licInfoDlg.ini" "Settings" "State"<br />   ReadINIStr $2 "licinfodlg.ini" "Field 3" "State"<br /><br />${If} $1 != 0<br />  ReadINIStr $3 "licinfodlg.ini" "Field 4" "HWND"<br /><br />    ${If} $2 = 1<br />      ; radio button selected so enable the field<br />       MessageBox MB_OK "radio button selected so enable the field"<br />      WriteINIStr "licinfodlg.ini" "Field 4" "Flags" ""<br />      EnableWindow $3 1<br />    ${Else}<br />      ; not selected, so disable field<br />        MessageBox MB_OK " ; not selected, so disable field"<br />      WriteINIStr "licinfodlg.ini" "Field 4" "Flags" "DISABLED"<br />      EnableWindow $3 0<br />    ${EndIf}<br /></code>
</pre><br />
      <br />
      But all the time the message "" ; not selected, so disable field" appears. It means it goes into the ELSE whatever radiobutton I click.<br />
      I enabled the NOTIFY flag for all radio buttons but nothing changed.<br />
      Any idea?
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
      <span class="post-time small text-muted">15th August 2008 11:58 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Use !insertmacro INSTALLOPTIONS_READ/WRITE, not Read/WriteINIStr. You have already done so with the first line!?<br />
      <br />
      Stu</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Comperio</span><br />
      <span class="post-time small text-muted">16th August 2008 02:41 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Just to elaborate a bit:<br />
      <br />
      The main difference between using the INSTALLOPTIONS_READ/Write macros and the normal Read/WriteIniStr function are that the read/write macros will read the files from $PLUGINSDIR. Calling like you did will read the INI from whatever the current working directory is (which in your case is probably the same directory that your compiled EXE lives in), which is often NOT the directory that gets used by pages during runtime.<br />
      <br />
      I often just use the normal Read/WriteIniStr functions, but I can see how this may be confusing to others. Afrow's suggestion of using the InstallOptions_Read/Write macros for all page functions leaves less room for error (and should have been my first suggestion.) Sorry for the confusion.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">monti0505</span><br />
      <span class="post-time small text-muted">17th August 2008 17:39 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"></p>

      <blockquote>
        <i>Originally posted by Comperio</i><br />
        <b>Just to elaborate a bit:<br />
        <br />
        The main difference between using the INSTALLOPTIONS_READ/Write macros and the normal Read/WriteIniStr function are that the read/write macros will read the files from $PLUGINSDIR.</b>
      </blockquote>Hi,<br />
      <br />
      but I never deploy the $PLUGINSDIR but only the executable file which is compiled from the nsis script.<br />
      How can then the INSTALLOPTIONS_READ/Write macros work?
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">ZmAn3</span><br />
      <span class="post-time small text-muted">18th August 2008 00:27 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">thank you so much that seems to be working great any idea on the start in folder part of the shortcuts properties?<br />
      <br />
      thanks again<br />
      <br />
      sorry posted in wrong place :/</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
      <span class="post-time small text-muted">18th August 2008 13:12 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">You are supposed to extract your INI file using the INSTALLOPTIONS_EXTRACT macro then those macros will work. It is all described in the InstallOptions readme.<br />
      <br />
      Stu</p>
    </div>
    <hr />

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]>
  </script>
</body>
</html>
