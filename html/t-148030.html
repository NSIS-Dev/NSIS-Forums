<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="description" content="detecting a logical drive"><title>detecting a logical drive - NSIS Forums</title><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script><link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css"><link rel="stylesheet" href="../css/style.css" type="text/css"></head><body><div class="container"><ol class="breadcrumb"><li><a href="../index.html" class="glyphicon glyphicon-home"></a></li><li><a href="f-65.html">NSIS Discussion</a></li><li class="active">detecting a logical drive</li></ol><p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=148030">detecting a logical drive</a></p><br><div class="post"><p class="post-meta"><span class="post-author text-primary">mdm</span><br><span class="post-time small text-muted">3rd September 2003 20:02 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>detecting a logical drive</strong><br>I can use FindFirst or IfFileExists with an argument of "D:\*.*" and find if there is something in the D:\ drive. What about if D:\ exists, but is empty? How can I detect it?<br><br>mdm</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">kichik</span><br><span class="post-time small text-muted">4th September 2003 14:04 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">You can use:<br><br>System::Call "kernel32::GetDriveTypeA(t 'D:\') i .s"<br>Pop $0<br>StrCmp $0 0 doesntExist<br>StrCmp $0 1 doesntExist<br># exists code here<br>doesntExist:<br># doesn't exist code here</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">mdm</span><br><span class="post-time small text-muted">4th September 2003 16:42 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Thanks,<br>mdm</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">atsuk</span><br><span class="post-time small text-muted">6th October 2003 17:48 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">hi!<br>but what about detecting all logical drivers(HD's)?<br>I would need something, that would detect, if computer has more than one logical driver, and if it has more, then put all avaliable drivers to variables.<br>And if it is possible, what i asked, then maybe this scipt could put driver of default program files($PROGRAMFILES) to sertain variable.<br><br>i really hope, that it is possible..tnx</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Joost Verburg</span><br><span class="post-time small text-muted">6th October 2003 17:52 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">That is possible. Check MSDN for the GetDriveType return values.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">atsuk</span><br><span class="post-time small text-muted">6th October 2003 18:22 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">ok, but i'm really not familiar to MSDN...haven't used it :S<br>could you please help me with a part of nsi script?</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br><span class="post-time small text-muted">6th October 2003 18:30 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">These are the return values from the MSDN page on "Using the GetDriveType Function" (<a href="http://msdn.microsoft.com/archive/default.asp?url=/archive/en-us/dnarvbtips/html/msdn_msdn165.asp" target="_blank">http://msdn.microsoft.com/archive/de...dn_msdn165.asp</a>)<br><br>Value / Drive Type<br>0 - Unknown media type<br>1 - No such root directory exists<br>DRIVE_REMOVABLE - Drive can be removed<br>DRIVE_FIXED - Drive cannot be removed<br>DRIVE_REMOTE - Network disk drive<br>DRIVE_CDROM - CD-ROM disk drive<br>DRIVE_RAMDISK - RAM disk drive<br><br>-Stu</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Joost Verburg</span><br><span class="post-time small text-muted">6th October 2003 18:47 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">DRIVE_CDROM = 5<br>DRIVE_FIXED = 3<br>DRIVE_RAMDISK = 6<br>DRIVE_REMOTE = 4<br>DRIVE_REMOVABLE = 2</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">kichik</span><br><span class="post-time small text-muted">6th October 2003 19:08 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">There is already a function on the Archive that does this for you, no need to reinvent the wheel:<br><br><a href="http://nsis.sourceforge.net/archive/viewpage.php?pageid=277" target="_blank">http://nsis.sourceforge.net/archive/...php?pageid=277</a></p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">deguix</span><br><span class="post-time small text-muted">6th October 2003 22:22 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"></p><blockquote>no need to reinvent the wheel</blockquote>Hehe.<br><br>Maybe I didn't add the DRIVE_RAMDISK = 6, DRIVE_REMOTE = 4. I didn't know they are from... If "More is better" I will add those at once today or tomorrow.</div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">atsuk</span><br><span class="post-time small text-muted">10th October 2003 21:20 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">hi..sry, but i expressed myself wrongly :$ what i really needed as a result was a names or letters of hard drives. for example, i have in my pc sutch driver letters:<br>A:\ - Floppy ; C:\ - HD ; D:\ - HD ; E:\ - HD ; F:\ - CD-R ; G:\ - CD-WR<br>(c:\ and d:\ are partitions of one hard driver). The results what i would need script to give are:<br>$R1 - a:\<br>$R2 - c:\<br>$R3 - d:\<br>$R4 - e:\<br>$R5 - f:\<br>$R6 - g:\<br>or if it is possible, then only letters of hard drivers (c:\ ; d:\ ; e:\ )<br>so, is this possible? tnx</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">deguix</span><br><span class="post-time small text-muted">10th October 2003 21:29 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">In the callback function:<br><br></p><blockquote>You can use any variables, but the $R0 have a function result, the drive letter detected.</blockquote>But to do this below, you have to include your code in this callback function, because the number of variables can vary, so:<br><br><pre>
<code>Function Callback<br><br>  # In your code, the variable $R0 will be the hard drive letter<br>  # detected<br><br>  # Push "go" if want to go<br>  # Push "stop" to stop<br><br>FunctionEnd</code>
</pre>The code will be executed EVERYTIME that detects a hard drive.
    </div>
    <hr>

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]></script></body></html>