<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="Restart Manager / Uninstaller" />

  <title>Restart Manager / Uninstaller - NSIS Forums</title>
  <script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script>
  <!-- Bootstrap core CSS -->

  <link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css" />
  <link rel="stylesheet" href="../css/style.css" type="text/css" /><!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!--[if lt IE 9]>
                <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
                <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->
</head>

<body>
  <div class="container">
    <!-- Put navigation bar here -->

    <ol class="breadcrumb">
      <li><a href="../index.html" class="glyphicon glyphicon-home"></a></li>

      <li><a href="f-65.html">NSIS Discussion</a></li>

      <li class="active">Restart Manager / Uninstaller</li>
    </ol>

    <p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=300537">Restart Manager / Uninstaller</a></p><br />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">winflight</span><br />
      <span class="post-time small text-muted">2nd December 2008 07:15 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>Restart Manager / Uninstaller</strong><br />
      My software must pass "OEM Ready Program" (like Windows logo Program).<br />
      <br />
      <a href="http://msdn.microsoft.com/en-us/windowsvista/cc315067.aspx" target="_blank">http://msdn.microsoft.com/en-us/wind.../cc315067.aspx</a><br />
      <br />
      However, the uninstaller of my softwareã€€which I made in NSIS fails on a test of Restart Manager.<br />
      <br />
      ---------------<br />
      3.1.1 : Verify the application is Restart Manager Aware<br />
      TEST STEPS:<br />
      For each Qualifying Applicationâ€™s main executable:<br />
      1. Launch the application or start the service if your application is a service.<br />
      2. Open the Windows Task Manager.<br />
      a. Click on the Processes tab or click on the Services tab if your application is a service.<br />
      b. From the View menu, select Select Columns.<br />
      c. Select the PID (Process Identifier) check box and click OK.<br />
      d. Click on Image Name to list all the current processes by name.<br />
      e. Find the application image name and make a note of its PID.<br />
      <br />
      3. Open an elevated command window (click Start / All Programs / Accessories, then right-click on Command Prompt and select Run as administrator).<br />
      4. Change directory to the directory that contains the Restart Manager Test tool.<br />
      5. In the command window type:<br />
      rmlogotest.exe dwPID<br />
      Where dwPID is the application's Process ID, obtained via Task Manager.<br />
      <br />
      <br />
      NOTES:<br />
      <br />
      1. The application must be idle and must not be running or performing any operations while performing this test case.<br />
      2. All applications must listen and respond to shutdown messages using the Restart Manager API quietly, without user interaction while idle in order to pass this test case.<br />
      3. The application or service must not cause an Access Violation and it must shutdown/restart safely.<br />
      4. Some applications require that a parameter be passed when the application is launched. If the application being testing requires that such a parameter be passed, then the application will need to be launched manually prior to starting this automated test.<br />
      5. Restart Manager shutdown messages are:<br />
      <br />
      WM_QUERYENDSESSION with LPARAM = ENDSESSION_CLOSEAPP(0x1)<br />
      GUI applications must respond (TRUE) immediately to prepare for a restart.<br />
      <br />
      WM_ENDSESSION with LPARAM = ENDSESSION_CLOSEAPP(0x1)<br />
      The application must shutdown within 5 seconds (20 seconds for services).<br />
      <br />
      CTRL_SHUTDOWN_EVENT<br />
      Console applications must shutdown immediately.<br />
      <br />
      ---------------<br />
      <br />
      My software has a short cut of the uninstallation in program menu.<br />
      <br />
      When the uninstaller is executed first, it displays message box.<br />
      And it starts uninstallation when I choose Yes.<br />
      What should the uninstaller of the software that I made in NSIS have done to pass an above test?</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Anders</span><br />
      <span class="post-time small text-muted">2nd December 2008 07:42 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">does this really apply to the installer/uninstaller? IIRC you must use .MSI to even apply to these programs. Anyway, you could probably register for the restart thing if you know the name of the api and call it with the system plugin. NSIS also tries to prevent a shutdown, look on the nsis wiki for a solution for that</p>
    </div>
    <hr />

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]>
  </script>
</body>
</html>
