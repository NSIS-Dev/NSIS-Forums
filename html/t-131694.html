<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="IsAdminDll question" />

  <title>IsAdminDll question - NSIS Forums</title><!-- Bootstrap core CSS -->
  <link rel="stylesheet" type="text/css" href="//netdna.bootstrapcdn.com/bootswatch/3.0.1/readable/bootstrap.min.css" />
  <link rel="stylesheet" href="../css/style.css" type="text/css" /><!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!--[if lt IE 9]>
                <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
                <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->
</head>

<body>
  <div class="container">
    <!-- Put navigation bar here -->

    <ol class="breadcrumb">
      <li><a href="../index.html" class="glyphicon glyphicon-home"></a></li>

      <li><a href="f-65.html">NSIS Discussion</a></li>

      <li class="active">IsAdminDll question</li>
    </ol>

    <p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=131694">IsAdminDll question</a></p><br />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">SprinklerHead</span><br />
      <span class="post-time small text-muted">14th April 2003 15:00 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>IsAdminDll question</strong><br />
      I just tried using IsAdminDll with my installer. Works great on my Win2000 box, but on a Win98 box it returns 0 (not admin) every time. I guess this is correct, but in my mind it seems like it should return 1 for Win95-based machines since users have complete control. I was expecting it to return 0 only for NT-based machines with few priveleges.<br />
      <br />
      But just to be sure, do I have this straight:<br />
      <br />
      - Perform a check to see if the machine is 95 or NT based.<br />
      <br />
      - If it is 95 based, skip the IsAdminDll check and proceed with the install.<br />
      <br />
      - If it is NT based, perform the IsAdminDll check. If 1 (admin) proceed, if 0 (not admin) abort.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Joost Verburg</span><br />
      <span class="post-time small text-muted">14th April 2003 15:13 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Instead of the IsAdminDll, you can use UserInfo.dll which is included in the latest NSIS versions.<br />
      <br />
      UserInfo fails and sets the error flag when there is no NT operating system. I think IsAdminDll has the same behavior, so you can use IfErrors.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">SprinklerHead</span><br />
      <span class="post-time small text-muted">14th April 2003 15:25 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">I'd rather not upgrade NSIS at the moment unless I have to. Can the UserInfo.dll be used with v2.0b0?</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Joost Verburg</span><br />
      <span class="post-time small text-muted">14th April 2003 15:31 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">It will probably work, but I highly recommend you to upgrade to the latest version. You only have to change some very small things in your script if you are using the Modern UI, otherwise you don't even have to change anything.<br />
      <br />
      Lots of bugs have been solved in later versions, using an outdated beta version is not a good idea.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">SprinklerHead</span><br />
      <span class="post-time small text-muted">15th April 2003 13:32 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">OK, I upgraded and hit a few snags (still using nextpage &amp; previouspage functions) but I think I have everything straight except for one thing. The v2.0b0 makensis.exe had the command line parameter /cd. It doesn't anymore I assume because it won't compile with /cd. Any clue as to what /cd did, because I can't remember and I am using it in my old batch file to create my installer. I took it out and it seems to work OK, but that has me a bit worried.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
      <span class="post-time small text-muted">15th April 2003 13:43 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">/CD made makensis change the working directory to the directory of the script. It is now the default and the switch has been replaced with /NOCD that will disable this behavior. You can safely remove the switch from your batch file.</p>
    </div>
    <hr />

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]>
  </script>
</body>
</html>
