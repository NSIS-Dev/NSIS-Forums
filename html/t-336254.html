<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="description" content="Error message - copy file in use"><title>Error message - copy file in use - NSIS Forums</title><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script><link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css"><link rel="stylesheet" href="../css/style.css" type="text/css"></head><body><div class="container"><ol class="breadcrumb"><li><a href="../index.html" class="glyphicon glyphicon-home"></a></li><li><a href="f-65.html">NSIS Discussion</a></li><li class="active">Error message - copy file in use</li></ol><p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=336254">Error message - copy file in use</a></p><br><div class="post"><p class="post-meta"><span class="post-author text-primary">Aaskilde</span><br><span class="post-time small text-muted">19th October 2011 10:09 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>Error message - copy file in use</strong><br>Hey,<br><br>I have created a installer there are copying some files to a directory for a server there can be running. If the server is running i get the error message: "Error opening file for writing".<br><br>Is there a way that i can get a message in example: "The file xxxx is in use, please shutdown the server and run the installer again" then they can cancel shutdown the server and run the installation.<br><br>-Aaskilde</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">MSG</span><br><span class="post-time small text-muted">19th October 2011 10:13 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">You cannot overwrite a file that is locked by another process (in your case, a server application). You must disable the process first. You can use for example the lockedlist plugin to check whether a file is locked. You can use this to (let the user) kill the application before you attempt to install.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Aaskilde</span><br><span class="post-time small text-muted">19th October 2011 11:02 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Ya okay that could be an idea i need to find out if they may execute the process when the installer asks.<br><br>But what if i just want a messagebox up instead of the error messages there is when the file is in use? Then with that messagebox you can cancel the install.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">MSG</span><br><span class="post-time small text-muted">19th October 2011 11:33 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">You could try to delete the file, and if that sets the error flag you can be relatively sure that you won't be able to overwrite it either. Then you can throw your own messagebox error.<br><br>(Strictly speaking it is possible to have overwrite ('modify') privileges while not having 'delete' privileges. If NSIS first opens the file before attempting the overwrite, modify rights would be sufficient. I doubt that's how it's done, but I'm not sure.)</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br><span class="post-time small text-muted">19th October 2011 11:42 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Another option is to replace on reboot:<br><a href="http://nsis.sourceforge.net/Install_on_reboot" target="_blank">http://nsis.sourceforge.net/Install_on_reboot</a><br><br>Stu</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Aaskilde</span><br><span class="post-time small text-muted">20th October 2011 08:10 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Okay the server that is using that file i need to overwrite is running on some of our users computers and if we can get passed it should not be restarted.<br><br>I was wondering if you could make something like this:<br><br>section "Messagebox1"<br><br>$INSTDIR<br><br>Messagebox MB_OK "The file xxxx is in use by the server. Please shut down the server and install again."<br>ok: Quit<br><br>sectionend<br><br>But is there maybe a command i can put in the section that checks if the file is in use?</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br><span class="post-time small text-muted">20th October 2011 10:32 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">As MSG said, try deleting the file. If that fails then you can show a message box. If you want to check earlier on (i.e. in .onInit) without deleting the file you can try appending to the file with FileOpen which should also fail.<br><br>Stu</p></div><hr><div class="footer"><p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p></div></div><script src="../js/highlight.pack.js" type="text/javascript"></script><script type="text/javascript">//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]></script></body></html>