<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="Stop and Start Website on IIS" />

  <title>Stop and Start Website on IIS - NSIS Forums</title>
  <script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script>
  <!-- Bootstrap core CSS -->

  <link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css" />
  <link rel="stylesheet" href="../css/style.css" type="text/css" /><!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!--[if lt IE 9]>
                <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
                <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->
</head>

<body>
  <div class="container">
    <!-- Put navigation bar here -->

    <ol class="breadcrumb">
      <li><a href="../index.html" class="glyphicon glyphicon-home"></a></li>

      <li><a href="f-65.html">NSIS Discussion</a></li>

      <li class="active">Stop and Start Website on IIS</li>
    </ol>

    <p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=317989">Stop and Start Website on IIS</a></p><br />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">whourdady</span><br />
      <span class="post-time small text-muted">25th March 2010 22:06 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>Stop and Start Website on IIS</strong><br />
      I am trying to stop and start the website for my web service so that after the install the correct version is running on IIS.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">msroboto</span><br />
      <span class="post-time small text-muted">26th March 2010 06:01 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">cscript %WinDir%\System32\iisweb.vbs /stop "%WebServer%"<br />
      <br />
      <br />
      cscript %WinDir%\System32\iisweb.vbs /start "%WebServer%"<br />
      <br />
      there might be another way but if you want to stop one web server this is it</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">whourdady</span><br />
      <span class="post-time small text-muted">26th March 2010 15:47 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Thank your for helping, this worked</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Rovastar</span><br />
      <span class="post-time small text-muted">30th March 2010 01:50 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Rather start and stop the web server you may find it better to start and stop teh site<br />
      <br />
      <a href="http://www.microsoft.com/technet/prodtechnol/WindowsServer2003/Library/IIS/d567048c-0171-4bc9-b084-b10f738fd964.mspx?mfr=true" target="_blank">http://www.microsoft.com/technet/pro....mspx?mfr=true</a><br />
      <br />
      For IIS 6.0</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">msroboto</span><br />
      <span class="post-time small text-muted">1st April 2010 05:37 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">The code I sent him does stop the site.<br />
      <br />
      There may be other ways for sure but that's what that does.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Rovastar</span><br />
      <span class="post-time small text-muted">4th April 2010 02:36 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">I was just pointing out that that will stop the web server service rather than a specfic site which the OP indicted he needed.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">whourdady</span><br />
      <span class="post-time small text-muted">4th May 2010 15:42 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Ok I am having problems running this inside of the installer in cmd prompt this works<br />
      <br />
      iisweb /stop WebService<br />
      <br />
      code in nullsoft is<br />
      <br />
      ExecWait '"cscript" iisweb.vbs /stop WebService'<br />
      <br />
      ive also tried<br />
      <br />
      ExecWait '"cscript" %WinDir%\System32\iisweb.vbs /stop "WebService"'<br />
      <br />
      any help is appreciated</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">whourdady</span><br />
      <span class="post-time small text-muted">4th May 2010 16:08 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Ok I have changed the code to<br />
      <br />
      PUSH $R0<br />
      ReadEnvStr $R0 "COMSPEC"<br />
      ExecWait '$R0 /C "iisweb.vbs /stop WebService"'<br />
      <br />
      but when i put<br />
      <br />
      ExecWait '$R0 /C cscript "iisweb.vbs /stop WebService"'<br />
      <br />
      it does not work correctly</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
      <span class="post-time small text-muted">4th May 2010 16:59 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Try:<br />
      ExecWait '"$R0" /C cscript iisweb.vbs /stop WebService'<br />
      <br />
      Also if you use /K instead of /C the command window will stay open so you can see any issues.<br />
      <br />
      Stu</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">whourdady</span><br />
      <span class="post-time small text-muted">4th May 2010 17:14 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">hey Afrow,<br />
      <br />
      with ExecWait '"$R0" /C cscript iisweb.vbs /stop WebService'<br />
      <br />
      the command window does not even open</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">whourdady</span><br />
      <span class="post-time small text-muted">4th May 2010 17:20 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">ExecWait '$R0 /K cscript "iisweb.vbs /stop WebService"'<br />
      <br />
      Ok the error i receive with this is<br />
      <br />
      Input Error: There is no file extension in C:\iisweb.vbs \stop WebService</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
      <span class="post-time small text-muted">4th May 2010 17:33 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"></p>

      <blockquote>
        <small>Originally posted by whourdady</small><br />
        hey Afrow,<br />
        <br />
        with ExecWait '"$R0" /C cscript iisweb.vbs /stop WebService'<br />
        <br />
        the command window does not even open
      </blockquote>It probably does but disappears before you see it. You need those quotes in case the path to cmd.exe contains spaces (it never should but you never know). Does using a full path to the VBS (in quotes) work?<br />
      <br />
      e.g.
      <pre>
<code>ExecWait `"$R0" /C cscript "C:\some\iisweb.vbs" /stop WebService`</code>
</pre>Edit: Everything after the /C is what you'd type in command prompt itself. If it doesn't work in command prompt then don't expect it to work on the command line either.<br />
      <br />
      Stu
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">whourdady</span><br />
      <span class="post-time small text-muted">4th May 2010 17:42 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">you are right, I just got it working as you posted it.<br />
      <br />
      ExecWait '$R0 /C cscript "%WinDir%\System32\iisweb.vbs" /stop WebService'<br />
      <br />
      I could not have gotten this without your help thanks Afrow UK</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
      <span class="post-time small text-muted">4th May 2010 18:09 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">You should use $SYSDIR\iisweb.vbs rather than that path.<br />
      <br />
      Stu</p>
    </div>
    <hr />

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]>
  </script>
</body>
</html>
