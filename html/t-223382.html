<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="description" content="Winmessages keystroke"><title>Winmessages keystroke - NSIS Forums</title><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script><link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css"><link rel="stylesheet" href="../css/style.css" type="text/css"></head><body><div class="container"><ol class="breadcrumb"><li><a href="../index.html" class="glyphicon glyphicon-home"></a></li><li><a href="f-65.html">NSIS Discussion</a></li><li class="active">Winmessages keystroke</li></ol><p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=223382">Winmessages keystroke</a></p><br><div class="post"><p class="post-meta"><span class="post-author text-primary">ender7584</span><br><span class="post-time small text-muted">4th August 2005 21:16 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>Winmessages keystroke</strong><br>Is there a way to send a window a specific keystroke using winmessages?<br><br>If not, then is there a way to get an "ok" button clicked?<br><br>I have been searching and cannot find much documentation (except in the case of closing a window), my ultimate goal is to keep selecting next (and a few radio buttons) on the "search the net for newer drivers" win XP system popup when a USB cable is inserted.<br><br>Basically I can get the class name of the window using win32 spy, but I'm unsure how to use the other paramaters of the findwindow and sendmessage commands. I also am totally lost with GetDlgItem, and do not know if I even need it (I have read the documentation, and still do not get it). Can someone please explain how to do this?<br><br>Thanks</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Comperio</span><br><span class="post-time small text-muted">6th August 2005 18:25 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">${WM_KEYDOWN} (from WinMessages.nsh) is probably what you need. However, I'm not 100% sure of the syntax--you may need to exeriment with it. <a href="http://msdn.microsoft.com/library/default.asp?url=/library/en-us/winui/winui/windowsuserinterface/userinput/keyboardinput/keyboardinputreference/keyboardinputmessages/wm_keydown.asp" target="_blank">This MSDN article</a> may help.<br><br>And I'm not sure about whether you'd need to use GetDlgItem or just FindWindow. (My guess is that the Window itself is what responds to keystrokes, so you'd probably just need to use FindWindow.)<br><br>The only thing I'd caution on is the fact that by sending keystrokes a window, you assume that the window is the same all the time. There could be that one time where the dialog is slightly different (becuase of a different serive pack, optional software, etc.) If you are not careful, you could end up sending the user down a totally different path than you indended.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Ender7584</span><br><span class="post-time small text-muted">8th August 2005 14:18 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Thanks for your reply. I tried a bunch of differant things with it, and nothing seemed to work. I ended up just writing a C applet that I can call from NSIS that will send the specified keystrokes. And yes, the problem with this, is if for some reason the user window is differant, which leads me to my next question.<br><br>Is there any way to, knowing the name of the hardware device, check to see that it is installed? Of course I will also be testing my code with every SP of XP (since it only needs to run on XP) but it would also be nice as a just in case factor to check to make sure it's installed. If for some reason it's not installed, I'll have to prompt the user to do a manual installation. Hopefully there is a way to do this, but I again cannot find it.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br><span class="post-time small text-muted">8th August 2005 14:35 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">This is the code you want to click Next I think:<br><br>SendMessage $HWNDPARENT ${WM_NOTIFY_OUTER_NEXT} 1 0<br><br>Haven't tried it, but it's what InstallOptions uses for Notify buttons.<br><br>-Stu</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Ender7584</span><br><span class="post-time small text-muted">8th August 2005 15:58 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Alright, Tested my C applet, and it's pretty stable.<br><br>Definatly my problem now would be trying to detect if a device is installed. My particular device i called "USB superlink adapter". It seems like you should be able to use the system plugin to call something in windows that will tell you if this device is installed on the system...but I can't find anything like it. Any ideas?</p></div><hr><div class="footer"><p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p></div></div><script src="../js/highlight.pack.js" type="text/javascript"></script><script type="text/javascript">//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]></script></body></html>