<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="PassDialog + Experience UI" />

  <title>PassDialog + Experience UI - NSIS Forums</title>
  <script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script>
  <!-- Bootstrap core CSS -->

  <link rel="stylesheet" type="text/css" href="//netdna.bootstrapcdn.com/bootswatch/3.0.1/readable/bootstrap.min.css" />
  <link rel="stylesheet" href="../css/style.css" type="text/css" /><!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!--[if lt IE 9]>
               <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
               <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
       <![endif]-->
</head>

<body>
  <div class="container">
    <!-- Put navigation bar here -->

    <ol class="breadcrumb">
      <li><a href="../index.html" class="glyphicon glyphicon-home"></a></li>

      <li><a href="f-65.html">NSIS Discussion</a></li>

      <li class="active">PassDialog + Experience UI</li>
    </ol>

    <p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=275826">PassDialog + Experience UI</a></p><br />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kallan06</span><br />
      <span class="post-time small text-muted">13th August 2007 08:24 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>PassDialog + Experience UI</strong><br />
      &nbsp; Hi all :D !<br />
      <br />
      I write you for an little problem.<br />
      i use this bottom code and when i call SerialPageShow function , my .exe crash ! why ? please help me<br />
      <br /></p>
      <pre>
<code>

<br /><br /><br />&gt;#Include
<br />&gt;!include LogicLib.nsh
<br />&gt;!include "XPUI.nsh"
<br />&gt;!include "Sections.nsh"
<br />&gt;!include "WinMessages.nsh"
<br /><br /><br /><br />&gt;;-----------------------------------------
<br />; General XPUI Settings
<br />XPStyle off
<br />&gt;#Splash screen bmp
<br />&gt;!define IMG_NAME INST_Mobilegov_SERVER_.bmp
<br />&gt;#Skin
<br />&gt;!define XPUI_WANSIS_SKIN Bliss
<br />&gt;!define XPUI_WANSIS_HEADERIMAGE
<br />&gt;#Color Text (white)
<br />&gt;!define XPUI_TEXT_COLOR FFFFFF
<br />&gt;!define XPUI_TEXT_LIGHTCOLOR FFFFFF
<br />&gt;#Color Licence text and BG
<br />&gt;!define XPUI_LICENSEBKCOLOR "ffffff"
<br />&gt;!define XPUI_BRANDINGTEXT_COLOR_FG "000000"
<br />&gt;#define radio button use for license agreement
<br />&gt;!define XPUI_LICENSEPAGE_RADIOBUTTONS
<br />&gt;!define XPUI_ABORTWARNING
<br />&gt;!define XPUI_DISABLEBG
<br />&gt;!define UI "XPUI"
<br /><br /><br /><br />&gt;;-----------------------------------------
<br />;Installer Page(s)
<br />&gt;#page welcome 1
<br />&gt;!insertmacro XPUI_PAGE_WELCOME
<br />&gt;#license page
<br />&gt;LicenseLangString myLicenseData 1033 "license_English.txt"
<br />&gt;LicenseLangString myLicenseData 1036 "license_French.txt"
<br />&gt;!define MUI_PAGE_CUSTOMFUNCTION_SHOW ComponentsShow
<br />&gt;!insertmacro XPUI_PAGE_LICENSE "$(myLicenseData)"
<br /><br />&gt;Page custom SerialPageShow SerialPageLeave
<br /><br />&gt;# install compoment page
<br />&gt;!insertmacro XPUI_PAGE_COMPONENTS
<br />&gt;#Directory installation
<br />&gt;!insertmacro XPUI_PAGE_DIRECTORY
<br />&gt;#Confirm install
<br />&gt;!insertmacro XPUI_PAGE_INSTCONFIRM
<br />&gt;#install files
<br />&gt;!insertmacro XPUI_PAGE_INSTFILES
<br />&gt;!insertmacro XPUI_PAGE_FINISH
<br />&gt;!insertmacro XPUI_PAGE_ABORT
<br /><br /><br /><br />&gt;## Displays the serial dialog
<br />&gt;Function SerialPageShow
<br /><br />&gt;!insertmacro MUI_HEADER_TEXT "Enter Serial Code" "Enter the software serial code to continue."
<br /><br />&gt;PassDialog::Dialog Serial 
<br />&gt;/HEADINGTEXT 'Please enter the serial code located on the software CD case...' 
<br />&gt;/CENTER 
<br />&gt;/BOXDASH 12 70 4 '' 
<br />&gt;/BOXDASH 92 70 4 '' 
<br />&gt;/BOXDASH 172 70 4 '' 
<br />&gt;/BOXDASH 252 70 4 '' 
<br />&gt;/BOX 332 70 4 ''
<br /><br />&gt;Pop $R0 # success, back, cancel or error
<br /><br />&gt;FunctionEnd
<br /><br />&gt;Function SerialPageLeave
<br /><br />&gt;## Pop values from stack
<br />&gt;Pop $R0
<br />Pop $R1
<br />Pop $R2
<br />Pop $R3
<br />Pop $R4
<br /><br /><br />&gt;## A bit of validation
<br /><br />&gt;StrCpy '$5' '$R0-$R1-$R2-$R3-$R4$\r$\n'
<br />&gt;StrCpy $6 0
<br /><br />Loop:
<br />&gt;IntOp $6 $6 + 1
<br />StrCmp$6 500 Bad ;1 more than the # serials in file
<br />&gt;Push $6 ;line number to read from
<br />File/oname=$PLUGINSDIRserial.txt "Numbers.txt"
<br />&gt;Push "$PLUGINSDIR\serial.txt" ;text file to read
<br />Call ReadFileLine
<br />Pop$0 ;output string (read from file.txt)
<br />&gt;StrCmp $0 $5 Good
<br />Goto Loop
<br /><br />Bad:
<br />&gt;MessageBox MB_OK|MB_ICONEXCLAMATION "The entered username or password is incorrect!"
<br />&gt;Delete "$PLUGINSDIR\serial.txt"
<br />&gt;Abort
<br /><br />Good:
<br />&gt;Delete "$PLUGINSDIR\serial.txt"
<br />&gt;FunctionEnd
<br /><br />&gt;Function ReadFileLine
<br />Exch$0 ;file
<br />Exch
<br />Exch$1 ;line number
<br />Push$2
<br />Push$3
<br /><br />FileOpen$2 $0 r
<br />StrCpy$3 0
<br />Loop:
<br />&gt;IntOp $3 $3 + 1
<br />ClearErrors
<br />FileRead$2 $0
<br />IfErrors+2
<br />StrCmp$3 $1 0 loop
<br />FileClose$2
<br /><br />Pop$3
<br />Pop$2
<br />Pop$1
<br />Exch$0
<br /><br />FunctionEnd 
<br />&gt;
</code>
</pre>thx
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kallan06</span><br />
      <span class="post-time small text-muted">14th August 2007 10:05 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">please help me :'( !<br />
      you have any idea why this function crash with experience UI ?<br />
      <br />
      Thx</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kallan06</span><br />
      <span class="post-time small text-muted">14th August 2007 15:56 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Hi all :) !<br />
      <br />
      It's good with this code :) ! But when i click on 'cancel' button, he call the function SerialPageLeave instead of display the popup cancel.<br />
      <br />
      <br /></p>
      <pre>
<code>

<br />Name    "Pass"
<br />&gt;OutFile "PassSerial.exe"
<br /><br /><br />&gt;## Include headers
<br />&gt;!include XPUI.nsh
<br />&gt;!include LogicLib.nsh
<br /><br />&gt;!define XPUI_ABORTWARNING
<br />&gt;## Pages
<br /><br />  #page welcome 1
<br />&gt;!insertmacro XPUI_PAGE_WELCOME
<br />  #license page
<br />&gt;!insertmacro XPUI_PAGE_LICENSE "license_English.txt"
<br /> Page custom SerialPageShow SerialPageLeave
<br /><br />  #Directory installation
<br />&gt;!insertmacro XPUI_PAGE_DIRECTORY
<br />    #Confirm install
<br />&gt;!insertmacro XPUI_PAGE_INSTCONFIRM
<br />  #install files
<br />&gt;!insertmacro XPUI_PAGE_INSTFILES
<br />&gt;!define XPUI_FINISHPAGE_RUN
<br />  # disable cancel button in finish
<br />&gt;!insertmacro XPUI_PAGE_FINISH
<br />  #Abord popup confirmation
<br />&gt;!insertmacro XPUI_PAGE_ABORT
<br /><br />&gt;!insertmacro XPUI_LANGUAGE English
<br /><br />&gt;## Displays the serial dialog
<br />&gt;Function SerialPageShow
<br /><br />&gt;;!insertmacro MUI_HEADER_TEXT "Enter Serial Code" "Enter the software serial code to continue."
<br />   ;!insertmacro MUI_INSTALLOPTIONS_EXTRACT "serial.ini"
<br />       !insertmacro MUI_INSTALLOPTIONS_DISPLAY "serial.ini" 
<br /><br />   ;!insertmacro MUI_INSTALLOPTIONS_DISPLAY "serial.ini" 
<br />&gt;; Pop $R0 # success, back, cancel or error
<br /><br />&gt;FunctionEnd
<br /><br />&gt;Function .onInit
<br /><br /> ;Extract InstallOptions files
<br /> ;$PLUGINSDIR will automatically be removed when the installer closes
<br />  
<br />  InitPluginsDir
<br />&gt;!insertmacro MUI_INSTALLOPTIONS_EXTRACT "serial.ini"
<br />  
<br />&gt;FunctionEnd
<br /><br />&gt;## Validate serial numbers
<br />&gt;Function SerialPageLeave
<br /><br /> ## Pop values from stack
<br /> Pop $R0
<br /> Pop $R1
<br /> Pop $R2
<br /> Pop $R3
<br /> Pop $R4
<br /><br /><br /> ## A bit of validation
<br />&gt;!insertmacro XPUI_INSTALLOPTIONS_READ $R0 "serial.ini" "Field 2" "State"
<br />&gt;!insertmacro XPUI_INSTALLOPTIONS_READ $R1 "serial.ini" "Field 3" "State"
<br />&gt;!insertmacro XPUI_INSTALLOPTIONS_READ $R2 "serial.ini" "Field 4" "State"
<br />&gt;!insertmacro XPUI_INSTALLOPTIONS_READ $R3 "serial.ini" "Field 5" "State"
<br />&gt;!insertmacro XPUI_INSTALLOPTIONS_READ $R4 "serial.ini" "Field 6" "State"
<br /><br /><br />&gt;;StrCpy '$5' '$R0-$R1-$R2-$R3-$R4'
<br />&gt;StrCpy '$5' '$R0-$R1-$R2-$R3-$R4$\r$\n'
<br />&gt;StrCpy $6 0
<br /><br />Loop:
<br />&gt;IntOp $6 $6 + 1
<br />StrCmp$6 500 Bad ;1 more than the # serials in file
<br />&gt;Push $6 ;line number to read from 
<br />File/oname=$PLUGINSDIRserial.txt "Numbers.txt"
<br />&gt;Push "$PLUGINSDIR\serial.txt" ;text file to read 
<br />Call ReadFileLine 
<br />Pop$0 ;output string (read from file.txt) 
<br />&gt;StrCmp $0 $5 Good
<br />Goto Loop
<br /><br />Bad:
<br />&gt;MessageBox MB_OK|MB_ICONEXCLAMATION "The entered username or password is incorrect!"
<br />&gt;Delete "$PLUGINSDIR\serial.txt"
<br />&gt;Abort
<br /><br />Good:
<br />&gt;Delete "$PLUGINSDIR\serial.txt"
<br />&gt;FunctionEnd
<br /><br />&gt;Function ComponentsPageShow
<br /><br /> ## Disable the Back button
<br /> GetDlgItem $R0 $HWNDPARENT 3
<br /> EnableWindow $R0 0
<br /><br />FunctionEnd
<br /><br />&gt;Function ReadFileLine
<br />Exch$0 ;file
<br />Exch
<br />Exch$1 ;line number
<br />Push$2
<br />Push$3
<br /><br />  FileOpen$2 $0 r
<br /> StrCpy$3 0
<br />Loop:
<br />&gt;IntOp $3 $3 + 1
<br />  ClearErrors
<br />  FileRead$2 $0
<br />  IfErrors+2
<br /> StrCmp$3 $1 0 loop
<br />  FileClose$2
<br /><br />Pop$3
<br />Pop$2
<br />Pop$1
<br />Exch$0
<br /><br />FunctionEnd
<br /><br />&gt;## Just a dummy section
<br />&gt;Section 'A section'
<br />&gt;SectionEnd 
<br />&gt;
</code>
</pre>serial.ini<br />
      <pre>
<code>

<br />&gt;***91;Settings***93;
<br />&gt;NumFields=10
<br /><br />&gt;***91;Field 1***93;
<br />&gt;Type=Label
<br />Text</code>=Label
<br />Left=12
<br />Right=265
<br />Top=42
<br />Bottom=61
<br /><br />&gt;***91;Field 2***93;
<br />&gt;Type=Text
<br />MaxLen=4
<br />Left=18
<br />Right=58
<br />Top=70
<br />Bottom=81
<br /><br />&gt;***91;Field 3***93;
<br />&gt;Type=Text
<br />MaxLen=4
<br />Left=70
<br />Right=110
<br />Top=70
<br />Bottom=81
<br /><br />&gt;***91;Field 4***93;
<br />&gt;Type=Text
<br />MaxLen=4
<br />Left=120
<br />Right=160
<br />Top=70
<br />Bottom=81
<br /><br />&gt;***91;Field 5***93;
<br />&gt;Type=Text
<br />MaxLen=4
<br />Left=170
<br />Right=210
<br />Top=70
<br />Bottom=81
<br /><br />&gt;***91;Field 6***93;
<br />&gt;Type=Text
<br />MaxLen=4
<br />Left=220
<br />Right=260
<br />Top=70
<br />Bottom=81
<br /><br />&gt;***91;Field 7***93;
<br />&gt;Type=Label
<br />Text=-
<br />&gt;Left=64
<br />Right=66
<br />Top=70
<br />Bottom=78
<br /><br />&gt;***91;Field 8***93;
<br />&gt;Type=Label
<br />Text=-
<br />&gt;Left=114
<br />Right=116
<br />Top=70
<br />Bottom=78
<br /><br />&gt;***91;Field 9***93;
<br />&gt;Type=Label
<br />Text=-
<br />&gt;Left=164
<br />Right=166
<br />Top=70
<br />Bottom=78
<br /><br />&gt;***91;Field 10***93;
<br />&gt;Type=Label
<br />Text=-
<br />&gt;Left=214
<br />Right=216
<br />Top=70
<br />Bottom=78 
<br />&gt;

</pre>you have any idea please ?
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kallan06</span><br />
      <span class="post-time small text-muted">16th August 2007 11:06 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">nobody wants to help me :'(<br />
      <br />
      I've just a last question, it's possible to past at next box when a box has 4 characters ?<br />
      Example : "aaaa" next box "aaaa" ...</p>
    </div>
    <hr />

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]>
  </script>
</body>
</html>