<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="description" content="Getting errors &quot;Can't open DLL for writing&quot;"><title>Getting errors "Can't open DLL for writing" - NSIS Forums</title><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script><link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css"><link rel="stylesheet" href="../css/style.css" type="text/css"><!--[if lt IE 9]><script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script><script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script><![endif]--></head><body><div class="container"><ol class="breadcrumb"><li><a href="../index.html" class="glyphicon glyphicon-home"></a></li><li><a href="f-65.html">NSIS Discussion</a></li><li class="active">Getting errors "Can't open DLL for writing"</li></ol><p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=138066">Getting errors "Can't open DLL for writing"</a></p><br><div class="post"><p class="post-meta"><span class="post-author text-primary">matthias_k</span><br><span class="post-time small text-muted">6th June 2003 11:00 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>Getting errors "Can't open DLL for writing"</strong><br>It seems that my installer tries to overwrite DLL's which are currently used by windows. I'm getting this error message during installation (at least from time to time):<br><br></p><blockquote>Error opening file for writing:<br>"C:\WINDOWS\System32\xxx.DLL"<br>Hit abort to abort installation,<br>retry to retry writing the file, or<br>ignore to skip this file</blockquote>Well, my installer HAS TO overwrite these files, at least if they're out of date. Is there a way to get instant access to these files or unload them from memory if currently loaded? Otherwise my installer will continue doing error messages if the files are in use.<br><br>Thanks.</div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">kichik</span><br><span class="post-time small text-muted">6th June 2003 11:10 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">You should use the <a href="http://nsis.sourceforge.net/Docs/AppendixB.html#B.11" target="_blank">UpgradeDLL macro</a>. It will make sure the DLL will only be copied over if the version on the user's system is older than what you're trying to install and, if the file in use, will replace the file after reboot.<br><br>Unless this DLL is only used by one program (rare if it's in the System directory), this is your only way. If it is used by only one program you can ask the user to close it or close it down yourself.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">matthias_k</span><br><span class="post-time small text-muted">6th June 2003 12:05 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Cool, that is everything I need in one single instruction.<br><br>Thanks.</p></div><hr><div class="footer"><p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p></div></div><script src="../js/highlight.pack.js" type="text/javascript"></script><script type="text/javascript">//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]></script></body></html>