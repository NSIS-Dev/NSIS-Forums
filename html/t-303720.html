<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="description" content="Problem in using message box with custom page"><title>Problem in using message box with custom page - NSIS Forums</title><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script><link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css"><link rel="stylesheet" href="../css/style.css" type="text/css"></head><body><div class="container"><ol class="breadcrumb"><li><a href="../index.html" class="glyphicon glyphicon-home"></a></li><li><a href="f-65.html">NSIS Discussion</a></li><li class="active">Problem in using message box with custom page</li></ol><p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=303720">Problem in using message box with custom page</a></p><br><div class="post"><p class="post-meta"><span class="post-author text-primary">nick_goyal</span><br><span class="post-time small text-muted">3rd March 2009 13:57 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>Problem in using message box with custom page</strong><br>i am using one custom page to check the "TCP-Port" whether its open or occupied and if it is occupied it is throwing a message saying this port is occupied.<br><br>my problem is when i click "ok" in "message box" the page moved to the next page and i have to come back to the old page to change the port. Is there any way to stay at the same page after clicking the "ok" button of the message box.<br><br>My Function for this operation is<br><br><br>Function CustomPage<br><br>InstallOptions::dialog "$PLUGINSDIR\CustomPage.ini"<br>ReadINIStr ${TEMP1} "$PLUGINSDIR\CustomPage.ini" "Field 2" "State"<br>${Unless} ${TCPPortOpen} ${TEMP1}<br>#MessageBox MB_OK "${TEMP1} port is free"<br>${Else}<br>MessageBox MB_OK "${TEMP1} port is occupied please use some other port "<br>${EndIf}<br>FunctionEnd<br><br><br>Truly grateful for any assistance on this issue.<br><br>Thanks a million!</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Red Wine</span><br><span class="post-time small text-muted">3rd March 2009 14:43 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Abort is the option.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">nick_goyal</span><br><span class="post-time small text-muted">4th March 2009 05:59 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Thank you for early reply Red Wine But this option is not working (i used Abort just after the Message Box).<br>Can you please tell me where to put Abort in this function.<br><br>Thanks in Advance</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">MSG</span><br><span class="post-time small text-muted">4th March 2009 07:09 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><a href="http://nsis.sourceforge.net/Docs/Chapter4.html#4.5.3" target="_blank">http://nsis.sourceforge.net/Docs/Chapter4.html#4.5.3</a></p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">nick_goyal</span><br><span class="post-time small text-muted">4th March 2009 09:34 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Hi MSG,<br><br>I have gone through this documentation but not able to use them as per my requirement, This Abort is not working under the condition and after clicking on OK (Message Box)it take me to the next page.<br><br>Thanks in Advance</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Animaether</span><br><span class="post-time small text-muted">4th March 2009 11:12 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">might not have read the documentation correctly, then.. you must call Abort in the custom page's Leave function, not in the Create function<br><br></p><pre>
<code><br>Page Custom CustomPageCreate CustomPageLave<br><br>Function CustomPageCreate<br>InstallOptions::dialog "$PLUGINSDIR\CustomPage.ini"<br>FunctionEnd<br><br>Function CustomPageLeave<br>ReadINIStr ${TEMP1} "$PLUGINSDIR\CustomPage.ini" "Field 2" "State"<br>${Unless} ${TCPPortOpen} ${TEMP1}<br>#MessageBox MB_OK "${TEMP1} port is free"<br>${Else}<br>MessageBox MB_OK "${TEMP1} port is occupied please use some other port "<br>Abort<br>${EndIf}<br>FunctionEnd<br></code>
</pre><br>
      <br>
      Edit: You might want to check to make sure that the user actually pressed the Next button by checking '"CustomPage.ini" "Settings" "State"'. If the value of that ini var is 0 (zero), then the user pressed the Next button.<br>
      <br>
      I highly recommend moving up to nsDialogs, by the way :)
    </div>
    <hr>

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]></script></body></html>