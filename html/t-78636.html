<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="CreateShortCut with an icon" />

  <title>CreateShortCut with an icon - NSIS Forums</title><!-- Bootstrap core CSS -->
  <link rel="stylesheet" type="text/css" href="//netdna.bootstrapcdn.com/bootswatch/3.0.1/readable/bootstrap.min.css" />
  <link rel="stylesheet" href="../css/style.css" type="text/css" /><!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!--[if lt IE 9]>
                <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
                <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->
</head>

<body>
  <div class="container">
    <!-- Put navigation bar here -->

    <ol class="breadcrumb">
      <li><a href="../index.html" class="glyphicon glyphicon-home"></a></li>

      <li><a href="f-65.html">NSIS Discussion</a></li>

      <li class="active">CreateShortCut with an icon</li>
    </ol>

    <p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=78636">CreateShortCut with an icon</a></p><br />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">bbh</span><br />
      <span class="post-time small text-muted">8th March 2002 20:14 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>CreateShortCut with an icon</strong><br />
      Hi,<br />
      <br />
      I guess I don't understand how to set an icon for my shortcut. I've searched the forum and some examples but haven't seen anything that seems relevent.<br />
      <br />
      My code looks like:<br />
      CreateShortCut "My App.lnk" "My App.exe" "" "myapp.jpg"<br />
      <br />
      and what I'm trying to accomplish is having myapp.jpg be the icon used for my shortcut. The shortcut gets created just fine, but the icon is not there. I've also tried including the jpeg file in my list of Files for the installer, but that didn't make any difference.<br />
      <br />
      What am I doing wrong? I haven't come across any examples that try to use a jpeg file for the icon. The few examples I've seen all specify an exe file here.<br />
      <br />
      Thanks for any help,<br />
      Beth</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">rainwater</span><br />
      <span class="post-time small text-muted">8th March 2002 20:31 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">You need to use a valid icon resource. Correct me if I'm wrong but you can either use, *.ico, *.dll, or *.exe files.<br />
      <br />
      Rob</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">bbh</span><br />
      <span class="post-time small text-muted">9th March 2002 00:06 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Thanks for the reply.<br />
      <br />
      I guess I am still confused as to what makes a "valid icon resource". I found a .ico file on my file system and gave that as input to the CreateShortCut tag. However that still didn't work.<br />
      <br />
      If I look at the properties of my newly created shortcut and try to "Change Icon", windows (W2K) reports an error that it can't find the file that I gave initially.<br />
      <br />
      Are there any links out there that describe how this works?<br />
      <br />
      Thanks again,<br />
      Beth</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">rainwater</span><br />
      <span class="post-time small text-muted">9th March 2002 00:08 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Try setting it to an exe that is on your system and see if it works. I wasnt sure about the ico resource.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">bbh</span><br />
      <span class="post-time small text-muted">11th March 2002 21:03 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">ok, I changed my shortcut to use notepad.exe as I saw in one of the example .nsi files and that worked (i.e. I saw the little notepad icon when I created the shortcut).<br />
      <br />
      So what does this mean if I am trying create a shortcut to a java app? Is the only way to set the image of the shortcut through an exe? What is the best way to accomplish this if I have either a jpeg file or an .ico file?<br />
      <br />
      Thanks,<br />
      Beth</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">SQwerl</span><br />
      <span class="post-time small text-muted">11th March 2002 22:30 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">I think your code is wrong. For the icon it should be like:<br /></p>
      <pre>
<code>Icon "c:\my documents\savirc\icons\savDesk.ico"</code>
</pre><br />
      <br />
      And for the shortcuts:<br />
      <pre>
<code>CreateShortCut "$DESKTOP\savIRC.lnk" "$INSTDIR\savirc.exe"</code>
</pre><br />
      <br />
      There are a few different ways you can make your icon's. In microangelo, or a regular graphic manipulation program such as Photoshop or Fireworks. But if you use the regular graphic apps, you will have to get a converter program, to convert your graphic to .ico. Don't forget that without tweaking the NSIS code, you can only use 16 colors for your icon. Dimensions: 32x32x16<br />
      <br />
      Hopefully this answers your question.<br />
      <br />
      Btw you can download microangelo at download.com
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">rainwater</span><br />
      <span class="post-time small text-muted">12th March 2002 00:04 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"></p>

      <blockquote>
        <i>Originally posted by bbh</i><br />
        <b>ok, I changed my shortcut to use notepad.exe as I saw in one of the example .nsi files and that worked (i.e. I saw the little notepad icon when I created the shortcut).<br />
        <br />
        So what does this mean if I am trying create a shortcut to a java app? Is the only way to set the image of the shortcut through an exe? What is the best way to accomplish this if I have either a jpeg file or an .ico file?<br />
        <br />
        Thanks,<br />
        Beth</b>
      </blockquote>You should be able to compile a dll with the icon file in the resources section. This could be done easily with any c or c++ compiler.
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">bbh</span><br />
      <span class="post-time small text-muted">12th March 2002 19:34 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">ok, I found the problem. I had copied the icon file to my working directory and thus was just giving the name of the icon file. This didn't work. But I changed to give the complete path and it is now working.<br />
      <br />
      Then I tried giving a relative path from my working directory, i.e. "src\images\myicon.ico" and that didn't work either.<br />
      <br />
      Is there any way for this to work without giving the complete path? So this script can move from machine to machine without having to worry about complete paths?<br />
      <br />
      Thanks for all your help.<br />
      Beth</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">rainwater</span><br />
      <span class="post-time small text-muted">12th March 2002 19:38 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">If you are installing to $INSTDIR, just use that variable in the string.<br />
      CreateShortCut "My App.lnk" "My App.exe" "" "$INSTDIR\my.ico"</p>
    </div>
    <hr />

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]>
  </script>
</body>
</html>
