<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="Uninstall header images not showing" />

  <title>Uninstall header images not showing - NSIS Forums</title><!-- Bootstrap core CSS -->
  <link rel="stylesheet" type="text/css" href="//netdna.bootstrapcdn.com/bootswatch/3.0.1/readable/bootstrap.min.css" />
  <link rel="stylesheet" href="../css/style.css" type="text/css" /><!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!--[if lt IE 9]>
                <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
                <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->
</head>

<body>
  <div class="container">
    <!-- Put navigation bar here -->

    <ol class="breadcrumb">
      <li><a href="../index.html" class="glyphicon glyphicon-home"></a></li>

      <li><a href="f-65.html">NSIS Discussion</a></li>

      <li class="active">Uninstall header images not showing</li>
    </ol>

    <p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=256673">Uninstall header images not showing</a></p><br />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Wabiloo</span><br />
      <span class="post-time small text-muted">2nd October 2006 11:15 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>Uninstall header images not showing</strong><br />
      My installer works great, with all images showing. The uninstaller on the other hand is showing no header or side image whatsoever. I don't quite understand it as the syntax seems correct, the graphics are in the directory quoted and the uninstaller icon is correct.<br />
      <br />
      Extracted from my code:<br />
      <br />
      PHP Code:</p>
      <hr />
      <code style="white-space:nowrap"><!-- php buffer start --></code><span style="color: #000000"><span style="color: #007700">;-----------------------------<br />
      ;</span><span style="color: #0000BB">Includes</span><span style="color: #007700">&amp;</span><span style="color: #0000BB">Defines<br />
      <br /></span> <span style="color: #007700">!include</span><span style="color: #DD0000">"..\common\src\GlobalDefines.nsh"<br /></span> <span style="color: #007700">!include</span><span style="color: #DD0000">"MUI.nsh"<br />
      <br /></span> <span style="color: #007700">(...)<br />
      <br />
      ;-----------------------------<br />
      ;</span><span style="color: #0000BB">Modern</span><span style="color: #007700">Interface<br />
      <br />
      ;</span><span style="color: #0000BB">MUISettings<br /></span> <span style="color: #007700">!</span><span style="color: #0000BB">defineMUI_ABORTWARNING<br />
      <br /></span> <span style="color: #007700">;</span><span style="color: #0000BB">MUISettings</span><span style="color: #007700">/</span><span style="color: #0000BB">Icons<br /></span> <span style="color: #007700">!</span><span style="color: #0000BB">defineMUI_ICON</span><span style="color: #DD0000">"${NSISDIR}\Contrib\Graphics\Icons\orange-install.ico"<br /></span> <span style="color: #007700">!</span><span style="color: #0000BB">defineMUI_UNICON</span><span style="color: #DD0000">"${NSISDIR}\Contrib\Graphics\Icons\orange-uninstall.ico"<br />
      <br /></span> <span style="color: #007700">;</span><span style="color: #0000BB">MUISettings</span><span style="color: #007700">/</span><span style="color: #0000BB">Header<br /></span> <span style="color: #007700">!</span><span style="color: #0000BB">defineMUI_HEADERIMAGE<br /></span> <span style="color: #007700">!</span><span style="color: #0000BB">defineMUI_HEADERIMAGE_RIGHT<br /></span> <span style="color: #007700">!</span><span style="color: #0000BB">defineMUI_HEADERIMAGE_BITMAP</span><span style="color: #DD0000">"${GRAPHICS_DIR}\installtop.bmp"<br /></span> <span style="color: #007700">!</span><span style="color: #0000BB">defineMUI_HEADERIMAGE_UNBITMAP</span><span style="color: #DD0000">"${GRAPHICS_DIR}\uninstalltop.bmp"<br />
      <br /></span> <span style="color: #007700">;</span><span style="color: #0000BB">MUISettings</span><span style="color: #007700">/</span><span style="color: #0000BB">Wizard<br /></span> <span style="color: #007700">!</span><span style="color: #0000BB">defineMUI_WELCOMEFINISHPAGE_BITMAP</span><span style="color: #DD0000">"${GRAPHICS_DIR}\installside.bmp"<br /></span> <span style="color: #007700">!</span><span style="color: #0000BB">defineMUI_UNWELCOMEFINISHPAGE_BITMAP</span><span style="color: #DD0000">"${GRAPHICS_DIR}\uninstallside.bmp"<br />
      <br /></span> <span style="color: #007700">(...</span><span style="color: #0000BB">includingsectionwritingtheuninstaller</span><span style="color: #007700">...)<br />
      <br />
      ;========================<br />
      ;</span><span style="color: #0000BB">Uninstaller<br />
      <br /></span> <span style="color: #007700">!</span><span style="color: #0000BB">insertmacroMUI_UNPAGE_CONFIRM<br /></span> <span style="color: #007700">!</span><span style="color: #0000BB">insertmacroMUI_UNPAGE_INSTFILES<br /></span> <span style="color: #007700">!</span><span style="color: #0000BB">insertmacroMUI_UNPAGE_FINISH<br />
      <br /></span> <span style="color: #007700">Function</span><span style="color: #0000BB">un</span><span style="color: #007700">.</span><span style="color: #0000BB">onGUIInit<br /></span> <span style="color: #007700">;</span><span style="color: #0000BB">getinstancefromtheuninstall</span><span style="color: #007700">.</span><span style="color: #0000BB">inifile<br />
      ReadIniStr$INSTANCE</span><span style="color: #DD0000">"$INSTDIR\Uninstall.ini""Uninstall""Instance"<br />
      <br /></span> <span style="color: #007700">;</span><span style="color: #0000BB">TODO</span><span style="color: #007700">-</span><span style="color: #0000BB">closeapplication</span><span style="color: #007700">if</span><span style="color: #0000BB">itisrunning<br />
      <br />
      FunctionEnd<br />
      <br />
      Section</span><span style="color: #DD0000">"un.Uninstallall"<br />
      <br /></span> <span style="color: #007700">;</span><span style="color: #0000BB">Media<br />
      ReadIniStr</span><span style="color: #007700">$</span><span style="color: #0000BB">0</span><span style="color: #DD0000">"$INSTDIR\Uninstall.ini""Uninstall""MediaDir"<br /></span> <span style="color: #007700">${If}$</span><span style="color: #0000BB">0</span><span style="color: #007700">!=</span><span style="color: #DD0000">""<br /></span> <span style="color: #0000BB">Delete</span><span style="color: #DD0000">"$0\*.*"<br /></span> <span style="color: #0000BB">RMDir</span><span style="color: #DD0000">"$0"<br /></span> <span style="color: #007700">${EndIf}<br />
      <br />
      ;</span><span style="color: #0000BB">Database<br />
      ReadIniStr</span><span style="color: #007700">$</span><span style="color: #0000BB">0</span><span style="color: #DD0000">"$INSTDIR\Uninstall.ini""Uninstall""DatabaseDir"<br /></span> <span style="color: #007700">${If}$</span><span style="color: #0000BB">0</span><span style="color: #007700">!=</span><span style="color: #DD0000">""<br /></span> <span style="color: #0000BB">Delete</span><span style="color: #DD0000">"$0\*.*"<br /></span> <span style="color: #0000BB">RMDir</span><span style="color: #DD0000">"$0"<br /></span> <span style="color: #007700">${EndIf}<br />
      <br />
      ;</span><span style="color: #0000BB">Settings<br />
      ReadIniStr</span><span style="color: #007700">$</span><span style="color: #0000BB">0</span><span style="color: #DD0000">"$INSTDIR\Uninstall.ini""Uninstall""InstanceType"<br /></span> <span style="color: #007700">${If}$</span><span style="color: #0000BB">0</span><span style="color: #007700">==</span><span style="color: #DD0000">"/reg"<br /></span> <span style="color: #0000BB">DeleteRegKeyHKLM</span><span style="color: #DD0000">"${IS_REGKEY}\${APP_NAME}\$INSTANCE"<br /></span> <span style="color: #007700">${ElseIf}$</span><span style="color: #0000BB">0</span><span style="color: #007700">==</span><span style="color: #DD0000">"/xml"<br /></span> <span style="color: #0000BB">ReadRegStr</span><span style="color: #007700">$</span><span style="color: #0000BB">1HKLM</span><span style="color: #DD0000">"${IS_REGKEY}\Paths""AppConfigRoot"<br /></span> <span style="color: #0000BB">Delete</span><span style="color: #DD0000">"$1\${APP_NAME}\Config-$INSTANCE.xml"<br /></span> <span style="color: #007700">${EndIf}<br />
      <br />
      ;</span><span style="color: #0000BB">Launcher<br /></span> <span style="color: #007700">;</span><span style="color: #0000BB">TODO</span><span style="color: #007700">-</span><span style="color: #0000BB">removeregistrationwithlauncherviaLauncherManager<br />
      <br /></span> <span style="color: #007700">;</span><span style="color: #0000BB">ProgramFiles<br />
      Delete</span><span style="color: #DD0000">"$INSTDIR\*.*"<br /></span> <span style="color: #0000BB">RMDir</span><span style="color: #DD0000">"$INSTDIR"<br />
      <br /></span> <span style="color: #007700">;</span><span style="color: #0000BB">removeuninstallerentryfromregistry<br />
      DeleteRegKeyHKLM</span><span style="color: #DD0000">"Software\Microsoft\Windows\CurrentVersion\Uninstall\${APP_NAME}-$INSTANCE"<br />
      <br /></span> <span style="color: #007700">;</span><span style="color: #0000BB">TODO</span><span style="color: #007700">-</span><span style="color: #0000BB">offertoremoveFirebird</span><span style="color: #007700">as</span><span style="color: #0000BB">well</span><span style="color: #007700">...<br />
      <br /></span> <span style="color: #0000BB">SectionEnd<br /></span></span> <!-- php buffer end -->
      <hr />
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">saschagottfried</span><br />
      <span class="post-time small text-muted">2nd October 2006 12:13 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">see help for uninstall 4.6.2<br />
      <br />
      The first Delete instruction works (deleting the uninstaller), because the uninstaller is transparently copied to the system temporary directory for the uninstall.<br />
      <br />
      Check if your paths, especially ${GRAPHICS_DIR} are absolut. If not uninstaller will not find your background image. uninstall icon works with ${NSISDIR}. That will build an absolut path.<br />
      <br />
      Try to put your images into $NSISDIR. If that works, you know its a common path error.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Wabiloo</span><br />
      <span class="post-time small text-muted">21st May 2007 12:05 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">My ${GRAPHICS_DIR} is an absolute path, and is the same as the one used in the installer part, which works.<br />
      I also tried copying the images in ${NSISDIR} and change the code accordingly, to no avail.<br />
      <br />
      Does anyone have another idea why my uninstaller wouldn't show the images?<br />
      <br />
      Thanks</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">saschagottfried</span><br />
      <span class="post-time small text-muted">21st May 2007 12:34 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Please attach your code from your installer that works and of uninstaller that does not work. My first intention is that you have to tell to MUI that you want to extract the file to a path during un.onInit of Uninstaller. You have to use that path for dialogs. Your installer approach works, because you have NSIS installed and and those MUI macros insert and extract the graphic files during installation. During installtion on customer system there is (most probably) no NSIS installtion. That's why you have to care for extraction to proper/known path on customer system. MUI_INSTALLOPTIONS_EXTRACT and $PLUGINSDIR are two good keywords for your readings. I know my example is for custom dialogs, but it explains the idea as well.<br />
      <br />
      Function un.onInit<br />
      ;bitmap as background image<br />
      !insertmacro MUI_INSTALLOPTIONS_EXTRACT "wizard.bmp"<br />
      !insertmacro MUI_INSTALLOPTIONS_EXTRACT "uninstallpage.ini"<br />
      <br />
      define a custom page for uninstaller:<br />
      UninstPage custom un.ChooseUninstallationType un.CheckUninstallationType<br />
      <br />
      When you do this you can refer to this picture in a custom function for custom dialogs:<br />
      <br />
      Function un.ChooseUninstallationType<br />
      <br />
      ;needs to be done before initialising dialog - otherwise bitmap is missing<br />
      !insertmacro MUI_INSTALLOPTIONS_WRITE "uninstallpage.ini" "Field 1" "Text" "$PLUGINSDIR\wizard.bmp"<br />
      <br />
      sorry for bad insertion of code snippets, but its just from my code. read 'Using InstallOptions for custom pages' in NSIS-MUI help for explanation of ressource file handling in installers/uninstallers!<br />
      <br />
      Good luck!</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">akshay.sharma</span><br />
      <span class="post-time small text-muted">30th April 2008 05:42 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">This is not resolving my problem. the unistaller still doesn't show the image.</p>
    </div>
    <hr />

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]>
  </script>
</body>
</html>
