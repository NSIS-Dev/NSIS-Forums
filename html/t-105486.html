<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="variable on function .oninit" />

  <title>variable on function .oninit - NSIS Forums</title>
  <script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script>
  <!-- Bootstrap core CSS -->

  <link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css" />
  <link rel="stylesheet" href="../css/style.css" type="text/css" /><!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!--[if lt IE 9]>
                <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
                <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->
</head>

<body>
  <div class="container">
    <!-- Put navigation bar here -->

    <ol class="breadcrumb">
      <li><a href="../index.html" class="glyphicon glyphicon-home"></a></li>

      <li><a href="f-65.html">NSIS Discussion</a></li>

      <li class="active">variable on function .oninit</li>
    </ol>

    <p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=105486">variable on function .oninit</a></p><br />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">david33470</span><br />
      <span class="post-time small text-muted">16th September 2002 12:25 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>variable on function .oninit</strong><br />
      Hello<br />
      I have a problem with a script, on the .oninit function<br />
      I do the following:<br />
      Function .onInit<br />
      StrCpy $2 “name of section 4”<br />
      SectionSetText 4 "$2"<br />
      StrCpy $2 “name of section 5”<br />
      SectionSetText 5 "$2"<br />
      StrCpy $2 “name of section 6”<br />
      SectionSetText 6 "$2"<br />
      <br />
      FunctionEnd<br />
      But all my section (4, 5, 6) have the name: name of section 6. I don’t understand why the variable $2 takes the last attributed value. Perhaps on the function .oninit, first the variables are calculated and then the sectionSetText are done??? I don’t know where I can do those commands, because it is to give a name to the section and this is the first executed function!!!</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
      <span class="post-time small text-muted">16th September 2002 13:09 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">The sections' names are processed just before they are shown. Therefore, setting the names in .onNextPage/.onPrevPage (which are called before the page shows up, before the names are processed) might be the best solution. You won't be able to use the same variable just as before, but at least you won't have to keep a lot of variables unused until then.<br />
      <br />
      I assume your example is just to show the problem, but just to be sure, you don't have to copy the string to a variable and then into the section name you can just use SectionSetName 1 "text".</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">david33470</span><br />
      <span class="post-time small text-muted">16th September 2002 13:29 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>tank you!</strong><br />
      tank you!<br />
      I know that i have not to copy the string before do a sectionSetText but I have put strcpy in the exemple to simplify the problem but in fact i get the name of each section with a DLL function and i pop the value on $2 variable.<br />
      But in the script i use approximatively 10 variable for other thing (that i keep in all the script)and i have more than 16 section and subsection to named like the exemple so i can't use a different variable for each section!!!<br />
      I don't realy understand why i have to put this lines on the function .onNextPage???</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
      <span class="post-time small text-muted">16th September 2002 13:40 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">I was just suggesting you will put those in .onNextPage so you will be able to use the variables else where in the script. When .onNextPage is called for the components page, push all of your variables, get the names, put them in seperate variables and set the sections names. After you have passed the components page, pop all of your variables and continue as usual. This is the best solution I can offer for you. I will try to somehow work around this for the next version of NSIS, sections names should not (IMHO) be depended on variables.</p>
    </div>
    <hr />

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]>
  </script>
</body>
</html>
