<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="description" content="Problem compiling with mstoolkit.py v1.3"><title>Problem compiling with mstoolkit.py v1.3 - NSIS Forums</title><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script><link rel="preload" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css" as="style" onload="this.rel='stylesheet'"><link rel="preload" href="../css/style.css" as="style" onload="this.rel='stylesheet'"><noscript><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css"><link rel="stylesheet" href="../css/style.css"></noscript><script>!function(a){"use strict";var b=function(b,c,d){function e(a){return h.body?a():void setTimeout(function(){e(a)})}function f(){i.addEventListener&&i.removeEventListener("load",f),i.media=d||"all"}var g,h=a.document,i=h.createElement("link");if(c)g=c;else{var j=(h.body||h.getElementsByTagName("head")[0]).childNodes;g=j[j.length-1]}var k=h.styleSheets;i.rel="stylesheet",i.href=b,i.media="only x",e(function(){g.parentNode.insertBefore(i,c?g:g.nextSibling)});var l=function(a){for(var b=i.href,c=k.length;c--;)if(k[c].href===b)return a();setTimeout(function(){l(a)})};return i.addEventListener&&i.addEventListener("load",f),i.onloadcssdefined=l,l(f),i};"undefined"!=typeof exports?exports.loadCSS=b:a.loadCSS=b}("undefined"!=typeof global?global:this);!function(a){if(a.loadCSS){var b=loadCSS.relpreload={};if(b.support=function(){try{return a.document.createElement("link").relList.supports("preload")}catch(b){return!1}},b.poly=function(){for(var b=a.document.getElementsByTagName("link"),c=0;c<b.length;c++){var d=b[c];"preload"===d.rel&&"style"===d.getAttribute("as")&&(a.loadCSS(d.href,d,d.getAttribute("media")),d.rel=null)}},!b.support()){b.poly();var c=a.setInterval(b.poly,300);a.addEventListener&&a.addEventListener("load",function(){b.poly(),a.clearInterval(c)}),a.attachEvent&&a.attachEvent("onload",function(){a.clearInterval(c)})}}}(this);</script></head><body><div class="container"><ol class="breadcrumb"><li><a href="../index.html" class="glyphicon glyphicon-home"></a></li><li><a href="f-65.html">NSIS Discussion</a></li><li class="active">Problem compiling with mstoolkit.py v1.3</li></ol><p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=228251">Problem compiling with mstoolkit.py v1.3</a></p><br><div class="post"><p class="post-meta"><span class="post-author text-primary">WebMatze</span><br><span class="post-time small text-muted">12th October 2005 15:17 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>Problem compiling with mstoolkit.py v1.3</strong><br>Hello,<br><br>i'm having problem to compile NSIS with the latest version of MSTOOLKIT.py (1.3), it works perfectly with the previous version... here is the log<br></p><blockquote><font size="1"><br>D:\Scripts NSIS\NSIS-20051011&gt;scons -j4 MSTOOLKIT=YES<br>scons: Reading SConscript files ...<br>Delete("nsis-12-Oct-2005.cvs")<br>Delete(".instdist")<br>Delete(".test")<br>Using Microsoft tools configuration<br>Checking for main() in C library gdi32... (cached) yes<br>Checking for main() in C library user32... (cached) yes<br>Checking for main() in C library version... (cached) yes<br>Checking for main() in C library pthread... (cached) no<br>Checking for main() in C library stdc++... (cached) no<br>Checking for main() in C library iconv... (cached) no<br>Checking for main() in C library dl... (cached) no<br>Checking for main() in C++ library cppunit... (cached) no<br>scons: done reading SConscript files.<br>scons: Building targets ...<br>"C:\Progra~1\Installers\MS-Platform-SDK\\bin\Win64\link.exe" /nologo /opt:nowin9<br>8 /map /entry:DllMain /NODEFAULTLIB /dll /out:build\release\InstallOptions\Insta<br>llOptions.dll kernel32.lib user32.lib gdi32.lib shell32.lib comdlg32.lib build\r<br>elease\InstallOptions\InstallerOptions.obj build\release\InstallOptions\ioptdll.<br>res<br>"C:\Progra~1\Installers\MS-Platform-SDK\\bin\Win64\link.exe" /nologo /opt:nowin9<br>8 /map /OUT:build\release\Library\LibraryLocal\LibraryLocal.exe kernel32.lib ole<br>aut32.lib version.lib build\release\Library\LibraryLocal\LibraryLocal.obj<br>LibraryLocal.obj : error LNK2019: unresolved external symbol "__int64 std::_Fpz"<br>(?_Fpz@std@@3_JA) referenced in function "protected: virtual class std::fpos&lt;in<br>t&gt; __thiscall std::basic_streambuf&lt;char,struct std::char_traits&lt;char&gt; &gt;::seekoff<br>(long,int,int)" (?seekoff@?$basic_streambuf@DU?$char_traits@D@std@@@std@@MAE?AV?<br>$fpos@H@2@JHH@Z)<br>LibraryLocal.obj : error LNK2019: unresolved external symbol "long const std::_B<br>ADOFF" (?_BADOFF@std@@3JB) referenced in function "protected: virtual class std:<br>:fpos&lt;int&gt; __thiscall std::basic_streambuf&lt;char,struct std::char_traits&lt;char&gt; &gt;:<br>:seekoff(long,int,int)" (?seekoff@?$basic_streambuf@DU?$char_traits@D@std@@@std@<br>@MAE?AV?$fpos@H@2@JHH@Z)<br>LibraryLocal.obj : error LNK2019: unresolved external symbol "public: void __thi<br>scall std::_String_base::_Xran(void)const " (?_Xran@_String_base@std@@QBEXXZ) re<br>ferenced in function "public: int __thiscall std::basic_string&lt;char,struct std::<br>char_traits&lt;char&gt;,class std::allocator&lt;char&gt; &gt;::compare(unsigned int,unsigned in<br>t,char const *,unsigned int)const " (?compare@?$basic_string@DU Creating libra<br>ry build\release\Insta?$char_traits@D@stllOptions\InstallOd@@V?$allocator@D@ptio<br>ns.lib and obj2@@std@@QBEHIIPBDIect build\release\@Z)<br>LibraryLocal.oInstallOptions\Insbj : error LNK2019tallOptions.exp<br>: unresolved external symbol "public: void __thiscall std::locale::facet::_Regis<br>ter(void)" (?_Register@facet@locale@std@@QAEXXZ) referenced in function "class s<br>td::ctype&lt;char&gt; const &amp; __cdecl std::use_facet&lt;class std::ctype&lt;char&gt; &gt;(class st<br>d::locale const &amp;)" (??$use_facet@V?$ctype@D@std@@@std@@YAABV?$ctype@D@0@ABVloca<br>le@0@@Z)<br>LibraryLocal.obj : error LNK2019: unresolved external symbol "public: class std:<br>:locale::facet const * __thiscall std::locale::_Getfacet(unsigned int)const " (?<br>_Getfacet@locale@std@@QBEPBVfacet@12@I@Z) referenced in function "class std::cty<br>pe&lt;char&gt; const &amp; __cdecl std::use_facet&lt;class std::ctype&lt;char&gt; &gt;(class std::loca<br>le const &amp;)" (??$use_facet@V?$ctype@D@std@@@std@@YAABV?$ctype@D@0@ABVlocale@0@@Z<br>)<br>LibraryLocal.obj : error LNK2019: unresolved external symbol "public: void __thi<br>scall std::_String_base::_Xlen(void)const " (?_Xlen@_String_base@std@@QBEXXZ) re<br>ferenced in function "protected: bool __thiscall std::basic_string&lt;char,struct s<br>td::char_traits&lt;char&gt;,class std::allocator&lt;char&gt; &gt;::_Grow(unsigned int,bool)" (?<br>_Grow@?$basic_string@DU?$char_traits@D@std@@V?$allocator@D@2@@std@@IAE_NI_N@Z)<br>LibraryLocal.obj : error LNK2019: unresolved external symbol "public: void __thi<br>scall std::ios_base::_Addstd(void)" (?_Addstd@ios_base@std@@QAEXXZ) referenced i<br>n function "protected: void __thiscall std::basic_ios&lt;char,struct std::char_trai<br>ts&lt;char&gt; &gt;::init(class std::basic_streambuf&lt;char,struct std::char_traits&lt;char&gt; &gt;<br>*,bool)" (?init@?$basic_ios@DU?$char_traits@D@std@@@std@@IAEXPAV?$basic_streamb<br>uf@DU?$char_traits@D@std@@@2@_N@Z)<br>LibraryLocal.obj : error LNK2019: unresolved external symbol "struct _iobuf * __<br>cdecl std::_Fiopen(char const *,int,int)" (?_Fiopen@std@@YAPAU_iobuf@@PBDHH@Z) r<br>eferenced in function "public: class std::basic_filebuf&lt;char,struct std::char_tr<br>aits&lt;char&gt; &gt; * __thiscall std::basic_filebuf&lt;char,struct std::char_traits&lt;char&gt;<br>&gt;::open(char const *,int,int)" (?open@?$basic_filebuf@DU?$char_traits@D@std@@@st<br>d@@QAEPAV12@PBDHH@Z)<br>build\release\Library\LibraryLocal\LibraryLocal.exe : fatal error LNK1120: 8 unr<br>esolved externals<br>cl /nologo /O2 /GX /W3 /TP /D_WIN32_IE=0x0500 /DNSIS_MAX_STRLEN=1024 /DNSIS_MAX_<br>INST_TYPES=32 /DNSIS_DEFAULT_LANG=1033 /DNSIS_CONFIG_UNINSTALL_SUPPORT /DNSIS_CO<br>NFIG_LICENSEPAGE /DNSIS_CONFIG_COMPONENTPAGE /DNSIS_CONFIG_SILENT_SUPPORT /DNSIS<br>_CONFIG_VISIBLE_SUPPORT /DNSIS_CONFIG_ENHANCEDUI_SUPPORT /DNSIS_CONFIG_COMPRESSI<br>ON_SUPPORT /DNSIS_COMPRESS_BZIP2_LEVEL=9 /DNSIS_CONFIG_CRC_SUPPORT /DNSIS_SUPPOR<br>T_BGBG /DNSIS_SUPPORT_CODECALLBACKS /DNSIS_SUPPORT_MOVEONREBOOT /DNSIS_SUPPORT_A<br>CTIVEXREG /DNSIS_SUPPORT_INTOPTS /DNSIS_SUPPORT_STROPTS /DNSIS_SUPPORT_STACK /DN<br>SIS_SUPPORT_FILEFUNCTIONS /DNSIS_SUPPORT_FINDFIRST /DNSIS_SUPPORT_CREATESHORTCUT<br>/DNSIS_SUPPORT_INIFILES /DNSIS_SUPPORT_REGISTRYFUNCTIONS /DNSIS_SUPPORT_COPYFIL<br>ES /DNSIS_SUPPORT_REBOOT /DNSIS_SUPPORT_FNUTIL /DNSIS_SUPPORT_EXECUTE /DNSIS_SUP<br>PORT_SHELLEXECUTE /DNSIS_SUPPORT_GETDLLVERSION /DNSIS_SUPPORT_GETFILETIME /DNSIS<br>_SUPPORT_HWNDS /DNSIS_SUPPORT_ENVIRONMENT /DNSIS_SUPPORT_RMDIR /DNSIS_SUPPORT_FI<br>LE /DNSIS_SUPPORT_DELETE /DNSIS_SUPPORT_RENAME /DNSIS_SUPPORT_MESSAGEBOX /DNSIS_<br>SUPPORT_VERSION_INFO /DNSIS_SUPPORT_STANDARD_PREDEFINES /DNSIS_LOCKWINDOW_SUPPOR<br>T /DNSIS_CONFIG_PLUGIN_SUPPORT /DNSIS_VERSION=v12-Oct-2005.cvs /c Source\build.c<br>pp /Fobuild\release\makensis\build.obj<br>scons: *** [build\release\Library\LibraryLocal\LibraryLocal.exe] Error 1120<br>build.cpp<br>scons: building terminated because of errors.<br></font></blockquote>Can someone please help me to find where the problem is?<br>Thanks in advance</div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">kichik</span><br><span class="post-time small text-muted">12th October 2005 15:40 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">It compiles just fine for me, and <a href="http://cvs.sourceforge.net/viewcvs.py/nsis/NSIS/SCons/Tools/mstoolkit.py.diff?r1=1.2&amp;r2=1.3" target="_blank">all that changed in 1.3</a> is the order of the lib and include directories. Are you sure nothing else has changed? Have you tried cleaning up LibraryLocal before trying to build it again? Try:</p><pre>
<code>scons MSTOOLKIT=yes -c LibraryLocal</code>
</pre></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">WebMatze</span><br><span class="post-time small text-muted">12th October 2005 16:38 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">I tried what you wrote, but i still get the same error...<br>and i did'nt change anything, qith 1.2 it works but not with 1.3.<br>Any idea?</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">kichik</span><br><span class="post-time small text-muted">12th October 2005 16:41 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Do you have files named iostream, istream, ostream, fstream, streambuf, ios or iosfwd in %MSSDK%\Include?</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">WebMatze</span><br><span class="post-time small text-muted">12th October 2005 16:57 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">No, there is none of these files in that folder...<br>Are they required to compile correctly? And where can i get them?</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">kichik</span><br><span class="post-time small text-muted">12th October 2005 17:04 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">No, they shouldn't be there. They should be in VC Toolkit include directory. Their presence could have explained this error.<br><br>Are you using cygwin or something similar to build NSIS?</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">WebMatze</span><br><span class="post-time small text-muted">12th October 2005 17:13 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">No i'm using the ms platform sdk and the vc++ toolkit 2003 they are installed in :<br>C:\Program Files\Installers\MS-Platform-SDK<br>C:\Program Files\Installers\MS-VisualC++Toolkit2003<br>Python is installed in<br>C:\Program Files\Installers\python24<br>and scons is also in the python dir.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">kichik</span><br><span class="post-time small text-muted">12th October 2005 17:16 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">But are you running it from a cygwin or msys shell? That could explain the problem, because os.sep would be a colon and not semi-colon. Try this one.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">WebMatze</span><br><span class="post-time small text-muted">12th October 2005 17:23 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"></p><blockquote>But are you running it from a cygwin or msys shell?</blockquote>I d'ont know what does it mean, but i tried your file and it didn't work...</div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">kichik</span><br><span class="post-time small text-muted">12th October 2005 17:37 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Can you attach the directory listings of %MSSDK%\lib, %MSSDK%\include, %VCToolkitInstallDir%\lib and %VCToolkitInstallDir%\include?</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">WebMatze</span><br><span class="post-time small text-muted">12th October 2005 17:54 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Here is the list</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">kichik</span><br><span class="post-time small text-muted">12th October 2005 18:16 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">It's libcp.lib. The same thing happened in <a href="http://forums.winamp.com/showthread.php?s=&amp;threadid=223417" target="_blank">this thread</a>. I wonder if it's just a one time bug with one of the Platform SDK versions, or if this file is always included in new versions. Do you mind uninstalling the current PSDK you have, installing the latest one and letting me know if that file is still there? Can you also attach this file? Even though it shouldn't be there, it should still contain all of those objects that weren't found in it.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Joost Verburg</span><br><span class="post-time small text-muted">12th October 2005 18:36 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">I have the same problem, it exists in the latest Platform SDK.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">WebMatze</span><br><span class="post-time small text-muted">12th October 2005 18:40 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">ok i'll try with a new PSDK...<br>the file is too big to be attached (even if I 7zip it...)<br>Thanks for your help, i'll let you know if with the new PSDK it works.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">WebMatze</span><br><span class="post-time small text-muted">12th October 2005 21:45 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Ok I've tested with the latest PSDK a i still get the error, the only way to correct it is to rename libcp.lib...</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Instructor</span><br><span class="post-time small text-muted">13th October 2005 00:22 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">I also have "%MSSDK%\Lib\LIBCP.LIB", but there is no problem with compiling NSIS (Windows Server 2003 SP1 SDK)</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">WebMatze</span><br><span class="post-time small text-muted">13th October 2005 06:02 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">That's strange, for me the only way to make it work is to rename the file... I Also use the Windows Server 2003 SP1 SDK...</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">kichik</span><br><span class="post-time small text-muted">13th October 2005 13:12 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">WebMatze, can you attach the list of the include folder of the Platform SDK as well?<br><br>Instructor, are you using the latest CVS version? The fix that I've added for your problem is currently available only there.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">kichik</span><br><span class="post-time small text-muted">13th October 2005 14:16 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">I've added a workaround that searches for a good version of libcp.lib and uses it. The file 'ms' goes into SCons\Config.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">kichik</span><br><span class="post-time small text-muted">13th October 2005 14:31 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">And a little fix.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">WebMatze</span><br><span class="post-time small text-muted">13th October 2005 15:40 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Hello,<br><br>you fix doesn't seem to work<br><br></p><blockquote>D:\Scripts NSIS\NSIS-20051012&gt;scons -j4 MSTOOLKIT=YES CHMDOCS=YES VERSION=2.10 dist-installer<br>scons: Reading SConscript files ...<br>Delete("nsis-2.10")<br>Delete(".instdist")<br>Delete(".test")<br>Using Microsoft tools configuration<br>ValueError: list.remove(x): x not in list:<br>File "SConstruct", line 189:<br>envs = SConscript('SCons/Config/ms')<br>File "C:\Program Files\Installers\Python24\scons-0.96.91\SCons\Script\SConscri<br>pt.py", line 557:<br>return apply(method, args, kw)<br>File "C:\Program Files\Installers\Python24\scons-0.96.91\SCons\Script\SConscri<br>pt.py", line 494:<br>return apply(_SConscript, [self.fs,] + files, {'exports' : exports})<br>File "C:\Program Files\Installers\Python24\scons-0.96.91\SCons\Script\SConscri<br>pt.py", line 226:<br>exec _file_ in call_stack[-1].globals<br>File "SCons\Config\ms", line 47:<br>libdirs.remove(Dir('#/.sconf_temp').abspath);<br>D:\Scripts NSIS\NSIS-20051012&gt;</blockquote>Here is the error.</div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">kichik</span><br><span class="post-time small text-muted">13th October 2005 15:48 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Thanks, fixed. Remove the libdirs.remove line, it's no longer needed.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">WebMatze</span><br><span class="post-time small text-muted">13th October 2005 15:54 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Here is the list of the include dir</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">kichik</span><br><span class="post-time small text-muted">13th October 2005 16:00 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Thanks, that confirms libcp.lib should not be included in the Platform SDK. They must have put it there by mistake. There are no matching haeder files for it.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">WebMatze</span><br><span class="post-time small text-muted">13th October 2005 16:05 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">YES!!!<br>It works<br><br>thanks a lot kichik</p></div><hr><div class="footer"><p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p></div></div><script src="../js/highlight.pack.js" type="text/javascript"></script><script type="text/javascript">//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]></script></body></html>