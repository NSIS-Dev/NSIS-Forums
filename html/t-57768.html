<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="description" content="Auto-Uninstall/NT 4"><title>Auto-Uninstall/NT 4 - NSIS Forums</title><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script><link rel="preload" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css" as="style" onload="this.rel='stylesheet'"><link rel="preload" href="../css/style.css" as="style" onload="this.rel='stylesheet'"><noscript><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css"><link rel="stylesheet" href="../css/style.css"></noscript><script>!function(a){"use strict";var b=function(b,c,d){function e(a){return h.body?a():void setTimeout(function(){e(a)})}function f(){i.addEventListener&&i.removeEventListener("load",f),i.media=d||"all"}var g,h=a.document,i=h.createElement("link");if(c)g=c;else{var j=(h.body||h.getElementsByTagName("head")[0]).childNodes;g=j[j.length-1]}var k=h.styleSheets;i.rel="stylesheet",i.href=b,i.media="only x",e(function(){g.parentNode.insertBefore(i,c?g:g.nextSibling)});var l=function(a){for(var b=i.href,c=k.length;c--;)if(k[c].href===b)return a();setTimeout(function(){l(a)})};return i.addEventListener&&i.addEventListener("load",f),i.onloadcssdefined=l,l(f),i};"undefined"!=typeof exports?exports.loadCSS=b:a.loadCSS=b}("undefined"!=typeof global?global:this);!function(a){if(a.loadCSS){var b=loadCSS.relpreload={};if(b.support=function(){try{return a.document.createElement("link").relList.supports("preload")}catch(b){return!1}},b.poly=function(){for(var b=a.document.getElementsByTagName("link"),c=0;c<b.length;c++){var d=b[c];"preload"===d.rel&&"style"===d.getAttribute("as")&&(a.loadCSS(d.href,d,d.getAttribute("media")),d.rel=null)}},!b.support()){b.poly();var c=a.setInterval(b.poly,300);a.addEventListener&&a.addEventListener("load",function(){b.poly(),a.clearInterval(c)}),a.attachEvent&&a.attachEvent("onload",function(){a.clearInterval(c)})}}}(this);</script></head><body><div class="container"><ol class="breadcrumb"><li><a href="../index.html" class="glyphicon glyphicon-home"></a></li><li><a href="f-65.html">NSIS Discussion</a></li><li class="active">Auto-Uninstall/NT 4</li></ol><p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=57768">Auto-Uninstall/NT 4</a></p><br><div class="post"><p class="post-meta"><span class="post-author text-primary">Pomflain</span><br><span class="post-time small text-muted">21st August 2001 19:59 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>Auto-Uninstall/NT 4</strong><br>I've been using NSIS for all the windows side installers at my job. What I've being doing recently is having the installers check for a previous installation and then prompting the user if a previous version is found. The problem is that on NT 4.0, this doesn't work for some reason. I'm doing this check in .OnInit, and I've tried using ExecShell, Exec, ExecWait, and even !system, but none of them will work. If I move this code out of .OnInit and into the main section, then the Exec's will work, but then you have to loop to prevent the installer from continuing the run - it's a mess. So it would be great if this kind of thing could be integrated into the scripts as an option.<br><br>Other things that would be nice would be if the uninstaller could close by default. I tried manipulating autoclose a bunch of different ways, but I couldn't get it to work. Maybe I'm doing something wrong, but I tried all the ways I could see.<br><br>Having variables so you can increment and decrement. I've been working in the registry and absolutely have to loop, so I basically have a large if x == 3, x = 4 type of deal. So that would be a nice addition.<br><br>I love this installer, saved a lot of $$$ since it's free, and have been able to do all kinds of great and crazy stuff with the scripts. I've just spent the majority of today trying to come up with a good solution for this apparently NT 4 problem, but I haven't seen it on any of the other versions of windows 95 up. It could potentially be a memory problem as the machine has 32 mb of ram total, which is pretty bad for NT 4.<br><br>Here's my code I've been using to do the uninstall, any ideas would be greatly appreciated. Thanks:<br><br>Function .onInit<br><br>strcpy $4 "FlingIt!"<br><br>ReadRegStr $9 HKEY_LOCAL_MACHINE "SOFTWARE\Microsoft\Windows\CurrentVersion\Uninstall\$4" "UninstallString"<br>strcmp $9 "" Clean PrevInst<br><br>Clean:<br>goto InitDone<br><br>PrevInst:<br><br>ReadRegStr $8 HKEY_LOCAL_MACHINE "SOFTWARE\Microsoft\Windows\CurrentVersion\Uninstall\$4" "DisplayName"<br><br>MessageBox MB_YESNO "$8 found$\nUninstall this version?" IDNO InitDone<br>ExecShell "" "$9" SW_SHOWNORMAL<br><br>InitDone:<br>FunctionEnd</p></div><hr><div class="footer"><p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p></div></div><script src="../js/highlight.pack.js" type="text/javascript"></script><script type="text/javascript">//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]></script></body></html>