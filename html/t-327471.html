<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="Startmenu Items creation" />

  <title>Startmenu Items creation - NSIS Forums</title>
  <script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script>
  <!-- Bootstrap core CSS -->

  <link rel="stylesheet" type="text/css" href="//netdna.bootstrapcdn.com/bootswatch/3.0.1/readable/bootstrap.min.css" />
  <link rel="stylesheet" href="../css/style.css" type="text/css" /><!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!--[if lt IE 9]>
                <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
                <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->
</head>

<body>
  <div class="container">
    <!-- Put navigation bar here -->

    <ol class="breadcrumb">
      <li><a href="../index.html" class="glyphicon glyphicon-home"></a></li>

      <li><a href="f-65.html">NSIS Discussion</a></li>

      <li class="active">Startmenu Items creation</li>
    </ol>

    <p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=327471">Startmenu Items creation</a></p><br />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">sunilkumar.bm</span><br />
      <span class="post-time small text-muted">17th February 2011 11:32 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>Startmenu Items creation</strong><br />
      Dear All<br />
      I'm new to NSIS and has been using it from the past one week.<br />
      I encountered a problem while installing the software created using NSIS.<br />
      As you know $SMPROGRAMS is the variable containing path to StartMenu\All Programs folder.<br />
      My code is somewhat like this<br />
      <br /></p>
      <pre>
<code>CreateDirectory "$SMPROGRAMS\TestProject"<br /> CreateShortCut "$SMPROGRAMS\TestProject\Uninstall.lnk" "$INSTDIR\Uninstall.exe" "" "$INSTDIR\Uninstall.exe" 0<br /> CreateShortCut "$SMPROGRAMS\TestProject\TestProject.lnk" "$INSTDIR\TestProject.exe" "" "$INSTDIR\TestProject.exe" 0</code>
</pre>While installing the application, if the user selects the default directory which is StartMenu\All Programs, there isn't any problem. But when he/she selects some other directory like StartMenu\All Programs\Accessories, the script is unable to get the complete path, it still remains StartMenu\All Programs. Is there any way to get the select path<br />
      <br />
      For example $INSTDIR, by default contains C:\program files, but when the user selects a different path, $INSTDIR will be changed to the selected path.<br />
      <br />
      <br />
      Regards<br />
      Sunil Kumar B M
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
      <span class="post-time small text-muted">17th February 2011 13:24 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Are you using the start menu page? If so then obviously you don't use the $SMPROGRAMS constant (it's called a constant for a reason). The examples show you how to use your own variable.<br />
      <br />
      Stu</p>
    </div>
    <hr />

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]>
  </script>
</body>
</html>
