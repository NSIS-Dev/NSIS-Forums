<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="Call DetailPrint while in EXECWAIT" />

  <title>Call DetailPrint while in EXECWAIT - NSIS Forums</title>
  <script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script>
  <!-- Bootstrap core CSS -->

  <link rel="stylesheet" type="text/css" href="//netdna.bootstrapcdn.com/bootswatch/3.0.1/readable/bootstrap.min.css" />
  <link rel="stylesheet" href="../css/style.css" type="text/css" /><!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!--[if lt IE 9]>
                <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
                <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->
</head>

<body>
  <div class="container">
    <!-- Put navigation bar here -->

    <ol class="breadcrumb">
      <li><a href="../index.html" class="glyphicon glyphicon-home"></a></li>

      <li><a href="f-65.html">NSIS Discussion</a></li>

      <li class="active">Call DetailPrint while in EXECWAIT</li>
    </ol>

    <p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=322642">Call DetailPrint while in EXECWAIT</a></p><br />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">htome</span><br />
      <span class="post-time small text-muted">22nd September 2010 20:17 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>Call DetailPrint while in EXECWAIT</strong><br />
      Hi there,<br />
      <br />
      Is it possible to update the UI while inside a EXECWAIT?<br />
      <br />
      I am installing a quite large application that doesn't give any feedback and I can't use "EXEC" as it is to difficult to verify if the large application was installed successfully.<br />
      <br />
      So my best option is to call EXECWAIT and rotate some text using DetailPrint but not sure how to do it.<br />
      <br />
      I tried by setting a timer right before I call EXECWAIT<br />
      <br />
      ${NSD_CreateTimer} OnRotateText 10<br />
      <br />
      but my function is never called.<br />
      <br />
      I am not sure if using nsExec or ExecDos will help... I haven't tried though...<br />
      <br />
      Any suggestions?<br />
      <br />
      Many thanks</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Animaether</span><br />
      <span class="post-time small text-muted">22nd September 2010 20:45 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">I don't think you can use the NSD timer within InstFiles (as there's no dialog kicking the timer off) - but putting it on its own page wouldn't do you any good either... It looks like ExecWait blocks those timers.<br />
      <br />
      As far as feedback goes.. why not DetailPrint something that tells the user that this could take a while, and then try changing the progressbar to a marquee style progressbar? ( the kind that loops around).. then change back once the execwait is done.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Animaether</span><br />
      <span class="post-time small text-muted">22nd September 2010 21:01 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">There's also some banner plugins that you could use that would have a similar effect.<br />
      <br />
      Just to get back to your actual desire, though... there is of course one other option... create a wrapper installer that executes that large installer. That wrapper installer uses ExecWait so that it can get the large installer's exit code and check for successful installation. It, then, writes this out somewhere... to a file, to the registry.. whatever.<br />
      <br />
      Then in your main installer, call -that- installer using Exec so that you're not waiting for it... and instead 'wait' by creating a loop that checks for that result (file/registry) value, does a little pause, and uses DetailPrint or whatever you want to let the user know the installer is still working, and simply waiting.<br />
      <br />
      Nasty.. but should work.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">htome</span><br />
      <span class="post-time small text-muted">22nd September 2010 21:29 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">I liked the idea of a second NSIS installer for the large install.<br />
      <br />
      Thanks</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Animaether</span><br />
      <span class="post-time small text-muted">22nd September 2010 21:41 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">keep in mind that if you use a file, the wrapper installer can't write entire tomes of information away.. otherwise the main installer might start reading the file while the wrapper is still writing to it (race condition... might try locking the file, I guess).. keep things as simple as possible :)<br />
      <br />
      ( I'm getting the feeling there's a better solution that I know about, but can't bring to the front of my mind right now )</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">htome</span><br />
      <span class="post-time small text-muted">22nd September 2010 22:20 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">I decided to use a registry value<br />
      thanks</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">jpderuiter</span><br />
      <span class="post-time small text-muted">23rd September 2010 07:24 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Why not use the ExecDos plugin as you suggested in ASYNC mode?</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">htome</span><br />
      <span class="post-time small text-muted">23rd September 2010 17:50 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">ExecDos is the winner!<br />
      It worked perfectly!<br />
      Thanks everyone!</p>
    </div>
    <hr />

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]>
  </script>
</body>
</html>
