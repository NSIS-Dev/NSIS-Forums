<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="description" content="Using a nsis installer with mIRC"><title>Using a nsis installer with mIRC - NSIS Forums</title><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script><link rel="preload" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css" as="style" onload="this.rel='stylesheet'"><link rel="preload" href="../css/style.css" as="style" onload="this.rel='stylesheet'"><noscript><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css"><link rel="stylesheet" href="../css/style.css"></noscript><script>!function(a){"use strict";var b=function(b,c,d){function e(a){return h.body?a():void setTimeout(function(){e(a)})}function f(){i.addEventListener&&i.removeEventListener("load",f),i.media=d||"all"}var g,h=a.document,i=h.createElement("link");if(c)g=c;else{var j=(h.body||h.getElementsByTagName("head")[0]).childNodes;g=j[j.length-1]}var k=h.styleSheets;i.rel="stylesheet",i.href=b,i.media="only x",e(function(){g.parentNode.insertBefore(i,c?g:g.nextSibling)});var l=function(a){for(var b=i.href,c=k.length;c--;)if(k[c].href===b)return a();setTimeout(function(){l(a)})};return i.addEventListener&&i.addEventListener("load",f),i.onloadcssdefined=l,l(f),i};"undefined"!=typeof exports?exports.loadCSS=b:a.loadCSS=b}("undefined"!=typeof global?global:this);!function(a){if(a.loadCSS){var b=loadCSS.relpreload={};if(b.support=function(){try{return a.document.createElement("link").relList.supports("preload")}catch(b){return!1}},b.poly=function(){for(var b=a.document.getElementsByTagName("link"),c=0;c<b.length;c++){var d=b[c];"preload"===d.rel&&"style"===d.getAttribute("as")&&(a.loadCSS(d.href,d,d.getAttribute("media")),d.rel=null)}},!b.support()){b.poly();var c=a.setInterval(b.poly,300);a.addEventListener&&a.addEventListener("load",function(){b.poly(),a.clearInterval(c)}),a.attachEvent&&a.attachEvent("onload",function(){a.clearInterval(c)})}}}(this);</script></head><body><div class="container"><ol class="breadcrumb"><li><a href="../index.html" class="glyphicon glyphicon-home"></a></li><li><a href="f-65.html">NSIS Discussion</a></li><li class="active">Using a nsis installer with mIRC</li></ol><p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=177193">Using a nsis installer with mIRC</a></p><br><div class="post"><p class="post-meta"><span class="post-author text-primary">DarkAkuma</span><br><span class="post-time small text-muted">19th April 2004 06:57 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>Using a nsis installer with mIRC</strong><br>Anyone have any advice on using nsis with mIRC? More specificly, im using a nsis installer to install a mIRC script ini file, and want my installer to properly load the script into mIRC. I first tried useing WriteINIStr, but ran into a problem with the way values are stored within mIRC ini's. Alot of the values are store with a entry name like n1=, n23=, n745=, or whatever. I need it to see what the last n* entry name is in the [rfiles] section of the mirc.ini, and basicly make the entry for my srcipt use the next number up, like:<br><br>if the last entry anme and value was:<br><br>n21=SomeScript.ini<br><br>id want mine to be:<br><br>n22=MyScriptDir/MyScript.ini<br><br>If im missing something, due to my little nsis experiance, that could help me. Or if theres a totaly different way to do this. Please help me out.<br><br>I looked into SendMessage too, thinking i may be able to use that to preform a command in mirc to load the script. But i dont understand it to well, so i dont even know if im interperting it right or not.<br><br>So anyone have any advice on getting my nsis installer to load my script into mirc after its installed? Preffered it to be done while mirc is closed, or both closed and open. Just while its open may complicate my install more then what im wanting. Not sure yet. Im tired, and burnt out right now. need sleep.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Joost Verburg</span><br><span class="post-time small text-muted">19th April 2004 09:11 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Create a loop that reads every key until it finds the last one.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Comm@nder21</span><br><span class="post-time small text-muted">19th April 2004 13:25 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">isn't there a enum-function available? like with registry-keys?</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Joost Verburg</span><br><span class="post-time small text-muted">19th April 2004 13:27 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Yes, but you'll have to use the System plug-in.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">DarkAkuma</span><br><span class="post-time small text-muted">19th April 2004 20:44 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Any help on finding the codeing commands i need to know to use a loop, in the help file? Or the lines of code themselves to do it?<br><br>Thats exactly what id do with mirc scripting if i ran into this problem, but when i looked through the nsis help files to find any info that might do that, i didnt find anything. =(</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Joost Verburg</span><br><span class="post-time small text-muted">19th April 2004 21:09 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">You can easily create a loop using a label and a Goto command.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">DarkAkuma</span><br><span class="post-time small text-muted">20th April 2004 04:50 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Ok. I'm just not getting this. Only been useing nsis for about 2 days now, and how to do this just isnt makeing sence. As bad as the help file was for a tutorial with mirc, the help file for nsis is about 5 times worse. I just dont understand codeing until i see an example, or it used in a script. And ive done a bunch of searching, but cant find anything that will help me understand this.<br><br>Can anyone help me out here, and give me the lines i need?<br><br>To sum it up again. When my install is run, i need it to read mirc.ini, look at the [rfiles] section, and see what the last n1, n23, n65, type number is in that section, and write to the ini in that section, n plus the next number up like "n45=MyScriptDir/MyScript.ini".</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Joost Verburg</span><br><span class="post-time small text-muted">20th April 2004 11:01 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">The NSIS Archive contains many script examples. Example of a loop:</p><pre>
<code>Var COUNT<br>Var VALUE<br><br>loop:<br><br>  IntOp $COUNT $COUNT + 1<br>  ReadIniStr $VALUE "myini.ini" "section" "n$COUNT"<br>  StrCmp $VALUE "" done loop<br>  <br>done:<br><br>  MessageBox MB_OK $COUNT</code>
</pre>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">DarkAkuma</span><br>
      <span class="post-time small text-muted">20th April 2004 21:24 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Thanks. Finaly got it working. Even put in a Check to make sure the entry for my ini isnt allready there from previous versons of my script. Seems to be working as intended. Heres how i have it now. Let me know if anything is done wrong, or if theirs any redundancy.<br>
      <br>
      loop:<br>
      <br>
      IntOp $COUNT $COUNT + 1<br>
      ReadIniStr $VALUE "$INSTDIR\mirc.ini" "rfiles" "n$COUNT"<br>
      StrCmp $VALUE "MyScriptDir\MyScript.ini" done2 loop2<br>
      <br>
      loop2:<br>
      <br>
      StrCmp $VALUE "" done loop<br>
      <br>
      done:<br>
      WriteINIStr "$INSTDIR\mirc.ini" "rfiles" "n$COUNT" "MyScriptDir\MyScript.ini"<br>
      <br>
      done2:</p>
    </div>
    <hr>

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script type="text/javascript" src="../js/highlight.pack.js" async>
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]></script></body></html>