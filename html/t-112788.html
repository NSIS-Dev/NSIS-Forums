<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="description" content="Different 'InstallDir's"><title>Different 'InstallDir's - NSIS Forums</title><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script><link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css"><link rel="stylesheet" href="../css/style.css" type="text/css"><!--[if lt IE 9]><script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script><script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script><![endif]--></head><body><div class="container"><ol class="breadcrumb"><li><a href="../index.html" class="glyphicon glyphicon-home"></a></li><li><a href="f-65.html">NSIS Discussion</a></li><li class="active">Different 'InstallDir's</li></ol><p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=112788">Different 'InstallDir's</a></p><br><div class="post"><p class="post-meta"><span class="post-author text-primary">uweb</span><br><span class="post-time small text-muted">4th November 2002 15:26 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>Different 'InstallDir's</strong><br>Hi everybody<br><br>From my component select dialogue the user can select all items<br>he wants to install. Than, he clicks on "next" and chooses the<br>destination folder.<br>So far, so good.<br><br>What I am looking for is the following:<br>If the user selects "ABC" he than choose the destination folder.<br>But "ABC" should go into a complete different folder and only in<br>the case he has selected "ABC" I want to have a *second* dialogue<br>where he can choose the destination for "ABC".<br><br>Is this possible ?<br>I have version 2.00b (or something very close to this)<br><br><br>Cheers<br>Uwe</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Jacob Metro</span><br><span class="post-time small text-muted">4th November 2002 15:49 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>SetOutPath</strong><br>I'm not sure about how to code the logic to do exactly what you want, but a method which will help you is SetOutPath's. Different INSTDIR's will be ignored by the compiler. The first one listed will be the only one to work. SetOutPath's though can be put inside seperate functions.<br>So, build one function that installs "ABC" one way, and another function to install "BCD" another way. I personally love SetOutPath.<br><br>For example,<br><br>InstallDir 'C:\WINNT'<br><br>Section "-FSIWIN"<br>SetOutPath $INSTDIR<br>File /r 'C:\Documents and Settings\Administrator\Desktop\FSIWIN'<br>SectionEnd<br><br>Section "-WHITNEYAPP"<br>SetOutPath '$INSTDIR\FSIWIN\WHITNEY.APP\'<br>File 'C:\DOCUMENTS AND SETTINGS\ADMINISTRATOR\DESKTOP\WHITNEYAPP\*.*'<br>CreateShortCut '$DESKTOP\MultiBank.lnk' '$INSTDIR\FSIWIN\WHITNEY.APP\MultiBank.exe'<br>SectionEnd<br><br>This code pulls files from $DESKTOP\FSIWIN and dumps it (recursively) into the WINNT directory. It next pulls data from $DESKTOP\WHITNEYAPP and dumps it into the WINNT\FSIWIN\WHITNEY.APP folder.<br><br>You could take out the dashes in front of the Section names and make check boxes from them. Your user then could choose which data he wants to install. And you could choose where you want that data to go.<br>Again, I'm not really sure how to build the logic necessary to do everything you want, but I think this'll help.<br>Thanks,<br>Jacob</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">kichik</span><br><span class="post-time small text-muted">4th November 2002 15:58 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">He wants a <b>second</b> directory selection dialog, not just to output to a specific directory.<br><br>What you need is InstallOptions. It allows you to create custom dialog pages. You can make a custom dialog with a directory selection box.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Sunjammer</span><br><span class="post-time small text-muted">4th November 2002 16:10 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Can you fool NSIS, maybe use .onNextPage and .onPrevPage (yes I know the paging system has changed recently, but in versions which have .onBlah...) to reshow the choose folder dialog (I spose this relies on being able to store the previously chosen instdir into a variable, can that be done?) *or* can the new page system show the folder choice dialog twice?<br><br>Sunjammer</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">uweb</span><br><span class="post-time small text-muted">4th November 2002 16:10 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Hi,<br>thanks for your replies<br><br>Maybe I was not precise enough, yes, I need a *second* directory<br>selection dialog.<br><br>Thanks for the hint, i will try to figure out how<br>InstallOptions work -:)<br><br><br>Uwe</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">kichik</span><br><span class="post-time small text-muted">4th November 2002 16:19 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">You can go back to the directory selection page, and you can show the same dialog twice. To change the text of the directory selection dialog you will have to use GetDlgItem and SendMessage. The only problem is it will save the new directory to the same $INSTDIR so you will have to save it in another variable. So, yes, it's another possible solution for this problem :D</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Nils2000</span><br><span class="post-time small text-muted">27th March 2003 16:28 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">HI<br><br>these few lines solved the problem for me (NSIS 2 Beta 3, modern UI):<br><br>;--------------------------------<br>!define MUI_CUSTOMPAGECOMMANDS ; i think you need this one<br>!define MUI_DIRECTORYPAGE<br>!define MUI_CUSTOMFUNCTION_DIRECTORY_SHOW DirectoryShow<br>!define MUI_CUSTOMFUNCTION_DIRECTORY_LEAVE DirectoryLeave<br>;--------------------------------<br>!insertmacro MUI_PAGECOMMAND_DIRECTORY ; due to MUI_CUSTOMPAGECOMMANDS<br>!insertmacro MUI_PAGECOMMAND_DIRECTORY ; you can call this one twice, but you need to !insertmacro your other pages too. Since I've got custom pages, it makes no difference for me.<br>;--------------------------------<br>; Tweak directory page<br>Function DirectoryShow<br>StrCmp $9 "1" ChangeDirectoryPage<br>StrCpy $9 "1" ; set state for next function entry<br>Goto EndDirectoryShow<br><br>ChangeDirectoryPage:<br>; change Directory page here for your second directory to query<br>StrCpy $9 "2" ; last state<br><br>EndDirectoryShow:<br>FunctionEnd<br>;--------------------------------<br>Function DirectoryLeave<br>StrCmp $9 "1" SaveInstallDir<br>StrCmp $9 "2" RestoreInstallDirAndSaveDatabaseDir<br>Goto EndDirectoryLeave<br><br>SaveInstallDir:<br>StrCpy $2 $INSTDIR ; store programm directory<br>Goto EndDirectoryLeave<br><br>RestoreInstallDirAndSaveDatabaseDir:<br>StrCpy $3 $INSTDIR ; store database directory<br>StrCpy $INSTDIR $2 ; restore programm directory<br><br>EndDirectoryLeave:<br>FunctionEnd<br>;--------------------------------<br><br>In the end you've got your directory in $3 and $INSTALLDIR contains the choosen programm directory.<br><br>Any suggestions to optimize this code are appreciated, since I don't really dig this script language.</p></div><hr><div class="footer"><p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p></div></div><script src="../js/highlight.pack.js" type="text/javascript"></script><script type="text/javascript">//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]></script></body></html>