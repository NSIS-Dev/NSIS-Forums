<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="Problems with inetc - Big bug + Understanding status messages" />

  <title>Problems with inetc - Big bug + Understanding status messages - NSIS Forums</title>
  <script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script>
  <!-- Bootstrap core CSS -->

  <link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css" />
  <link rel="stylesheet" href="../css/style.css" type="text/css" /><!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!--[if lt IE 9]>
                <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
                <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->
</head>

<body>
  <div class="container">
    <!-- Put navigation bar here -->

    <ol class="breadcrumb">
      <li><a href="../index.html" class="glyphicon glyphicon-home"></a></li>

      <li><a href="f-65.html">NSIS Discussion</a></li>

      <li class="active">Problems with inetc - Big bug + Understanding status messages</li>
    </ol>

    <p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=314477">Problems with inetc - Big bug + Understanding status messages</a></p><br />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">daucool</span><br />
      <span class="post-time small text-muted">9th November 2009 13:14 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>Problems with inetc - Big bug + Understanding status messages</strong><br />
      Hello all,<br />
      <br />
      I haven't really posted on here before, but I do a lot of NSIS work. Thanks for all the great threads that have helped me along the way!<br />
      <br />
      I wanted to report (heads up Tahkir :)) some issues with the inetc plugin which I am struggling with.<br />
      <br />
      First up, we have a couple of installers where we track the whole process of installations using requests to the web (using a combination of NSISdl and inetc). One of the installers has an unusually high fail rate compared to the other. In the tracking I decided to pass the returned inetc error message as an extra parameter, and the result was the following:<br />
      <br />
      SendRequest 631<br />
      Cancelled 150<br />
      Terminated 93<br />
      Transfer 36<br />
      File 9<br />
      SendRequestError 4<br />
      SendRequest Error 4<br />
      TransferError 3<br />
      /TIMEOUT 2<br />
      <br />
      Most of these are self-explanatory, and I believe that "SendRequestError" means that there is no internet connection? My question is, what does "SendRequest" status error mean, and why do we have so many of them on this particular installer? I've tested it from multiple locations and component is coming from a reliable CDN - any thoughts? (perhaps the CDN is truly less reliable!)<br />
      <br />
      The second issue, perhaps more serious as its a coding bug. I am forced to use NSISdl as well as inetc because NSISdl is able to make a SILENT call onInit to a tracking script.<br />
      <br />
      As it stands, if you use inetc to make a silent request onInit, the installer loads in a minimised state and it is impossible to restore it programmatically! BringToFront, SendMessage, none of these work. I had this confirmed by AfrowUK and he told me to contact Tahkir.<br />
      <br />
      Anyway, any advice on the above would be much appreciated!<br />
      <br />
      Regards,<br />
      Ucool</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Takhir</span><br />
      <span class="post-time small text-muted">9th November 2009 18:22 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Below is a list of Inetc possible result strings</p>
      <pre>
<code>static TCHAR szStatus[][32] = {<br />        _T("OK"),_T("Connecting"),_T("Downloading"),_T("Cancelled"),_T("Connecting"), //_T("Opening URL")),<br />        _T("Reconnect Pause"),_T("Terminated"),_T("Dialog Error"),_T("Open Internet Error"),<br />        _T("Open URL Error"),_T("Transfer Error"),_T("File Open Error"),_T("File Write Error"),_T("File Read Error"),<br />        _T("Reget Error"),_T("Connection Error"),_T("OpenRequest Error"),_T("SendRequest Error"),<br />        _T("URL Parts Error"),_T("File Not Found (404)"),_T("CreateThread Error"),_T("Proxy Error (407)"),<br />        _T("Access Forbidden (403)"),_T("Not Allowed (405)"),_T("Request Error"),_T("Server Error"),<br />        _T("Unauthorized (401)"),_T("FtpCreateDir failed (550)"),_T("Error FTP path (550)"),_T("Not Modified"), <br />        _T("Redirection")<br />};</code>
</pre>What are numbers near messages in you post? Is this a statistics? For me "/TIMEOUT" looks like wrong command line or a stack content. Plug-in not reads all items or reads wrong items from stack. May be because of wrong URL item you have so many SendRequest Errors. Please note that plug-in may continue reading stack for the next URL/File pair if command line is not limited with /END parameter.
    </div>
    <hr />

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]>
  </script>
</body>
</html>
