<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="Check for presence of spaces in the $INSTDIR?" />

  <title>Check for presence of spaces in the $INSTDIR? - NSIS Forums</title><!-- Bootstrap core CSS -->
  <link rel="stylesheet" type="text/css" href="//netdna.bootstrapcdn.com/bootswatch/3.0.1/readable/bootstrap.min.css" />
  <link rel="stylesheet" href="../css/style.css" type="text/css" /><!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!--[if lt IE 9]>
                <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
                <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->
</head>

<body>
  <div class="container">
    <!-- Put navigation bar here -->

    <ol class="breadcrumb">
      <li><a href="../index.html" class="glyphicon glyphicon-home"></a></li>

      <li><a href="f-65.html">NSIS Discussion</a></li>

      <li class="active">Check for presence of spaces in the $INSTDIR?</li>
    </ol>

    <p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=115747">Check for presence of spaces in the $INSTDIR?</a></p><br />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Silencerr</span><br />
      <span class="post-time small text-muted">27th November 2002 03:33 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>Check for presence of spaces in the $INSTDIR?</strong><br />
      I was wondering if its possible to write .onVerifyInstDir in a way that would check the path for the presence of any space characters and only proceed if there aren't any.<br />
      <br />
      Any help is appreciated!</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Mottel</span><br />
      <span class="post-time small text-muted">27th November 2002 12:59 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>Try this</strong><br />
      A function can call another function. Try calling the one below from your .OnVerifyInstDir function. I haven't used .OnVerifyInstDir myself yet, so you'll have to test this, but in general terms try something like this:<br /></p>
      <pre>
<code><br />;------------------------<br />Function .OnVerifyInstDir<br />;------------------------<br />; whatever<br /><br />  Push "$INSTDIR"<br />  Push " "<br />  Call StrSearch<br />  Exch<br />  Pop $0  ; $0 now = 0 or position in string of remainder<br />  Pop $0  ; $0 now = 0 or position in string of substring<br />  StrCmp $0 "0" DirGood DirBad<br /><br />DirGood:<br />  ; whatever<br />DirBad:<br />  ; whatever<br />  abort<br /><br />FunctionEnd<br /><br />;-----------------<br />Function StrSearch<br />;-----------------<br />; Searches string for a substring<br />; Adapted from Function strstr in NSIS Manual C.4<br /><br />; Inputs: stack 0 = Substring to search for<br />;         stack 1 = String to search in<br /><br />; Output: stack 0 = 0 if substring not found, else position in string of substring.<br />;         stack 1 = 0 if substring not found, else position in string of remainder<br />;                   (anything following substring).  If no remainder, this will be<br />;                   len(string) + 1.<br />;         If string is empty, always returns 0,0<br />;         If substring empty, returns 1,1<br /><br />; Usage:<br />;   Push "string"<br />;   Push "substring"<br />;   Call StrSearch<br />;   Pop $0  ; $0 now = 0 or position in string of substring<br />;   Pop $1  ; $1 now = 0 or position in string of remainder<br /><br />  Exch $3    ; Substring<br />  Exch<br />  Exch $4    ; String<br />  Push $0    ; Temp<br />  Push $1    ; Counter<br />  Push $2    ; Len<br /><br />  StrCmp $4 "" NotFound ; If String empty, we will always return 0,0<br />  StrLen $2 $3          ; Len = len(substring)<br />  StrCpy $1 0           ; initialize counter to 0<br />  Loop:<br />    StrCpy $0 $4 $2 $1  ; Temp = Len chars from String commencing from Counter+1 <br />    IntOp  $1 $1 + 1<br />    StrCmp $0 $3 Done<br />    StrCmp $0 "" NotFound<br />  Goto Loop<br />NotFound:<br />  StrCpy $1 0<br />  StrCpy $2 0<br />Done:<br />  StrCpy $3 $1             ; $3 now = pos of SubString<br />  IntOp  $4 $1 + $2        ; $4 now = pos of remainder<br />  Pop  $2<br />  Pop  $1<br />  Pop  $0<br />  Exch $4<br />  Exch<br />  Exch $3<br />FunctionEnd ; (StrSearch) ====================================<br /></code>
</pre>
    </div>
    <hr />

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]>
  </script>
</body>
</html>
