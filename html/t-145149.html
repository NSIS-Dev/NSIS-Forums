<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="description" content="Add/Remove Programs, what am i doing wrong"><title>Add/Remove Programs, what am i doing wrong - NSIS Forums</title><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script><link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css"><link rel="stylesheet" href="../css/style.css" type="text/css"></head><body><div class="container"><ol class="breadcrumb"><li><a href="../index.html" class="glyphicon glyphicon-home"></a></li><li><a href="f-65.html">NSIS Discussion</a></li><li class="active">Add/Remove Programs, what am i doing wrong</li></ol><p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=145149">Add/Remove Programs, what am i doing wrong</a></p><br><div class="post"><p class="post-meta"><span class="post-author text-primary">statblaster</span><br><span class="post-time small text-muted">8th August 2003 16:43 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>Add/Remove Programs, what am i doing wrong</strong><br>why is this not showing up in the Add/Remove programs list?<br><br><br>WriteRegStr HKLM "Software\Microsoft\Windows\CurrentVersion\Uninstall\ABC" "ABC" "$INSTDIR\uninst.exe"<br><br>WriteRegStr HKLM "Software\Microsoft\Windows\CurrentVersion\Uninstall\ABC" "ABC" "$INSTDIR\ABC.exe"<br><br><br>many thanks.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">kichik</span><br><span class="post-time small text-muted">8th August 2003 16:49 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">The value name (ABC) is wrong and some values are missing. Take a look at the following page for more information about adding entries to the Add/Remove control panel:<br><br><a href="http://nsis.sourceforge.net/archive/viewpage.php?pageid=103" target="_blank">http://nsis.sourceforge.net/archive/...php?pageid=103</a></p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Joost Verburg</span><br><span class="post-time small text-muted">8th August 2003 16:51 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"></p><pre>
<code>WriteRegStr HKLM "Software\Microsoft\Windows\CurrentVersion\Uninstall\ABC" \<br>"DisplayName" "ABC" <br><br>WriteRegStr HKLM "Software\Microsoft\Windows\CurrentVersion\Uninstall\ABC" \<br>"UninstllString" "$INSTDIR\uninst.exe"</code>
</pre>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Joel</span><br>
      <span class="post-time small text-muted">8th August 2003 16:54 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">'cuase you need this:<br></p>
      <pre>
<code><br>WriteRegStr HKLM "Software\Microsoft\Windows\CurrentVersion\Uninstall\${MUI_PRODUCT} ${MUI_VERSION}" \<br>"DisplayName" "App name"<br>WriteRegStr HKLM "Software\Microsoft\Windows\CurrentVersion\Uninstall\${MUI_PRODUCT} ${MUI_VERSION}" \<br>"UninstallString" "uninst-app.exe"<br></code>
</pre><br>
      /just for a couple of secs. :D
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">statblaster</span><br>
      <span class="post-time small text-muted">8th August 2003 17:00 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">i am sorry, i am not that great w/ this stuff.<br>
      <br>
      whats {mui_product} represent? if thats my product, what would i do w/ the example I gave, w/ "ABC"?</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Joost Verburg</span><br>
      <span class="post-time small text-muted">8th August 2003 17:33 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">See my example.</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br>
      <span class="post-time small text-muted">8th August 2003 17:33 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">That is for Modern UI installer<br>
      You should have<br>
      !define MUI_PRODUCT "my app name"<br>
      at the top of your nsi file.<br>
      If you aren't using Modern UI (you should be!!) then replace ${MUI_PRODUCT} with the directory representing your product.<br>
      <br>
      -Stu</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">statblaster</span><br>
      <span class="post-time small text-muted">8th August 2003 19:15 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">so i have,<br>
      <br>
      !define MUI_PRODUCT "ABC"<br>
      <br>
      WriteRegStr HKLM "Software\Microsoft\Windows\CurrentVersion\Uninstall\${$INSTDIR\ABC.exe} ${MUI_VERSION}" \ "DisplayName" "App name"<br>
      <br>
      WriteRegStr HKLM "Software\Microsoft\Windows\CurrentVersion\Uninstall\${$INSTDIR\ABC.exe} ${MUI_VERSION}" \ "UninstallString" "uninst.exe"<br>
      <br>
      please help me out...</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Joost Verburg</span><br>
      <span class="post-time small text-muted">8th August 2003 19:20 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">What's wrong with my example above? Didn't it work?</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">statblaster</span><br>
      <span class="post-time small text-muted">8th August 2003 19:26 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">no, it didnt work. sorry :)</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">rainwater</span><br>
      <span class="post-time small text-muted">8th August 2003 19:40 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"></p>

      <blockquote>
        <i>Originally posted by Joost Verburg</i><br>
        <b>What's wrong with my example above? Didn't it work?</b>
      </blockquote>"UninstllString" -&gt; "UninstallString"
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">statblaster</span><br>
      <span class="post-time small text-muted">8th August 2003 19:49 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">still didnt work :(</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">rainwater</span><br>
      <span class="post-time small text-muted">8th August 2003 19:59 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"></p>

      <blockquote>
        <i>Originally posted by statblaster</i><br>
        <b>still didnt work :(</b>
      </blockquote>What about it doesn't work. What are you using? I have done this a million times and have never known it not to work:<br>
      <br>
      <pre>
<code><br>  WriteRegStr HKLM "Software\Microsoft\Windows\CurrentVersion\Uninstall\ABC" "DisplayName" "ABC 1.2.3" <br>  WriteRegStr HKLM "Software\Microsoft\Windows\CurrentVersion\Uninstall\ABC" "UninstallString" "$INSTDIR\uninstall.exe"<br></code>
</pre>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">statblaster</span><br>
      <span class="post-time small text-muted">8th August 2003 20:12 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">its just not showing up in the add/ remove directory. i have attached the code:<br>
      <br>
      WriteRegStr HKLM SOFTWARE\StatBlaster "Install_Dir" "$INSTDIR"<br>
      WriteRegStr HKLM SOFTWARE\Microsoft\Windows\CurrentVersion\Run "UpdateStats" "$INSTDIR\UpdateStats.exe"<br>
      WriteRegStr HKLM "Software\Microsoft\Windows\CurrentVersion\Uninstall\StatBlaster" \"DisplayName" "StatBlaster"<br>
      WriteRegStr HKLM "Software\Microsoft\Windows\CurrentVersion\Uninstall\StatBlaster" \"UninstallString" "$INSTDIR\uninst.exe"</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">rainwater</span><br>
      <span class="post-time small text-muted">8th August 2003 20:14 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Why do you have \ in the line if its all on one line?</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">statblaster</span><br>
      <span class="post-time small text-muted">8th August 2003 20:16 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">what do you mean?</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br>
      <span class="post-time small text-muted">8th August 2003 20:18 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">You have copied Joost's code wrongly. The line breaks are supposed to be there and the back-slashes in the end of the line tell NSIS to treat the next line as an extension to the current line. If you join the lines you have to remove those back-slashes.</p>
    </div>
    <hr>

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]></script></body></html>