<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="description" content="Read a word from a line"><title>Read a word from a line - NSIS Forums</title><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script><link rel="preload" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css" as="style" onload="this.rel='stylesheet'"><link rel="preload" href="../css/style.css" as="style" onload="this.rel='stylesheet'"><noscript><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css"><link rel="stylesheet" href="../css/style.css"></noscript><script>!function(a){"use strict";var b=function(b,c,d){function e(a){return h.body?a():void setTimeout(function(){e(a)})}function f(){i.addEventListener&&i.removeEventListener("load",f),i.media=d||"all"}var g,h=a.document,i=h.createElement("link");if(c)g=c;else{var j=(h.body||h.getElementsByTagName("head")[0]).childNodes;g=j[j.length-1]}var k=h.styleSheets;i.rel="stylesheet",i.href=b,i.media="only x",e(function(){g.parentNode.insertBefore(i,c?g:g.nextSibling)});var l=function(a){for(var b=i.href,c=k.length;c--;)if(k[c].href===b)return a();setTimeout(function(){l(a)})};return i.addEventListener&&i.addEventListener("load",f),i.onloadcssdefined=l,l(f),i};"undefined"!=typeof exports?exports.loadCSS=b:a.loadCSS=b}("undefined"!=typeof global?global:this);!function(a){if(a.loadCSS){var b=loadCSS.relpreload={};if(b.support=function(){try{return a.document.createElement("link").relList.supports("preload")}catch(b){return!1}},b.poly=function(){for(var b=a.document.getElementsByTagName("link"),c=0;c<b.length;c++){var d=b[c];"preload"===d.rel&&"style"===d.getAttribute("as")&&(a.loadCSS(d.href,d,d.getAttribute("media")),d.rel=null)}},!b.support()){b.poly();var c=a.setInterval(b.poly,300);a.addEventListener&&a.addEventListener("load",function(){b.poly(),a.clearInterval(c)}),a.attachEvent&&a.attachEvent("onload",function(){a.clearInterval(c)})}}}(this);</script></head><body><div class="container"><ol class="breadcrumb"><li><a href="../index.html" class="glyphicon glyphicon-home"></a></li><li><a href="f-65.html">NSIS Discussion</a></li><li class="active">Read a word from a line</li></ol><p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=260098">Read a word from a line</a></p><br><div class="post"><p class="post-meta"><span class="post-author text-primary">Alstom</span><br><span class="post-time small text-muted">22nd November 2006 09:08 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>Read a word from a line</strong><br>hi, is it possible to read a word from a line?<br><br>Example: This is a cat.<br><br>If i want to read only the 2nd word, how do i do it??<br><br>I had used lineread, but it only read a whole line.<br><br>Is there any way to read just 1 word from a line??</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">bholliger</span><br><span class="post-time small text-muted">22nd November 2006 11:46 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Hi Alstom!<br><br>Have a look at those functions<br><br><a href="http://nsis.sourceforge.net/Docs/AppendixE.html" target="_blank">http://nsis.sourceforge.net/Docs/AppendixE.html</a><br><br>especially WordFind<br><br>Have a nice day!<br><br>Cheers<br><br>Bruno</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Alstom</span><br><span class="post-time small text-muted">23rd November 2006 01:48 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Thx Bruno<br><br>But is it possible to read a word on a line that would constantly be changed by the user?<br><br>Like on which line and which word to be read.<br><br>This is actually what i wanted to get.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">bholliger</span><br><span class="post-time small text-muted">23rd November 2006 03:33 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Yes, of course.<br><br>Just read the line with<br><br>${LineRead} "[File]" "$LineNumber" $var<br><br>and use<br><br>${WordFind} $var "[delimiter]" "$WordNumber" $R0<br><br>You can change $LineNumber and $WordNumber at runtime.<br><br>Otherwise post some real-world examples.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Alstom</span><br><span class="post-time small text-muted">23rd November 2006 03:43 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">ok, so how do i use it? What is [delimiter]?? $WordNumber is the number of the word in the sentence??<br><br>I would be changing the word in a few sentences in a file and the installer would be able to call the file to read the word i would be changing.<br><br>Could you show me a example to use this two together??<br><br>Example:<br><br>This is his dog.<br><br>How to alway read only the second word {is} or any word replacing the {is} in the sentence which could be changed anytime.<br><br>Do you understand my Q? Sorry, my english is not so gd. ;)</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">bholliger</span><br><span class="post-time small text-muted">23rd November 2006 04:16 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">This might help you:<br><br></p><pre>
<code><br>;--------------------------------<br>;Include Modern UI<br> <br>  !include "MUI.nsh"<br> <br>;--------------------------------<br>;General<br> <br>  Outfile test.exe<br> <br>;--------------------------------<br>;Pages<br> <br>  !insertmacro MUI_PAGE_INSTFILES<br><br>;--------------------------------<br>;including files<br><br>        !include TextFunc.nsh<br>        !insertmacro LineFind<br>        !include WordFunc.nsh<br>        !insertmacro WordReplace<br>        !insertmacro WordFind<br> <br>Function "MyFunction"<br>        ; $R9       current line<br>        ; $R8       current line number<br>        ; $R7       current line negative number<br>        ; $R6       current range of lines<br>        ; $R5       handle of a file opened to read<br>        ; $R4       handle of a file opened to write ($R4="" if "/NUL")<br><br>        ; you can use any string functions<br>        ; $R0-$R3  are not used (save data in them).<br>        ; ...<br><br>        ${WordFind} "$R9" " " "+2" $R0 ; get the second word<br>        ${WordReplace} $R9 " $R0 " " was " "+" $R9 ; replace the word (including delimiters)<br>        <br>        Push $0        ; If $var="StopLineFind"  Then exit from function<br>                       ; If $var="SkipWrite"     Then skip current line (ignored if "/NUL")<br>FunctionEnd<br><br> <br>Section "secDummy"<br>        ${LineFind} "test.txt" "" "2" "MyFunction"       ; 2 = line number<br>        <br>SectionEnd<br>  <br> <br>;--------------------------------<br>;Languages<br> <br>  !insertmacro MUI_LANGUAGE "English"<br><br></code>
</pre><br>
      Content of file test.txt before:<br>
      <pre>
<code><br>This is my cat.<br>This is my dog.<br>This is my cow.<br></code>
</pre><br>
      Content of file test.txt after:<br>
      <pre>
<code><br>This is my cat.<br>This was my dog.<br>This is my cow.<br></code>
</pre>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Alstom</span><br>
      <span class="post-time small text-muted">24th November 2006 08:07 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Hi , that was great!! Now i would wish to do a loop to read a file and get some content in the file til end of file.<br>
      <br>
      How do i write the loop??<br>
      <br>
      Example:<br>
      <br>
      Read the file<br>
      While(Not end of file)<br>
      Do line read<br>
      Do Word find<br>
      IF $R1 ;value of the word<br>
      Do ..........<br>
      Else<br>
      Do ..........<br>
      <br>
      How do i write the actual code for this??</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">bholliger</span><br>
      <span class="post-time small text-muted">24th November 2006 08:12 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Hi Alstom!<br>
      <br>
      To achieve this, just read the documentation for LineFind at [1] and use the skeleton provided above.<br></p>
      <pre>
<code><br>${LineFind} "test.txt" "" "1:-1" "MyFunction"<br></code>
</pre><br>
      <br>
      Cheers<br>
      <br>
      Bruno<br>
      <br>
      [1] <a href="http://nsis.sourceforge.net/Docs/AppendixE.html#E.2.2" target="_blank">http://nsis.sourceforge.net/Docs/AppendixE.html#E.2.2</a>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Alstom</span><br>
      <span class="post-time small text-muted">24th November 2006 08:15 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Hi, I am able to do the lineread and wordfind to get the word i want but how to do a loop for a file with many lines to check the word and call a function if it is the word i want.<br>
      <br>
      If $R1 = A<br>
      Do .....</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Alstom</span><br>
      <span class="post-time small text-muted">24th November 2006 08:42 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">hi, maybe i put a simple example of what i want to do below.<br>
      <br>
      Example:<br>
      WHILE ($R0 != END OF FILE)<br>
      <br>
      ${WordFind} "$R1 " "," "-2" $R1 ; Read the last 2nd word from current line<br>
      <br>
      IF $R1 = A<br>
      CopyFiles "$DESKTOP\file.exe" "$OUTDIR"<br>
      ExecWait "$OUTDIR\file.exe"<br>
      <br>
      ELSE<br>
      MessageBox MB_Ok "$$R1 not correct"<br>
      <br>
      $R1++ ;go to next line</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">bholliger</span><br>
      <span class="post-time small text-muted">24th November 2006 08:56 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">The third parameter of LineFind is to specify the range of lines you want to read! You don't need to use something like while!</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">bholliger</span><br>
      <span class="post-time small text-muted">24th November 2006 09:03 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">I think you want to parse a licence file. You could parse your license file in .onInit with LineFind and activate the sections with SelectSection from Sections.nsh. If you want to use the components dialog as well just add hidden sections to your script, which you enable from the license file, and show those the user is allowed to choose.</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Alstom</span><br>
      <span class="post-time small text-muted">27th November 2006 06:28 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">How to write not end of file in a while loop??<br>
      <br>
      ${WHILE} R0 != end of file??<br>
      <br>
      What the code for end of file??</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">bholliger</span><br>
      <span class="post-time small text-muted">27th November 2006 06:39 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Here you are:<br>
      <br></p>
      <pre>
<code><br>${LineFind} "test.txt" "" "1:-1" "MyFunction"<br></code>
</pre><br>
      1:-1 symbolises the whole file
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Alstom</span><br>
      <span class="post-time small text-muted">27th November 2006 06:44 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">i just wan the end of the file.<br>
      <br>
      for while loop.<br>
      <br>
      While $R1 &lt; "end of file"</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">bholliger</span><br>
      <span class="post-time small text-muted">27th November 2006 07:10 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><a href="http://nsis.sourceforge.net/Docs/AppendixE.html#E.2.2" target="_blank">http://nsis.sourceforge.net/Docs/AppendixE.html#E.2.2</a><br>
      <br>
      use a negative value (-1) for the last line.</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Alstom</span><br>
      <span class="post-time small text-muted">28th November 2006 01:21 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">sorry but not able to work when i i wan to put it in a while loop. how to let the loop go to the end of file??<br>
      <br>
      i have put a $R0 $R0 + 1 before the end of the loop to go to the next line but how to go to the last line of the line to stop??<br>
      <br>
      for the moment , i put :<br>
      <br>
      WHILE $R0 &lt;100<br>
      <br>
      but how to replace the 100 with the end of file???</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">bholliger</span><br>
      <span class="post-time small text-muted">28th November 2006 01:30 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Actually, I don't understand why you want to use a while loop! Just use LineFind, that's great.</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Alstom</span><br>
      <span class="post-time small text-muted">28th November 2006 01:34 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">i using a line read and wordfind to go from a line to the other line 1 by 1 to call some function if the word is found on each line.</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">bholliger</span><br>
      <span class="post-time small text-muted">28th November 2006 03:38 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Ok, have a look at the post from 23. November.<br>
      <br>
      LineFind is even better because you don't have to worry about the size of the file. LineFind calls your function for every line you specify and you get the index in a variable in the function:<br>
      <br>
      ; $R9 current line &lt;--<br>
      ; $R8 current line number &lt;---<br>
      ; $R7 current line negative number<br>
      ; $R6 current range of lines<br>
      ; $R5 handle of a file opened to read<br>
      ; $R4 handle of a file opened to write ($R4="" if "/NUL")<br>
      <br>
      This calls MyFunction for every line in the file. If you need only the last, just adjust the range as you see in the docs.<br>
      <br>
      ${LineFind} "test.txt" "" "1:-1" "MyFunction"</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">sunlight112</span><br>
      <span class="post-time small text-muted">30th November 2006 03:51 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Hi bholliger,<br>
      I has problems which related with WordFind and I post my question here.<br>
      I also try with your example which you posted above.<br>
      I try with it and it do well except one case.<br></p>
      <pre>
<code><br>Url = jdbc:mysql://127.0.0.1:3306/Openim<br></code>
</pre><br>
      I has put this line in file text in c:\test.txt<br>
      Firstly, I try with this<br>

      <blockquote>
        This is my cat
      </blockquote>And I can put "jdbc:mysql://127.0.0.1:3306/Openim" in "THIS IS MY CAT" to become "THIS jdbc:mysql://127.0.0.1:3306/Openim MY CAT"<br>
      However, I try with this <font color="blue">"Url = jdbc:mysql://127.0.0.1:3306/Openim"</font> Nothing change after I run your code above!<br>
      ${WORDFIND}is not work in my case, is it?<br>
      Can you help me!<br>
      My word is too bad, if you do not understand.Please tell me!<br>
      Thank in advance,
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">bholliger</span><br>
      <span class="post-time small text-muted">30th November 2006 03:57 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Sorry, I don't get what you want to achieve.<br>
      <br>
      Could you explain it in another way? What do you want to change in your URL = ...?</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">sunlight112</span><br>
      <span class="post-time small text-muted">30th November 2006 04:14 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Hi bholliger,<br>
      I want to change URL to run my webadmin if they run webadmin in their computer or they run it on the other computer. So, I need IP address and change URL.<br>
      I try your code and I change to like this<br></p>
      <pre>
<code><br>Function "MyFunction"<br>        ; $R9       current line<br>        ; $R8       current line number<br>        ; $R7       current line negative number<br>        ; $R6       current range of lines<br>        ; $R5       handle of a file opened to read<br>        ; $R4       handle of a file opened to write ($R4="" if "/NUL")<br><br>        ; you can use any string functions<br>        ; $R0-$R3  are not used (save data in them).<br>        ; ...<br><br>        ${WordFind} "$R9" " " "+3" $R0 ; get the third word<br>        MessageBOx MB_OK "$$R9 (string): $R9"<br>        MessageBOx MB_OK "$$R0 (word to replace): $R0"<br>        ${WordReplace} $R9 " $R0 " " jdbc:mysql://<font color="red">193.168.75.124</font>:3306/Openim " "+" $R9 ; replace the word (including delimiters)<br>        MessageBOx MB_OK "$$R9 after replace: $R9"<br>        Push $0        ; If $var="StopLineFind"  Then exit from function<br>                       ; If $var="SkipWrite"     Then skip current line (ignored if "/NUL")<br>FunctionEnd<br><br><br>Section "secDummy"<br>        ${LineFind} "c:\test.txt" "" "4" "MyFunction"    ; 2 = line number<br><br>SectionEnd<br></code>
</pre><br>
      My test.txt<br>
      <pre>
<code><br>This is my cat.<br>This was my dog<br>This is my cow.<br>Url = jdbc:mysql://127.0.0.1:3306/Openim<br></code>
</pre><br>
      This is one case which I must change in file webadmin. Also,I can not change it although I try with other case like<br>
      <font color="blue">Username = root or Password = 123456<br>
      [</font><br>
      With WORDFIND and WORDREPLACE, I can not do if in my text has "="<br>
      I do not know why it is not work?<br>
      If you know, please tell me!<br>
      Thank in advance,
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">bholliger</span><br>
      <span class="post-time small text-muted">30th November 2006 04:37 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">For your sample I'd use WordFind2X because there is a certain structure. :// and :<br>
      <br></p>
      <pre>
<code><br>  StrCpy $R2 "192.168.0.24" ; new IP<br>        <br>  ${WordFind2X} "$R9" "://" ":" "+1" $R0 ; get current value<br><br>  MessageBOx MB_OK "$$R9 (string): $R9"<br>  MessageBOx MB_OK "$$R0 (word to replace): $R0"<br>  MessageBOx MB_OK "$$R2 (IP): $R2"<br>        <br>  ${WordReplace} $R9 "$R0" "$R2" "+" $R9<br>  MessageBOx MB_OK "$$R9 after replace: $R9"<br></code>
</pre><br>
      <br>
      If you have a file with this structure:<br>
      <br>
      <pre>
<code><br>Username = root<br>Password = 123456<br></code>
</pre><br>
      use ConfigRead and ConfigWrite from [1]. It's a lot easier and you don't have to filter or know where your value in the file is.<br>
      <br>
      [1] <a href="http://nsis.sourceforge.net/Docs/AppendixE.html#E.2.9" target="_blank">http://nsis.sourceforge.net/Docs/AppendixE.html#E.2.9</a><br>
      <br>
      Have fun!<br>
      <br>
      Cheers<br>
      <br>
      Bruno
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">sunlight112</span><br>
      <span class="post-time small text-muted">30th November 2006 06:13 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Thank bholliger very much for your help<br>
      Now I can solve my problems<br>
      :)</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">bholliger</span><br>
      <span class="post-time small text-muted">30th November 2006 06:18 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">You're welcome! :-)</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">sunlight112</span><br>
      <span class="post-time small text-muted">30th November 2006 09:45 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Hi bholliger :)<br>
      I still have one question which is related with change word in file.<br>
      My file which I intend to change it influence my application.<br>
      If I change some words by hand in that file, I can run my web well. But I try with $WORDFIND, $CONFIGWRITE and $WORDREPLACE, at that time, my application is error when it runs.<br>
      I do not know why although I check file which I change.It's ok.<br>
      I wonder I use $WORDFIND... in NSIS does it display some characters in my file and it also is problems which my application is not run when I repair it.<br>
      Did you use to see this problem? I also search these errors on google but they just said "it is problem in software".In my mind, I do not think so.<br>
      Do you have any opinions about my case?<br>
      Thank a lot for your help,<br>
      :)</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">bholliger</span><br>
      <span class="post-time small text-muted">30th November 2006 10:34 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Could you post your code, please?<br>
      <br>
      How does the file look before/after?</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">sunlight112</span><br>
      <span class="post-time small text-muted">1st December 2006 01:33 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Thank bholliger,<br>
      My code here:<br></p>
      <pre>
<code><br>Function Replace<br>  StrCpy $R2 $IP   ;new IP<br>  Detailprint "$$IP : $IP"<br>  ${WordFind2X} "$R9" "://" ":" "+1" $R0 ; get current value<br>  Detailprint "$$R9 truoc khi thay the: $R9"<br>  Detailprint "$$R0 tu de thay the: $R0"<br>  Detailprint "$$R2 (IP): $R2"<br>  ${WordReplace} $R9 "$R0" "$R2" "+" $R9<br>;       ${WordReplace} $R9 " $R0 " " jdbc:mysql://127.0.0.1:3306/Openim  " "+" $R9 ; replace the word (including delimiters)<br>  Detailprint "$$R9 sau khi thay the: $R9"<br>  Push $0        ; If $var="StopLineFind"  Then exit from function<br>                 ; If $var="SkipWrite"     Then skip current line (ignored if "/NUL")<br>FunctionEnd<br><br>InstallDirRegKey HKLM "SOFTWARE\Apache Software Foundation\Tomcat\5.5" "InstallPath"<br><br>Section EditFile<br>  StrCpy $IP "localhost"<br>  StrCpy $root "root"<br>  StrCpy $passroot "123456"<br>  StrCpy $domain "telnet.com"<br>  StrCpy $useradmin "admin"<br>  StrCpy $passadmin "password"<br><br>  nsExec::Exec 'net stop "Apache Tomcat 5"'<br>  Detailprint "Stop Tomcat successfull"<br>  StrCpy $Path "$INSTDIR\webapps\webadmin\WEB-INF\classes\ApplicationResources.properties"<br>  Detailprint "$$Path :$Path"<br>  ####      Change hostname<br>  ${LineFind} "$Path" "" "2" "Replace"   ; 2 = line number<br>  ####        Change root and password of database<br>  ${ConfigWrite} "$Path" "Username" " = $root" $1<br>  Detailprint "$$1: $1"<br><br>  ${ConfigWrite} "$Path" "Password" " = $passroot" $1<br>  Detailprint "$$1: $1"<br>  ####       Change Domain<br>  ${ConfigWrite} "$Path" "domainname" "=$domain" $1<br>  Detailprint "$$1: $1"<br><br>  ####       Change rootuser and passworduser<br>;  StrCpy $domain "adminroot"<br>  ${ConfigWrite} "$Path" "Rootuser" "=$useradmin" $1<br>  Detailprint "$$1: $1"<br><br>  ${ConfigWrite} "$Path" "Rootpassword" "=$passadmin" $1<br>  Detailprint "$$1: $1"<br>  nsExec::Exec 'net start "Apache Tomcat 5"'<br>SectionEnd<br></code>
</pre><br>
      File before I change<br>
      [QUOTE]<br>
      Driver = com.mysql.jdbc.Driver<br>
      Url = jdbc:mysql://127.0.0.1:3306/Openim<br>
      Username = root<br>
      Password = 123456<br>
      <br>
      domainname=wwtkk.com<br>
      <br>
      RootUser=rootadm<br>
      RootPassword=password<br>
      {/QUOTE]<br>
      My file after I execute my installer<br>

      <blockquote>
        Driver = com.mysql.jdbc.Driver<br>
        Url = jdbc:mysql://<font color="red">localhost</font>:3306/Openim<br>
        Username = <font color="red">root</font><br>
        Password = <font color="red">123456</font><br>
        <br>
        domainname=<font color="red">telnet.com</font><br>
        <br>
        RootUser=<font color="red">admin</font><br>
        RootPassword=<font color="red">password</font>
      </blockquote>I only change these lines in my file. I can not explain why if I install with my installer,my web application is error. When I change by hand, it works well.<br>
      If you know, please tell me why?<br>
      Thank in advance,
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">bholliger</span><br>
      <span class="post-time small text-muted">1st December 2006 03:44 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">What's the error message of the application? Is your computer resolving the localhost correctly to 127.0.0.1?<br>
      <br>
      Although this is not the root of the problem, I'd use ConfigWrite like that:<br>
      <br>
      ${ConfigWrite} "$Path" "Rootuser=" "$useradmin" $1<br>
      and I'd use ${ConfigRead} to read the value of Url=, otherwise you have to make sure that this setting always appears on the second line.</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">sunlight112</span><br>
      <span class="post-time small text-muted">1st December 2006 04:39 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Hi bholliger<br></p>

      <blockquote>
        HTTPã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ 500 -<br>
        <br>
        --------------------------------------------------------------------------------<br>
        <br>
        type ä¾‹å¤–ãƒ¬ãƒãƒ¼ãƒˆ<br>
        <br>
        ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸<br>
        <br>
        èª¬æ˜Ž The server encountered an internal error () that prevented it from fulfilling this request.<br>
        <br>
        ä¾‹å¤–<br>
        <br>
        javax.servlet.ServletException<br>
        org.apache.struts.action.RequestProcessor.processException(RequestProcessor.java:545)<br>
        org.apache.struts.action.RequestProcessor.processActionPerform(RequestProcessor.java:486)<br>
        org.apache.struts.action.RequestProcessor.process(RequestProcessor.java:274)<br>
        org.apache.struts.action.ActionServlet.process(ActionServlet.java:1482)<br>
        org.apache.struts.action.ActionServlet.doPost(ActionServlet.java:525)<br>
        javax.servlet.http.HttpServlet.service(HttpServlet.java:709)<br>
        javax.servlet.http.HttpServlet.service(HttpServlet.java:802)<br>
        <br>
        <br>
        åŽŸå›_<br>
        <br>
        java.lang.NullPointerException<br>
        DataObject.Factory.UserFactory.CheckUserNamePassword(UserFactory.java:133)<br>
        webadmin.loginAction.execute(loginAction.java:43)<br>
        org.apache.struts.action.RequestProcessor.processActionPerform(RequestProcessor.java:484)<br>
        org.apache.struts.action.RequestProcessor.process(RequestProcessor.java:274)<br>
        org.apache.struts.action.ActionServlet.process(ActionServlet.java:1482)<br>
        org.apache.struts.action.ActionServlet.doPost(ActionServlet.java:525)<br>
        javax.servlet.http.HttpServlet.service(HttpServlet.java:709)<br>
        javax.servlet.http.HttpServlet.service(HttpServlet.java:802)<br>
        <br>
        <br>
        æ³¨æ„ åŽŸå›_ã®ã™ã¹ã¦ã®ã‚¹ã‚¿ãƒƒã‚¯ãƒˆãƒ¬ãƒ¼ã‚¹ã¯ã€Apache Tomcat/5.5.20ã®ãƒ_ã‚°ã«è¨˜éŒ²ã•ã‚Œã¦ã„ã¾ã™<br>
      </blockquote>This is error when I run my web application.<br>
      I am sure when I use localhost on my computer, I can run my application.<br>
      And I also check carefully in file which I change by my installer.<br>
      It is the same with file which I change by hand.<br>
      But it can not run if I run installer to repair some characters in file by $WORDFIND....<br>
      Now I can not find a solution to do it.<br>
      Did you use to see this problem?<br>
      Please help me!
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">bholliger</span><br>
      <span class="post-time small text-muted">1st December 2006 04:46 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Hmmm. Obviously there are some problems with the login. Which password is used? The Username= or RootUser=?</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">sunlight112</span><br>
      <span class="post-time small text-muted">1st December 2006 06:21 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Password is used to logging is RootUser and Rootpassword</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">bholliger</span><br>
      <span class="post-time small text-muted">1st December 2006 07:37 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Compare a working copy and an edited copy of the file with Beyond Compare <a href="http://www.scootersoftware.com/download.php" target="_blank">http://www.scootersoftware.com/download.php</a><br>
      <br>
      The Hex-Module might show the difference, if there's one...<br>
      <br>
      <a href="http://www.scootersoftware.com/download.php?c=hexview" target="_blank">http://www.scootersoftware.com/download.php?c=hexview</a></p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">sunlight112</span><br>
      <span class="post-time small text-muted">1st December 2006 10:27 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Thank bholliger,<br>
      I will try with this.</p>
    </div>
    <hr>

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script type="text/javascript" src="../js/highlight.pack.js" async>
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]></script></body></html>