<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="Postscript Font Installer" />

  <title>Postscript Font Installer - NSIS Forums</title>
  <script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script>
  <!-- Bootstrap core CSS -->

  <link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css" />
  <link rel="stylesheet" href="../css/style.css" type="text/css" /><!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!--[if lt IE 9]>
                <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
                <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->
</head>

<body>
  <div class="container">
    <!-- Put navigation bar here -->

    <ol class="breadcrumb">
      <li><a href="../index.html" class="glyphicon glyphicon-home"></a></li>

      <li><a href="f-65.html">NSIS Discussion</a></li>

      <li class="active">Postscript Font Installer</li>
    </ol>

    <p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=273825">Postscript Font Installer</a></p><br />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">trukovg</span><br />
      <span class="post-time small text-muted">3rd July 2007 21:15 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>Postscript Font Installer</strong><br />
      I am experiencing difficulty developing an installer for post script fonts (e.g .pfm font) for XP/2000.<br />
      I have researched extensively online and the NSIS site, but only found reference to TTF and FON font installaters.<br />
      <br />
      Any tips or guidance would be greatly appreciated.<br />
      THANK you in advance!</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
      <span class="post-time small text-muted">4th July 2007 19:03 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">The documentation for <a href="http://msdn2.microsoft.com/en-us/library/ms534231.aspx" target="_blank">AddFontResource</a> says it supports .pfm files. All of the functions available for TTF should work, except that you probably won't be able to get the font name automatically using the FontName plug-in.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">trukovg</span><br />
      <span class="post-time small text-muted">9th July 2007 23:06 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Thank you very much for the instructions. I worked with the website you provided, but was not successful with installing the Type 1 font file.<br />
      <br />
      I tried to use the AddFontResource function based on examples I found, but it does not add the file to the Fonts directory as expected.<br />
      <br />
      Here is my code, in case you have a chance to take a look and advise on errors I made:<br />
      --------------------------------<br />
      Section "Fonts"<br />
      SetOutPath "$INSTDIR"<br />
      File "$INSTDIR\MyFont.pfm"<br />
      File "$INSTDIR\MyFont.pfb"<br />
      <br />
      CheckWinVer:<br />
      ReadRegStr $R0 HKLM "SOFTWARE\Microsoft\Windows NT\CurrentVersion" "CurrentVersion"<br />
      IfErrors WIN-x WIN-NT<br />
      <br />
      WIN-NT:<br />
      StrCpy $R1 "Software\Microsoft\Windows NT\CurrentVersion\Fonts"<br />
      goto Reg-Add<br />
      <br />
      WIN-x:<br />
      StrCpy $R1 "Software\Microsoft\Windows\CurrentVersion\Fonts"<br />
      goto Reg-Add<br />
      <br />
      Reg-Add:<br />
      ClearErrors<br />
      ReadRegStr $R0 HKLM "$R1" "MyFont"<br />
      IfErrors 0 End<br />
      System::Call "GDI32::AddFontResourceA(t) i ('MyFont.pfm|MyFont.pfb') .s"<br />
      WriteRegStr HKLM "$R1" "My Font" "MyFont.pfm"<br />
      <br />
      End:<br />
      SendMessage ${HWND_BROADCAST} ${WM_FONTCHANGE} 0 0 /TIMEOUT=5000<br />
      SectionEnd<br />
      --------------------------------------------</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
      <span class="post-time small text-muted">13th July 2007 10:28 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Have you tried extracting the fonts to the $FONTS directory instead of $INSTDIR? You pass a relative path, but install it to somewhere AddFontResource might not expect to find the fonts.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">trukovg</span><br />
      <span class="post-time small text-muted">13th July 2007 14:46 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">That worked. Thank you so much!!!</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Yathosho</span><br />
      <span class="post-time small text-muted">18th November 2007 17:56 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">you can read the fontname from the .afm file, that many type1 fonts come with. same goes for type1 fonts in ascii format (.pfa) rather than binaries (.pfb).<br />
      <br />
      according to <a href="http://www.myfonts.com/support/help_formats_win.html#type1" target="_blank">this website</a>, type1 installation require adobe type manager on windows version priorto windows 2000.<br />
      <br />
      also type1 fonts are registered under a different keyname:<br /></p>
      <pre>
<code>HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Type 1 Installer</code>
</pre>
    </div>
    <hr />

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]>
  </script>
</body>
</html>
