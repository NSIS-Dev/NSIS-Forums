<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="description" content="Uninstall Deletes Uninstaller when invoked from Add/Remove Programs but not from..."><title>Uninstall Deletes Uninstaller when invoked from Add/Remove Programs but not from... - NSIS Forums</title><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script><link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css"><link rel="stylesheet" href="../css/style.css" type="text/css"></head><body><div class="container"><ol class="breadcrumb"><li><a href="../index.html" class="glyphicon glyphicon-home"></a></li><li><a href="f-65.html">NSIS Discussion</a></li><li class="active">Uninstall Deletes Uninstaller when invoked from Add/Remove Programs but not from...</li></ol><p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=295407">Uninstall Deletes Uninstaller when invoked from Add/Remove Programs but not from...</a></p><br><div class="post"><p class="post-meta"><span class="post-author text-primary">ronca</span><br><span class="post-time small text-muted">1st August 2008 23:05 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>Uninstall Deletes Uninstaller when invoked from Add/Remove Programs but not from...</strong><br>&nbsp; Newbie. First NSIS script ever. Based on makensis.nsi. It was a no-brainer. Just copy makensis.nsi and modify the product name, file names, etc.<br><br>However. Something strange and I don't know how to troubleshoot this: When I invoke the Uninstaller from Add/Remove Programs (Windows XP control panel), it uninstalls EVERYTHING, including the uninstaller itself, and deletes my programs directory in C:\Program Files. This is what I expect and this is what I want!<br><br>However, if I invoke the Uninstaller from the Install program itself (you know, it smartly detects whether it is already installed and offers to either re-install or uninstall), it uninstalls everything, EXCEPt for the uninstaller! which means that my programs directory in C:\Program Files is not deleted...<br><br>Is this by design? or is this a bug?<br><br>If this is by design, what is the rational behind this difference in behavior based on how the Uninstaller was invoked?<br><br>If this is a bug (in my script), how do I troubleshoot this?<br><br>Thanks,<br>Ron</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Comperio</span><br><span class="post-time small text-muted">3rd August 2008 06:15 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">I have to say, it sounds odd. One thing that comes to mind is the command to create the uninstaller is in the main installer. Could it be the uninstaller you are seeing is actually the one the installation is creating?<br><br>The other thing is the when you run the uninstaller, it copies itself to the TEMP folder and runs from there. By doing this, it should delete the original uninstaller from C:\program files.<br><br>But, if you are instead running something else to uninstall (or have use the "_?=" switch) from your installation, then that temp file copy thing may not be happening. (I assume you are just launching the uninstaller directly, but thought I'd mention it just in case.)</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">vc6</span><br><span class="post-time small text-muted">4th August 2008 15:27 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>Re: Uninstall Deletes Uninstaller when invoked from Add/Remove Programs but not from.</strong><br>&nbsp;</p><blockquote><i>Originally posted by ronca</i><br><b>Is this by design? or is this a bug?</b></blockquote>Ron, I checked for you the makensis.nsi example (the most recent one) and sure enough in Function <b>PageLeaveReinstall</b> there is:<br><pre>
<code>
    ExecWait '$R1 _?=$INSTDIR'
<br><br>    IfErrors no_remove_uninstaller
<br>    IfFileExists"$INSTDIR\makensis.exe" no_remove_uninstaller 
<br>&gt;
</code>
</pre>So, your problem appears to be caused by the "_?=" switch as suggested by Comperio. Read the FAQ:<br>
      <br>

      <blockquote>
        <b>When I use ExecWait uninstaller.exe it doesn't wait for the uninstaller. Why?</b><br>
        NSIS uninstaller copies itself to the temporary directory, runs the temporary uninstaller create and then exits. This is done so it will be able to delete itself. To force the uninstaller not to do this use:<br>
        <br>
        <b>ExecWait '"$INSTDIR\uninstall.exe" _?=$INSTDIR'</b>
      </blockquote>Now the question that comes to mind is why did the makensis.nsi example writer choose to NOT WAIT for the uninstaller...<br>
      <br>
      HTH,<br>
      Victor
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">KrisAster</span><br>
      <span class="post-time small text-muted">4th August 2008 19:54 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">It also might be something as simple as the directory is still open while the uninstall is running. It could potentially be held open by your script, or by windows explorer navigated to that directory.</p>
    </div>
    <hr>

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]></script></body></html>