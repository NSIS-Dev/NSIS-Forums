<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="Help Button" />

  <title>Help Button - NSIS Forums</title>
  <script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script>
  <!-- Bootstrap core CSS -->

  <link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css" />
  <link rel="stylesheet" href="../css/style.css" type="text/css" /><!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!--[if lt IE 9]>
                <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
                <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->
</head>

<body>
  <div class="container">
    <!-- Put navigation bar here -->

    <ol class="breadcrumb">
      <li><a href="../index.html" class="glyphicon glyphicon-home"></a></li>

      <li><a href="f-65.html">NSIS Discussion</a></li>

      <li class="active">Help Button</li>
    </ol>

    <p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=330535">Help Button</a></p><br />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">hanenjom</span><br />
      <span class="post-time small text-muted">11th May 2011 18:36 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>Help Button</strong><br />
      Please can you help me,<br />
      <br />
      i need to add a Help Button, and in my Result i need to have a window (.ini), i have a solution<br />
      HelpButton::show /NOUNLOAD "232,231" "Help" "Dialog" "/file=C:\NSIS\.....\file.ini" wrap 20<br />
      but i hve in result the .ini in lines no a window.<br />
      how can i change the HelpButton.dll to display my file.ini.<br />
      <br />
      <br />
      think you</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
      <span class="post-time small text-muted">11th May 2011 21:33 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">The window only displays text. You can't have it showing a custom page. If you want to have a custom page with help information on it, either put it in another executable and extract and run it or add a custom page and only show it when your help button is pressed (don't need HelpButton for this).<br />
      <br />
      Stu</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">T.Slappy</span><br />
      <span class="post-time small text-muted">12th May 2011 05:39 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">I dont entirely understand but isn't there possibility to create dialog with nsDialogs?</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">jiake</span><br />
      <span class="post-time small text-muted">12th May 2011 08:24 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">You can use nsWindows, it could create dialog box.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">hanenjom</span><br />
      <span class="post-time small text-muted">12th May 2011 14:47 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">think for your answers,<br />
      <br />
      but my problem is "how could I call a page from a help button that will contain components such as GroupBox and Label".<br />
      <br />
      <br />
      Please help me</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
      <span class="post-time small text-muted">12th May 2011 15:17 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><a href="http://nsis.sourceforge.net/Go_to_a_NSIS_page" target="_blank">http://nsis.sourceforge.net/Go_to_a_NSIS_page</a><br /></p>

      <ol style="list-style-type: decimal">
        <li>Add a help button (if it's via Resource Hacker then use ButtonEvent plug-in on it)</li>

        <li>On click, set a global Var (i.e. $ShowHelp) to 1</li>

        <li>Jump to your help page</li>
      </ol><br />
      In your help page's show function, call Abort if $ShowHelp != 1. Also ensure you reset $ShowHelp to 0 when you leave the help page.<br />
      <br />
      The only issue really is that when you enter the help page, the back or next buttons won't take you back to where you were when you clicked the Help button. For that reason to be honest it'd be easier to have a pop-up.<br />
      <br />
      Stu
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">hanenjom</span><br />
      <span class="post-time small text-muted">12th May 2011 16:12 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>Re</strong><br />
      Hi, in fact am little bit confused here, the pop-up you mentioned earlier you mean a message_box or a whole custom page? cause this last one always ,as you know ,contains the three useless button, (next,back and cancel ).<br />
      thnks</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
      <span class="post-time small text-muted">12th May 2011 18:06 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">If you want a custom page pop-up, use nsWindows (as mentioned already) which is a modified version of nsDialogs. The other option as I said would be to bundle another NSIS EXE which has one custom page and extract and run that (probably messier than nsWindows).<br />
      <br />
      Stu</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">jiake</span><br />
      <span class="post-time small text-muted">13th May 2011 07:03 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Create a pop-up dialog with web control, list view and tree view with checkboxes.<br />
      <a href="http://forums.winamp.com/attachment.php?attachmentid=48828" target="_blank"></a><a href="http://forums.winamp.com/attachment.php?attachmentid=48828" target="_blank">http://forums.winamp.com/attachment....chmentid=48828</a><br />
      <a href="http://forums.winamp.com/attachment.php?attachmentid=48829" target="_blank"></a><a href="http://forums.winamp.com/attachment.php?attachmentid=48829" target="_blank">http://forums.winamp.com/attachment....chmentid=48829</a><br />
      See this example script.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">hanenjom</span><br />
      <span class="post-time small text-muted">13th May 2011 10:16 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>thx</strong><br />
      think you for your help, its working :), i can finally have my custom Dialog :).<br />
      <br />
      thx</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">hanenjom</span><br />
      <span class="post-time small text-muted">13th May 2011 17:29 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>button to close</strong><br />
      Please i need a button to close my custom popup , and return to the origin page.<br />
      i create the button, but i have a problem with the event to add on to close.<br />
      can you help me please?<br />
      thx</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
      <span class="post-time small text-muted">13th May 2011 18:08 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Send WM_CLOSE to the window (the handle returned from ::Create) using SendMessage.<br />
      <br />
      Stu</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">jiake</span><br />
      <span class="post-time small text-muted">14th May 2011 03:07 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">In this example I use $0 multiple times for dialog handle and other controls. If you want to send message to dialog handle, make sure the value of the variable for dialog's handle in dialog creation function is always the same, use the variable only once.<br />
      <br />
      nsWindows::Create $HWNDPARENT 0 ${WS_VISIBLE}|${WS_SYSMENU}|${WS_CAPTION} "Pop-up dialog" 1018<br />
      Pop $0 # handle of dialog<br />
      <br />
      If you use $0 for dialog handle, the variable wouldn't be used again in all event funtions of controls on this dialog. I think you should know.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">hanenjom</span><br />
      <span class="post-time small text-muted">16th May 2011 08:25 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>re</strong><br />
      hi,<br />
      <br />
      please, I still can not find how to leave the window and return to the calling page via the button :confused:.<br />
      <br />
      I need your help.<br />
      <br />
      thx.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">hanenjom</span><br />
      <span class="post-time small text-muted">16th May 2011 14:03 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">hi,<br />
      <br />
      please, I still can not find how to leave the window and return to the calling page via the button .<br />
      <br />
      I need your help.<br />
      <br />
      thx.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
      <span class="post-time small text-muted">16th May 2011 14:28 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">In your button event use:<br />
      SendMessage $handle ${WM_CLOSE} 0 0<br />
      Where $handle has been mentioned already.<br />
      <br />
      Stu</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">hanenjom</span><br />
      <span class="post-time small text-muted">27th May 2011 10:14 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>re</strong><br />
      Hi<br />
      <br />
      I try to do this for my close button<br />
      <br />
      Function help<br />
      ${NSW_CreateButton} 50% 84% 10% 5% "OK"<br />
      Pop $R1<br />
      <br />
      ${NSW_OnClick} $R1 CloseCustomDialog<br />
      <br />
      nsWindows::Show<br />
      FunctionEnd<br />
      <br />
      Function CloseCustomDialog<br />
      <br />
      SendMessage $HWNDPARENT ${WS_CLOSE} 0 0<br />
      <br />
      FunctionEnd<br />
      <br />
      and it's still not working :stare:<br />
      <br />
      Please help me.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
      <span class="post-time small text-muted">27th May 2011 10:23 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">It's WM_CLOSE not WS_CLOSE. Where did you get WS_CLOSE from? You should be seeing a compiler warning "unknown variable/constant "{WS_CLOSE}" detected, ignoring" if you haven't defined WS_CLOSE. Don't ignore ANY compiler warnings.<br />
      <br />
      Stu</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">hanenjom</span><br />
      <span class="post-time small text-muted">27th May 2011 10:52 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>re</strong><br />
      if i use ${WM_Close} , i will close the window for help and the parnet window ...</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
      <span class="post-time small text-muted">27th May 2011 14:27 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">That's because you're using $HWNDPARENT which is a handle to the NSIS window. You want the handle returned from nsWindow::Create as we have already explained.<br />
      <br />
      Stu</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">hanenjom</span><br />
      <span class="post-time small text-muted">30th May 2011 11:08 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>re</strong><br />
      thx for your answers, now i can close my Dialog.<br />
      <br />
      juste my problem is how retur to the parent window?<br />
      <br />
      I have a custom page, when i click in my help button i lost my custom page , she disappears.<br />
      <br />
      how could I stay on the same custom page during the call and help when I close my dialog?<br />
      <br />
      can you help me please.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">hanenjom</span><br />
      <span class="post-time small text-muted">30th May 2011 11:43 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">hi, please i use the help button , but i have a problem,<br />
      when I click in my help button I lost my parent page and I have a other page,<br />
      how can I still in my parent Page.<br />
      my parent page is a custom page.<br />
      <br />
      I use this code :<br />
      when i click in my button help i call "CreateHelpButton"<br />
      <br />
      Function CreateHelpButton<br />
      <br />
      nsDialogs::Create 1018<br />
      Pop $0<br />
      <br />
      StrCmp $0 error 0 +2<br />
      Abort<br />
      call CreateCustomDialog<br />
      <br />
      nsDialogs::Show<br />
      <br />
      FunctionEnd<br />
      <br />
      Function CreateCustomDialog<br />
      <br />
      Pop $0<br />
      nsWindows::Create $0 0 ${WS_VISIBLE}|${WS_SYSMENU}|${WS_CAPTION} "Help dialog" 1018<br />
      Pop $1<br />
      <br />
      ${NSW_SetWindowSize} $1 500 350<br />
      ${NSW_CenterWindow} $1 $HWNDPARENT<br />
      <br />
      StrCmp $1 error 0 +2<br />
      Abort<br />
      <br />
      EnableWindow $0 0<br />
      <br />
      ${NSW_CreateGroupBox} 3% 4% 90% 10% "blabal"<br />
      Pop $R0<br />
      ${NSW_CreateLabel} 8% 8% 70% 5% "blabal"<br />
      Pop $R1<br />
      <br />
      ${NSW_CreateGroupBox} 3% 19% 90% 10% "blabal"<br />
      Pop $R2<br />
      ${NSW_CreateLabel} 8% 23% 70% 5% "blabal"<br />
      Pop $R3<br />
      <br />
      ${NSW_CreateGroupBox} 3% 34% 90% 10% "blabal"<br />
      Pop $R4<br />
      ${NSW_CreateLabel} 8% 38% 70% 5% "blabal"<br />
      Pop $R5<br />
      <br />
      ${NSW_CreateGroupBox} 3% 49% 90% 10% "blabal"<br />
      Pop $R6<br />
      ${NSW_CreateLabel} 8% 53% 70% 5% "blabal"<br />
      Pop $R7<br />
      <br />
      ${NSW_CreateGroupBox} 3% 64% 90% 10% "blabal"<br />
      Pop $R8<br />
      ${NSW_CreateLabel} 8% 68% 70% 5% " blabal"<br />
      Pop $R9<br />
      <br />
      ${NSW_CreateButton} 50% 84% 10% 5% "OK"<br />
      Pop $R1<br />
      <br />
      ${NSW_OnClick} $R1 CloseCustomDialog<br />
      nsWindows::Show<br />
      FunctionEnd<br />
      <br />
      Function CloseCustomDialog<br />
      <br />
      SendMessage $1 ${WM_CLOSE} 0 0<br />
      <br />
      FunctionEnd</p>
    </div>
    <hr />

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]>
  </script>
</body>
</html>
