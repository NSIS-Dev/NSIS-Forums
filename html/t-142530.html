<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="font name from its file name" />

  <title>font name from its file name - NSIS Forums</title>
  <script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script>
  <!-- Bootstrap core CSS -->

  <link rel="stylesheet" type="text/css" href="//netdna.bootstrapcdn.com/bootswatch/3.0.1/readable/bootstrap.min.css" />
  <link rel="stylesheet" href="../css/style.css" type="text/css" /><!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!--[if lt IE 9]>
                <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
                <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content=" font name from its file name" />

  <title>font name from its file name - NSIS Forums</title>
  <link rel="stylesheet" type="text/css" href="//netdna.bootstrapcdn.com/bootswatch/3.0.1/readable/bootstrap.min.css" />
  <link rel="stylesheet" href="../css/style.css" type="text/css" />
</head>

<body>
  <div class="container">
    <!-- Put navigation bar here -->

    <ol class="breadcrumb">
      <li><a href="../index.html" class="glyphicon glyphicon-home"></a></li>

      <li><a href="f-65.html">NSIS Discussion</a></li>

      <li class="active">font name from its file name</li>
    </ol>

    <p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=142530">font name from its file name</a></p><br />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Yathosho</span><br />
      <span class="post-time small text-muted">17th July 2003 15:46 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>font name from its file name</strong><br />
      is there a possibility to query a font file for the fonts name?<br />
      <br />
      example: comic.ttf is called 'comic sans ms' and registered as such.<br />
      <br />
      i know one can specify that when one uses font installation functions for nsis, but it would be useful (for my script) to get around that.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
      <span class="post-time small text-muted">17th July 2003 15:54 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Try opening a font into Notepad and see the layout of the file.<br />
      You can then probably read from this file and get hold of the chunk you need.<br />
      <br />
      -Stu</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Joost Verburg</span><br />
      <span class="post-time small text-muted">17th July 2003 15:58 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Do you want to get the name of a registered or unregistered font?<br />
      <br />
      Do you want to get the file from a name or the name from a file?</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Yathosho</span><br />
      <span class="post-time small text-muted">17th July 2003 17:35 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">i want to read the font name (to register it under that name) from the ttf file. so, unregistered font and name from file.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Joost Verburg</span><br />
      <span class="post-time small text-muted">17th July 2003 18:15 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">You can write a plug-in using this code:<br />
      <br />
      <a href="http://www.codeproject.com/gdi/fontnamefromfile.asp" target="_blank">http://www.codeproject.com/gdi/fontnamefromfile.asp</a></p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Vytautas</span><br />
      <span class="post-time small text-muted">8th November 2003 21:56 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">So has anyone writen a plug-in fot this?<br />
      <br />
      Vytautas</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Joost Verburg</span><br />
      <span class="post-time small text-muted">8th November 2003 21:59 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">There is no such plug-in available in the archive, but you can easily write one using the code above.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Vytautas</span><br />
      <span class="post-time small text-muted">8th November 2003 22:30 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Only problem is that my C/C++ skills are almost non existent and I do not have access to MS VC copmiler. I think that it would be quite difficult to convert that code into delphi.<br />
      <br />
      Vytautas</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Vytautas</span><br />
      <span class="post-time small text-muted">8th November 2003 23:24 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">I tried to create this plugin with C++ Builder 6 but I get "Undefined Symbol: 'CFile'" and "Undefined Symbol: 'CString'" errors did I miss a really obvious include or do I need VC for this to work?<br />
      <br />
      Vytautas</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">rsegal</span><br />
      <span class="post-time small text-muted">9th November 2003 03:22 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">CFile and CString are MFC classes. Are you building the project with MFC included? I think visual c++ includes this automatically when you use any MFC data type. Sounds like you need to do something different for C++ builder.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Vytautas</span><br />
      <span class="post-time small text-muted">9th November 2003 11:04 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">OK, in that case are there any equivalents that dont use MFC or is there a way do accomplish this task with just the ANSI C/C++. Cos after a quick look on the net I discovered that getting MFC to work with Borlan C++ Builder is next to impossible, good old Microsoft.<br />
      <br />
      Vytautas</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
      <span class="post-time small text-muted">9th November 2003 11:20 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><a href="http://www.codeproject.com/gdi/xfont.asp#xx651625xx" target="_blank">http://www.codeproject.com/gdi/xfont.asp#xx651625xx</a><br />
      <br />
      GetFontProperties is what you're looking for.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Vytautas</span><br />
      <span class="post-time small text-muted">9th November 2003 11:36 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Thanks kichik I will try to make the plugin tomorrow.<br />
      <br />
      I just noticed one thing. The name of the font from the file is used for the display name in the registry, thats the reason I need this plugin, however the name in the registry has (TrueType) appended to the end of the name if its a TTF file however if tis a FON file it has either (All res) or (VGA res).<br />
      <br />
      Is this always the case with TTF files and is there a way to find out which type is the FON font?<br />
      <br />
      Vytautas</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
      <span class="post-time small text-muted">9th November 2003 12:24 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Well, TTF stands for TrueType Font, so unless the file name is wrong, it should be TrueType. There is another page in CodeProject, in the same category that shows how to get the font type from the file. Maybe that would help.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Joost Verburg</span><br />
      <span class="post-time small text-muted">9th November 2003 12:28 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">That application above gets the name from both registry and file.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Vytautas</span><br />
      <span class="post-time small text-muted">9th November 2003 22:05 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Yes joost but I need to get the name of the font so that I can add it to the registry when installing the font. Kichik I will check out that page.<br />
      <br />
      Vytautas</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Vytautas</span><br />
      <span class="post-time small text-muted">10th November 2003 05:35 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Attached is a plugin to get the name of a TTF Font from the file. Considering that this plugin only works with TTF files the previous post about registry name change can be disregarded.<br />
      <br />
      Vytautas<br />
      <br />
      PS. Attached file contains the source code with the project files for DEV-C++<br />
      <br />
      PPS. I will create an archive page about this plugin later tonight including usage examples.<br />
      <br />
      PPPS. You should call this plugin using this command:</p>
      <pre>
<code>FontName::Name 'Location of TTF font file'</code>
</pre>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Vytautas</span><br />
      <span class="post-time small text-muted">10th November 2003 13:32 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">kickik, or someone else, could you please upload this plugin to the archive. For a more detailed example of the plugins usage check out my font registration page in the archive as it utilizes this plugin.<br />
      <br />
      Vytautas</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
      <span class="post-time small text-muted">10th November 2003 20:43 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Uploaded.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Yathosho</span><br />
      <span class="post-time small text-muted">18th November 2003 21:47 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">thats a very nice plugin, but i want suggest adding the fontstyle to the output.<br />
      <br />
      try the plugin on all ttf files of the arial family. the plugin will always display<br />
      <br />
      <i>Arial (TrueType)</i><br />
      <br />
      not<br />
      <br />
      <i>Arial Bold (TrueType)</i><br />
      <i>Arial Italics (TrueType)</i><br />
      etc.<br />
      <br />
      without fontstyle, fonts of the same family aren't distinguishable.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Vytautas</span><br />
      <span class="post-time small text-muted">18th November 2003 22:24 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Thanks, I will try to find out how to add that support.<br />
      <br />
      Vytautas</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Vytautas</span><br />
      <span class="post-time small text-muted">18th November 2003 23:35 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">OK found where the problem was, the original code replaces the name with the family name of the font if the font name was '' and for some reason the code is not reading the name. Will post when a fix is found.<br />
      <br />
      Vytautas</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Vytautas</span><br />
      <span class="post-time small text-muted">19th November 2003 03:07 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Fixed, also removed unused info from the plugin, made it slightly smaller. :) Could someone please update the archive file with this.<br />
      <br />
      Vytautas</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Vytautas</span><br />
      <span class="post-time small text-muted">19th November 2003 12:12 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Optimized the plugin size a little more.<br />
      <br />
      Vytautas :D</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
      <span class="post-time small text-muted">19th November 2003 14:09 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Updated.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Vytautas</span><br />
      <span class="post-time small text-muted">21st November 2003 09:03 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">I have struck a problem with my plugin. It seems to generate a BSOD in Win98SE. Could anyone help me test this, e.g. try with different versions of windows to see which platforms have this problem.<br />
      <br />
      Also what is the best way to debug a NSIS Plugin. I used Dev-C++ to create it, source code is included in the plugin.<br />
      <br />
      Any help is greatly appreaciated.<br />
      <br />
      Vytautas :cry:</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
      <span class="post-time small text-muted">21st November 2003 17:54 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">According to Dev-C++'s changelog, they have added an option to debug DLLs in version 4.9.8.2 so it should be there somewhere if you're using this version. I suggest you first get more information about the crash, the exact text to start with.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Vytautas</span><br />
      <span class="post-time small text-muted">24th November 2003 01:02 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">The error I get is this:</p>

      <blockquote>
        <font face="courier new">A fatal exception OE has occured at 0028:C02A3531 in VXD VWIN32(05) + 00002059. The current application will be terminated.</font>
      </blockquote>This error only seems to occur in Win9x.<br />
      <br />
      kickik when I asked how to debug a plugin I meant how do I tell NSIS to run the debug dll instead of the normal.<br />
      <br />
      Vytautas
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
      <span class="post-time small text-muted">24th November 2003 01:10 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">You simply put it in the Plugins directory and use it like every other plug-in. For NSIS it's just another DLL.<br />
      <br />
      <a href="http://nsis.sf.net/changelog.php" target="_blank"><font size="1">.</font></a></p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Vytautas</span><br />
      <span class="post-time small text-muted">24th November 2003 01:17 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">I'm not so good with C++ so I don't know if I'm on the right path here or not, but I thought that if you wanted to let's say step through the execution of a dll you had to link it the the application that used that dll.<br />
      <br />
      Vytautas</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
      <span class="post-time small text-muted">24th November 2003 11:25 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">That's true, you need to tell your debugger to run an installer that will use the debug version of the DLL. Once you do that you can set breakpoints and whatnot wherever you want in the DLL.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Vytautas</span><br />
      <span class="post-time small text-muted">24th November 2003 12:56 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">So I do not need to modify the script in any way for it to work, e.g. I do net have to tell it to use the debug plugin dll instead of the one it got built with.<br />
      <br />
      Vytautas</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
      <span class="post-time small text-muted">24th November 2003 13:06 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">If they are the same name, you don't have to change a thing. If you have named the debug build MyPluginDebug, then you'll have to change every MyPlugin::func to MyPluginDebug::func. NSIS only cares about the name of the DLL and its exports. If both are the same, you don't have to change anything in the script.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Vytautas</span><br />
      <span class="post-time small text-muted">25th November 2003 22:31 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">kickik that didn't quite work as expected but I found and fixed the problem with 'creative' debugging. I used lots of message boxes in the plugin to see where it died and then played around with the code.<br />
      <br />
      Here is the fixed plugin. Could someone upload it to the archive.<br />
      <br />
      Vytautas</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Vytautas</span><br />
      <span class="post-time small text-muted">25th November 2003 22:44 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">kickik as an afterthought the bug involved me using a 'char *sFileName' which caused an error in Win9x when I changed it to 'char sFileName[4096]' it worked ok. Is 4096 going to be large enough to hold any path?<br />
      <br />
      Vytautas</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Joost Verburg</span><br />
      <span class="post-time small text-muted">26th November 2003 07:34 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">The maximum length is MAX_PATH (260).</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
      <span class="post-time small text-muted">26th November 2003 12:51 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">And you can always add a check just to make sure.<br />
      <br />
      Do you want to upload a new version or is the one you just uploaded good to go?</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Vytautas</span><br />
      <span class="post-time small text-muted">26th November 2003 22:44 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">I'll upload a new version a little later. Just about to finish an implementation of error checking/reporting.<br />
      <br />
      Vytautas</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
      <span class="post-time small text-muted">26th November 2003 23:37 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">You should use this to get the fonts folder:<br />
      <br />
      System::Call "Shell32::SHGetSpecialFolderLocation(i $HWNDPARENT, i ${CSIDL_...}|${CSIDL_FLAG_CREATE}, *i .r0)"<br />
      System::Call "Shell32::SHGetPathFromIDList(i r0, t .r0)"<br />
      <br />
      The code you currently have on the Archive corrupts the stack because of wrong quotes ('System... b 'false' ...) and doesn't work without Internet Explorer 3 or 4 (I don't remember the exact version).<br />
      <br />
      This code is missing the free line for the PIDL though. I can't figure out how to do that in the moment but it is possible thanks to COM support in the latest System.dll. Maybe it'll just be easier to add that to your plug-in, since you already have one...</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">brainsucker</span><br />
      <span class="post-time small text-muted">26th November 2003 23:59 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">System::Call "Shell32::SHGetSpecialFolderLocation(i $HWNDPARENT, i ${CSIDL_...}|${CSIDL_FLAG_CREATE}, *i .r0)"<br />
      System::Call "Shell32::SHGetPathFromIDList(i r0, t .r1)"<br />
      <br />
      System::Call 'shell32::SHGetMalloc(*i . r2)' ; IMalloc<br />
      System::Call '$2-&gt;5(i r0)' ; -&gt;Free<br />
      System::Call '$2-&gt;2()' ; -&gt;Release<br />
      <br />
      Ugly, i know. :)<br />
      don't forget to change shgetpathfromidlist output from t.r0 to t.rANOTHER.</p>
    </div>
    <hr />
    <!-- Bootstrap core CSS -->
    <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
                <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
                <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->

    <div class="container">
      <!-- Put navigation bar here -->

      <ol class="breadcrumb">
        <li><a href="../index.html" class="glyphicon glyphicon-home"></a></li>

        <li><a href="f-65.html">NSIS Discussion</a></li>

        <li class="active">font name from its file name</li>
      </ol>

      <p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=142530">font name from its file name</a></p><br />

      <div class="post">
        <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
        <span class="post-time small text-muted">27th November 2003 00:06 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

        <p class="post-content">brainsucker to the rescue! :)<br />
        <br />
        Thanks.</p>
      </div>
      <hr />

      <div class="post">
        <p class="post-meta"><span class="post-author text-primary">Vytautas</span><br />
        <span class="post-time small text-muted">27th November 2003 03:08 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

        <p class="post-content">Firstly when I enabled error checking I found that when the plugin failed, sometimes on win9x PC's, it was because it could not open the font file. The GetLastError function returns code 87 - ERROR_INVALID_PARAMETER, yet this function works fine on WinNT family and seams to work on win9x sometimes. I had the installer working on one 98 machine and a few minutes later the same installer failed on the same machine :confused: .<br />
        <br />
        Secondly I will update the archive page with brainsucker's code. BTW what is the define value of CSIDL_FLAG_CREATE.<br />
        <br />
        Vytautas</p>
      </div>
      <hr />

      <div class="post">
        <p class="post-meta"><span class="post-author text-primary">Vytautas</span><br />
        <span class="post-time small text-muted">27th November 2003 03:30 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

        <p class="post-content">This is getting weirder by the minute now its comming up with error 32 - ERROR_SHARING_VIOLATION. Which would make more sense but I still can quite figgure this out.<br />
        <br />
        Vytautas :igor:</p>
      </div>
      <hr />

      <div class="post">
        <p class="post-meta"><span class="post-author text-primary">Vytautas</span><br />
        <span class="post-time small text-muted">27th November 2003 03:38 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

        <p class="post-content">oops, forgot to attach file just in casesomeone want to play-around with it and maybe help me figgure this problem out. If there is an error in the plugin it will push an error string to the stack instead of the font name. So just check for 'error:' at the start of the poped string and handle as you wish.<br />
        <br />
        Vytautas</p>
      </div>
      <hr />

      <div class="post">
        <p class="post-meta"><span class="post-author text-primary">lewellyn</span><br />
        <span class="post-time small text-muted">27th November 2003 04:00 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

        <p class="post-content">According to kichik earlier today, !define CSIDL_FLAG_CREATE 0x8000</p>
      </div>
      <hr />

      <div class="post">
        <p class="post-meta"><span class="post-author text-primary">Vytautas</span><br />
        <span class="post-time small text-muted">27th November 2003 06:30 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

        <p class="post-content">OK this appears to have fixed the plugin. I will Update all of the related Archive pages later tonight. This version of the plugin includes error reporting functionality.<br />
        <br />
        brainsucker :up: thank you for your help as the problem does not seem to be with the plugin but with the function I used to get the font folder, certainly very weird.<br />
        <br />
        Vytautas :D</p>
      </div>
      <hr />

      <div class="post">
        <p class="post-meta"><span class="post-author text-primary">lewellyn</span><br />
        <span class="post-time small text-muted">27th November 2003 06:42 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

        <p class="post-content">I guess I'll head into the office tomorrow after my holiday dinner (or maybe Friday ;)) and test it out... If there are still issues, I'm bound to run into them... :igor:<br />
        <br />
        Again, thanks for all your hard work on this!<br />
        <br />
        --Matt</p>
      </div>
      <hr />

      <div class="post">
        <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
        <span class="post-time small text-muted">3rd December 2003 13:23 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

        <p class="post-content">Just a little addition so the font directory detection will work on Windows 9x too:<br />
        <br />
        System::Call 'shell32::SHGetMalloc(*i . r2)' ; IMalloc<br />
        System::Call "Shell32::SHGetSpecialFolderLocation(i $HWNDPARENT, i ${CSIDL_FONTS}, *i .r0)"<br />
        System::Call "Shell32::SHGetPathFromIDList(i r0, t .r1)"<br />
        System::Call '$2-&gt;5(i r0)' ; -&gt;Free<br />
        System::Call '$2-&gt;2()' ; -&gt;Release<br />
        StrCmp $1 "" 0 done<br />
        System::Call "Shell32::SHGetSpecialFolderLocation(i $HWNDPARENT, i ${CSIDL_FONTS}|${CSIDL_FLAG_CREATE}, *i .r0)"<br />
        System::Call "Shell32::SHGetPathFromIDList(i r0, t .r1)"<br />
        System::Call '$2-&gt;5(i r0)' ; -&gt;Free<br />
        System::Call '$2-&gt;2()' ; -&gt;Release<br />
        done:<br />
        <br />
        It seems Windows 9x doesn't like CSIDL_FLAG_FLAG... :(<br />
        <br />
        BTW, soon enough you'll have a NSIS variable named $FONTS which will do this for you.</p>
      </div>
      <hr />

      <div class="post">
        <p class="post-meta"><span class="post-author text-primary">Vytautas</span><br />
        <span class="post-time small text-muted">3rd December 2003 22:21 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

        <p class="post-content">kichik, didn't the older function work well in Win9x. I did several tests and after I included the 'create' flag as in the old function all the errors seemed to disappear.<br />
        <br />
        Looking forward to the $FONTS variable :D<br />
        <br />
        Vytautas</p>
      </div>
      <hr />

      <div class="post">
        <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
        <span class="post-time small text-muted">4th December 2003 14:34 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

        <p class="post-content">Well, on all of my tests and according to MSDN CSIDL_FLAG_CREATE doesn't work on Windows 9x. At first I thought Windows 9x would just ignore it, assuming it's an unknown flag, but instead it just failed.</p>
      </div>
      <hr />

      <div class="footer">
        <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
      </div>
    </div><script src="../js/highlight.pack.js" type="text/javascript">
</script> <script type="text/javascript">
//<![CDATA[
    hljs.initHighlightingOnLoad();
    //]]>
    </script>
  </div>
</body>
</html>
