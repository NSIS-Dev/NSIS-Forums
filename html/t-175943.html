<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="HELP! NSIS Installers do not function when launched from Director apps under Win98!!" />

  <title>HELP! NSIS Installers do not function when launched from Director apps under Win98!! - NSIS Forums</title>
  <script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script>
  <!-- Bootstrap core CSS -->

  <link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css" />
  <link rel="stylesheet" href="../css/style.css" type="text/css" /><!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!--[if lt IE 9]>
                <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
                <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->
</head>

<body>
  <div class="container">
    <!-- Put navigation bar here -->

    <ol class="breadcrumb">
      <li><a href="../index.html" class="glyphicon glyphicon-home"></a></li>

      <li><a href="f-65.html">NSIS Discussion</a></li>

      <li class="active">HELP! NSIS Installers do not function when launched from Director apps under Win98!!</li>
    </ol>

    <p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=175943">HELP! NSIS Installers do not function when launched from Director apps under Win98!!</a></p><br />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Wasteland</span><br />
      <span class="post-time small text-muted">9th April 2004 07:00 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>HELP! NSIS Installers do not function when launched from Director apps under Win98!!</strong><br />
      So, we're supposed to Gold Master City of Heroes in, uh, like 12 hours. Our publisher set up a snazzy MacroMedia Director Auto-run that lets you click the "Install the Game" button. Problem is, under Windows 98, no NSIS installer with more than 1 page will function when launched from Director! I get to the install page where you choose a location and it checks how much space is available and the Next or Install button is always greyed out. Running the installer from Explorer works fine.<br />
      <br />
      To top this off, this behavior seems to only exhibit itself when running the installer from a CD or network share (even a writeable one, so it doesn't care about read-only).<br />
      <br />
      I've placed the Director launcher up at <a href="http://www.horningabout.com/temp/City_of_Heroes.zip" target="_blank">http://www.horningabout.com/temp/City_of_Heroes.zip</a> . Download this file to a network share, compile Example2.nsi or MUI/basic.nsi and rename it to Setup.exe in the same folder, run the Director program, click Install, and you'll see that it won't let you actually install.<br />
      <br />
      Please, can someone help me? I'm looking at workarounds at the moment (probaly having my wrapper installer spawn off the actual installer using something other than "Exec" and hope it can detach completely).<br />
      <br />
      This seems like a pretty ugly bug in NSIS somewhere. If any of the devs are available, please help, lest the hundreds of thousands of City of Heroes fans curse my name for choosing NSIS over one of those "reliable and tested" install systems!<br />
      <br />
      Feel free to contact me via ICQ: 435337 or MSN:Wastelnd@hotmail.com or AIM: wasteland777 or Y! Messenger: Wasteland7 if you are NSIS dev and want to help debug this.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Wasteland</span><br />
      <span class="post-time small text-muted">9th April 2004 07:09 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Clarification/new info: The installer only fails if the Director program has been closed since the installer was launched (in this case the Director program closes instantly upon launching the installer, since the installer requires the user to switch to a second CD at some point)</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Wasteland</span><br />
      <span class="post-time small text-muted">9th April 2004 07:15 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Ugh. Maybe this is something you don't even want to deal with (or can't).<br />
      <br />
      I launch the installer through the Director program, the Next&gt; button is greyed out. Hit Back, hit Next, still greyed out. Launch a *new* copy of the Director program. Hit Back, hit Next in the *first* installer I launched, *and now the Next button is no longer greyed out*. What the heck is going on?!? Am I insane? This makes no sense.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Wasteland</span><br />
      <span class="post-time small text-muted">9th April 2004 09:44 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Okay, it wasn't anything as crazy as I originally thought it was (fears of Director having a sandbox intercepting files I/O or something insane like that).<br />
      <br />
      The bug appears to be in the function is_valid_instpath() in util.c, the last check in the function appears to be trying to determine if the root of the drive exists, but is actually checking to see if the current working directory on the drive exists, which it is not guaranteed to, like in this case where the current working directory was a temporary folder made by Director that was deleted upon exit.<br />
      <br />
      Changing that line of code to look at "X:\" instead of "X:" fixed the issue and now the installer works on Windows 98 as well. Yay!<br />
      <br />
      My fix was by adding the two lines:<br />
      tmp[2]='\\';<br />
      tmp[3]=0;<br />
      right before the GetFileAttributes() call. Since I'll be the first to admit I know nothing about the NSIS code base (first looked at it today), someone let me know if there's something wrong with that, but it seemed to work fine =).</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
      <span class="post-time small text-muted">9th April 2004 13:57 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Thanks for the report. Fixed in latest CVS version. Note that latest CVS version's LZMA implementation doesn't work with Windows 95.<br />
      <br />
      As the directory can be specified using UNC, you should replace your addition with:</p>
      <pre>
<code>addtrailingslash(tmp);</code>
</pre>As for:

      <blockquote>
        Ugh. Maybe this is something you don't even want to deal with (or can't).
      </blockquote>Don't forget we're not even on the same timezone ;)
    </div>
    <hr />

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]>
  </script>
</body>
</html>
