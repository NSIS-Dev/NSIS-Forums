<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="Why doesn't this work?" />

  <title>Why doesn't this work? - NSIS Forums</title><!-- Bootstrap core CSS -->
  <link rel="stylesheet" type="text/css" href="//netdna.bootstrapcdn.com/bootswatch/3.0.1/readable/bootstrap.min.css" />
  <link rel="stylesheet" href="../css/style.css" type="text/css" /><!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!--[if lt IE 9]>
                <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
                <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->
</head>

<body>
  <div class="container">
    <!-- Put navigation bar here -->

    <ol class="breadcrumb">
      <li><a href="../index.html" class="glyphicon glyphicon-home"></a></li>

      <li><a href="f-65.html">NSIS Discussion</a></li>

      <li class="active">Why doesn't this work?</li>
    </ol>

    <p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=205141">Why doesn't this work?</a></p><br />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Chilli24</span><br />
      <span class="post-time small text-muted">17th January 2005 12:21 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>Why doesn't this work?</strong><br />
      Hi...I don't know why doesn't this work:<br />
      <br />
      InstallDirRegKey HKLM "Software\MyCompany\MyKey" "Root path"<br />
      <br />
      Function .onInit<br />
      <br />
      StrCpy $INSTDIR InstallDirRegKey\folder1<br />
      <br />
      FunctionEnd<br />
      <br />
      Section "Copy files" SEC01<br />
      <br />
      SetOutPath $INSTDIR\Components<br />
      SetOverwrite on<br />
      File "source\${DLLname1}"<br />
      File "source\${DLLname2}"<br />
      <br />
      SectionEnd<br />
      <br />
      When I run this install the path is shown as: "InstallDirRegKey\folder1"...i want it to be "C:\rootFolder\folder1", where "C:\rootFolder" is in the registry.<br />
      So, can anyone help me? I'm a newbie :)...Thanks.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Takhir</span><br />
      <span class="post-time small text-muted">17th January 2005 12:43 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">StrCpy $INSTDIR "$INSTDIR\folder1"</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Chilli24</span><br />
      <span class="post-time small text-muted">17th January 2005 12:58 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Thanks Takhir but I want to use InstallDirRegKey, not INSTDIR. I want the installer to take the path from regisstry, not to be predefined by me. Can you help me with that?</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Takhir</span><br />
      <span class="post-time small text-muted">17th January 2005 13:09 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">InstallDirRegKey is Attribute, not a variable.<br />
      <i>"This attribute tells the installer to check a string in the registry, and use it for the install dir if that string is valid. If this attribute is present, it will override the InstallDir attribute if the registry key is valid, otherwise it will fall back to the InstallDir default."</i><br />
      So installer reads InstallDirRegKey to $INSTDIR if key is valid or uses InstallDir attribute otherwise.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Chilli24</span><br />
      <span class="post-time small text-muted">17th January 2005 13:16 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">I have done exactly like you said but it's just showing me : "\folder1".</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Takhir</span><br />
      <span class="post-time small text-muted">17th January 2005 13:27 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Before sending first reply I tested attached script on my Win2K server, NSIS 2.04 and I could see correct paths. The question may be when installer checks for InstallDirRegKey in the registry, but this is strange... It looks like your registry node exists and it's value is "" or registry has not this string and InstallDir is not defined.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Chilli24</span><br />
      <span class="post-time small text-muted">17th January 2005 13:57 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Thanks man...The problem was that I have entered the path in the registry wrong.Now it works.</p>
    </div>
    <hr />

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]>
  </script>
</body>
</html>
