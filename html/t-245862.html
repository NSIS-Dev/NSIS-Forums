<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="Automated (not Silent) Installer" />

  <title>Automated (not Silent) Installer - NSIS Forums</title>
  <script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script>
  <!-- Bootstrap core CSS -->

  <link rel="stylesheet" type="text/css" href="//netdna.bootstrapcdn.com/bootswatch/3.0.1/readable/bootstrap.min.css" />
  <link rel="stylesheet" href="../css/style.css" type="text/css" /><!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!--[if lt IE 9]>
                <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
                <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->
</head>

<body>
  <div class="container">
    <!-- Put navigation bar here -->

    <ol class="breadcrumb">
      <li><a href="../index.html" class="glyphicon glyphicon-home"></a></li>

      <li><a href="f-65.html">NSIS Discussion</a></li>

      <li class="active">Automated (not Silent) Installer</li>
    </ol>

    <p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=245862">Automated (not Silent) Installer</a></p><br />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Wabiloo</span><br />
      <span class="post-time small text-muted">10th May 2006 10:55 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>Automated (not Silent) Installer</strong><br />
      I've created a rather complex installer for my application, that "intelligently" finds what components to install, how to fill in the default values in the custom pages, etc. according to what's already on the computer. This is (at the moment) all done in the custom page functions.<br />
      <br />
      I would like now to make the installer fully automated, ie. not require the user to click the "next" button manually.<br />
      However, I don't want it to be silent. First, because I would have to rewrite the whole thing so that the logic wouldn't be in the custom page functions (I discovered that the page functions are not called at all in a silent installer). Anyway, I want to see the GUI, even if I want to not have to interact with it.<br />
      <br />
      Is there a way, just after a page (be it custom page or standard MUI page) is displayed, to automatically go to the next page (as if the "next" button had been clicked)?<br />
      <br />
      I notice that if in a custom page I put a messagebox just after the call to MUI_INSTALLOPTIONS_DISPLAY, it will not appear until I actually click the "next" button...</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">o_owd</span><br />
      <span class="post-time small text-muted">10th May 2006 11:15 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">you can make the installer to proccess your custom pages too when making a silent install.<br />
      <br />
      have a look at this thread, maybe it helps...<br />
      <a href="http://forums.winamp.com/showthread.php?s=&amp;threadid=239240" target="_blank">http://forums.winamp.com/showthread....hreadid=239240</a><br />
      <br />
      OJi.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Wabiloo</span><br />
      <span class="post-time small text-muted">10th May 2006 12:29 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Yes, but that what I meant when I said I didn't want to rewrite the whole thing. Plus, I actually want to see the screens, just not want to click them.<br />
      <br />
      What I'd like is some way of having each page show for 3 seconds, then the next button is "clicked" automatically.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">o_owd</span><br />
      <span class="post-time small text-muted">10th May 2006 13:45 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">i understood what you want.<br />
      i just wanted to show you that it can be made in silent too. you don't have to rewrite everything.<br />
      i had the same problem and with the help from the thread i specified i managed to do it. :)<br />
      <br />
      sorry, but i don't know how to make what you want.<br />
      the solution will come, just be pacient. somebody from this forum will help you. they allways do ! :up:<br />
      <br />
      OJi.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">galil</span><br />
      <span class="post-time small text-muted">10th May 2006 17:33 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Clicking a button is a simple matter of sending a bm_click message to installer window.<br />
      Problem here is that I don't think (though I might be wrong) there's a way to send it from installer itself when it finishes creating a page and waits for user input.<br />
      So you have to compile an external proggy to do the job and run it from your main installer.<br />
      Conceptual script for the proggy:<br /></p>
      <pre>
<code>SetCompress off<br />Name "Autoclick"<br />OutFile "Autoclick.exe"<br /><br />!include WinMessages.nsh<br /><br />Function .onInit<br />loop:<br />Sleep 3000 ;wait some (optional)<br />FindWindow $0 "#32770" ;search for the NSIS window<br />StrCmp $0 0 end ;quit if not found<br />     GetDlgItem $0 $0 1 ;get handle of the proceed button<br />     SendMessage $0 ${BM_CLICK} "" "" ;click the button<br />     Goto loop ;repeat<br />end:<br />Quit<br />FunctionEnd<br /><br />Section ""<br />SectionEnd</code>
</pre><br />
      In your main script, add something like this:<br />
      <pre>
<code>!define MUI_CUSTOMFUNCTION_GUIINIT myGuiInit<br />  <br />Function myGuiInit<br />ClearErrors<br />Exec "$EXEDIR\Autoclick.exe"<br />IfErrors 0 +2<br />MessageBox MB_OK "Could not launch Autoclick! Manual step through."<br />FunctionEnd</code>
</pre>
    </div>
    <hr />

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]>
  </script>
</body>
</html>
