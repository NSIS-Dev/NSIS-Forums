<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="description" content="Validation check"><title>Validation check - NSIS Forums</title><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script><link rel="preload" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css" as="style" onload="this.rel='stylesheet'"><link rel="preload" href="../css/style.css" as="style" onload="this.rel='stylesheet'"><noscript><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css"><link rel="stylesheet" href="../css/style.css"></noscript><script>!function(a){"use strict";var b=function(b,c,d){function e(a){return h.body?a():void setTimeout(function(){e(a)})}function f(){i.addEventListener&&i.removeEventListener("load",f),i.media=d||"all"}var g,h=a.document,i=h.createElement("link");if(c)g=c;else{var j=(h.body||h.getElementsByTagName("head")[0]).childNodes;g=j[j.length-1]}var k=h.styleSheets;i.rel="stylesheet",i.href=b,i.media="only x",e(function(){g.parentNode.insertBefore(i,c?g:g.nextSibling)});var l=function(a){for(var b=i.href,c=k.length;c--;)if(k[c].href===b)return a();setTimeout(function(){l(a)})};return i.addEventListener&&i.addEventListener("load",f),i.onloadcssdefined=l,l(f),i};"undefined"!=typeof exports?exports.loadCSS=b:a.loadCSS=b}("undefined"!=typeof global?global:this);!function(a){if(a.loadCSS){var b=loadCSS.relpreload={};if(b.support=function(){try{return a.document.createElement("link").relList.supports("preload")}catch(b){return!1}},b.poly=function(){for(var b=a.document.getElementsByTagName("link"),c=0;c<b.length;c++){var d=b[c];"preload"===d.rel&&"style"===d.getAttribute("as")&&(a.loadCSS(d.href,d,d.getAttribute("media")),d.rel=null)}},!b.support()){b.poly();var c=a.setInterval(b.poly,300);a.addEventListener&&a.addEventListener("load",function(){b.poly(),a.clearInterval(c)}),a.attachEvent&&a.attachEvent("onload",function(){a.clearInterval(c)})}}}(this);</script></head><body><div class="container"><ol class="breadcrumb"><li><a href="../index.html" class="glyphicon glyphicon-home"></a></li><li><a href="f-65.html">NSIS Discussion</a></li><li class="active">Validation check</li></ol><p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=323116">Validation check</a></p><br><div class="post"><p class="post-meta"><span class="post-author text-primary">starfighter5</span><br><span class="post-time small text-muted">13th October 2010 16:10 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>Validation check</strong><br>&nbsp; Hi all,<br><br>I have an installer that I am creating that asks the user to input two text fields using an installoptions custom page.<br><br>I am trying to get the installer to check if the fields are empty and then display an error message if either or both are empty. I have managed to get this to work using the following code for one of the text fields but how can i get it to check both of them?<br><br></p><pre>
<code>;Page5<br>Page custom page5 ValidateCustom<br>Function page5<br>!insertmacro MUI_HEADER_TEXT "Folders" "Please share folders out and set share names here"<br>#Display the page<br>!insertmacro MUI_INSTALLOPTIONS_DISPLAY "page5"<br>!insertmacro MUI_INSTALLOPTIONS_READ $1 "page5" "Field 2" "State"<br>!insertmacro MUI_INSTALLOPTIONS_READ $2 "page5" "Field 3" "State"<br>FunctionEnd<br><br>Function ValidateCustom<br>  !insertmacro INSTALLOPTIONS_READ $1 "page5" "Field 2" "State"<br>    !insertmacro INSTALLOPTIONS_READ $2 "page5" "Field 3" "State"<br>  StrCmp $1 "" 0 +3<br>    MessageBox MB_ICONEXCLAMATION|MB_OK "Please enter your name."<br>    Abort<br>FunctionEnd</code>
</pre>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Animaether</span><br>
      <span class="post-time small text-muted">13th October 2010 16:19 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">I highly recommend using LogicLib:<br>
      <a href="http://nsis.sourceforge.net/LogicLib" target="_blank">http://nsis.sourceforge.net/LogicLib</a><br>
      <br></p>
      <pre>
<code>
FunctionEnd 
<br>&gt;
</code>
</pre>I also recommend switching from InstallOptions to nsDialogs:<br>
      <a href="http://nsis.sourceforge.net/Docs/nsDialogs/Readme.html" target="_blank">http://nsis.sourceforge.net/Docs/nsDialogs/Readme.html</a><br>
      <br>
      but that's another thread %)
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">starfighter5</span><br>
      <span class="post-time small text-muted">13th October 2010 16:45 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Thanks for that, having used your code thought it prompts me with the error message if there is anything in the boxes or not.<br>
      <br>
      am I missing something?</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Animaether</span><br>
      <span class="post-time small text-muted">13th October 2010 17:27 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">If you didn't get any warnings.. not that I can think of;<br>
      <br></p>
      <pre>
<code>
OutFile "$%temp%\temp.exe"<br>Section<br>SectionEnd<br><br>!include "InstallOptions.nsh"<br><br>Function .onInit<br>  !insertmacro INSTALLOPTIONS_EXTRACT "page5"<br>FunctionEnd<br><br>Page custom CustomPageFunction<br><br>Function CustomPageFunction<br>  !insertmacro INSTALLOPTIONS_DISPLAY "page5"<br>  Call ValidateCustom<br>FunctionEnd<br><br><br>Function ValidateCustom<br>  !insertmacro INSTALLOPTIONS_READ $1 "page5" "Field 2" "State"<br>  !insertmacro INSTALLOPTIONS_READ $2 "page5" "Field 3" "State"<br>  MessageBox MB_OK "***91;$1***93;***91;$2***93;" /* to see what the values are */<br>  ${If} "$1" == ""<br>  ${OrIf} "$2" == ""<br>    MessageBox MB_ICONEXCLAMATION|MB_OK "Please enter your name."<br>    Abort<br>  ${EndIf}<br>FunctionEnd 
<br>&gt;
</code>
</pre>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">starfighter5</span><br>
      <span class="post-time small text-muted">9th December 2010 15:31 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">I have finally managed to find some time to go back to this installer, I have this in place...<br>
      <br></p>
      <pre>
<code>
FunctionEnd 
<br>&gt;
</code>
</pre>Which works to a degree, problem is if I select 'Cancel' it brings the message 'Please ensure both fields are filled in. It does this regardless of wether the fields are filled in or not.<br>
      <br>
      Anyone any ideas?
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br>
      <span class="post-time small text-muted">9th December 2010 15:42 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">You must read the values from the INI file in the page leave function.<br>
      <br>
      Stu</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">starfighter5</span><br>
      <span class="post-time small text-muted">9th December 2010 15:47 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Hi,<br>
      <br>
      I have taken the easy route out and used MinLen=1 in the .ini file. This way I don't get the message displaying but it should be pretty obvious to the end user what they have done wrong.<br>
      <br>
      Now I just got to work out if I can use the same approach for radio buttons....</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">starfighter5</span><br>
      <span class="post-time small text-muted">9th December 2010 16:43 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Doesn't seem to be as simple with radio buttons! I have three radio buttons on the one page.<br>
      <br>
      I just want the page to not allow the user to go to the next one without selecting a button.</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br>
      <span class="post-time small text-muted">9th December 2010 17:02 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Like I said you need to check the contents of the INI file in the page LEAVE function. You are doing your checks in the page CREATE function. The INI file is not updated until the leave function is called. I recommend switching to nsDialogs. It makes stuff like this much easier.<br>
      <br>
      Stu</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">starfighter5</span><br>
      <span class="post-time small text-muted">10th December 2010 11:02 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Hi Stu,<br>
      <br>
      After some extensive reading I have now realised also that using nsDialogs would have been a better route to take! Seen as I only have to resolve this last issue with the installer I am going to try and stick with InstallOptions for this project......<br>
      <br>
      I am struggling to find some examples or an explanation of a LEAVE function.<br>
      <br>
      Can you point me in the right direction of some reading material or explain it for me?</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">jpderuiter</span><br>
      <span class="post-time small text-muted">10th December 2010 11:11 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Check the testnotify script in the InstallOptions examples</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">starfighter5</span><br>
      <span class="post-time small text-muted">10th December 2010 13:46 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Ok, using the example in <a href="http://nsis.sourceforge.net/Examples/InstallOptions/testnotify.nsi" target="_blank">http://nsis.sourceforge.net/Examples...testnotify.nsi</a> I have come up with this, only problem is it displays the Error message if anything is selected or not......<br>
      <br></p>
      <pre>
<code>
Page6
<br>Page custom page6 page6leave
<br>&gt;Function page6
<br>&gt;!insertmacro MUI_HEADER_TEXT "Checkboxes" "Please select a checkbox"
<br>&gt;#Display the page
<br>&gt;!insertmacro MUI_INSTALLOPTIONS_DISPLAY "page6"
<br>&gt;!insertmacro MUI_INSTALLOPTIONS_READ $R1 "page6" "Field 1" "State"
<br>&gt;!insertmacro MUI_INSTALLOPTIONS_READ $R2 "page6" "Field 2" "State"
<br>&gt;!insertmacro MUI_INSTALLOPTIONS_READ $R3 "page6" "Field 3" "State"
<br>&gt;FunctionEnd
<br><br>&gt;Function page6leave
<br> ReadINIStr$0 "page6.ini" "Field 1" "State"
<br> StrCmp $0 1 done
<br>  ReadINIStr$0 "page6.ini" "Field 2" "State"
<br> StrCmp $0 1 done
<br>  ReadINIStr$0 "page6.ini" "Field 3" "State"
<br> StrCmp $0 1 done
<br>    MessageBox MB_ICONEXCLAMATION</code>|MB_OK "You must select at least one install option!"
<br>    Abort
<br>    done:
<br><br>&gt;FunctionEnd 
<br>&gt;

</pre>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">jpderuiter</span><br>
      <span class="post-time small text-muted">11th December 2010 11:29 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Use the MUI_INSTALLOPTIONS_READ macro (like you did in function "page5") instead of the ReadINIStr function.<br>
      And you better use the LogicLib library, as said before.</p>
    </div>
    <hr>

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script type="text/javascript" src="../js/highlight.pack.js" async>
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]></script></body></html>