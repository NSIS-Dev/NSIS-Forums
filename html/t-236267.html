<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="description" content="NSIS unstall resources"><title>NSIS unstall resources - NSIS Forums</title><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script><link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css"><link rel="stylesheet" href="../css/style.css" type="text/css"><!--[if lt IE 9]><script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script><script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script><![endif]--></head><body><div class="container"><ol class="breadcrumb"><li><a href="../index.html" class="glyphicon glyphicon-home"></a></li><li><a href="f-65.html">NSIS Discussion</a></li><li class="active">NSIS unstall resources</li></ol><p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=236267">NSIS unstall resources</a></p><br><div class="post"><p class="post-meta"><span class="post-author text-primary">princy</span><br><span class="post-time small text-muted">24th January 2006 04:17 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>NSIS unstall resources</strong><br>i'm creating a java application using derby,java connecting Quickbooks.i want the script to install resouces like derby,jvm,qbbridge,xerces parser (and set classpath)automatically during installation so tht client dosen't need to install it.plzz do help me<br>J.Princy</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">dandaman32</span><br><span class="post-time small text-muted">24th January 2006 05:00 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">If those programs use EXE or MSI databases you can usually do a silent (unattended) install.<br><br>For an EXE, this varies, but NSIS installers run silently if you pass the /S switch on the command line.<br><br>To install an MSI database, you can use this macro:<br></p><pre>
<code><br>!macro InstallMSI FILE TEXT<br>  Exch $0<br>  Push $1<br>  Push $OUTDIR<br>  GetTempFileName $1<br>  StrCpy $1 $1 -4<br>  SetOutPath $TEMP<br>  File "/oname=$1.msi" "${FILE}"<br>  Banner::show /NOUNLOAD `${TEXT}`<br>    ExecWait '"$SYSDIR\msiexec.exe" /qn /i "$1.msi"'<br>  Banner::destroy<br>  Delete "$1.msi"<br>  Pop $OUTDIR<br>  Pop $1<br>  Exch $0<br>!macroend<br></code>
</pre><br>
      <br>
      And to invoke it:<br>
      <br>
      <pre>
<code><br>Section<br>  !insertmacro InstallMSI "C:\Path\To\MSI\File\On\Dev\Machine.msi" "Text displayed while installing"<br>SectionEnd<br></code>
</pre><br>
      In this case, the compiler would compress "C:\Path\To\MSI\File\On\Dev\Machine.msi" into the NSIS installer and the MSI file will be extracted at runtime and installed. Note that this function installs the MSI database without showing any UI. To show a full UI, change the "/qn" to "/qf" in the ExecWait line.<br>
      <br>
      You can set class paths with WriteRegStr.<br>
      <br>
      -dandaman32
    </div>
    <hr>

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]></script></body></html>