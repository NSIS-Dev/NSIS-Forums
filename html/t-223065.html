<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="Forcefully Aborting installation" />

  <title>Forcefully Aborting installation - NSIS Forums</title>
  <script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script>
  <!-- Bootstrap core CSS -->

  <link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css" />
  <link rel="stylesheet" href="../css/style.css" type="text/css" /><!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!--[if lt IE 9]>
                <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
                <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->
</head>

<body>
  <div class="container">
    <!-- Put navigation bar here -->

    <ol class="breadcrumb">
      <li><a href="../index.html" class="glyphicon glyphicon-home"></a></li>

      <li><a href="f-65.html">NSIS Discussion</a></li>

      <li class="active">Forcefully Aborting installation</li>
    </ol>

    <p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=223065">Forcefully Aborting installation</a></p><br />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Sajida_cts</span><br />
      <span class="post-time small text-muted">1st August 2005 11:20 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>Forcefully Aborting installation</strong><br />
      Hi,<br />
      I have just shipped my installer for testing. One of the major bugs which came up was that during installation if the installer is forcefully aborted by going to Task Manager-&gt;Processes, the installation wont happen again during a subsequent double-click. Which is understandable considering that I'm putting in a registry key check at the beginning of installationa nd taking it off only if the installation succeeds or the user cancels the installation. Is there any way I can handle the forceful abortion of the installation??<br />
      I know it is a stupid bug, but please help me out...<br />
      Thanks,<br />
      Saaji</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
      <span class="post-time small text-muted">1st August 2005 11:48 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">I don't think it's possible from the installer side, because when you terminate a program from task manager, you're killing the process, hence the process is no longer running.<br />
      What you could do is write another installer which has code in .onInit only (so it's hidden) which has an infinite loop (with say Sleep 5000 in it) which constantly checks if your installer is running (with FindWindow). If it isn't then it changes the registry key and exits (Abort). Obviously you want to compress this into your main installer, and extract it and run it from .onInit too.<br />
      <br />
      Edit: If you don't want the user to run the installer twice (at the same time) you can use a Mutex:<br /></p>
      <pre>
<code><br /> System::Call 'kernel32::CreateMutexA(i 0, i 0, t "my install") i .r1 ?e'<br />  Pop $R0<br /><br /> StrCmp $R0 0 +2<br />  Abort         ; abort if another install is running<br /></code>
</pre><br />
      <br />
      -Stu
    </div>
    <hr />

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]>
  </script>
</body>
</html>
