<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="Search for files, any easier way?" />

  <title>Search for files, any easier way? - NSIS Forums</title><!-- Bootstrap core CSS -->
  <link rel="stylesheet" type="text/css" href="//netdna.bootstrapcdn.com/bootswatch/3.0.1/readable/bootstrap.min.css" />
  <link rel="stylesheet" href="../css/style.css" type="text/css" /><!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!--[if lt IE 9]>
                <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
                <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->
</head>

<body>
  <div class="container">
    <!-- Put navigation bar here -->

    <ol class="breadcrumb">
      <li><a href="../index.html" class="glyphicon glyphicon-home"></a></li>

      <li><a href="f-65.html">NSIS Discussion</a></li>

      <li class="active">Search for files, any easier way?</li>
    </ol>

    <p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=173629">Search for files, any easier way?</a></p><br />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kukomamasan</span><br />
      <span class="post-time small text-muted">17th March 2004 00:46 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>Search for files, any easier way?</strong><br />
      hi back again, before im going into 24 hours of reading in the forum, witch i have allready done :-), im having some difficulties implenting a search script, and not sure if you really have to make 2 pages of script to make this installer search for a file on any location on any drive letter possibel. so far i have this section i wanna work with:<br />
      <br />
      Function .onInit<br />
      ReadRegStr $R0 HKLM "SOFTWARE\Microsoft\Windows\CurrentVersion\App Paths\GhostRecon.exe" "path"<br />
      StrCmp $R0 "" NotPresent Present<br />
      <br />
      notpresent:<br />
      StrCpy $INSTDIR "$programfiles\Red Storm Entertainment\Ghost Recon\Mods\Navy SEALS_V2"<br />
      MessageBox MB_ICONQUESTION|MB_YESNO "Couldent Find The Location Of [..\Ghost Recon\Mods], Want This Installer To Search For The Right Location?" IDYES +2<br />
      goto done<br />
      goto search<br />
      <br />
      search:<br />
      <br />
      present:<br />
      <br />
      strcpy $instdir "$R0\mods\Navy SEALS_V2"<br />
      goto done<br />
      <br />
      so what i have read to make a search was to enter this:<br />
      <br />
      ComponentText "Check the drives where you want the installer to scan for Ghost Recon Directory." "" "Select drives to scan:"<br />
      <br />
      ; One section to scan drive C<br />
      Section "Drive C:"<br />
      ; put search root on stack, initialize stack counter<br />
      StrCpy $8 1<br />
      Push "C:"<br />
      ; start searching<br />
      Call FindFiles<br />
      SectionEnd<br />
      <br />
      ; One section to scan drive D<br />
      Section "Drive D:"<br />
      ; put search root on stack, initialize stack counter<br />
      StrCpy $8 1<br />
      Push "D:"<br />
      ; start searching<br />
      Call FindFiles<br />
      SectionEnd<br />
      <br />
      now here is my question, is it really meaning you have to make a section like above for every harddrive letter possible? since there is alot of harddrive letter possible since cc: dd: ee: is also possible :-).<br />
      and when i wanted to make an goto the search section where the script should search for a file i would get an error that ComponentText cannot be inside a function, ok i moved it out, but look like the function .oninit and all the thing in there must not be seperated by no function stuff, hehe can it be done? and plz dont mind cut it out for me :-), since the stuff in the archives are not any good for me, there is to little info there, i dont get the whole picture. Well i almost dont get any of this scripting anyway :-(</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Joost Verburg</span><br />
      <span class="post-time small text-muted">17th March 2004 08:58 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">You can also create a loop that checks all drives. The System plug-in allows you to detect which drives exist (see examples).</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kukomamasan</span><br />
      <span class="post-time small text-muted">17th March 2004 12:44 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Ty Joost sounds great :-) well found a exampel, and can see i still need 2 pages of scripting to search for a file on any harddrive hehe. i guess thats just to find out what drive letter there is on the system :-( , so i still would know how to use the loop, since i dident find anything usefull there, can u give a link to an exampel written so i can understand it hehe. ty in advance, so far you have been most helpfull</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kukomamasan</span><br />
      <span class="post-time small text-muted">17th March 2004 15:24 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">ok im totally lost how would i incorporate the search for drives and add that loop in the script so the user can select the drives to search in, and then nicely get that in the script where i have the function search. since i dont get any of that, when i tried to just put the script in the function .oninit before the rest in .oninit, i will get an error installer corrupted, invalid opcode, i dont know what an opcode is hehe.</p>
    </div>
    <hr />

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]>
  </script>
</body>
</html>
