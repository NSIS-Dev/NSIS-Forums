<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="description" content="ExecShell does not run!"><title>ExecShell does not run! - NSIS Forums</title><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script><link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css"><link rel="stylesheet" href="../css/style.css" type="text/css"></head><body><div class="container"><ol class="breadcrumb"><li><a href="../index.html" class="glyphicon glyphicon-home"></a></li><li><a href="f-65.html">NSIS Discussion</a></li><li class="active">ExecShell does not run!</li></ol><p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=257850">ExecShell does not run!</a></p><br><div class="post"><p class="post-meta"><span class="post-author text-primary">sunlight112</span><br><span class="post-time small text-muted">19th October 2006 02:36 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>ExecShell does not run!</strong><br>I want to redistribute environment to run my application. When I use ExecShell, it does not execute.I do not know why,somebody can help me!<br>My code here:<br><br>SetOutPath "$INSTDIR"<br>SetOverwrite ifnewer<br>Fle "e:\client\install\vcredist_x86.exe"<br>ExecShell '"$INSTDIR\vcredist_x86.exe"' 'SW_HIDE'<br><br>Thank you,</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">sunlight112</span><br><span class="post-time small text-muted">19th October 2006 02:44 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">I think I forgot something and I also add some option<br><br>SetOutPath "$INSTDIR"<br>SetOverwrite ifnewer<br>Fle "e:\client\install\vcredist_x86.exe"<br>ExecShell "open" '"$INSTDIR\vcredist_x86.exe"' SW_HIDE<br><br>It runs but display an error:<br>"Command line operation syntax error.Type command /?for help"<br>But I make right ExecShell in help file, I may make some mistakes in some places.<br>Can you help me!</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">niteflyer</span><br><span class="post-time small text-muted">19th October 2006 10:50 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">ExecShell "open" '"$INSTDIR\vcredist_x86.exe"' '' SW_HIDE<br><br>If you want to specify the "showmode" you have to pass [parameters] as well (here: empty list). see<br><a href="http://nsis.sourceforge.net/Docs/Chapter4.html#4.9.1.3" target="_blank">http://nsis.sourceforge.net/Docs/Chapter4.html#4.9.1.3</a></p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">sunlight112</span><br><span class="post-time small text-muted">19th October 2006 11:37 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Thank niteflyer a lot,<br>I do it the same way you help but It can not run vcredist_x86.exe, only announce an error the same below.I do not know why. Can you tell me another way ?<br>My code here:<br>Function .onInit<br>; check for .NET<br>!insertmacro MUI_LANGDLL_DISPLAY<br>Call IsDotNETInstalled<br>Pop $R3<br>StrCmp $R3 0 not_found found<br>found:<br>goto end<br>not_found:<br>MessageBox MB_OKCANCEL "We need to create an environment to run this program" IDOK installNET IDCANCEL 0<br>installNET:<br>SetOutPath "$INSTDIR"<br>SetOverwrite ifnewer<br>File "e:\client\install\vcredist_x86.exe"<br>ExecShell "open" '"$INSTDIR\vcredist_x86.exe"' '' SW_HIDE<br><br>end:<br>FunctionEnd<br><br>Please help me!!!!</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">niteflyer</span><br><span class="post-time small text-muted">19th October 2006 11:57 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">I am not familiar with vcredist. Does it require parameters ? I have no idea, why my suggestion does not work.<br>Did you try<br>ExecShell "open" '"$INSTDIR\vcredist_x86.exe"'<br>just to figure out if the SW-parameter is the baddie?<br><br>And I dont remember if ExecShell waits for completion of vcredist; I guess you want to wait, if you are doing this onInit ?</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">niteflyer</span><br><span class="post-time small text-muted">19th October 2006 12:00 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">or try<br>ExecShell "open" "$INSTDIR\vcredist_x86.exe" "" SW_HIDE</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">sunlight112</span><br><span class="post-time small text-muted">20th October 2006 02:26 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Thank niteflyer,<br>Now, It run well but I want to SW_HIDE it when I run it. Because users do not know about "redistribute" of Visual Studio 2005. Consequently, I want it run on SW_HIDE. I must use ExecShell to hide it.<br>Your command can run it but it does not hide the screen redistribute VC++.<br>ExecShell "open" "$INSTDIR\vcredist_x86.exe" "" SW_HIDE<br>Can you help me please!!!</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">niteflyer</span><br><span class="post-time small text-muted">20th October 2006 10:17 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Could it be that vcredist unhides itself or spawns another (visible) process ? If so, you should use FindWindow and SendMessage to hide the new window when it gets visible; not nice but I have no more ideas.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">sunlight112</span><br><span class="post-time small text-muted">20th October 2006 10:23 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Thank you niteflyer for your idea,</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">ranahimal</span><br><span class="post-time small text-muted">29th November 2006 15:24 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>Can u help me?</strong><br>Hi!<br>Can anybody help me how to integrate VCRedist.exe into my Application setup.<br>How to integrate it?</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">sunlight112</span><br><span class="post-time small text-muted">30th November 2006 01:22 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Hi ranahimal,<br></p><blockquote><b>ranahimal</b> said:<br>Can u help me?<br>Hi!<br>Can anybody help me how to integrate VCRedist.exe into my Application setup.<br>How to integrate it?</blockquote>I do not understand clearly what you want to say? Can you tell specific your opinion?<br>At that time, I hope I can help you!<br>Have a nice day!</div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Comperio</span><br><span class="post-time small text-muted">1st December 2006 15:22 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">If you run VCRedist_x86.exe with a "/?" switch, you'll see the parameter for silent mode is "/Q".<br><br>So, instead of using ExecShell, you should be using just Exec like this:<br></p><pre>
<code><br>Exec '"$INSTDIR\VCRedist_x86.exe" /Q'<br></code>
</pre><br>
      <br>
      <b>edit:</b><br>
      I changed references of VCRedist.exe to VCRedist_x86.exe to match the original post.
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">demiller9</span><br>
      <span class="post-time small text-muted">1st December 2006 16:39 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">I think that should be ExecWait instead of Exec.<br>
      <br>
      I created a small installer yesterday just to check this out. What I've used is<br></p>
      <pre>
<code><br>!include "LogicLib.nsh"<br>!define UNINSTALL_KEY "Software\Microsoft\Windows\CurrentVersion\Uninstall"<br>!define APP_KEY "{A49F249F-0C91-497F-86DF-B2585E8E76B7}"<br>Section -VCRedistributable<br>        ReadRegStr $R0 HKLM "${UNINSTALL_KEY}\${APP_KEY}\" "DisplayName"<br>        ${If} ${Errors}<br>                # reg value doesn't exist (ie, needs installed)<br>                InitPluginsDir<br>                SetOutPath "$PLUGINSDIR"<br>                File "WindowsInstaller-KB893803-v2-x86.exe"<br>                File "VCRedist_x86.exe"<br>                ExecWait '"$PLUGINSDIR\WindowsInstaller-KB893803-v2-x86.exe"  /quiet /norestart'<br>                ExecWait '"$PLUGINSDIR\VCRedist_x86.exe"  /Q'<br>        ${EndIf}<br>SectionEnd<br></code>
</pre>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">NinjaHippie</span><br>
      <span class="post-time small text-muted">13th December 2007 11:00 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Here's the script you need to do the VC Redist silent install properly:<br>
      <a href="http://blogs.msdn.com/astebner/archive/2007/02/07/update-regarding-silent-install-of-the-vc-8-0-runtime-vcredist-packages.aspx" target="_blank">http://blogs.msdn.com/astebner/archi...-packages.aspx</a></p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">NinjaHippie</span><br>
      <span class="post-time small text-muted">13th December 2007 11:02 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Lol, what happened to my URL? Anyway, here's the text from that page:<br>
      <br>
      Update regarding silent install of the VC 8.0 runtime (vcredist) packages<br>
      <br>
      A while back, I posted this item on my blog that describes options for silent installation of the Visual C++ 8.0 runtime redistributable setup packages. When I investigated this issue and wrote that blog post, I based the command line parameters on the versions of vcredist_x86.exe, vcredist_x64.exe and vcredist_ia64.exe that are included in the directory %ProgramFiles%\Microsoft Visual Studio 8\SDK\v2.0\Bootstrapper\Packages when installing Visual Studio 2005.<br>
      <br>
      However, a customer recently alerted me to an issue that I wasn't aware of previously. The standalone versions of the VC runtime redistributable packages that are available for download via the web are packaged differently, and so the command lines that I previously documented for silent installation will not work with those versions of the packages. Essentially, the standalone versions are wrapped in a second self-extracting EXE that displays a EULA before allowing extraction and execution of the main setup package, whereas the packages included as part of Visual Studio 2005 directly launch setup and are not doubly wrapped.<br>
      <br>
      Therefore, here are some amended silent install instructions for the VC 8.0 runtime redistributable packages. If you are using the packages included as a part of Visual Studio 2005, you can continue to use the silent install switches from my previous blog post.<br>
      <br>
      However, if you have downloaded the standalone VC 8.0 redistributable packages, you will need to modify the command lines slightly. The following command lines can be used to install the original release of the standalone VC 8.0 redistributable packages:<br>
      <br>
      * For x86: vcredist_x86.exe /q:a /c:"VCREDI~1.EXE /q:a /c:""msiexec /i vcredist.msi /qn"" "<br>
      * For x64: vcredist_x64.exe /q:a /c:"VCREDI~2.EXE /q:a /c:""msiexec /i vcredist.msi /qn"" "<br>
      * For ia64: vcredist_ia64.exe /q:a /c:"VCREDI~3.EXE /q:a /c:""msiexec /i vcredist.msi /qn"" "<br>
      <br>
      The following command lines can be used to install the Visual Studio 2005 SP1 release of the standalone VC 8.0 redistributable packages:<br>
      <br>
      * For x86: vcredist_x86.exe /q:a /c:"VCREDI~3.EXE /q:a /c:""msiexec /i vcredist.msi /qn"" "<br>
      * For x64: vcredist_x64.exe /q:a /c:"VCREDI~2.EXE /q:a /c:""msiexec /i vcredist.msi /qn"" "<br>
      * For ia64: vcredist_ia64.exe /q:a /c:"VCREDI~1.EXE /q:a /c:""msiexec /i vcredist.msi /qn"" "<br>
      <br>
      If you would like to install the VC runtime packages in unattended mode (which will show a small progress bar but not require any user interaction), you can change the /qn switch above to /qb. If you would like the progress bar to not show a cancel button, then you can change the /qn switch above to /qb!</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br>
      <span class="post-time small text-muted">13th December 2007 17:13 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Your URL is here: <a href="http://blogs.msdn.com/astebner/archive/2007/02/07/update-regarding-silent-install-of-the-vc-8-0-runtime-vcredist-packages.aspx" target="_blank">http://blogs.msdn.com/astebner/archi...-packages.aspx</a></p>
    </div>
    <hr>

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]></script></body></html>