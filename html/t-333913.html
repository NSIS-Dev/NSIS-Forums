<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="ExecWait doesn't wait with for VirtualServer2005-Install" />

  <title>ExecWait doesn't wait with for VirtualServer2005-Install - NSIS Forums</title>
  <script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script>
  <!-- Bootstrap core CSS -->

  <link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css" />
  <link rel="stylesheet" href="../css/style.css" type="text/css" /><!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!--[if lt IE 9]>
                <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
                <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->
</head>

<body>
  <div class="container">
    <!-- Put navigation bar here -->

    <ol class="breadcrumb">
      <li><a href="../index.html" class="glyphicon glyphicon-home"></a></li>

      <li><a href="f-65.html">NSIS Discussion</a></li>

      <li class="active">ExecWait doesn't wait with for VirtualServer2005-Install</li>
    </ol>

    <p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=333913">ExecWait doesn't wait with for VirtualServer2005-Install</a></p><br />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">mezcalin</span><br />
      <span class="post-time small text-muted">22nd August 2011 10:30 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>ExecWait doesn't wait with for VirtualServer2005-Install</strong><br />
      Hi<br />
      <br />
      I have to make an installer that includes some other installer an driver.<br />
      With the first command execWait works fine:<br />
      ExecWait '"$OUTDIR\VirtualServer2005\VMRCplus-1.8.0-x86\setup.exe"'<br />
      <br />
      But it doesn't wait for the installer for Microsoft Virtual Server 2005 R2 SP1:<br />
      ExecWait '"$OUTDIR\VirtualServer2005\virtualserver-2005-r2-sp1-setup-win32.exe"'<br />
      <br />
      Please help.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">jpderuiter</span><br />
      <span class="post-time small text-muted">22nd August 2011 11:22 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">http://nsis.sourceforge.net/When_I_use_ExecWait,_it_doesn't_wait</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">mezcalin</span><br />
      <span class="post-time small text-muted">22nd August 2011 13:53 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">sorry, doesn't work.<br />
      <br />
      ExecWait '"$OUTDIR\VirtualServer2005\virtualserver-2005-r2-sp1-setup-win32.exe" /wait'<br />
      nor<br />
      ExecWait '"$OUTDIR\VirtualServer2005\virtualserver-2005-r2-sp1-setup-win32.exe" /clone_wait'</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">MSG</span><br />
      <span class="post-time small text-muted">22nd August 2011 14:07 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">If you can't find the commandline parameter for that particular installer that tells it to not quit the initial process until its child processes are finished, you'll have to launch the exe while waiting for its child processes yourself:<br />
      <a href="http://nsis.sourceforge.net/ExecWait_and_waiting_for_child_processes_with_Job_Objects" target="_blank">http://nsis.sourceforge.net/ExecWait...th_Job_Objects</a></p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">mezcalin</span><br />
      <span class="post-time small text-muted">22nd August 2011 14:19 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">I already tried this one.<br />
      I included the macro in my script and try the example first.<br />
      But my installer won't continue. I don't know why.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Roger_wgnr</span><br />
      <span class="post-time small text-muted">23rd August 2011 08:06 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Run the install from a command promt with a /? or -? this will display a list of available command line switches for the installer.<br />
      <br />
      Look through the list to find the option to wait for all processes to complete before exiting and use that switch in your ExecWait statement.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">mezcalin</span><br />
      <span class="post-time small text-muted">23rd August 2011 15:30 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">The installer from Microsoft extracted a .msi-file in my temp-folder. So now I got the .msi-file und tried to execute this one.<br />
      Works fine in the command prompt. But it does not work with ExecWait.<br />
      I tried this command<br /></p>
      <pre>
<code>ExecWait '"start /wait msiexec.exe /i $OUTDIR\VirtualServer2005\Virtual_Server_2005_Install_32.msi"'</code>
</pre><br />
      but nothing happened.
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">msroboto</span><br />
      <span class="post-time small text-muted">23rd August 2011 17:52 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">These are the possible options to msiexec<br />
      <br />
      Windows ® Installer. V 5.0.7601.17514<br />
      <br />
      msiexec /Option &lt;Required Parameter&gt; [Optional Parameter]<br />
      <br />
      Install Options<br />
      &lt;/package | /i&gt; &lt;Product.msi&gt;<br />
      Installs or configures a product<br />
      /a &lt;Product.msi&gt;<br />
      Administrative install - Installs a product on the network<br />
      /j&lt;u|m&gt; &lt;Product.msi&gt; [/t &lt;Transform List&gt;] [/g &lt;Language ID&gt;]<br />
      Advertises a product - m to all users, u to current user<br />
      &lt;/uninstall | /x&gt; &lt;Product.msi | ProductCode&gt;<br />
      Uninstalls the product<br />
      Display Options<br />
      /quiet<br />
      Quiet mode, no user interaction<br />
      /passive<br />
      Unattended mode - progress bar only<br />
      /q[n|b|r|f]<br />
      Sets user interface level<br />
      n - No UI<br />
      b - Basic UI<br />
      r - Reduced UI<br />
      f - Full UI (default)<br />
      /help<br />
      Help information<br />
      Restart Options<br />
      /norestart<br />
      Do not restart after the installation is complete<br />
      /promptrestart<br />
      Prompts the user for restart if necessary<br />
      /forcerestart<br />
      Always restart the computer after installation<br />
      Logging Options<br />
      /l[i|w|e|a|r|u|c|m|o|p|v|x|+|!|*] &lt;LogFile&gt;<br />
      i - Status messages<br />
      w - Nonfatal warnings<br />
      e - All error messages<br />
      a - Start up of actions<br />
      r - Action-specific records<br />
      u - User requests<br />
      c - Initial UI parameters<br />
      m - Out-of-memory or fatal exit information<br />
      o - Out-of-disk-space messages<br />
      p - Terminal properties<br />
      v - Verbose output<br />
      x - Extra debugging information<br />
      + - Append to existing log file<br />
      ! - Flush each line to the log<br />
      * - Log all information, except for v and x options<br />
      /log &lt;LogFile&gt;<br />
      Equivalent of /l* &lt;LogFile&gt;<br />
      Update Options<br />
      /update &lt;Update1.msp&gt;[;Update2.msp]<br />
      Applies update(s)<br />
      /uninstall &lt;PatchCodeGuid&gt;[;Update2.msp] /package &lt;Product.msi | ProductCode&gt;<br />
      Remove update(s) for a product<br />
      Repair Options<br />
      /f[p|e|c|m|s|o|d|a|u|v] &lt;Product.msi | ProductCode&gt;<br />
      Repairs a product<br />
      p - only if file is missing<br />
      o - if file is missing or an older version is installed (default)<br />
      e - if file is missing or an equal or older version is installed<br />
      d - if file is missing or a different version is installed<br />
      c - if file is missing or checksum does not match the calculated value<br />
      a - forces all files to be reinstalled<br />
      u - all required user-specific registry entries (default)<br />
      m - all required computer-specific registry entries (default)<br />
      s - all existing shortcuts (default)<br />
      v - runs from source and recaches local package<br />
      Setting Public Properties<br />
      [PROPERTY=PropertyValue]<br />
      <br />
      Consult the Windows ® Installer SDK for additional documentation on the<br />
      command line syntax.<br />
      <br />
      Copyright © Microsoft Corporation. All rights reserved.<br />
      Portions of this software are based in part on the work of the Independent JPEG Group.<br />
      <br />
      <br />
      this is my command<br />
      ExecWait '"msiexec" /i "$INSTDIR\myfile.msi" /qn+ ALLUSERS=1 /passive'<br />
      <br />
      I don't know if this will help.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">mezcalin</span><br />
      <span class="post-time small text-muted">24th August 2011 09:36 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Thanks for help. The command below works fine.<br /></p>
      <pre>
<code>ExecWait '"msiexec" /i "$INSTDIR\VirtualServer2005\Virtual_Server_2005_Install_32.msi" ALLUSERS=1'</code>
</pre>
    </div>
    <hr />

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]>
  </script>
</body>
</html>
