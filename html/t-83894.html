<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="If &quot;X&quot; string is already in Registry then abort" />

  <title>If "X" string is already in Registry then abort - NSIS Forums</title><!-- Bootstrap core CSS -->
  <link rel="stylesheet" type="text/css" href="//netdna.bootstrapcdn.com/bootswatch/3.0.1/readable/bootstrap.min.css" />
  <link rel="stylesheet" href="../css/style.css" type="text/css" /><!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!--[if lt IE 9]>
                <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
                <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->
</head>

<body>
  <div class="container">
    <!-- Put navigation bar here -->

    <ol class="breadcrumb">
      <li><a href="../index.html" class="glyphicon glyphicon-home"></a></li>

      <li><a href="f-65.html">NSIS Discussion</a></li>

      <li class="active">If "X" string is already in Registry then abort</li>
    </ol>

    <p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=83894">If "X" string is already in Registry then abort</a></p><br />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">mixo</span><br />
      <span class="post-time small text-muted">7th April 2002 03:29 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>If "X" string is already in Registry then abort</strong><br />
      Yep - another pesky newbie question<br />
      <br />
      Can anyone please provide full script necessary to check if a pre-written Registry entry exists [ from Freeware Trial installtion ], which will then abort the installation, and offer user to purchase Full Version of my program. [ I wish to allow users to only install my Freeware Trial program Once ]<br />
      <br />
      I believe this message box will work OK, but I don't know how to script to check if my pre-written Freeware RegStr already exists.<br />
      ++++++++++++++++<br />
      <br />
      Function .onInit<br />
      <br />
      ???<br />
      <br />
      MessageBox MB_YESNO|MB_ICONQUESTION \<br />
      "Our records show you have already downloaded and tried our Freeware Version once. Would you like to purchase Full version now ?" \<br />
      IDNO NoReadme<br />
      ExecShell open 'http://myUrl/software/purchase.htm'<br />
      NoReadme:<br />
      hideWindow<br />
      abort<br />
      FunctionEnd<br />
      <br />
      +++++++++++++++++<br />
      <br />
      Many thanks [ to NSIS too ]<br />
      Mixo</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Pomflain</span><br />
      <span class="post-time small text-muted">7th April 2002 05:29 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>Ok.</strong><br />
      You just take one of the standard registry read functions and then check for the value to read it out from the registry. Like this:<br />
      <br />
      ReadRegStr $R0 HKEY_LOCAL_MACHINE "SOFTWARE\Microsoft\Windows\CurrentVersion\Uninstall\${PROGNAME}" "UninstallString"<br />
      <br />
      If PROGNAME is !define'd as the name you write to the registry, that has the path to the uninstaller. That's basically right out of one of the sample scripts. If you write out a DWORD or Binary value, just change the keyword to the appropriate version.<br />
      <br />
      However, is this really going to work? I don't think it would take too long to figure out that's all you have to do to continue using the Trial version, even if you are really good at obfuscating the key. You really need to apply a combination of registry key(s) and some installed file(s) to more effectively prevent people from continuing to use your trial version.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">mixo</span><br />
      <span class="post-time small text-muted">8th April 2002 14:24 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>Re: Ok.</strong><br />
      [QUOTE]<i>Originally posted by Pomflain</i><br />
      <br />
      Thanks for your prompt reply.<br />
      <br />
      I agree using that using a well known {PROGNAME} "uninstallString"<br />
      would be fairly easy for a more advanced user to locate and delete.<br />
      <br />
      Perhaps utilizing SetDateSave may be a viable alternative<br />
      to check on a prior installation of Trial Version, but being a nsi Newbie, have no idea how to code such a check.<br />
      <br />
      Thanks again for your time and suggestion<br />
      Mixo<br />
      Down Under</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Pomflain</span><br />
      <span class="post-time small text-muted">8th April 2002 23:00 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>Re: Re: Ok.</strong><br />
      [QUOTE]<i>Originally posted by mixo</i><br /></p>

      <blockquote>
        <b><i>Originally posted by Pomflain</i><br />
        <br />
        Thanks for your prompt reply.<br />
        <br />
        I agree using that using a well known {PROGNAME} "uninstallString"<br />
        would be fairly easy for a more advanced user to locate and delete.</b>
      </blockquote>No, I didn't mean to use that, just meant as an example of how to read from the registry.<br />
      <br />
      Also, I think you are misunderstanding how SetDateSave works. SetDateSave preserves the date/timestamp on the compiling system when it is turned on. Otherwise (assuming here, I always leave it set to on) it would set the date to the time the installer was run and extracted the files on the installing system.<br />
      <br />
      Unless you mean to check the date on the files to see if it matches what you are expecting with SetDateSave on, but even then all they would have to do is compress the files and not preserve the date and then extract them again. I think you'll need to do some kind of combination of the two.
    </div>
    <hr />

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]>
  </script>
</body>
</html>
