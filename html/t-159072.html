<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="Multiple uninstalls" />

  <title>Multiple uninstalls - NSIS Forums</title><!-- Bootstrap core CSS -->
  <link rel="stylesheet" type="text/css" href="//netdna.bootstrapcdn.com/bootswatch/3.0.1/readable/bootstrap.min.css" />
  <link rel="stylesheet" href="../css/style.css" type="text/css" /><!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!--[if lt IE 9]>
                <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
                <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->
</head>

<body>
  <div class="container">
    <!-- Put navigation bar here -->

    <ol class="breadcrumb">
      <li><a href="../index.html" class="glyphicon glyphicon-home"></a></li>

      <li><a href="f-65.html">NSIS Discussion</a></li>

      <li class="active">Multiple uninstalls</li>
    </ol>

    <p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=159072">Multiple uninstalls</a></p><br />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">BitOver</span><br />
      <span class="post-time small text-muted">9th December 2003 09:23 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>Multiple uninstalls</strong><br />
      Hi,<br />
      <br />
      For one of my products I need to have 2 uninstallers intead of one.<br />
      The kit is installing an exe and a dll. I need to be able to see in Add/Remove programs 2 unsintallers, one for exe and one for dll.<br />
      <br />
      It is this posiible or not ?<br />
      If it is posisble please give me some tips on how I can do this.<br />
      <br />
      Thanks,<br />
      BitOver</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
      <span class="post-time small text-muted">9th December 2003 13:50 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">There are two options I can think of:</p>

      <ol style="list-style-type: decimal">
        <li>Create two "uninstallers" on your computer, package them inside your installer and extract both upon installation. These "uninstallers" can be installers that delete, real uninstallers that you have generated using WriteUninstaller or even batch files or any other program if you want.</li>

        <li>Have your uninstaller process the command line for switches like /UNINSTALLEXE and /UNINSTALLDLL which you will include in the UninstallString. For example:
          <pre>
<code>WriteRegStr HKLM "Software\Microsoft\Windows\CurrentVersion\Uninstall\MyProgDLL" "UninstallString" '"$INSTDIR\uninst.exe" /UNINSTALLDLL'<br />WriteRegStr HKLM "Software\Microsoft\Windows\CurrentVersion\Uninstall\MyProgEXE" "UninstallString" '"$INSTDIR\uninst.exe" /UNINSTALLEXE'</code>
</pre>If you choose this method you'd have to delete the uninstaller only when both components have been uninstalled. The easy way around this would be to use WriteUninstaller twice with two different names:
          <pre>
<code>WriteUninstaller uninstall-exe.exe<br />WriteUninstaller uninstall-dll.exe</code>
</pre>According to the command line switch, each would delete itself and not the other one.
        </li>
      </ol>
    </div>
    <hr />

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]>
  </script>
</body>
</html>
