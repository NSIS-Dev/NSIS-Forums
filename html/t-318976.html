<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="Usint Active Desktop Instances in NSIS" />

  <title>Usint Active Desktop Instances in NSIS - NSIS Forums</title><!-- Bootstrap core CSS -->
  <link rel="stylesheet" type="text/css" href="//netdna.bootstrapcdn.com/bootswatch/3.0.1/readable/bootstrap.min.css" />
  <link rel="stylesheet" href="../css/style.css" type="text/css" /><!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!--[if lt IE 9]>
                <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
                <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->
</head>

<body>
  <div class="container">
    <!-- Put navigation bar here -->

    <ol class="breadcrumb">
      <li><a href="../index.html" class="glyphicon glyphicon-home"></a></li>

      <li><a href="f-65.html">NSIS Discussion</a></li>

      <li class="active">Usint Active Desktop Instances in NSIS</li>
    </ol>

    <p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=318976">Usint Active Desktop Instances in NSIS</a></p><br />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">santana108</span><br />
      <span class="post-time small text-muted">6th May 2010 10:14 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>Usint Active Desktop Instances in NSIS</strong><br />
      Maybe someone can help me with this. In my installer, I need to use the Remote API to communicate with a Windows CE device. To do this I need to create some class instances for the remote API. There is some sample code for creating and using class instances on the NSIS wiki. I have some questions about this code. The code is given below:<br />
      <br />
      !define CLSCTX_INPROC_SERVER 1<br />
      !define CLSID_ActiveDesktop {75048700-EF1F-11D0-9888-006097DEACF9}<br />
      !define IID_IActiveDesktop {F490EB00-1240-11D1-9888-006097DEACF9}<br />
      # create IActiveDesktop interface<br />
      System::Call "ole32::CoCreateInstance( \<br />
      g '${CLSID_ActiveDesktop}', p 0, \<br />
      i ${CLSCTX_INPROC_SERVER}, \<br />
      g '${IID_IActiveDesktop}', *p .r0) i.r1"<br />
      StrCmp $1 0 0 end<br />
      # call IActiveDesktop-&gt;GetWallpaper<br />
      System::Call "$0-&gt;4(w .r2, i ${NSIS_MAX_STRLEN}, i 0)"<br />
      # call IActiveDesktop-&gt;Release<br />
      System::Call "$0-&gt;2()"<br />
      <br />
      <br />
      The first question that I have is where do the GUIDs CLSID_ActiveDesktop and IID_IActiveDesktop come from?<br />
      <br />
      The second question that I have is how to determine the methods in an active desktop instance. The methods of the active desktop are being referenced by numbers. How does one know what number is associated with what method?<br />
      <br />
      If I know the answers to these questions I will be able to use the RAPI2 interfaces for my install program.<br />
      <br />
      If anyone knows the answer to these questions a reply would be greatly appreciated.<br />
      <br />
      Thanks,<br />
      <br />
      Chris Lustig</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
      <span class="post-time small text-muted">6th May 2010 10:57 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">The class id is defined in the same library that defines e.g. ActiveDesktop/IActiveDesktop in shlobj.h/shell32.dll. As for the numbers, those are the methods in their order. Release is #2 because it is the 2nd method in IUnknown (which IActiveDesktop inherits). GetWallpaper is #4 because it is the 2nd method in IActiveDesktop.<br />
      <br />
      Edit: MSDN is your friend :)<br />
      <br />
      Stu</p>
    </div>
    <hr />

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]>
  </script>
</body>
</html>
