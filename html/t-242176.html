<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="Two plugins" />

  <title>Two plugins - NSIS Forums</title>
  <script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script>
  <!-- Bootstrap core CSS -->

  <link rel="stylesheet" type="text/css" href="//netdna.bootstrapcdn.com/bootswatch/3.0.1/readable/bootstrap.min.css" />
  <link rel="stylesheet" href="../css/style.css" type="text/css" /><!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!--[if lt IE 9]>
                <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
                <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->
</head>

<body>
  <div class="container">
    <!-- Put navigation bar here -->

    <ol class="breadcrumb">
      <li><a href="../index.html" class="glyphicon glyphicon-home"></a></li>

      <li><a href="f-65.html">NSIS Discussion</a></li>

      <li class="active">Two plugins</li>
    </ol>

    <p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=242176">Two plugins</a></p><br />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
      <span class="post-time small text-muted">30th March 2006 17:51 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>Two plugins</strong><br />
      Just so that people know that they exist, I've uploaded two plugins.<br />
      <br />
      <b><a href="http://nsis.sf.net/File:EmbeddedLists.zip" target="_blank">EmbeddedLists.dll</a></b><br />
      This displays a single selection, multiple selection or columned list box (with column headings and optional check boxes). The plugin takes its list box items from the NSIS stack. I wrote this plugin as even with the makensis 8192 string length build I felt it was unsafe when having a large number of list box items for InstallOptions list boxes (from an Internet source).<br />
      <br />
      <b><a href="http://nsis.sf.net/File:ButtonEvent.zip" target="_blank">ButtonEvent.dll</a></b><br />
      A small 3KB dll that allows you to catch click events of any custom buttons on any NSIS dialogs. The buttons must be added to the UI files with Resource Hacker. The example included makes use of a custom button on the parent window (alongside the Next and Back buttons) and one on the Components page.<br />
      <br />
      -Stu</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Red Wine</span><br />
      <span class="post-time small text-muted">30th March 2006 20:51 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Hi Stu,<br />
      this ButtonEvent sounds like something was really missed!<br />
      It is that what I was looking for to figure some actions I have in my mind, yet, I was not able to find such code or to write one by my self.<br />
      Next, I'll check it deeply to find out how it works, thus where and how it will assists me.<br />
      Regards</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
      <span class="post-time small text-muted">31st March 2006 08:16 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Well basically you just need to add a button with Resource Hacker and give it a unique ID number.<br />
      If the button is on the parent dialog (105) then call the AddEventHandler function in .onGUIInit. If the button is on a child form (inner dialog) then call it in the pages' Show function.<br />
      <br />
      With this accomplished, the buttons will act the same as the user clicking "Next" except an internal flag is set showing that the user in fact clicked on one of the custom buttons.<br />
      <br />
      For custom buttons on the parent dialog, the WhichButtonID function should be called in all pages' Leave functions (to catch the click event for all pages of the installer).<br />
      For individual pages, the WhichButtonID only needs to be called for that pages' Leave function.<br />
      <br />
      Hope that helps.<br />
      The example script displays this, but in script form.<br />
      <br />
      -Stu</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">{_trueparuex^}</span><br />
      <span class="post-time small text-muted">1st April 2006 13:00 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">The example of EmbeddedLists.dll caused the installer to crash, but it was one time crash only. It crashed after I clicked next button on the multi column page, but I am not sure about that. It might have been when initializing the check box page too.<br />
      <br />
      My os is windows 2000</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
      <span class="post-time small text-muted">1st April 2006 14:45 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Do you have .NET Framework 1.1 installed? The plugin was written under MS VS.NET, but works fine on a Windows XP machine without .NET Framework installed. I don't have a Windows 2000 machine anymore either.<br />
      <br />
      -Stu</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">{_trueparuex^}</span><br />
      <span class="post-time small text-muted">1st April 2006 18:29 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">I avoid .NET Framework like the plague. So no, I don't have .NET Framework installed. ;)</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
      <span class="post-time small text-muted">1st April 2006 18:37 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">I'll recompile it in C++6 tomorrow and I'll post here.<br />
      How often does it crash? Have you been able to get it to crash again?<br />
      <br />
      -Stu</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">{_trueparuex^}</span><br />
      <span class="post-time small text-muted">2nd April 2006 11:44 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Yes actually I just got it to crash again. And I think I even can reproduce the crash. This time it crashed when I clicked the close button in the Installion complete page. This makes me wonder, maybe I used the cancel button instead of next button when it crashed last time. (I really should pay more attention while testing these things :rolleyes: )</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
      <span class="post-time small text-muted">2nd April 2006 21:56 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Hello.<br />
      I was able to recompile the plugin under VC++6 with minor changes. One thing that could be causing the crash (but I doubt it) is that the ListView_SetCheckState macro was undefined for VC++6 when MSDN said that it is defined from Windows 95 and upwards (with IE3+ installed). However, the compiler said otherwise.<br />
      <br />
      If you could re-download from the same URL and try it out I'd be very greatful. If my assumptions are correct then I'll have to avoid using VS.NET for plugin work.<br />
      <br />
      -Stu</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">zeeh3</span><br />
      <span class="post-time small text-muted">3rd April 2006 12:21 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Hi Stu, I have a question for you. Can EmbeddedLists.dll be used with installoptions' custom page?</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">RobGrant</span><br />
      <span class="post-time small text-muted">3rd April 2006 12:28 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">These look cool! I don't quite understand the difference between your ButtonEvent and just using the NOTIFY flag on a custom button with appropriate exit code. I haven't looked at it, only at your description.<br />
      <br />
      I point this out because in the future when people are searching the wiki, it would be worth having a clear explanation :)</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
      <span class="post-time small text-muted">3rd April 2006 15:28 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">The explanation is pretty clear. You can't place a button on an existing NSIS dialog with InstallOptions. Adding it with ResourceHacker is the only way, and then it doesn't actually do anything when you click on it. This is where the ButtonEvent plugin comes in.<br />
      <br />
      -Stu</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
      <span class="post-time small text-muted">3rd April 2006 15:30 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><i>zeeh3</i>: If you want to display a list box on an InstallOptions dialog, use Type=ListBox. Note that this is a basic control without the additional features that a ListView control has (multiple columns and column headings).<br />
      <br />
      -Stu</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">{_trueparuex^}</span><br />
      <span class="post-time small text-muted">3rd April 2006 19:33 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Sorry to say, but it still crashes. Now it crashed just like the first crash. So I guess that was right after all.<br />
      <br />
      Is anyone else having problems with this plugin?</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
      <span class="post-time small text-muted">3rd April 2006 21:31 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Interesting. I'll have a good look at the code tomorrow.<br />
      <br />
      -Stu</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">iceman_k</span><br />
      <span class="post-time small text-muted">3rd April 2006 23:44 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">The Embedded Lists functionality can be achieved using InstallOptions and System plugins.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
      <span class="post-time small text-muted">4th April 2006 09:00 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">I would love to see the code to add a SysListView32 control :]<br />
      <br />
      -Stu</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">iceman_k</span><br />
      <span class="post-time small text-muted">4th April 2006 12:49 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">It would be complex, but the System plugin is very powerful. Pretty much any Windows API can be invoked using it.<br />
      Right now I don't have the time, but maybe later I could look at it.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">zeeh3</span><br />
      <span class="post-time small text-muted">4th April 2006 15:19 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"></p>

      <blockquote>
        <i>Originally posted by Afrow UK</i><br />
        <b><i>zeeh3</i>: If you want to display a list box on an InstallOptions dialog, use Type=ListBox. Note that this is a basic control without the additional features that a ListView control has (multiple columns and column headings).<br />
        <br />
        -Stu</b>
      </blockquote>I know that :)<br />
      I was just asking for an enhaced Listbox using your plugin with custom pages.
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
      <span class="post-time small text-muted">4th April 2006 17:16 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">I'm not sure what InstallOptionsEx has, but you can check that out (forum search).<br />
      <br />
      -Stu</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">SimonSez07</span><br />
      <span class="post-time small text-muted">11th April 2006 22:55 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">how can i hide my custom button (placed where your "Try Me" button is on the example) for all pages after the welcome page? i only want the button to be pressable on the welcome page.<br />
      <br />
      also trying to abort the installation after the button is pressed (after the button does its purpose, of course)<br />
      <br />
      (thx for your plug-in stu)</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
      <span class="post-time small text-muted">11th April 2006 23:01 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Use Quit to close the installer. Abort when called in any pages' Leave function will just return the user back to the page.<br />
      <br />
      To hide the button for all other pages; in their Show functions use:<br />
      <br />
      GetDlgItem $R0 $HWNDPARENT id_num<br />
      ShowWindow $R0 ${SW_HIDE}<br />
      <br />
      For the page for it to be shown on; use ${SW_SHOW} instead of ${SW_HIDE}. id_num is your button control ID defined through Resource Hacker.<br />
      <br />
      -Stu</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">rmccue</span><br />
      <span class="post-time small text-muted">12th April 2006 01:22 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Can I use ButtonEvent to catch clicks on the minimize/maximize/close buttons? Thanks.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
      <span class="post-time small text-muted">12th April 2006 11:11 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Hmm no I never thought of that :)<br />
      I should be able to add support for it if you want?<br />
      <br />
      Edit: Well only the minimise and close buttons are usable, but the close button is the same as clicking on Cancel (MUI_CUSTOMFUNCTION_ABORT is called). As for minimise what would you want to do there?<br />
      <br />
      -Stu</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">rmccue</span><br />
      <span class="post-time small text-muted">13th April 2006 22:46 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Well,<br />
      I was thinking that it might help me with using Wansis and TrayIcon together.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
      <span class="post-time small text-muted">13th April 2006 23:28 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">So you'd like to call a function when the program is minimised or maximised?<br />
      <br />
      -Stu</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">rmccue</span><br />
      <span class="post-time small text-muted">15th April 2006 01:08 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">I was thinking that. But whenever you click the Tray Icon to minimize/maximize, it would call the function.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
      <span class="post-time small text-muted">15th April 2006 10:13 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">That would need to be a modification to the NotifyIcon plugin.<br />
      I'll see what I can do.<br />
      <br />
      -Stu</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
      <span class="post-time small text-muted">15th April 2006 11:26 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Done.<br />
      <a href="http://nsis.sourceforge.net/File:NotifyIcon.zip" target="_blank">http://nsis.sourceforge.net/File:NotifyIcon.zip</a><br />
      <br />
      Check Examples\NotifyIcon folder.<br />
      <br />
      -Stu</p>
    </div>
    <hr />

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]>
  </script>
</body>
</html>
