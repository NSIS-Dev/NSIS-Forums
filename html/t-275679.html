<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="Unable to altering a list box" />

  <title>Unable to altering a list box - NSIS Forums</title><!-- Bootstrap core CSS -->
  <link rel="stylesheet" type="text/css" href="//netdna.bootstrapcdn.com/bootswatch/3.0.1/readable/bootstrap.min.css" />
  <link rel="stylesheet" href="../css/style.css" type="text/css" /><!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!--[if lt IE 9]>
                <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
                <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->
</head>

<body>
  <div class="container">
    <!-- Put navigation bar here -->

    <ol class="breadcrumb">
      <li><a href="../index.html" class="glyphicon glyphicon-home"></a></li>

      <li><a href="f-65.html">NSIS Discussion</a></li>

      <li class="active">Unable to altering a list box</li>
    </ol>

    <p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=275679">Unable to altering a list box</a></p><br />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">davidnewcomb</span><br />
      <span class="post-time small text-muted">10th August 2007 14:56 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>Unable to altering a list box</strong><br />
      Try as I might I have been unable to update the contents of a list box. I have searched and searched to no avail so any help on this would be appreciated.<br />
      <br />
      I have a list box with some values in it.<br />
      When I hit "Go" I want to select that entry in the list box<br />
      <br />
      On reading some external documentation LB_FINDSTRING returns LB_ERR which is not defined anywhere. I have added a bug on SF (1771644) which covers it, but it would be nice to know so that I can include it in my installer before your next release.<br />
      <br />
      Aside from the LB_ERR issue which is almost academic because no matter what I do it never works.<br />
      <br />
      Tried of programming by trail and error. :(<br />
      Help !<br />
      <br />
      Cheers,<br />
      David.<br />
      <br /></p>
      <pre>
<code><br /><br />[Settings]<br />NumFields=3<br /><br />[Field 1]<br />Type=DropList<br />Left=30<br />Top=26<br />Right=-31<br />Bottom=100<br />Flags=Notify<br />State=<br />ListItems=<br /><br />[Field 2]<br />Type=Text<br />Left=30<br />Top=94<br />Right=119<br />Bottom=114<br />State=three<br /><br />[Field 3]<br />Type=Button<br />Left=156<br />Top=89<br />Right=-5<br />Bottom=119<br />Text=Go<br />Flags=NOTIFY<br /><br /></code>
</pre><br />
      <br />
      <br />
      PHP Code:
      <hr />
      <code style="white-space:nowrap"><!-- php buffer start --></code><span style="color: #000000"><span style="color: #0000BB">Name</span><span style="color: #DD0000">'ListBoxExample'<br /></span> <span style="color: #0000BB">OutFile</span><span style="color: #DD0000">'ListBoxExample.exe'<br />
      <br /></span> <span style="color: #007700">!include</span><span style="color: #DD0000">"MUI.nsh"<br /></span> <span style="color: #007700">!include</span><span style="color: #DD0000">"WinMessages.nsh"<br /></span> <span style="color: #007700">;!include</span><span style="color: #0000BB">LogicLib</span><span style="color: #007700">.</span><span style="color: #0000BB">nsh<br />
      <br /></span> <span style="color: #007700">!</span><span style="color: #0000BB">defineF_SYSTEM__NEXT_ID0<br /></span> <span style="color: #007700">!</span><span style="color: #0000BB">defineF_LIST_ID1<br /></span> <span style="color: #007700">!</span><span style="color: #0000BB">defineF_LIST</span><span style="color: #DD0000">"Field${F_LIST_ID}"<br /></span> <span style="color: #007700">!</span><span style="color: #0000BB">defineF_TEXT_ID2<br /></span> <span style="color: #007700">!</span><span style="color: #0000BB">defineF_TEXT</span><span style="color: #DD0000">"Field${F_TEXT_ID}"<br /></span> <span style="color: #007700">!</span><span style="color: #0000BB">defineF_BUTTON_GO_ID3<br /></span> <span style="color: #007700">!</span><span style="color: #0000BB">defineF_BUTTON_GO</span><span style="color: #DD0000">"Field${F_BUTTON_GO_ID}"<br />
      <br /></span> <span style="color: #0000BB">PageCustomCustomCreateCustomLeave<br />
      <br /></span> <span style="color: #007700">Var</span><span style="color: #0000BB">text_value<br /></span> <span style="color: #007700">Var</span><span style="color: #0000BB">list_hw<br />
      <br />
      Section</span><span style="color: #007700">empty<br /></span> <span style="color: #0000BB">SectionEnd<br />
      <br /></span> <span style="color: #007700">Function</span><span style="color: #0000BB">CustomCreate<br />
      <br /></span> <span style="color: #007700">!</span><span style="color: #0000BB">insertmacroMUI_HEADER_TEXT</span><span style="color: #DD0000">"ListBoxExample""Whywon'titwork?"<br /></span> <span style="color: #007700">!</span><span style="color: #0000BB">insertmacroMUI_INSTALLOPTIONS_WRITE</span><span style="color: #DD0000">"ListBoxExample""${F_LIST}""ListItems""one|two|three|four"<br /></span> <span style="color: #007700">!</span><span style="color: #0000BB">insertmacroMUI_INSTALLOPTIONS_WRITE</span><span style="color: #DD0000">"ListBoxExample""${F_TEXT}""State""three"<br /></span> <span style="color: #007700">!</span><span style="color: #0000BB">insertmacroMUI_INSTALLOPTIONS_DISPLAY</span><span style="color: #DD0000">"ListBoxExample"<br />
      <br /></span> <span style="color: #0000BB">FunctionEnd<br />
      <br /></span> <span style="color: #007700">Function</span><span style="color: #0000BB">CustomLeave<br />
      <br /></span> <span style="color: #007700">!</span><span style="color: #0000BB">insertmacroMUI_INSTALLOPTIONS_READ$text_value</span><span style="color: #DD0000">"ListBoxExample""${F_TEXT}""State"<br /></span> <span style="color: #0000BB">MessageBoxMB_OK</span><span style="color: #DD0000">"text_value=$text_value|"<br /></span> <span style="color: #007700">!</span><span style="color: #0000BB">insertmacroMUI_INSTALLOPTIONS_READ$list_hw</span><span style="color: #DD0000">"ListBoxExample""${F_LIST}""HWND"<br /></span> <span style="color: #0000BB">MessageBoxMB_OK</span><span style="color: #DD0000">"list_hw=$list_hw|"<br />
      <br /></span> <span style="color: #007700">!</span><span style="color: #0000BB">insertmacroMUI_INSTALLOPTIONS_READ</span><span style="color: #007700">$</span><span style="color: #0000BB">0</span><span style="color: #DD0000">"ListBoxExample""Settings""State"<br /></span> <span style="color: #0000BB">StrCmp</span><span style="color: #007700">$</span><span style="color: #0000BB">0</span><span style="color: #007700">${</span><span style="color: #0000BB">F_SYSTEM__NEXT_ID</span><span style="color: #007700">}</span><span style="color: #0000BB">end<br />
      StrCmp</span><span style="color: #007700">$</span><span style="color: #0000BB">0</span><span style="color: #007700">${</span><span style="color: #0000BB">F_BUTTON_GO_ID</span><span style="color: #007700">}</span><span style="color: #0000BB">go<br />
      Abort<br />
      <br />
      go</span><span style="color: #007700">:<br />
      <br /></span> <span style="color: #FF8000">#ShowinListbox<br /></span> <span style="color: #0000BB">SendMessage$list_hw</span><span style="color: #007700">${</span><span style="color: #0000BB">LB_SELECTSTRING</span><span style="color: #007700">}-</span><span style="color: #0000BB">1</span><span style="color: #DD0000">"STR:$text_value"</span><span style="color: #007700">$</span><span style="color: #0000BB">0</span><span style="color: #007700">/</span><span style="color: #0000BB">TIMEOUT</span><span style="color: #007700">=</span><span style="color: #0000BB">5000<br />
      <br />
      end</span><span style="color: #007700">:<br /></span> <span style="color: #0000BB">Abort<br />
      <br />
      FunctionEnd<br />
      <br />
      <br /></span> <span style="color: #007700">Function.</span><span style="color: #0000BB">onInit<br /></span> <span style="color: #007700">!</span><span style="color: #0000BB">insertmacroMUI_INSTALLOPTIONS_EXTRACT_AS</span><span style="color: #DD0000">"ListBoxExample.ini""ListBoxExample"<br /></span> <span style="color: #0000BB">FunctionEnd<br /></span></span> <!-- php buffer end -->
      <hr />
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
      <span class="post-time small text-muted">10th August 2007 15:02 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">If the return value is &lt;0 then it was not successful.<br />
      <br />
      Stu</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">davidnewcomb</span><br />
      <span class="post-time small text-muted">10th August 2007 15:32 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Thanks Stu, any idea why the code isn't working?</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
      <span class="post-time small text-muted">10th August 2007 15:40 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">DropList is not a list box, it's a combo box control.<br />
      <br />
      Stu</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">davidnewcomb</span><br />
      <span class="post-time small text-muted">10th August 2007 16:44 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">I want to have your babies! All fixed now - thanks.</p>
    </div>
    <hr />

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]>
  </script>
</body>
</html>
