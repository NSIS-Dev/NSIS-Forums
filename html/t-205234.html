<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="description" content="Problems with nsExec::Exec"><title>Problems with nsExec::Exec - NSIS Forums</title><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script><link rel="preload" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css" as="style" onload="this.rel='stylesheet'"><link rel="preload" href="../css/style.css" as="style" onload="this.rel='stylesheet'"><noscript><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css"><link rel="stylesheet" href="../css/style.css"></noscript><script>!function(a){"use strict";var b=function(b,c,d){function e(a){return h.body?a():void setTimeout(function(){e(a)})}function f(){i.addEventListener&&i.removeEventListener("load",f),i.media=d||"all"}var g,h=a.document,i=h.createElement("link");if(c)g=c;else{var j=(h.body||h.getElementsByTagName("head")[0]).childNodes;g=j[j.length-1]}var k=h.styleSheets;i.rel="stylesheet",i.href=b,i.media="only x",e(function(){g.parentNode.insertBefore(i,c?g:g.nextSibling)});var l=function(a){for(var b=i.href,c=k.length;c--;)if(k[c].href===b)return a();setTimeout(function(){l(a)})};return i.addEventListener&&i.addEventListener("load",f),i.onloadcssdefined=l,l(f),i};"undefined"!=typeof exports?exports.loadCSS=b:a.loadCSS=b}("undefined"!=typeof global?global:this);!function(a){if(a.loadCSS){var b=loadCSS.relpreload={};if(b.support=function(){try{return a.document.createElement("link").relList.supports("preload")}catch(b){return!1}},b.poly=function(){for(var b=a.document.getElementsByTagName("link"),c=0;c<b.length;c++){var d=b[c];"preload"===d.rel&&"style"===d.getAttribute("as")&&(a.loadCSS(d.href,d,d.getAttribute("media")),d.rel=null)}},!b.support()){b.poly();var c=a.setInterval(b.poly,300);a.addEventListener&&a.addEventListener("load",function(){b.poly(),a.clearInterval(c)}),a.attachEvent&&a.attachEvent("onload",function(){a.clearInterval(c)})}}}(this);</script></head><body><div class="container"><ol class="breadcrumb"><li><a href="../index.html" class="glyphicon glyphicon-home"></a></li><li><a href="f-65.html">NSIS Discussion</a></li><li class="active">Problems with nsExec::Exec</li></ol><p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=205234">Problems with nsExec::Exec</a></p><br><div class="post"><p class="post-meta"><span class="post-author text-primary">mnavarro</span><br><span class="post-time small text-muted">18th January 2005 10:13 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>Problems with nsExec::Exec</strong><br>The installer of our procuct uses nsExec::Exec and it always have worked fine. But recently one of our clients is experiencing some problems with our installer: it hangs. We suspected the problem was related with nsExec and we made a little installer that just calls "nsExec:Exec notepad.exe". In our machines this installer works fine but in client's machine it also hangs.<br><br>Client's machine has a Windows 2000 Advanced Server in Chinese with SP4. We have tried it in a Windows 2000 Advanced Server in Spanish with SP4 and it works fine<br><br>Have you ever heard about nsExec problems like this?<br><br>Thanks</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Takhir</span><br><span class="post-time small text-muted">18th January 2005 10:34 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Do not use nsExec with window applications, this plug-in was written for DOS apps only. For Notepad and others use Exec, ExecWait, ExecShell.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">mnavarro</span><br><span class="post-time small text-muted">18th January 2005 10:55 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Our installer doesn't call notepad.exe. Our installer uses nsExec to call DOS apps. notepad.exe is called from a small installer we made to ensure that the problem was caused by nsExec. This installer has four sections: one section uses nsExec to call dcomperm.exe (the app of our installer), another one uses nsExec to call a DOS hello world app, another one uses nsExec to call notepad.exe and the last one calls dcomperm.exe with ExecWait.<br>In out client machine the installer hangs if he selects any of the first three sections (the nsExec ones) and works fine if he only selects the forth one. So the problem is not the dcomperm.exe app but the nsExec itself.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Yathosho</span><br><span class="post-time small text-muted">18th January 2005 11:34 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">maybe you should use $WINDIR\notepad.exe ?</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">kichik</span><br><span class="post-time small text-muted">18th January 2005 18:34 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">I have never heard about such problems with nsExec. Any chance you can open Contrib\nsExec\nsExec.c, insert some debug information (message boxes/OutputDebugString/log file) and post your findings?</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Takhir</span><br><span class="post-time small text-muted">18th January 2005 18:56 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">2 days ago <a href="http://forums.winamp.com/showthread.php?s=&amp;threadid=205043" target="_blank">http://forums.winamp.com/showthread....hreadid=205043</a> :)<br>May be chinese string length (file path)? Or problems with ASCII and Unicode?</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">kichik</span><br><span class="post-time small text-muted">18th January 2005 18:58 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">That's not a similar problem.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">mnavarro</span><br><span class="post-time small text-muted">19th January 2005 09:08 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">We haven't been able to reproduce the problem in our office, so it's not easy to find the problem modifying the nsExec.c. But I will take a look at it anyway I will let you know any progress.<br><br>Thanks</p></div><hr><div class="footer"><p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p></div></div><script src="../js/highlight.pack.js" type="text/javascript"></script><script type="text/javascript">//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]></script></body></html>