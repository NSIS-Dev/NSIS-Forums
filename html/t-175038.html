<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="SelectSection" />

  <title>SelectSection - NSIS Forums</title>
  <script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script>
  <!-- Bootstrap core CSS -->

  <link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css" />
  <link rel="stylesheet" href="../css/style.css" type="text/css" /><!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!--[if lt IE 9]>
                <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
                <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->
</head>

<body>
  <div class="container">
    <!-- Put navigation bar here -->

    <ol class="breadcrumb">
      <li><a href="../index.html" class="glyphicon glyphicon-home"></a></li>

      <li><a href="f-65.html">NSIS Discussion</a></li>

      <li class="active">SelectSection</li>
    </ol>

    <p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=175038">SelectSection</a></p><br />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">DigitAl56K</span><br />
      <span class="post-time small text-muted">2nd April 2004 01:06 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>SelectSection</strong><br />
      Hi guys,<br />
      <br />
      I'm looking for a way for one section to turn on a bunch of others when enabled.<br />
      <br />
      Currently I'm looking at the SelectSection macro in Section.nsh, and doing something like this:<br />
      <br />
      <b>Section "First section"<br />
      !insertmacro SelectSection TEST<br />
      SectionEnd<br />
      <br />
      Section "Second section" TEST<br />
      MessageBox MB_OK "Enabled!"<br />
      SectionEnd</b><br />
      <br />
      When I turn on the first section and hit next I expect to see the second section run, because the first section should have enabled it. This doesn't seem to be the case though.<br />
      <br />
      Any ideas where I'm going wrong, or alternative solutions for achieving the desired functionality?</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Vytautas</span><br />
      <span class="post-time small text-muted">2nd April 2004 01:25 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">The 'one-section.nsi' in the examples directory should give you some ideas.<br />
      <br />
      Vytautas :)</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
      <span class="post-time small text-muted">2nd April 2004 05:31 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">TEST is parsed as 0 because NSIS expects a number for what the SelectSection macro uses. You should use ${TEST}. Another problem is that TEST will not be defined at that point so you'd need to define a function after the second section. That function should enable that section and should be called from the first section.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">DigitAl56K</span><br />
      <span class="post-time small text-muted">5th April 2004 04:11 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">kichik: Firstly, thanks for actually offering some help, and not simply pointing me at an example file already referenced in the usage notes....<br />
      <br />
      Second, perhaps you can help me understand how parameters are passed. If I look at the SelectSection macro code I see this:<br />
      <br />
      <i>!macro SelectSection SECTION<br />
      <br />
      Push $0<br />
      SectionGetFlags "${SECTION}" $0<br />
      IntOp $0 $0 | ${SF_SELECTED}<br />
      SectionSetFlags "${SECTION}" $0<br />
      Pop $0<br /></i><br />
      <br />
      Which lead me to believe that SECTION should be the section name, not enclodes in ${}, since this is already added in the macro code. Obviously this isn't the case :)<br />
      <br />
      It seems that one section can't enable another? I can make SelectSection work when I call it from a callback like .onSelChange, but I think there is an ordering problem.<br />
      <br />
      You say I can't use TEST until it has been defined, so I can't try to enable the TEST section until after its already been processed, which means even if I enable it, it won't run...<br />
      <br />
      Its kind of annoying that there is no callback that occurs right when the user leaves the components page but before sections are actually processed to enable you to manage this kind of thing. It makes my problem a lot harder...</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Joost Verburg</span><br />
      <span class="post-time small text-muted">5th April 2004 07:59 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"></p>
      <pre>
<code>Section "First section"<br />  Call SelectSecond<br />SectionEnd<br /><br />Section "Second section" TEST<br />  MessageBox MB_OK "Enabled!"<br />SectionEnd<br /><br />Function SelectSecond<br />  !insertmacro SelectSection ${TEST}<br />FunctionEnd</code>
</pre>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
      <span class="post-time small text-muted">5th April 2004 11:31 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Macro parameters are passed defines. For example:</p>
      <pre>
<code>!macro echo msg<br />DetailPrint "${msg}"<br />!macroend<br />!insertmacro echo "a message"</code>
</pre>will translate into
      <pre>
<code>DetailPrint "a message"</code>
</pre>You can think of the !insertmacro lines as:
      <pre>
<code>!define msg "a message"<br />DetailPrint "${msg}"</code>
</pre>As for one section enabling another, you can use the function trick I talked about and Joost demonstrated.
    </div>
    <hr />

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]>
  </script>
</body>
</html>
