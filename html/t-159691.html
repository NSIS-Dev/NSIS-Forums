<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="description" content="All User script"><title>All User script - NSIS Forums</title><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script><link rel="preload" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css" as="style" onload="this.rel='stylesheet'"><link rel="preload" href="../css/style.css" as="style" onload="this.rel='stylesheet'"><noscript><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css"><link rel="stylesheet" href="../css/style.css"></noscript><script>!function(a){"use strict";var b=function(b,c,d){function e(a){return h.body?a():void setTimeout(function(){e(a)})}function f(){i.addEventListener&&i.removeEventListener("load",f),i.media=d||"all"}var g,h=a.document,i=h.createElement("link");if(c)g=c;else{var j=(h.body||h.getElementsByTagName("head")[0]).childNodes;g=j[j.length-1]}var k=h.styleSheets;i.rel="stylesheet",i.href=b,i.media="only x",e(function(){g.parentNode.insertBefore(i,c?g:g.nextSibling)});var l=function(a){for(var b=i.href,c=k.length;c--;)if(k[c].href===b)return a();setTimeout(function(){l(a)})};return i.addEventListener&&i.addEventListener("load",f),i.onloadcssdefined=l,l(f),i};"undefined"!=typeof exports?exports.loadCSS=b:a.loadCSS=b}("undefined"!=typeof global?global:this);!function(a){if(a.loadCSS){var b=loadCSS.relpreload={};if(b.support=function(){try{return a.document.createElement("link").relList.supports("preload")}catch(b){return!1}},b.poly=function(){for(var b=a.document.getElementsByTagName("link"),c=0;c<b.length;c++){var d=b[c];"preload"===d.rel&&"style"===d.getAttribute("as")&&(a.loadCSS(d.href,d,d.getAttribute("media")),d.rel=null)}},!b.support()){b.poly();var c=a.setInterval(b.poly,300);a.addEventListener&&a.addEventListener("load",function(){b.poly(),a.clearInterval(c)}),a.attachEvent&&a.attachEvent("onload",function(){a.clearInterval(c)})}}}(this);</script></head><body><div class="container"><ol class="breadcrumb"><li><a href="../index.html" class="glyphicon glyphicon-home"></a></li><li><a href="f-65.html">NSIS Discussion</a></li><li class="active">All User script</li></ol><p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=159691">All User script</a></p><br><div class="post"><p class="post-meta"><span class="post-author text-primary">Bill Halpern</span><br><span class="post-time small text-muted">14th December 2003 17:59 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>All User script</strong><br>I am a brand new user to NSIS. Love it.<br><br>1. I am having somewhat of a problem. I have created a simple install script using the HMNIS editor. It works great but only for the currently logged on user. How do I set it to work for All Users of the machine?<br><br>2. Is there any way to set the Start in Directory of the created shortcuts?<br><br>Remember, I am a real novice at this. Please help.<br><br>Thanks</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Joel</span><br><span class="post-time small text-muted">14th December 2003 18:07 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">SetContextVar it's your friend :)</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Bill Halpern</span><br><span class="post-time small text-muted">14th December 2003 18:11 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>AllUser</strong><br></p><blockquote><i>Originally posted by Lobo Lunar</i><br><b>SetContextVar it's your friend :)</b></blockquote>I am a non-programmer and don't understand what you mean here. Could you give me some more details?<br><br>Thank You</div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Joel</span><br><span class="post-time small text-muted">14th December 2003 18:21 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">I read again your question. I thought you were talking about installation. Sorry...<br>Let's start again... about the users.... you must have enable "all users" to do this....must be apply for the currently user of your NT machine...<br>About the shortcut... I don't understand the <i>Is there any way to set the Start in Directory of the created shortcuts</i><br>Do you ment open the folder where the shorcuts were created? If so check the ShellExec instructions of the manual...<br>HIH (Hope it helps)!!!</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Bill Halpern</span><br><span class="post-time small text-muted">14th December 2003 18:52 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"></p><blockquote><i>Originally posted by Lobo Lunar</i><br><b>I read again your question. I thought you were talking about installation. Sorry...<br>Let's start again... about the users.... you must have enable "all users" to do this....must be apply for the currently user of your NT machine...<br>About the shortcut... I don't understand the <i>Is there any way to set the Start in Directory of the created shortcuts</i><br>Do you ment open the folder where the shorcuts were created? If so check the ShellExec instructions of the manual...<br>HIH (Hope it helps)!!!</b></blockquote>Thank you for your patience with me. One more time. I want to be able to do this easily if possible using the script editor. I have created a script that does the install but only puts the shortcuts on the current users desktop.<br><br>I don't know what you mean by "enable all users to do this." Where do I do this? When I run the install program I want the user to be able to answer whether he wants this to be installed for just the current user or all users. Can you be more specific?<br><br>Thank you again.</div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">kichik</span><br><span class="post-time small text-muted">14th December 2003 20:57 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">SetShellVarContext:</p><blockquote>Sets the context of $SMPROGRAMS and other shell folders. If set to 'current' (the default), the current user's shell folders are used. If set to 'all', the 'all users' shell folder is used. The all users folder may not be supported on all OSes.</blockquote>You can use it to tell NSIS to put the shortcut on the all users' desktop instead of just on the current user's desktop.<br><br>For example:<pre>
<code>SetShellVarContext all<br>CreateShortcut $DESKTOP\MyProg.lnk $INSTDIR\MyProg.exe</code>
</pre><br>
      <br>
      If you want to give the user an option you can create an InstallOptions page to get the user's input. See Examples\Modern UI\InstallOptions.nsi for an example and Contrib\InstallOptions\Readme.html for the documentation.<br>
      <br>
      To set the working directory of shortcuts use SetOutPath. For example:
      <pre>
<code>SetOutPath "C:\working\directory\for\the\shortcut"<br>CreateShortcut $DESKTOP\MyProg.lnk $INSTDIR\MyProg.exe</code>
</pre>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Bill Halpern</span><br>
      <span class="post-time small text-muted">14th December 2003 21:09 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"></p>

      <blockquote>
        <i>Originally posted by kichik</i><br>
        <b>SetShellVarContext:You can use it to tell NSIS to put the shortcut on the all users' desktop instead of just on the current user's desktop.<br>
        <br>
        For example:</b>
        <pre>
<b><code>SetShellVarContext all<br>CreateShortcut $DESKTOP\MyProg.lnk $INSTDIR\MyProg.exe</code></b>
</pre><b><br>
        <br>
        If you want to give the user an option you can create an InstallOptions page to get the user's input. See Examples\Modern UI\InstallOptions.nsi for an example and Contrib\InstallOptions\Readme.html for the documentation.<br>
        <br>
        To set the working directory of shortcuts use SetOutPath. For example:</b>
        <pre>
<b><code>SetOutPath "C:\working\directory\for\the\shortcut"<br>CreateShortcut $DESKTOP\MyProg.lnk $INSTDIR\MyProg.exe</code></b>
</pre>
      </blockquote>Thank You! This is just what I needed. Consider yourself a savior of a neophyte!!
    </div>
    <hr>

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script type="text/javascript" src="../js/highlight.pack.js" async>
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]></script></body></html>