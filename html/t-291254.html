<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="Building a Windows installer package under FreeBSD invalid DOS header message" />

  <title>Building a Windows installer package under FreeBSD invalid DOS header message - NSIS Forums</title>
  <script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script>
  <!-- Bootstrap core CSS -->

  <link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css" />
  <link rel="stylesheet" href="../css/style.css" type="text/css" /><!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!--[if lt IE 9]>
                <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
                <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->
</head>

<body>
  <div class="container">
    <!-- Put navigation bar here -->

    <ol class="breadcrumb">
      <li><a href="../index.html" class="glyphicon glyphicon-home"></a></li>

      <li><a href="f-65.html">NSIS Discussion</a></li>

      <li class="active">Building a Windows installer package under FreeBSD invalid DOS header message</li>
    </ol>

    <p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=291254">Building a Windows installer package under FreeBSD invalid DOS header message</a></p><br />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">geekgod</span><br />
      <span class="post-time small text-muted">4th May 2008 02:24 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>Building a Windows installer package under FreeBSD invalid DOS header message</strong><br />
      Hello, I am trying to build a OpenVPN gui installer under FreeBSD but keep running into this error:<br />
      <br />
      !define: "MUI_UNFINISHPAGE_NOAUTOCLOSE"=""<br />
      !define: "MUI_COMPONENTSPAGE_TEXT_TOP"="Select the components to install/upgrade. Stop any OpenVPN or OpenVPN GUI processes or the OpenVPN service if it is running."<br />
      !insertmacro: MUI_PAGE_LICENSE<br />
      Error while changing UI: PE file contains invalid DOS header<br />
      Error in macro MUI_INTERFACE on macroline 50<br />
      Error in macro MUI_PAGE_INIT on macroline 2<br />
      Error in macro MUI_PAGE_LICENSE on macroline 5<br />
      Error in script "openvpn-gui.nsi" on line 111 -- aborting creation process<br />
      <br />
      Does anyone know which file this is complaining about or how to fix this?</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
      <span class="post-time small text-muted">4th May 2008 06:33 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">It's probably complaining about Contrib/UIs/modern.exe. Can you execute that application on Windows? Which version of NSIS is that? Which processor are you using?</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">geekgod</span><br />
      <span class="post-time small text-muted">5th May 2008 02:58 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Thanks for the reply.<br />
      <br />
      Using nsis-2.36 and I zipped up the Contrib/UIs from a recent NSIS Windows Installer executable and used WinSCP to copy the zip file to the FreeBSD host and used unzip to extract the files. I am pretty sure the windows binaries will work OK on windows.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
      <span class="post-time small text-muted">5th May 2008 19:05 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Processor?</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">geekgod</span><br />
      <span class="post-time small text-muted">5th May 2008 19:16 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Here is the relevant dmesg -a information:<br />
      <br />
      Copyright (c) 1992-2008 The FreeBSD Project.<br />
      Copyright (c) 1979, 1980, 1983, 1986, 1988, 1989, 1991, 1992, 1993, 1994<br />
      The Regents of the University of California. All rights reserved.<br />
      FreeBSD is a registered trademark of The FreeBSD Foundation.<br />
      FreeBSD 7.0-RELEASE #0: Sun Feb 24 19:59:52 UTC 2008<br />
      <a href="mailto:root@logan.cse.buffalo.edu">root@logan.cse.buffalo.edu</a>:/usr/obj/usr/src/sys/GENERIC<br />
      Timecounter "i8254" frequency 1193182 Hz quality 0<br />
      CPU: AMD Opteron(tm) Processor 275 (2205.01-MHz 686-class CPU)<br />
      Origin = "AuthenticAMD" Id = 0x20f12 Stepping = 2<br />
      Features=0x178bfbff&lt;FPU,VME,DE,PSE,TSC,MSR,PAE,MCE,CX8,APIC,SEP,MTRR,PGE,MCA,CMOV,PAT,PSE36,CLFLUSH,MMX,FXSR,SSE,SSE2,HTT&gt;<br />
      Features2=0x1&lt;SSE3&gt;<br />
      AMD Features=0xe2500800&lt;SYSCALL,NX,MMX+,FFXSR,LM,3DNow!+,3DNow!&gt;<br />
      AMD Features2=0x2&lt;CMP&gt;<br />
      Cores per package: 2<br />
      real memory = 1073709056 (1023 MB)<br />
      avail memory = 1037111296 (989 MB)<br />
      ACPI APIC Table: &lt;HP 00000083&gt;<br />
      FreeBSD/SMP: Multiprocessor System Detected: 2 CPUs<br />
      cpu0 (BSP): APIC ID: 0<br />
      cpu1 (AP): APIC ID: 1<br />
      <br />
      Appreciate all the help so far!!</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
      <span class="post-time small text-muted">5th May 2008 19:20 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">It might be complaining about the Stubs. Have you copied those from Windows as well? That check is the very first check of the EXE file and just checks the first two characters are MZ. If your processor is not big-endian, I don't see how that can go wrong unless the file is really invalid.<br />
      <br />
      Do you care for some debugging? Can you tell what it compares to MZ?</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">geekgod</span><br />
      <span class="post-time small text-muted">5th May 2008 19:25 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Hmm, you might be on to something. I could not locate any of the stubs in the source tree since soca was instructed to not build them (it errors out when building). So this very well might be the cause of the issues. Where can I obtain the correct Stubs to populate to /usr/local/Stubs?</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
      <span class="post-time small text-muted">5th May 2008 19:38 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">From the zipped up version of NSIS. See the SourceForge download page. As for the location, I'm not sure that's the right one, but it depends on how you built makensis.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">geekgod</span><br />
      <span class="post-time small text-muted">5th May 2008 19:42 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">The zipped up version of NSIS's stubs will work okay on FreeBSD without rebuilding?</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
      <span class="post-time small text-muted">5th May 2008 20:49 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Sure. It's just the Windows installer stub. They are read as data files by makensis.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">geekgod</span><br />
      <span class="post-time small text-muted">6th May 2008 00:34 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">That appears to have fixed it. Thanks a lot for your help!!</p>
    </div>
    <hr />

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]>
  </script>
</body>
</html>
