<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="blanking out the Install button" />

  <title>blanking out the Install button - NSIS Forums</title>
  <script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script>
  <!-- Bootstrap core CSS -->

  <link rel="stylesheet" type="text/css" href="//netdna.bootstrapcdn.com/bootswatch/3.0.1/readable/bootstrap.min.css" />
  <link rel="stylesheet" href="../css/style.css" type="text/css" /><!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!--[if lt IE 9]>
                <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
                <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->
</head>

<body>
  <div class="container">
    <!-- Put navigation bar here -->

    <ol class="breadcrumb">
      <li><a href="../index.html" class="glyphicon glyphicon-home"></a></li>

      <li><a href="f-65.html">NSIS Discussion</a></li>

      <li class="active">blanking out the Install button</li>
    </ol>

    <p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=280363">blanking out the Install button</a></p><br />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">xthematrix</span><br />
      <span class="post-time small text-muted">30th October 2007 20:30 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>blanking out the Install button</strong><br />
      how do i blank out the install button. i want it to appear, just faded out, and the user can't click on it until they select at least one component on MUI_PAGE_COMPONENTS<br />
      <br />
      is there a code that I can use to set the install button temporarily off, then when the user clicks on one of the components (each component is in a different section)it will become active.<br />
      <br />
      Thanks.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
      <span class="post-time small text-muted">30th October 2007 20:32 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Disable/enable it with EnableWindow.<br />
      <br />
      Stu</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">xthematrix</span><br />
      <span class="post-time small text-muted">30th October 2007 22:23 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">ok , i tried the following code and it removed the next button on the welcome page...<br />
      <br />
      !define MUI_WELCOMEFINISHPAGE_CUSTOMFUNCTION_INIT disableInstallButton<br />
      <br />
      Function disableInstallButton<br />
      GetDlgItem $1 $HWNDPARENT 1<br />
      EnableWindow $1 0<br />
      FunctionEnd<br />
      <br />
      but now i want it to do the same thing, only on the components page, and this time the install button.<br />
      I have a bunch of sections on the components page.<br />
      How do I get this code to work on the MUI_PAGE_COMPONENTS?</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
      <span class="post-time small text-muted">30th October 2007 22:59 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Replace MUI_WELCOMEFINISHPAGE_CUSTOMFUNCTION_INIT with MUI_PAGE_CUSTOMFUNCTION_SHOW and place the entire line (!define ...) before !insertmacro MUI_PAGE_COMPONENTS.<br />
      <br />
      As for enabling/disabling the button dynamically on section check/uncheck, you need to do this in .onSelChange and use ${If} ${SectionIsSelected} (LogicLib.nsh).<br />
      <br />
      Stu</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">xthematrix</span><br />
      <span class="post-time small text-muted">31st October 2007 01:15 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">ok replacing the line and placing it before MUI_PAGE_COMPONENTS worked successfully!<br />
      The Install option is now blanked out.<br />
      <br />
      The next problem is this...<br />
      <br />
      I have included LogicLib at the top of my script as<br />
      !include LogicLib.nsh<br />
      <br />
      However, when I add the following code to .onSelChange, which is located at the very bottom of my script, i get a compiler error message<br />
      <br />
      Function .onSelChange<br />
      ${If} ${SectionIsSelected}<br />
      GetDlgItem $1 $HWNDPARENT 1<br />
      EnableWindow $1 1<br />
      FunctionEnd<br />
      <br />
      The error message is<br />
      <br />
      !insertmacro: macro "_If" requires 4 parameter(s), passed 3!<br />
      Error in script "G:\setup.nsi" on line 398 -- aborting creation process<br />
      <br />
      <br />
      If I take out the code<br />
      ${If} ${SectionIsSelected}<br />
      the install button appears from its blanked out state when the user clicks on a component. However, it does not return to the blanked out state when they unclick it.<br />
      <br />
      Any suggestions?</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">demiller9</span><br />
      <span class="post-time small text-muted">31st October 2007 05:02 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">${SectionIsSelected} requires a section index (the identifier you add after the section name). And you are missing the ${EndIf}. You probably want an ${Else} to reset (disable) the button when the section is not selected.<br /></p>
      <pre>
<code>Function .onSelChange<br />GetDlgItem $1 $HWNDPARENT 1<br />${If} ${SectionIsSelected} ${mySectionId}<br />  EnableWindow $1 1<br />${Else}<br />  EnableWindow $1 0<br />${EndIf}<br />FunctionEnd<br /></code>
</pre><br />
      With more than one section, the logic will have to be more complex, but this is the basic idea. You will want to check that the user has selected enough sections before you enable the button, and disable the button when they don't have enough sections selected.<br />
      <br />
      Don
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
      <span class="post-time small text-muted">31st October 2007 11:24 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Make sure this function goes after all sections.<br />
      <br />
      I.e.<br /></p>
      <pre>
<code>Section "A section" mySection1<br />SectionEnd<br /><br />Section "Another section" mySection2<br />SectionEnd<br /><br />Function .onSelChange<br />GetDlgItem $1 $HWNDPARENT 1<br />${If} ${SectionIsSelected} ${mySection1}<br />${OrIf} ${SectionIsSelected} ${mySection1}<br />  EnableWindow $1 1<br />${Else}<br />  EnableWindow $1 0<br />${EndIf}<br />FunctionEnd</code>
</pre><br />
      <br />
      Stu
    </div>
    <hr />

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]>
  </script>
</body>
</html>
