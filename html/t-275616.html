<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="Vista doesn't like an NSIS installer" />

  <title>Vista doesn't like an NSIS installer - NSIS Forums</title>
  <script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script>
  <!-- Bootstrap core CSS -->

  <link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css" />
  <link rel="stylesheet" href="../css/style.css" type="text/css" /><!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!--[if lt IE 9]>
                <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
                <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->
</head>

<body>
  <div class="container">
    <!-- Put navigation bar here -->

    <ol class="breadcrumb">
      <li><a href="../index.html" class="glyphicon glyphicon-home"></a></li>

      <li><a href="f-65.html">NSIS Discussion</a></li>

      <li class="active">Vista doesn't like an NSIS installer</li>
    </ol>

    <p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=275616">Vista doesn't like an NSIS installer</a></p><br />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
      <span class="post-time small text-muted">9th August 2007 12:11 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>Vista doesn't like an NSIS installer</strong><br />
      In Windows Vista:<br /></p>

      <blockquote>
        First it puts up the Nag box that this is an "Unidentified Program" and you need to click "Allow" the install. Then, after the install, only sometimes, Vista will say that the program might not have installed correctly and should be reinstalled with the proper configuration settings. You need to say it did install correctly or click on the Reinstall with proper settings (nothing different) and let it do it again. Then Vista is happy.
      </blockquote>The installer does not write any registry keys. It only extracts files.<br />
      <br />
      Any ideas?<br />
      <br />
      Stu
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Red Wine</span><br />
      <span class="post-time small text-muted">9th August 2007 12:37 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Throw vista away, considered as an idea?</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Anders</span><br />
      <span class="post-time small text-muted">9th August 2007 13:20 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">try adding RequestExecutionLevel to disable lagacy installer detection.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">helix400</span><br />
      <span class="post-time small text-muted">10th August 2007 00:33 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>Re: Vista doesn't like an NSIS installer</strong><br /></p>

      <blockquote>
        First it puts up the Nag box that this is an "Unidentified Program" and you need to click "Allow" the install.
      </blockquote>I'm pretty sure this part is an NTFS thing. If the file was copied from an unidentified source, it will pop up that message when a user tries to execute it.<br />
      <br />
      For example, if you download an installer from the web using Internet Explorer to a local NTFS drive, a setting is put on that file that says it's an unidentified program. So when you double click on it, you get that dialog box.
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">DariTo</span><br />
      <span class="post-time small text-muted">10th August 2007 19:18 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">I just tried a simple nsis installer writing in registry and it did fine, maybe a little more explanation?</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
      <span class="post-time small text-muted">10th August 2007 19:20 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Using RequestExecutionLevel worked.<br />
      <br />
      Stu</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">vbguy</span><br />
      <span class="post-time small text-muted">12th August 2007 22:12 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>Re: Re: Vista doesn't like an NSIS installer</strong><br /></p>

      <blockquote>
        <i>Originally posted by helix400</i><br />
        <b>I'm pretty sure this part is an NTFS thing. If the file was copied from an unidentified source, it will pop up that message when a user tries to execute it.<br />
        <br />
        For example, if you download an installer from the web using Internet Explorer to a local NTFS drive, a setting is put on that file that says it's an unidentified program. So when you double click on it, you get that dialog box.</b>
      </blockquote>It's a UAC function in vista, and there was a similar warning for files downloaded with IE in XP SP2.<br />
      <br />
      You can avoid the non-descript yellow box if you code sign your installer. So instead of a yellow warning that says "Unidentified Program", it will instead be a more subtle color and say "YourProgramName from YourCompanyName needs elevated privileges.<br />
      <br />
      A code signing certificate cost anywhere from $90 to $400 depending on who you buy from.<br />
      <br />
      See this article to learn more about code signing and some cheap places to get certificates: en.wikipedia.org/wiki/Code_signing
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Joel</span><br />
      <span class="post-time small text-muted">13th August 2007 01:19 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>Re: Re: Re: Vista doesn't like an NSIS installer</strong><br /></p>

      <blockquote>
        <i>Originally posted by vbguy</i><br />
        <b>It's a UAC function in vista, and there was a similar warning for files downloaded with IE in XP SP2.<br />
        <br />
        You can avoid the non-descript yellow box if you code sign your installer. So instead of a yellow warning that says "Unidentified Program", it will instead be a more subtle color and say "YourProgramName from YourCompanyName needs elevated privileges.<br />
        <br />
        A code signing certificate cost anywhere from $90 to $400 depending on who you buy from.<br />
        <br />
        See this article to learn more about code signing and some cheap places to get certificates: en.wikipedia.org/wiki/Code_signing</b>
      </blockquote>Wouldn't be cheapier just to stick with XP or above?
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">vbguy</span><br />
      <span class="post-time small text-muted">14th August 2007 00:31 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>Re: Re: Re: Re: Vista doesn't like an NSIS installer</strong><br /></p>

      <blockquote>
        <i>Originally posted by Joel</i><br />
        <b>Wouldn't be cheapier just to stick with XP or above?</b>
      </blockquote>Sure, but when XP goes the way of Windows 98 and all of your users switch to Vista and beyond, you're stuck with unprofessional looking software and installers.
    </div>
    <hr />

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]>
  </script>
</body>
</html>
