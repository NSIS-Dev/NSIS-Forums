<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="description" content="&quot;Install&quot; button disabled after verifying directory"><title>"Install" button disabled after verifying directory - NSIS Forums</title><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script><link rel="preload" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css" as="style" onload="this.rel='stylesheet'"><link rel="preload" href="../css/style.css" as="style" onload="this.rel='stylesheet'"><noscript><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css"><link rel="stylesheet" href="../css/style.css"></noscript><script>!function(a){"use strict";var b=function(b,c,d){function e(a){return h.body?a():void setTimeout(function(){e(a)})}function f(){i.addEventListener&&i.removeEventListener("load",f),i.media=d||"all"}var g,h=a.document,i=h.createElement("link");if(c)g=c;else{var j=(h.body||h.getElementsByTagName("head")[0]).childNodes;g=j[j.length-1]}var k=h.styleSheets;i.rel="stylesheet",i.href=b,i.media="only x",e(function(){g.parentNode.insertBefore(i,c?g:g.nextSibling)});var l=function(a){for(var b=i.href,c=k.length;c--;)if(k[c].href===b)return a();setTimeout(function(){l(a)})};return i.addEventListener&&i.addEventListener("load",f),i.onloadcssdefined=l,l(f),i};"undefined"!=typeof exports?exports.loadCSS=b:a.loadCSS=b}("undefined"!=typeof global?global:this);!function(a){if(a.loadCSS){var b=loadCSS.relpreload={};if(b.support=function(){try{return a.document.createElement("link").relList.supports("preload")}catch(b){return!1}},b.poly=function(){for(var b=a.document.getElementsByTagName("link"),c=0;c<b.length;c++){var d=b[c];"preload"===d.rel&&"style"===d.getAttribute("as")&&(a.loadCSS(d.href,d,d.getAttribute("media")),d.rel=null)}},!b.support()){b.poly();var c=a.setInterval(b.poly,300);a.addEventListener&&a.addEventListener("load",function(){b.poly(),a.clearInterval(c)}),a.attachEvent&&a.attachEvent("onload",function(){a.clearInterval(c)})}}}(this);</script></head><body><div class="container"><ol class="breadcrumb"><li><a href="../index.html" class="glyphicon glyphicon-home"></a></li><li><a href="f-65.html">NSIS Discussion</a></li><li class="active">"Install" button disabled after verifying directory</li></ol><p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=268016">"Install" button disabled after verifying directory</a></p><br><div class="post"><p class="post-meta"><span class="post-author text-primary">Azaitchik</span><br><span class="post-time small text-muted">19th March 2007 00:55 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>"Install" button disabled after verifying directory</strong><br>I am an NSIS newbie and am stuck. All help appreciated. My NSI file has just a few additions to an example that came with the NSIS distribution, but the "Install" button is now greyed out after I select the target directory.<br>The entire code of the NSI file is appended below-- quite short. I want the user to select the drive which happens to be assigned to the iPod, I want to verify that this drive is the right one, and I want to set the $INSTDIR (or $OUTDIR) to the "\Notes" folder on that drive. Is there something elementary I am screwing up? I have indeed read the manual and searched this forum, but to no avail. Thanks for any help. BTW, if I hard code the path (e.g.<br>SetOutPath "F:\Notes\"<br>it works just fine.<br>Alan Zaitchik<br>+========================================+<br><br>; The name of the installer<br>Name "az1"<br>; The file to write<br>OutFile "az1.exe"<br>; Select and verify installation directory<br>DirText 'Be sure that your iPod is connected to your computer and appears as an external drive.' 'If you are not sure which drive is your iPod,\r\ncheck to see which drive has the file "._iPod_Control" and a "Notes" folder on it.' 'Browse' 'Select the drive letter for your iPod. The installation will not continue unless a valid drive is selected.'<br>InstallDir ""<br>InstallButtonText "Continue"<br>Var /GLOBAL ipod_drive<br>Var /GLOBAL notes_dir<br><br>Function .onVerifyInstDir<br>IfFileExists $INSTDIR\._iPod_Control PathGood<br>Abort<br>PathGood:<br>StrCpy $ipod_drive $INSTDIR<br>StrCpy $notes_dir "\Notes\"<br>StrCpy $INSTDIR $ipod_drive$notes_dir<br>FunctionEnd<br>;--------------------------------<br>; Pages<br>Page directory<br>Page instfiles<br>;--------------------------------<br>; The stuff to install<br>Section "" ;No components page, name is not important<br>SetOutPath $INSTDIR<br>File az1.nsi ;for testing<br>SectionEnd ; end the section</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Red Wine</span><br><span class="post-time small text-muted">19th March 2007 01:19 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">See NSIS manual about AllowRootDirInstall,<br><br><a href="http://nsis.sourceforge.net/Docs/Chapter4.html#4.8.1.2" target="_blank">http://nsis.sourceforge.net/Docs/Chapter4.html#4.8.1.2</a><br><br>Provided that ._iPod_Control is a valid file name, this should work,<br></p><pre>
<code>!define NOTES_DIR "Notes"<br>InstallDir ""<br>InstallButtonText "Continue"<br>AllowRootDirInstall true<br><br>Function .onVerifyInstDir<br>IfFileExists $INSTDIR\._iPod_Control PathGood<br>MessagrBox MB_OK|MB_ICONSTOP "Bad path"<br>Abort<br>PathGood:<br>;StrCpy $ipod_drive $INSTDIR<br>;StrCpy $notes_dir "\Notes\"<br>StrCpy $INSTDIR "$INSTDIR\${NOTES_DIR}"<br>FunctionEnd<br>;--------------------------------<br>; Pages<br>Page directory<br>Page instfiles<br>;--------------------------------<br>; The stuff to install<br>Section "" ;No components page, name is not important<br>SetOutPath "$INSTDIR"<br>File az1.nsi ;for testing<br>SectionEnd ; end the section</code>
</pre><br>
      <br>
      PS Of course you can make a bit more pro looking. e.g. you may use ${GetDrives} <a href="http://nsis.sourceforge.net/Docs/AppendixE.html#E.1.5" target="_blank">http://nsis.sourceforge.net/Docs/AppendixE.html#E.1.5</a> in function .onInit to find the drive with the file ._iPod_Control and add it in $INSTDIR
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Azaitchik</span><br>
      <span class="post-time small text-muted">19th March 2007 03:35 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>Thank you very much!</strong><br>
      Dear Red Wine,<br>
      I was able to get it working based on your help. In the end I changed some of the specific testing to make sure it is the iPod in the selected drive, but you got me over the hump! Thanks so much.<br>
      Alan</p>
    </div>
    <hr>

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]></script></body></html>