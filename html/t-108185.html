<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="Closing a DOS box problem" />

  <title>Closing a DOS box problem - NSIS Forums</title><!-- Bootstrap core CSS -->
  <link rel="stylesheet" type="text/css" href="//netdna.bootstrapcdn.com/bootswatch/3.0.1/readable/bootstrap.min.css" />
  <link rel="stylesheet" href="../css/style.css" type="text/css" /><!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!--[if lt IE 9]>
                <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
                <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->
</head>

<body>
  <div class="container">
    <!-- Put navigation bar here -->

    <ol class="breadcrumb">
      <li><a href="../index.html" class="glyphicon glyphicon-home"></a></li>

      <li><a href="f-65.html">NSIS Discussion</a></li>

      <li class="active">Closing a DOS box problem</li>
    </ol>

    <p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=108185">Closing a DOS box problem</a></p><br />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Sailo</span><br />
      <span class="post-time small text-muted">3rd October 2002 14:42 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>Closing a DOS box problem</strong><br />
      Hi,<br />
      <br />
      I'm struggling to close a DOS box after running a batch file. What am i missing?<br />
      <br />
      Name "DOS Window Test"<br />
      OutFile "FindWindow.exe"<br />
      <br />
      !define WM_CLOSE 0x10<br />
      <br />
      Section<br />
      File 'test.bat'<br />
      <br />
      Exec 'test.bat'<br />
      <br />
      findloop:<br />
      Sleep 500<br />
      FindWindow $0 "test"<br />
      StrCmp $0 0 findloop<br />
      <br />
      MessageBox MB_OK "Click OK to close DOS Window"<br />
      <br />
      SendMessage $0 ${WM_CLOSE} 0 0<br />
      <br />
      SectionEnd<br />
      ;eof<br />
      <br />
      It just seems to get stuck in a loop.<br />
      <br />
      Test.bat just contains an echo statement.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
      <span class="post-time small text-muted">3rd October 2002 14:50 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Are you sure the window name is "test"? Have you tried nsExec? It will show the output in the NSIS log, or no output at all if that's what you want.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Sailo</span><br />
      <span class="post-time small text-muted">3rd October 2002 15:10 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">The blue bar at the top of the window reads 'Finished - test' and if i right click on it and select properties it has test in the title box.<br />
      <br />
      I'm using nsis 1.99 so don't have option of nsExec. Any other ideas? How do you use shellExec? Will that help?</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
      <span class="post-time small text-muted">3rd October 2002 15:23 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Download nsExec.dll alone from the CVS and use it.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Sailo</span><br />
      <span class="post-time small text-muted">3rd October 2002 15:56 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">How can i display a list of window titles of windows that are currently open?</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
      <span class="post-time small text-muted">3rd October 2002 16:03 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">You can't with NSIS. You will have to create an extension DLL to do this with EnumWindows.<br />
      <br />
      Why won't you use nsExec? It is so much easier and simpler.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Sailo</span><br />
      <span class="post-time small text-muted">3rd October 2002 16:46 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">I am just trying to make sure my window title is correct.<br />
      <br />
      I can't get nsExec to work. Where is the log that it rights. I can't find any info on it.<br />
      <br />
      If you just open a command prompt what is the window title? This is all i'm trying to find out.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
      <span class="post-time small text-muted">3rd October 2002 16:57 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">nsExec logs into the NSIS log, installation details. Logging will not work with NSIS 1.x because the logging method has changed since 2.0a2/3, I am sorry I mislead you. You can still use simple Exec with no output.<br />
      <br />
      I think the window title should be the name of the batch file at the begining but after it finishes it depends on language of the system (Finished in different languages). You can't trust the NSIS process to be fast enough when trying to find the window before the title changes, it could be problematic.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Sailo</span><br />
      <span class="post-time small text-muted">3rd October 2002 17:06 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">I have found that if you run a batch file and the very last command in the file is CLS windows automatically shuts the screen for you. So instead i created a temporary batch file, put my command with all its variables into it with a CLS on the end then used execwait to run it then deleted it.<br />
      <br />
      This works fine for me but thanks for your help.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">david33470</span><br />
      <span class="post-time small text-muted">7th October 2002 13:13 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>I Have a similar Problem</strong><br />
      During the installation, I compile the uninstal script (that it permit me to give some parameter from the install script to the uninstall one) using the following comand:<br />
      <br />
      ExecWait '"$NSISDIR\makensis.exe" /CD /PAUSE /Duninstalrekey="My parameter" Uninstallscript.nsi'<br />
      but the problem is that the dos windows doesn't close automaticaly!!!<br />
      what can I do for the windows closing automaticaly???<br />
      <br />
      Tank you, in advance, for your help!!!</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Joost Verburg</span><br />
      <span class="post-time small text-muted">7th October 2002 15:33 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>Re: I Have a similar Problem</strong><br />
      Use nsExec</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">david33470</span><br />
      <span class="post-time small text-muted">7th October 2002 21:09 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>???</strong><br />
      OK but I dont find nsexec in the documentation.<br />
      how can I use this command?</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Netsabes</span><br />
      <span class="post-time small text-muted">7th October 2002 21:38 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">It's a plugin. There should be a readme in Contrib/nsExec/ explaining it's functions.<br />
      Also, if you are using the current cvs version, plugins are not called like in NSIS 1.x/2.0alpha. You need to use something like plugin::func.<br />
      <br />
      For nsExec, it's nsExec::Exec [/TIMEOUT=x] path and nsExec::ExecToLog [/TIMEOUT=x] path</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Joost Verburg</span><br />
      <span class="post-time small text-muted">8th October 2002 09:31 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">The old way still works, but this is a easier of course.</p>
    </div>
    <hr />

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]>
  </script>
</body>
</html>
