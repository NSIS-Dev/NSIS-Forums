<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="description" content="Driver installation"><title>Driver installation - NSIS Forums</title><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script><link rel="preload" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css" as="style" onload="this.rel='stylesheet'"><link rel="preload" href="../css/style.css" as="style" onload="this.rel='stylesheet'"><noscript><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css"><link rel="stylesheet" href="../css/style.css"></noscript><script>!function(a){"use strict";var b=function(b,c,d){function e(a){return h.body?a():void setTimeout(function(){e(a)})}function f(){i.addEventListener&&i.removeEventListener("load",f),i.media=d||"all"}var g,h=a.document,i=h.createElement("link");if(c)g=c;else{var j=(h.body||h.getElementsByTagName("head")[0]).childNodes;g=j[j.length-1]}var k=h.styleSheets;i.rel="stylesheet",i.href=b,i.media="only x",e(function(){g.parentNode.insertBefore(i,c?g:g.nextSibling)});var l=function(a){for(var b=i.href,c=k.length;c--;)if(k[c].href===b)return a();setTimeout(function(){l(a)})};return i.addEventListener&&i.addEventListener("load",f),i.onloadcssdefined=l,l(f),i};"undefined"!=typeof exports?exports.loadCSS=b:a.loadCSS=b}("undefined"!=typeof global?global:this);!function(a){if(a.loadCSS){var b=loadCSS.relpreload={};if(b.support=function(){try{return a.document.createElement("link").relList.supports("preload")}catch(b){return!1}},b.poly=function(){for(var b=a.document.getElementsByTagName("link"),c=0;c<b.length;c++){var d=b[c];"preload"===d.rel&&"style"===d.getAttribute("as")&&(a.loadCSS(d.href,d,d.getAttribute("media")),d.rel=null)}},!b.support()){b.poly();var c=a.setInterval(b.poly,300);a.addEventListener&&a.addEventListener("load",function(){b.poly(),a.clearInterval(c)}),a.attachEvent&&a.attachEvent("onload",function(){a.clearInterval(c)})}}}(this);</script></head><body><div class="container"><ol class="breadcrumb"><li><a href="../index.html" class="glyphicon glyphicon-home"></a></li><li><a href="f-65.html">NSIS Discussion</a></li><li class="active">Driver installation</li></ol><p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=273554">Driver installation</a></p><br><div class="post"><p class="post-meta"><span class="post-author text-primary">anttip</span><br><span class="post-time small text-muted">28th June 2007 13:21 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>Driver installation</strong><br>Hi,<br>I need to install a virtual network adapter. I checked the <a href="http://nsis.sourceforge.net/Driver_installation_and_update" target="_blank">existing example</a> that uses <i>newdev::UpdateDriverForPlugAndPlayDevices</i> and <i>setupapi::SetupCopyOEMInf</i>, but I don't know if these can be used for this case.<br><br>The driver consists of .inf and .sys files. I tried to point the example driver installation script to the .inf file and set the HardwareId to dni_dnemp, which is what regedit shows as hardware id (in <i>HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Enum\Root\DNI_DNEMP</i>) if I manually install the driver. The test failed with error codes (XP:0,2) and #2 (XP).<br><br>I haven't done anything with drivers before, so I might be on completely wrong tracks here, but for me the <i>newdev::InstallSelectedDriver</i> sounded like a better match. Too bad I've got no idea how I could try it out. It is described for example at <a href="http://msdn2.microsoft.com/en-us/library//aa906293.aspx" target="_blank">http://msdn2.microsoft.com/en-us/library//aa906293.aspx</a> .<br><br>Any ideas?</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">anttip</span><br><span class="post-time small text-muted">28th June 2007 15:10 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">I tried InstDrv plugin. Got an error E0000203 (which other people have encountered too, no solution seems to be available). Additionally, now I have an unknown device that can't be uninstalled :)<br><br>Found some comments about DPInst, and tried to check that out, but the Microsoft pages aren't too informative. Seems that it's a part of WDK driver kit, but found only download links to some Vista beta versions of that. Additionally, it sounds like it's some kit for VisualStudio, which is not what I'm after.</p></div><hr><div class="footer"><p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p></div></div><script src="../js/highlight.pack.js" type="text/javascript"></script><script type="text/javascript">//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]></script></body></html>