<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="description" content="NSIS Issue on Chinese windows XP / 7"><title>NSIS Issue on Chinese windows XP / 7 - NSIS Forums</title><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script><link rel="preload" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css" as="style" onload="this.rel='stylesheet'"><link rel="preload" href="../css/style.css" as="style" onload="this.rel='stylesheet'"><noscript><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css"><link rel="stylesheet" href="../css/style.css"></noscript><script>!function(a){"use strict";var b=function(b,c,d){function e(a){return h.body?a():void setTimeout(function(){e(a)})}function f(){i.addEventListener&&i.removeEventListener("load",f),i.media=d||"all"}var g,h=a.document,i=h.createElement("link");if(c)g=c;else{var j=(h.body||h.getElementsByTagName("head")[0]).childNodes;g=j[j.length-1]}var k=h.styleSheets;i.rel="stylesheet",i.href=b,i.media="only x",e(function(){g.parentNode.insertBefore(i,c?g:g.nextSibling)});var l=function(a){for(var b=i.href,c=k.length;c--;)if(k[c].href===b)return a();setTimeout(function(){l(a)})};return i.addEventListener&&i.addEventListener("load",f),i.onloadcssdefined=l,l(f),i};"undefined"!=typeof exports?exports.loadCSS=b:a.loadCSS=b}("undefined"!=typeof global?global:this);!function(a){if(a.loadCSS){var b=loadCSS.relpreload={};if(b.support=function(){try{return a.document.createElement("link").relList.supports("preload")}catch(b){return!1}},b.poly=function(){for(var b=a.document.getElementsByTagName("link"),c=0;c<b.length;c++){var d=b[c];"preload"===d.rel&&"style"===d.getAttribute("as")&&(a.loadCSS(d.href,d,d.getAttribute("media")),d.rel=null)}},!b.support()){b.poly();var c=a.setInterval(b.poly,300);a.addEventListener&&a.addEventListener("load",function(){b.poly(),a.clearInterval(c)}),a.attachEvent&&a.attachEvent("onload",function(){a.clearInterval(c)})}}}(this);</script></head><body><div class="container"><ol class="breadcrumb"><li><a href="../index.html" class="glyphicon glyphicon-home"></a></li><li><a href="f-65.html">NSIS Discussion</a></li><li class="active">NSIS Issue on Chinese windows XP / 7</li></ol><p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=330457">NSIS Issue on Chinese windows XP / 7</a></p><br><div class="post"><p class="post-meta"><span class="post-author text-primary">ranajyotic</span><br><span class="post-time small text-muted">9th May 2011 12:32 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>NSIS Issue on Chinese windows XP / 7</strong><br>I have a simple silent installer script which installs a printer driver and then run a EXE. It works perfectly in English OS, but in both the Chinese Traditional and Simplified it will fail to find the folder where the files have been extracted, which is the user Temp folder.<br>Here is the script. Please let me know what solution is available.<br><br></p><pre>
<code># General Symbol Definitions<br>!define REGKEY "SOFTWARE\$(^Name)"<br><br># Included files<br>!include Sections.nsh<br>!include "FileFunc.nsh"<br>!include LogicLib.nsh<br><br><br>#!insertmacro GetParameters<br><br># Installer pages<br>Page instfiles<br><br># Installer attributes<br>OutFile DriverX86.exe<br>CRCCheck on<br>XPStyle on<br>Icon "logo.ico"<br>SilentInstall silent<br>Var DEVICE_NAME<br># Installer sections<br>Section -Main SEC0000<br>    StrCpy $DEVICE_NAME "XXXX Device"    <br>    SetOutPath $TEMP\UPD<br>    SetOverwrite on<br>    File /a /r Print\Win_2KXP\*    <br>    ExecWait "rundll32 printui.dll PrintUIEntry /if /b $\"$DEVICE_NAME$\" /f $TEMP\UPD\somefile.inf /m $\"XXXX Device$\" /r $\"LPT1:$\""<br>    Delete $TEMP\UPD\Win_2KXP\English\i386\*<br>    Delete $TEMP\UPD\Win_2KXP\English\*<br>    Delete $TEMP\UPD\Win_2KXP\i386\*<br>    Delete $TEMP\UPD\Win_2KXP\*<br>    RMDir /r $TEMP\UPD\i386<br>    RMDir /r $TEMP\UPD\English\i386<br>    RMDir /r $TEMP\UPD\English<br>    RMDir /r $TEMP\UPD<br>    SetOutPath $TEMP\BPTracker<br>    SetOverwrite on<br>    File /a /r WIN-DS3IVPKX4GX_Install\*<br>    ExecWait "$TEMP\BPTracker\WIN-DS3IVPKX4GX_Install.exe /s"<br>    Delete $TEMP\BPTracker\WIN-DS3IVPKX4GX_Install.exe<br>    RMDir $TEMP\BPTracker<br>SectionEnd<br><br># Installer functions<br>Function .onInit<br>    InitPluginsDir<br>FunctionEnd</code>
</pre><br>
      <br>
      The problem seems to be in the $TEMP variable. When the installer is executed the system is unable to find the Driver files which is located in $TEMP\UPD
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Anders</span><br>
      <span class="post-time small text-muted">9th May 2011 13:17 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">You are missing some quotes, try ExecWait "rundll32 printui.dll PrintUIEntry /if /b $\"$DEVICE_NAME$\" /f $\"$TEMP\UPD\somefile.inf$\" /m $\"XXXX Device$\" /r $\"LPT1:$\""<br>
      <br>
      and ExecWait '"$TEMP\BPTracker\WIN-DS3IVPKX4GX_Install.exe" /s'</p>
    </div>
    <hr>

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]></script></body></html>