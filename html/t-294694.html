<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="Install for current user or all?" />

  <title>Install for current user or all? - NSIS Forums</title>
  <script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script>
  <!-- Bootstrap core CSS -->

  <link rel="stylesheet" type="text/css" href="//netdna.bootstrapcdn.com/bootswatch/3.0.1/readable/bootstrap.min.css" />
  <link rel="stylesheet" href="../css/style.css" type="text/css" /><!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!--[if lt IE 9]>
                <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
                <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->
</head>

<body>
  <div class="container">
    <!-- Put navigation bar here -->

    <ol class="breadcrumb">
      <li><a href="../index.html" class="glyphicon glyphicon-home"></a></li>

      <li><a href="f-65.html">NSIS Discussion</a></li>

      <li class="active">Install for current user or all?</li>
    </ol>

    <p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=294694">Install for current user or all?</a></p><br />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">bhaveshbp</span><br />
      <span class="post-time small text-muted">17th July 2008 19:34 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>Install for current user or all?</strong><br />
      What would you have to do to install an application for just one user? For all users? Does it have to do with registry keys?</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">LoRd_MuldeR</span><br />
      <span class="post-time small text-muted">17th July 2008 19:49 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">On Windows computers there usually is only one directory to install programs, which is used by *all* users. That is "C:\Program Files" aka $PROGRAMS. You might need admin rights to install a program there though. The Registry has one root key to store system-wide settings (read access for all users, write access for admin only) and one root key to store the user's personal settings (full access for all users). Those are HKEY_LOCAL_MACHINE and HKEY_CURRENT_USER. The Startmenu has folders for all users and for single users. That is: "C:\Documents and Settings\All Users\Start Menu\Programs" and "C:\Documents and Settings\John Doe\Start Menu\Programs". Both accessible via $SMPROGRAMS, depending on ShellVarContext.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">KrisAster</span><br />
      <span class="post-time small text-muted">17th July 2008 20:00 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Take a look at the documentation for SetShellVarContext. It was written for the issues that you're talking about. By setting the context you can decide whether your program makes shortcuts for a single user or for the machine.<br />
      <br />
      Obviously, files that are copied to your machine during setup are visible to all users unless privileges are applied to a directory, but you can determine who the preferences are set up for. And, if you install keys to your HKCU portion of the registry, you can make it very difficult for another person who hasn't run the installation to use your program if that's what you're looking to do.</p>
    </div>
    <hr />

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]>
  </script>
</body>
</html>
