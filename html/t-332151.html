<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="description" content="A message box after PAGE_INSTFILES completed"><title>A message box after PAGE_INSTFILES completed - NSIS Forums</title><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script><link rel="preload" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css" as="style" onload="this.rel='stylesheet'"><link rel="preload" href="../css/style.css" as="style" onload="this.rel='stylesheet'"><noscript><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css"><link rel="stylesheet" href="../css/style.css"></noscript><script>!function(a){"use strict";var b=function(b,c,d){function e(a){return h.body?a():void setTimeout(function(){e(a)})}function f(){i.addEventListener&&i.removeEventListener("load",f),i.media=d||"all"}var g,h=a.document,i=h.createElement("link");if(c)g=c;else{var j=(h.body||h.getElementsByTagName("head")[0]).childNodes;g=j[j.length-1]}var k=h.styleSheets;i.rel="stylesheet",i.href=b,i.media="only x",e(function(){g.parentNode.insertBefore(i,c?g:g.nextSibling)});var l=function(a){for(var b=i.href,c=k.length;c--;)if(k[c].href===b)return a();setTimeout(function(){l(a)})};return i.addEventListener&&i.addEventListener("load",f),i.onloadcssdefined=l,l(f),i};"undefined"!=typeof exports?exports.loadCSS=b:a.loadCSS=b}("undefined"!=typeof global?global:this);!function(a){if(a.loadCSS){var b=loadCSS.relpreload={};if(b.support=function(){try{return a.document.createElement("link").relList.supports("preload")}catch(b){return!1}},b.poly=function(){for(var b=a.document.getElementsByTagName("link"),c=0;c<b.length;c++){var d=b[c];"preload"===d.rel&&"style"===d.getAttribute("as")&&(a.loadCSS(d.href,d,d.getAttribute("media")),d.rel=null)}},!b.support()){b.poly();var c=a.setInterval(b.poly,300);a.addEventListener&&a.addEventListener("load",function(){b.poly(),a.clearInterval(c)}),a.attachEvent&&a.attachEvent("onload",function(){a.clearInterval(c)})}}}(this);</script></head><body><div class="container"><ol class="breadcrumb"><li><a href="../index.html" class="glyphicon glyphicon-home"></a></li><li><a href="f-65.html">NSIS Discussion</a></li><li class="active">A message box after PAGE_INSTFILES completed</li></ol><p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=332151">A message box after PAGE_INSTFILES completed</a></p><br><div class="post"><p class="post-meta"><span class="post-author text-primary">yoachan</span><br><span class="post-time small text-muted">4th July 2011 12:48 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>A message box after PAGE_INSTFILES completed</strong><br>Dear all,<br><br>please bear with me for it's only approx a week since I know NSIS.<br>I've made my first NSIS installer, but something still bother me.<br><br>I stated this two lines:<br></p><pre>
<code><br>!define MUI_FINISHPAGE_NOAUTOCLOSE<br>!define MUI_UNFINISHPAGE_NOAUTOCLOSE<br></code>
</pre><br>
      <br>
      that will cause user to be able to see log after install/uninstall completed.<br>
      <br>
      But I'm afraid some inexperienced user of mine didn't notice that the "next" button becomes available when the installation/uninstall completed. So they will wait until something happens. So I want to make a message box to appear just right after the last install/uninstall section completed to tell them that, hey, the installation/uninstall process is completed. You can either see the log detail or just click next to proceed to "finish window".<br>
      <br>
      I tried to use an empty section that will only display messagebox, but what happens is that it's often that the messagebox appears even though the progress bar still at around 80%...<br>
      <br>
      onInstSuccess Function won't work either for it will only be executed when everything is done instead of the "real installation/uninstall progress".<br>
      <br>
      is there any way so that a message box will appear when and only when the install/uninstall progress is completed and the progress bar reach 100%.<br>
      <br>
      thanks in advanced.<br>
      <br>
      Regards,<br>
      <br>
      Yoachan
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br>
      <span class="post-time small text-muted">4th July 2011 15:04 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Add a hidden Section at the end (no name).<br>
      <br>
      Stu</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">yoachan</span><br>
      <span class="post-time small text-muted">5th July 2011 04:35 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">@Afrow: Thanks for your reply....<br>
      <br></p>

      <blockquote>
        <small>Originally posted by Afrow UK</small><br>
        Add a hidden Section at the end (no name).<br>
        <br>
        Stu
      </blockquote>I've tried this approach as I said earlier... and this what occurs to me....<br>

      <blockquote>
        I tried to use an empty section that will only display messagebox, but what happens is that it's often that the messagebox appears even though the progress bar still at around 80%...
      </blockquote>what I mean with empty section is a section with no name. sorry for the disambiguation....
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">MSG</span><br>
      <span class="post-time small text-muted">5th July 2011 06:20 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">The installation progress bar shows what percentage of script the installer has finished executing. So once your sections will contain all the code required for your installation, the progress will be 99% or 100% by the time it reaches the messagebox.<br>
      <br>
      Of course another option is to just do DetailPrint "Installation completed successfully." &gt;_&gt;</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">yoachan</span><br>
      <span class="post-time small text-muted">5th July 2011 07:07 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">@MSG: Thanks for your reply :)<br>
      <br></p>

      <blockquote>
        <small>Originally posted by MSG</small><br>
        The installation progress bar shows what percentage of script the installer has finished executing. So once your sections will contain all the code required for your installation, the progress will be 99% or 100% by the time it reaches the messagebox.<br>
        <br>
        Of course another option is to just do DetailPrint "Installation completed successfully." &gt;_&gt;
      </blockquote>Yes... that make sense.........<br>
      <br>
      so is it mean that I don't have any chance to put my message box there...? :(
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">MSG</span><br>
      <span class="post-time small text-muted">5th July 2011 07:28 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Well you can add the Nop command a hundred times... Or just use the RealProgress plugin.</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">pengyou</span><br>
      <span class="post-time small text-muted">5th July 2011 11:05 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">You can use MUI_INSTFILESPAGE_FINISHHEADER_TEXT and MUI_INSTFILESPAGE_FINISHHEADER_SUBTEXT to define the text shown in the header of the installation page <b><u>when the installation has been completed</u></b>. See the "Installation page settings" section in the MUI manual for more information.<br>
      <br>
      Another way to show some text when the installation completes is to use "SetDetailsPrint textonly" and "DetailPrint" to display a message just above the progress bar on the installation page. If you create a final section containing only these commands then the message will appear when installation is complete.</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">yoachan</span><br>
      <span class="post-time small text-muted">6th July 2011 05:43 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Thanks for you replies :)<br>
      <br></p>

      <blockquote>
        <small>Originally posted by MSG</small><br>
        Well you can add the Nop command a hundred times... Or just use the RealProgress plugin.
      </blockquote>@MSG: RealProgress plugin seems to be a good solution. But when I look into it, I noted this warning:<br>
      <pre>
<code>Warning: This file type may contain malicious code. <br>By executing it, your system may be compromised.</code>
</pre><br>
      <br>
      So I'm holding back.... is it really safe to use it?<br>
      <br>

      <blockquote>
        <small>Originally posted by pengyou</small><br>
        You can use MUI_INSTFILESPAGE_FINISHHEADER_TEXT and MUI_INSTFILESPAGE_FINISHHEADER_SUBTEXT to define the text shown in the header of the installation page <b><u>when the installation has been completed</u></b>. See the "Installation page settings" section in the MUI manual for more information.<br>
        <br>
        Another way to show some text when the installation completes is to use "SetDetailsPrint textonly" and "DetailPrint" to display a message just above the progress bar on the installation page. If you create a final section containing only these commands then the message will appear when installation is complete.
      </blockquote>@pengyou: thank you, I'll look into it.<br>
      <br>
      <br>
      My current solution is removing<br>
      <pre>
<code><br>!define MUI_FINISHPAGE_NOAUTOCLOSE<br>!define MUI_UNFINISHPAGE_NOAUTOCLOSE<br></code>
</pre><br>
      <br>
      and add the following:<br>
      <pre>
<code><br>LogSet ON<br></code>
</pre><br>
      <br>
      so when installation complete, they will be directed to "finish_page". And if they need to see installation log, they can see it in install.log file. In most cases I think user won't need to see it. I just think that it will be needed in case installation failed and we need to know why and where it stops...<br>
      <br>
      regards,<br>
      <br>
      Yoachan
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">MSG</span><br>
      <span class="post-time small text-muted">6th July 2011 06:44 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"></p>

      <blockquote>
        <small>Originally posted by yoachan</small><br>
        Thanks for you replies :)<br>
        <br>
        @MSG: RealProgress plugin seems to be a good solution. But when I look into it, I noted this warning:<br>
        <pre>
<code>Warning: This file type may contain malicious code. <br>By executing it, your system may be compromised.</code>
</pre><br>
        <br>
        So I'm holding back.... is it really safe to use it?
      </blockquote>All attachments on the wiki have this warning, because anyone can edit a wiki (that's the whole point of a wiki). Just make sure the file is from the actual creator (check the wiki page history). Anyway, here's the forum thread: <a href="http://forums.winamp.com/showthread.php?s=&amp;threadid=235740" target="_blank">http://forums.winamp.com/showthread....hreadid=235740</a>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">yoachan</span><br>
      <span class="post-time small text-muted">6th July 2011 16:16 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">@MSG: again, thanks for your replies :)<br>
      <br></p>

      <blockquote>
        <small>Originally posted by MSG</small><br>
        All attachments on the wiki have this warning, because anyone can edit a wiki (that's the whole point of a wiki). Just make sure the file is from the actual creator (check the wiki page history). Anyway, here's the forum thread: <a href="http://forums.winamp.com/showthread.php?s=&amp;threadid=235740" target="_blank">http://forums.winamp.com/showthread....hreadid=235740</a>
      </blockquote>Well, if that's the case. I'll give it a shot. And it's more likely case is closed for now. :)<br>
      Thank you, and I thank everyone that already replied in my thread. :)<br>
      <br>
      regards,<br>
      <br>
      Yoachan
    </div>
    <hr>

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]></script></body></html>