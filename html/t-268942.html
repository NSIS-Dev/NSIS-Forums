<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="Building an SQL Interface" />

  <title>Building an SQL Interface - NSIS Forums</title><!-- Bootstrap core CSS -->
  <link rel="stylesheet" type="text/css" href="//netdna.bootstrapcdn.com/bootswatch/3.0.1/readable/bootstrap.min.css" />
  <link rel="stylesheet" href="../css/style.css" type="text/css" /><!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!--[if lt IE 9]>
                <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
                <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->
</head>

<body>
  <div class="container">
    <!-- Put navigation bar here -->

    <ol class="breadcrumb">
      <li><a href="../index.html" class="glyphicon glyphicon-home"></a></li>

      <li><a href="f-65.html">NSIS Discussion</a></li>

      <li class="active">Building an SQL Interface</li>
    </ol>

    <p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=268942">Building an SQL Interface</a></p><br />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">GarBear</span><br />
      <span class="post-time small text-muted">4th April 2007 19:18 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>Building an SQL Interface</strong><br />
      <b>Hi all;</b><br />
      <br />
      I want to find and check databases for things and provide greater customizability for my customers. I have been building a new SQL Server 2005 Interface because there really aren't any out there, not in the open source, freeware, or closed source/install market (Install Shield, Wise etc...).<br />
      <br />
      That is,not with the kind of flexibility and customizability we can achieve with a powerful scripting language like NSIS.<br />
      <br />
      Mind you, I am not a great programmer, but I can do a few things. I will eventually convert all my scripts over and compile them in VB (If anyone wants to help with that feel free) as a dynamic link library (.DLL) file.<br />
      <br />
      I thought I would start a new topic and share my code as I go along, gleaning suggestions as we go. I have found to get the larger window size I need I have to use Experience or Ultra UIâ€™s. (My Choice is ExperienceUI)<br />
      <br />
      NSIS Install Code Begin:<br />
      #Defines<br />
      !define APPNAME "DBConnetion"<br />
      !define APPNAMEANDVERSION "DBConnetion 1.0"<br />
      !define dbini "DBList.ini"<br />
      !define sqlini "SQLList.ini"<br />
      !define XP_STYLE "ON"<br />
      #Varriables<br />
      #Note: Bug causes Global use all the time right now.<br />
      Var /Global Count<br />
      Var /Global SQLUserName<br />
      Var /Global SQLPassword<br />
      Var /Global DBServer<br />
      Var /Global Database<br />
      Var /Global DBConnectionType<br />
      #Custom Install Options<br />
      BrandingText "Example DB Connect"<br />
      Name "${APPNAMEANDVERSION}"<br />
      InstallDir "$PROGRAMFILES\DBConnetion"<br />
      ;InstallDirRegKey HKLM "Software\${APPNAME}" ""<br />
      OutFile "DBConnectionExample.exe"<br />
      #Includes<br />
      !include "XPUI.nsh"<br />
      !include "logiclib.nsh"<br />
      !include "WinMessages.nsh"<br />
      !include "TextFunc.nsh"<br />
      !include "WordFunc.nsh"<br />
      !insertmacro "WordFind"<br />
      !define MUI_ABORTWARNING<br />
      !insertmacro MUI_PAGE_WELCOME<br />
      #Custom Page that does everything<br />
      Page custom "DBConnectionPage" "validate"<br />
      !insertmacro MUI_LANGUAGE "English"<br />
      <br />
      Function .onInit<br />
      !insertmacro MUI_INSTALLOPTIONS_EXTRACT "DBConnectObject.ini"<br />
      Call CreateSQLSVRVBS<br />
      Call CreateDBVBS<br />
      nsExec::Exec /TIMEOUT=20000 '"$SYSDIR\CScript.exe" "$PLUGINSDIR\SQLServers.vbs" "$PLUGINSDIR\${sqlini}"'<br />
      Call PopulateDBConnectObject<br />
      FunctionEnd<br />
      <br />
      # Macro to handle screen manipulation<br />
      !macro SNDMESSAGE lg cmd lparm rparm<br />
      #usage: SNDMESSAGE DialogueItem MessageType leftparameter rightparameter<br />
      SendMessage ${lg} ${cmd} ${lparm} ${rparm}<br />
      !macroend<br />
      <br />
      <br />
      # Macro to handle getting combobox info from ini and putting it into dropdown<br />
      !macro GETINI fileName sectionName valueName strDelimiter dlgNumber dlgIniFile dlgFieldname dlgValue<br />
      StrCpy $Count ""<br />
      # Expects ini file format to match NSIS default line delimiter "|" then line i.e. "line|line"<br />
      ReadINIStr $9 ${fileName} ${sectionName} ${valueName}<br />
      ${WordFind} $9 ${strDelimiter} "*" $R9<br />
      ${If} $R9 &gt;= 1<br />
      # Clear current values<br />
      !insertmacro SNDMESSAGE ${dlgNumber} ${CB_RESETCONTENT} 0 0<br />
      WriteINIStr ${dlgIniFile} ${dlgFieldname} ${dlgValue}<br />
      ${Do}<br />
      # Find out how many times to loop<br />
      ${WordFind} $9 ${strDelimiter} "*" $R9<br />
      StrCpy $Count $R9<br />
      ${WordFind} $9 "${strDelimiter}" "-1(" $8<br />
      ${WordFind} $9 "${strDelimiter}" "-1{" $9<br />
      # Update the Dialogue with the next item in Messagebox<br />
      !insertmacro SNDMESSAGE ${dlgNumber} ${CB_INSERTSTRING} 0 'STR:$8'<br />
      IntOp $Count $Count - 1<br />
      ${LoopUntil} $Count = 0<br />
      # Set first text item<br />
      !insertmacro SNDMESSAGE ${dlgNumber} ${WM_SETTEXT} 1 'STR:$8'<br />
      # Enable dropdown<br />
      !insertmacro SNDMESSAGE ${dlgNumber} ${WM_ENABLE} 1 1<br />
      # Show the new values<br />
      !insertmacro SNDMESSAGE ${dlgNumber} ${CB_SHOWDROPDOWN} 1 1<br />
      ${EndIf}<br />
      StrCpy $Count ""<br />
      !macroend<br />
      <br />
      Function validate<br />
      # To Do: Needs a check for cancel button the skips all code and exits<br />
      ReadINIStr $R0 "$PLUGINSDIR\DBConnectObject.ini" "Settings" "State"<br />
      FindWindow $0 '#32770' '' $HWNDPARENT<br />
      ${IF} $R0 == 18<br />
      WriteINIStr "$PLUGINSDIR\DBConnectObject.ini" "Field 13" State "0"<br />
      WriteINIStr "$PLUGINSDIR\DBConnectObject.ini" "Field 18" State "1"<br />
      GetDlgItem $1 $0 1203<br />
      SetCtlColors $1 ${MUI_TEXT_COLOR} ${XPUI_TEXT_LIGHTCOLOR}<br />
      SendMessage $1 ${WM_ENABLE} 0 0<br />
      GetDlgItem $1 $0 1219<br />
      SetCtlColors $1 000000 FFFFFF<br />
      SendMessage $1 ${WM_ENABLE} 0x50810000 1<br />
      GetDlgItem $1 $0 1218<br />
      SetCtlColors $1 000000 FFFFFF<br />
      SendMessage $1 ${WM_ENABLE} 0x50810000 1<br />
      # Show Activate<br />
      SendMessage $1 ${SW_SHOWNOACTIVATE} 0x50810000 1<br />
      # NOTE: Need to figure out why I can't make this work right.<br />
      #SendMessage $1 ${WM_SETFOCUS} '' ''<br />
      Abort<br />
      ${ElseIf} $R0 == 13<br />
      WriteINIStr "$PLUGINSDIR\DBConnectObject.ini" "Field 13" State "1"<br />
      WriteINIStr "$PLUGINSDIR\DBConnectObject.ini" "Field 18" State "0"<br />
      GetDlgItem $1 $0 1220<br />
      SendMessage $1 ${BM_SETSTATE} 0 'STR:NotUsed'<br />
      GetDlgItem $1 $0 1219<br />
      SetCtlColors $1 FFFFFF ${XPUI_TEXT_BGCOLOR}<br />
      SendMessage $1 ${WM_ENABLE} 0x50810000 0<br />
      GetDlgItem $1 $0 1218<br />
      SetCtlColors $1 FFFFFF ${XPUI_TEXT_BGCOLOR}<br />
      SendMessage $1 ${WM_ENABLE} 0x50810000 0<br />
      GetDlgItem $1 $0 1213<br />
      SendMessage $1 ${SW_SHOWNOACTIVATE} 0x50810000 0<br />
      SendMessage $1 ${WM_SETFOCUS} 0x50810000 1<br />
      Abort<br />
      ${ElseIf} $R0 == 21<br />
      GetDlgItem $1 $0 1206<br />
      # To be done: Need vb script to validate SQL user is connected<br />
      # If validated will set Connected Else Connection Failed.<br />
      SendMessage $1 ${WM_SETTEXT} '0' 'STR:Connected'<br />
      SendMessage $1 ${WM_ENABLE} 1 1<br />
      Abort<br />
      ${ElseIf} $R0 == 15<br />
      nsExec::Exec /TIMEOUT=20000 '"$SYSDIR\CScript.exe" "$PLUGINSDIR\SQLServers.vbs" "$PLUGINSDIR\${sqlini}"'<br />
      Sleep 250<br />
      Call PopulateDBConnectObject<br />
      GetDlgItem $1 $0 1213<br />
      !insertmacro GETINI $PLUGINSDIR\${sqlini} "SQLServers" "List" "|" $1 "$PLUGINSDIR\DBConnectObject.ini" "Field 14" "ListItems"<br />
      Abort<br />
      ${ElseIf} $R0 == 17<br />
      #Validate has entered some name<br />
      ReadINIStr $4 "$PLUGINSDIR\DBConnectObject.ini" "Field 14" "State"<br />
      ${If} $4 == ""<br />
      MessageBox MB_OK "You must first choose a SQLServer."<br />
      Abort<br />
      ${Else}<br />
      nsExec::Exec /TIMEOUT=20000 '"$SYSDIR\CScript.exe" "$PLUGINSDIR\FindDB.vbs" $4 "$PLUGINSDIR\${dbini}"'<br />
      GetDlgItem $1 $0 1215<br />
      !insertmacro GETINI $PLUGINSDIR\${dbini} $4 "List" "|" $1 "$PLUGINSDIR\DBConnectObject.ini" "Field 16" "ListItems"<br />
      Abort<br />
      ${EndIf}<br />
      ${ElseIf} $R0 == 22<br />
      # Test connection and report back<br />
      Abort<br />
      ${EndIf}<br />
      ReadINIStr $0 "$PLUGINSDIR\DBConnectObject.ini" "Field 16" "State"<br />
      ReadINIStr $1 "$PLUGINSDIR\DBConnectObject.ini" "Field 14" "State"<br />
      ReadINIStr $3 "$PLUGINSDIR\DBConnectObject.ini" "Field 18" "State" #Radio SQL Auth<br />
      ReadINIStr $4 "$PLUGINSDIR\DBConnectObject.ini" "Field 19" "State"<br />
      ReadINIStr $5 "$PLUGINSDIR\DBConnectObject.ini" "Field 20" "State"<br />
      ${IF} $0 == ""<br />
      MessageBox MB_OK "You must select or type in the name of your database first."<br />
      Abort<br />
      ${ElseIf} $1 == ""<br />
      MessageBox MB_OK "You must select or type in the name of your database Server first."<br />
      Abort<br />
      ${ElseIf} $3 == 1<br />
      ${If} $4 == ""<br />
      MessageBox MB_OK "You have chosen to use SQL Authentication but neglected to provide a username. Please enter a SQL username first."<br />
      Abort<br />
      ${ElseIf} $5 == ""<br />
      MessageBox MB_OK "You have chosen to use SQL Authentication but neglected to provide a password. Please enter a SQL username first."<br />
      Abort<br />
      ${EndIf}<br />
      <br />
      ${EndIf}<br />
      Call SetDBVars<br />
      FunctionEnd<br />
      <br />
      Function SetDBVars<br />
      ReadINIStr $0 "$PLUGINSDIR\DBConnectObject.ini" "Field 18" "State"<br />
      ${If} $0 == 1<br />
      StrCpy $DBConnectionType "SQL"<br />
      ReadINIStr $SQLUserName "$PLUGINSDIR\DBConnectObject.ini" "Field 19" "State"<br />
      ReadINIStr $SQLPassword "$PLUGINSDIR\DBConnectObject.ini" "Field 20" "State"<br />
      ${Else}<br />
      StrCpy $DBConnectionType "NT"<br />
      ${EndIf}<br />
      <br />
      ReadINIStr $DBServer "$PLUGINSDIR\DBConnectObject.ini" "Field 14" "State"<br />
      <br />
      ReadINIStr $Database "$PLUGINSDIR\DBConnectObject.ini" "Field 16" "State"<br />
      <br />
      FunctionEnd<br />
      <br />
      # Not currently in use<br />
      Section -FinishSection<br />
      ;<br />
      ; WriteRegStr HKLM "Software\${APPNAME}" "" "$INSTDIR"<br />
      ; WriteRegStr HKLM "Software\Microsoft\Windows\CurrentVersion\Uninstall\${APPNAME}" "DisplayName" "${APPNAME}"<br />
      ; WriteRegStr HKLM "Software\Microsoft\Windows\CurrentVersion\Uninstall\${APPNAME}" "UninstallString" "$INSTDIR\uninstall.exe"<br />
      ; ;WriteUninstaller "$INSTDIR\uninstall.exe"<br />
      <br />
      SectionEnd<br />
      <br />
      Function DBConnectionPage<br />
      <br />
      !insertmacro MUI_INSTALLOPTIONS_INITDIALOG "DBConnectObject.ini"<br />
      FindWindow $0 '#32770' '' $XPUI_HWND<br />
      Push $R0<br />
      !insertmacro MUI_HEADER_TEXT "${APPNAME}" "${APPNAMEANDVERSION}"<br />
      !insertmacro MUI_INSTALLOPTIONS_DISPLAY "DBConnectObject.ini"<br />
      GetDlgItem $1 $0 1200<br />
      SetCtlColors $1 ${XPUI_TEXT_BGCOLOR} ${XPUI_TEXT_LIGHTCOLOR}<br />
      ShowWindow $1 1<br />
      !insertmacro MUI_INSTALLOPTIONS_SHOW<br />
      Pop $R0<br />
      <br />
      FunctionEnd<br />
      <br />
      Function PopulateDBConnectObject<br />
      ReadINIStr $0 "$PLUGINSDIR\${sqlini}" "SQLServers" "List"<br />
      WriteINIStr "$PLUGINSDIR\DBConnectObject.ini" "Field 14" ListItems $0<br />
      FunctionEnd<br />
      <br />
      # Visual Basic Script that Gets a list of SQL Servers<br />
      Function CreateSQLSVRVBS<br />
      StrCpy $1 "'"<br />
      FileOpen $0 "$PLUGINSDIR\SQLServers.vbs" w<br />
      FileWrite $0 '$1---------------------------------------------------------------------------$\r$\n'<br />
      FileWrite $0 '$1---------------------------------------------------------------------------$\r$\n'<br />
      FileWrite $0 '$1$\r$\n'<br />
      FileWrite $0 '$1 Licensed Materials - Property of MyCompany (TSW)$\r$\n'<br />
      FileWrite $0 '$1 $\r$\n'<br />
      FileWrite $0 '$1 Governed under the terms of the International$\r$\n'<br />
      FileWrite $0 '$1 License Agreement for Non-Warranted Code.$\r$\n'<br />
      FileWrite $0 '$1$\r$\n'<br />
      FileWrite $0 '$1 (C) COPYRIGHT MYCOMPANY Corp. 2006 - 2007$\r$\n'<br />
      FileWrite $0 '$1 All Rights Reserved.$\r$\n'<br />
      FileWrite $0 '$1$\r$\n'<br />
      FileWrite $0 '$1---------------------------------------------------------------------------$\r$\n'<br />
      FileWrite $0 '$1$\r$\n'<br />
      FileWrite $0 '$1 SOURCE FILE NAME: SQLServers.vbs$\r$\n'<br />
      FileWrite $0 '$1$\r$\n'<br />
      FileWrite $0 '$1----------------------------------------------------------------------------$\r$\n'<br />
      FileWrite $0 '$\r$\n'<br />
      FileWrite $0 'Const FOR_WRITING = 2$\r$\n'<br />
      FileWrite $0 'Dim strResults$\r$\n'<br />
      FileWrite $0 'fileOutput = WScript.Arguments(0)$\r$\n'<br />
      FileWrite $0 '$\r$\n'<br />
      FileWrite $0 'CheckSQL()$\r$\n'<br />
      FileWrite $0 '$\r$\n'<br />
      FileWrite $0 'Private Function CheckSQL()$\r$\n'<br />
      FileWrite $0 'Set oSQLApp =CreateObject("SQLDMO.Application")$\r$\n'<br />
      FileWrite $0 'Set oNames = oSQLApp.ListAvailableSQLServers()$\r$\n'<br />
      FileWrite $0 'For i = 1 To oNames.Count$\r$\n'<br />
      FileWrite $0 ' If count &lt;= 0 Then$\r$\n'<br />
      FileWrite $0 ' strResults = "[SQLServers]" &amp; vbNewLine &amp; "List=" &amp; oNames.Item(i)$\r$\n'<br />
      FileWrite $0 ' count = 1$\r$\n'<br />
      FileWrite $0 ' Else$\r$\n'<br />
      FileWrite $0 ' strResults = strResults &amp; "|" &amp; oNames.Item(i)$\r$\n'<br />
      FileWrite $0 ' End If$\r$\n'<br />
      FileWrite $0 'Next $\r$\n'<br />
      FileWrite $0 '$\r$\n'<br />
      FileWrite $0 'CheckFile()$\r$\n'<br />
      FileWrite $0 '$\r$\n'<br />
      FileWrite $0 'End Function$\r$\n'<br />
      FileWrite $0 '$\r$\n'<br />
      FileWrite $0 '$\r$\n'<br />
      FileWrite $0 'Sub CheckFile$\r$\n'<br />
      FileWrite $0 'Set objFS = CreateObject("Scripting.FileSystemObject")$\r$\n'<br />
      FileWrite $0 ' If objFS.FileExists(fileOutput) Then$\r$\n'<br />
      FileWrite $0 ' objFS.DeleteFile(fileOutput)$\r$\n'<br />
      FileWrite $0 ' End If$\r$\n'<br />
      FileWrite $0 ' If Not objFS.FileExists(fileOutput) Then$\r$\n'<br />
      FileWrite $0 ' objFS.CreateTextFile(fileOutput)$\r$\n'<br />
      FileWrite $0 ' End If$\r$\n'<br />
      FileWrite $0 ' WriteFile()$\r$\n'<br />
      FileWrite $0 'End Sub$\r$\n'<br />
      FileWrite $0 '$\r$\n'<br />
      FileWrite $0 'Sub WriteFile$\r$\n'<br />
      FileWrite $0 'Set objFS = CreateObject("Scripting.FileSystemObject")$\r$\n'<br />
      FileWrite $0 ' Set objTS = objFS.OpenTextFile(fileOutput, FOR_WRITING)$\r$\n'<br />
      FileWrite $0 ' objTS.Write strResults$\r$\n'<br />
      FileWrite $0 'End Sub$\r$\n'<br />
      FileClose $0<br />
      FunctionEnd<br />
      <br />
      # Visual Basic Script that gets a list of Databases on for a selected Server<br />
      Function CreateDBVBS<br />
      StrCpy $1 "'"<br />
      FileOpen $0 "$PLUGINSDIR\FindDB.vbs" w<br />
      FileWrite $0 '$1---------------------------------------------------------------------------$\r$\n'<br />
      FileWrite $0 '$1---------------------------------------------------------------------------$\r$\n'<br />
      FileWrite $0 '$1$\r$\n'<br />
      FileWrite $0 '$1 Licensed Materials - Property of MyCompany (TSW)$\r$\n'<br />
      FileWrite $0 '$1 $\r$\n'<br />
      FileWrite $0 '$1 Governed under the terms of the International$\r$\n'<br />
      FileWrite $0 '$1 License Agreement for Non-Warranted Code.$\r$\n'<br />
      FileWrite $0 '$1$\r$\n'<br />
      FileWrite $0 '$1 (C) COPYRIGHT MYCOMPANY Corp. 2006 - 2007$\r$\n'<br />
      FileWrite $0 '$1 All Rights Reserved.$\r$\n'<br />
      FileWrite $0 '$1$\r$\n'<br />
      FileWrite $0 '$1---------------------------------------------------------------------------$\r$\n'<br />
      FileWrite $0 '$1$\r$\n'<br />
      FileWrite $0 '$1 SOURCE FILE NAME: FindDB.vbs$\r$\n'<br />
      FileWrite $0 '$1$\r$\n'<br />
      FileWrite $0 '$1----------------------------------------------------------------------------$\r$\n'<br />
      FileWrite $0 '$\r$\n'<br />
      FileWrite $0 'Const FOR_WRITING = 2$\r$\n'<br />
      FileWrite $0 'Dim strResults$\r$\n'<br />
      FileWrite $0 'strDBServerName = WScript.Arguments(0)$\r$\n'<br />
      FileWrite $0 'fileOutput = WScript.Arguments(1)$\r$\n'<br />
      FileWrite $0 'Call GetDatabases(strDBServerName)$\r$\n'<br />
      FileWrite $0 '$\r$\n'<br />
      FileWrite $0 'Private Function GetDatabases(s)$\r$\n'<br />
      FileWrite $0 '$\r$\n'<br />
      FileWrite $0 ' $\r$\n'<br />
      FileWrite $0 'Set objSQLServer = CreateObject("SQLDMO.SQLServer")$\r$\n'<br />
      FileWrite $0 ' objSQLServer.LoginSecure = True$\r$\n'<br />
      FileWrite $0 ' objSQLServer.Connect s$\r$\n'<br />
      FileWrite $0 ' $\r$\n'<br />
      FileWrite $0 ' Set colDatabases = objSQLServer.Databases$\r$\n'<br />
      FileWrite $0 ' $\r$\n'<br />
      FileWrite $0 ' For Each objDatabase In colDatabases$\r$\n'<br />
      FileWrite $0 ' If count &lt;= 0 Then$\r$\n'<br />
      FileWrite $0 ' strResults = "[" &amp; s &amp; "]" &amp; _$\r$\n'<br />
      FileWrite $0 ' vbNewLine &amp; "List=" &amp; objDatabase.Name$\r$\n'<br />
      FileWrite $0 ' count = 1$\r$\n'<br />
      FileWrite $0 ' Else$\r$\n'<br />
      FileWrite $0 ' strResults = strResults &amp; "|" &amp; objDatabase.Name$\r$\n'<br />
      FileWrite $0 ' End If$\r$\n'<br />
      FileWrite $0 ' Next$\r$\n'<br />
      FileWrite $0 '$\r$\n'<br />
      FileWrite $0 ' CheckFile()$\r$\n'<br />
      FileWrite $0 'End Function$\r$\n'<br />
      FileWrite $0 '$\r$\n'<br />
      FileWrite $0 'Sub CheckFile$\r$\n'<br />
      FileWrite $0 'Set objFS = CreateObject("Scripting.FileSystemObject")$\r$\n'<br />
      FileWrite $0 ' If objFS.FileExists(fileOutput) Then$\r$\n'<br />
      FileWrite $0 ' objFS.DeleteFile(fileOutput)$\r$\n'<br />
      FileWrite $0 ' End If$\r$\n'<br />
      FileWrite $0 ' If Not objFS.FileExists(fileOutput) Then$\r$\n'<br />
      FileWrite $0 ' objFS.CreateTextFile(fileOutput)$\r$\n'<br />
      FileWrite $0 ' End If$\r$\n'<br />
      FileWrite $0 ' WriteFile()$\r$\n'<br />
      FileWrite $0 'End Sub$\r$\n'<br />
      FileWrite $0 '$\r$\n'<br />
      FileWrite $0 'Sub WriteFile()$\r$\n'<br />
      FileWrite $0 ' Set objFS = CreateObject("Scripting.FileSystemObject")$\r$\n'<br />
      FileWrite $0 ' Set objTS = objFS.OpenTextFile(fileOutput, FOR_WRITING)$\r$\n'<br />
      FileWrite $0 ' objTS.Write strResults$\r$\n'<br />
      FileWrite $0 'End Sub$\r$\n'<br />
      FileClose $0<br />
      FunctionEnd<br />
      NSIS Install Code End<br />
      <br />
      INI for Custom Page Begin:<br />
      <br />
      [Settings]<br />
      NumFields=22<br />
      <br />
      [Field 1]<br />
      Type=Groupbox<br />
      Text=SQL 2005 Server<br />
      Flags=NOTABSTOP<br />
      Left=4<br />
      Right=268<br />
      Top=1<br />
      Bottom=198<br />
      <br />
      [Field 2]<br />
      Type=Label<br />
      Text=SQLServer:<br />
      Left=30<br />
      Right=68<br />
      Top=115<br />
      Bottom=123<br />
      <br />
      [Field 3]<br />
      Type=Label<br />
      Text=Database:<br />
      Left=33<br />
      Right=68<br />
      Top=134<br />
      Bottom=142<br />
      <br />
      [Field 4]<br />
      Type=Groupbox<br />
      Text=SQL Server Authentication<br />
      Flags=NOTABSTOP<br />
      Left=13<br />
      Right=260<br />
      Top=12<br />
      Bottom=102<br />
      <br />
      [Field 5]<br />
      Type=Label<br />
      Text=Username:<br />
      Flags=NOTABSTOP<br />
      Left=46<br />
      Right=80<br />
      Top=49<br />
      Bottom=57<br />
      <br />
      [Field 6]<br />
      Type=Label<br />
      Text=Password:<br />
      Flags=NOTABSTOP<br />
      Left=46<br />
      Right=79<br />
      Top=65<br />
      Bottom=73<br />
      <br />
      [Field 7]<br />
      Type=Label<br />
      Text=Not Connected<br />
      Flags=NOTABSTOP<br />
      Left=186<br />
      Right=240<br />
      Top=84<br />
      Bottom=92<br />
      <br />
      [Field 8]<br />
      Type=Label<br />
      Text=Version #.#.#.#<br />
      Flags=NOTABSTOP<br />
      Left=78<br />
      Right=176<br />
      Top=153<br />
      Bottom=161<br />
      <br />
      [Field 9]<br />
      Type=Label<br />
      Text=Database Version:<br />
      Flags=NOTABSTOP<br />
      Left=10<br />
      Right=68<br />
      Top=153<br />
      Bottom=161<br />
      <br />
      [Field 10]<br />
      Type=Label<br />
      Text=SQLServer Version:<br />
      Flags=NOTABSTOP<br />
      Left=9<br />
      Right=71<br />
      Top=166<br />
      Bottom=174<br />
      <br />
      [Field 11]<br />
      Type=Label<br />
      Text=SQL 2005 Server<br />
      Flags=NOTABSTOP<br />
      Left=78<br />
      Right=133<br />
      Top=166<br />
      Bottom=174<br />
      <br />
      [Field 12]<br />
      Type=Link<br />
      Text=techsupport@mycompany.com<br />
      Flags=NOTABSTOP<br />
      State=mailto:techsupport@mycompany.com<br />
      Left=80<br />
      Right=197<br />
      Top=180<br />
      Bottom=188<br />
      <br />
      [Field 13]<br />
      Type=RadioButton<br />
      Text=Current User Credentials<br />
      Flags=NOTIFY<br />
      State=1<br />
      Left=32<br />
      Right=131<br />
      Top=32<br />
      Bottom=41<br />
      <br />
      [Field 14]<br />
      Type=Combobox<br />
      Text=Combobox<br />
      ListItems=<br />
      Left=69<br />
      Right=204<br />
      Top=113<br />
      Bottom=126<br />
      <br />
      [Field 15]<br />
      Type=Button<br />
      Text=Refresh<br />
      Flags=NOTIFY<br />
      Left=208<br />
      Right=258<br />
      Top=112<br />
      Bottom=126<br />
      <br />
      [Field 16]<br />
      Type=Combobox<br />
      Text=Combobox<br />
      ListItems=<br />
      Left=69<br />
      Right=204<br />
      Top=131<br />
      Bottom=145<br />
      <br />
      [Field 17]<br />
      Type=Button<br />
      Text=Refresh<br />
      Flags=NOTIFY<br />
      Left=208<br />
      Right=258<br />
      Top=129<br />
      Bottom=145<br />
      <br />
      [Field 18]<br />
      Type=RadioButton<br />
      Text=Use SQL Server Authentication<br />
      Flags=NOTIFY<br />
      Left=136<br />
      Right=250<br />
      Top=32<br />
      Bottom=41<br />
      <br />
      [Field 19]<br />
      Type=Text<br />
      Left=82<br />
      Right=176<br />
      Top=46<br />
      Bottom=59<br />
      <br />
      [Field 20]<br />
      Type=Password<br />
      Left=82<br />
      Right=176<br />
      Top=64<br />
      Bottom=76<br />
      <br />
      [Field 21]<br />
      Type=Button<br />
      Text=TestConnection<br />
      Flags=NOTIFY<br />
      Left=82<br />
      Right=176<br />
      Top=80<br />
      Bottom=94<br />
      <br />
      [Field 22]<br />
      Type=Button<br />
      Text=Test Database<br />
      Flags=NOTIFY<br />
      Left=204<br />
      Right=260<br />
      Top=176<br />
      Bottom=190<br />
      <br />
      INI for Custom Page End:</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">sgiusto</span><br />
      <span class="post-time small text-muted">4th April 2007 20:37 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Hi there,<br />
      I'm interested in SQL Interfaces<br />
      I developed a plugin to execute generic sql scripts using SQL OLEDB interface, so you don't have to manage vbscript or similar.<br />
      You can find it at the plugins section of nsis site.<br />
      I think that using my plugin your posted script wuold be a lot less complex.<br />
      Drop me email if you find useful the plugin and have requests of new features</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">GarBear</span><br />
      <span class="post-time small text-muted">12th April 2007 16:02 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>Thanks for the SQL Help!</strong><br />
      I am excited to try out your SQL tools. I have a release this Monday so won't be able to update my application until after then, but here is the example of the app as it currently sits. Once you have seen that you may have other suggestions for improvements as well.<br />
      <br />
      My hope is that people can download my plug-ins for MSSQL and IIS and encorporate real interfaces for their installations.<br />
      <br />
      Thanks;<br />
      <br />
      GarBear</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">GarBear</span><br />
      <span class="post-time small text-muted">19th April 2007 20:55 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">I attempted to attach the new file but it is too big for the forumn now at 133KB. Send me a message if you would like the latest version.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
      <span class="post-time small text-muted">19th April 2007 21:04 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">You can upload to <a href="http://stashbox.org/" target="_blank">stashbox.org</a>.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">valentz142</span><br />
      <span class="post-time small text-muted">20th April 2007 08:52 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Hi sgiusto,<br />
      <br />
      I found that your plugin only can display 4 character max per column, I have already tried to select one column only, it was still display first 4 character of my string.<br />
      Could you help me?</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">sgiusto</span><br />
      <span class="post-time small text-muted">20th April 2007 21:58 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Hi valentz142,<br />
      did you tried the given sample? it reads much more than 4 characters and it works on my tests.<br />
      Provide some script fragment with examples of wrong behaviour and I will check.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">valentz142</span><br />
      <span class="post-time small text-muted">23rd April 2007 07:05 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Hi sgiusto,<br />
      <br />
      actually i used your example, i put my query in your query field, i used "select columid" instead of "select *". And this query has already been tested in sql query program, it will get one 1 row and 1 column only.<br />
      I should expect 10 character of string, but i've just only received 4 character.<br />
      <br />
      I have tested it in sql2000 and sql express 2005</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">sgiusto</span><br />
      <span class="post-time small text-muted">26th April 2007 22:03 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Can you post the complete query? the table in my example does not contain a 'columid' column</p>
    </div>
    <hr />

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]>
  </script>
</body>
</html>
