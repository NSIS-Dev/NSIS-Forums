<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="need gzip support for web downloads/INETC" />

  <title>need gzip support for web downloads/INETC - NSIS Forums</title><!-- Bootstrap core CSS -->
  <link rel="stylesheet" type="text/css" href="//netdna.bootstrapcdn.com/bootswatch/3.0.1/readable/bootstrap.min.css" />
  <link rel="stylesheet" href="../css/style.css" type="text/css" /><!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!--[if lt IE 9]>
                <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
                <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->
</head>

<body>
  <div class="container">
    <!-- Put navigation bar here -->

    <ol class="breadcrumb">
      <li><a href="../index.html" class="glyphicon glyphicon-home"></a></li>

      <li><a href="f-65.html">NSIS Discussion</a></li>

      <li class="active">need gzip support for web downloads/INETC</li>
    </ol>

    <p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=339851">need gzip support for web downloads/INETC</a></p><br />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Brummelchen</span><br />
      <span class="post-time small text-muted">23rd December 2011 05:57 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>need gzip support for web downloads/INETC</strong><br />
      i need gzip support...<br />
      <br />
      <b>url</b> http://beta.data-cdn.mbamupdates.com/v1/database/rules/version.chk<br />
      <b>result in INETC</b> ".‹........+3204Ô34Ò32Ð30..¦“$Ö...."<br />
      <b>should be</b> "v2011.12.20.06" (from Firefox)<br /></p>

      <blockquote>
        inetc::get /POPUP "" "http://beta.data-cdn.mbamupdates.com/v1/database/rules/version.chk" "$EXEDIR\version.txt" /END /TIMEOUT 30000 /NOCANCEL
      </blockquote>
      <pre>
<code>GET</code><span style="color: #007700">/</span><span style="color: #0000BB">v1</span><span style="color: #007700">/</span><span style="color: #0000BB">database</span><span style="color: #007700">/</span><span style="color: #0000BB">rules</span><span style="color: #007700">/</span><span style="color: #0000BB">version</span><span style="color: #007700">.</span><span style="color: #0000BB">chkHTTP</span><span style="color: #007700">/</span><span style="color: #0000BB">1.1
<br />Accept</span><span style="color: #007700">-</span><span style="color: #0000BB">Encoding</span><span style="color: #007700">:</span><span style="color: #0000BB">gzip</span><span style="color: #007700">,</span><span style="color: #0000BB">deflate
<br />Connection</span><span style="color: #007700">:</span><span style="color: #0000BB">Close
<br />Content</span><span style="color: #007700">-</span><span style="color: #0000BB">Length</span><span style="color: #007700">:</span><span style="color: #0000BB">0
<br />Host</span><span style="color: #007700">:</span><span style="color: #0000BB">beta</span><span style="color: #007700">.</span><span style="color: #0000BB">data</span><span style="color: #007700">-</span><span style="color: #0000BB">cdn</span><span style="color: #007700">.</span><span style="color: #0000BB">mbamupdates</span><span style="color: #007700">.</span><span style="color: #0000BB">com</span><span style="color: #007700">/</span><span style="color: #0000BB">v1</span><span style="color: #007700">/</span><span style="color: #0000BB">database</span><span style="color: #007700">/</span><span style="color: #0000BB">rules</span><span style="color: #007700">/</span><span style="color: #0000BB">version</span><span style="color: #007700">.</span><span style="color: #0000BB">chk
<br />User</span><span style="color: #007700">-</span><span style="color: #0000BB">Agent</span><span style="color: #007700">:</span><span style="color: #0000BB">mbam
<br /><br /><br />HTTP</span><span style="color: #007700">/</span><span style="color: #0000BB">1.1200OK
<br />Accept</span><span style="color: #007700">-</span><span style="color: #0000BB">Ranges</span><span style="color: #007700">:</span><span style="color: #0000BB">bytes
<br />cache</span><span style="color: #007700">-</span><span style="color: #0000BB">control</span><span style="color: #007700">:</span><span style="color: #0000BB">max</span><span style="color: #007700">-</span><span style="color: #0000BB">age</span><span style="color: #007700">=</span><span style="color: #0000BB">120</span><span style="color: #007700">,public,</span><span style="color: #0000BB">s</span><span style="color: #007700">-</span><span style="color: #0000BB">maxage</span><span style="color: #007700">=</span><span style="color: #0000BB">120
<br />Content</span><span style="color: #007700">-</span><span style="color: #0000BB">Encoding</span><span style="color: #007700">:</span><span style="color: #0000BB">gzip
<br />Content</span><span style="color: #007700">-</span><span style="color: #0000BB">Type</span><span style="color: #007700">:</span><span style="color: #0000BB">text</span><span style="color: #007700">/</span><span style="color: #0000BB">plain</span><span style="color: #007700">;</span><span style="color: #0000BB">charset</span><span style="color: #007700">=</span><span style="color: #0000BB">UTF</span><span style="color: #007700">-</span><span style="color: #0000BB">8
<br />Date</span><span style="color: #007700">:</span><span style="color: #0000BB">Fri</span><span style="color: #007700">,</span><span style="color: #0000BB">23Dec201105</span><span style="color: #007700">:</span><span style="color: #0000BB">04</span><span style="color: #007700">:</span><span style="color: #0000BB">58GMT
<br />expires</span><span style="color: #007700">:</span><span style="color: #0000BB">Fri</span><span style="color: #007700">,</span><span style="color: #0000BB">23Dec201105</span><span style="color: #007700">:</span><span style="color: #0000BB">06</span><span style="color: #007700">:</span><span style="color: #0000BB">58GMT
<br />Last</span><span style="color: #007700">-</span><span style="color: #0000BB">Modified</span><span style="color: #007700">:</span><span style="color: #0000BB">Fri</span><span style="color: #007700">,</span><span style="color: #0000BB">23Dec201105</span><span style="color: #007700">:</span><span style="color: #0000BB">01</span><span style="color: #007700">:</span><span style="color: #0000BB">52GMT
<br />Server</span><span style="color: #007700">:</span><span style="color: #0000BB">ECAcc</span><span style="color: #007700">(</span><span style="color: #0000BB">fra</span><span style="color: #007700">/</span><span style="color: #0000BB">D4B8</span><span style="color: #007700">)
<br /></span><span style="color: #0000BB">X</span><span style="color: #007700">-</span><span style="color: #0000BB">Cache</span><span style="color: #007700">:</span><span style="color: #0000BB">HIT
<br />Content</span><span style="color: #007700">-</span><span style="color: #0000BB">Length</span><span style="color: #007700">:</span><span style="color: #0000BB">34
<br />Connection</span><span style="color: #007700">:</span><span style="color: #0000BB">close
<br /><br /></span><span style="color: #007700">.</span><span style="color: #0000BB">‹</span><span style="color: #007700">........+</span><span style="color: #0000BB">3204Ô34Ò32Ð30</span><span style="color: #007700">..</span><span style="color: #0000BB">¦“$Ö</span><span style="color: #007700">....
</span>
</pre>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Yathosho</span><br />
      <span class="post-time small text-muted">23rd December 2011 08:53 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><a href="http://nsis.sourceforge.net/UnTGZ_plug-in" target="_blank">http://nsis.sourceforge.net/UnTGZ_plug-in</a> (or 7za.exe)</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Brummelchen</span><br />
      <span class="post-time small text-muted">23rd December 2011 12:34 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">i tried untgz (as well as nsisunz|nsiszip|nsis7z) - but i got always the message "Error: Failure reading from tarball".<br /></p>

      <blockquote>
        untgz::extract -j -zauto "$EXEDIR\version.gz"
      </blockquote>i download the file as "version.gz" but also "version.tar.gz" - dont fit.<br />
      <br />
      7za is not really a option, i found gzip.exe (90kb, 7za=574kb).<br />
      unzip.exe and pkunzip also failed (unrar|rar too).<br />
      but the major problem with those extensions in EXEDIR is that they cannot be deleted cause<br />
      anyhow locked up. that why i wanted an internal invisible solution, pity.<br />
      # ok $PLUGINSDIR can do, solved that part<br />
      <br />
      another idea was to outsource the download complete with wget but that would cause<br />
      another thread for a firewall, not my file.<br />
      <br />
      /me=dumb - i had the inetc thread open and somehow pushed wrong submit button
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">{_trueparuex^}</span><br />
      <span class="post-time small text-muted">23rd December 2011 14:07 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Try disabling the encoding by using /HEADER "Accept-Encoding: none" in your INETC command. This should tell the server not to use content encoding as the client doesn't support it.<br />
      <br /></p>

      <blockquote>
        inetc::get /POPUP "" /HEADER "Accept-Encoding: none" "http://beta.data-cdn.mbamupdates.com/v1/database/rules/version.chk" "$EXEDIR\version.txt" /END /TIMEOUT 30000 /NOCANCEL
      </blockquote>PaR
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Brummelchen</span><br />
      <span class="post-time small text-muted">23rd December 2011 14:39 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">afraid it does not work<br />
      <a href="http://www.w3.org/Protocols/rfc2616/rfc2616-sec14.html" target="_blank">http://www.w3.org/Protocols/rfc2616/rfc2616-sec14.html</a><br />
      <br />
      i had<br />
      "Accept-Encoding:"<br />
      "Accept-Encoding: identity"<br />
      "Accept-Encoding: deflate"<br />
      "Accept-Encoding: gzip;q=0"<br />
      <br />
      :,|</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">{_trueparuex^}</span><br />
      <span class="post-time small text-muted">24th December 2011 13:43 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">You are right. I got the encoding response headers and request headers mixed up.<br />
      <br />
      What I don't get is why in your case inetc even sends the Accept-Encoding header. It shouldn't use the encoding unless it's told to do so: <a href="http://msdn.microsoft.com/en-us/library/windows/desktop/aa383955%28v=vs.85%29.aspx" target="_blank">http://msdn.microsoft.com/en-us/libr...=vs.85%29.aspx</a></p>
    </div>
    <hr />

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]>
  </script>
</body>
</html>
