<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="asking for 2 directories" />

  <title>asking for 2 directories - NSIS Forums</title><!-- Bootstrap core CSS -->
  <link rel="stylesheet" type="text/css" href="//netdna.bootstrapcdn.com/bootswatch/3.0.1/readable/bootstrap.min.css" />
  <link rel="stylesheet" href="../css/style.css" type="text/css" /><!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!--[if lt IE 9]>
                <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
                <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->
</head>

<body>
  <div class="container">
    <!-- Put navigation bar here -->

    <ol class="breadcrumb">
      <li><a href="../index.html" class="glyphicon glyphicon-home"></a></li>

      <li><a href="f-65.html">NSIS Discussion</a></li>

      <li class="active">asking for 2 directories</li>
    </ol>

    <p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=151841">asking for 2 directories</a></p><br />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">micahel</span><br />
      <span class="post-time small text-muted">7th October 2003 16:26 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>asking for 2 directories</strong><br />
      Hello,<br />
      <br />
      me again with some silly questions:<br />
      <br />
      a) How can I produce two "wizzard-like" pages for requesting the user to browse for a directory which I can put to user-variables?<br />
      <br />
      b) Is there another possibility (more nifty) to set system variables in windows (like the command "set VARIABLE=TOVALUE") which will be used while the installer is running?<br />
      Or shall I execute the "set" command?<br />
      <br />
      Thank you for your help<br />
      Michael</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
      <span class="post-time small text-muted">7th October 2003 16:32 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">StrCpy $0 hello<br />
      $0 = hello<br />
      <br />
      See the documentation on user vairiables, and creating new variables.<br />
      Also check out the syntaxes for StrCpy, StrCmp and other string functions.<br />
      <br />
      Use InstallOptions (in Contrib\InstallOptions) to create custom dialogs with directory inputs.<br />
      <br />
      I'm not sure, but it may be possible to have two directory pages in latest NSIS CVS, and you can use<br />
      StrCpy $R0 $INSTDIR, StrCpy $R1 $INSTDIR to store the different directory paths in the leave functions of both pages.<br />
      <br />
      -Stu</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
      <span class="post-time small text-muted">7th October 2003 16:47 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">In the latest CVS version just insert the directory page macro twice and use MUI_DIRECTORYPAGE_VARIABLE before one of them to define a different variable into which the directory will be saved.<br />
      <br />
      <a href="http://nsis.sf.net/archive" target="_blank">The Archvie</a> contains some functions that can help you set environment variables. Simply search for "environment" and you'd find what you need.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">micahel</span><br />
      <span class="post-time small text-muted">8th October 2003 18:36 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">First of all, thanks for your help. I really made a major step to my goal. But I recognized, that I got a problem with the System/User Variables . So I have a question that don't rely on NSIS, but maybe someone of you could help me:<br />
      <br />
      Is it possible to set a System/User Variable, which normaly would by set by Start-&gt;System Properties-&gt;System-&gt;Environment (on Win2k) without having to logout and login again, in order to aktivate this System/User Variable?<br />
      Something of rereading the Registry regarding "Environment" without leaving the current Windows(NT)-Session?<br />
      <br />
      Thanks for your help!<br />
      <br />
      Cheers Michael</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
      <span class="post-time small text-muted">8th October 2003 18:51 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">There is a function in the Archive that does exactly that. Just search for "environment" in there and you should about 4 related pages.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">micahel</span><br />
      <span class="post-time small text-muted">8th October 2003 19:30 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Sorry for my silliness. I just read only one of your articles.<br />
      The other article helped me to solve my problem.<br />
      <br />
      Again, sorry. And please, don't hit me....<br />
      Thanks for the great support!<br />
      <br />
      Cheers Michael</p>
    </div>
    <hr />

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]>
  </script>
</body>
</html>
