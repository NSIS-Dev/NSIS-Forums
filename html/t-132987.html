<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="description" content="CD vs. harddisk"><title>CD vs. harddisk - NSIS Forums</title><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script><link rel="preload" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css" as="style" onload="this.rel='stylesheet'"><link rel="preload" href="../css/style.css" as="style" onload="this.rel='stylesheet'"><noscript><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css"><link rel="stylesheet" href="../css/style.css"></noscript><script>!function(a){"use strict";var b=function(b,c,d){function e(a){return h.body?a():void setTimeout(function(){e(a)})}function f(){i.addEventListener&&i.removeEventListener("load",f),i.media=d||"all"}var g,h=a.document,i=h.createElement("link");if(c)g=c;else{var j=(h.body||h.getElementsByTagName("head")[0]).childNodes;g=j[j.length-1]}var k=h.styleSheets;i.rel="stylesheet",i.href=b,i.media="only x",e(function(){g.parentNode.insertBefore(i,c?g:g.nextSibling)});var l=function(a){for(var b=i.href,c=k.length;c--;)if(k[c].href===b)return a();setTimeout(function(){l(a)})};return i.addEventListener&&i.addEventListener("load",f),i.onloadcssdefined=l,l(f),i};"undefined"!=typeof exports?exports.loadCSS=b:a.loadCSS=b}("undefined"!=typeof global?global:this);!function(a){if(a.loadCSS){var b=loadCSS.relpreload={};if(b.support=function(){try{return a.document.createElement("link").relList.supports("preload")}catch(b){return!1}},b.poly=function(){for(var b=a.document.getElementsByTagName("link"),c=0;c<b.length;c++){var d=b[c];"preload"===d.rel&&"style"===d.getAttribute("as")&&(a.loadCSS(d.href,d,d.getAttribute("media")),d.rel=null)}},!b.support()){b.poly();var c=a.setInterval(b.poly,300);a.addEventListener&&a.addEventListener("load",function(){b.poly(),a.clearInterval(c)}),a.attachEvent&&a.attachEvent("onload",function(){a.clearInterval(c)})}}}(this);</script></head><body><div class="container"><ol class="breadcrumb"><li><a href="../index.html" class="glyphicon glyphicon-home"></a></li><li><a href="f-65.html">NSIS Discussion</a></li><li class="active">CD vs. harddisk</li></ol><p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=132987">CD vs. harddisk</a></p><br><div class="post"><p class="post-meta"><span class="post-author text-primary">zoli</span><br><span class="post-time small text-muted">24th April 2003 18:09 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>CD vs. harddisk</strong><br>Disclaimer: I searched the site but did not find answer to my question.<br><br>Has anybody experienced differences between running the created install from burnt CD or harddisk?<br><br>I have a small installer asking the user to select between<br>1) running the (html) application from the CD or<br>2) running another installer which copies the application to the HDD and launches it from there.<br><br>My problem is that this first installer works fine from my disk before burning it to the CD, but just does not launch anything if I run it from the CD.<br><br>The related code from this first installer is the following:<br><br>Section "CD-meghajtóról futtatom" sec1<br>ExecShell "open" "$EXEDIR\FIGURAKATALOGUS\START.HTM"<br>SectionEnd<br><br>Section "Feltelepítem a gépre" sec2<br>Exec "$EXEDIR\INSTALL\SETUP_TANC.EXE"<br>SectionEnd<br><br><br>If I manually launch them (either the html or the setup) then they are working, reachable, etc. I've also created a version with messageboxes displaying the path before launching the files and it seemed good.<br><br><br>Thanks in advance.<br><br>The full file is attached as well</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Yathosho</span><br><span class="post-time small text-muted">24th April 2003 19:01 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">you didnt attach anything.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Joost Verburg</span><br><span class="post-time small text-muted">24th April 2003 19:34 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Doens't the installer start at all or is it ExecShell causing the problem?</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">zoli</span><br><span class="post-time small text-muted">25th April 2003 09:29 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">What happens is that the first installer gets executed as far as I see, so I can select which option to launch.<br><br>After selecting and pressing the button, the first installer terminates, but the second installer (or the application) is not launched.<br><br>If I do the same from the winchester then they are launched.<br><br>&lt;I will give another try to attach the .nsi file in the evening, it is on my home computer&gt;</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">R@m00n</span><br><span class="post-time small text-muted">25th April 2003 10:21 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">It's caused by this fault:<br>On HDD: $EXEDIR=C:\Test -&gt; C:\Test\FIGURAKATALOGUS\START.HTM<br>On CD: $EXEDIR=D:\ -&gt; D:\\FIGURAKATALOGUS\START.HTM<br><br>So it uses to Backslashes. You need to check if Exedir ends with a Backslash and if yes then remove it.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br><span class="post-time small text-muted">25th April 2003 10:50 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Use this...<br><br>Push [Your string]<br>Call removebs<br>Pop $R0<br><br>If [Your string] had a backslash on the end (\) then it will now be removed.<br><br></p><pre>
<code><br>Function removebs<br>Exch $R0<br>Push $R1<br>StrCpy $R1 $R0 1 -1<br>StrCmp $R1 "\" 0 +2<br>StrCpy $R0 $R0 -1<br>Pop $R1<br>Exch $R0<br>FunctionEnd<br></code>
</pre><br>
      <br>
      -Stu
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br>
      <span class="post-time small text-muted">25th April 2003 15:01 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">R@m00n, that's not true. $EXEDIR and friends are always stripped down from the last back-slash. Besides, he said the path looked OK to him.<br>
      <br>
      I had no problem doing what you're trying to do from a CD or hard-disk. What version of NSIS and Windows are you using?</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">zoli</span><br>
      <span class="post-time small text-muted">27th April 2003 10:54 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Hi Guys!<br>
      <br>
      Thanks to all of you for the tips and help.<br>
      <br>
      Now it is working. You were right kichik that this was not the backslash, but still, the comment of RamOOn made me reactivate my debug messageboxes and it turned out that there was indeed a mistake in the path:<br>
      <br>
      On the CD root (and in the harddisk root as well) $EXEDIR evaluates to G (or C), so no backslash but there is the colon missing.<br>
      <br>
      So here is my code now:<br>
      <br>
      Push $EXEDIR<br>
      Call fix_exe_path<br>
      Pop $R0<br>
      Exec "$R0\INSTALL\SETUP_TANC.EXE"<br>
      <br>
      the similar for the "launch the html" as well.<br>
      <br>
      And the function:<br>
      <br>
      Function fix_exe_path<br>
      Exch $R0<br>
      Push $R1<br>
      Push $R2<br>
      StrLen $R1 $R0<br>
      IntCmp $R1 1 0 0 +3<br>
      StrCpy $R2 ":"<br>
      StrCpy $R0 "$R0$R2"<br>
      Pop $R2<br>
      Pop $R1<br>
      Exch $R0<br>
      FunctionEnd<br>
      <br>
      THANKS AGAIN.<br>
      Zoli</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">virtlink</span><br>
      <span class="post-time small text-muted">27th April 2003 14:27 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">So you mean that $EXEDIR becomes the following:<br></p>
      <pre>
<code>C<br>D<br>E:\Whatever</code>
</pre><br>
      <br>
      right?<br>
      <br>
      Is this a bug in NSIS, in Windows or what?
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br>
      <span class="post-time small text-muted">27th April 2003 17:25 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">It's an old bug in NSIS. What version are you using?</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">zoli</span><br>
      <span class="post-time small text-muted">28th April 2003 08:44 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">You are right Virtlink.<br>
      <br>
      From this experience, if you are in the root of a drive then $EXEDIR (at least in my version) evaluates only to the drive label, so C or D, etc.<br>
      <br>
      When you are in a directory, then it is fine, so you get back C:\Directory_name<br>
      <br>
      If I remember well then I am using the nsis20b1.exe</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Joost Verburg</span><br>
      <span class="post-time small text-muted">28th April 2003 11:25 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">NSIS 2 beta 1 is an old version. Upgrading is recommended.</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">virtlink</span><br>
      <span class="post-time small text-muted">30th April 2003 16:35 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">So is this 'bug' eliminated in the latest versions (or releases)?</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br>
      <span class="post-time small text-muted">30th April 2003 16:36 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Yes, it's an old bug.</p>
    </div>
    <hr>

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]></script></body></html>