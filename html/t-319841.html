<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="NSIS Exec uninstaller" />

  <title>NSIS Exec uninstaller - NSIS Forums</title>
  <script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script>
  <!-- Bootstrap core CSS -->

  <link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css" />
  <link rel="stylesheet" href="../css/style.css" type="text/css" /><!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!--[if lt IE 9]>
                <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
                <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->
</head>

<body>
  <div class="container">
    <!-- Put navigation bar here -->

    <ol class="breadcrumb">
      <li><a href="../index.html" class="glyphicon glyphicon-home"></a></li>

      <li><a href="f-65.html">NSIS Discussion</a></li>

      <li class="active">NSIS Exec uninstaller</li>
    </ol>

    <p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=319841">NSIS Exec uninstaller</a></p><br />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">allausk</span><br />
      <span class="post-time small text-muted">10th June 2010 21:30 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>NSIS Exec uninstaller</strong><br />
      I have a simple installer and uninstaller which will write log to a text file<br />
      When the installer run, it will check the install file existence. If it exists, it will run the uninstaller. The installer and uninstaller run perfect. However, auto uninstall will not write to the log file. The uninstaller will write to log file if involked alone. Please find my code below.<br />
      <br />
      Thanks for any help!<br />
      <br />
      ${If} ${FileExists} `$INSTDIR\PSS.jar`<br />
      MessageBox MB_YESNO "PSS.jar already exists$\r$\nDo you want to uninstall that?" IDYES AutoUninstall<br />
      <br />
      ${Else}<br />
      <br />
      MessageBox MB_OK "No previous version found. Continue with installer"<br />
      <br />
      Install:<br />
      ;Set the output path to the installation directory $InstallDir<br />
      SetOutPath $INSTDIR<br />
      <br />
      ; Put files to be copied in this section<br />
      File PSS.jar<br />
      <br />
      WriteUninstaller $INSTDIR\UninstallPSS.exe<br />
      <br />
      FileOpen $4 c:\log\PX.log a<br />
      FileSeek $4 0 END<br />
      FileWrite $4 "PSS.jar V1.2 installed$\r$\n"<br />
      FileClose $4<br />
      <br />
      ${EndIf}<br />
      <br />
      Goto End<br />
      <br />
      AutoUninstall:<br />
      ExecShell "" "UninstallPSS.exe"<br />
      Goto Install<br />
      <br />
      End:<br />
      <br />
      SectionEnd<br />
      <br />
      ; Uninstall<br />
      Section "Uninstall"<br />
      <br />
      Delete $INSTDIR\PSS.jar<br />
      Delete $INSTDIR\UninstallPSS.exe<br />
      FileOpen $4 C:\log\PX.log a<br />
      FileSeek $4 0 END<br />
      FileWrite $4 "PSS.jar V1.2 uninstalled$\r$\n"<br />
      FileClose $4<br />
      <br />
      SectionEnd</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">allausk</span><br />
      <span class="post-time small text-muted">10th June 2010 22:07 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>Solved myself</strong><br />
      I did not specify the path of the uninstaller on my code and the uninstall is not running at all.</p>
    </div>
    <hr />

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]>
  </script>
</body>
</html>
