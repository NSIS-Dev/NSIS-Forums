<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="description" content="Command Line Usage Problems"><title>Command Line Usage Problems - NSIS Forums</title><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script><link rel="preload" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css" as="style" onload="this.rel='stylesheet'"><link rel="preload" href="../css/style.css" as="style" onload="this.rel='stylesheet'"><noscript><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css"><link rel="stylesheet" href="../css/style.css"></noscript><script>!function(a){"use strict";var b=function(b,c,d){function e(a){return h.body?a():void setTimeout(function(){e(a)})}function f(){i.addEventListener&&i.removeEventListener("load",f),i.media=d||"all"}var g,h=a.document,i=h.createElement("link");if(c)g=c;else{var j=(h.body||h.getElementsByTagName("head")[0]).childNodes;g=j[j.length-1]}var k=h.styleSheets;i.rel="stylesheet",i.href=b,i.media="only x",e(function(){g.parentNode.insertBefore(i,c?g:g.nextSibling)});var l=function(a){for(var b=i.href,c=k.length;c--;)if(k[c].href===b)return a();setTimeout(function(){l(a)})};return i.addEventListener&&i.addEventListener("load",f),i.onloadcssdefined=l,l(f),i};"undefined"!=typeof exports?exports.loadCSS=b:a.loadCSS=b}("undefined"!=typeof global?global:this);!function(a){if(a.loadCSS){var b=loadCSS.relpreload={};if(b.support=function(){try{return a.document.createElement("link").relList.supports("preload")}catch(b){return!1}},b.poly=function(){for(var b=a.document.getElementsByTagName("link"),c=0;c<b.length;c++){var d=b[c];"preload"===d.rel&&"style"===d.getAttribute("as")&&(a.loadCSS(d.href,d,d.getAttribute("media")),d.rel=null)}},!b.support()){b.poly();var c=a.setInterval(b.poly,300);a.addEventListener&&a.addEventListener("load",function(){b.poly(),a.clearInterval(c)}),a.attachEvent&&a.attachEvent("onload",function(){a.clearInterval(c)})}}}(this);</script></head><body><div class="container"><ol class="breadcrumb"><li><a href="../index.html" class="glyphicon glyphicon-home"></a></li><li><a href="f-65.html">NSIS Discussion</a></li><li class="active">Command Line Usage Problems</li></ol><p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=355649">Command Line Usage Problems</a></p><br><div class="post"><p class="post-meta"><span class="post-author text-primary">Webmaster2015</span><br><span class="post-time small text-muted">8th February 2013 13:35 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>Command Line Usage Problems</strong><br>Hello. I am new to this forum. Anyway, I am a modder of GTA: Vice City and I was trying to integrate IMG editing into my NSIS installer. I am using a command line IMG editing tool to do so. However, when I run my installer, it skips the extraction of the IMG tool. Can someone tell me what to do to fix this?<br><br>Here is the nsi<br><br><a href="http://www.mediafire.com/?ndrh9a5mpk866au" target="_blank">http://www.mediafire.com/?ndrh9a5mpk866au</a><br><br>Thanks in advance!</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">demiller9</span><br><span class="post-time small text-muted">9th February 2013 16:09 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">The FILE command you used specifies a relative path to get/compress the executable. Are you sure that the path is correct relative to the nsi script?<br><br>The compiler should detect an error if the file isn't found, but absolute paths might be more reliable. Check the compiler output listing to be sure it found the file (you'll see the size before and after it was compressed when the FILE command is processed).<br><br>You can also use 7zip to look at the installer executable. If the fastman92ImgConsole.exe was found you'll see it under the $TEMP folder inside the archive. If it is present but does not get extracted, it might be a permissions issue. Try adding <a href="http://nsis.sourceforge.net/Docs/Chapter4.html#4.8.1.32" target="_blank">RequestExecutionLevel</a> HIGHEST to your script.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">MSG</span><br><span class="post-time small text-muted">9th February 2013 19:50 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">I agree with demiller9. It sounds like you were trying to do this:<br>File "C:\Downloads\Programs\GTAVC\fastman92_IMG_Console_1_7\go here for program\fastman92ImgConsole.exe"<br>instead of this:<br>File "Downloads\Programs\GTAVC\fastman92_IMG_Console_1_7\go here for program\fastman92ImgConsole.exe"<br><br>(Note that it's probably better to use $PLUGINSDIR, instead of $TEMP.)<br><br>You should also include requestexecutionlevel admin, and verify adminlevel access using the UserInfo plugin in .onInit. Because you're trying to write to programfiles and HKLM.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Webmaster2015</span><br><span class="post-time small text-muted">11th February 2013 14:52 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Thanks! I'll try permissions.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Webmaster2015</span><br><span class="post-time small text-muted">12th February 2013 14:58 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">I updated nsi with a script piece from here:<br><br><a href="http://forums.winamp.com/showthread.php?t=310377" target="_blank">http://forums.winamp.com/showthread.php?t=310377</a><br><br>Above mediafire link no longer works!!!<br><br>I also changed fastman92 to ImgEdCmd.<br><br>Hopefully it will work.<br><br></p><pre>
<code><br>!define PRODUCT_NAME "Test"<br>!define PRODUCT_VERSION "1.0"<br>!define PRODUCT_DIR_REGKEY "Software\Microsoft\Windows\CurrentVersion\App Paths\IMGEdCmd.exe"<br><br>!define XPUI_SYSDIR "C:\Program Files (x86)\NSIS\ExperienceUI\Contrib\ExperienceUI"<br>!include "${XPUI_SYSDIR}\XPUI.nsh"<br><br>RequestExecutionLevel Highest<br><br>; MUI 1.67 compatible ------<br>;!include "MUI.nsh"<br><br>; MUI Settings<br>!define MUI_ABORTWARNING<br>!define MUI_ICON "${NSISDIR}\Contrib\Graphics\Icons\modern-install.ico"<br><br>; Welcome page<br>!insertmacro MUI_PAGE_WELCOME<br>; Directory page<br>!insertmacro MUI_PAGE_DIRECTORY<br>; Instfiles page<br>!insertmacro MUI_PAGE_INSTFILES<br>; Finish page<br>!insertmacro MUI_PAGE_FINISH<br><br>; Language files<br>!insertmacro MUI_LANGUAGE "English"<br><br>; MUI end ------<br><br>Name "${PRODUCT_NAME} ${PRODUCT_VERSION}"<br>OutFile "IMG 1.exe"<br>InstallDir "$PROGRAMFILES\Rockstar Games\Grand Theft Auto Vice City"<br>InstallDirRegKey HKLM "${PRODUCT_DIR_REGKEY}" ""<br>ShowInstDetails show<br><br><br>Section "MainSection" SEC01<br><br>SetOutPath "$INSTDIR\addtogta3img"<br>  SetOverwrite on<br>  File "C:\Users\Ryan\Documents\GTAVC\ImgEdCmd\ImgEdCmd.exe"<br>  File "C:\Users\Ryan\Documents\GTAVC\sparrow.txd"<br><br>; Unset all file-attributes (like Read-Only) and check if gta3.img and gta3.dir exist<br>  SetOutPath "$INSTDIR\models"<br><br>/*<br><br>  IfFileExists "$INSTDIR\models\gta3.img" errModelInstall startModelInstallImg<br><br>  Goto errModelInstall<br><br>  startModelInstallImg:<br><br>  IfFileExists "$INSTDIR\models\gta3.dir" errModelInstall startModelInstallDir<br><br>  Goto errModelInstall<br><br>  startModelInstallDir:<br><br>*/<br><br>  SetFileAttributes "$INSTDIR\models\gta3.img" FILE_ATTRIBUTE_NORMAL<br><br>  SetFileAttributes "$INSTDIR\models\gta3.dir" FILE_ATTRIBUTE_NORMAL<br><br>  ; Add models to gta3.img<br>  <br>  nsExec::Exec '"$INSTDIR\addtogta3img\ImgEdCmd.exe" "$INSTDIR\models\gta3.img" /a "$INSTDIR\addtogta3img\sparrow.dff"'<br><br>SectionEnd<br><br><br><br>Section -Post<br>WriteRegStr HKLM "${PRODUCT_DIR_REGKEY}" "" ""$PROGRAMFILES\Rockstar Games\Grand Theft Auto Vice City""<br>Delete "$INSTDIR\addtogta3img"<br><br>SectionEnd</code>
</pre><br>
      <br>
      Later.
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">MSG</span><br>
      <span class="post-time small text-muted">12th February 2013 16:09 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">You should use requestexecutionlevel admin, and you also need to use the UserInfo plugin to make sure the installer actually *gets* admin access, for example in case UAC is turned off (or if using Windows older than Vista).<br>
      <br>
      Anders has made an excellent example script: <a href="http://pastebin.com/EvMkyLLt" target="_blank">http://pastebin.com/EvMkyLLt</a></p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Webmaster2015</span><br>
      <span class="post-time small text-muted">12th February 2013 17:16 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Thanks again!</p>
    </div>
    <hr>

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]></script></body></html>