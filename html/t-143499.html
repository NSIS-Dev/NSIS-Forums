<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="Calling Uninstaller from Installer..." />

  <title>Calling Uninstaller from Installer... - NSIS Forums</title><!-- Bootstrap core CSS -->
  <link rel="stylesheet" type="text/css" href="//netdna.bootstrapcdn.com/bootswatch/3.0.1/readable/bootstrap.min.css" />
  <link rel="stylesheet" href="../css/style.css" type="text/css" /><!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!--[if lt IE 9]>
                <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
                <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->
</head>

<body>
  <div class="container">
    <!-- Put navigation bar here -->

    <ol class="breadcrumb">
      <li><a href="../index.html" class="glyphicon glyphicon-home"></a></li>

      <li><a href="f-65.html">NSIS Discussion</a></li>

      <li class="active">Calling Uninstaller from Installer...</li>
    </ol>

    <p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=143499">Calling Uninstaller from Installer...</a></p><br />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">jcagle</span><br />
      <span class="post-time small text-muted">25th July 2003 02:42 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>Calling Uninstaller from Installer...</strong><br />
      Can someone give me a hand? I want to run the uninstaller from my installer, then continue with the installation. The catch is, if I call the uninstaller from the installer, I want to skip some things in the uninstaller. If I double click the uninstaller, I want to do everything in the uninstaller. So, below is what I have attempted. However, it doesn't appear to call the uninstaller. Any suggestions would be very welcomed!!! Thanks in advance!!!<br />
      <br />
      In the Uninstall Section...<br />
      Call un.GetParameters<br />
      Pop $0<br />
      StrCmp $0 "upgrade" skipit<br />
      MessageBox MB_OK "I am here"<br />
      skipit:<br />
      <br />
      Here is the call from the installer...<br />
      ExecWait '"$INSTDIR\uninstall.exe upgrade" _?=$INSTDIR'<br />
      <br />
      I put the "_?=$INSTDIR" on this line because I read somewhere that that is needed to make the installer script wait for the uninstaller to finish. If that's not the case, please let me know.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
      <span class="post-time small text-muted">25th July 2003 11:03 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Get the word upgrade outside of the quotes, it's not part of the executable path.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">jcagle</span><br />
      <span class="post-time small text-muted">25th July 2003 13:58 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Outside of the double quotes...correct? Not the single quotes?<br />
      <br />
      Also, is it correct to have "_?=$INSTDIR"? I would like to delete the directory at the end of the uninstall...but, this might not allow it because the directory is not empty???</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
      <span class="post-time small text-muted">25th July 2003 14:04 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Yes, outside of the double quotes. It should look like this:<br />
      <br />
      ExecWait '"$INSTDIR\uninstall.exe" update _?=$INSTDIR'<br />
      <br />
      It's OK to have the _?= part, and it must be there if you want the installer to really wait for the uninstaller. You won't be able to delete $INSTDIR from the uninstaller because the uninstaller won't copy itself because of the _?= part. If you want to delete it, copy the uninstaller to $TEMP yourself and then call it with _?= from temp. For example:<br />
      <br />
      GetTempFileName $0<br />
      CopyFiles /SILENT $INSTDIR\uninstall.exe $0<br />
      ExecWait '"$0" update _?=$INSTDIR'</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">jcagle</span><br />
      <span class="post-time small text-muted">25th July 2003 14:07 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Cool, that actually makes sense to me!?!?!?! (I'm new, if you can't tell) :D<br />
      <br />
      Is GetTempFilename a built-in function, or is it a function I must put in my script?<br />
      <br />
      Thanks so much!!</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
      <span class="post-time small text-muted">25th July 2003 14:16 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">GetTempFileName is a built-in instruction. Functions that are not built-in are called using the Call instruction. For example:<br />
      <br />
      Call myFunction<br />
      <br />
      Another possibility of something that's not built-in is plug-ins. For example:<br />
      <br />
      PluginName::FunctionName</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
      <span class="post-time small text-muted">25th July 2003 14:23 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">There are all the cool functions and plugins on the NSIS Archive:<br />
      <a href="http://nsis.sourceforge.net/archive" target="_blank">http://nsis.sourceforge.net/archive</a><br />
      <br />
      -Stu :)</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">superwan</span><br />
      <span class="post-time small text-muted">31st January 2005 18:10 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">hello... I'm sorry to "up" this topic, but I don't understand it really...<br />
      <br />
      this is my code :<br />
      <br /></p>
      <pre>
<code><br />SetOutPath "$TEMP"<br />        WriteUninstaller "$TEMP\setup_KTV_tmp.exe"<br /><br />;écrit dans le KTVsetup.ini qu'il est en train d'installer<br /><br /><br />        WriteIniStr "$TEMP\KTVsetup.ini" "setup" "type" "install"<br /><br />;Lance le désinstalleur en fenêtre, cache l'autre fenêtre (qui de toute façon est déjà cachée avec le silentinstall silent)<br /><br />        HideWindow<br />        ClearErrors<br />        ExecWait '$TEMP\setup_KTV_tmp.exe _?=$TEMP'<br />        IfErrors no_remove_uninstaller<br />        ReadRegStr $0 HKLM Software\K!TV ""<br />        StrCpy $INSTDIR "$0"<br />        SetOutPath $INSTDIR<br />        WriteUninstaller "$INSTDIR\UninstKTV.exe"<br />        BringToFront<br /><br />no_remove_uninstaller:<br />        Delete "$TEMP\setup_KTV_tmp.exe"</code>
</pre><br />
      <br />
      and my execwait doesn't wait :L<br />
      <br />
      <br />
      where is my error ?<br />
      <br />
      thx for your answers ;)
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">superwan</span><br />
      <span class="post-time small text-muted">31st January 2005 18:17 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">sorry....<br />
      <br />
      <br />
      this works :) :<br />
      <br />
      <br />
      ExecWait '"$TEMP\setup_KTV_tmp.exe" _?=$TEMP'<br />
      <br />
      <br />
      <br />
      (quoting problem)<br />
      (i'm really dumb :D )</p>
    </div>
    <hr />

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]>
  </script>
</body>
</html>
