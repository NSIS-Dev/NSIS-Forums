<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="description" content="file association"><title>file association - NSIS Forums</title><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script><link rel="preload" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css" as="style" onload="this.rel='stylesheet'"><link rel="preload" href="../css/style.css" as="style" onload="this.rel='stylesheet'"><noscript><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css"><link rel="stylesheet" href="../css/style.css"></noscript><script>!function(a){"use strict";var b=function(b,c,d){function e(a){return h.body?a():void setTimeout(function(){e(a)})}function f(){i.addEventListener&&i.removeEventListener("load",f),i.media=d||"all"}var g,h=a.document,i=h.createElement("link");if(c)g=c;else{var j=(h.body||h.getElementsByTagName("head")[0]).childNodes;g=j[j.length-1]}var k=h.styleSheets;i.rel="stylesheet",i.href=b,i.media="only x",e(function(){g.parentNode.insertBefore(i,c?g:g.nextSibling)});var l=function(a){for(var b=i.href,c=k.length;c--;)if(k[c].href===b)return a();setTimeout(function(){l(a)})};return i.addEventListener&&i.addEventListener("load",f),i.onloadcssdefined=l,l(f),i};"undefined"!=typeof exports?exports.loadCSS=b:a.loadCSS=b}("undefined"!=typeof global?global:this);!function(a){if(a.loadCSS){var b=loadCSS.relpreload={};if(b.support=function(){try{return a.document.createElement("link").relList.supports("preload")}catch(b){return!1}},b.poly=function(){for(var b=a.document.getElementsByTagName("link"),c=0;c<b.length;c++){var d=b[c];"preload"===d.rel&&"style"===d.getAttribute("as")&&(a.loadCSS(d.href,d,d.getAttribute("media")),d.rel=null)}},!b.support()){b.poly();var c=a.setInterval(b.poly,300);a.addEventListener&&a.addEventListener("load",function(){b.poly(),a.clearInterval(c)}),a.attachEvent&&a.attachEvent("onload",function(){a.clearInterval(c)})}}}(this);</script></head><body><div class="container"><ol class="breadcrumb"><li><a href="../index.html" class="glyphicon glyphicon-home"></a></li><li><a href="f-65.html">NSIS Discussion</a></li><li class="active">file association</li></ol><p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=136888">file association</a></p><br><div class="post"><p class="post-meta"><span class="post-author text-primary">o_owd</span><br><span class="post-time small text-muted">28th May 2003 10:50 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>file association</strong><br>hi!<br><br>actualy i have 4 questions:<br><br>1. i need to make multiple file associations. does anyone know how? and how do i UNassociate at uninstall?<br><br>2. how to make if win9x is installed o install file1 and if win2000, winxp is installed, to install file2?<br><br>3. can i make (i did not tried yet this one !) a custom page to display something like this with a chekbox : "associate .123 files with file1.exe"?<br><br>4. i am a bit confused. i have 6 sections at install. but at uninstall there is only one section. right?<br>if the user selects only 2 sections at install, NSIS knows that were selected only 2 sections? because if not, that means it deletes a lot of files that are not mine. (sorry for bad english). or if i am wrong, please tell me how to correct this.<br><br>thanks.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">kichik</span><br><span class="post-time small text-muted">28th May 2003 13:28 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">1. Examples\makensis.nsi associates file extensions, you can use it as an example.<br><br>2. Use <a href="http://nsis.sourceforge.net/Docs/AppendixB.html#B.5" target="_blank">GetWindowsVersion</a>.<br><br>3. Use InstallOptions to display custom made pages. See Examples\Modern UI\InstallOptions.nsi if using the MUI or Contrib\InstallOptions\test.nsi if not.<br><br>4. The uninstaller doesn't remember the sections choosen in the installer. If you need to know exactly which sections where choosen you can write the selection (using GetSectionFlags to find out if they were selected) to an INI file or the registry and then read those values at uninstall time.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">o_owd</span><br><span class="post-time small text-muted">29th May 2003 06:54 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">question 1 is ok. i associated the extensions.<br>question 2 - working now.<br>question 3 is ok. i creted my custom page. the user can associate file extensions with a program.<br>question 4 - not yet.<br><br>but i have to combine q1 with q3. how can i do this: the custom page to be displayed only if a section from the installer has been selected ? and how to associate the file extensions only if the checkbox from the custom page has been selected ?<br><br><br><br>another question. can anyone tell me was this lines mean (from the .ini file required for the custom page):<br>Left=0 - space from the left side. right ?<br>Right=-1 - ???<br>Top=0 - ???<br>Bottom=10 - ???<br><br>thanks.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">kichik</span><br><span class="post-time small text-muted">29th May 2003 10:12 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">To skip a page according to section selection see:<br><a href="http://forums.winamp.com/showthread.php?s=&amp;threadid=126317&amp;highlight=custom+page+section" target="_blank">http://forums.winamp.com/showthread....m+page+section</a><br><br>To read the values entered by the user in the custom page see one of the InstallOptions examples.<br><br>Left, Right, Top and Bottom define a rectangle in which the control will be created. Left and Right values are distances from the left side of the page, Top and Bottom are the distances from the top side of the page. If the value is negative it's the distance from the oppsite side. For example, Right is -1 in your example so it's distance from the left side of the page will be PageWidth - 1.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">o_owd</span><br><span class="post-time small text-muted">29th May 2003 16:01 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">hello again!<br><br>i changed my code as is "Contrib\InstallOptions\test.nsi" and the file extension association does not work. i can't see what is wrong, so i attach the function. help! please !<br><br>PS: 1. i opened regedit.exe and look for ".xvid" extension. it does not exist in registry<br>2. the state of the checkbox is "1" (default in .ini file)</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">kichik</span><br><span class="post-time small text-muted">29th May 2003 16:10 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">I can tell much without the whole code but I bet it just doesn't find Tasks.ini. Specify a full path as in the example - $PLUGINSDIR\test.ini (assuming you've extracted it to the $PLUGINSDIR). I also think it'll be a better idea to put this code in a section so it will only register the file type if the user actually got to installation step.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">o_owd</span><br><span class="post-time small text-muted">29th May 2003 16:22 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">thanks very much for super fast response, kichik !<br><br>i changed the code as you said and it works. but what does $PLUGINSDIR mean ?<br>let me rephrase : where would be my file extracted ? in a temp directory ?<br><br>about the question with the uninstall section, can you point me to an example ?<br><br>thanks again.!</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">kichik</span><br><span class="post-time small text-muted">29th May 2003 17:49 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">$PLUGINSDIR is a special directory for plug-in used by NSIS and other temporary files used by the installer. It's directory name is random but it's always in the temporary directory.<br><br>Hmm... Example of what? Of writing the section selection into an INI file? If that's the case all you need is:<br><br>SectionGetFlags ${sectionDefinedName} $0<br>IntOp $0 $0 &amp; ${SF_SELECTED}<br>WriteIniStr myFile.ini uninstallSection section1 $0<br><br>for every section you have. It will write 1 if the section is selected and 0 if it's not.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">kichik</span><br><span class="post-time small text-muted">29th May 2003 17:49 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">You can also write a value to the ini file in the end of each section. It will only be written if that section executed which means it was selected.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">o_owd</span><br><span class="post-time small text-muted">2nd June 2003 11:33 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">hello again, is tried with this example<br><br></p><blockquote><i>Originally posted by kichik</i><br><b>SectionGetFlags ${sectionDefinedName} $0<br>IntOp $0 $0 &amp; ${SF_SELECTED}<br>WriteIniStr myFile.ini uninstallSection section1 $0<br><br>for every section you have. It will write 1 if the section is selected and 0 if it's not.</b></blockquote>i have no errors and no warnings, but "1" is not written to file. the path is correct. i put the code in "Section -post" of the installer.<br>how do the ini file should look like ?<br>mine is like this:<br><br>[uninstallSection]<br><br>section1=0<br>section2=0<br>section3=0<br>section4=0<br>section5=0<br>section6=0<br><br>sorry for all the (probably) stupid questions.<br><br>thanks.</div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">kichik</span><br><span class="post-time small text-muted">2nd June 2003 13:38 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Do all of the defines (${sectionDefinedName}) have the right value or are they all zero?<br><br>Don't worry about asking, ask until you understand.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">o_owd</span><br><span class="post-time small text-muted">2nd June 2003 13:51 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">the script is already attached in<br><br><a href="http://forums.winamp.com/showthread.php?s=&amp;threadid=136925" target="_blank">http://forums.winamp.com/showthread....hreadid=136925</a><br><br>i attach the ini file to.<br><br>nothing changes in it. everything remains with "=0".<br><br>thanks for helping.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">kichik</span><br><span class="post-time small text-muted">2nd June 2003 13:57 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">You should not extract a default INI file but let the code create it for you. You must inlcude the code above for every section in the script, not just the first section. If it still doesn't work try giving a full path to WriteIniStr ($INSTDIR\install.ini).</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">o_owd</span><br><span class="post-time small text-muted">2nd June 2003 14:59 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">ok. it works. the uninstall part too. it's ok. thanks very much.</p></div><hr><div class="footer"><p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p></div></div><script type="text/javascript" src="../js/highlight.pack.js" async></script><script type="text/javascript">//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]></script></body></html>