<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="Screensize" />

  <title>Screensize - NSIS Forums</title><!-- Bootstrap core CSS -->
  <link rel="stylesheet" type="text/css" href="//netdna.bootstrapcdn.com/bootswatch/3.0.1/readable/bootstrap.min.css" />
  <link rel="stylesheet" href="../css/style.css" type="text/css" /><!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!--[if lt IE 9]>
                <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
                <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->
</head>

<body>
  <div class="container">
    <!-- Put navigation bar here -->

    <ol class="breadcrumb">
      <li><a href="../index.html" class="glyphicon glyphicon-home"></a></li>

      <li><a href="f-65.html">NSIS Discussion</a></li>

      <li class="active">Screensize</li>
    </ol>

    <p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=79049">Screensize</a></p><br />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Smile2Me</span><br />
      <span class="post-time small text-muted">12th March 2002 15:39 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>Screensize</strong><br />
      Hi, doe anyone know where to find the screensize of Windows?<br />
      (So 800x600, 1024x768, 1280x1024, ...)<br />
      <br />
      Thx, greetz,<br />
      -Hendri.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">0mar</span><br />
      <span class="post-time small text-muted">12th March 2002 18:21 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Hey Hendri.<br />
      <br />
      I certainly hope the following info. helps you - I really appreciate all the info. you have provided on this forum. :)<br />
      <br />
      Anyway, on a win98 machine with multiple users this is what I found:<br />
      <br />
      The desktop size is stored in a 'Resolution' string in:<br />
      HKEY_CURRENT_USER\Display\Settings<br />
      HKEY_LOCAL_MACHINE\Config\0001\Display\Settings<br />
      HKEY_USERS\crashbox\Display\Settings<br />
      HKEY_CURRENT_CONFIG\Display\Settings<br />
      <br />
      I think the HKEY_CURRENT_USER\Display\Settings Resolution key is the most useful one since it will be valid at installation time...<br />
      <br />
      I hope a similar key exists under NT-based platforms. I can't verify that until the evening though - if no one else has checked under NT, I will do so and let you know tonight.<br />
      <br />
      Take care,<br />
      <br />
      Omar</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Smile2Me</span><br />
      <span class="post-time small text-muted">12th March 2002 19:52 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Hi Omar,<br />
      <br /></p>

      <blockquote>
        I certainly hope the following info. helps you - I really appreciate all the info. you have provided on this forum.
      </blockquote>Thx a lot for the nice words.:)<br />
      <br />
      The keys you found are a part of the solution. I cannot verify it, but I believe you're right. My problem: I cannot find similar keys on my Win2k machine. So I really appreciate if you would let me know if you find something for NT/2K.<br />
      <br />
      Thx a lot in advance, greetz from Holland,<br />
      Hendri.
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Smile2Me</span><br />
      <span class="post-time small text-muted">12th March 2002 20:04 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Hi Omar,<br />
      <br />
      using your keyword "Resolution" I found the following key:<br />
      HKEY_CURRENT_CONFIG\System\CurrentControlSet\SERVICES\SISV\DEVICE0<br />
      <br />
      Do you think this will work in general on any Windows machine. I think it will work for different users on a Win2K machine, but what about win98, winNt. Could you please check this?<br />
      <br />
      Thx a lot! Greetz,<br />
      Hendri.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">0mar</span><br />
      <span class="post-time small text-muted">12th March 2002 20:22 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Hi Hendri. :)<br />
      <br />
      I'm sorry, the key you mentioned:<br />
      HKEY_CURRENT_CONFIG\System\CurrentControlSet\SERVICES\SISV\DEVICE0<br />
      <br />
      doesn't exist in '98 - It goes as far as:<br />
      HKEY_CURRENT_CONFIG\System\CurrentControlSet<br />
      <br />
      But contains no SERVICES subkey. :(<br />
      <br />
      Maybe it's not so bad though - if<br />
      HKEY_CURRENT_USER\Display\Settings with the 'Resolution' key contains res. info on 9x, and<br />
      HKEY_CURRENT_CONFIG\System\CurrentControlSet\SERVICES\SISV\DEVICE0 contains res. info on NT/2k/XP, then all you have to do is check the OS.<br />
      <br />
      If it's 9x, get the resolution from HKEY_CURRENT_USER\Display\Settings, otherwise from HKEY_CURRENT_CONFIG\System\CurrentControlSet\SERVICES\SISV\DEVICE0<br />
      <br />
      Hopefully that would work, provided we can be sure those keys will definitely exist in the respective operating systems.<br />
      <br />
      Hope that works! :D</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">0mar</span><br />
      <span class="post-time small text-muted">12th March 2002 20:50 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Hey Hendri.<br />
      <br />
      I just wanted to clarify that I can only test on 98, 2k, and XP, not NT.<br />
      <br />
      But I did find some info. on NT which leads me to believe that you won't have any problems on NT.<br />
      <br />
      At <a href="http://www.robvanderwoude.com/ntregistry.html" target="_blank">this site</a> you will find many useful batch files, for example batch files that display resolution information. The batch files are using regedit to read resolution information from:<br />
      HKEY_CURRENT_CONFIG\System\CurrentControlSet\Services<br />
      <br />
      I'm attaching the relevant batch file in case you're interested.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">0mar</span><br />
      <span class="post-time small text-muted">13th March 2002 01:48 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Hmm bad news - on XP HKEY_CURRENT_CONFIG\System\CurrentControlSet\SERVICES\SISV\DEVICE0 doesn't exist. It's fine up to SERVICES, but there's no SISV subkey. :(</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Smile2Me</span><br />
      <span class="post-time small text-muted">13th March 2002 07:53 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Hi Omar,<br />
      <br />
      thx for all the effort. I think this is going to be a hell of a job. I just wanted to know the resolution to install some wallpaper for windows. I have three formats of the picture and wanted to automate the installation. But it seems a rather difficult job (determine OS first then some functions for each OS...) The batch file you posted does work, but only for NT 4...<br />
      <br />
      Another idea: ReadEnvStr<br />
      Does you know if this will work?<br />
      <br />
      Otherwise I will create an installer using InstOpts to select the proper wallpaper.<br />
      <br />
      But I would really like to automate this...<br />
      <br />
      Thx again Omar,<br />
      I'll also check MSDN, maybe they have an idea.<br />
      <br />
      Greetz, Hendri.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">0mar</span><br />
      <span class="post-time small text-muted">13th March 2002 14:57 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Hi Hendri.<br />
      <br />
      This is unfortunate indeed. It's really odd - I would have thought that information on desktop resolution would be stored at some sensible place in the registry. At the very least I thought it would be in a certain key on 9x, and a certain key on NT/2k/XP, but that doesn't seem to be the case - unless I'm missing something. ;)<br />
      <br />
      RedEnvStr - this won't work on 9x, there's no resolution info. in the default 9x environment variables. I don't think that NT/2k/XP env. vars. have such info. either.<br />
      <br />
      It really is a pity, you might have to settle for using InstallOpts - thank goodness that we at least have that! :)<br />
      <br />
      Checking MSDN sounds like a good idea. :up:</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Smile2Me</span><br />
      <span class="post-time small text-muted">14th March 2002 07:42 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Nothing found on MSDN...<br />
      <br />
      I decided to supply a zip-file instead, since it also seemed insufficient to change reg settings to a new wallpaper and refreshing the desktop. It will not load the new desktop. So reboot would be needed to change the desktop wallpaper. But I don't want to do that. So the user will need to install the background itself...<br />
      <br />
      Anyone an idea about loading the new wallpaper???<br />
      <br />
      Thx, greetz,<br />
      Hendri.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
      <span class="post-time small text-muted">14th March 2002 14:41 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Hi Hendri!<br />
      <br />
      Try using Window's API function SystemParametersInfo (with an external DLL) with SPI_SETGRIDGRANULARITY and SPI_SETDESKWALLPAPER. I think it should work.<br />
      <br />
      KiCHiK</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Smile2Me</span><br />
      <span class="post-time small text-muted">14th March 2002 17:34 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Hi KiCHiK,<br />
      <br />
      thx for the idea. But I cannot implement it because i've never heard of this. Is this possible using Delphi?<br />
      <br />
      Thx, Hendri.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
      <span class="post-time small text-muted">14th March 2002 17:41 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">I think you can... I don't really know Delphi, but I have seen some source codes of it, and I think I saw Window's API calls. Search MSDN for this API call for more information.<br />
      <br />
      KiCHiK</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Smile2Me</span><br />
      <span class="post-time small text-muted">15th March 2002 10:01 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">I found that screen.width in Delphi will give the width of the desktop screen. But I couldn't find anything about setting the wallpaper. BTW, I have delphi 4.<br />
      <br />
      Does anyone know how to do this in Delphi?<br />
      <br />
      Thx, greetz,<br />
      Hendri.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
      <span class="post-time small text-muted">15th March 2002 10:58 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Here is a FAQ about using Win32 API with Delphi:<br />
      <a href="http://www.used-disks.com/Programming/Pascal/FAQ/WinAPI/" target="_blank">http://www.used-disks.com/Programmin...al/FAQ/WinAPI/</a><br />
      <br />
      It even has the code you need :)<br />
      <br />
      KiCHiK</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">plaztic</span><br />
      <span class="post-time small text-muted">15th March 2002 11:19 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"></p>

      <blockquote>
        using your keyword "Resolution" I found the following key: HKEY_CURRENT_CONFIG\System\CurrentControlSet\SERVICES\SISV\DEVICE0
      </blockquote>Problem is that SISV is the gfxcard used in the system.<br />
      If you look at another computer that have another card, SISV would be<br />
      exchanged by something else, ie:<br />
      <br />
      I81X\DEVICE0 # for example, Intel 81x gfx card<br />
      S3SAVAGE4\DEVICE0<br />
      TRID3D\DEVICE0<br />
      VGASAVE\DEVICE0<br />
      <br />
      Below is the values I guess you want to extract from the registry.<br />
      <br />
      Name Type Data<br />
      ---------------------------------------------------------------------<br />
      DefaultSettings.BitsPerPel reg_dword 0x00000018 (24)<br />
      DefaultSettings.VRefresh reg_dword 0x00000055 (85)<br />
      DefaultSettings.XResolution reg_dword 0x00000400 (1024)<br />
      DefaultSettings.YResolution reg_dword 0x00000300 (768)<br />
      ---------------------------------------------------------------------<br />
      <br />
      This states that the gfxcard is running in 1024*768, 24 Bits colors and a refresh frequency of 85 Hertz<br />
      <br />
      If you use a computer that was made with Sysprep and Ghost, you would probably end up with more than one gfx card. And it would be difficult to determine which card that is the right one. I dont know where to look in the registry for the default gfx for the current computer, but I guess someone on this forum knows ..<br />
      <br />
      Good luck ..<br />
      <br />
      \plaz
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Smile2Me</span><br />
      <span class="post-time small text-muted">15th March 2002 11:25 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Thx KiCHik, that's really helpfull!<br />
      <br />
      Together with info at MSDN i'll try to set the wallpaper. But I don't know if this will also refresh the desktop and load the new wallpaper or that a reboot is required, but I will find out when programming this thing!<br />
      <br />
      Thx plaz for your post, your right, i wanted to use these regkeys, but they will indeed not always exist...<br />
      <br />
      I'm trying to build a dll now to overcome the problem.<br />
      <br />
      I'll post my findings here.<br />
      Thx to you all!!!<br />
      <br />
      Greetz, Hendri.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Smile2Me</span><br />
      <span class="post-time small text-muted">17th March 2002 08:41 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Hi all,<br />
      <br />
      KiCHiK, you're solution seemed not to work when ActiveDesktop is Active (:)). And my program, which should be installed to be able to install the wallpaper, uses ActiveDesktop, so this wouldn't work unfortunately. So I went to a Borland Newsgroup and I found out another solution to set colors and background wallpaper using Delphi. The installer really works great now.<br />
      <br />
      Thx for your help! Omar and Plaz, also thx for your ideas!<br />
      <br />
      BTW, I created ToDoList entirely using NSIS!!!<br />
      Interested in ToDoList? Take a look at my homepage:<br />
      <a href="http://home.hetnet.nl/~HendriAdriaens" target="_blank">http://home.hetnet.nl/~HendriAdriaens</a><br />
      <br />
      <br />
      Greetz, Hendri.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">eccles</span><br />
      <span class="post-time small text-muted">17th March 2002 11:23 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Hey Hendri, ToDoList is very nice! It's amazing what can be done with NSIS! :)<br />
      <br />
      Just one small problem I have though - the text colour of the ToDoList page merges in with the background (dark blue) so I can't see it. I notice it uses the current desktop colour for the background colour, but how does it decide what colour to use for text?<br />
      <br />
      --<br />
      Dave.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">eccles</span><br />
      <span class="post-time small text-muted">17th March 2002 11:33 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Mmm, actually, the Run and Info pages have the orange background.<br />
      <br />
      Should the ToDoList page be the same?<br />
      <br />
      btw, this is in an IE window, not on the desktop - if that could be a cause...<br />
      <br />
      Just noticed TDLBack too... btw, my desktop is 1152x864 ;)<br />
      <br />
      --<br />
      Dave.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Smile2Me</span><br />
      <span class="post-time small text-muted">17th March 2002 17:29 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Thx Dave,<br />
      <br />
      nice you tried ToDoList. The idea behind the colors is the following: normally, ToDoList will be at the desktop and it should be not too offencive in color. That's why it will take background color. The other pages on the contrary are only temporary on the desktop, so I wanted to create something that would last in memory :) Just my homepage style... :) But it can be adapted, just plain html files with some javascript code.<br />
      <br />
      About the text color: this can be changed permanently in head.txt. These are the declarations used to build todolist.html which is on the active desktop. In a later version I will try to customize this during install to the standard text color or some other windows color. Thx for the comment!!!<br />
      <br />
      About the desktop resolution. Just resize your desktop ;) No kidding, you can use 1280x1024, but then ToDoList will have to be rescaled a bit to integrate it in the desktop. The problem here is, that the wallpaper can be scaled (in principle) but the HTML not (scaling is depending on fontsize). That's why the area for ToDoList is the same size (in pixels) in every version of TDLBack. I'll try to come up with a scalable HTML...<br />
      <br />
      <br />
      Thx for the comments again, thx for the nice words,<br />
      greetz, Hendri.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Smile2Me</span><br />
      <span class="post-time small text-muted">18th March 2002 17:26 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">But if you Dave or anyone else has ideas for ToDoList i'm happy to receive them at my e-mail address.<br />
      <br />
      In particular, if you have ideas about scaling the HTML, this would be great, because for 800x600 the HTML is actually too big and for 1280x1024 it's too small, it's optimal for 1024x768...<br />
      <br />
      Thx, greetz,<br />
      Hendri.</p>
    </div>
    <hr />

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]>
  </script>
</body>
</html>
