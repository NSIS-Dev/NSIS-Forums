<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="description" content="How can I resolve Sign error 0x800700C1 when signing an uninstaller?"><title>How can I resolve Sign error 0x800700C1 when signing an uninstaller? - NSIS Forums</title><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script><link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css"><link rel="stylesheet" href="../css/style.css" type="text/css"></head><body><div class="container"><ol class="breadcrumb"><li><a href="../index.html" class="glyphicon glyphicon-home"></a></li><li><a href="f-65.html">NSIS Discussion</a></li><li class="active">How can I resolve Sign error 0x800700C1 when signing an uninstaller?</li></ol><p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=344726">How can I resolve Sign error 0x800700C1 when signing an uninstaller?</a></p><br><div class="post"><p class="post-meta"><span class="post-author text-primary">gencha</span><br><span class="post-time small text-muted">8th May 2012 22:36 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>How can I resolve Sign error 0x800700C1 when signing an uninstaller?</strong><br>I was just looking into signing our installer/uninstaller and read this wiki article: <a href="http://nsis.sourceforge.net/Signing_an_Uninstaller" target="_blank">http://nsis.sourceforge.net/Signing_an_Uninstaller</a><br><br>Everything seemed to go well until it comes to signing the actual uninstaller:<br><br></p><blockquote>!system: ""C:\Program Files\Microsoft SDKs\Windows\v7.1\Bin\signtool.exe" sign /f "X:\ssl\code\y.pfx" /p abcdef /t "http://timestamp" "C:\Users\y\AppData\Local\Temp\uninstaller.exe""<br>Done Adding Additional Store<br><br>Number of errors: 1<br><br>SignTool Error: SignedCode::Sign returned error: 0x800700C1<br><br>Either the file being signed or one of the DLL specified by /j switch is not a valid Win32 application.<br><br>SignTool Error: An error occurred while attempting to sign: C:\Users\y\AppData\Local\Temp\uninstaller.exe<br><br>!system: returned 1</blockquote>But there is nothing wrong with that uninstaller. I can execute it just fine (so I'm quite certain it's a valid Win32 application).<br><br>Is the approach outlined in that article still correct?</div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br><span class="post-time small text-muted">8th May 2012 22:52 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">That means "The parameter is incorrect". Try writing the uninstaller elsewhere.<br><br>Stu</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">gencha</span><br><span class="post-time small text-muted">8th May 2012 22:59 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">I think it just resolved itself.<br><br>I won't claim that I understand it, but I think the issue was related to switching compression on and off during the build process.<br>Most likely, the way I use the code from the article isn't optimal (to say the least) and this caused problems.<br><br>I now enable whole LZMA compression at the beginning of the build process and just keep it. Even though the build takes forever :P</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">isawen</span><br><span class="post-time small text-muted">19th June 2012 23:02 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>Uninstaller comming from a signed installer cannot be signed</strong><br>Hi guys,<br><br>It appears that if you try to sign the uninstaller belonging to a signed installer you will get the same exception..<br>Isn't that strange?<br><br>Thanks,<br>Isa</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">stephench</span><br><span class="post-time small text-muted">15th August 2012 00:25 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">I am getting the same error when I attempt to sign uninst.exe. The error persists even if I turn off compression completely.<br><br>My guess is when nullsoft installer dynamically patches the uninst.exe file, it somehow violates some non-critical rule of win32 exe format which doesn't affect correction executation of the file. But it is not able to pass the exe format validation performed by the signtool.exe file from Microsoft Platform SDK.<br><br>Does anybody have a better idea what might go wrong?</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br><span class="post-time small text-muted">15th August 2012 00:35 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">I've not had any issues signing uninstall executables. How are you going about it? You need to:<br><br>1. Write a standalone script which generates the uninstaller.<br>2. Build it and run the built executable to generate the uninstaller.<br>3. Sign the generated uninstaller.<br>4. Bundle it in the main installer.<br><br>I wasn't aware there was any other way so you are probably already doing this?<br><br>Stu</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">stephench</span><br><span class="post-time small text-muted">15th August 2012 02:19 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">I didn't attempt to create the fully automatic flow yet. I just use the original script to generate the installer, install it manually to get the file uninst.exe. Then I tried to sign the uninst.exe file manually and got this error. I do use the unicode version of the installer instead of the ansi version.<br><br>I noticed in your earlier reply saying "Try writing the uninstaller elsewhere". How does the location of the uninstaller matter in this case?<br><br><br></p><blockquote><small>Originally posted by Afrow UK</small><br>I've not had any issues signing uninstall executables. How are you going about it? You need to:<br><br>1. Write a standalone script which generates the uninstaller.<br>2. Build it and run the built executable to generate the uninstaller.<br>3. Sign the generated uninstaller.<br>4. Bundle it in the main installer.<br><br>I wasn't aware there was any other way so you are probably already doing this?<br><br>Stu</blockquote></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Anders</span><br><span class="post-time small text-muted">15th August 2012 06:26 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><a href="http://social.msdn.microsoft.com/Forums/en-US/wdk/thread/158b5381-f257-4076-83ca-db71cd8a323b/" target="_blank">http://social.msdn.microsoft.com/For...-db71cd8a323b/</a> ?</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">n1ghtv1s1on</span><br><span class="post-time small text-muted">16th November 2012 18:34 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">I ran across this post from a Google search because I was having the same problem signing an uninstaller from Bitrock Install Builder. This was my solution:<br><br>1.) Build an unsigned installer<br>2.) Install that unsigned installer on your machine<br>3.) Sign the resultant uninstall.exe<br>4.) Package it with your distribution<br>5.) Build the signed installer<br><br>BitRock instructions for packaging and deploying are here if anybody is interested:<br><a href="http://answers.bitrock.com/questions/720/how-can-i-add-digital-signature-to-uninstaller-on-windows" target="_blank">http://answers.bitrock.com/questions...ler-on-windows</a></p></div><hr><div class="footer"><p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p></div></div><script src="../js/highlight.pack.js" type="text/javascript"></script><script type="text/javascript">//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]></script></body></html>