<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="description" content="SP2 Firewall in WinXP"><title>SP2 Firewall in WinXP - NSIS Forums</title><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script><link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css"><link rel="stylesheet" href="../css/style.css" type="text/css"></head><body><div class="container"><ol class="breadcrumb"><li><a href="../index.html" class="glyphicon glyphicon-home"></a></li><li><a href="f-65.html">NSIS Discussion</a></li><li class="active">SP2 Firewall in WinXP</li></ol><p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=190727">SP2 Firewall in WinXP</a></p><br><div class="post"><p class="post-meta"><span class="post-author text-primary">lars1106</span><br><span class="post-time small text-muted">20th August 2004 09:00 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>SP2 Firewall in WinXP</strong><br>I noticed yesterday when I installed "Groove" [<a href="http://www.groove.net" target="_blank">http://www.groove.net</a>] that during the installation, the installation kit (InstallShield) that this interacted with the new firewall in XP.<br>this means that the installer unblocked this program during installation. I think this is a very good feature, since users do not by accident block a program that needs certain ports open.<br><br>I have in vain searched MSDN to find information to find information about this issue, so I could implement this in the NSIS installer.<br>Does anyone here know which information, and how to pass this on to the Firewall ???<br><br><br>Cheers,<br><br>Lars</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">kichik</span><br><span class="post-time small text-muted">20th August 2004 10:16 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Is the installer signed? Windows probably did this automatically if it is. I seriously doubt there is some way to disable the firewall for a specific program without some sort of approval from Microsoft. That would make the firewall pretty useless...</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">lars1106</span><br><span class="post-time small text-muted">20th August 2004 12:10 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>more info</strong><br>Hi<br>After posting question I found some more information. There exists an API for Windows firewall + you can use a command like:<br><br>netsh firewall set portopening TCP 445 ENABLE<br>or<br>netsh firewall add allowedprogram [program.exe]<br><br>I disagree with you in that this renders the firewall useless since this is done from within the secure side of the firewall.<br><br>Now I just have to find out how to run this from an NSIS script..<br><br>Cheers,<br>Lars</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">kichik</span><br><span class="post-time small text-muted">20th August 2004 12:16 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">I wouldn't call a program I didn't write the secure side of the firewall. What about trojans? Wouldn't you want to be notified when it tries to send your credit card number to the other side of the world?<br><br>To execute programs from NSIS use Exec, ExecWait, ExecShell or the nsExec plug-in.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">lars1106</span><br><span class="post-time small text-muted">20th August 2004 12:31 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>Trojan</strong><br>Well - I guess the idea is that the trojan will not be allowed in by the firewall in the first place. If it is in though for some reason it will be able to fire the "add allowed program" command.<br><br>Try to run this command from a prompt, then you will see the possibilities:<br>netsh firewall add allowedprogram<br><br>Thanks for your answer ;)</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">kichik</span><br><span class="post-time small text-muted">20th August 2004 12:35 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">A firewall is not an antivirus, it can not recognize you're downloading a trojan.<br><br>I don't have SP2 yet, so I can't test this.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">afrodan</span><br><span class="post-time small text-muted">20th August 2004 12:59 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"></p><blockquote><i>Originally posted by kichik</i><br><b>A firewall is not an antivirus, it can not recognize you're downloading a trojan.</b></blockquote>But the firewall is going to stop the trojan from listing on ports to be activated. It also askes if you would like to allow the progam that is accesing the net to get access to the net...</div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">kichik</span><br><span class="post-time small text-muted">20th August 2004 13:02 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">That's another story. I'm sure lars1106 doesn't want to distribute his installer this way.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">kichik</span><br><span class="post-time small text-muted">20th August 2004 13:03 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"></p><blockquote>It also askes if you would like to allow the progam that is accesing the net to get access to the net...</blockquote>Which is exactly what lars1106 is trying to avoid.</div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">afrodan</span><br><span class="post-time small text-muted">20th August 2004 13:06 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"></p><blockquote><i>Originally posted by kichik</i><br><b>Which is exactly what lars1106 is trying to avoid.</b></blockquote>He can't its micrsofts newest thing... that is what sp2 is about beffing up security</div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">lars1106</span><br><span class="post-time small text-muted">20th August 2004 13:10 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>I can´t ?</strong><br>Afro...Read the thread and if you have windows firewall then try to fire the command I mention.<br><br>Lars</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">kichik</span><br><span class="post-time small text-muted">20th August 2004 13:10 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Exactly. That's why I seriously doubt it's possible. However, lars1106 says that netsh can do the trick.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">lars1106</span><br><span class="post-time small text-muted">20th August 2004 13:21 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>Believe Microsoft :-)</strong><br>I you guys doesn´t believe me, maybe you belive Microsoft:<br><br><a href="http://support.microsoft.com/default.aspx?scid=kb;en-us;875357#13" target="_blank">Using Command line options</a><br><br>The more I think about this the more sense it makes. Imagine a netadmin controlling 1000´s of computers in for instance a bank, he has to have command line tools if the firewall is deployed locally as well<br><br>Cheers,<br>Lars</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">kichik</span><br><span class="post-time small text-muted">20th August 2004 13:23 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">It makes sense for an admin to have an option to allow a certain program, but it doesn't make sense for a program to allow itself.</p></div><hr><div class="footer"><p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p></div></div><script src="../js/highlight.pack.js" type="text/javascript"></script><script type="text/javascript">//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]></script></body></html>