<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="Single installer file(all files and dlls should go in a single installer file)" />

  <title>Single installer file(all files and dlls should go in a single installer file) - NSIS Forums</title><!-- Bootstrap core CSS -->
  <link rel="stylesheet" type="text/css" href="//netdna.bootstrapcdn.com/bootswatch/3.0.1/readable/bootstrap.min.css" />
  <link rel="stylesheet" href="../css/style.css" type="text/css" /><!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!--[if lt IE 9]>
                <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
                <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->
</head>

<body>
  <div class="container">
    <!-- Put navigation bar here -->

    <ol class="breadcrumb">
      <li><a href="../index.html" class="glyphicon glyphicon-home"></a></li>

      <li><a href="f-65.html">NSIS Discussion</a></li>

      <li class="active">Single installer file(all files and dlls should go in a single installer file)</li>
    </ol>

    <p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=301083">Single installer file(all files and dlls should go in a single installer file)</a></p><br />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">mmsajid</span><br />
      <span class="post-time small text-muted">15th December 2008 11:52 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>Single installer file(all files and dlls should go in a single installer file)</strong><br />
      Hi,<br />
      <br />
      I required to invoke a dll in my script and I can able to do that by using the below code.But it requires the dll to be in the same level as of the exe, i.e same folder should contain the dlls to be invoked and the .exe.<br />
      <br />
      Which should not be the case, as normally we should have only single exe.<br />
      <br />
      Can any body suggest how can I achieve this.<br />
      <br />
      ---------------------------------------------<br />
      InitPluginsDir<br />
      SetOutPath $PLUGINSDIR<br />
      File CLR.dll<br />
      File One.dll<br />
      File Two.dll<br />
      <br />
      Section<br />
      CLR::Call /NOUNLOAD "One.dll" "OneNamespace.OneClass" ".OneMethod"<br />
      pop $0<br />
      messagebox mb_ok $0<br />
      CLR::Destroy<br />
      ...<br />
      ...<br />
      <br />
      SectionEnd<br />
      -------------------------------------------<br />
      Regards,</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Animaether</span><br />
      <span class="post-time small text-muted">15th December 2008 12:10 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">There's no need for you to include / extract the plugin file yourself, NSIS will take care of that on the first call.<br />
      ( You do for the .NET assembly dlls, of course )<br />
      <br />
      After that, instead of "One.dll", try "$PLUGINSDIR\One.dll" as the parameter for CLR?</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">mmsajid</span><br />
      <span class="post-time small text-muted">15th December 2008 12:29 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Thanks Animaether,<br />
      <br />
      I tried as suggested, but throws below error.<br />
      ------------------------------<br />
      Error calling .NET DLL method<br />
      <br />
      The given path's format is not supported.<br />
      ------------------------------<br />
      <br />
      But I tried setting the path to $ExeDir and it works fine.<br />
      But it copies the dlls to the place where the executable is present.<br />
      <br />
      I can delete the dlls after the installation but I think it is not the good way of doing it.<br />
      <br />
      Iam sure there should be a better way for acheiving this.<br />
      Any suggestions will be appreciated.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Animaether</span><br />
      <span class="post-time small text-muted">15th December 2008 15:04 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">*eyes the CLR plugin*<br />
      quaint<br />
      <br />
      I just tried with the code from:<br />
      <a href="http://forums.winamp.com/showthread.php?postid=2402816#post2402816" target="_blank">http://forums.winamp.com/showthread....16#post2402816</a><br />
      ( ignore the VB code - just download the attachment )<br />
      <br />
      Does that sample code + the DLL work for you?<br />
      If it does - try substituting the "TestCLRDLL.dll" with your "One.dll", along with the actual .NET methods called. Does that still work?</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
      <span class="post-time small text-muted">15th December 2008 16:12 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">What is the . in front of your method name for?<br />
      <br />
      Stu</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">mmsajid</span><br />
      <span class="post-time small text-muted">17th December 2008 09:41 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Hi Stu,<br />
      <br />
      That was just a typo mistake. But it does not work even if we remove the dot(.).<br />
      <br />
      Thanks,</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">claesabrandt</span><br />
      <span class="post-time small text-muted">13th January 2009 13:41 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">mmsajid, I guess you are having problems calling .NET methods in other .NET dlls from your first .NET dll. The only way to do this is to wrap your installer in another installer. The first installer places the .NET dlls besides the second setup exe. The second setup makes the .NET calls. Now the DLL files can be found from the second installer while you will only be distributing one setup file.</p>
    </div>
    <hr />

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]>
  </script>
</body>
</html>
