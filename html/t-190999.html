<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="description" content="Why doesnt this command work?"><title>Why doesnt this command work? - NSIS Forums</title><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script><link rel="preload" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css" as="style" onload="this.rel='stylesheet'"><link rel="preload" href="../css/style.css" as="style" onload="this.rel='stylesheet'"><noscript><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css"><link rel="stylesheet" href="../css/style.css"></noscript><script>!function(a){"use strict";var b=function(b,c,d){function e(a){return h.body?a():void setTimeout(function(){e(a)})}function f(){i.addEventListener&&i.removeEventListener("load",f),i.media=d||"all"}var g,h=a.document,i=h.createElement("link");if(c)g=c;else{var j=(h.body||h.getElementsByTagName("head")[0]).childNodes;g=j[j.length-1]}var k=h.styleSheets;i.rel="stylesheet",i.href=b,i.media="only x",e(function(){g.parentNode.insertBefore(i,c?g:g.nextSibling)});var l=function(a){for(var b=i.href,c=k.length;c--;)if(k[c].href===b)return a();setTimeout(function(){l(a)})};return i.addEventListener&&i.addEventListener("load",f),i.onloadcssdefined=l,l(f),i};"undefined"!=typeof exports?exports.loadCSS=b:a.loadCSS=b}("undefined"!=typeof global?global:this);!function(a){if(a.loadCSS){var b=loadCSS.relpreload={};if(b.support=function(){try{return a.document.createElement("link").relList.supports("preload")}catch(b){return!1}},b.poly=function(){for(var b=a.document.getElementsByTagName("link"),c=0;c<b.length;c++){var d=b[c];"preload"===d.rel&&"style"===d.getAttribute("as")&&(a.loadCSS(d.href,d,d.getAttribute("media")),d.rel=null)}},!b.support()){b.poly();var c=a.setInterval(b.poly,300);a.addEventListener&&a.addEventListener("load",function(){b.poly(),a.clearInterval(c)}),a.attachEvent&&a.attachEvent("onload",function(){a.clearInterval(c)})}}}(this);</script></head><body><div class="container"><ol class="breadcrumb"><li><a href="../index.html" class="glyphicon glyphicon-home"></a></li><li><a href="f-65.html">NSIS Discussion</a></li><li class="active">Why doesnt this command work?</li></ol><p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=190999">Why doesnt this command work?</a></p><br><div class="post"><p class="post-meta"><span class="post-author text-primary">JiveMiguel</span><br><span class="post-time small text-muted">23rd August 2004 00:26 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>Why doesnt this command work?</strong><br>ExecWait 'cscript "$INSTDIR\helpers\sys.vbs" &gt; systemsummary.txt'<br><br>I have this command in my nsis script. The idea is to run the WSH script 'sys.vbs' and to send the output to the file systemsummary.txt, instead of the screen. That way, if the end user has a problem post-install, he or she can send me the file 'systemsummary.txt' and I can get an idea of how their system is configured, what services are running, etc.<br><br>As far as I can tell, the script is not executing and the text file isn't being created. The line right before this one is an execwait that runs a different WSH script, and it's working fine... Can anyone help me?<br><br>Thanks!</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br><span class="post-time small text-muted">23rd August 2004 01:01 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">You need to execute it under command prompt correct?<br>If so you need to include the path to COMSPEC (Dos command-line).<br><br>Something like this:<br><br>Push $R0<br>ReadEnvStr $R0 "COMSPEC"<br>ExecWait '$R0 cscript "$INSTDIR\helpers\sys.vbs" &gt; systemsummary.txt'<br>Pop $R0<br><br>You're also using a relative path to cscript. Is it in the shell, or shouldn't you supply the full path? Similarely, shouldn't you supply the full path for the output file?<br><br>Lastly, ExecWait will show a command window. You could use nsExec::Exec instead to hide it, and then display a status message with the Banner plugin.<br><br>-Stu</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">JiveMiguel</span><br><span class="post-time small text-muted">23rd August 2004 01:19 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Thanks for your response. First, i'll answer your questions:<br><br>Yes, I want this to execute under a command prompt. The Cscript exe should be in the system PATH var, so a relative path should be ok. As I said, I run other cscripts in this installer in the same way (no path specified) and they work. I've tried speccing an absolute path for the textfile, as well as the relative one shown in my post, and neither work. I'm not worried about showing the command window, as it's only visible for a half second (or so).<br><br>Your example didn't work. It simply opened a command window at the specified path, and waited for input. The installer only continued once I typed 'exit'.<br><br>It seems that my problem is related with sending the output to a textfile using the '&gt;' character.<br><br>Still confused... but thanks for your response.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">kichik</span><br><span class="post-time small text-muted">26th August 2004 21:25 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Add /C after $R0 in Afrow's example and it should work. If it doesn't, search the forum for examples. Try searching for 'MySQL'.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">JiveMiguel</span><br><span class="post-time small text-muted">26th August 2004 21:52 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>That worked</strong><br>Thanks. Your suggestion worked. I added the /C to the execwait line and it works as I'd expect it to.<br><br>Why does the /C make it work? I looked in the NSIS docs and can't figure it out. Am I modifying the execwait command with the /C or something else?<br><br>Thanks again,<br>- Greg</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">niteflyer</span><br><span class="post-time small text-muted">27th August 2004 16:39 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">/C does not modify ExecWait but COMSPEC.<br>Type cmd /? or command /? at the console to get help...</p></div><hr><div class="footer"><p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p></div></div><script type="text/javascript" src="../js/highlight.pack.js" async></script><script type="text/javascript">//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]></script></body></html>