<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="VB Runtimes" />

  <title>VB Runtimes - NSIS Forums</title>
  <script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script>
  <!-- Bootstrap core CSS -->

  <link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css" />
  <link rel="stylesheet" href="../css/style.css" type="text/css" /><!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!--[if lt IE 9]>
                <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
                <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->
</head>

<body>
  <div class="container">
    <!-- Put navigation bar here -->

    <ol class="breadcrumb">
      <li><a href="../index.html" class="glyphicon glyphicon-home"></a></li>

      <li><a href="f-65.html">NSIS Discussion</a></li>

      <li class="active">VB Runtimes</li>
    </ol>

    <p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=95728">VB Runtimes</a></p><br />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">HelluvaEngineer</span><br />
      <span class="post-time small text-muted">25th July 2002 21:57 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>VB Runtimes</strong><br />
      I'm trying to figure out the most seamless way to integrate the VB runtimes into my installation.<br />
      <br />
      I set it up so that it would launch the Microsoft installer using the "ExecWait /Q" option. That worked, but on machines that actually needed the update, it prompted to reboot. Even if I did this last, I would still prefer that the user not reboot in the middle of an installation. Perhaps I could wait till the end and just use "Exec", but then I can't clean up the temp file I extracted.<br />
      <br />
      What are my other options? Bundle the individual .DLLs and check versions on each to decide whether I should upgrade? I had even thought of creating a download link and launching that if the user needs the upgrade (thereby shrinking the install by 1 MB).<br />
      <br />
      Any advice? Thanks.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">DuaneJeffers</span><br />
      <span class="post-time small text-muted">26th July 2002 09:05 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Very Simple .... At the End of the install of your program, run the vbRuntimes installer. Have it something like (IF the installer is autoclose) running a pop saying the user needs to update and once the user clicks ok, then the installer for your program quits and launches the installer for the vbRuntimes. This is usually what games do for the upgrade of DirectX or OpenGL.<br />
      <br />
      -Duane</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">HelluvaEngineer</span><br />
      <span class="post-time small text-muted">26th July 2002 15:10 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Ok, I'm down with that plan. However, I see one glitch. How do I clean up the M$ executable, since the installer will have already exited? I would prefer to not leave ~1MB of junk in the $TEMP directory, unless there's no other way.<br />
      <br />
      EDIT: I just realized this won't work. I need to launch a VB app (an Audio Setup Wizard) before or immediately after the installer. It has a dependency on the VB runtimes. So, this would require launching the runtime installer first and THEN run the wizard.<br />
      <br /></p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Joost Verburg</span><br />
      <span class="post-time small text-muted">26th July 2002 15:33 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">You can also extract the VB runtimes from the file and install them using NSIS (with the UpgradeDLL macro).</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">HelluvaEngineer</span><br />
      <span class="post-time small text-muted">26th July 2002 19:04 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">I guess that's what I need to do, then. Do I need to bother with any of that Shared DLL registry stuff?</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Joost Verburg</span><br />
      <span class="post-time small text-muted">26th July 2002 21:11 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Yes, you should use the UpgradeDLL macro for upgrading the VB DLL's.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">By-Gones</span><br />
      <span class="post-time small text-muted">8th August 2002 01:00 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">I had the same vb-runtime-problem. Here's my solution:<br />
      <br />
      For the completly silent install of the vbrun60sp5.exe, you need the command line option /Q /R:N for the microsoft file so there is never a restart:<br />
      ExecWait "$INSTDIR\VBRUN60SP5.EXE /Q /R:N"<br />
      <br />
      After that, you can clean the temporary file.<br />
      Then, at the end of the installation, you call something like this:<br />
      MessageBox MB_YESNO|MB_ICONQUESTION "Do you want to restart Windows?" IDNO NoRestart<br />
      Reboot<br />
      NoRestart:<br />
      ...<br />
      <br />
      You also can call this in the .onInstSuccess - function, so it's really at the end.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Tscherno</span><br />
      <span class="post-time small text-muted">30th August 2002 06:33 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>Re: VB Runtimes</strong><br /></p>

      <blockquote>
        <i>Originally posted by HelluvaEngineer</i><br />
        <b>I had even thought of creating a download link and launching that if the user needs the upgrade (thereby shrinking the install by 1 MB).</b>
      </blockquote>This sounds very interesting. How could it be done?
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
      <span class="post-time small text-muted">30th August 2002 09:36 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Either use ExecShell "open" "http://www.whatever.com/downloadthis.exe" or just use NSIS-dl.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Tscherno</span><br />
      <span class="post-time small text-muted">30th August 2002 11:47 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">And how can I check if a specific version of the vb-runtime is installed?</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
      <span class="post-time small text-muted">30th August 2002 11:53 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Using GetDLLVersion or Sunjammer's SysDLL</p>
    </div>
    <hr />

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]>
  </script>
</body>
</html>
