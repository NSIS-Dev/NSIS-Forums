<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="Attempting to use installer to call another installer in Silent mode." />

  <title>Attempting to use installer to call another installer in Silent mode. - NSIS Forums</title><!-- Bootstrap core CSS -->
  <link rel="stylesheet" type="text/css" href="//netdna.bootstrapcdn.com/bootswatch/3.0.1/readable/bootstrap.min.css" />
  <link rel="stylesheet" href="../css/style.css" type="text/css" /><!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!--[if lt IE 9]>
                <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
                <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->
</head>

<body>
  <div class="container">
    <!-- Put navigation bar here -->

    <ol class="breadcrumb">
      <li><a href="../index.html" class="glyphicon glyphicon-home"></a></li>

      <li><a href="f-65.html">NSIS Discussion</a></li>

      <li class="active">Attempting to use installer to call another installer in Silent mode.</li>
    </ol>

    <p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=275936">Attempting to use installer to call another installer in Silent mode.</a></p><br />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Gato Muerto</span><br />
      <span class="post-time small text-muted">15th August 2007 02:50 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>Attempting to use installer to call another installer in Silent mode.</strong><br />
      The first installer will ask the user if they want to install the additional content, and on yes will call the second installer. No problem. However Boss says he wants it to work without user input. Easy enough, just slap an "/S" at the end of the nsExec::ExecToLog portion. The second installer works, but gives an error message at the end. The only clue I have is a blank messagebox with the word "Error", and an OK button. The program installs, but I am wondering what is causing the "Error" message.<br />
      <br />
      How do I isolate this, if I want the program to install silently within another program, but run normally if run without the original installer?<br />
      <br />
      There is supposed to be a log file, but that appears to not work correctly, either. I get the log file from the original installer, but not from the smaller sub-installer. No error messages in the regular log, so this appears to be a sub-installer issue.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">darthvader</span><br />
      <span class="post-time small text-muted">15th August 2007 04:00 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Can you check if the second sub installer installs correctly if you run it in silent mode without using it in the script?<br />
      <br />
      If this works fine then problem might be in the nsExec plugin try using ExecWait since i assume the sub installer is a windows application.<br />
      <br />
      If it does not work(throwing some errors) then the problem is in the sub installer.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Gato Muerto</span><br />
      <span class="post-time small text-muted">15th August 2007 18:06 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">/me kicks self.<br />
      Thanks, I should have thought of that...<br />
      <br />
      Just tried it, and yes, there is still an error. Any thoughts on how to obtain the error message while running in silent mode?</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">darthvader</span><br />
      <span class="post-time small text-muted">15th August 2007 18:24 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">I am assuming the second installer is NSIS Installer, since you were talking about /S switch.<br />
      <br />
      The most common problem with silent mode is you wouldnt have specified the inputs(/SD switch) for MessageBoxes in silent mode. Check if you have specified /SD switches to all messageboxes?<br />
      <br />
      I may not be right but just give it a shot.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">wacaveman</span><br />
      <span class="post-time small text-muted">15th August 2007 18:48 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">I do the silent install within installers all of the time. Just use the logging build, and send an installer.log to the install directory. As a suggestion, implement logging using the following macros, otherwise if you add logging, you won't be able to build again if you use the default compiler (IMHO, if this was in the standard build, it would make two separate NSIS compilers un-neccessary).<br />
      <br />
      !macro Logger What<br />
      !ifdef NSIS_CONFIG_LOG<br />
      LogSet "${What}"<br />
      !endif<br />
      !macroend<br />
      <br />
      !macro Log What<br />
      !ifdef NSIS_CONFIG_LOG<br />
      LogText "${What}"<br />
      !endif<br />
      !macroend<br />
      <br />
      Then, to turn it on:<br />
      !insertmacro Logger on<br />
      <br />
      And to log some text:<br />
      !insertmacro Log "About to install ${prodname}"<br />
      <br />
      Anyway, the logging build is the ONLY way to fly for debugging silent installs. Go to the downloads screen and look under special builds.<br />
      <br />
      -Kevin</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Gato Muerto</span><br />
      <span class="post-time small text-muted">15th August 2007 21:01 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">darthvader:<br />
      Part of my surprise is the secondary script (yes, NSIS) completely lacks any messagebox lines. What would cause a random "error" messagebox to appear when run in silent mode?<br />
      <br />
      Kevin:<br />
      Thanks for the suggestion about a logging build. I'll look into it. I am a little confused regarding: "you won't be able to build again if you use the default compiler"</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Gato Muerto</span><br />
      <span class="post-time small text-muted">16th August 2007 02:09 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Found there was an issue with the logging that I already had in the program. Found it by backtracking and commenting out sections until I found the culprit.<br />
      <br />
      Thanks for your suggestions.</p>
    </div>
    <hr />

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]>
  </script>
</body>
</html>
