<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="Change radiobutton in .oninit function" />

  <title>Change radiobutton in .oninit function - NSIS Forums</title>
  <script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script>
  <!-- Bootstrap core CSS -->

  <link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css" />
  <link rel="stylesheet" href="../css/style.css" type="text/css" /><!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!--[if lt IE 9]>
                <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
                <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->
</head>

<body>
  <div class="container">
    <!-- Put navigation bar here -->

    <ol class="breadcrumb">
      <li><a href="../index.html" class="glyphicon glyphicon-home"></a></li>

      <li><a href="f-65.html">NSIS Discussion</a></li>

      <li class="active">Change radiobutton in .oninit function</li>
    </ol>

    <p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=188418">Change radiobutton in .oninit function</a></p><br />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Satsuki</span><br />
      <span class="post-time small text-muted">31st July 2004 11:28 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>Change radiobutton in .oninit function</strong><br />
      Thank for this very good forum, i've learned a lot with it.<br />
      Sorry for my bad english, i'm not english native.<br />
      <br />
      so here's my problem:<br />
      in my scrip i use radiobutton in a .onselchange function:<br />
      <br />
      section $(SecHP20Name) hp20<br />
      WriteRegDWORD ....<br />
      WriteRegDWORD ....<br />
      sectionend<br />
      section /o $(SecHP21Name) hp21<br />
      WriteRegDWORD ....<br />
      WriteRegDWORD ....<br />
      sectionend<br />
      section /o $(SecHP51Name) hp51<br />
      WriteRegDWORD ....<br />
      WriteRegDWORD ....<br />
      sectionend<br />
      <br />
      Function .onSelChange<br />
      !insertmacro StartRadioButtons $8<br />
      !insertmacro RadioButton ${hp20}<br />
      !insertmacro RadioButton ${hp21}<br />
      !insertmacro RadioButton ${hp51}<br />
      !insertmacro EndRadioButtons<br />
      FunctionEnd<br />
      <br />
      <br />
      this works great, but in .oninit function i need to change the default selected radiobutton but if i use sectionsetflags or !insertmacro SelectSection, it select one of the radiobutton without unselect the others one (like if the radiobutton wasn't active).<br />
      <br />
      i hope i've been clear (if not i'll try to be more acurate)<br />
      <br />
      thanks in advance<br />
      <br />
      ++</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">mumuri</span><br />
      <span class="post-time small text-muted">31st July 2004 13:26 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">You only have to use sectionsetflags to unset the others button<br />
      <br />
      SectionSetFlags 0 0x10 ; this button is inactive<br />
      SectionSetFlags 1 0x10 ; this button is inactive too<br />
      SectionSetFlags 2 0x01 ; this button is active<br />
      <br />
      i don't know if you want to disable the button or only unselect it. 0x10 is to disable it. Look in the doc to find the code to unselect them ;).</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Comm@nder21</span><br />
      <span class="post-time small text-muted">31st July 2004 13:33 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">simply include the sections header file:<br /></p>
      <pre>
<code>!include Sections.nsh</code>
</pre><br />
      inside this, u'll find some macros for radio-button behaviour. works really good.
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Satsuki</span><br />
      <span class="post-time small text-muted">31st July 2004 13:51 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">if i use sectionsetflags to unsheck radiobutton it's buggy, the sction is unshecked but the radiobutton works as if it is checked, for exemple i see:<br />
      [0]<br />
      [0]<br />
      [X]<br />
      but when i sheck the first one:<br />
      [X]<br />
      [0]<br />
      [X]<br />
      and i want:<br />
      [X]<br />
      [0]<br />
      [0]<br />
      <br />
      what i mean is when i use sectionsetflags, the sections are shecked but the radiobuton consider that the section are as they are before the use of sectionsetflags... so it's no use.<br />
      <br />
      i just want a way to change the default shecked button, that all, but all the way i've found to change it make the radiobutton bug<br />
      <br />
      ++</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
      <span class="post-time small text-muted">31st July 2004 13:58 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">From Sections.nsh:</p>

      <blockquote>
        ; You should pass a variable that keeps the selected section<br />
        ; as the first parameter for this macro. <b>This variable should<br />
        ; be initialized to the default section's index.</b>
      </blockquote>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">mumuri</span><br />
      <span class="post-time small text-muted">31st July 2004 14:00 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">have you read this ????<br />
      <a href="http://forums.winamp.com/showthread.php?s=&amp;threadid=188384" target="_blank">http://forums.winamp.com/showthread....hreadid=188384</a><br />
      he has the same problems as you ;).</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Satsuki</span><br />
      <span class="post-time small text-muted">31st July 2004 14:34 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">thanks i'm going to read all that ^^<br />
      <br />
      ++</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Satsuki</span><br />
      <span class="post-time small text-muted">31st July 2004 15:03 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">i got exactly the same bug when i change the default with<br />
      <br />
      Push $0<br />
      StrCpy $8 ${hp21}<br />
      SectionGetFlags ${hp21} $0<br />
      IntOp $0 $0 | ${SF_SELECTED}<br />
      SectionSetFlags ${hp21} $0<br />
      SectionGetFlags ${hp20} $0<br />
      IntOp $0 $0 &amp; ${SECTION_OFF}<br />
      SectionSetFlags ${hp20} $0<br />
      SectionGetFlags ${hp51} $0<br />
      IntOp $0 $0 &amp; ${SECTION_OFF}<br />
      SectionSetFlags ${hp51} $0<br />
      Pop $0<br />
      <br />
      this code unselect the first option and select the second option but when i sheck an other radiobuton i get :<br />
      [0]<br />
      [X]<br />
      [X]<br />
      instead of :<br />
      [0]<br />
      [0]<br />
      [X]<br />
      <br />
      <br />
      ++</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">pengyou</span><br />
      <span class="post-time small text-muted">31st July 2004 15:38 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">If you want to change the default "radiobutton" section in .onInit you'll also need to change the line<br />
      <br />
      section $(SecHP20Name) hp20<br />
      <br />
      to<br />
      <br />
      section /o $(SecHP20Name) hp20<br />
      <br />
      (i.e. ensure none of the sections are selected by default)<br />
      <br />
      otherwise you could end up with two sections selected at the same time.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">mumuri</span><br />
      <span class="post-time small text-muted">31st July 2004 15:43 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">lol, sorry,i was just saying that you should watch the one-section.nsi .<br />
      <br />
      Your problem come from the fact that you have to use a variable to keep the selected option (like kichik said)<br />
      <br />
      All is explain in one section.nsi ;).</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Satsuki</span><br />
      <span class="post-time small text-muted">31st July 2004 17:31 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">section /o $(SecHP20Name) hp20<br />
      WriteRegDWORD ...<br />
      WriteRegDWORD ...<br />
      sectionend<br />
      section /o $(SecHP21Name) hp21<br />
      WriteRegDWORD ...<br />
      WriteRegDWORD ...<br />
      sectionend<br />
      section /o $(SecHP51Name) hp51<br />
      WriteRegDWORD ...<br />
      WriteRegDWORD ...<br />
      sectionend<br />
      <br />
      Function .onInit<br />
      ReadRegStr $R9 .....<br />
      StrCmp $R9 "..." goto20 goto21c<br />
      goto20:<br />
      StrCpy $8 ${hp20}<br />
      !insertmacro SelectSection ${hp20}<br />
      goto21c:<br />
      StrCmp $R9 "..." goto21 goto51c<br />
      goto21:<br />
      StrCpy $8 ${hp21}<br />
      !insertmacro SelectSection ${hp21}<br />
      goto51c:<br />
      StrCmp $R9 "..." goto51 gotofinal<br />
      goto51:<br />
      StrCpy $8 ${hp51}<br />
      !insertmacro SelectSection ${hp51}<br />
      gotofinal:<br />
      FunctionEnd<br />
      <br />
      Function .onSelChange<br />
      !insertmacro StartRadioButtons $8<br />
      !insertmacro RadioButton ${hp20}<br />
      !insertmacro RadioButton ${hp21}<br />
      !insertmacro RadioButton ${hp51}<br />
      !insertmacro EndRadioButtons<br />
      FunctionEnd<br />
      <br />
      same bug here, i've read a lot the one-section.nsi but if i want to change the default radiobutton in it, it make the same bug to ...<br />
      sorry for bother you but i don't understand at all why it doesn't work (if you can explain with a concret exemple instead of some abstract definition (i'm not english native so thecnical english is not easy to understand for me))<br />
      <br />
      thanks again<br />
      <br />
      ++</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
      <span class="post-time small text-muted">31st July 2004 17:36 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Your code works just fine for me, after replacing all of the triple dots with something meaningful, of course... There must be something else in the script. You should attach your entire script.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Satsuki</span><br />
      <span class="post-time small text-muted">31st July 2004 18:14 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">my script is ok if hp20 is the radiobutton by default.<br />
      if it's not, when you try to select an other radiobutton, it bugg.<br />
      i'm going to simplifie my scrip, and post it here after that (more than 1200 lines of code)<br />
      <br />
      ++</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Satsuki</span><br />
      <span class="post-time small text-muted">31st July 2004 18:29 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">must realy have something bad in my script, i've tested this script and it works perfectly well:<br />
      <br />
      !include "MUI.nsh"<br />
      !include "Sections.nsh"<br />
      <br />
      Name "test1"<br />
      OutFile "test1.exe"<br />
      <br />
      InstallDir "$PROGRAMFILES\test1"<br />
      <br />
      !insertmacro MUI_PAGE_COMPONENTS<br />
      !insertmacro MUI_PAGE_DIRECTORY<br />
      !insertmacro MUI_PAGE_INSTFILES<br />
      !insertmacro MUI_UNPAGE_CONFIRM<br />
      !insertmacro MUI_UNPAGE_INSTFILES<br />
      !insertmacro MUI_LANGUAGE "French"<br />
      <br />
      <br />
      section /o "HP2.0" hp20<br />
      WriteRegDWORD HKCU "Software\test" "remind" "20"<br />
      sectionend<br />
      section /o "HP2.1" hp21<br />
      WriteRegDWORD HKCU "Software\test" "remind" "21"<br />
      sectionend<br />
      section /o "HP5.1" hp51<br />
      WriteRegDWORD HKCU "Software\test" "remind" "51"<br />
      sectionend<br />
      <br />
      <br />
      Function .onInit<br />
      <br />
      ReadRegStr $R9 HKCU "Software\test" "remind"<br />
      StrCmp $R9 "20" goto20 goto21c<br />
      goto20:<br />
      StrCpy $8 ${hp20}<br />
      !insertmacro SelectSection ${hp20}<br />
      goto21c:<br />
      StrCmp $R9 "21" goto21 goto51c<br />
      goto21:<br />
      StrCpy $8 ${hp21}<br />
      !insertmacro SelectSection ${hp21}<br />
      goto51c:<br />
      StrCmp $R9 "51" goto51 gotofinal<br />
      goto51:<br />
      StrCpy $8 ${hp51}<br />
      !insertmacro SelectSection ${hp51}<br />
      goto endsel<br />
      gotofinal:<br />
      StrCpy $8 ${hp20}<br />
      !insertmacro SelectSection ${hp20}<br />
      endsel:<br />
      <br />
      functionend<br />
      <br />
      <br />
      Function .onSelChange<br />
      !insertmacro StartRadioButtons $8<br />
      !insertmacro RadioButton ${hp20}<br />
      !insertmacro RadioButton ${hp21}<br />
      !insertmacro RadioButton ${hp51}<br />
      !insertmacro EndRadioButtons<br />
      FunctionEnd<br />
      <br />
      <br />
      <br />
      !insertmacro MUI_FUNCTION_DESCRIPTION_BEGIN<br />
      !insertmacro MUI_FUNCTION_DESCRIPTION_END<br />
      <br />
      <br />
      thanks for all, i'm going to verif my script ^^<br />
      <br />
      ++<br />
      <br />
      [EDIT] bug spotted, i had a bad command in my .oninit function (400 lines of code that looks like a mess so that my fault).<br />
      thank for all, i learned a lot about radiobutton.</p>
    </div>
    <hr />

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]>
  </script>
</body>
</html>
