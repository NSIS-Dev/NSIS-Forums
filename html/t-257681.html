<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="Uninstall in onInit w/o reboot page" />

  <title>Uninstall in onInit w/o reboot page - NSIS Forums</title><!-- Bootstrap core CSS -->
  <link rel="stylesheet" type="text/css" href="//netdna.bootstrapcdn.com/bootswatch/3.0.1/readable/bootstrap.min.css" />
  <link rel="stylesheet" href="../css/style.css" type="text/css" /><!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!--[if lt IE 9]>
                <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
                <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->
</head>

<body>
  <div class="container">
    <!-- Put navigation bar here -->

    <ol class="breadcrumb">
      <li><a href="../index.html" class="glyphicon glyphicon-home"></a></li>

      <li><a href="f-65.html">NSIS Discussion</a></li>

      <li class="active">Uninstall in onInit w/o reboot page</li>
    </ol>

    <p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=257681">Uninstall in onInit w/o reboot page</a></p><br />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">broadware</span><br />
      <span class="post-time small text-muted">16th October 2006 20:11 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>Uninstall in onInit w/o reboot page</strong><br />
      In the .onInit function I uninstall the previous version before installing the next via (<a href="http://nsis.sourceforge.net/Auto-uninstall_old_before_installing_new" target="_blank">http://nsis.sourceforge.net/Auto-uni...installing_new</a>):<br />
      <br />
      ExecWait '$R0 _?=$INSTDIR' ;Do not copy the uninstaller to a temp file<br />
      <br />
      but a dialog appears with two radio buttons, one to reboot now (default), the other: Manually reboot later.<br />
      <br />
      I would like to skip this page or have the default set to 'manullly reboot later.'<br />
      <br />
      Removing _?=$INSTDIR suppress the reboot page, but then installer does not wait for the uninstaller to complete before executing.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
      <span class="post-time small text-muted">16th October 2006 20:34 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Copy the uninstaller to the temporary directory and execute it from there. If you don't, it won't be able to delete itself and its containing directory.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">broadware</span><br />
      <span class="post-time small text-muted">16th October 2006 21:23 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Are you saying I should change the statement to:<br />
      <br />
      ExecWait '$R0'<br />
      <br />
      If I do that, the uninstaller executes in a window on top of the installer window, instead of the installer window waiting until the uninstaller window is finsihed before appearing.<br />
      <br />
      The Reboot window has disappered, which is great, but I would like the uninstallation window to disapper before the installation window appears.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">broadware</span><br />
      <span class="post-time small text-muted">17th October 2006 00:57 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">This is what he means:<br />
      <br />
      ExecWait '$R0 _?=$TEMPBASEDIR' ;copy the uninstaller to a temp file -- no reboot page</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
      <span class="post-time small text-muted">17th October 2006 10:12 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Both are not what I mean. I mean you should copy the uninstaller to the temporary directory yourself before executing it. This way it'll be able to delete "itself" from the real installation directory.</p>
      <pre>
<code>CopyFiles $INSTDIR\uninstaller.exe $TEMP<br />ExecWait '"$TEMP\uninstaller.exe" _?=$INSTDIR'</code>
</pre>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">demiller9</span><br />
      <span class="post-time small text-muted">17th October 2006 14:33 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Broadware-<br />
      Does it bother your users that it automatically uninstalls the app when the installer starts? I often start an installer just to see what version it is (or even to see what app it is) because one 'setup.exe' looks like another setup.exe. Maybe you could have the uninstaller run later in the process (like after the user has clicked on 'Install').</p>
    </div>
    <hr />

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]>
  </script>
</body>
</html>
