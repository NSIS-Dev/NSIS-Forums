<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="system: second release - final" />

  <title>system: second release - final - NSIS Forums</title>
  <script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script>
  <!-- Bootstrap core CSS -->

  <link rel="stylesheet" type="text/css" href="//netdna.bootstrapcdn.com/bootswatch/3.0.1/readable/bootstrap.min.css" />
  <link rel="stylesheet" href="../css/style.css" type="text/css" /><!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!--[if lt IE 9]>
                <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
                <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->
</head>

<body>
  <div class="container">
    <!-- Put navigation bar here -->

    <ol class="breadcrumb">
      <li><a href="../index.html" class="glyphicon glyphicon-home"></a></li>

      <li><a href="f-65.html">NSIS Discussion</a></li>

      <li class="active">system: second release - final</li>
    </ol>

    <p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=112243">system: second release - final</a></p><br />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">brainsucker</span><br />
      <span class="post-time small text-muted">31st October 2002 11:27 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>system: second release - final</strong><br />
      &nbsp; Ok. I've completed examples, but documentation is still in bad condition (any help will be apreciated :).<br />
      <br />
      Examples included: Indirect message boxes (with custom icons etc), Int64 ops, Disk space etc, Structures, GetFileSysTime, and ... SPLASH :) callbacks are working ;)<br />
      <br />
      Changes from prerelease version:<br />
      1. Inline input into structures bug fixed.<br />
      2. Zero values for structure special options bug fixed.<br />
      3. &amp;lN for structures - automatic size detection - added.<br />
      4. Automatic callback queue clear up (so no /CALLBACK required for System::Free now).<br />
      5. System::Store - store/restore registers and pop/push registers.<br />
      6. '\' is no more an escape character for inline input. If you need to place the<br />
      same quotes into input as you used for separation of input expression just use<br />
      these characters in doubled way. For example (t "just an ""Example""!").<br />
      <br />
      P.S. I've created an additional dir in contrib/system since there are many source files and it's hard to find textual contribs otherwise. Sorry to makensis.nsi updater :)<br />
      P.P.S. Examples/System.nsi contains examples :)<br />
      P.P.P.S. I'm to busy to adopt vc6 project file now, sorry...</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">brainsucker</span><br />
      <span class="post-time small text-muted">31st October 2002 20:55 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">There is a small update required since you changed file/directory paths:<br />
      <br />
      system.nsi: replace<br />
      !include "${NSISDIR}\Contrib\System\Additionals\sysfunc.nsh"<br />
      with<br />
      !include "${NSISDIR}\Contrib\System\sysfunc.nsh"<br />
      <br />
      SysFunc.nsh: replace<br />
      !include "${NSISDIR}\Contrib\System\Additionals\System.nsh"<br />
      with<br />
      !include "${NSISDIR}\Contrib\System\System.nsh"<br />
      <br />
      sorry ;)</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Joost Verburg</span><br />
      <span class="post-time small text-muted">1st November 2002 09:43 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Thanks, fixed :D</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
      <span class="post-time small text-muted">14th November 2002 19:45 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">The compiled System.nsi example doesn't delete Resource.dll. Seems like System.dll doesn't release it.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">n0On3</span><br />
      <span class="post-time small text-muted">17th November 2002 10:21 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">I downloaded this file and the latest CVS but it won't compile. Anyway, what I wanted to know is if that "int64" means that I can use integers of 64 bits in nsis. if the answer is yes: how?<br />
      <br />
      thanks</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">brainsucker</span><br />
      <span class="post-time small text-muted">17th November 2002 23:37 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Kichik: added FreeLibrary call to systemMessageBox, thanx. Modified examples attached. Also resource.dll link updated - now compiles fine.<br />
      <br />
      btw: NSIS never deletes System plugin too :) May be it should delete all used plugins at final (i found my Temp dir fillled with 8 mb of system.dll in different nsis folders ;) ?<br />
      <br />
      noon: see Int64Op function. Search for the 'Int64Op' string files located at Contrib\System folder: system.txt and system.nsi.<br />
      <br />
      P.S. System is already included into NSIS distribution (at least CVS version).</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">brainsucker</span><br />
      <span class="post-time small text-muted">18th November 2002 00:57 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Sorry Kichik, sourceforge was done, so I've noted your changes too late. Here is combined version of our changes... ;)</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">n0On3</span><br />
      <span class="post-time small text-muted">18th November 2002 15:30 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">"could be a hard barrier for non Win32 programmers"<br />
      ok, I am not a win32 programmer. Could you tell me what do I need to change to work with integers of 64bits? I want to add, divide and write to files.<br />
      <br />
      Thanks<br />
      :)</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
      <span class="post-time small text-muted">18th November 2002 15:35 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">From System.nsi:<br />
      <br /></p>
      <pre>
<code>
StrCpy $2 "12312312"
<br />&gt;StrCpy $3 "12345678903"
<br />&gt;System::Int64Op $2 "*" $3
<br />Pop$4 
<br />&gt;
</code>
</pre>$4 will contain 12312312 * 12345678903 after this piece of code.<br />
      <br />
      Instead of IntOp you use System::Int64Op and Pop, that's all.
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">n0On3</span><br />
      <span class="post-time small text-muted">18th November 2002 17:43 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Thanks I think it works.<br />
      <br />
      btw, not using the intop64 takes 16 seconds an installation to work, and using it takes 52. is this normal?</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">brainsucker</span><br />
      <span class="post-time small text-muted">19th November 2002 12:20 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">SUUUCK! I've typed two pages of answer :)) and that damn IE eated it all after I pressed Backspace by the case. sux.<br />
      <br />
      Ok. Short answer: Calls to external plugins and int64 arithmetic are time consuming oops. check for unload option, in case of many system:: calls this could be the reason.<br />
      <br />
      at script start should be:<br />
      <br />
      setpluginunload manual<br />
      <br />
      at script end should be (at line which will be executed last or so):<br />
      <br />
      setpluginunload alwaysoff<br />
      System::Free 0 ; actually does nothing</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">n0On3</span><br />
      <span class="post-time small text-muted">19th November 2002 19:57 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">well, I didn't understand fully. But I will add this "setpluginunload manual" in the very beginning, and this "setpluginunload alwaysoff" at the very end (I forget the other line as it does nothing).<br />
      <br />
      As I have sections and functions, do I need to put this in every section or function, or just in the first line of the first section and the last line for the last section (as functionas are called from sections)?</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
      <span class="post-time small text-muted">19th November 2002 20:47 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Right before you use System.dll for the first time and the second one right before you use it for the last time.<br />
      <br />
      It takes longer because NSIS has to load the DLL everytime, and that takes some time. If you tell it not to unload the DLL it will be a bit shorter.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">brainsucker</span><br />
      <span class="post-time small text-muted">19th November 2002 21:58 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"></p>

      <blockquote>
        (I forget the other line as it does nothing).
      </blockquote>;) It does nothing but you shouldn't forget it :) The system plugin couldn't free the zero, so it will do nothing, but the NSIS don't know this. By the other hand we are turning plugin unload back (always off state), so the plugin will be finally unloaded and deleted successfully after instalation end.<br />
      <br />
      Kichik described the other way (it is right too): you could find the last use of system plugin and set this option (plugin unload) right before it.<br />
      <br />
      2 Kichik: may be we should find easier way to do this? ;) This could be some statement which will compile into the same call (the same compiled entry) to unexistant function of plugin but with unload turned on (so no exehead size consumption)...
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">n0On3</span><br />
      <span class="post-time small text-muted">23rd November 2002 00:13 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">and...<br />
      <br />
      is IntCmp implemented for 64bits?<br />
      (I need it and can't find a work around:D )</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
      <span class="post-time small text-muted">23rd November 2002 10:08 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">If you just want to see if they are equal you can use IntOp64 &lt;#1&gt; - &lt;#2&gt; and compare the result to "0". If you want a bit more, you can compare the first char to "-".</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">brainsucker</span><br />
      <span class="post-time small text-muted">23rd November 2002 10:45 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Kichiks way will work too, but ... RTFM (system.txt ;)<br />
      <br />
      ----------------------------------<br />
      System::Int64Op ARG1 OP1<br />
      System::Int64Op ARG1 OP2 ARG2<br />
      ----------------------------------<br />
      Performs operation on ARG1 and ARG2 (or on ARG1 only at single argument operator cases) and returns result on stack. Here are the OP2s: +, -, *, / DIV, % MOD, | OR, &amp; AND, ^ XOR, || LOGIC-OR, &amp;&amp; LOGIC-AND, &lt; BELOW, &gt; ABOVE, = EQUAL.<br />
      There are only 2 OP1s: ~ (BITWISE-NOT) and ! (LOGIC-NOT).<br />
      <br />
      So, use:<br />
      <br />
      System::Int64Op 234563524532 &lt; 7236487463264<br />
      Pop $0<br />
      Strcmp $0 0 labelFirstIsNotSmaller labelFirstIsSmaller</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">n0On3</span><br />
      <span class="post-time small text-muted">23rd November 2002 16:25 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">yes! very smart :winamp:</p>
    </div>
    <hr />

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]>
  </script>
</body>
</html>