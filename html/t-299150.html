<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="description" content="Changing Root for DirRequest"><title>Changing Root for DirRequest - NSIS Forums</title><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script><link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css"><link rel="stylesheet" href="../css/style.css" type="text/css"><!--[if lt IE 9]><script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script><script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script><![endif]--></head><body><div class="container"><ol class="breadcrumb"><li><a href="../index.html" class="glyphicon glyphicon-home"></a></li><li><a href="f-65.html">NSIS Discussion</a></li><li class="active">Changing Root for DirRequest</li></ol><p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=299150">Changing Root for DirRequest</a></p><br><div class="post"><p class="post-meta"><span class="post-author text-primary">aerDNA</span><br><span class="post-time small text-muted">25th October 2008 22:06 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>Changing Root for DirRequest</strong><br>An InstallOptions related question: is it possible to change the 'Root' value for a DirRequest control without reinitializing the page? Like, when you want to change 'State' (e.g. to append \MyProg after the user selects a dir), it's not enough to change it in .ini, you also need to use SendMessage to display the new string in the box. But 'Root' is not some element for which you can get a HWND, so I'm clueless.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">saschagottfried</span><br><span class="post-time small text-muted">29th October 2008 09:39 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">I have used the DirRequest control in one of my setups. You can two things. Switch to using (!include nsDialogs.nsh). This targets the somewhat complicated programming method with using InstallOptions for custom dialogs. The tutorial is quite promising. If you have only one custom dialog, it is worth a try. The next problem you will be facing with InstallOptions, could be not a problem with nsDialogs.<br><br>Or you paste some code into your reply and I try to give you advice looking for similarities in my code. Actually I did not completely understand what you are trying to do. Please show your goal with examples and your problems as well.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">aerDNA</span><br><span class="post-time small text-muted">29th October 2008 16:30 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">I realize that switching to MUI2 would probably be the best solution but right now I don't have time nor the will to explore nsDialogs, so let's drop that one.<br>As for InstallOptions:<br>I've built a custom page for shortcuts selection. It uses DirRequest to select a Start menu folder. The user can also select whether it will be created for all or for current user. Default is set to current, so if the user clicks the 'All users' RadioButton, the script needs:<br>SetShellVarContext All<br>!insertmacro MUI_INSTALLOPTIONS_WRITE "shortcuts.ini" "Field 13" "Root" "$SMPROGRAMS"<br>But InstallOptions doesn't reload values from .ini so it will not take effect unless user reinits the page (i.e. goes &lt;Back and then Next&gt; again). This limitation is generally not much of a problem, you activate the change by getting HWND of the control and using SendMessage or EnableWindow, depending on what you need. But as I said, you can't do that for 'Root', it's not a page element and it has no HWND. I guess it's only handled internally by the plugin but I thought I'd ask anyway. My workaround for the problem is creating two separate DirRequest controls. I'm not completely happy with this solution but it's functional.<br>Wrote to Santa to bring me money so I have spare time to play around with nsDialogs.</p></div><hr><div class="footer"><p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p></div></div><script src="../js/highlight.pack.js" type="text/javascript"></script><script type="text/javascript">//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]></script></body></html>