<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="How do i get a list of installed printers?" />

  <title>How do i get a list of installed printers? - NSIS Forums</title>
  <script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script>
  <!-- Bootstrap core CSS -->

  <link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css" />
  <link rel="stylesheet" href="../css/style.css" type="text/css" /><!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!--[if lt IE 9]>
                <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
                <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->
</head>

<body>
  <div class="container">
    <!-- Put navigation bar here -->

    <ol class="breadcrumb">
      <li><a href="../index.html" class="glyphicon glyphicon-home"></a></li>

      <li><a href="f-65.html">NSIS Discussion</a></li>

      <li class="active">How do i get a list of installed printers?</li>
    </ol>

    <p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=103943">How do i get a list of installed printers?</a></p><br />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Sailo</span><br />
      <span class="post-time small text-muted">6th September 2002 17:12 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>How do i get a list of installed printers?</strong><br />
      Is it possible to get a list of installed Printers, the ports they are installed onto and their share name?<br />
      <br />
      I know that the printers are listed in win.ini but is there another way, plus there is no share names in there.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
      <span class="post-time small text-muted">6th September 2002 17:37 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Create an extension DLL that uses EnumPrinters.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Sailo</span><br />
      <span class="post-time small text-muted">9th September 2002 11:47 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">I don't know how to create a DLL. Is it a big job?</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">veekee</span><br />
      <span class="post-time small text-muted">9th September 2002 12:22 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">printers may be in the registry ... try to search them ;) (can't do it by my self, i'm currently on Linux :D)</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Sailo</span><br />
      <span class="post-time small text-muted">9th September 2002 14:43 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">I believe they are but how do you tell nsis to search for a key when you don't know what it is called.<br />
      <br />
      HKEY_LOCAL_MACHINE\System\CurrentControlSet\Control\Print\Printers\HP LaserJet 4 in Corridor<br />
      <br />
      The last part of the key is the Printer Name displayed in the Printers folder (win 98).<br />
      <br />
      How can i utilise this?</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Sunjammer</span><br />
      <span class="post-time small text-muted">9th September 2002 15:21 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Look at EnumRegKey in the makensis.htm.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
      <span class="post-time small text-muted">9th September 2002 16:41 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">EnumPrinters is the safest way to go. I will try to write you a simple DLL.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Sailo</span><br />
      <span class="post-time small text-muted">9th September 2002 16:55 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Thanx guys</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
      <span class="post-time small text-muted">9th September 2002 17:54 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Code example included inside the ZIP file. Enjoy :D<br />
      <br />
      BTW, a lot more info can be gathered. Have a look <a href="http://msdn.microsoft.com/library/default.asp?url=/library/en-us/gdi/prntspol_9otu.asp" target="_blank">here</a> to see how much.<br />
      <br />
      Note to plug-in developers: this is also a simple example of how to use the new /NOUNLOAD thingy.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Sailo</span><br />
      <span class="post-time small text-muted">9th September 2002 19:33 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">I'm sorry but i don't understand how to use the example. Can anyone help?</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
      <span class="post-time small text-muted">9th September 2002 19:36 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">What exactly don't you understand? If you can be a little more specific I can help you better ;)</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Sailo</span><br />
      <span class="post-time small text-muted">9th September 2002 19:55 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">As you may have guessed i'm not that up on programming and stuff. Sorry to be a pain. This is all a learning curve to me.<br />
      <br />
      I don't no where to put :<br />
      <br />
      ; printers enumeration starts at 1<br />
      StrCpy $R0 1<br />
      enum_printers:<br />
      Printers::GetPrinterInfo /NOUNLOAD $R0<br />
      Pop $0<br />
      ; First pop == 0, no more printers<br />
      StrCmp $0 "" enum_printers_done<br />
      Pop $1<br />
      Pop $2<br />
      Pop $3<br />
      MessageBox MB_OK "Name: $0$\nServer name: $1$\nShare name: $2$\nPort name: $3"<br />
      IntOp $R0 $R0 + 1<br />
      Goto enum_printers<br />
      enum_printers_done:<br />
      ; unload the DLL<br />
      Printers::GetPrinterInfo $R0<br />
      <br />
      Do i put it in a section or what?<br />
      <br />
      When i do i get "Invalid Command : Printers::GetPrinterInfo"</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
      <span class="post-time small text-muted">9th September 2002 20:00 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">You must put Printers.dll in your plug-ins directory, or use PluginDir, then it will find the command. After you did that you can put that code piece any where you want. I think you will understand it all from there, don't be afraid to ask again if you still don't.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Sailo</span><br />
      <span class="post-time small text-muted">9th September 2002 20:44 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">I don't understand. I must be missing something simple.<br />
      <br />
      Compiler results....<br />
      <br />
      Processing plugin dlls: "C:\Program Files\NSIS\plugins\*.dll"<br />
      - InstallOptions.dll::dialog<br />
      - LangDLL.dll::LangDialog<br />
      - nsisdl.dll::download<br />
      - nsisdl.dll::download_quiet<br />
      - Printers.dll::GetPrinterInfo<br />
      <br />
      <br />
      Processing config:<br />
      Changing directory to: "C:\Software\Software Development\NSIS\printers\Printers"<br />
      <br />
      <br />
      Processing script file: "C:\Software\Software Development\NSIS\printers\Printers\printers.nsi"<br />
      OutFile: "printers.exe"<br />
      Name: "Printers Test"<br />
      Section: ""<br />
      StrCpy $R0 "1" () ()<br />
      Invalid command: Printers::GetPrinterInfo<br />
      Error in script "C:\Software\Software Development\NSIS\printers\Printers\printers.nsi" on line 9 -- aborting creation process<br />
      <br />
      My simple script ...<br />
      <br />
      outfile printers.exe<br />
      name "Printers Test"<br />
      <br />
      Section<br />
      <br />
      ; printers enumeration starts at 1<br />
      StrCpy $R0 1<br />
      enum_printers:<br />
      Printers::GetPrinterInfo /NOUNLOAD $R0<br />
      Pop $0<br />
      ; First pop == 0, no more printers<br />
      StrCmp $0 "" enum_printers_done<br />
      Pop $1<br />
      Pop $2<br />
      Pop $3<br />
      MessageBox MB_OK "Name: $0$\nServer name: $1$\nShare name: $2$\nPort name: $3"<br />
      IntOp $R0 $R0 + 1<br />
      Goto enum_printers<br />
      enum_printers_done:<br />
      ; unload the DLL<br />
      Printers::GetPrinterInfo $R0<br />
      SectionEnd<br />
      <br />
      Do i need anything else?</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
      <span class="post-time small text-muted">10th September 2002 06:45 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">What NSIS version do you use? If you don't use the latest CVS version you will need to call GetPrintersInfo without Printers:: infront of it.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Dizzy007</span><br />
      <span class="post-time small text-muted">11th September 2002 08:14 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>where is the PluginDir for the printers.dll</strong><br />
      Hi!<br />
      <br />
      I've got the same problem.<br />
      I use NSIS198 downloaded from <a href="http://www.nullsoft.com/free/nsis." target="_blank">http://www.nullsoft.com/free/nsis.</a><br />
      <br />
      So, after installation i haven't got a "plugin-dir".<br />
      I have created one under c:\Programme\NSIS\plugins and copied the<br />
      printers.dll into it.<br />
      I inserted "PluginDir" into the code but i still get errors.<br />
      <br />
      *****************<br />
      Changing directory to: "C:\8\Printers"<br />
      <br />
      Processing script file: "C:\8\Printers\printer.nsi"<br />
      OutFile: "printer.exe"<br />
      Name: "Print"<br />
      Invalid command: PluginDir<br />
      Error in script "C:\8\Printers\printer.nsi" on line 4 -- aborting creation process<br />
      ******************<br />
      <br />
      <br />
      My code :<br />
      =========<br />
      outfile printer.exe<br />
      name Print<br />
      <br />
      PluginDir C:\Programme\NSIS\plugins\<br />
      <br />
      <br />
      ; printers enumeration starts at 1<br />
      StrCpy $R0 1<br />
      enum_printers:<br />
      Printers::GetPrinterInfo /NOUNLOAD $R0<br />
      Pop $0<br />
      ; First pop == 0, no more printers<br />
      StrCmp $0 "" enum_printers_done<br />
      Pop $1<br />
      Pop $2<br />
      Pop $3<br />
      MessageBox MB_OK "Name: $0$\nServer name: $1$\nShare name: $2$\nPort name: $3"<br />
      IntOp $R0 $R0 + 1<br />
      Goto enum_printers<br />
      enum_printers_done:<br />
      ; unload the DLL<br />
      Printers::GetPrinterInfo $R0<br />
      <br />
      ===================================================<br />
      Can someone tell me :<br />
      --&gt; where i have to put the plugindir?<br />
      --&gt; how to tell the compiler to use the plugins<br />
      --&gt; and if possible : the hole printer.nsi the get the printers out of the registry ??<br />
      <br />
      I really would be happy!<br />
      <br />
      Thanks<br />
      Jens</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
      <span class="post-time small text-muted">11th September 2002 08:34 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Simplified calling of plug-ins (dllname::function) was introduced in NSIS 2.0a4 by Sunjammer.<br />
      It doesn't work on NSIS 1.98.<br />
      Either download NSIS 2, or use the old fashioned way (GetTempFileName, File /oname, Push, CallInstDLL).</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Sailo</span><br />
      <span class="post-time small text-muted">11th September 2002 09:34 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">OK my NSIS wasn't the most up to date.<br />
      <br />
      This works for 1.98<br />
      <br />
      ; printers enumeration starts at 1<br />
      StrCpy $R0 1<br />
      enum_printers:<br />
      Push $R0<br />
      CallInstDLL $TEMP\Printers.dll GetPrinterInfo<br />
      Pop $0<br />
      ; First pop == 0, no more printers<br />
      StrCmp $0 "" enum_printers_done<br />
      Pop $1<br />
      Pop $2<br />
      Pop $3<br />
      MessageBox MB_OK "Name: $0$\nServer name: $1$\nShare name: $2$\nPort name: $3"<br />
      IntOp $R0 $R0 + 1<br />
      Goto enum_printers<br />
      enum_printers_done:<br />
      <br />
      <br />
      Do you need to unload the DLL in any way if you use the old CallInstDLL method?</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Dizzy007</span><br />
      <span class="post-time small text-muted">11th September 2002 13:50 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>Local or network printer ??</strong><br />
      Yes - this works with nsis 1.98 - THANKS<br />
      but ...<br />
      is there a function to get the network printer as well??<br />
      <br />
      Regards<br />
      Jens<br />
      <br />
      <font size="1">[edited by kichik, script not needed here]</font></p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Sailo</span><br />
      <span class="post-time small text-muted">11th September 2002 14:56 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">The printers.dll was intended to get a list of printers installed on the machine that you are running it on.<br />
      <br />
      If you want a list of printers installed on all machines across your network that is a compleletly different thing.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
      <span class="post-time small text-muted">12th September 2002 11:37 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"></p>

      <blockquote>
        Do you need to unload the DLL in any way if you use the old CallInstDLL method?
      </blockquote>NSIS automatically unloads the DLL after it calls it with CallInstDLL, unless you specify /NOUNLOAD (only available from a7 and above [maybe 6...])<br />
      <br />

      <blockquote>
        is there a function to get the network printer as well??
      </blockquote>Do you mean all printers installed on the network, or only the printers the user has installed drivers for in his computer?<br />
      If the user installed a driver, you will see it with this function.
    </div>
    <hr />

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]>
  </script>
</body>
</html>
