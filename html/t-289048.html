<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="Install to Local Disk with HM NIS" />

  <title>Install to Local Disk with HM NIS - NSIS Forums</title>
  <script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script>
  <!-- Bootstrap core CSS -->

  <link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css" />
  <link rel="stylesheet" href="../css/style.css" type="text/css" /><!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!--[if lt IE 9]>
                <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
                <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->
</head>

<body>
  <div class="container">
    <!-- Put navigation bar here -->

    <ol class="breadcrumb">
      <li><a href="../index.html" class="glyphicon glyphicon-home"></a></li>

      <li><a href="f-65.html">NSIS Discussion</a></li>

      <li class="active">Install to Local Disk with HM NIS</li>
    </ol>

    <p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=289048">Install to Local Disk with HM NIS</a></p><br />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">alpuppy</span><br />
      <span class="post-time small text-muted">25th March 2008 21:21 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>Install to Local Disk with HM NIS</strong><br />
      This is my first run at creating an installer, I'm using HM NIS edit to make my nsi script, what I'm trying to do is get the installer to install in c:/(my folder name here)<br />
      I can't figure out how to do that though.<br />
      any tips?</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">AaronLS</span><br />
      <span class="post-time small text-muted">25th March 2008 21:52 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">I'm not sure exactly what you mean by "get the installer to install in". You mean where you want the files to be placed? Some clarification and examples would be helpful.<br />
      <br />
      I believe in the *.nsi script HM generates there will be two lines of the form:<br />
      <br />
      !define DEFAULT_DIR "C:\SomeDir"<br />
      InstallDir "${DEFAULT_DIR}"<br />
      <br />
      You can modify the first line to change the default destination. You won't get too far with the wizard though. I tried HM first and soon switched to Notepad++. Then I read the NSIS User manual page by page. I got as far as section 4.9 before I got bored with reading about each instruction, but it has proven valuable, because it made me aware of all the capabilities available to me.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">alpuppy</span><br />
      <span class="post-time small text-muted">25th March 2008 22:19 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">ok sorry for not being more specific.<br />
      I am using the wizard so that could be a problem, but I don't have any experience with this so that sort of noob setup is good for me.<br />
      the part I'm talking about is "Application default directory" and the choices it gives me (in the wizard) are:<br />
      $PROGRAMFILES\My application<br />
      $TEMP<br />
      $DESKTOP<br />
      $SYSDIR<br />
      $EXEDIR<br />
      $WINDIR<br />
      $STARTMENU<br />
      $SMPROGRAMS<br />
      $QUICKLAUNCH<br />
      <br />
      I looked through the output code that HM generated and I couldnt' see either of those lines.<br />
      <br />
      does notepad++ have a wizard by chance?</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">AaronLS</span><br />
      <span class="post-time small text-muted">25th March 2008 23:23 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Is (my folder name) something you are coming up with right now, or is it something that will be set at runtime?<br />
      <br />
      Ok, I just ran through the wizard, just type for the Application default directory:<br />
      c:\ThisIsAFolderName<br />
      <br />
      Or whatever you want it to be. You don't necesarily have to choose from the options in the drop down. After the wizard finishes and it generates the script, it had created this line on line 41:<br />
      InstallDir "C:\ThisIsAFolderName"<br />
      <br />
      This statement basically sets the $INSTDIR property to "C:\ThisIsAFolderName". You'll notice later in the file it writes fields to that location with commands like:<br />
      SetOutPath "$INSTDIR"<br />
      <br />
      Notepad++ does not have a wizard, all it has is snytax highlighting for the files. I used HM to generate the initial script, but have done most of the editing with Notepad++. The problem I have with depending on a wizard is if you decide that "Oh, I want to do this slightly differently." then you have to go back through the same wizard and remember which options you chose initially, except for that one change. So it's just a personal preference of mine. It's a great learning tool initially though, as you can see how what you do in the wizard effects the script output. I would suggest making an effort to understand the script it generates and using the NSIS manual to look up commands frequently.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">alpuppy</span><br />
      <span class="post-time small text-muted">27th March 2008 21:45 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">I have the folder name picked out, it's going to be ODLink.<br />
      I just tested it on mine and that works great, silly me. Thanks so much for your help. I think I'll get Notepad++ though. I would go about it the same way as you, generating the script in HM, I just know there's no way I want to get to the point where I can create the whole script myself in notepad, too much else to work on right now.<br />
      thanks for your help, my setup file is running good.<br />
      <br />
      I do have 2 more questions that I hope I can tack onto this thread.<br />
      How do I pick an icon for my website link that's located in the start menu.<br />
      And how would I define the icon for the file I'm putting on the desktop? It's a filemaker file so it defaults as the filemaker icon, but I want to change it so it shows as my company logo, I know how to make an icon, I've already done that, and I know how to right click, properties, etc...to manually use my icon as the icon, but is there a way to make the setup do it.<br />
      <br />
      thanks aaron</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">AaronLS</span><br />
      <span class="post-time small text-muted">27th March 2008 22:32 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Search your script for CreateShortcut commands. The ones that create shortcuts in the start menu will begin like this:<br />
      CreateShortCut "$SMPROGRAMS\<br />
      <br />
      Then lookup CreateShortcut in the index of the NSIS User Manual which tells you how to add icons to your shortcut.<br />
      <br />
      Here is an example from the manual that I modified a little:<br />
      CreateShortCut "$SMPROGRAMS\My Company\${PRODUCT_NAME}.lnk" "$INSTDIR\${PRODUCT_NAME}.URL" "" "$INSTDIR\My Program.exe" 0<br />
      <br />
      If your ${PRODUCT_NAME}" is set to ODLink for example, then this will create a link that is under "My Company" in the start menu called "ODLink.lnk" (but will just show up as ODLink since the .lnk extension is hidden). The "$INSTDIR\${PRODUCT_NAME}.URL" is the destination of the link(a previous Writeini statement would have create the .url file). The empty string "" is optional command line paramters to pass to the destination program, since this is just a url that is not needed.<br />
      <br />
      "$INSTDIR\My Program.exe" is the the file to get the icon from. This could be an exe or dll that already contains icons, or I think it can be an *.ico file as well. The number 0 is the index of the icon in the My Program.exe. I believe you can have multiple icons in an exe or dll so you could have 1 or 2 or something greater.<br />
      <br />
      So if you already have an exe such as My Program.exe that has an icon you want to use, try referencing it and try 0 for the index. If you want to experiment with referencing an *.ico file, make sure you copy the file to the destination computer first.<br />
      <br />
      <br />
      For the second question, if it has an icon based on it's filename extension, you can't change it without affecting all other files of that type on the system. I would suggest placing the file in your application directory, and creating a shrotcut to it on the desktop with the CreateShortcut command, and using the icon parameters of the CreateShortcut command to set the icon for the shortcut.</p>
    </div>
    <hr />

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]>
  </script>
</body>
</html>
