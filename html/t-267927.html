<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="Plugin fails on other machines" />

  <title>Plugin fails on other machines - NSIS Forums</title>
  <script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script>
  <!-- Bootstrap core CSS -->

  <link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css" />
  <link rel="stylesheet" href="../css/style.css" type="text/css" /><!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!--[if lt IE 9]>
                <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
                <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->
</head>

<body>
  <div class="container">
    <!-- Put navigation bar here -->

    <ol class="breadcrumb">
      <li><a href="../index.html" class="glyphicon glyphicon-home"></a></li>

      <li><a href="f-65.html">NSIS Discussion</a></li>

      <li class="active">Plugin fails on other machines</li>
    </ol>

    <p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=267927">Plugin fails on other machines</a></p><br />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">dvalenitate</span><br />
      <span class="post-time small text-muted">17th March 2007 12:42 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>Plugin fails on other machines</strong><br />
      <b>I have created a NSIS plugin using Visual Studio 2005. It works great on my XP system but on any other system it doesn't seem to be executed at all.<br />
      <br />
      Does anyone have an experience similar to this?</b><br />
      <br />
      <b>Some more details:</b><br />
      - If I compile the plugins from the NSIS site the same thing happens. My system: fine ; others : no execution<br />
      <br />
      - I have the Academic version of Visual Studio.<br />
      <br />
      - No errors occure when the plugin seems to fail to execute. Except that later things in my NSIS script that depended on results from the plugin to work don't work.<br />
      <br />
      - I have XP running in a Virtual PC on my machine as well. The DLLs I make work fine in this.<br />
      <br />
      <b>Some side questions:</b><br />
      - has anyone had much success with open source compilers with NSIS plugins?<br />
      <br />
      - does the Academic version of Visual Studio somehow limit the dll code it produces to the creator machine?<br />
      <br />
      - if I provided the code could someone else compile it and send me the resulting dll.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Takhir</span><br />
      <span class="post-time small text-muted">17th March 2007 13:34 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">You should avoid msvcrt80 dependencies VS 2005 like to include. Replace vcrt calls with kernel functions (if any, wsprintf for example) or add your own functions (most of NSIS plug-ins include code for atoi variants). Tiny libc also helps sometimes. Or add MSCVRT redistributions to your package :) DependencyWalker (DEPENDS.EXE) can help to check situation.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Mr Inches</span><br />
      <span class="post-time small text-muted">18th March 2007 00:29 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Further to Takhir's comment, the best place to run the Dependency Walker is on a plain vanilla installtion of Windows NT or Windows 2000. These operating systems include very old versions of the C runtime DLLs which VS2005 and VS2003 can't use. By running it on these systems, you will quickly see what your development PC has that your installation targets don't.<br />
      <br />
      Also, make sure you have not selected the multi-threaded DLL support for the MSCRT - I did this in an early version of CABSetup and it took one of the senior developers at my work to point out what I had done; I wouldn't have guessed it in a million years!<br />
      <br />
      Finally, check the MSDN to make sure that all of the functions your plugin uses are supported on your target platforms - some functions fail quietly or rely on you checking GetLastError.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">dvalenitate</span><br />
      <span class="post-time small text-muted">18th March 2007 02:58 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">I will try your suggestions. Thanks for being so responsive!</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Anders</span><br />
      <span class="post-time small text-muted">18th March 2007 03:33 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">msvcrt shipped with Win95B (OSR2.5 to be specific) and will be present on the original version if IE4 or WinSock or any kind of update is installed (It is also present on the Win95A CD IIRC) so it is pretty safe to build with the multi-threaded DLL version of the CRT IMHO</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Takhir</span><br />
      <span class="post-time small text-muted">18th March 2007 07:55 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">BTW do not use debug build for distribution - msvcrtd.dll and mfc40d.dll will be absent in 99%! VS 6 is OK for most of Win versions (may be Win95 Gold not includes vcrt), but VS 2005 links to msvcrt80 and mfc80, and this is a problem almost everywhere.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">dvalenitate</span><br />
      <span class="post-time small text-muted">19th March 2007 09:15 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">I compiled using Visual Studio 2002 and everything worked great.<br />
      <br />
      Thank you Microsoft for making life more complicated with progressive versions. Keeps things interesting. - Now with more productivity! Or not.</p>
    </div>
    <hr />

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]>
  </script>
</body>
</html>
