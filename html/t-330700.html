<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="description" content="Permissioning issues with Nsis Installer"><title>Permissioning issues with Nsis Installer - NSIS Forums</title><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script><link rel="preload" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css" as="style" onload="this.rel='stylesheet'"><link rel="preload" href="../css/style.css" as="style" onload="this.rel='stylesheet'"><noscript><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css"><link rel="stylesheet" href="../css/style.css"></noscript><script>!function(a){"use strict";var b=function(b,c,d){function e(a){return h.body?a():void setTimeout(function(){e(a)})}function f(){i.addEventListener&&i.removeEventListener("load",f),i.media=d||"all"}var g,h=a.document,i=h.createElement("link");if(c)g=c;else{var j=(h.body||h.getElementsByTagName("head")[0]).childNodes;g=j[j.length-1]}var k=h.styleSheets;i.rel="stylesheet",i.href=b,i.media="only x",e(function(){g.parentNode.insertBefore(i,c?g:g.nextSibling)});var l=function(a){for(var b=i.href,c=k.length;c--;)if(k[c].href===b)return a();setTimeout(function(){l(a)})};return i.addEventListener&&i.addEventListener("load",f),i.onloadcssdefined=l,l(f),i};"undefined"!=typeof exports?exports.loadCSS=b:a.loadCSS=b}("undefined"!=typeof global?global:this);!function(a){if(a.loadCSS){var b=loadCSS.relpreload={};if(b.support=function(){try{return a.document.createElement("link").relList.supports("preload")}catch(b){return!1}},b.poly=function(){for(var b=a.document.getElementsByTagName("link"),c=0;c<b.length;c++){var d=b[c];"preload"===d.rel&&"style"===d.getAttribute("as")&&(a.loadCSS(d.href,d,d.getAttribute("media")),d.rel=null)}},!b.support()){b.poly();var c=a.setInterval(b.poly,300);a.addEventListener&&a.addEventListener("load",function(){b.poly(),a.clearInterval(c)}),a.attachEvent&&a.attachEvent("onload",function(){a.clearInterval(c)})}}}(this);</script></head><body><div class="container"><ol class="breadcrumb"><li><a href="../index.html" class="glyphicon glyphicon-home"></a></li><li><a href="f-65.html">NSIS Discussion</a></li><li class="active">Permissioning issues with Nsis Installer</li></ol><p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=330700">Permissioning issues with Nsis Installer</a></p><br><div class="post"><p class="post-meta"><span class="post-author text-primary">mhatreakshay</span><br><span class="post-time small text-muted">18th May 2011 11:29 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>Permissioning issues with Nsis Installer</strong><br>Hi Everyone,<br>I am facing below issue once the installation is complete.<br><br>1. I have two option to install Local users and Admin user.<br>2. IF Local User select,it can install in its local folders (eg: C:\Documents and Settings\mhatreakshay)<br>3. IF Admin User user select,it will select default dir to Program files.<br>4. However if i select Admin User and try to install it in any local users folder (say C:\Documents and Settings\mhatreakshay) ,it will complete the installation properly.<br>5. But when i login using the local user (mhatreakshay) , and click on the start icon it gives a permission denied error.<br>6. I checked the permissions on the files,some files have Admin rights only .local user mhatreakshay cant access this files even if they are been installed in his local folder.<br>Please help.<br><br>I am trying this on windows machine.<br><br>Regards<br>Akshay</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">MSG</span><br><span class="post-time small text-muted">18th May 2011 14:15 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><a href="http://nsis.sourceforge.net/AccessControl_plug-in" target="_blank">http://nsis.sourceforge.net/AccessControl_plug-in</a></p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">mhatreakshay</span><br><span class="post-time small text-muted">20th May 2011 08:06 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">thank you.Is this the only option to handle this issue ?<br>cant the installer by default permission the local user for accessing the files if administrator is installating in his local directory?</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">MSG</span><br><span class="post-time small text-muted">20th May 2011 09:01 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Yes, it can. Using the AccessControl plugin.<br><br>NSIS doesn't do anything automatically. You must tell it what to do.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">mhatreakshay</span><br><span class="post-time small text-muted">20th May 2011 11:29 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">but i have issues only with files with the extensions<br>.bat , .jnlp , .xml ..<br>I the local user can access .exe and other files properly.so i am bit confused with this behavior.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">MSG</span><br><span class="post-time small text-muted">20th May 2011 19:56 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">I've no idea what you're trying to accomplish. Is there a specific question, in there?</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">mhatreakshay</span><br><span class="post-time small text-muted">23rd May 2011 09:08 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">sorry for the confusion.let me explain it.<br>I have created a installer which installs my application.<br>once installed ,it has .bat , .jnlp, .xml , unistall.exe , .jar and other extension files.<br>I logged in as a Adminitrator(amhatre) in my system and installed this application for a local user in the local users directory C:\Documents and Settings\xyz.<br>Now the problem is ,local user "xyz" cant launched the application using the .bat file.<br>He gets a permission denied error.<br>But at the same time local user "xyz" can access the uninstall.exe and uninstall the application.<br><br>So my question is ,<br>Why is that the local users cant access files with specific extension ,.bat in this case ?<br>do i need to do something special for this to work ?<br>And how will i be able to use access control ,if required in such scenario ?<br><br>Thank you in advance.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">mhatreakshay</span><br><span class="post-time small text-muted">23rd May 2011 12:00 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">hey its leting the user access uninstall.exe since its been creating using . WriteUninstaller.<br>but other issues still persist.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br><span class="post-time small text-muted">24th May 2011 10:14 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">If it's just the batch file with the issue, how about replacing it with an executable. You could even write the executable in NSIS (use SilentInstall silent).<br><br>Stu</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">MSG</span><br><span class="post-time small text-muted">24th May 2011 18:33 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">It may very well be that he's trying to do some writing commands in the .bat, and that those commands are throwing an access denied error.<br><br>Once again, use the accesscontrol plugin to give users access.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br><span class="post-time small text-muted">24th May 2011 18:48 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">If you can avoid having to change permissions then that would be best. The files and folders you extract/create should be inheriting the permissions from their parent. And applying permissions for that user is easier said than done. How can he be sure what the user name is? Perhaps get it from the path but that is messy. Perhaps you shouldn't be allowing the user to install to certain paths.<br><br>Stu</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">MSG</span><br><span class="post-time small text-muted">24th May 2011 21:12 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"></p><blockquote><small>Originally posted by Afrow UK</small><br>If you can avoid having to change permissions then that would be best.</blockquote>True enough. But since he's not saying what exactly is failing...<br><br><blockquote><small>Originally posted by Afrow UK</small><br>Perhaps you shouldn't be allowing the user to install to certain paths.</blockquote>I think he's installing there on purpose. I've never heard of an end-user manually selecting the user profile folder, regardless of whether the installer was elevated or not.</div><hr><div class="footer"><p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p></div></div><script type="text/javascript" src="../js/highlight.pack.js" async></script><script type="text/javascript">//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]></script></body></html>