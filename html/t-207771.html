<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="description" content="Createshortcut Problems"><title>Createshortcut Problems - NSIS Forums</title><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script><link rel="preload" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css" as="style" onload="this.rel='stylesheet'"><link rel="preload" href="../css/style.css" as="style" onload="this.rel='stylesheet'"><noscript><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css"><link rel="stylesheet" href="../css/style.css"></noscript><script>!function(a){"use strict";var b=function(b,c,d){function e(a){return h.body?a():void setTimeout(function(){e(a)})}function f(){i.addEventListener&&i.removeEventListener("load",f),i.media=d||"all"}var g,h=a.document,i=h.createElement("link");if(c)g=c;else{var j=(h.body||h.getElementsByTagName("head")[0]).childNodes;g=j[j.length-1]}var k=h.styleSheets;i.rel="stylesheet",i.href=b,i.media="only x",e(function(){g.parentNode.insertBefore(i,c?g:g.nextSibling)});var l=function(a){for(var b=i.href,c=k.length;c--;)if(k[c].href===b)return a();setTimeout(function(){l(a)})};return i.addEventListener&&i.addEventListener("load",f),i.onloadcssdefined=l,l(f),i};"undefined"!=typeof exports?exports.loadCSS=b:a.loadCSS=b}("undefined"!=typeof global?global:this);!function(a){if(a.loadCSS){var b=loadCSS.relpreload={};if(b.support=function(){try{return a.document.createElement("link").relList.supports("preload")}catch(b){return!1}},b.poly=function(){for(var b=a.document.getElementsByTagName("link"),c=0;c<b.length;c++){var d=b[c];"preload"===d.rel&&"style"===d.getAttribute("as")&&(a.loadCSS(d.href,d,d.getAttribute("media")),d.rel=null)}},!b.support()){b.poly();var c=a.setInterval(b.poly,300);a.addEventListener&&a.addEventListener("load",function(){b.poly(),a.clearInterval(c)}),a.attachEvent&&a.attachEvent("onload",function(){a.clearInterval(c)})}}}(this);</script></head><body><div class="container"><ol class="breadcrumb"><li><a href="../index.html" class="glyphicon glyphicon-home"></a></li><li><a href="f-65.html">NSIS Discussion</a></li><li class="active">Createshortcut Problems</li></ol><p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=207771">Createshortcut Problems</a></p><br><div class="post"><p class="post-meta"><span class="post-author text-primary">Tmort</span><br><span class="post-time small text-muted">14th February 2005 16:20 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>Createshortcut Problems</strong><br>I'm trying to create a shortcut, particularly on the Desktop and specify an icon.<br><br>I have output set to "$INSTDIR" and this is where all the files a copied to including the icon file.<br><br>I've tried a few variations and I can get the code to compile but it doesn't create a shortcut when I run it.<br><br>The section of code is:<br><br>SetOutPath "$INSTDIR"<br>SetOverwrite ifnewer<br>;File "..\..\path\to\file\mydb.mdb"<br>CreateDirectory "$SMPROGRAMS\mydb"<br>CreateShortCut "$SMPROGRAMS\mydb\mydb.lnk" "$INSTDIR\mydb.mdb" "mydb icon.ico"<br>CreateShortCut "$DESKTOP\mydb.lnk" "$INSTDIR\mydb.mdb" "mydb icon.ico"<br><br>Thanks in advance for the help</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br><span class="post-time small text-muted">14th February 2005 16:39 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">You use SetOutPath to set the 'Start in' path for shortcuts. You need to specify the full path to your icon:<br>"$INSTDIR\mydb icon.ico"<br><br>-Stu</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Tmort</span><br><span class="post-time small text-muted">14th February 2005 21:14 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">I guess I don't get it.<br><br>I've tried:<br><br>Section "MainSection" SEC01<br>SetOutPath "$INSTDIR"<br>SetOverwrite ifnewer<br>;File "..\..\path\to\file\mydb.mdb"<br>CreateDirectory "$SMPROGRAMS\mydb"<br><br>;File "..\..\path\to\file\Example.file"<br>File "mydb.mdb"<br>File "mydb Icon.ico"<br>File "mydb_DATA.mdb"<br>SetOutPath "$instdir\mydb icon.ico"<br>CreateShortCut "$SMPROGRAMS\mydb\mydb.lnk" "$INSTDIR\mydb.mdb" "$instdir\mydb icon.ico"<br>CreateShortCut "$DESKTOP\iwcd.lnk" "$INSTDIR\mydb.mdb" "$instdir\mydb icon.ico"<br><br>SectionEnd<br><br>What am I missing?<br><br>Thanks</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">kichik</span><br><span class="post-time small text-muted">19th January 2007 13:57 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">The icon path is the fourth parameter. The third parameter is the command line parameters. Add an empty set of quotes between the mdb and the file and it should work.</p></div><hr><div class="footer"><p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p></div></div><script src="../js/highlight.pack.js" type="text/javascript"></script><script type="text/javascript">//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]></script></body></html>