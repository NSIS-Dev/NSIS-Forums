<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="description" content="How to use switch /sms?"><title>How to use switch /sms? - NSIS Forums</title><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script><link rel="preload" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css" as="style" onload="this.rel='stylesheet'"><link rel="preload" href="../css/style.css" as="style" onload="this.rel='stylesheet'"><noscript><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css"><link rel="stylesheet" href="../css/style.css"></noscript><script>!function(a){"use strict";var b=function(b,c,d){function e(a){return h.body?a():void setTimeout(function(){e(a)})}function f(){i.addEventListener&&i.removeEventListener("load",f),i.media=d||"all"}var g,h=a.document,i=h.createElement("link");if(c)g=c;else{var j=(h.body||h.getElementsByTagName("head")[0]).childNodes;g=j[j.length-1]}var k=h.styleSheets;i.rel="stylesheet",i.href=b,i.media="only x",e(function(){g.parentNode.insertBefore(i,c?g:g.nextSibling)});var l=function(a){for(var b=i.href,c=k.length;c--;)if(k[c].href===b)return a();setTimeout(function(){l(a)})};return i.addEventListener&&i.addEventListener("load",f),i.onloadcssdefined=l,l(f),i};"undefined"!=typeof exports?exports.loadCSS=b:a.loadCSS=b}("undefined"!=typeof global?global:this);!function(a){if(a.loadCSS){var b=loadCSS.relpreload={};if(b.support=function(){try{return a.document.createElement("link").relList.supports("preload")}catch(b){return!1}},b.poly=function(){for(var b=a.document.getElementsByTagName("link"),c=0;c<b.length;c++){var d=b[c];"preload"===d.rel&&"style"===d.getAttribute("as")&&(a.loadCSS(d.href,d,d.getAttribute("media")),d.rel=null)}},!b.support()){b.poly();var c=a.setInterval(b.poly,300);a.addEventListener&&a.addEventListener("load",function(){b.poly(),a.clearInterval(c)}),a.attachEvent&&a.attachEvent("onload",function(){a.clearInterval(c)})}}}(this);</script></head><body><div class="container"><ol class="breadcrumb"><li><a href="../index.html" class="glyphicon glyphicon-home"></a></li><li><a href="f-65.html">NSIS Discussion</a></li><li class="active">How to use switch /sms?</li></ol><p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=330499">How to use switch /sms?</a></p><br><div class="post"><p class="post-meta"><span class="post-author text-primary">JohnChen</span><br><span class="post-time small text-muted">10th May 2011 22:41 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>How to use switch /sms?</strong><br>I call ExecWait with the switch /sms to make the uninstaller wait until it is done. But it doesn't wait. Here is how I use it.<br><br>ExecWait '"$R0" /sms'<br><br>Here $R0 is an executable. Thanks.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Anders</span><br><span class="post-time small text-muted">10th May 2011 22:57 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">/sms is not a NSIS switch...</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">JohnChen</span><br><span class="post-time small text-muted">10th May 2011 23:01 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"></p><blockquote><small>Originally posted by Anders</small><br>/sms is not a NSIS switch...</blockquote>I see. So how can I do the similar thing like /sms in NSIS? Thanks.</div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">T.Slappy</span><br><span class="post-time small text-muted">11th May 2011 07:28 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">What does /sms do?</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">JohnChen</span><br><span class="post-time small text-muted">11th May 2011 16:53 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"></p><blockquote><small>Originally posted by T.Slappy</small><br>What does /sms do?</blockquote>/sms makes ExecWait wait until the current uninstallation is done.</div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">JohnChen</span><br><span class="post-time small text-muted">11th May 2011 16:54 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"></p><blockquote><small>Originally posted by JohnChen</small><br>I call ExecWait with the switch /sms to make the uninstaller wait until it is done. But it doesn't wait. Here is how I use it.<br><br>ExecWait '"$R0" /sms'<br><br>Here $R0 is an executable. Thanks.</blockquote>FYI, _?=$INSTDIR' works for me. It looks like _?=$INSTDIR' works with NSIS ExecWait. Thanks.</div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">JohnChen</span><br><span class="post-time small text-muted">11th May 2011 17:15 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"></p><blockquote><small>Originally posted by JohnChen</small><br>FYI, _?=$INSTDIR' works for me. It looks like _?=$INSTDIR' works with NSIS ExecWait. Thanks.</blockquote>Does any one know why _?=$INSTDIR ? I found it on the web but I don't really know what it is. Thanks.</div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br><span class="post-time small text-muted">11th May 2011 17:22 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">It has nothing to do with ExecWait really. All it does is stops the uninstaller copying itself to %TEMP% and relaunching from there (i.e. spawning a new process and so the old process closes; ExecWait returns).<br><br><a href="http://nsis.sourceforge.net/Docs/Chapter3.html#3.2.2" target="_blank">http://nsis.sourceforge.net/Docs/Chapter3.html#3.2.2</a><br><br>Stu</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">RaggieSoft</span><br><span class="post-time small text-muted">12th May 2011 03:51 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>An answer</strong><br>/sms is an old switch from InstallShield 3 and InstallShield 5 installers (popular around the Windows 95/98 era, InstallShield 6 did away with /sms - it came out around the time of Windows 2000)<br><br>What it did:<br><br>Back then, you would see "Setup is preparing the InstallShield wizard..." along with a progress bar. That EXE would immediately exit upon launch of the main installer (I'm talking installer, not uninstaller). SMS is Microsoft's Systems Management Server (I don't think they make it any more) and calling an InstallShield EXE with /sms was how you got SMS (or any other program, like a parent installation calling a 3rd party redist installer) to WAIT for installation to finish. My guess is that InstallShield assumed most people needing to keep a parent waiting were using Microsoft's SMS (thus why the switch is "/sms")<br><br>An alternative would be the old WinZip Self-Extractor being told to wait for a program called _ISDEL to run (this would clean up InstallShield EXE temporary files after installation is completed).<br><br>Granted, these were done in enterprises long before Microsoft came out with Windows Installer, and this is the very old way to do it.<br><br><br>Hope this answers any questions on what /sms is. I haven't seen it discussed in years</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">RaggieSoft</span><br><span class="post-time small text-muted">12th May 2011 03:58 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Assuming you're trying to uninstall a program from a parent uninstaller (and you want the parent uninstaller to <b>wait</b> for the child), here's how to duplicate:<br><br>In this example, the child program uninstaller is called uninstall.exe and the child program is installed to C:\Program Files (x86)\Program 2\<br><br>1. Your parent uninstaller needs to COPY the child's uninstaller EXE to another folder such $TEMP. This is because Windows doesn't allow an EXE to delete itself<br>2. the PARENT uninstaller would then call ExecWait $TEMP\uninstall.exe _?=C:\Program Files (x86)\Program 2\. (this path shouldn't be hard coded - your uninstaller should use a registry key/value (for example, as it's fastest) to grab the path of the child)</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">JohnChen</span><br><span class="post-time small text-muted">12th May 2011 20:03 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"></p><blockquote><small>Originally posted by RaggieSoft</small><br>Assuming you're trying to uninstall a program from a parent uninstaller (and you want the parent uninstaller to <b>wait</b> for the child), here's how to duplicate:<br><br>In this example, the child program uninstaller is called uninstall.exe and the child program is installed to C:\Program Files (x86)\Program 2\<br><br>1. Your parent uninstaller needs to COPY the child's uninstaller EXE to another folder such $TEMP. This is because Windows doesn't allow an EXE to delete itself<br>2. the PARENT uninstaller would then call ExecWait $TEMP\uninstall.exe _?=C:\Program Files (x86)\Program 2\. (this path shouldn't be hard coded - your uninstaller should use a registry key/value (for example, as it's fastest) to grab the path of the child)</blockquote>If the uninstaller has one parameter, so I thought I should call ExecWait like this,'<br>ExecWait '"$0" "$1" "_?=$INSTDIR"'<br>Here $0 is uninstaller and $1 is its parameter. But I got an error like "Parsing Failed: Unable to open file _?". What did I wrong? Thanks.</div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br><span class="post-time small text-muted">12th May 2011 21:02 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Read the manual page that I linked to.<br><br>Stu</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">JohnChen</span><br><span class="post-time small text-muted">12th May 2011 21:21 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"></p><blockquote><small>Originally posted by Afrow UK</small><br>Read the manual page that I linked to.<br><br>Stu</blockquote>Actually I did. The manual page you linked to contains some examples demonstrating how to use ExecWait with _?=. But in those examples, the uninstaller doesn't take any parameter. My specific problem is related to that when the uninstaller takes one parameter, ExecWait failed with error message like "Parsing Failed: Unable to open file _?"<br>Here is how I did,<br>ExecWait '"$0" "$1" "_?=$INSTDIR"'<br>$0 is the uninstaller and $1 is its parameter. Is there anything wrong in this statement? Thanks.</div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br><span class="post-time small text-muted">12th May 2011 21:24 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">You missed this:</p><blockquote>It must be the last parameter used in the command line and must not contain any quotes, even if the path contains spaces.</blockquote>Edit: I.e. ExecWait '"$0" "$1" _?=$INSTDIR'<br><br>Stu</div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">JohnChen</span><br><span class="post-time small text-muted">12th May 2011 22:25 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"></p><blockquote><small>Originally posted by Afrow UK</small><br>You missed this:Edit: I.e. ExecWait '"$0" "$1" _?=$INSTDIR'<br><br>Stu</blockquote>Unfortunately this one doesn't work either. Say if $INSTDIR = "C:\Another folder\Myfolder", I got a similar error like "Parsing Failed: Unable to open file folder\Myfolder". Notice that there is a space between "Another" and "folder".<br><br>Based on your solution, here is the summary,<br><br>ExecWait '"$0" "$1" _?=C:\Another folder\Myfolder'<br>error msg: Unable to open file folder\Myfolder<br><br>ExecWait '"$0" "$1" _?=C:\Temp'<br>error msg: Unable to open file _?<br><br>Errors above happen only when the uninstaller($0) takes one parameter. If the uninstaller doesn't take any parameter, it works fine for both cases. Any idea why? Thanks a lot.</div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br><span class="post-time small text-muted">12th May 2011 23:39 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">I've never encountered that error. I will look in the source code when I can. Just to be sure, it is an NSIS uninstall executable you are running, not some other one?<br><br>Stu</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">JohnChen</span><br><span class="post-time small text-muted">13th May 2011 00:05 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"></p><blockquote><small>Originally posted by Afrow UK</small><br>I've never encountered that error. I will look in the source code when I can. Just to be sure, it is an NSIS uninstall executable you are running, not some other one?<br><br>Stu</blockquote>Yes, I am sure I am running NSIS. Have you ever tried the case where you use ExecWait to run the uninstaller which takes one parameter together with "_?=" option ? Thanks.</div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br><span class="post-time small text-muted">13th May 2011 11:13 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Yes I have tried. This works:</p><pre>
<code>!include MUI2.nsh<br><br>OutFile TestUninstall.exe<br>InstallDir $EXEDIR<br><br>!insertmacro MUI_PAGE_INSTFILES<br>!insertmacro MUI_UNPAGE_INSTFILES<br>!insertmacro MUI_LANGUAGE English<br><br>Section<br><br>  WriteUninstaller $INSTDIR\un.exe<br>  ExecWait `"$INSTDIR\un.exe" /a /b _?=$INSTDIR`<br>  Delete $INSTDIR\un.exe<br><br>SectionEnd<br><br>Section Uninstall<br>SectionEnd</code>
</pre>Stu
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br>
      <span class="post-time small text-muted">13th May 2011 11:25 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">I can't find a "Parsing Failed: Unable to open file" in the source code so I highly doubt your uninstall executable is an NSIS one (i.e. generated with WriteUninstaller). NSIS only has a generic "Error launching installer" message. You do realise that _?= is specific to NSIS uninstall executables...<br>
      <br>
      Stu</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">JohnChen</span><br>
      <span class="post-time small text-muted">13th May 2011 11:25 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"></p>

      <blockquote>
        <small>Originally posted by Afrow UK</small><br>
        Yes I have tried. This works:
        <pre>
<code>!include MUI2.nsh<br><br>OutFile TestUninstall.exe<br>InstallDir $EXEDIR<br><br>!insertmacro MUI_PAGE_INSTFILES<br>!insertmacro MUI_UNPAGE_INSTFILES<br>!insertmacro MUI_LANGUAGE English<br><br>Section<br><br>  WriteUninstaller $INSTDIR\un.exe<br>  ExecWait `"$INSTDIR\un.exe" /a /b _?=$INSTDIR`<br>  Delete $INSTDIR\un.exe<br><br>SectionEnd<br><br>Section Uninstall<br>SectionEnd</code>
</pre>Stu
      </blockquote>Thanks for your reply. But /a or /b is not considered as a parameter of un.exe and they are just switch. A uninstaller with a switch works for me too. The only problem for me is that if a uninstaller takes a parameter. For example, if un.exe needs a file as an input parameter, you would call ExecWait like this,<br>
      <br>
      ExecWait `"$INSTDIR\un.exe" "$INSTDIR\someFile.txt" _?=$INSTDIR`<br>
      <br>
      I wonder if it works for you too? Thanks a lot.
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br>
      <span class="post-time small text-muted">13th May 2011 11:29 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"></p>

      <blockquote>
        But /a or /b is not considered as a parameter of un.exe and they are just switch.
      </blockquote>There is no difference between a 'parameter' and a 'switch'. A program simply splits up the tokens on its command line with whitespace as the delimiter. If you tried the code yourself you'd see it works fine substituting /a with "$INSTDIR\someFile.txt".<br>
      <br>
      Edit: And the uninstaller doesn't care whether the parameter begins with / or not. It only looks for the first token that begins with _?=, removes that (and proceeding tokens) and then puts the remainder into $CMDLINE which you can use from your uninstall code. It is up to your uninstaller code to handle the parameters from there.<br>
      <br>
      Stu
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">JohnChen</span><br>
      <span class="post-time small text-muted">13th May 2011 11:48 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"></p>

      <blockquote>
        <small>Originally posted by Afrow UK</small><br>
        There is no difference between a 'parameter' and a 'switch'. A program simply splits up the tokens on its command line with whitespace as the delimiter. If you tried the code yourself you'd see it works fine substituting /a with "$INSTDIR\someFile.txt".<br>
        <br>
        Edit: And the uninstaller doesn't care whether the parameter begins with / or not. It only looks for the first token that begins with _?=, removes that (and proceeding tokens) and then puts the remainder into $CMDLINE which you can use from your uninstall code. It is up to your uninstaller code to handle the parameters from there.<br>
        <br>
        Stu
      </blockquote>Before I discuss further, may I ask a simple question? Who is responsible for parsing _?= part? Thanks.
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">JohnChen</span><br>
      <span class="post-time small text-muted">13th May 2011 11:58 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"></p>

      <blockquote>
        <small>Originally posted by Afrow UK</small><br>
        I can't find a "Parsing Failed: Unable to open file" in the source code so I highly doubt your uninstall executable is an NSIS one (i.e. generated with WriteUninstaller). NSIS only has a generic "Error launching installer" message. You do realise that _?= is specific to NSIS uninstall executables...<br>
        <br>
        Stu
      </blockquote>This is very possible. Thanks for your information. Actually the uninstaller in question is a third party uninstaller. If this third party uninstaller is not a NSIS one, is there any way to make it work like a NSIS one? Thanks.
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br>
      <span class="post-time small text-muted">13th May 2011 12:00 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">_?= is specific to NSIS uninstall executables (i.e. those generated via WriteUninstaller). The NSIS uninstaller, when executed with this option, automatically handles _?= itself. ExecWait does not handle _?= (perhaps this is what you are confused about). You can use _?= via cmd.exe or via a shortcut; it doesn't matter.<br>
      <br>
      Therefore, you must be trying to execute an uninstall executable which does not know what _?= is (because it's not an NSIS uninstall executable).<br>
      <br>
      Stu</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br>
      <span class="post-time small text-muted">13th May 2011 12:02 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"></p>

      <blockquote>
        If this third party uninstaller is not a NSIS one, is there any way to make it work like a NSIS one?
      </blockquote>You'll need to find out what uninstaller it is (i.e. is it Wise, InnoSetup etc.) and determine the correct command line argument to use to prevent it from spawning a new process.<br>
      <br>
      Stu
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">JohnChen</span><br>
      <span class="post-time small text-muted">13th May 2011 14:46 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"></p>

      <blockquote>
        <small>Originally posted by Afrow UK</small><br>
        _?= is specific to NSIS uninstall executables (i.e. those generated via WriteUninstaller). The NSIS uninstaller, when executed with this option, automatically handles _?= itself. ExecWait does not handle _?= (perhaps this is what you are confused about). You can use _?= via cmd.exe or via a shortcut; it doesn't matter.<br>
        <br>
        Therefore, you must be trying to execute an uninstall executable which does not know what _?= is (because it's not an NSIS uninstall executable).<br>
        <br>
        Stu
      </blockquote>How can I use WriteUninstaller in a uninstall section? In a uninstall section functions are expected to have un.. But un.WriteUninstaller is not defined. Thanks.
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br>
      <span class="post-time small text-muted">13th May 2011 14:54 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Are you getting confused on something else now? Look up WriteUninstaller in the manual. Perhaps you should explain what you are trying to achieve...<br>
      <br>
      Stu</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">JohnChen</span><br>
      <span class="post-time small text-muted">13th May 2011 15:20 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"></p>

      <blockquote>
        <small>Originally posted by Afrow UK</small><br>
        Are you getting confused on something else now? Look up WriteUninstaller in the manual. Perhaps you should explain what you are trying to achieve...<br>
        <br>
        Stu
      </blockquote>Actually, I was trying to use WriteUninstaller to convert a non-NSIS uninstaller to a NSIS uninstaller. But it doesn't look like it works that way. So if I get a non-NSIS uninstaller, is there any way I can use in NSIS? Thanks.
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br>
      <span class="post-time small text-muted">13th May 2011 15:33 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Well logically you have two options:<br>
      <br>
      1. Convert the 3rd party uninstaller to NSIS by writing NSIS script<br>
      2. Execute the existing one (as you are trying to do)<br>
      <br>
      The 2nd option is easiest obviously.<br>
      <br>
      Stu</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">JohnChen</span><br>
      <span class="post-time small text-muted">13th May 2011 15:41 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"></p>

      <blockquote>
        <small>Originally posted by Afrow UK</small><br>
        Well logically you have two options:<br>
        <br>
        1. Convert the 3rd party uninstaller to NSIS by writing NSIS script<br>
        2. Execute the existing one (as you are trying to do)<br>
        <br>
        The 2nd option is easiest obviously.<br>
        <br>
        Stu
      </blockquote>But if I choose 2nd option, the existing uninstaller doesn't know how to parse _?=. If I choose 1st option, would you please provide me a sample script how to convert the 3rd party uninstaller to NSIS? Thanks a lot.
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br>
      <span class="post-time small text-muted">13th May 2011 15:47 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">As I said before, you need to identify the type of uninstaller and find a suitable switch which does what _?= does in NSIS uninstallers. And I don't mean to write NSIS script to do the conversion lol... you need to follow the tasks the 3rd party uninstaller does and do those tasks in your NSIS uninstall script. Run the 3rd party uninstaller from a sandbox such as Sandboxie. That is what I have done in the past.<br>
      <br>
      Stu</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">JohnChen</span><br>
      <span class="post-time small text-muted">13th May 2011 18:11 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">There is one related issue with using _?= option. Since _?= stops uninstaller from copying itself to the temporary directory, as the result, the uninstaller couldn't be removed(it couldn't remove itself). Since the uninstaller couldn't be removed, the folder where the uninstaller is located couldn't be removed. I wonder if there is way to keep two good things at the same time. One good thing is allow ExecWait to wait for the uninstaller to finish. Another good thing is still allow users to remove the whole folder where the uninstaller is located.</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br>
      <span class="post-time small text-muted">13th May 2011 18:20 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Copy the uninstaller to $PLUGINSDIR and then run it from there with _?=$INSTDIR.<br>
      <br>
      Stu</p>
    </div>
    <hr>

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]></script></body></html>