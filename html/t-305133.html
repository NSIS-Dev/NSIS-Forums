<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="description" content="What about this NSIS installer script - possible or not?"><title>What about this NSIS installer script - possible or not? - NSIS Forums</title><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script><link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css"><link rel="stylesheet" href="../css/style.css" type="text/css"></head><body><div class="container"><ol class="breadcrumb"><li><a href="../index.html" class="glyphicon glyphicon-home"></a></li><li><a href="f-65.html">NSIS Discussion</a></li><li class="active">What about this NSIS installer script - possible or not?</li></ol><p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=305133">What about this NSIS installer script - possible or not?</a></p><br><div class="post"><p class="post-meta"><span class="post-author text-primary">underline</span><br><span class="post-time small text-muted">9th April 2009 02:01 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>What about this NSIS installer script - possible or not?</strong><br>Hello everyone,<br><br>I want to create an NSIS script and I need your help:<br><br>I have next files:<br><br>file1.exe<br>file2.exe<br>file3.dll<br>file4.dll<br>file5.dat<br>file6.dat<br><br>and I want all files to be added to an installer with the next options:<br><br>The installer should extract all files to temp folder, then the file "file1.exe" should start, then the files should be copied/moved to the Windows/system32 folder and deleted from temp folder, then file2.exe should start.<br><br>I use the next NSIS script to create an installer that extract the files on Windows temp folder and then run file1.exe but don't know how to update it to copy/move the files to Windows\system32 folder and then run file2.exe<br><br>Here is the script so please any help to update it or give me a new solution will be highly appreciated. Here is the script:<br><br><br><br>OutFile "installer.exe"<br>Icon "name.ico"<br>SilentInstall Silent<br>WindowIcon Off<br>CRCCheck On<br>SetCompress Off<br>RequestExecutionLevel highest<br><br>Section<br><br>; Generate a temp file name<br>GetTempFileName $0<br>; Delete it and replace it with a folder<br>Delete $0<br>CreateDirectory $0<br><br>; Report any problem<br>IFErrors 0 +2<br>Abort "Can't install application! Please contact support."<br><br>; Unpack files<br>SetOutPath $0<br><br>; Pack all the files in the current directory and its subdirectories,<br>; excluding anything in SVN<br>; File /r /x .svn "*.*"<br>File /r /x .svn /x *.ico /x *.nsi "*.*" ; Also exclude the ICO and NSI files from installer<br><br>; Run the executable and wait<br>ClearErrors<br>SetOutPath "$0\"<br><br>; IMPORTANT: Place the name of your starting executable (i.e. the file to run<br>; when unpacked) here.<br>ExecWait "$0\file1.exe"<br><br>IFErrors 0 +2<br>Abort "Can't run app! Please contact support."<br><br>; And delete the unpacked files<br>ClearErrors<br>SetOutPath $TEMP ; Need to do this because we can't delete the working folder<br>RMDir /r $0 ; If there's an error we probably don't really care, as it's in a temp folder<br><br>SectionEnd<br><br><br><br><br><br>Thank you in advance for your help.<br>If anyone can offer me real support then I can pay him for the time spent for me!<br><br>Thanks!</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Red Wine</span><br><span class="post-time small text-muted">9th April 2009 02:22 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Unpack your files in $PLUGINSDIR which is removed upon terminating the installer. (see the manual)<br><br>ExecWait or nsExec the file1.exe (see the manual again)<br><br>Once the file1.exe has finished CopyFiles or Rename from the $PLUGINSDIR to $SYSDIR (once again see the manual)<br><br>Finally launch file2.exe with Exec or ExecWait or nsExec if you're dealing with console applications.<br><br>What else? Read the documentation.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">underline</span><br><span class="post-time small text-muted">9th April 2009 17:40 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Red Wine, thank you so much for your reply!<br><br>I am just beginner with NSIS and I need someone to update my script (or post a new one) for my case.<br><br>As I said before, if anyone can offer me professional support and help me with what I need, I can pay with PayPal for that, just let me know!<br><br>If anyone can update my script or create a new one for my case please let me know.<br><br>Thank you!</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Red Wine</span><br><span class="post-time small text-muted">9th April 2009 21:10 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Nevertheless, you'll need to provide more details about the task.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">underline</span><br><span class="post-time small text-muted">9th April 2009 21:55 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Red Wine, thank you again for your reply!<br><br>I will try to give you more info as requested:<br><br>I will rename the files to make you understand much better what I need:<br><br>uninstall.exe<br>uninstall.dat<br>installer.exe<br>installer.dll<br>installer.dat<br><br>Now I need an installer with all the above files inside and the installer should unpack the files on Windows TEMP folder, then next run the uninstall.exe file (this will uninstall any previous installed version of the application which is installed on Windows system32 folder) then once any old version is uninstalled the installer files (installer.exe, installer.dll, installer.dat) should be copied/moved to Windows system32 folder and the file installer.exe should be executed. After this is completed the temp files should be deleted.<br><br>Also next options should be there:<br><br>SilentInstall Silent ; for Silent install<br>RequestExecutionLevel highest ; for Vista<br>CRCCheck On ; I think is needed<br>SetCompress Off ; I think is needed for faster extraction<br><br>If you need more info please let me know and if you spend your time to help me I don't want you to do it for nothing, I want to pay you for that and maybe we can continue future collaboration.<br><br>Thanks!</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Red Wine</span><br><span class="post-time small text-muted">9th April 2009 22:14 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Okay, do you want to upload the files somewhere and give the link to download them and build your installation or you prefer a script on which you'll replace the file names and the local paths in order to compile it your self?</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">underline</span><br><span class="post-time small text-muted">9th April 2009 22:19 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Red Wine, thank you!<br><br>I prefer a script on which I will replace the file names and the local paths in order to compile it my self.<br><br>In the script I post it I should have the files in one folder and the script will add all the files inside the folder to installer excepting the .svn , .nsi and .ico files which not needed on the installer. I preffer same way when I create the installer but only if is possible.<br><br>Thanks!</p></div><hr><div class="footer"><p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p></div></div><script src="../js/highlight.pack.js" type="text/javascript"></script><script type="text/javascript">//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]></script></body></html>