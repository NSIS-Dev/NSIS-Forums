<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="CommandLine param with CreateShortCut" />

  <title>CommandLine param with CreateShortCut - NSIS Forums</title><!-- Bootstrap core CSS -->
  <link rel="stylesheet" type="text/css" href="//netdna.bootstrapcdn.com/bootswatch/3.0.1/readable/bootstrap.min.css" />
  <link rel="stylesheet" href="../css/style.css" type="text/css" /><!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!--[if lt IE 9]>
                <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
                <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->
</head>

<body>
  <div class="container">
    <!-- Put navigation bar here -->

    <ol class="breadcrumb">
      <li><a href="../index.html" class="glyphicon glyphicon-home"></a></li>

      <li><a href="f-65.html">NSIS Discussion</a></li>

      <li class="active">CommandLine param with CreateShortCut</li>
    </ol>

    <p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=89978">CommandLine param with CreateShortCut</a></p><br />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">mcollins</span><br />
      <span class="post-time small text-muted">4th June 2002 21:33 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>CommandLine param with CreateShortCut</strong><br />
      Hey here is the problem i am having. I am trying to create a shortcut that contains a command line parameter for the exe it points to. When i run this ....<br />
      <br />
      CreateShortCut "$DESKTOP\Whatever.lnk" '"C:\Test.ext" /c "MyString"'<br />
      <br />
      it creates the shortcut just fine except it switches the "/c" to "\c" and so link does not work correctly. Does anyone know why its switching the slashes on me and how i can fix this problem? I've also tried<br />
      <br />
      CreateShortCut "$DESKTOP\Whatever.lnk" '"C:\Test.ext" '/c' "MyString"'<br />
      <br />
      and that didnt work either. Any help you can offer would be appreciated.<br />
      <br />
      Thnx,<br />
      Mark</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Smile2Me</span><br />
      <span class="post-time small text-muted">5th June 2002 07:40 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">I guess MyString is also a parameter. Then you should put both parameters into 1 string, like this:<br />
      CreateShortCut "$DESKTOP\Whatever.lnk" "C:\Test.ext" "/c MyString"<br />
      <br />
      -Hendri.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">mcollins</span><br />
      <span class="post-time small text-muted">5th June 2002 17:19 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">'"C:\Test.exe" /c "MyString"' (which is what ive been using) is actually one string that is contained inside single quotes. i did it that way because in the target path of the link file there are parts of the string that need to be in double quotes. If you were to right click and look at the properties of the icon, this is what should be in the target path...<br />
      "C:\Test.exe" /c "MyString"</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
      <span class="post-time small text-muted">5th June 2002 18:13 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">The problem is that the parameters should come in a seprate string.<br />
      <br /></p>

      <blockquote>
        CreateShortCut link.lnk target.file [parameters] [icon.file] [icon_index_number] [start_options] [keyboard_shortcut]
      </blockquote>This is because the Windows function that creates shortcuts also uses two strings. One for the program and the other for the parameters.
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">mcollins</span><br />
      <span class="post-time small text-muted">5th June 2002 18:29 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>Thanks!</strong><br />
      Hey thanks a lot man! Spliting up the string solved my problem. Guess i just wasnt comprehending the documentation.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Smile2Me</span><br />
      <span class="post-time small text-muted">6th June 2002 07:36 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Thx KiCHiK for explaining again. My solution was correct but apparently not clear to everyone. I'll be more clear next time.<br />
      <br />
      -Hendri.</p>
    </div>
    <hr />

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]>
  </script>
</body>
</html>
