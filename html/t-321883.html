<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="FlipPages - Paging non-linearly between custom pseudopages" />

  <title>FlipPages - Paging non-linearly between custom pseudopages - NSIS Forums</title>
  <script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script>
  <!-- Bootstrap core CSS -->

  <link rel="stylesheet" type="text/css" href="//netdna.bootstrapcdn.com/bootswatch/3.0.1/readable/bootstrap.min.css" />
  <link rel="stylesheet" href="../css/style.css" type="text/css" /><!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!--[if lt IE 9]>
                <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
                <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->
</head>

<body>
  <div class="container">
    <!-- Put navigation bar here -->

    <ol class="breadcrumb">
      <li><a href="../index.html" class="glyphicon glyphicon-home"></a></li>

      <li><a href="f-65.html">NSIS Discussion</a></li>

      <li class="active">FlipPages - Paging non-linearly between custom pseudopages</li>
    </ol>

    <p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=321883">FlipPages - Paging non-linearly between custom pseudopages</a></p><br />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Animaether</span><br />
      <span class="post-time small text-muted">22nd August 2010 21:57 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>FlipPages - Paging non-linearly between custom pseudopages</strong><br />
      I stumbled across a script I started many years ago that was supposed to let me move an overly complex installer back-and-forth between <i>custom</i> pages non-linearly;<br />
      you know the kind: you have a main page with components with sub-settings, let the user configure that component in further pages, and you want to end up back at the main page. Could 'solve' that with a secondary installer that gets run and stores the settings somewhere (temp file, registry, etc.), or you could get tricky..<br />
      <br />
      ..but then deguix wrote the RelGotoPage function ( <a href="http://nsis.sourceforge.net/Go_to_a_NSIS_page" target="_blank">http://nsis.sourceforge.net/Go_to_a_NSIS_page</a> ) and I quickly dropped what I was working on.<br />
      <br />
      Nevertheless, when I saw it again I thought I'd give it a renewed shot now with the awesomeness of nsDialogs.. and lo-and-behold it actually works.<br />
      <br />
      <br />
      I can't think of any -good- reason to use it given RelGotoPage's existence (although I think a recent post mentioned a crash, I suspect that's user error.. but who knows), but I'm dropping it in here anyway. It's a complete example script, rather than an implementation guide, but figuring out what goes where should be pretty self-explanatory (there's comments, of course).<br />
      <br />
      <br />
      I noted at the top (and in the thread title) that it was a method to move between <i>custom</i> pseudopages (the FlipPages) - so just to stress that... it can -only- be used to move between FlipPages within a single Custom Page - not any built-in or MUI or whatnot pages.<br />
      So if you have a typical flow (using, say, MUI) might look like:<br />
      1. MUI Welcome page<br />
      2. Custom Page with FlipPages<br />
      2.1 FlipPage 1<br />
      2.2 FlipPage 2<br />
      2.3 FlipPage 3<br />
      3. MUI Components Page<br />
      4. MUI InstFiles page<br />
      5. MUI Finish page<br />
      Then you can move around inside 2.x, but page 2 can only go back to page 1 or forward to page 3. Page 4 can't go back to Page 2 (except if it first passes Page 3, of course). Page 1 can go forward to any Page 2.x, just as Page 3 can go back to any Page 2.x, by messing with the current page variable in those pages, though.<br />
      Confusing? Good ;)<br />
      <br />
      <br />
      There's two pieces of hack code in there that I'd like to get rid of, but not sure I can (or want to bother to at this time).<br />
      <br />
      The first is detecting which button was pressed. The überhack method does that by getting the hwnd of the control that currently has focus and comparing that to the hwnds of the next/back/cancel buttons. This does mean that Alt+Letter combinations to access those buttons cannot be used (as they don't change the focus like a mouse-click/keyboard navigation do).. hence re-setting the button texts so that no hotkey accessors are available for those buttons. The slightly less hacky method does it through the WndSubClass plug-in ( <a href="http://nsis.sourceforge.net/WndSubclass_plug-in" target="_blank">http://nsis.sourceforge.net/WndSubclass_plug-in</a> ). Ideally, nsDialogs would store the action that caused it to exit. ( There is an onBack event, but that doesn't trigger until the NSIS custom page end )<br />
      <br />
      The second is getting a custom button to cause navigation to another FlipPage. For this nsDialogs needs to exit.. the most logical option there was to 'press' the Next button by making NSIS believe the next button was pressed using BN_CLICKED in a Sendmessage.<br />
      <br />
      <br />
      For the code to make everybody flee back to RelGotoPage like I did those years ago, hit the ZIP attachment.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">MSG</span><br />
      <span class="post-time small text-muted">23rd August 2010 05:13 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"></p>

      <blockquote>
        <small>Originally posted by Animaether</small><br />
        The first is detecting which button was pressed. The überhack method does that by getting the hwnd of the control that currently has focus and comparing that to the hwnds of the next/back/cancel buttons.
      </blockquote>I circumvented this problem by defining a PAGE_NUMBER for every defined page, and before I jump to another page I set a PREVIOUS_PAGE variable to the page I'm about to leave. I then use this variable to see whether I should skip 'ahead' or skip 'backward'. This can make your page functions rather messy, though.
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Animaether</span><br />
      <span class="post-time small text-muted">23rd August 2010 23:33 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"></p>

      <blockquote>
        <small>Originally posted by MSG</small><br />
        I circumvented this problem by defining a PAGE_NUMBER for every defined page, and before I jump to another page I set a PREVIOUS_PAGE variable to the page I'm about to leave. I then use this variable to see whether I should skip 'ahead' or skip 'backward'. This can make your page functions rather messy, though.
      </blockquote>I'm pretty sure that doesn't apply to the FlipPages (pseudo pages inside a regular page) - maybe I'm mistaken, though?<br />
      <br />
      If you're referring to regular pages, shouldn't you have enough info from the .onUserAbort and nsDialogs::OnBack callbacks? (Next being the one left if the other 2 aren't what triggered a page change).
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">MSG</span><br />
      <span class="post-time small text-muted">24th August 2010 07:03 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"></p>

      <blockquote>
        <small>Originally posted by Animaether</small><br />
        I'm pretty sure that doesn't apply to the FlipPages (pseudo pages inside a regular page) - maybe I'm mistaken, though?<br />
        <br />
        If you're referring to regular pages, shouldn't you have enough info from the .onUserAbort and nsDialogs::OnBack callbacks? (Next being the one left if the other 2 aren't what triggered a page change).
      </blockquote>Ah, very true. I stand corrected. :)
    </div>
    <hr />

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]>
  </script>
</body>
</html>
