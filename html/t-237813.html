<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="description" content="NSIS scripting OS nitpicking"><title>NSIS scripting OS nitpicking - NSIS Forums</title><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script><link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css"><link rel="stylesheet" href="../css/style.css" type="text/css"><!--[if lt IE 9]><script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script><script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script><![endif]--></head><body><div class="container"><ol class="breadcrumb"><li><a href="../index.html" class="glyphicon glyphicon-home"></a></li><li><a href="f-65.html">NSIS Discussion</a></li><li class="active">NSIS scripting OS nitpicking</li></ol><p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=237813">NSIS scripting OS nitpicking</a></p><br><div class="post"><p class="post-meta"><span class="post-author text-primary">Pharaoh Atem</span><br><span class="post-time small text-muted">12th February 2006 01:07 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>NSIS scripting OS nitpicking</strong><br>I have one program that has two versions: a version that works only on Windows 9x/NT4, and a version that works on Windows 2k/XP/Vista. Here is my problem: I need a way to make installers that either have both versions but distinguish between OSes to choose which files are allowed to be installed, or two separate installers that have OS checks to allow only certain OSes to run the installers... Can someone help me with this? I am using MUI-compatible skinning and base MUI.<br>I also need help designing my installer to work with Limited Users, while allowing installations System-wide if Administrators are logged in and running the installation.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br><span class="post-time small text-muted">12th February 2006 12:11 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Use <a href="http://nsis.sf.net/File:GetVersion.zip" target="_blank">GetVersion plugin</a> or <a href="http://nsis.sourceforge.net/Docs/AppendixC.html#C.5" target="_blank">GetWindowsVersion function</a>.<br><br>Edit: GetVersion plugin support added for Windows Vista and Longhorn Server.<br><br>-Stu</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Pharaoh Atem</span><br><span class="post-time small text-muted">12th February 2006 14:26 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">That solves one part of it, now I just need to know how to use it for my situation....</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br><span class="post-time small text-muted">12th February 2006 14:53 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">For example:<br></p><pre>
<code><br>!include LogicLib.nsh<br><br>Section<br><br> GetVersion::WindowsName<br>  Pop $R0<br> StrCpy $R0 $R0 2 8<br><br> ${If}   $R0 == 98<br> ${OrIf} $R0 == 95<br> ${OrIf} $R0 == NT<br><br>  ## Extract 9x/NT files<br><br> ${ElseIf} $R0 == XP<br> ${OrIf}   $R0 == 20 # 2000<br> ${OrIf}   $R0 == Vi # Vista<br><br>  ## Extract XP/2000/Vista files<br><br> ${EndIf}<br><br>SectionEnd<br></code>
</pre><br>
      <br>
      -Stu
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Pharaoh Atem</span><br>
      <span class="post-time small text-muted">12th February 2006 15:15 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">So, with this I can use one installer to install different versions of a program on different versions of Windows? Well, unfortunately, I am extremely stupid on NSIS at the moment... Can you please make a complete example script for me?</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br>
      <span class="post-time small text-muted">12th February 2006 17:32 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">There are already many example scripts bundled with NSIS. Rather than having a Section for each installation (for different Windows) you just use this code inside a Section (it already is in fact).<br>
      <br>
      I've put comments in there where you need to put the relevant instructions (SetOutPath, File etc) for the individual installations.<br>
      <br>
      -Stu</p>
    </div>
    <hr>

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]></script></body></html>