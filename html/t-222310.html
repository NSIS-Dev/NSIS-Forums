<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="Functions for saving/loading settings to/from registry" />

  <title>Functions for saving/loading settings to/from registry - NSIS Forums</title><!-- Bootstrap core CSS -->
  <link rel="stylesheet" type="text/css" href="//netdna.bootstrapcdn.com/bootswatch/3.0.1/readable/bootstrap.min.css" />
  <link rel="stylesheet" href="../css/style.css" type="text/css" /><!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!--[if lt IE 9]>
                <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
                <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->
</head>

<body>
  <div class="container">
    <!-- Put navigation bar here -->

    <ol class="breadcrumb">
      <li><a href="../index.html" class="glyphicon glyphicon-home"></a></li>

      <li><a href="f-65.html">NSIS Discussion</a></li>

      <li class="active">Functions for saving/loading settings to/from registry</li>
    </ol>

    <p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=222310">Functions for saving/loading settings to/from registry</a></p><br />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Rolando</span><br />
      <span class="post-time small text-muted">24th July 2005 01:22 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>Functions for saving/loading settings to/from registry</strong><br />
      Hi, I'm working on an installer with 5 pages and 14 checkboxes per page (using MUI custompages) and I want the installer to be able to remember the selected checkboxes by storing them in the registry. I was hoping someone could help me create 2 functions: one for saving settings to the registry and the other for loading them from the registry. This is probably easy to do, but I don't know my way around loops, which I think is the best way to do this since the pages are named options1.ini --&gt; options5.ini and there are 14 fields in each page. I'd appreciate any help offered. Thanks.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
      <span class="post-time small text-muted">24th July 2005 01:24 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Use ReadRegStr and WriteRegStr for the registry parts, then ReadINIStr and WriteINIStr for the INI files.<br />
      <br />
      -Stu</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Instructor</span><br />
      <span class="post-time small text-muted">24th July 2005 07:50 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><a href="http://nsis.sourceforge.net/wiki/RememberComponents" target="_blank">http://nsis.sourceforge.net/wiki/RememberComponents</a></p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Rolando</span><br />
      <span class="post-time small text-muted">24th July 2005 11:46 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Ok thanks, well I'm almost done. I finished the SaveSettings function however, the LoadSettings function isn't working. Is there something wrong with the following:<br />
      <br /></p>
      <pre>
<code>ReadRegStr $R0 HKCU "Software\LTP\${CURRENT_VER}" "$R2-$R3"</code>
</pre><br />
      <br />
      because $R0 is returning a null result while I check the registry and it should have a numeric value. At this point, I checked and am sure that $R2 and $R3 have their correct values.
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">deguix</span><br />
      <span class="post-time small text-muted">25th July 2005 06:00 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">ReadRegStr can read only string values. Use ReadRegDWORD if you are reading integers, which is probable to happen in this case. If this is not enough, say which type has your value name.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Comperio</span><br />
      <span class="post-time small text-muted">25th July 2005 06:03 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">I'd go into RegEdit and see if you can browse to HCKU\software\LTP\${CURRENT_VER} and read what $R2-$R3 is.<br />
      <br />
      If that doesn't work, you can insert a message box just before the command to see what the string "Software\LTP\${CURRENT_VER}" and "$R2-$R3" actually are at the time the command is being called.<br />
      <br />
      EDIT: Deguix also has a good point!</p>
    </div>
    <hr />

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]>
  </script>
</body>
</html>
