<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="description" content="Cannot install application on Vista"><title>Cannot install application on Vista - NSIS Forums</title><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script><link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css"><link rel="stylesheet" href="../css/style.css" type="text/css"></head><body><div class="container"><ol class="breadcrumb"><li><a href="../index.html" class="glyphicon glyphicon-home"></a></li><li><a href="f-65.html">NSIS Discussion</a></li><li class="active">Cannot install application on Vista</li></ol><p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=305264">Cannot install application on Vista</a></p><br><div class="post"><p class="post-meta"><span class="post-author text-primary">laurent22300</span><br><span class="post-time small text-muted">12th April 2009 16:33 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>Cannot install application on Vista</strong><br>Hello,<br><br>For some reasons, my installer doesn't work on Windows Vista (french version). When I try to install my app to the default folder (c:\program files\app), I get this error for each file:<br><br></p><pre>
<code>Error opening file for writing: &lt;name of file&gt;</code>
</pre><br><br>On the other hand, if I try to install the app in a folder other than "Program files" then the installation works fine. Does anybody know what could be the problem? I assume it's not the UAC since it would display a message and not just silently block the installation, right? Any ideas?<br><br>Thanks,<br><br>Laurent</div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Comperio</span><br><span class="post-time small text-muted">12th April 2009 16:59 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Just taking a wild guess, I would say that either it is a UAC problem and the user has not been elevated, or that the user just doesn't have adequate permissions to the program files folder.<br><br>I would probably check 2 things:[list=1][*]make sure you are using RequestExecutionLevel admin to ensure that if UAC is enabled, the user's security settings are properly elevated.[*]You also may want to then check for admin access just in case the user has UAC disabled. (maybe using something like <a href="http://nsis.sourceforge.net/Check_if_the_current_user_is_an_Administrator" target="_blank">this</a>).[/list=1]</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">laurent22300</span><br><span class="post-time small text-muted">12th April 2009 17:47 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"></p><blockquote>make sure you are using RequestExecutionLevel admin to ensure that if UAC is enabled, the user's security settings are properly elevated.</blockquote>That was it! I had it set to "RequestExecutionLevel user" which apparently makes the UAC blocks the installation without providing any meaningful error message. By setting it to "admin" as you've suggested, the usual UAC mesage shows up asking for confirmation. Thanks for your help!</div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Anders</span><br><span class="post-time small text-muted">13th April 2009 01:15 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">it does not block the install, it just runs it as a normal user and not admin</p></div><hr><div class="footer"><p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p></div></div><script src="../js/highlight.pack.js" type="text/javascript"></script><script type="text/javascript">//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]></script></body></html>