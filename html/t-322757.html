<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="user profile folder (not the installer)" />

  <title>user profile folder (not the installer) - NSIS Forums</title><!-- Bootstrap core CSS -->
  <link rel="stylesheet" type="text/css" href="//netdna.bootstrapcdn.com/bootswatch/3.0.1/readable/bootstrap.min.css" />
  <link rel="stylesheet" href="../css/style.css" type="text/css" /><!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!--[if lt IE 9]>
                <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
                <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->
</head>

<body>
  <div class="container">
    <!-- Put navigation bar here -->

    <ol class="breadcrumb">
      <li><a href="../index.html" class="glyphicon glyphicon-home"></a></li>

      <li><a href="f-65.html">NSIS Discussion</a></li>

      <li class="active">user profile folder (not the installer)</li>
    </ol>

    <p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=322757">user profile folder (not the installer)</a></p><br />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kalverson</span><br />
      <span class="post-time small text-muted">27th September 2010 13:00 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>user profile folder (not the installer)</strong><br />
      Just checking if someone has something here to make life easier. I have an install that creates a user profile for running a postgresql database. On the uninstall, I delete the user, but the profile folder is currently left behind. Is there anything available that will return just the profile folder path without the user attached so I can create and add a remove on the uninstall for the user folder?</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Animaether</span><br />
      <span class="post-time small text-muted">27th September 2010 13:46 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">you mean a Windows user profile?<br />
      If so.. I'm not 100% sure if this always applies ..wouldn't the parent folder of the current profile be applicable?<br />
      <br />
      PHP Code:</p>
      <hr />
      <code style="white-space:nowrap"><!-- php buffer start --></code><span style="color: #000000"><span style="color: #007700">!include</span><span style="color: #DD0000">"filefunc.nsh"<br />
      <br /></span><span style="color: #0000BB">OutFile</span><span style="color: #DD0000">"$%temp%\temp.exe"<br />
      <br /></span><span style="color: #0000BB">ShowInstDetailsshow<br />
      <br />
      Section<br /></span><span style="color: #007700">${</span><span style="color: #0000BB">GetParent</span><span style="color: #007700">}</span><span style="color: #DD0000">"$PROFILE"</span><span style="color: #007700">$</span><span style="color: #0000BB">0<br />
      DetailPrint</span><span style="color: #DD0000">"Profilesfolder:$0\"<br />
      SectionEnd<br /></span></span> <!-- php buffer end -->
      <hr />
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kalverson</span><br />
      <span class="post-time small text-muted">27th September 2010 15:52 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Quote:</p>
      <hr />
      Thanks, that worked perfectly. The GetParent saved me the hassel of writting that part myself.

      <table cellpadding="6" cellspacing="0" border="0" width="100%">
        <tr>
          <td class="alt2">
            <hr />
            Originally Posted by <strong>Animaether</strong> (Post 2702564) you mean a Windows user profile?<br />
            If so.. I'm not 100% sure if this always applies ..wouldn't the parent folder of the current profile be applicable?<br />
            <br />
            PHP Code:
            <hr />
            <code style="white-space:nowrap"><!-- php buffer start --></code><span style="color: #000000"><span style="color: #007700">!include</span><span style="color: #DD0000">"filefunc.nsh"<br />
            <br /></span> <span style="color: #0000BB">OutFile</span><span style="color: #DD0000">"$%temp%\temp.exe"<br />
            <br /></span> <span style="color: #0000BB">ShowInstDetailsshow<br />
            <br />
            Section<br /></span> <span style="color: #007700">${</span><span style="color: #0000BB">GetParent</span><span style="color: #007700">}</span><span style="color: #DD0000">"$PROFILE"</span><span style="color: #007700">$</span><span style="color: #0000BB">0<br />
            DetailPrint</span><span style="color: #DD0000">"Profilesfolder:$0\"<br />
            SectionEnd<br /></span></span> <!-- php buffer end -->
            <hr />
            <hr />
          </td>
        </tr>
      </table><br />

      <div class="post">
        <p class="post-meta"><span class="post-author text-primary">Animaether</span><br />
        <span class="post-time small text-muted">27th September 2010 16:49 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

        <p class="post-content">yeah, there's tons of goodies in the headers that ship with NSIS - I recommed reading through the docs in some idle time.. even if nothing in there helps you immediately, it can save you in the future (remembering that a function that might help you is in those headers). Ditto the wiki, but start with the docs as several wiki pages are deprecated in favor of the headers that ship with NSIS :)</p>
      </div>
      <hr />

      <div class="footer">
        <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
      </div>
    </div><script src="../js/highlight.pack.js" type="text/javascript">
</script> <script type="text/javascript">
//<![CDATA[
    hljs.initHighlightingOnLoad();
    //]]>
    </script>
  </div>
</body>
</html>
