<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="Files wont get installed." />

  <title>Files wont get installed. - NSIS Forums</title>
  <script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script>
  <!-- Bootstrap core CSS -->

  <link rel="stylesheet" type="text/css" href="//netdna.bootstrapcdn.com/bootswatch/3.0.1/readable/bootstrap.min.css" />
  <link rel="stylesheet" href="../css/style.css" type="text/css" /><!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!--[if lt IE 9]>
                <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
                <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->
</head>

<body>
  <div class="container">
    <!-- Put navigation bar here -->

    <ol class="breadcrumb">
      <li><a href="../index.html" class="glyphicon glyphicon-home"></a></li>

      <li><a href="f-65.html">NSIS Discussion</a></li>

      <li class="active">Files wont get installed.</li>
    </ol>

    <p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=354682">Files wont get installed.</a></p><br />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">thaman667</span><br />
      <span class="post-time small text-muted">17th January 2013 13:44 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>Files wont get installed.</strong><br />
      &nbsp; <b>What I am trying to achieve.</b><br />
      I have an installer that installs 5 files at 1 place and 1 file at an another place. (C:\ProgramData\Data Access Worldwide\Visual Report Writer\2.1\) &amp; (C:\ProgramData\Data Access Worldwide\Visual Report Writer\2.1\Data)<br />
      <br />
      If the windows is vista or higher, if the windows is XP then it should install all the files at 1 place.(C:\Program Files\Data Access Worldwide\Visual Report Writer\2.1)<br />
      <br />
      This is what I tried but it does not install any files, I assume I am doing something completely wrong but I can't figure out what..<br /></p>
      <pre>
<code>
.
<br /><br />; HM NIS Edit Wizard helper defines
<br />&gt;!define PRODUCT_NAME "Visual Report Writer Developer Deployment"
<br />&gt;!define PRODUCT_VERSION "2.1"
<br />&gt;!define PRODUCT_PUBLISHER "DataAccess"
<br />&gt;!define PRODUCT_WEB_SITE "http://www.dataaccess.com"
<br />&gt;!define PRODUCT_UNINST_KEY "Software\Microsoft\Windows\CurrentVersion\Uninstall\${PRODUCT_NAME}"
<br />&gt;!define PRODUCT_UNINST_ROOT_KEY "HKLM"
<br />&gt;!define PRODUCT_STARTMENU_REGVAL "NSIS:StartMenuDir"
<br /><br />&gt;; MUI 1.67 compatible ------
<br />!include "MUI.nsh"
<br />&gt;!include "LogicLib.nsh"
<br />&gt;!include "WinVer.nsh"
<br />&gt;!include "x64.nsh"
<br /><br />&gt;; MUI Settings
<br />&gt;!define MUI_ABORTWARNING
<br />&gt;!define MUI_ICON "${NSISDIR}\Contrib\Graphics\Icons\modern-install.ico"
<br />&gt;!define MUI_UNICON "${NSISDIR}\Contrib\Graphics\Icons\modern-uninstall.ico"
<br /><br />&gt;; Welcome page
<br />&gt;!insertmacro MUI_PAGE_WELCOME
<br />&gt;; License page
<br />&gt;!insertmacro MUI_PAGE_LICENSE "License Agreement.txt"
<br />&gt;; Directory page
<br />&gt;!insertmacro MUI_PAGE_DIRECTORY
<br />&gt;; Start menu page
<br />&gt;var ICONS_GROUP
<br />&gt;!define MUI_STARTMENUPAGE_NODISABLE
<br />&gt;!define MUI_STARTMENUPAGE_DEFAULTFOLDER "Visual Report Writer Developer Deployment"
<br />&gt;!define MUI_STARTMENUPAGE_REGISTRY_ROOT "${PRODUCT_UNINST_ROOT_KEY}"
<br />&gt;!define MUI_STARTMENUPAGE_REGISTRY_KEY "${PRODUCT_UNINST_KEY}"
<br />&gt;!define MUI_STARTMENUPAGE_REGISTRY_VALUENAME "${PRODUCT_STARTMENU_REGVAL}"
<br />&gt;!insertmacro MUI_PAGE_STARTMENU Application $ICONS_GROUP
<br />&gt;; Instfiles page
<br />&gt;!insertmacro MUI_PAGE_INSTFILES
<br />&gt;; Finish page
<br />&gt;!insertmacro MUI_PAGE_FINISH
<br /><br />&gt;; Uninstaller pages
<br />&gt;!insertmacro MUI_UNPAGE_INSTFILES
<br /><br />&gt;; Language files
<br />&gt;!insertmacro MUI_LANGUAGE "English"
<br /><br />&gt;;Directories
<br />&gt;;!define Dir1 "C:\ProgramData\Data Access Worldwide\Visual Report Writer\2.1\Data\"
<br />;!define Dir2 "</code>C:Program FilesData Access WorldwideVisual Report Writer2.1"
<br />;!define Dir3 "C:Program Files(x86)Data Access WorldwideVisual Report Writer2.1"
<br /><br />; MUI end ------
<br /><br />Name "${PRODUCT_NAME} ${PRODUCT_VERSION}"
<br />OutFile "Setup.exe"
<br />InstallDir "C:ProgramDataData Access WorldwideVisual Report Writer2.1"
<br />ShowInstDetails show
<br />ShowUnInstDetails show
<br /><br />Section "-RuntimeFiles64" SEC01
<br />  StrCpy $INSTDIR "C:ProgramDataData Access WorldwideVisual Report Writer2.1Data"
<br />  SetOverwrite ifnewer
<br />  File "Installation FilesVisual Report Writer 2012 Developer Edition API.ocx"
<br />  File "Installation Fileslanguage.db"
<br />  File "Installation FilesDynapdf.dll"
<br />  File "Installation FilesDfapi30.dll"
<br />  File "Installation FilesDf_collate.cfg"
<br /><br />; Shortcuts
<br />  !insertmacro MUI_STARTMENU_WRITE_BEGIN Application
<br />  !insertmacro MUI_STARTMENU_WRITE_END
<br />SectionEnd
<br /><br />Section "-RuntimeFiles32" SEC02
<br />  StrCpy $INSTDIR "C:Program Files(x86)Data Access WorldwideVisual Report Writer2.1"
<br />  SetOverwrite ifnewer
<br />  File "Installation FilesVisual Report Writer 2012 Developer Edition API.ocx"
<br />  File "Installation Fileslanguage.db"
<br />  File "Installation FilesDynapdf.dll"
<br />  File "Installation FilesDfapi30.dll"
<br />  File "Installation FilesDf_collate.cfg"
<br /><br />; Shortcuts
<br />  !insertmacro MUI_STARTMENU_WRITE_BEGIN Application
<br />  !insertmacro MUI_STARTMENU_WRITE_END
<br />SectionEnd
<br /><br />Section "-VRW.DB XP" SEC03
<br />  StrCpy $INSTDIR "C:Program FilesData Access WorldwideVisual Report Writer2.1"
<br />  File "Installation Filesvrw.db"
<br />SectionEnd
<br /><br />Section "-VRW.DB NOTXP" SEC04
<br />  StrCpy $INSTDIR "C:ProgramDataData Access WorldwideVisual Report Writer2.1Data"
<br />  File "Installation Filesvrw.db"
<br />SectionEnd
<br /><br />Section -AdditionalIcons
<br />  !insertmacro MUI_STARTMENU_WRITE_BEGIN Application
<br />  CreateDirectory "$SMPROGRAMS$ICONS_GROUP"
<br />  CreateShortCut "$SMPROGRAMS$ICONS_GROUPUninstall.lnk" "$INSTDIRuninst.exe"
<br />  !insertmacro MUI_STARTMENU_WRITE_END
<br />SectionEnd
<br /><br />Section -Post
<br />  WriteUninstaller "$INSTDIRuninst.exe"
<br />SectionEnd
<br /><br />Function .onInit
<br />;  IfFileExists "C:ProgramDataData Access WorldwideVisual Report Writer2.1Data*.*" +3 0
<br />;  MessageBox MB_OK "Directory does not exists and will now be created."
<br />;  CreateDirectory "C:ProgramDataData Access WorldwideVisual Report Writer2.1Data"
<br /><br /> ${If} ${IsWinXP}
<br /> ${AndIfNot} ${RunningX64} #32 bit
<br />   !insertmacro UnselectSection ${SEC01}
<br />   !insertmacro SelectSection ${SEC02}
<br />   !insertmacro UnselectSection ${SEC04}
<br />   !insertmacro SelectSection ${SEC03}
<br />   MessageBox MB_OK "Windows XP"
<br /><br />   IfFileExists "C:Program FilesData Access WorldwideVisual Report Writer2.1*.*" +3 0
<br />   MessageBox MB_OK "Directory does not exists and will now be created."
<br />   CreateDirectory "C:Program FilesData Access WorldwideVisual Report Writer2.1"
<br /> ${ElseIf} ${AtleastWinVista}
<br /> ${AndIf} ${RunningX64}
<br />   !insertmacro UnselectSection ${SEC02}
<br />   !insertmacro SelectSection ${SEC01}
<br />   !insertmacro UnselectSection ${SEC03}
<br />   !insertmacro SelectSection ${SEC04}
<br />   MessageBox MB_OK "Windows Vista or higher 64 Bit"
<br />   
<br />   IfFileExists "C:Program Files (x86)Data Access WorldwideVisual Report Writer2.1*.*" +3 0
<br />   MessageBox MB_OK "Directory does not exists and will now be created."
<br />   CreateDirectory "C:Program Files (x86)Data Access WorldwideVisual Report Writer2.1"
<br /> ${Else} # Vista or higher 32 bit
<br />   !insertmacro UnselectSection ${SEC02}
<br />   !insertmacro SelectSection ${SEC01}
<br />   !insertmacro UnselectSection ${SEC03}
<br />   !insertmacro SelectSection ${SEC04}
<br />   MessageBox MB_OK "Windows Vista or higher 32 Bit"
<br /><br />   IfFileExists "C:Program FilesData Access WorldwideVisual Report Writer2.1*.*" +3 0
<br />   MessageBox MB_OK "Directory does not exists and will now be created."
<br />   CreateDirectory "C:Program FilesData Access WorldwideVisual Report Writer2.1"
<br /> ${EndIf}
<br />FunctionEnd
<br /><br />Function .onInstSuccess
<br />  Exec 'C:\Windows\System32\regsvr32.exe /i "Visual Report Writer 2012 Developer Edition API.ocx"'
<br />FunctionEnd
<br /><br />Function un.onUninstSuccess
<br />  Exec 'C:\Windows\System32\regsvr32.exe /u "Visual Report Writer 2012 Developer Edition API.ocx"'
<br />  HideWindow
<br />  MessageBox MB_ICONINFORMATION|MB_OK "$(^Name) was successfully removed from your computer."
<br />FunctionEnd
<br /><br />Function un.onInit
<br />  MessageBox MB_ICONQUESTION|MB_YESNO|MB_DEFBUTTON2 "Are you sure you want to completely remove $(^Name) and all of its components?" IDYES +2
<br />  Abort
<br />FunctionEnd
<br /><br />Section Uninstall
<br />  !insertmacro MUI_STARTMENU_GETFOLDER "Application" $ICONS_GROUP
<br />  Delete "$INSTDIRuninst.exe"
<br />  Delete "$INSTDIRDf_collate.cfg"
<br />  Delete "$INSTDIRDfapi30.dll"
<br />  Delete "$INSTDIRDynapdf.dll"
<br />  Delete "$INSTDIRVisual Report Writer 2012 Developer Edition API.ocx"
<br />  Delete "$INSTDIRlanguage.db"
<br />  Delete "$INSTDIRvrw.db"
<br /><br />  Delete "$SMPROGRAMS$ICONS_GROUPUninstall.lnk"
<br /><br />  RMDir "$SMPROGRAMS$ICONS_GROUP"
<br />  RMDir "$INSTDIR"
<br /><br />  SetAutoClose true
<br />SectionEnd 
<br />&gt;

</pre>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Anders</span><br />
      <span class="post-time small text-muted">17th January 2013 14:53 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">You don't have RequestExecutionLevel in your script.<br />
      <br />
      You should not hard-code paths, use $ProgramFiles, $windir etc</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">thaman667</span><br />
      <span class="post-time small text-muted">17th January 2013 15:03 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"></p>

      <blockquote>
        <small>Originally posted by Anders</small><br />
        You don't have RequestExecutionLevel in your script.
      </blockquote>Didn't do anything extra, still doesn't copy anything.<br />
      <br />

      <blockquote>
        <small>Originally posted by Anders</small><br />
        You should not hard-code paths, use $ProgramFiles, $windir etc
      </blockquote>Paths are correct, this is how my boss want it to be.
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">MSG</span><br />
      <span class="post-time small text-muted">17th January 2013 18:02 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"></p>

      <blockquote>
        <small>Originally posted by thaman667</small><br />
        Didn't do anything extra, still doesn't copy anything.
      </blockquote>Did you set it to requestexecutionlevel admin?<br />
      <br />

      <blockquote>
        <small>Originally posted by thaman667</small><br />
        Paths are correct, this is how my boss want it to be.
      </blockquote>Your boss is most probably wrong. The name "program files" is different on different language versions of Windows. Even if you're only deploying on English Windows versions, users can change the location of program files. Some Windows installs don't even have a C drive.<br />
      <br />
      (Other explanation: You're developing an installer for a Windows application. If that application insists on using c:\Program Files, it is not a valid Windows application and is therefore broken. If you want to use Windows, you need to use it the way it was meant to be used. Otherwise, use a different OS.)
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">msroboto</span><br />
      <span class="post-time small text-muted">17th January 2013 18:04 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">[QUOTE=Paths are correct, this is how my boss want it to be.[/QUOTE]<br />
      <br />
      So if someone has these directories on the D drive you are screwed. Just because your boss doesn't know the right way to do this doesn't mean you should do it wrong.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">thaman667</span><br />
      <span class="post-time small text-muted">21st January 2013 10:19 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Corrected the paths and its still not working :\</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">MSG</span><br />
      <span class="post-time small text-muted">21st January 2013 16:01 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Like I said.<br />
      <br /></p>

      <blockquote>
        <small>Originally posted by MSG</small><br />
        Did you set it to requestexecutionlevel admin?
      </blockquote>
    </div>
    <hr />

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]>
  </script>
</body>
</html>