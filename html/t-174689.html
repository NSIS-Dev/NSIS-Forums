<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="progressbar manipulation" />

  <title>progressbar manipulation - NSIS Forums</title><!-- Bootstrap core CSS -->
  <link rel="stylesheet" type="text/css" href="//netdna.bootstrapcdn.com/bootswatch/3.0.1/readable/bootstrap.min.css" />
  <link rel="stylesheet" href="../css/style.css" type="text/css" /><!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!--[if lt IE 9]>
                <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
                <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->
</head>

<body>
  <div class="container">
    <!-- Put navigation bar here -->

    <ol class="breadcrumb">
      <li><a href="../index.html" class="glyphicon glyphicon-home"></a></li>

      <li><a href="f-65.html">NSIS Discussion</a></li>

      <li class="active">progressbar manipulation</li>
    </ol>

    <p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=174689">progressbar manipulation</a></p><br />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">TheChewy</span><br />
      <span class="post-time small text-muted">30th March 2004 07:11 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>progressbar manipulation</strong><br />
      Is it possible to manipulate the progressbar to increase / decrease the space for a certain section of the de-, installer progress?</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">deguix</span><br />
      <span class="post-time small text-muted">30th March 2004 09:38 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">:up:<br />
      <br />
      It is possible. But you need to do this inside a function (but this function can be called from a section), because when you put this code in a section, it doesn't work (NSIS sets the progress indicator bar position value everytime when passing by a command):<br />
      <br /></p>
      <pre>
<span style="color: #007700">!</span><span style="color: #0000BB">definePBM_SETPOS0x0402
<br /></span><span style="color: #FF8000">#!definePBM_DELTAPOS0x0403
<br /><br />#UsePBM_DELTAPOSifyouwanttoincrement,
<br />#nottoset,thevalue.
<br /><br /></span><span style="color: #0000BB">Section
<br /><br /></span><span style="color: #FF8000">#Otherthings
<br /><br /></span><span style="color: #0000BB">FindWindow$R0</span><span style="color: #DD0000">"#32770"""</span><span style="color: #0000BB">$HWNDPARENT
<br />GetDlgItem$R0$R01004
<br /><br />CallChangeProgressIndicatorBarPosition
<br /><br /></span><span style="color: #FF8000">#Otherthings
<br /><br /></span><span style="color: #0000BB">SectionEnd
<br /><br /></span><span style="color: #007700">Function</span><span style="color: #0000BB">ChangeProgressIndicatorBarPosition
<br /><br />StrCpy</span><span style="color: #007700">$</span><span style="color: #0000BB">050</span><span style="color: #FF8000">#Setindicatorbarinposition"50%"
<br /><br /></span><span style="color: #0000BB">IntOp</span><span style="color: #007700">$</span><span style="color: #0000BB">0</span><span style="color: #007700">$</span><span style="color: #0000BB">0</span><span style="color: #007700">*</span><span style="color: #0000BB">300
<br /><br />SendMessage$R0</span><span style="color: #007700">${</span><span style="color: #0000BB">PBM_SETPOS</span><span style="color: #007700">}$</span><span style="color: #0000BB">0</span><span style="color: #DD0000">""
<br /><br /></span><span style="color: #FF8000">#Ifyouwanttoseetheshowabove,puta
<br />#MessageBoxcommandafterthecommandabove,
<br />#soitdoesn'tdisappear,untilyouclickOK.
<br /><br />#ORifyouwanttoincrement,nottoset,thenew
<br />#position,youcanuse${PBM_DELTAPOS}.
<br /><br />#SendMessage$R0${PBM_DELTAPOS}$0""
<br /><br /></span><span style="color: #0000BB">FunctionEnd
<br /></span>

<!-- php buffer end -->
                
                
                
</pre>
      <hr />
      <pre>
        

                
</pre>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Dj Nyx</span><br />
      <span class="post-time small text-muted">1st April 2004 08:37 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">is there any way to display the progress bar like the "xp-progress bar"?<br />
      i read some threads but i wasn't able to find out exactly if it's possible...</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Joost Verburg</span><br />
      <span class="post-time small text-muted">1st April 2004 11:07 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">It will use the XP-style progress bar when you are using Windows XP.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">eccles</span><br />
      <span class="post-time small text-muted">1st April 2004 13:18 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">If you are not using MUI then make sure you have <b>XPStyle on</b> at the start of your script (MUI includes this automatically), but, of course, only when installing on XP will this have an effect.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Dj Nyx</span><br />
      <span class="post-time small text-muted">5th April 2004 07:41 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">and is there any way to make something like this [attached file]</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Joost Verburg</span><br />
      <span class="post-time small text-muted">5th April 2004 08:02 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Yes, create a UI file with a custom dialog and use window messages.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Dj Nyx</span><br />
      <span class="post-time small text-muted">5th April 2004 08:51 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">is there a manual "how to create a UI file with a custom dialog and window messages for dummys"? :D</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Joost Verburg</span><br />
      <span class="post-time small text-muted">5th April 2004 14:27 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">No. Get a resource editor to modify the UI file and search MSDN for information about window messages to use.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Dj Nyx</span><br />
      <span class="post-time small text-muted">5th April 2004 14:37 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">ok.<br />
      one more question...<br />
      do you know a simple resource editor?<br />
      and which file is the ui file<br />
      [i'm a total greenhorn]</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Joost Verburg</span><br />
      <span class="post-time small text-muted">5th April 2004 14:47 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">See the Modern UI Readme.<br />
      <br />
      Custom pages &gt; Customize standard dialogs</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Dj Nyx</span><br />
      <span class="post-time small text-muted">5th April 2004 16:25 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">ok I was able to make 5 checkboxes in the modern.exe [for me this is no mean feat :D ]<br />
      now the next step is to set the caption of the checkbox.<br />
      [name of section 1 is caption of checkbox 1, ...]<br />
      I rumaged many sites, but I'm still planless... [I know I'm a little nerving] :(</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Joost Verburg</span><br />
      <span class="post-time small text-muted">5th April 2004 17:19 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Use the WM_SETTEXT message with a string.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Dj Nyx</span><br />
      <span class="post-time small text-muted">6th April 2004 08:39 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">first i tried it with a sample from the archive:<br /></p>
      <pre>
<code>GetDlgItem$R0$HWNDPARENT3
<br />SendMessage$R0</code><span style="color: #007700">${</span><span style="color: #0000BB">WM_SETTEXT</span><span style="color: #007700">}</span><span style="color: #0000BB">0</span><span style="color: #DD0000">"STR:pOiSoN"
<br /></span><span style="color: #0000BB">MessageBoxMB_OK</span><span style="color: #DD0000">"HWNDPARENT:$HWNDPARENT"
<br /></span><span style="color: #0000BB">MessageBoxMB_OK</span><span style="color: #DD0000">"R0:$R0"
</span>
</pre>and this worked.<br />
      <br />
      then i opened the ressource hacker and I assigned the checkbox the id 3333.<br />
      <pre>
<code>GetDlgItem$R0$HWNDPARENT</code><span style="color: #DD0000">"#3333"
<br /></span><span style="color: #0000BB">SendMessage$R0</span><span style="color: #007700">${</span><span style="color: #0000BB">WM_SETTEXT</span><span style="color: #007700">}</span><span style="color: #0000BB">0</span><span style="color: #DD0000">"STR:pOiSoN"
<br /></span><span style="color: #0000BB">MessageBoxMB_OK</span><span style="color: #DD0000">"HWNDPARENT:$HWNDPARENT"
<br /></span><span style="color: #0000BB">MessageBoxMB_OK</span><span style="color: #DD0000">"R0:$R0"
</span>
</pre>but it doesn't work.<br />
      <br />
      do you know whats my failure?
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">deguix</span><br />
      <span class="post-time small text-muted">6th April 2004 11:05 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">It's clear why that's happening because you did put "#3333", not the correct "3333".</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Joost Verburg</span><br />
      <span class="post-time small text-muted">6th April 2004 14:25 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">If it's on the inner dialog you'll have to use the handle of that dialog. See users manual section 4.9.14.6.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Dj Nyx</span><br />
      <span class="post-time small text-muted">6th April 2004 15:33 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">ok thank you very very much joost<br />
      respect to you patience ;-)<br />
      <br />
      this is the working code [only 3 lines, i can't take it ~gg~]<br />
      <br /></p>
      <pre>
<span style="color: #007700">Var</span><span style="color: #0000BB">window
<br /><br />Section</span><span style="color: #DD0000">"Hauptgruppe"</span><span style="color: #0000BB">SEC01FindWindow$window</span><span style="color: #DD0000">"#32770"""
<br /><br /></span><span style="color: #0000BB">FindWindow$window</span><span style="color: #DD0000">"#32770"""</span><span style="color: #0000BB">$HWNDPARENT
<br />GetDlgItem$R0$window</span><span style="color: #DD0000">"3333"
<br /></span><span style="color: #0000BB">SendMessage$R0</span><span style="color: #007700">${</span><span style="color: #0000BB">WM_SETTEXT</span><span style="color: #007700">}</span><span style="color: #0000BB">0</span><span style="color: #DD0000">"STR:textofthecheckbox"
</span>
</pre>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Dj Nyx</span><br />
      <span class="post-time small text-muted">6th April 2004 15:53 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">hi again :rolleyes:<br />
      i opened the<br /></p>

      <blockquote>
        List of common Windows Messages<br />
        By KiCHiK
      </blockquote>file<br />
      <br />
      with which option am I able to change the status of the checkbox [checked/unchecked]?
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Joost Verburg</span><br />
      <span class="post-time small text-muted">6th April 2004 17:06 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">It's not in that list. See MSDN or <a href="http://forums.winamp.com/showthread.php?s=&amp;threadid=175303" target="_blank">http://forums.winamp.com/showthread....hreadid=175303</a></p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Dj Nyx</span><br />
      <span class="post-time small text-muted">13th April 2004 09:22 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">so, now everything works...<br />
      <br />
      i have 5 checkboxes and i am able to "check" or "uncheck" them... great :p<br />
      i don't know if its necessary to post my code. shall i?¿</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Joost Verburg</span><br />
      <span class="post-time small text-muted">13th April 2004 12:09 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Yes, it's always useful for others.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Dj Nyx</span><br />
      <span class="post-time small text-muted">13th April 2004 12:32 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">ok it's not really elaborate...<br />
      <br />
      first i made 5 checkboxes [with a resource editor: "Resource Hacker"][into the modern.exe]<br />
      then i gave them the ids "3333", "3334", "3335", "3336" &amp; "3337".<br />
      <br />
      so, now i had to set the captions...<br />
      first you have to set a variable [in my code it is $InstallWindow]<br />
      <br /></p>
      <pre>
<span style="color: #007700">Var</span><span style="color: #0000BB">InstallWindow
<br /><br />Section</span><span style="color: #DD0000">"createWindow"</span><span style="color: #0000BB">SEC01
<br /></span><span style="color: #007700">;</span><span style="color: #0000BB">1st
<br />FindWindow$InstallWindow</span><span style="color: #DD0000">"#32770"""</span><span style="color: #0000BB">$HWNDPARENT
<br />GetDlgItem$R0$InstallWindow</span><span style="color: #DD0000">"3333"
<br /></span><span style="color: #0000BB">SendMessage$R0</span><span style="color: #007700">${</span><span style="color: #0000BB">WM_SETTEXT</span><span style="color: #007700">}</span><span style="color: #0000BB">0</span><span style="color: #DD0000">"STR:Caption1"
<br /></span><span style="color: #007700">;</span><span style="color: #0000BB">2nd
<br />GetDlgItem$R0$InstallWindow</span><span style="color: #DD0000">"3334"
<br /></span><span style="color: #0000BB">SendMessage$R0</span><span style="color: #007700">${</span><span style="color: #0000BB">WM_SETTEXT</span><span style="color: #007700">}</span><span style="color: #0000BB">0</span><span style="color: #DD0000">"STR:Text2"
<br /></span><span style="color: #007700">;</span><span style="color: #0000BB">3rd
<br />GetDlgItem$R0$InstallWindow</span><span style="color: #DD0000">"3335"
<br /></span><span style="color: #0000BB">SendMessage$R0</span><span style="color: #007700">${</span><span style="color: #0000BB">WM_SETTEXT</span><span style="color: #007700">}</span><span style="color: #0000BB">0</span><span style="color: #DD0000">"STR:Text3"
<br /></span><span style="color: #007700">;</span><span style="color: #0000BB">4th
<br />GetDlgItem$R0$InstallWindow</span><span style="color: #DD0000">"3336"
<br /></span><span style="color: #0000BB">SendMessage$R0</span><span style="color: #007700">${</span><span style="color: #0000BB">WM_SETTEXT</span><span style="color: #007700">}</span><span style="color: #0000BB">0</span><span style="color: #DD0000">"STR:Text4"
<br /></span><span style="color: #007700">;</span><span style="color: #0000BB">5th
<br />GetDlgItem$R0$InstallWindow</span><span style="color: #DD0000">"3337"
<br /></span><span style="color: #0000BB">SendMessage$R0</span><span style="color: #007700">${</span><span style="color: #0000BB">WM_SETTEXT</span><span style="color: #007700">}</span><span style="color: #0000BB">0</span><span style="color: #DD0000">"STR:Text5"
<br /></span><span style="color: #0000BB">SectionEnd
<br /></span>
</pre>So now i can check/uncheck any box with<br />
      <br />
      <pre>
<code>GetDlgItem$R0$InstallWindow</code><span style="color: #DD0000">"3333"
<br /></span><span style="color: #0000BB">SendMessage$R0</span><span style="color: #007700">${</span><span style="color: #0000BB">BM_SETCHECK</span><span style="color: #007700">}${</span><span style="color: #0000BB">BST_CHECKED</span><span style="color: #007700">}</span><span style="color: #DD0000">""
<br /><br /></span><span style="color: #0000BB">GetDlgItem$R0$InstallWindow</span><span style="color: #DD0000">"3335"
<br /></span><span style="color: #0000BB">SendMessage$R0</span><span style="color: #007700">${</span><span style="color: #0000BB">BM_SETCHECK</span><span style="color: #007700">}${</span><span style="color: #0000BB">BST_UNCHECKED</span><span style="color: #007700">}</span><span style="color: #DD0000">""
</span>
</pre>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Bennyyy</span><br />
      <span class="post-time small text-muted">13th April 2004 14:01 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">hi<br />
      <br />
      can someone give me a working example script, please?</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Dj Nyx</span><br />
      <span class="post-time small text-muted">13th April 2004 15:27 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">gerne...</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Bennyyy</span><br />
      <span class="post-time small text-muted">13th April 2004 15:35 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">danke sehr! :D</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Dj Nyx</span><br />
      <span class="post-time small text-muted">14th April 2004 09:21 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">so now I have a little problem [its not really important...]<br />
      <br />
      i had the captions of the ckeckboxes in a languages.nsh<br />
      [<br /></p>
      <pre>
<code>LangStringCUSTOM_INSTFILES_CHECKBOX_FIRST</code><span style="color: #007700">${</span><span style="color: #0000BB">LANG_GERMAN</span><span style="color: #007700">}</span><span style="color: #DD0000">"EinMännleinstehtimWaldeganzstillundstumm,EshatvonlauterPurpureinMäntleinum.Sagt,wermagdasMännleinsein,DasdastehtimWaldallein.MitdempurpurrotenMäntelein."
</span>
</pre>]<br />
      <br />
      i read somewhere here that i have to include this language file at the bottom...<br />
      no problem...until i tried to uninstall this...<br />
      <br />
      i think that the language.nsh isn't include...<br />
      what can i do?
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Joost Verburg</span><br />
      <span class="post-time small text-muted">14th April 2004 09:56 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Use an uninstaller langauge string (.un prefix) for the uninstaller.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Dj Nyx</span><br />
      <span class="post-time small text-muted">14th April 2004 10:16 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">oh, thx</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Dj Nyx</span><br />
      <span class="post-time small text-muted">15th April 2004 14:16 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">and it goes on...<br />
      <br />
      is there a way to make the caption of a checkbox bold?<br />
      i looked in the winmessages.nsh, but havent found what i need...</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Joost Verburg</span><br />
      <span class="post-time small text-muted">15th April 2004 16:17 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">WM_SETFONT / CreateFont</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Dj Nyx</span><br />
      <span class="post-time small text-muted">16th April 2004 07:12 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">ok in my example this is...<br />
      PHP Code:</p>
      <hr />
      <code style="white-space:nowrap"><!-- php buffer start --></code><span style="color: #000000"><span style="color: #0000BB">CreateFont</span><span style="color: #007700">$</span><span style="color: #0000BB">2</span><span style="color: #DD0000">"Tahoma"</span><span style="color: #0000BB">10700<br />
      SendMessage$R0</span><span style="color: #007700">${</span><span style="color: #0000BB">WM_SETFONT</span><span style="color: #007700">}$</span><span style="color: #0000BB">20<br /></span><br />
      <br /></span>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Dj Nyx</span><br />
      <span class="post-time small text-muted">16th April 2004 07:24 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">but i am not able to make the first caption "bold" then the second......<br />
      <br />
      if i use WM_SETFONT 2 times only the last executes</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Dj Nyx</span><br />
      <span class="post-time small text-muted">16th April 2004 08:48 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">ok now i use "createfont" 5 times... it works [obviously you can't use one font for more than one caption]</p>
    </div>
    <hr />

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]>
  </script>
</body>
</html>
