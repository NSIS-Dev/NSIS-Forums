<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="description" content="ExDll example doesn't produce DLL file?"><title>ExDll example doesn't produce DLL file? - NSIS Forums</title><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script><link rel="preload" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css" as="style" onload="this.rel='stylesheet'"><link rel="preload" href="../css/style.css" as="style" onload="this.rel='stylesheet'"><noscript><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css"><link rel="stylesheet" href="../css/style.css"></noscript><script>!function(a){"use strict";var b=function(b,c,d){function e(a){return h.body?a():void setTimeout(function(){e(a)})}function f(){i.addEventListener&&i.removeEventListener("load",f),i.media=d||"all"}var g,h=a.document,i=h.createElement("link");if(c)g=c;else{var j=(h.body||h.getElementsByTagName("head")[0]).childNodes;g=j[j.length-1]}var k=h.styleSheets;i.rel="stylesheet",i.href=b,i.media="only x",e(function(){g.parentNode.insertBefore(i,c?g:g.nextSibling)});var l=function(a){for(var b=i.href,c=k.length;c--;)if(k[c].href===b)return a();setTimeout(function(){l(a)})};return i.addEventListener&&i.addEventListener("load",f),i.onloadcssdefined=l,l(f),i};"undefined"!=typeof exports?exports.loadCSS=b:a.loadCSS=b}("undefined"!=typeof global?global:this);!function(a){if(a.loadCSS){var b=loadCSS.relpreload={};if(b.support=function(){try{return a.document.createElement("link").relList.supports("preload")}catch(b){return!1}},b.poly=function(){for(var b=a.document.getElementsByTagName("link"),c=0;c<b.length;c++){var d=b[c];"preload"===d.rel&&"style"===d.getAttribute("as")&&(a.loadCSS(d.href,d,d.getAttribute("media")),d.rel=null)}},!b.support()){b.poly();var c=a.setInterval(b.poly,300);a.addEventListener&&a.addEventListener("load",function(){b.poly(),a.clearInterval(c)}),a.attachEvent&&a.attachEvent("onload",function(){a.clearInterval(c)})}}}(this);</script></head><body><div class="container"><ol class="breadcrumb"><li><a href="../index.html" class="glyphicon glyphicon-home"></a></li><li><a href="f-65.html">NSIS Discussion</a></li><li class="active">ExDll example doesn't produce DLL file?</li></ol><p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=151145">ExDll example doesn't produce DLL file?</a></p><br><div class="post"><p class="post-meta"><span class="post-author text-primary">lzandman</span><br><span class="post-time small text-muted">1st October 2003 19:32 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>ExDll example doesn't produce DLL file?</strong><br>Hi,<br><br>Since I got a lot of comments about the (big) size of my NSIS plugins created in Delphi, I'm trying to convert them to Visual C++. But when I build the ExDLL C sample DLL it doesn't generate a DLL file. Only an OBJ- and a LIB-file. Does anybody know what I'm doing wrong?<br><br>I use Visual C++ .NET 2003 and I loaded the supplied .dsw file. It asks if I want to convert it to the new format. I do this and select "Build ExDLL". Then I get a 'release' directory, but it doesn't include a DLL file, only some other files.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">DrO</span><br><span class="post-time small text-muted">1st October 2003 19:49 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">have you checked the output path in the project?<br><br>the examples in the distro normally will output the plugin into the '\plugins' folder so you will see the obj and lib files in the 'release' folder or whatever it has been called where the source is but the dll will be created elsewhere.<br><br>best to check the plugins folder for the file times is what i can suggest<br><br>hope that helps<br><br>-daz</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">lzandman</span><br><span class="post-time small text-muted">1st October 2003 20:59 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"></p><blockquote><i>Originally posted by DrO</i><br><b>have you checked the output path in the project?<br><br>best to check the plugins folder for the file times is what i can suggest</b></blockquote>You're right! I feel pretty n00b :)<br><br>I didn't check the linker output path, which is set to "../../Plugins/exdll.dll". The DLL was located in the plugins folder.<br><br>Thanx again!</div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">lzandman</span><br><span class="post-time small text-muted">1st October 2003 23:47 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">I've got a new problem. When I add my own code to the exdll example I get the following errors:<br></p><pre>
<code>exdll.obj : error LNK2019: unresolved external symbol _rand referenced in function _GetRandom<br>exdll.obj : error LNK2019: unresolved external symbol _srand referenced in function _GetRandom<br>exdll.obj : error LNK2019: unresolved external symbol _time referenced in function _GetRandom<br>exdll.obj : error LNK2001: unresolved external symbol __fltused<br>exdll.obj : error LNK2019: unresolved external symbol __ftol2 referenced in function _GetRandom<br>../../Plugins/exdll.dll : fatal error LNK1120: 5 unresolved externals</code>
</pre><br>
      I've already looked at MSDN and Google, but couldn't find the solution. It seems there's something wrong with the linked libraries. To make the srand(), rand() and time() functions work I included stdlib.h and time.h, but that didn't solve the problem.<br>
      <br>
      When I create a simple console application my code works perfectly, so the problem must be easily to solve...<br>
      <br>
      Does anybody know what might be the problem? Here's the full source code of my exdll.c file:<br>
      <pre>
<code><br>#include &lt;windows.h&gt;<br>#include &lt;stdlib.h&gt;<br>#include "exdll.h"<br>#include "time.h"<br><br>HINSTANCE g_hInstance;<br><br>HWND g_hwndParent;<br><br>int myatoi(char *s);<br><br>void __declspec(dllexport) GetRandom(HWND hwndParent, int string_size, <br>                                     char *variables, stack_t **stacktop)<br>{<br>  g_hwndParent=hwndParent;<br><br>  EXDLL_INIT();<br><br>  // do your stuff here<br>  {<br>        int range;<br>        int val;<br>        char buf[1024];<br><br>        // Pop range from stack<br>        popstring(buf);<br>        range = myatoi(buf);<br>        <br>        // Seed the random number generator with the current time<br>        srand( (unsigned)time( NULL ) );<br><br>        // The following code was taken from this website:<br>        // http://www.delorie.com/djgpp/v2faq/faq22_23.html<br>        // int random_number =<br>        //        low + (double)rand () * (high - low + 1) / RAND_MAX;<br><br>        val = ((double) rand() * range / RAND_MAX);<br><br>        wsprintf(buf,"%d",val);<br><br>        pushstring(buf);<br>  }<br>}<br><br><br><br>BOOL WINAPI _DllMainCRTStartup(HANDLE hInst, ULONG ul_reason_for_call, LPVOID lpReserved)<br>{<br>  g_hInstance=hInst;<br>        return TRUE;<br>}<br><br>// This function was copied from AdvSplash plugin<br>int myatoi(char *s)<br>{<br>  unsigned int v=0;<br>  if (*s == '0' &amp;&amp; (s[1] == 'x' || s[1] == 'X'))<br>  {<br>    s+=2;<br>    for (;;)<br>    {<br>      int c=*s++;<br>      if (c &gt;= '0' &amp;&amp; c &lt;= '9') c-='0';<br>      else if (c &gt;= 'a' &amp;&amp; c &lt;= 'f') c-='a'-10;<br>      else if (c &gt;= 'A' &amp;&amp; c &lt;= 'F') c-='A'-10;<br>      else break;<br>      v&lt;&lt;=4;<br>      v+=c;<br>    }<br>  }<br>  else if (*s == '0' &amp;&amp; s[1] &lt;= '7' &amp;&amp; s[1] &gt;= '0')<br>  {<br>    s++;<br>    for (;;)<br>    {<br>      int c=*s++;<br>      if (c &gt;= '0' &amp;&amp; c &lt;= '7') c-='0';<br>      else break;<br>      v&lt;&lt;=3;<br>      v+=c;<br>    }<br>  }<br>  else<br>  {<br>    int sign=0;<br>    if (*s == '-') { s++; sign++; }<br>    for (;;)<br>    {<br>      int c=*s++ - '0';<br>      if (c &lt; 0 || c &gt; 9) break;<br>      v*=10;<br>      v+=c;<br>    }<br>    if (sign) return -(int) v;<br>  }<br>  return (int)v;<br>}<br></code>
</pre>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br>
      <span class="post-time small text-muted">2nd October 2003 12:26 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">It's because the ExDLL project doesn't include default libraries. Add LIBC.LIB to the list of library modules.<br>
      <br>
      Please attach large files next time.</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">lzandman</span><br>
      <span class="post-time small text-muted">2nd October 2003 13:30 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"></p>

      <blockquote>
        <i>Originally posted by kichik</i><br>
        It's because the ExDLL project doesn't include default libraries. Add LIBC.LIB to the list of library modules.
      </blockquote>Thanx, I will try that when I get home.

      <blockquote>
        Please attach large files next time.
      </blockquote>I tried that at first, but the forum didn't accept .c files. I had to press "back" in my browser and I also lost all the text that I had typed. So I added it in-line with the text.
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br>
      <span class="post-time small text-muted">2nd October 2003 13:36 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Rename it to .txt then.</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">lzandman</span><br>
      <span class="post-time small text-muted">2nd October 2003 15:33 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"></p>

      <blockquote>
        <i>Originally posted by kichik</i><br>
        <b>Rename it to .txt then.</b>
      </blockquote>OK OK... I will do that next time :p
    </div>
    <hr>

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]></script></body></html>