<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="description" content="Problem with pluggins"><title>Problem with pluggins - NSIS Forums</title><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script><link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css"><link rel="stylesheet" href="../css/style.css" type="text/css"></head><body><div class="container"><ol class="breadcrumb"><li><a href="../index.html" class="glyphicon glyphicon-home"></a></li><li><a href="f-65.html">NSIS Discussion</a></li><li class="active">Problem with pluggins</li></ol><p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=242588">Problem with pluggins</a></p><br><div class="post"><p class="post-meta"><span class="post-author text-primary">RaulFlores</span><br><span class="post-time small text-muted">4th April 2006 18:36 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>Problem with pluggins</strong><br>Hello Everybody.<br><br>I have a problem with my installer I try to use two pluggins but they use the same variable $1 How can I change this variable?<br><br>I need to use this pluggins for my installer<br><br><br>FontName.nsh<br>FileFunc.nsh<br>WriteEnvStr.nsh</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br><span class="post-time small text-muted">4th April 2006 19:26 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">In what way are they using $1? Do they use it internally, or by how you are using them?<br>Some sample code would help us identify the problem and produce a solution.<br><br>-Stu</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">RaulFlores</span><br><span class="post-time small text-muted">4th April 2006 21:01 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Hello I send you the code of my installer</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">RaulFlores</span><br><span class="post-time small text-muted">4th April 2006 21:08 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Sorry a forget the file. But I send you.<br><br>The file contains my intaller and the pluggins that I used</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br><span class="post-time small text-muted">4th April 2006 22:21 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">I still don't understand what the problem is. You aren't even using $1 in any of your own code and the BgImage plugin doesn't use it.<br><br>If you want to use $1 in your script and find that something is changing its value, just use a different variable or perhaps create your own with the Var instruction.<br><br>-Stu</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">RaulFlores</span><br><span class="post-time small text-muted">5th April 2006 19:11 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Thanks a lot I sorted out the problem with my installer. but I have another problem, when I try to create a Shortcut with this instruction<br><br>CreateShortCut "$DESKTOP\SIG-TC ZMVM.lnk" "$BLA" ""<br><br>The variable $BLA contains the value<br><br>"C:\Archivos de programa\TransCAD\tcw.exe" -q -a C:\SIG-TC\compilacion\gis-tc -ai SIG-TC -n "SIG-Transporte de carga ZMVM"<br><br>But when the installer creates the shortcut on the DESKTOP, it has this value:<br><br>"C:\"C:\Archivos de programa\TransCAD\tcw.exe" -q -a C:\SIG-TC\compilacion\gis-tc -ai SIG-TC -n "SIG-Transporte de carga ZMVM" "<br><br>How I can clear value "C:\ at the begining of the string and " in the last part?</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">JasonFriday13</span><br><span class="post-time small text-muted">6th April 2006 03:41 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Try using ' around the value.</p><pre>
<code>'"C:\Archivos de programa\TransCAD\tcw.exe" -q -a C:\SIG-TC\compilacion\gis-tc -ai SIG-TC -n "SIG-Transporte de carga ZMVM"'</code>
</pre></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br><span class="post-time small text-muted">6th April 2006 09:09 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">CreateShortCut requires the parameters to be separate from the target path:<br><br>CreateShortCut<br>link.lnk target.file [parameters [icon.file [icon_index_number [start_options [keyboard_shortcut [description]]]]]]<br><br>Where does your target path come from exactly?<br>Is it a constant value set at compile time or a path read from somewhere at run time?<br><br>-Stu</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">RaulFlores</span><br><span class="post-time small text-muted">6th April 2006 19:02 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Hello<br><br>I send you a basic example, it only creates a Shortcut on the desktop.<br><br>In the code I read from the registry, this value is the target path that I want in the shortcut, but I don't know why in the shorcut the value appears like this:<br><br>"C:\"C:\Archivos de programa\Microsoft Office\OFFICE11\WINWORD.EXE" \n \dde"<br><br>And the correct path is:<br><br>"C:\Archivos de programa\Microsoft Office\OFFICE11\WINWORD.EXE" \n \dde<br><br><br>Thanks a lot for help me</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br><span class="post-time small text-muted">6th April 2006 19:20 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Well like I've already said, CreateShortCut must be like the following:<br><br>CreateShortCut "icon file.lnk" "target file.exe" "parameters"<br><br>Use this function to get the path in the quotes:<br><a href="http://nsis.sourceforge.net/GetInQuotes:_Get_string_from_between_quotes" target="_blank">http://nsis.sourceforge.net/GetInQuo...between_quotes</a><br>If you need the parameters as well, I can probably update the function to return the rest of the string not in quotes (in this case it'd be the parameters).<br><br></p><pre>
<code>ReadRegStr $R0 HKLM SOFTWARE\Classes\Applications\WINWORD.EXE\shell\edit\command ""<br><br>Push $R0<br> Call GetInQuotes<br>Pop $R0<br><br>CreateShortCut "$DESKTOP\TEST.lnk" $R0</code>
</pre><br>
      <br>
      -Stu
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">RaulFlores</span><br>
      <span class="post-time small text-muted">6th April 2006 21:46 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Hello Again Thaks a lot for help me.<br>
      <br>
      I did all that you said me. but the target path now is:<br>
      <br>
      "C:\Archivos de programa\Microsoft Office\OFFICE11\WINWORD.EXE"<br>
      <br>
      and the correct is<br>
      <br>
      "C:\Archivos de programa\Microsoft Office\OFFICE11\WINWORD.EXE" \n \dde<br>
      <br>
      How can I obtain the rest of the string not in quotes?<br>
      <br>
      I send you again my code<br>
      <br>
      Thanks</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">RaulFlores</span><br>
      <span class="post-time small text-muted">6th April 2006 22:01 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Code of TEST</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">galil</span><br>
      <span class="post-time small text-muted">7th April 2006 02:23 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Assuming that the path part of the string you read from registry is always in quotes...<br></p>
      <pre>
<code>!include "StrFunc.nsh"<br>${StrStrAdv}<br><br>Name "Test"<br>OutFile "Test.exe"<br><br>Section ""<br><br>ReadRegStr $0 HKLM SOFTWARE\Classes\Applications\WINWORD.EXE\shell\edit\command ""<br>${StrStrAdv} $R0 $0 "$\" " &gt; &lt; 1 0 0 #get path<br>${StrStrAdv} $R1 $0 "$\" " &gt; &gt; 0 0 0 #get the rest<br>StrCpy $R0 $R0 -1 #trim ending space character from path<br>CreateShortCut "$DESKTOP\TEST.lnk" $R0 $R1<br><br>SectionEnd</code>
</pre>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">RaulFlores</span><br>
      <span class="post-time small text-muted">7th April 2006 04:48 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Thanks for help me. My installer is OK</p>
    </div>
    <hr>

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]></script></body></html>