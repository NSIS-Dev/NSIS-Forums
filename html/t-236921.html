<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="description" content="Working on my first script for Pocket PC - Need some help"><title>Working on my first script for Pocket PC - Need some help - NSIS Forums</title><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script><link rel="preload" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css" as="style" onload="this.rel='stylesheet'"><link rel="preload" href="../css/style.css" as="style" onload="this.rel='stylesheet'"><noscript><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css"><link rel="stylesheet" href="../css/style.css"></noscript><script>!function(a){"use strict";var b=function(b,c,d){function e(a){return h.body?a():void setTimeout(function(){e(a)})}function f(){i.addEventListener&&i.removeEventListener("load",f),i.media=d||"all"}var g,h=a.document,i=h.createElement("link");if(c)g=c;else{var j=(h.body||h.getElementsByTagName("head")[0]).childNodes;g=j[j.length-1]}var k=h.styleSheets;i.rel="stylesheet",i.href=b,i.media="only x",e(function(){g.parentNode.insertBefore(i,c?g:g.nextSibling)});var l=function(a){for(var b=i.href,c=k.length;c--;)if(k[c].href===b)return a();setTimeout(function(){l(a)})};return i.addEventListener&&i.addEventListener("load",f),i.onloadcssdefined=l,l(f),i};"undefined"!=typeof exports?exports.loadCSS=b:a.loadCSS=b}("undefined"!=typeof global?global:this);!function(a){if(a.loadCSS){var b=loadCSS.relpreload={};if(b.support=function(){try{return a.document.createElement("link").relList.supports("preload")}catch(b){return!1}},b.poly=function(){for(var b=a.document.getElementsByTagName("link"),c=0;c<b.length;c++){var d=b[c];"preload"===d.rel&&"style"===d.getAttribute("as")&&(a.loadCSS(d.href,d,d.getAttribute("media")),d.rel=null)}},!b.support()){b.poly();var c=a.setInterval(b.poly,300);a.addEventListener&&a.addEventListener("load",function(){b.poly(),a.clearInterval(c)}),a.attachEvent&&a.attachEvent("onload",function(){a.clearInterval(c)})}}}(this);</script></head><body><div class="container"><ol class="breadcrumb"><li><a href="../index.html" class="glyphicon glyphicon-home"></a></li><li><a href="f-65.html">NSIS Discussion</a></li><li class="active">Working on my first script for Pocket PC - Need some help</li></ol><p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=236921">Working on my first script for Pocket PC - Need some help</a></p><br><div class="post"><p class="post-meta"><span class="post-author text-primary">Loogie</span><br><span class="post-time small text-muted">1st February 2006 13:47 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>Working on my first script for Pocket PC - Need some help</strong><br>Hi<br><br>I have read through the forums and have used an example off of here to create an install for my application. However it is not working quite right.<br><br>It displays the readme.txt and eula.txt fine and connects to my Pocket PC fine but the installation screen for the Pocket PC has a bunch of files listed there to select for install/remove (why I don't know) but none are the files contained in my script. It appears that my cabs and .mdb file are being ignored even though they are in the same folder as the readme.txt and eula.txt.<br><br>Can some someone figure this out for me and point me in the right direction. I am new to this so simple explainations work best for my simple mind.<br><br>I have pasted my ini file then my installer script.<br><br>Thanks<br><br>L<br><br>*********************<br>setup.ini start<br>*********************<br></p><pre>
<code>[CEAppManager]<br>Version      = 1.0<br>Component    = App<br><br>[App]<br>Description  = Pocket PCT.<br>CabFiles = pct_PPC.ARM.CAB,pct_PPC.ARMV4.CAB,pct_PPC.MIPS.CAB,pct_PPC.WCE420X86.CAB,pct_PPC.X86.CAB</code>
</pre><br>
      <br>
      *********************<br>
      setup.nsi start<br>
      *********************<br>
      <pre>
<code>; Script generated with the Venis Install Wizard<br><br>; Define your application name<br>!define APPNAME "Pocket PCT"<br>!define APPNAMEANDVERSION "Pocket PCT v1.1"<br><br>; Use compression<br>SetCompressor /FINAL /SOLID LZMA<br><br>Icon "G:\Visual Studio Projects\Projects\pct.ico"<br><br><br>; Main Install settings<br>Name "${APPNAMEANDVERSION}"<br>InstallDir "$PROGRAMFILES\Pocket PCT"<br>InstallDirRegKey HKLM "Software\${APPNAME}" ""<br>OutFile "pocketpct.exe"<br><br>!define MUI_WELCOMEPAGE_TITLE_3LINES<br>!define MUI_WELCOMEFINISHPAGE_BITMAP "${NSISDIR}\Contrib\Graphics\Wizard\orange.bmp"<br><br>; Modern interface settings<br>!include "MUI.nsh"<br>!include "FileFunc.nsh"<br><br>;!define MUI_FINISHPAGE_SHOWREADME "readme.txt"<br>;!define MUI_FINISHPAGE_LINK "Pocket PCT: <a href="http://www.pct.com" target="_blank">http://www.pct.com</a>"<br>;!define MUI_FINISHPAGE_LINK_LOCATION <a href="http://www.pct.com" target="_blank">http://www.pct.com</a><br>  <br>!define MUI_ABORTWARNING<br><br>!insertmacro MUI_PAGE_WELCOME<br>Page custom ReadmePage<br>!insertmacro MUI_PAGE_LICENSE "eula.txt"<br>;!insertmacro MUI_PAGE_DIRECTORY<br>!insertmacro MUI_PAGE_INSTFILES<br>!insertmacro MUI_PAGE_FINISH<br><br>!insertmacro MUI_UNPAGE_CONFIRM<br>!insertmacro MUI_UNPAGE_INSTFILES<br><br>; Set languages (first is default language)<br>!insertmacro MUI_LANGUAGE "English"<br>!insertmacro MUI_RESERVEFILE_LANGDLL<br><br>ReserveFile "readme.txt"<br>ReserveFile "eula.txt"<br>ReserveFile "readme.ini"<br><br>!insertmacro GetParent<br><br>Section "PCT" Section1<br><br>        ReadRegStr $1 HKEY_LOCAL_MACHINE "software\Microsoft\Windows\CurrentVersion\App Paths\CEAppMgr.exe" ""<br>        IfErrors Error<br>        Goto End<br>        Error:<br>        MessageBox MB_OK|MB_ICONEXCLAMATION \<br>        "Unable to find an Application Manager for PocketPC applications. \<br>        Please install Microsoft ActiveSync and reinstall the software."<br>        Abort<br>        End:<br><br>        ${GetParent} "$1" $2<br>        ; Set Section properties<br>        SetOverwrite on<br><br>        ; Set Section Files and Shortcuts<br>        SetOutPath "$2\Pocket PCT"<br>        File "pct_PPC.ARM.CAB"<br>        File "pct_PPC.ARMV4.CAB"<br>        File "pct_PPC.MIPS.CAB"<br>        File "pct_PPC.SH3.CAB"<br>        File "pct_PPC.WCE420X86.CAB"<br>        File "pct_PPC.X86.CAB"<br>            File "pct.mdb"<br>            File "eula.txt"<br>        File "readme.txt"<br>        File "setup.ini"<br><br>        StrCpy $0 "$2\setup.ini"<br>        Call InstallCAB<br>SectionEnd<br><br>Var HWND<br>Var DLGITEM<br><br>Function ReadmePage<br><br>  InitPluginsDir<br>  SetOutPath "$PLUGINSDIR"<br>  File "readme.txt"<br><br>  !insertmacro MUI_HEADER_TEXT "Release notes" "Pleas read"<br>  !insertmacro MUI_INSTALLOPTIONS_INITDIALOG "readme.ini"<br>  Pop $HWND ;HWND of dialog<br>  GetDlgItem $DLGITEM $HWND 1200 ;1200 + Field number - 1<br>    <br>  ;$DLGITEM contains the HWND of the first field<br>  SetCtlColors $DLGITEM "" "${MUI_BGCOLOR}"<br><br>  ; clear the field<br>  SendMessage $DLGITEM ${WM_SETTEXT} 1 "STR: "<br><br>  FileOpen $1 "$PLUGINSDIR\readme.txt" "r"<br>  loop:<br>     FileRead $1 $2<br>     SendMessage $DLGITEM 0x00C2 0 "STR:$2"<br>  IfErrors 0 loop<br>  FileClose $1<br>  SendMessage $DLGITEM 0x00B1 0 0  ; EM_SETSEL<br>  SendMessage $DLGITEM 0x00B7 0 0  ; EM_SCROLLCARET<br><br>  !insertmacro MUI_INSTALLOPTIONS_SHOW<br><br>FunctionEnd<br><br>Function InstallCAB<br><br>   ExecWait '"$1" "$0"'<br><br>FunctionEnd <br><br>; Modern install component descriptions<br>!insertmacro MUI_FUNCTION_DESCRIPTION_BEGIN<br>        !insertmacro MUI_DESCRIPTION_TEXT ${Section1} ""<br>!insertmacro MUI_FUNCTION_DESCRIPTION_END<br><br><br>; On initialization<br>Function .onInit<br><br>        !insertmacro MUI_INSTALLOPTIONS_EXTRACT "readme.ini"<br>        !insertmacro MUI_LANGDLL_DISPLAY<br><br>FunctionEnd<br><br>; eof</code>
</pre>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br>
      <span class="post-time small text-muted">3rd February 2006 11:56 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">CEAppMgr might be looking for the files in the directory that contains setup.ini because you haven't supplied full paths in the setup.ini. Try extracting setup.ini to the same directory as the CABs.<br>
      <br>
      Please attach scripts next time.</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">zbd</span><br>
      <span class="post-time small text-muted">7th November 2006 22:22 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">also<br></p>
      <pre>
<code><br>SetOutPath "$2\Pocket PCT"<br><br>StrCpy $0 "$2\setup.ini"<br></code>
</pre><br>
      wouldn't it need to be<br>
      <pre>
<code><br>StrCpy $0 "$2\Pocket PCT\setup.ini"<br></code>
</pre>
    </div>
    <hr>

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script type="text/javascript" src="../js/highlight.pack.js" async>
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]></script></body></html>