<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="description" content="Import digital certificate"><title>Import digital certificate - NSIS Forums</title><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script><link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css"><link rel="stylesheet" href="../css/style.css" type="text/css"><!--[if lt IE 9]><script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script><script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script><![endif]--></head><body><div class="container"><ol class="breadcrumb"><li><a href="../index.html" class="glyphicon glyphicon-home"></a></li><li><a href="f-65.html">NSIS Discussion</a></li><li class="active">Import digital certificate</li></ol><p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=249446">Import digital certificate</a></p><br><div class="post"><p class="post-meta"><span class="post-author text-primary">ewallig</span><br><span class="post-time small text-muted">23rd June 2006 17:13 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>Import digital certificate</strong><br>Hi,<br><br>Saw one post on this a couple of years ago - is there any way to import a root certificate as part of an installation? My "pet app" is code signed by an internal CA and the root cert for that ca needs to be imported for the app to work correctly.<br><br>Any thoughts?<br><br>Thanks...:igor:</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">onad</span><br><span class="post-time small text-muted">27th June 2006 17:13 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">IMHO<br><br>Write a plugin for NSIS via Delphi (see examples of how to do just that) with the help of buying the source of the following<br><br><a href="http://www.eldos.com/sbb/desc-pki-features.php" target="_blank">http://www.eldos.com/sbb/desc-pki-features.php</a><br><br>In the worst case you can look in the souce and try to do this by useing NSIS System command, but then you must be reeeeeaaaly persistant to get it working ;)</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">ewallig</span><br><span class="post-time small text-muted">27th June 2006 20:17 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Yeah, I'm simply not that talented....but I did get it to work using the CAPICOM dll, a sample vbscript that comes in the CAPICOM SDK, and the basic modern UI example so all is well.<br><br>Thanks again...;)</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">darshanaltekar</span><br><span class="post-time small text-muted">29th March 2007 10:45 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Hey ewallig<br>Can you please give me the code to install the certificate please<br>Thanks in advance</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">ewallig</span><br><span class="post-time small text-muted">29th March 2007 15:18 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Hi,<br><br>you need the following files<br><br>- CAPICOM.dll<br>- The vbscript file that MSOFT provides for the procedure<br><br>Both of these files can be obtained from Microsoft but if you need to, send an email to <a href="mailto:ilinktech@yahoo.com">ilinktech@yahoo.com</a> and I'll get them out to you. As far as the NSIS code, see the attached file.<br><br>The installer checks for and if necessary installs / registers CAPICOM, copies the files to a TEMP folder, executes the script which imports the cert. Once the cert is imported, it unregisters and removes CAPICOM (security purposes) and then deletes the temp files.<br><br>No real error checking built in but I'm sure that it can be improved on. It works 100% of the time for me so I didn't add anything else to it.<br><br>Hope this helps,<br><br>- Ed</p></div><hr><div class="footer"><p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p></div></div><script src="../js/highlight.pack.js" type="text/javascript"></script><script type="text/javascript">//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]></script></body></html>