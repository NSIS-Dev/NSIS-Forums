<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="NT 4 crash" />

  <title>NT 4 crash - NSIS Forums</title>
  <script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script>
  <!-- Bootstrap core CSS -->

  <link rel="stylesheet" type="text/css" href="//netdna.bootstrapcdn.com/bootswatch/3.0.1/readable/bootstrap.min.css" />
  <link rel="stylesheet" href="../css/style.css" type="text/css" /><!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!--[if lt IE 9]>
                <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
                <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->
</head>

<body>
  <div class="container">
    <!-- Put navigation bar here -->

    <ol class="breadcrumb">
      <li><a href="../index.html" class="glyphicon glyphicon-home"></a></li>

      <li><a href="f-65.html">NSIS Discussion</a></li>

      <li class="active">NT 4 crash</li>
    </ol>

    <p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=57902">NT 4 crash</a></p><br />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Pomflain</span><br />
      <span class="post-time small text-muted">22nd August 2001 20:55 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>NT 4 crash</strong><br />
      Ok, I decided to continue working on the stuff from yesterday and decided to popup a message box if the uninstaller can't be run. So I added that in today, but now there's a new problem. Randomly, there will be a memory read error before the message box appears.<br />
      <br />
      Perhaps there's a problem with the speed since the computer is slow and it's trying the ShellExec and Exec at about the same time and that's causing the crash? I'll put a sleep delay in there and see what happens.<br />
      <br />
      Here's the new code I'm using:<br />
      <br />
      Function .onInit<br />
      <br />
      strcpy $4 "PiCoMap"<br />
      <br />
      ReadRegStr $9 HKEY_LOCAL_MACHINE "SOFTWARE\Microsoft\Windows\CurrentVersion\Uninstall\$4" "UninstallString"<br />
      strcmp $9 "" Clean PrevInst<br />
      <br />
      Clean:<br />
      goto InitDone<br />
      <br />
      PrevInst:<br />
      <br />
      ReadRegStr $8 HKEY_LOCAL_MACHINE "SOFTWARE\Microsoft\Windows\CurrentVersion\Uninstall\$4" "DisplayName"<br />
      MessageBox MB_YESNO "$8 found$\nUninstall this version?" IDNO InitDone<br />
      ExecShell "open" "$9" SW_SHOWNORMAL<br />
      <br />
      IfErrors InstErr InitDone<br />
      InstErr:<br />
      Call FailedUninst<br />
      <br />
      InitDone:<br />
      FunctionEnd<br />
      <br />
      Function FailedUninst<br />
      ReadRegStr $9 HKEY_LOCAL_MACHINE "SOFTWARE\Microsoft\Windows\CurrentVersion\Uninstall\$4" "UninstallString"<br />
      ClearErrors<br />
      Exec "$9"<br />
      IfErrors DisplayMsgBox Fin<br />
      <br />
      DisplayMsgBox:<br />
      MessageBox MB_YESNO|MB_ICONSTOP "Uninstaller failed to load, please uninstall before continuing$\n$\n Abort installation?" IDNO Fin<br />
      Abort<br />
      Fin:<br />
      FunctionEnd</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Pomflain</span><br />
      <span class="post-time small text-muted">22nd August 2001 21:15 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Ok, I added in the sleep and the problem seems to have gone away...</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Pomflain</span><br />
      <span class="post-time small text-muted">23rd August 2001 16:05 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Ok, the problem isn't fixed, I got that same read memory error crash once again. So maybe it's not a problem of running ExecShell and Exec on the same program at roughly the same time.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">DuaneJeffers</span><br />
      <span class="post-time small text-muted">24th August 2001 00:49 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Try offering it for download here so that we see what the problem is. If you Zip it up and add the NSI source (not in the installer) then we here at the forums will help you. I think that NSIS wasn't built for Win3.1, WinNT 4, and (I believe) Win95. This might account for the problem.<br />
      <br />
      -DJ</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Pomflain</span><br />
      <span class="post-time small text-muted">24th August 2001 19:23 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Go to <a href="http://www.palmgear.com" target="_blank">www.palmgear.com</a> and search for apps by Hi-CE Development. Actually, it's only the in the new ones we uploaded yesterday. So PiCoMap 1.71 and WriteHere 1.4.0 will have this problem. I added in a test, but it does crash on occasion. As for the source, I tried uploading, but the unix convertion wasn't nice, and it didn't work uploading, so I'll just paste it all in here.<br />
      <br />
      ; Generated NSIS script file (generated by makensitemplate.phtml 0.20)<br />
      ; by 141.213.34.248 on Jun 12 01 @ 18:31<br />
      <br />
      ; NOTE: this .NSI script is designed for NSIS v1.3+<br />
      <br />
      Name "WriteHere 1.4.0"<br />
      OutFile "WriteHere_Installer140.exe"<br />
      <br />
      ; Some default compiler settings (uncomment and change at will):<br />
      ; SetCompress auto ; (can be off or force)<br />
      ; SetDatablockOptimize on ; (can be off)<br />
      ; CRCCheck on ; (can be off)<br />
      ; AutoCloseWindow false ; (can be true for the window go away automatically at end)<br />
      ; ShowInstDetails hide ; (can be show to have them shown, or nevershow to disable)<br />
      ; SetDateSave on ; (can be on to have files restored to their orginal date)<br />
      <br />
      SetCompress auto ; (can be off or force)<br />
      SetDatablockOptimize on ; (can be off)<br />
      CRCCheck on ; (can be off)<br />
      AutoCloseWindow false ; (can be true for the window go away automatically at end)<br />
      SetDateSave on ; (can be on to have files restored to their orginal date)<br />
      <br />
      InstType "Full"<br />
      <br />
      InstallDir "$DESKTOP\Hi-CE\WriteHere"<br />
      InstallDirRegKey HKEY_LOCAL_MACHINE "SOFTWARE\Hi-CE\WriteHere" ""<br />
      DirShow show ; (make this hide to not let the user change it)<br />
      DirText "Preparing to install WriteHere"<br />
      Icon WriteHere.ico<br />
      <br />
      ComponentText "Select Components to Install"<br />
      EnabledBitmap Check3.bmp<br />
      DisabledBitmap Gray3.bmp<br />
      <br />
      LicenseText 'You must click "next" to agree to this license before installing.'<br />
      LicenseData "WriteHere Disclaimer.txt"<br />
      <br />
      Section "WriteHere.prc (34 kb)"<br />
      ;SectionIn 12345678 ; (uncomment and change this to add it to install types)<br />
      SetOutPath "$INSTDIR"<br />
      StrCpy $0 "false"<br />
      SectionEnd ; end of default section<br />
      SectionDivider ;<br />
      <br />
      Section "Spellchecker Database (914 kb) [optional]"<br />
      SectionIn 1;<br />
      File "WriteHereSpellDB.pdb"<br />
      StrCpy $0 "true"<br />
      SectionEnd ; end of default section<br />
      <br />
      Section "Conduit"<br />
      SectionIn 1;<br />
      StrCpy $7 "true"<br />
      SectionEnd ; end of default section<br />
      <br />
      Section ""<br />
      strcpy $4 "WriteHere"<br />
      <br />
      File "WriteHere.prc"<br />
      File "Readme.txt"<br />
      File "Goto_Hi-CE_Handhelds_web_site.url"<br />
      File "WriteHere_Quick_Start.pdf"<br />
      File "Getting_Started.pdf"<br />
      <br />
      StrCpy $8 "erHw"<br />
      <br />
      ReadRegStr $9 HKEY_CURRENT_USER "Software\U.S. Robotics\Pilot Desktop\Core" "Path"<br />
      <br />
      strcmp $9 "" Bad Good<br />
      <br />
      Bad:<br />
      Abort "Palm Desktop 3.x must be installed before $4 - Aborting Installation"<br />
      <br />
      Good:<br />
      <br />
      WriteRegStr HKEY_LOCAL_MACHINE "SOFTWARE\Hi-CE\$4" "" "$INSTDIR"<br />
      WriteRegStr HKEY_LOCAL_MACHINE "Software\Microsoft\Windows\CurrentVersion\Uninstall\$4" "DisplayName" "Hi-CE: $4 1.4.0 (remove only)"<br />
      WriteRegStr HKEY_LOCAL_MACHINE "Software\Microsoft\Windows\CurrentVersion\Uninstall\$4" "UninstallString" '"$INSTDIR\uninst.exe"'<br />
      <br />
      strcmp $7 "true" HotSyncChk Complete<br />
      <br />
      HotSyncChk:<br />
      FindWindow goto:HotSyncRunning "KittyHawk"<br />
      StrCpy $1 "false"<br />
      Goto PalmRegistry<br />
      <br />
      HotSyncRunning:<br />
      ReadRegStr $6 HKEY_CURRENT_USER "Software\U.S. Robotics\Pilot Desktop\HotSync Manager" "DontAskExit"<br />
      StrCpy $1 "true"<br />
      <br />
      strcmp $6 "" CloseHotSyncManager CloseDontAsk<br />
      CloseHotSyncManager:<br />
      WriteRegDword HKEY_CURRENT_USER "Software\U.S. Robotics\Pilot Desktop\HotSync Manager" "DontAskExit" 1<br />
      StrCpy $6 "true"<br />
      <br />
      CloseDontAsk:<br />
      FindWindow closeinstant "KittyHawk"<br />
      <br />
      PalmRegistry:<br />
      ReadRegStr $2 HKEY_LOCAL_MACHINE "SOFTWARE\Hi-CE\$4" "AppNum"<br />
      strcmp $2 "" NewInst RegChk<br />
      NewInst:<br />
      StrCpy $2 "3"<br />
      <br />
      RegChk:<br />
      ReadRegStr $3 HKEY_CURRENT_USER "Software\U.S. Robotics\Pilot Desktop\Application$2" "Creator"<br />
      strcmp $3 "" BgnWrt<br />
      <br />
      Strcmp $3 $8 DelConduit ChkDigits<br />
      <br />
      DelConduit:<br />
      DeleteRegKey HKEY_CURRENT_USER "Software\U.S. Robotics\Pilot Desktop\Application$2"<br />
      Goto BgnWrt<br />
      <br />
      ChkDigits:<br />
      Strcmp $2 "3" Set4 Set5<br />
      Set4:<br />
      StrCpy $2 "4"<br />
      Goto RegChk<br />
      <br />
      Set5:<br />
      Strcmp $2 "4" Set5a Set6<br />
      Set5a:<br />
      StrCpy $2 "5"<br />
      Goto RegChk<br />
      <br />
      Set6:<br />
      Strcmp $2 "5" Set6a Set7<br />
      Set6a:<br />
      StrCpy $2 "6"<br />
      Goto RegChk<br />
      <br />
      Set7:<br />
      Strcmp $2 "6" Set7a Set8<br />
      Set7a:<br />
      StrCpy $2 "7"<br />
      Goto RegChk<br />
      <br />
      Set8:<br />
      Strcmp $2 "7" Set8a Set9<br />
      Set8a:<br />
      StrCpy $2 "8"<br />
      Goto RegChk<br />
      <br />
      Set9:<br />
      Strcmp $2 "8" Set9a Set10<br />
      Set9a:<br />
      StrCpy $2 "9"<br />
      Goto RegChk<br />
      <br />
      Set10:<br />
      Strcmp $2 "9" Set10a Set11<br />
      Set10a:<br />
      StrCpy $2 "10"<br />
      Goto RegChk<br />
      <br />
      Set11:<br />
      Strcmp $2 "10" Set11a Set12<br />
      Set11a:<br />
      StrCpy $2 "11"<br />
      Goto RegChk<br />
      <br />
      Set12:<br />
      Strcmp $2 "11" Set12a Set13<br />
      Set12a:<br />
      StrCpy $2 "12"<br />
      Goto RegChk<br />
      <br />
      Set13:<br />
      Strcmp $2 "12" Set13a Set14<br />
      Set13a:<br />
      StrCpy $2 "13"<br />
      Goto RegChk<br />
      <br />
      Set14:<br />
      Strcmp $2 "13" Set14a Set15<br />
      Set14a:<br />
      StrCpy $2 "14"<br />
      Goto RegChk<br />
      <br />
      Set15:<br />
      Strcmp $2 "14" Set15a Set16<br />
      Set15a:<br />
      StrCpy $2 "15"<br />
      Goto RegChk<br />
      <br />
      Set16:<br />
      Strcmp $2 "15" Set16a Set17<br />
      Set16a:<br />
      StrCpy $2 "16"<br />
      Goto RegChk<br />
      <br />
      Set17:<br />
      Strcmp $2 "16" Set17a Set18<br />
      Set17a:<br />
      StrCpy $2 "17"<br />
      Goto RegChk<br />
      <br />
      Set18:<br />
      Strcmp $2 "17" Set18a Set19<br />
      Set18a:<br />
      StrCpy $2 "18"<br />
      Goto RegChk<br />
      <br />
      Set19:<br />
      Strcmp $2 "18" Set19a Set20<br />
      Set19a:<br />
      StrCpy $2 "19"<br />
      Goto RegChk<br />
      <br />
      Set20:<br />
      Strcmp $2 "19" Set20a Set21<br />
      Set20a:<br />
      StrCpy $2 "20"<br />
      Goto RegChk<br />
      <br />
      Set21:<br />
      Strcmp $2 "20" Set21a Set22<br />
      Set21a:<br />
      StrCpy $2 "21"<br />
      Goto RegChk<br />
      <br />
      Set22:<br />
      Strcmp $2 "21" Set22a Set23<br />
      Set22a:<br />
      StrCpy $2 "22"<br />
      Goto RegChk<br />
      <br />
      Set23:<br />
      Strcmp $2 "22" Set23a Set24<br />
      Set23a:<br />
      StrCpy $2 "23"<br />
      Goto RegChk<br />
      <br />
      Set24:<br />
      Strcmp $2 "23" Set24a Set25<br />
      Set24a:<br />
      StrCpy $2 "24"<br />
      Goto RegChk<br />
      <br />
      Set25:<br />
      Strcmp $2 "25" SetFinal<br />
      SetFinal:<br />
      StrCpy $2 "63"<br />
      ReadRegStr $3 HKEY_CURRENT_USER "Software\U.S. Robotics\Pilot Desktop" "Application$2"<br />
      ifErrors RegAbort BgnWrt<br />
      RegAbort:<br />
      Abort "Too many conduits installed - Aborting installation"<br />
      <br />
      BgnWrt:<br />
      <br />
      WriteRegStr HKEY_CURRENT_USER "Software\U.S. Robotics\Pilot Desktop\Application$2" "Conduit" "$4.dll"<br />
      WriteRegStr HKEY_CURRENT_USER "Software\U.S. Robotics\Pilot Desktop\Application$2" "Remote0" "$4DB"<br />
      WriteRegDword HKEY_CURRENT_USER "Software\U.S. Robotics\Pilot Desktop\Application$2" "Creator" 0x77487265<br />
      WriteRegDword HKEY_CURRENT_USER "Software\U.S. Robotics\Pilot Desktop\Application$2" "Priority" 2<br />
      WriteRegStr HKEY_LOCAL_MACHINE "SOFTWARE\Hi-CE\$4" "AppNum" $2<br />
      <br />
      ;StrCpy $4 $OUTDIR<br />
      <br />
      SetOutPath $9<br />
      <br />
      File "WriteHere.dll"<br />
      <br />
      SetOutPath "$INSTDIR\Images"<br />
      <br />
      File "Hi-CE_logo.jpeg"<br />
      File "leftArrow.gif"<br />
      File "rightArrow.gif"<br />
      File "upArrow.gif"<br />
      File "WriteHereLogo.gif"<br />
      <br />
      SetOutPath "$INSTDIR\Data"<br />
      <br />
      SetOutPath "$INSTDIR"<br />
      <br />
      strcmp $1 "true" RestartHotSync<br />
      Goto Complete<br />
      RestartHotSync:<br />
      <br />
      strcmp $6 "true" ResetKey JmpEnd<br />
      ResetKey:<br />
      WriteRegDword HKEY_CURRENT_USER "Software\U.S. Robotics\Pilot Desktop\HotSync Manager" "DontAskExit" 0<br />
      <br />
      JmpEnd:<br />
      <br />
      ClearErrors<br />
      ExecShell "open" "$9\HotSync.exe" SW_SHOWNORMAL<br />
      ifErrors HotSyncErr0 Complete<br />
      <br />
      HotSyncErr0:<br />
      Call HotSyncFailedMsg<br />
      <br />
      Complete:<br />
      <br />
      MessageBox MB_YESNO|MB_ICONQUESTION|MB_TOPMOST \<br />
      "View README file?" \<br />
      IDNO SkipReadme<br />
      <br />
      ExecShell "open" "$OUTDIR\Readme.txt" SW_SHOWNORMAL<br />
      <br />
      SkipReadme:<br />
      <br />
      <br />
      MessageBox MB_YESNO|MB_ICONQUESTION \<br />
      "Would you like to view the Getting Started Page?$\n$\n(Requires Adobe Acrobat Reader)" \<br />
      IDNO SkipQSe<br />
      <br />
      ExecShell "open" "$OUTDIR\Getting_Started.pdf" SW_SHOWNORMAL<br />
      <br />
      SkipQSe:<br />
      <br />
      MessageBox MB_YESNO|MB_ICONQUESTION \<br />
      "Would you like to view the Quick Start Guide?$\n$\n(Requires Adobe Acrobat Reader)" \<br />
      IDNO SkipQS<br />
      <br />
      ExecShell "open" "$OUTDIR\$4_Quick_Start.pdf" SW_SHOWNORMAL<br />
      <br />
      SkipQS:<br />
      HideWindow<br />
      strcmp $0 "true" Both One<br />
      One:<br />
      <br />
      ClearErrors<br />
      Exec "$9\Instapp.exe $OUTDIR\$4.prc"<br />
      ifErrors InstAppErr0 Done<br />
      <br />
      InstAppErr0:<br />
      Call InstAppFailedMsg<br />
      <br />
      Goto Done<br />
      <br />
      Both:<br />
      <br />
      ClearErrors<br />
      Exec "$9\Instapp.exe $OUTDIR\$4.prc $OUTDIR\$4SpellDB.pdb"<br />
      ifErrors InstAppErr1 Done<br />
      <br />
      InstAppErr1:<br />
      Call InstAppFailedMsg<br />
      <br />
      Done:<br />
      <br />
      SectionEnd ; end of default section<br />
      <br />
      ; begin uninstall settings/section<br />
      UninstallText "This will uninstall WriteHere 1.4.0 from your system"<br />
      UninstallExeName "uninst.exe"<br />
      <br />
      Section Uninstall<br />
      ; add delete commands to delete whatever files/registry keys/etc you installed here.<br />
      <br />
      strcpy $4 "WriteHere"<br />
      <br />
      ReadRegStr $9 HKEY_CURRENT_USER "Software\U.S. Robotics\Pilot Desktop\Core" "Path"<br />
      ReadRegStr $6 HKEY_CURRENT_USER "Software\U.S. Robotics\Pilot Desktop\HotSync Manager" "DontAskExit"<br />
      <br />
      FindWindow goto:UnHotSyncRunning "KittyHawk"<br />
      StrCpy $1 "false"<br />
      Goto UnReg<br />
      <br />
      UnHotSyncRunning:<br />
      StrCpy $1 "true"<br />
      <br />
      strcmp $6 "" UnCloseHotSyncManager UnDontAsk<br />
      <br />
      UnCloseHotSyncManager:<br />
      WriteRegDword HKEY_CURRENT_USER "Software\U.S. Robotics\Pilot Desktop\HotSync Manager" "DontAskExit" 1<br />
      StrCpy $6 "true"<br />
      <br />
      UnDontAsk:<br />
      FindWindow closeinstant "KittyHawk"<br />
      <br />
      UnReg:<br />
      <br />
      ReadRegStr $5 HKEY_LOCAL_MACHINE "SOFTWARE\Hi-CE\$4" "AppNum"<br />
      <br />
      strcmp $5 "" DelNoConduit DelConduit<br />
      <br />
      DelConduit:<br />
      <br />
      DeleteRegKey HKEY_CURRENT_USER "Software\U.S. Robotics\Pilot Desktop\Application$5"<br />
      <br />
      DelNoConduit:<br />
      Delete "$INSTDIR\uninst.exe"<br />
      DeleteRegKey HKEY_LOCAL_MACHINE "SOFTWARE\Hi-CE\$4"<br />
      DeleteRegKey HKEY_LOCAL_MACHINE "SOFTWARE\Microsoft\Windows\CurrentVersion\Uninstall\$4"<br />
      <br />
      strcmp $1 "true" UnRestartHotSync<br />
      Goto UnComplete<br />
      UnRestartHotSync:<br />
      <br />
      strcmp $6 "true" UnResetKey UnJmpEnd<br />
      UnResetKey:<br />
      WriteRegDword HKEY_CURRENT_USER "Software\U.S. Robotics\Pilot Desktop\HotSync Manager" "DontAskExit" 0<br />
      <br />
      UnJmpEnd:<br />
      ClearErrors<br />
      ExecShell "open" "$9\HotSync.exe" SW_SHOWNORMAL<br />
      ifErrors HotSyncErr0 UnComplete<br />
      <br />
      HotSyncErr0:<br />
      MessageBox MB_OK|MB_ICONEXCLAMATION "HotSync Manager failed to reload.$\nPlease restart HotSync Manager before using this program."<br />
      <br />
      UnComplete:<br />
      <br />
      Delete /REBOOTOK "$INSTDIR\$4.prc"<br />
      Delete /REBOOTOK "$INSTDIR\Readme.txt"<br />
      Delete /REBOOTOK "$INSTDIR\Goto_Hi-CE_Handhelds_web_site.url"<br />
      Delete /REBOOTOK "$INSTDIR\$4_Quick_Start.pdf"<br />
      Delete /REBOOTOK "$INSTDIR\Getting_Started.pdf"<br />
      Delete /REBOOTOK "$INSTDIR\$4SpellDB.pdb"<br />
      <br />
      strcmp $5 "" DelData<br />
      <br />
      Delete /REBOOTOK "$9\WriteHere.dll"<br />
      <br />
      DelData:<br />
      <br />
      ClearErrors<br />
      RMDir "$INSTDIR\Data"<br />
      ifErrors Finished<br />
      <br />
      SetFileAttributes "$INSTDIR\Images\" NORMAL<br />
      <br />
      Delete /REBOOTOK "$INSTDIR\Images\Hi-CE_logo.jpeg"<br />
      Delete /REBOOTOK "$INSTDIR\Images\leftArrow.gif"<br />
      Delete /REBOOTOK "$INSTDIR\Images\rightArrow.gif"<br />
      Delete /REBOOTOK "$INSTDIR\Images\upArrow.gif"<br />
      Delete /REBOOTOK "$INSTDIR\Images\$4Logo.gif"<br />
      Delete /REBOOTOK "$INSTDIR\View your WriteHere docs.html"<br />
      <br />
      GetParentDir $4 $INSTDIR<br />
      <br />
      SetOutPath "C:\"<br />
      <br />
      RMDir "$INSTDIR\Images"<br />
      <br />
      RMDir "$INSTDIR"<br />
      RMDir "$4"<br />
      <br />
      Finished:<br />
      <br />
      SetFileAttributes "$INSTDIR\Images\" HIDDEN<br />
      <br />
      SectionEnd ; end of uninstall section<br />
      <br />
      Function .onInit<br />
      <br />
      strcpy $4 "WriteHere"<br />
      <br />
      ReadRegStr $9 HKEY_LOCAL_MACHINE "SOFTWARE\Microsoft\Windows\CurrentVersion\Uninstall\$4" "UninstallString"<br />
      strcmp $9 "" Clean PrevInst<br />
      <br />
      Clean:<br />
      goto InitDone<br />
      <br />
      PrevInst:<br />
      <br />
      ReadRegStr $8 HKEY_LOCAL_MACHINE "SOFTWARE\Microsoft\Windows\CurrentVersion\Uninstall\$4" "DisplayName"<br />
      MessageBox MB_YESNO "$8 found$\nUninstall this version?" IDNO InitDone<br />
      ExecShell "open" "$9" SW_SHOWNORMAL<br />
      ;Abort ; causes installer to quit.<br />
      <br />
      IfErrors InstErr InitDone<br />
      InstErr:<br />
      Call FailedUninst<br />
      <br />
      InitDone:<br />
      FunctionEnd<br />
      <br />
      Function .onInstSuccess<br />
      <br />
      SetFileAttributes "$INSTDIR\Images\" HIDDEN<br />
      <br />
      MessageBox MB_OK "This version of WriteHere has the ability to use the Infrared Port for Printing WriteHere Documents! $\nVisit <a href="http://www.handheld.hice-dev.org/writehereAppPage.htm" target="_blank">http://www.handheld.hice-dev.org/writehereAppPage.htm</a> for a trial version of Bachmann's PrintBoy Software."<br />
      <br />
      FunctionEnd<br />
      <br />
      Function HotSyncFailedMsg<br />
      ReadRegStr $9 HKEY_CURRENT_USER "Software\U.S. Robotics\Pilot Desktop\Core" "Path"<br />
      ClearErrors<br />
      <br />
      Sleep 500<br />
      <br />
      Exec "$9\HotSync.exe"<br />
      IfErrors DisplayMsgBox Fin<br />
      <br />
      DisplayMsgBox:<br />
      MessageBox MB_OK|MB_ICONEXCLAMATION "HotSync Manager failed to reload.$\nPlease restart HotSync Manager before using this program."<br />
      <br />
      Fin:<br />
      FunctionEnd<br />
      <br />
      Function FailedUninst<br />
      ReadRegStr $9 HKEY_LOCAL_MACHINE "SOFTWARE\Microsoft\Windows\CurrentVersion\Uninstall\$4" "UninstallString"<br />
      ClearErrors<br />
      <br />
      Sleep 500<br />
      <br />
      Exec "$9"<br />
      IfErrors DisplayMsgBox Fin<br />
      <br />
      DisplayMsgBox:<br />
      MessageBox MB_YESNO|MB_ICONSTOP "Uninstaller failed to load, please uninstall before continuing$\n$\n Abort installation?" IDNO Fin<br />
      Abort<br />
      Fin:<br />
      FunctionEnd<br />
      <br />
      Function InstAppFailedMsg<br />
      ReadRegStr $9 HKEY_CURRENT_USER "Software\U.S. Robotics\Pilot Desktop\Core" "Path"<br />
      ClearErrors<br />
      <br />
      Sleep 500<br />
      <br />
      StrCpy $4 "WriteHere"<br />
      Exec "$9\Instapp.exe $OUTDIR\$4.prc"<br />
      IfErrors DisplayMsgBox Fin<br />
      <br />
      DisplayMsgBox:<br />
      MessageBox MB_OK|MB_ICONEXCLAMATION "InstApp failed to load.$\nPlease double-click on the .prc and .pdb files in:$\n$\n$INSTDIR."<br />
      <br />
      Fin:<br />
      FunctionEnd<br />
      ; eof<br />
      <br /></p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Koen van de Sande</span><br />
      <span class="post-time small text-muted">24th August 2001 20:08 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">I have this in my installation sometimes on NT4 workstation. Memory could not be read, etc. But I had a WISE installer before, and it had the same.<br />
      I traced it to the registration of an OCX component, which 'fails' somehow. If I use Regsvr32 manually, it works.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Pomflain</span><br />
      <span class="post-time small text-muted">24th August 2001 23:28 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Hmm...cool, thanks, I'll look into that when I have a few minutes next week. Working on my "normal" projects rather than the installers right now, but I'll definitely give that a look when I get a chance. Thanks.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Koen van de Sande</span><br />
      <span class="post-time small text-muted">25th August 2001 21:29 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Did I say that it only worked properly when I did it manually afterwards myself in a Command Prompt with Regsvr32?<br />
      It's really rare, because I never heard anyone about it, I'm only having it myself.<br />
      I never got it really fixed in the installer, but sometimes it doesn't occur for some reason. It's confusing.</p>
    </div>
    <hr />

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]>
  </script>
</body>
</html>
