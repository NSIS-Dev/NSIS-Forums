<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="Why Does RegDLL Uses Short Filenames" />

  <title>Why Does RegDLL Uses Short Filenames - NSIS Forums</title><!-- Bootstrap core CSS -->
  <link rel="stylesheet" type="text/css" href="//netdna.bootstrapcdn.com/bootswatch/3.0.1/readable/bootstrap.min.css" />
  <link rel="stylesheet" href="../css/style.css" type="text/css" /><!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!--[if lt IE 9]>
                <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
                <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->
</head>

<body>
  <div class="container">
    <!-- Put navigation bar here -->

    <ol class="breadcrumb">
      <li><a href="../index.html" class="glyphicon glyphicon-home"></a></li>

      <li><a href="f-65.html">NSIS Discussion</a></li>

      <li class="active">Why Does RegDLL Uses Short Filenames</li>
    </ol>

    <p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=206123">Why Does RegDLL Uses Short Filenames</a></p><br />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">JoeAcunzo</span><br />
      <span class="post-time small text-muted">27th January 2005 19:59 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>Why Does RegDLL Uses Short Filenames</strong><br />
      I've determined that RegDLL translates long filenames into short names before actually registering the DLL. For example, "LongName.ocx" gets registered (in the Registry) as "LongNa~1.ocx".<br />
      <br />
      Can RegDLL be forced to use the long name?<br />
      <br />
      This use of short names is causing a problem when I run my patch installer that patches, for example, LongName.ocx. Using my patch procedure, the short name becomes "LongNa~2.ocx", which of course is not registered ("~1" is registered from the original install, not "~2").<br />
      <br />
      This change in short name happens because I patch into a temporary name of "LongName.ocx~patched", and if all files are patched without error, I then delete the original "LongName.ocx" and rename the patched version "LongName.ocx~patched" to the correct name of "LongName.ocx". My goal is to leave the original in place as long as possible.<br />
      <br />
      Joe A.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
      <span class="post-time small text-muted">27th January 2005 20:08 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">RegDLL itself doesn't use short file names. When using /REBOOTOK on Windows 9x, the file names are translated to short file names if the action is done after reboot because of a limitation of Windows 9x.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">JoeAcunzo</span><br />
      <span class="post-time small text-muted">27th January 2005 20:55 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">This is happening on Windows XP, and in a situation that does not require a reboot to get the file installed. It is on the very first install that the short name is used in the registry (NOT in the directory for the filename as that maintains the long name, it's using the short name just in the registry). What else could impact this? Here's the code I'm using, pretty simple:<br />
      <br />
      [code]<br />
      ; Must set to here to find dependent DLLs for the .ocx.<br />
      SetOutPath "$INSTDIR\${BIN}"<br />
      ClearErrors<br />
      RegDLL "$INSTDIR\${BIN}\BCGTimeIntervals.ocx"<br />
      [code]<br />
      <br />
      Thanks,<br />
      Joe A.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
      <span class="post-time small text-muted">27th January 2005 21:02 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Well, if the RegDLL itself triggers the registry value creation, then it's the the OCX itself that is writing that short file name. Nothing is written to the registry by NSIS when you use the RegDLL command.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">JoeAcunzo</span><br />
      <span class="post-time small text-muted">28th January 2005 00:24 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">kichik, your absolutely right (as usual) about this not being a RegDLL issue. I just unregistered the OCX and used regsvr32 to register it, and I get the same thing -- it gets registered with the short name. I then stepped through the registration code (it's using MFC), and I don't see how that's happening, unless some Windows API is doing it during registration (doubtful), but it is NOT an NSIS issue. Thanks again for your help, it's much appreciated.<br />
      <br />
      Joe A.</p>
    </div>
    <hr />

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]>
  </script>
</body>
</html>
