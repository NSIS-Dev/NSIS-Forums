<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="description" content="InstallLib functionality"><title>InstallLib functionality - NSIS Forums</title><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script><link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css"><link rel="stylesheet" href="../css/style.css" type="text/css"><!--[if lt IE 9]><script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script><script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script><![endif]--></head><body><div class="container"><ol class="breadcrumb"><li><a href="../index.html" class="glyphicon glyphicon-home"></a></li><li><a href="f-65.html">NSIS Discussion</a></li><li class="active">InstallLib functionality</li></ol><p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=245572">InstallLib functionality</a></p><br><div class="post"><p class="post-meta"><span class="post-author text-primary">Ron.Stordahl</span><br><span class="post-time small text-muted">6th May 2006 23:15 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>InstallLib functionality</strong><br>I am using the following to install VB40032.dll in the appropriate system folder (OS dependent):<br><br>!insertmacro InstallLib DLL $Already_Installed REBOOT_PROTECTED "..\BPQ32_StagingArea\VB40032.DLL" $SYSDIR\VB40032.DLL $INSTDIR<br><br>My version of VB40032.dll I wish to install is the last one released by MS dated 1/12/1996 v4.0.29.24 freely available on their website.<br><br>Perhaps I shouldn't be worried about replacing an earlier version that might exist, perhaps installed by another application, after all this version is already over 10 years old. And they are supposed to be forward (or is that backward) compatible.<br><br>However can anyone tell me if the code above would do so, and if it does what changes would be needed so that it would just leave an earlier installed version alone?<br><br>Ron</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">kichik</span><br><span class="post-time small text-muted">7th May 2006 10:14 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">The last parameter should be $SYSDIR, not $INSTDIR. But in both ways, it will always replace older versions. If you don't want to replace, use SetOverwrite off and File instead of the Library macros.</p></div><hr><div class="footer"><p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p></div></div><script src="../js/highlight.pack.js" type="text/javascript"></script><script type="text/javascript">//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]></script></body></html>