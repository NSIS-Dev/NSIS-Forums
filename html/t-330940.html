<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="description" content="Adding Button on Cutom Page"><title>Adding Button on Cutom Page - NSIS Forums</title><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script><link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css"><link rel="stylesheet" href="../css/style.css" type="text/css"></head><body><div class="container"><ol class="breadcrumb"><li><a href="../index.html" class="glyphicon glyphicon-home"></a></li><li><a href="f-65.html">NSIS Discussion</a></li><li class="active">Adding Button on Cutom Page</li></ol><p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=330940">Adding Button on Cutom Page</a></p><br><div class="post"><p class="post-meta"><span class="post-author text-primary">atliano</span><br><span class="post-time small text-muted">26th May 2011 06:12 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>Adding Button on Cutom Page</strong><br>&nbsp; Hello All,<br><br>I have created a custom page in which we can entered input required for database connection like username,password,url ... I want to add a button "test" that immediate test whether connection can be established ..<br><br>Can anyone suggest me how can i add a button on custom page and how can i check databse connection on button click event..<br><br><br>Thanks...</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">MSG</span><br><span class="post-time small text-muted">26th May 2011 06:17 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">The nsDialogs readme has an excellent tutorial:<br><a href="http://nsis.sourceforge.net/Docs/nsDialogs/Readme.html" target="_blank">http://nsis.sourceforge.net/Docs/nsDialogs/Readme.html</a><br><br>As for database connection, you can try searching the forums, but NSIS is not database software so we can't help you unless you give more information.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">atliano</span><br><span class="post-time small text-muted">26th May 2011 07:10 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"></p><blockquote><small>Originally posted by MSG</small><br>The nsDialogs readme has an excellent tutorial:<br><a href="http://nsis.sourceforge.net/Docs/nsDialogs/Readme.html" target="_blank">http://nsis.sourceforge.net/Docs/nsDialogs/Readme.html</a><br><br>As for database connection, you can try searching the forums, but NSIS is not database software so we can't help you unless you give more information.</blockquote>Thanks for your reply..<br><br>Could you please let me know how can i perform operation on clicking button..<br>for databse connection i have wriiten batch file which takes database information from custom pages and i have add a button test on that page olso..now i want to run that batch file which checks whether the information provided by user makes the connection or not...<br><br><br>Thanks</div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">T.Slappy</span><br><span class="post-time small text-muted">26th May 2011 08:23 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Use<br></p><blockquote>nsDialogs::OnClick control_HWND function_address</blockquote>Example:<br><pre>
<code>
12u Test
<br>&gt;Var /Global BUTTON
<br>Pop $BUTTON
<br>GetFunctionAddress$0 OnClick
<br>nsDialogs</code>::OnClick $BUTTON $0
<br><br>&gt;Function OnClick
<br>    Pop$0 # HWND
<br>        # Do your stuff here...
<br>    # MessageBox MB_OK clicky
<br>&gt;FunctionEnd 
<br>&gt;

</pre>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">atliano</span><br>
      <span class="post-time small text-muted">26th May 2011 10:06 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Thanks for your reply...<br>
      This is not what i required..<br>
      I have posted my page ..as you can see i have add a button "Test" now i want that on clicking this test button my batch file starts running and from that batch file i need to redirect my db connectivity output to my installer page..<br>
      can anyone help me in doin this..?<br>
      <br>
      <br>
      Thanks..</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">atliano</span><br>
      <span class="post-time small text-muted">26th May 2011 12:19 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Hi All.</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">MSG</span><br>
      <span class="post-time small text-muted">26th May 2011 14:35 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">We are not going to write your installer for you. You have already been given all the information you need to make your custom page work. Slappy's post describes exactly what you need (and you could also have found that information yourself if you had looked at the nsDialogs readme).<br>
      <br>
      As for your question about how to capture the output of a batch file, I think the ExecDos plugin can do that (to some extent). But it's better to write to a .txt file for example (use something like "command.exe param1 param2 &gt; yourfile.txt" in the batch file), and read that using the FileRead command.</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">atliano</span><br>
      <span class="post-time small text-muted">31st May 2011 07:56 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Hi All,<br>
      <br>
      Thanks MSG for ur reply ..even i am not saying to write an installer for me..Watever Solution Slappy had wriiten is not working for me..its because i have mase my custom page usinh ini file...<br>
      and i want to perform some task on clicking my button that is defined in ini file...<br>
      Above wriiten code bascically adds a new dialog that i dont required...<br>
      Can any one knw how to get address of button defined in '.ini' file at run time and do some operations on clicking that button..<br>
      <br>
      Thanks</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">MSG</span><br>
      <span class="post-time small text-muted">31st May 2011 08:24 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">I haven't used InstallOptions in ages, so I really can't remember if it even supports onClick events in the first place... But either way, please switch to nsDialogs. InstallOptions is only supplied with NSIS for backwards compatibility. It should not be used for new installers.</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">pengyou</span><br>
      <span class="post-time small text-muted">31st May 2011 11:54 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"></p>

      <blockquote>
        Can any one knw how to get address of button defined in '.ini' file at run time and do some operations on clicking that button..
      </blockquote>This is explained in the InstallOptions Readme documentation. You should also look at the InstallOptions example scripts that come with NSIS.
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">atliano</span><br>
      <span class="post-time small text-muted">31st May 2011 13:46 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Hi All,<br>
      <br>
      Thanks a ton Peng You..yeah i Read it from manual and i got the Solution of my problem...<br>
      I need to know one more thing, I want that on clicking button (defined in my ini file), dynamically it generates a label on same page and display text whatever we want...<br>
      Can anyone have idea about it??<br>
      <br>
      Thanks...</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">pengyou</span><br>
      <span class="post-time small text-muted">31st May 2011 14:59 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Define the label in your .ini file but use the ShowWindow command to hide the label before the custom page is shown. When the button is clicked use SendMessage to set the label text and use ShowWindow to show the label. (The testnotify.nsi example script uses SendMessage to change the text on some controls.)</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">atliano</span><br>
      <span class="post-time small text-muted">2nd June 2011 08:47 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Hi All,<br>
      <br>
      Hey Pengyou Thanks for ur Wonderful Help...I really got good suggestion on my post..<br>
      Thanx to all..<br>
      I just left with one thing ...i need to know how can i change text color of label...Please if anyone know the color values...post here..Basically i need color value (Red and Green) for my text of label...<br>
      <br>
      Thanks</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">pengyou</span><br>
      <span class="post-time small text-muted">2nd June 2011 10:45 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">The answer is in the manual (SetCtlColors):<br>
      <a href="http://nsis.sourceforge.net/Docs/Chapter4.html#4.9.14.15" target="_blank">http://nsis.sourceforge.net/Docs/Cha...html#4.9.14.15</a><br>
      <br>
      There are some color definitions in Colors.nsh<br>
      <br>
      Here is one way to use red text for a label:<br>
      <br>
      ReadINIStr $1 "$PLUGINSDIR\test.ini" "Field 7" "HWND"<br>
      SetCtlColors $1 0xFF0000 transparent</p>
    </div>
    <hr>

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]></script></body></html>