<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="Windows 64 bit issues" />

  <title>Windows 64 bit issues - NSIS Forums</title><!-- Bootstrap core CSS -->
  <link rel="stylesheet" type="text/css" href="//netdna.bootstrapcdn.com/bootswatch/3.0.1/readable/bootstrap.min.css" />
  <link rel="stylesheet" href="../css/style.css" type="text/css" /><!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!--[if lt IE 9]>
                <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
                <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->
</head>

<body>
  <div class="container">
    <!-- Put navigation bar here -->

    <ol class="breadcrumb">
      <li><a href="../index.html" class="glyphicon glyphicon-home"></a></li>

      <li><a href="f-65.html">NSIS Discussion</a></li>

      <li class="active">Windows 64 bit issues</li>
    </ol>

    <p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=306069">Windows 64 bit issues</a></p><br />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">xsinx</span><br />
      <span class="post-time small text-muted">5th May 2009 18:23 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>Windows 64 bit issues</strong><br />
      Hello everyone!<br />
      <br />
      I'm having an issue getting my app to run on Windows 64 platforms. Until recently we were using WISE to install our software and since they lack Unicode support, we decided to move over to NSIS. We are using the Unicode version, but I'm going by the assumption that is irrelevant to the issue at hand.<br />
      <br />
      Lets jump right to the juice. The problem I'm having is that my app is not able to use COM classes defined in some of the DLL's I'm installing. The error code I'm getting is 80040154. At first I was registering the DLL using RegDLL in NSIS, nothing fancy. Then I found out about the SysWoW64 version of regsvr32 so I figured maybe, just maybe, NSIS wasn't using the right version so I modified my installer to use the regsvr32 manually, using the right one depending on 32 vs 64 bit OS. Still the same error.<br />
      <br />
      So I went to the command prompt (in admin-mode) and registered all my DLL's using one version of regsvr32, tried the app, then the other version, tried the app again. Always the same message no matter what.<br />
      <br />
      I have then used regedit to look up the registry. The classes seem to be registered properly, I can't see anything wrong with it. Also, the user I'm using to run these test is a local admin. I have made sure he has access to all the keys relating to the DLL in question and he has "Full Control" over everything, from registry entries to the app folder, files, etc.<br />
      <br />
      I have tried running the installer, as well as the application w/ admin override (Run As administrator) and still the same thing.<br />
      <br />
      Does anyone have any idea of what might be wrong? I can't tell if it's the installation process or something else that's the problem. I'm running out of options fast.<br />
      <br />
      Any help would be appreciated.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">xsinx</span><br />
      <span class="post-time small text-muted">5th May 2009 21:07 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Ah! Found the problem but not sure I'm understanding it fully. It's not NSIS related. My app is composed of a mix of VB.NET and C++ (COM and plain, no DOTNET) and my VB apps/DLL's were configured to compile for "AnyCPU". Apparently, this was causing the app to not be able to load the 32 bit COM objects. I'm guessing all my VB layer was defaulting to 64 bits and trying to load 64 bit versions of my COM objects (which do not exist).</p>
    </div>
    <hr />

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]>
  </script>
</body>
</html>
