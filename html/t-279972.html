<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="description" content="Help with classpath and jars - JAVA"><title>Help with classpath and jars - JAVA - NSIS Forums</title><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script><link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css"><link rel="stylesheet" href="../css/style.css" type="text/css"></head><body><div class="container"><ol class="breadcrumb"><li><a href="../index.html" class="glyphicon glyphicon-home"></a></li><li><a href="f-65.html">NSIS Discussion</a></li><li class="active">Help with classpath and jars - JAVA</li></ol><p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=279972">Help with classpath and jars - JAVA</a></p><br><div class="post"><p class="post-meta"><span class="post-author text-primary">pgg1</span><br><span class="post-time small text-muted">25th October 2007 17:49 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>Help with classpath and jars - JAVA</strong><br>Hi Guys<br><br>look at the following line:<br><br></p><pre>
<code><br>CreateShortCut  "$SMPROGRAMS\${ZANG}\${ZANG}.lnk" "${JAVA_EXE}" "-cp ./Client/a.jar;./Client/b.jar;./Client/c.jar;./Client/d.jar;./Client/e.jar com.kc.pm.Main" "${SOME_ICON}" ""<br></code>
</pre><br>
      <br>
      This works fine. However if I add another 7 jars to the classpath:<br>
      <br>
      <pre>
<code><br>CreateShortCut  "$SMPROGRAMS\${ZANG}\${ZANG}.lnk" "${JAVA_EXE}" "-cp ./Client/a.jar;./Client/b.jar;./Client/c.jar;./Client/d.jar;./Client/e.jar;./Client/f.jar;./Client/g.jar;./Client/h.jar;./Client/i.jar;./Client/j.jar;./Client/k.jar;./Client/l.jar com.kc.pm.Main" "${SOME_ICON}" ""<br></code>
</pre><br>
      <br>
      <br>
      <br>
      This doesn't work. I've noticed that It breaks after adding the 10th jar. When I add the 10th jar it effects the desktop and quick launch icons as well.<br>
      <br>
      Is the string above too long for NSIS? I have no idea. If i run all the jars using a batch file the program runs correctly.<br>
      <br>
      ps. I've renamed the jars above for simplicity.
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br>
      <span class="post-time small text-muted">25th October 2007 19:25 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">The string isn't too long. The limit is 1024 characters. How exactly does it "break"? Does it not create the shortcut at all?</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">pgg1</span><br>
      <span class="post-time small text-muted">25th October 2007 20:30 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Thanks for the reply<br>
      <br>
      If we can forget the desktop and quick launch icons and concentrate the start menu it makes its easier.<br>
      <br>
      I have the following jars to put on the classpath.<br>
      <br>
      (1) ./Client/a.jar<br>
      (2) ./Client/bjar<br>
      (3) ./Client/c.jar<br>
      (4) ./Client/d.ar<br>
      (5) ./Client/e.ar<br>
      <br>
      (6) ./Client/f.jar<br>
      (7) ./Client/g.jar<br>
      (8) ./Client/h.jar<br>
      (9) ./Client/i.jar<br>
      (10) ./Client/j.jar<br>
      (11) ./Client/k.ar;<br>
      (12) ./Client/l.jar<br>
      <br>
      The first five work as expected and the application runs. However, we are now adding new functionality and are using some API's which are the jars (6 -&gt; 12)<br>
      The problem is I can add an ANY additional 4 jars (from 6 -&gt; 12) making a total of 9 jars and the login screen of the app loads. The moment I add the tenth jar<br>
      which can be ANY jar from the remaining 3 jars the icon on the start menu is lost and the app cannot start.<br>
      <br>
      The message I get back is from the Java Virtual Machine saying "Could not find the main class. Program will exit."<br>
      If I add any more jars and try to run the app nothing happens at all.<br>
      <br>
      <br>
      With 9 it looks like this:<br></p>
      <pre>
<code><br>CreateShortCut  "$SMPROGRAMS\${ZANG}\${ZANG}.lnk" "${JAVA_EXE}" "-cp ./Client/a.jar;./Client/b.jar;./Client/c.jar;./Client/d.jar;./Client/e.jar;./Client/f.jar;./Client/g.jar;./Client/h.jar;./Client/i.jar com.kc.pm.MyApp" "${ZANG_ICON}" ""<br></code>
</pre><br>
      And 10 I add one more<br>
      <br>
      If I run a batch file from the Client directory of the installation (where all the jars have been copied to):<br>
      <pre>
<code><br>java -cp ./a.jar;./b.jar;./c.jar;./d.jar;./e.jar;./f.jar;./g.jar;./h.jar;./i.jar;./j.jar;./k.jar;./l.jar com.kc.pm.MyApp<br></code>
</pre><br>
      It works as expected.
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">pgg1</span><br>
      <span class="post-time small text-muted">25th October 2007 20:33 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Sorry I forgot to mention that when I say the "icon on the start menu is lost" I mean it's there but it's not my icon, It's an icon that Windows gives it when it can't find a suitable file type. I can still select the menu item.<br>
      <br>
      Cheers.</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">pgg1</span><br>
      <span class="post-time small text-muted">26th October 2007 10:23 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>BUG - NSIS CAN ONLY TAKE 9 JARS</strong><br>
      Hi<br>
      <br>
      I have solved my problem. NSIS can only take 9 jars after that something breaks. Initially I had 12 jars and was having problems. I then put 4 of the jars into one of the existing jars reducing the overall jar count to 8. This solved my problem.<br>
      <br>
      Cheers.</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">mannaking</span><br>
      <span class="post-time small text-muted">26th October 2007 10:59 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">You can use a batch file (.bat) to resolve this problem.</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br>
      <span class="post-time small text-muted">26th October 2007 11:22 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">NSIS doesn't know what a Jar is, so the problem can't be the number of Jars, but something deeper. What does the properties of the shortcut show when you create a non-functional shortcut? Would it possible to show the real CreateShortcut line?</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">pgg1</span><br>
      <span class="post-time small text-muted">26th October 2007 14:02 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">My Create Shortcuts looks like:<br>
      <br></p>
      <pre>
<code><br>Section "Create Shortcuts"<br>  CreateDirectory "$SMPROGRAMS\${ZANG}"<br>  CreateShortCut  "$SMPROGRAMS\${ZANG}\${ZANG}.lnk" "${JAVA_EXE}" "${PARAMETERS}"  "${ZANG_ICON}" ""<br>  WriteINIStr     "$SMPROGRAMS\${ZANG}\ZangBeZang.url" "InternetShortcut" "URL" "http://www.someAddress.com/"<br>  CreateShortCut  "$SMPROGRAMS\${ZANG}\Uninstall ${ZANG}.lnk" "${UNINSTALLER}"<br>SectionEnd<br></code>
</pre><br>
      <br>
      PARAMETERS is defined as:<br>
      <br>
      <pre>
<code><br>"-cp ./Client/BrowserLauncher2-10rc4.jar;./Client/Connected.jar;./Client/flickrapi-1.0b4.jar;./Client/jdic.jar;./Client/jh.jar;./Client/jregex1.2_01.jar;./Client/JSON.jar;./Client/mail.jar;./gdata-client-1.0.jar;./gdata-core-1.0.jar;./gdata-media-1.0.jar;./gdata-youtube-1.0.jar com.kc.pm.MyAPP"<br></code>
</pre><br>
      <br>
      The last four jars had to be removed and placed into Connected.jar<br>
      <br>
      Cheers,<br>
      <br>
      Paul
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">pgg1</span><br>
      <span class="post-time small text-muted">26th October 2007 14:04 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Sorry I've pasted the last four jars in and forget the client directory. The problem still occurs though.</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br>
      <span class="post-time small text-muted">26th October 2007 19:20 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Could you attach a complete piece of code that'd reproduce this. I can't reproduce this with the code you've posted.</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">pgg1</span><br>
      <span class="post-time small text-muted">29th October 2007 13:38 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">In order for your to reproduce the problem I would have to give you our proprietary jars, which of course I can't. Once we have an obfuscater in place I will send everything over to you.<br>
      <br>
      Cheers</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br>
      <span class="post-time small text-muted">29th October 2007 19:46 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Why would I need the JAR files if the problem is in the shortcut itself?</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">pgg1</span><br>
      <span class="post-time small text-muted">29th October 2007 23:08 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">So you can reproduce it.<br>
      <br>
      I've already posted the shortcut code as requested. That's it, there's nothing more to add regarding shortcuts apart from the quick launch and desktop icons but I've temporarily commented them out. I don't believe posting any more of my script will be helpful.<br>
      <br>
      All the jars are in the same directory before I build my installer and they are in the same directory after the installer has done it's stuff.<br>
      <br>
      I don't think there is anything wrong with the shortcut and nobody has told me otherwise. How can the shortcut work up to and including the 9th jar but when I add the 10th jar it falls apart. However, the jars works perfectly when running from a batch file (from the install directory), or the jars work perfectly when I add 4 jars into one of the other jars, therefore reducing the overall jar count to 8 and below the 9 jar threshold.<br>
      <br>
      I take on board that NSIS has no concept of a jar but I don't know what to think at the moment. It's just strange behaviour.<br>
      <br>
      Cheers.</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br>
      <span class="post-time small text-muted">3rd November 2007 10:52 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Well, not exactly. I don't have the exact code to create the shortcut as I don't have the definition of all those constants you've used there. PARAMETERS might also be defined differently than I assume.<br>
      <br>
      But the longer this thread goes, it seems more and more like a problem with the something else than the shortcut. I'd start by debugging the executed program if I were you. You can start with a simple Process Explorer examination to make sure it got the command line right and go as far as debugging your main function in your JAR. As long as the icon is created and its properties are fine, I can't say much.</p>
    </div>
    <hr>

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]></script></body></html>