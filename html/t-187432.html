<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="description" content="UpgradeDLL could not load ?!?"><title>UpgradeDLL could not load ?!? - NSIS Forums</title><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script><link rel="preload" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css" as="style" onload="this.rel='stylesheet'"><link rel="preload" href="../css/style.css" as="style" onload="this.rel='stylesheet'"><noscript><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css"><link rel="stylesheet" href="../css/style.css"></noscript><script>!function(a){"use strict";var b=function(b,c,d){function e(a){return h.body?a():void setTimeout(function(){e(a)})}function f(){i.addEventListener&&i.removeEventListener("load",f),i.media=d||"all"}var g,h=a.document,i=h.createElement("link");if(c)g=c;else{var j=(h.body||h.getElementsByTagName("head")[0]).childNodes;g=j[j.length-1]}var k=h.styleSheets;i.rel="stylesheet",i.href=b,i.media="only x",e(function(){g.parentNode.insertBefore(i,c?g:g.nextSibling)});var l=function(a){for(var b=i.href,c=k.length;c--;)if(k[c].href===b)return a();setTimeout(function(){l(a)})};return i.addEventListener&&i.addEventListener("load",f),i.onloadcssdefined=l,l(f),i};"undefined"!=typeof exports?exports.loadCSS=b:a.loadCSS=b}("undefined"!=typeof global?global:this);!function(a){if(a.loadCSS){var b=loadCSS.relpreload={};if(b.support=function(){try{return a.document.createElement("link").relList.supports("preload")}catch(b){return!1}},b.poly=function(){for(var b=a.document.getElementsByTagName("link"),c=0;c<b.length;c++){var d=b[c];"preload"===d.rel&&"style"===d.getAttribute("as")&&(a.loadCSS(d.href,d,d.getAttribute("media")),d.rel=null)}},!b.support()){b.poly();var c=a.setInterval(b.poly,300);a.addEventListener&&a.addEventListener("load",function(){b.poly(),a.clearInterval(c)}),a.attachEvent&&a.attachEvent("onload",function(){a.clearInterval(c)})}}}(this);</script></head><body><div class="container"><ol class="breadcrumb"><li><a href="../index.html" class="glyphicon glyphicon-home"></a></li><li><a href="f-65.html">NSIS Discussion</a></li><li class="active">UpgradeDLL could not load ?!?</li></ol><p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=187432">UpgradeDLL could not load ?!?</a></p><br><div class="post"><p class="post-meta"><span class="post-author text-primary">Greybird</span><br><span class="post-time small text-muted">22nd July 2004 14:29 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>UpgradeDLL could not load ?!?</strong><br>I try to use the UpgradeDll macro to install a DLL.<br><br>I use the following syntax :<br></p><blockquote>!insertmacro UpgradeDLL "OUTLOOK2000\outlookclientaddin.dll" "$INSTDIR\outlookclientaddin.dll" "$INSTDIR"</blockquote>But the registration is not done. The log tells me : "Could not load C:\Program Files\Outlook Synchronization Addin\outlookclientaddin.dll"<br><br>I checked that the DLL was at its place when the call to RegDll occurs, and it is.<br><br>The same problem occurs with short file names too.<br><br>Has someone had the same problem ?<br><br>Arnaud</div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Greybird</span><br><span class="post-time small text-muted">22nd July 2004 15:31 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Here is the script I use.<br><br>outlookclientaddin.dll is dependant of dll2000.dll.<br><br></p><blockquote>SetOutPath "$INSTDIR"<br>SectionIn 1 RO<br><br>File /oname="AddinToolbarRemover.exe" "OUTLOOK2000\addintoolbarremover.exe"<br>File /oname="README.TXT" "Common\README.TXT"<br>File /oname="COPYING" "Common\COPYING"<br><br>!define UPGRADEDLL_NOREGISTER<br>!insertmacro UpgradeDLL "OUTLOOK2000\dll2000.dll" "$INSTDIR\dll2000.dll" "$INSTDIR"<br>!undef UPGRADEDLL_NOREGISTER<br>!insertmacro UpgradeDLL "OUTLOOK2000\outlookclientaddin.dll" "$INSTDIR\outlookclientaddin.dll" "$INSTDIR"</blockquote>Hope this helps...</div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">scully13</span><br><span class="post-time small text-muted">22nd July 2004 16:06 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">I had that problem once because the DLL I was trying to load was dependent on another DLL. I ended up having to include both DLLs in the folder I was calling the first one from and then SetOutPath to that folder. I've never used the upgrade DLL but maybe it calls the DLL to determine it's version and that causes it's dependency to be needed. You could also use Dependency Walker to determine if that DLL has other dependencies. I made a post several weeks ago with the problem I discussed above if you think the problems are related and want more info.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Greybird</span><br><span class="post-time small text-muted">23rd July 2004 10:45 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Thanks for your response.<br><br>The Dll on which the Dll I try to register is dependant is in the same directory, INSTDIR, and SetOutPath is set to this directory.<br><br>Some tests I've done :<br>UnRegDll works on the same dll.<br>regserv32 works after the installer is closed, but not if I call it with ExecWait.<br><br>Any ideas ?</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">scully13</span><br><span class="post-time small text-muted">23rd July 2004 19:46 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Sorry, I have no more ideas. I used your code with 2 DLLs I have here and it worked fine. Both files were copied in and it registered the second one. However, neither of my files were dependent on one another.</p></div><hr><div class="footer"><p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p></div></div><script src="../js/highlight.pack.js" type="text/javascript"></script><script type="text/javascript">//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]></script></body></html>