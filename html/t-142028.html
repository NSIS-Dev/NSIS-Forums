<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="description" content="nsExec problem"><title>nsExec problem - NSIS Forums</title><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script><link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css"><link rel="stylesheet" href="../css/style.css" type="text/css"></head><body><div class="container"><ol class="breadcrumb"><li><a href="../index.html" class="glyphicon glyphicon-home"></a></li><li><a href="f-65.html">NSIS Discussion</a></li><li class="active">nsExec problem</li></ol><p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=142028">nsExec problem</a></p><br><div class="post"><p class="post-meta"><span class="post-author text-primary">n0On3</span><br><span class="post-time small text-muted">13th July 2003 06:10 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>nsExec problem</strong><br>I am trying to use nsExec but It doesn't work.</p><pre>
<code>nsExec</code><span style="color: #007700">::</span><span style="color: #0000BB">ExecToLog</span><span style="color: #007700">/</span><span style="color: #0000BB">TIMEOUT</span><span style="color: #007700">=</span><span style="color: #0000BB">9999</span><span style="color: #DD0000">"$INSTDIR\grep.exe"
</span>
</pre>I tried with an without the timeout.<br><br>I think that the problem is with <a href="http://www.delorie.com/djgpp/dl/ofc/simtel/v2gnu/grep24b.zip/bin/grep.exe" target="_blank">grep.exe</a> because when I run it from a batch it doesn't close the window and remains open (usually a batch closes the window).<br><br>The log should reflect this:<br><i>Usage: grep [OPTION]... PATTERN [FILE]...<br>Try `grep --help' for more information.<br></i>but it doesn't<br><br>I found <a href="http://forums.winamp.com/showthread.php?threadid=126972&amp;highlight=nsexec" target="_blank">this</a> thread with similar problems. I don't know if it's the same, since this grep.exe just makes a list, and they talk about getting live output or nsExec not getting the output until the program has finished. In my case, nsExec never grabs the output.<br><br>I forgot to say that the return value is 1 (no errors, timeout, or whatever).<br><br>note: why can't I write backslashes?</div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">DOCa Cola</span><br><span class="post-time small text-muted">13th July 2003 07:27 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">First of all the link says that the server is too busy, here is an alternate link. i will test grep.exe now...<br><a href="http://sunsite.utk.edu/ftp/usr-218-2/djgpp/v2gnu/grep24b.zip" target="_blank">http://sunsite.utk.edu/ftp/usr-218-2...nu/grep24b.zip</a></p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">DOCa Cola</span><br><span class="post-time small text-muted">13th July 2003 07:35 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">hm, right, isn't working for me either, thats strange....i don't think it has something to do with live output...</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">kichik</span><br><span class="post-time small text-muted">13th July 2003 15:41 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Will check out.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">n0On3</span><br><span class="post-time small text-muted">13th July 2003 20:57 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">thanks kichik :)</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">DOCa Cola</span><br><span class="post-time small text-muted">13th July 2003 21:08 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">At this point, here another thing i noticed is that nsexec makes these boxes in front of the output of lame (mp3 encoder). in the dos box they aren't there...<br><a href="http://www.borgcore.de/outerspace/NSIS/lame.png" target="_blank">http://www.borgcore.de/outerspace/NSIS/lame.png</a></p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">kichik</span><br><span class="post-time small text-muted">14th July 2003 14:54 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Those are tabs DOCa Cola. I'll see what I can do about it too.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">DOCa Cola</span><br><span class="post-time small text-muted">14th July 2003 14:57 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">ah i see, thx</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">n0On3</span><br><span class="post-time small text-muted">16th July 2003 20:32 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">I found another grep.exe that works with NSIS. But now I have another problem :( As kichik said in another thread, stack items are only 1024Bytes, so when the program lauched through nsExec ExecToStack prints more than 1024 it gets lost :(<br><br>I tried my best to redirect with "&gt; t.txt" but I am quite unlucky in this thread and couldn't make it work, either.<br><br>I tried many variations of this:<br>ExecWait `"$INSTDIR\grep.exe" -h -i "$4" "$INSTDIR\$1" &gt; "$INSTDIR\t.txt"`<br>and none works :(</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">kichik</span><br><span class="post-time small text-muted">16th July 2003 20:51 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">To use redirection you have to use command.com/cmd.exe. Search the forum using the term "COMSPEC" for usage examples.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br><span class="post-time small text-muted">16th July 2003 20:55 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">You can't log output using ExecWait let alone without using MS-DOS.<br><br>Use the WriteToFile function and create a batch file with the above (you're) command-line.<br>Then execute the batch using nsExec::Exec<br><br>The logging feature is an MS-DOS feature.<br><br>-Stu</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br><span class="post-time small text-muted">16th July 2003 21:02 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Or do this (like Kichik said)<br></p><pre>
<code><br>ReadEnvStr $0 COMSPEC<br>nsExec::Exec '$0 /c "$INSTDIR\grep.exe" -h -i "$4" "$INSTDIR\$1" &gt; "$INSTDIR\t.txt"'<br></code>
</pre><br>
      <br>
      -Stu
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">n0On3</span><br>
      <span class="post-time small text-muted">17th July 2003 08:28 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Great! many ideas to try now.<br>
      Thanks :)</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">DOCa Cola</span><br>
      <span class="post-time small text-muted">18th July 2003 06:39 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"></p>

      <blockquote>
        <i>Originally posted by kichik</i><br>
        <b>Those are tabs DOCa Cola. I'll see what I can do about it too.</b>
      </blockquote>Hm, is there a way to replace the tab boxes with nothing or 'real' tabs with exectostring or something. i need this fix soon cause i am going to release an installer with that.<br>
      <br>
      DOCa Cola
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">n0On3</span><br>
      <span class="post-time small text-muted">19th July 2003 14:09 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">You can always find out what character is and use strcpy to strip it. It's bit of work, but works ;)</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br>
      <span class="post-time small text-muted">19th July 2003 14:11 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Sorry, missed your message the first time. If it's really urgent drop by the IRC channel and I'll compile a version of nsExec for you that will temporarily solve this.</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">DOCa Cola</span><br>
      <span class="post-time small text-muted">22nd July 2003 06:40 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Thx for taking on the Tab issue, but there is a small bug remaining<br>
      <a href="http://www.borgcore.de/outerspace/NSIS/mmpack.png" target="_blank">http://www.borgcore.de/outerspace/NSIS/mmpack.png</a><br>
      The first character of the executed program seems to be untouched by that (after "decoding shellstr.mp3..." the nsexec command with lame starts)<br>
      <br>
      DOCa Cola</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">ramon18</span><br>
      <span class="post-time small text-muted">22nd July 2003 09:45 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">DOCa Cola, I will check this, but can you examine what char is it? TAB char left or another one? Can you please post the link to the tool you are using and an example of the parameters used so I can check it more quickly? thanks<br>
      <br>
      cya later,<br>
      Ramon</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">DOCa Cola</span><br>
      <span class="post-time small text-muted">22nd July 2003 09:52 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">hm, when i tried to paste this here it was translated as a new line<br>
      ---<br>
      Decoding shellstr.mp3...<br>
      <br>
      input:<br>
      ---<br>
      parameters in the previous screen<br>
      <a href="http://www.borgcore.de/outerspace/NSIS/lame.png" target="_blank">http://www.borgcore.de/outerspace/NSIS/lame.png</a><br>
      Note: as you can see, all boxes have been fixed but not the one at the beginning<br>
      <br>
      <a href="http://lame.sourceforge.net" target="_blank">http://lame.sourceforge.net</a><br>
      Download: <a href="http://mitiok.cjb.net/" target="_blank">http://mitiok.cjb.net/</a></p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Sunjammer</span><br>
      <span class="post-time small text-muted">22nd July 2003 10:19 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">It's probably a carriage return to move the cursor to the start of the line, \r.</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">DOCa Cola</span><br>
      <span class="post-time small text-muted">8th August 2003 13:28 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">so..and how can i get rid of this?<br>
      <br>
      DOCa Cola</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">DOCa Cola</span><br>
      <span class="post-time small text-muted">8th August 2003 13:38 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Ok, here a ready to test simple installer using lame (all required files included)<br>
      <a href="http://www.borgcore.de/outerspace/nsis/lameinst.zip" target="_blank">http://www.borgcore.de/outerspace/nsis/lameinst.zip</a><br>
      hope it is easier now to determine the bug<br>
      <br>
      DOCa Cola</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br>
      <span class="post-time small text-muted">8th August 2003 14:52 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">In latest CVS version I have fixed:<br>
      <br>
      - Empty lines were not printed<br>
      <b>- CR or LF alone were not handled</b><br>
      - Tab conversion removed the next char<br>
      <br>
      Thanks for the example, it was handy.<br>
      <br>
      nsExec.dll from latest CVS attached so you won't have to wait for the CVS delays.</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">DOCa Cola</span><br>
      <span class="post-time small text-muted">8th August 2003 14:54 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">thx!</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">DOCa Cola</span><br>
      <span class="post-time small text-muted">11th August 2003 11:44 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">- Empty lines were not printed<br>
      <br>
      oh, is there a way to surpress this feature optionally? i have another program i execute with nsexec::exectolog now just prints out to many empty lines into my log<br>
      <br>
      DOCa Cola</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br>
      <span class="post-time small text-muted">11th August 2003 16:08 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">There is no option to turn it off. Why would you want to do it? Does it print more empty lines than seen when executing the program without nsExec?</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">DOCa Cola</span><br>
      <span class="post-time small text-muted">11th August 2003 16:13 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">no the line size is correct in nsis, but the lines just exist to fill out the standard dos screen size, so there are a few empty lines not needed in nsis, it worked well without the printed empty lines. is it to complicated to make that optional? than i maybe could find another solution for that, but i thought such a feature might be helpful not to overload the nsis log with unnecessary empty lines.<br>
      <br>
      DOCa Cola</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br>
      <span class="post-time small text-muted">11th August 2003 16:20 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">It's not that complicated, but I am trying to finish something else right now. You can use Afrow's/Brainsucker's scripts for removing lines in log for now. You can also use some of the methods described here:<br>
      <br>
      <a href="http://www.experts-exchange.com/Programming/Programming_Platforms/Unix_Programming/Q_20640729.html" target="_blank">http://www.experts-exchange.com/Prog..._20640729.html</a><br>
      <br>
      Although mainly for *nix, there are ports of the applications discussed there to Windows.</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">DOCa Cola</span><br>
      <span class="post-time small text-muted">11th August 2003 16:30 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">yea, but i don't want to remove empty lines from a generated log file but from the output with showinstdetails. i can't see a solution how to solve this with such a program...ok, but anyway, i don't want to bother you, i will wait until you have time to add an option for that<br>
      <br>
      DOCa Cola</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br>
      <span class="post-time small text-muted">11th August 2003 16:32 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">The solution is in there. Get grep and use this:<br>
      <br>
      myprog.exe bla bla | grep.exe -v "^$"</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">DOCa Cola</span><br>
      <span class="post-time small text-muted">11th August 2003 16:36 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">owww, i am too blind, sorry, the commands just overtook me and i thought he wants to remove empty lines from a file, thx for the help! great support here! thx! :)<br>
      <br>
      DOCa Cola</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">DOCa Cola</span><br>
      <span class="post-time small text-muted">11th August 2003 17:08 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">ok..i have come to one problem that my program now sees grep as a command parameter and stopped working....</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br>
      <span class="post-time small text-muted">11th August 2003 17:13 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Right, forgot to mention you need the command line processor for this. You must use %COMSPEC% to make this work. Search for COMSPEC in the forum, there are lots of examples.</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">DOCa Cola</span><br>
      <span class="post-time small text-muted">11th August 2003 17:27 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">owww, i see, but this is getting way to complicated, the thing is that i not only have one line of nsexec::exectolog and i don't want to change 20 commands around 2 times, so until then i will use the older nsexec where the bug was existend :D<br>
      thx!<br>
      <br>
      DOCa Cola</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br>
      <span class="post-time small text-muted">11th August 2003 17:32 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">It's just another line, it's not that complicated. You can also make a macro out of it to make it even simpler.</p>
    </div>
    <hr>

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]></script></body></html>