<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="better method of creating the installer EXE ?" />

  <title>better method of creating the installer EXE ? - NSIS Forums</title><!-- Bootstrap core CSS -->
  <link rel="stylesheet" type="text/css" href="//netdna.bootstrapcdn.com/bootswatch/3.0.1/readable/bootstrap.min.css" />
  <link rel="stylesheet" href="../css/style.css" type="text/css" /><!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!--[if lt IE 9]>
                <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
                <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->
</head>

<body>
  <div class="container">
    <!-- Put navigation bar here -->

    <ol class="breadcrumb">
      <li><a href="../index.html" class="glyphicon glyphicon-home"></a></li>

      <li><a href="f-65.html">NSIS Discussion</a></li>

      <li class="active">better method of creating the installer EXE ?</li>
    </ol>

    <p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=110032">better method of creating the installer EXE ?</a></p><br />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">shantanu_gadgil</span><br />
      <span class="post-time small text-muted">16th October 2002 08:48 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>better method of creating the installer EXE ?</strong><br />
      When NSIS is creating the installer EXE, I think it first creates this in the TEMP directory and then moves it to the specified place.<br />
      <br />
      Isn't this a round-about way of doing it ? Why doesn't NSIS start "outputting" the installer EXE in the final place itself.<br />
      <br />
      Wouldn't this be a spacesaver (and hence time saver) ?<br />
      - Shantanu</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
      <span class="post-time small text-muted">16th October 2002 16:58 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">That's not true. There is only one fopen (build.cpp:1361) and it opens the output file directly, it doesn't create it in the temporary directory and then moves to the output directory.<br />
      <br /></p>
      <pre>
<code>FILE *fp = fopen(build_output_filename,"w+b");</code>
</pre>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">shantanu_gadgil</span><br />
      <span class="post-time small text-muted">17th October 2002 14:43 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">You know why I was saying what I was saying...because when I tried to create a huge installer with the following code...<br />
      -----cut------<br />
      Name crap_trial<br />
      OutFile setup.exe<br />
      SetCompress off<br />
      InstallDir "C:\XYZ"<br />
      Section -<br />
      SetOutPath "$INSTDIR"<br />
      File /r "C:\Program Files\*.*"<br />
      SectionEnd<br />
      -----cut--------<br />
      <br />
      ...I got an error message which said...<br />
      <br />
      ------cut----------<br />
      Internal compiler error #12345: error mmapping datablock to 34257021.<br />
      <br />
      Note: you may have one or two (large) stale temporary file(s)<br />
      left in your temporary directory (Generally this only happens on Windows 9x).<br />
      -------- cut ------<br />
      <br />
      BTW, this error was for NSIS version 1.98.<br />
      <br />
      I know the error says that this will happen on Win 9x systems. What is the problem ?</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
      <span class="post-time small text-muted">17th October 2002 16:43 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Well, the data block is saved is a memory mapped file which means it creates a temporary file and maps needed parts to memory. This is done so the data block will be able to grow bigger than your memory. I don't really know what is the problem with Windows 9x, but I guess it has a bug which causes it not to delete those temporary files.<br />
      The data block can't be directly written to the output file because the headers size is not yet known and moving the data block around in the file will take a lot of time.<br />
      <br />
      There is a size limit on the installer which is:<br /></p>

      <blockquote>
        Installers can be as large as 2GB (theoretically -- when building on Win9x the limit seems to be around 500MB, however building on NT then installing on Win9x works with larger sizes)
      </blockquote>You probably got that error because you crossed this limit.
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">shantanu_gadgil</span><br />
      <span class="post-time small text-muted">19th October 2002 13:14 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">I don't know if I crossed the limit...<br />
      <br />
      the installer crashed when it was trying to compress the AVI files(video codec Indeo 5) of Age of Empires. Out of these, the biggest is ~39 MB.<br />
      <br />
      BTW, would the amount of main memory and VM size matter. The machine where the Win9x error was caused has 64MB RAM running Win98 SE. VM is fixed at 128 MB.<br />
      <br />
      - Shantanu</p>
    </div>
    <hr />

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]>
  </script>
</body>
</html>
