<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="How to locate path for drv.sys file in NSIS." />

  <title>How to locate path for drv.sys file in NSIS. - NSIS Forums</title>
  <script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script>
  <!-- Bootstrap core CSS -->

  <link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css" />
  <link rel="stylesheet" href="../css/style.css" type="text/css" /><!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!--[if lt IE 9]>
                <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
                <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->
</head>

<body>
  <div class="container">
    <!-- Put navigation bar here -->

    <ol class="breadcrumb">
      <li><a href="../index.html" class="glyphicon glyphicon-home"></a></li>

      <li><a href="f-65.html">NSIS Discussion</a></li>

      <li class="active">How to locate path for drv.sys file in NSIS.</li>
    </ol>

    <p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=193433">How to locate path for drv.sys file in NSIS.</a></p><br />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">VCR</span><br />
      <span class="post-time small text-muted">13th September 2004 16:38 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>How to locate path for drv.sys file in NSIS.</strong><br />
      Hi all,<br />
      <br />
      I need one urgent help.<br />
      <br />
      I am installing one driver using NSIS installer on the Win-XP system. My whole installer is working fine, but in the process of installation the system device manager (New Hardware found wizard) asks for 'drv.sys' file location to complete the installation. But before this only the required 'drv.sys' file is made available in "$WINDIR\System32\drivers" folder through the NSIS script.<br />
      Can any one suggest me how to set the path in the NSIS script or any alternative solution so that the installer should not ask for the drv.sys file location and pick it automatically from "$WINDIR\System32\drivers" during installation.<br />
      Kindly anyone reply.<br />
      Thanks in advance.<br />
      <br />
      Regards<br />
      VCR</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Joel</span><br />
      <span class="post-time small text-muted">13th September 2004 20:53 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Did you try <b>IfFileExists</b>?<br />
      <br />
      Also for the system path try <b>$SYSDIR</b></p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
      <span class="post-time small text-muted">13th September 2004 21:07 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">You can set the working directory using SetOutPath. The Archive contains some pages about setting the path (use the one with the System.dll call). But I think you somehow need to register your driver, not set the path variable or the working directory.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">VCR</span><br />
      <span class="post-time small text-muted">14th September 2004 05:09 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">I have already done the SetOutPath "$WINDIR\System32\drivers", but its not working.<br />
      <br />
      I am doing the following registry entry:<br />
      <br />
      ............................<br />
      WriteRegStr HKLM SOFTWARE\Driver "Install_Directory" "$INSTDIR"<br />
      <br />
      WriteRegStr HKLM "Software\Microsoft\Windows\CurrentVersion\Uninstall\Driver" "DisplayName" "MyDrv(1)"<br />
      <br />
      WriteRegStr HKLM "Software\Microsoft\Windows\CurrentVersion\Uninstall\Driver" "UninstallString" "$INSTDIR\Driver_Uninst.exe"<br />
      <br />
      WriteUninstaller "Driver_Uninst.exe"<br />
      ............................<br />
      <br />
      Is there any registry entry I am missing... Plz tell if any other entry I have to make, so that the System Device Manager can find the drv.sys file from the "$WINDIR\System32\drivers" directory.<br />
      <br />
      Waiting for reply.<br />
      <br />
      Thanks in advance...<br />
      <br />
      VCR</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Joel</span><br />
      <span class="post-time small text-muted">14th September 2004 15:18 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Did you try:<br /></p>
      <pre>
<code><br />SetOutPath "$SYSDIR\drivers"<br />File "C:\path\of\file\in\your\harddrive\drv.sys"<br /></code>
</pre>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">VCR</span><br />
      <span class="post-time small text-muted">21st September 2004 14:23 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Hi all,<br />
      <br />
      Thanks for your replies.<br />
      I tried the above options, but it does not work for me.<br />
      I did<br />
      SetOutPath "$SYSDIR\drivers"<br />
      File "C:\path\of\file\in\your\harddrive\drv.sys"<br />
      <br />
      But still the windows pops up asking for the file 'drv.sys' under the caption "Files Needed"<br />
      It says "The file 'drv.sys' on [Unknown] is needed.<br />
      Type the pathwhere the file is located, and then click OK"<br />
      Canm anybody tell what the problem is, or is there any NSIS function to solve it or where the problem could be traced.<br />
      As I have told the drv.sys file is already been copied to the "$SYSDIR\drivers".<br />
      Please help me in solving this as I need it badly.<br />
      <br />
      Kind Regards,<br />
      VCR</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Joel</span><br />
      <span class="post-time small text-muted">21st September 2004 14:52 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Can you be sure that the driver is in the "driver" folder after NSIS closes?</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">VCR</span><br />
      <span class="post-time small text-muted">21st September 2004 15:09 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Hi,<br />
      Yes, after the installation also (exit from NSIS)<br />
      the driver file is in the \system32\drivers folder.<br />
      In fact I locate the same file(\system32\drivers\drv.sys) when prompted for loaction and installation suceeds.<br />
      But still NSIS did not pick it automatically.<br />
      <br />
      -VCR</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Joel</span><br />
      <span class="post-time small text-muted">21st September 2004 15:31 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">huh?<br /></p>

      <blockquote>
        Yes, after the installation also (exit from NSIS)<br />
        the driver file is in the \system32\drivers folder.
      </blockquote>

      <blockquote>
        But still NSIS did not pick it automatically.
      </blockquote>mmm...<br />
      Let's try something like this<br />
      <pre>
<code><br />section -InstallDriver<br />SetOutPath "$SYSDIR\drivers"<br />File "$SYSDIR\drivers\drv.sys"<br />;RegDLL "$SYSDIR\drivers\drv.sys"<br />sectionend<br /></code>
</pre>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Venu</span><br />
      <span class="post-time small text-muted">22nd September 2004 14:30 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Hi,<br />
      <br />
      I tried all the above options, but its not working at all... Even then the Found new hardware wizard for location the "drv.sys" file is prompted.<br />
      <br />
      Plz help me out....<br />
      <br />
      Regards<br />
      VCR</p>
    </div>
    <hr />

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]>
  </script>
</body>
</html>
