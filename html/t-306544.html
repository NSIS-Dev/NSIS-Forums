<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="Creating two uninstallers in same installer" />

  <title>Creating two uninstallers in same installer - NSIS Forums</title>
  <script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script>
  <!-- Bootstrap core CSS -->

  <link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css" />
  <link rel="stylesheet" href="../css/style.css" type="text/css" /><!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!--[if lt IE 9]>
                <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
                <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->
</head>

<body>
  <div class="container">
    <!-- Put navigation bar here -->

    <ol class="breadcrumb">
      <li><a href="../index.html" class="glyphicon glyphicon-home"></a></li>

      <li><a href="f-65.html">NSIS Discussion</a></li>

      <li class="active">Creating two uninstallers in same installer</li>
    </ol>

    <p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=306544">Creating two uninstallers in same installer</a></p><br />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">adum</span><br />
      <span class="post-time small text-muted">19th May 2009 17:13 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>Creating two uninstallers in same installer</strong><br />
      Hello everyone, i'm new here and need some help already...<br />
      <br />
      Here is the case:<br />
      I need to crate an installer, witch include toolbar installer..<br />
      My issue is: in both uninstallers, the Welcome title is the same and I wish in each unnistallers show different Titles(main uninstaller show "Program name uninstaller" and toolbar uninstaller show "Toolbar Uninstaller")<br />
      <br />
      What i'm trying to do is create a custom page, and the installer detects if the uninstaller is for program or for toolbar, and show the correct text. But the uninstaller don't show this custom page..<br />
      <br />
      Can someone help me in this case? I'm doing right or exist other way to do this???<br />
      <br />
      Thanks</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">TobbeSweden</span><br />
      <span class="post-time small text-muted">19th May 2009 18:57 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Can't you set the window title with something like this?<br /></p>
      <pre>
<code>System::Call 'user32::SetWindowText(i $hwnd, t "title")'</code>
</pre>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">adum</span><br />
      <span class="post-time small text-muted">20th May 2009 05:59 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">I'm not specific on my question. The title i'm refering is the "Welcome to Program Uninstall Wizard".. In fact i'm need to change every place when "Program" appears and put "Toolbar"..<br />
      <br />
      But thanks for help anyway.. This system call will be useful.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
      <span class="post-time small text-muted">20th May 2009 09:30 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">You can use a variable in Name or Caption and set that variable in .onInit before any page shows up.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">adum</span><br />
      <span class="post-time small text-muted">20th May 2009 14:39 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Thanks kichik! This way works perfectly!</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">adum</span><br />
      <span class="post-time small text-muted">25th June 2009 16:38 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Hello, it's me again.<br />
      <br />
      I have a new issue, someone can help me?<br />
      <br />
      My script have the follow:<br />
      -a function "install_toolbar", where installs the toolbar fileset if the box is checked, and in the end use command writeUninstaller.<br />
      -a section "MainProgram", where call a function install_toolbar, install the fileset of software, and use command writeUninstaller.<br />
      -a section "Uninstall", where remove software files and shortcuts.<br />
      <br />
      My issue is: Both uninstallers call the same section Uninstall. So, when i execute the software uninstaller, itÂ´s fine. He will remove only software fileset. But when i execute toolbar uninstaller, all files are removed, including software fileset. Is it possible create diferents sections to each uninstaller?<br />
      <br />
      Or have other way to create these uninstallers??</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
      <span class="post-time small text-muted">25th June 2009 17:43 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">You can have multiple uninstall sections instead of one "Uninstall" section. Just put un. in front of section names. You can then add a MUI_UNPAGE_COMPONENTS.<br />
      <br />
      Stu</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">adum</span><br />
      <span class="post-time small text-muted">25th June 2009 23:21 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Nice, Thanks for reply.<br />
      <br />
      What i'm thinking to do is:<br />
      -Create a section un.install_toolbar to remove toolbar fileset.<br />
      -Create a section un.MainProgram to remove software fileset(actually it is done on section Uninstall).<br />
      -Remove section Uninstall(un.MainProgram will do the work).<br />
      <br />
      So if I create this structure, when i use WriteUninstaller on each Section(install_toolbar and MainProgram), NSIS will create diferents and independents uninstallers? Is it?<br />
      <br />
      And about MUI_UNPAGE_COMPONENTS, how it works? it1s only add this command on script? need any argument?<br />
      <br />
      Sorry ask without test the solution, but i'm at home now, and i havent access of scripts.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
      <span class="post-time small text-muted">26th June 2009 12:52 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">You can't write multiple uninstallers. You will have one uninstaller with 2 uninstall sections.<br />
      <br />
      Stu</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">adum</span><br />
      <span class="post-time small text-muted">26th June 2009 13:46 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Now i'm a bit confused.<br />
      <br />
      What I need is 2 independent uninstallers. When i run "Program uninstaller" he will remove the Program fileset only, and when i run "Toolbar uninstaller" he will remove toolbar fileset only.<br />
      <br />
      Is it possible to do? If yes, can you help me a bit?</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">adum</span><br />
      <span class="post-time small text-muted">26th June 2009 15:15 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Ok, I have made some tests and now i understand what you say.<br />
      <br />
      So the only way to not run all un. section is using MUI_UNPAGE_COMPONENTS?<br />
      <br />
      What i thinking to do is something like this:<br />
      On un.onInit(maybe other place) he checks if uninstaller is toolbar uninstaller or Program unsinstaller and "select" one of the sections to run.<br />
      <br />
      Is it possible? Or without MUI_UNPAGE_COMPONENTS the uninstaller will run all un. sections?</p>
    </div>
    <hr />

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]>
  </script>
</body>
</html>
