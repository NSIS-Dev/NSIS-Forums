<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="description" content="How to get a directory deleted *after* executing a file?"><title>How to get a directory deleted *after* executing a file? - NSIS Forums</title><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script><link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css"><link rel="stylesheet" href="../css/style.css" type="text/css"></head><body><div class="container"><ol class="breadcrumb"><li><a href="../index.html" class="glyphicon glyphicon-home"></a></li><li><a href="f-65.html">NSIS Discussion</a></li><li class="active">How to get a directory deleted *after* executing a file?</li></ol><p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=82472">How to get a directory deleted *after* executing a file?</a></p><br><div class="post"><p class="post-meta"><span class="post-author text-primary">japheth</span><br><span class="post-time small text-muted">26th March 2002 19:24 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>How to get a directory deleted *after* executing a file?</strong><br>Okay, I want to do the following: Install a bunch of files to a certain directory, and then at the end of the install it executes a file that compiles certain files and copies others. After the executable is done that, I want to remove the directories that the executable copied/compiled the files from. However I tried using the following nsi script:<br><br># [Installer Attributes]<br>Name "Norse Mini Mod"<br>OutFile "norseinstaller.exe"<br>Caption "Norse Mini Mod Setup"<br>BrandingText ""<br><br><br><br># [Additional Installer Settings ]<br>ShowInstDetails show<br>AutoCloseWindow false<br>SilentInstall normal<br>CRCCheck on<br>SetCompress auto<br>SetDatablockOptimize on<br>SetOverwrite on<br><br># [Background Gradient]<br>BGGradient 808000 804040 FFFFFF<br><br># [Files]<br>Section "default"<br>SetOutPath $INSTDIR<br>File /r "C:\Program Files\Black Isle\BGII - SoA\norsemod"<br>File "C:\Program Files\Black Isle\BGII - SOA\NorseSetup.exe"<br>SectionEnd<br><br># [Directory Selection]<br>InstallDir "$PROGRAMFILES\Black Isle\BGII - SOA"<br><br># [Registry Get]<br>InstallDirRegKey HKLM \<br>"Software\Microsoft\Windows\CurrentVersion\App Paths\BG2Main.Exe" \<br>"Path"<br><br><br>DirShow show<br>DirText "Select your default BGII - SoA directory."<br><br>;called when the installer is nearly finished initializing<br>Function .onInit<br><br>;message box<br>MessageBox MB_YESNO "This will install the Norse Mini Mod. Continue?" IDYES NoAbort<br>Abort<br>NoAbort:<br>FunctionEnd<br><br>;called when the user hits the 'cancel' button<br>Function .onUserAbort<br>MessageBox MB_YESNO "Abort install?" IDYES NoCancelAbort<br>Abort<br>NoCancelAbort:<br>FunctionEnd<br><br>;called when the install was successful<br>Function .onInstSuccess<br>CreateDirectory "$INSTDIR\backup"<br>Exec "$INSTDIR\NorseSetup.exe norsemod/norsemod.tp2 --tlkout dialog.tlk"<br>RMDir /r "$INSTDIR\norsemod"<br>Delete "$INSTDIR\norsesetup.debug"<br><br>FunctionEnd<br><br><br><br>#eof!<br><br>And it runs the executable at the end, howvever it deletes the directory before the executable can compile/copy the files to the appropriate directories...<br><br>Any thoughts on how to do this?<br><br>Thanx in advance.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Smile2Me</span><br><span class="post-time small text-muted">26th March 2002 20:37 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">japbeth,<br><br>use ExecWait instead of Exec to execute the decompressor. Then it will wait for the decompressor to finish and shut down and then the script will continue and remove the dir. Maybe you should also include a delete command to delete the files in this dir first otherwise it will not be possible to remove the dir. It's only a suggestion, because I don't know what the decompressor will do with the source files. Maybe it will already delete them, hey, I don't know...<br><br>So anyway, just use ExecWait...<br><br>Good luck, greetz,<br>-Hendri.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">sdbarker</span><br><span class="post-time small text-muted">26th March 2002 21:13 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">And why clear the branding text if you have nothing else to put there and didn't modify the source?<br><br>That just seems mean to me.<br><br>-Scott</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Pomflain</span><br><span class="post-time small text-muted">26th March 2002 23:09 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>Re: How to get a directory deleted *after* executing a file?</strong><br></p><blockquote><i>Originally posted by japheth</i><br><b>File /r "C:\Program Files\Black Isle\BGII - SoA\norsemod"<br>File "C:\Program Files\Black Isle\BGII - SOA\NorseSetup.exe"<br><br></b></blockquote>I'd make sure on all instructions similar to this that you change them to something like File /r '"C:\Program Files\Black Isle\BGII - SoA\norsemod"'<br><br>Don't think there should be any problems, but with the spaces in the path you might end up with it delimiting the path incorrectly in some commands. I think that NSIS will straighten things up for you internally, but better to double check anyway.</div><hr><div class="footer"><p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p></div></div><script src="../js/highlight.pack.js" type="text/javascript"></script><script type="text/javascript">//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]></script></body></html>