<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="ExecShell problem" />

  <title>ExecShell problem - NSIS Forums</title>
  <script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script>
  <!-- Bootstrap core CSS -->

  <link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css" />
  <link rel="stylesheet" href="../css/style.css" type="text/css" /><!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!--[if lt IE 9]>
                <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
                <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->
</head>

<body>
  <div class="container">
    <!-- Put navigation bar here -->

    <ol class="breadcrumb">
      <li><a href="../index.html" class="glyphicon glyphicon-home"></a></li>

      <li><a href="f-65.html">NSIS Discussion</a></li>

      <li class="active">ExecShell problem</li>
    </ol>

    <p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=289628">ExecShell problem</a></p><br />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">obicharon</span><br />
      <span class="post-time small text-muted">4th April 2008 10:30 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>ExecShell problem</strong><br />
      I have made in my uninstaller some custom pages that collect the reasons for uninstalling the program. The answers are gathered in a string and the string is sent as a GET argument to a web page. The string contains double quotation marks " " .<br />
      It is something like this<br />
      ?motifs="1,2,3"&amp;obs="observation text"<br />
      <br />
      The string is constructed correctly ( i put a message box to display it and contains the quotation marks). The string is passed to a ExecShell instruction like this<br />
      <br />
      ExecShell "open" "http://www.mysite.com/$getString" where get string is the variable that contains the string (displayed with MBox it looks ok).<br />
      The Exec is ok, the page in open ,the string is passed as a GET argument but the quotation marks do not appear in the link opened in the browser.<br />
      How can i make the marks show?</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Anders</span><br />
      <span class="post-time small text-muted">4th April 2008 10:34 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">escape the " maybe, ...?foo%22bar</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">GregL</span><br />
      <span class="post-time small text-muted">4th April 2008 14:56 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Anders is correct. You are probably using Internet Explorer. It's trying to be "helpful" and it's NOT showing you what it really did behind the scenes.<br />
      Quotes get escaped to %22 and technically you'd want their whole string URL encoded, including spaces and ampersands.<br /></p>
      <pre>
<code>?motifs=%221,2,3%22&amp;obs=%22observation%20text%22</code>
</pre><br />
      <br />
      Also bear in mind that Internet Explorer has max length URL limit of about 2,048 bytes. Other browsers don't have this limit so you have to code for the lowest common denominator here.<br />
      <br />
      Another option you may want to consider is just launching a page on your site and presenting them with your form. Assuming you're using PHP, or similar language, you'll have much more control over their submission and can avoid some pitfalls doing it this other way.
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">obicharon</span><br />
      <span class="post-time small text-muted">4th April 2008 16:14 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Not using IE (ever) . Using Firefox.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">GregL</span><br />
      <span class="post-time small text-muted">4th April 2008 17:53 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">But many (most?) of your users likely are using IE.<br />
      <br />
      Firefox on my system showed the values after encoding which is why I made the assumption you were using IE.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
      <span class="post-time small text-muted">4th April 2008 20:24 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">This is not just Internet Explorer. You have to encode all characters except for _ - and all alpha-numeric characters. Spaces need to be replaced with + signs.<br />
      <br />
      The encoding is % followed by the ASCII hexadecimal equivalent.<br />
      <br />
      <a href="http://www.w3schools.com/TAGS/ref_urlencode.asp" target="_blank">http://www.w3schools.com/TAGS/ref_urlencode.asp</a><br />
      <br />
      Stu</p>
    </div>
    <hr />

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]>
  </script>
</body>
</html>
