<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="Folder.CopyHere to install fonts on Win7" />

  <title>Folder.CopyHere to install fonts on Win7 - NSIS Forums</title>
  <script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script>
  <!-- Bootstrap core CSS -->

  <link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css" />
  <link rel="stylesheet" href="../css/style.css" type="text/css" /><!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!--[if lt IE 9]>
                <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
                <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->
</head>

<body>
  <div class="container">
    <!-- Put navigation bar here -->

    <ol class="breadcrumb">
      <li><a href="../index.html" class="glyphicon glyphicon-home"></a></li>

      <li><a href="f-65.html">NSIS Discussion</a></li>

      <li class="active">Folder.CopyHere to install fonts on Win7</li>
    </ol>

    <p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=318029">Folder.CopyHere to install fonts on Win7</a></p><br />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Legace</span><br />
      <span class="post-time small text-muted">28th March 2010 16:48 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>Folder.CopyHere to install fonts on Win7 (VBScript)</strong><br />
      &nbsp; I've tried and tried, but I just couldn't get CopyFiles or File to install fonts on Windows 7. Then I stumbled on this VBScript that does work:<br />
      <br /></p>
      <pre>
<code>Const FONTS = &amp;H14&amp;<br />'/-&gt; Path And Name To Font<br /> Dim Font :Font =  "PATH_FONT_NAME_HERE"<br />'/-&gt; Objects                              <br /> Dim Folder, Fso, Shell<br /> Set Fso = CreateObject("Scripting.FileSystemObject")<br /> Set Shell = CreateObject("Shell.Application")<br /> Set Folder = Shell.Namespace(FONTS)<br />'/-&gt; Check For File Exists<br /> If Fso.FileExists(Font) Then <br />  Folder.CopyHere Font<br /> Else<br />  MsgBox "Missing " &amp; Font,4128,"Missing Font"<br /> End If</code>
</pre><br />
      <br />
      or simply:<br />
      <pre>
<code>Const FONTS = &amp;H14&amp;<br /><br />Set objShell = CreateObject("Shell.Application")<br />Set objFolder = objShell.Namespace(FONTS)<br />objFolder.CopyHere "PATH_TO_FONT"</code>
</pre><br />
      <br />
      The problem is that I don't know how to use that in NSIS. I've read <a href="http://msdn.microsoft.com/en-us/library/bb787866%28VS.85%29.aspx" target="_blank">http://msdn.microsoft.com/en-us/libr...8VS.85%29.aspx</a> but I don't have a clue on how to convert that to NSIS.<br />
      <br />
      I've tried System::Call and other stuff, but I guess I'm stupid and can't get it right.<br />
      <br />
      Any help? Thanks :)
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
      <span class="post-time small text-muted">31st March 2010 22:26 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">None of the Wiki scripts or plugins work?<br />
      <br />
      Stu</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Legace</span><br />
      <span class="post-time small text-muted">2nd April 2010 16:12 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Not for me.<br />
      <br />
      Using FontReg.exe for now, is small enough and does what it's supposed to.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Animaether</span><br />
      <span class="post-time small text-muted">6th April 2010 13:47 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Worked fine for me using...<br />
      <a href="http://nsis.sourceforge.net/Register_Fonts" target="_blank">http://nsis.sourceforge.net/Register_Fonts</a><br />
      ...<br />
      <br />
      Just a few notes on it..<br />
      1. The page refers to the FontName plugin which seems to include the same script already as a header file. However, that header file does not have the latest update which allows you to use spaces in the font path. So make sure you adjust the header, or copy/paste the code from the wiki page.<br />
      2. Make sure your installer runs as Administrator. Non-administrators can't write to the Windows Fonts folder.<br />
      3.1 Make sure you don't forget "SendMessage ${HWND_BROADCAST} ${WM_FONTCHANGE} 0 0 /TIMEOUT=5000" otherwise Windows won't know there's a new font.<br />
      3.2 The example on that page was missing the WinMessages.nsh include (required for the above two defines), I've adjusted this on that page now.<br />
      <br />
      Platform: Windows 7 Home Premium NL 64bit<br />
      Code used:<br /></p>
      <pre>
<code>
5000<br />SectionEnd 
<br />&gt;
</code>
</pre>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">MarcelP1977</span><br />
      <span class="post-time small text-muted">16th May 2010 10:53 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">@Animaether:<br />
      <br />
      Thanks for your help here.<br />
      <br />
      I have issue on Win7 Font Installation (works for me fine, but one User is reporting a Error-Message: "Ungültiges Dateihandle 32" (in German)<br />
      <br />
      Look also here:<br />
      <a href="http://centrafuse.de/board/wbb/index.php?page=Thread&amp;postID=11401#post11401" target="_blank">http://centrafuse.de/board/wbb/index...1401#post11401</a><br />
      <br />
      Maybe you can post the right Header that i have to change?! That would be nice if you can help me with this.<br />
      <br />
      Best Regards, Marcel.<br />
      <br />
      (My nsi-Code is correct as you have posted.)</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">MarcelP1977</span><br />
      <span class="post-time small text-muted">16th May 2010 11:09 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Ok, i have found one thing in line 60:<br />
      <br />
      Changed it from:<br />
      <br /></p>
      <pre>
<code>${GetFileName} ${FontFile} $0</code>
</pre><br />
      <br />
      to:<br />
      <br />
      <pre>
<code>${GetFileName} "${FontFile}" $0</code>
</pre><br />
      <br />
      Is all that i need?<br />
      <br />
      Why i become this Error "Ungültiges Dateihandle 32"?<br />
      <br />
      But only one User has this Issue (on Win7 64Bit).
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Animaether</span><br />
      <span class="post-time small text-muted">16th May 2010 12:19 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"></p>

      <blockquote>
        <small>Originally posted by MarcelP1977</small><br />
        <pre>
<code>${GetFileName} "${FontFile}" $0</code>
</pre><br />
        Is all that i need?
      </blockquote>It's the only header change that I noticed with regard to spaces in paths.<br />
      <br />

      <blockquote>
        <small>Originally posted by MarcelP1977</small><br />
        Why i become this Error "Ungültiges Dateihandle 32"?
      </blockquote>No idea - I know what it's trying to say (invalid filehandle).. but don't know -why- it's saying it :)<br />
      <br />

      <blockquote>
        <small>Originally posted by MarcelP1977</small><br />
        But only one User has this Issue (on Win7 64Bit).
      </blockquote>Could be that this specific user has a particular path either to the font file or the windows font folder? You could add some debug information (messageboxes or dump out to a file) for this particular user and see if that offers any clues.<br />
      <br />
      There's also this previous post where as u user had the same error...<br />
      <a href="http://forums.winamp.com/showpost.php?p=2640488&amp;postcount=12" target="_blank">http://forums.winamp.com/showpost.ph...8&amp;postcount=12</a><br />
      ...where they fixed it by changing the location of the TTF file on the build machine; not sure how/why that matters, but worth a shot.
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">MarcelP1977</span><br />
      <span class="post-time small text-muted">16th May 2010 12:48 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Thanks.<br />
      <br />
      I have it allready as it in other thread is.<br />
      <br />
      But maybe i can fix it with this changes?!<br />
      <br />
      Old Code was:<br />
      <br /></p>
      <pre>
<code>!insertmacro InstallTTFFont 'GOTHIC.ttf'</code>
</pre><br />
      <br />
      and now i will try with this:<br />
      <br />
      <pre>
<code>!insertmacro InstallTTFFont 'GOTHIC.TTF'</code>
</pre><br />
      <br />
      Thanks, i hope it works.
    </div>
    <hr />

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]>
  </script>
</body>
</html>