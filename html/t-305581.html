<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="description" content="Add/Remove Programs icons and overwrite"><title>Add/Remove Programs icons and overwrite - NSIS Forums</title><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script><link rel="preload" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css" as="style" onload="this.rel='stylesheet'"><link rel="preload" href="../css/style.css" as="style" onload="this.rel='stylesheet'"><noscript><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css"><link rel="stylesheet" href="../css/style.css"></noscript><script>!function(a){"use strict";var b=function(b,c,d){function e(a){return h.body?a():void setTimeout(function(){e(a)})}function f(){i.addEventListener&&i.removeEventListener("load",f),i.media=d||"all"}var g,h=a.document,i=h.createElement("link");if(c)g=c;else{var j=(h.body||h.getElementsByTagName("head")[0]).childNodes;g=j[j.length-1]}var k=h.styleSheets;i.rel="stylesheet",i.href=b,i.media="only x",e(function(){g.parentNode.insertBefore(i,c?g:g.nextSibling)});var l=function(a){for(var b=i.href,c=k.length;c--;)if(k[c].href===b)return a();setTimeout(function(){l(a)})};return i.addEventListener&&i.addEventListener("load",f),i.onloadcssdefined=l,l(f),i};"undefined"!=typeof exports?exports.loadCSS=b:a.loadCSS=b}("undefined"!=typeof global?global:this);!function(a){if(a.loadCSS){var b=loadCSS.relpreload={};if(b.support=function(){try{return a.document.createElement("link").relList.supports("preload")}catch(b){return!1}},b.poly=function(){for(var b=a.document.getElementsByTagName("link"),c=0;c<b.length;c++){var d=b[c];"preload"===d.rel&&"style"===d.getAttribute("as")&&(a.loadCSS(d.href,d,d.getAttribute("media")),d.rel=null)}},!b.support()){b.poly();var c=a.setInterval(b.poly,300);a.addEventListener&&a.addEventListener("load",function(){b.poly(),a.clearInterval(c)}),a.attachEvent&&a.attachEvent("onload",function(){a.clearInterval(c)})}}}(this);</script></head><body><div class="container"><ol class="breadcrumb"><li><a href="../index.html" class="glyphicon glyphicon-home"></a></li><li><a href="f-65.html">NSIS Discussion</a></li><li class="active">Add/Remove Programs icons and overwrite</li></ol><p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=305581">Add/Remove Programs icons and overwrite</a></p><br><div class="post"><p class="post-meta"><span class="post-author text-primary">abcdgoldfish</span><br><span class="post-time small text-muted">21st April 2009 21:07 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>Add/Remove Programs icons and overwrite</strong><br>&nbsp; I have a couple of questions regarding Add/Remove Programs that I've looked high and low for answers but have found nothing that solves my problems. I hope someone here can help.<br><br>I want to add an icon in A/R P but the code I am using does not seem to work. Here's the line of code in Section -Post.<br>For clarity:<br>PURK = PRODUCT_UNINST_ROOT_KEY, PUK = PRODUCT_UNINST_KEY)<br><br>WriteRegStr ${PURK} "${PUK}" "DisplayIcon" "${NSISDIR}\Contrib\Graphics\Icons\uninstall.ico"<br><br>Also, my installer adds an entry into A/R P just fine, except for the above tweak. Or so I thought. When I built and ran an installer that had a different version of the same product I expected to find a second entry in A/R P. Instead, I find that the new entry overwrites the original. Here is the code:<br><br>WriteRegStr ${PURK} "${PUK}" "DisplayName" "$(^Name)"<br>WriteRegStr ${PURK} "${PUK}" "UninstallString" "$INSTDIR\uninst.exe"<br>WriteRegStr ${PURK} "${PUK}" "DisplayVersion" "${PRODUCT_VERSION}"<br>WriteRegStr ${PURK} "${PUK}" "Publisher" "${PRODUCT_PUBLISHER}"<br><br>One last question, where does $(^Name) come from? I've tried to view it using MessageBox but was unable. What is the carat doing?<br><br><br>Thanks.<br>p.s., in the name of full disclosure I'm forced to use NSIS version 2.39 so, if there are fixes in later versions to these problems, please let me know so I can build a case.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Animaether</span><br><span class="post-time small text-muted">21st April 2009 22:43 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">"$(^Name)"<br>comes from the Installer "Name" directive.<br><br>"${NSISDIR}\Contrib\Graphics\Icons\uninstall.ico"<br>wouldn't work on any machine other than those who have that icon file in the exact same location on their machine; which is probably not your end-users.<br>Best is to use an icon in the uninstaller itself, btw - ARP will use that icon from the executable automatically.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">abcdgoldfish</span><br><span class="post-time small text-muted">22nd April 2009 01:47 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Thanks for the .ico observation - doh! I should have known that.<br><br>Are you saying that ${^Name} is the same as ${PRODUCT_NAME}? If so, why the alias and what's with the ^?<br><br>My most pressing question though is why I can't get multiple versions of uninstallers in Add/Remove Programs.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Animaether</span><br><span class="post-time small text-muted">22nd April 2009 02:19 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">no, ${PRODUCT_NAME} is probably a define somewhere in the script you're working with; sounds like an HMSoft NIS Edit default define name.<br><br>$(^Name) (not ${^Name} - curly braces here) is a so-called 'langstring' variable. It changes the string based on whatever language your installer uses (in some installers, that can be decided by the user, typically on startup).<br><br>--<br><br>as for your ARP.. if you want multiple entries, you'll need separate registry key files. Try adding the version number or so to the registry key.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">abcdgoldfish</span><br><span class="post-time small text-muted">28th April 2009 00:52 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">I got the ARP entries to be unique per build - thank you.<br><br>But I still can't get the icon in ARP to work. I put a copy of the .ico file in the same directory as my .nsi file but that didn't help. Here's what I do have that works as desired:<br><br>; The icon in the top right corner of the installer windows and the desktop icon.<br>!define MUI_ICON "${NSISDIR}\Contrib\Graphics\Icons\my_1.ico"<br><br>; The icon for the installer in the directory, not in Add or Remove Programs.<br>!define MUI_UNICON "${NSISDIR}\Contrib\Graphics\Icons\my_1_un.ico"<br><br>...<br><br>And this does not work as desired:<br><br>Section -Post<br>...<br><br>; Shows up as a registry Name/Data entry. ARP icon not changed.<br>WriteRegStr ${PRODUCT_UNINST_ROOT_KEY} "${PRODUCT_UNINST_KEY}" "DisplayIcon" "my_uninstall.ico,4"<br><br>; Also tried, with similar results (no icon index):<br>WriteRegStr ${PRODUCT_UNINST_ROOT_KEY} "${PRODUCT_UNINST_KEY}" "DisplayIcon" "my_uninstall.ico"<br><br>...<br><br>I suspect I'm missing something obvious but I just don't see it. Thanks again for your help.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Animaether</span><br><span class="post-time small text-muted">28th April 2009 01:09 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">I think you have to specify the -full path- to the resource file (in your case, "my_uninstall.ico") - so including any "c:\program files\myApp\my_uninstall.ico" bits.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Anders</span><br><span class="post-time small text-muted">28th April 2009 12:10 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">a .ico does not have a icon index, its just one icon, so just using the full path without a index should work</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">abcdgoldfish</span><br><span class="post-time small text-muted">28th April 2009 20:01 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">I hate to sound dense but I'm still not there yet. I modified the line in my .nsi script in Section -Post:<br>WriteRegStr ${PRODUCT_UNINST_ROOT_KEY} "${PRODUCT_UNINST_KEY}" "DisplayIcon" "${NSISDIR}\Contrib\Graphics\Icons\my_uninstall.ico"<br><br>by replacing ${NSISDIR} with its explicit c:\... path.<br><br>I still don't see the icon I want in ARP. In fact, it is using an icon from the folder of one of the tools. Should I expect to see the .ico in the delivered product? Should I be using the path to this icon? That doesn't seem right. I thought it would be incorporated into the installer's .exe like it does the other icons.<br><br>The .ico file I am using is composed of four separate images of different sizes. I thought that was standard for .ico files that are used as resources.<br><br>Is there some sample code someone can point me to?</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Anders</span><br><span class="post-time small text-muted">28th April 2009 20:11 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">${NSISDIR} is a path on your system, not the users system.<br><br>try:</p><pre>
<code>
Section
<br>SetOutPath $instdir
<br>File "${NSISDIR}\\Contrib\\Graphics\\Icons\\my_uninstall.ico"
<br>&gt;WriteRegStr ${PRODUCT_UNINST_ROOT_KEY} "${PRODUCT_UNINST_KEY}" "DisplayIcon" "$instdir\\my_uninstall.ico"
<br>&gt;SectionEnd 
<br>&gt;
</code>
</pre>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">abcdgoldfish</span><br>
      <span class="post-time small text-muted">28th April 2009 22:33 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Okay, thanks. But that puts a copy of the .ico file into my deliverable. Is this how it's supposed to work, the .ico file has to be installed? None of the other icon files, like those that adorn the install window, are installed. Why would this be different?</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Animaether</span><br>
      <span class="post-time small text-muted">28th April 2009 22:55 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">yes, it has to be installed because the end-user's machine needs to be able to find that icon file.<br>
      <br>
      The icons for the installer itself (top-left corner, usually, and explorer views of the installer, etc. etc.) are inside the .exe itself. So if you place that .exe on the machine's computer, that icon is, in a way, placed on the end-user's machine as well.<br>
      <br>
      If you don't want to install the icon file, you may be able to add the uninstall icon to the uninstaller executable, and then reference it using e.g. "$instdir\uninstaller.exe,N", where N would the icon index within the uninstaller.<br>
      But I suspect that might be more trouble than it's worth.</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">abcdgoldfish</span><br>
      <span class="post-time small text-muted">28th April 2009 23:52 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Thanks. It's making sense.</p>
    </div>
    <hr>

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script type="text/javascript" src="../js/highlight.pack.js" async>
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]></script></body></html>