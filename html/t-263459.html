<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="How do I register.net library thru NSIS Script" />

  <title>How do I register.net library thru NSIS Script - NSIS Forums</title>
  <script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script>
  <!-- Bootstrap core CSS -->

  <link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css" />
  <link rel="stylesheet" href="../css/style.css" type="text/css" /><!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!--[if lt IE 9]>
                <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
                <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->
</head>

<body>
  <div class="container">
    <!-- Put navigation bar here -->

    <ol class="breadcrumb">
      <li><a href="../index.html" class="glyphicon glyphicon-home"></a></li>

      <li><a href="f-65.html">NSIS Discussion</a></li>

      <li class="active">How do I register.net library thru NSIS Script</li>
    </ol>

    <p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=263459">How do I register.net library thru NSIS Script</a></p><br />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">gnanaprakash</span><br />
      <span class="post-time small text-muted">11th January 2007 14:27 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>How do I register.net library thru NSIS Script</strong><br />
      Hi,<br />
      <br />
      How do I register.net library thru NSIS Script.Pls provide me sample script.<br />
      <br />
      <br />
      Thanks in Advance;)</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
      <span class="post-time small text-muted">11th January 2007 21:17 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">The following Wiki page has some information about this.<br />
      <br />
      <a href="http://nsis.sourceforge.net/Register_a_managed_.NET_DLL_in_the_GAC" target="_blank">http://nsis.sourceforge.net/Register...DLL_in_the_GAC</a></p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">gnanaprakash</span><br />
      <span class="post-time small text-muted">12th January 2007 16:31 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Hi,<br />
      <br />
      I tried to put my dll in GAC by using the below script but I was not able to register.<br />
      <br />
      ;R0 "$INSTDIR\mydll.dll"'<br />
      nsExec::Exec '"$WINDIR\Microsoft.NET\Framework\v1.1.432\GacUtil.exe" /i "$R0" /f'<br />
      <br />
      <br />
      for the GACUtil do I need to give the above path or "..\Program Files\Microsoft Visual Studio 8\VC\gacutil\"<br />
      <br />
      Iam not sure what's wrong in it.Even I tried like this<br />
      <br />
      ExecWait '"$WINDIR\Microsoft.NET\Framework\v1.1.432\GacUtil.exe" /i "$INSTDIR\mydll.dll"' still I am not able to register.<br />
      <br />
      Thanks</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
      <span class="post-time small text-muted">12th January 2007 18:15 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">If you point to the Visual Studio directory, only users with Visual Studio will be able to install your application. You don't want that. Probably a better overall solution would be including gacutil.exe with your installer.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">gnanaprakash</span><br />
      <span class="post-time small text-muted">13th January 2007 09:17 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">After Calling this script<br />
      R0 "$INSTDIR\mydll.dll"'<br />
      nsExec::Exec '"$WINDIR\Microsoft.NET\Framework\v1.1.432\GacUtil.exe" /i "$R0" /f'<br />
      ;(or)<br />
      ExecWait '"$WINDIR\Microsoft.NET\Framework\v1.1.432\GacUtil.exe" /i "$INSTDIR\mydll.dll"' still I am not able to register.<br />
      <br />
      I was not able to find "mydll.dll" in GAC.<br />
      <br />
      What's wrong in it?.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
      <span class="post-time small text-muted">13th January 2007 16:13 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Does that work from the command line? Are you sure gacutil.exe really exists? Why not package gacutil.exe with your installer, as I suggested?</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">gnanaprakash</span><br />
      <span class="post-time small text-muted">15th January 2007 15:24 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Yes it's working in command line and gacutil is exists in "\Microsoft.NET\Framework\v1.1.432\GacUtil.exe"</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
      <span class="post-time small text-muted">16th January 2007 18:34 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Try executing it with nsExec. Maybe it prints some kind of an error.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">gnanaprakash</span><br />
      <span class="post-time small text-muted">17th January 2007 05:29 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Hi,<br />
      <br />
      I have one more gacutil under the following folder.<br />
      <br />
      nsExec::Exec '"C:\Program Files\Microsoft Visual Studio 8\SDK\v2.0\Bin\gacutil.exe"<br />
      <br />
      If I use the above path in the script It's registering .<br />
      <br />
      If I use this path it's not registering. "\Microsoft.NET\Framework\v1.1.432\GacUtil.exe"<br />
      <br />
      <br />
      Thanks,<br />
      Gnanaprakash</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Red Wine</span><br />
      <span class="post-time small text-muted">17th January 2007 06:18 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"></p>

      <blockquote>
        nsExec::Exec '"C:\Program Files\Microsoft Visual Studio 8\SDK\v2.0\Bin\gacutil.exe"
      </blockquote>this path points to your local system, probably is not valid for every target.<br />

      <blockquote>
        If I use this path it's not registering. "\Microsoft.NET\Framework\v1.1.432\GacUtil.exe"
      </blockquote>Also, this one is partially hard coded therefore useless for every machine.<br />
      Why not just package gacutil with your installer as kichik suggested twice?<br />
      If you want anyway to use the gacutil that resides on the target, you need to grab in a variable the framework path from registry, and use it like this,<br />
      <pre>
<code>ReadRegStr $0 HKLM "SOFTWARE\Microsoft\.NETFramework" "InstallRoot"<br />nsExec::Exec "$0\v1.1.4322\gacutil.exe"</code>
</pre>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">gnanaprakash</span><br />
      <span class="post-time small text-muted">18th January 2007 11:38 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Yes,I am packaging gacutil with installer as kichik suggested .<br />
      <br />
      Thanks for helping me :)</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">mayevski</span><br />
      <span class="post-time small text-muted">27th February 2007 10:34 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">You are not allowed to distribute GACUtil.<br />
      Also, different versions of gacutil (namely, 1.1 and 2.0) install the assemblies to different GACs (1.1 and 2.0 accordingly). So the correct way is to use Fusion DLLs on the target systems.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">zanz</span><br />
      <span class="post-time small text-muted">30th July 2008 02:32 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">I read the following note from the link posted by kichik:<br />
      - The above will not work in most cases on Vista, since you need permissions to do it. So we need some way to do the above from within NSIS. I have no idea how.<br />
      <br />
      Retrieved from "http://nsis.sourceforge.net/Register_a_managed_.NET_DLL_in_the_GAC"<br />
      <br />
      <br />
      Is there any alternative for Vista? If my permission level is set to 'admin' would I still have problem on Vista? thanks!</p>
    </div>
    <hr />

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]>
  </script>
</body>
</html>
