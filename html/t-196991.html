<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="description" content="MSIBanner - newest plugin"><title>MSIBanner - newest plugin - NSIS Forums</title><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script><link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css"><link rel="stylesheet" href="../css/style.css" type="text/css"><!--[if lt IE 9]><script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script><script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script><![endif]--><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="description" content=" MSIBanner - newest plugin"><title>MSIBanner - newest plugin - NSIS Forums</title><link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css"><link rel="stylesheet" href="../css/style.css" type="text/css"></head><body><div class="container"><ol class="breadcrumb"><li><a href="../index.html" class="glyphicon glyphicon-home"></a></li><li><a href="f-65.html">NSIS Discussion</a></li><li class="active">MSIBanner - newest plugin</li></ol><p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=196991">MSIBanner - newest plugin</a></p><br><div class="post"><p class="post-meta"><span class="post-author text-primary">Joel</span><br><span class="post-time small text-muted">21st October 2004 16:37 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>MSIBanner - newest plugin</strong><br>This is my new plugin, MSIBanner.<br><br>It prompts a banner like the MSI installations (Windows Installer).<br><br>Please test it :)<br><br>TODO:<br>1. Remove the parameter /NOUNLOAD<br>2. Put a progress bar.<br><br>Thanks!<br><br>:D</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Joel</span><br><span class="post-time small text-muted">22nd October 2004 15:55 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>updated....</strong><br>Update MSIBanner....<br><br>What's new:<br>1. Rewrite Update function.<br>2. Added the progress bar.<br><br>See example.<br><br>TODO:<br>1. Remove the /NOUNLOAD parameter.<br>2. (maybe) add colors to the progress bar.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Joel</span><br><span class="post-time small text-muted">23rd October 2004 22:16 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">It will put at the archive in a few hours...<br><br>any last suggestions?</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">kichik</span><br><span class="post-time small text-muted">23rd October 2004 23:33 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">It has the same problem as old Banner. The installer shows on the background.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Joel</span><br><span class="post-time small text-muted">24th October 2004 02:13 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">ok, add it into my TODO list... :)<br><br>Archive <a href="http://nsis.sourceforge.net/archive/nsisweb.php?page=635" target="_blank">page</a>.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Joel</span><br><span class="post-time small text-muted">19th January 2005 04:59 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"></p><blockquote><i>Originally posted by kichik</i><br><b>It has the same problem as old Banner. The installer shows on the background.</b></blockquote>Not anymore ;)<br><br>plus added a static text control which shows the current "%" number.<br><br><a href="http://nsis.sourceforge.net/archive/viewpage.php?pageid=528" target="_blank">Archive page</a></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Takhir</span><br><span class="post-time small text-muted">19th January 2005 07:12 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Win2K (Server, SP2, Rus), NSIS 2.04, goes to background. After banner destroyed, installer window becomes visisble on the top for a short time and after this goes to BG (100% repeatable on my Win2K). I run it 4 times, and one of them caused installer crash (bad pointer) on the banner destroy step.<br>Looking from my corner % at the end of progress bar looks ugly. And I not found any progress bar positioning parameter, to reach it's end (100% without jumps from 20 to 100) developer should add 20 Update script lines :(</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Joel</span><br><span class="post-time small text-muted">19th January 2005 14:23 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Hi Takhir:<br>I don't know why in win2k goes to the background...maybe is the API I'm using that is not available in win2k (doubtfull, but I'll check)...<br>On this moment is the only place where I can place the "%".<br>And... Detroy function will close the counter, so you don't need to add the 20 lines... :D</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Takhir</span><br><span class="post-time small text-muted">19th January 2005 16:01 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"></p><blockquote><i>Originally posted by Lobo Lunar</i><br>And... Detroy function will close the counter, so you don't need to add the 20 lines... :D</blockquote>For example installer checks 3 questions while banner window is visible, and developer (I :D ) want to show 3 steps: 30%, 60% and 100%. May be I misunderstood something, but current implementation with 3 /UPDATEs will show 5 and 10, and after this user will see jump to 100%. Or I should add 6 /UPDATEs on every step ;) to emulate correct check out progress?<br>And finally most of users can live with "background", installer crash is a real problem.</div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Takhir</span><br><span class="post-time small text-muted">19th January 2005 16:19 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Test script attached. I run it on slow comp with Win98, <i>no</i> crashes, but background gradient flushes on installer start (after banner). This not happens if Destroy line is commented, but this case Installer loses keyboard focus.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Joel</span><br><span class="post-time small text-muted">23rd January 2005 23:02 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">I tested the script in my XP and seemes to be ok.... weird :igor:<br><br>Anyway, before uploading the big one... I update again the plugin<br><br>what's new:<br>1.- Added <b>reset</b> function: Which will reset the global increment and the position of the progress bar.<br><br>2. Added <b>Move</b> function: Which the progress bar moves and adds the inputed value to the global increment.<br><br>3. Added <b>Pos</b> function: Which the progress bar moves into position inputed, becoming the current global increment.<br><br>See the example :)</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Takhir</span><br><span class="post-time small text-muted">25th January 2005 11:14 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Attached image shows another possible place for percent value. Win2K test still is a good idea ;)</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Joel</span><br><span class="post-time small text-muted">25th January 2005 14:11 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Hi Takhir<br><br>I'm thinking to subclass the progress bar to put the % value inside of it...<br><br>Now, I don't know why you have issues in 2k... I already tested in XP and WinME and seems that everything is ok...<br><br>I'll try to find a 2k machine to tested my self :)</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">grahama</span><br><span class="post-time small text-muted">25th January 2005 20:42 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">for some reason I am getting fatal errors....since I got the new MSIBanner<br>I am on Win 2000<br>says it is generating an error log...do you know where the log is located...<br>It does compile properly...and your script example works fine<br>Strangely, resaving the nsi as a new file name made it work...<br>Then, I made some changes and recompiled...and started getting the fatal errors again<br>:(</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">grahama</span><br><span class="post-time small text-muted">25th January 2005 20:48 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">FYI, I am using variables in the text string like:<br>msibanner::update /NOUNLOAD "Checking for ${FILENAME}.ini"<br>or<br>msibanner::move 15 /NOUNLOAD "Checking for ${FILENAME}.ini"</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">grahama</span><br><span class="post-time small text-muted">25th January 2005 21:11 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">another note:<br>sometimes it compiles properly and runs....properly<br>if I try to launch the file manually, I get the fatal errors again</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">grahama</span><br><span class="post-time small text-muted">25th January 2005 21:27 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">went back to the previous MSIBANNER which does not produce the erros<br>do you have the latest MSIBANNER BEFORE the new changes were made ?<br>not sure if I have it<br><br>many thanks</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Joel</span><br><span class="post-time small text-muted">25th January 2005 21:34 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">send the changes your made.... :)</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">grahama</span><br><span class="post-time small text-muted">25th January 2005 21:56 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">thanks Lobo :)<br><a href="http://www.siren.cc/Univision/fonovisa/Library/nsis/MSIBANNER_error.zip" target="_blank">http://www.siren.cc/Univision/fonovi...NNER_error.zip</a><br>the main nsi is !Fonovisav5<br>the plugins are from the nsis plugin folder<br>I have made some alterations trying to find the bug...but basically get the same fatal error even though it compiles properly</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Joel</span><br><span class="post-time small text-muted">26th January 2005 14:35 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Hi grahama!<br><br>I read your code :)<br><br>Seems that when the plugin read this line:<br></p><pre>
<code><br>MSIBanner::UPDATE /NOUNLOAD 'User= "$R1"  AccountType= "$R2"  IsUserAdmin= "$R0"'<br></code>
</pre><br>
      can't continue.... watch the loop thing :)
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">JimInNH</span><br>
      <span class="post-time small text-muted">26th January 2005 15:15 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>Help using MSIBanner</strong><br>
      I am relatively new to the NSIS installer. I am trying to use your MSIBanner plugin to show progress.<br>
      <br>
      I put code in a function that controls a custom page. That code is the same as your demonstration and the function is attached.<br>
      <br>
      What I see is the msibanner dialog come up but it never gets any increments. At the very end it goes to 100% in one step and goes away, i guess on MSIBanner::destroy.<br>
      <br>
      Are there any other steps that must happen? Is MsiBanner designed to be used in another way?<br>
      <br>
      Thanks,<br>
      Jim McGlaughlin</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Joel</span><br>
      <span class="post-time small text-muted">26th January 2005 20:45 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Did you use Update, pos nor move functions?</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">JimInNH</span><br>
      <span class="post-time small text-muted">26th January 2005 22:17 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Here is the function:<br>
      <br>
      ;====================================================================<br>
      Function CustomInstallPageXXXX<br>
      <br>
      !insertmacro MUI_HEADER_TEXT "Installation Progress" "Line 2"<br>
      !insertmacro MUI_INSTALLOPTIONS_DISPLAY "Progress.ini"<br>
      <br>
      <br>
      ; Call MSIBanner show funtion to create both dialog and dialog title:<br>
      MSIBanner::Show /NOUNLOAD "${PROGNAME} Installer - Progress Monitor"<br>
      <br>
      ; Call MSIBanner Update function so, the text &amp; the progress bar will be...mmm, updated :p<br>
      MSIBanner::Update /NOUNLOAD "Reading known stuff from your PC"<br>
      ; Sleep a while, since we don't real reading let's see for a sec. the text ;)<br>
      Sleep 100<br>
      MSIBanner::Update /NOUNLOAD "Reading unknown stuff 1 from your PC"<br>
      Sleep 100<br>
      MSIBanner::Update /NOUNLOAD "Reading unknown stuff 2 from your PC"<br>
      Sleep 100<br>
      MSIBanner::Update /NOUNLOAD "Reading unknown stuff 3 from your PC"<br>
      Sleep 100<br>
      <br>
      ; Let's reset the progress bar...<br>
      MSIBanner::Reset /NOUNLOAD "Reseting values..."<br>
      <br>
      MSIBanner::Move /NOUNLOAD 20 "Countdown to destruction 5"<br>
      Sleep 100<br>
      MSIBanner::Move /NOUNLOAD 20 "Countdown to destruction 4"<br>
      Sleep 100<br>
      MSIBanner::Move /NOUNLOAD 20 "Countdown to destruction 3"<br>
      Sleep 100<br>
      MSIBanner::Move /NOUNLOAD 20 "Countdown to destruction 2"<br>
      Sleep 100<br>
      MSIBanner::Move /NOUNLOAD 20 "Countdown to destruction 1"<br>
      Sleep 100<br>
      <br>
      <br>
      MSIBanner::Reset /NOUNLOAD "Re-counting again...."<br>
      ; And... let's move the progress bar manually :)<br>
      Sleep 400<br>
      MSIBanner::Pos /NOUNLOAD 10 "Reading hardaware"<br>
      Sleep 400<br>
      MSIBanner::Pos /NOUNLOAD 25 "Reading memory"<br>
      Sleep 400<br>
      MSIBanner::Pos /NOUNLOAD 45 "Reading mouse"<br>
      Sleep 400<br>
      MSIBanner::Pos /NOUNLOAD 60 "Reading software"<br>
      Sleep 400<br>
      MSIBanner::Pos /NOUNLOAD 40 "wait... forgot keyboard"<br>
      Sleep 1000<br>
      MSIBanner::Pos /NOUNLOAD 70 "Reading CPU"<br>
      Sleep 400<br>
      MSIBanner::Pos /NOUNLOAD 90 "Finish ing global scoops..."<br>
      Sleep 400<br>
      ; last call and the progress bar will increase more:<br>
      MSIBanner::Pos /NOUNLOAD 100 "Cleaning...."<br>
      <br>
      ; MessageBox MB_OK "end of custom install"<br>
      <br>
      MSIBanner::Destroy<br>
      <br>
      <br>
      FunctionEnd</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Joel</span><br>
      <span class="post-time small text-muted">26th January 2005 23:23 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Sleep 1000 is equal to 1 sec... but 400 or 100? you do the math :D</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">grahama</span><br>
      <span class="post-time small text-muted">27th January 2005 03:28 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">many thanks Lobo for looking thru my code :)<br>
      that is a great help<br>
      <br>
      g</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">JimInNH</span><br>
      <span class="post-time small text-muted">27th January 2005 14:21 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">"Sleep 1000 is equal to 1 sec... but 400 or 100? you do the math "<br>
      <br>
      For a test I did not want to wait a full second between events. Is 1000 the minimum? I sent it to 400 milliseconds to speed up the test.</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Joel</span><br>
      <span class="post-time small text-muted">27th January 2005 14:25 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">No, is not the minimun, but the increasing of the progress bar is very quick, which also depends on the users machines. That's why I recommend one sec. of delay.... at least to see the bar info :)</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Joel</span><br>
      <span class="post-time small text-muted">1st February 2005 15:06 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Updated:<br>
      -Added <b>getHWND</b>. Which will get the handle(hwnd) of the dialog of MSIBanner.<br>
      -Added two more example files.<br>
      -I think the erros went out :)<br>
      <br>
      Test it :D</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">JimInNH</span><br>
      <span class="post-time small text-muted">1st February 2005 18:10 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Thank you, Thank you, Thank you!<br>
      <br>
      I am now able to launch MSIBanner in .oninit and hide the window immediately. Then in a later custom page I can show it and update it.<br>
      <br>
      Thanks, I needed that. Today is/was my deadline for getting and installer done and this avoids an unpleasant work around.<br>
      <br>
      This forum is great.</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">grahama</span><br>
      <span class="post-time small text-muted">1st February 2005 22:20 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">seems to work perfectly Lobo :)<br>
      no more crashes<br>
      way to go :)<br>
      g</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Joel</span><br>
      <span class="post-time small text-muted">1st February 2005 22:33 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Really? :D<br>
      <br>
      So, will be later on the web archive plus in my server... :)<br>
      <br>
      Thanks to you all for testing it.... ;)</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Takhir</span><br>
      <span class="post-time small text-muted">2nd February 2005 11:20 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Yes, no more crashes :)<br>
      But installer after banner still goes to background on Win2K :(</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Comperio</span><br>
      <span class="post-time small text-muted">2nd February 2005 18:15 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Is there any documentation for this? (I think it would be helpful for us all to know exactly what functions are available to test.)<br>
      <br>
      Great work on this, by the way!</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Joel</span><br>
      <span class="post-time small text-muted">2nd February 2005 21:17 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">erm... see examples? :|</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Comperio</span><br>
      <span class="post-time small text-muted">3rd February 2005 01:21 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">I just thought that perhaps you had more undocumented properties/procedures you'd like to have tested, but from the sounds of it, what's in the examples is all there is.<br>
      <br>
      In response to Takhir:<br></p>

      <blockquote>
        But installer after banner still goes to background on Win2K
      </blockquote>I've compiled all the included examples on my Win2K computer using NSIS 2.04 and did not see the same symptoms--the installer always stays in front. Were those tests done with the included example scripts or something different?
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Takhir</span><br>
      <span class="post-time small text-muted">3rd February 2005 07:35 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">This happens on my comp with all (3) included nsi examples. Win2K Server Rus, SP2, NSIS 2.04. Pentium II 400, 256 MB :)<br>
      I see installer page for a short time (~0.5 sec) in the foreground, but after this page goes to background, while it's task bar item continue flashing (focus not lost?).</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Comperio</span><br>
      <span class="post-time small text-muted">3rd February 2005 16:31 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">hmmm, Strange...<br>
      My PC is Win2k Pro w/ SP4. Do you think the SP might be the problem?<br>
      <br>
      (I'd test it, but unfortunately, I don't have any spare Win2k computers...)</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Takhir</span><br>
      <span class="post-time small text-muted">3rd February 2005 17:46 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">This may be slow comp...<br>
      BTW KichiK also wrote about background problem (4-th post of this thread).</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Joel</span><br>
      <span class="post-time small text-muted">3rd February 2005 20:19 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"></p>

      <blockquote>
        BTW KichiK also wrote about background problem
      </blockquote>Yes, but was before adding the feature ;)
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Comperio</span><br>
      <span class="post-time small text-muted">4th February 2005 04:28 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">I was experimenting with the banner on an XP pro computer and Win2K. I seem to get fairly consistant errors whenever I use a silent installer with the banner and a message box displaying with the .onInstSuccess callback.<br>
      <br>
      Here's a simplified example script:<br></p>
      <pre>
<code><br>!define PRODUCT "MSIBanner"<br><br>Name ${PRODUCT}<br>OutFile "${PRODUCT}2.exe"<br>ShowInstDetails show<br>;XPStyle on<br><br>Function .onInit<br>SetSilent silent<br>MSIBanner::Show /NOUNLOAD "NSIS Installer - ${PRODUCT}"<br>MSIBanner::Move /NOUNLOAD 20 "Countdown to destruction 5"<br>MSIBanner::Pos /NOUNLOAD 100 "Cleaning...."<br>FunctionEnd<br><br>Function .onInstSuccess<br>   MessagebOX MB_OK "DONE!"<br>FunctionEnd<br><br>Section -default<br>MSIBanner::Destroy<br>DetailPrint "Works great!"<br>SectionEnd<br></code>
</pre><br>
      <br>
      If I remove the calls to MSIBanner, it seems to work fine. It also seems to be ok if I REM the SetSilent line. (Example error is attached.)
    </div>
    <hr>
    
    
    <!--[if lt IE 9]><script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script><script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script><![endif]-->

    <div class="container">
      

      <ol class="breadcrumb">
        <li><a href="../index.html" class="glyphicon glyphicon-home"></a></li>

        <li><a href="f-65.html">NSIS Discussion</a></li>

        <li class="active">MSIBanner - newest plugin</li>
      </ol>

      <p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=196991">MSIBanner - newest plugin</a></p><br>

      <div class="post">
        <p class="post-meta"><span class="post-author text-primary">Joel</span><br>
        <span class="post-time small text-muted">4th February 2005 14:33 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

        <p class="post-content">Of course... there aren't windows or dialogs which the banner attached to it...<br>
        <br>
        The MSIBanner isn't a standalone one ;)<br>
        Needs a parent window.<br>
        <br>
        BIG EDIT:<br>
        Just test the code ... and I don't get any errors:<br></p>
        <pre>
<code><br>!define PRODUCT "MSIBanner"<br><br>Name ${PRODUCT}<br>OutFile "${PRODUCT}2.exe"<br>ShowInstDetails show<br>;XPStyle on<br><br>Function .onInit<br>SetSilent silent<br>MSIBanner::Show /NOUNLOAD "NSIS Installer - ${PRODUCT}"<br>Sleep 1000<br>MSIBanner::Move /NOUNLOAD 20 "Countdown to destruction 5"<br>Sleep 1000<br>MSIBanner::Pos /NOUNLOAD 100 "Cleaning...."<br>Sleep 1000<br>FunctionEnd<br><br>Function .onInstSuccess<br>   MessagebOX MB_OK "DONE!"<br>FunctionEnd<br><br>Section -default<br>MSIBanner::Destroy<br>DetailPrint "Works great!"<br>SectionEnd<br></code>
</pre><br>
        Be sure to have the lastest version of the MSIBanner...<br>
        WOW! Works even in silent mode :up:
      </div>
      <hr>

      <div class="post">
        <p class="post-meta"><span class="post-author text-primary">Comperio</span><br>
        <span class="post-time small text-muted">4th February 2005 20:45 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

        <p class="post-content">Your explanation makes perfect sense! (And once you do it right, it works like a charm!)<br>
        ;)<br>
        Thanks!</p>
      </div>
      <hr>

      <div class="post">
        <p class="post-meta"><span class="post-author text-primary">Comperio</span><br>
        <span class="post-time small text-muted">14th February 2005 15:33 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

        <p class="post-content">2 new questions:<br>
        I have situations where I launch applications during an install. The applications I use a banner page that displays while the app is initializing. The problem is that the banner of the other apps covers MSI Banner's window.<br>
        <br>
        Is it possible to force the MSI Banner to the top of all other windows? Or is it posible to set the position of MSI Banner on the screen?</p>
      </div>
      <hr>

      <div class="post">
        <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br>
        <span class="post-time small text-muted">14th February 2005 16:41 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

        <p class="post-content">Try using BringToFront to bring the installer to the top.<br>
        <br>
        -Stu</p>
      </div>
      <hr>

      <div class="post">
        <p class="post-meta"><span class="post-author text-primary">Joel</span><br>
        <span class="post-time small text-muted">14th February 2005 20:28 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

        <p class="post-content"></p>

        <blockquote>
          Is it possible to force the MSI Banner to the top of all other windows?
        </blockquote>Do what Stu said :D<br>
        <pre>
<code><br>Or is it posible to set the position of MSI Banner on the screen?<br></code>
</pre><br>
        Maybe on next release ;)
      </div>
      <hr>

      <div class="post">
        <p class="post-meta"><span class="post-author text-primary">Comperio</span><br>
        <span class="post-time small text-muted">14th February 2005 20:31 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

        <p class="post-content">Thanks guys!</p>
      </div>
      <hr>

      <div class="post">
        <p class="post-meta"><span class="post-author text-primary">Yathosho</span><br>
        <span class="post-time small text-muted">30th July 2006 10:47 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

        <p class="post-content">could you make it support InstallColors and InstProgressFlags in future?</p>
      </div>
      <hr>

      <div class="post">
        <p class="post-meta"><span class="post-author text-primary">Yathosho</span><br>
        <span class="post-time small text-muted">30th July 2006 12:52 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

        <p class="post-content"></p>

        <blockquote>
          <i>Originally posted by Joel</i><br>
          <b>The MSIBanner isn't a standalone one ;)<br>
          Needs a parent window.</b>
        </blockquote>i take it that's why the attached example doesn't work?
      </div>
      <hr>

      <div class="footer">
        <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
      </div>
    </div><script src="../js/highlight.pack.js" type="text/javascript">
</script> <script type="text/javascript">
//<![CDATA[
    hljs.initHighlightingOnLoad();
    //]]></script></div></body></html>