<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="description" content="InstallDirRegKey does not work for me."><title>InstallDirRegKey does not work for me. - NSIS Forums</title><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script><link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css"><link rel="stylesheet" href="../css/style.css" type="text/css"></head><body><div class="container"><ol class="breadcrumb"><li><a href="../index.html" class="glyphicon glyphicon-home"></a></li><li><a href="f-65.html">NSIS Discussion</a></li><li class="active">InstallDirRegKey does not work for me.</li></ol><p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=150325">InstallDirRegKey does not work for me.</a></p><br><div class="post"><p class="post-meta"><span class="post-author text-primary">lll2008</span><br><span class="post-time small text-muted">24th September 2003 23:31 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>InstallDirRegKey does not work for me.</strong><br>I am a new user of NSIS (just started to play with it today). I used:<br><br>InstallDirRegKey HKLM "SYSTEM\CurrentControlSet\Control\ServiceProvider\ServiceTypes\Microsoft Internet Information Server" ""<br><br>or<br><br>HKLM "SYSTEM\CurrentControlSet\Control\ServiceProvider\ServiceTypes" "Microsoft Internet Information Server"<br><br>to check if iis has been installed, but neither worked for me. I am sure the key is there! I also tried to add a key to SOFTWARE, and InstallDirKey did not work for me either. Please refer to my script file (attached).<br><br>Could you tell me what the problem is? Or any suggestion on this?<br><br>Thank you in advance!<br><br>li</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Vytautas</span><br><span class="post-time small text-muted">25th September 2003 00:29 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Which version of NSIS are you using?<br><br>Vytautas</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">lll2008</span><br><span class="post-time small text-muted">25th September 2003 14:55 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Hi Vytautas, I am using NSIS 2.0 Beta 3a - Released March 15, 2003.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Joost Verburg</span><br><span class="post-time small text-muted">25th September 2003 16:02 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">What exactly do you want to do? InstallDirRegKey gets a folder from the registry.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">lll2008</span><br><span class="post-time small text-muted">29th September 2003 15:36 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Hi Joost,<br>I am trying to check if iis is installed before I install my components. I suppose if the iis key is there InstallDirRegKey HKLM "SYSTEM\CurrentControlSet\Control\ServiceProvider\ServiceTypes\Microsoft Internet Information Server" "" will return a folder to INSTDIR, otherwise INSTDIR will be empty. But apprently this does not work for me. Even though the key is there, the InstallDirRegKey still returns an empty string. Please check the attachement in my first post.<br><br>Any suggestion?<br><br>Thanks,</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">kichik</span><br><span class="post-time small text-muted">29th September 2003 15:43 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Are you sure it contains a valid directory path? If it doesn't contain a valid directory path, nothing will get into $INSTDIR. If you want to read this value, which is not a directory path, you should use ReadRegStr and not InstallDirRegKey.<br><br>BTW, you can use RegDLL instead of executing regsvr32 which doesn't exist on every Windows machine.</p></div><hr><div class="footer"><p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p></div></div><script src="../js/highlight.pack.js" type="text/javascript"></script><script type="text/javascript">//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]></script></body></html>