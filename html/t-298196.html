<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="description" content="Welcome/Finish pages not displaying in Windows Vista"><title>Welcome/Finish pages not displaying in Windows Vista - NSIS Forums</title><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script><link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css"><link rel="stylesheet" href="../css/style.css" type="text/css"><!--[if lt IE 9]><script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script><script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script><![endif]--></head><body><div class="container"><ol class="breadcrumb"><li><a href="../index.html" class="glyphicon glyphicon-home"></a></li><li><a href="f-65.html">NSIS Discussion</a></li><li class="active">Welcome/Finish pages not displaying in Windows Vista</li></ol><p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=298196">Welcome/Finish pages not displaying in Windows Vista</a></p><br><div class="post"><p class="post-meta"><span class="post-author text-primary">jossie</span><br><span class="post-time small text-muted">4th October 2008 03:04 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>Welcome/Finish pages not displaying in Windows Vista</strong><br>I was running my installer under Windows XP and it was running fine. Under Vista however, the Welcome and Finish pages don't display. I thought it could be due to the custom modern.exe I was running so then I compiled the following sample script, and it still didn't display the welcome/finish pages in Vista. Does anyone have any ideas?<br><br></p><blockquote>;NSIS Modern User Interface<br>;Welcome/Finish Page Example Script<br>;Written by Joost Verburg<br><br>;--------------------------------<br>;Include Modern UI<br><br>!include "MUI2.nsh"<br><br>;--------------------------------<br>;General<br><br>;Name and file<br>Name "Modern UI Test"<br>OutFile "WelcomeFinish.exe"<br><br>;Default installation folder<br>InstallDir "$LOCALAPPDATA\Modern UI Test"<br><br>;Get installation folder from registry if available<br>InstallDirRegKey HKCU "Software\Modern UI Test" ""<br><br>;Request application privileges for Windows Vista<br>RequestExecutionLevel user<br><br>;--------------------------------<br>;Interface Settings<br><br>!define MUI_ABORTWARNING<br><br>;--------------------------------<br>;Pages<br><br>!insertmacro MUI_PAGE_WELCOME<br>!insertmacro MUI_PAGE_LICENSE "${NSISDIR}\Docs\Modern UI\License.txt"<br>!insertmacro MUI_PAGE_COMPONENTS<br>!insertmacro MUI_PAGE_DIRECTORY<br>!insertmacro MUI_PAGE_INSTFILES<br>!insertmacro MUI_PAGE_FINISH<br><br>!insertmacro MUI_UNPAGE_WELCOME<br>!insertmacro MUI_UNPAGE_CONFIRM<br>!insertmacro MUI_UNPAGE_INSTFILES<br>!insertmacro MUI_UNPAGE_FINISH<br><br>;--------------------------------<br>;Languages<br><br>!insertmacro MUI_LANGUAGE "English"<br><br>;--------------------------------<br>;Installer Sections<br><br>Section "Dummy Section" SecDummy<br><br>SetOutPath "$INSTDIR"<br><br>;ADD YOUR OWN FILES HERE...<br><br>;Store installation folder<br>WriteRegStr HKCU "Software\Modern UI Test" "" $INSTDIR<br><br>;Create uninstaller<br>WriteUninstaller "$INSTDIR\Uninstall.exe"<br><br>SectionEnd<br><br>;--------------------------------<br>;Descriptions<br><br>;Language strings<br>LangString DESC_SecDummy ${LANG_ENGLISH} "A test section."<br><br>;Assign language strings to sections<br>!insertmacro MUI_FUNCTION_DESCRIPTION_BEGIN<br>!insertmacro MUI_DESCRIPTION_TEXT ${SecDummy} $(DESC_SecDummy)<br>!insertmacro MUI_FUNCTION_DESCRIPTION_END<br><br>;--------------------------------<br>;Uninstaller Section<br><br>Section "Uninstall"<br><br>;ADD YOUR OWN FILES HERE...<br><br>Delete "$INSTDIR\Uninstall.exe"<br><br>RMDir "$INSTDIR"<br><br>DeleteRegKey /ifempty HKCU "Software\Modern UI Test"<br><br>SectionEnd</blockquote></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">kichik</span><br><span class="post-time small text-muted">4th October 2008 10:50 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">That works fine for me on both XP and Vista. Any different programs installed on the Vista machine that might make the difference?</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">jossie</span><br><span class="post-time small text-muted">7th October 2008 00:02 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Its a pretty clean install of Vista Enterprise Edition SP1. The only other software installed on the machine is McAfee VirusScan Enterprise and McAfee AntiSpyware Enterprise.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">kichik</span><br><span class="post-time small text-muted">7th October 2008 07:09 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Try disabling both.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">jossie</span><br><span class="post-time small text-muted">9th October 2008 00:32 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Ok so the problem was definitely McAfee VirusScan Enterprise.<br><br>With it running no NSIS based installers (including the installer for NSIS) would should the welcome/finish pages.<br><br>I uninstalled the VirusScan application, and the Welcome/Finish pages started showing up again. (the antispyware application is still running).</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Animaether</span><br><span class="post-time small text-muted">9th October 2008 01:56 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">I'm clueless on this, but... are you saying that the -other- pages do display? I.e. it essentially skips the welcome page and goes straight to whatever the next page in line is?<br><br>Or are you saying that the installer refuses to run -if- you have a welcome and/or finish page?</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">kichik</span><br><span class="post-time small text-muted">9th October 2008 07:04 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">I guess it's a false positive on nsDialogs.dll. Try scanning nsDialogs.dll manually and see what it says.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Joost Verburg</span><br><span class="post-time small text-muted">9th October 2008 11:46 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">I don't have any problems with this virus scanner. Did you update your DAT files?</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">jossie</span><br><span class="post-time small text-muted">10th October 2008 23:46 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Specifically the welcome/finish pages didn't display, but the rest of the installer did.<br><br>I had to convince the IT department to let me uninstall the virus scanner since they wouldn't let me disable it (since that would mean they would have to provide me the password for it). After uninstalling mcafee the issue went away (as I said earlier). Now the interesting bit is I reinstalled the installer and updated the DAT files, and the installer was still working fine.<br><br>The only theory I can come up with is that this machine was an upgrade from XP to Vista. Somehow during the upgrade process Mcafee got messed up?<br><br>Thanks for everyone's help.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Joost Verburg</span><br><span class="post-time small text-muted">11th October 2008 12:59 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">The previous DAT files probably contained an error causing a false virus detection in an NSIS plug-in. The update of the DAT files has resolved this issue.</p></div><hr><div class="footer"><p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p></div></div><script src="../js/highlight.pack.js" type="text/javascript"></script><script type="text/javascript">//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]></script></body></html>