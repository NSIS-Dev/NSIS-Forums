<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="User Directory in Vista" />

  <title>User Directory in Vista - NSIS Forums</title><!-- Bootstrap core CSS -->
  <link rel="stylesheet" type="text/css" href="//netdna.bootstrapcdn.com/bootswatch/3.0.1/readable/bootstrap.min.css" />
  <link rel="stylesheet" href="../css/style.css" type="text/css" /><!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!--[if lt IE 9]>
                <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
                <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->
</head>

<body>
  <div class="container">
    <!-- Put navigation bar here -->

    <ol class="breadcrumb">
      <li><a href="../index.html" class="glyphicon glyphicon-home"></a></li>

      <li><a href="f-65.html">NSIS Discussion</a></li>

      <li class="active">User Directory in Vista</li>
    </ol>

    <p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=270582">User Directory in Vista</a></p><br />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">MikeInVancouver</span><br />
      <span class="post-time small text-muted">3rd May 2007 23:46 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>User Directory in Vista</strong><br />
      I have run into a problem with Vista when the unistall is run. The files in the installation directory are all removed without a problem, but Vista has decided to make copies of the data files used by the application. So after an uninstall is run and the application is reinstalled in the same location for some reason the application looks for the copies first??????? (gotta love Vista). I need to remove these files on uninstall, but they exist in the users folder structure, specifically: c:\Users\"username"\AppData\Local\VirtualStore\Program Files\MyProgram\myprogram.exe<br />
      <br />
      So what I am trying to get is the Window users name so I can remove the appropiate folders.<br />
      <br />
      Any help is appreciated.<br />
      <br />
      Sorry for the long winded question but I thought others might be having a similar problem and I wanted it to be understood by all.<br />
      <br />
      Thank you,<br />
      <br />
      Mike</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Anders</span><br />
      <span class="post-time small text-muted">3rd May 2007 23:55 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">System::Call "advapi32::GetUserName(t.r0,*i ${NSIS_MAX_STRLEN})i"<br />
      DetailPrint "User name - $0"<br />
      <br />
      If you want to write to program files you should add a manifest to your application telling vista it needs to run it as admin or save your users data in a folder where a normal user has access (Appdata or My documents etc)</p>
    </div>
    <hr />

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]>
  </script>
</body>
</html>
