<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="How to add an icon to a URL shortcut?" />

  <title>How to add an icon to a URL shortcut? - NSIS Forums</title><!-- Bootstrap core CSS -->
  <link rel="stylesheet" type="text/css" href="//netdna.bootstrapcdn.com/bootswatch/3.0.1/readable/bootstrap.min.css" />
  <link rel="stylesheet" href="../css/style.css" type="text/css" /><!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!--[if lt IE 9]>
                <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
                <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->
</head>

<body>
  <div class="container">
    <!-- Put navigation bar here -->

    <ol class="breadcrumb">
      <li><a href="../index.html" class="glyphicon glyphicon-home"></a></li>

      <li><a href="f-65.html">NSIS Discussion</a></li>

      <li class="active">How to add an icon to a URL shortcut?</li>
    </ol>

    <p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=326263">How to add an icon to a URL shortcut?</a></p><br />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">ScotK</span><br />
      <span class="post-time small text-muted">21st January 2011 03:05 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>How to add an icon to a URL shortcut?</strong><br />
      Here's my code so far but it puts an IE looking page icon on my desktop instead of the red.ico file that I want on the desktop. How do I make the actual desktop icon work?<br />
      <br />
      WriteINIStr "$DESKTOP\$(^Name).url" "InternetShortcut" "${NSISDIR}\Contrib\Graphics\Icons\red.ico" "www.MyDomain.com/MyPage.html"<br />
      <br />
      Thanks!</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">jpderuiter</span><br />
      <span class="post-time small text-muted">21st January 2011 08:19 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><a href="http://nsis.sourceforge.net/CreateInternetShortcut_macro_%26_function" target="_blank">http://nsis.sourceforge.net/CreateIn...o_%26_function</a></p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Anders</span><br />
      <span class="post-time small text-muted">21st January 2011 14:38 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">${NSISDIR} is a path on the system you compile on and can NOT be used in a shortcut, you must copy the icon to the users system and then use a path like "$instdir\youricon.ico"</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
      <span class="post-time small text-muted">21st January 2011 16:32 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Yes and you're not creating the .url file correctly anyway. Check that link jpderuiter posted. And yes the icon must exist on the destination machine so you should either extract one specially or use your application executable's icon (might need ,0 at the end of the icon path).<br />
      <br />
      Stu</p>
    </div>
    <hr />

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]>
  </script>
</body>
</html>
