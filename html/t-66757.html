<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="Add/remove progrrams" />

  <title>Add/remove progrrams - NSIS Forums</title><!-- Bootstrap core CSS -->
  <link rel="stylesheet" type="text/css" href="//netdna.bootstrapcdn.com/bootswatch/3.0.1/readable/bootstrap.min.css" />
  <link rel="stylesheet" href="../css/style.css" type="text/css" /><!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!--[if lt IE 9]>
                <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
                <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->
</head>

<body>
  <div class="container">
    <!-- Put navigation bar here -->

    <ol class="breadcrumb">
      <li><a href="../index.html" class="glyphicon glyphicon-home"></a></li>

      <li><a href="f-65.html">NSIS Discussion</a></li>

      <li class="active">Add/remove progrrams</li>
    </ol>

    <p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=66757">Add/remove progrrams</a></p><br />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">aquarii</span><br />
      <span class="post-time small text-muted">26th November 2001 20:21 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>Add/remove progrrams</strong><br />
      NSIS newbie here -- I am using NSIS to deliver my app. I would like to have an entry in the add/remove programs window for my app. Right now I run the installer and it does not show up in add/remove.. How can I right this wrong?</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">mgentry</span><br />
      <span class="post-time small text-muted">26th November 2001 22:25 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">In your installer, do this:<br />
      WriteRegStr HKEY_LOCAL_MACHINE "Software\Microsoft\Windows\CurrentVersion\Uninstall\YourProductHere" "DisplayName" "Your Product"<br />
      <br />
      WriteRegStr HKEY_LOCAL_MACHINE "Software\Microsoft\Windows\CurrentVersion\Uninstall\YourProductHere" "UninstallString" "uninst.exe"<br />
      <br />
      The first is the text displayed in the Add/Remove dialog, the 2nd is the command line to execute.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">dbareis</span><br />
      <span class="post-time small text-muted">27th November 2001 07:14 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">You can do a much better job than just set up the basic items, I have extracted some code out of my header (this will add "support information" with web links etc - formatting stuffed up):<br />
      <br />
      ;--- Set up the uninstall (and add/remove program) Information --------------<br />
      &lt;$NsisCmt "Specify ADD/REMOVE Programs Info"&gt;<br />
      &lt;$WriteReg SUBKEY="&lt;$MachKeyUninstall&gt;" KEY="UninstallString" VALUE="&lt;$UninstallEXEThere&gt;"&gt;<br />
      &lt;$WriteReg SUBKEY="&lt;$MachKeyUninstall&gt;" KEY="DisplayName" VALUE="&lt;$DisplayName&gt;"&gt;<br />
      &lt;$WriteReg SUBKEY="&lt;$MachKeyUninstall&gt;" KEY="DisplayIcon" VALUE="&lt;$UninstallIcon&gt;"&gt;<br />
      &lt;$WriteReg SUBKEY="&lt;$MachKeyUninstall&gt;" KEY="DisplayVersion" VALUE="&lt;$ProductVersion&gt; (&lt;$PackagedWhen&gt;)"&gt;<br />
      #ifdef HelpLink<br />
      &lt;$WriteReg SUBKEY="&lt;$MachKeyUninstall&gt;" KEY="HelpLink" VALUE="&lt;$HelpLink&gt;"&gt;<br />
      #endif<br />
      #ifdef Publisher<br />
      &lt;$WriteReg SUBKEY="&lt;$MachKeyUninstall&gt;" KEY="Publisher" VALUE="&lt;$Publisher&gt;"&gt;<br />
      #endif<br />
      #ifdef Comments<br />
      #RexxVar RxComments = ^&lt;$Comments&gt;^<br />
      #DefineRexx ''<br />
      ;--- Work around Windows bug #1,456,321 ------------------------------<br />
      RxComments = ReplaceString(RxComments, '"', "'");<br />
      #DefineRexx<br />
      &lt;$WriteReg SUBKEY="&lt;$MachKeyUninstall&gt;" KEY="Comments" VALUE="&lt;??RxComments&gt;"&gt;<br />
      #endif<br />
      #ifndef NSIS_NO_README<br />
      ;--- If local readme exists assume it will in the "INSTDIR" as well ------<br />
      #define? ReadmeFileHere &lt;$ProductName&gt;.txt<br />
      #define? ReadmeFileThere $INSTDIR\&lt;$ReadmeFileHere&gt;<br />
      &lt;$NsisCmt "Want the readme in the package"&gt;<br />
      #DependsOn INPUT "&lt;$ReadmeFileHere&gt;"<br />
      &lt;$FILE "&lt;$ReadmeFileHere&gt;"&gt;<br />
      <br />
      ;--- Add to Uninstall Information ----------------------------------------<br />
      #ifndef NSIS_NO_README_IN_ADD_REMOVE<br />
      #DefineRexx ''<br />
      ArFile = ReplaceString('&lt;$ReadmeFileThere&gt;', ':', '|');<br />
      ArFile = 'file:///' || ArFile;<br />
      #DefineRexx<br />
      &lt;$WriteReg SUBKEY="&lt;$MachKeyUninstall&gt;" KEY="Readme" VALUE="&lt;??ArFile&gt;"&gt;<br />
      #endif<br />
      <br />
      <br />
      There are some other keys but from what I can see of limited use.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">vajuras</span><br />
      <span class="post-time small text-muted">2nd December 2001 01:15 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>awesome!</strong><br /></p>

      <blockquote>
        <i>Originally posted by mgentry</i><br />
        <b>In your installer, do this:<br />
        WriteRegStr HKEY_LOCAL_MACHINE "Software\Microsoft\Windows\CurrentVersion\Uninstall\YourProductHere" "DisplayName" "Your Product"<br />
        <br />
        WriteRegStr HKEY_LOCAL_MACHINE "Software\Microsoft\Windows\CurrentVersion\Uninstall\YourProductHere" "UninstallString" "uninst.exe"<br />
        <br />
        The first is the text displayed in the Add/Remove dialog, the 2nd is the command line to execute.</b>
      </blockquote>Thanks, these few lines helped me achieve the one thing I didn't like bout my installer.
    </div>
    <hr />

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]>
  </script>
</body>
</html>
