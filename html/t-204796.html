<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="How do you ReadINIStr &amp; nsExec::ExecToLog one line with a few parameters?" />

  <title>How do you ReadINIStr &amp; nsExec::ExecToLog one line with a few parameters? - NSIS Forums</title>
  <script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script>
  <!-- Bootstrap core CSS -->

  <link rel="stylesheet" type="text/css" href="//netdna.bootstrapcdn.com/bootswatch/3.0.1/readable/bootstrap.min.css" />
  <link rel="stylesheet" href="../css/style.css" type="text/css" /><!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!--[if lt IE 9]>
                <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
                <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->
</head>

<body>
  <div class="container">
    <!-- Put navigation bar here -->

    <ol class="breadcrumb">
      <li><a href="../index.html" class="glyphicon glyphicon-home"></a></li>

      <li><a href="f-65.html">NSIS Discussion</a></li>

      <li class="active">How do you ReadINIStr &amp; nsExec::ExecToLog one line with a few parameters?</li>
    </ol>

    <p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=204796">How do you ReadINIStr &amp; nsExec::ExecToLog one line with a few parameters?</a></p><br />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">vbgunz</span><br />
      <span class="post-time small text-muted">13th January 2005 09:58 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>How do you ReadINIStr &amp; nsExec::ExecToLog one line with a few parameters?</strong><br />
      I've tried doing the following which should really be easy but which is proving to be so frustrating. I've tried so many combinations of the following, it got me sick :(<br />
      <br />
      I am trying to read an ini value then feed it into a cmd fired by nsExec::ExecToLog. I've tried so many different combinations, I am tired :( The pasted code below is what I feel should be dead on the money.</p>
      <pre>
<code><br />ReadEnvStr $0 COMSPEC<br />ReadINIStr $1 $INSTDIR\madman.ini "field 1" state<br />nsExec::ExecToLog '$0 /C $\"$INSTDIR\psychopath.exe$\" -r $\"$INSTDIR\hysteria.log$\" /$1 /$1'</code>
</pre>When I say I've tried so many things I mean it. Look at the above code... I've tried without exaggeration maybe forty or more different combinations. I finally got tired :(<br />
      <br />
      I just don't see whats going wrong... *sigh*. I'll try to remember a long list of errors and make this quick. Either (A) NSIS wont read it upon install OR (B) It will log the DOS splash screen (MS COPYRIGHT,etc) and nothing else OR (C) It will tell me C:\Program is not a program, etc OR (D) I can only get the first of the code to work
      <pre>
<code><br />nsExec::ExecToLog '$0 /C $\"$INSTDIR\psychopath.exe$\"</code>
</pre><br />
      <br />
      The entire line of code above (-minus NSIS format) direct into the cmdline works perfect without hiccup. Yet I must be getting the format horribly wrong. Can someone please help shine some light on my problem?<br />
      <br />
      Thank you for your time!
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Takhir</span><br />
      <span class="post-time small text-muted">13th January 2005 10:11 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">ReadINIStr $1 "$INSTDIR\madman.ini" "field 1" "state"<br />
      <br />
      INSTDIR includes blank spaces, this is why c:\program is not a program. ;)<br />
      MessageBox also helps to debug (after every statement :) )<br />
      Are you really sure you need this cmd line beginning?<br />
      "E:\WINNT\system32\cmd.exe /C ..."<br />
      nsExec works without this.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">vbgunz</span><br />
      <span class="post-time small text-muted">13th January 2005 14:45 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Thank you for pointing that out. I am not sure why I've been using comspec but remember faintly it being because it was supposed to be a sure fire way to find the cmd :)<br />
      <br />
      After 3 hours of sleep and my baby waking me up, I checked this thread, got back to work on it and got it to work. I removed code like you suggested and all seems well.<br />
      <br />
      Thank you for your help and time Takhir!</p>
    </div>
    <hr />

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]>
  </script>
</body>
</html>
