<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="description" content="Some files are copied to c:\ instead to the install dir"><title>Some files are copied to c:\ instead to the install dir - NSIS Forums</title><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script><link rel="preload" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css" as="style" onload="this.rel='stylesheet'"><link rel="preload" href="../css/style.css" as="style" onload="this.rel='stylesheet'"><noscript><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css"><link rel="stylesheet" href="../css/style.css"></noscript><script>!function(a){"use strict";var b=function(b,c,d){function e(a){return h.body?a():void setTimeout(function(){e(a)})}function f(){i.addEventListener&&i.removeEventListener("load",f),i.media=d||"all"}var g,h=a.document,i=h.createElement("link");if(c)g=c;else{var j=(h.body||h.getElementsByTagName("head")[0]).childNodes;g=j[j.length-1]}var k=h.styleSheets;i.rel="stylesheet",i.href=b,i.media="only x",e(function(){g.parentNode.insertBefore(i,c?g:g.nextSibling)});var l=function(a){for(var b=i.href,c=k.length;c--;)if(k[c].href===b)return a();setTimeout(function(){l(a)})};return i.addEventListener&&i.addEventListener("load",f),i.onloadcssdefined=l,l(f),i};"undefined"!=typeof exports?exports.loadCSS=b:a.loadCSS=b}("undefined"!=typeof global?global:this);!function(a){if(a.loadCSS){var b=loadCSS.relpreload={};if(b.support=function(){try{return a.document.createElement("link").relList.supports("preload")}catch(b){return!1}},b.poly=function(){for(var b=a.document.getElementsByTagName("link"),c=0;c<b.length;c++){var d=b[c];"preload"===d.rel&&"style"===d.getAttribute("as")&&(a.loadCSS(d.href,d,d.getAttribute("media")),d.rel=null)}},!b.support()){b.poly();var c=a.setInterval(b.poly,300);a.addEventListener&&a.addEventListener("load",function(){b.poly(),a.clearInterval(c)}),a.attachEvent&&a.attachEvent("onload",function(){a.clearInterval(c)})}}}(this);</script></head><body><div class="container"><ol class="breadcrumb"><li><a href="../index.html" class="glyphicon glyphicon-home"></a></li><li><a href="f-65.html">NSIS Discussion</a></li><li class="active">Some files are copied to c:\ instead to the install dir</li></ol><p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=159538">Some files are copied to c:\ instead to the install dir</a></p><br><div class="post"><p class="post-meta"><span class="post-author text-primary">premm</span><br><span class="post-time small text-muted">13th December 2003 09:01 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>Some files are copied to c:\ instead to the install dir</strong><br>Its strange, some useres report that DeskCalc.exe file was sent to root directory (c:\), but the uninstall programs (Uninstall.exe and uninst-nsis.exe) were sent to the right directory (c:\Program Files\DeskCalc Pro) along with the help subdirectory (French and English help files).<br><br>Here's the script, can anybody help me with this, i'am using 2.0Beta3<br><br>Thank you<br>Mario<br><br>;--------------------------------<br>;Installer Sections<br><br>Section "Deskcalc.exe" SecCopyUI<br><br>;Add your stuff here<br>SetOutPath "$INSTDIR"<br><br>File "lizenz.txt"<br>File "f:\Projects\DeskCalc.uk\TaxCalc___Win32_Release_englisch\deskcalc.exe"<br>File "f:\PROJECTS\DeskCalc.uk\Taxcalc.bat"<br>File "f:\PROJECTS\DeskCalc.uk\wait.exe"<br><br>SetOutPath "$INSTDIR\HELP"<br>File "f:\PROJECTS\DeskCalc.uk\help\deskcalc_uk.chm"<br>File "f:\PROJECTS\DeskCalc.uk\help\deskcalc_fr.chm"<br>File "f:\PROJECTS\DeskCalc.uk\help\deskcalc_basics.swf"<br>File "f:\PROJECTS\DeskCalc.uk\help\deskcalc_basics.html"<br><br>;Add your stuff here<br>WriteUninstaller "$INSTDIR\Uninstall.exe"<br><br>SetOutPath "$INSTDIR"<br><br>SectionEnd</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br><span class="post-time small text-muted">13th December 2003 10:51 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">You might want to upgrade to b4 and see if that fixes the problem.<br><br>-Stu</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">premm</span><br><span class="post-time small text-muted">13th December 2003 11:19 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">thanks, but does anyone know that this bug is fixed in B4 ?</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">kichik</span><br><span class="post-time small text-muted">13th December 2003 13:04 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">I know no such bug. Please attach the entire script.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">premm</span><br><span class="post-time small text-muted">13th December 2003 13:09 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">here it is, its really strange, this problem happens only on some<br>machine. i haven't seen that myself, so i cannt reproduce it.<br><br>script is attached !<br><br>thanks<br>mario</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">kichik</span><br><span class="post-time small text-muted">13th December 2003 13:29 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">You have some errors in your script. You have mixed code from makensis.nsi with your own code. You write to the NSIS registry key instead into your own:</p><pre>
<code>WriteRegStr HKLM SOFTWARE\NSIS "" $INSTDIR</code>
</pre>You create uninst-nsis.exe again after you've created Uinstall.exe:<pre>
<code>WriteUninstaller $INSTDIR\uninst-nsis.exe</code>
</pre>And you still read $INSTDIR from your own registry key though you don't write anything there:<pre>
<code>InstallDirRegKey HKCU "Software\${MUI_PRODUCT}" ""</code>
</pre>Those users probably had a previous installation of your product which wrote something to that registry key on its own. NSIS probably read that key, got the wrong directory from and installed the files in there. The wrong directory in their case was the root directory.<br><br>You also get the desktop dirctory using the wrong method. You should use $DESKTOP and not $SMPROGRAMS\..\.. which might not always work. You also forgot to quote the paths in ExecShell.<br><br>Try the attached file with b4 or the latest CVS version.</div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">premm</span><br><span class="post-time small text-muted">13th December 2003 14:33 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">thank you,<br><br>i'll try that!</p></div><hr><div class="footer"><p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p></div></div><script src="../js/highlight.pack.js" type="text/javascript"></script><script type="text/javascript">//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]></script></body></html>