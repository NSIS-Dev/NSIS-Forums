<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="win98 registry changes ignored until reboot?" />

  <title>win98 registry changes ignored until reboot? - NSIS Forums</title>
  <script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script>
  <!-- Bootstrap core CSS -->

  <link rel="stylesheet" type="text/css" href="//netdna.bootstrapcdn.com/bootswatch/3.0.1/readable/bootstrap.min.css" />
  <link rel="stylesheet" href="../css/style.css" type="text/css" /><!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!--[if lt IE 9]>
                <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
                <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->
</head>

<body>
  <div class="container">
    <!-- Put navigation bar here -->

    <ol class="breadcrumb">
      <li><a href="../index.html" class="glyphicon glyphicon-home"></a></li>

      <li><a href="f-65.html">NSIS Discussion</a></li>

      <li class="active">win98 registry changes ignored until reboot?</li>
    </ol>

    <p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=122171">win98 registry changes ignored until reboot?</a></p><br />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Darker</span><br />
      <span class="post-time small text-muted">20th January 2003 19:03 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>win98 registry changes ignored until reboot?</strong><br />
      ;) Background:<br />
      Part of an installer I'm creating that runs via a login script installs a screen saver.<br />
      <br />
      Win2k and Win98 both use the same key to specify the 'wait' period before the screen saver kicks in. Here's the command I'm using to set it.<br />
      <br />
      WriteRegStr HKCU "Control Panel\Desktop" "ScreenSaveTimeOut" "240"<br />
      <br />
      :up: Works fine in 2k, takes effect immediately.<br />
      <br />
      :cry: Problem:<br />
      In win98, this registry setting doesn't take effect until the user logs out and back in.<br />
      <br />
      i.e. If you change it to 4 minutes from 10 minutes via the above script command, then open the Desktop properties, the screen saver 'wait' period is still 10 minutes. At the next login, win98 picks up the new setting from the registry and all is well.<br />
      <br />
      :hang: I don't want users to have to re-log to get this set.<br />
      <br />
      Anybody know of a way to force some kind of scriptable 'refresh' that will whip win98 into compliance? Maybe? :D<br />
      <br />
      Thanks!</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
      <span class="post-time small text-muted">20th January 2003 20:31 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Try:<br />
      <br />
      !include WinMessages.nsh<br />
      SendMessage ${HWND_BROADCAST} ${WM_WININICHANGE} 0 "STR:Control Panel\Desktop" /TIMEOUT=5000<br />
      <br />
      or:<br />
      <br />
      !include WinMessages.nsh<br />
      SendMessage ${HWND_BROADCAST} ${WM_WININICHANGE} 0 0 /TIMEOUT=5000<br />
      <br />
      If either of these doesn't work you'll have to search MSDN.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Darker</span><br />
      <span class="post-time small text-muted">21st January 2003 16:11 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Well, good try, but that doesn't seem to work.<br />
      <br />
      I played with it for 3 or 4 hours (maybe I'm an idiot :)) and had no luck with either method above, or using the System.nsh sysSystemParametersInfo function which according to MSDN, should also set this.<br />
      <br />
      I think I'll just accept defeat. Windows 98 sucks.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
      <span class="post-time small text-muted">21st January 2003 19:15 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">It does, but when done right you can make it happen. The screen saver control panel does it, so it is possible. What's the System.dll line you tried?</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Darker</span><br />
      <span class="post-time small text-muted">22nd January 2003 16:16 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">bah, I erased the line when I couldn't get it working and gave up.<br />
      Thanks for the help though.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Yathosho</span><br />
      <span class="post-time small text-muted">26th March 2004 08:12 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">sorry for bringing up this old post again, but i was wondering if somebody came across a solution in meanwhile.<br />
      <br />
      my installer changes a couple of appearance settings (font smoothing etc), but that also doesn't work until i reboot.<br />
      <br />
      to make this off-topic, i don't have win98 :p</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">gieltje</span><br />
      <span class="post-time small text-muted">26th March 2004 09:51 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">I would also be very interested, my installer makes a **** load of such registry changes</p>
    </div>
    <hr />

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]>
  </script>
</body>
</html>
