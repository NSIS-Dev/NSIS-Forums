<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="Extract file from a nsis installer" />

  <title>Extract file from a nsis installer - NSIS Forums</title>
  <script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script>
  <!-- Bootstrap core CSS -->

  <link rel="stylesheet" type="text/css" href="//netdna.bootstrapcdn.com/bootswatch/3.0.1/readable/bootstrap.min.css" />
  <link rel="stylesheet" href="../css/style.css" type="text/css" /><!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!--[if lt IE 9]>
                <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
                <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->
</head>

<body>
  <div class="container">
    <!-- Put navigation bar here -->

    <ol class="breadcrumb">
      <li><a href="../index.html" class="glyphicon glyphicon-home"></a></li>

      <li><a href="f-65.html">NSIS Discussion</a></li>

      <li class="active">Extract file from a nsis installer</li>
    </ol>

    <p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=291829">Extract file from a nsis installer</a></p><br />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">neviton</span><br />
      <span class="post-time small text-muted">15th May 2008 12:43 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>Extract file from a nsis installer</strong><br />
      :confused: I was thinging if there is a way to extract files from a installer created with NSIS.<br />
      <br />
      Maybe using a command line parameter with the installer like:<br />
      <br />
      <b>setup.exe /please_gimme_my_file:app.exe :D</b><br />
      <br />
      There is ?</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Animaether</span><br />
      <span class="post-time small text-muted">15th May 2008 13:15 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">nsis installers usually have their files compressed in an archive block.. if the compression is lzma, you can extract the files using 7zip.<br />
      <br />
      It's also one of many good reasons for those writing installers to offer an option to just dump the contents from within the installer, and encrypt or obfuscate the files within.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">neviton</span><br />
      <span class="post-time small text-muted">15th May 2008 14:35 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">OK Thanks Animaether<br />
      <br />
      But if you know if there is a script that I could put inner the installer script to let me extract a file for a location that I choose using command line parameter if possible.<br />
      <br />
      Or if you have any idea...<br />
      Tell me please<br />
      <br />
      Thanks again :D</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Animaether</span><br />
      <span class="post-time small text-muted">15th May 2008 17:25 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">ohhh you want to actually offer this yourself in your own installer!<br />
      Well that's a whole different question :D<br />
      <br />
      Try this...<br />
      <br /></p>
      <pre>
<code><br />!include "StrFunc.nsh" ; String library<br /><br />SetCompressor lzma<br /><br />Name "Test"<br />OutFile "Setup.exe"<br />InstallDir "$PROGRAMFILES\test"<br />${StrStr}<br /><br />!macro getParameterValue SWITCH DEFAULT<br />        !define UniqueID ${__LINE__}<br /><br />        Push $0<br />        Push $1<br />        Push $2<br />        Push $3<br />        Push $4<br /><br />        ; Find SWITCH in CMDLINE<br />        Push "$CMDLINE"<br />        Push "${SWITCH}"<br />        Call StrStr<br />        Pop $0<br /><br />        ; Check if the SWITCH was specified at all<br />        StrCmp "$0" "" gpv_notfound_${UniqueID}<br /><br />        ; It was found, so get the actual value<br />        StrLen $2 "$0"<br />        StrLen $1 "${SWITCH}"<br />        StrCpy $0 "$0" $2 $1<br /><br />        ; Check if the last character is a doublequote, and remove if it is<br />        StrCpy $3 "$0" 1 -1<br />        StrCmp $3 '"' 0 +3<br />            StrLen $2 "$0"<br />            IntOp $2 $2 - 1<br />            StrCpy $0 "$0" $2 0<br /><br />        ; If value is null, assign default value<br />        StrCmp "$0" "" 0 +2<br />        StrCpy $0 "${DEFAULT}"<br />        goto _done_${UniqueID}<br /><br />        gpv_notfound_${UniqueID}:<br />        StrCpy $0 -1<br /><br />        _done_${UniqueID}:<br />        Pop $4<br />        Pop $3<br />        Pop $2<br />        Pop $1<br />        Exch $0<br />        !undef UniqueID<br />!macroend<br /><br />Function .onInit<br />        !insertMacro getParameterValue "/extractFile=" "%nofile%"<br />        Pop $0<br />        <br />        StrCmp $0 -1 0 +3<br />            MessageBox MB_OK "/extractFile= parameter not specified - skipping"<br />            goto _skip<br /><br />        StrCmp $0 "%nofile%" 0 +3<br />            MessageBox MB_OK "/extractFile= parameter specified, but value empty - skipping"<br />            goto _skip<br /><br />    SetOutPath $EXEDIR<br />        MessageBox MB_OK "File to extract: $0"<br /><br />        StrCmp $0 "test.txt" 0 +4<br />                MessageBox MB_OK "Extracting file: $0"<br />            File "test.txt"<br />            Abort<br /><br />        StrCmp $0 "test2.txt" 0 +4<br />                MessageBox MB_OK "Extracting file: $0"<br />            File "test2.txt"<br />            Abort<br /><br />        MessageBox MB_OK "Invalid file specified - aborting."<br />                Abort<br /><br />        _skip:<br />        MessageBox MB_OK "Continuing to GUI mode."<br />FunctionEnd<br /><br />Section "MainSection" SEC01<br />        ; dummy section<br />SectionEnd<br /></code>
</pre><br />
      <br />
      ( You will need two files, "test.txt" and "test2.txt" for the above code to work. Replace with your actual files, of course. )
    </div>
    <hr />

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]>
  </script>
</body>
</html>
