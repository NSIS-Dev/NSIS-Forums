<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="description" content="Silent install with parameters"><title>Silent install with parameters - NSIS Forums</title><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script><link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css"><link rel="stylesheet" href="../css/style.css" type="text/css"><!--[if lt IE 9]><script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script><script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script><![endif]--></head><body><div class="container"><ol class="breadcrumb"><li><a href="../index.html" class="glyphicon glyphicon-home"></a></li><li><a href="f-65.html">NSIS Discussion</a></li><li class="active">Silent install with parameters</li></ol><p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=326636">Silent install with parameters</a></p><br><div class="post"><p class="post-meta"><span class="post-author text-primary">ssamuels_sv</span><br><span class="post-time small text-muted">29th January 2011 17:42 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>Silent install with parameters</strong><br>I would like to create an installer that runs silently but allows a network administrator to distribute to users with certain installer parameters pre-defined. I'm not referring to the install folder, but actually user parameters. For example, if my installer allows a user to pick Option A, B and/or C during the normal installation process, if I were to run this in silent mode, I would still want to define, perhaps in a command line, whether a user is installing with which option, or perhaps the word "All" for all three.<br><br>I would create the scripts to receive these parameters or arguments and automatically install the program with the proper options, so that the user doesn't have to decide for themselves.<br><br>In a network/corporate environment, there may be different types of users that need different options, but I'd want the silent installer to handle each one appropriately.<br><br>Can this be done? How would I pass in these options as part of a silent install process?<br><br>Thanks.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br><span class="post-time small text-muted">29th January 2011 17:49 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">GetParameters and GetOptions.<br><br>Stu</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">ssamuels_sv</span><br><span class="post-time small text-muted">29th January 2011 18:46 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Thanks for the prompt reply. So, if the compiled install package is "myInstall.exe", would I run that with the following:<br><br>myInstall "OptionA"<br><br>or<br><br>myInstall "OptionA, OptionC"<br><br>or<br><br>myInstall "All"<br><br>and the GetParameters() or GetOptions() will pass the particular string into my scripts?<br><br>That will be perfect if that is what you are meaning.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">jpderuiter</span><br><span class="post-time small text-muted">29th January 2011 22:25 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">rtfm...<br><a href="http://nsis.sourceforge.net/Docs/AppendixE.html#E.1.11" target="_blank">http://nsis.sourceforge.net/Docs/AppendixE.html#E.1.11</a><br><a href="http://forums.winamp.com/showthread.php?postid=2211469" target="_blank">http://forums.winamp.com/showthread.php?postid=2211469</a></p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">ssamuels_sv</span><br><span class="post-time small text-muted">2nd February 2011 02:31 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">I think I may not have clearly stated my question. I've read the manual and I think I understand how GetParameters and GetOptions work. What I am after is a desire to define my own commandline parameters. Not simply a /S or /D option, but something that is very specific to my application. It might be a list of room names, users, etc. that are default parameters that I want to assign to the installed app without the user having to go through the UI to select them. I know that I can create set of custom pages to request this information. But can I pass in the details through commandline parameters?</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">MSG</span><br><span class="post-time small text-muted">2nd February 2011 05:50 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Yes you can, using what Stu AND jpderuiter already pointed you at. Or if you want to pass params to your application, instead of to your installer, you can do that to. Pay attention to the quote usage:<br><br>Exec '"$INSTDIR\YourApp.exe" Param1 Param2 ParamEtc'</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">ssamuels_sv</span><br><span class="post-time small text-muted">2nd February 2011 20:40 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>Got it working</strong><br>When I am part of a forum, I try to give back as much as I get from a forum. So, here is a bit more detail on how to get this working, if anyone else is trying to do the same thing. The information that you offered (and that is in the manual) is correct, but there are a few missing pieces that I couldn't find anywhere. I just happened to guess on a few things and got lucky.<br><br>To begin with, at the top of your script, you have to include the following or GetParameters and GetOptions won't even compile:<br><br>!include "FileFunc.nsh" ; this is critical<br><br>Next, the parameters themselves are not put into double quotes. Using the following code<br><br>Var roomList<br><br>Function .onInit<br>var /GLOBAL cmdLineParams<br>Push $R0<br>${GetParameters} $cmdLineParams<br>Pop $R0<br>FunctionEnd<br><br>; Then add the following code goes in the main section<br>; where the StartMenu shortcut and other commands<br>; get executed.<br><br>${GetOptions} $cmdLineParams "/Params=" $R0<br>IfErrors +2 0<br>StrCpy $paramList "$R0"<br><br>Then the installer is executed with the following command line.<br><br>myInstall.exe /Params=P1,P2,P3<br><br>The end result is that $paramList will contain "P1,P2,P3".<br><br>Hope this helps others. If anyone wants to comment on other ways to clean up the above code, that will help all of us.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Anders</span><br><span class="post-time small text-muted">2nd February 2011 20:57 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">If you look at where GetParameters and GetOptions are located in the helpfile you will see that they are in the "Appendix E: Useful Headers" section, the first thing the file function header section tells you in "E.1.1 Introduction" is to !include "FileFunc.nsh"<br><br>Your ${GetParameters} usage is weird, there is no need to push and pop, just use ${GetParameters} $cmdLineParams (The helpfile documents the syntax as "${GetParameters} $var", the example just uses $R0)</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">ssamuels_sv</span><br><span class="post-time small text-muted">2nd February 2011 21:20 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">I realize that now, but as a newbie, it isn't that obvious. If someone just points you to GetParameters and GetOptions and doesn't explain how to use any of those functions in general, you would miss that important item. I saw another post that explained a far more complete description for these functions that also didn't include that line.<br><br>And yes, I suspected that I could take out the push and pop but that was how the usage was explained in another thread and since it is working, I haven't gone back to see what I could remove and what was absolutely required.<br><br>Thanks for the clarification.</p></div><hr><div class="footer"><p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p></div></div><script src="../js/highlight.pack.js" type="text/javascript"></script><script type="text/javascript">//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]></script></body></html>