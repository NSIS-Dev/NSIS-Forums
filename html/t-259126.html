<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="Problem with Create Shortcut" />

  <title>Problem with Create Shortcut - NSIS Forums</title><!-- Bootstrap core CSS -->
  <link rel="stylesheet" type="text/css" href="//netdna.bootstrapcdn.com/bootswatch/3.0.1/readable/bootstrap.min.css" />
  <link rel="stylesheet" href="../css/style.css" type="text/css" /><!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!--[if lt IE 9]>
                <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
                <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->
</head>

<body>
  <div class="container">
    <!-- Put navigation bar here -->

    <ol class="breadcrumb">
      <li><a href="../index.html" class="glyphicon glyphicon-home"></a></li>

      <li><a href="f-65.html">NSIS Discussion</a></li>

      <li class="active">Problem with Create Shortcut</li>
    </ol>

    <p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=259126">Problem with Create Shortcut</a></p><br />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">g2g</span><br />
      <span class="post-time small text-muted">8th November 2006 12:07 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>Problem with Create Shortcut</strong><br />
      Hi;<br />
      <br />
      IÂ´m a newbie with NSIS.<br />
      I try to create an installer using the Wizard of HM NSIS Editor.<br />
      It works fine. I try to create a shortcut on the desktop, but it donÂ´t work.<br /></p>
      <pre>
<code>CreateShortCut "$SMPROGRAMS\$ICONS_GROUP\MyApp.lnk" "$INSTDIR\directory\start.bat"</code>
</pre><br />
      the shortcut is created on the desktop. But when I look at the properties the value of the parameter 'start in' is wrong.<br />
      Could I change this value anywhere in my script?<br />
      <br />
      Thanks for helping<br />
      <br />
      Kind regards<br />
      g2g
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Anders</span><br />
      <span class="post-time small text-muted">8th November 2006 12:37 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">use SetOutPath before you call CreateShortCut</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">g2g</span><br />
      <span class="post-time small text-muted">8th November 2006 12:52 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Hi Anders;<br />
      <br />
      i already use the Command SetOutPath before i create the ShortCut.<br />
      <br />
      <br /></p>
      <pre>
<code><br />  SetOutPath "$INSTDIR"<br />  SetOverwrite try<br />  File /r "directory"<br />  CreateShortCut "$SMPROGRAMS\$ICONS_GROUP\MyApp.lnk" "$INSTDIR\directory\start.bat"</code>
</pre><br />
      <br />
      I attached a image, that shows the properties of the shortcut.<br />
      The value of the parameter should be "C:\Program Files\MyApp" instead of "C:\Program Files\MyApp\directory\xxx"<br />
      <br />
      Thanks for helping<br />
      g2g
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">g2g</span><br />
      <span class="post-time small text-muted">8th November 2006 12:55 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">sorry the image isnÂ´t attached.<br />
      i try it one more time.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
      <span class="post-time small text-muted">8th November 2006 18:25 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Works fine for me. Which version of NSIS are you using? Could you attach the installation details (right click on it in the instfiles page and choose Copy Details to Clipboard)?</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">g2g</span><br />
      <span class="post-time small text-muted">9th November 2006 08:52 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Hi @ll;<br />
      <br />
      i fixed the problem. The shortcut works.<br />
      Anders was wright. The value of SetOutPath was wrong. I had to change it before i create the shortcuts.<br />
      <br />
      Another question.<br />
      I also try to run my Application after the install.<br />
      HM NSIS Editor creates following Code:<br /></p>
      <pre>
<code>!define MUI_FINISHPAGE_RUN "$INSTDIR\jakarta-tomcat-5.5.9\bin\startup.bat"<br />!insertmacro MUI_PAGE_FINISH</code>
</pre><br />
      <br />
      ItÂ´s the same file, that my shortcut is joined to.<br />
      But the application doesnÂ´t start up correctly.<br />
      Are there any details (parameters) i have to attend?<br />
      Do you have any ideas?<br />
      <br />
      Thanks a lot for your support!<br />
      <br />
      Regards<br />
      g2g
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Anders</span><br />
      <span class="post-time small text-muted">9th November 2006 15:16 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">you probably have the same "current directory" problem, try executing the .lnk instead of the .bat on the finish page. Or if the shortcut is optional, you can use a function callback on the finish page instead of executing something directly, that should give you more control</p>
    </div>
    <hr />

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]>
  </script>
</body>
</html>
