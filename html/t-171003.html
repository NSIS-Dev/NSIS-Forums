<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="description" content="Set the bitmap in a custom page"><title>Set the bitmap in a custom page - NSIS Forums</title><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script><link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css"><link rel="stylesheet" href="../css/style.css" type="text/css"><!--[if lt IE 9]><script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script><script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script><![endif]--></head><body><div class="container"><ol class="breadcrumb"><li><a href="../index.html" class="glyphicon glyphicon-home"></a></li><li><a href="f-65.html">NSIS Discussion</a></li><li class="active">Set the bitmap in a custom page</li></ol><p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=171003">Set the bitmap in a custom page</a></p><br><div class="post"><p class="post-meta"><span class="post-author text-primary">VegetaSan</span><br><span class="post-time small text-muted">25th February 2004 23:10 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>Set the bitmap in a custom page</strong><br>I tried serveral thing and I can't find anything in the Manual<br><br>Could somebody help have made a custom page with a bitmap in it, But how can I set for example this file to display the bitmap in my custom page "C:\arrow.bmp"<br><br>Thanks Again</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Joost Verburg</span><br><span class="post-time small text-muted">25th February 2004 23:17 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Extract it to a temporary location ($PLUGINSDIR after using InitPluginsDir) and write the location to the InstallOptions INI file.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">heXor</span><br><span class="post-time small text-muted">26th February 2004 08:59 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">To add a bitmap to your custom page will be very simple if you follow the steps below:<br><br>1. You have to do as Joost writes, i.e. to unpack the bitmap to the pluginsdir<br><br>2. In the Pre function of your custom dialog write this code:<br><br>; Load the dialog<br>InstallOptions::initDialog /NOUNLOAD "$PLUGINSDIR\YourCustomDialog.ini"<br>Pop $R0<br><br>System::Call '${sysLoadImage} (0, \<br>"$PLUGINSDIR\yourbmp.bmp", \<br>${IMAGE_BITMAP}, \<br>0, \<br>0, \<br>${LR_CREATEDIBSECTION}|${LR_LOADFROMFILE}) .r6'<br><br><br><br>; Show your bmp in the "field" 1201<br>GetDlgItem $R3 $R0 1201 ;1200 + Field number - 1<br>SendMessage $R3 ${STM_SETIMAGE} ${IMAGE_BITMAP} $R6<br><br>; Show the dialog<br>InstallOptions::show<br><br>3. Now you'll be able to see your bmp in the custom page. Ofcourse that the field number might not be the same in your case. If you use HM NSIS Editor, you will ba able to choose the field number. Make sure you set the style "Bitmap" if you load a bitmap and "Icon" of you'll display an icon.<br><br>4. Other definitions that you might need:<br><br>!define sysLoadImage "user32::LoadImageA(i, t, i, i, i, i) i"<br><br>!ifndef IMAGE_BITMAP<br>!define IMAGE_BITMAP 0<br>!endif<br><br><br>!ifndef LR_LOADFROMFILE<br>!define LR_LOADFROMFILE 0x0010<br>!endif<br><br>!ifndef LR_CREATEDIBSECTION<br>!define LR_CREATEDIBSECTION 0x2000<br>!endif<br><br><br>Good luck<br>/Paul</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Joost Verburg</span><br><span class="post-time small text-muted">26th February 2004 10:54 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">There is no need to use Windows API. You only have to write the filename to the InstallOptions INI file.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">heXor</span><br><span class="post-time small text-muted">26th February 2004 11:33 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">I didn't knew that...<br>But now I know.<br>Anyway, I don't find it hard to use WinAPI either. If you use WinAPI you have other possibilities too, like stretching pictures.<br>/Paul</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Joost Verburg</span><br><span class="post-time small text-muted">26th February 2004 11:36 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">InstallOptions also has a RESIZETOFIT flag that allows you to stretch an image.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">heXor</span><br><span class="post-time small text-muted">26th February 2004 12:04 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Using Win32 API in this case is not the best solution. It is not the simplest solutions either. I admit that. The best solutions is to use the built in stuff, ofcourse.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">VegetaSan</span><br><span class="post-time small text-muted">27th February 2004 10:31 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">I got it thanks : heXor and Joost Verburg</p></div><hr><div class="footer"><p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p></div></div><script src="../js/highlight.pack.js" type="text/javascript"></script><script type="text/javascript">//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]></script></body></html>