<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="NSIS created setup file contains suspicious code" />

  <title>NSIS created setup file contains suspicious code - NSIS Forums</title><!-- Bootstrap core CSS -->
  <link rel="stylesheet" type="text/css" href="//netdna.bootstrapcdn.com/bootswatch/3.0.1/readable/bootstrap.min.css" />
  <link rel="stylesheet" href="../css/style.css" type="text/css" /><!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!--[if lt IE 9]>
                <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
                <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->
</head>

<body>
  <div class="container">
    <!-- Put navigation bar here -->

    <ol class="breadcrumb">
      <li><a href="../index.html" class="glyphicon glyphicon-home"></a></li>

      <li><a href="f-65.html">NSIS Discussion</a></li>

      <li class="active">NSIS created setup file contains suspicious code</li>
    </ol>

    <p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=290285">NSIS created setup file contains suspicious code</a></p><br />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">dhesmer</span><br />
      <span class="post-time small text-muted">15th April 2008 17:44 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>NSIS created setup file contains suspicious code</strong><br />
      I'm using the "AVIRA" anti virus software. Since last update of the signature file I get the message "MyProgram_setup.exe contains suspicious code: HEUR/Malware".<br />
      MyProgram_setup.exe is created by NSIS, the source is VB.Net2008 code. This is the only program I created by NSIS. All older versions of the program, located in different zip-files, are also indicated by above message and only these programs are listed, no others.<br />
      Is something wrong with NSIS?<br />
      Thanks for your help.<br />
      Diedrich</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">fabian.rap.more</span><br />
      <span class="post-time small text-muted">15th April 2008 18:45 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">it is just another false positive. contact them about it</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Joel</span><br />
      <span class="post-time small text-muted">15th April 2008 22:19 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">nsis should be for installation tasks not detecting bad signatures to AntiVirus :)</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">fabian.rap.more</span><br />
      <span class="post-time small text-muted">17th April 2008 02:30 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">I agree with Joel but we must atleast contact them about or new users will get frightened away</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
      <span class="post-time small text-muted">18th April 2008 11:14 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">We need a server that'd upload all versions of NSIS including the plug-ins to daily tests on all known Anti-Virus products. Jotti and friends can be used for that. Once a false positive is detected, an automatic mail can be sent out.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">ionut_y</span><br />
      <span class="post-time small text-muted">18th April 2008 12:18 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>Re: NSIS created setup file contains suspicious code</strong><br />
      Scan your .NET exe there : <a href="http://www.virustotal.com" target="_blank">www.virustotal.com</a><br />
      (virustotal.com)</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">dhesmer</span><br />
      <span class="post-time small text-muted">20th April 2008 09:33 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>Re: Re: NSIS created setup file contains suspicious code</strong><br /></p>

      <blockquote>
        <i>Originally posted by ionut_y</i><br />
        <b>Scan your .NET exe there : <a href="http://www.virustotal.com" target="_blank">www.virustotal.com</a><br />
        (virustotal.com)</b>
      </blockquote>I checked my setup file (available at <a href="http://www.hesmer.name/ofb/files/ofb-setup_5.0.1.exe" target="_blank">www.hesmer.name\ofb\files\ofb-setup_5.0.1.exe</a>) by virustotal. 2 of 32 (AntiVir from AVIRA and Webwasher-Gateway) found Heuristic Malware. All programs packed in this setup are with no result.<br />
      Regards Diedrich
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">dhesmer</span><br />
      <span class="post-time small text-muted">20th April 2008 09:37 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"></p>

      <blockquote>
        <i>Originally posted by Joel</i><br />
        <b>nsis should be for installation tasks not detecting bad signatures to AntiVirus :)</b>
      </blockquote>Sorry ... ,<br />
      I use NSIS for setting up a distribution file. But the resulted setup file was marked suspicious by an antivirus scanner.
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">dhesmer</span><br />
      <span class="post-time small text-muted">20th April 2008 09:46 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"></p>

      <blockquote>
        <i>Originally posted by kichik</i><br />
        <b>We need a server that'd upload all versions of NSIS including the plug-ins to daily tests on all known Anti-Virus products. Jotti and friends can be used for that. Once a false positive is detected, an automatic mail can be sent out.</b>
      </blockquote>Dear kichik,<br />
      I need some advise what to do from a developer. In the meantime several users of my software informed me about finding heuristic malware after downloading the setup file from the server. The results of a check by virustotal.com you can find at the answer to ionut_y some minutes ago. Only the setup file created by NSIS is find faulty, not the files packed into the setup file.<br />
      Thanks in advance<br />
      Diedrich
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
      <span class="post-time small text-muted">20th April 2008 14:53 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">You should contact the relevant anti-virus company and notify them of their mistake. They usually fix it within a few days.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">seg_telltale</span><br />
      <span class="post-time small text-muted">21st April 2008 01:23 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Checking in that we had a few of our users noticing this problem. And by noticing, I say that they were blaming us for distributing a virus. :rolleyes:<br />
      <br />
      We all agree here that it's nothing that NSIS has done wrong and is simply security software developers not checking the differences between NSIS running and the offending software. However, this causes problems because users have no concept of this. What we're asking users is to say that the program that protects them from the cyber-baddies is incorrect. While we certainly aren't trying to infect people with bad stuff, I don't see how they would trust us saying that.<br />
      <br />
      So how do we fix this problem? Should we have a generic NSIS installer setup for security software manufactures to check against? An installer where it compiles all the elements of NSIS but is already known as a safe program. Then security manufactures can check against the known clean NSIS and see if the signature they are detecting is a false-positive.<br />
      <br />
      This has been the third time this calendar year that something like this has come across our studio, so I'd like to start ways to make sure these false-positives don't happen.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Joel</span><br />
      <span class="post-time small text-muted">21st April 2008 03:11 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Or you can change antivirus :)<br />
      <br />
      There are good ones, without nsis complainment, I never had problems with avast, nod32, both are commercial if that's what you want. There are also free ones.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">seg_telltale</span><br />
      <span class="post-time small text-muted">21st April 2008 03:22 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"></p>

      <blockquote>
        <i>Originally posted by Joel</i><br />
        <b>Or you can change antivirus :)</b>
      </blockquote>Saying "Your antivirus sucks" is not a solution to give people contacting your support lines.
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">fabian.rap.more</span><br />
      <span class="post-time small text-muted">21st April 2008 06:27 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"></p>

      <blockquote>
        <i>Originally posted by seg_telltale</i><br />
        <b>Saying "Your antivirus sucks" is not a solution to give people contacting your support lines.</b>
      </blockquote>I agree with that but why are the antivirus companies detecting NSIS as malware? If it doesnt fix it then arnt they neglecting the reports sent in?
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">dhesmer</span><br />
      <span class="post-time small text-muted">21st April 2008 15:20 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"></p>

      <blockquote>
        <i>Originally posted by kichik</i><br />
        <b>You should contact the relevant anti-virus company and notify them of their mistake. They usually fix it within a few days.</b>
      </blockquote>I sent the affected file to AVIRA yesterday and got the answer right now. "No virus, just a false alarm. Will be eliminated within one of the next updates of the signature file".<br />
      <br />
      Thanks to everybody<br />
      Diedrich<br />
      <br />
      P.S. NSIS is an excellent product !!
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
      <span class="post-time small text-muted">21st April 2008 23:47 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">seg_telltale, handing them a ZIP file with all of the files from all of the versions isn't good enough. They don't care. I have talked with some companies in the past and non of them were cooperative in any way. They will only fix the errors in their current definitions. And those are sometimes updated in a semi or even fully automatic fashion.<br />
      <br />
      What we need is to make an automated system of our own that would notify them instantly of false positives in their database. If we create something good enough, we can even offer it to other open source projects that suffer from the same problem.</p>
    </div>
    <hr />

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]>
  </script>
</body>
</html>
