<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="Strange Vista Issue (Not Shortcut!)" />

  <title>Strange Vista Issue (Not Shortcut!) - NSIS Forums</title>
  <script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script>
  <!-- Bootstrap core CSS -->

  <link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css" />
  <link rel="stylesheet" href="../css/style.css" type="text/css" /><!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!--[if lt IE 9]>
                <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
                <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->
</head>

<body>
  <div class="container">
    <!-- Put navigation bar here -->

    <ol class="breadcrumb">
      <li><a href="../index.html" class="glyphicon glyphicon-home"></a></li>

      <li><a href="f-65.html">NSIS Discussion</a></li>

      <li class="active">Strange Vista Issue (Not Shortcut!)</li>
    </ol>

    <p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=287864">Strange Vista Issue (Not Shortcut!)</a></p><br />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">zenkick</span><br />
      <span class="post-time small text-muted">1st March 2008 23:37 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>Strange Vista Issue (Not Shortcut!)</strong><br />
      I'm seeing strange behavior:<br />
      <br />
      1.) Install app<br />
      2.) Use App. You have to register in my app. When you are done, you get prompted for a u/p.<br />
      3.) Exit App<br />
      4.) Uninstall App<br />
      5.) Confirm all files are removed. Check!<br />
      6.) Confirm used registry settings are removed. Check!<br />
      <br />
      Now, if I reinstall the same app (using the same installer), and launch it, I'm not presented with my registration screens, but rather my login window. It's like my app was never uninstalled.<br />
      <br />
      If I change the location of my installed app (using the same installer), everything functions as expected.<br />
      <br />
      Help?</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
      <span class="post-time small text-muted">2nd March 2008 20:09 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">You'll have to include more details. What exactly happens when a user registers? Does it write a file? Does it write to the registry?</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">zenkick</span><br />
      <span class="post-time small text-muted">6th March 2008 15:32 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"></p>

      <blockquote>
        <i>Originally posted by kichik</i><br />
        <b>You'll have to include more details. What exactly happens when a user registers? Does it write a file? Does it write to the registry?</b>
      </blockquote>The application does not write to the registry. The installer and uninstaller does, however.<br />
      <br />
      The app does write to a database. I am using mysql-embedded 4.1 (libmysqld) to access the database files, which are stored on the local filesystem. And to be clear, I am *not* running a mysql server process-- everything is in-line in-memory while the app is running.<br />
      <br />
      The database files *are* removed during an uninstall.<br />
      <br />
      The symptoms are, however, as if the files are not removed-- as registration information is cached after a reinstall.<br />
      <br />
      I'm installing and uninstalling into "C:\Program Files" successfully, using "RequestExecutionLevel admin".<br />
      <br />
      I've confirmed the files are not appearing in a search after uninstall.<br />
      <br />
      Thoughts?
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
      <span class="post-time small text-muted">6th March 2008 17:25 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">I have no good idea regarding this. You should add some debug messages into your application to see exactly where it gets that information from and then we might at least have a lead.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">MSG</span><br />
      <span class="post-time small text-muted">6th March 2008 17:37 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">My first thought is that the file ended up in virtualstore, but it could also have ended up in some other protected directory that Windows doesn't search in. Who knows, maybe even winsxs.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">zenkick</span><br />
      <span class="post-time small text-muted">12th March 2008 16:20 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Thanks MSG.<br />
      <br />
      The files that my program needs to write/open, are indeed copied to and used out of the virtualstore. Since my uninstaller doesn't know about that, they never get purged.<br />
      <br />
      Now I need to know if there is a simple way to have nsis purge the files from a default $INSTVIRTSTORE or something similar?<br />
      <br />
      Or is that something I have to script like MSG did:<br />
      <br />
      <a href="http://forums.winamp.com/showthread.php?s=&amp;threadid=285290&amp;highlight=virtualstore" target="_blank">Previous Post</a><br />
      <br />
      Please advise.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
      <span class="post-time small text-muted">16th March 2008 20:45 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Previous post link:<br />
      <br />
      <a href="http://forums.winamp.com/showthread.php?s=&amp;threadid=285290&amp;highlight=virtualstore" target="_blank">http://forums.winamp.com/showthread....t=virtualstore</a></p>
    </div>
    <hr />

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]>
  </script>
</body>
</html>
