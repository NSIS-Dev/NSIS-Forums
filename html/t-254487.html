<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="Install one or more Clients" />

  <title>Install one or more Clients - NSIS Forums</title><!-- Bootstrap core CSS -->
  <link rel="stylesheet" type="text/css" href="//netdna.bootstrapcdn.com/bootswatch/3.0.1/readable/bootstrap.min.css" />
  <link rel="stylesheet" href="../css/style.css" type="text/css" /><!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!--[if lt IE 9]>
                <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
                <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->
</head>

<body>
  <div class="container">
    <!-- Put navigation bar here -->

    <ol class="breadcrumb">
      <li><a href="../index.html" class="glyphicon glyphicon-home"></a></li>

      <li><a href="f-65.html">NSIS Discussion</a></li>

      <li class="active">Install one or more Clients</li>
    </ol>

    <p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=254487">Install one or more Clients</a></p><br />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Amun</span><br />
      <span class="post-time small text-muted">31st August 2006 09:55 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>Install one or more Clients</strong><br />
      Hi!<br />
      <br />
      I'm trying to generate an installation routine which should have the following functionality:<br />
      With a installation-routine it should be possible to distribute and install a defined software program to one or more computers automatically.<br />
      The selection, which computers should be updated, is realised with a custompage and the result (selection) is stored in a predefined file. The next step is to read this selection-file line by line and to distribute the software accordingly.<br />
      <br />
      As an attachment I send you my version of the installation-routine.<br />
      The question is: How do I have to include the components for their proper installation?<br />
      <br />
      Thx<br />
      <br />
      edit:<br />
      can't upload files so here a link to ZIP:<br />
      <a href="http://mitglied.lycos.de/amun1973/multiclients.zip" target="_blank">multiclients.zip</a></p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
      <span class="post-time small text-muted">1st September 2006 10:02 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Can you upload it somewhere else? I keep getting an error message I can't read when trying to download.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Amun</span><br />
      <span class="post-time small text-muted">1st September 2006 10:54 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">sorry here the code from NSI<br />
      PHP Code:</p>
      <hr />
      <code style="white-space:nowrap"><!-- php buffer start --></code><span style="color: #000000"><span style="color: #007700">!</span><span style="color: #0000BB">insertmacroMUI_PAGE_WELCOME<br />
      Pagecustomselect_pc<br />
      <br /></span> <span style="color: #007700">!</span><span style="color: #0000BB">insertmacroMUI_PAGE_COMPONENTS<br /></span> <span style="color: #007700">;</span><span style="color: #0000BB">Instfilespage<br /></span> <span style="color: #007700">!</span><span style="color: #0000BB">insertmacroMUI_PAGE_INSTFILES<br /></span> <span style="color: #007700">;</span><span style="color: #0000BB">Finishpage<br /></span> <span style="color: #007700">!</span><span style="color: #0000BB">insertmacroMUI_PAGE_FINISH<br />
      <br />
      <br /></span> <span style="color: #007700">;</span><span style="color: #0000BB">Languagefiles<br /></span> <span style="color: #007700">!</span><span style="color: #0000BB">insertmacroMUI_LANGUAGE</span><span style="color: #DD0000">"German"<br /></span> <span style="color: #007700">!</span><span style="color: #0000BB">insertmacroMUI_LANGUAGE</span><span style="color: #DD0000">"English"<br />
      <br /></span> <span style="color: #007700">;</span><span style="color: #0000BB">MUIend</span><span style="color: #007700">------<br />
      <br />
      <br />
      <br /></span> <span style="color: #0000BB">Name</span><span style="color: #DD0000">"${PRODUCT_NAME}${PRODUCT_VERSION}"<br /></span> <span style="color: #0000BB">OutFile</span><span style="color: #DD0000">"test.exe"<br /></span> <span style="color: #0000BB">InstallDir</span><span style="color: #DD0000">"C:\test"<br /></span> <span style="color: #0000BB">ShowInstDetailsshow<br />
      ShowUnInstDetailsshow<br />
      AllowRootDirInstalltrue<br />
      <br />
      <br />
      <br />
      Section</span><span style="color: #007700">-var<br />
      Var/GLOBAL</span><span style="color: #0000BB">TMP<br /></span> <span style="color: #007700">var/GLOBAL</span><span style="color: #0000BB">pc<br /></span> <span style="color: #007700">var/GLOBAL</span><span style="color: #0000BB">done<br />
      StrCpy$TMP</span><span style="color: #DD0000">"c:\temp"<br /></span> <span style="color: #0000BB">strcpy$done</span><span style="color: #DD0000">"N"<br /></span> <span style="color: #0000BB">SectionEnd<br />
      <br /></span> <span style="color: #007700">Function.</span><span style="color: #0000BB">onInit<br /></span> <span style="color: #007700">!</span><span style="color: #0000BB">insertmacroMUI_INSTALLOPTIONS_EXTRACT</span><span style="color: #DD0000">"select_pc.ini"<br /></span> <span style="color: #0000BB">FunctionEnd<br />
      <br /></span> <span style="color: #007700">Function</span><span style="color: #0000BB">select_pc<br /></span> <span style="color: #007700">!</span><span style="color: #0000BB">insertmacroMUI_HEADER_TEXT</span><span style="color: #DD0000">"Clients"<br />
      "SelecttheClient(multiselectpossible)"<br /></span> <span style="color: #007700">!</span><span style="color: #0000BB">insertmacroMUI_INSTALLOPTIONS_DISPLAY</span><span style="color: #DD0000">"select_pc.ini"<br /></span> <span style="color: #0000BB">FunctionEnd<br />
      <br />
      Section</span><span style="color: #007700">-</span><span style="color: #0000BB">get_pcnames<br />
      Delete</span><span style="color: #DD0000">"$TMP\pc.txt"<br /></span> <span style="color: #0000BB">StrCpy</span><span style="color: #007700">$</span><span style="color: #0000BB">0</span><span style="color: #DD0000">"3"<br /></span> <span style="color: #007700">!</span><span style="color: #0000BB">insertmacroMUI_INSTALLOPTIONS_READ$R0</span><span style="color: #DD0000">"select_pc.ini""Settings""NumFields"<br /></span> <span style="color: #0000BB">IntOp$R0$R0</span><span style="color: #007700">+</span><span style="color: #0000BB">1<br />
      FileOpen$R1</span><span style="color: #DD0000">"$TMP\pc.txt""a"<br />
      <br /></span> <span style="color: #0000BB">Next_pc</span><span style="color: #007700">:<br />
      <br /></span> <span style="color: #0000BB">IntOp</span><span style="color: #007700">$</span><span style="color: #0000BB">0</span><span style="color: #007700">$</span><span style="color: #0000BB">0</span><span style="color: #007700">+</span><span style="color: #0000BB">1<br />
      StrCmp</span><span style="color: #007700">$</span><span style="color: #0000BB">0</span><span style="color: #DD0000">"$R0"</span><span style="color: #0000BB">endloop_pc<br /></span> <span style="color: #007700">!</span><span style="color: #0000BB">insertmacroMUI_INSTALLOPTIONS_READ$R3</span><span style="color: #DD0000">"select_pc.ini""Field$0""State"<br /></span> <span style="color: #0000BB">StrCmp$R3</span><span style="color: #DD0000">"0"</span><span style="color: #0000BB">Next_pc<br /></span> <span style="color: #007700">!</span><span style="color: #0000BB">insertmacroMUI_INSTALLOPTIONS_READ$R4</span><span style="color: #DD0000">"select_pc.ini""Field$0""Text"<br />
      <br /></span> <span style="color: #0000BB">FileSeek$R10END<br />
      FileWrite$R1</span><span style="color: #DD0000">"$R4$\r$\n"<br /></span> <span style="color: #0000BB">gotoNext_pc<br />
      Endloop_pc</span><span style="color: #007700">:<br /></span> <span style="color: #0000BB">FileClose$R1<br />
      SectionEnd<br />
      <br />
      Section</span><span style="color: #007700">-</span><span style="color: #0000BB">Readfile<br />
      FileOpen</span><span style="color: #007700">$</span><span style="color: #0000BB">0</span><span style="color: #DD0000">"$TMP\pc.txt"</span><span style="color: #0000BB">r<br />
      IfErrorsdone_read<br />
      <br />
      FileSeek</span><span style="color: #007700">$</span><span style="color: #0000BB">00<br />
      loop_read</span><span style="color: #007700">:<br />
      <br /></span> <span style="color: #0000BB">FileRead</span><span style="color: #007700">$</span><span style="color: #0000BB">0$pc<br />
      StrCmp$pc</span><span style="color: #DD0000">""</span><span style="color: #0000BB">done_read<br />
      CallAllgemein<br />
      gotoloop_read<br />
      <br />
      done_read</span><span style="color: #007700">:<br /></span> <span style="color: #0000BB">FileClose</span><span style="color: #007700">$</span><span style="color: #0000BB">0<br />
      <br />
      callend_install<br /></span> <span style="color: #007700">;return<br /></span> <span style="color: #0000BB">SectionEnd<br />
      <br /></span> <span style="color: #007700">Function</span><span style="color: #0000BB">Allgemein<br />
      MessageBoxMB_OK</span><span style="color: #DD0000">"startinstall$pc"<br /></span> <span style="color: #0000BB">call</span><span style="color: #007700">:.</span><span style="color: #0000BB">sectioninstall<br />
      FunctionEnd<br />
      <br />
      <br />
      Section</span><span style="color: #007700">-</span><span style="color: #0000BB">Install<br />
      <br /></span> <span style="color: #007700">.</span><span style="color: #0000BB">sectioninstall</span><span style="color: #007700">:<br /></span> <span style="color: #0000BB">StrCmp$done</span><span style="color: #DD0000">"J"</span><span style="color: #0000BB">end<br />
      MessageBoxMB_OK</span><span style="color: #DD0000">"Installfor$pccomlete"<br /></span> <span style="color: #007700">return<br />
      <br /></span> <span style="color: #0000BB">end</span><span style="color: #007700">:<br /></span> <span style="color: #0000BB">SectionEnd<br />
      <br />
      Section1SEC01<br />
      MessageBoxMB_OK</span><span style="color: #DD0000">"Section1"<br /></span> <span style="color: #0000BB">SectionEnd<br />
      <br />
      Section2SEC02<br />
      MessageBoxMB_OK</span><span style="color: #DD0000">"Section2"<br /></span> <span style="color: #0000BB">SectionEnd<br />
      <br />
      Section3SEC03<br />
      MessageBoxMB_OK</span><span style="color: #DD0000">"Section3"<br /></span> <span style="color: #0000BB">SectionEnd<br />
      <br /></span> <span style="color: #007700">Function</span><span style="color: #0000BB">end_install<br />
      <br />
      Messageboxmb_ok</span><span style="color: #DD0000">"Allinstallscomplete"<br /></span> <span style="color: #0000BB">strcpy$done</span><span style="color: #DD0000">"J"<br />
      <br /></span> <span style="color: #0000BB">FunctionEnd<br /></span></span> <!-- php buffer end -->
      <hr />
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Amun</span><br />
      <span class="post-time small text-muted">1st September 2006 10:56 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">and here is a sampe INI<br />
      <br />
      PHP Code:</p>
      <hr />
      <code style="white-space:nowrap"><!-- php buffer start --></code><span style="color: #000000"><span style="color: #007700">***91;</span><span style="color: #0000BB">Settings</span><span style="color: #007700">***93;<br /></span> <span style="color: #0000BB">NumFields</span><span style="color: #007700">=</span><span style="color: #0000BB">10<br />
      <br /></span> <span style="color: #007700">***91;</span><span style="color: #0000BB">Field1</span><span style="color: #007700">***93;<br /></span> <span style="color: #0000BB">Type</span><span style="color: #007700">=</span><span style="color: #0000BB">Label<br />
      Text</span><span style="color: #007700">=</span><span style="color: #0000BB">SERVER<br />
      Flags</span><span style="color: #007700">=</span><span style="color: #0000BB">NOTABSTOP<br />
      Left</span><span style="color: #007700">=</span><span style="color: #0000BB">0<br />
      Right</span><span style="color: #007700">=-</span><span style="color: #0000BB">1<br />
      Top</span><span style="color: #007700">=</span><span style="color: #0000BB">0<br />
      Bottom</span><span style="color: #007700">=</span><span style="color: #0000BB">10<br />
      <br /></span> <span style="color: #007700">***91;</span><span style="color: #0000BB">Field2</span><span style="color: #007700">***93;<br /></span> <span style="color: #0000BB">Type</span><span style="color: #007700">=</span><span style="color: #0000BB">Label<br />
      Text</span><span style="color: #007700">=</span><span style="color: #0000BB">EClients<br />
      Flags</span><span style="color: #007700">=</span><span style="color: #0000BB">NOTABSTOP<br />
      Left</span><span style="color: #007700">=</span><span style="color: #0000BB">0<br />
      Right</span><span style="color: #007700">=-</span><span style="color: #0000BB">1<br />
      Top</span><span style="color: #007700">=</span><span style="color: #0000BB">30<br />
      Bottom</span><span style="color: #007700">=</span><span style="color: #0000BB">40<br />
      <br /></span> <span style="color: #007700">***91;</span><span style="color: #0000BB">Field3</span><span style="color: #007700">***93;<br /></span> <span style="color: #0000BB">Type</span><span style="color: #007700">=</span><span style="color: #0000BB">Label<br />
      Text</span><span style="color: #007700">=</span><span style="color: #0000BB">iClients<br />
      Flags</span><span style="color: #007700">=</span><span style="color: #0000BB">NOTABSTOP<br />
      Left</span><span style="color: #007700">=</span><span style="color: #0000BB">0<br />
      Right</span><span style="color: #007700">=-</span><span style="color: #0000BB">1<br />
      Top</span><span style="color: #007700">=</span><span style="color: #0000BB">75<br />
      Bottom</span><span style="color: #007700">=</span><span style="color: #0000BB">85<br />
      <br /></span> <span style="color: #007700">;********************<br />
      ;</span><span style="color: #0000BB">SERVER</span><span style="color: #007700">*<br />
      ;********************<br />
      ***91;</span><span style="color: #0000BB">Field4</span><span style="color: #007700">***93;<br /></span> <span style="color: #0000BB">Type</span><span style="color: #007700">=</span><span style="color: #0000BB">Checkbox<br />
      Text</span><span style="color: #007700">=</span><span style="color: #0000BB">SERVER1<br />
      State</span><span style="color: #007700">=</span><span style="color: #0000BB">0<br />
      Left</span><span style="color: #007700">=</span><span style="color: #0000BB">20<br />
      Right</span><span style="color: #007700">=</span><span style="color: #0000BB">100<br />
      Top</span><span style="color: #007700">=</span><span style="color: #0000BB">15<br />
      Bottom</span><span style="color: #007700">=</span><span style="color: #0000BB">25<br />
      <br /></span> <span style="color: #007700">***91;</span><span style="color: #0000BB">Field5</span><span style="color: #007700">***93;<br /></span> <span style="color: #0000BB">Type</span><span style="color: #007700">=</span><span style="color: #0000BB">Checkbox<br />
      Text</span><span style="color: #007700">=</span><span style="color: #0000BB">SERVER2<br />
      State</span><span style="color: #007700">=</span><span style="color: #0000BB">0<br />
      Left</span><span style="color: #007700">=</span><span style="color: #0000BB">100<br />
      Right</span><span style="color: #007700">=</span><span style="color: #0000BB">180<br />
      Top</span><span style="color: #007700">=</span><span style="color: #0000BB">15<br />
      Bottom</span><span style="color: #007700">=</span><span style="color: #0000BB">25<br />
      <br /></span> <span style="color: #007700">;********************<br />
      ;</span><span style="color: #0000BB">EClients</span><span style="color: #007700">*<br />
      ;********************<br />
      ***91;</span><span style="color: #0000BB">Field6</span><span style="color: #007700">***93;<br /></span> <span style="color: #0000BB">Type</span><span style="color: #007700">=</span><span style="color: #0000BB">Checkbox<br />
      Text</span><span style="color: #007700">=</span><span style="color: #0000BB">E1<br />
      State</span><span style="color: #007700">=</span><span style="color: #0000BB">0<br />
      Left</span><span style="color: #007700">=</span><span style="color: #0000BB">20<br />
      Right</span><span style="color: #007700">=</span><span style="color: #0000BB">100<br />
      Top</span><span style="color: #007700">=</span><span style="color: #0000BB">45<br />
      Bottom</span><span style="color: #007700">=</span><span style="color: #0000BB">55<br />
      <br /></span> <span style="color: #007700">***91;</span><span style="color: #0000BB">Field7</span><span style="color: #007700">***93;<br /></span> <span style="color: #0000BB">Type</span><span style="color: #007700">=</span><span style="color: #0000BB">Checkbox<br />
      Text</span><span style="color: #007700">=</span><span style="color: #0000BB">E2<br />
      State</span><span style="color: #007700">=</span><span style="color: #0000BB">0<br />
      Left</span><span style="color: #007700">=</span><span style="color: #0000BB">100<br />
      Right</span><span style="color: #007700">=</span><span style="color: #0000BB">180<br />
      Top</span><span style="color: #007700">=</span><span style="color: #0000BB">45<br />
      Bottom</span><span style="color: #007700">=</span><span style="color: #0000BB">55<br />
      <br /></span> <span style="color: #007700">***91;</span><span style="color: #0000BB">Field8</span><span style="color: #007700">***93;<br /></span> <span style="color: #0000BB">Type</span><span style="color: #007700">=</span><span style="color: #0000BB">Checkbox<br />
      Text</span><span style="color: #007700">=</span><span style="color: #0000BB">E3<br />
      State</span><span style="color: #007700">=</span><span style="color: #0000BB">0<br />
      Left</span><span style="color: #007700">=</span><span style="color: #0000BB">20<br />
      Right</span><span style="color: #007700">=</span><span style="color: #0000BB">100<br />
      Top</span><span style="color: #007700">=</span><span style="color: #0000BB">60<br />
      Bottom</span><span style="color: #007700">=</span><span style="color: #0000BB">70<br />
      <br /></span> <span style="color: #007700">***91;</span><span style="color: #0000BB">Field9</span><span style="color: #007700">***93;<br /></span> <span style="color: #0000BB">Type</span><span style="color: #007700">=</span><span style="color: #0000BB">Checkbox<br />
      Text</span><span style="color: #007700">=</span><span style="color: #0000BB">E4<br />
      Left</span><span style="color: #007700">=</span><span style="color: #0000BB">100<br />
      Right</span><span style="color: #007700">=</span><span style="color: #0000BB">180<br />
      Top</span><span style="color: #007700">=</span><span style="color: #0000BB">60<br />
      Bottom</span><span style="color: #007700">=</span><span style="color: #0000BB">70<br /></span> <span style="color: #007700">;********************<br />
      ;</span><span style="color: #0000BB">IClients</span><span style="color: #007700">*<br />
      ;********************<br />
      ***91;</span><span style="color: #0000BB">Field10</span><span style="color: #007700">***93;<br /></span> <span style="color: #0000BB">Type</span><span style="color: #007700">=</span><span style="color: #0000BB">Checkbox<br />
      Text</span><span style="color: #007700">=</span><span style="color: #0000BB">I1<br />
      Left</span><span style="color: #007700">=</span><span style="color: #0000BB">20<br />
      Right</span><span style="color: #007700">=</span><span style="color: #0000BB">100<br />
      Top</span><span style="color: #007700">=</span><span style="color: #0000BB">90<br />
      Bottom</span><span style="color: #007700">=</span><span style="color: #0000BB">100<br /></span></span> <!-- php buffer end -->
      <hr />
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
      <span class="post-time small text-muted">1st September 2006 11:23 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">I don't understand the question. What are those components you wish to install? What do you mean by including them? Do you want to include files with the installer? If so, use File.<br />
      <br />
      If you're asking about installing files to a remote computer, that depends on the protocol you wish to use and the access method. If you wish to use Windows shares, simply write the files to \\server\share, it works just like any other directory.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Amun</span><br />
      <span class="post-time small text-muted">1st September 2006 12:26 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">The problem: you select one ore more Clients in Custom Page.<br />
      The Sections (1,2,3), there selectet in Components Page must include in the loop.<br />
      <br />
      Sample:<br />
      Select on Customepage "select_pc" 2 Clients<br />
      This 2 Clients where Written in a temp File pc.txt<br />
      Start MUI_PAGE_COMPONENTS<br />
      Select Section 1 and 3<br />
      start MUI_PAGE_INSTFILES<br />
      Read fist line from pc.txt<br />
      Result = Client1<br />
      Install selected Sections on Clint1<br />
      Read next line from pc.txt<br />
      Result = Client2<br />
      Install selected Sections on Client2<br />
      Read next line from pc.txt<br />
      Result = empty<br />
      Start MUI_PAGE_FINISH<br />
      <br />
      <br />
      The Components in the Sample are only you see the Sections are Starts.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
      <span class="post-time small text-muted">1st September 2006 12:42 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">So you're asking how to select section from the script? For that you have the macros in Sections.nsh named SelectSection and UnselectSection.</p>
    </div>
    <hr />

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]>
  </script>
</body>
</html>
