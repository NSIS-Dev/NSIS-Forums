<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="description" content="Weird behavior of ExecWait"><title>Weird behavior of ExecWait - NSIS Forums</title><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script><link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css"><link rel="stylesheet" href="../css/style.css" type="text/css"><!--[if lt IE 9]><script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script><script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script><![endif]--></head><body><div class="container"><ol class="breadcrumb"><li><a href="../index.html" class="glyphicon glyphicon-home"></a></li><li><a href="f-65.html">NSIS Discussion</a></li><li class="active">Weird behavior of ExecWait</li></ol><p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=220670">Weird behavior of ExecWait</a></p><br><div class="post"><p class="post-meta"><span class="post-author text-primary">SneakySly</span><br><span class="post-time small text-muted">4th July 2005 21:59 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>Weird behavior of ExecWait</strong><br>Hello,<br>The software Im installing using NSIS consists in windows services. When installing, once the files are copied I call the following and all works very well:<br><br>; Install the service<br>ExecWait "installutil MyService.exe"<br><br>; Start the service<br>ExecWait "net start $\"My Windows Service$\""<br><br>Then comes the time of uninstalling, I want the uninstaller to stop the service and remove it from the windows services. So I do the following:<br><br>ExecWait 'net stop $\"My Windows Service$\"'<br>Sleep 1000<br><br>; Uninstall the service<br>ExecWait "installutil MyService.exe /u"<br>Sleep 1000<br><br>Doing so, the service stops as expected. However, it does not get uniinstalled using installutil as expected. NSIS seems just to skip this step the service is never removed from the list of services installed in Windows.<br><br>Anyone got an idea why would this happen?<br>Thanks for your help,</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Takhir</span><br><span class="post-time small text-muted">5th July 2005 07:04 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">1. If we are talking about .net\framework installutil.exe, you can also use one of DOS plug-ins, nsExec (included to NSIS package, program files\nsis\contrib\nsexec) or <a href="http://nsis.sourceforge.net/wiki/ExecDos" target="_blank">ExecDos</a>, this allow to hide dos window.<br>2. If you don't see any output in the DOS window on ExecWait call, this means that executable not found. PATH env. var on my comp not includes framework folder, in uninstaller it is very usefull to set full path, for example<br>ExecWait "'$WINDIR\Microsoft.NET\Framework\v1.1.4322\installutil.exe' MyService.exe /u"<br>(or extract framework path from registry).</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">SneakySly</span><br><span class="post-time small text-muted">5th July 2005 22:19 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">1. Thanks for the tip, it does look nicer and more professional without the DOS window.<br>I used nsExec::ExecToLog instead, now all the output of the execution is in the details instead, pretty nice :).<br><br>2. Using full paths, it worked well. Looks like you were right. What I had done is include the installutil.exe in the package so it could be called from the installation folder (wouldnt have to look for the .Net path). It works fine for installing the service, it just doesnt work when uninstalling (couldnt find the reason why).<br><br>nsExec::ExecToLog "installutil MyService.exe"<br>works all good<br><br>ExecWait "installutil MyService.exe /u"<br>wont work... So it looks like using the option "/u" screws up smtg and I couldnt figure out what.<br><br>Anyways, thanks for the tip I guess I will just retrieve the .NET framework path and do it the right way.<br><br>Regards,</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">DonChunior</span><br><span class="post-time small text-muted">23rd June 2010 15:03 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">I know that the tread is from a long time ago, but I had exactely the same problem SneakySly.<br>The reason for not working of ExecWait is following: <a href="http://nsis.sourceforge.net/Docs/Chapter4.html#4.6.2" target="_blank">The uninstaller is transparently copied to the system temporary directory for the uninstall.</a><br><br>Regards, DonChunior</p></div><hr><div class="footer"><p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p></div></div><script src="../js/highlight.pack.js" type="text/javascript"></script><script type="text/javascript">//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]></script></body></html>