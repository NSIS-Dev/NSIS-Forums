<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="description" content="Probleme recuperate var in custom pages"><title>Probleme recuperate var in custom pages - NSIS Forums</title><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script><link rel="preload" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css" as="style" onload="this.rel='stylesheet'"><link rel="preload" href="../css/style.css" as="style" onload="this.rel='stylesheet'"><noscript><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css"><link rel="stylesheet" href="../css/style.css"></noscript><script>!function(a){"use strict";var b=function(b,c,d){function e(a){return h.body?a():void setTimeout(function(){e(a)})}function f(){i.addEventListener&&i.removeEventListener("load",f),i.media=d||"all"}var g,h=a.document,i=h.createElement("link");if(c)g=c;else{var j=(h.body||h.getElementsByTagName("head")[0]).childNodes;g=j[j.length-1]}var k=h.styleSheets;i.rel="stylesheet",i.href=b,i.media="only x",e(function(){g.parentNode.insertBefore(i,c?g:g.nextSibling)});var l=function(a){for(var b=i.href,c=k.length;c--;)if(k[c].href===b)return a();setTimeout(function(){l(a)})};return i.addEventListener&&i.addEventListener("load",f),i.onloadcssdefined=l,l(f),i};"undefined"!=typeof exports?exports.loadCSS=b:a.loadCSS=b}("undefined"!=typeof global?global:this);!function(a){if(a.loadCSS){var b=loadCSS.relpreload={};if(b.support=function(){try{return a.document.createElement("link").relList.supports("preload")}catch(b){return!1}},b.poly=function(){for(var b=a.document.getElementsByTagName("link"),c=0;c<b.length;c++){var d=b[c];"preload"===d.rel&&"style"===d.getAttribute("as")&&(a.loadCSS(d.href,d,d.getAttribute("media")),d.rel=null)}},!b.support()){b.poly();var c=a.setInterval(b.poly,300);a.addEventListener&&a.addEventListener("load",function(){b.poly(),a.clearInterval(c)}),a.attachEvent&&a.attachEvent("onload",function(){a.clearInterval(c)})}}}(this);</script></head><body><div class="container"><ol class="breadcrumb"><li><a href="../index.html" class="glyphicon glyphicon-home"></a></li><li><a href="f-65.html">NSIS Discussion</a></li><li class="active">Probleme recuperate var in custom pages</li></ol><p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=351571">Probleme recuperate var in custom pages</a></p><br><div class="post"><p class="post-meta"><span class="post-author text-primary">devcphp</span><br><span class="post-time small text-muted">7th November 2012 13:28 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>Probleme recuperate var in custom pages</strong><br>Hi<br><br>I want to recuperate some var in a custom pages but i can't realise it.<br><br></p><pre>
<code>!insertmacro MUI_PAGE_WELCOME<br>!insertmacro MUI_PAGE_DIRECTORY<br><br>Page custom ShowCustomPageConfigurationMatricesServeur  LeaveCustomPageConfigurationMatricesServeur<br><br>    Function ShowCustomPageConfigurationMatricesServeur<br>      ReserveFile "${PAGE_CUSTOM_MATRICES_SERVEUR}"<br>      !insertmacro MUI_HEADER_TEXT "Personnalisation" ""<br>      !insertmacro MUI_INSTALLOPTIONS_EXTRACT "${PAGE_CUSTOM_MATRICES_SERVEUR}"<br>      !insertmacro MUI_INSTALLOPTIONS_DISPLAY "${PAGE_CUSTOM_MATRICES_SERVEUR}"<br>    FunctionEnd<br>    Function LeaveCustomPageConfigurationMatricesServeur<br>        ReadINIStr $R0 "${PAGE_CUSTOM_MATRICES_SERVEUR}" "Field 1" "State"    <br>        <br>      <br>        ReadINIStr $R1 "${PAGE_CUSTOM_MATRICES_SERVEUR}" "Field 2" "State"    <br>        ReadINIStr $R2 "${PAGE_CUSTOM_MATRICES_SERVEUR}" "Field 3" "State"    <br>        ReadINIStr $R4 "${PAGE_CUSTOM_MATRICES_SERVEUR}" "Field 4" "State"    <br>        ReadINIStr $R5 "${PAGE_CUSTOM_MATRICES_SERVEUR}" "Field 9" "State"   <br>        ReadINIStr $R6 "${PAGE_CUSTOM_MATRICES_SERVEUR}" "Field 12" "State"   <br>        <br>       FileOpen $0 ${NOM_FICHIER_PARAMETRAGE_XML} w<br>       FileWrite $0 "&lt;?xml version=$\"1.0$\" encoding=$\"ISO-8859-1$\" standalone=$\"no$\"?$\r$\n"<br>       FileWrite $0 "&lt;!-- standalone=no pour faire savoir à l'analyseur syntaxique xml que la dtd se trouve dans un fichier séparé--&gt;$\r$\n"<br>     <br>       FileWrite $0 "&lt;!DOCTYPE ParametrageGeneral SYSTEM $\"Parametrage.dtd$\"&gt;$\r$\n"<br>       FileWrite $0 "&lt;ParametrageGeneral&gt;$\r$\n$\t"<br>       FileWrite $0 "&lt;!--Configuration des éléments nécéssaires aux types de connexions aux bases de données--&gt;$\r$\n$\t"<br>       FileWrite $0 "&lt;TypeConnexions&gt;$\r$\n$\t"<br>       FileWrite $0 "&lt;ParamTypeConnexion id=$\"CONNECTION_TO_ACCESS$\"&gt;odbc:Driver={Microsoft Access Driver (*.mdb)};Dbq=&lt;/ParamTypeConnexion&gt;$\r$\n$\t"<br>       FileWrite $0 "&lt;/TypeConnexions&gt;$\r$\n"<br>       FileWrite $0 "&lt;Connexions&gt;$\r$\n$\t"<br>       FileWrite $0 "&lt;ParamConnexion id=$\"CONNECTION_TO_ACCESS_ANALYSIMMO$\"&gt;$R0&lt;/ParamConnexion&gt;$\r$\n$\t"<br>       FileWrite $0 "&lt;ParamConnexion id=$\"CONNECTION_TO_MYDB$\"&gt;$R2&lt;/ParamConnexion&gt;$\r$\n$\t"<br>       FileWrite $0 "&lt;ParamConnexion id=$\"CONNECTION_TO_ACCESS_DPE$\"&gt;$R1&lt;/ParamConnexion&gt;$\r$\n$\t"<br>       FileWrite $0 "&lt;ParamConnexion id=$\"CONNECTION_TO_CADASTRE$\"&gt;http://www.cadastre.gouv.fr&lt;/ParamConnexion&gt;$\r$\n"<br>       FileWrite $0 "&lt;/Connexions&gt;$\r$\n"<br>       FileWrite $0 "&lt;!--Configuration des éléments nécéssaires aux documents--&gt;$\r$\n"<br>       FileWrite $0 "&lt;Generations&gt;$\r$\n$\t"<br>       FileWrite $0 "&lt;ParamGeneration id=$\"SCRIPT_VB_TO_PDF$\"&gt;$INSTDIR\${PDFCREATOR_DATA_FICHIERS_SOURCES}\Convert2Pdf.vbs&lt;/ParamGeneration&gt;$\r$\n$\t"<br>       FileWrite $0 "&lt;ParamGeneration id=$\"SCRIPT_VB_TO_PNG$\"&gt;$INSTDIR\${PDFCREATOR_DATA_FICHIERS_SOURCES}\Convert2Png.vbs&lt;/ParamGeneration&gt;$\r$\n$\t"<br>       FileWrite $0 "&lt;ParamGeneration id=$\"SCRIPT_VB_TO_TIFF$\"&gt;$INSTDIR\${PDFCREATOR_DATA_FICHIERS_SOURCES}\Convert2Tiff.vbs&lt;/ParamGeneration&gt;$\r$\n$\t"<br>       FileWrite $0 "&lt;ParamGeneration id=$\"SCRIPT_VB_TO_BMP$\"&gt;$INSTDIR\${PDFCREATOR_DATA_FICHIERS_SOURCES}\Convert2Bmp.vbs&lt;/ParamGeneration&gt;$\r$\n$\t"<br>       FileWrite $0 "&lt;ParamGeneration id=$\"SCRIPT_VB_TO_JPG$\"&gt;$INSTDIR\${PDFCREATOR_DATA_FICHIERS_SOURCES}\Convert2Jpg.vbs&lt;/ParamGeneration&gt;$\r$\n$\t"<br>       FileWrite $0 "&lt;ParamGeneration id=$\"CHEMIN_DE_GENERATION$\"&gt;$R6&lt;/ParamGeneration&gt;$\r$\n$\t"<br>       FileWrite $0 "&lt;ParamGeneration id=$\"MATRICE_ERNT$\"&gt;$R2&lt;/ParamGeneration&gt;$\r$\n$\t"<br>       FileWrite $0 "&lt;ParamGeneration id=$\"MATRICE_NON_INDEMNISATION$\"&gt;$R4&lt;/ParamGeneration&gt;$\r$\n$\t"<br>       FileWrite $0 "&lt;ParamGeneration id=$\"MATRICE_INDEMNISATION$\"&gt;$R5&lt;/ParamGeneration&gt;$\r$\n"<br>       FileWrite $0 "&lt;Versions&gt;$\r$\n$\t"<br>       FileWrite $0 " &lt;ParamVersion id=$\"VERSION_FICHIER_XML_PARAMETRAGE$\"&gt;2.0.3&lt;/ParamVersion&gt;$\r$\n$\t"<br>       FileWrite $0 "&lt;!--&lt;ParamVersion id=$\"VERSION_LOGICIEL$\"&gt;2.0.0&lt;/ParamVersion&gt;--&gt;$\r$\n$\t"<br>       FileWrite $0 "&lt;ParamVersion id=$\"VERSION_SERVEUR_ERNT$\"&gt;3.0.0&lt;/ParamVersion&gt;$\r$\n"<br>       FileWrite $0 "&lt;/Versions&gt;$\r$\n"<br>       FileClose $0<br>    FunctionEnd</code>
</pre><br>
      <br>
      i write an xml file but whitout any var.<br>
      <br>
      But if i write manually the state in the .ini file, the xml file output contain the variable.<br>
      <br>
      Where is my error?
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">MSG</span><br>
      <span class="post-time small text-muted">7th November 2012 14:31 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">(Please use pastebin or an attachment to share large amounts of code.)<br>
      <br>
      First of all, verify that $R0-6 contains the proper value, using a MessageBox. If the variable is empty, it cannot be written to a file either.<br>
      Second, your code example is rather unclear. Please provide a minimal script that shows your problem (without ${defines} that we don't know, etc...), and explain what it should do and what it actually does.</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">devcphp</span><br>
      <span class="post-time small text-muted">7th November 2012 15:03 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">thank's for your response.<br>
      When i use a sgBox, i don't have any value of my var.<br>
      <br>
      i will modify my code as you like</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">MSG</span><br>
      <span class="post-time small text-muted">7th November 2012 16:35 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">If the Msgbox is empty, it means either the state is not set, or the ini file is not being read properly. Since manually editing the ini works, we must conclude that the state is not set.<br>
      <br>
      Not sure how that's happening, it's been years since I've touched InstallOptions. Perhaps someone else can help you, but that's where the problem appears to begin, at least.</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">devcphp</span><br>
      <span class="post-time small text-muted">8th November 2012 14:18 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">effectively the state is not set. If i set it manuelly by editing the ini file no problem. if not nothing is read.</p>
    </div>
    <hr>

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script type="text/javascript" src="../js/highlight.pack.js" async>
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]></script></body></html>