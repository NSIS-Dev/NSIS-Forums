<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="description" content="Information!"><title>Information! - NSIS Forums</title><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script><link rel="preload" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css" as="style" onload="this.rel='stylesheet'"><link rel="preload" href="../css/style.css" as="style" onload="this.rel='stylesheet'"><noscript><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css"><link rel="stylesheet" href="../css/style.css"></noscript><script>!function(a){"use strict";var b=function(b,c,d){function e(a){return h.body?a():void setTimeout(function(){e(a)})}function f(){i.addEventListener&&i.removeEventListener("load",f),i.media=d||"all"}var g,h=a.document,i=h.createElement("link");if(c)g=c;else{var j=(h.body||h.getElementsByTagName("head")[0]).childNodes;g=j[j.length-1]}var k=h.styleSheets;i.rel="stylesheet",i.href=b,i.media="only x",e(function(){g.parentNode.insertBefore(i,c?g:g.nextSibling)});var l=function(a){for(var b=i.href,c=k.length;c--;)if(k[c].href===b)return a();setTimeout(function(){l(a)})};return i.addEventListener&&i.addEventListener("load",f),i.onloadcssdefined=l,l(f),i};"undefined"!=typeof exports?exports.loadCSS=b:a.loadCSS=b}("undefined"!=typeof global?global:this);!function(a){if(a.loadCSS){var b=loadCSS.relpreload={};if(b.support=function(){try{return a.document.createElement("link").relList.supports("preload")}catch(b){return!1}},b.poly=function(){for(var b=a.document.getElementsByTagName("link"),c=0;c<b.length;c++){var d=b[c];"preload"===d.rel&&"style"===d.getAttribute("as")&&(a.loadCSS(d.href,d,d.getAttribute("media")),d.rel=null)}},!b.support()){b.poly();var c=a.setInterval(b.poly,300);a.addEventListener&&a.addEventListener("load",function(){b.poly(),a.clearInterval(c)}),a.attachEvent&&a.attachEvent("onload",function(){a.clearInterval(c)})}}}(this);</script></head><body><div class="container"><ol class="breadcrumb"><li><a href="../index.html" class="glyphicon glyphicon-home"></a></li><li><a href="f-65.html">NSIS Discussion</a></li><li class="active">Information!</li></ol><p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=90681">Information!</a></p><br><div class="post"><p class="post-meta"><span class="post-author text-primary">balashankerg</span><br><span class="post-time small text-muted">11th June 2002 13:23 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>Help Needed!</strong><br>Hello,<br><br>Anyone could help me!<br><br>I'm making/writing a background program(bitmap) that runs under installation with the help av win32(c++).<br>I would like anyone could help me, how can I make a window that has caption/title bar and icon at upper left corner but doesn't show at taskbar!<br><br>I tried most of the window styles including WS_EX_TOOLWINDOW but it doesn't show icon at upper left corner!<br><br>Could anyone guide me!<br><br>Help me as soon as possible.<br><br>Best regards<br>Shanker</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Sunjammer</span><br><span class="post-time small text-muted">11th June 2002 14:14 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>MSDN October 2001</strong><br>The October 2001 MSDN Library contains the following text in a document called "The Taskbar" :-<br><br></p><blockquote>Managing Taskbar Buttons<br>The Shell creates a button on the taskbar whenever an application creates a window that isn't owned. To ensure that the window button is placed on the taskbar, create an unowned window with the WS_EX_APPWINDOW extended style. To prevent the window button from being placed on the taskbar, create the unowned window with the WS_EX_TOOLWINDOW extended style. As an alternative, you can create a hidden window and make this hidden window the owner of your visible window.<br><br>The Shell will remove a window's button from the taskbar only if the window's style supports visible taskbar buttons. If you want to dynamically change a window's style to one that doesn't support visible taskbar buttons, you must hide the window first (by calling ShowWindow with SW_HIDE), change the window style, and then show the window.</blockquote>I'll see if I can find some example code for you.<br><br>---<br><br>Ximon Eighteen<br>Programmer @ Advent Publishing Systems<br>email: <a href="mailto:ximon_eighteen@3b2.com">ximon_eighteen@3b2.com</a><br>&amp; msn: <a href="mailto:ximon_eighteen@hotmail.com">ximon_eighteen@hotmail.com</a></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Sunjammer</span><br><span class="post-time small text-muted">11th June 2002 15:40 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>Hidden Windows Unleashed</strong><br>It seems that the secret is to use a WM_POPUP window that has a hidden parent window. The following code works :- (it's not quoted from anywhere, just looks neater in the quote box ;))<br><br>I doubt you need the #defines for Win2k (the 0x0500 stuff).<br><br><b>[edit by Smile2Me]</b><br>Message was much too long. Code has been attached to the next post. Read <a href="http://forums.winamp.com/announcement.php?s=&amp;forumid=65" target="_blank">this</a>.</p><blockquote>For text, please try and keep it to 3 lines max.</blockquote>I understand that messages sometimes need to be longer to explain clearly the problem or the solution, but if you can reduce the length by attaching code instead of posting it, please do so.<br><b>[/edit]</b></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Smile2Me</span><br><span class="post-time small text-muted">12th June 2002 09:50 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">The code.<br><br>-Hendri.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Sunjammer</span><br><span class="post-time small text-muted">12th June 2002 09:59 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">3 lines!!! What's the point in that?<br><br>Well I'm not attaching/zipping stuff in future, I'll just not post it at all.... I can't believe that rule.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Smile2Me</span><br><span class="post-time small text-muted">12th June 2002 10:04 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Please cool down Ximon,<br><br>the rule is, as mentioned in the Forum rules, to keep the Forum neat. As I already explained, I'm NOT very strict at this point (otherwise I need to edit almost all posts), but If you can minimize please help us to avoid annoying long posts. See the rules for more information.<br><br>I don't think it's that much trouble. I'm not asking that much. Please keep sharing your knowledge with us.<br><br>-Hendri.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">kichik</span><br><span class="post-time small text-muted">12th June 2002 14:19 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Please see this thread:<br><br><a href="http://forums.winamp.com/showthread.php?s=&amp;threadid=88802" target="_blank">http://forums.winamp.com/showthread....threadid=88802</a><br><br>I have started this program, you can see all you need in there. If you can help me fix that annoying hooking bug it will be finally ready. I don't think I will be able to finish this alone this month so I will appreciate it if you can help me out.<br><br>KiCHiK</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Sunjammer</span><br><span class="post-time small text-muted">12th June 2002 15:45 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>Confused</strong><br>I have to say I'm a little confused. I downloaded your code and built and ran it and yes sometimes it leaves the .exe behind in the $TEMP directory, I assume this is your problem.<br><br>However, I am assuming that this is because you are immediately calling Delete on the file after sending the close message to the background picture application. Sometimes therefore the message might not have been received and fully acted upon by the time the Delete action is attempted.<br><br>I changed your delete code to the following and have not been able to reproduce the problem anymore. Am I missing something? (note this example is not very safe, you might only want to retry about 5 times max, possibly with a tiny delay between delete attempts).<br><br></p><pre>
<code>  retry:<br>  Delete "$TEMP\_bg.exe"<br>  IfFileExists "$TEMP\_bg.exe" retry 0<br></code>
</pre>And do the same for the bmp file too.<br>
      <br>
      I really think I must be missing the point of your thread about a problem with the code. I downloaded code from Hendri's website, that was right yes?
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Smile2Me</span><br>
      <span class="post-time small text-muted">12th June 2002 17:24 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Ximon,<br>
      <br>
      I'm getting confused now too.<br>
      <br>
      First of all, KiCHiK has a problem with the dll not getting deleted. His code is on his website. Second, Shanker has the problem described in the post by him. His code is on my website.<br>
      <br>
      Furthermore, two versions are available on my website. The one by Shanker (in C) and the one by me (in Delphi). Both codes already contain "Sleep 500" before deleting the files. I saw Shanker disabled that command in his code. Maybe it was not necessary anymore.<br>
      <br>
      Please clarify what code you downloaded.<br>
      <br>
      -Hendri.</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Sunjammer</span><br>
      <span class="post-time small text-muted">12th June 2002 17:38 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">I think I understand now - I knew I must have something wrong.<br>
      <br>
      From various comments (such as "Balashanker has put the program to C." and "Thanks to Balashanker NSISBGImage will have resizing support tomorrow") I got the idea that Balashankar had been working on the same code as Kichik and that therefore the Balashankar code on your site was what was being talked about.<br>
      <br>
      What made me confused was the mention of a DLL when all I could see was an EXE ;)<br>
      <br>
      When I saw that the Sleep 500 had been commented out, and that running the BG stuff on my machine sometimes left the .EXE file behind, I figured that the Sleep 500 either hadn't solved the problem or was an unsatisfactory solution... anyway I'll look at the Kichik site when I get home from work and see what I can make of that instead of the other one :p<br>
      <br>
      X</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br>
      <span class="post-time small text-muted">12th June 2002 17:56 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">The DLL function Destroy waits for the EXE's process to end there for it can be deleted. The problem is with the DLL and something with those damn hooks. When I run the compiled installer with NSISBGImage a couple of times my Windows starts acting crazy. Menus no longer work and it just won't react to some of my actions. Hooks can not be set anymore either... Very weird stuff.<br>
      <br>
      The resizing has been partly implented. I just need to put the proper functions in the DLL.<br>
      <br>
      My program is supposed to solve the problem that makes the background disappear after you Alt+Tab out of NSIS and back. For this I encapsulated NSIS window inside my window using a hook. And that is where all the problems began. I triple checked I am freeing all the things needed to be freed yet the DLL does not get deleted and this weird stuff I was talking about before happens.</p>
    </div>
    <hr>

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script type="text/javascript" src="../js/highlight.pack.js" async>
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]></script></body></html>