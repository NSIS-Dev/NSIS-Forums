<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="description" content="Check for Windows 7 / Seven"><title>Check for Windows 7 / Seven - NSIS Forums</title><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script><link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css"><link rel="stylesheet" href="../css/style.css" type="text/css"><!--[if lt IE 9]><script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script><script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script><![endif]--></head><body><div class="container"><ol class="breadcrumb"><li><a href="../index.html" class="glyphicon glyphicon-home"></a></li><li><a href="f-65.html">NSIS Discussion</a></li><li class="active">Check for Windows 7 / Seven</li></ol><p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=305675">Check for Windows 7 / Seven</a></p><br><div class="post"><p class="post-meta"><span class="post-author text-primary">kando234</span><br><span class="post-time small text-muted">24th April 2009 08:58 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>Check for Windows 7 / Seven</strong><br>Hi,<br><br>is there any way to check if user is running Windows 7 ?<br><br>Thanks<br>and greets<br>kando</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Anders</span><br><span class="post-time small text-muted">24th April 2009 09:06 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">WinVer.nsh will give you the version number, so check for &gt;=6.1</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">kando234</span><br><span class="post-time small text-muted">24th April 2009 09:46 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">How to do that with WinVer.nsh ?<br><br>It offers me only the following functions<br>and not getting the version number to compare it ?<br><br></p><pre>
<code><br>; AtLeastWin&lt;version&gt; checks if the installer is running on Windows version at least as specified.<br>; IsWin&lt;version&gt; checks if the installer is running on Windows version exactly as specified.<br>; AtMostWin&lt;version&gt; checks if the installer is running on Windows version at most as specified.<br>;<br>; &lt;version&gt; can be replaced with the following values:<br>;<br>;   95<br>;   98<br>;   ME<br>;<br>;   NT4<br>;   2000<br>;   XP<br>;   2003<br>;   Vista<br>;   2008<br></code>
</pre>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Animaether</span><br>
      <span class="post-time small text-muted">24th April 2009 16:33 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">It's slightly hidden away / not documented. Near the bottom of WinVer.nsh are the bits you'll want to peek at. Example:<br>
      <br></p>
      <pre>
<code><br>${WinVerGetMajor} $0<br>${WinVerGetMinor} $1<br>${WinVerGetBuild} $2<br>${WinVerGetServicePackLevel} $3<br>MessageBox MB_OK "$0.$1.$2 SP$3"<br></code>
</pre>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br>
      <span class="post-time small text-muted">10th May 2009 14:59 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Windows 7 has settled on 6.1? If so, we should add it to WinVer.nsh.</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Animaether</span><br>
      <span class="post-time small text-muted">10th May 2009 17:00 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">The Release Candidate, Build 7100, is version 6.1, yes.<br>
      <br>
      For confirmation.. download and install, or poke at a number of websites who have done so and peruse screenshots of the 'about screen' :)<br>
      <br>
      There was some talk of that 6.1 not being the case if they ever got around to implementing minwin but.. yeah</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Anders</span><br>
      <span class="post-time small text-muted">10th May 2009 21:01 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">minwin was never a product, closest you get is server core<br>
      <br>
      We don't know the build number until RTM, but using 6.1.0000 for now would probably work</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Pawel</span><br>
      <span class="post-time small text-muted">10th May 2009 21:16 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"></p>

      <blockquote>
        <i>Originally posted by Animaether</i><br>
        <b>The Release Candidate, Build 7100, is version 6.1, yes.<br>
        <br>
        For confirmation.. download and install, or poke at a number of websites who have done so and peruse screenshots of the 'about screen' :)<br></b>
      </blockquote>Here is a screenshot. it is 6.1 for now.<br>
      <a href="http://shup.com/Shup/156791/Untitled.png" target="_blank">http://shup.com/Shup/156791/Untitled.png</a><br>
      -Pawel
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">th_mi</span><br>
      <span class="post-time small text-muted">11th May 2009 12:14 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"></p>

      <blockquote>
        <i>Originally posted by PepeSoft</i><br>
        <b>Here is a screenshot. it is 6.1 for now.<br>
        <a href="http://shup.com/Shup/156791/Untitled.png" target="_blank">[Image]</a><br>
        -Pawel</b>
      </blockquote>And it will be 6.1 later in W7. See here:<br>
      <a href="http://msdn.microsoft.com/en-us/library/ms724833(VS.85).aspx" target="_blank">http://msdn.microsoft.com/en-us/libr...33(VS.85).aspx</a><br>
      (MSDN documentation "OSVERSIONINFOEX Structure" of function "GetVersionEx")<br>
      <br>
      Even if this piece of software is called "Windows Seven" the internal version number is "6.1" :D
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br>
      <span class="post-time small text-muted">11th May 2009 12:39 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">That MSDN page also says Windows 2008 R2 has the same version number. Need to work around that one like we worked around Vista and 2008. Anders, care to handle this?</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Anders</span><br>
      <span class="post-time small text-muted">11th May 2009 17:47 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">for those that can't wait for the next release, get it from <a href="http://nsis.svn.sourceforge.net/viewvc/nsis/NSIS/trunk/Include/WinVer.nsh" target="_blank">http://nsis.svn.sourceforge.net/view...ude/WinVer.nsh</a></p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br>
      <span class="post-time small text-muted">11th May 2009 18:19 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Also, if anyone has Windows 7 and/or Windows Server 2008 R2, please add it to <a href="http://forums.winamp.com/showthread.php?s=&amp;threadid=300436&amp;highlight=winver" target="_blank">the WinVer test thread</a>.</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Pawel</span><br>
      <span class="post-time small text-muted">16th May 2009 14:18 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"></p>

      <blockquote>
        <i>Originally posted by kichik</i><br>
        <b>Also, if anyone has Windows 7 and/or Windows Server 2008 R2, please add it to <a href="http://forums.winamp.com/showthread.php?s=&amp;threadid=300436&amp;highlight=winver" target="_blank">the WinVer test thread</a>.</b>
      </blockquote>Kichik,<br>
      I want to test it, but what tool should I use?<br>
      Should I use WinVer, from that thread? Is it updated to support win7?<br>
      -Pawel
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br>
      <span class="post-time small text-muted">16th May 2009 15:18 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">The tool from the thread is version independent. The version attached there should work fine on Windows 7 as well.</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">jweinraub</span><br>
      <span class="post-time small text-muted">8th June 2009 16:51 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">I can't seem to get Windows 7 to even show up with I pop the variable. I am using the latest WinVer.nsh that includes Win7 routines.<br>
      <br>
      Any help is greatly appreciated.<br>
      <br>
      Please see my code.<br>
      <br></p>
      <pre>
<code><br>Function .onInit<br><br>GetVersion::WindowsName<br>Pop $R0<br><br>;${If} $R1 == "64"<br>;  Goto no64<br>;${EndIf}<br>${If} $R0 == "XP"<br>  Goto xp<br>${ElseIf} $R0 == "XP x64"<br>  Goto go_away<br>${ElseIf} $R0 == "2000"<br>  Goto go_away<br>${ElseIf} $R0 == "Server 2003"<br>  Goto go_away<br>${Elseif} $R0 == "Server 2003 R2"<br>  Goto go_away<br>${Elseif} $R0 == "Vista"   <br>  Goto vista<br>${Else}<br>  Goto error<br>${EndIf}<br>; i suppose i do need to add a win7 block?  will there be multiple SKUs like Vista?<br><br><br>xp:<br>   GetVersion::WindowsType<br>   Pop $R0<br>   ${If} $R0 == "Professional"<br>   ${OrIf} $R0 == "Tablet PC Edition"<br>     Goto go_away<br>   ${Else}<br>     Goto non_professional<br>   ${EndIf}<br><br>non_professional:<br>  MessageBox MB_YESNO|MB_ICONEXCLAMATION|MB_TOPMOST|MB_DEFBUTTON2 \<br>  "The XYZ-Soft software has not been tested on, and is not supported on Windows XP $R1.$\r$\n$\r$\nXYZ-Tek cannot \<br>  provide technical support for this installation.$\r$\n$\r$\nDo you want to continue?" \<br>  IDYES go_away IDNO done<br>    <br>vista:<br>   GetVersion::WindowsType<br>   Pop $R1<br><br>     ${If} $R1 == "Home Basic Edition"<br>         MessageBox MB_YESNO|MB_ICONEXCLAMATION|MB_TOPMOST|MB_DEFBUTTON2 \<br>         "The XYZ-Soft software has not been tested on, and is not supported on Windows $R0 $R1.$\r$\n$\r$\nXYZ-Tek cannot \<br>         provide technical support for this installation.$\r$\n$\r$\nDo you want to continue?" \<br>         IDYES go_away IDNO done<br>     ${ElseIf} $R1 == "Home Premium Edition"<br>         MessageBox MB_YESNO|MB_ICONEXCLAMATION|MB_TOPMOST|MB_DEFBUTTON2 \<br>         "The XYZ-Soft software has not been tested on, and is not supported on Windows $R0 $R1.$\r$\n$\r$\nXYZ-Tek cannot \<br>         provide technical support for this installation.$\r$\n$\r$\nDo you want to continue?" \<br>        IDYES go_away IDNO done<br>      ${ElseIf} $R1 == "Starter Edition"<br>         MessageBox MB_YESNO|MB_ICONEXCLAMATION|MB_TOPMOST|MB_DEFBUTTON2 \<br>         "The XYZ-Soft software has not been tested on, and is not supported on Windows $R0 $R1.$\r$\n$\r$\nXYZ-Tek cannot \<br>         provide technical support for this installation.$\r$\n$\r$\nDo you want to continue?" \<br>         IDYES go_away IDNO done<br>      ${Else}<br>         Goto go_away<br>      ${EndIf}<br><br>error:<br>  ; generic block for the rest of OS's... 95,98,Me,7, etc. ??? <br>  MessageBox MB_YESNO|MB_ICONEXCLAMATION|MB_TOPMOST|MB_DEFBUTTON2 \<br>  "The XYZ-Soft software has not been tested on, and is not supported on Windows $R0 $R1.$\r$\n$\r$\nXYZ-Tek cannot \<br>  provide technical support for this installation.$\r$\n$\r$\nDo you want to continue?" \<br>  IDYES go_away IDNO done<br><br>done:<br>   Quit<br><br></code>
</pre>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br>
      <span class="post-time small text-muted">8th June 2009 17:15 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">You are using GetVersion plug-in and not WinVer.nsh. Use:</p>
      <pre>
<code>!include WinVer.nsh<br><br>${If} ${IsWin7}<br>  MessageBox MB_OK 7<br>${ElseIf} ${IsWin2000}<br>  MessageBox MB_OK 2000<br># etc... ${ElseIf}...<br>${EndIf}</code>
</pre>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">jweinraub</span><br>
      <span class="post-time small text-muted">8th June 2009 18:46 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">oops,<br>
      thanks! (i think i used winver at one point in my life but switched i guess, i think my old codebase has it).</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">jweinraub</span><br>
      <span class="post-time small text-muted">9th June 2009 14:46 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Okay.. I got a couple of more questions.<br>
      <br>
      In GetVersion they have the ability to find home edition detection (probably why i used it to begin with), is WinVer.nsh going to detect the different SKUs of Home/Vista/7 (Home/Pro/Home Basic/Ultimate/...) Is there a way to detect that?<br>
      <br>
      Also, I like to detect anything below Win 95 (Windows 1.0 - 3.11). is there a way to detect &lt; 95? (I know GetVersion does for example)<br>
      <br>
      Since I know GetVersion more, is my logic below correct? How do I get the version to display in the second message?<br>
      <br></p>
      <pre>
<code><br>Function .onInit<br><br>; Give warning about Windows 7<br><br>${If} ${IsWin7}<br>  MessageBox MB_YESNO|MB_ICONEXCLAMATION|MB_TOPMOST|MB_DEFBUTTON2 \<br>  "The blah software has not been tested on, and is not supported on Windows 7.$\r$\n$\r$\nFoobar Industries cannot \<br>  provide technical support for this installation.$\r$\n$\r$\nDo you still want to continue with the installation?" \<br>  IDYES go_away IDNO done<br>${ElseIf} ${AtLeastWin95}<br>     ${And} ${AtMostWinME}<br>       MessageBox MB_OK|MB_ICONSTOP "Windows -version- is not supported by the blah software." IDOK  ; Anything below 2000 throw error<br>       Quit<br>; what about below 95 (Win 1 - 3.11)<br>${EndIf}<br><br><br>done:<br>   Quit<br><br>go_away:<br>; ...<br></code>
</pre><br>
      <br>
      Thanks so much!
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Anders</span><br>
      <span class="post-time small text-muted">9th June 2009 15:12 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">lol, Win v1.<br>
      <br>
      AFAIK, NSIS does not work on anything below v4</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">jweinraub</span><br>
      <span class="post-time small text-muted">9th June 2009 16:18 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">I thought nsis did work with &lt; 4.<br>
      I thought it can with 3.1 at least, though i never verified it. i thought i saw it in some forum.</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Anders</span><br>
      <span class="post-time small text-muted">9th June 2009 16:32 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Win 3.1 is 16bit, you would have to install Win32s on there</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">jweinraub</span><br>
      <span class="post-time small text-muted">9th June 2009 20:20 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Okay but how do I determine the windows version using winver in the output?<br>
      <br></p>
      <pre>
<code><br>${ElseIf} ${AtLeastWin95}<br>     ${And} ${AtMostWinME}<br>       MessageBox MB_OK|MB_ICONSTOP "Windows -version- is not supported by the blah software." IDOK  ; Anything below 2000 throw error<br>       Quit<br>${EndIf}<br></code>
</pre><br>
      <br>
      That is generic code, so do i need to make an if for each version?<br>
      <br>
      I can't say : MessageBox MB_OK|MB_ICONSTOP "Windows ${WINVER} is .. " .. ?
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">jweinraub</span><br>
      <span class="post-time small text-muted">26th June 2009 14:54 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">My above code doeswnt seem to work. I tried changing And to AndIf and made no difference other than it allowed me to compile it.<br>
      <br>
      I am unable to execute the installer.</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Yathosho</span><br>
      <span class="post-time small text-muted">27th July 2009 13:47 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">it would be lovely, if WinVer could make a check if the user is running a 64-bit system (whether its xp, vista or win7 etc.). something like ${Is64bit}/${Is32bit} would be very helpful!</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Anders</span><br>
      <span class="post-time small text-muted">27th July 2009 14:43 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"></p>

      <blockquote>
        <i>Originally posted by Yathosho</i><br>
        <b>it would be lovely, if WinVer could make a check if the user is running a 64-bit system (whether its xp, vista or win7 etc.). something like ${Is64bit}/${Is32bit} would be very helpful!</b>
      </blockquote>x64.nsh
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">didava</span><br>
      <span class="post-time small text-muted">6th September 2013 22:39 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">hi<br>
      <br>
      for win 8 &amp; xp<br>
      <br>
      Is this true?<br>
      <br>
      ${If} ${IsWin8}<br>
      <br>
      MessageBox MB_OK 8<br>
      <br>
      ${ElseIf} ${IsXP}<br>
      <br>
      MessageBox MB_OK XP<br>
      <br>
      # etc... ${ElseIf}...<br>
      <br>
      ${EndIf}<br>
      <br>
      ???????</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">didava</span><br>
      <span class="post-time small text-muted">6th September 2013 23:33 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">[QUOTE]<br>
      <br>
      var isWindowsXP<br>
      var IsWindows7<br>
      var IsWindows8<br>
      <br>
      ------<br>
      <br></p>

      <blockquote>
        <br>
        <br>
        Version::IsWindowsXP<br>
        Pop $isWindowsXP<br>
        ${If} $isWindowsXP == "1"<br>
        Goto XP<br>
        ${EndIf}<br>
        <br>
        Version::IsWindows7<br>
        Pop $IsWindows7<br>
        ${If} IsWindows7 == "1"<br>
        Goto WINDOWS7<br>
        ${EndIf}<br>
        <br>
        Version::IsWindows8<br>
        Pop $IsWindows8<br>
        ${If} IsWindows8 == "1"<br>
        Goto WINDOWS8<br>
        <br>
        ${ElseIf}<br>
        MessageBox MB_OK|MB_ICONSTOP|MB_TOPMOST "$(OS_NOT_S)"<br>
        QUIT<br>
        ${EndIf}<br>
        <br>
        WINDOWS8:<br>
        <br>
        WINDOWS7:<br>
        <br>
        xp:<br>
      </blockquote>
    </div>
    <hr>

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]></script></body></html>