<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="Open folder/program" />

  <title>Open folder/program - NSIS Forums</title><!-- Bootstrap core CSS -->
  <link rel="stylesheet" type="text/css" href="//netdna.bootstrapcdn.com/bootswatch/3.0.1/readable/bootstrap.min.css" />
  <link rel="stylesheet" href="../css/style.css" type="text/css" /><!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!--[if lt IE 9]>
                <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
                <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->
</head>

<body>
  <div class="container">
    <!-- Put navigation bar here -->

    <ol class="breadcrumb">
      <li><a href="../index.html" class="glyphicon glyphicon-home"></a></li>

      <li><a href="f-65.html">NSIS Discussion</a></li>

      <li class="active">Open folder/program</li>
    </ol>

    <p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=207391">Open folder/program</a></p><br />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">MechMykl</span><br />
      <span class="post-time small text-muted">10th February 2005 02:16 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>Open folder/program</strong><br />
      This may have been asked before and the search came up with to much and being specific wont find anything probably, how would I:<br />
      <br />
      add a check box to execute a program on close<br />
      <br />
      and<br />
      <br />
      add a check bow to open a folder<br />
      <br />
      please provide exact code if you can, im kinda new at this ;)</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">bnicer</span><br />
      <span class="post-time small text-muted">10th February 2005 04:57 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">See if this helps:<br />
      <br />
      !define MUI_FINISHPAGE_SHOWREADME "$INSTDIR\index.htm"<br />
      !define MUI_FINISHPAGE_SHOWREADME_TEXT "&amp;Start ${PRODUCT_NAME}"<br />
      ;!define MUI_FINISHPAGE_SHOWREADME_NOTCHECKED<br />
      <br />
      or, for a function:<br />
      <br />
      !define MUI_FINISHPAGE_SHOWREADME_FUNCTION "post_install"<br />
      !define MUI_FINISHPAGE_SHOWREADME_TEXT "&amp;Start ${PRODUCT_NAME}"<br />
      ;!define MUI_FINISHPAGE_SHOWREADME_NOTCHECKED<br />
      <br />
      For both:<br />
      <br />
      !insertmacro MUI_PAGE_FINISH<br />
      <br />
      A function would be:<br />
      <br />
      Function post_install<br />
      ExecShell open "$INSTDIR\help\readme.rtf"<br />
      FunctionEnd<br />
      <br />
      Good luck!<br />
      <br />
      ps:<br />
      <br />
      This thread might have an answer regarding 2 checkboxes:<br />
      <br />
      <a href="http://forums.winamp.com/showthread.php?s=&amp;threadid=205674&amp;highlight=checkbox" target="_blank">install options : page custom like a welcome page</a></p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">MechMYkl</span><br />
      <span class="post-time small text-muted">11th February 2005 02:52 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">;NSIS Modern User Interface<br />
      ;Start Menu Folder Selection Example Script<br />
      ;Written by Joost Verburg<br />
      <br />
      ;--------------------------------<br />
      ;Include Modern UI<br />
      <br />
      !include "MUI.nsh"<br />
      <br />
      ;--------------------------------<br />
      ;General<br />
      <br />
      ;Name and file<br />
      Name "The Fro Icon Pack"<br />
      OutFile "The Fro Icon Pack.exe"<br />
      <br />
      ;Default installation folder<br />
      InstallDir "$PROGRAMFILES\HQubed\The Fro Icon Pack"<br />
      <br />
      ;Get installation folder from registry if available<br />
      InstallDirRegKey HKCU "Software\The Fro Icon Pack" ""<br />
      <br />
      ;--------------------------------<br />
      ;Interface Settings<br />
      <br />
      Var MUI_TEMP<br />
      Var STARTMENU_FOLDER<br />
      !define MUI_HEADERIMAGE<br />
      !define MUI_ABORTWARNING<br />
      <br />
      ;--------------------------------<br />
      ;Pages<br />
      <br />
      !insertmacro MUI_PAGE_WELCOME<br />
      !insertmacro MUI_PAGE_LICENSE "C:\Documents and Settings\Michael\My Documents\Web<br />
      <br />
      Pages\Projects\Installers\The Fro Icon Pack\assets\License.txt"<br />
      !define MUI_STARTMENUPAGE_REGISTRY_ROOT "HKCU"<br />
      !define MUI_STARTMENUPAGE_REGISTRY_KEY "Software\The Fro Icon Pack"<br />
      !define MUI_STARTMENUPAGE_REGISTRY_VALUENAME "Start Menu Folder"<br />
      !insertmacro MUI_PAGE_STARTMENU Application $STARTMENU_FOLDER<br />
      !insertmacro MUI_PAGE_INSTFILES<br />
      !insertmacro MUI_PAGE_FINISH<br />
      !insertmacro MUI_UNPAGE_WELCOME<br />
      !insertmacro MUI_UNPAGE_CONFIRM<br />
      !insertmacro MUI_UNPAGE_INSTFILES<br />
      !insertmacro MUI_UNPAGE_FINISH<br />
      <br />
      ;--------------------------------<br />
      ;Languages<br />
      <br />
      !insertmacro MUI_LANGUAGE "English"<br />
      <br />
      ;--------------------------------<br />
      ;Installer Sections<br />
      <br />
      Section "The Fro Icon Pack" SecBF<br />
      <br />
      SetOutPath "$INSTDIR\"<br />
      <br />
      File /r "C:\Documents and Settings\Michael\My Documents\Web Pages\Projects\Installers\The Fro<br />
      <br />
      Icon Pack\files\"<br />
      <br />
      ;Store installation folder<br />
      WriteRegStr HKCU "$PROGRAMFILES\HQubed\The Fro Icon Pack" "" $INSTDIR<br />
      <br />
      ;Create uninstaller<br />
      WriteUninstaller "$INSTDIR\Uninstall.exe"<br />
      <br />
      !insertmacro MUI_STARTMENU_WRITE_BEGIN Application<br />
      <br />
      ;Create shortcuts<br />
      CreateDirectory "$SMPROGRAMS\HQubed\The Fro Icon Pack"<br />
      CreateShortCut "$SMPROGRAMS\HQubed\The Fro Icon Pack\Uninstall.lnk" "$INSTDIR\Uninstall.exe"<br />
      <br />
      !insertmacro MUI_STARTMENU_WRITE_END<br />
      <br />
      SectionEnd<br />
      <br />
      ;--------------------------------<br />
      ;Descriptions<br />
      <br />
      ;Language strings<br />
      LangString DESC_SecBF ${LANG_ENGLISH} "The first version of The Fro Icon Pack, includes many<br />
      <br />
      different authors praised icons."<br />
      <br />
      ;Assign language strings to sections<br />
      !insertmacro MUI_FUNCTION_DESCRIPTION_BEGIN<br />
      !insertmacro MUI_DESCRIPTION_TEXT ${SecBF} $(DESC_SecBF)<br />
      !insertmacro MUI_FUNCTION_DESCRIPTION_END<br />
      <br />
      ;--------------------------------<br />
      ;Uninstaller Section<br />
      <br />
      Section "Uninstall"<br />
      <br />
      ;ADD YOUR OWN FILES HERE...<br />
      <br />
      Delete "$INSTDIR\Uninstall.exe"<br />
      <br />
      RMDir "$INSTDIR"<br />
      <br />
      !insertmacro MUI_STARTMENU_GETFOLDER Application $MUI_TEMP<br />
      <br />
      Delete "$SMPROGRAMS\$MUI_TEMP\Uninstall.lnk"<br />
      <br />
      ;Delete empty start menu parent diretories<br />
      StrCpy $MUI_TEMP "$SMPROGRAMS\$MUI_TEMP"<br />
      <br />
      startMenuDeleteLoop:<br />
      ClearErrors<br />
      RMDir $MUI_TEMP<br />
      GetFullPathName $MUI_TEMP "$MUI_TEMP\.."<br />
      <br />
      IfErrors startMenuDeleteLoopDone<br />
      <br />
      StrCmp $MUI_TEMP $SMPROGRAMS startMenuDeleteLoopDone startMenuDeleteLoop<br />
      startMenuDeleteLoopDone:<br />
      <br />
      DeleteRegKey /ifempty HKCU "Software\The Fro Icon Pack"<br />
      <br />
      SectionEnd<br />
      <br />
      Sorry its long, where would I put it? And I notice there are a few header errors ;)</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">MechMykl</span><br />
      <span class="post-time small text-muted">11th February 2005 03:01 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">One more thing, how can i delete all of the files i installed<br />
      <br />
      C:\Program Files\HQubed\The Fro Icon Pack<br />
      <br />
      I want to delete the folder "The Fro Icon Pack" and all of its contents and delete<br />
      <br />
      "The Fro Icon Pack" but not HQubed (in either) on the start menu, ty in advance.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
      <span class="post-time small text-muted">11th February 2005 11:24 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">You put it where the MUI readme says you should put it, which is:</p>

      <blockquote>
        Page Settings apply to a single page and should be set before inserting a page macro. If you have multiple pages of one type and you want to set a setting for all them, put the setting before each page macro.
      </blockquote>To delete a directory use RMDir.
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">MechMykl</span><br />
      <span class="post-time small text-muted">12th February 2005 04:46 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">This is ticking me off to no end, and im sorry this is probably gonna get anoying<br />
      <br />
      <br />
      ;--------------------------------<br />
      ;Uninstaller Section<br />
      <br />
      Section "Uninstall"<br />
      <br />
      ;ADD YOUR OWN FILES HERE...<br />
      RMDir "$INSTDIR\"<br />
      Delete "$INSTDIR\Uninstall.exe"<br />
      <br />
      !insertmacro MUI_STARTMENU_GETFOLDER Application $MUI_TEMP<br />
      <br />
      Delete "$SMPROGRAMS\$MUI_TEMP\Uninstall.lnk"<br />
      <br />
      ;Delete empty start menu parent diretories<br />
      StrCpy $MUI_TEMP "$SMPROGRAMS\$MUI_TEMP"<br />
      <br />
      startMenuDeleteLoop:<br />
      ClearErrors<br />
      RMDir $MUI_TEMP<br />
      GetFullPathName $MUI_TEMP "$MUI_TEMP\.."<br />
      <br />
      IfErrors startMenuDeleteLoopDone<br />
      <br />
      StrCmp $MUI_TEMP $SMPROGRAMS startMenuDeleteLoopDone startMenuDeleteLoop<br />
      startMenuDeleteLoopDone:<br />
      <br />
      DeleteRegKey /ifempty HKCU "Software\The Fro Icon Pack"<br />
      <br />
      SectionEnd<br />
      <br />
      How to i delete the start menu folder ...\The Fro Icon Pack (but not its parent)<br />
      <br />
      And what is the code for the rm dir thing.<br />
      <br />
      Once I get this I shouldnt have any more questions.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
      <span class="post-time small text-muted">12th February 2005 10:59 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">The code you've got there is correct, assuming it's an exact copy from the start menu example. If it doesn't work, you've probably got a problem in the code that writes the start menu path to the registry at installation time. Attach (don't just paste it in the message, it's hard to read) the entire script so the problem can be spotted.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">MechMykl</span><br />
      <span class="post-time small text-muted">12th February 2005 20:48 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">--Attached</p>
    </div>
    <hr />

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]>
  </script>
</body>
</html>
