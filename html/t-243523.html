<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="A better tutorial for extract, install, delete" />

  <title>A better tutorial for extract, install, delete - NSIS Forums</title><!-- Bootstrap core CSS -->
  <link rel="stylesheet" type="text/css" href="//netdna.bootstrapcdn.com/bootswatch/3.0.1/readable/bootstrap.min.css" />
  <link rel="stylesheet" href="../css/style.css" type="text/css" /><!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!--[if lt IE 9]>
                <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
                <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->
</head>

<body>
  <div class="container">
    <!-- Put navigation bar here -->

    <ol class="breadcrumb">
      <li><a href="../index.html" class="glyphicon glyphicon-home"></a></li>

      <li><a href="f-65.html">NSIS Discussion</a></li>

      <li class="active">A better tutorial for extract, install, delete</li>
    </ol>

    <p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=243523">A better tutorial for extract, install, delete</a></p><br />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">rxs2k5</span><br />
      <span class="post-time small text-muted">15th April 2006 07:12 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>A better tutorial for extract, install, delete</strong><br />
      hi pros,<br />
      <br />
      I am trying to understand most of the stuff provided in here but then I just cannot get it as many of it are refering to different things<br />
      <br />
      Here's my questions, will it be possible to provide a tutorial<br />
      <br />
      1. I have an installer.exe<br />
      2. I have a file.exe<br />
      3. I have a registry.reg file<br />
      <br />
      How to make<br />
      1. Create an installer.exe which will extract it to temp<br />
      2. During installation, installer.exe will run and file.exe will run.<br />
      3. When installation completes, registry.reg in temp folder will register.<br />
      4. Whatever is left in the temp folder will be completely deleted without a single trance, after the finish page.<br />
      <br />
      thanks</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
      <span class="post-time small text-muted">15th April 2006 11:29 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Like all of us have done, you should read the documentation provided. It has everything you need. You just need to use a bit more brain power and work out how to do it.<br />
      <br />
      -Stu</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">rxs2k5</span><br />
      <span class="post-time small text-muted">15th April 2006 11:39 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Hi Afrow UK<br />
      <br />
      1.<br />
      I actually found something for the .exe extracting but then in this topic <a href="http://forums.winamp.com/showthread.php?threadid=239371&amp;highlight=install+temp" target="_blank">here</a><br />
      <br />
      Will this ever happens ? How will I solve it ?<br />
      <br />
      2.<br />
      How can I make a registry.reg to enter into the user registry sliently ?? (codes)<br />
      <br />
      thanks for your reply is appreciated.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
      <span class="post-time small text-muted">15th April 2006 12:20 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">1. If ExecWait doesn't wait then that'd mean the installer being executed passes execution onto another process and then quits. In other words, you need to pass it an extra parameter (say /sms for example) to make it wait.<br />
      <br />
      2. Either execute regedit to do it with the registry.reg file path as the parameter (which will bring up a confirmation message box), or translate the registry.reg file into WriteRegStr instructions.<br />
      <br />
      -Stu</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">rxs2k5</span><br />
      <span class="post-time small text-muted">15th April 2006 15:05 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">what do you mean by /sms is it a valid codec or you trying to say to add others please further elaborate</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Red Wine</span><br />
      <span class="post-time small text-muted">15th April 2006 15:12 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">/sms is a switch used in (older) IShield installations. if you try to execute one of those IShield installations from cmd without /sms you end up with nothing.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">rxs2k5</span><br />
      <span class="post-time small text-muted">15th April 2006 16:35 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">then how do I deal with completely deleting my files after installation that are extracted to my temp</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">rxs2k5</span><br />
      <span class="post-time small text-muted">15th April 2006 18:40 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">hi pros<br />
      <br />
      I done everything is fine but I have some questions here.<br />
      <br />
      1.Why is it that I have some files, like installoptions.dll,modern-wizard,iospecial.ini in the temp folder during installation ???<br />
      <br />
      1.1 Are they supposed to be there or not to be there ??<br />
      <br />
      1.2 Is there a way to prevent these from appearing in temp ?? because I do want people to know the stuff I am using for the installer.<br />
      <br />
      2. Please look at the section code<br />
      <br />
      SetOutPath $TEMP<br />
      SetOverwrite on ( is there any other code beside SetOverwrite ?? Can you tell me in nsis help which page should I refer for more sections addable code.)<br />
      <br />
      thanks</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Red Wine</span><br />
      <span class="post-time small text-muted">15th April 2006 19:14 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">1. initpluginsdir<br />
      2. file /oname=$PLUGINSDIR\myfile.exe 'myfile.exe'<br />
      <br />
      3. READ THE MANUAL :-)</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Red Wine</span><br />
      <span class="post-time small text-muted">15th April 2006 19:49 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"></p>
      <pre>
<code><br />function .onInit<br /># along with anything else you have to do on init<br />initpluginsdir<br /><br />functionend<br /><br /><br /><br />section -<br /># suppose you're ready to do the job<br /><br />file /oname=$PLUGINSDIR\file1.exe "my local dir\file1.exe"<br />clearerrors # or use a return var to check for errors<br />execwait '$PLUGINSDIR\file1.exe'<br />iferrors # executions failed do something<br /># execution would fail also but without errors<br /># if the executed prog requires params e.g. /sms<br /><br />file /oname=$PLUGINSDIR\file2.exe "my local dir\file2.exe"<br />clearerrors # or use a return var to check for errors<br />execwait '$PLUGINSDIR\file2.exe'<br />iferrors # executions failed do something<br /># execution would fail also but without errors<br /># if the executed prog requires params e.g. /sms<br /><br /># this is not recommended, instead try to convert the registry<br /># entries to NSIS script. Search forum for a tool reg2nsis<br /># this tool could help you under some conditions, read readme.<br />file /oname=$PLUGINSDIR\registry.reg "my local dir\registry.reg"<br />clearerrors # or use a return var to check for errors<br />execwait 'regedit.exe /s $PLUGINSDIR\registry.reg'<br />iferrors # write to registry failed do something<br /><br />sectionend<br /><br />Function .onInstSuccess<br /># in case you did a convertion from registry.reg to nsh<br />!include 'registry.nsh'<br />functionend<br /><br /></code>
</pre>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">rxs2k5</span><br />
      <span class="post-time small text-muted">15th April 2006 20:08 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Thanks alot redwine, I think its ok with the temp<br />
      <br />
      thanks everyone for giving me a bit hints, manage to compile all the knowledge with full details supports. thanks again</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">rxs2k5</span><br />
      <span class="post-time small text-muted">15th April 2006 20:22 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">hi<br />
      <br />
      1 question<br />
      <br />
      4.9.3.13 RegDLL<br />
      dllfile [entrypoint_name]<br />
      Loads the specified DLL and calls DllRegisterServer (or entrypoint_name if specified). The error flag is set if an error occurs (i.e. it can't load the DLL, initialize OLE, find the entry point, or the function returned anything other than ERROR_SUCCESS (=0)).<br />
      <br />
      Use SetOutPath to set the current directory for DLLs that depend on other DLLs that are now in the path or in the Windows directory. For example, if foo.dll depends on bar.dll which is located in $INSTDIR use:<br />
      <br />
      SetOutPath $INSTDIR<br />
      RegDLL $INSTDIR\foo.dll<br />
      <br />
      Does this register, ocx and other system files ???<br />
      <br />
      If NO, please verify which script code I should be using.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Red Wine</span><br />
      <span class="post-time small text-muted">15th April 2006 22:08 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Read the manual, here is the answer:<br />
      Appendix B: DLL/TLB Library Setup</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">rxs2k5</span><br />
      <span class="post-time small text-muted">17th April 2006 14:16 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">hi pros<br />
      <br />
      yes my greatest fear have arrived<br />
      <br />
      both ExecWait doesn't wait<br />
      <br />
      1. beside using /sms<br />
      <br />
      Is there any other safe way to make it wait till it close and launch the next installer ???</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
      <span class="post-time small text-muted">17th April 2006 15:01 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Depends what InstallShield version installer it is.<br />
      <br />
      So does<br />
      ExecWait `"$INSTDIR\setup.exe" /sms`<br />
      not wait?<br />
      <br />
      -Stu</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">rxs2k5</span><br />
      <span class="post-time small text-muted">17th April 2006 15:35 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Afrow UK my computer is a bit weird<br />
      <br />
      Now execwait obeys the installer,<br />
      <br />
      both one of my installer made from innosetup, the other made from nsis.<br />
      <br />
      Now it follows orders<br />
      <br />
      like<br />
      <br />
      extracting....1<br />
      extracting....2<br />
      execloading....1 ( freeze ) [when close]<br />
      execloading....2 (freeze) [when close]<br />
      delete 1<br />
      delete 2<br />
      <br />
      Its like not a single trace to be found cool.<br />
      <br />
      Thanks for your reply I have manage to solve the problem,<br />
      <br />
      Thanks for your plugins<br />
      File:ScrollLicense.zip<br />
      File:PassDialog.zip</p>
    </div>
    <hr />

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]>
  </script>
</body>
</html>
