<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="$SMPROGRAMS not in correct place??" />

  <title>$SMPROGRAMS not in correct place?? - NSIS Forums</title>
  <script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script>
  <!-- Bootstrap core CSS -->

  <link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css" />
  <link rel="stylesheet" href="../css/style.css" type="text/css" /><!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!--[if lt IE 9]>
                <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
                <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->
</head>

<body>
  <div class="container">
    <!-- Put navigation bar here -->

    <ol class="breadcrumb">
      <li><a href="../index.html" class="glyphicon glyphicon-home"></a></li>

      <li><a href="f-65.html">NSIS Discussion</a></li>

      <li class="active">$SMPROGRAMS not in correct place??</li>
    </ol>

    <p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=291814">$SMPROGRAMS not in correct place??</a></p><br />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">xplct0</span><br />
      <span class="post-time small text-muted">15th May 2008 00:50 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>$SMPROGRAMS not in correct place??</strong><br />
      Hey, I'm new to nsis, and I've been having an issue that I'm not sure how to elegantly resolve.<br />
      <br />
      After install I'm creating a shortcut to our application via:<br />
      createShortCut '$SMPROGRAMS\Company\Game.lnk' '$INSTDIR\Game.exe'<br />
      <br />
      Taking a quick look at the value of $SMPROGRAMS, I see the following:<br />
      C:\Users\david.DOMAIN\AppData\Roaming\Microsoft\Windows\Start Menu\Programs<br />
      <br />
      However, this isn't where the shortcut gets created. It actually is sitting in the hidden folder:<br />
      C:\ProgramData\Microsoft\Windows\Start Menu\Programs\Company<br />
      <br />
      So now my question comes on uninstallation. If I use the same syntax, ie:<br />
      Delete '$SMPROGRAMS\Company\*'<br />
      RMDir '$SMPROGRAMS\Company'<br />
      The startmenu-program files entry doesn't actually get cleared out. The only way for me to get around this, right now, is to literally enter the location of the shortcut and the shortcut's folder...</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Anders</span><br />
      <span class="post-time small text-muted">15th May 2008 17:14 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">say it with me now, Vista Sucks, Vista Sucks...<br />
      <br />
      <a href="http://nsis.sourceforge.net/Shortcuts_removal_fails_on_Windows_Vista" target="_blank">http://nsis.sourceforge.net/Shortcut..._Windows_Vista</a></p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">xplct0</span><br />
      <span class="post-time small text-muted">17th May 2008 00:21 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Hey, thanks for the help. That fixed the issue. I'm actually very unfamiliar with the whole privlages system windows has established. Without going into much detail, could you maybe explain to me what the issue was? (I understand the concept of logging in under different credentials)<br />
      <br />
      Also, as a curiosity, I now manually need to create a directory to contain my shortcut. What is the reason behind this?<br />
      <br />
      createShortCut '$SMPROGRAMS\COMPANY\Shortcut.lnk' '$INSTDIR\Executable.exe'<br />
      <br />
      The above line used to create a folder, COMPANY, for me. And now that I've added: RequestExecutionLevel admin, I now need to CreateDirectory '$SMPROGRAMS\COMPANY', first.</p>
    </div>
    <hr />

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]>
  </script>
</body>
</html>
