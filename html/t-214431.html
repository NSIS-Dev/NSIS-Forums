<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="description" content="Trying to build a conditional application launcher...now I'm stuck and need help"><title>Trying to build a conditional application launcher...now I'm stuck and need help - NSIS Forums</title><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script><link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css"><link rel="stylesheet" href="../css/style.css" type="text/css"><!--[if lt IE 9]><script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script><script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script><![endif]--></head><body><div class="container"><ol class="breadcrumb"><li><a href="../index.html" class="glyphicon glyphicon-home"></a></li><li><a href="f-65.html">NSIS Discussion</a></li><li class="active">Trying to build a conditional application launcher...now I'm stuck and need help</li></ol><p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=214431">Trying to build a conditional application launcher...now I'm stuck and need help</a></p><br><div class="post"><p class="post-meta"><span class="post-author text-primary">gadz</span><br><span class="post-time small text-muted">28th April 2005 18:43 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>Trying to build a conditional application launcher...now I'm stuck and need help</strong><br>Well I've never used NSIS before and know next to nothing about scripting. I've been at this for 3 days straight and I'm stuck and confused.<br><br>This is what I've come up with so far. (see attached)<br><br>I'm using the InstallOptionEx plugin (see attachment), I renamed it to InstallOptions and overwrote the one that came with NSIS.<br><br>In the end I'll replace the MessageBoxes with ExecWait to launch the application with the proper arguments, but I put the MessageBoxes while testing.<br><br>I think the problem is pretty obvious when you open the script, compile and run it...<br><br>(somebody help...please??)</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">kichik</span><br><span class="post-time small text-muted">28th April 2005 19:38 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">You must insert at least one page macro for the MUI to work its magic on the UI. You'll probably want to use MUI_PAGE_INSTFILES anyway.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">gadz</span><br><span class="post-time small text-muted">28th April 2005 21:43 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">could you maybe give a little example of how you mean, I've tried that and it didn't help much, just gave me an page I didn't want.<br><br>The main thing that's giving me trouble is that it's supposed to skip certain functions depending on the operating system it's running on, the custom pages seem to work fine but it still runs all the messageboxes regardless of whether the page was skipped or not.<br><br>An obvious example of this is when you compile and run the script on WindowsXP: It shows the intro page fine, but when you click next it shows the "Single User" dialog even before the next page comes up with the install button. Also the "Single User" dialog is only supposed to come up in Windows 98-ME with the Win98ME page, in fact all the messageboxes pop up when only some are supposed to.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">gadz</span><br><span class="post-time small text-muted">29th April 2005 13:00 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Ok well I got it working (almost) without having to use any page macro (I only use custom pages).<br>The problem now is that the cancel button doesn't work properly. When you click cancel it shows the "are you sure you want to quit" dialog but then when you click yes it still runs through the commands.<br><br>I hope that someone is able to help me fix it and that it's it's not too difficult.<br><br>:(</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">kichik</span><br><span class="post-time small text-muted">29th April 2005 16:28 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">For an example of MUI_PAGE_INSTFILES usage see any of the MUI examples in Examples\Modern UI.<br><br>As for the cancel button, if you want to know if the user clicked cancel after MUI_INSTALLOPTIONS_DISPLAY returns, you should use MUI_INSTALLOPTIONS_DISPLAY_RETURN and pop the return value. The return value will contain "cancel" if the user clicked the cancel button.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">gadz</span><br><span class="post-time small text-muted">2nd May 2005 16:39 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Thanks, got it working. :)</p></div><hr><div class="footer"><p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p></div></div><script src="../js/highlight.pack.js" type="text/javascript"></script><script type="text/javascript">//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]></script></body></html>