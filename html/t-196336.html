<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="description" content="Does WriteINIStr command work on Win98???"><title>Does WriteINIStr command work on Win98??? - NSIS Forums</title><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script><link rel="preload" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css" as="style" onload="this.rel='stylesheet'"><link rel="preload" href="../css/style.css" as="style" onload="this.rel='stylesheet'"><noscript><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css"><link rel="stylesheet" href="../css/style.css"></noscript><script>!function(a){"use strict";var b=function(b,c,d){function e(a){return h.body?a():void setTimeout(function(){e(a)})}function f(){i.addEventListener&&i.removeEventListener("load",f),i.media=d||"all"}var g,h=a.document,i=h.createElement("link");if(c)g=c;else{var j=(h.body||h.getElementsByTagName("head")[0]).childNodes;g=j[j.length-1]}var k=h.styleSheets;i.rel="stylesheet",i.href=b,i.media="only x",e(function(){g.parentNode.insertBefore(i,c?g:g.nextSibling)});var l=function(a){for(var b=i.href,c=k.length;c--;)if(k[c].href===b)return a();setTimeout(function(){l(a)})};return i.addEventListener&&i.addEventListener("load",f),i.onloadcssdefined=l,l(f),i};"undefined"!=typeof exports?exports.loadCSS=b:a.loadCSS=b}("undefined"!=typeof global?global:this);!function(a){if(a.loadCSS){var b=loadCSS.relpreload={};if(b.support=function(){try{return a.document.createElement("link").relList.supports("preload")}catch(b){return!1}},b.poly=function(){for(var b=a.document.getElementsByTagName("link"),c=0;c<b.length;c++){var d=b[c];"preload"===d.rel&&"style"===d.getAttribute("as")&&(a.loadCSS(d.href,d,d.getAttribute("media")),d.rel=null)}},!b.support()){b.poly();var c=a.setInterval(b.poly,300);a.addEventListener&&a.addEventListener("load",function(){b.poly(),a.clearInterval(c)}),a.attachEvent&&a.attachEvent("onload",function(){a.clearInterval(c)})}}}(this);</script></head><body><div class="container"><ol class="breadcrumb"><li><a href="../index.html" class="glyphicon glyphicon-home"></a></li><li><a href="f-65.html">NSIS Discussion</a></li><li class="active">Does WriteINIStr command work on Win98???</li></ol><p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=196336">Does WriteINIStr command work on Win98???</a></p><br><div class="post"><p class="post-meta"><span class="post-author text-primary">Jnuw</span><br><span class="post-time small text-muted">11th October 2004 19:48 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>Does WriteINIStr command work on Win98???</strong><br>I was using the WriteINIStr command to add some text to an ini file on my Win2k machine. It was working great. However, when I tested my installer on a Win98 PC, the WriteINIStr command did absolutely nothing. In fact, it seems to prevent the next 1 or 2 commands from working. Here is the code:<br><br>WriteINIStr "$INSTDIR\ULogs\ULog.ini" "Info" "bla bla" "1"<br>Delete "$INSTDIR\ULogs\$ULogLM"<br>Rename "$INSTDIR\ULogs\ULog.ini" "$ULogLM"<br><br>The Rename command would rename the ini into the ULogLM string, but would leave the Ulog.ini file, as if it was locked by the failing WriteINIStr command. Any ideas?<br><br>Thanks much all!</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">scully13</span><br><span class="post-time small text-muted">11th October 2004 19:54 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">If you are copying the ULog.ini file from a CD make sure you remove it's read-only attribute before you use WriteINIStr. Win98 makes files read-only when they are copied from a CD. If you are not copying the file from a CD then ignore me.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Jnuw</span><br><span class="post-time small text-muted">11th October 2004 20:08 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Not copying from a CD, and double checked the files, they are not read only, but thank you very much for the advice. When I comment out the WriteINIStr line, everything works fine, so I think it has something to do with the WriteINIStr command and Win98.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br><span class="post-time small text-muted">11th October 2004 20:11 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Maybe try FlushINI first.<br><br>-Stu</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Jnuw</span><br><span class="post-time small text-muted">11th October 2004 20:38 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Thanks Afrow UK, should I put the FlushINI command right before, or right after the WriteINIStr command? Thanks.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">kichik</span><br><span class="post-time small text-muted">11th October 2004 21:10 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Right after WriteINIStr.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Jnuw</span><br><span class="post-time small text-muted">11th October 2004 21:58 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Nope, no luck with the FlushINI as far as actually writing to the ini, however the next commands (Delete and Rename) do work now.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">deguix</span><br><span class="post-time small text-muted">11th October 2004 22:39 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Every change you do to an INI file will only be updated when you use "FlushINI" (on Win9x). So if you write something to the INI file and you want to read it correctly you should use "FlushINI" before reading, deleting or renaming an INI file.<br><br>Logically, if you try to open an INI file after writting and before flushing it, you'll see that the INI file didn't change at all.<br><br>This sometimes should be looked as a feature, because with this you don't need to backup the file -&gt; even when you try to write, you can still read the intact old version...:)</p></div><hr><div class="footer"><p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p></div></div><script src="../js/highlight.pack.js" type="text/javascript"></script><script type="text/javascript">//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]></script></body></html>