<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="description" content="WordFunc.nsh + TextFunc.nsh + FileFunc.nsh"><title>WordFunc.nsh + TextFunc.nsh + FileFunc.nsh - NSIS Forums</title><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script><link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css"><link rel="stylesheet" href="../css/style.css" type="text/css"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="description" content=" WordFunc.nsh + TextFunc.nsh + FileFunc.nsh"><title>WordFunc.nsh + TextFunc.nsh + FileFunc.nsh - NSIS Forums</title><link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css"><link rel="stylesheet" href="../css/style.css" type="text/css"></head><body><div class="container"><ol class="breadcrumb"><li><a href="../index.html" class="glyphicon glyphicon-home"></a></li><li><a href="f-65.html">NSIS Discussion</a></li><li class="active">WordFunc.nsh + TextFunc.nsh + FileFunc.nsh</li></ol><p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=203228">WordFunc.nsh + TextFunc.nsh + FileFunc.nsh</a></p><br><div class="post"><p class="post-meta"><span class="post-author text-primary">Instructor</span><br><span class="post-time small text-muted">28th December 2004 11:23 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>WordFunc.nsh + TextFunc.nsh + FileFunc.nsh</strong><br>I have thought :) more convenient to update one topic than three topics<br><br><b>Word Functions Header v2.52<br>Text Functions Header v1.4<br>File Functions Header v1.21</b><br><br>1. Function GetParameters moved from WordFunc.nsh to FileFunc.nsh<br>2. Text Functions LineFind and LineRead<br>&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;-now last line "-1" instead of "0"<br><br><b><font size="5">These headers are included with NSIS. See: <a href="http://nsis.sourceforge.net/Docs/AppendixE.html#E" target="_blank">http://nsis.sourceforge.net/Docs/AppendixE.html#E</a></font></b></p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Instructor</span><br><span class="post-time small text-muted">18th January 2005 00:53 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><b>Word Functions Header v2.6<br>Text Functions Header v1.4<br>File Functions Header v1.3</b><br><br>1. "<b>GetDrives</b>" v1.1<br>&amp;nbsp;&amp;nbsp;&amp;nbsp;-Fixed: depended on drives order<br><br>2. "<b>WordFind2X</b>" v2.1<br>&amp;nbsp;&amp;nbsp;&amp;nbsp;-Loops sorted<br><br>3. New: "<b>WordFind3X</b>" v1.0<br>&amp;nbsp;&amp;nbsp;&amp;nbsp;-Find word, that contain string, between two delimiters.<br>&amp;nbsp;&amp;nbsp;&amp;nbsp;(Based on Afrow UK idea of Function "StrSortLR" 2003-06-18)<br><br>4. "WordFuncExample.nsi" updated.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Instructor</span><br><span class="post-time small text-muted">1st February 2005 08:05 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><b>Word Functions Header v2.6<br>Text Functions Header v1.5<br>File Functions Header v1.3</b><br><br>"<b>LineFind</b>" v1.3<br>&amp;nbsp;&amp;nbsp;-Added "/NUL" option: No output text file (only read InputFile).</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Instructor</span><br><span class="post-time small text-muted">13th February 2005 02:50 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><b>Word Functions Header v2.6<br>Text Functions Header v1.5<br>File Functions Header v1.4</b><br><br>1. New: "<b>GetBaseName</b>"<br>&amp;nbsp;&amp;nbsp;&amp;nbsp;-Get file name without extension.<br>&amp;nbsp;&amp;nbsp;&amp;nbsp;(Based on comperio idea of Function "GetBaseName" 2005-01-28)<br><br>2. New: "<b>GetFileVersion</b>"<br>&amp;nbsp;&amp;nbsp;&amp;nbsp;-Gets the version information from executable file.<br><br>3. New: "<b>VersionCompare</b>" v1.0<br>&amp;nbsp;&amp;nbsp;&amp;nbsp;-Compare version numbers.<br>&amp;nbsp;&amp;nbsp;&amp;nbsp;(Based on Afrow UK Function "VersionCheckNew2" 2005-01-24)<br>&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;His original function isn't included because of wrong results:<br>&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;${VersionCheckNew2} "2.5.9" "2.5.01" $R0&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;-Ver2 newer<br>&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;${VersionCheckNew2} "2.5.09" "2.5" $R0&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;-equal</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">kichik</span><br><span class="post-time small text-muted">13th February 2005 04:33 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Why is 2.5.09 equal to 2.5? Just a typo or does the function behave that way?</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Instructor</span><br><span class="post-time small text-muted">13th February 2005 09:29 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">No. It isn't a typo.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Comm@nder21</span><br><span class="post-time small text-muted">13th February 2005 14:12 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">@kichik:<br></p><blockquote><b>His original function isn't included because of <u>wrong results</u>:</b><br>${VersionCheckNew2} "2.5.9" "2.5.01" $R0 -Ver2 newer<br>${VersionCheckNew2} "2.5.09" "2.5" $R0 -equal</blockquote>read it another time :)</div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br><span class="post-time small text-muted">13th February 2005 18:16 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Thanks for letting me know :hang:<br>Fixed my function.<br><br>-Stu</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Instructor</span><br><span class="post-time small text-muted">21st March 2005 08:24 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><b>Word Functions Header v2.6<br>Text Functions Header v1.6<br>File Functions Header v1.4</b><br><br>1. "<b>LineFind</b>" v1.4<br>&amp;nbsp;&amp;nbsp;&amp;nbsp;-Output file will not be updated if no changes made<br>&amp;nbsp;&amp;nbsp;&amp;nbsp;-Error flag if output file path isn't exists<br>&amp;nbsp;&amp;nbsp;&amp;nbsp;-Added: "{No}" callback this line and don't write others<br>&amp;nbsp;&amp;nbsp;&amp;nbsp;-Variables in callback function changed<br><br>2. Added script to simple install WordFunc.nsh, TextFunc.nsh, FileFunc.nsh</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Instructor</span><br><span class="post-time small text-muted">26th March 2005 20:53 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><b>Word Functions Header v2.7<br>Text Functions Header v1.7<br>File Functions Header v1.5</b><br><br>1. "<b>ClbSet</b>", "<b>ClbGet</b>" removed from WordFunc.nsh<br><br>2. "<b>LineRead</b>" v1.2, "<b>LineSum</b>", "<b>FileJoin</b>" v1.4, "<b>TextCompare</b>" v1.2<br>&amp;nbsp;&amp;nbsp;&amp;nbsp;-Added IfErrors after FileOpen<br><br>3. "<b>GetDrives</b>" v1.2<br>&amp;nbsp;&amp;nbsp;&amp;nbsp;-Added "ALL" along with ""<br><br>4. New: "<b>FileReadFromEnd</b>" v1.0<br>&amp;nbsp;&amp;nbsp;&amp;nbsp;-Read text file from end line by line.<br><br>5. New: "<b>DriveSpace</b>" v1.0<br>&amp;nbsp;&amp;nbsp;&amp;nbsp;-Get total, occupied or free space of the drive.<br><br>6. Added: "<b>GetRoot</b>"<br>&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;(Based on KiCHiK Function "GetRoot")<br>&amp;nbsp;&amp;nbsp;&amp;nbsp;-Get the root directory.<br><br>7. Added: "<b>GetParent</b>"<br>&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;(Based on sunjammer Function "GetParent")<br>&amp;nbsp;&amp;nbsp;&amp;nbsp;-Get parent directory.<br><br>8. Added: "<b>GetFileName</b>"<br>&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;(Based on KiCHiK Function "GetFileName")<br>&amp;nbsp;&amp;nbsp;&amp;nbsp;-Get last part from directory path.<br><br>9. Many minor code and documentation improvements</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Instructor</span><br><span class="post-time small text-muted">27th March 2005 09:49 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><b>Word Functions Header v2.7<br>Text Functions Header v1.7<br>File Functions Header v1.6</b><br><br>&amp;nbsp;&amp;nbsp;"<b>DriveSpace</b>", "<b>DirState</b>", "<b>GetFileVersion</b>"<br>&amp;nbsp;&amp;nbsp;&amp;nbsp;-Missing ClearErrors at the beginning.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Instructor</span><br><span class="post-time small text-muted">28th March 2005 11:56 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><b>Word Functions Header v2.7<br>Text Functions Header v1.8<br>File Functions Header v1.7</b><br><br>In order to avoid exiting from connected functions,<br>changed exit value in callback function to "Stop&lt;FunctionName&gt;":<br><br>-"<b>LineFind</b>"&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;Stop -&gt; StopLineFind<br>-"<b>FileReadFromEnd</b>"&amp;nbsp;&amp;nbsp;Stop -&gt; StopFileReadFromEnd<br>-"<b>TextCompare</b>"&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;StopCompare -&gt; StopTextCompare<br>-"<b>GetDrives</b>"&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;Stop -&gt; StopGetDrives</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Instructor</span><br><span class="post-time small text-muted">1st April 2005 18:45 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><b>Word Functions Header v2.8<br>Text Functions Header v1.8<br>File Functions Header v1.8</b><br><br>1. "<b>Locate</b>" v1.5<br>&amp;nbsp;&amp;nbsp;&amp;nbsp;-Added "/B=" parameter (when used banner with function)<br><br>2. "<b>StrFilter</b>" v1.2<br>&amp;nbsp;&amp;nbsp;&amp;nbsp;-Missing ClearErrors at the beginning.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Instructor</span><br><span class="post-time small text-muted">11th April 2005 12:31 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><b>Word Functions Header v2.8<br>Text Functions Header v1.8<br>File Functions Header v1.9</b><br><br><br>Changes:<br><br>&amp;nbsp;"<b>Locate</b>" v1.6<br>&amp;nbsp;&amp;nbsp;&amp;nbsp;-Fixed: if error appeared in the callback, function don't restore stack after exit.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Instructor</span><br><span class="post-time small text-muted">14th April 2005 11:01 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><b>Word Functions Header v2.8<br>Text Functions Header v1.8<br>File Functions Header v2.0</b><br><br><br>Changes:<br><br>&amp;nbsp;New: "<b>GetOptions</b>"<br>&amp;nbsp;&amp;nbsp;&amp;nbsp;-Get options from command line parameters.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Instructor</span><br><span class="post-time small text-muted">20th April 2005 12:53 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><b>Word Functions Header v2.9<br>Text Functions Header v2.0<br>File Functions Header v2.3</b><br><br><br>Changes:<br><br>1. Verbosity added (faster compilation time)<br><br>2. "<b>Locate</b>" v1.7<br>&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;-Fixed: Banner support<br><br>3. "<b>GetOptions</b>"<br>&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;-Now required only 2 arguments:<br>&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;${GetOptions} "[Parameters]" "[Option]" $var<br><br>4. "<b>GetTime</b>" v1.2<br>&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;-Now convert day and month in DD and MM format<br><br>5. "<b>TextCompare</b>" v1.4<br>&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;-Rewrited all code<br><br>6. "<b>FileReadFromEnd</b>" v1.2<br>&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;-Now if the text file cannot be opened, the error flag is set</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Instructor</span><br><span class="post-time small text-muted">24th May 2005 19:05 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><b>Word Functions Header v3.0<br>Text Functions Header v2.1<br>File Functions Header v2.4</b><br><br><br>Changes:<br><br>1. "<b>VersionCompare</b>" moved from FileFunc.nsh to WordFunc.nsh<br><br>2. New: "<b>VersionConvert</b>" v1.0<br>&amp;nbsp;&amp;nbsp;&amp;nbsp;-Convert version in the numerical format which can be compared.<br><br>3. New: "<b>ConfigRead</b>" v1.0<br>&amp;nbsp;&amp;nbsp;&amp;nbsp;-Read value from entry name in config file.<br><br>4. New: "<b>ConfigWrite</b>" v1.1<br>&amp;nbsp;&amp;nbsp;&amp;nbsp;-Write value from entry name in config file.<br><br>5. New: "<b>FileRecode</b>"<br>&amp;nbsp;&amp;nbsp;&amp;nbsp;-Recode text file from DOS to Windows format and vice-versa.<br><br>6. New: "<b>GetFileAttributes</b>" v1.1<br>&amp;nbsp;&amp;nbsp;&amp;nbsp;-Get attributes of file or directory.<br><br>7. New: "<b>BannerTrimPath</b>"<br>&amp;nbsp;&amp;nbsp;&amp;nbsp;-Trim string path for banner.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Instructor</span><br><span class="post-time small text-muted">12th July 2005 12:35 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><b>Word Functions Header v3.0<br>Text Functions Header v2.1<br>File Functions Header v2.5</b><br><br><br>Changes:<br><br>1. "<b>GetDrives</b>" v1.4<br>&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;-Fixed: Alloc/Free (Thanks <b>nechai</b>)<br><br>2. "<b>GetOptions</b>"<br>&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;-Better option search (complite ignoration in quotes)<br><br>3. Renamed example scripts (like in CVS):<br>&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;...FuncTest.nsi -&gt; ...Func.nsi<br>&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;...FuncTest.ini -&gt; ...Func.ini</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Instructor</span><br><span class="post-time small text-muted">21st July 2005 00:49 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><b>Word Functions Header v3.0<br>Text Functions Header v2.1<br>File Functions Header v2.6</b><br><br><br>Changes:<br><br>1. "<b>GetTime</b>" v1.3<br>&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;-Fixed: Free structures<br><br>2. "<b>GetExeName</b>" and "<b>GetExePath</b>"<br>&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;-Simplification with "GetLongPathNameA"<br><br>3. "<b>BannerTrimPath</b>"<br>&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;-Added D mode</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Instructor</span><br><span class="post-time small text-muted">23rd August 2005 13:20 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><b>Word Functions Header v3.1<br>Text Functions Header v2.1<br>File Functions Header v2.7</b><br><br>Changes:<br><br>1. "<b>WordReplace</b>" v2.1<br>&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;-Fixed: Incorrect rule for return errorlevel 1 in situation when string beginning with word to replace and its only one word in string and when uses option - deletes all founded words (thanks <b>hemancuso</b>)<br><br>2. "<b>GetExeName</b>" and "<b>GetExePath</b>"<br>&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;-Fixed: Return empty string in Windows 95 (thanks <b>kichik</b>)</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Instructor</span><br><span class="post-time small text-muted">21st October 2005 19:22 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><b>Word Functions Header v3.1<br>Text Functions Header v2.1<br>File Functions Header v2.8</b><br><br>Changes:<br><br>1. Now "<b>GetRoot</b>" returns not only root drive or UNC:<br>&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;${GetRoot} "Program Files\NSIS" $R0 &amp;nbsp;&amp;nbsp;&amp;nbsp;# $R0="Program Files" instead of ""<br>&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;${GetRoot} "\Program Files\NSIS" $R0 &amp;nbsp;&amp;nbsp;# $R0="\Program Files" instead of ""<br><br>2. Some typos corrected (thanks <b>Jamyn</b>)</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">MikeSchinkel</span><br><span class="post-time small text-muted">23rd December 2005 08:47 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>What about UTC (Coordinated Universal Time?)</strong><br>I need to use UTC (Coordinated Universal Time) instead of Local Time which can be gotten from <a href="http://msdn.microsoft.com/library/default.asp?url=/library/en-us/sysinfo/base/getsystemtime.asp" target="_blank">kernel32::GetSystemTime</a>. Any chance of updating the "official" version of Text Functions Header to incorporate that functionality?<br><br>My other option is to hack GetTime() and include it directly in my code. Yuck.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Instructor</span><br><span class="post-time small text-muted">24th December 2005 14:16 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><b>Word Functions Header v3.1<br>Text Functions Header v2.1<br>File Functions Header v2.9</b><br><br>Changes:<br><br>"<b>GetTime</b>" v1.4<br>-Added support for system time (UTC)<br>-Added example how to convert time to 12-hour format AM/PM</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">TonyDS</span><br><span class="post-time small text-muted">3rd February 2006 14:01 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Has the getdrives function been tested on windows 98,<br><br>If so does it work?</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Instructor</span><br><span class="post-time small text-muted">3rd February 2006 14:30 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"></p><blockquote>Has the getdrives function been tested on windows 98</blockquote>Yes<blockquote>If so does it work?</blockquote>:) Yes</div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">TonyDS</span><br><span class="post-time small text-muted">3rd February 2006 14:37 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Thanks</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Instructor</span><br><span class="post-time small text-muted">5th February 2006 18:37 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><b>Word Functions Header v3.2<br>Text Functions Header v2.2<br>File Functions Header v3.0</b><br><br>Changes:<br><br>1. "<b>WordReplace</b>" v2.2<br>&amp;nbsp;&amp;nbsp;&amp;nbsp;-Added options "{", "}", "{*", "}*"<br><br>2. "<b>GetOptions</b>"<br>&amp;nbsp;&amp;nbsp;&amp;nbsp;-Now sets error flag if option does not found<br><br>3. "<b>ConfigRead</b>"<br>&amp;nbsp;&amp;nbsp;&amp;nbsp;-Now sets error flag if entry does not found<br><br>4. New case sensitive functions (NSIS 2.14 required):<br>&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;"<b>WordFindS</b>", "<b>WordFind2XS</b>", "<b>WordFind3XS</b>", "<b>WordReplaceS</b>",<br>&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;"<b>WordAddS</b>", "<b>WordInsertS</b>", "<b>StrFilterS</b>", "<b>TextCompareS</b>",<br>&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;"<b>ConfigReadS</b>", "<b>ConfigWriteS</b>", "<b>GetOptionsS</b>"<br><br>5. Added program for simple headers install</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Instructor</span><br><span class="post-time small text-muted">6th February 2006 09:19 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><b>Word Functions Header v3.2<br>Text Functions Header v2.3<br>File Functions Header v3.1</b><br><br>Changes:<br><br>-Added /NOUNLOAD flag for the system plugin. Functions that uses system plugin calls several times, now 25-75% faster ("GetSize", "DriveSpace", "GetDrives", "GetTime", "ConfigWrite", "FileRecode").</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Comm@nder21</span><br><span class="post-time small text-muted">6th February 2006 19:48 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">kichik, plz update the CVS :)</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Comperio</span><br><span class="post-time small text-muted">9th March 2006 01:46 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Hey Instructor,<br>I have to say that your functions are very cool. I find that I use them almost every chance I get!<br><br>Here's an enhancement suggestion for the Locate function:<br>Currently, there is an option /M=[mask] to add options of what to search for. A cool option might be something like /!M=[mask] to specify what to EXCLUDE.<br><br>For example /!M=*.EXE would mean to exclude all dat files from the search.<br><br>Using both together, one might use<br>/M=*.DAT /!M=doofus.dat<br><br>which would translate to:<br>"Include all *.DAT files except the file named 'doofus.dat'"<br><br>That's all I have for now. Keep up the great work!:up:</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Instructor</span><br><span class="post-time small text-muted">9th March 2006 03:17 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Many filters implemented in <a href="http://nsis.sourceforge.net/Locate_plugin" target="_blank">Locate plugin</a></p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Comperio</span><br><span class="post-time small text-muted">9th March 2006 03:53 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Thanks for the link, Instructor. Looks exactly what I was looking for!<br><br>So tell me, why is this not included with NSIS itself like you've your other functions? (Just curious)</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Instructor</span><br><span class="post-time small text-muted">9th March 2006 05:34 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"></p><blockquote>So tell me, why is this not included with NSIS itself like you've your other functions? (Just curious)</blockquote>I think this is not my question :)</div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Comperio</span><br><span class="post-time small text-muted">9th March 2006 15:26 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">OK, I found an odd problem:<br>I'm using the Locate function from NSIS ver 2.15.<br><br>I'm using it to search for all files/directies. I found that if I push <b><u>two</u></b> items to the stack, then locate will stop. But, if I just push <b><u>one</u></b> item to the stack, it works as expected.<br><br>I also noticed that when i push the text "blah" to the stack the 2nd time (instead of "continue"), I get a Windows error.<br><br>Here's a short sample showing the error:<br></p><pre>
<code><br>name "test"<br>outfile "test.exe"<br>!define ROOT "C:\TEMP"<br>!include FileFunc.nsh<br>!insertmacro Locate<br><br>Page instfiles<br><br>Section<br>    ${Locate} "${ROOT}" "/L=FD /M=*.* /G=1 /B=0" "AddToList"<br>SectionEnd<br><br>Function AddToList<br>    MessageBox MB_OK "$$R7=$R7"<br>    Push "$R7"<br>    Push "continue" <b><font color="green">### if I remove this line, it works fine</font></b><br>FunctionEnd<br></code>
</pre><br>
      <br>
      Is this an NSIS error or a problem with ${locate}?
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Instructor</span><br>
      <span class="post-time small text-muted">9th March 2006 16:27 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">You can not use NSIS stack in the callback function, because it is used by function. Only one push requered in the callback.<br>
      <br>
      P.S.<br>
      You can call another function from the callback, on condition that this function don't change the stack after completion.</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Comperio</span><br>
      <span class="post-time small text-muted">9th March 2006 19:42 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">hmmm... I see. I'll have to keep that in mind.<br>
      <br>
      I didn't see this this info in the NSIS manuals. Are you the one that manages those, or do I need to post a separate request on the NSIS sourceforge site?</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Comperio</span><br>
      <span class="post-time small text-muted">9th March 2006 23:24 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">*sigh* :(<br>
      I may have opened a big can of worms with this. In my example script above, I changed the sample script above to write the file names to a text file instead of pushing to the stack using the command <b><i>FileWrite $myHandle "$R7$\r$\n"</i></b>. (my hope was to bypass the stack completely and then retrieve the values one at a time later.) Unfortunately, I find that it didn't work, either. :cry:<br>
      <br>
      However, using a WriteIniStr command <b><i>WriteIniStr "$myFileName" "General" "$R7" ""</i></b> did work, so I guess I have a workaround.<br>
      <br>
      But, I'd still like to understand why the FileWrite did not work. My only guess is that some NSIS functions (like FileWrite) must also use the NSIS stack. Is this correct? (If so, would perhaps using regular variables work better?)</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Instructor</span><br>
      <span class="post-time small text-muted">10th March 2006 04:00 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">See example in manual "Write results to a text file"<br>
      <br></p>

      <blockquote>
        My only guess is that some NSIS functions (like FileWrite) must also use the NSIS stack. Is this correct?
      </blockquote>FileOpen-FileWrite-FileClose don't use NSIS stack.
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Comperio</span><br>
      <span class="post-time small text-muted">10th March 2006 14:37 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Thanks, Instructor. As always, your suggestion worked perfectly!<br>
      (I guess I can just chalk this up as a bad day.) :weird:</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Ary Manzana</span><br>
      <span class="post-time small text-muted">22nd March 2006 13:25 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Hi. I test this:<br>
      <br>
      ${VersionCompare} "2.3" "2.29" $0<br>
      <br>
      And it tells me that $0 is 2. That means that 2.29 is a higher version than 2.3, which is wrong. Same goes with:<br>
      <br>
      ${VersionCompare} "2.29" "2.3" $0<br>
      <br>
      it tells me that $0 is 1.<br>
      <br>
      I'll try to fix it, but I'm a newbie in NSIS...</p>
    </div>
    <hr>
    
    
    

    <div class="container">
      

      <ol class="breadcrumb">
        <li><a href="../index.html" class="glyphicon glyphicon-home"></a></li>

        <li><a href="f-65.html">NSIS Discussion</a></li>

        <li class="active">WordFunc.nsh + TextFunc.nsh + FileFunc.nsh</li>
      </ol>

      <p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=203228">WordFunc.nsh + TextFunc.nsh + FileFunc.nsh</a></p><br>

      <div class="post">
        <p class="post-meta"><span class="post-author text-primary">Ary Manzana</span><br>
        <span class="post-time small text-muted">22nd March 2006 13:27 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

        <p class="post-content">Sorry, I had a lapsus there. Just ignore my last post. :-P</p>
      </div>
      <hr>

      <div class="post">
        <p class="post-meta"><span class="post-author text-primary">dienjd</span><br>
        <span class="post-time small text-muted">1st April 2006 00:29 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

        <p class="post-content">GetOptions doesn't work correctly when it finds a URL because of the "/" in the URL value (example: /url=http://nsis.sf.net)<br>
        <br>
        Maybe a check can be added for "//" ?</p>
      </div>
      <hr>

      <div class="post">
        <p class="post-meta"><span class="post-author text-primary">Instructor</span><br>
        <span class="post-time small text-muted">1st April 2006 04:40 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

        <p class="post-content">Use quotes /url="http://nsis.sf.net"</p>
      </div>
      <hr>

      <div class="post">
        <p class="post-meta"><span class="post-author text-primary">dienjd</span><br>
        <span class="post-time small text-muted">1st April 2006 05:19 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

        <p class="post-content">I have a situation where I don't have control over what is passed in, so I can't have quotes put around the value itself. I got everything working by using a different routine to get the value. It's no problem, probably a very uncommon situation.</p>
      </div>
      <hr>

      <div class="post">
        <p class="post-meta"><span class="post-author text-primary">Instructor</span><br>
        <span class="post-time small text-muted">22nd May 2006 17:29 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

        <p class="post-content"><b>Word Functions Header v3.3<br>
        Text Functions Header v2.4<br>
        File Functions Header v3.2</b><br>
        <br>
        Changes:<br>
        <br>
        1. "<b>GetFileAttributes</b>" v1.2<br>
        &amp;nbsp;&amp;nbsp;&amp;nbsp;-Some corrections<br>
        <br>
        2. Prevent error in case of including headers several times.</p>
      </div>
      <hr>

      <div class="post">
        <p class="post-meta"><span class="post-author text-primary">Instructor</span><br>
        <span class="post-time small text-muted">23rd September 2006 07:20 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

        <p class="post-content"><b>Word Functions Header v3.3<br>
        Text Functions Header v2.4<br>
        File Functions Header v3.3</b><br>
        <br>
        Changes:<br>
        <br>
        1. "<b>Locate</b>" v1.8<br>
        &amp;nbsp;&amp;nbsp;&amp;nbsp;-Handles were not getting closed properly.<br>
        <br>
        2. "<b>GetSize</b>" v2.0<br>
        &amp;nbsp;&amp;nbsp;&amp;nbsp;-Handles were not getting closed properly.</p>
      </div>
      <hr>

      <div class="post">
        <p class="post-meta"><span class="post-author text-primary">Animaether</span><br>
        <span class="post-time small text-muted">23rd September 2006 08:23 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

        <p class="post-content">*zap* I was on an old page when I commented - d'oh!</p>
      </div>
      <hr>

      <div class="post">
        <p class="post-meta"><span class="post-author text-primary">dbyron</span><br>
        <span class="post-time small text-muted">16th November 2008 23:51 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

        <p class="post-content">Any chance to get the day and number of seconds returned from GetTime as a 0-padded string if it's less than 10? In other words "08" instead of "8" for seconds and day-of-month?<br>
        <br>
        Thanks much.<br>
        <br>
        -DB</p>
      </div>
      <hr>

      <div class="post">
        <p class="post-meta"><span class="post-author text-primary">Johnm312</span><br>
        <span class="post-time small text-muted">8th April 2009 17:47 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

        <p class="post-content">Edit. nevermind. I found the readme and i overlooked something.</p>
      </div>
      <hr>

      <div class="footer">
        <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
      </div>
    </div><script src="../js/highlight.pack.js" type="text/javascript">
</script> <script type="text/javascript">
//<![CDATA[
    hljs.initHighlightingOnLoad();
    //]]></script></div></body></html>