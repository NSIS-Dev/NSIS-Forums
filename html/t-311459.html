<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="getting user feedback on uninstall" />

  <title>getting user feedback on uninstall - NSIS Forums</title><!-- Bootstrap core CSS -->
  <link rel="stylesheet" type="text/css" href="//netdna.bootstrapcdn.com/bootswatch/3.0.1/readable/bootstrap.min.css" />
  <link rel="stylesheet" href="../css/style.css" type="text/css" /><!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!--[if lt IE 9]>
                <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
                <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->
</head>

<body>
  <div class="container">
    <!-- Put navigation bar here -->

    <ol class="breadcrumb">
      <li><a href="../index.html" class="glyphicon glyphicon-home"></a></li>

      <li><a href="f-65.html">NSIS Discussion</a></li>

      <li class="active">getting user feedback on uninstall</li>
    </ol>

    <p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=311459">getting user feedback on uninstall</a></p><br />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">xDan</span><br />
      <span class="post-time small text-muted">3rd September 2009 13:36 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>getting user feedback on uninstall</strong><br />
      Hi, is there any plugin or example to request the user for feedback on uninstalling the app? I.e. to ask why they uninstalled.<br />
      <br />
      (I guess it would post to a web form or something)</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">xDan</span><br />
      <span class="post-time small text-muted">3rd September 2009 14:32 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">It's ok, I think I will just open a web browser window to a webpage on uninstall, that will probably be much easier.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Anders</span><br />
      <span class="post-time small text-muted">3rd September 2009 15:13 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">except, there is a problem with opening browsers in the uninstaller, mainly, the add/remove program window waits for every uninstaller child process</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">xDan</span><br />
      <span class="post-time small text-muted">3rd September 2009 15:55 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Really? I just tried on XP and there didn't seem to be a problem.<br />
      <br />
      I did use this technique: <a href="http://nsis.sourceforge.net/Open_link_in_new_browser_window" target="_blank">http://nsis.sourceforge.net/Open_lin...browser_window</a><br />
      <br />
      Which is better than plain ol' ShellExecute.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Anders</span><br />
      <span class="post-time small text-muted">3rd September 2009 16:03 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"></p>

      <blockquote>
        <i>Originally posted by xDan</i><br />
        <b>Really? I just tried on XP and there didn't seem to be a problem.<br />
        <br />
        I did use this technique: <a href="http://nsis.sourceforge.net/Open_link_in_new_browser_window" target="_blank">http://nsis.sourceforge.net/Open_lin...browser_window</a><br />
        <br />
        Which is better than plain ol' ShellExecute.</b>
      </blockquote>That code is both wrong and stupid, ExecShell is the correct choice
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">CrushBug</span><br />
      <span class="post-time small text-muted">3rd September 2009 16:32 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Yeah, ow, use ExecShell as Anders says.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">xDan</span><br />
      <span class="post-time small text-muted">3rd September 2009 16:34 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">So are you going to bother to back that up with facts? Why exactly is it stupid?</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Anders</span><br />
      <span class="post-time small text-muted">3rd September 2009 18:03 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"></p>

      <blockquote>
        <i>Originally posted by xDan</i><br />
        <b>So are you going to bother to back that up with facts? Why exactly is it stupid?</b>
      </blockquote>ExecShell calls ShellExecute and that is correct way to open a url. Parsing the registry on your own is so error prone and not future proof.<br />
      <br />
      1) ReadRegStr $0 HKCR "http\shell\open\command" "" is problematic since open might not be the default verb, you would have to read HKCR "http\shell" "" first and get the default verb, if empty, use the first key found, if no keys are found, use open (this sounds weird, but thats how it is)<br />
      <br />
      2) This code does not handle REG_EXPAND_SZ<br />
      <br />
      3) Does not handle DDE, DropTarget or shellex handlers<br />
      <br />
      4) Breaks shellexecute hooks<br />
      <br />
      In short, it could start the wrong browser or not start anything at all. The specifics of ShellExecute is way to complicated for someone to emulate in a simple helper function like this
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">xDan</span><br />
      <span class="post-time small text-muted">3rd September 2009 18:34 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Well, ok then, I didn't realise that. ShellExecute is still annoying, though, in that in some cases it will use an already open window.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Anders</span><br />
      <span class="post-time small text-muted">3rd September 2009 19:07 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"></p>

      <blockquote>
        <i>Originally posted by xDan</i><br />
        <b>Well, ok then, I didn't realise that. ShellExecute is still annoying, though, in that in some cases it will use an already open window.</b>
      </blockquote>That is not ShellExecute's fault, it depends on the end user's setup (default browser and how this browser is registered)
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Anders</span><br />
      <span class="post-time small text-muted">3rd September 2009 20:14 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">You could try</p>
      <pre>
<code>rundll32 url.dll,FileProtocolHandler <a href="http://example.com" target="_blank">http://example.com</a></code>
</pre>probably not documented and might just call ShellExecute internally, I don't know<br />
      <br />
      edit:<br />
      yeah, on XP.SP2 at least, it just calls ShellExecuteA
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">xDan</span><br />
      <span class="post-time small text-muted">3rd September 2009 21:46 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Thanks anyway. I guess this isn't really a critical situation, I can live with a few problems if they are uninstalling the software trial anyway.</p>
    </div>
    <hr />

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]>
  </script>
</body>
</html>
