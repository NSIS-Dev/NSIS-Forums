<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="Custom page problem with 2.06" />

  <title>Custom page problem with 2.06 - NSIS Forums</title>
  <script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script>
  <!-- Bootstrap core CSS -->

  <link rel="stylesheet" type="text/css" href="//netdna.bootstrapcdn.com/bootswatch/3.0.1/readable/bootstrap.min.css" />
  <link rel="stylesheet" href="../css/style.css" type="text/css" /><!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!--[if lt IE 9]>
                <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
                <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->
</head>

<body>
  <div class="container">
    <!-- Put navigation bar here -->

    <ol class="breadcrumb">
      <li><a href="../index.html" class="glyphicon glyphicon-home"></a></li>

      <li><a href="f-65.html">NSIS Discussion</a></li>

      <li class="active">Custom page problem with 2.06</li>
    </ol>

    <p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=214327">Custom page problem with 2.06</a></p><br />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">sbellon</span><br />
      <span class="post-time small text-muted">27th April 2005 14:12 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>Custom page problem with 2.06</strong><br />
      I had a NSIS installer working with Modern UI and one custom page with NSIS 2.04, running with wine from Debian Linux. Now, Debian ships a Linux-native version of NSIS 2.06 and the installer doesn't show the custom page anymore. The rest is working fine. I wonder whether it's a change between 2.04 and 2.06 or whether the Linux version has a problem.<br />
      <br />
      The relevant part of the install script looks like this:<br />
      <br />
      !insertmacro MUI_PAGE_WELCOME<br />
      !insertmacro MUI_PAGE_LICENSE "LICENSE.txt"<br />
      !insertmacro MUI_PAGE_DIRECTORY<br />
      !insertmacro MUI_PAGE_INSTFILES<br />
      Page custom LicenseKeyInstallation ""<br />
      !insertmacro MUI_PAGE_FINISH<br />
      <br />
      ; later on<br />
      <br />
      Var TempFile<br />
      <br />
      Function LicenseKeyInstallation<br />
      GetTempFileName $TempFile<br />
      File /oname=$TempFile "win32\instkey.ini"<br />
      !insertmacro MUI_HEADER_TEXT "Install License Key" \<br />
      "Now you can optionally install your license key."<br />
      Push $R0<br />
      InstallOptions::dialog $TempFile<br />
      Pop $R0<br />
      StrCmp $R0 "success" 0 isNotSuccess<br />
      ReadINIStr $R0 $TempFile "Field 2" "State"<br />
      StrCmp $R0 "" isNotSuccess<br />
      CopyFiles /SILENT $R0 "$INSTDIR\license.key"<br />
      isNotSuccess:<br />
      Delete $TempFile<br />
      FunctionEnd<br />
      <br />
      Previously (with makensis 2.04, using wine from Linux) it created an installer that showed that custom page and you could enter a file or leave it blank. Now, with native 2.06 on Linux that page does not appear at all. And the final "Installation finished, click to exit" page does not appear either.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
      <span class="post-time small text-muted">28th April 2005 18:06 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Make sure the INI file has Windows line endings. Windows doesn't seem to like INI files with just LF.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">sbellon</span><br />
      <span class="post-time small text-muted">29th April 2005 15:24 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Ok, I just checked that.<br />
      <br />
      But even if I don't use a custom page, the installer terminates after the MUI_PAGE_INSTFILES page without any other page. If I don't add a custom page, the MUI_PAGE_FINISH page is not displayed either. The installer scripts do have DOS endings. I checked with wine and 2.06 and that works.<br />
      <br />
      So, it's in fact a problem with the Linux version: 2.06 windows works (even under wine), but 2.06 native Linux doesn't.<br />
      <br />
      Any further ideas?</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
      <span class="post-time small text-muted">29th April 2005 16:19 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Does the custom page show now, or did already have Windows line endings?<br />
      <br />
      The finish page's INI file also needs to have Windows line endings. The file is located at /path/to/nsis/Contrib/Modern UI/ioSpecial.ini. The script doesn't need Windows line endings because makensis parses it and not Windows.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">sbellon</span><br />
      <span class="post-time small text-muted">29th April 2005 16:57 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Changing the line endings of the custom page's .ini file didn't change anything. The .ini file of the finish page has already DOS line endings.<br />
      <br />
      Are you saying you are using Modern UI successfully by building installers from Linux?</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
      <span class="post-time small text-muted">29th April 2005 22:39 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Using the <a href="http://prdownloads.sourceforge.net/nsis/nsis206.tar.bz2?download" target="_blank">original package</a>, I have no problems building scripts using the Modern UI. It works with custom, welcome and finish pages. It might be a problem with the InstallOptions plug-in compiled under MinGW, or one of the patches applied to the Debian package. You should submit a bug report to the <a href="http://forums.winamp.com/member.php?s=&amp;action=getinfo&amp;userid=167723" target="_blank">package maintainer</a>.</p>
    </div>
    <hr />

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]>
  </script>
</body>
</html>
