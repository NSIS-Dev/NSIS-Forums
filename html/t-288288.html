<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="Passing Var to Registry" />

  <title>Passing Var to Registry - NSIS Forums</title>
  <script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script>
  <!-- Bootstrap core CSS -->

  <link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css" />
  <link rel="stylesheet" href="../css/style.css" type="text/css" /><!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!--[if lt IE 9]>
                <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
                <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->
</head>

<body>
  <div class="container">
    <!-- Put navigation bar here -->

    <ol class="breadcrumb">
      <li><a href="../index.html" class="glyphicon glyphicon-home"></a></li>

      <li><a href="f-65.html">NSIS Discussion</a></li>

      <li class="active">Passing Var to Registry</li>
    </ol>

    <p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=288288">Passing Var to Registry</a></p><br />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">hungryOrb</span><br />
      <span class="post-time small text-muted">11th March 2008 12:56 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>Passing Var to Registry</strong><br />
      I'm looking to ask a user to input 3 strings, then input those into the registry as program settings. I've looked around a little but couldn't make huge sense of the best(only?) way to do this. Was wondering if someone would offer a minute suggestion? ^.^</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Red Wine</span><br />
      <span class="post-time small text-muted">11th March 2008 13:22 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">See here,<br />
      <br />
      <a href="http://nsis.sourceforge.net/Reading_and_Writing_the_Registry_-_NSIS_makes_it_easy" target="_blank">http://nsis.sourceforge.net/Reading_..._makes_it_easy</a></p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">hungryOrb</span><br />
      <span class="post-time small text-muted">11th March 2008 14:42 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>-!</strong><br />
      Thanks RW. Although, for a nab such as I, that is a little hard to comprehend ;] I don't think I can make out even the start and finish of each way that you manage the registry :]<br />
      <br />
      Nps ;]</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">hungryOrb</span><br />
      <span class="post-time small text-muted">11th March 2008 15:14 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>MUI</strong><br />
      Does the MUI.nsh have any generic input pages that are easily customisable? I guess that would be easiest :]<br />
      Thanks for any helps.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">cheryll</span><br />
      <span class="post-time small text-muted">11th March 2008 15:32 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Hm, perhaps I don't understand it right, but isn't what you want quite simple?<br />
      Just make a custom- page with some textfields and labels, read the user-input in the leave-function and then just use WriteRegStr to store it in the registry.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">hungryOrb</span><br />
      <span class="post-time small text-muted">11th March 2008 15:39 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">That's exactly it Cheryll, ye. But reading through the Manual at this point of light comprehension is just too much, it's like throwing crowbars into the cogs. A small example or tutorial which touches that exact syntax would be ideal, more important than a solution is understanding, of course.<br />
      <br />
      If anyone knows of such a thing, I'd be delighted to hear :) thanks for any help.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">cheryll</span><br />
      <span class="post-time small text-muted">11th March 2008 15:54 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">I extracted the essential parts from one of my installers. Perhaps that will help. Btw. HM NIS Edit has an editor for ini-files. Makes it quite easy to build them. If you didn't know this.<br />
      <br /></p>
      <pre>
<code>;Add at appropriate place<br />Page custom UserInput UserInputLeave<br /><br />Function .onInit<br />!insertmacro MUI_INSTALLOPTIONS_EXTRACT_AS "UserInput.ini" "UserInput"<br />Functionend<br /><br />;Manipuale the page as you want befor showing it<br />Function UserInput<br />!insertmacro MUI_HEADER_TEXT $(PAGE_TITLE) $(PAGE_SUBTITLE)<br />!insertmacro MUI_INSTALLOPTIONS_WRITE "UserInput" "Settings" "Title" $(Title)<br />!insertmacro MUI_INSTALLOPTIONS_DISPLAY "UserInput"<br />FunctionEnd<br /><br />Function UserInputLeave<br />;read in the userinformation (use the appropriate Fieldnumbers)<br />!insertmacro MUI_INSTALLOPTIONS_READ $1 UserInput  "Field 3" "State"<br />!insertmacro MUI_INSTALLOPTIONS_READ $2 UserInput  "Field 2" "State"<br /><br />;write it to the registry<br />WriteRegStr HKLM "Software\${APP_NAME}\" "UserInput1" $1<br />WriteRegStr HKLM "Software\${APP_NAME}\" "UserInput2" $2<br /><br />FunctionEnd</code>
</pre>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">hungryOrb</span><br />
      <span class="post-time small text-muted">11th March 2008 15:59 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Oh, thankyou :) I just found the tutorial referring to the installer options feature :] I think I'm sorted now. tyty!</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">hungryOrb</span><br />
      <span class="post-time small text-muted">11th March 2008 16:32 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Does the order of the text dictate the order of the pages? :O</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">cheryll</span><br />
      <span class="post-time small text-muted">11th March 2008 16:49 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Well, the pages will be displayed in the same order in that they are written in the code, if that's what you're asking...</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">hungryOrb</span><br />
      <span class="post-time small text-muted">11th March 2008 17:01 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Yes, exactly :) I hadn't noticed any other indexing code of pages, but then, I'm not very observant :) thanks.<br />
      I hope you don't mind me asking questions continuously, you can always ignore or whatever ^.^<br />
      <br />
      Erm, the MUI macros are usually the start of the pages right? And what about the end of the pages? Do they only end before the "un." parts? At compile time, does the code get re-ordered to link the sections up to everything etc?<br />
      <br />
      If you hadn't guessed I'm a simple guy who must associate visually xD</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">hungryOrb</span><br />
      <span class="post-time small text-muted">11th March 2008 17:24 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Ahm. I followed the tutorial, and your example, and the code ended up between the auto-generated <font color="red">"!insertmacro MUI_PAGE_DIRECTORY"</font> and the beginning of the start menu !defines. It compiles, so I guess there is no error, but there is no page in the installer ^.^ This means it's in the wrong place doesn't it?<br />
      <br />
      EEK.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">cheryll</span><br />
      <span class="post-time small text-muted">11th March 2008 19:19 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"></p>

      <blockquote>
        Erm, the MUI macros are usually the start of the pages right? And what about the end of the pages? Do they only end before the "un." parts? At compile time, does the code get re-ordered to link the sections up to everything etc?
      </blockquote>Hm, not sure I understand what you mean.<br />
      You just list the installerpages, then the uninstaller pages.<br />
      The functions and sections come after that. You put the functions that do stuff before the installation before the functions and section that do stuff during the installation.<br />
      <br />

      <blockquote>
        Ahm. I followed the tutorial, and your example, and the code ended up between the auto-generated "!insertmacro MUI_PAGE_DIRECTORY" and the beginning of the start menu !defines. It compiles, so I guess there is no error, but there is no page in the installer ^.^ This means it's in the wrong place doesn't it?
      </blockquote>Have you got the ini-file? And is it in the same directory as the installer file? If yes, please post your code. It's easier if I know what you actually did.
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">hungryOrb</span><br />
      <span class="post-time small text-muted">12th March 2008 12:00 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>:]</strong><br />
      Thanks Cheryll.<br />
      <br /></p>
      <pre>
<code><br /><br />; HM NIS Edit Wizard helper defines<br />!define PRODUCT_NAME "Draco SSC"<br />!define PRODUCT_VERSION "1.0"<br />!define PRODUCT_PUBLISHER "Forwessun"<br />!define PRODUCT_WEB_SITE "http://www.forwessun.com"<br />!define PRODUCT_DIR_REGKEY "Software\Microsoft\Windows\CurrentVersion\App Paths\DracoSSC.exe"<br />!define PRODUCT_UNINST_KEY "Software\Microsoft\Windows\CurrentVersion\Uninstall\${PRODUCT_NAME}"<br />!define PRODUCT_UNINST_ROOT_KEY "HKLM"<br />!define PRODUCT_STARTMENU_REGVAL "NSIS:StartMenuDir"<br /><br />; MUI 1.67 compatible ------<br />!include "MUI.nsh"<br /><br />; MUI Settings<br />!define MUI_ABORTWARNING<br />!define MUI_ICON "${NSISDIR}\Contrib\Graphics\Icons\modern-install.ico"<br />!define MUI_UNICON "${NSISDIR}\Contrib\Graphics\Icons\modern-uninstall.ico"<br /><br />; Welcome page<br />!insertmacro MUI_PAGE_WELCOME<br />; Directory page<br />!insertmacro MUI_PAGE_DIRECTORY<br /><br />  Function .onInit<br />   !insertmacro MUI_INSTALLOPTIONS_EXTRACT_AS "Custom.ini" "Custom"<br />  Functionend<br /><br />   LangString CUSTOM_TITLE ${LANG_ENGLISH} "Enter your Login Details."<br />   LangString CUSTOM_SUBTITLE ${LANG_ENGLISH} " "<br />   Page custom Custom1Page<br />   <br /><br />#==================================<br /><br />Function UsernamePasswordPage<br /><br />   !insertmacro MUI_HEADER_TEXT "$(CUSTOM_TITLE)" "$(CUSTOM_SUBTITLE)"<br /><br />   # Display the page.<br />   !insertmacro MUI_INSTALLOPTIONS_DISPLAY "Custom"<br /><br />   # Get the user entered values.<br />   !insertmacro MUI_INSTALLOPTIONS_READ $Username "UserInput" "Field 1" "State"<br />   !insertmacro MUI_INSTALLOPTIONS_READ $Password "UserInput" "Field 2" "State"<br />   !insertmacro MUI_INSTALLOPTIONS_READ $Server "UserInput" "Field 3" "State"<br /><br />WriteRegStr HKCU "Software\VB and VBA Program Settings\${PRODUCT_NAME}\Main" "MySQLUser" $1 ;As per install instruction file.<br />WriteRegStr HKCU "Software\VB and VBA Program Settings\${PRODUCT_NAME}\Main" "MySQLPass" $2<br />WriteRegStr HKCU "Software\VB and VBA Program Settings\${PRODUCT_NAME}\Main" "MySQLADDR" $3<br /><br />FunctionEnd<br /><br />#===================================<br /><br />################################- Credit: Cheryll(NSIS Forum) -###############################<br />/*Page Custom UserInput UserInputLeave<br /><br />Function .onInit<br />!insertmacro MUI_INSTALLOPTIONS_EXTRACT_AS "Custom1.ini" "Custom1"<br />Functionend<br /><br />;Manipuale the page as you want befor showing it<br />Function UserInput<br />!insertmacro MUI_HEADER_TEXT $(PAGE_TITLE) $(PAGE_SUBTITLE)<br />!insertmacro MUI_INSTALLOPTIONS_WRITE "UserInput" "Settings" "Title" $(Title)<br />!insertmacro MUI_INSTALLOPTIONS_DISPLAY "UserInput"<br />FunctionEnd<br /><br />Function UserInputLeave<br />;read in the userinformation (use the appropriate Fieldnumbers)<br />!insertmacro MUI_INSTALLOPTIONS_READ $1 UserInput  "Field 1" "State"<br />!insertmacro MUI_INSTALLOPTIONS_READ $2 UserInput  "Field 2" "State"<br />!insertmacro MUI_INSTALLOPTIONS_READ $3 UserInput  "Field 3" "State"<br /><br />;write it to the registry<br />WriteRegStr HKCU "Software\VB and VBA Program Settings\${PRODUCT_NAME}\Main" "MySQLUser" $1 ;As per install instruction file.<br />WriteRegStr HKCU "Software\VB and VBA Program Settings\${PRODUCT_NAME}\Main" "MySQLPass" $2<br />WriteRegStr HKCU "Software\VB and VBA Program Settings\${PRODUCT_NAME}\Main" "MySQLADDR" $3<br /><br />FunctionEnd*/<br />################################- End of Custom Page 1 -#########################<br /><br /><br /><br /><br />; Start menu page<br />var ICONS_GROUP<br />!define MUI_STARTMENUPAGE_NODISABLE<br />!define MUI_STARTMENUPAGE_DEFAULTFOLDER "Draco SSC"<br />!define MUI_STARTMENUPAGE_REGISTRY_ROOT "${PRODUCT_UNINST_ROOT_KEY}"<br />!define MUI_STARTMENUPAGE_REGISTRY_KEY "${PRODUCT_UNINST_KEY}"<br />!define MUI_STARTMENUPAGE_REGISTRY_VALUENAME "${PRODUCT_STARTMENU_REGVAL}"<br />!insertmacro MUI_PAGE_STARTMENU Application $ICONS_GROUP<br />; Instfiles page<br />!insertmacro MUI_PAGE_INSTFILES<br />; Finish page<br />!define MUI_FINISHPAGE_RUN "$INSTDIR\DracoSSC.exe"<br />!insertmacro MUI_PAGE_FINISH<br /><br />; Uninstaller pages<br />!insertmacro MUI_UNPAGE_INSTFILES<br /><br />; Language files<br />!insertmacro MUI_LANGUAGE "English"<br /><br />; MUI end ------<br /><br />Name "${PRODUCT_NAME} ${PRODUCT_VERSION}"<br />OutFile "DracoSetup.exe"<br />InstallDir "$PROGRAMFILES\Draco SSC"<br />InstallDirRegKey HKLM "${PRODUCT_DIR_REGKEY}" ""<br />ShowInstDetails show<br />ShowUnInstDetails show<br /><br />######################################################-------------COPYING FILES<br />Section "Draco Files" SEC01<br />  SetOutPath "$INSTDIR"<br />  SetOverwrite try<br />  File "C:\Documents and Settings\Robin.Smith\Desktop\Draco NSIS Build Files\App\DAO350.DLL"<br />  File "C:\Documents and Settings\Robin.Smith\Desktop\Draco NSIS Build Files\App\Dracohelp.chm"<br />  File "C:\Documents and Settings\Robin.Smith\Desktop\Draco NSIS Build Files\App\dracok.dll"<br />  File "C:\Documents and Settings\Robin.Smith\Desktop\Draco NSIS Build Files\App\DracoSSC.exe"<br />  File "C:\Documents and Settings\Robin.Smith\Desktop\Draco NSIS Build Files\App\DracoUpdate.exe"<br />  File "C:\Documents and Settings\Robin.Smith\Desktop\Draco NSIS Build Files\App\ezVidC60.ocx"<br />  SetOutPath "$INSTDIR\Icons"<br />  File "C:\Documents and Settings\Robin.Smith\Desktop\Draco NSIS Build Files\App\Icons\Customer.ico"<br />  File "C:\Documents and Settings\Robin.Smith\Desktop\Draco NSIS Build Files\App\Icons\CustomerO.ico"<br />  File "C:\Documents and Settings\Robin.Smith\Desktop\Draco NSIS Build Files\App\Icons\CustomerX.ico"<br />  File "C:\Documents and Settings\Robin.Smith\Desktop\Draco NSIS Build Files\App\Icons\Dragon.ico"<br />  File "C:\Documents and Settings\Robin.Smith\Desktop\Draco NSIS Build Files\App\Icons\Job.ico"<br />  File "C:\Documents and Settings\Robin.Smith\Desktop\Draco NSIS Build Files\App\Icons\JobO.ico"<br />  File "C:\Documents and Settings\Robin.Smith\Desktop\Draco NSIS Build Files\App\Icons\JobX.ico"<br />  File "C:\Documents and Settings\Robin.Smith\Desktop\Draco NSIS Build Files\App\Icons\Order.ico"<br />  File "C:\Documents and Settings\Robin.Smith\Desktop\Draco NSIS Build Files\App\Icons\OrderO.ico"<br />  File "C:\Documents and Settings\Robin.Smith\Desktop\Draco NSIS Build Files\App\Icons\OrderX.ico"<br />  File "C:\Documents and Settings\Robin.Smith\Desktop\Draco NSIS Build Files\App\Icons\Quote.ico"<br />  File "C:\Documents and Settings\Robin.Smith\Desktop\Draco NSIS Build Files\App\Icons\QuoteO.ico"<br />  File "C:\Documents and Settings\Robin.Smith\Desktop\Draco NSIS Build Files\App\Icons\QuoteX.ico"<br />  File "C:\Documents and Settings\Robin.Smith\Desktop\Draco NSIS Build Files\App\Icons\Stock.ico"<br />  File "C:\Documents and Settings\Robin.Smith\Desktop\Draco NSIS Build Files\App\Icons\StockO.ico"<br />  File "C:\Documents and Settings\Robin.Smith\Desktop\Draco NSIS Build Files\App\Icons\StockX.ico"<br />  File "C:\Documents and Settings\Robin.Smith\Desktop\Draco NSIS Build Files\App\Icons\Supplier.ico"<br />  File "C:\Documents and Settings\Robin.Smith\Desktop\Draco NSIS Build Files\App\Icons\SupplierO.ico"<br />  File "C:\Documents and Settings\Robin.Smith\Desktop\Draco NSIS Build Files\App\Icons\SupplierX.ico"<br />  File "C:\Documents and Settings\Robin.Smith\Desktop\Draco NSIS Build Files\App\Icons\Thumbs.db"<br />  SetOutPath "$INSTDIR\Images"<br />  File "C:\Documents and Settings\Robin.Smith\Desktop\Draco NSIS Build Files\App\Images\confail.jpg"<br />  File "C:\Documents and Settings\Robin.Smith\Desktop\Draco NSIS Build Files\App\Images\dragon.jpg"<br />  File "C:\Documents and Settings\Robin.Smith\Desktop\Draco NSIS Build Files\App\Images\Floorplan.jpg"<br />  File "C:\Documents and Settings\Robin.Smith\Desktop\Draco NSIS Build Files\App\Images\lockbg.jpg"<br />  File "C:\Documents and Settings\Robin.Smith\Desktop\Draco NSIS Build Files\App\Images\logonbg.jpg"<br />  File "C:\Documents and Settings\Robin.Smith\Desktop\Draco NSIS Build Files\App\Images\po.jpg"<br />  File "C:\Documents and Settings\Robin.Smith\Desktop\Draco NSIS Build Files\App\Images\pocn.jpg"<br />  File "C:\Documents and Settings\Robin.Smith\Desktop\Draco NSIS Build Files\App\Images\splash.jpg"<br />  File "C:\Documents and Settings\Robin.Smith\Desktop\Draco NSIS Build Files\App\Images\Thumbs.db"<br />  File "C:\Documents and Settings\Robin.Smith\Desktop\Draco NSIS Build Files\App\Images\update.avi"<br />  File "C:\Documents and Settings\Robin.Smith\Desktop\Draco NSIS Build Files\App\Images\WelcomeBitMap.bmp"<br />  SetOutPath "$INSTDIR"<br />  File "C:\Documents and Settings\Robin.Smith\Desktop\Draco NSIS Build Files\App\KDateBox.ocx"<br />  File "C:\Documents and Settings\Robin.Smith\Desktop\Draco NSIS Build Files\App\langs.dat"<br />  File "C:\Documents and Settings\Robin.Smith\Desktop\Draco NSIS Build Files\App\LanguageEditor.exe"<br />  File "C:\Documents and Settings\Robin.Smith\Desktop\Draco NSIS Build Files\App\LanguageSelector.exe"<br />  SetOutPath "$INSTDIR\Modules\CommandPrompt"<br />  File "C:\Documents and Settings\Robin.Smith\Desktop\Draco NSIS Build Files\App\Modules\CommandPrompt\CommandPrompt.exe"<br />  SetOutPath "$INSTDIR\Modules"<br />  File "C:\Documents and Settings\Robin.Smith\Desktop\Draco NSIS Build Files\App\Modules\CommandPrompt.dmd"<br />  File "C:\Documents and Settings\Robin.Smith\Desktop\Draco NSIS Build Files\App\Modules\DracoSSC.DDF"<br />  SetOutPath "$INSTDIR\Modules\TestJet"<br />  File "C:\Documents and Settings\Robin.Smith\Desktop\Draco NSIS Build Files\App\Modules\TestJet\TestJet.exe"<br />  SetOutPath "$INSTDIR\Modules"<br />  File "C:\Documents and Settings\Robin.Smith\Desktop\Draco NSIS Build Files\App\Modules\TestJet.dmd"<br />  SetOutPath "$INSTDIR\Modules\Verifier"<br />  File "C:\Documents and Settings\Robin.Smith\Desktop\Draco NSIS Build Files\App\Modules\Verifier\verifier.cmd"<br />  SetOutPath "$INSTDIR"<br />  File "C:\Documents and Settings\Robin.Smith\Desktop\Draco NSIS Build Files\App\MSDERUN.DLL"<br />  File "C:\Documents and Settings\Robin.Smith\Desktop\Draco NSIS Build Files\App\SSubTmr6.dll"<br />  File "C:\Documents and Settings\Robin.Smith\Desktop\Draco NSIS Build Files\App\unzip32.dll"<br />  File "C:\Documents and Settings\Robin.Smith\Desktop\Draco NSIS Build Files\App\UpdateInProgress.exe"<br />  File "C:\Documents and Settings\Robin.Smith\Desktop\Draco NSIS Build Files\App\Updates.txt"<br />  SetOutPath "$INSTDIR\User Modules"<br />  File "C:\Documents and Settings\Robin.Smith\Desktop\Draco NSIS Build Files\App\User Modules\_dmd syntax.txt"<br />  SetOutPath "$INSTDIR"<br />  File "C:\Documents and Settings\Robin.Smith\Desktop\Draco NSIS Build Files\App\WinSubHook.tlb"<br />  File "C:\Documents and Settings\Robin.Smith\Desktop\Draco NSIS Build Files\App\zip32.dll"<br /><br />; Shortcuts<br />  !insertmacro MUI_STARTMENU_WRITE_BEGIN Application<br />  CreateDirectory "$SMPROGRAMS\$ICONS_GROUP"<br />  CreateShortCut "$SMPROGRAMS\$ICONS_GROUP\Draco SSC.lnk" "$INSTDIR\DracoSSC.exe"<br />  CreateShortCut "$DESKTOP\Draco SSC.lnk" "$INSTDIR\DracoSSC.exe"<br />  !insertmacro MUI_STARTMENU_WRITE_END<br />SectionEnd<br /><br />Section "System" SEC02<br />  SetOutPath "$WINDIR\System\TestFolder1"<br />  File "C:\Documents and Settings\Robin.Smith\Desktop\Draco NSIS Build Files\MySQL (Goes in System Folder)\myodbc3.dll"<br />  File "C:\Documents and Settings\Robin.Smith\Desktop\Draco NSIS Build Files\MySQL (Goes in System Folder)\myodbc3.hlp"<br />  File "C:\Documents and Settings\Robin.Smith\Desktop\Draco NSIS Build Files\MySQL (Goes in System Folder)\myodbc3.lib"<br />  File "C:\Documents and Settings\Robin.Smith\Desktop\Draco NSIS Build Files\MySQL (Goes in System Folder)\myodbc3c.exe"<br />  File "C:\Documents and Settings\Robin.Smith\Desktop\Draco NSIS Build Files\MySQL (Goes in System Folder)\myodbc3i.exe"<br />  File "C:\Documents and Settings\Robin.Smith\Desktop\Draco NSIS Build Files\MySQL (Goes in System Folder)\myodbc3m.exe"<br />  File "C:\Documents and Settings\Robin.Smith\Desktop\Draco NSIS Build Files\MySQL (Goes in System Folder)\myodbc3S.dll"<br />  File "C:\Documents and Settings\Robin.Smith\Desktop\Draco NSIS Build Files\MySQL (Goes in System Folder)\myodbc3S.lib"<br />  File "C:\Documents and Settings\Robin.Smith\Desktop\Draco NSIS Build Files\System Folder\COMCT332.OCX"<br />  File "C:\Documents and Settings\Robin.Smith\Desktop\Draco NSIS Build Files\System Folder\COMDLG32.OCX"<br />  File "C:\Documents and Settings\Robin.Smith\Desktop\Draco NSIS Build Files\System Folder\FM20.DLL"<br />  File "C:\Documents and Settings\Robin.Smith\Desktop\Draco NSIS Build Files\System Folder\hhctrl.ocx"<br />  File "C:\Documents and Settings\Robin.Smith\Desktop\Draco NSIS Build Files\System Folder\msado25.tlb"<br />  File "C:\Documents and Settings\Robin.Smith\Desktop\Draco NSIS Build Files\System Folder\MSCOMCT2.OCX"<br />  File "C:\Documents and Settings\Robin.Smith\Desktop\Draco NSIS Build Files\System Folder\MSCOMCTL.OCX"<br />  File "C:\Documents and Settings\Robin.Smith\Desktop\Draco NSIS Build Files\System Folder\MSFLXGRD.OCX"<br />  File "C:\Documents and Settings\Robin.Smith\Desktop\Draco NSIS Build Files\System Folder\MSHFLXGD.OCX"<br />  File "C:\Documents and Settings\Robin.Smith\Desktop\Draco NSIS Build Files\System Folder\MSINET.OCX"<br />  File "C:\Documents and Settings\Robin.Smith\Desktop\Draco NSIS Build Files\System Folder\MSMAPI32.OCX"<br />  File "C:\Documents and Settings\Robin.Smith\Desktop\Draco NSIS Build Files\System Folder\MSMASK32.OCX"<br />  File "C:\Documents and Settings\Robin.Smith\Desktop\Draco NSIS Build Files\System Folder\msvcr71.dll"<br />  File "C:\Documents and Settings\Robin.Smith\Desktop\Draco NSIS Build Files\System Folder\richtx32.ocx"<br />  File "C:\Documents and Settings\Robin.Smith\Desktop\Draco NSIS Build Files\System Folder\scrrun.dll"<br />  File "C:\Documents and Settings\Robin.Smith\Desktop\Draco NSIS Build Files\VB6 Runtimes\asycfilt.dll"<br />  File "C:\Documents and Settings\Robin.Smith\Desktop\Draco NSIS Build Files\VB6 Runtimes\COMCAT.DLL"<br />  File "C:\Documents and Settings\Robin.Smith\Desktop\Draco NSIS Build Files\VB6 Runtimes\msvbvm60.dll"<br />  File "C:\Documents and Settings\Robin.Smith\Desktop\Draco NSIS Build Files\VB6 Runtimes\oleaut32.dll"<br />  File "C:\Documents and Settings\Robin.Smith\Desktop\Draco NSIS Build Files\VB6 Runtimes\olepro32.dll"<br />  File "C:\Documents and Settings\Robin.Smith\Desktop\Draco NSIS Build Files\VB6 Runtimes\stdole2.tlb"<br />######################################################---------------------------------------END OF COPYING FILES<br /><br />; Shortcuts<br />  !insertmacro MUI_STARTMENU_WRITE_BEGIN Application<br />  CreateShortCut "$SMPROGRAMS\$ICONS_GROUP\Help.lnk" "$WINDIR\System\TestFolder1\myodbc3.hlp"<br />  !insertmacro MUI_STARTMENU_WRITE_END<br />SectionEnd<br /><br />Section -AdditionalIcons<br />  SetOutPath $INSTDIR<br />  !insertmacro MUI_STARTMENU_WRITE_BEGIN Application<br />  WriteIniStr "$INSTDIR\${PRODUCT_NAME}.url" "InternetShortcut" "URL" "${PRODUCT_WEB_SITE}"<br />  CreateShortCut "$SMPROGRAMS\$ICONS_GROUP\Website.lnk" "$INSTDIR\${PRODUCT_NAME}.url"<br />  !insertmacro MUI_STARTMENU_WRITE_END<br />SectionEnd<br /><br />Section -Post<br />  WriteUninstaller "$INSTDIR\uninst.exe"<br />  WriteRegStr HKLM "${PRODUCT_DIR_REGKEY}" "" "$INSTDIR\DracoSSC.exe"<br />  WriteRegStr ${PRODUCT_UNINST_ROOT_KEY} "${PRODUCT_UNINST_KEY}" "DisplayName" "$(^Name)"<br />  WriteRegStr ${PRODUCT_UNINST_ROOT_KEY} "${PRODUCT_UNINST_KEY}" "UninstallString" "$INSTDIR\uninst.exe"<br />  WriteRegStr ${PRODUCT_UNINST_ROOT_KEY} "${PRODUCT_UNINST_KEY}" "DisplayIcon" "$INSTDIR\DracoSSC.exe"<br />  WriteRegStr ${PRODUCT_UNINST_ROOT_KEY} "${PRODUCT_UNINST_KEY}" "DisplayVersion" "${PRODUCT_VERSION}"<br />  WriteRegStr ${PRODUCT_UNINST_ROOT_KEY} "${PRODUCT_UNINST_KEY}" "URLInfoAbout" "${PRODUCT_WEB_SITE}"<br />  WriteRegStr ${PRODUCT_UNINST_ROOT_KEY} "${PRODUCT_UNINST_KEY}" "Publisher" "${PRODUCT_PUBLISHER}"<br />SectionEnd<br /><br /><br /><br />Function un.onUninstSuccess<br />  HideWindow<br />  MessageBox MB_ICONINFORMATION|MB_OK "$(^Name) was successfully removed from your computer."<br />FunctionEnd<br /><br />Function un.onInit<br />  MessageBox MB_ICONQUESTION|MB_YESNO|MB_DEFBUTTON2 "Are you sure you want to completely remove $(^Name) and all of its components?" IDYES +2<br />  Abort<br />FunctionEnd<br /><br />Section Uninstall<br />  !insertmacro MUI_STARTMENU_GETFOLDER "Application" $ICONS_GROUP<br />  Delete "$INSTDIR\${PRODUCT_NAME}.url"<br />  Delete "$INSTDIR\uninst.exe"<br />  Delete "$WINDIR\System\TestFolder1\stdole2.tlb"<br />  Delete "$WINDIR\System\TestFolder1\olepro32.dll"<br />  Delete "$WINDIR\System\TestFolder1\oleaut32.dll"<br />  Delete "$WINDIR\System\TestFolder1\msvbvm60.dll"<br />  Delete "$WINDIR\System\TestFolder1\COMCAT.DLL"<br />  Delete "$WINDIR\System\TestFolder1\asycfilt.dll"<br />  Delete "$WINDIR\System\TestFolder1\scrrun.dll"<br />  Delete "$WINDIR\System\TestFolder1\richtx32.ocx"<br />  Delete "$WINDIR\System\TestFolder1\msvcr71.dll"<br />  Delete "$WINDIR\System\TestFolder1\MSMASK32.OCX"<br />  Delete "$WINDIR\System\TestFolder1\MSMAPI32.OCX"<br />  Delete "$WINDIR\System\TestFolder1\MSINET.OCX"<br />  Delete "$WINDIR\System\TestFolder1\MSHFLXGD.OCX"<br />  Delete "$WINDIR\System\TestFolder1\MSFLXGRD.OCX"<br />  Delete "$WINDIR\System\TestFolder1\MSCOMCTL.OCX"<br />  Delete "$WINDIR\System\TestFolder1\MSCOMCT2.OCX"<br />  Delete "$WINDIR\System\TestFolder1\msado25.tlb"<br />  Delete "$WINDIR\System\TestFolder1\hhctrl.ocx"<br />  Delete "$WINDIR\System\TestFolder1\FM20.DLL"<br />  Delete "$WINDIR\System\TestFolder1\COMDLG32.OCX"<br />  Delete "$WINDIR\System\TestFolder1\COMCT332.OCX"<br />  Delete "$WINDIR\System\TestFolder1\myodbc3S.lib"<br />  Delete "$WINDIR\System\TestFolder1\myodbc3S.dll"<br />  Delete "$WINDIR\System\TestFolder1\myodbc3m.exe"<br />  Delete "$WINDIR\System\TestFolder1\myodbc3i.exe"<br />  Delete "$WINDIR\System\TestFolder1\myodbc3c.exe"<br />  Delete "$WINDIR\System\TestFolder1\myodbc3.lib"<br />  Delete "$WINDIR\System\TestFolder1\myodbc3.hlp"<br />  Delete "$WINDIR\System\TestFolder1\myodbc3.gid"<br />  Delete "$WINDIR\System\TestFolder1\myodbc3.fts"<br />  Delete "$WINDIR\System\TestFolder1\myodbc3.dll"<br />  Delete "$INSTDIR\zip32.dll"<br />  Delete "$INSTDIR\WinSubHook.tlb"<br />  Delete "$INSTDIR\User Modules\_dmd syntax.txt"<br />  Delete "$INSTDIR\Updates.txt"<br />  Delete "$INSTDIR\UpdateInProgress.exe"<br />  Delete "$INSTDIR\unzip32.dll"<br />  Delete "$INSTDIR\SSubTmr6.dll"<br />  Delete "$INSTDIR\MSDERUN.DLL"<br />  Delete "$INSTDIR\Modules\Verifier\verifier.cmd"<br />  Delete "$INSTDIR\Modules\TestJet.dmd"<br />  Delete "$INSTDIR\Modules\TestJet\TestJet.exe"<br />  Delete "$INSTDIR\Modules\DracoSSC.DDF"<br />  Delete "$INSTDIR\Modules\CommandPrompt.dmd"<br />  Delete "$INSTDIR\Modules\CommandPrompt\CommandPrompt.exe"<br />  Delete "$INSTDIR\LanguageSelector.exe"<br />  Delete "$INSTDIR\LanguageEditor.exe"<br />  Delete "$INSTDIR\langs.dat"<br />  Delete "$INSTDIR\KDateBox.ocx"<br />  Delete "$INSTDIR\Images\WelcomeBitMap.bmp"<br />  Delete "$INSTDIR\Images\update.avi"<br />  Delete "$INSTDIR\Images\Thumbs.db"<br />  Delete "$INSTDIR\Images\splash.jpg"<br />  Delete "$INSTDIR\Images\pocn.jpg"<br />  Delete "$INSTDIR\Images\po.jpg"<br />  Delete "$INSTDIR\Images\logonbg.jpg"<br />  Delete "$INSTDIR\Images\lockbg.jpg"<br />  Delete "$INSTDIR\Images\Floorplan.jpg"<br />  Delete "$INSTDIR\Images\dragon.jpg"<br />  Delete "$INSTDIR\Images\confail.jpg"<br />  Delete "$INSTDIR\Icons\Thumbs.db"<br />  Delete "$INSTDIR\Icons\SupplierX.ico"<br />  Delete "$INSTDIR\Icons\SupplierO.ico"<br />  Delete "$INSTDIR\Icons\Supplier.ico"<br />  Delete "$INSTDIR\Icons\StockX.ico"<br />  Delete "$INSTDIR\Icons\StockO.ico"<br />  Delete "$INSTDIR\Icons\Stock.ico"<br />  Delete "$INSTDIR\Icons\QuoteX.ico"<br />  Delete "$INSTDIR\Icons\QuoteO.ico"<br />  Delete "$INSTDIR\Icons\Quote.ico"<br />  Delete "$INSTDIR\Icons\OrderX.ico"<br />  Delete "$INSTDIR\Icons\OrderO.ico"<br />  Delete "$INSTDIR\Icons\Order.ico"<br />  Delete "$INSTDIR\Icons\JobX.ico"<br />  Delete "$INSTDIR\Icons\JobO.ico"<br />  Delete "$INSTDIR\Icons\Job.ico"<br />  Delete "$INSTDIR\Icons\Dragon.ico"<br />  Delete "$INSTDIR\Icons\CustomerX.ico"<br />  Delete "$INSTDIR\Icons\CustomerO.ico"<br />  Delete "$INSTDIR\Icons\Customer.ico"<br />  Delete "$INSTDIR\ezVidC60.ocx"<br />  Delete "$INSTDIR\DracoUpdate.exe"<br />  Delete "$INSTDIR\DracoSSC.exe"<br />  Delete "$INSTDIR\dracok.dll"<br />  Delete "$INSTDIR\Dracohelp.chm"<br />  Delete "$INSTDIR\DAO350.DLL"<br /><br />  Delete "$SMPROGRAMS\$ICONS_GROUP\Website.lnk"<br />  Delete "$SMPROGRAMS\$ICONS_GROUP\Help.lnk"<br />  Delete "$DESKTOP\Draco SSC.lnk"<br />  Delete "$SMPROGRAMS\$ICONS_GROUP\Draco SSC.lnk"<br /><br />  RMDir "$WINDIR\System\TestFolder1"<br />  RMDir "$SMPROGRAMS\$ICONS_GROUP"<br />  RMDir "$INSTDIR\User Modules"<br />  RMDir "$INSTDIR\Modules\Verifier"<br />  RMDir "$INSTDIR\Modules\TestJet"<br />  RMDir "$INSTDIR\Modules\CommandPrompt"<br />  RMDir "$INSTDIR\Modules"<br />  RMDir "$INSTDIR\Images"<br />  RMDir "$INSTDIR\Icons"<br />  RMDir "$INSTDIR"<br /><br />  ######## Deleting MySQL user details from registry.<br />  /*DeleteRegValue HKCU "Software\VB and VBA Program Settings\${PRODUCT_NAME}\Main" "MySQLUser" $1<br />  DeleteRegValue HKCU "Software\VB and VBA Program Settings\${PRODUCT_NAME}\Main" "MySQLPass" $2<br />  DeleteRegValue HKCU "Software\VB and VBA Program Settings\${PRODUCT_NAME}\Main" "MySQLADDR" $3*/<br />  ########<br /><br />  DeleteRegKey ${PRODUCT_UNINST_ROOT_KEY} "${PRODUCT_UNINST_KEY}"<br />  DeleteRegKey HKLM "${PRODUCT_DIR_REGKEY}"<br />  SetAutoClose true<br />SectionEnd<br /><br /></code>
</pre><br />
      <br />
      I'm guessing you know what you are looking for, so I didn't bother editing any of it out. Thanks for taking the time, I admire you for it.<br />
      <br />
      At this point, I was attempting to follow the tutorial which is downloadable in a .doc from the tutorials main site, while using your example as reference :]<br />
      <br />
      Edit. Sorry forgot to add that yes, the .ini file is in the same folder as the script.
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">cheryll</span><br />
      <span class="post-time small text-muted">12th March 2008 15:56 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Acctualy, the whole order is messed up.<br />
      Try order it like this<br />
      <br />
      - Variables, Naming and stuff<br />
      - pages (just the pages and stuff you have to define for the page like so:<br /></p>
      <pre>
<code><br />; Welcome page<br />!insertmacro MUI_PAGE_WELCOME<br />; Directory page<br />!insertmacro MUI_PAGE_DIRECTORY<br />LangString CUSTOM_TITLE ${LANG_ENGLISH} "Enter your Login Details."<br />LangString CUSTOM_SUBTITLE ${LANG_ENGLISH} " "<br />Page custom Custom1Page<br />; Start menu page<br />var ICONS_GROUP<br />!define MUI_STARTMENUPAGE_NODISABLE<br />!define MUI_STARTMENUPAGE_DEFAULTFOLDER "Draco SSC"<br />!define MUI_STARTMENUPAGE_REGISTRY_ROOT "${PRODUCT_UNINST_ROOT_KEY}"<br />!define MUI_STARTMENUPAGE_REGISTRY_KEY "${PRODUCT_UNINST_KEY}"<br />!define MUI_STARTMENUPAGE_REGISTRY_VALUENAME "${PRODUCT_STARTMENU_REGVAL}"<br />!insertmacro MUI_PAGE_STARTMENU Application $ICONS_GROUP<br />; Instfiles page<br />!insertmacro MUI_PAGE_INSTFILES<br />; Finish page<br />!define MUI_FINISHPAGE_RUN "$INSTDIR\DracoSSC.exe"<br />!insertmacro MUI_PAGE_FINISH</code>
</pre><br />
      <br />
      -localization and language stuff<br />
      -Functions (onInit, then the custompage function, then the sections, then un.onInit, un.Sections, un.onUninstSucces)<br />
      <br />
      <br />
      Basicly, first tell the installer which pages to use in what order, then follow with the function in the order they will most likely be used. I'm not certain if everything has to be in exact order, but it's easier to read and comprehend that way at least.<br />
      <br />
      Oh, and if you got a custom Page called CustomPage you got to call the function the same.
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">hungryOrb</span><br />
      <span class="post-time small text-muted">18th March 2008 15:28 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>:]</strong><br />
      Thanks very much Cheryll, I'll try to follow your advice. I've tried following some learning resources, but don't find them thorough enough, while I find the manual a little too tough to wade through ;]<br />
      <br />
      edit1: Sorry, been dumped with some work that has taken time, I hope I haven't made you waste any time checking for replies ^.^<br />
      <br />
      Edit2: Oh, my custom page is simply called Custom, so I guess the function would be 'Custom'.</p>
    </div>
    <hr />

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]>
  </script>
</body>
</html>
