<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="description" content="MUI_PAGE_DIRECTORY not shown in some cases"><title>MUI_PAGE_DIRECTORY not shown in some cases - NSIS Forums</title><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script><link rel="preload" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css" as="style" onload="this.rel='stylesheet'"><link rel="preload" href="../css/style.css" as="style" onload="this.rel='stylesheet'"><noscript><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css"><link rel="stylesheet" href="../css/style.css"></noscript><script>!function(a){"use strict";var b=function(b,c,d){function e(a){return h.body?a():void setTimeout(function(){e(a)})}function f(){i.addEventListener&&i.removeEventListener("load",f),i.media=d||"all"}var g,h=a.document,i=h.createElement("link");if(c)g=c;else{var j=(h.body||h.getElementsByTagName("head")[0]).childNodes;g=j[j.length-1]}var k=h.styleSheets;i.rel="stylesheet",i.href=b,i.media="only x",e(function(){g.parentNode.insertBefore(i,c?g:g.nextSibling)});var l=function(a){for(var b=i.href,c=k.length;c--;)if(k[c].href===b)return a();setTimeout(function(){l(a)})};return i.addEventListener&&i.addEventListener("load",f),i.onloadcssdefined=l,l(f),i};"undefined"!=typeof exports?exports.loadCSS=b:a.loadCSS=b}("undefined"!=typeof global?global:this);!function(a){if(a.loadCSS){var b=loadCSS.relpreload={};if(b.support=function(){try{return a.document.createElement("link").relList.supports("preload")}catch(b){return!1}},b.poly=function(){for(var b=a.document.getElementsByTagName("link"),c=0;c<b.length;c++){var d=b[c];"preload"===d.rel&&"style"===d.getAttribute("as")&&(a.loadCSS(d.href,d,d.getAttribute("media")),d.rel=null)}},!b.support()){b.poly();var c=a.setInterval(b.poly,300);a.addEventListener&&a.addEventListener("load",function(){b.poly(),a.clearInterval(c)}),a.attachEvent&&a.attachEvent("onload",function(){a.clearInterval(c)})}}}(this);</script></head><body><div class="container"><ol class="breadcrumb"><li><a href="../index.html" class="glyphicon glyphicon-home"></a></li><li><a href="f-65.html">NSIS Discussion</a></li><li class="active">MUI_PAGE_DIRECTORY not shown in some cases</li></ol><p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=250790">MUI_PAGE_DIRECTORY not shown in some cases</a></p><br><div class="post"><p class="post-meta"><span class="post-author text-primary">coco_vc</span><br><span class="post-time small text-muted">10th July 2006 14:57 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>MUI_PAGE_DIRECTORY not shown in some cases</strong><br>Hi all,<br><br>When my setup is run, if the product is already installed, I show a custom page with the following options: uninstall before installing, uninstall only, overwrite files only. In case "overwrite files only" is chosen I would like _not_ to show the installation-directory-page MUI_PAGE_DIRECTORY, as I don't want the user to choose another directory, b/c I want the INSTDIR to be the one from previous installation.<br><br>So, how can I not show the MUI_PAGE_DIRECTORY page in case a specific option was chosen on a custom page.<br><br>Thx,<br>Viv</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">galil</span><br><span class="post-time small text-muted">10th July 2006 15:17 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">From NSIS manual, about Pages...<br>"The pre-function allows you to skip the page using Abort."</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">coco_vc</span><br><span class="post-time small text-muted">10th July 2006 16:06 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Thx galil,<br><br>I'm using the Modern UI so the Pages section from help doesn't really apply. But following that info, I was able to find the info I need in the NSIS\Docs\Modern UI\Readme.html in the "Page Custom Functions". Seems that I need to define the<br>MUI_PAGE_CUSTOMFUNCTION_PRE function<br>just before the<br>!insertmacro MUI_PAGE_DIRECTORY<br>and then in function to just Abort in case needed.<br><br>Thx,<br>Viv</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">galil</span><br><span class="post-time small text-muted">10th July 2006 16:36 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"></p><blockquote><i>Originally posted by coco_vc</i><br>I'm using the Modern UI so the Pages section from help doesn't really apply.</blockquote>How does it not apply if you can skip a page with Abort command in callback "pre" function regardless of which UI you are using?<br>Everything does apply. Concept and mechanics are the same. It's just a matter of different syntax in some cases between Standard and Modern UI (which uses defines and macros more). In fact you could even define pages in modern script the "old" way:<br>Page directory prefunc<br>instead of the "modern" and more cumbersome way with define and insertmacro, and still get the same working modern UI.</div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br><span class="post-time small text-muted">10th July 2006 23:17 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Of course it isn't recommended.<br>Just create the callbacks like so:<br><br>!define MUI_PAGE_CUSTOMFUNCTION_PRE DirectoryPre<br>!insertmacro MUI_PAGE_DIRECTORY<br><br>All of this is in the Modern UI documentation.<br><br>-Stu</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">saschagottfried</span><br><span class="post-time small text-muted">5th September 2006 15:27 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">There is a perfect "builtin"-example for such a feature which coco_vc tries to realize.<br><br>The installer file for NSIS itself.<br>$NSISDIR\examples\makensis.nsi<br><br>!ifdef VER_MAJOR &amp; VER_MINOR &amp; VER_REVISION &amp; VER_BUILD<br>Page custom PageReinstall PageLeaveReinstall<br>!endif<br><br>The PRE function "PageReinstall" checks the registry which NSIS version is already installed and shows a custom dialog depending on the result. It's very modern usage of MUI macros.<br><br>By the way, NSIS installer offers the selection of another target directory even if it is already installed. Thats exactly what coco_vc tries to avoid.<br><br>Is there a reason why this is still enabled???</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">kichik</span><br><span class="post-time small text-muted">8th September 2006 16:23 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"></p><blockquote>Is there a reason why this is still enabled???</blockquote>Why shouldn't this be enabled? The user shouldn't be forced to install the application anywhere. What if he wants to have two versions side-by-side?</div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">kalverson</span><br><span class="post-time small text-muted">27th June 2007 19:10 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"></p><blockquote><i>Originally posted by Afrow UK</i><br><b>Put of course it isn't recommended.<br>Just create the callbacks like so:<br><br>!define MUI_PAGE_CUSTOMFUNCTION_PRE DirectoryPre<br>!insertmacro MUI_PAGE_DIRECTORY<br><br>All of this is in the Modern UI documentation.<br><br>-Stu</b></blockquote>I spend several hours trying to figure out why my custom function named "SkipDirectory" was zero'ed out by the compiler as an unreferenced custom function. Of course when I renamed the function to DirectoryPre it worked fine. This would seem to be a bug when you have to guess at what the custome function should be called.</div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">kichik</span><br><span class="post-time small text-muted">27th June 2007 19:26 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">You don't have to guess, you set it with MUI_PAGE_CUSTOMFUNCTION_PRE.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">kalverson</span><br><span class="post-time small text-muted">3rd July 2007 14:21 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"></p><blockquote><i>Originally posted by kichik</i><br><b>You don't have to guess, you set it with MUI_PAGE_CUSTOMFUNCTION_PRE.</b></blockquote>I did that with many different names that did not work including the one in my previous post. The only one that worked for me was DirectoryPre.</div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br><span class="post-time small text-muted">3rd July 2007 15:20 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">No, you still have the wrong end of the stick!<br><br>!define MUI_PAGE_CUSTOMFUNCTION_PRE <b>MyFunc</b><br>...<br><br>Function <b>MyFunc</b><br>...<br><br>If the function name set with MUI_PAGE_CUSTOMFUNCTION_PRE does not exist then your script will not compile.<br><br>Stu</p></div><hr><div class="footer"><p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p></div></div><script src="../js/highlight.pack.js" type="text/javascript"></script><script type="text/javascript">//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]></script></body></html>