<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="description" content="Cancelling the installation process as it happens"><title>Cancelling the installation process as it happens - NSIS Forums</title><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script><link rel="preload" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css" as="style" onload="this.rel='stylesheet'"><link rel="preload" href="../css/style.css" as="style" onload="this.rel='stylesheet'"><noscript><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css"><link rel="stylesheet" href="../css/style.css"></noscript><script>!function(a){"use strict";var b=function(b,c,d){function e(a){return h.body?a():void setTimeout(function(){e(a)})}function f(){i.addEventListener&&i.removeEventListener("load",f),i.media=d||"all"}var g,h=a.document,i=h.createElement("link");if(c)g=c;else{var j=(h.body||h.getElementsByTagName("head")[0]).childNodes;g=j[j.length-1]}var k=h.styleSheets;i.rel="stylesheet",i.href=b,i.media="only x",e(function(){g.parentNode.insertBefore(i,c?g:g.nextSibling)});var l=function(a){for(var b=i.href,c=k.length;c--;)if(k[c].href===b)return a();setTimeout(function(){l(a)})};return i.addEventListener&&i.addEventListener("load",f),i.onloadcssdefined=l,l(f),i};"undefined"!=typeof exports?exports.loadCSS=b:a.loadCSS=b}("undefined"!=typeof global?global:this);!function(a){if(a.loadCSS){var b=loadCSS.relpreload={};if(b.support=function(){try{return a.document.createElement("link").relList.supports("preload")}catch(b){return!1}},b.poly=function(){for(var b=a.document.getElementsByTagName("link"),c=0;c<b.length;c++){var d=b[c];"preload"===d.rel&&"style"===d.getAttribute("as")&&(a.loadCSS(d.href,d,d.getAttribute("media")),d.rel=null)}},!b.support()){b.poly();var c=a.setInterval(b.poly,300);a.addEventListener&&a.addEventListener("load",function(){b.poly(),a.clearInterval(c)}),a.attachEvent&&a.attachEvent("onload",function(){a.clearInterval(c)})}}}(this);</script></head><body><div class="container"><ol class="breadcrumb"><li><a href="../index.html" class="glyphicon glyphicon-home"></a></li><li><a href="f-65.html">NSIS Discussion</a></li><li class="active">Cancelling the installation process as it happens</li></ol><p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=277190">Cancelling the installation process as it happens</a></p><br><div class="post"><p class="post-meta"><span class="post-author text-primary">HaydenDevlin</span><br><span class="post-time small text-muted">11th September 2007 11:50 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>Cancelling the installation process as it happens</strong><br>Hello,<br><br>I am trying to make an installer for a large program and I have sucessfully done so using NSIS and using the ModernUI, but there is one thing I want to be able to add, but it doesn't seem to be an option. What I want to do is to make it so that users of my installer can cancel the install while it is happening in the install screen, so that if the install is taking too long or users realise that they have made a mistake or whatever, they can stop the install as it happens by pressing cancel, at which point the installer will remove all of the files that it had put onto the computer. It's quite surprising to me that this does not seem to be a supported feature in the ModernUI, and it makes me think that I am just missing something obvious, but I have tried and looked through the documentation and forums to no avail. I know that the UltraModernUI allows this, but there are problems with that itself anyway, and it is not what we want to use if we can help it.<br><br>Thanks in advance for any help,<br><br>Hayden Devlin</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">darthvader</span><br><span class="post-time small text-muted">11th September 2007 17:00 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Have you tried using the callback function .onUserAbort. Just write the files you want to remove when the user aborts the installer, you can have the installer do anything over here. This is the flexibility of NSIS over other Installers.;)</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">HaydenDevlin</span><br><span class="post-time small text-muted">11th September 2007 17:02 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Well when installing the cancel button is not enabled, it is shaded out so you can't press it. Surely the onAbort method would only be called when cancel is clicked yes? Do you know how to enable the cancel button while installing?<br><br>Thanks,<br><br>Hayden Devlin</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">darthvader</span><br><span class="post-time small text-muted">11th September 2007 17:12 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">I am not sure but try defining this at the top of your script<br><br>!define MUI_FINISHPAGE_ABORTWARNINGCHECK</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">HaydenDevlin</span><br><span class="post-time small text-muted">11th September 2007 17:18 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">I'm afraid that doens't seem to do anything :( When the installation occurs all buttons become disabled, including the buttons of the window itself (except for the minimize button). Does that happen for other people when their software installs or have I somehow set that myself? What I want is just to have ht ecancel button enabled while uninstalling<br><br>Thanks,<br><br>Hayden Devlin</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">darthvader</span><br><span class="post-time small text-muted">11th September 2007 17:47 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">This link might help you.<br><br><a href="http://sourceforge.net/tracker/index.php?func=detail&amp;aid=1219437&amp;group_id=22049&amp;atid=373087" target="_blank">http://sourceforge.net/tracker/index...49&amp;atid=373087</a></p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">HaydenDevlin</span><br><span class="post-time small text-muted">11th September 2007 17:54 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Oh great that looks like it might be able to do what I am after I will have a look tomorrow to make sure but it sounds good!<br><br>Thanks,<br><br>Hayden Devlin</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">HaydenDevlin</span><br><span class="post-time small text-muted">11th September 2007 18:25 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Hmm don't want to sound too stupid but how do you use what is on that website? There are 2 .patch files you can download, but aren't .patch they for unix? If not does anyone know how to use them on a windows machine?<br><br>Thanks,<br><br>Hayden Devlin</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">HaydenDevlin</span><br><span class="post-time small text-muted">14th September 2007 14:00 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">I have managed to install the patches onto my windows version of NSIS 2.30 by using cygwin (like a unix environment for windows) to do the patching via the unix patch command. The patch, however seems to only work on an older version of NSIS, as some of the code regions for patching are now slightly different from when the patch was written. This means that not all of the patch sections or 'hunks' work, and the patched version no longer compiles. By reading the patch file and manually applying the patch sections to the current NSIS code I managed to apply all of the patch code. This did not compile because of a more recently added line of code in the NSIS code, but with a little tinkering it compiled ok, but then crashes when you run it. So basically the patch doesn't work anymore. Does anyone know if there is an up-to-date patch for this, or what version of NSIS the patch actually works with (and where I can get it)?<br><br>Thanks in advance for any help,<br><br>Hayden Devlin</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">kichik</span><br><span class="post-time small text-muted">14th September 2007 18:52 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">If you attach your latest changes, I can have a look and see why it crashes.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">makhzi</span><br><span class="post-time small text-muted">18th September 2007 15:24 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">I've found the problem, it lies here:<br>ui.c ( line 676 )<br><br></p><pre>
<code><br>    else if (id == IDCANCEL)<br>    {<br>...<br>...<br>...<br>        if (g_this_page-&gt;wndproc_id == PWP_INSTFILES)<br>        {<br><br>        }<br></code>
</pre><br>
      <br>
      <b>g_this_page</b> is NULL, when CANCEL button is pressed during setup of installation process ( dest. folder, shortcuts etc. )<br>
      <br>
      Currently I'm trying to solve this problem.
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Wizou</span><br>
      <span class="post-time small text-muted">18th October 2007 09:46 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Hi there<br>
      <br>
      What is the current status ? Is it still impossible to cancel installation (abort installation while it is installing) ?<br>
      <br>
      The previous patch seems out of date for current NSIS builds.<br>
      <br>
      As "aborting" is already possible when the user is prompted the dialog for a file that cannot be open for writing, it shouldn't be too hard to implement the Cancel button to behave as if user clicked abort on that dialog.<br>
      (of course this would allow aborting only during "File" operations, but this would be enough for most installers)</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br>
      <span class="post-time small text-muted">20th October 2007 01:04 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Status hasn't changed.<br>
      <br>
      Abortion isn't the same as the file open problem dialog. Those originate from two different threads. The naive implementation would actually only make it possible to abort in between File commands and not while extracting a big file.</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Wizou</span><br>
      <span class="post-time small text-muted">22nd October 2007 10:12 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">sure..<br>
      <br>
      I was just saying that rather than waiting 6+ months for a new "abort" feature fully implemented, that could be nice to start by having a quick implementation that would be already enough to answer the needs of 90% of NSIS users.<br>
      <br>
      (if the demand is strong)</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br>
      <span class="post-time small text-muted">23rd October 2007 01:19 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">I currently have more important subjects lined up. A high quality and up-to-date patch would be useful.</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">namorham</span><br>
      <span class="post-time small text-muted">14th March 2008 08:07 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">So far I have had no luck enabling the cancel button during the install section, so is it possible to remove it. I have been working on a single page install (for a patch) and since this is the only page the back and cancel buttons are pointless/redundant. Short of defining my own custom page, is there a way to remove these butttons?</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">dmut</span><br>
      <span class="post-time small text-muted">28th May 2008 10:34 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Hi All<br>
      Have run into the same problem recently. Managed to enable "cancel", but have no luck to stop file copying thread. and therefore removing files in .onGuiEnd leads to crash or leftover files.<br>
      Already read similar threads, nothing helpfull found.<br>
      Is there is a way to add a command to stop file copying process? or add a mutex, which should be checked before copying every next file, so we can at least wait while an operation on sigle file finished?<br>
      Advice is highly appreciated.<br>
      <br>
      Regards, Dmut<br>
      <br>
      ps: kichik, NSIS is THE BEST, don't stop on it :)</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">coderanger</span><br>
      <span class="post-time small text-muted">18th July 2008 01:14 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Is there still no workaround for this with MUI? I have a large (~2GB) installer and it would be nice to allow aborting it, even without any kind of rollback.</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">dmut</span><br>
      <span class="post-time small text-muted">28th August 2008 15:45 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"></p>

      <blockquote>
        <i>Originally posted by coderanger</i><br>
        <b>Is there still no workaround for this with MUI? I have a large (~2GB) installer and it would be nice to allow aborting it, even without any kind of rollback.</b>
      </blockquote>I have had to use nsis.sourceforge.net/Multi-volume_Distribution "CABsetup", to implement a canceling, rollback, and to be able to create my installer bigger then 2gb.
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">ChocJunkie</span><br>
      <span class="post-time small text-muted">2nd October 2009 11:51 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"></p>

      <blockquote>
        <i>Originally posted by dmut</i><br>
        <b>I have had to use nsis.sourceforge.net/Multi-volume_Distribution "CABsetup", to implement a canceling, rollback, and to be able to create my installer bigger then 2gb.</b>
      </blockquote>Can you cancel the running install process?
    </div>
    <hr>

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]></script></body></html>