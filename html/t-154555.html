<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="description" content="Plugin for controlling Internet Explorer"><title>Plugin for controlling Internet Explorer - NSIS Forums</title><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script><link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css"><link rel="stylesheet" href="../css/style.css" type="text/css"></head><body><div class="container"><ol class="breadcrumb"><li><a href="../index.html" class="glyphicon glyphicon-home"></a></li><li><a href="f-65.html">NSIS Discussion</a></li><li class="active">Plugin for controlling Internet Explorer</li></ol><p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=154555">Plugin for controlling Internet Explorer</a></p><br><div class="post"><p class="post-meta"><span class="post-author text-primary">dRaakje</span><br><span class="post-time small text-muted">30th October 2003 10:39 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>Plugin for controlling Internet Explorer</strong><br>Hi,<br><br>I've created a plugin for controlling Internet Explorer. I haven't found anything like it yet. Or anyway, that has the ability to make toolbars visible in Internet Explorer.<br><br>I know, it's a bit big (51K) but I couldn't get it to compile/link smaller :igor:<br><br>Anyway, it does the following, not much, but it can easily be expanded upon:<br><br>- Open an internet explorer instance<br>- Surf to an URL<br>- Make a toolbar visible (you need to know its CLSID)<br>- Close the browser.<br><br>source files included.<br><br>Remco Lam</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">DrO</span><br><span class="post-time small text-muted">30th October 2003 13:26 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">can't look at your code at the moment but have a look at the source code for the plugin <a href="http://forums.winamp.com/showthread.php?postid=1143621#post1143621" target="_blank">here</a> which may be of use in showing how you can cut the dll size down :)<br><br>the code has a similar feature to you're plugin i guess and when i put the code in it only added 1k to 1.5k to the plugin's size (was thinking of coding a similar plugin myself but don't need to now i guess ;) )<br><br>hope this is of some help<br><br>-daz</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">dRaakje</span><br><span class="post-time small text-muted">30th October 2003 14:30 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">I've downloaded and compiled that plugin and compared all the settings.<br><br>I could copy almost all settings and it still worked. All except the entrypoint, if I set that I get the following error:<br><br>libcmt.lib(crt0.obj) : error LNK2001: unresolved external symbol _main<br><br>Besides, I think most of the filesize probably comes from the my inclusion of COM pointers... (comdef.h) But if anyone manages in creating a smaller dll, I'd be very interested :)</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">DrO</span><br><span class="post-time small text-muted">30th October 2003 17:18 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">the reason for the size is because of 'libcmt.lib' which is the c run time (crt) library. had a look and you're using things like sprintf, memset and using the default 'new' and 'delete' operators.<br><br>in my code i redefine the 'new' and 'delete' operators to not use the crt and if you put in you're own memset function and to use wsprintf(..) then that should cut things down :)<br><br>if you don't beat me to it i'll post a modified version for you<br><br>-daz</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">deguix</span><br><span class="post-time small text-muted">30th October 2003 20:56 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"></p><blockquote>Make a toolbar visible</blockquote>It can't be done using the registry?<br><br>And the other features:<br><br>- Open the Internet Explorer: Using the function "Wait file execution registry based" and just renaming the part that says (like) ExecWait "$..." to Exec "$...".<br>- Close the Internet Explorer: Have some functions in Archive for it.<br>- Opening an URL: Executing (i.e.) <a href="http://www.test.com" target="_blank">http://www.test.com</a> using "Wait file execution registry based" (see Open the Internet Explorer).<br><br>(to get the function "Wait file execution registry based", see it in my signature)</div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">dRaakje</span><br><span class="post-time small text-muted">31st October 2003 06:42 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"></p><blockquote><i>Originally posted by deguix</i><br>[B]It can't be done using the registry?</blockquote>It probably can, but I've looked into that, and it looks like IE stores its active toolbars in a binary registry setting. Good luck deciphering that! :p<br><br>And of course, you could use other functions to open IE and surf to an URL. But my point was this one can easily be extended for all sorts of functions. You can even receive IE events (although I don't know why you'd need that in an installer)<br><br>Dr0:<br>Much obliged if you'd post that updated version. I'm pretty goed at high level programming, but don't ask me about low level code optimizations... Although I'll certainly take a look at your code and play around with it. Always good to learn something new. Why, just this week I learned how to make an installer using NSIS :)<br><br>Remco</div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">DrO</span><br><span class="post-time small text-muted">31st October 2003 13:09 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">here's what i've done (only 4.5k now :) ) i have stripped some bits from the project (exdll dependancies which weren't needed) and a few other bits.<br><br>the link error was to do with the crt being included :( i've altered the Navigate and Toolbar functions (the Navigate definitely works but you'll need to check the toolbar one out)<br><br>for interest it is related to the _bstr_t (taken from an msdn example)<br></p><blockquote>Favorites Reader uses some of the new C++ smart pointers and new types available in Visual C++ 5.0 such as _bstr_t. These features clean up the code significantly but unfortunately they do require the C Run-time. This does increase the size of the DLL a bit.</blockquote>40k is a bit (bigger than a basic nsis installer :rolleyes: )<br><br>-daz</div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">dRaakje</span><br><span class="post-time small text-muted">31st October 2003 14:17 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"></p><blockquote><i>Originally posted by DrO</i><br><b>here's what i've done (only 4.5k now :) ) i have stripped some bits from the project (exdll dependancies which weren't needed) and a few other bits.<br></b></blockquote>Wow! I'm impressed. As I said before, I've never really looked at how to optimize my code for size.<br><br>Unforunately, showbar doesn't work anymore...<br><br>Which is really weird, since I've stepped through the execution and the BSTR variant looks exactly the same whether I fill it using your functions or whether I use _bstr_t as a cast. (I put it back in just to test)<br><br>:(<br><br>Remco</div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">dRaakje</span><br><span class="post-time small text-muted">31st October 2003 14:23 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Just relalized something. I think the problem is with bstr ownership.<br>When I do this:<br>vtBandGUID1.bstrVal = _bstr_t(szBarCLSID);<br><br>the _bstr_t class knows its being assigned to another BSTR and so relinguishes control over the BSTR (Or allocates a new BSTR)<br><br>When I do:<br>vtBandGUID2.bstrVal = bBarCLSID;<br><br>Nothing special is done and the call of ShowBandObject doesn't have access to the bstr that is being passed on.<br>VariantClear() afterwards isn't even necessary...<br><br>Or am I completely off track here... I have to admit, I've been bluffing my way through COM without really understanding it :P<br><br>Remco</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">dRaakje</span><br><span class="post-time small text-muted">31st October 2003 14:31 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Well, I was right, I've solved it.<br><br>I just needed to add SysAllocString<br><br>So the call now is:<br>vURL.bstrVal = SysAllocString(bstrUrl);<br><br>Thanx for the downsizing help daz!<br><br>Give me sec and I'll upload a new working version</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">dRaakje</span><br><span class="post-time small text-muted">31st October 2003 14:45 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Well, here it is. The dll is now 4.5K<br><br>Actually the bug is pretty obvious, once you see it :)<br><br>Again, thanks daz<br><br>Remco</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">DrO</span><br><span class="post-time small text-muted">31st October 2003 14:52 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">just seen this has changed.<br><br>it was no problem plus a 4.5k is a lot nicer ;)<br><br>-daz<br><br>[edit]<br>just checked out the new version and i see you haven't updated the text file -&gt; still refers to a 56k file size. pointing it out in case you haven't noticed it already ;)<br>[/edit]</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">dRaakje</span><br><span class="post-time small text-muted">3rd November 2003 10:05 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"></p><blockquote><i>Originally posted by DrO</i><br><b><br>just checked out the new version and i see you haven't updated the text file -&gt; still refers to a 56k file size. pointing it out in case you haven't noticed it already ;)<br></b></blockquote>Does this justify uploading it again? I think I'll just leave it this way. I'll change it locally in case I ever need to distrtibute it again. Thanks for the tip :)<br><br>&lt;edit&gt;<br>Well, I'll upload it again, I've made some changes anyway<br>&gt;/edit&gt;<br><br>Remco</div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">dRaakje</span><br><span class="post-time small text-muted">3rd November 2003 10:44 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Here's a new version. The attached zip contains the 2 dll's, one real small one (3.5K) that works just fine. And a slightly bigger one (5.1K) that displays some messageboxes when an error occurs.<br><br>Of course I've also updated the included text file.<br><br>Greets<br><br>Remco</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">kichik</span><br><span class="post-time small text-muted">5th November 2003 20:15 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">No Archive page? :(</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">dRaakje</span><br><span class="post-time small text-muted">6th November 2003 06:31 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"></p><blockquote><i>Originally posted by kichik</i><br><b>No Archive page? :(</b></blockquote>Is that something I should do? I'm still new to all this :p<br><br>Remco</div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">DrO</span><br><span class="post-time small text-muted">6th November 2003 11:12 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><a href="http://nsis.sourceforge.net/archive" target="_blank">archive is here</a><br><br>you will need to register as a user for the archive (is up at the top of the page to do that). once your registered then go down to 'contribute' (or similar worded) and follow the instructions.<br><br>as a note you should probably link to the most current version you have in this thread on the page you create.<br><br>-daz</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">dRaakje</span><br><span class="post-time small text-muted">6th November 2003 11:22 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"></p><blockquote><i>Originally posted by DrO</i><br><b>as a note you should probably link to the most current version you have in this thread on the page you create.<br></b></blockquote>Ah, that last one, I didn't think of that... I'd already checked the contrib part of the archive, but since I wasn't allowed to upload I didn't see the point in submitting anything :D<br><br>I'll make a page right away...<br><br>&lt;EDIT&gt;<br>It is <a href="http://nsis.sourceforge.net/archive/nsisweb.php?page=458&amp;instances=0" target="_blank">done</a>!<br>&lt;/EDIT&gt;<br>Remco</div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">wacki</span><br><span class="post-time small text-muted">27th June 2008 02:48 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">I downloaded the plugin and put it in:<br><br>C:\Program Files\NSIS\Plugins<br><br>And then I tried compiling this:<br><br><br>outFile "installer.exe"<br>section<br>IEFunctions::OpenBrowser /NOUNLOAD<br>sectionEnd<br><br><br>only to get this error:<br><br>Invalid command: IEFunctions::OpenBrowser<br>Error in script "C:\Documents and Settings\jnowacki\Desktop\NSIS\link.nsi" on line 7 -- aborting creation process<br><br><br>Suggestions?</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br><span class="post-time small text-muted">27th June 2008 16:01 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Make sure you put IEFunctions.dll not IEFunctionsDbg.dll in there. Also what are you doing exactly? If you want to just open a web page, just use ExecShell open `<a href="http://..." target="_blank">http://...</a>`<br><br>Stu</p></div><hr><div class="footer"><p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p></div></div><script src="../js/highlight.pack.js" type="text/javascript"></script><script type="text/javascript">//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]></script></body></html>