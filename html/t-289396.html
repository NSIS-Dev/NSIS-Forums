<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="nsDialogs, auto-complete and combo boxes" />

  <title>nsDialogs, auto-complete and combo boxes - NSIS Forums</title>
  <script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script>
  <!-- Bootstrap core CSS -->

  <link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css" />
  <link rel="stylesheet" href="../css/style.css" type="text/css" /><!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!--[if lt IE 9]>
                <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
                <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->
</head>

<body>
  <div class="container">
    <!-- Put navigation bar here -->

    <ol class="breadcrumb">
      <li><a href="../index.html" class="glyphicon glyphicon-home"></a></li>

      <li><a href="f-65.html">NSIS Discussion</a></li>

      <li class="active">nsDialogs, auto-complete and combo boxes</li>
    </ol>

    <p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=289396">nsDialogs, auto-complete and combo boxes</a></p><br />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">GregL</span><br />
      <span class="post-time small text-muted">31st March 2008 16:56 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>nsDialogs, auto-complete and combo boxes</strong><br />
      I'm digging into the new nsDialogs that I was initially reluctant to convert my installs to. Using the welcome.nsi example from nsDialogs as my starting point, I'm "converting" that directory line into one that also lists my company's installs for patching. We support multiple named copies of our program on a system, and also have web components that may or may not be present on the system. So I have it creating a drop-down list of install paths that are present, but doing so kills the auto-complete functionality and possibly the file presence functionality, since that also stopped working. I need the ability for manual entry to support the different web parts. Unfortunately, those paths are not stored reliably in the registry to support populating the same list. Can those features be combined in this manner?</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
      <span class="post-time small text-muted">31st March 2008 21:53 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">I don't understand what is it exactly that you're trying to do. Are you trying to add auto-complete feature that'd have only a set of paths you choose?</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">GregL</span><br />
      <span class="post-time small text-muted">1st April 2008 13:57 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Yes, sorry, I guess I was a little confusing. In the welcome.nsi example, I like the auto-complete feature as you enter a local path/folder. But when I modified that line to be a combo box, where I populated current install paths, it lost that ability. It's certainly not earth-shattering, but was a feature I was trying to keep. I wanted it to have the features of a combo box because the install could alternately be used to patch a local web server where I wouldn't necessarily know the path to the files. That's where it needs to allow a path other than the drop-down's.<br />
      <br />
      Having said that, after first posting this, I started trying to figure out how to query the MSI information to append the web component paths to the others and just have a regular drop-down list. I'm trying to do a System::Call to MSI::MsiGetProductInfo to get started and I must be boogering up the syntax. Anyone had success doing that?<br />
      <br />
      Even Microsoft is inconsistent with using MSI's fully. There is an InstallLocation under the various GUID's in the registry that are just plain empty. I'm guessing it's not a required property like some of the others are.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
      <span class="post-time small text-muted">1st April 2008 21:40 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><a href="http://msdn2.microsoft.com/en-us/library/bb759862.aspx" target="_blank">SHAutoComplete</a> only works for text boxes.</p>
    </div>
    <hr />

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]>
  </script>
</body>
</html>
