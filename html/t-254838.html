<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="Lots of InetC crashes in NSISdl mode" />

  <title>Lots of InetC crashes in NSISdl mode - NSIS Forums</title><!-- Bootstrap core CSS -->
  <link rel="stylesheet" type="text/css" href="//netdna.bootstrapcdn.com/bootswatch/3.0.1/readable/bootstrap.min.css" />
  <link rel="stylesheet" href="../css/style.css" type="text/css" /><!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!--[if lt IE 9]>
                <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
                <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->
</head>

<body>
  <div class="container">
    <!-- Put navigation bar here -->

    <ol class="breadcrumb">
      <li><a href="../index.html" class="glyphicon glyphicon-home"></a></li>

      <li><a href="f-65.html">NSIS Discussion</a></li>

      <li class="active">Lots of InetC crashes in NSISdl mode</li>
    </ol>

    <p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=254838">Lots of InetC crashes in NSISdl mode</a></p><br />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Backland</span><br />
      <span class="post-time small text-muted">5th September 2006 06:48 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>Lots of InetC crashes in NSISdl mode</strong><br />
      Hi all,<br />
      <br />
      I'm using InetC to download a file in the install page, but it crashes during the download 25% of the time.<br />
      <br />
      The crash is always during the download, most at the beginning or the end.<br />
      <br />
      I noticed there is no crash in POPUP or BANNER mode, but having the download progress within the main NSIS window is much better than a new popup window.<br />
      <br />
      Any help you be appreciated,<br />
      Thanks! :D</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Takhir</span><br />
      <span class="post-time small text-muted">5th September 2006 09:17 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">The problem is that this never happened on my comp. Can you test InetLoad in the same mode? Or may be you can even run Inetc under VS debugger? Something like this<br />
      - open inetc project in VS;<br />
      - build dll with "Debug" info (combo on the tool bar)<br />
      - compile nsi file (build installer) - new dll must be in NSIS/plugins folder, I am not sure this path is set for debug build;<br />
      - in VS set installer file as executable for debug;<br />
      - run it all from VS<br />
      (not sure this works :) )</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Takhir</span><br />
      <span class="post-time small text-muted">7th September 2006 16:10 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">We (I and Backland) finally fixed NSISdl mode crashes. Or we think we did it :) Backland idea was simple: remove and forget all NSISdl code and write new one in the same manner as /popup and /banner were done. When writing this feature I added some other minor improvements, so test required.<br />
      If anybody want to test plug-in - it is here <a href="http://nsis.sourceforge.net/Inetc_plug-in" target="_blank">http://nsis.sourceforge.net/Inetc_plug-in</a><br />
      Also thanks Backland for the 'center parent' function and a lot of time spent for testing :)<br />
      And please note that 'post' is now inetc.dll entry point (not option in the 'get' call).</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Backland</span><br />
      <span class="post-time small text-muted">7th September 2006 16:25 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Thanks for posting this update Takhir.<br />
      <br />
      I have tested this and it works great so far, but all my tests have been on computers with XP SP2.<br />
      <br />
      If anybody else could test this with other versions of Windows, it would be great.<br />
      <br />
      I hope that this plugin is finally stable in all modes, as this is the most feature packed internet plugin available for NSIS.<br />
      <br />
      Cheers :)</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">pengyou</span><br />
      <span class="post-time small text-muted">7th September 2006 20:09 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">When I tried the new Inetc plugin (in NSISdl mode) on my Win98SE system I found that the download Cancel button and download progress bar disappeared if another window was moved on top of the installer and then moved away.<br />
      <br />
      Part of the progress bar re-appeared when the data for the bar changed but the Cancel button never re-appeared.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Backland</span><br />
      <span class="post-time small text-muted">7th September 2006 20:32 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Thanks pengyou,<br />
      <br />
      Looks like some of the repainting code need to be adjusted!</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Takhir</span><br />
      <span class="post-time small text-muted">8th September 2006 07:29 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">I also found re-paint problem on 2003 server, but after small changes it looks correct, new build uploaded. And Readme now reflects curent WIKI page :)</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">pengyou</span><br />
      <span class="post-time small text-muted">8th September 2006 13:28 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">The NSISdl plugin hides the "Show details" button.<br />
      <br />
      When the Inetc plugin is used to replace the NSISdl plugin I think it should also hide that button.<br />
      <br />
      Here are some screenshots showing what happens when I click the "Show details" button while Inetc is downloading a file on my Win98SE system.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Backland</span><br />
      <span class="post-time small text-muted">8th September 2006 13:44 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">I think a good option would be hide the button and the detail list within the NSIS script using the Getdlgtem and Showwindow functions<br />
      <br />
      I guess an extra parameter could be added to do this from within the plugin, but you have more control over this behaviour from within your own script<br />
      <br />
      I think in the next verion the progressbar will be laid out much neater and look the same as the real NSIS one, because it looks a bit weird in those screenshots<br />
      <br />
      Cheers :)</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Takhir</span><br />
      <span class="post-time small text-muted">8th September 2006 13:54 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">I am leaving to vacations, will be back Sep 20.<br />
      2 Backland - can you offer a formula for plug-in' top? This should work both in basic and modern UI ;)</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Backland</span><br />
      <span class="post-time small text-muted">8th September 2006 14:09 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">I'll check it out ;)</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Takhir</span><br />
      <span class="post-time small text-muted">22nd September 2006 18:32 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">New version <a href="http://nsis.sourceforge.net/Inetc_plug-in" target="_blank">uploaded</a>. It was 100% stable during tests.<br />
      New features: plug-in uses parent dialog font (NSISdl mode) and progress bar style.<br />
      2 new options: cancel_button_text for NSISdl mode and UserAgent http header value.<br />
      Again many thanks to Backland who offered new features/options and spent a lot of time testing the plug-in.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Backland</span><br />
      <span class="post-time small text-muted">23rd September 2006 10:13 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Everything works really great, but here is what I've noticed:<br />
      <br />
      if you run the plugin a second time in NSISdl mode in the instfiles page, the progressbar no longer appears after the first time the plguin is called.</p>
    </div>
    <hr />

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]>
  </script>
</body>
</html>
