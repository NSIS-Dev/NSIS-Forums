<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="UpgradeDll sample script" />

  <title>UpgradeDll sample script - NSIS Forums</title><!-- Bootstrap core CSS -->
  <link rel="stylesheet" type="text/css" href="//netdna.bootstrapcdn.com/bootswatch/3.0.1/readable/bootstrap.min.css" />
  <link rel="stylesheet" href="../css/style.css" type="text/css" /><!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!--[if lt IE 9]>
                <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
                <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->
</head>

<body>
  <div class="container">
    <!-- Put navigation bar here -->

    <ol class="breadcrumb">
      <li><a href="../index.html" class="glyphicon glyphicon-home"></a></li>

      <li><a href="f-65.html">NSIS Discussion</a></li>

      <li class="active">UpgradeDll sample script</li>
    </ol>

    <p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=133793">UpgradeDll sample script</a></p><br />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Mæster</span><br />
      <span class="post-time small text-muted">30th April 2003 22:42 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>UpgradeDll sample script</strong><br />
      Trying to implement a method to install VB runtimes leads me to the UpgradeDll-, the AddSharedDll- and the un.RemovedSharedDll macros described in the NSIS documentation. Because I'm an bloody newbie describing the NSIS macros and functions alone couldnt help me that much.<br />
      I'm sure, that the best way to understand both, the use of those functions and the general handling of a nsis-script would be a sample.<br />
      <br />
      I'am using NSIS 2.0b3 with the Modern GUI, so is there any sample script aviable which could teach me right from scratch how to implement the UpgradeDll-Macros in a NSIS-script?</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Joost Verburg</span><br />
      <span class="post-time small text-muted">30th April 2003 23:21 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><a href="http://nsis.sourceforge.net/archive/viewpage.php?pageid=47" target="_blank">http://nsis.sourceforge.net/archive/....php?pageid=47</a></p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Mæster</span><br />
      <span class="post-time small text-muted">1st May 2003 08:57 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">First I want to thank Joost for his fast replay.<br />
      <br />
      Perhaps I described my needs very bad above.<br />
      What I'm rather looking for is a whole! working sample script involving the UpdateDll Macros not only a part of a script. Something that starts with<br />
      !include "MUI.nsh" and ends with something like<br />
      !insertmacro 'MUI_UNFINISHHEADER' having the all the functionality of the Upgrade-Macros implemented between would be very nice.<br />
      <br />
      All the examples for the Modern UI in the NSIS documentation written by Joost Verburg (i.E. 'Basic.nsi' or 'Language.nsi') are great examples of "whole" working scripts with the described functionality in it.<br />
      <br />
      Has somebody such a sample concerning the UpgradeDll-functions for me?</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Joost Verburg</span><br />
      <span class="post-time small text-muted">1st May 2003 13:06 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">To use the UpgradeDLL macro:<br />
      <br />
      1) Copy the macro to a file called "UpgradeDLL.nsh" (keeping it in a separate file makes your script easier to read)<br />
      2) !insert "UpgradeDLL.nsh" ;Add to the top of your script<br />
      3) Now you can use the macro using !insertmacro UpgradeDLL "dllname.dll" "$SYSDIR\dllname.dll"<br />
      <br />
      Btw, upgrade to the latest NSIS 2 version (unfinishheader doesn't exist anymore in the latest version :) ).</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Mæster</span><br />
      <span class="post-time small text-muted">5th May 2003 07:04 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Thank you, Joost. Following your advices leads me to success.</p>
    </div>
    <hr />

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]>
  </script>
</body>
</html>
