<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="Installing .NET managed dll's into the GAC" />

  <title>Installing .NET managed dll's into the GAC - NSIS Forums</title><!-- Bootstrap core CSS -->
  <link rel="stylesheet" type="text/css" href="//netdna.bootstrapcdn.com/bootswatch/3.0.1/readable/bootstrap.min.css" />
  <link rel="stylesheet" href="../css/style.css" type="text/css" /><!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!--[if lt IE 9]>
                <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
                <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->
</head>

<body>
  <div class="container">
    <!-- Put navigation bar here -->

    <ol class="breadcrumb">
      <li><a href="../index.html" class="glyphicon glyphicon-home"></a></li>

      <li><a href="f-65.html">NSIS Discussion</a></li>

      <li class="active">Installing .NET managed dll's into the GAC</li>
    </ol>

    <p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=272505">Installing .NET managed dll's into the GAC</a></p><br />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">helix400</span><br />
      <span class="post-time small text-muted">8th June 2007 18:41 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>Installing .NET managed dll's into the GAC</strong><br />
      I'm about a month or two away from deploying .net managed dll's into customers GAC's, so I looked into what it would take to do it right.<br />
      <br />
      So far, I'm a bit confuse how this would be done. I did find this:<br />
      <br />
      <a href="http://nsis.sourceforge.net/Register_a_managed_.NET_DLL_in_the_GAC" target="_blank">http://nsis.sourceforge.net/Register...DLL_in_the_GAC</a><br />
      <br />
      But it mentions that if the user doesn't have the SDK installed, then gacutil probably won't exist on the users machine (the 2.0 version of GACUtil only exists on my machine because of Visual Studio). That makes the solution worthless.<br />
      <br />
      It also mentioned that instead of using NSIS to deploy the .NET dll, you use some C# app to do it for you. But that has issus with Windows Vista users who don't have admin access (and I'd assume any non-admin user).<br />
      <br />
      Another thread (<a href="http://forums.winamp.com/showthread.php?s=&amp;threadid=263459&amp;highlight=gac" target="_blank">http://forums.winamp.com/showthread....&amp;highlight=gac</a>), talked about this too, and it seemed a solution was to package gacutil with the install. But, then<br />
      mayevski chimed in and said you're not allowed to do that.<br />
      <br />
      So I'm just stuck and asking for help. Are there any clean methods for installing a .NET dll into the GAC?</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">n_baua</span><br />
      <span class="post-time small text-muted">12th June 2007 07:51 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Hi,<br />
      <br />
      I guess this is not the easy task even either.<br />
      First you would have to look around all the requirements and if they are available then install the .net dll to GAC<br />
      <br />
      The steps should be as under;<br />
      <br />
      1&gt; Check if supported OS.. (if No skip installation else proceed)<br />
      <br />
      2&gt; Check if Admin Rights are available..<br />
      . [if No skip installation else proceed]<br />
      3&gt; Check if required framework installed.... (if No you can launch installer from your installation disk <b>OR</b> redirect user to online for download OR proceed)<br />
      4&gt; To install the .Net dll proceed as normal with the GacUtil.exe (Make sure you have sn.exe to strong name the same dlls or better you have them strong name before you ship).</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">helix400</span><br />
      <span class="post-time small text-muted">12th June 2007 20:57 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Thanks n_baua for the update. Your approach would work, but like you said, it's not an easy task.<br />
      <br />
      It seems the best approach would be to create a plugin that uses C++ code to work with Fusion to do all of this the Microsoft recommended way.<br />
      <br />
      A couple good sites that show how to do it are:<br />
      <br />
      <a href="http://www.codeguru.com/csharp/.net/net_general/assemblies/article.php/c12793/" target="_blank">http://www.codeguru.com/csharp/.net/...le.php/c12793/</a><br />
      <br />
      and<br />
      <br />
      <a href="http://support.microsoft.com/kb/317540" target="_blank">http://support.microsoft.com/kb/317540</a><br />
      <br />
      Unfortunately, my C++ skills are weak. :(<br />
      <br />
      Our alternate approach is to just install all of our applications to a common folder. That way, they can all share the same bin folder, and no GAC registeration is necessary.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">n_baua</span><br />
      <span class="post-time small text-muted">13th June 2007 06:49 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Hi Helix,<br />
      <br />
      I am not seeing the following thing as a good practice,<br />
      <br />
      <i>Our alternate approach is to just install all of our applications to a common folder. That way, they can all share the same bin folder, and no GAC registeration is necessary.<br /></i><br />
      <br />
      The objective to use the GAC is to have a system wide usage and not just with the projects which we have created, another issue is if we choose to use c:\myFolder or some other static location as a prefered common directory, some one may tamper it or possibilities are the directory it self can be deleted, this is not possible with the GAC.<br />
      <br />
      in short the question is about the Security.<br />
      <br />
      BTW I am also not good in C++ ;)</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">jocker</span><br />
      <span class="post-time small text-muted">16th June 2007 17:25 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">the only good &amp; official way to put dlls into the GAC is to use a windows installer setup program.<br />
      But there's an alternative, written in c# that uses fusion, as it was said before on this thread: gacutil2 by Christoph Wille<br />
      <a href="http://chrison.net/OnlyColdFusionCanBeMoreComplicated.aspx" target="_blank">http://chrison.net/OnlyColdFusionCan...mplicated.aspx</a><br />
      it does not implement everything of gacutil, but at least it seems usable.<br />
      <br />
      good luck<br />
      <br />
      EDIT: why this board does not let me add links??<br />
      chrison.net/OnlyColdFusionCanBeMoreComplicated.aspx</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Anders</span><br />
      <span class="post-time small text-muted">16th June 2007 22:22 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Stupid spam protection for new users<br />
      <br />
      <a href="http://chrison.net/OnlyColdFusionCanBeMoreComplicated.aspx" target="_blank">http://chrison.net/OnlyColdFusionCan...mplicated.aspx</a></p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">helix400</span><br />
      <span class="post-time small text-muted">18th June 2007 17:41 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Don't use the url block tags. It doesn't work for me. Just keep the URL as plain text, and the board will convert it.<br />
      <br />
      Btw, thanks for the link.</p>
    </div>
    <hr />

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]>
  </script>
</body>
</html>
