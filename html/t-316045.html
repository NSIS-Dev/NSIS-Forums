<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="Font installation Problem" />

  <title>Font installation Problem - NSIS Forums</title><!-- Bootstrap core CSS -->
  <link rel="stylesheet" type="text/css" href="//netdna.bootstrapcdn.com/bootswatch/3.0.1/readable/bootstrap.min.css" />
  <link rel="stylesheet" href="../css/style.css" type="text/css" /><!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!--[if lt IE 9]>
                <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
                <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->
</head>

<body>
  <div class="container">
    <!-- Put navigation bar here -->

    <ol class="breadcrumb">
      <li><a href="../index.html" class="glyphicon glyphicon-home"></a></li>

      <li><a href="f-65.html">NSIS Discussion</a></li>

      <li class="active">Font installation Problem</li>
    </ol>

    <p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=316045">Font installation Problem</a></p><br />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">jstoefer</span><br />
      <span class="post-time small text-muted">6th January 2010 15:25 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>Font installation Problem</strong><br />
      Hi,<br />
      <br />
      I have compiled an installer from a rather simple script.<br />
      Besides installing an executable + dll, it should install one font.<br />
      I am using a method suggested in this forum. Installation works fine, until, at the end of the process, an "invalid File handle" error pops up and the font does not get installed.<br />
      This error occurs on Win XP, Win 7 and even under Wine emulation.<br />
      I have double-checked the source path of the font on the source system, it is valid and the script does not give any error message during compile time.<br />
      <br />
      Could someone have a second look on the attached script - probably it's a stupid error I just can't see it at the moment ...<br />
      <br />
      regards,<br />
      Jan</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">jstoefer</span><br />
      <span class="post-time small text-muted">6th January 2010 15:30 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">here is the script:</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">meaningoflights</span><br />
      <span class="post-time small text-muted">8th January 2010 11:42 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Weird!<br />
      Googling the EM results in a lot of unsolved cases but they seem to be PC specific. "invalid File handle" hmm is there anything obvious in ProcessExplorer or even your eventvwr?</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">jstoefer</span><br />
      <span class="post-time small text-muted">9th January 2010 10:44 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Hi,<br />
      <br />
      one information I should add is that I am using a linux machine to compile the installer. This may be one reason for the difficulties I encountered with font installation.<br />
      <br />
      I was able to resolve the problem by putting the font file into the same directory as the script and modifying the script accordingly.<br />
      <br />
      So for me the result is: For all other files that I want to install, I can give absolute paths on the source machine, even on a linux machine.<br />
      In case of fonts, if I give the absolute path on the linux machine, the installer will be compiled without error, but the installer cannot find the font file on the target machine, after unpacking the data.<br />
      <br />
      Regards,<br />
      Jan<br />
      <br />
      P.S.: Here is the final script for reference in case anybody might face the same problem:</p>
    </div>
    <hr />

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]>
  </script>
</body>
</html>
