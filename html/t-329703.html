<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="description" content="NSIS GUI unresponsive during file installation"><title>NSIS GUI unresponsive during file installation - NSIS Forums</title><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script><link rel="preload" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css" as="style" onload="this.rel='stylesheet'"><link rel="preload" href="../css/style.css" as="style" onload="this.rel='stylesheet'"><noscript><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css"><link rel="stylesheet" href="../css/style.css"></noscript><script>!function(a){"use strict";var b=function(b,c,d){function e(a){return h.body?a():void setTimeout(function(){e(a)})}function f(){i.addEventListener&&i.removeEventListener("load",f),i.media=d||"all"}var g,h=a.document,i=h.createElement("link");if(c)g=c;else{var j=(h.body||h.getElementsByTagName("head")[0]).childNodes;g=j[j.length-1]}var k=h.styleSheets;i.rel="stylesheet",i.href=b,i.media="only x",e(function(){g.parentNode.insertBefore(i,c?g:g.nextSibling)});var l=function(a){for(var b=i.href,c=k.length;c--;)if(k[c].href===b)return a();setTimeout(function(){l(a)})};return i.addEventListener&&i.addEventListener("load",f),i.onloadcssdefined=l,l(f),i};"undefined"!=typeof exports?exports.loadCSS=b:a.loadCSS=b}("undefined"!=typeof global?global:this);!function(a){if(a.loadCSS){var b=loadCSS.relpreload={};if(b.support=function(){try{return a.document.createElement("link").relList.supports("preload")}catch(b){return!1}},b.poly=function(){for(var b=a.document.getElementsByTagName("link"),c=0;c<b.length;c++){var d=b[c];"preload"===d.rel&&"style"===d.getAttribute("as")&&(a.loadCSS(d.href,d,d.getAttribute("media")),d.rel=null)}},!b.support()){b.poly();var c=a.setInterval(b.poly,300);a.addEventListener&&a.addEventListener("load",function(){b.poly(),a.clearInterval(c)}),a.attachEvent&&a.attachEvent("onload",function(){a.clearInterval(c)})}}}(this);</script></head><body><div class="container"><ol class="breadcrumb"><li><a href="../index.html" class="glyphicon glyphicon-home"></a></li><li><a href="f-65.html">NSIS Discussion</a></li><li class="active">NSIS GUI unresponsive during file installation</li></ol><p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=329703">NSIS GUI unresponsive during file installation</a></p><br><div class="post"><p class="post-meta"><span class="post-author text-primary">jprocto</span><br><span class="post-time small text-muted">16th April 2011 02:25 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>NSIS GUI unresponsive during file installation</strong><br>Hi,<br><br>I'm using NSIS for my installers and I'm finding that during the installation of large files using either "File" or "CopyFile", the GUI does not update at all so that if I open Windows Explorer and then click back on the installer, the installer does not update its GUI until that file has finished installing. Does anyone else have this problem and is there any way around it?<br><br>Thanks,<br><br>John.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br><span class="post-time small text-muted">16th April 2011 10:34 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Yes. Don't copy or extract files from page callbacks. That is what sections are for. You should never modify the system until the user has clicked Install. If you are then you should rethink your installer design. If you need to extract something between pages, perhaps add another InstFiles page in between (but really you should only ever need one).<br><br>Stu</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">jprocto</span><br><span class="post-time small text-muted">16th April 2011 11:41 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"></p><blockquote><small>Originally posted by Afrow UK</small><br>Yes. Don't copy or extract files from page callbacks. That is what sections are for. You should never modify the system until the user has clicked Install. If you are then you should rethink your installer design. If you need to extract something between pages, perhaps add another InstFiles page in between (but really you should only ever need one).<br><br>Stu</blockquote>Yes, I'm afraid that the operations are already being included within a section and not within a page callback. This problem is occurring during the actual installation process.</div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br><span class="post-time small text-muted">16th April 2011 13:42 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">If that is the case then how do you click Back? The Back button is disabled unless you have enabled it yourself. Perhaps you should attach some script that reproduces the problem. Extracting files in a section does not freeze up the UI because sections are executed in another thread. If you mean the progress bar does not move, then that's not the UI freezing up. It just doesn't move while a file is extracted; it only works on the number of instructions.<br><br>Stu</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">MSG</span><br><span class="post-time small text-muted">16th April 2011 14:46 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">With clicking 'back' he means changing focus to another window and then switching back to the installer. At which point the window is not redrawn properly.<br><br>Indeed some minimal script that recreates the issue would be helpful.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">jprocto</span><br><span class="post-time small text-muted">17th April 2011 11:06 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"></p><blockquote><small>Originally posted by MSG</small><br>With clicking 'back' he means changing focus to another window and then switching back to the installer. At which point the window is not redrawn properly.<br><br>Indeed some minimal script that recreates the issue would be helpful.</blockquote>Sorry, yes that's exactly what I meant. I wasn't very clear with my original explanation. Below is the section that I am having the problem with. The actual part where people first reported this problem was the line that is now commented out:<br><br>;CopyFiles /silent $EXEPATH "$PROGRAMFILES\Camel Audio\Alchemy\SoundbankInstaller.exe"<br><br>I replaced this line with the following two lines because I thought that the problem might be caused by the executable copying itself, but this does not seem to have fixed it:<br><br>SetOutPath "$PROGRAMFILES\Camel Audio\Alchemy"<br>File SoundbankInstaller.exe<br><br>Here is the actual section to put this into context:<br><br>Section "-Install Support Files" SECINSTALLSUPPORT<br>${If} $SkipInstallingSupportFiles == "false"<br>Call FixDataInstallPath<br>SetOverwrite on<br>SetOutPath $DataInstallDir<br>!ifdef PLAYER_VERSION<br>File ..\AlchemyData\AlchemyPlayer.aky<br>!endif<br>CreateDirectory $DataInstallDir<br>CopyFiles /silent $PluginInstallDir\*.aky $DataInstallDir<br>Delete $PluginInstallDir\*.aky<br>;StrCpy $DataInstallDir $DataInstallDir\Alchemy<br>SetOutPath $DataInstallDir\Libraries<br>File /r /x .svn /x .DS_Store ..\AlchemyData\Libraries\*.*<br>!ifdef FULL_VERSION<br>WriteRegStr HKLM "${REGKEY}" "${FULL_VERSION_INSTALLED_REGISTRY_VALUENAME}" "true"<br>!endif<br>SetOutPath $DataInstallDir\Skins<br>File /r /x .svn /x .DS_Store ..\AlchemyData\Skins\*.*<br>;CreateDirectory $DataInstallDir\Libraries<br>CreateDirectory $DataInstallDir\Presets<br>CreateDirectory $DataInstallDir\Presets\User<br>CreateDirectory $DataInstallDir\Presets\User\Sounds1<br>CreateDirectory $DataInstallDir\Samples<br>;CreateDirectory $DataInstallDir\Skins<br>CreateDirectory "$PROGRAMFILES\Camel Audio\Alchemy"<br>;CopyFiles /silent $EXEPATH "$PROGRAMFILES\Camel Audio\Alchemy\SoundbankInstaller.exe"<br>SetOutPath "$PROGRAMFILES\Camel Audio\Alchemy"<br>File SoundbankInstaller.exe<br>;${unregisterExtension} ".CamelSounds" "Camel Audio Sound Library"<br>${registerExtension} "$PROGRAMFILES\Camel Audio\Alchemy\SoundbankInstaller.exe" ".CamelSounds" "Camel Audio Sound Library"<br>SetShellVarContext current<br>FileOpen $0 $PluginInstallDir\AlchemyConfig.txt w<br><br>FileWrite $0 "LibraryPath= $DataInstallDir\$\r$\n"<br>FileWrite $0 "MaxChunkSize= 1048576$\r$\n"<br>FileWrite $0 "KnobCircular= 0$\r$\n"<br>FileWrite $0 "ShowAuthor= 1"<br>FileClose $0<br>${If} $InstallingRTAS == "true"<br>FileOpen $0 ${RTAS_INSTALL_DIR}\AlchemyConfig.txt w<br><br>FileWrite $0 "LibraryPath= $DataInstallDir\$\r$\n"<br>FileWrite $0 "MaxChunkSize= 1048576$\r$\n"<br>FileWrite $0 "KnobCircular= 0$\r$\n"<br>FileWrite $0 "ShowAuthor= 1"<br>FileClose $0<br>${EndIf}<br>!ifdef PLAYER_VERSION_WITH_CONTENT<br>SetOutPath $DataInstallDir\Presets<br>File /r /x .svn /x .DS_Store "..\..\Alchemy Player Content\Presets\*.*"<br>SetOutPath $DataInstallDir\Samples<br>File /r /x .svn /x .DS_Store "..\..\Alchemy Player Content\Samples\*.*"<br>!endif<br>${EndIf}<br>SectionEnd</div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">MSG</span><br><span class="post-time small text-muted">17th April 2011 12:34 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Ah, so you're copying an executable. There's a good chance your virusscanner is at fault. Try again with your virusscanner disabled.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">jprocto</span><br><span class="post-time small text-muted">17th April 2011 14:06 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"></p><blockquote><small>Originally posted by MSG</small><br>Ah, so you're copying an executable. There's a good chance your virusscanner is at fault. Try again with your virusscanner disabled.</blockquote>Ah yes. Good thinking. Obviously I can't tell all my users to switch off their antivirus software and it probably won't be sufficient to do something like changing the extension and then switching it to "exe" once it is copied so I don't think there's much I can do about this.<br><br>Thanks for all your help MSG and Stu :)</div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br><span class="post-time small text-muted">17th April 2011 14:54 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Sorry I misunderstood your wording. Have you tried without /silent? I doubt it will help but perhaps if the A/V is holding things up you might at least see a copy progress pop-up dialog box. You could also try doing the copy by calling xcopy.exe.<br><br>Stu</p></div><hr><div class="footer"><p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p></div></div><script type="text/javascript" src="../js/highlight.pack.js" async></script><script type="text/javascript">//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]></script></body></html>