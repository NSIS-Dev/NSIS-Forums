<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="description" content="modern UI not refreshing when using progress bar"><title>modern UI not refreshing when using progress bar - NSIS Forums</title><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script><link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css"><link rel="stylesheet" href="../css/style.css" type="text/css"></head><body><div class="container"><ol class="breadcrumb"><li><a href="../index.html" class="glyphicon glyphicon-home"></a></li><li><a href="f-65.html">NSIS Discussion</a></li><li class="active">modern UI not refreshing when using progress bar</li></ol><p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=325808">modern UI not refreshing when using progress bar</a></p><br><div class="post"><p class="post-meta"><span class="post-author text-primary">zivha</span><br><span class="post-time small text-muted">11th January 2011 06:44 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>modern UI not refreshing when using progress bar</strong><br>Hello,<br><br>I am using modern UI for my installer. I have a dialog page that is downloading some files, the way I implemented it is by embedding inetc plugin in the dialog. So I do something like:<br><br>Function DownloadPage<br>nsDialogs::Create 1018<br>Pop $DownloadDialog<br>.<br>.<br>.<br>// create some labels and text<br>${NSD_CreateTimer} StartDownload 1<br>nsDialogs::Show<br>FunctionEnd<br><br>Function StartDownload<br>${NSD_KillTimer} StartDownload<br><br>inetc::get /nocancel /caption "caption text" $AppUrl /END<br>Pop $0<br>FunctionEnd<br><br><br>So basically I create a dialog, display it and then use a timer to overlay the inetc progress bar on top of the dialog. The problem is that during the download the dialog underneath does not receive refresh messages so for example if another window hides it and is then removed, the dialog is not refreshed and the text and graphics disappear (only the progress bar is constantly refreshed).<br><br>Any ideas how to solve it? I thought of adding another time to keep refreshing the dialog but no idea how to do it. Maybe my solution is just not correct but I can not find any other cleaner way to embed a dialog into a dialog there is no way to "Create" the inetc object and insert it to the dialog in a clean way.<br><br>Ideas???</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">ZmAn3</span><br><span class="post-time small text-muted">11th January 2011 07:33 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Cant help you based just off what your saying but I would like a copy of your script or a stripped down version for future referance of embedding the plugin if you dont mind:)<br><br>thanks</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">zivha</span><br><span class="post-time small text-muted">11th January 2011 07:45 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">This is pretty much the relevant part of the script, just created a custom dialog called DownloadPage, the function for DownloadPage is listed above just add whatever elements to it and then use the timer to call another function to initiate the inetc right after the dialog::show is run.<br><br>Not sure it is a good method to copy as you can see there is a problem with it that hopefully can be resolved :-)</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">ZmAn3</span><br><span class="post-time small text-muted">11th January 2011 09:10 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">what about using<br>ShowWindow $yourcontrol ${SW_HIDE}<br>ShowWindow $yourcontrol ${SW_SHOW}<br><br>for each custom control in a timer ?</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">zivha</span><br><span class="post-time small text-muted">11th January 2011 13:11 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Does not work, first it creates flicker but the real problem is that it still not working, I believe the control does not know it needs to repaint its content, or maybe the problem is different. One of the controls is a bitmap once it is covered with another window and then revealed the bitmap is partially grey and does not get repainted.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">zivha</span><br><span class="post-time small text-muted">13th January 2011 07:44 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Actually I take it back, the Dialog is refresh I had another error on my dialog (some resource panel with no content was on top of some controls, could not see it but found it after reviewing the resource files again) - so everything actually works fine with this solution.<br><br>Can close the thread :-)</p></div><hr><div class="footer"><p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p></div></div><script src="../js/highlight.pack.js" type="text/javascript"></script><script type="text/javascript">//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]></script></body></html>