<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="MojoPack NSIS plugin project written in Delphi" />

  <title>MojoPack NSIS plugin project written in Delphi - NSIS Forums</title>
  <script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script>
  <!-- Bootstrap core CSS -->

  <link rel="stylesheet" type="text/css" href="//netdna.bootstrapcdn.com/bootswatch/3.0.1/readable/bootstrap.min.css" />
  <link rel="stylesheet" href="../css/style.css" type="text/css" /><!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!--[if lt IE 9]>
                <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
                <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->
</head>

<body>
  <div class="container">
    <!-- Put navigation bar here -->

    <ol class="breadcrumb">
      <li><a href="../index.html" class="glyphicon glyphicon-home"></a></li>

      <li><a href="f-65.html">NSIS Discussion</a></li>

      <li class="active">MojoPack NSIS plugin project written in Delphi</li>
    </ol>

    <p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=303644">MojoPack NSIS plugin project written in Delphi</a></p><br />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Candu</span><br />
      <span class="post-time small text-muted">1st March 2009 15:39 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>MojoPack NSIS plugin project written in Delphi</strong><br />
      Hello,<br />
      <br />
      I am using NSIS now for nearly 1,5 years. NSIS is the installer technology of my choice. So I decide to write own plugins to enhance the functionality of NSIS. Like a convinced Delphi programmer, the goal for me was to write NSIS plugins in Delphi. To give the NSIS community some more information about writing NSIS plugins using Delphi, I decide to provide the source code as well. Now, writing NSIS plugins should be very easy, because I have spent a lot of time to comment my source code well. Feel free to use the source for your own plugin project or just help to enhance my MojoPack NSIS plugin project (MNPP).<br />
      <br />
      MojoPack provides a view useful functions and should be enhanced with more functions in the near future. Currently the following functions are implemented:<br />
      <br />
      - SetAttributes: Set file system attributes to entire directories<br />
      - ReplaceInFile: Replace a string with another string in a given file<br />
      - ReplaceInFileEx: Replace two strings at the same time in a given file<br />
      - TerminateTask: Terminate a running application<br />
      - CheckTask: Check if task is currently running<br />
      - IsUserLocalAdmin: Check if current user is a member of the local administrator group<br />
      <br />
      See the MojoPack_Readme.txt for more information about the usage of each function and what you have to do if you decide to help enhancing MojoPack.<br />
      <br />
      At least let me give you some useful information how to write plugin functions (procedures) in Delphi.<br />
      -------------------------------------------------------------------------------------------<br />
      - Always use NSIS.pas for the interface to NSIS<br />
      - Each exported dll procedure must call the INIT() function of NSIS.pas first.<br />
      - The return value must always be of type string<br />
      - Each call of PopString() will catch the next parameter of the function. Note: all parameters<br />
      are passed as strings.<br />
      - The last call of PushString() fills $0<br />
      <br />
      MNPP is developed with BDS2006/CRS2007 but you should be able to open the .dpr file in previous versions of Delphi.<br />
      <br />
      To compile the Mojopack make sure you have the Jedi Code Library installed.<br />
      <br />
      Special thanks to Bernhard Mayer, Peter Windridge, Brett Dever and Rainer Budde. Great job guys.<br />
      <br />
      Use UPX to shrink the size of the output dll file. Thanks to the upx developper team Markus Oberhumer, Laszlo Molnar and John Reiser.<br />
      <br />
      <br />
      I hope, you find the provided stuff useful.<br />
      Candu</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Candu</span><br />
      <span class="post-time small text-muted">2nd March 2009 15:18 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Hello again,<br />
      <br />
      I have updated the MojoPack with two additional functions:<br />
      <br />
      WReplaceInFile and WReplaceInFileEx.<br />
      <br />
      The functions are working similar to ReplaceInfile and ReplaceInFileEx, but using unicode files.<br />
      <br />
      The version of MojoPack.dll has been increased to 1.0.0.1.<br />
      <br />
      See MojoPack_ReleaseNotes.txt for some more details on this release.<br />
      <br />
      The attached file only contains the dll, the readme and the release notes. The source code could not be included because of the file size limitation.<br />
      <br />
      @board admins: do I have the chance to upload the whole MojoPack project somewhere? (211 KB).<br />
      <br />
      Regards<br />
      Candu</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Candu</span><br />
      <span class="post-time small text-muted">2nd March 2009 16:02 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">OK, attached you will find the Source code of version 1.0.0.1.<br />
      <br />
      For Delphians:<br />
      --------------<br />
      To compile the project, you must have the Jedi Code Library and the TMS Unicode Component Pack installed.<br />
      <br />
      <br />
      Regards<br />
      Candu</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Red Wine</span><br />
      <span class="post-time small text-muted">2nd March 2009 21:39 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"></p>

      <blockquote>
        do I have the chance to upload the whole MojoPack project somewhere? (211 KB).
      </blockquote>NSIS wiki <a href="http://nsis.sf.net" target="_blank">http://nsis.sf.net</a> is the place.
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">f!o</span><br />
      <span class="post-time small text-muted">1st September 2009 16:34 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Hello,<br />
      <br />
      Your plugin unfortunately cannot work with the Unicode version of NSIS. I have the same issue.<br />
      <br />
      Do you know if there is an existing version of the NSIS.pas that manages unicode for the string parameters passed ?<br />
      <br />
      Thanks &amp; Regards,<br />
      F!o</p>
    </div>
    <hr />

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]>
  </script>
</body>
</html>
