<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="description" content="nsExec problem"><title>nsExec problem - NSIS Forums</title><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script><link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css"><link rel="stylesheet" href="../css/style.css" type="text/css"><!--[if lt IE 9]><script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script><script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script><![endif]--></head><body><div class="container"><ol class="breadcrumb"><li><a href="../index.html" class="glyphicon glyphicon-home"></a></li><li><a href="f-65.html">NSIS Discussion</a></li><li class="active">nsExec problem</li></ol><p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=125431">nsExec problem</a></p><br><div class="post"><p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br><span class="post-time small text-muted">17th February 2003 21:52 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>nsExec problem</strong><br>Could not load: C:\DOCUME~1\WINDOW~1\LOCALS~1\Temp\nst22.tmp\nsExec.dll<br><br>I get this when trying to use nsExec<br>It worked before, but stopped working now.<br>All I have done is moved parts of my nsi script to seperate nsi files, since my script got so large.<br>Is this a bug due to the nsExec command being called from in a seperate (!include) file?<br><br>I ran my old map-compiler script (when nsExec worked), and it still happens.<br><br>Also, how do I use LogText?<br><br>-Stuart :(</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">rainwater</span><br><span class="post-time small text-muted">18th February 2003 04:39 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Did you look to see if the file was there?</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">kichik</span><br><span class="post-time small text-muted">18th February 2003 15:53 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">b0 or b1? Please attach the script.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">kichik</span><br><span class="post-time small text-muted">18th February 2003 19:24 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">To use LogText you have to compile your own version of NSIS with #define NSIS_CONFIG_LOG uncommented in Source\exehead\config.h. Then use LogSet to turn on/off the log and then you'll be able to use LogText (I think you can skip LogSet, not sure about it).</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br><span class="post-time small text-muted">18th February 2003 20:02 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Another question...<br>Is there any way of copying all text in the LogText window, and then pasting it into a file?<br>I mean a script to do it, instead of the user doing it manually.<br><br>-Stuart</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">kichik</span><br><span class="post-time small text-muted">18th February 2003 20:10 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Well, you can do what NSIS does when the user right-clicks the log and chooses copy. This will require System.dll and I don't have much time now so you'll have to wait for tomorrow unless someone will figure it out before me :)</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br><span class="post-time small text-muted">19th February 2003 19:07 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">How is the figuring it out going :)<br><br>-Stuart</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">kichik</span><br><span class="post-time small text-muted">19th February 2003 20:15 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Here it is:<br><a href="http://nsis.sourceforge.net/archive/nsisweb.php?page=153&amp;instances=0,11" target="_blank">http://nsis.sourceforge.net/archive/...instances=0,11</a></p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Irish2007</span><br><span class="post-time small text-muted">29th February 2008 20:57 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Kichik, I am using your Dump Log file script for the installer - but it doesn't log the uninstall -- is there a way to adapt this script to log the uninstall information??<br><br>thanks so much for the help!</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">kichik</span><br><span class="post-time small text-muted">1st March 2008 15:35 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Well, the function in the example is not built for the uninstaller as you can see by its lack of "un." prefix. If you wish to use it in the uninstaller, rename it to un.DumpLog.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">yudyzhao</span><br><span class="post-time small text-muted">16th February 2010 12:17 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">kichik, I used your dumplog in my installer script. But the install.log content is unreadable at all because I created the installer by Unicode NSIS. Is there Unicode system.dll available or any other way to solve this problem?<br><br>Thanks a lot.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">kichik</span><br><span class="post-time small text-muted">16th February 2010 12:26 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">System plug-in already supports Unicode. You just have to call the right functions (W instead of A) with the right parameter types (w instead of t).</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">yudyzhao</span><br><span class="post-time small text-muted">17th February 2010 15:00 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">kichik, thanks a lot. Problem is solved! :up:</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">ptz</span><br><span class="post-time small text-muted">8th December 2011 15:32 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"></p><blockquote><small>Originally posted by kichik</small><br>System plug-in already supports Unicode. You just have to call the right functions (W instead of A) with the right parameter types (w instead of t).</blockquote>I receive an unreadable file too (2.46 Unicode), and I don't understand the instruction kichik gave above regarding how to modify the function (<a href="http://nsis.sourceforge.net/Dump_log_to_file" target="_blank">http://nsis.sourceforge.net/Dump_log_to_file</a>) to make it readable. Help is appreciated.<br><br>Thanks.</div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br><span class="post-time small text-muted">8th December 2011 16:23 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Use SendMessageW instead of SendMessageA and you need to use LVM_GETITEMTEXTW instead of LVM_GETITEMTEXT (google the value). You may also need to change the &amp;t to &amp;w but check the Unicode System plug-in readme for that.<br><br>Edit: You may also need to use different FileWrite functions but again check the Unicode NSIS manual.<br><br>Stu</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">ptz</span><br><span class="post-time small text-muted">8th December 2011 16:52 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Oh, excellent, switching to LVM_GETITEMTEXTW did the trick. Thanks, Stu.</p></div><hr><div class="footer"><p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p></div></div><script src="../js/highlight.pack.js" type="text/javascript"></script><script type="text/javascript">//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]></script></body></html>