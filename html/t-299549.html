<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="description" content="ExecWait and Visual Studio Express"><title>ExecWait and Visual Studio Express - NSIS Forums</title><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script><link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css"><link rel="stylesheet" href="../css/style.css" type="text/css"></head><body><div class="container"><ol class="breadcrumb"><li><a href="../index.html" class="glyphicon glyphicon-home"></a></li><li><a href="f-65.html">NSIS Discussion</a></li><li class="active">ExecWait and Visual Studio Express</li></ol><p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=299549">ExecWait and Visual Studio Express</a></p><br><div class="post"><p class="post-meta"><span class="post-author text-primary">hinmanj</span><br><span class="post-time small text-muted">4th November 2008 17:48 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>ExecWait and Visual Studio Express</strong><br>I just found another bug with my installer that installs Visual Studio 2005 Express and it's Service Pack.<br>The problem: NSIS downloads and runs the installer for VS 2005 Express from microsoft.com using ExecWait, but when it runs the VSE, the VSE installer self-extracts something really fast, and then setup starts. When the self-extracting ends, VSE's service pack gets called by NSIS to start (being the next component to install), and then there is an error because VSE hasn't finished installing yet. Is there a way to make ExecWait wait for the second part of the VSE installer? I can't find a VSE installer that doesn't self-extract first...<br><br>Thanks in advance for helping!<br><br>Edit: this is the best I could find about the installer, yet none of the command line calls help with ExecWait... <a href="http://support.microsoft.com/?id=197147" target="_blank">http://support.microsoft.com/?id=197147</a></p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">LoRd_MuldeR</span><br><span class="post-time small text-muted">4th November 2008 20:36 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">You could unpack the VSE installer yourself and include only the "unpacked" files in your installer. When VSE is to be installer, you let <i>your</i> installer extract the VSE setup files to the $PLUGINSDIR folder. Then you run the actual "Setup.exe" from the $PLUGINSDIR directory via ExecWait. Should work that way...<br><br><br>Like that:</p><pre>
<code>InitPluginsDir<br>SetOutPath "$PLUGINSDIR\VSE_Install"<br>File /r "C:\Redist\VSE Setup Files\*.*"<br>ExecWait '"$PLUGINSDIR\VSE_Install\Setup.exe"' $0<br>RMDir /r "$PLUGINSDIR\VSE_Install"</code>
</pre>
    </div>
    <hr>

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]></script></body></html>