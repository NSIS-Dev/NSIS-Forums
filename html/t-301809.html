<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="Exec syntax for ppm" />

  <title>Exec syntax for ppm - NSIS Forums</title>
  <script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script>
  <!-- Bootstrap core CSS -->

  <link rel="stylesheet" type="text/css" href="//netdna.bootstrapcdn.com/bootswatch/3.0.1/readable/bootstrap.min.css" />
  <link rel="stylesheet" href="../css/style.css" type="text/css" /><!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!--[if lt IE 9]>
                <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
                <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->
</head>

<body>
  <div class="container">
    <!-- Put navigation bar here -->

    <ol class="breadcrumb">
      <li><a href="../index.html" class="glyphicon glyphicon-home"></a></li>

      <li><a href="f-65.html">NSIS Discussion</a></li>

      <li class="active">Exec syntax for ppm</li>
    </ol>

    <p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=301809">Exec syntax for ppm</a></p><br />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">mysteryegg</span><br />
      <span class="post-time small text-muted">7th January 2009 22:05 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>Exec syntax for ppm</strong><br />
      Hello,<br />
      <br />
      I am familiar with executing .exe files with ExecWait, opening files with ExecShell, and even writing macro installers with lines such as<br />
      ExecWait '"msiexec" /i "$OUTDIR\ActivePerl-5.10.0.1004-MSWin32-x86-287188.msi" /norestart'<br />
      <br />
      However, I seem to run into a snag when I try to execute the equivalent of the following cmd-line argument:<br />
      <br />
      ppm install <a href="http://www.bribes.org/perl/ppm/Win32-Console-ANSI.ppd" target="_blank">http://www.bribes.org/perl/ppm/Win32-Console-ANSI.ppd</a><br />
      <br />
      (You can find details on what I am trying to achieve at <a href="http://www.bribes.org/perl/wANSIConsole.html" target="_blank">http://www.bribes.org/perl/wANSIConsole.html</a>)<br />
      <br />
      I have tried phrasing the argument the same way as the msiexec argument above, i.e.:<br />
      ExecWait '"ppm" install "<a href="http://www.bribes.org/perl/ppm/Win32-Console-ANSI.ppd" target="_blank">http://www.bribes.org/perl/ppm/Win32-Console-ANSI.ppd</a>"'<br />
      but perhaps the fact that ppm arguments do not use a forward-slash '/' somehow confuses NSIS?</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Anders</span><br />
      <span class="post-time small text-muted">7th January 2009 22:25 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">nsis does not care, it just passes the commandline to CreateProcess() are you sure ppm (.exe?) is in the path so CreateProcess finds it? if you use Process Monitor from sysinternals, you can see why the process does not start, or if it does, what the actual parameters it started with are</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">mysteryegg</span><br />
      <span class="post-time small text-muted">8th January 2009 15:59 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Hmm... is it possible for a command-line argument to work from the shell if it is not in the path for CreateProcess to find? Does Windows not share the same "PATH" environment variables with NSIS?<br />
      <br />
      ppm is the Perl Package Manager... oh wait, perhaps NSIS does not recognize the same list of executable filetypes (usually derived from environment variable PATHEXT). In fact, ppm is a .bat file, not a .exe. So it looks like I'm fine as long as I explicitly write ppm.bat in my argument.<br />
      <br />
      Is this a limitation of NSIS?</p>
    </div>
    <hr />

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]>
  </script>
</body>
</html>
