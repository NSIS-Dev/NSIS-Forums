<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="Apply Windows Theme" />

  <title>Apply Windows Theme - NSIS Forums</title><!-- Bootstrap core CSS -->
  <link rel="stylesheet" type="text/css" href="//netdna.bootstrapcdn.com/bootswatch/3.0.1/readable/bootstrap.min.css" />
  <link rel="stylesheet" href="../css/style.css" type="text/css" /><!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!--[if lt IE 9]>
                <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
                <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->
</head>

<body>
  <div class="container">
    <!-- Put navigation bar here -->

    <ol class="breadcrumb">
      <li><a href="../index.html" class="glyphicon glyphicon-home"></a></li>

      <li><a href="f-65.html">NSIS Discussion</a></li>

      <li class="active">Apply Windows Theme</li>
    </ol>

    <p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=216478">Apply Windows Theme</a></p><br />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Yathosho</span><br />
      <span class="post-time small text-muted">19th May 2005 22:34 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>Apply Windows Theme</strong><br />
      i did a little research on msdn and google, but couldn't get any helpful information. what i'm trying to do is to install and apply a theme for windows xp (i.e. <i>$WINDIR\Resources\Themes\Windows Classic.theme</i>).<br />
      <br />
      when you do it over the registry, the theme won't be installed until next reboot. i'm not sure if one can install it using anything related to <i>rundll32.exe shell32.dll,Control_RunDLL desk.cpl</i> without pressing an extra button (OK or Apply) to apply it.<br />
      <br />
      there might be a system-call, but i couldn't find anything (<a href="http://msdn.microsoft.com/library/default.asp?url=/library/en-us/shellcc/platform/commctls/userex/themesinstaller.asp" target="_blank">this</a> might be a hint).<br />
      <br />
      can anyone help me?</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">ZmAn3</span><br />
      <span class="post-time small text-muted">20th May 2005 08:39 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">i know this has to be possible style xp does it and ive seen a self extracting copy of windows 3000 theme somewhere at one point that did it too.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Instructor</span><br />
      <span class="post-time small text-muted">20th May 2005 08:56 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><a href="http://msdn.microsoft.com/library/default.asp?url=/library/en-us/shellcc/platform/commctls/userex/refentry.asp" target="_blank">http://msdn.microsoft.com/library/de...x/refentry.asp</a><br />
      <br />
      <br />
      But I think easy to use:</p>
      <pre>
<code>ExecShell "open" "$WINDIR\Resources\Themes\Windows Classic.theme"</code>
</pre>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">ZmAn3</span><br />
      <span class="post-time small text-muted">20th May 2005 09:15 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Instructor,<br />
      <br />
      that just brings up the dialog to change the theme it doesnt actually apply it</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Instructor</span><br />
      <span class="post-time small text-muted">20th May 2005 09:58 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"></p>

      <blockquote>
        that just brings up the dialog to change the theme it doesnt actually apply it
      </blockquote>I know. See link above.
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Yathosho</span><br />
      <span class="post-time small text-muted">20th May 2005 14:15 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">is it SetWindowTheme to use or do you suggest using ExecShell and CloseThemeData?</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Instructor</span><br />
      <span class="post-time small text-muted">21st May 2005 09:35 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Yathosho, you can use API or ExecShell.<br />
      <br />
      I tried to write a code, but have faced a problem with API - $1 is NULL:<br /></p>
      <pre>
<code>System::Call 'user32::GetDesktopWindow()i .r0'<br />System::Call 'uxtheme::OpenThemeData(i r0, t L"StartPanel")i .r1'</code>
</pre>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Instructor</span><br />
      <span class="post-time small text-muted">21st May 2005 12:37 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Try this:<br /></p>
      <pre>
<code>Name "ChangeStyleXP"<br />OutFile "ChangeStyleXP.exe"<br /><br />!include "FileFunc.nsh"<br />!insertmacro GetFileName<br /><br />!define BM_CLICK 0x00F5<br />!define WM_CLOSE 0x0010<br /><br />Section<br />        IfFileExists "$WINDIR\Resources\Themes\Windows Classic.theme" 0 error<br />        ExecShell 'open' '$WINDIR\Resources\Themes\Windows Classic.theme'<br />        FindWindow $0 '#32770' '' $HWNDPARENT<br />        StrCpy $3 0<br /><br />        wait:<br />        IntOp $3 $3 + 1<br />        StrCmp $3 50 error<br />        Sleep 100<br />        System::Call 'user32::GetForegroundWindow()i .r1'<br />        StrCmp $0 $1 wait<br /><br />        System::Call 'user32::GetWindowModuleFileName(i r1, t .r2, i ${NSIS_MAX_STRLEN})'<br />        ${GetFileName} '$2' $2<br />        StrCmp $2 'comctl32.dll' 0 wait<br /><br />        HideWindow<br />        GetDlgItem $2 $1 1<br />        SendMessage $2 ${BM_CLICK} 0 0<br />        MessageBox MB_OK "Success" IDOK quit<br /><br />        error:<br />        MessageBox MB_OK "Error"<br /><br />        quit:<br />        quit<br />SectionEnd</code>
</pre><a href="http://forums.winamp.com/attachment.php?s=&amp;postid=1647312" target="_blank">Script use header</a>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">ZmAn3</span><br />
      <span class="post-time small text-muted">22nd May 2005 06:31 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">now that works thanks ive been looking for that myself</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">ZmAn3</span><br />
      <span class="post-time small text-muted">23rd May 2005 01:03 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">you should post that in the archive</p>
    </div>
    <hr />

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]>
  </script>
</body>
</html>
