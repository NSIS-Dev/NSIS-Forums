<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="&quot;Could not load: XXXX.dll&quot; error in log (possibly XP SP3 related)" />

  <title>"Could not load: XXXX.dll" error in log (possibly XP SP3 related) - NSIS Forums</title><!-- Bootstrap core CSS -->
  <link rel="stylesheet" type="text/css" href="//netdna.bootstrapcdn.com/bootswatch/3.0.1/readable/bootstrap.min.css" />
  <link rel="stylesheet" href="../css/style.css" type="text/css" /><!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!--[if lt IE 9]>
                <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
                <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->
</head>

<body>
  <div class="container">
    <!-- Put navigation bar here -->

    <ol class="breadcrumb">
      <li><a href="../index.html" class="glyphicon glyphicon-home"></a></li>

      <li><a href="f-65.html">NSIS Discussion</a></li>

      <li class="active">"Could not load: XXXX.dll" error in log (possibly XP SP3 related)</li>
    </ol>

    <p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=291913">"Could not load: XXXX.dll" error in log (possibly XP SP3 related)</a></p><br />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kinar</span><br />
      <span class="post-time small text-muted">16th May 2008 21:37 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>"Could not load: XXXX.dll" error in log (possibly XP SP3 related)</strong><br />
      I've run into an issue where an installer will not work on a machine that was previously "hosed up" by XP SP3. Prior to the botched SP3 install, the computer had the software installed and was working fine. resolving the botched SP3 install involved restoring to a previous restore point (i'm not sure if this was windows restore or a 3rd party restore util) which was also prior to the software being installed.<br />
      <br />
      However, the installer no longer works on this machine.<br />
      <br />
      I've left out all the gory details of the install log, however, normally it goes like this (I have highlighted the file names which I replaced to protect the innocent):<br />
      <br /></p>
      <pre>
<code>Output folder: C:\Program Files\<font color="red">InstallDirectory</font>\<br />Extract: <font color="red">File1.exe</font>... 100%<br />Extract: <font color="red">File2.dll</font>... 100%<br />Extract: <font color="red">File3.dll</font>... 100%<br />Extract: <font color="red">File4.exe</font>... 100%<br />...<br />Continue on with other files and directorys in the install dir<br />...<br />Create folder: C:\Documents and Settings\<font color="red">USER</font>\Start Menu\Programs\<font color="red">ApplicationName</font><br />Create shortcut: C:\Documents and Settings\<font color="red">USER</font>\Start Menu\Programs\<font color="red">ApplicationName</font>\<font color="red">Application</font>.lnk<br />Created uninstaller: C:\Program Files\<font color="red">InstallDirectory</font>\uninst.exe<br />Registering: C:\Program Files\<font color="red">InstallDirectory</font>\<font color="red">File2.dll</font><br />Registering: C:\Program Files\<font color="red">InstallDirectory</font>\<font color="red">File3.dll</font><br />Completed<br /></code>
</pre><br />
      <br />
      On the machine in question, it goes as follows (fails at the registering stage).<br />
      <br />
      <pre>
<code>Output folder: C:\Program Files\<font color="red">InstallDirectory</font>\<br />Extract: <font color="red">File1.exe</font>... 100%<br />Extract: <font color="red">File2.dll</font>... 100%<br />Extract: <font color="red">File3.dll</font>... 100%<br />Extract: <font color="red">File4.exe</font>... 100%<br />...<br />Continue on with other files and directorys in the install dir<br />...<br />Create folder: C:\Documents and Settings\<font color="red">USER</font>\Start Menu\Programs\<font color="red">ApplicationName</font><br />Create shortcut: C:\Documents and Settings\<font color="red">USER</font>\Start Menu\Programs\<font color="red">ApplicationName</font>\<font color="red">Application</font>.lnk<br />Created uninstaller: C:\Program Files\<font color="red">InstallDirectory</font>\uninst.exe<br />Could not load: C:\Program Files\<font color="red">InstallDirectory</font>\<font color="red">File2.dll</font><br />Could not load: C:\Program Files\<font color="red">InstallDirectory</font>\<font color="red">File3.dll</font><br />Completed<br /></code>
</pre><br />
      <br />
      Upon checking the Install directory, it is empty which explains the could not load error, however, what could possibly cause the installer to report that it extracted the file but the file not actually get extracted?<br />
      <br />
      Any thoughts/ideas/help would be greatly appreciated...<br />
      <br />
      I realise that the answer I probably am going to get is something along the lines of "reinstall XP" or "no way of knowing what is happening" but if anyone has any other advice, please help.<br />
      <br />
      TIA,
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
      <span class="post-time small text-muted">16th May 2008 22:15 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">I'll give you both. No way and you need to reinstall XP. No way because it'd tell you if it couldn't extract, so something is probably deleting the files later. And reinstall XP because it fails loading due to missing dependencies.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">{_trueparuex^}</span><br />
      <span class="post-time small text-muted">16th May 2008 22:29 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>Re: "Could not load: XXXX.dll" error in log (possibly XP SP3 related)</strong><br /></p>

      <blockquote>
        <i>Originally posted by kinar</i><br />
        <b>I realise that the answer I probably am going to get is something along the lines of "reinstall XP" or "no way of knowing what is happening" but if anyone has any other advice, please help.</b>
      </blockquote>Luckily we don't get much that kind of answers around here. :)<br />
      <br />
      The first thing that comes to mind is that your AV thinks those files are malware and is removing them, but then you probably should get a warning from the AV.<br />
      <br />
      You could try to run to <a href="http://technet.microsoft.com/en-us/sysinternals/bb896642.aspx" target="_blank">Filemon</a>. It's a tool from Microsoft to monitor system file activity.<br />
      <br />
      Just use "File2.dll;File3.dll" as Include filter in Filemon and run the installer again. That should tell exactly what's happening to those files.<br />
      <br />
      Edit: Lol kichik! Though you are might be right.
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kinar</span><br />
      <span class="post-time small text-muted">16th May 2008 22:38 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">kichik, thanks for the response. As a developer, I certainly appreciate seeing someone else use the "no way in hell that is happening" response (I use it frequently). I'll look into what might possibly be removing them.<br />
      <br />
      Also, {_trueparuex^}, thanks for the suggestion of FileMon. I am familiar with it from back before MS bought sysinternals.<br />
      <br />
      Unfortunately this is not a machine that I can sit down in front of so I may not ever find a solution, but I'll see if I can arrange to remote into the machine on monday and poke around a bit.<br />
      <br />
      I'll make sure to post back here any results.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kinar</span><br />
      <span class="post-time small text-muted">21st May 2008 20:58 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">As usual, it turns out that I got some bad information.<br />
      <br />
      The files are extracted to the installation directory as expected.<br />
      <br />
      The DLL registration failure is being caused by the fact that vcredist_x86 is not properly installing the MFC80 dlls which causes the application dlls to fail registration.<br />
      <br />
      The funny thing about all of this is that while searching the forums prior to posting, I found all 80 million posts about dll registration failing due to missing dependancies but had assumed it wasn't the issue due to the information I had previously been given.<br />
      <br />
      Sometimes it is quite amazing how things work out.<br />
      <br />
      Thanks one last time for the help guys.</p>
    </div>
    <hr />

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]>
  </script>
</body>
</html>
