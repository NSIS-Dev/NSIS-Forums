<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="description" content="Cursor Image reload"><title>Cursor Image reload - NSIS Forums</title><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script><link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css"><link rel="stylesheet" href="../css/style.css" type="text/css"></head><body><div class="container"><ol class="breadcrumb"><li><a href="../index.html" class="glyphicon glyphicon-home"></a></li><li><a href="f-65.html">NSIS Discussion</a></li><li class="active">Cursor Image reload</li></ol><p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=148002">Cursor Image reload</a></p><br><div class="post"><p class="post-meta"><span class="post-author text-primary">DOCa Cola</span><br><span class="post-time small text-muted">3rd September 2003 10:38 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>Cursor Image reload</strong><br>Hi!<br><br>i sometimes use an old app which everytime i use it replaces the windows cursors with custom cursors for the arrow, textselect and the hourglass.<br><br>it should remove the custom cursors after i close the app, but i have read in a faq that this is a known bug since windows 2000/xp and there will be no furthur support for it. the cursors are used globally after i closed the app and even are selected in the pointers tab in the mouse properties in the control panel. but when i logout and login again or restart my computer the cursors are all normal. it seems the only problem that the custom cursors of that app don't go away is that they are not refreshed anymore after closing the app. i wanted to write a small script with the help of the system plugin to refresh the cursors manually but i have (again) no idea how to begin, maybe someone could help me...<br><br>I have looked through the imports of the app and found for user32.dll<br>LoadCursorA<br>SetCursor<br><br>so i looked through msdn for it and came to that <a href="http://msdn.microsoft.com/library/default.asp?url=/library/en-us/winui/WinUI/WindowsUserInterface/Resources/Cursors/UsingCursors.asp#_win32_Displaying_a_Cursor" target="_blank">site</a><br><br>hope that helps<br><br>DOCa Cola</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">brainsucker</span><br><span class="post-time small text-muted">4th September 2003 00:15 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Could you post more information about that bug? It will be much easier to know what to do if we will know the way that program corrupts the cursors. may be a link to faq will help.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">DOCa Cola</span><br><span class="post-time small text-muted">4th September 2003 10:48 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">it does not corrupt the cursors, it loads a new cursor set which replaces the standard windows cursors, but since windows 2000/xp it is unable to unload the cursors after the program has quit, so they stay until i restart, logoff/logon or reset them in the mouse properties in the control panel...</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">n0On3</span><br><span class="post-time small text-muted">5th September 2003 13:07 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Modified cursors are stored in the registry in "CU\Control Panel\Cursors". Maybe if you delete values inside that folder, you will regain old cursors on reboot. (I tried the 'refresh icons' thing and didn't refresh cursors)</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">brainsucker</span><br><span class="post-time small text-muted">5th September 2003 17:44 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">If he reboots the cursors are restored anyway :) He just wants to do that without rebooting :)<br><br>the following function does what she wants, but where should we look for default cursors? ;)<br><br>BOOL SetSystemCursor(HCURSOR hcur, DWORD id);</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">brainsucker</span><br><span class="post-time small text-muted">5th September 2003 18:04 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">It looks like cursors (changed one) are stored at HKCU\Control Panel\Cursors. Default cursors are default :)<br>You could load and set listed cursors and try to set not listed to NULL (0) (may be this will restore them).<br><br>Here the functioon prototype (look at msdn for parameters):<br>System::Call 'user32::SetSystemCursor(i r0, i 32512) i'<br><br>also you will need (will place cursor handle to r0, you should pass it SetSystemCursor).<br>System::Call 'user32::LoadImage(i 0, t "file name", i 2, i 0, i 0, i 0x10) i.r0'<br><br>list of constants for SetSystemCursor second arg:<br>#define OCR_NORMAL 32512<br>#define OCR_IBEAM 32513<br>#define OCR_WAIT 32514<br>#define OCR_CROSS 32515<br>#define OCR_UP 32516<br>#define OCR_SIZENWSE 32642<br>#define OCR_SIZENESW 32643<br>#define OCR_SIZEWE 32644<br>#define OCR_SIZENS 32645<br>#define OCR_SIZEALL 32646<br>#define OCR_NO 32648<br>#define OCR_HAND 32649<br>#define OCR_APPSTARTING 32650</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">DOCa Cola</span><br><span class="post-time small text-muted">6th September 2003 00:03 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">ok, i got it to work to load a cursor, but thats the same as the program does...so<br>i attached a sample code to change to cursor to another one, maybe you will find a way, i tried to load a 'null' cursor (to reset to the default arrow), but that does not work<br><br>DOCa Cola</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">n0On3</span><br><span class="post-time small text-muted">6th September 2003 13:26 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"></p><blockquote><i>Originally posted by brainsucker</i><br>[B]If he reboots the cursors are restored anyway :) He just wants to do that without rebooting :)</blockquote>:rolleyes: :hang:</div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">DOCa Cola</span><br><span class="post-time small text-muted">6th September 2003 13:33 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">i like the idea to load up custom cursors, and it's a simple but useful function (maybe for more custom setups), now only a way is missing to unload them again to fix the problem with my program, i think the program loads the cursors exact the same way.<br><br>DOCa Cola</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">DOCa Cola</span><br><span class="post-time small text-muted">14th September 2003 16:06 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">any ideas how to get the default windows cursors back? :)<br><br>DOCa Cola</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Joost Verburg</span><br><span class="post-time small text-muted">14th September 2003 16:08 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><a href="http://msdn.microsoft.com/library/default.asp?url=/library/en-us/winui/WinUI/WindowsUserInterface/Resources/Cursors/CursorReference/CursorFunctions/LoadCursor.asp" target="_blank">http://msdn.microsoft.com/library/de...LoadCursor.asp</a></p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">DOCa Cola</span><br><span class="post-time small text-muted">14th September 2003 16:20 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">ok..<br>now there is<br>HCURSOR LoadCursor(<br>HINSTANCE hInstance,<br>LPCTSTR lpCursorName<br>);<br><br>so<br><br>hInstance<br>[in] Handle to an instance of the module whose executable file contains the cursor to be loaded.<br><br>so, which handle should i use then?<br>i have no idea.. (i am no programmer :))<br><br>DOCa Cola</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">DOCa Cola</span><br><span class="post-time small text-muted">17th September 2003 14:19 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">bump<br>sorry, don't want this thread get lost..please someone help me and load my example program and help me to reset the cursors to standard back after that..</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">brainsucker</span><br><span class="post-time small text-muted">17th September 2003 23:51 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">LoadCursor handle: you should give it a handle to the file you want to use as a source for cursor.<br><br>sorry ;)</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">brainsucker</span><br><span class="post-time small text-muted">19th September 2003 11:27 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Sorry again :) Lost my mind. This should work:<br><br>System::Call "user32::SystemParametersInfo(i 0x057, i 0, i 0, i 0x02) i.r0"</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">DOCa Cola</span><br><span class="post-time small text-muted">21st September 2003 16:46 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">oh! thank you very very much :)<br>Great work! Works very nice, now i am really happy :)<br><br>DOCa Cola</p></div><hr><div class="footer"><p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p></div></div><script src="../js/highlight.pack.js" type="text/javascript"></script><script type="text/javascript">//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]></script></body></html>