<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="description" content="run installed app as administrator, and remove services"><title>run installed app as administrator, and remove services - NSIS Forums</title><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script><link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css"><link rel="stylesheet" href="../css/style.css" type="text/css"><!--[if lt IE 9]><script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script><script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script><![endif]--></head><body><div class="container"><ol class="breadcrumb"><li><a href="../index.html" class="glyphicon glyphicon-home"></a></li><li><a href="f-65.html">NSIS Discussion</a></li><li class="active">run installed app as administrator, and remove services</li></ol><p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=321882">run installed app as administrator, and remove services</a></p><br><div class="post"><p class="post-meta"><span class="post-author text-primary">technobuddha</span><br><span class="post-time small text-muted">22nd August 2010 21:24 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>run installed app as administrator, and remove services</strong><br>Hi all,<br>I have an nsis installer, that installs a few applications.<br>it works in windows xp, but in widnows 7, there are a few problems, and I'm sure nsis has a plugin for me, but can't figure it out for the likes of me.<br><br>The application, which needs to run at startup, is always prompted with "needs to run as administrator". My understanding, is that a shortcut with the checked "run as administrator" needs to be included? how is this accomplished with NSIS?<br><br>also, another service application, gets installed and runs fine, but when the user tries to remove it, via the installer, it won't work: needs administrative permission to remove (because the uninstaller runs a batch file,to remove the services). Is there an nsis plugin that allows the removal of a service, instead of a batch file?<br><br>thanks!</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Animaether</span><br><span class="post-time small text-muted">22nd August 2010 22:02 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"></p><blockquote><small>Originally posted by technobuddha</small><br>The application, which needs to run at startup, is always prompted with "needs to run as administrator". My understanding, is that a shortcut with the checked "run as administrator" needs to be included? how is this accomplished with NSIS?</blockquote><a href="http://forums.winamp.com/showthread.php?t=278764&amp;highlight=shortcut+administrator" target="_blank">http://forums.winamp.com/showthread....+administrator</a> - Create a shortcut link which has "Run as administrator" option enabled on Vista<br><a href="http://forums.winamp.com/showthread.php?t=319628&amp;highlight=shortcut+administrator" target="_blank">http://forums.winamp.com/showthread....+administrator</a> - CreateShortcut to run as administrator<br><br>Note that this won't -remove- the prompt for elevation to Administrator, though. In fact, if the application already asks for it, then the shortcut flag won't change anything. The shortcut flag is needed for applications that do -not- attempt to elevate themselves to Administrator (i.e. you double-click on it, and it runs as User), but you always want to run as Administrator anyway (so that double-clicking on it will prompt for Administrator elevation, etc.).<br><br><blockquote>Is there an nsis plugin that allows the removal of a service, instead of a batch file?</blockquote><a href="http://nsis.sourceforge.net/NSIS_Simple_Service_Plugin" target="_blank">http://nsis.sourceforge.net/NSIS_Simple_Service_Plugin</a></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">technobuddha</span><br><span class="post-time small text-muted">23rd August 2010 18:21 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">sooo, then how does NSIS able to create an installer, that allows for an application to startup WITHOUT being prompted for administration privilage? this application needs it, and i suspect what your saying, is that at this time, NSIS can't do that then?</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">MSG</span><br><span class="post-time small text-muted">23rd August 2010 21:04 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">If an application requires administrative access, then naturally there's nothing you can do about that. If it needs it, it needs it. Not even NSIS can change that.<br><br>What makes you think you can run an application without what it needs? You wouldn't expect your PC to start running without the electricity it requires, would you?</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Animaether</span><br><span class="post-time small text-muted">23rd August 2010 23:38 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">One potential confusing situation is when you build an installer that requires Admin access, so you 'RequestExecutionLevel admin' in your installer. Now the installer process has Admin privileges. Next up you install an application that requires Administrator privileges and on the Finish page you add a "Run MyProgram now" option. The user leaves that checked, finishes the installer, and the application ruins.. without an elevation prompt. So what happens there? The installer with its Admin privileges process launches another process (the application) - and this process automatically takes on the same privileges (roughly speaking) as the process that launched it (the installer). Hence no renewed elevation required.<br><br>This is typically -not- desired, though, and is one of the main reasons the UAC plugin exists, for example... to specifically launch an application as User even if the installer runs with Admin privileges.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">technobuddha</span><br><span class="post-time small text-muted">24th August 2010 14:09 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Yep,thanks Animaether for the suggestion, I used the NSIS_Simple_Service_Plugin, and it works! with regards to 'RequestExecutionLevel admin', I'll add that!!!<br><br>I hope this works, and i'll find out tomorrow... I appreciate your time!</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Animaether</span><br><span class="post-time small text-muted">24th August 2010 16:31 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"></p><blockquote><small>Originally posted by technobuddha</small><br>Yep,thanks Animaether for the suggestion, I used the NSIS_Simple_Service_Plugin, and it works! with regards to 'RequestExecutionLevel admin', I'll add that!!!<br><br>I hope this works, and i'll find out tomorrow... I appreciate your time!</blockquote>I'm not entirely convinced you understood what I wrote :)<br><br>If you add "RequestExecutionLevel admin" to your installer, then the user will be prompted for elevation when they run the installer, but not be prompted again when the installer runs the application.<br>However, if the user -themselves- run the application (presuming they're not running under an admin shell/etc.), they -will- still be prompted. There's just no way around that other than getting the application's developer to release a non-Admin-required version of the application. Presumably it needs Admin for a reason, though :)</div><hr><div class="footer"><p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p></div></div><script src="../js/highlight.pack.js" type="text/javascript"></script><script type="text/javascript">//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]></script></body></html>