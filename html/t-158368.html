<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="@Afrow Write to text file line number" />

  <title>@Afrow Write to text file line number - NSIS Forums</title>
  <script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script>
  <!-- Bootstrap core CSS -->

  <link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css" />
  <link rel="stylesheet" href="../css/style.css" type="text/css" /><!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!--[if lt IE 9]>
                <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
                <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->
</head>

<body>
  <div class="container">
    <!-- Put navigation bar here -->

    <ol class="breadcrumb">
      <li><a href="../index.html" class="glyphicon glyphicon-home"></a></li>

      <li><a href="f-65.html">NSIS Discussion</a></li>

      <li class="active">@Afrow Write to text file line number</li>
    </ol>

    <p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=158368">@Afrow Write to text file line number</a></p><br />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">TonyDS</span><br />
      <span class="post-time small text-muted">3rd December 2003 02:24 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>@Afrow Write to text file line number</strong><br />
      Hi Afrow or anyone, I'm trying to use your script to write to a text file, but I'm having a problem, I'm trying to place a bit of text onto the first line of the text file, I'm only presuming that the other text in the file will be move down by on row, but when I try it, it deleted the whole text file and only places the "hello" on the second line down.<br />
      <br />
      <br />
      Could you or anyone else tell me where I'm going wrong please<br />
      <br />
      <br /></p>
      <pre>
<code><br />Function .onInit<br />Push hello<br />Push 1<br />Push "$INSTDIR\file.txt"<br />Call WriteToFileLine<br /><br /><br />Function WriteToFileLine<br />Exch $0 ;file<br />Exch<br />Exch $1 ;line number<br />Exch 2<br />Exch $2 ;string to write<br />Exch 2<br />Push $3<br />Push $4<br /><br />  FileOpen $4 $0 w<br /> StrCpy $3 0<br /><br />loop:<br />IntOp $3 $3 + 1<br />   ClearErrors<br />  FileRead $4 $0<br />   IfErrors +2<br />StrCmp $3 $1 0 loop<br />  FileWrite $4 "$\r$\n$2$\r$\n"<br />  FileClose $4<br /><br />Pop $4<br />Pop $3<br />Pop $2<br />Pop $1<br />Pop $0<br />FunctionEnd<br /></code>
</pre>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
      <span class="post-time small text-muted">3rd December 2003 11:31 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">You can't just stick text in the middle of the file, it won't push the following text further. You must open another file, write what you want into it, delete the original file and then copy over the new file. There are examples in the Archive that do that, you can use them as a reference.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">TonyDS</span><br />
      <span class="post-time small text-muted">3rd December 2003 23:01 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Oh well thanks</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
      <span class="post-time small text-muted">5th December 2003 16:43 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Sorry, I wrote the script while lacking a bit of skills.<br />
      It now works.<br />
      <br />
      -Stu</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">TonyDS</span><br />
      <span class="post-time small text-muted">5th December 2003 18:55 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Thanks Afrow I'll try it :)</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">TonyDS</span><br />
      <span class="post-time small text-muted">5th December 2003 21:03 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Yep it does work, now, I looked thorugh the archive but I wasn't sure which script was right, the thing is, how would I go about writing to more than one line<br />
      Say I wanted for example<br />
      <br />
      Hello<br />
      Hi again<br />
      Bye Bye<br />
      Im outta here<br />
      Gone<br />
      <br />
      would it work if I placed $/r$/n and so on (if thats right I've forgotten this is correct or not)<br />
      <br />
      or say I wanted to write different lines to lines 1 5 10 7 22 and so on is this possible?<br />
      <br />
      Thanks</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
      <span class="post-time small text-muted">5th December 2003 23:29 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"></p>

      <blockquote>
        <i>Originally posted by TonyDS</i><br />
        <b>Yep it does work, now, I looked thorugh the archive but I wasn't sure which script was right, the thing is, how would I go about writing to more than one line<br />
        Say I wanted for example<br />
        <br />
        Hello<br />
        Hi again<br />
        Bye Bye<br />
        Im outta here<br />
        Gone<br />
        <br />
        would it work if I placed $/r$/n and so on (if thats right I've forgotten this is correct or not)<br />
        <br />
        or say I wanted to write different lines to lines 1 5 10 7 22 and so on is this possible?<br />
        <br />
        Thanks</b>
      </blockquote>Yes all of this is possible.<br />
      Write multiple lines to a single line number using $\r$\n, and as for writing to multiple line numbers, you will have to call the function multiple times.<br />
      Don't forget that once a line has been entered, the preceeding lines will be moved down. Therefore, what used to be line 14 will now be line 15. You will have to take this into account while writing to different lines one after another.<br />
      <br />
      -Stu
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">lewellyn</span><br />
      <span class="post-time small text-muted">5th December 2003 23:43 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Of course, you could always write from the bottom up and not worry about the numbers changing :)</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
      <span class="post-time small text-muted">5th December 2003 23:48 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"></p>

      <blockquote>
        <i>Originally posted by lewellyn</i><br />
        <b>Of course, you could always write from the bottom up and not worry about the numbers changing :)</b>
      </blockquote>Good idea!<br />
      <br />
      -Stu :)
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">TonyDS</span><br />
      <span class="post-time small text-muted">6th December 2003 00:46 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">True I could do it bottom up, but for this specific file it need to be top down<br />
      <br />
      Thanks again Afrow :)</p>
    </div>
    <hr />

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]>
  </script>
</body>
</html>
