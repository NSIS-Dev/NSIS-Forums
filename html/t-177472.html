<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="description" content="Exec executes in one PC and not in another"><title>Exec executes in one PC and not in another - NSIS Forums</title><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script><link rel="preload" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css" as="style" onload="this.rel='stylesheet'"><link rel="preload" href="../css/style.css" as="style" onload="this.rel='stylesheet'"><noscript><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css"><link rel="stylesheet" href="../css/style.css"></noscript><script>!function(a){"use strict";var b=function(b,c,d){function e(a){return h.body?a():void setTimeout(function(){e(a)})}function f(){i.addEventListener&&i.removeEventListener("load",f),i.media=d||"all"}var g,h=a.document,i=h.createElement("link");if(c)g=c;else{var j=(h.body||h.getElementsByTagName("head")[0]).childNodes;g=j[j.length-1]}var k=h.styleSheets;i.rel="stylesheet",i.href=b,i.media="only x",e(function(){g.parentNode.insertBefore(i,c?g:g.nextSibling)});var l=function(a){for(var b=i.href,c=k.length;c--;)if(k[c].href===b)return a();setTimeout(function(){l(a)})};return i.addEventListener&&i.addEventListener("load",f),i.onloadcssdefined=l,l(f),i};"undefined"!=typeof exports?exports.loadCSS=b:a.loadCSS=b}("undefined"!=typeof global?global:this);!function(a){if(a.loadCSS){var b=loadCSS.relpreload={};if(b.support=function(){try{return a.document.createElement("link").relList.supports("preload")}catch(b){return!1}},b.poly=function(){for(var b=a.document.getElementsByTagName("link"),c=0;c<b.length;c++){var d=b[c];"preload"===d.rel&&"style"===d.getAttribute("as")&&(a.loadCSS(d.href,d,d.getAttribute("media")),d.rel=null)}},!b.support()){b.poly();var c=a.setInterval(b.poly,300);a.addEventListener&&a.addEventListener("load",function(){b.poly(),a.clearInterval(c)}),a.attachEvent&&a.attachEvent("onload",function(){a.clearInterval(c)})}}}(this);</script></head><body><div class="container"><ol class="breadcrumb"><li><a href="../index.html" class="glyphicon glyphicon-home"></a></li><li><a href="f-65.html">NSIS Discussion</a></li><li class="active">Exec executes in one PC and not in another</li></ol><p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=177472">Exec executes in one PC and not in another</a></p><br><div class="post"><p class="post-meta"><span class="post-author text-primary">almoes</span><br><span class="post-time small text-muted">21st April 2004 08:34 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>Exec executes in one PC and not in another</strong><br>Hi,<br><br>I am using the Exec command to run a .cmd file. If I run the script in a winXP client it runs, but if I try to execute it on a win2k server it doesn't work. But it doesn't give any error, that is, for the details of the installation it appears as executed. However I know the script doesn't even start because it generates a log file which is not generated. Any ideas? Thanxs!<br><br>cheers,<br>alej</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Joost Verburg</span><br><span class="post-time small text-muted">21st April 2004 09:50 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Try using ExecShell with the open command.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">almoes</span><br><span class="post-time small text-muted">21st April 2004 10:38 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Thanxs, but it also doesn't work :cry: any ideas other ideas???<br><br>cheers,<br>alej</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">almoes</span><br><span class="post-time small text-muted">21st April 2004 12:30 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">If it helps, this is my command:<br><br>ExecShell open "$PROGRAMFILES\MyFolder\temp\myProgram.cmd" SW_SHOWNORMAL</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Takhir</span><br><span class="post-time small text-muted">21st April 2004 12:38 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">If ".cmd" (?) file requires console, try to use AllocConsole() API call in your NSIS script. Correct input/output redirection may be found in MSDN articles (CreatePipe(), DuplicateHandle(), CreateProcess()), but this is not easy way for script. And if this is what you need - ".cmd" text may help to understand problem :))</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">almoes</span><br><span class="post-time small text-muted">21st April 2004 12:43 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">So complicated??? I just want to run a batch file, there's no way to use 'Exec'? But it works in my lap-top.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Takhir</span><br><span class="post-time small text-muted">21st April 2004 12:49 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Try<br><br>System::Call "kernel32.lib::AllocConsole()"<br><br>first :-)</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Takhir</span><br><span class="post-time small text-muted">21st April 2004 12:52 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">sorry, kernel32.dll</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">almoes</span><br><span class="post-time small text-muted">21st April 2004 12:55 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">I am a bit lost with that expression, I am new to NSIS :-[<br>could you please tell me what it does? Thnaxs!</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Takhir</span><br><span class="post-time small text-muted">21st April 2004 13:06 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">This allocates console for parent application, and child application gets correct i/o handles. But My explanation is not based on any facts - give me your script and I'll run it on my W2K Server.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">almoes</span><br><span class="post-time small text-muted">21st April 2004 13:12 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">But how should I use the expression, I mean how do I indicate my batch file? My batch file gives some SQL commands, so you can't really execute it, but you can just do any batch file with an 'echo' to try.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Takhir</span><br><span class="post-time small text-muted">21st April 2004 13:19 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">System::Call "kernel32.lib::AllocConsole()"<br>ExecShell open "$PROGRAMFILES\MyFolder\temp\myProgram.cmd" SW_SHOWNORMAL<br><br>First call just creates conditions for next console app. execution. But (again) - there may absolutely another reasons of you batch crash, for example shell script specifics on various platforms.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">almoes</span><br><span class="post-time small text-muted">21st April 2004 13:33 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">no improvement! :-[</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">zimsms</span><br><span class="post-time small text-muted">21st April 2004 13:46 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">It could be a permissions issue. Windows Server is very strict on who can install or execute scripting files. This batch file, you say it contains SQL which you are executing, do you have the correct permissions to access the SQL Server/Oracle Server etc?</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">almoes</span><br><span class="post-time small text-muted">21st April 2004 13:50 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">It runs as Administrator!</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Joost Verburg</span><br><span class="post-time small text-muted">21st April 2004 13:50 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">It is probably a system related problem not related to this command.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">almoes</span><br><span class="post-time small text-muted">21st April 2004 13:53 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">ufff, then its not possible to run this batch file any other way?</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Joost Verburg</span><br><span class="post-time small text-muted">21st April 2004 13:55 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Does the batch file work when you start it manually?</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">almoes</span><br><span class="post-time small text-muted">21st April 2004 13:56 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">yes, in both machines.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Joost Verburg</span><br><span class="post-time small text-muted">21st April 2004 14:03 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Try to put quotes around the path:<br><br>'"file"'</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">almoes</span><br><span class="post-time small text-muted">21st April 2004 14:04 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">I got it....the script in the batch is failing (I entered a pause), but I dont know why because manually it runs. But its not NSIS problem anymore. So it looks like Exec runs on this system ;-) Thanxs for all.<br><br>cheers,<br>alej</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">zimsms</span><br><span class="post-time small text-muted">21st April 2004 14:13 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">You could try the following.<br><br>Admin Tools<br>Local Secuity Policies<br>User Rights Assignment<br>and add the admin to either of the following:<br>log on as batch job, or Act as part of the OS.<br><br>I'd only try this, it would at least let you know if it's a permissions thing. I found odd behaviour like this since I found the shell I was opening was just a shell with no privileges.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">almoes</span><br><span class="post-time small text-muted">21st April 2004 14:36 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">nothing! doesn't work....</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">almoes</span><br><span class="post-time small text-muted">21st April 2004 15:41 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">I know whats going on, but still need some help. The ShellExec is not getting the proper path. If I do<br><br>SetOutPath $PROGRAMFILES\MyFolder\temp<br><br>on a XP client and a win2k client the path remains, but in the server it points to c:!</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Joost Verburg</span><br><span class="post-time small text-muted">21st April 2004 16:31 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Does that folder exist?</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">almoes</span><br><span class="post-time small text-muted">21st April 2004 16:34 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Yes it exists and I checked tones of times the spelling of it. Anyway I tested in another win2k server and works fine. I really wonder what environment thing is different. Anyway, programming a 'cd path' in the batch file it works. Just to let say that there's something that doesn't always behave the same for 'SetOutPath'.</p></div><hr><div class="footer"><p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p></div></div><script type="text/javascript" src="../js/highlight.pack.js" async></script><script type="text/javascript">//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]></script></body></html>