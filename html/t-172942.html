<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="description" content="Another modifed Modern UI with image control"><title>Another modifed Modern UI with image control - NSIS Forums</title><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script><link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css"><link rel="stylesheet" href="../css/style.css" type="text/css"></head><body><div class="container"><ol class="breadcrumb"><li><a href="../index.html" class="glyphicon glyphicon-home"></a></li><li><a href="f-65.html">NSIS Discussion</a></li><li class="active">Another modifed Modern UI with image control</li></ol><p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=172942">Another modifed Modern UI with image control</a></p><br><div class="post"><p class="post-meta"><span class="post-author text-primary">shantanu_gadgil</span><br><span class="post-time small text-muted">11th March 2004 10:14 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>Another modifed Modern UI with image control</strong><br>Hello all !<br><br>Yet another modified ModernUI based on the dimensions of some software (you'll get it from the name :), *PROBABLY* made using WISE classic.<br><br>Thats is not so important, anyway... :)<br><br>How to use the modified UI.<br><br>1. Just download the attached zip.<br>2. Extract the EXE in any directory (preferably "$NSISDIR\Contrib\UIs")<br>3. In your script use the following command:<br><br>---<br>.<br>.<br>.<br>ChangeUI all "${NSISDIR}\Contrib\UIs\modern_eraser.exe"<br>.<br>.<br>.<br>---<br><br>4. If you extract it somewhere else, modify the path to the EXE accordingly.<br>5. That's it ! Enjoy :up:<br><br>=-=-= Question =-=-=<br>I have added an image control (SS_BITMAP) in which the user can keep showing image/images as per his her wish !<br><br>The control ID of the image control is 6666.<br><br>I will be searching the forum...still...could anyone point me to the relevant topic of how to set the image immmediately after the WELCOME page.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">shantanu_gadgil</span><br><span class="post-time small text-muted">11th March 2004 10:38 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>I searched the forums, still... :(</strong><br>I searched the forums, and kept coming up with "custom .onGUIInit function". Would this solve my problem ?<br><br>Please help !<br><br>Thanks.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">evilO</span><br><span class="post-time small text-muted">11th March 2004 11:27 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Hi :)<br><br>Actually this function won't solve your problem as the function .onGUIInit is called *before* the Welcome page's display, and not *after*...<br><br>Unfortunately I don't have the answer to your question :(<br><br>Hope you'll find a way... :D<br><br>evilO/Olive</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Vytautas</span><br><span class="post-time small text-muted">11th March 2004 13:55 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">You should do it in the show function of the next installer page. If you need any help with the right instructions to display the image check out my MUI mod, see the link below.<br><br>Vytautas</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">o_owd</span><br><span class="post-time small text-muted">11th March 2004 14:04 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">where do i have to write that line "changeIU..." ?<br><br>i wrote it in my script and i can't see any diference.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Vytautas</span><br><span class="post-time small text-muted">11th March 2004 14:12 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">It shold be used at the start of the script, before page commands. Also if using MUI you should define MUI_UI rather than use the Change UI setting.<br><br>Vytautas</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">shantanu_gadgil</span><br><span class="post-time small text-muted">11th March 2004 18:27 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>is there a better method</strong><br>after fiddling with many small snippets of codes from many different users I got a working script...<br><br>Please note :D could be a colon followed by a capital 'd'<br>----<br>.<br>.<br>.<br>!include "${NSISDIR}\Include\WinMessages.nsh"<br>.<br>.<br>.<br>!define LR_LOADFROMFILE 0x0010<br>!define LR_LOADREALSIZE 0xF7FF<br>!define LR_CREATEDIBSECTION 0x2000<br>!define STM_SETIMAGE 370<br>!define IMAGE_BITMAP 0<br>!define sysLoadImage "user32::LoadImageA(i, t, i, i, i, i) i"<br>!define sysDeleteObject "gdi32:DeleteObject(i) i"<br>.<br>.<br>.<br><br>!define MUI_CUSTOMFUNCTION_GUIINIT MyCustomFunction<br>!define MUI_CUSTOMFUNCTION_UNGUIINIT un.MyCustomFunction<br><br><br>Function MyCustomFunction<br>Push $0<br>Push $1<br>Push $6<br><br>GetTempFileName $0<br>File /oname=$0 "Setup.bmp"<br><br>GetDlgItem $1 $HWNDPARENT 6666<br><br>System::Call '${sysLoadImage} (0, "$0", ${IMAGE_BITMAP}, 135, 200, ${LR_CREATEDIBSECTION}|${LR_LOADFROMFILE} ) .r6'<br>SendMessage $1 ${STM_SETIMAGE} ${IMAGE_BITMAP} $6<br><br>Pop $6<br>Pop $1<br>Pop $0<br>FunctionEnd<br><br><br>Function un.MyCustomFunction<br>Push $0<br>Push $1<br>Push $6<br><br>GetTempFileName $0<br>File /oname=$0 "Uninstall.bmp"<br><br>GetDlgItem $1 $HWNDPARENT 6666<br><br>System::Call '${sysLoadImage} (0, "$0", ${IMAGE_BITMAP}, 128, 200, ${LR_CREATEDIBSECTION}|${LR_LOADFROMFILE} ) .r6'<br>SendMessage $1 ${STM_SETIMAGE} ${IMAGE_BITMAP} $6<br><br>Pop $6<br>Pop $1<br>Pop $0<br>FunctionEnd<br><br>---<br><br>The approximate size of the bmp should be somewhere around 135x200.<br><br>In the API call we HAVE to specify the dimensions in which we want to display the bmp.<br><br>P.S. aaaarrrgh, Idon't like this :) I actually waded through the macros and made myself understand the custom .onGUIInit macro. Ack !!! :)</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">o_owd</span><br><span class="post-time small text-muted">11th March 2004 18:48 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"></p><blockquote><i>Originally posted by Vytautas</i><br><b>It shold be used at the start of the script, before page commands. Also if using MUI you should define MUI_UI rather than use the Change UI setting.<br><br>Vytautas</b></blockquote>sorry, but it seems that i'm doing something wrong. if i write "ChangeUI ..." - no diference. if i write "!define MUI_UI all 'file.exe'" - i get an error - too many parameters. if i write "!define MUI_UI 'file.exe'" - the size of the installer is the same, only some controls are smaller.<br><br>i wrote the line before page commands. i am using NSIS v2.0 and modern UI.<br><br>thanks.</div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Vytautas</span><br><span class="post-time small text-muted">11th March 2004 22:17 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">I use this command and it works for me, in my MUI mod.<br><br></p><pre>
<code>!define MUI_UI "${NSISDIR}\Contrib\UIs\modern_instpic.exe"</code>
</pre>Are you sure that the installer is supposed to look very different?<br><br>Vytautas<br><br>PS. BTW Which page are you trying to display the image in?</div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">shantanu_gadgil</span><br><span class="post-time small text-muted">14th March 2004 20:07 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>full (sample) working script</strong><br>The attached script is a sample full working script. :)<br><br>Please change the BMP and ICON paths for your system. :)<br><br>Most of the script is half-cooked, anyway...tell me if you run into any problems.<br>- Enjoy</p></div><hr><div class="footer"><p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p></div></div><script src="../js/highlight.pack.js" type="text/javascript"></script><script type="text/javascript">//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]></script></body></html>