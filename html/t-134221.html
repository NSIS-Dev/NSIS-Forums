<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="Help needed" />

  <title>Help needed - NSIS Forums</title><!-- Bootstrap core CSS -->
  <link rel="stylesheet" type="text/css" href="//netdna.bootstrapcdn.com/bootswatch/3.0.1/readable/bootstrap.min.css" />
  <link rel="stylesheet" href="../css/style.css" type="text/css" /><!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!--[if lt IE 9]>
                <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
                <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->
</head>

<body>
  <div class="container">
    <!-- Put navigation bar here -->

    <ol class="breadcrumb">
      <li><a href="../index.html" class="glyphicon glyphicon-home"></a></li>

      <li><a href="f-65.html">NSIS Discussion</a></li>

      <li class="active">Help needed</li>
    </ol>

    <p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=134221">Help needed</a></p><br />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">blazer1504</span><br />
      <span class="post-time small text-muted">4th May 2003 09:47 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>Help needed</strong><br />
      I'm having little trouble with my install script and I'm wishing that maybe some of you guys could help me with this:<br />
      <br />
      Okay, what I'm trying to do here is to detect winamp2 to $1 and Winamp3 to $2<br />
      <br />
      ReadRegStr $1 HKLM \<br />
      "Software\Microsoft\Windows\CurrentVersion\Uninstall\Winamp" \<br />
      "UninstallString"<br />
      <br />
      ReadRegStr $2 HKLM \<br />
      "Software\Microsoft\Windows\CurrentVersion\Uninstall\Winamp3" \<br />
      "UninstallString"<br />
      <br />
      These sets wa2 (if exists) to $1 &amp; wa3 (if exists) to $2, right.<br />
      because we get the path in file format (...\winamp(3)\uninstall.exe) I need to get that file stripped, and here's where I have problems.<br />
      <br />
      With what function I could erase the letter from both, $1 &amp; $2, one by one until the last letter would be different ?<br />
      <br />
      Or with what function, I could erase letter from both , $1 &amp; $2, one by one until the first ' \ ' mark comes ?</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Yathosho</span><br />
      <span class="post-time small text-muted">4th May 2003 10:59 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">hey,<br />
      <br />
      there's a script in the <a href="http://forums.winamp.com/showthread.php?threadid=106373" target="_blank">avs forum</a>, just have a look at the StripPath Function from EL-VIS. i can also offer you my avscript (version 3 out soon), will talk to you on #finnish-flash about that :D</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
      <span class="post-time small text-muted">4th May 2003 14:10 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Use GetFileName here:<br />
      <a href="http://nsis.sourceforge.net/archive/nsisweb.php?page=221&amp;instances=0,11,211" target="_blank">http://nsis.sourceforge.net/archive/...ances=0,11,211</a><br />
      <br />
      That will get the uninstall.exe part, whether it is uninstall.exe or not.<br />
      <br />
      -Stu</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Joel</span><br />
      <span class="post-time small text-muted">4th May 2003 16:41 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">I'll be cool as feature to create variables to detect Winamp 2<br />
      and Winamp 3.<br />
      For example:<br />
      $INSTDIR means the installation directory, right?<br />
      So<br /></p>
      <pre>
<code><br />$WINAMP2 'will be the path for Winamp 2.x installation <br />$WINAMP3 'will be the path for Winamp 3.x installation<br /></code>
</pre>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Joost Verburg</span><br />
      <span class="post-time small text-muted">5th May 2003 14:13 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">You can detect it using a function, so that won't be addded (it will increase the overhead).</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">blazer1504</span><br />
      <span class="post-time small text-muted">6th May 2003 10:23 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"></p>

      <blockquote>
        there's a script in the avs forum, just have a look at the StripPath Function from EL-VIS. i can also offer you my avscript (version 3 out soon), will talk to you on #finnish-flash about that
      </blockquote>The el-vis is little oldish since it's designed for Nsis1 and I couldn't get that Jheriko's script work with me (maybe I have too old version of NSIS2) and besides I like to do things by myself, so..<br />
      <br />
      It's still not clear to me how the stripping does work, with what function I can erase for example 9 last letters from the path ?
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Joost Verburg</span><br />
      <span class="post-time small text-muted">6th May 2003 12:36 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">StrCpy supports negative values for the lenght (so you can cut off chars).</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">blazer1504</span><br />
      <span class="post-time small text-muted">7th May 2003 10:11 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">okay let's imagine that $1 would point to C:/something/word.exe<br />
      Let's say that I'd like to get the file out and copy it to $2, would this work?<br />
      <br />
      StrCpy $2 $1 -8<br />
      <br />
      or is it more complicate than that?</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Joost Verburg</span><br />
      <span class="post-time small text-muted">7th May 2003 10:31 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Use start_offset, not maxlen.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">blazer1504</span><br />
      <span class="post-time small text-muted">8th May 2003 09:55 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">um....<br />
      <br />
      /me is confused. me don't understand<br />
      <br />
      Please give me example how it works, and maybe I'll figure it out then..:rolleyes:</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Sunjammer</span><br />
      <span class="post-time small text-muted">8th May 2003 10:34 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">What Joost is saying relates to the documentation for <a href="file:///C:/src/cvs_nsis/NSIS/Docs/Chapter4.html#4.9.8.1" target="_blank">StrCpy</a>. The syntax is</p>
      <pre>
<code>user_var(destination) str [maxlen] [start_offset]</code>
</pre>so he is saying you need to make use of the start_offset parameter and not the maxlen parameter. This is because in your example rather than getting the file you'd actually get the path, e.g. 'C:/something/' instead of 'word.exe'.<br />
      <br />
      You need to do :-
      <pre>
<code>StrLen $3 $1 ; how long is our string?<br />IntOp $4 $3 - 8 ; where do we start copying?<br />StrCpy $2 $1 $3 $4 ; copy $3 amount of characters from position $4 in string $1 into string $2</code>
</pre><br />
      One thing I realised working this out is that you can't do this :-
      <pre>
<code>StrCpy $2 $1 0 13</code>
</pre>i.e. I was trying to say copy all characters from position 13, bit of a shame that.
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">blazer1504</span><br />
      <span class="post-time small text-muted">8th May 2003 11:30 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">That makes sense, thanks man , I really appreciate :)</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">pengyou</span><br />
      <span class="post-time small text-muted">8th May 2003 16:04 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Try this to copy all characters from position 13:<br /></p>
      <pre>
<code><br />StrCpy $2 $1 "" 13<br /></code>
</pre>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">blazer1504</span><br />
      <span class="post-time small text-muted">8th May 2003 19:49 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Function stripwa2<br />
      StrLen $3 $1<br />
      IntOp $4 $3 - 13<br />
      StrCpy $2 $1 $3 $4<br />
      functionEnd<br />
      <br />
      I tried this like you told (used $2 in SetOutPath) but it gave me the file ( uninst.exe\plugins\blahblah ) that's what I wanted to <b>cut off</b> from the path :rolleyes:<br />
      <br />
      I'm sure, you can easily change that by changing some positions of $1-$4 but after trying to figure it out long enough, I thought to leave it to you smarter guys ;)</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">pengyou</span><br />
      <span class="post-time small text-muted">8th May 2003 20:35 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">If I understand the problem correctly, the uninstall string from the registry for Winamp2 looks like this:<br />
      <br /></p>
      <pre>
<code>"x:\blah blah blah\winamp.exe" /UNINSTALL</code>
</pre><br />
      <br />
      and you want to extract just the<br />
      <pre>
<code>x:\blah blah blah\</code>
</pre>part of the string.<br />
      <br />
      One way to do this is to cut off the last 22 characters and cut off the first character ("), as follows:<br />
      <br />
      <pre>
<code><br />; $1 holds "x:\blah blah blah\winamp.exe" /UNINSTALL<br />; Now cut off the last 22 characters (i.e. cut off winamp.exe" /UNINSTALL)<br /><br />StrCpy $1 $1 -22<br /><br />; Now $1 =  "x:\blah blah blah\<br /><br />StrCpy $1 $1 "" 1 <br /><br />; Now $1 = x:\blah blah blah\<br /></code>
</pre><br />
      <br />
      If the Winamp3 uninstall string is "x:\blah blah blah\winamp3.exe" /UNINSTALL then you have to cut off 23 characters instead of 22.<br />
      <br />
      Hope this helps.
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
      <span class="post-time small text-muted">8th May 2003 20:58 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">I see that there are no "\" characters until you reach "x:\blah blah blah\" in the string.<br />
      You can therefore use the GetParent function (on the NSIS Archive) and then use my GetFileName function after that.<br />
      <br />
      -Stu</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">blazer1504</span><br />
      <span class="post-time small text-muted">9th May 2003 13:56 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">ok, now it works perfect !<br />
      <br />
      Thanks again guys ! :)</p>
    </div>
    <hr />

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]>
  </script>
</body>
</html>
