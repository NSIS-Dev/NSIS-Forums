<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="blocking options in uninstaller" />

  <title>blocking options in uninstaller - NSIS Forums</title>
  <script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script>
  <!-- Bootstrap core CSS -->

  <link rel="stylesheet" type="text/css" href="//netdna.bootstrapcdn.com/bootswatch/3.0.1/readable/bootstrap.min.css" />
  <link rel="stylesheet" href="../css/style.css" type="text/css" /><!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!--[if lt IE 9]>
                <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
                <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->
</head>

<body>
  <div class="container">
    <!-- Put navigation bar here -->

    <ol class="breadcrumb">
      <li><a href="../index.html" class="glyphicon glyphicon-home"></a></li>

      <li><a href="f-65.html">NSIS Discussion</a></li>

      <li class="active">blocking options in uninstaller</li>
    </ol>

    <p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=223429">blocking options in uninstaller</a></p><br />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">slickgoonie</span><br />
      <span class="post-time small text-muted">5th August 2005 21:56 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>blocking options in uninstaller</strong><br />
      Hi:<br />
      <br />
      Here is what i would like to do:<br />
      <br />
      I have 3 sections, a, b, c. In the uninstaller the user have the options to remove option, a, b or c...so what i would like to have is that whenever the user removes option a, and run the uninstaller again...option a should be marked as deleted so only b and c will appear. Same as if in the installer he only choose to install option a, when running the uninstaller option a should be the only one available to uninstall.<br />
      <br />
      Last, the uninstall.exe sits on the root directory(where folder a, b, c are) so whenever the user uninstall the last section and there is nothing else to uninstall, it should remove the uninstall.exe from the root directory as well.<br />
      <br />
      thanks.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">JasonFriday13</span><br />
      <span class="post-time small text-muted">6th August 2005 03:26 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Yeah, I was also wondering why this has not been a feature. But then again the original installer does the same job (I think).</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
      <span class="post-time small text-muted">6th August 2005 08:35 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Write some values to registry specifying what's left and act accordingly in the uninstaller. To hide sections, use the macros in Include\Sections.nsh.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">slickgoonie</span><br />
      <span class="post-time small text-muted">22nd August 2005 19:33 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>hidding secitions in uninstaller.</strong><br />
      Can you give me an example of how to hide sections in the unistaller??<br />
      <br />
      thanks.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
      <span class="post-time small text-muted">22nd August 2005 23:20 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Section "un.A Section" unSec01<br />
      ...<br />
      SectionEnd<br />
      <br />
      Function un.onInit<br />
      !insertmacro UnselectSection ${unSec01}<br />
      FunctionEnd<br />
      <br />
      -Stu</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">slickgoonie</span><br />
      <span class="post-time small text-muted">23rd August 2005 01:37 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">First of all. Thanks for all your help! It seems that I'm not getting what I wanna do tho. The piece of code you provided me only unchecked the option, but it doesn't hide it or block it(so the user cant select it again), so is there any way I can do that?<br />
      <br />
      Also, How do can I keep tracking of what the user has installed/uninstalled and what not?? Using comparing with the registry? how can that be done??<br />
      <br />
      Thanks.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
      <span class="post-time small text-muted">23rd August 2005 10:39 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Function un.onInit<br />
      SectionSetText ${unSec01} ""<br />
      FunctionEnd<br />
      <br />
      Edit: As for your second question, use WriteRegStr in each section of your installer, e.g.<br />
      WriteRegStr HKLM "Software\myApp\Installed" "A" "1"<br />
      <br />
      Then in un.onInit:<br /></p>
      <pre>
<code>Function un.onInit<br />Push $R0<br /><br /> ReadRegStr $R0 HKLM "Software\myApp\Installed" "A"<br /> StrCmp $R0 1 +2<br /> SectionSetText ${unSec01} ""<br /><br /> ReadRegStr $R0 HKLM "Software\myApp\Installed" "B"<br /> StrCmp $R0 1 +2<br /> SectionSetText ${unSec02} ""<br /><br /> ...etc...<br /><br />Pop $R0<br />FunctionEnd</code>
</pre><br />
      -Stu
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">slickgoonie</span><br />
      <span class="post-time small text-muted">23rd August 2005 23:31 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Thanks, it works!</p>
    </div>
    <hr />

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]>
  </script>
</body>
</html>
