<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="Install not complete, but no errors." />

  <title>Install not complete, but no errors. - NSIS Forums</title><!-- Bootstrap core CSS -->
  <link rel="stylesheet" type="text/css" href="//netdna.bootstrapcdn.com/bootswatch/3.0.1/readable/bootstrap.min.css" />
  <link rel="stylesheet" href="../css/style.css" type="text/css" /><!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!--[if lt IE 9]>
                <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
                <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content=" Install not complete, but no errors." />

  <title>Install not complete, but no errors. - NSIS Forums</title>
  <link rel="stylesheet" type="text/css" href="//netdna.bootstrapcdn.com/bootswatch/3.0.1/readable/bootstrap.min.css" />
  <link rel="stylesheet" href="../css/style.css" type="text/css" />
</head>

<body>
  <div class="container">
    <!-- Put navigation bar here -->

    <ol class="breadcrumb">
      <li><a href="../index.html" class="glyphicon glyphicon-home"></a></li>

      <li><a href="f-65.html">NSIS Discussion</a></li>

      <li class="active">Install not complete, but no errors.</li>
    </ol>

    <p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=251631">Install not complete, but no errors.</a></p><br />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">chrisofnine</span><br />
      <span class="post-time small text-muted">21st July 2006 16:46 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>Install not complete, but no errors.</strong><br />
      When I run the installer from internet explorer (a link to it), the installer runs with no errors, then flys through it in like 10 seconds. When you check the directory the file was created where it should be, but none of the files inside of it are created. If you run the installer directly from the file, it works perfectly and installs everything. Could this be an option in Internet Explorer that is causing it to bug out? (This does not happen on all computers)</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
      <span class="post-time small text-muted">22nd July 2006 10:11 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Not much can be said without the script, but it seems like you're missing SetOutPath.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">chrisofnine</span><br />
      <span class="post-time small text-muted">22nd July 2006 17:07 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">No it can't be the script, because it works perfectly every time when you run it straight off the file, and on most computers it runs perfectly off the browser link too, it's just certain computer's it's doing that.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
      <span class="post-time small text-muted">22nd July 2006 17:09 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Still, I can't say much without knowing what's happening...</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">chrisofnine</span><br />
      <span class="post-time small text-muted">24th July 2006 14:38 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">...I explained what's happening. When you choose the directory to install it and continue with the install, it fly's right through it in 5 seconds and only creates the main folder. It does not actually install any files. Like I said though, on the same computers that are having trouble, if you go and run the install directly from the file itself (by double clicking on the exe) then it will install everything properly. I initially assumed that this was some sort of option with internet explorer causing this? Or what could it be?</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">chrisofnine</span><br />
      <span class="post-time small text-muted">24th July 2006 14:59 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Another way to put this, would be that if you choose to "Open" the exe file on the install, it doesn't work. When you choose to "Save" the exe file and run that, it works...</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
      <span class="post-time small text-muted">24th July 2006 18:30 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">There aren't enough details. I can't reproduce this problem and no one else has reported it. I can't help you without an example reproducing the problem. It doesn't have to be your exact script, as long as it shows the problem.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">chrisofnine</span><br />
      <span class="post-time small text-muted">24th July 2006 18:38 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Like I said though, I can't even make a script that would produce the problem whenever I wanted. It only happens on some computers. Even if I gave you the script to look at, it would work perfectly. I've had people look at the script and have tested it many times.<br />
      I'm not trying to be an ass or anything, I'm just saying I'm positive it's not the script, and was wondering if anyone else had experienced something similar or knew what it could be. I do appreciate your help though.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
      <span class="post-time small text-muted">24th July 2006 19:17 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Fine, be it your way. But I'll guess only once. Make sure no anti-virus/anti-spyware/anti-malware/anti-whatever is blocking the installer, make sure SetOutPath is set properly, make sure SetOverwrite is set properly, check the extraction log and <a href="http://nsis.sourceforge.net/Special_Builds" target="_blank">install.log</a>.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">chrisofnine</span><br />
      <span class="post-time small text-muted">24th July 2006 20:01 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">If I can send you my script I totally will, I'm not keeping that from you - another set of eyes never hurts! What email can I send it to?</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
      <span class="post-time small text-muted">24th July 2006 20:23 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><a href="http://nsis.sourceforge.net/Contact" target="_blank">kichik@users.sf.net</a>.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
      <span class="post-time small text-muted">25th July 2006 23:22 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Your script uses CopyFiles from $EXEDIR to $INSTDIR. $EXEDIR is Internet Explorer's cache folder when you use the "Open" button. Use File instead.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">chrisofnine</span><br />
      <span class="post-time small text-muted">26th July 2006 14:32 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">So just replace CopyFiles with File everywhere?<br />
      <br />
      And how come it works fine on some computers if this is the problem?</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
      <span class="post-time small text-muted">26th July 2006 15:26 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">CopyFiles copies files from one folder on the users' machine to another folder on the users' machine. CopyFiles does not include the actual files in your installer. File on the other hand puts the files into the install executable and compresses them if need be.<br />
      <br />
      If it works on some machines then perhaps those machines have the files to be installed with the setup executable (not actually inside the executable).<br />
      <br />
      -Stu</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">chrisofnine</span><br />
      <span class="post-time small text-muted">26th July 2006 21:57 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Well I used CopyFiles because I have very limited space on the DVD this is going on. I don't have the free space to have all the files inside the installer itself!<br />
      If I'm looking at this the wrong way, can you show me an example?<br />
      Thanks a bunch.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
      <span class="post-time small text-muted">26th July 2006 22:40 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">I don't understand now lol<br />
      You can't fit the files on the DVD if they're all in the installer in compressed format, but you have enough space if you have them outside the installer uncompressed?<br />
      <br />
      -Stu</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">JoeMcC00L</span><br />
      <span class="post-time small text-muted">26th July 2006 23:27 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">I have used both CopyFile and File when writing an installer. Here are some examples that might be helpful:<br />
      <br />
      SetOutPath $INSTDIR<br />
      File ./foo.bar<br />
      # This tells the NSIS compiler to look for foo.bar and<br />
      # compress it into the installer. If you have your<br />
      # installer executable on the CD, you DO NOT need to package<br />
      # foo.bar separately. When your executalbe is run on the<br />
      # end user's machine, foo.bar is extracted and placed in<br />
      # $INSTDIR<br />
      <br />
      CopyFiles $EXEDIR/foo.bar $INSTDIR<br />
      # This tells the compiler that when the installer is run,<br />
      # there will be a file called foo.bar in $EXEDIR, or in<br />
      # your case the DVD you're putting the installer on. When<br />
      # you use CopyFiles, the compiler DOES NOT compress foo.bar<br />
      # into the executable, and you have to supply foo.bar<br />
      # separately. In our example, it will copy foo.bar to<br />
      # $INSTDIR only if foo.bar is a separate file and it<br />
      # resides in the same directory as your installer<br />
      <br />
      So if you have space limitations, it would be wise to use "File" whenever you can in your installer. This will compress all your files into one executable. If you want a third pair of eyes to look at your script, send it to:<br />
      <br />
      <a href="mailto:joe.jmcc00l@gmail.com">joe.jmcc00l@gmail.com</a><br />
      <br />
      Hope this helps!<br />
      Joe</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
      <span class="post-time small text-muted">27th July 2006 00:08 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">And always use back strokes "\" and not forward strokes "/" in Windows paths :p<br />
      <br />
      -Stu</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">JoeMcC00L</span><br />
      <span class="post-time small text-muted">27th July 2006 15:42 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">heh, my mistake. :D</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">chrisofnine</span><br />
      <span class="post-time small text-muted">27th July 2006 16:21 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Didn't explain myself fully - caused a bit of confusion!<br />
      The reason I can't compress all the files into the installer is because I need the option to run the files directly off the DVD as well without the install! (on insertion of the DVD, a page comes up asking if they would like to install or if they would like to run straight off the DVD). Not all the user's have permission at all times to install, so this is why it has to be set up that way.<br />
      <br />
      I emailed you the script as well McC00L. Have a look!<br />
      <br />
      I'm starting to get very confused now too though. Will CopyFiles work for my situation? If so, what's the problem, and if not, what are my alt. options?<br />
      <br />
      Thanks very much for your guys' help! Much appreciated.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Comperio</span><br />
      <span class="post-time small text-muted">27th July 2006 17:30 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Based on your last post, it sounds to me as if you need 2 versions of the install. One that you download as a single file and another that you distribute on DVD. (Or maybe you just pack the full install into one compressed file, such as an ISO image, zip file, etc.)<br />
      <br />
      Another thought would be to somehow detect whether or not the install was run from a DVD or from the internet. If it were an internet install, then you would download just the main setup program which would then run and download the rest of the files (perhaps to users TEMP folder). Once the full set of files is downloaded, then it could then continue with the install using the CopyFiles command--only this time, you'd copy from the user's TEMP folder instead of $EXEDIR). To accomplish this, you'd probably want to use a plugin such as InetLoad (search the wiki/forums for more info.)<br />
      <br />
      The bottom line here is that you can't copy files from the $EXEDIR when you are running directly from the browser for reasons Kichik mentioned earlier in this post.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">chrisofnine</span><br />
      <span class="post-time small text-muted">27th July 2006 18:36 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">This won't be put online anywhere, only distributed on the DVD.<br />
      <br />
      And I'm not really clear as to Kichik's explanation of why CopyFiles doesn't work...like I said before - it works on some computers! (mine for example) That's why I'm so confused that your saying it's the CopyFiles command causing the problem. Unless it's a setting on certain computers for creating temp files or anything like that?</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
      <span class="post-time small text-muted">27th July 2006 18:39 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Have the installer show you $EXEDIR when it's running and it'll all be clear. Use:</p>
      <pre>
<code>Function .onInit<br />  MessageBox MB_OK $$EXEDIR=$EXEDIR<br />FunctionEnd</code>
</pre>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">chrisofnine</span><br />
      <span class="post-time small text-muted">27th July 2006 20:13 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">On my computer it returns "D:" (which is my DVD drive) and it works.<br />
      Why would it show anything else?</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
      <span class="post-time small text-muted">27th July 2006 20:42 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Because when you open it from Internet Explorer using the Open button, it first "downloads" the file to the cache folder and then runs the file from there. You cannot use $EXEDIR unless you're running the installer from the DVD itself.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">chrisofnine</span><br />
      <span class="post-time small text-muted">27th July 2006 21:24 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">I really don't mean to be the devil's advocate here or anything, but I did run it in IE and pressed the Open button.<br />
      <br />
      Here's my steps (just trying to make sure we're on the same page!):<br />
      1. Put in the DVD. It autoruns, and the first page comes up with a disclaimer on an htm file that I made.<br />
      2. Agree to that, and you are taken to a new htm page that asks if you would like to install the files to your hard drive (recommended) or if you would like to view them straight off the DVD. Clicked Install.<br />
      3. A popup appears asking to Open the file, or Save it to my computer. I choose to Open the file.<br />
      4. The install continues through...choose the files...choose the directory...and it installs everything perfectly to my computer.<br />
      <br />
      I did this with that hunk of code you posted and it displayed D: like it should as the $EXEDIR.<br />
      <br />
      I totally understand what you mean now that IE downloads a temp file and runs it off that. Couple questions for that:<br />
      1. Why is it not doing it on my computer?<br />
      2. Do all browsers do this?<br />
      <br />
      A couple specific Q's:<br />
      1. Is this problem a setting on the user's computer that I can just tell them to make sure they have "______" checked off under their IE properties? Then the CopyFiles command should still work.<br />
      2. If this is a continuing and permanent problem, is using 'File' my only alternative? As I said before, this MUST have the option of install or no install, so I don't have room to include all the files in the installer.<br />
      3. Perhaps is there an alternative to using '$EXEDIR'? Can the installer figure out what the user's DVD drive is and use that? Or could the user possibly enter their DVD drive letter and that would be stored and used?<br />
      <br />
      Again, I can't thank you guys enough for your help and patience!!!</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
      <span class="post-time small text-muted">27th July 2006 21:29 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">It depends on Internet Explorer's setting. I'm not sure exactly which one changes that, probably something zone related. But I'd say having the user change Internet Explorer's setting in order to install your application is a bit off-track.<br />
      <br />
      What you should do is simply not use an HTML page and use the built-in license page or your own custom program. If you want to add formatting to the license, you can use RTF instead of plain text.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">chrisofnine</span><br />
      <span class="post-time small text-muted">28th July 2006 14:32 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">As for my first question (IE setting) which is the only one that was answered, I meant that I've already distributed some copies to people, so if they contact me with this problem, can I just tell them to check off _____ IE property.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
      <span class="post-time small text-muted">28th July 2006 14:35 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Have them execute the installer manually.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">chrisofnine</span><br />
      <span class="post-time small text-muted">28th July 2006 21:51 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">I understand the problem fully now. Stoooopid IE!!<br />
      Still hazy on the fix though...would appreciate the following answered!<br />
      <br />
      1. Do all browsers do this?<br />
      <br />
      2. Is using 'File' my only alternative? As I said before, this MUST have the option of install or no install, so I don't have room to include all the files in the installer.<br />
      <br />
      3. Perhaps is there an alternative to using '$EXEDIR'? Can the installer figure out what the user's DVD drive is and use that? Or could the user possibly enter their DVD drive letter and that would be stored and used?<br />
      <br />
      Thanks a bunch for stickin around kichik - appreciate the help!</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">stb</span><br />
      <span class="post-time small text-muted">28th July 2006 22:48 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">@1: I wouldn't rely on the browsers behaviour. If the user "downloads" and starts a file you link to in a html page, you can't rely on EXEDIR or current dir. I don't think this is a problem of IE (if you download the file from remote machines (http), you can't have EXEDIR the same as the html file).<br />
      <br />
      @2: No. Avoid using html pages with links to your installer or avoid separating installer and install data.<br />
      <br />
      @3: Yes. Yes. Yes. (You're free to do this.) I don't think this way is the smart one (see 2. or kichik's last two comments).</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
      <span class="post-time small text-muted">28th July 2006 23:44 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">You shouldn't search for the correct DVD as you can't make sure you've found the right one and because it wouldn't work in case someone copies over the setup files.<br />
      <br />
      As stb said and as I said a couple of posts ago, you should not use HTML in a browser and except a specific behavior. Use your own program to display the license, or the license page of NSIS itself.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">chrisofnine</span><br />
      <span class="post-time small text-muted">31st July 2006 14:33 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Alright cool, thank's very much for your help everyone!</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">chrisofnine</span><br />
      <span class="post-time small text-muted">31st July 2006 16:43 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Stb, how would implementing #3 work? (Having the installer run off the DVD drive instead of $EXEDIR)<br />
      I do understand what you and kichik are saying about displaying the installer differently, but the options I have to work with for this specific DVD are very limited, so I need some workable work-arounds! If you could kindly walk me through how this setup would work that would be wicked!<br />
      (Like I said, including the files in the installer is out of the question, and opening the installer seperatly is sorta out of the question, so this seems like the best alternative by far!?)</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">stb</span><br />
      <span class="post-time small text-muted">31st July 2006 17:03 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">@chrisofnine: Sorry, I will not code this for you (for free). Exchanging new ideas, great code and problem solutions in this forum is at a nice social level -- but IMHO this is beyond that. If you want to have something done for free, you'll need a "better" problem (with some advantage for others).</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
      <span class="post-time small text-muted">31st July 2006 17:12 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">I wrote this script a while ago to allow you to run an installer off multiple CDs/DVDs:<br />
      <br /></p>
      <pre>
<code><br />!define OutFile "setup.exe"<br />!define TempCD  "$TEMP\tempCD.tmp"<br />OutFile "${OutFile}"<br /><br />Var CDDRIVE<br /><br />Function .oninit<br />  IfFileExists "${TempCD}" fromHD<br /><br />   CopyFiles "$EXEDIR\${OutFile}" "$TEMP"<br />   WriteINIStr "${TempCD}" "CD" "Drive" "$EXEDIR"<br /><br />   Exec "$TEMP\${OutFile}"<br />   Abort<br /><br />  fromHD:<br />   ReadINIStr $CDDRIVE "${TempCD}" "CD" "Drive"<br />   Delete "${TempCD}"<br /><br />FunctionEnd<br /></code>
</pre><br />
      <br />
      -Stu
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">chrisofnine</span><br />
      <span class="post-time small text-muted">31st July 2006 22:54 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">...I'm not asking for the code to be written for me...I'm just asking how it's done! Anyone who doesn't have a stick up their butt want to help me out?!!<br />
      <br />
      Stu - thanks for that, my next step will be to jump to a 2 DVD install definatly - that will come in handy! For this version however I really need to keep it on 1. That's why I was looking for the alternative to '$EXEDIR'.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
      <span class="post-time small text-muted">31st July 2006 23:00 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">What would you need an alternative to $EXEDIR for? Would that be to identify which drive the DVD is in if the installer is run from another location?<br />
      <br />
      Like kichik said, there's no way. All I can suggest is you don't let the setup executable run if the files that are needed aren't in $EXEDIR\*whatever*.<br />
      <br />
      Another solution would be to write $EXEDIR to the registry when the DVD is inserted with autorun, but not all PC's have autorun enabled ;)<br />
      <br />
      -Stu</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">chrisofnine</span><br />
      <span class="post-time small text-muted">3rd August 2006 15:28 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Ya if I could just put the DVD Drive instead of $EXEDIR, then it would work every time...instead of IE making the temp file and running it from there.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">fistos</span><br />
      <span class="post-time small text-muted">3rd August 2006 16:25 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">*Post Deleted*</p>
    </div>
    <hr />
    <!-- Bootstrap core CSS -->
    <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
                <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
                <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->

    <div class="container">
      <!-- Put navigation bar here -->

      <ol class="breadcrumb">
        <li><a href="../index.html" class="glyphicon glyphicon-home"></a></li>

        <li><a href="f-65.html">NSIS Discussion</a></li>

        <li class="active">Install not complete, but no errors.</li>
      </ol>

      <p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=251631">Install not complete, but no errors.</a></p><br />

      <div class="post">
        <p class="post-meta"><span class="post-author text-primary">Comperio</span><br />
        <span class="post-time small text-muted">5th August 2006 17:48 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

        <p class="post-content">One alternative to your dilema might be to build the HTML page on the fly on the user's local drive (say in the TEMP folder or other directory).<br />
        <br />
        Have a separate EXE do the work (like say "launch.exe"). This would allow you to edit the main HTML file during launch to basically "hard code" the link path to the exact directory on the DVD drive.<br />
        <br />
        The 2 challenges that I see:</p>

        <ol style="list-style-type: decimal">
          <li>you may have to re-code your HTML to deal with other links, such as graphics files, that might be present. (To make it easier, you might want to just extract the entire folder tree to a temp file so that the only thing you'd have to change is the path to the EXE link.)<br /></li>

          <li>You might want to somehow clean up the user's temp area when they are done with the install. (I haven't really thought much about the best way to do that.)</li>
        </ol>
      </div>
      <hr />

      <div class="post">
        <p class="post-meta"><span class="post-author text-primary">chrisofnine</span><br />
        <span class="post-time small text-muted">8th August 2006 15:20 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

        <p class="post-content">I think I understand where you're going Comperio, but how would you hard code the path to the DVD drive when launch.exe is executed?<br />
        I don't think this will be a feasable fix though, because as I said there must be the option to not install anything and run it right off the DVD, as some user's will have totally locked down computers.</p>
      </div>
      <hr />

      <div class="post">
        <p class="post-meta"><span class="post-author text-primary">Comperio</span><br />
        <span class="post-time small text-muted">8th August 2006 17:46 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

        <p class="post-content">The paths would be "hard coded" in the fact that launch.exe would determine which drive it's running from and then modify the temp HTML file to refelect the full path (instead of a relative one).<br />
        <br />
        Users could still browse the CD and run from there. (The only thing that this would change is the "front end" or the HTML page. The actual setup and the other files would remain unchanged.)<br />
        <br />
        And becuase it's only the setup.exe file that seems to be causing the issue, you might be able to still run the HTML file off the CD, but just disable the link to install. (or omit it completely and let LAUNCH.EXE create the link on the fly.)<br />
        <br />
        All these are just suggestions for you to try.</p>
      </div>
      <hr />

      <div class="post">
        <p class="post-meta"><span class="post-author text-primary">chrisofnine</span><br />
        <span class="post-time small text-muted">9th August 2006 22:29 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

        <p class="post-content">I don't really understand how this works around the initial problem though, because what's stopping IE or any browser from creating that same file and running the install from there?</p>
      </div>
      <hr />

      <div class="post">
        <p class="post-meta"><span class="post-author text-primary">stb</span><br />
        <span class="post-time small text-muted">9th August 2006 23:32 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

        <p class="post-content">Nothing. You can't stop IE from creating some downloaded file within TEMP or elsewere.<br />
        <br />
        I think you basically have three choices:<br />
        <br />
        1) bad design: try to detect DVD/CD drive with data files. Maybe this will not work for all users (reminds me about some PC games about 10 years ago). If you really want to do this, search for "detect CD drive" or something like that.<br />
        <br />
        2) complicated design: Comperio's idea was that you start some "launch.exe"-Installer that helps your real installer to detect the CD drive. There may be problems, anyway. Maybe you need to set some registry key or environment variable to your data source (i.e. DVD drive letter).<br />
        <br />
        3) clean design: create some setup.exe/autorun.exe/launch.exe directly on the DVD. This exe can be created with NSIS and some features to not install anything (e.g. just run from DVD). NSIS installers can do everything. It's up to you.</p>
      </div>
      <hr />

      <div class="post">
        <p class="post-meta"><span class="post-author text-primary">chrisofnine</span><br />
        <span class="post-time small text-muted">11th August 2006 18:01 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

        <p class="post-content">Thanks very much stb. Cleared it up!</p>
      </div>
      <hr />

      <div class="footer">
        <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
      </div>
    </div><script src="../js/highlight.pack.js" type="text/javascript">
</script> <script type="text/javascript">
//<![CDATA[
    hljs.initHighlightingOnLoad();
    //]]>
    </script>
  </div>
</body>
</html>
