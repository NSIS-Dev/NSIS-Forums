<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="description" content="scons install on Linux"><title>scons install on Linux - NSIS Forums</title><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script><link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css"><link rel="stylesheet" href="../css/style.css" type="text/css"><!--[if lt IE 9]><script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script><script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script><![endif]--></head><body><div class="container"><ol class="breadcrumb"><li><a href="../index.html" class="glyphicon glyphicon-home"></a></li><li><a href="f-65.html">NSIS Discussion</a></li><li class="active">scons install on Linux</li></ol><p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=266976">scons install on Linux</a></p><br><div class="post"><p class="post-meta"><span class="post-author text-primary">cch1</span><br><span class="post-time small text-muted">2nd March 2007 21:59 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>scons install on Linux</strong><br>After reading the available documentation, I have been able to build makensis on Linux (Fedora Core 5). I have confirmed that makensis runs and correctly builds an installer when makensis is copied to the distribution zip directory structure.<br><br>BUT, I cannot install the results of the build. If I do a "scons install", here is what I get:<br><br></p><blockquote><font size="1"><br>scons: done reading SConscript files.<br>scons: Building targets ...<br>gcc -o build/release/stub_bzip2/bgbg.o -c -Os -Wall -x c -fno-strict-aliasing -DEXEHEAD -DWIN32_LEAN_AND_MEAN -D_WIN32_IE=0x0500 -DNSIS_COMPRESS_USE_BZIP2 Source/exehead/bgbg.c<br>In file included from Source/exehead/bgbg.c:21:<br>Source/exehead/state.h:34: error: expected '=', ',', ';', 'asm' or '__attribute__' before 'g_hwnd'<br>Source/exehead/state.h:36: error: expected '=', ',', ';', 'asm' or '__attribute__' before 'insthwnd'<br>In file included from Source/exehead/bgbg.c:22:<br>Source/exehead/ui.h:28: error: expected '=', ',', ';', 'asm' or '__attribute__' before 'm_curwnd'<br>In file included from Source/exehead/bgbg.c:23:<br>Source/exehead/util.h:19:20: error: shlobj.h: No such file or directory<br>In file included from Source/exehead/bgbg.c:23:<br>Source/exehead/util.h:33: error: expected '=', ',', ';', 'asm' or '__attribute__' before '*' token<br>Source/exehead/util.h:35: error: expected ')' before 'idl'<br>Source/exehead/util.h:39: error: expected ')' before 'dlg'<br>Source/exehead/util.h:91: error: expected ')' before 'pszExisting'<br>Source/exehead/bgbg.c:30: error: expected '=', ',', ';', 'asm' or '__attribute__' before 'CALLBACK'<br>scons: *** [build/release/stub_bzip2/bgbg.o] Error 1<br>scons: building terminated because of errors.<br>[cch1@bmw nsis-2.24-src]$<br></font></blockquote>So, how can I get the results of the build installed to the proper locations? I'm pretty sure the zip file that I downloaded has to be part of the equation, but I'm not sure how to put the zip plus the makensis executable together so that scons install will work.</div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">kichik</span><br><span class="post-time small text-muted">3rd March 2007 10:27 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">You must pass the same parameters to `install` or scons will rebuild it with the new (default) parameters. You can also use install-compiler which should only install makensis.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">cch1</span><br><span class="post-time small text-muted">3rd March 2007 12:50 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">How can I find the parameters that were used to build the zip? I used the recommended parameters to build makensis:<br><br>scons SKIPSTUBS=all SKIPPLUGINS=all SKIPUTILS=all SKIPMISC=all NSIS_CONFIG_CONST_DATA_PATH=no</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">kichik</span><br><span class="post-time small text-muted">3rd March 2007 12:53 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">The zip is built with the default parameters. They match the line in INSTALL which matches the line you just posted. Simply append `install-compiler` or `install` to that line. You can also just copy makensis from build/release/makensis/makensis.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">cch1</span><br><span class="post-time small text-muted">3rd March 2007 13:03 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Just running "sudo scons install-compiler" yields results which you probably could have predicted:<br><br>[cch1@bmw mmwin]$ makensis setup<br>Error: opening stub "/usr/local/share/nsis/Stubs/zlib"<br>Error initalizing CEXEBuild: error setting default stub<br><br>Regarding my previous question about ensuring the parameters match: I think that means matching my build parameters with those used to build the files in the zip (hard for me to guess). I also tried making sure my build params match my install params. But then I get this:<br><br>$ scons install SKIPSTUBS=all SKIPPLUGINS=all SKIPUTILS=all SKIPMISC=all NSIS_CONFIG_CONST_DATA_PATH=no<br>...<br>scons: Building targets ...<br>scons: *** Do not know how to make target `install'. Stop.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">kichik</span><br><span class="post-time small text-muted">3rd March 2007 13:12 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Using just scons when not compiling the entire package is not enough. You must extract the zip contents to /usr/local/share/nsis, in your case.<br><br>I'm currently checking why 'install' and 'install-compiler' don't work with all the SKIPs in place.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">cch1</span><br><span class="post-time small text-muted">3rd March 2007 13:13 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">I am still confused as to how to get the contents of the zip file installed into the correct location.<br><br>When I did the build using the default target and all the SKIPXXX options, that just made the native linux makensis. So doing an scons install is not going to be able to install any more than makensis anyway. Yet I want the contents of the zip installed as well so that makensis can put all the pieces together into a compiled installer.<br><br>How can scons know where to get the files that are in the zip (to put them into the correct locations in the linux filesystem so that makensis finds them later)?<br><br>My apologies if these questions are answered elsewhere -or should be obvious. I just don't get it!</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">kichik</span><br><span class="post-time small text-muted">3rd March 2007 13:13 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Actually, it's not the SKIPs, it's NSIS_CONFIG_CONST_DATA_PATH. When using NSIS_CONFIG_CONST_DATA_PATH, you must install using a PREFIX or the build system won't know where to put the files. Point PREFIX to the path where you've extracted the zip file.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">cch1</span><br><span class="post-time small text-muted">3rd March 2007 13:18 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">AHA! I think you have provided the key: extract the zip to /usr/local/share/nsis. That has resolved the problem very nicely. I assumed that the locations for all the zip files would be spread out -but with something as simple as dumping them all into /usr/local/share/nsis, it's very reasonable to do it manually.<br><br>Thanks for all your help. I am now up and running NICELY with the files in the right location. If I can be of any help with the debugging of the install target, let me know.<br>(Fedora Core 5)</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">cch1</span><br><span class="post-time small text-muted">3rd March 2007 15:02 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">I've gotten the installation working, so from here on out we're working to make it easier on the next guy that comes along. I'll post our final solution to my blog (cho.hapgoods.com/wordpress/?p=136) and reference it in this post here on the forum.<br><br>OK. I have extracted the zip file to ~/nsis/nsis-2.24. I have extracted the source file to ~/nsis/nsis-2.24-src.<br><br>First, I run scons with all the SKIP options and NSIS_CONFIG_CONST_DATA_PATH=no. This builds the makensis native compiler with no problems.<br><br>Now, to get the install target to work, I have tried:<br><br>[cch1@bmw nsis-2.24-src]$ scons PREFIX=../nsis-2.24 install<br><br>This gives me the following:<br><br>gcc -o build/release/stub_bzip2/bgbg.o -c -Os -Wall -x c -fno-strict-aliasing -DEXEHEAD -DWIN32_LEAN_AND_MEAN -D_WIN32_IE=0x0500 -DNSIS_COMPRESS_USE_BZIP2 Source/exehead/bgbg.c<br>In file included from Source/exehead/bgbg.c:21:<br>Source/exehead/state.h:34: error: expected '=', ',', ';', 'asm' or '__attribute__' before 'g_hwnd'<br>Source/exehead/state.h:36: error: expected '=', ',', ';', 'asm' or '__attribute__' before 'insthwnd'<br>In file included from Source/exehead/bgbg.c:22:<br>Source/exehead/ui.h:28: error: expected '=', ',', ';', 'asm' or '__attribute__' before 'm_curwnd'<br>In file included from Source/exehead/bgbg.c:23:<br>Source/exehead/util.h:19:20: error: shlobj.h: No such file or directory<br>In file included from Source/exehead/bgbg.c:23:<br>Source/exehead/util.h:33: error: expected '=', ',', ';', 'asm' or '__attribute__' before '*' token<br>Source/exehead/util.h:35: error: expected ')' before 'idl'<br>Source/exehead/util.h:39: error: expected ')' before 'dlg'<br>Source/exehead/util.h:91: error: expected ')' before 'pszExisting'<br>Source/exehead/bgbg.c:30: error: expected '=', ',', ';', 'asm' or '__attribute__' before 'CALLBACK'<br>scons: *** [build/release/stub_bzip2/bgbg.o] Error 1<br>scons: building terminated because of errors.<br><br><br><br>Any ideas?</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">cch1</span><br><span class="post-time small text-muted">3rd March 2007 15:05 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">GOT IT!!!<br><br>This did it:<br><br>scons install SKIPSTUBS=all SKIPPLUGINS=all SKIPUTILS=all SKIPMISC=all NSIS_CONFIG_CONST_DATA_PATH=no PREFIX=../nsis-2.24<br><br>I should have tried all the skip options with the PREFIX option first.<br><br>Blog updated with the entire story, amended to show this last step.<br><br>Thanks a 10^6.<br><br>-CHris</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">kichik</span><br><span class="post-time small text-muted">3rd March 2007 15:07 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Exactly what I said in the first reply. Either use the same parameters or use `install-compiler` instead of just `install`. It tries to build the other parts of NSIS because you haven't skipped them and specifically told it to install them.<br><br>You should simply use:</p><pre>
<code>scons SKIPSTUBS=all SKIPPLUGINS=all SKIPUTILS=all SKIPMISC=all<br>              NSIS_CONFIG_CONST_DATA_PATH=no PREFIX=/path/to/extracted/zip<br>              install-compiler</code>
</pre>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">cch1</span><br>
      <span class="post-time small text-muted">3rd March 2007 15:11 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">I spoke too soon. It seems as though the scons install SKIPXXX NSIS_CONFIG_CONST_DATA_PATH=no PREFIX=../nsis-2.24 just pumped all the files from the build back into the zip directory. Nothing seems to have been installed into the appropriate Linux fs locations...<br>
      <br>
      Are we getting close?</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br>
      <span class="post-time small text-muted">3rd March 2007 15:13 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">You can't install into the appropriate Linux locations with NSIS_CONFIG_CONST_DATA_PATH and you can't use the ZIP file without NSIS_CONFIG_CONST_DATA_PATH. The best you can do is create a symlink from /bin to wherever you installed makensis.</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">cch1</span><br>
      <span class="post-time small text-muted">3rd March 2007 15:21 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">First, sorry for not keeping things in order. I need to refresh my browser before submitting the reply -you are too fast!<br>
      <br>
      If I understand correctly, the install target can't install ALL the files (zip + makensis) to the appropriate Linux fs locations automatically. The install-compiler target will put the makensis file into the correct location (/usr/local/bin), but it can't put the zip files into the correct location.<br>
      <br>
      If this is correct, then I think the best solution is to use the install-compiler target to place makensis correctly and then manually put the zip contents into /usr/local/share/nsis.<br>
      <br>
      OK?</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br>
      <span class="post-time small text-muted">3rd March 2007 15:27 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Any target of the build system doesn't touch the ZIP file. That's up to you to extract.<br>
      <br>
      Setting NSIS_CONFIG_CONST_DATA_PATH to "no" tells makensis to look for the files it needs in the directory where makensis itself is located. Without it, it'll look for the files in PREFIX_DATA which is $PREFIX/share/nsis by default. $PREFIX is /usr/local by default.<br>
      <br>
      That leaves you with two options.</p>

      <ol style="list-style-type: decimal">
        <li>Don't use NSIS_CONFIG_CONST_DATA_PATH, install into the extracted ZIP and manually put a symlink in /bin.</li>

        <li>Use NSIS_CONFIG_CONST_DATA_PATH and extract the ZIP to PREFIX_DATA which is /usr/local/share/nsis by default.</li>
      </ol>
    </div>
    <hr>

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]></script></body></html>