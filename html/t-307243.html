<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="description" content="Product Version MessageBox from start menu shortcut"><title>Product Version MessageBox from start menu shortcut - NSIS Forums</title><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script><link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css"><link rel="stylesheet" href="../css/style.css" type="text/css"></head><body><div class="container"><ol class="breadcrumb"><li><a href="../index.html" class="glyphicon glyphicon-home"></a></li><li><a href="f-65.html">NSIS Discussion</a></li><li class="active">Product Version MessageBox from start menu shortcut</li></ol><p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=307243">Product Version MessageBox from start menu shortcut</a></p><br><div class="post"><p class="post-meta"><span class="post-author text-primary">YeSaYa</span><br><span class="post-time small text-muted">10th June 2009 12:08 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>Product Version MessageBox from start menu shortcut</strong><br>Hi,<br>I would like to include in my installer a start menu shortcut to message box with product version information.<br>Is there any way create a shortcut not to some file, but some function in installer script which will be invoked?(for example function may containing:<br>MessageBox MB_ICONINFORMATION|MB_OK "Version " "${PRODUCT_VERSION}")?<br><br>Thanks and Regards,<br>Sasa</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Animaether</span><br><span class="post-time small text-muted">10th June 2009 12:33 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">you could pass something like "/version" as a command line parameter to your installer, check for that in the installer, and if /version is specified, only pop up a messagebox.<br><br>You might want to make that a separate installer if your regular installers requires Admin; otherwise just to check the version would pop up UAC on Vista/Se7en, etc.<br>Ideally you'd write a small app that does it proper :)</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">YeSaYa</span><br><span class="post-time small text-muted">10th June 2009 16:01 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Thanks for anwering,<br>I decided to add another trivial installer which will produce version.exe with desired information and wich I will attach for link in Start Menu.<br>Now I am facing with new issue:<br>I would like to implement following line in my "main" installer:<br><br><b>ExecShell "open" '"${NSISDIR}\makensis.exe" version.nsi'</b><br><br>to get version.exe which I will latest in main installer script I will use when I will create shortcut.<br>Unfortunately, this ExecShell is executing with no errors in log but it doesn't produce expected version.exe file and it causing error later in main installer script when I am trying to copy file which doesn't exist.<br>Simple call from command line: "C:\Program Files\NSIS\makensis.exe" version.nsi will produce expected <i>version.exe</i>.<br><br>Any ideas what I am doing wrong?<br><br>Thanks once again,<br>Sasa</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Animaether</span><br><span class="post-time small text-muted">10th June 2009 16:07 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">err... you can't do that - unless you're distributing NSIS with your own plugin, too.<br><br>Why aren't you just storing the version number in the registry on installation, and then reading that out from there? You should only have to build an executable that reads that out once, locally, and then include that executable in your installer :o</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br><span class="post-time small text-muted">10th June 2009 16:28 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">ExecShell is a run time instruction. You need to use !system.<br><br>Stu</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">YeSaYa</span><br><span class="post-time small text-muted">10th June 2009 19:38 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Stu,<br>thanks... It is exactly what I was looking for...<br><br>Regards,<br>Sasa</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br><span class="post-time small text-muted">10th June 2009 20:15 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Also just a note on your version.nsi it should probably look something like this:<br><br></p><pre>
<code>OutFile version.exe<br>SilentInstall silent<br>XPStyle on<br>Icon ...<br><br>Section<br>  MessageBox MB_OK|MB_ICONINFORMATION ...<br>SectionEnd</code>
</pre><br>
      <br>
      That is the most minimal script which will not have any UI resources in it (SilentInstall silent ensures this).<br>
      <br>
      Stu
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">YeSaYa</span><br>
      <span class="post-time small text-muted">10th June 2009 20:44 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">:D<br>
      Yes, exactly... And most important - it's working. ;)<br>
      <br>
      Sasa</p>
    </div>
    <hr>

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]></script></body></html>