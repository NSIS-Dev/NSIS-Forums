<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="Need File association help" />

  <title>Need File association help - NSIS Forums</title>
  <script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script>
  <!-- Bootstrap core CSS -->

  <link rel="stylesheet" type="text/css" href="//netdna.bootstrapcdn.com/bootswatch/3.0.1/readable/bootstrap.min.css" />
  <link rel="stylesheet" href="../css/style.css" type="text/css" /><!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!--[if lt IE 9]>
                <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
                <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->
</head>

<body>
  <div class="container">
    <!-- Put navigation bar here -->

    <ol class="breadcrumb">
      <li><a href="../index.html" class="glyphicon glyphicon-home"></a></li>

      <li><a href="f-65.html">NSIS Discussion</a></li>

      <li class="active">Need File association help</li>
    </ol>

    <p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=266766">Need File association help</a></p><br />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">f1nn</span><br />
      <span class="post-time small text-muted">28th February 2007 12:08 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>Need File association help</strong><br />
      Hi<br />
      <br />
      I am trying to set a file assocation for my application<br />
      I am trying the script by Vytautas on the NSIS site<br />
      <a href="http://nsis.sourceforge.net/wiki/File_Association." target="_blank">http://nsis.sourceforge.net/wiki/File_Association.</a><br />
      However I am having trouble and dont understand what is going wrong.<br />
      If I check the registry after runing the script I can see that under HOT KEY CLASSES ROOT their is a folder called .riverDoc.<br />
      I also have a folder called RiverDocs.riverDoc, contained within this are two more folders one called RiverDocsIcon.ico and the shell folder which contains the Edit and Open commands.<br />
      <br />
      If I highlight the .riverDoc folder the registry shows the following information<br />
      Name Type Data<br />
      (Default) Reg_SZ RiverDoc.riverDoc<br />
      <br />
      If I highlight the RiverDoc.riverDoc folder the registry shows the following information<br />
      <br />
      Name Type Data<br />
      (Default) Reg_SZ RiverDoc File<br />
      EditFlags Reg_DWORD 0x00000000 (0)<br />
      <br />
      The entry for the RiverDocsIcon reads<br />
      Name Type Data<br />
      (Default) REG_SZ c:\program files\RiverDocs\RiverDoc.exe,0<br />
      <br />
      If I highlight the edit or the open folder I see for edit<br />
      Name Type Data<br />
      (Default) REG_SZ edit<br />
      and for open<br />
      Name Type Data<br />
      (Default) REG_SZ Value not set<br />
      <br />
      The shell edit command folder highlighted reads<br />
      Name Type Data<br />
      (Default) REG_SZ c:\program files\RiverDocs\RiverDoc.exe"%1"<br />
      <br />
      The shell open command folder highlighted reads<br />
      Name Type Data<br />
      (Default) REG_SZ c:\program files\RiverDocs\RiverDoc.exe"%1"<br />
      <br />
      The problem that I am having is that when I check the file assocations in explorer folder options I can see in file types<br />
      Extension FileTypes<br />
      RIVERDOC RiverDocs File<br />
      <br />
      When I go to the advanced option edit and open appear in the actions panel RiverDocs File appears in the textfiels beside the change icon button. If I choose to highlight the edit or open action and choose edit button I get the proper path in the application used to perform action<br />
      C:\Program Files\RiverDocs\RiverDoc.exe "%1"<br />
      <br />
      Thsi all seeams ok but if I try to open a file of type riverdoc it just wont work. Windows asks me to choose the program to open the file. Also the Icons are not appearing in the file assocation in explorer folder options file types nor on the document that I am trying to open. Sorry if this is a bit long winded but I would apprecate any help in pointing out what I am doing wrong and how I might fix it. I have trawled the site and seen similar questions but no answers that work for me yet.<br />
      <br />
      many thanks<br />
      <br />
      <br />
      !define Index "Line${__LINE__}"<br />
      ReadRegStr $1 HKCR ".riverdoc" ""<br />
      StrCmp $1 "" "${Index}-NoBackup"<br />
      StrCmp $1 "RiverDocs.riverdoc" "${Index}-NoBackup"<br />
      WriteRegStr HKCR ".riverDoc" "backup_val" $1<br />
      "${Index}-NoBackup:"<br />
      WriteRegStr HKCR ".riverDoc" "" "RiverDocs.riverDoc"<br />
      ReadRegStr $0 HKCR "RiverDocs.riverDoc" ""<br />
      StrCmp $0 "" 0 "${Index}-Skip"<br />
      WriteRegStr HKCR "RiverDocs.riverdoc" "" "RiverDocs File"<br />
      WriteRegStr HKCR "RiverDocs.riverdoc\shell" "" "open"<br />
      WriteRegStr HKCR "RiverDocs.riverdoc\RiverDocsIcon.ico" "" "$INSTDIR\RiverDoc.exe,0"<br />
      "${Index}-Skip:"<br />
      WriteRegStr HKCR "RiverDocs.riverdoc\shell\open\command" "" \<br />
      '$INSTDIR\RiverDoc.exe "%1"'<br />
      WriteRegStr HKCR "RiverDocs.riverdoc\shell\edit" "" "Edit"<br />
      WriteRegStr HKCR "RiverDocs.riverdoc\shell\edit\command" "" \<br />
      '$INSTDIR\RiverDoc.exe "%1"'<br />
      <br />
      !define SHCNE_ASSOCCHANGED 0x8000000<br />
      !define SHCNF_IDLIST 0<br />
      System::Call 'Shell32::SHChangeNotify(i ${SHCNE_ASSOCCHANGED}, i ${SHCNF_IDLIST}, i 0, i 0)'<br />
      ;System::Call 'shell32.dll::SHChangeNotify(i, i, i, i) v (0x08000000, 0, 0, 0)'<br />
      ;System::Call 'Shell32::SHChangeNotify(i 0x8000000, i 0, i 0, i 0)'</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">demiller9</span><br />
      <span class="post-time small text-muted">28th February 2007 13:59 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Try putting quotes around the program path in the registry shell commands. When you write the shell edit and open commands, try '"$INSTDIR\Riverdoc.exe" "%1"'. (single quotes around two quoted strings).<br />
      <br />
      Don</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">f1nn</span><br />
      <span class="post-time small text-muted">1st March 2007 13:42 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">thanks for the reply I will try this</p>
    </div>
    <hr />

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]>
  </script>
</body>
</html>
