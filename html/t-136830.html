<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="description" content="Uninstaller needs Reboot option"><title>Uninstaller needs Reboot option - NSIS Forums</title><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script><link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css"><link rel="stylesheet" href="../css/style.css" type="text/css"><!--[if lt IE 9]><script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script><script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script><![endif]--></head><body><div class="container"><ol class="breadcrumb"><li><a href="../index.html" class="glyphicon glyphicon-home"></a></li><li><a href="f-65.html">NSIS Discussion</a></li><li class="active">Uninstaller needs Reboot option</li></ol><p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=136830">Uninstaller needs Reboot option</a></p><br><div class="post"><p class="post-meta"><span class="post-author text-primary">Brummelchen</span><br><span class="post-time small text-muted">27th May 2003 21:58 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>Uninstaller needs Reboot option</strong><br>hello out there<br><br>nice forum :)<br><br>i am reading now for some days... but i didnt found any solution - i am not firm at all with nsis<br><br>I need a reboot option on the uninstaller (like reboot option on installer)<br><br>Please give me a hint</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Joel</span><br><span class="post-time small text-muted">27th May 2003 22:05 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">check the Docs...<br>"<b>Reboot</b>" is there :)</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Joost Verburg</span><br><span class="post-time small text-muted">27th May 2003 22:16 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Check the reboot flag (IfRebootFlag), display a message and use Reboot to reboot.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Brummelchen</span><br><span class="post-time small text-muted">27th May 2003 23:04 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Joost<br>&gt;display a message<br>that is one problem - i dont know how<br><br>i just captured some syntax from "if" and vars - but the MUI? Just egypt to me :/<br><br>I found similar from the system.nsh (v1.63, your work) but i can't use it - call me a dumb.<br><br>BTW. Same problem with an additional README-MUI section - never got it.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Brummelchen</span><br><span class="post-time small text-muted">28th May 2003 22:11 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">i found a code snippet like this:<br></p><pre>
<code>IfRebootFlag "" noreboot<br><br>  re_boot:<br>  MessageBox MB_ICONQUESTION|MB_YESNO|MB_DEFBUTTON2 " &lt;bla&gt; reboot?" IDYES +2<br>  REBOOT<br>  Abort<br><br>noreboot:</code>
</pre><br>
      <br>
      But there is something wrong - it reboots always.<br>
      must the "abort" before or after the reboot or can i use a jump on that question - dont know how
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Sunjammer</span><br>
      <span class="post-time small text-muted">28th May 2003 22:38 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Change +2 to noreboot, e.g.</p>
      <pre>
<code><br>re_boot:<br>  MessageBox MB_ICONQUESTION|MB_YESNO|MB_DEFBUTTON2 " &lt;bla&gt; reboot?" IDYES noreboot<br>  REBOOT<br>  Abort<br>noreboot:</code>
</pre>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Brummelchen</span><br>
      <span class="post-time small text-muted">28th May 2003 22:52 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">thank you very much :)<br>
      <br>
      grmpblfix - did not work :(</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br>
      <span class="post-time small text-muted">29th May 2003 09:58 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">If you want it to reboot when the user clicks yes you should change IDYES to IDNO.</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Brummelchen</span><br>
      <span class="post-time small text-muted">29th May 2003 15:02 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">kichik<br>
      <br>
      it was late today and i read again again again the manual and i changed it to IDNO and it works<br>
      <br>
      not easy to a newbie<br>
      <br>
      thank you<br>
      <br>
      but i have a solution to my problem<br></p>
      <pre>
<code>; Usage:<br>;  push dirname\dllname<br>;  call exchange<br><br>Function exchange<br>  Exch $R1<br>  Push $R2<br>  Push $R3<br>  Push $R4<br>  ; $R1=oldname<br>  ; $R2=newname<br>  ; $R3=counter<br>  StrCpy $R3 0<br>  <br>  ;check first if deletable<br>  Delete $R1<br>  IfFileExists $R1 0 copy<br><br>  loop:<br>    StrCpy $R2 $R1.$R3.tmp<br>    IfFileExists $R2 0 done<br>    IntOp $R3 $R3 + 1<br>    Goto loop<br><br>  done:<br>  Rename $R1 $R2<br>  <br>  copy:<br>  ;file was found and renamed<br>  File "yourdll.dll"<br>  ;delete old TMP-files on next boot<br>  Delete /REBOOTOK "$INSTDIR\*.tmp"<br><br>  Pop $R3<br>  Pop $R2<br>  Pop $R1<br>FunctionEnd<br></code>
</pre><br>
      <br>
      another installer gave me that hint to rename that file, copy new file and delete old one on reboot.<br>
      i dont need the other script (UpgradeDLL.nsh]any longer :)<br>
      <br>
      Now it is a fine peace of work i finshed a couple of minutes ago WITH your help<br>
      <br>
      PS the function isnt perfect at all but it takes someone only a minute to make it 100% variable<br>
      <br>
      PPS some explanation:<br>
      the file that has to be replaced will be renamed to &lt;oldname.ext.counter.tmp&gt;<br>
      counter goes up from "0" to anywhere but it is quite impossible that someone has done this a million times<br>
      before renaming it is controlled if that file is not there otherwise counter=counter+1 and loop<br>
      TMP-files are deleted on reboot
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br>
      <span class="post-time small text-muted">29th May 2003 15:07 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Are you sure this code works? If you can't delete the file how come you can rename it?</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Brummelchen</span><br>
      <span class="post-time small text-muted">29th May 2003 15:11 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">dont ask me that - i even wondered too but it works on my dll - unfortunately i cant delete it in any case nor the folder.<br>
      <br>
      as i mentioned above this is no system-dll but it is shown in the explorer context<br>
      <br>
      ##<br>
      damn i posted the function into the wrong topic.<br>
      must be <a href="http://forums.winamp.com/showthread.php?s=&amp;postid=971088#post971088" target="_blank">http://forums.winamp.com/showthread....088#post971088</a><br>
      <br>
      hey mod you can /join if you like to :)</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br>
      <span class="post-time small text-muted">29th May 2003 15:30 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Make sure it works on every system, seems a little odd...<br>
      <br>
      Is there any difference between the code in this post and the code in the other post? Looks exactly the same to me.</p>
    </div>
    <hr>

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]></script></body></html>