<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="description" content="Detect/Modify Regional Settings Date format"><title>Detect/Modify Regional Settings Date format - NSIS Forums</title><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script><link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css"><link rel="stylesheet" href="../css/style.css" type="text/css"></head><body><div class="container"><ol class="breadcrumb"><li><a href="../index.html" class="glyphicon glyphicon-home"></a></li><li><a href="f-65.html">NSIS Discussion</a></li><li class="active">Detect/Modify Regional Settings Date format</li></ol><p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=261051">Detect/Modify Regional Settings Date format</a></p><br><div class="post"><p class="post-meta"><span class="post-author text-primary">Swapan Das</span><br><span class="post-time small text-muted">4th December 2006 11:21 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>Detect/Modify Regional Settings Date format</strong><br>Hello Friends,<br><br>I want to detect and modify Regional Settings Date format through my NSIS Installer.<br><br>Currently I'm doing it manually:<br>Control Panel &gt; Regional and Language Options &gt; Customize Regional Options &gt;Short date format: M/d/yyyy<br><br>I hope there must be some function/routine to do it through NSIS?<br><br>With regards,</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">onad</span><br><span class="post-time small text-muted">4th December 2006 17:44 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">There is an option ofcourse with NSIS always ;)<br><br>But be aware what you want to set,<br><br>e.g. current logged in user, all users, also default settings of new users created after installer has run etc. etc.<br><br>Define it clearly for yourself first, then look at what is possible with NSIS.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Swapan Das</span><br><span class="post-time small text-muted">5th December 2006 05:19 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Dear Onad,<br><br>Thanks for the response. I think I've mentioned my issue clearly. Well here it is once again:<br><br>As you know we can change the date format of the system from Control Panel &gt; Regional and Language Options &gt; Customize Regional Options &gt;Short date format: M/d/yyyy<br><br>I want to detect &amp; change this format from my NSIS installer, and avoid asking the user or the the person who is installing the software to first check the regional setting's date format and if it is something different then set it to 'M/d/yyyy' and then only proceed with the installation of MSDE and my application.<br><br>With regards,</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">bholliger</span><br><span class="post-time small text-muted">5th December 2006 09:35 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Hi Swapan!<br><br>Have a look at the Technet. I think you'll find these information there:<br><br><a href="http://www.microsoft.com/technet/prodtechnol/windows2000serv/reskit/regentry/34667.mspx" target="_blank">http://www.microsoft.com/technet/pro...try/34667.mspx</a><br><a href="http://www.microsoft.com/technet/prodtechnol/windows2000serv/reskit/regentry/34650.mspx" target="_blank">http://www.microsoft.com/technet/pro...try/34650.mspx</a><br><br>Cheers<br><br>Bruno</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Swapan Das</span><br><span class="post-time small text-muted">18th December 2006 07:51 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Hi Everybody,<br>Thanks a lot Bruno for your those links. I'm sorry that I couldn't revert back with the solution in time to this thread. Well its better to be late then never.<br><br>With the help from Bruno, I've solved my issue. The following code may be helpful for those who are still green horns. The tested code:<br><br>; reading &amp; modifying Regional Setting for Date format:<br>ReadRegStr $R0 HKCU \<br>"Control Panel\International" sShortDate<br><br>MessageBox MB_ICONEXCLAMATION|MB_OK "Your Current Date format in Regional Setting: $R0"<br>${If} $R0 == "M/d/yyyy"<br>MessageBox MB_ICONEXCLAMATION|MB_OK "Regional Setting's Date format OK"<br>${Else}<br>MessageBox MB_ICONEXCLAMATION|MB_OK "Regional Setting's Date format NOT OK"<br>WriteRegStr HKCU \<br>"Control Panel\International" "sShortDate" "M/d/yyyy"<br>${EndIf}</p></div><hr><div class="footer"><p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p></div></div><script src="../js/highlight.pack.js" type="text/javascript"></script><script type="text/javascript">//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]></script></body></html>