<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="description" content="Administrative folder appears on Vista"><title>Administrative folder appears on Vista - NSIS Forums</title><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script><link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css"><link rel="stylesheet" href="../css/style.css" type="text/css"></head><body><div class="container"><ol class="breadcrumb"><li><a href="../index.html" class="glyphicon glyphicon-home"></a></li><li><a href="f-65.html">NSIS Discussion</a></li><li class="active">Administrative folder appears on Vista</li></ol><p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=298203">Administrative folder appears on Vista</a></p><br><div class="post"><p class="post-meta"><span class="post-author text-primary">TapeWyrm</span><br><span class="post-time small text-muted">4th October 2008 08:38 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>Administrative folder appears on Vista</strong><br>I'm experiencing a weird issue. I have 2 installer scripts, and one works perfectly when uninstalling, while the other always makes the Administrative Tools appear in the Start Menu after uninstalling. It's supposed to be hidden and it's not a permanent thing, it goes away after some time or when I switch users. The weird thing is that both installers have similar uninstall sections and yet only one produces this behaviour. I've experienced this on both Vista x86 and x64, but I -think- XP (I have no way to confirm right now) is unaffected.<br><br>Has anyone else run into this?<br><br>Here's the uninstall snippet from the offending script:<br></p><pre>
<code><br>  Delete "$INSTDIR\uninst.exe"<br>  <br>  RMDir /r "$SMPROGRAMS\Gorgon\Gorgon Examples"<br>  RMDir "$SMPROGRAMS\Gorgon"<br>  <br>  RMDir /r "$INSTDIR\Resources"<br>  RMDir /r "$INSTDIR\PlugIns"<br>  RMDir /r "$INSTDIR\Examples"<br>  RMDir "$INSTDIR"<br><br>  DeleteRegKey ${PRODUCT_UNINST_ROOT_KEY} "${PRODUCT_UNINST_KEY}"<br>  SetAutoClose true</code>
</pre>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br>
      <span class="post-time small text-muted">4th October 2008 10:48 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">What exactly are you deleting in the registry? Try adding a call to <a href="http://nsis.sourceforge.net/Docs/AppendixE.html#E.1.21" target="_blank">RefreshShellIcons</a> after deleting the shortcuts, it might help.</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">TapeWyrm</span><br>
      <span class="post-time small text-muted">4th October 2008 18:40 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">The call to RefreshShellIcons worked like a charm. Thanks.</p>
    </div>
    <hr>

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]></script></body></html>