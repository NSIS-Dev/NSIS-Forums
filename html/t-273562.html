<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="description" content="How to check if the PC is inet connected ?"><title>How to check if the PC is inet connected ? - NSIS Forums</title><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script><link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css"><link rel="stylesheet" href="../css/style.css" type="text/css"></head><body><div class="container"><ol class="breadcrumb"><li><a href="../index.html" class="glyphicon glyphicon-home"></a></li><li><a href="f-65.html">NSIS Discussion</a></li><li class="active">How to check if the PC is inet connected ?</li></ol><p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=273562">How to check if the PC is inet connected ?</a></p><br><div class="post"><p class="post-meta"><span class="post-author text-primary">FingerThief</span><br><span class="post-time small text-muted">28th June 2007 15:22 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>How to check if the PC is inet connected ?</strong><br>Afternoon ...<br><br>Being reading NSIS documentation, google search results and stuff for over an hour now ... but I can't find an answer to above question.<br><br>I simply need a function ( to show after the MUI_PAGE_WELCOME ) that checks if the computer is connected to the internet.<br><br>If not I need to MB_OK|MB_ICONSTOP out of the installation without further notice.<br><br>This is due to some files and settings being obtained during installation over the internet via SOAP and NSISdl.<br><br>If somebody could help me out there it would be much appreciated !<br><br>TIA<br><br>FT</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">kichik</span><br><span class="post-time small text-muted">28th June 2007 15:29 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Simply do a test call to your SOAP service. This should cover all checks. If it works, the computer is connected to the internet, your website is accessible and the SOAP service is functional.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">FingerThief</span><br><span class="post-time small text-muted">28th June 2007 15:43 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"></p><blockquote><i>Originally posted by kichik</i><br><b>Simply do a test call to your SOAP service.</b></blockquote>That is what I want to avoid ... I just want to verify if the PC is connected to the internet before I start the mumbo jumbo about downloading files/SOAP etc.( and constructing a fake SOAP call ain't something I would wanna do ).<br><br>No simple way ?<br><br>FT</div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">kichik</span><br><span class="post-time small text-muted">28th June 2007 15:54 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">You can use Dialer::GetConnectedState or Dialer::AttemptConnect but that's never as good as making an actual call. Every heuristic has some false positives. Some, like checking for an active interface, have more than others.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Takhir</span><br><span class="post-time small text-muted">28th June 2007 16:01 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">forum and wiki search give me nothing now, but I remember few threads with InternetGetConnectedState samples. Try search later.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">kichik</span><br><span class="post-time small text-muted">28th June 2007 16:02 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Dialer::GetConnectedState calls InternetGetConnectedState.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Joel</span><br><span class="post-time small text-muted">28th June 2007 16:32 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">I think using Wininet::InternetConnect would more secure to detect currently and active internet connection...<br>In my past experiences, Wininet::InternetAttemptConnect is not always accurate :\</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Red Wine</span><br><span class="post-time small text-muted">28th June 2007 19:00 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Here is a recent discussion of the subject, Takhir's way ;)<br><br><a href="http://forums.winamp.com/showthread.php?s=&amp;threadid=262554" target="_blank">http://forums.winamp.com/showthread....hreadid=262554</a></p></div><hr><div class="footer"><p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p></div></div><script src="../js/highlight.pack.js" type="text/javascript"></script><script type="text/javascript">//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]></script></body></html>