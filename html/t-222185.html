<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="description" content="nsExec Issues and The ModerUI"><title>nsExec Issues and The ModerUI - NSIS Forums</title><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script><link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css"><link rel="stylesheet" href="../css/style.css" type="text/css"></head><body><div class="container"><ol class="breadcrumb"><li><a href="../index.html" class="glyphicon glyphicon-home"></a></li><li><a href="f-65.html">NSIS Discussion</a></li><li class="active">nsExec Issues and The ModerUI</li></ol><p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=222185">nsExec Issues and The ModerUI</a></p><br><div class="post"><p class="post-meta"><span class="post-author text-primary">ddod</span><br><span class="post-time small text-muted">22nd July 2005 18:11 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>nsExec Issues and The ModerUI</strong><br>I have been reading all the forum threads regarding starting dos commands or batch files and have determined that nsExec should do what I want it to. However I am having some issues with it casuing the graphics of my installer to hang (using moder UI).<br><br>Here is a brief explanation of my install program. It is basically a wrapper for an MSI.<br><br>get user input<br>NSIS Installs files for MSI Installation.<br>custom leave funtions for MUI_PAGE_INSTFILES hides installer and runs the MSI with appropriate switches<br>some final pages then determine if MSI installed properly, etc<br><br>However, I have a few command line scripts that I want to run as soon as the MSI install finishes succesfully. I don't want the dos windows to show so I am trying it with nsExecLog (the output would be nice to display but not necessary). However, whenever I run this the gaphics hang until the commands finish.<br><br>I have placed the commands in several areas of the code with the same result.<br><br>It is logging the command' output to the installer window but I can't see it happening. I know it is logging because if I place a message box after the nsExec commands the installer re-paints when the message box appears and I can see the appropriate result in the log window.<br><br>No matter where I run these commands I can't get it to post the output while it is happening. And the installer hanging will not be acceptable<br><br>I also put all the commands into a batch file and ran<br><br>ExecShell "open" 'firewall.bat' SW_HIDE and<br>ExecShell "" 'firewall.bat' SW_HIDE<br><br>which runs the batch file fine, but the dos windows still appears even though I have the SW_HIDE option set.<br><br>None of these commands seem to be behaving the the documentation states. What am I doing wrong.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br><span class="post-time small text-muted">22nd July 2005 18:21 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">nsExec will pause your installer until it is finished, and there is no way of getting around this.<br>You should either display a Banner (see Contrib\Banner) or use DetailPrint if calling it in a Section.<br><br>-Stu</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">ddod</span><br><span class="post-time small text-muted">22nd July 2005 18:50 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Banner looks like it might work to keep the user busy while these commands run. However I am getting strange results with it and the ModernUI. The example file for it says:<br><br># Look at Readme.txt for usage alongside with the Modern UI<br><br>Yet no readme.txt was supllied for this dll in the NSIS install.<br><br>Where can I find it?</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">kichik</span><br><span class="post-time small text-muted">22nd July 2005 18:51 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">In the Docs folder.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">ddod</span><br><span class="post-time small text-muted">22nd July 2005 19:23 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">OK, Thanks. Does MSIBanner work with the modern UI. I just tried it and it crashed the program. I can't find any documentation about the MSIBanner other than the samples. There is a clue about needing to destroy it in a "Section" section. I can't do this becasue I would use this Banner after the section have completed.<br><br>Also no one has answered why the SW_HIDE is not working on the ExecShell command.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Takhir</span><br><span class="post-time small text-muted">22nd July 2005 19:55 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">ExecShell uses ShellExecute API call, and it cannot hide DOS windows.<br>MSIBanner related thread ;) <a href="http://forums.winamp.com/showthread.php?s=&amp;threadid=211870" target="_blank">http://forums.winamp.com/showthread....hreadid=211870</a> and <a href="http://nsis.sourceforge.net/wiki/Banner_with_Cancel_button" target="_blank">wiki page</a> with latest version.<br>It is possible to make DOS plug-in (nsExec or ExecDos)running with /NOUNLOAD (additional thread) but not implemented yet.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">ddod</span><br><span class="post-time small text-muted">22nd July 2005 20:05 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">So the documentation for ExecShell is innacurate?<br><br>According to the threads you gave me, it appears that MSIBanner is obsolete and the nxs.dll replaces it?<br><br>Thanks again for your help.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Takhir</span><br><span class="post-time small text-muted">23rd July 2005 12:07 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">I updated <a href="http://nsis.sourceforge.net/wiki/ExecDos" target="_blank">ExecDos</a> to support async process execution.</p></div><hr><div class="footer"><p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p></div></div><script src="../js/highlight.pack.js" type="text/javascript"></script><script type="text/javascript">//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]></script></body></html>