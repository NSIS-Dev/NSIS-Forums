<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="BringToFront doesn't work on XP" />

  <title>BringToFront doesn't work on XP - NSIS Forums</title>
  <script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script>
  <!-- Bootstrap core CSS -->

  <link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css" />
  <link rel="stylesheet" href="../css/style.css" type="text/css" /><!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!--[if lt IE 9]>
                <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
                <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->
</head>

<body>
  <div class="container">
    <!-- Put navigation bar here -->

    <ol class="breadcrumb">
      <li><a href="../index.html" class="glyphicon glyphicon-home"></a></li>

      <li><a href="f-65.html">NSIS Discussion</a></li>

      <li class="active">BringToFront doesn't work on XP</li>
    </ol>

    <p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=157907">BringToFront doesn't work on XP</a></p><br />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Nils2000</span><br />
      <span class="post-time small text-muted">28th November 2003 16:53 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>BringToFront doesn't work on XP</strong><br />
      Hi,<br />
      <br />
      BringToFront doesn't work on WinXP. It only makes the taskbar appear and the icon of the window blink.<br />
      <br />
      Has this to do with the documentation of the Win-API Function<br />
      SetForegroundWindow ?<br />
      Here's an extract:<br />
      [...]<br />
      Windows NT 5.0 and later: An application cannot force a window to the foreground while the user is working with another window. Instead, SetForegroundWindow will activate the window (see SetActiveWindow) and call theFlashWindowEx function to notify the user.<br />
      [...]<br />
      <br />
      Thanks for any help.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
      <span class="post-time small text-muted">28th November 2003 17:02 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Yes, that's the bit of information that's related to it and explains it perfectly. There is no easy method I know about that you can use to override this. Frankly, I think that's a good thing. As a user, I hate it when Windows pop-up and require my attention while I'm doing something totally unrelated.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Nils2000</span><br />
      <span class="post-time small text-muted">28th November 2003 17:14 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">I totally agree with you to that. However, I wonder how some MS-Applications like Outlook manage to penetrate me when I'm synchronizing my eMail-Accounts. Well, I don't believe this is some undocumented functionality, of which MS-Applications take advantage ;-)</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
      <span class="post-time small text-muted">28th November 2003 17:23 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Well... If you really want to do that, you can install a global hook which, on your command, will set the foreground window to your application. As a global hook will be injected into every process and therefore will be run under each of them, including the one that has the foreground window, you should be able to do that.<br />
      <br />
      Also, new windows which are shown using SW_SHOWNORMAL, should pop-up on front. Outlook and friends might just create the window every time to have it pop-up. If that is true, you can create a small window that will never really show on the screen, but get the foreground property and will therefore be able to set it to your window.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Nils2000</span><br />
      <span class="post-time small text-muted">1st December 2003 09:28 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">In that special case I'ld really like to do that, because when installing software, one shouldn't work with other programms. I think this is stated somewhere on the first dialog of the installer. The problem occurs because there is another application, which is installed from the installer. This application pops up a Readme and the application folder which overlap the installer.<br />
      <br />
      Isn't there a new window created when I use MUI_INSTALLOPTIONS_DISPLAY ?</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
      <span class="post-time small text-muted">1st December 2003 13:08 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Setup wizards say a lot of things ;) It usually isn't really nessacry to close all other programs.<br />
      <br />
      Is there no command line switch that will tell the second installer to not pop-up the readme and the folder?<br />
      <br />
      A new window is created for InstallOptions pages, but it's not a top level window.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
      <span class="post-time small text-muted">11th December 2003 13:35 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">I can't believe I forgot about this (the first part tells you how to do what you want to do):<br />
      <br />
      <a href="http://www.installsite.org/pages/en/isp_ext.htm" target="_blank">http://www.installsite.org/pages/en/isp_ext.htm</a></p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Nils2000</span><br />
      <span class="post-time small text-muted">11th December 2003 17:31 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Thanks,<br />
      I've tried it, but it didn't work :(<br />
      <br />
      So I've done a bit more research and found another method:<br />
      HWND theForegroundWnd = ::GetForegroundWindow();<br />
      ::AttachThreadInput(::GetWindowThreadProcessId( theForegroundWnd, NULL), ::GetCurrentThreadId(), TRUE);<br />
      BOOL retVal = ::SetForegroundWindow( hwndParent );<br />
      ::AttachThreadInput( ::GetWindowThreadProcessId( theForegroundWnd, NULL), ::GetCurrentThreadId(), FALSE);<br />
      <br />
      but it didn't work either. I've no clue. Somewhere I've read that MS has disabled both methods but I don't know if it's true.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
      <span class="post-time small text-muted">12th December 2003 17:01 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Well, the AttachThreadInput trick works for Banner, but for threads in the same process. Maybe the combination of both will do the trick.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Anders</span><br />
      <span class="post-time small text-muted">12th December 2003 19:09 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"></p>

      <blockquote>
        <i>Originally posted by Nils2000</i><br />
        <b>Thanks,<br />
        I've tried it, but it didn't work :(<br />
        <br />
        So I've done a bit more research and found another method:<br />
        HWND theForegroundWnd = ::GetForegroundWindow();<br />
        ::AttachThreadInput(::GetWindowThreadProcessId( theForegroundWnd, NULL), ::GetCurrentThreadId(), TRUE);<br />
        BOOL retVal = ::SetForegroundWindow( hwndParent );<br />
        ::AttachThreadInput( ::GetWindowThreadProcessId( theForegroundWnd, NULL), ::GetCurrentThreadId(), FALSE);<br />
        <br />
        but it didn't work either. I've no clue. Somewhere I've read that MS has disabled both methods but I don't know if it's true.</b>
      </blockquote>add: SetFocus(hwndParent ); after SetForegroundWindow... (i have not tested this, but found it in my own code from and old app :) )
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Nils2000</span><br />
      <span class="post-time small text-muted">15th December 2003 09:06 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">::SetFocus doesn't make a change with the AttachThread-method.<br />
      <br />
      @kichik:<br />
      SystemParametersInfo(...) fails with error-code ERROR_ACCESS_DENIED, when it is used to set the parameter. Reading the parameter works fine. So I don't think a combination of both methods would make any change.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
      <span class="post-time small text-muted">15th December 2003 13:58 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">According to MSDN:</p>

      <blockquote>
        The calling thread must be able to change the foreground window, otherwise the call fails.
      </blockquote>So make sure you call it when you still have focus. .onGUIInit or the first page's pre or show function would probably work best.
    </div>
    <hr />

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]>
  </script>
</body>
</html>
