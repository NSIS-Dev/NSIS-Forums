<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="help reading field values on ModernUI" />

  <title>help reading field values on ModernUI - NSIS Forums</title>
  <script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script>
  <!-- Bootstrap core CSS -->

  <link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css" />
  <link rel="stylesheet" href="../css/style.css" type="text/css" /><!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!--[if lt IE 9]>
                <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
                <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->
</head>

<body>
  <div class="container">
    <!-- Put navigation bar here -->

    <ol class="breadcrumb">
      <li><a href="../index.html" class="glyphicon glyphicon-home"></a></li>

      <li><a href="f-65.html">NSIS Discussion</a></li>

      <li class="active">help reading field values on ModernUI</li>
    </ol>

    <p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=257745">help reading field values on ModernUI</a></p><br />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">chickendavis</span><br />
      <span class="post-time small text-muted">17th October 2006 16:13 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>help reading field values on ModernUI</strong><br />
      Hello,<br />
      <br />
      I've been struggling with reading the values from some fields i have on a custom dialog using the Modern UI.<br />
      <br />
      Here is the ini content (Tester.ini):<br />
      [Settings]<br />
      NumFields=1<br />
      <br />
      [Field 1]<br />
      Type=CheckBox<br />
      Left=15<br />
      Right=-12<br />
      Top=3<br />
      Bottom=18<br />
      Text=Enabled Blah<br />
      <br />
      <br />
      Here are some script snippets that deal with this dialog:<br />
      ;include custom page<br />
      Page Custom ShowDlg LeaveDlg<br />
      <br />
      ;initialization<br />
      Var DLG_INI<br />
      Function .onInit<br />
      InitPluginsDir<br />
      GetTempFileName $DLG_INI $PLUGINSDIR<br />
      File /oname=$DLG_INI "Tester.ini"<br />
      FunctionEnd<br />
      <br />
      Function ShowDlg<br />
      InstallOptions::initDialog /NOUNLOAD "$BMS_DLG_INI"<br />
      InstallOptions::show<br />
      FunctionEnd<br />
      <br />
      Function LeaveDlg<br />
      !insertmacro MUI_INSTALLOPTIONS_READ $0 "Tester.ini" "Field 1" "State"<br />
      MessageBox MB_OK "Value: $0"<br />
      FunctionEnd<br />
      <br />
      <br />
      As you can see this is a very simple example. Im using the MUI_INSTALLOPTIONS_READ macro but it never pulls the value in. MessageBox never displays a value. From what i've read, this script seems correct. Is there something im missing? or is there an alternative way of reading the values from the fields.<br />
      <br />
      Thanks very much for the help. :)</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
      <span class="post-time small text-muted">17th October 2006 16:22 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">If you're not using the MUI macros to extract and show the INI file, don't use the MUI macros to read and write from the file. Use ReadINIStr instead.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">chickendavis</span><br />
      <span class="post-time small text-muted">18th October 2006 13:53 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">sweet that worked perfect.. thanx for the help mon.<br />
      should i be using the mui macros as opposed to how im doing it now? if so, can you give me an example of how the script would change to use mui macros instead?<br />
      thanx again.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
      <span class="post-time small text-muted">20th October 2006 09:55 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">When using the MUI, you should use the MUI macros to handle custom InstallOptions pages as it does some things behind the scenes for you so they'll come up more MUI-like. An example is available in the Examples\Modern UI directory.</p>
    </div>
    <hr />

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]>
  </script>
</body>
</html>
