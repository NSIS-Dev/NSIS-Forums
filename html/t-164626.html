<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="Looking for Rexx SearchPath function" />

  <title>Looking for Rexx SearchPath function - NSIS Forums</title>
  <script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script>
  <!-- Bootstrap core CSS -->

  <link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css" />
  <link rel="stylesheet" href="../css/style.css" type="text/css" /><!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!--[if lt IE 9]>
                <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
                <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->
</head>

<body>
  <div class="container">
    <!-- Put navigation bar here -->

    <ol class="breadcrumb">
      <li><a href="../index.html" class="glyphicon glyphicon-home"></a></li>

      <li><a href="f-65.html">NSIS Discussion</a></li>

      <li class="active">Looking for Rexx SearchPath function</li>
    </ol>

    <p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=164626">Looking for Rexx SearchPath function</a></p><br />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">openafsdev</span><br />
      <span class="post-time small text-muted">13th January 2004 07:37 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>Looking for Rexx SearchPath function</strong><br />
      The following link describes the Rexx SearchPath function in detail<br />
      <br />
      <a href="http://www.borg.com/~jglatt/rexx/scripts/language/funcs5.htm#SEARCHPATH" target="_blank">http://www.borg.com/~jglatt/rexx/scr...htm#SEARCHPATH</a><br />
      <br />
      In brief, given a PATH-style environment variable (string of directory names separated by semi-colons) and a filename, the function will return the first matching filename found.<br />
      <br />
      fullname = SEARCHPATH(path, filename)<br />
      <br />
      Has anyone implemented something similar to this for NSIS? This type of functionality is very important when you are trying to find a previous installation which may not have been installed with a means of tracking it.<br />
      <br />
      this is often true with opensource security software such as OpenSSL and MIT Kerberos for Windows which has been bundled with just about every application that uses it since there is no standard installation procedure.<br />
      <br />
      Thanks for your help.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Joost Verburg</span><br />
      <span class="post-time small text-muted">13th January 2004 15:34 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Get the PATH envrionment variable using ExpandEnvStrings, parse it using string commands like StrCpy and StrCmp and search using FindFirst/FindNext/FindClose.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">openafsdev</span><br />
      <span class="post-time small text-muted">13th January 2004 15:55 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>so the answer is 'no'</strong><br />
      Joost, thank you for your reply. Although a simply 'no' I have not would have been sufficient. Clearly the building blocks are available to perform the search, it just would have been nicer if the function was available for inclusion.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Joost Verburg</span><br />
      <span class="post-time small text-muted">13th January 2004 16:00 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">You can write your own functions using the NSIS script language and share them with other users in the NSIS Archive.<br />
      <br />
      There are already file search functions and PATH variable modification function available, so you would only have to combine them to get what you want.<br />
      <br />
      And if you create one, other can benefit from it too.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">openafsdev</span><br />
      <span class="post-time small text-muted">13th January 2004 22:14 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>SearchPath function implementation</strong><br />
      Attached is a SearchPath implementation. Feel free to insert it into the archive. In exchange, please explain how ExpandEnvStrings and ReadEnvStr are supposed to work. I can't figure it out.<br />
      <br />
      ReadEnvStr $R0 "PATH"<br />
      <br />
      sets $R0 to the empty string.<br />
      <br />
      ExpandEnvStrings $R0 "PATH"<br />
      <br />
      sets $R0 to "PATH".<br />
      <br />
      Thanks.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Joost Verburg</span><br />
      <span class="post-time small text-muted">13th January 2004 22:30 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">To get the content of a single variable you should use ReadEnvStr.<br />
      <br />
      ReadEnvStr $R0 "PATH"<br />
      <br />
      is the correct syntax and works for me.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">openafsdev</span><br />
      <span class="post-time small text-muted">13th January 2004 22:39 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">As indicated it does not work for me. NSIS 2.0 RC2 built from source with MSVC 6.0. Installer running on Windows XP SP1.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Joost Verburg</span><br />
      <span class="post-time small text-muted">14th January 2004 11:55 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">What's the output when you enter PATH in the command line?</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">openafsdev</span><br />
      <span class="post-time small text-muted">14th January 2004 12:01 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">I obtain the PATH<br />
      <br />
      [C:\]PATH<br />
      Path=C:\Program Files\Windows Resource Kits\Tools\;C:\Tcl\bin;C:\Perl\bin\;C:\PROGRAM FILES\THINKPAD\UTILITIES;C:\WINDOWS\system32;C:\WINDOWS;C:\WINDOWS\System3<br />
      2\Wbem;C:\Program Files\ATI Technologies\ATI Control Panel;C:\Program Files\ATI<br />
      Technologies\Fire GL 3D Studio Max;C:\Program Files\ATI Technologies\Fire GL Control Panel;C:\Program Files\PC-Doctor for Windows\services;C:\Program Files\Common Files\Adaptec Shared\System;c:\program files\resource kit\bin;c:\perl\bin;c:\<br />
      ssleay32;c:\kerberos;c:\kermit;c:\rse;c:\rse\nt;c:\tools\hamilton\bin;c:\tools\mks\mksnt;C:\Program Files\Support Tools\;c:\tools\sysinternals;C:\Program Files\OpenAFS\Client\Program;C:\Program Files\OpenAFS\Common;C:\Adabas\bin;C:\Adabas\pgm</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Joost Verburg</span><br />
      <span class="post-time small text-muted">14th January 2004 12:07 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Are you absolutely sure your script is correct? I tested it on multiple systems and it always gives the right output.<br />
      <br />
      Try:<br />
      <br />
      ReadEnvStr $R0 "PATH"<br />
      MessageBox MB_OK $R0</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">openafsdev</span><br />
      <span class="post-time small text-muted">14th January 2004 12:13 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">I copied your text exactly as you wrote it and pasted it followed by an "abort" command to the very beginning of the .onInit function. The end result is a message box displaying the empty string.<br />
      <br />
      Is there anyway to build a debug version of the generated installer?</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Joost Verburg</span><br />
      <span class="post-time small text-muted">14th January 2004 12:54 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Maybe the string is too large for the default string size. Try to increase NSIS_MAX_STRLEN in exehead\config.h</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">openafsdev</span><br />
      <span class="post-time small text-muted">14th January 2004 13:03 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">increasing to 4096 did indeed solve the problem.<br />
      <br />
      fyi, it would be a good idea to autogenerate the makenssi.mak and makenssi.dep files from the makenssi.dsw project. that would allow the .NET2003 compiler to be used to build the project from the command line. Unfortunately, I have not figured out yet how to generate makefiles from .NET2003.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Joost Verburg</span><br />
      <span class="post-time small text-muted">14th January 2004 13:10 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Makefiles are published in this topic:<br />
      <br />
      <a href="http://forums.winamp.com/showthread.php?s=&amp;threadid=163009" target="_blank">http://forums.winamp.com/showthread....hreadid=163009</a><br />
      <br />
      We are still looking for someone who wants to test these files with the free .NET command line compiler.<br />
      <br />
      Any help would be great.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">openafsdev</span><br />
      <span class="post-time small text-muted">14th January 2004 13:14 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">well, I don't have the "free" compiler. I have the complete set of MSVC++ 6.0, MSVS.NET, and MSVS.NET2003 tools. Using MSVC++ 6.0 I have generated the .mak and .dep files and then successfully used them to build NSIS with the MSVS.NET2003 compiler.<br />
      <br />
      I can provide the generated .dep and .mak files if you desire them.</p>
    </div>
    <hr />

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]>
  </script>
</body>
</html>
