<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="description" content="nsExec"><title>nsExec - NSIS Forums</title><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script><link rel="preload" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css" as="style" onload="this.rel='stylesheet'"><link rel="preload" href="../css/style.css" as="style" onload="this.rel='stylesheet'"><noscript><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css"><link rel="stylesheet" href="../css/style.css"></noscript><script>!function(a){"use strict";var b=function(b,c,d){function e(a){return h.body?a():void setTimeout(function(){e(a)})}function f(){i.addEventListener&&i.removeEventListener("load",f),i.media=d||"all"}var g,h=a.document,i=h.createElement("link");if(c)g=c;else{var j=(h.body||h.getElementsByTagName("head")[0]).childNodes;g=j[j.length-1]}var k=h.styleSheets;i.rel="stylesheet",i.href=b,i.media="only x",e(function(){g.parentNode.insertBefore(i,c?g:g.nextSibling)});var l=function(a){for(var b=i.href,c=k.length;c--;)if(k[c].href===b)return a();setTimeout(function(){l(a)})};return i.addEventListener&&i.addEventListener("load",f),i.onloadcssdefined=l,l(f),i};"undefined"!=typeof exports?exports.loadCSS=b:a.loadCSS=b}("undefined"!=typeof global?global:this);!function(a){if(a.loadCSS){var b=loadCSS.relpreload={};if(b.support=function(){try{return a.document.createElement("link").relList.supports("preload")}catch(b){return!1}},b.poly=function(){for(var b=a.document.getElementsByTagName("link"),c=0;c<b.length;c++){var d=b[c];"preload"===d.rel&&"style"===d.getAttribute("as")&&(a.loadCSS(d.href,d,d.getAttribute("media")),d.rel=null)}},!b.support()){b.poly();var c=a.setInterval(b.poly,300);a.addEventListener&&a.addEventListener("load",function(){b.poly(),a.clearInterval(c)}),a.attachEvent&&a.attachEvent("onload",function(){a.clearInterval(c)})}}}(this);</script></head><body><div class="container"><ol class="breadcrumb"><li><a href="../index.html" class="glyphicon glyphicon-home"></a></li><li><a href="f-65.html">NSIS Discussion</a></li><li class="active">nsExec</li></ol><p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=255686">nsExec</a></p><br><div class="post"><p class="post-meta"><span class="post-author text-primary">rajiv naravane</span><br><span class="post-time small text-muted">17th September 2006 18:44 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>nsExec</strong><br>Documentation says :<br>nsExec will execute command-line based programs and capture the output without opening a dos box.<br>This is really a nice feature.<br>Question is, does it behave like ExecWait and waits till the program terminates or there is error executing the program?<br>Do I need to specify any timeout option to make it behave like ExecWait()<br>Thanks</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">kichik</span><br><span class="post-time small text-muted">22nd September 2006 10:05 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Yes, it waits.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">rajiv naravane</span><br><span class="post-time small text-muted">22nd September 2006 14:47 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Thanks, Kichik. A follow up question: As part of the installation, I need to stop, remove, uninstall and reinstall one or more Windows services on Windows 2000 and Windows 2003 server platforms.<br>Currently I am using ExecWait 'net start' etc. If the service can not be stopped (and it could happens in production environment) and goes into error state, is ExecWait() going to hang? Would nsExec with timeout parameters be a better option? With nsExec I can retry and eventually pop up a dialog box indicating error -- What do you think?<br>I have seen some plugins as well which use C APIs to talk to ServiceControl manager? Is this approach any better than 'net start' etc commands when it comes to handling errors -- That's the most important thing for me.<br>Thanks for your help.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">kichik</span><br><span class="post-time small text-muted">22nd September 2006 14:53 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">The <a href="http://nsis.sourceforge.net/How_do_I_start/stop/create/remove/check_a_service" target="_blank">plug-ins</a> are built especially for handling services, so I'd imagine they have better error handling then ExecWait or nsExec for this specific case. Besides, using API is always better than a command line utility which may not have the same interface in future versions, on different languages or might not even exist in older versions of Windows.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">rajiv naravane</span><br><span class="post-time small text-muted">22nd September 2006 14:57 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Would ExecWait() hang, though or it recovers gracefully? Thanks.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">kichik</span><br><span class="post-time small text-muted">22nd September 2006 14:58 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">It'll wait until the process it executed returns. If the process hangs, it'll hang.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">rajiv naravane</span><br><span class="post-time small text-muted">22nd September 2006 15:02 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">I guess then, I have two choices to recover gracefully from errors:<br>Use nsExec with timeout, parse its output and retry or show error dialog.<br>Go for the plugin approach.</p></div><hr><div class="footer"><p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p></div></div><script src="../js/highlight.pack.js" type="text/javascript"></script><script type="text/javascript">//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]></script></body></html>