<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="DLL dependencies" />

  <title>DLL dependencies - NSIS Forums</title>
  <script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script>
  <!-- Bootstrap core CSS -->

  <link rel="stylesheet" type="text/css" href="//netdna.bootstrapcdn.com/bootswatch/3.0.1/readable/bootstrap.min.css" />
  <link rel="stylesheet" href="../css/style.css" type="text/css" /><!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!--[if lt IE 9]>
                <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
                <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->
</head>

<body>
  <div class="container">
    <!-- Put navigation bar here -->

    <ol class="breadcrumb">
      <li><a href="../index.html" class="glyphicon glyphicon-home"></a></li>

      <li><a href="f-65.html">NSIS Discussion</a></li>

      <li class="active">DLL dependencies</li>
    </ol>

    <p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=110919">DLL dependencies</a></p><br />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">aj0000009</span><br />
      <span class="post-time small text-muted">22nd October 2002 09:40 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>DLL dependencies</strong><br />
      Hi,<br />
      Is there a way in NSIS to findout the dependencies for<br />
      the installing DLL files?<br />
      When I install the package on my machine(development),<br />
      the binary works fine. But, when I install the same product<br />
      on a new machine, I get an error "ActiveX component<br />
      can't create object".<br />
      <br />
      I collected the dependencies of all the DLL for my product using<br />
      MS VB Package and Deployment Wizard... dependencies option. Is<br />
      there a better way to figuring out the dependency DLL files?<br />
      <br />
      <br />
      <br />
      :cry:</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Kypec</span><br />
      <span class="post-time small text-muted">22nd October 2002 16:48 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">try to use Process viewer which you can download from here:<br />
      <a href="http://www.prcview.com" target="_blank">http://www.prcview.com</a><br />
      <br />
      hope it will help you :)</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Koen van de Sande</span><br />
      <span class="post-time small text-muted">22nd October 2002 20:45 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">This 'error' appears frequently for users of my program too, for me it's related to several OCX/DLL files which are not correctly registered.<br />
      You may have gotten the right dependencies, but not correctly installed all the files.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">ilya31</span><br />
      <span class="post-time small text-muted">2nd August 2005 01:40 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">I get the same error: "ActiveX component<br />
      can't create object". Can somebody give me more info which OCX/DLL is causing it? I am using several tools to find the DLL/OCX that is giving me problem, but so far I was unable to find it. I am creating an installer for VB 6 application. I have used Library.nsh to install VB6 runtime.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Comperio</span><br />
      <span class="post-time small text-muted">2nd August 2005 03:41 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">I agree that it sounds like some DLL or OCX didn't get properly registered. But, it could also mean that a call is being made to another OCX/DLL that is expected to be there but isn't. (For example, Internet Explorer, DirectX, etc.)<br />
      <br />
      In order to get to the bottom of this, you'll need to try to find out is exactly what DLL/OCX you are missing and then try to manually register it. (use REGSVR32 at a Windows RUN box to register files manually. For help, run 'REGSVR32 /?') I'd probably start with the files included in the VB6 runtime.<br />
      <br />
      As far viewing dependencies, I'd use Dependency Walker (<a href="http://www.dependencywalker.com/" target="_blank">http://www.dependencywalker.com/</a>) to analzyer individual DLLS. However, keep in mind that most of these tools will not detect dynamically loaded DLLs.<br />
      <br />
      There's another tool from SysInternals called 'filemon' that might help you analyze the program in question to see what files it's trying to access. (URL: <a href="http://www.sysinternal.com" target="_blank">www.sysinternal.com</a>) Then you can compare this list to the list on your developer machine to see what may be missing on the test machine. (filemon allows you to filter a process using wildcards so that you get a list of just the files used by a particular process.)</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">ilya31</span><br />
      <span class="post-time small text-muted">3rd August 2005 01:41 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Thank you Comperio for your advise. I am still trying to figure out the problem. I have used Dependency Walker and Filemon like you suggested.<br />
      <br />
      I think I figured out what the problem is.<br />
      <br />
      Here is the output of the Dependency Walker where my program crashes:<br />
      <br />
      LoadLibraryW("OLE32.DLL") called from "OLE32.DLL" at address 0x774FD899.<br />
      LoadLibraryW("OLE32.DLL") returned 0x774E0000.<br />
      <br />
      I checked the search path on the computer where my application runs using VB installer.<br />
      <br />
      Search Path: C:\WINDOWS\system32;C:\WINDOWS;C:\WINDOWS\System32\Wbem;C:\Program Files\Common Files\GTK\2.0\bin<br />
      <br />
      The search path on the test machine is the following:<br />
      <br />
      Search Path: C:\WINDOWS\system32;C:\WINDOWS;C:\WINDOWS\System32\Wbem<br />
      <br />
      It is missing C:\Program Files\Common Files\GTK\2.0\bin, so I guess that's why it cannot find some DLL which are located in Program Files\Common Files folder.<br />
      <br />
      How do I add the missing directory to the Search path of my application using NSIS? Which registry contains an entry to the path variable?</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Comperio</span><br />
      <span class="post-time small text-muted">3rd August 2005 04:27 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">This should help:<br />
      <a href="http://nsis.sourceforge.net/wiki/Setting_Environment_Variables" target="_blank">http://nsis.sourceforge.net/wiki/Set...ment_Variables</a></p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">ilya31</span><br />
      <span class="post-time small text-muted">4th August 2005 01:55 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">I am still trying to figure out the problem to this error.<br />
      The path stuff is fine and it was not the problem. I hate DLL errors, they are very hard to track down.<br />
      <br />
      Using Regmon, which is a tool for monitoring accesses to registry I figured out that my program blows up when<br />
      it is trying to access the HKCR\CLSID\9289FAC-xxxx registry. This registry does not exist. Using VB installer, when I installed my application I checked that this registry contains AccuObjects.clsCompany which is inside AccuObjects.dll (dll that contains compiled code for my company's application). When I checked on the test PC AccuObjects.dll with all the classes is there in the registry but under different CLSID. How can I fix this problem? All the application's DLLs are there but under different CLSID then what the system looks for when I run my application.<br />
      <br />
      In my NSIS code I registered all DLLs for my application using Library.nsh. This is very time consuming to track and fix this DLL errors.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">ilya31</span><br />
      <span class="post-time small text-muted">4th August 2005 19:36 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Using another tool ListDlls, I figured out that 2 Dlls for my applications are not hetting loaded. I registered them manually using regsvr32 command. Why are they not getting loaded eventhough they are registered? Any ideas would be great.</p>
    </div>
    <hr />

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]>
  </script>
</body>
</html>
