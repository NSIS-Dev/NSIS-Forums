<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="Don't Have Write Access?!" />

  <title>Don't Have Write Access?! - NSIS Forums</title>
  <script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script>
  <!-- Bootstrap core CSS -->

  <link rel="stylesheet" type="text/css" href="//netdna.bootstrapcdn.com/bootswatch/3.0.1/readable/bootstrap.min.css" />
  <link rel="stylesheet" href="../css/style.css" type="text/css" /><!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!--[if lt IE 9]>
                <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
                <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->
</head>

<body>
  <div class="container">
    <!-- Put navigation bar here -->

    <ol class="breadcrumb">
      <li><a href="../index.html" class="glyphicon glyphicon-home"></a></li>

      <li><a href="f-65.html">NSIS Discussion</a></li>

      <li class="active">Don't Have Write Access?!</li>
    </ol>

    <p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=280057">Don't Have Write Access?!</a></p><br />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">torpark</span><br />
      <span class="post-time small text-muted">26th October 2007 18:45 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>Don't Have Write Access?!</strong><br />
      Some users, who are admin, logged into their box, can't write to C:\Program Files\SomeDirectory etc. What is going on? How can this be? There are no programs like Norton running preventing access, yet when a routine to write a file is run to check privs, the user doesn't appear to have the capability.<br />
      <br />
      Is there anything else we can do or find out what is going on?<br />
      <br />
      I tried first using RequestExecutionLevel to user, then none, and now admin. All with the same effect. This is driving me crazy that the installer, and this installer alone, somehow doesn't have permission that even the user has.<br />
      <br />
      Please help.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
      <span class="post-time small text-muted">26th October 2007 19:07 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">RequestExecutionLevel is for Vista only. Does this happen on Vista? If so, it's UAC. You have to pass the UAC prompt in order to write anything to Program Files.<br />
      <br />
      If it's not Vista, it's probably some left over privileges on the folder or its parent folder. NSIS doesn't modify any privileges unless told so. Try completely removing the folder and install again.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">torpark</span><br />
      <span class="post-time small text-muted">26th October 2007 19:39 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Happen to some users in both XP and Vista. Left over privileges from what? We just created the directory, and then can't write to it.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Joel</span><br />
      <span class="post-time small text-muted">27th October 2007 01:08 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">I can't reproduce the problem in XP.<br />
      I don't know, maybe I didn't read well the first topic, but seems that the directory is been scanning during the creation from a 3rd part app...just maybe.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
      <span class="post-time small text-muted">27th October 2007 11:35 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Check the access control lists on the Program Files folder.<br />
      Properties&gt;Security (make sure Use simple file sharing is unchecked in Folder Options).<br />
      <br />
      Stu</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">torpark</span><br />
      <span class="post-time small text-muted">29th October 2007 01:52 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Problem Found!<br />
      <br />
      CreateDirectory created the program files directory as read-only. How did that happen? How do we change that?</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
      <span class="post-time small text-muted">29th October 2007 10:29 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Why should you use CreateDirectory to create it? Surely it will already exist? Use SetFileAttributes.<br />
      <br />
      Stu</p>
    </div>
    <hr />

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]>
  </script>
</body>
</html>
