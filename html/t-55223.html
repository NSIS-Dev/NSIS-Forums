<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="description" content="Installer Self-deletion"><title>Installer Self-deletion - NSIS Forums</title><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script><link rel="preload" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css" as="style" onload="this.rel='stylesheet'"><link rel="preload" href="../css/style.css" as="style" onload="this.rel='stylesheet'"><noscript><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css"><link rel="stylesheet" href="../css/style.css"></noscript><script>!function(a){"use strict";var b=function(b,c,d){function e(a){return h.body?a():void setTimeout(function(){e(a)})}function f(){i.addEventListener&&i.removeEventListener("load",f),i.media=d||"all"}var g,h=a.document,i=h.createElement("link");if(c)g=c;else{var j=(h.body||h.getElementsByTagName("head")[0]).childNodes;g=j[j.length-1]}var k=h.styleSheets;i.rel="stylesheet",i.href=b,i.media="only x",e(function(){g.parentNode.insertBefore(i,c?g:g.nextSibling)});var l=function(a){for(var b=i.href,c=k.length;c--;)if(k[c].href===b)return a();setTimeout(function(){l(a)})};return i.addEventListener&&i.addEventListener("load",f),i.onloadcssdefined=l,l(f),i};"undefined"!=typeof exports?exports.loadCSS=b:a.loadCSS=b}("undefined"!=typeof global?global:this);!function(a){if(a.loadCSS){var b=loadCSS.relpreload={};if(b.support=function(){try{return a.document.createElement("link").relList.supports("preload")}catch(b){return!1}},b.poly=function(){for(var b=a.document.getElementsByTagName("link"),c=0;c<b.length;c++){var d=b[c];"preload"===d.rel&&"style"===d.getAttribute("as")&&(a.loadCSS(d.href,d,d.getAttribute("media")),d.rel=null)}},!b.support()){b.poly();var c=a.setInterval(b.poly,300);a.addEventListener&&a.addEventListener("load",function(){b.poly(),a.clearInterval(c)}),a.attachEvent&&a.attachEvent("onload",function(){a.clearInterval(c)})}}}(this);</script></head><body><div class="container"><ol class="breadcrumb"><li><a href="../index.html" class="glyphicon glyphicon-home"></a></li><li><a href="f-65.html">NSIS Discussion</a></li><li class="active">Installer Self-deletion</li></ol><p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=55223">Installer Self-deletion</a></p><br><div class="post"><p class="post-meta"><span class="post-author text-primary">Kreft</span><br><span class="post-time small text-muted">19th July 2001 15:41 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">is it possible to make the installer remove itself once it has been run?</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Gonzotek</span><br><span class="post-time small text-muted">19th July 2001 16:49 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Yes...sort of.<br><br>You'll need to write an .nsi script(install.nsi) that writes the location it is being run from to a registry string.<br><br>Then write a seperate .nsi script(delete.nsi) that will read from the registry the directory that install.nsi put there. Put the result in a user variable ($1). You'll need to play around with SLEEP to see how long it takes for install.nsi to close. Then DELETE $1.<br><br>Compile delete.nsi and then you can include it in your main installer (install.nsi). If you extract it to temp and run it just before you come to the end of the installation. Install.exe should quit after launching delete.exe from temp, then delete.exe should delete the installer. you are left with a ~32k delete.exe in the temp directory, which will of course eventually get overwritten. Anyone know of an easier way to do this?<br><br>I could post example code, but the documentation should cover everything you need for this.<br>-=Gonzotek=-</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Edgewize</span><br><span class="post-time small text-muted">19th July 2001 19:33 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Simple:<br><br>Delete /REBOOTOK installer.exe<br><br>The only trick is that you have to know the path and file name of your own installer ... that's a tricky bit I can't figure out yet.<br></p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Kreft</span><br><span class="post-time small text-muted">19th July 2001 20:42 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>thanks</strong><br>that should give me enough info to do what i want... but i would very appreciative if this were made a little simpler by simply adding a 'melt on run' option</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Edgewize</span><br><span class="post-time small text-muted">20th July 2001 06:39 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">I still don't understand why anyone would *want* a 'melt-on-run' option?<br><br>Every time I come up with a reason for it, I just as quickly come up with a reason why it is a bad idea.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Kreft</span><br><span class="post-time small text-muted">20th July 2001 09:06 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Upgrades and selfextractors.. like if it is just a pretty package for a movie or something large that you wouldnt want to hang on to..</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">prodangle</span><br><span class="post-time small text-muted">20th July 2001 16:11 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">if i download something and run it I expect it to still be there - someone might want to still have it after a re-install, or install the stuff on other machines. If the user wants the installer gone they can easily delete it themselves. taking that amount of control away from the user is a bit scary - it definetly scares me shitless anyway. One thing I can think of right away installs like that - the Back Orifice server... I dont think Justin wanted NSIS to be used for wrecking folks computers ;)</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">prodangle</span><br><span class="post-time small text-muted">20th July 2001 16:15 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">if i download something and run it I expect it to still be there - someone might want to still have it after a re-install, or install the stuff on other machines. If the user wants the installer gone they can easily delete it themselves. taking that amount of control away from the user is a bit scary - it definetly scares me shitless anyway. One thing I can think of right away installs like that - the Back Orifice server... I dont think Justin wants NSIS to be used for wrecking folks computers so we're probably unlikely to see a /melt-on-run switch</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">prodangle</span><br><span class="post-time small text-muted">20th July 2001 16:17 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">man, these forums are knackered (or maybe its my connection) that's my excuse for posting that twice anyway (like throwing up a third post makes up for it :confused: )</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">saivert</span><br><span class="post-time small text-muted">5th August 2001 08:03 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>Microsoft style of doing things</strong><br>What you are talking about here is what MS might have done.<br>If they didn't want you to fickle with any update installer they could do a "melt-on-run" with the installer.<br>Ofcourse the correct instruction for this is (as per 1.44 of NSIS):<br>Function .onInstSuccess<br>Delete $EXEPATH\installer.exe /REBOOTOK<br>; Now if the installation fails we still can run the installer again.<br>FunctionEnd<br>Ofcourse if the installer was renamed this wouldn't work.<br>For that we would need a GetModuleFileName() Win32 API instruction wrapper (GetModuleFilename $0-9) or a $EXEFILE variable. Maybe even a DeleteInstaller macro. Nah!...</p></div><hr><div class="footer"><p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p></div></div><script type="text/javascript" src="../js/highlight.pack.js" async></script><script type="text/javascript">//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]></script></body></html>