<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="description" content="Compiling Win64 installer on 32bit system"><title>Compiling Win64 installer on 32bit system - NSIS Forums</title><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script><link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css"><link rel="stylesheet" href="../css/style.css" type="text/css"><!--[if lt IE 9]><script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script><script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script><![endif]--></head><body><div class="container"><ol class="breadcrumb"><li><a href="../index.html" class="glyphicon glyphicon-home"></a></li><li><a href="f-65.html">NSIS Discussion</a></li><li class="active">Compiling Win64 installer on 32bit system</li></ol><p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=241507">Compiling Win64 installer on 32bit system</a></p><br><div class="post"><p class="post-meta"><span class="post-author text-primary">ncsengodi</span><br><span class="post-time small text-muted">22nd March 2006 10:39 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>Compiling Win64 installer on 32bit system</strong><br>I tried compile 64bit installer on a 32bit system in this way:<br>1. Compiling Exehead's and ui's for AMD64<br>2. Replacing the binaries in the NSIS directory strcuture with the 64bit version<br>3. Compiling the script with the 32bit version of makensis<br><br>The compilation process was broken at the ChangeUI command.<br>( I use ModernUI )<br><br>Is there any solution for my problem?</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">kichik</span><br><span class="post-time small text-muted">23rd March 2006 18:13 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Not yet. The resource editor can't edit 64-bit resources. You can try simply replacing the the structure definitions with the 64-bit version. It might work.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">ncsengodi</span><br><span class="post-time small text-muted">24th March 2006 15:10 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">I changed the _IMAGE_NT_HEADERS struct to _IMAGE_NT_HEADERS64, but in _IMAGE_NT_HEADERS64 struct's sub element IMAGE_OPTIONAL_HEADER64 no more BaseOfData member.<br><br>After commenting out two lines in ResourceEditor.cpp (318 and 319) the compilation finished, but the makensis.exe tried to read the stub from it's own file.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">kichik</span><br><span class="post-time small text-muted">24th March 2006 15:57 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">What do you mean by saying makensis.exe is trying to read the stub from its own file? The stub file should have no affect here. It's read into memory before the resource editor gets into action. Or are you no longer talking about the resource editor? What error message does it show?</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">ncsengodi</span><br><span class="post-time small text-muted">29th March 2006 16:58 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">I don't remember the real message.<br>The makensis.exe tried to read the "...makensis.exe/zlib" stub.<br><br>I tried again the modification with the original source code of 2.15 and I made it. :D<br><br>I modified the ResourceEditor.h/.c and the plugin.c.<br>Both were IMAGE_NT_HEADERS64 dependent.<br><br>Compiling the stub-s to amd64 is strange because memset amd memcpy functions are needed. :weird:<br>Appending memset.c and memcpy.c from the source package to the files list in Sconscript file wasn't a good way for me. I added the libc.lib to the libs.<br><br>I cannot compile the system plugin.<br>There are three naked functions and the compilert don't support inline assembly.<br><br>----------------------------------------------<br>I have the worst english knowledge. Sorry. :D</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">ncsengodi</span><br><span class="post-time small text-muted">29th March 2006 17:09 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>XPStyle</strong><br>One more thing:<br><br>In the szXPManifest XML string the processorArchitecture property must be Amd64 or Ia64.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">kichik</span><br><span class="post-time small text-muted">31st March 2006 13:44 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Do the generated installers actually work? There are some "unsafe" casts in the code which are a bit too much over to the unsafe side. For example, the blocks loading loop in loadHeaders forces a 64-bit pointer to a 32-bit integer. Those block pointers are then used everywhere in the code.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">ncsengodi</span><br><span class="post-time small text-muted">31st March 2006 14:48 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">I haven't solved any cast warning in the code.<br>It works without any problem at this moment.</p></div><hr><div class="footer"><p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p></div></div><script src="../js/highlight.pack.js" type="text/javascript"></script><script type="text/javascript">//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]></script></body></html>