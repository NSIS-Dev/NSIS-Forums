<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="description" content="VB Runtime and Multiple OS installation"><title>VB Runtime and Multiple OS installation - NSIS Forums</title><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script><link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css"><link rel="stylesheet" href="../css/style.css" type="text/css"></head><body><div class="container"><ol class="breadcrumb"><li><a href="../index.html" class="glyphicon glyphicon-home"></a></li><li><a href="f-65.html">NSIS Discussion</a></li><li class="active">VB Runtime and Multiple OS installation</li></ol><p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=204800">VB Runtime and Multiple OS installation</a></p><br><div class="post"><p class="post-meta"><span class="post-author text-primary">pedro56</span><br><span class="post-time small text-muted">13th January 2005 11:13 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>VB Runtime and Multiple OS installation</strong><br>I have a program I wrote in VB6 which requires VB runtime files such as OLEAUT32.DLL however when installed on Windows 98 any programs using InstallShield no longer function due to new dll file version. Should I modify script to check if VB runtime files exist and only copy to Windows system if they don't exist ? The only file that appears to be missing from Windows 98 is msvbvm60.dll which should be in system32 folder. I now this is a common problem but doesn't appear to be a simple solution.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">kichik</span><br><span class="post-time small text-muted">13th January 2005 20:25 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Have you deployed OLEAUT32.DLL from Microsoft's redistributables, or from your own system directory? If you've used the DLL from your own system directory, that's probably the source of the problem.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">pedro56</span><br><span class="post-time small text-muted">13th January 2005 23:33 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">The runtime files were from my systerm (XP) so I took out all VB runtime files from NSIS script. The program only works in Windows 98 if msvbvm60.dll is in Windows/System32. I have many clients who still have an old OS so I need it compatible to 98, ME, NT,&amp; 2000. I am worried that if I include msvbvm60.dll it may cause problems with other OS which I can't test on.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Joost Verburg</span><br><span class="post-time small text-muted">14th January 2005 10:38 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Never copy any files from your own system folder, these files are only compatible with Windows XP. The OLE files in the VB6 runtimes from Microsoft are only intented to update older Windows version.<br><br>NSIS can handle all these things automatically, just copy the code from the documentation and use official Microsoft files as described.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">pedro56</span><br><span class="post-time small text-muted">15th January 2005 11:12 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Thanks. Installed vbrun60sp5.exe downloaded from MS on a clean install of Win98 SE. I included script from here into my setup script: <a href="http://nsis.sourceforge.net/archive/viewpage.php?pageid=47" target="_blank">http://nsis.sourceforge.net/archive/....php?pageid=47</a><br><br>Do I need to copy all dlls mentioned or can I modify to include only msvbvm60.dll as it appears this dll is the only one my app needs or are they all needed for Windows 95, NT, 2000 etc ?</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">kichik</span><br><span class="post-time small text-muted">15th January 2005 11:29 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">You should include all of them since that's what Microsoft does. msvcvm60.dll probably depends on the others.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">pedro56</span><br><span class="post-time small text-muted">15th January 2005 12:12 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">I am sure you are right with dependancies between dlls so I will include all "distributable" VB Runtime files listed.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">pedro56</span><br><span class="post-time small text-muted">16th January 2005 05:01 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Tested with "redistributable" runtime files and appears OK. Visual Studio Package &amp; Deployment Wizard included mci32.ocx (multimedia control), msrd2x35.dll (MS Jet ODBC) and vb6stkit.dll (VB Setup Toolkit Library). I understand vb6stkit.dll is possibly not required but I didn't select ODBC in wizard and leaving out all doesn't appear to affect correct running of my app. Should I include some or all the same way as runtime files or just copy to windows system?</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">tsugio</span><br><span class="post-time small text-muted">18th January 2005 17:18 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">I found the best way to make sure you include everything you need is to use the Package &amp; Deployment wizard before using NSIS. This will create a directory with all the dependencies for your project and you can simply add those files to your NSIS installation.<br><br>HTH.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">kichik</span><br><span class="post-time small text-muted">18th January 2005 18:19 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">If it's a redistributable and is placed in the system directory, it's always a good idea to not just copy it. Your installer might contain an older version than the one on the system, and simply overwriting is not a good idea in such cases. Also, if it requires registration, simply copying it won't do.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">pedro56</span><br><span class="post-time small text-muted">23rd January 2005 01:56 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Modified script to include MCI32.OCX<br>and MSRD2X35.DLL which Package &amp; Deployment wizard listed. I have attached script for information. I am not sure about !insertmacro InstallLib REGDLL $ALREADY_INSTALLED REBOOT_NOTPROTECTED whether it should be REBOOT_NOTPROTECTED or REBOOT_PROTECTED.</p></div><hr><div class="footer"><p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p></div></div><script src="../js/highlight.pack.js" type="text/javascript"></script><script type="text/javascript">//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]></script></body></html>