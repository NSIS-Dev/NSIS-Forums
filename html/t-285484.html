<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="Close page window automaticly and safely?" />

  <title>Close page window automaticly and safely? - NSIS Forums</title>
  <script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script>
  <!-- Bootstrap core CSS -->

  <link rel="stylesheet" type="text/css" href="//netdna.bootstrapcdn.com/bootswatch/3.0.1/readable/bootstrap.min.css" />
  <link rel="stylesheet" href="../css/style.css" type="text/css" /><!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!--[if lt IE 9]>
                <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
                <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->
</head>

<body>
  <div class="container">
    <!-- Put navigation bar here -->

    <ol class="breadcrumb">
      <li><a href="../index.html" class="glyphicon glyphicon-home"></a></li>

      <li><a href="f-65.html">NSIS Discussion</a></li>

      <li class="active">Close page window automaticly and safely?</li>
    </ol>

    <p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=285484">Close page window automaticly and safely?</a></p><br />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">lovespy108</span><br />
      <span class="post-time small text-muted">23rd January 2008 01:00 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>Close page window automaticly and safely?</strong><br />
      Var AlreadySetup<br />
      Var Modify<br />
      <br />
      !macro MAINTENANCE<br />
      page custom ModifyShow ModifyLeave<br />
      !macroend<br />
      <br />
      !insertmacro MAINTENANCE //my own macro<br />
      !insertmacro MUI_PAGE_WELCOME<br />
      <br />
      Function .onInit<br />
      ...<br />
      IfFileExists "$INSTDIR\myApplication.exe" 0 +3<br />
      StrCpy $AlreadySetup 1<br />
      goto End<br />
      ...<br />
      End:<br />
      FunctionEnd<br />
      <br />
      Function ModifyShow<br />
      <br />
      ${If} $AlreadySetup == 1<br />
      InstallOptions::initDialog /NOUNLOAD "$R0\modify.ini"<br />
      InstallOptions::show<br />
      ${EndIf}<br />
      <br />
      FunctionEnd<br />
      <br />
      Function ModifyLeave<br />
      <br />
      ReadINIStr $Modify "$R0\modify.ini" "Field 2" "State"<br />
      ${If} $Modify == 0<br />
      ExecShell "open" "$INSTDIR\uninst.exe"<br />
      ************************************************<br />
      my problem is at here?????????<br />
      ************************************************<br />
      ${Else}<br />
      Call RunOrNot //call my own function<br />
      ${EndIf}<br />
      <br />
      FunctionEnd<br />
      ----------------------------------------------------------<br />
      How to realize the following purpose?<br />
      -After it executed [ExecShell...] ,I want that the custom page window can close automaticly and safely.Then the setup is finished at here.<br />
      ----------------------------------------------------------<br />
      <br />
      Thanks very much for help!!!:up: :up: :up: :up:</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Animaether</span><br />
      <span class="post-time small text-muted">23rd January 2008 01:09 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">simply call Quit?<br />
      <br /></p>

      <blockquote>
        4.9.4.17 Quit<br />
        Causes the installer to exit as soon as possible. After Quit is called, the installer will exit (no callback functions will get a chance to run).
      </blockquote>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">lovespy108</span><br />
      <span class="post-time small text-muted">23rd January 2008 01:18 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Thank you! It can work so well.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Animaether</span><br />
      <span class="post-time small text-muted">23rd January 2008 01:47 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">just make sure you don't have any cleanup code in any callbacks that would normally run when the installer finishes. If you do, you'll have to either duplicate that cleanup code, or use a different method instead. E.g. in an installer I maintain, a 'skip' variable is set to true and each page calls Abort if that variable is true - thereby skipping that page.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">lovespy108</span><br />
      <span class="post-time small text-muted">23rd January 2008 02:58 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Yes.I did that like your method.I found that way occasionally.@_@^_^:p</p>
    </div>
    <hr />

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]>
  </script>
</body>
</html>
