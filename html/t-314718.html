<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="description" content="Work with $DOCUMENTS"><title>Work with $DOCUMENTS - NSIS Forums</title><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script><link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css"><link rel="stylesheet" href="../css/style.css" type="text/css"></head><body><div class="container"><ol class="breadcrumb"><li><a href="../index.html" class="glyphicon glyphicon-home"></a></li><li><a href="f-65.html">NSIS Discussion</a></li><li class="active">Work with $DOCUMENTS</li></ol><p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=314718">Work with $DOCUMENTS</a></p><br><div class="post"><p class="post-meta"><span class="post-author text-primary">CG!</span><br><span class="post-time small text-muted">19th November 2009 12:13 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>Work with $DOCUMENTS</strong><br>As the thread title says, my installer works with the $DOCUMENT folder by extracting some files there and starting an program afterwards (detected by reading the registry) wich is working with the installed files.<br>But the program always says "fail".<br>So i tried the UAC plugin. No change.<br>i did set __COMPAT_LAYER env-var for the installer and program started by it only. Still no change.<br>i even tried to add "ELEVATECREATEPROCESS" to the corresponding registry keys. But still no change.<br>i can call the prog without problems using java and "state.gThread = new GameEXEThread(cmds);".<br>But i don't want to use java but only NSiS instead.<br><br>Anyone having an idea what i'm doing wrong?</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Zinthose</span><br><span class="post-time small text-muted">24th November 2009 13:53 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><font color="blue">&lt;insert Guess/Observation&gt;</font>I think it has something to do with executing the program after installation since it was spawned from the original process tree.<font color="blue">&lt;/insert&gt;</font><br><br>I personally try to avoid executing the program after installation as it typically will retain the rights of the installer and is not always desirable.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">CG!</span><br><span class="post-time small text-muted">24th November 2009 15:18 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">i tried to start the program on it's own and with set admin rights but still no change.<br>i know a java program that starts the same prog with the above mentioned command and it works like a charm.<br>But due to the fact that i don't want to force the user to have java installed, i thought there is a pure NSiS solution.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Zinthose</span><br><span class="post-time small text-muted">24th November 2009 15:37 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Is this the error your getting?<br><br><a href="http://colinnewell.files.wordpress.com/2008/06/program-compatibility-assistant.png" target="_blank">http://colinnewell.files.wordpress.c...-assistant.png</a><a href="http://colinnewell.wordpress.com/2008/06/08/nsis-installers-and-windows-vista/" target="_blank">Image Source</a></p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Anders</span><br><span class="post-time small text-muted">24th November 2009 19:25 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">do you have RequestExecutionLevel in your script?</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">CG!</span><br><span class="post-time small text-muted">24th November 2009 19:31 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><b>@Zinthose:</b><br>Nope. The prog just says "failed to install". No UAC or other Windows based message.<br>it's installing out of $DOCUMENTS by default so there's no way i can change it.<br><br><b>@Anders:</b><br>Yep and it's set to user, which is needed when using the UAC plugin.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Anders</span><br><span class="post-time small text-muted">24th November 2009 19:52 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">are you adding uninstall registry keys?</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">CG!</span><br><span class="post-time small text-muted">24th November 2009 21:58 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">No, because they are not needed.<br>But i don't think this would solve my problem.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">pengyou</span><br><span class="post-time small text-muted">24th November 2009 22:33 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"></p><blockquote>No, because they are not needed.<br>But i don't think this would solve my problem.</blockquote>I think you are wrong about this. Here is what MSDN has to say about the Program Compatibility Assistant (PCA)<blockquote>The logic used by PCA is to detect if a setup did not complete successfully. It monitors a program detected as setup by Windows Vista and Windows Server 2008 and checks whether the program registers an entry in Add or Remove Programs (ARP). If no entries are created in ARP, PCA concludes that the installer did not complete successfully. It will then wait for the install program to terminate before displaying the UI. If it is an uninstaller, the detection looks for whether an entry was deleted from ARP.</blockquote>The UI it refers to is similar to the screenshot Zinthose supplied. See Application Compatibility: Program Compatibility Assistant (PCA):<br><br><a href="http://msdn.microsoft.com/en-us/library/bb756937.aspx" target="_blank">http://msdn.microsoft.com/en-us/library/bb756937.aspx</a></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">CG!</span><br><span class="post-time small text-muted">25th November 2009 03:22 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Erm... i don't have this problem.<br>The installation finishes successfull.<br>But i start a program which is detected by it's registry entry.<br>This program is meant to import the installed files into the detected program by calling it using the right parameters.<br>But the program says fail when trying to import the files that was placed in $DOCUMENTS using NSiS.<br>if i start this program using a java program it works just perfect by using the command mentioned in my first post.<br><br>And no, there's no way to force the program to import the files from a different directory and that's the problem.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">pengyou</span><br><span class="post-time small text-muted">25th November 2009 10:51 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"></p><blockquote>Erm... i don't have this problem.</blockquote>Sorry, I didn't notice your earlier <i>Nope. The prog just says "failed to install"</i> reply.</div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Anders</span><br><span class="post-time small text-muted">25th November 2009 11:01 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"></p><blockquote><i>Originally posted by CG!</i><br><b>Erm... i don't have this problem.<br>But i start a program which is detected by it's registry entry.<br>This program is meant to import the installed files into the detected program by calling it using the right parameters.<br>But the program says fail when trying to import the files that was placed in $DOCUMENTS using NSiS.<br>if i start this program using a java program it works just perfect by using the command mentioned in my first post.<br></b></blockquote>I don't know what the hell you are even talking about. Could you explain a little better? Is this "program" written in NSIS?</div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">MSG</span><br><span class="post-time small text-muted">25th November 2009 11:19 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">I agree with Anders. CG!, please try to rephrase what you want to accomplish, what you have, and what you need.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">CG!</span><br><span class="post-time small text-muted">2nd December 2009 00:02 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">OK. Sorry for my bad explanation trys but as all of you can see, english is not my native language.<br>i'll try to explain how it works step-by-step.<br><br>1. NSiS installs files to $DOCUMENTS\Program\Plugins<br>2. NSiS starts the local software (found using the registry)<br>3. the started software accesses $DOCUMENTS\Program\Plugins<br>4. the software tries to install the Plugins<br>5. the software tells the user that it failed installing<br><br>A similar fan-made program, that is written in java, uses the in the first post mentioned command and it works.<br>if i start the program myself (with admin rights), it fails.<br>if i use the NSiS UAC plugin, it fails too.<br>Same if i set the __COMPAT_LAYER variable and the corresponding registry keys to elevate the process.<br><br>Hope i could make things more clear now.<br><br><br>And sorry for the late answer, but i switched my iSP and it didn't works as seemless as planed because my old iSP dc'ed me 5 days to earlie.<br>Sorry again, but sh... things happen.</p></div><hr><div class="footer"><p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p></div></div><script src="../js/highlight.pack.js" type="text/javascript"></script><script type="text/javascript">//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]></script></body></html>