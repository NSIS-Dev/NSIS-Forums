<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="description" content="Double variable expansion"><title>Double variable expansion - NSIS Forums</title><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script><link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css"><link rel="stylesheet" href="../css/style.css" type="text/css"><!--[if lt IE 9]><script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script><script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script><![endif]--></head><body><div class="container"><ol class="breadcrumb"><li><a href="../index.html" class="glyphicon glyphicon-home"></a></li><li><a href="f-65.html">NSIS Discussion</a></li><li class="active">Double variable expansion</li></ol><p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=282158">Double variable expansion</a></p><br><div class="post"><p class="post-meta"><span class="post-author text-primary">wraithdu</span><br><span class="post-time small text-muted">26th November 2007 21:31 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>Double variable expansion</strong><br>Is there a way to make NSIS do double variable expansions? I'm trying to set some environment variables that are read from an INI file. The values in the INI file reference variables set in the launcher. For ex the INI has sections like -<br><br>[1]<br>name=TCDrive<br>value=$MEDIAROOT<br><br>The var $MEDIAROOT is derived in the launcher. The name and value are read from the INI into $R0 and $R1, and the System call uses "$R0" and "$R1". What I get is an environment variable like (type set at command prompt) -<br><br>TCDrive=$MEDIAROOT<br><br>So how can I get NSIS to do the double expansion so I get the correct env var?</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">kichik</span><br><span class="post-time small text-muted">26th November 2007 23:24 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">You'll have to manually implement that as all of the expansion is done in the compiler at build time and the installer itself doesn't know how to expand them. The installer itself isn't even aware the variables have names.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">wraithdu</span><br><span class="post-time small text-muted">27th November 2007 01:43 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Do you have any tips on how I should go about doing that? I've got no idea. Also, how is that possible that all expansion is done at compile time? Any of the contstants must be expanded at runtime as they change from system to system and based on the current script directory.<br><br>Anyways, I can't figure out how to accomplish what I want. Reading from the INI seems to cause the problem.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">kichik</span><br><span class="post-time small text-muted">27th November 2007 17:59 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">You can use the <a href="http://nsis.sourceforge.net/Docs/AppendixE.html" target="_blank">WordReplace function</a>.<br><br>The variables aren't actually expanded at compile-time. That was wrong term usage on my end. But they are stripped of their names and assigned a number, so the installer doesn't know of names at all.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">wraithdu</span><br><span class="post-time small text-muted">28th November 2007 05:55 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Thanks! My brain just needed a kick in the right direction. Works like a charm now :)</p></div><hr><div class="footer"><p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p></div></div><script src="../js/highlight.pack.js" type="text/javascript"></script><script type="text/javascript">//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]></script></body></html>