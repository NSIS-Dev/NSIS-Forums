<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="description" content="Problems passing parameters using ExecWait"><title>Problems passing parameters using ExecWait - NSIS Forums</title><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script><link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css"><link rel="stylesheet" href="../css/style.css" type="text/css"><!--[if lt IE 9]><script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script><script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script><![endif]--></head><body><div class="container"><ol class="breadcrumb"><li><a href="../index.html" class="glyphicon glyphicon-home"></a></li><li><a href="f-65.html">NSIS Discussion</a></li><li class="active">Problems passing parameters using ExecWait</li></ol><p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=307199">Problems passing parameters using ExecWait</a></p><br><div class="post"><p class="post-meta"><span class="post-author text-primary">fmbulah</span><br><span class="post-time small text-muted">8th June 2009 19:18 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>Problems passing parameters using ExecWait</strong><br>Hello,<br><br>I am trying to launch the JRE installer using ExecWait and pass in the installation directory to install to a specific directory inside the installation:<br><br>File "jre-1_5_0_10-windows-i586-p.exe"<br>ExecWait '"$OUTDIR\jre-1_5_0_10-windows-i586-p.exe" INSTALLDIR=$INSTDIR\jre'<br><br>It fails and brings up the Windows Installer error dialog which at the top says<br>"msiexec /Option &lt;Required Parameter&gt; [Optional Parameter]"<br><br>I suspect this is happening because it somehow is not recognizing the INSTALLDIR parameter.<br><br>I've tried enclosing the entire parameter string in quotes and enclosing just the value ($INSTDIR\jre) in quotes and neither works.<br><br>It works if I run it from a Windows command prompt.<br><br>If I leave the parameter off of the ExecWait it works but installs to the default location unless you do a 'Custom' install which is what I am trying to avoid.<br><br>Any and all ideas would be welcome and very much appreciated.<br><br>Thanks in advance.<br><br>Fred<br><a href="mailto:fbulah@progress.com">fbulah@progress.com</a></p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br><span class="post-time small text-muted">8th June 2009 19:25 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">What if $INSTDIR has spaces in it? You should put double quotes around your command line parameter as well.<br><br>Stu</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">fmbulah</span><br><span class="post-time small text-muted">8th June 2009 19:40 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Hi Stu,<br><br>Thanks for the reply. As I described in the message, I tried putting quotes around $INSTDIR and also tried putting quotes around INSTALLDIR=$INSTDIR\jre neither of which worked. I tried putting quotes just around $INSTDIR and that also did not work.<br><br>I'm just about ready to pull what little hair I have left out. :)</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br><span class="post-time small text-muted">8th June 2009 21:28 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Ah sorry for missing that. Maybe this will help you:<br><a href="http://java.sun.com/j2se/1.4.2/docs/guide/plugin/developer_guide/silent.html" target="_blank">http://java.sun.com/j2se/1.4.2/docs/...de/silent.html</a><br><br>Stu</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">fmbulah</span><br><span class="post-time small text-muted">8th June 2009 22:43 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Thanks for the pointer. I think I've tried every permutation ... except the right one. :)<br><br>Here's what I have now:<br><br>ExecWait '"$OUTDIR\jre-1_5_0_10-windows-i586-p.exe" /s /v "/qn ADDLOCAL=ALL IEXPLORER=1 MOZILLA=1 INSTALLDIR=$INSTDIR\jre /L $INSTDIR\jre.log"' $0<br><br>There is even an inconsistency in the instructions (surprise?): at the top it says to use /s /sv /qn " ... " while later on it says to use /s /v "/qn ... "<br><br>Tried both ways but still to no avail ... going to give it one more shot.<br><br>Ugggh!!</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">jpderuiter</span><br><span class="post-time small text-muted">8th June 2009 23:55 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">As stated in the first note on the java page mentioned by Afrow UK no space should be used between /v and the quote since you install it as a "Windows Offline Installation".<br><br>JP</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">fmbulah</span><br><span class="post-time small text-muted">9th June 2009 00:35 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Thanks for the response JP. As I described, I tried all permutations both with and without the space. I'll try once more just to make sure there was no cockpit error on my part.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">jpderuiter</span><br><span class="post-time small text-muted">9th June 2009 07:30 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">There are actually a couple of posts about installing jre.<br>You should use an escape character before the quotes in the parameter, so that the parser keeps them ($\" instead of "):</p><pre>
<code>ExecWait '"$OUTDIR\jre-1_5_0_10-windows-i586-p.exe" /s /v$\"/qn ADDLOCAL=ALL IEXPLORER=1 MOZILLA=1 INSTALLDIR=$INSTDIR\jre /L $INSTDIR\jre.log$\"' $0</code>
</pre>Why are you using an outdated version anyway?<br>JRE is at Version 6 Update 13 now.<br><a href="http://www.java.com/en/download/manual.jsp" target="_blank">http://www.java.com/en/download/manual.jsp</a></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">fmbulah</span><br><span class="post-time small text-muted">9th June 2009 15:16 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Thanks for pointing out the need for an escape sequence ... good observation. I knew it would come down to something simple and somehow this did not dawn on me.<br><br>Unfortunately the bad news is that I cut-and-pasted this exactly and it still did not work. It seemed to take a bit longer before ultimately displaying the Windows Installer error dialog, however. Needless to say this is incredibly frustrating because I thought this was it.<br><br>NB: The return code - value of $0 - is 1639. I should have mentioned this before. I Google'd this but haven't found anything yet. Does this ring a bell?<br><br>NB2: This installer is for a specific project for one of our customers that uses an older version of our software (Progress Apama) with 1.5_10.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">jpderuiter</span><br><span class="post-time small text-muted">9th June 2009 17:57 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">OK, so msiexec doesn't like spaces in it's parameters.<br>I wasn't able to work around this by using quotes.<br>But I got it working using the short "DOS" version of a path, like c:\progra~1:</p><pre>
<code>File "jre-1_5_0_10-windows-i586-p.exe"<br>GetFullPathName /SHORT $0 $INSTDIR<br>ExecWait '"$OUTDIR\jre-1_5_0_10-windows-i586-p.exe" /s /v$\"/qn ADDLOCAL=ALL IEXPLORER=1 MOZILLA=1 INSTALLDIR=$0\jre /L $0\jre.log$\"' $1<br></code>
</pre><br>
      Not sure if it works on Vista though...<br>
      <br>
      Else you have to install it to a path without spaces...<br>
      <br>
      JP
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">fmbulah</span><br>
      <span class="post-time small text-muted">9th June 2009 18:34 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Eureka ... this worked! Now I don't have to jump out the MS Window. :)<br>
      <br>
      Thanks a ton ... your help is truly appreciated and your perseverance is to be commended.<br>
      <br>
      With apologies to all MS devotees out there, MS continues to be the bane of our existence well into the 21st Century. :)</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">jpderuiter</span><br>
      <span class="post-time small text-muted">9th June 2009 19:20 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">You're welcome, I'm glad I could help.<br>
      <br>
      BTW, I forgot to search for the obvious thing: an escape character for msiexec.<br>
      It appears to be \".<br>
      Well, for NSIS this results in \$\".<br>
      Now the full line would become:</p>
      <pre>
<code>ExecWait '"$OUTDIR\jre-1_5_0_10-windows-i586-p.exe" /s /v$\"/qn ADDLOCAL=ALL IEXPLORER=1 MOZILLA=1 INSTALLDIR=\$\"$INSTDIR\jre\$\" /L \$\"$INSTDIR\jre.log\$\"$\"' $0</code>
</pre>It works, but really hard to read.<br>
      The choice is yours ;-)
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">fmbulah</span><br>
      <span class="post-time small text-muted">9th June 2009 23:40 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Thanks again and duly noted.<br>
      <br>
      But I think I may just quit while I'm ahead at this point. :)</p>
    </div>
    <hr>

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]></script></body></html>