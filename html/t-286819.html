<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="description" content="ExecWait &amp; rundll32"><title>ExecWait &amp; rundll32 - NSIS Forums</title><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script><link rel="preload" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css" as="style" onload="this.rel='stylesheet'"><link rel="preload" href="../css/style.css" as="style" onload="this.rel='stylesheet'"><noscript><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css"><link rel="stylesheet" href="../css/style.css"></noscript><script>!function(a){"use strict";var b=function(b,c,d){function e(a){return h.body?a():void setTimeout(function(){e(a)})}function f(){i.addEventListener&&i.removeEventListener("load",f),i.media=d||"all"}var g,h=a.document,i=h.createElement("link");if(c)g=c;else{var j=(h.body||h.getElementsByTagName("head")[0]).childNodes;g=j[j.length-1]}var k=h.styleSheets;i.rel="stylesheet",i.href=b,i.media="only x",e(function(){g.parentNode.insertBefore(i,c?g:g.nextSibling)});var l=function(a){for(var b=i.href,c=k.length;c--;)if(k[c].href===b)return a();setTimeout(function(){l(a)})};return i.addEventListener&&i.addEventListener("load",f),i.onloadcssdefined=l,l(f),i};"undefined"!=typeof exports?exports.loadCSS=b:a.loadCSS=b}("undefined"!=typeof global?global:this);!function(a){if(a.loadCSS){var b=loadCSS.relpreload={};if(b.support=function(){try{return a.document.createElement("link").relList.supports("preload")}catch(b){return!1}},b.poly=function(){for(var b=a.document.getElementsByTagName("link"),c=0;c<b.length;c++){var d=b[c];"preload"===d.rel&&"style"===d.getAttribute("as")&&(a.loadCSS(d.href,d,d.getAttribute("media")),d.rel=null)}},!b.support()){b.poly();var c=a.setInterval(b.poly,300);a.addEventListener&&a.addEventListener("load",function(){b.poly(),a.clearInterval(c)}),a.attachEvent&&a.attachEvent("onload",function(){a.clearInterval(c)})}}}(this);</script></head><body><div class="container"><ol class="breadcrumb"><li><a href="../index.html" class="glyphicon glyphicon-home"></a></li><li><a href="f-65.html">NSIS Discussion</a></li><li class="active">ExecWait &amp; rundll32</li></ol><p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=286819">ExecWait &amp; rundll32</a></p><br><div class="post"><p class="post-meta"><span class="post-author text-primary">fabian.rap.more</span><br><span class="post-time small text-muted">13th February 2008 17:12 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>ExecWait &amp; rundll32</strong><br>i use <font color="blue">ExecWait</font> to launch a dll using <b>rundll32.exe</b> and the dialog that appears requires input from the user. however the installer will continue its work without waiting for the dialog to close. i know that rundll32.exe has finished its job and closed so is there any way to make the installer wait till the dialog box has closed?</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Joel</span><br><span class="post-time small text-muted">13th February 2008 18:03 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Or rebuild to dll the close the dialog until the user "ends it".</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">fabian.rap.more</span><br><span class="post-time small text-muted">13th February 2008 18:43 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">i cannot do that as i am only incharge of the installer........my code is something like this<br><br><b>ExecWait "rundll32.exe dll_name.dll,FunctionName"</b><br><br>now i need to make the installer wait for the relevant details from the dialog box....... rebuilding the dll is not an option and even if it was it would take some time</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Joel</span><br><span class="post-time small text-muted">13th February 2008 18:52 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">I don't know much, is logic that if rundll.exe exits from the process before the dialog close, must be something wrong with the dll.<br>A temp solution that I can give you, is to use sleep function.<br>ExecWait finishes when rundll32 finishes, keep that in mind.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">kichik</span><br><span class="post-time small text-muted">14th February 2008 11:08 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">You can use the System plug-in to call that function instead of rundll32.exe. It should always wait for the function to return.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">fabian.rap.more</span><br><span class="post-time small text-muted">14th February 2008 17:21 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">the problem is that the dll will return an inistalisation success message and cause the system plug in to close.... it is similar to the rundll32 problem i think. the guy who made the dll says it is vital to the program and that to help out he said that it resembles the following function call::<br><br><b>rundll32.exe user32.dll,LockWorkStation</b><br><br>i transalated it into the system plugin so i could get some idea of how it works but no luck. suggestions???<br><br><b>System::Call 'user32.dll::LockWorkStation(i, *i, t) i(.r0, r1, .r2) .r3'</b></p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">fabian.rap.more</span><br><span class="post-time small text-muted">14th February 2008 17:25 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"></p><blockquote><i>Originally posted by Joel</i><br><b>must be something wrong with the dll.</b></blockquote>ah if only it were that simple........:(</div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">kichik</span><br><span class="post-time small text-muted">14th February 2008 17:33 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">In that case, there's nothing you can do. The DLL must change or you must find something else to wait for. Maybe you can wait for the window it opens to close.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">fabian.rap.more</span><br><span class="post-time small text-muted">14th February 2008 17:56 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">maybe i can use ::<br><b>FindWindow $0 '' 'Program Title'</b><br><br>but what will be the windows class???</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">kichik</span><br><span class="post-time small text-muted">14th February 2008 18:09 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">You some sort of spy, like <a href="http://www.gena01.com/win32spy/" target="_blank">win32spy</a>, to find that out. But be aware any solution like this could fail due to timing issues. The best solution would be to modify the DLL.</p></div><hr><div class="footer"><p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p></div></div><script src="../js/highlight.pack.js" type="text/javascript"></script><script type="text/javascript">//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]></script></body></html>