<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="How can I force the language to get re-read after onInit?" />

  <title>How can I force the language to get re-read after onInit? - NSIS Forums</title>
  <script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script>
  <!-- Bootstrap core CSS -->

  <link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css" />
  <link rel="stylesheet" href="../css/style.css" type="text/css" /><!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!--[if lt IE 9]>
                <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
                <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->
</head>

<body>
  <div class="container">
    <!-- Put navigation bar here -->

    <ol class="breadcrumb">
      <li><a href="../index.html" class="glyphicon glyphicon-home"></a></li>

      <li><a href="f-65.html">NSIS Discussion</a></li>

      <li class="active">How can I force the language to get re-read after onInit?</li>
    </ol>

    <p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=318551">How can I force the language to get re-read after onInit?</a></p><br />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">rgerard</span><br />
      <span class="post-time small text-muted">20th April 2010 21:31 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>How can I force the language to get re-read after onInit?</strong><br />
      For my installer, I was using the LangDialog DLL for a while to have users choose a language, but there was an issue: it's a really small window that opens, and it would commonly get "lost" on users machines. They would try to open the exe, not see the small language picker, and end up never installing.<br />
      <br />
      Instead what I did was create a droplist on the first main page that users see, which is a CustomPage I created. The custom page allows the users to select the language from a drop-down list, and in the leave function of the custom page, I copy the selection to the $LANGUAGE variable.<br />
      <br />
      The problem I'm having is that even though the $LANGUAGE variable is set correctly, the strings being used in the installer aren't the language set in $LANGUAGE. From what I'm reading in these forums, it looks like NSIS will somehow set the appropriate language to show sometime after onInit exits, but before any custom pages are shown.<br />
      <br />
      Is there a way to force the installer to re-init the language for the installer after onInit has finished and pages are showing? I've tried manually calling onInit again from my custom page (after the $LANGUAGE is set correctly), and that mostly worked, but that seems like a buggy solution, and in my case calling onInit twice causes some other problems.<br />
      <br />
      Any ideas?<br />
      <br />
      Thanks,<br />
      Ryan</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
      <span class="post-time small text-muted">22nd April 2010 14:36 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">The easiest solution would be to move your custom dialog to another NSIS executable and run that from .onInit. You can store the chosen language in the registry temporarily or pass it as the exit code (error level): <a href="http://nsis.sourceforge.net/Docs/AppendixD.html#D.1" target="_blank">http://nsis.sourceforge.net/Docs/AppendixD.html#D.1</a>.<br />
      <br />
      Stu</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">htome</span><br />
      <span class="post-time small text-muted">28th June 2010 12:17 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Hi<br />
      <br />
      I need to do the same thing with the Welcome page<br />
      <br />
      I was able to create my own Welcome nsDialog based on Welcome.nsh, but I don't even know how to populate the dropdown list with the available languages.<br />
      <br />
      Does anybody have a working code for this? An example that I can base on?<br />
      <br />
      I am new to NSIS but have this enormous task to do...<br />
      <br />
      "rgerard", have you been able to create this? Would it be possible for you to share some of your code?<br />
      <br />
      Any help is much appreciated!<br />
      <br />
      Many thanks</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Animaether</span><br />
      <span class="post-time small text-muted">28th June 2010 12:53 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"></p>

      <blockquote>
        <small>Originally posted by htome</small><br />
        I was able to create my own Welcome nsDialog based on Welcome.nsh, but I don't even know how to populate the dropdown list with the available languages.
      </blockquote>See:<br />
      <a href="http://nsis.sourceforge.net/Move_data_between_ListBoxes" target="_blank">http://nsis.sourceforge.net/Move_data_between_ListBoxes</a><br />
      and<br />
      <a href="http://forums.winamp.com/showthread.php?t=318395" target="_blank">http://forums.winamp.com/showthread.php?t=318395</a> (read full thread)
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">rgerard</span><br />
      <span class="post-time small text-muted">30th June 2010 08:49 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>Populating the drop-down list</strong><br />
      Hi htome,<br />
      <br />
      I was using InstallOptions, not nsDialogs, so it might be a bit different for you. Basically, I defined the Droplist in my INI file, like so:<br />
      <br />
      [Field 6]<br />
      Type=DropList<br />
      Left=230<br />
      Right=300<br />
      Top=125<br />
      Bottom=136<br />
      Flags=Notify<br />
      ListItems=English|Japanese|German|Dutch<br />
      <br />
      When you render the Droplist, it should have the items already. I hope that helps!</p>
    </div>
    <hr />

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]>
  </script>
</body>
</html>
