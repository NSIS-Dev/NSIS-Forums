<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="description" content="Installer Closes Without notice.."><title>Installer Closes Without notice.. - NSIS Forums</title><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script><link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css"><link rel="stylesheet" href="../css/style.css" type="text/css"></head><body><div class="container"><ol class="breadcrumb"><li><a href="../index.html" class="glyphicon glyphicon-home"></a></li><li><a href="f-65.html">NSIS Discussion</a></li><li class="active">Installer Closes Without notice..</li></ol><p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=212370">Installer Closes Without notice..</a></p><br><div class="post"><p class="post-meta"><span class="post-author text-primary">Sam_Engenuity</span><br><span class="post-time small text-muted">5th April 2005 16:57 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>Installer Closes Without notice..</strong><br>My installer calls a dll however after calling it, the installer closes by itself.<br>Is there a way to stop that? is that an error? plz help<br>Thank you</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Sam_Engenuity</span><br><span class="post-time small text-muted">5th April 2005 18:13 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">I fixed the previous problem, but now i got a similar problem. If i put ?u at the end of the system call... the installer closes by itself.<br>Thx for the help</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Sam_Engenuity</span><br><span class="post-time small text-muted">5th April 2005 18:47 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Problem fixed<br>Thank you anyways!<br><br>However i got another problem now, which might be way easier to solve. The problem is... i have to see if a directory in the registry exists.<br>How can i do this?<br>Thanks again!</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">rsegal</span><br><span class="post-time small text-muted">5th April 2005 19:53 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Get the folder you want to test for existence from the registry then make a call to IfFileExists using that folder name and tack on "*.*" as the filter.<br><br></p><pre>
<code><br>IfFileExists "&lt;my-registry-folder&gt;\*.*" 0 +2<br>print "Hey I found the folder!"<br></code>
</pre>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Sam_Engenuity</span><br>
      <span class="post-time small text-muted">5th April 2005 21:01 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">rsegal i understand what you mean ... however its not working could you give me a better example...<br>
      Thanks again!</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">rsegal</span><br>
      <span class="post-time small text-muted">6th April 2005 16:31 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"></p>

      <blockquote>
        <i>Originally posted by Sam_Engenuity</i><br>
        <b>rsegal i understand what you mean ... however its not working could you give me a better example...<br>
        Thanks again!</b>
      </blockquote>What's not working for you specifically? Does the script you create not compile? Is the call to IfFileExists not working for you?
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Sam_Engenuity</span><br>
      <span class="post-time small text-muted">6th April 2005 16:52 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Everything runs fine, thats not the problem, the problem is i dont understand the code example your wrote<br>
      <br>
      IfFileExists "&lt;my-registry-folder&gt;\*.*" 0 +2<br>
      print "Hey I found the folder!"<br>
      <br>
      What did you mean by "My registry folder", How can i put a folder from the registry in the IfFileExists?<br>
      <br>
      Heres an example of what i wrote that doesnt work<br>
      IfFileExists "HKCU Software\XXXX\XX" 0 +2<br>
      messagebox MB_OK "Hey I found the folder!"</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">rsegal</span><br>
      <span class="post-time small text-muted">6th April 2005 17:30 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"></p>

      <blockquote>
        <i>Originally posted by Sam_Engenuity</i><br>
        <b>Everything runs fine, thats not the problem, the problem is i dont understand the code example your wrote<br>
        <br>
        IfFileExists "&lt;my-registry-folder&gt;\*.*" 0 +2<br>
        print "Hey I found the folder!"<br>
        <br>
        What did you mean by "My registry folder", How can i put a folder from the registry in the IfFileExists?<br>
        <br>
        Heres an example of what i wrote that doesnt work<br>
        IfFileExists "HKCU Software\XXXX\XX" 0 +2<br>
        messagebox MB_OK "Hey I found the folder!"</b>
      </blockquote>Ok I understand now. You need to first read your folder from the registry using a call to ReadRegStr...<br>
      <pre>
<code><br>ReadRegStr $R0 HKCU "Software\XXXX\XX" "&lt;folder-registry-value&gt;"<br></code>
</pre><br>
      Where &lt;folder-registry-value&gt; is the name of the regsitry value that contains the folder name. Check the docs on ReadRegStr for more details on how it works.<br>
      <br>
      <a href="http://nsis.sourceforge.net/Docs/Chapter4.html#4.9.2" target="_blank">NSIS online docs</a><br>
      <br>
      Once you have the folder name in a register like $R0 as I've demonstrated above you can use that in the call to IfFileExists...<br>
      <pre>
<code><br>IfFileExists "$R0\*.*" 0 +2<br></code>
</pre><br>
      Again consult the docs on IfFileExists for how it works. The first param is the file you want to check for existance of which in my example case is stored in $R0. We append the "\*.*" because we are looking for a folder. Note that you may not need to append the backslash depending on how your folder is stored in the register. If you don't need to append it you would just append "*.*" to your folder name. The second parameter is a relative jump for where you want to go if the folder was found. The third parameter is a relative jump for where you want to go if the folder wasn't found.
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Sam_Engenuity</span><br>
      <span class="post-time small text-muted">6th April 2005 20:38 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Thanks alot for your help! it works!!</p>
    </div>
    <hr>

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]></script></body></html>