<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="description" content="Custom Page"><title>Custom Page - NSIS Forums</title><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script><link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css"><link rel="stylesheet" href="../css/style.css" type="text/css"><!--[if lt IE 9]><script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script><script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script><![endif]--></head><body><div class="container"><ol class="breadcrumb"><li><a href="../index.html" class="glyphicon glyphicon-home"></a></li><li><a href="f-65.html">NSIS Discussion</a></li><li class="active">Custom Page</li></ol><p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=267637">Custom Page</a></p><br><div class="post"><p class="post-meta"><span class="post-author text-primary">is99</span><br><span class="post-time small text-muted">12th March 2007 15:09 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>Custom Page</strong><br>Is it possible when I use modern UI to make a custom page without the Header ?</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Red Wine</span><br><span class="post-time small text-muted">12th March 2007 15:16 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">[Settings]<br>NumFields=#<br>Rect=1044<br><br>See IO documentation,<br><br><a href="http://nsis.sourceforge.net/Docs/InstallOptions/Readme.html" target="_blank">http://nsis.sourceforge.net/Docs/Ins...ns/Readme.html</a></p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">is99</span><br><span class="post-time small text-muted">12th March 2007 16:58 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Thanks</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">is99</span><br><span class="post-time small text-muted">13th March 2007 16:28 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">I have one very small problem with it.<br><br>When I work your way everything work great but at the bottom of the screen where there is usually "Nullsoft installation system" line this line is cut in half so I dont see the upper half of the line.<br><br>Is it possible to remove this line at all somehow or make someohow that my screen wont overlap it?</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Red Wine</span><br><span class="post-time small text-muted">13th March 2007 16:40 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><a href="http://nsis.sourceforge.net/Docs/Chapter4.html#4.8.1.6" target="_blank">http://nsis.sourceforge.net/Docs/Chapter4.html#4.8.1.6</a></p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">is99</span><br><span class="post-time small text-muted">13th March 2007 17:13 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Thanks again</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">BlueStream</span><br><span class="post-time small text-muted">9th April 2007 11:29 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">How about if you want the "content area" to have a white background like the MUI_PAGE_WELCOME and MUI_PAGE_FINISH?<br><br>I've tried putting a white bitmap in the "content area" but the labels for the checkboxes that I've included are still gray.<br><br>Is there a better way to do this?</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">kichik</span><br><span class="post-time small text-muted">9th April 2007 11:45 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Use SetCtlColors to set its background color. In the show callback function of the page, read HWND from the INI file and use it with SetCtlColors.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">BlueStream</span><br><span class="post-time small text-muted">9th April 2007 12:13 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Hi kichik<br><br>Sorry.. I'm a bit confused esp about handles.. This is what I did...<br><br>in file.nsi<br></p><pre>
<code>GetDlgItem $asd $HWNDPARENT 1<br>SetCtlColors $asd 0x000000 0xFFFFFF</code>
</pre><br>
      <br>
      in options.ini<br>
      <pre>
<code>[Settings]<br>NumFields=7<br>Rect=1044<br>HWND=asd</code>
</pre><br>
      <br>
      Think it's wrong :eek:<br>
      <br>
      <pre>
<code>Usage: GetDlgItem $(user_var: handle output) dialog item_id<br>Error in script</code>
</pre>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br>
      <span class="post-time small text-muted">9th April 2007 12:16 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">You probably forgot to define $asd using Var.<br>
      <br>
      But you don't need GetDlgItem and 1 is the identifier of the Next button and not of your control. Use ReadINIStr or MUI_INSTALLOPTIONS_READ to get the HWND value of your Field. Open the INI file in $PLUGINSDIR when the installer is running and you'll see.<br>
      <br>
      To find out where $PLUGINSDIR is, simply MessageBox it after it's initialized. You can manually initialize it using InitPluginsDir or use it after the custom page was already displayed.</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">BlueStream</span><br>
      <span class="post-time small text-muted">9th April 2007 13:09 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Hi kichik.<br>
      <br>
      I now see that it's generated for you. :)<br>
      <br>
      But I still can't read the value.<br>
      <br></p>
      <pre>
<code>ReadINIStr $asd "ioC.ini" "Field 3" "HWND"<br>ReadINIStr $asd "$PLUGINSDIR\ioC.ini" "Field 3" "HWND"<br>!insertmacro MUI_INSTALLOPTIONS_READ $asd "$PLUGINSDIR\ioC.ini" "Field 3" "HWND"</code>
</pre><br>
      <br>
      Neither of these return the value of HWND, unless I manually set the value in the original ioC.ini file which is wrong, I know.
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br>
      <span class="post-time small text-muted">9th April 2007 13:45 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Then you're either using a very old version of NSIS or you're reading the value before the page is actually created. Use it after MUI_INSTALLOPTIONS_INITDIALOG. If you're using MUI_INSTALLOPTIONS_DISPLAY, split it to MUI_INSTALLOPTIONS_INITDIALOG and MUI_INSTALLOPTIONS_SHOW.</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">BlueStream</span><br>
      <span class="post-time small text-muted">9th April 2007 14:29 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Thanks kichik :D<br>
      <br>
      As always, letting me find my way without leading me by the hand. I always learn a lot from you. :)<br>
      <br>
      Cheers :D<br>
      <br>
      For the benefit of the rest:<br>
      <br>
      in script.nsi (replace Field X with the name of the field)</p>
      <pre>
<code><br>Var $avarname<br><br>Function PageFunction<br>   !insertmacro MUI_INSTALLOPTIONS_INITDIALOG "ioC.ini"<br>   ReadINIStr $avarname "$PLUGINSDIR\io.ini" "Field X" "HWND"<br>   SetCtlColors $avarname 0x000000 0xFFFFFF<br>   !insertmacro MUI_INSTALLOPTIONS_SHOW<br>FunctionEnd</code>
</pre><br>
      <br>
      in io.ini
      <pre>
<code>Nothing extra</code>
</pre>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">BlueStream</span><br>
      <span class="post-time small text-muted">9th April 2007 16:40 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Now I have a related question.<br>
      <br>
      Why is my white bitmap image of size 250x200 and monochrome at [Field 1] appearing above the other fields and not displaying.<br>
      <br>
      I made one also at 600x600 but that covered up almost the entire screen even though i put the left, top, etc at different coordinates.</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br>
      <span class="post-time small text-muted">9th April 2007 16:48 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">If it's not appearing, you probably didn't extract it and set the State value of the Bitmap control correctly. You must set State at runtime so InstallOptions can find the image.<br>
      <br>
      The controls are created sequentially from Field 1 to the last field so the first control should be behind everything. Are you sure it's really Field 1 that's hiding the second group box?</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">BlueStream</span><br>
      <span class="post-time small text-muted">9th April 2007 16:56 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">This is my ioC.ini<br>
      <br></p>
      <pre>
<code><br>[Settings]<br>NumFields=8<br>Rect=1044<br>NextButtonText=Finish<br><br>[Field 1]<br>Type=Bitmap<br>Text=white.bmp<br>Left=130<br>Right=313<br>Top=32<br>Bottom=180<br>State=1<br><br>[Field 2]<br>Type=Groupbox<br>Text=Shortcuts<br>Left=117<br>Right=315<br>Top=52<br>Bottom=93<br><br>[Field 3]<br>Type=Groupbox<br>Text=Additional<br>Left=117<br>Right=315<br>Top=109<br>Bottom=148<br><br>[Field 4]<br>Type=checkbox<br>Text=Create shortcut on the Desktop.<br>Left=126<br>Right=288<br>Top=64<br>Bottom=76<br>State=0<br>HWND=<br><br>[Field 5]<br>Type=checkbox<br>Text=Create shortcut in the Start Menu.<br>Left=126<br>Right=300<br>Top=76<br>Bottom=88<br>State=1<br><br>[Field 6]<br>Type=Checkbox<br>Text=Start the program once done.<br>Left=126<br>Right=272<br>Top=124<br>Bottom=132<br>State=1<br><br>[Field 7]<br>Type=Bitmap<br>Text=win.bmp<br>Left=0<br>Right=110<br>Top=0<br>Bottom=193<br><br>[Field 8]<br>Type=Label<br>Text=Additional configuration<br>Left=109<br>Right=316<br>Top=0<br>Bottom=47<br></code>
</pre><br>
      <br>
      State=1 added to [Field 1] to no avail. As you can see, the other bitmap displays fine.
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br>
      <span class="post-time small text-muted">9th April 2007 16:59 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Sorry, you must set Text correctly, not State. State means nothing for Bitmap controls. You must set Text to where you've extracted the image or InstallOptions won't be able to find the image. You must use WriteINIStr or MUI_INSTALLOPTIONS_WRITE on runtime to write the path where the image was extracted.</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">BlueStream</span><br>
      <span class="post-time small text-muted">9th April 2007 17:11 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">oooo<br>
      <br>
      I think I've got the general idea. Was under the impression that it was all automatic.<br>
      <br>
      Thx :)</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">BlueStream</span><br>
      <span class="post-time small text-muted">9th April 2007 19:12 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Image displays but is still on top. Any ideas?<br>
      <br></p>
      <pre>
<code>Function onInit<br>   InitPluginsDir<br>   File /oname=$PLUGINSDIR\white.bmp "white.bmp"<br>FunctionEnd<br><br>Function CustomPageC<br>   !insertmacro MUI_INSTALLOPTIONS_WRITE "ioC.ini" "Field 1" "Text" "$PLUGINSDIR\white.bmp"<br>   !insertmacro MUI_INSTALLOPTIONS_INITDIALOG "ioC.ini"<br>FunctionEnd</code>
</pre>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br>
      <span class="post-time small text-muted">9th April 2007 19:16 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Attach the script and the INI file. As said earlier, this shouldn't happen as the first field is created first.</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">BlueStream</span><br>
      <span class="post-time small text-muted">9th April 2007 19:30 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Attached</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">BlueStream</span><br>
      <span class="post-time small text-muted">9th April 2007 19:32 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">File is attached here</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br>
      <span class="post-time small text-muted">9th April 2007 19:57 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Is that still for the white background? You don't need a bitmap for that... Get the HWND of the InstallOptions dialog and use SetCtlColors on that. Use MUI_INSTALLOPTIONS_INITDIALOG_RETURN and Pop the result which is the HWND.<br>
      <br>
      As for the bitmap, my bad again. The last Field goes on the bottom of the Z-order. From MSDN:</p>

      <blockquote>
        If the created window is a child window, its default position is at the bottom of the Z-order. If the created window is a top-level window, its default position is at the top of the Z-order (but beneath all topmost windows unless the created window is itself topmost).
      </blockquote>So Field 1 should be Field 8.
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">BlueStream</span><br>
      <span class="post-time small text-muted">10th April 2007 05:36 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Hey again Kichik.<br>
      <br>
      That about solves it :)<br>
      <br>
      But there is "no such macro MUI_INSTALLOPTIONS_INITDIALOG_RETURN".<br>
      <br>
      Will just stick with the bitmap :)</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br>
      <span class="post-time small text-muted">10th April 2007 20:17 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Right, then MUI_INSTALLOPTIONS_INITDIALOG already pushes the HWND to the stack. Even if you stick with the bitmap, you should Pop that value to avoid stack corruption.</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">BlueStream</span><br>
      <span class="post-time small text-muted">11th April 2007 06:21 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">script updated..<br>
      <br>
      Thx again :)</p>
    </div>
    <hr>

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]></script></body></html>