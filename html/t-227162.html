<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="XML plugin" />

  <title>XML plugin - NSIS Forums</title><!-- Bootstrap core CSS -->
  <link rel="stylesheet" type="text/css" href="//netdna.bootstrapcdn.com/bootswatch/3.0.1/readable/bootstrap.min.css" />
  <link rel="stylesheet" href="../css/style.css" type="text/css" /><!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!--[if lt IE 9]>
                <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
                <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content=" XML plugin" />

  <title>XML plugin - NSIS Forums</title>
  <link rel="stylesheet" type="text/css" href="//netdna.bootstrapcdn.com/bootswatch/3.0.1/readable/bootstrap.min.css" />
  <link rel="stylesheet" href="../css/style.css" type="text/css" />
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content=" XML plugin" />

  <title>XML plugin - NSIS Forums</title>
  <link rel="stylesheet" type="text/css" href="//netdna.bootstrapcdn.com/bootswatch/3.0.1/readable/bootstrap.min.css" />
  <link rel="stylesheet" href="../css/style.css" type="text/css" />
</head>

<body>
  <div class="container">
    <!-- Put navigation bar here -->

    <ol class="breadcrumb">
      <li><a href="../index.html" class="glyphicon glyphicon-home"></a></li>

      <li><a href="f-65.html">NSIS Discussion</a></li>

      <li class="active">XML plugin</li>
    </ol>

    <p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=227162">XML plugin</a></p><br />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Instructor</span><br />
      <span class="post-time small text-muted">28th September 2005 19:52 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>XML plugin</strong><br />
      XML plugin parses an XML document, and builds from that a Document Object Model (DOM) that can be read, modified and saved. XML plugin is based on <a href="http://www.sourceforge.net/projects/tinyxml" target="_blank">TinyXml</a> (2.4.0 RC).<br />
      <br />
      <b>Features</b>:<br />
      - Read and/or modified xml files<br />
      - Code is fast and lightweight<br />
      - Unicode UTF-8 support<br />
      - "MSXML.DLL" independent<br />
      - Support for condense and non-condense white spaces<br />
      - Row and Column tracking<br />
      <br />
      <br />
      "<b>XML</b>" plugin v1.0</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kike_velez</span><br />
      <span class="post-time small text-muted">29th September 2005 09:17 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">:up: :up: :up: for<br />
      <br /></p>
      <pre>
<span style="color: #DD0000">"MSXML.DLL"</span><span style="color: #0000BB">independent
<br /></span>

<!-- php buffer end -->
                
                
                
</pre>
      <hr />
      <pre>
        
Best Regards and Good Job
                
</pre>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Instructor</span><br />
      <span class="post-time small text-muted">20th October 2005 17:49 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><b>Changes</b>:<br />
      - TinyXml updated to v2.4.1<br />
      - Fixed: output variable in xml::NoChildren<br />
      - New: xml::GetText<br />
      &amp;nbsp;&amp;nbsp;&amp;nbsp;Convenience function for easy access to the text inside current element.<br />
      - New: xml::SetCDATA<br />
      &amp;nbsp;&amp;nbsp;&amp;nbsp;Turns on or off a CDATA representation of the current element text.<br />
      - New: xml::IsCDATA<br />
      &amp;nbsp;&amp;nbsp;&amp;nbsp;Queries whether this represents text using a CDATA section.<br />
      <br />
      <br />
      "<b>XML</b>" plugin v1.1</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Comm@nder21</span><br />
      <span class="post-time small text-muted">20th October 2005 19:58 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">next plugin i repack for correct usage of nsis file structure :)</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Instructor</span><br />
      <span class="post-time small text-muted">25th October 2005 05:23 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">-TinyXml updated to v2.4.2<br />
      -Fixed: "CreateNode" appearance of the "\r\n" at the end (thanks <b>Lee Thomason</b>)<br />
      -Fixed: Now error appears if current node is TEXT and uses "InsertEndChild"<br />
      -Changed: "AttributeByName" -&gt; "GetAttribute" now not only returns value of the attribute, but also goes to it<br />
      -New: "GetNodeValue" can be useful in some cases<br />
      <br />
      <br />
      "<b>XML</b>" plugin v1.2</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">false</span><br />
      <span class="post-time small text-muted">7th November 2005 18:58 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">How would I go about selecting a particular node by it's name? Like how Olivier Marcoux's NSIS XML uses...<br />
      <br />
      nsisXML::select &lt;XPath expression&gt;<br />
      <br />
      Thx!</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Instructor</span><br />
      <span class="post-time small text-muted">7th November 2005 19:35 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">If you want to "select" the node you need go to it (FirstChildElement, NextSiblingElement ...). Easy for me, when you ask the concrete example, what you trying to do.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">false</span><br />
      <span class="post-time small text-muted">7th November 2005 21:59 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Somewhere nested in my XML, I have a set of child nodes who have the same name and share the same parent. The child nodes differ by having different attributes values.<br />
      <br />
      I would like to test if a particular node exists in an XML without having to drill down using FirstChildElement and NextSiblingElement. If the node with the target node name exists, I would make it the current node.<br />
      <br />
      I thought GotoHandle would do this for me but I am wrong in thinking it takes in a node name for a parameter.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Instructor</span><br />
      <span class="post-time small text-muted">7th November 2005 22:33 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">I'll think about recursive node search</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Instructor</span><br />
      <span class="post-time small text-muted">9th November 2005 16:45 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><b>New</b>: [xml::FindNextElement /NOUNLOAD "[name]" .r0 .r1]<br />
      &amp;nbsp;&amp;nbsp;&amp;nbsp;-Search for element (recursive), returns the element name and goes to it.<br />
      <b>New</b>: [xml::FindCloseElement /NOUNLOAD]<br />
      &amp;nbsp;&amp;nbsp;&amp;nbsp;-Closes search opened by xml::FindNextElement.<br />
      <b>New</b>: [xml::ElementPath /NOUNLOAD .r0]<br />
      &amp;nbsp;&amp;nbsp;&amp;nbsp;-Returns the current element path.<br />
      &amp;nbsp;&amp;nbsp;&amp;nbsp;(e.g. "/a/b/c[3]/d")<br />
      <b>New</b>: [xml::GotoPath /NOUNLOAD "[path]" .r0]<br />
      &amp;nbsp;&amp;nbsp;&amp;nbsp;-Goes to the specified path.<br />
      &amp;nbsp;&amp;nbsp;&amp;nbsp;(e.g. from root "/a/b[2]/c/d", from current element "a/b[2]/c/d",<br />
      &amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;using last element 'b' "a/b[-1]/c/d")<br />
      <br />
      <br />
      "<b>XML</b>" plugin v1.3</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">false</span><br />
      <span class="post-time small text-muted">9th November 2005 16:56 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">You da man! That was a fast. I'll give this a shot. Thx</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">rsegal</span><br />
      <span class="post-time small text-muted">9th November 2005 19:33 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Hey Instructor any plans for UTF-16 support? I could really use that.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Instructor</span><br />
      <span class="post-time small text-muted">9th November 2005 20:15 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">DOM builds by TinyXML parser, so UTF-16 is depend on this project. BTW: Where is already have <a href="http://sourceforge.net/tracker/index.php?func=detail&amp;aid=1111690&amp;group_id=13559&amp;atid=363559" target="_blank">feature request</a> about it.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">rsegal</span><br />
      <span class="post-time small text-muted">9th November 2005 21:01 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Ah excellent. Good to know it's on the queue.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Instructor</span><br />
      <span class="post-time small text-muted">10th November 2005 15:04 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><b>Added</b>: now "GotoPath" can accept elements without name (e.g. using any last element "a/[-1]/c/d")<br />
      <br />
      <br />
      "<b>XML</b>" plugin v1.4</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Instructor</span><br />
      <span class="post-time small text-muted">10th December 2005 17:21 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><b>Fixed</b>: Now "ElementPath" and "GotoPath" correctly working with the document beginning. If "ElementPath" returns "" - the current element is the beginning of the document. [xml::GotoPath /NOUNLOAD "" .r0] - go to the document beginning.<br />
      <br />
      <br />
      "<b>XML</b>" plugin v1.5</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Kiggie</span><br />
      <span class="post-time small text-muted">13th January 2006 11:04 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>Bug in GetAttribute</strong><br />
      Hi,<br />
      <br />
      there seems to be a bug in the GetAttribute Method, it returns<br />
      always -1 for the first attribute of a node.<br />
      <br />
      A possible workaround is to check if the FirstAttribute differs from the desired attribute.<br />
      <br />
      Kind Regards,<br />
      <br />
      Rob</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">chagam</span><br />
      <span class="post-time small text-muted">13th January 2006 11:46 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Hi,<br />
      <br />
      May be I'm missing something but I don't understand how to replace a text value.<br />
      <br />
      There's a xml::GetText function. How do I do a xml::SetText ?<br />
      <br />
      Thanks in advance<br />
      <br />
      Chag</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Kiggie</span><br />
      <span class="post-time small text-muted">13th January 2006 11:54 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"></p>

      <blockquote>
        <i>Originally posted by chagam</i><br />
        <b>Hi,<br />
        <br />
        May be I'm missing something but I don't understand how to replace a text value.<br />
        <br />
        There's a xml::GetText function. How do I do a xml::SetText ?<br />
        <br />
        Thanks in advance<br />
        <br />
        Chag</b>
      </blockquote>Did you try the xml::SetNodeValue method ?
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">chagam</span><br />
      <span class="post-time small text-muted">13th January 2006 12:25 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Hi,<br />
      <br />
      Yes, I tried. May be a did something wrong.<br />
      <br />
      My xml file looks like this :<br />
      &lt;config&gt;<br />
      &lt;local&gt;<br />
      &lt;host&gt;test&lt;/host&gt;<br />
      &lt;/local&gt;<br />
      &lt;/config&gt;<br />
      <br />
      I tried :<br />
      xml::GotoPath /NOUNLOAD "/config/local/host" .r0<br />
      xml::SetNodeValue /NOUNLOAD "1234" .r0<br />
      <br />
      and my new xml file looks like this :<br />
      &lt;config&gt;<br />
      &lt;local&gt;1234<br />
      &lt;/local&gt;<br />
      &lt;/config&gt;<br />
      <br />
      Chag</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Instructor</span><br />
      <span class="post-time small text-muted">13th January 2006 13:26 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"></p>
      <pre>
<code>Name "XMLTest"<br />OutFile "XMLTest.exe"<br /><br />Section<br />        xml::LoadFile /NOUNLOAD "test.xml" .r0<br />        MessageBox MB_OK "xml::LoadFile$\n$$0=$0"<br /><br />        xml::GotoPath /NOUNLOAD "/config/local/host" .r0<br />        MessageBox MB_OK "xml::GotoPath$\n$$0=$0"<br /><br />        xml::FirstChild /NOUNLOAD "" .r0 .r1<br />        MessageBox MB_OK "xml::FirstChild$\n$$0=$0$\n$$1=$1"<br /><br />        xml::SetNodeValue /NOUNLOAD "1234"<br />        MessageBox MB_OK "xml::SetNodeValue"<br /><br />        xml::SaveFile "test_saved.xml" .r0<br />        MessageBox MB_OK "xml::SaveFile$\n$$0=$0"<br />SectionEnd</code>
</pre>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Instructor</span><br />
      <span class="post-time small text-muted">13th January 2006 13:31 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"></p>

      <blockquote>
        there seems to be a bug in the GetAttribute Method, it returns<br />
        always -1 for the first attribute of a node.
      </blockquote>Fixed, thanks.
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Instructor</span><br />
      <span class="post-time small text-muted">13th January 2006 14:40 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><b>Fixed</b>: GetAttribute returns -1 for the first attribute.<br />
      <b>New</b>: "SetText" -convenience function for easy set the text of the current element.<br />
      <br />
      <br />
      "<b>XML</b>" plugin v1.6</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">xilay</span><br />
      <span class="post-time small text-muted">3rd March 2006 13:32 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Hello,<br />
      <br />
      I need to create a new element without text.<br />
      I use this code :<br />
      PHP Code:</p>
      <hr />
      <code style="white-space:nowrap"><!-- php buffer start --></code><span style="color: #000000"><span style="color: #0000BB">xml</span><span style="color: #007700">::</span><span style="color: #0000BB">LoadFile</span><span style="color: #007700">/</span><span style="color: #0000BB">NOUNLOAD</span><span style="color: #DD0000">"test.xml"</span><span style="color: #007700">.</span><span style="color: #0000BB">r0<br />
      xml</span><span style="color: #007700">::</span><span style="color: #0000BB">GotoPath</span><span style="color: #007700">/</span><span style="color: #0000BB">NOUNLOAD</span><span style="color: #DD0000">"/root"</span><span style="color: #007700">.</span><span style="color: #0000BB">r0<br />
      xml</span><span style="color: #007700">::</span><span style="color: #0000BB">CreateNode</span><span style="color: #007700">/</span><span style="color: #0000BB">NOUNLOAD</span><span style="color: #DD0000">"&lt;histo&gt;&lt;/histo&gt;"</span><span style="color: #007700">.</span><span style="color: #0000BB">r0<br />
      xml</span><span style="color: #007700">::</span><span style="color: #0000BB">InsertEndChild</span><span style="color: #007700">/</span><span style="color: #0000BB">NOUNLOAD</span><span style="color: #DD0000">"$0"</span><span style="color: #007700">.</span><span style="color: #0000BB">r0<br />
      xml</span><span style="color: #007700">::</span><span style="color: #0000BB">SaveFile</span><span style="color: #007700">/</span><span style="color: #0000BB">NOUNLOAD</span><span style="color: #DD0000">"test.xml"</span><span style="color: #007700">.</span><span style="color: #0000BB">r0<br /></span></span> <!-- php buffer end -->
      <hr />
      But the new element is with a blank at the end, like this :<br />
      PHP Code:
      <hr />
      <code style="white-space:nowrap"><!-- php buffer start --></code><span style="color: #000000"><span style="color: #007700">&lt;</span><span style="color: #0000BB">root</span><span style="color: #007700">&gt;<br />
      &lt;</span><span style="color: #0000BB">histo</span><span style="color: #007700">/&gt;<br />
      &lt;/</span><span style="color: #0000BB">root</span><span style="color: #007700">&gt;</span> If I create the element with text, it's ok.<br />
      Have you got an idea?<br />
      <br />
      Thanks<br />
      <br />
      (sorry if my english is not very good)<br />
      <br /></span>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Comm@nder21</span><br />
      <span class="post-time small text-muted">3rd March 2006 15:13 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">this is correct xml behaviour.<br />
      empty elements have to be &lt;element /&gt;, not &lt;element&gt;&lt;/element&gt;.<br />
      <br />
      last one is no valid xml!</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">xilay</span><br />
      <span class="post-time small text-muted">3rd March 2006 16:10 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Yes, I know, the problem is the blank after 'histo'.<br />
      I have this &lt;histo /&gt; (you see, the blank between 'histo' and '/') and not this &lt;histo/&gt;.<br />
      <br />
      Sorry for my bad explanation :(</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Comperio</span><br />
      <span class="post-time small text-muted">3rd March 2006 20:16 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">W3.org (which pretty much has the final word on markup languages like XML) recommends that a space should be used when declaring empty tags.<br />
      <br />
      So this would be proper XML:<br />
      &lt;histo /&gt;<br />
      <br />
      NOT this:<br />
      &lt;histo/&gt;<br />
      <br />
      See the section <i><b>tags for empty elements</b></i> at <a href="http://www.w3.org/TR/REC-xml/#sec-starttags" target="_blank">http://www.w3.org/TR/REC-xml/#sec-starttags</a> for more info.<br />
      <br />
      [edit]<br />
      And FWIW, I've always seen empty tags written using a space between the element name and the '/' character...</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">xilay</span><br />
      <span class="post-time small text-muted">6th March 2006 08:10 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Ok, I use xmlspy and it deletes the blank, so, I thought it was not normal.<br />
      Thanks a lot (and thanks for this perfect plugin)</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Instructor</span><br />
      <span class="post-time small text-muted">6th March 2006 13:50 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Updated: TinyXml to v2.4.3<br />
      Changed: Now plugin used header "XML.nsh" for custom user variables and<br />
      &amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;better compile errors check.<br />
      <br />
      <b>Update from previous versions:</b><br />
      &amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;- Insert line in script:<br />
      &amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;!include "XML.nsh"<br />
      &amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;- Replace:<br />
      &amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;xml::LoadFile -&gt; ${xml::LoadFile} ...<br />
      &amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;- Replace:<br />
      &amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;.r0 -&gt; $0, .r1 -&gt; $1 ... .R0 -&gt; $R0, .R1 -&gt; $R1 ...<br />
      <br />
      "<b>XML</b>" plugin v1.7</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">stwhit</span><br />
      <span class="post-time small text-muted">3rd May 2006 14:52 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">I need to be able to parse two XML documents at the same time (because I'm merging them during an upgrade process).<br />
      <br />
      From looking at the API and the source code, it looks like this XML plugin only supports working on a single XML document at a time, because there is no concept of a file handle being returned by ${xml::LoadFile} and being passed to the other functions. It looks like there is a single, global XML document being edited (TiXmlDocument doc).<br />
      <br />
      So, two questions:<br />
      <br />
      1. Is it possible to edit two XML documents at the same time using this plugin?<br />
      2. If not, would you consider enhancing the plugin to use file handles to support editing multiple XML documents at once?<br />
      <br />
      Thanks!</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Instructor</span><br />
      <span class="post-time small text-muted">3rd May 2006 15:19 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">1. Not.<br />
      2. I'm not plaining this.<br />
      <br />
      But you can use ${xml::CloneNode}<br />
      <br /></p>
      <pre>
<code><br />Section<br />        ${xml::LoadFile} "file.xml" $0<br />        MessageBox MB_OK "xml::LoadFile$\n$$0=$0"<br /><br />        ${xml::GotoPath} "/" $0<br />        MessageBox MB_OK "xml::GotoPath$\n$$0=$0"<br /><br />        ${xml::CloneNode} $R0<br />        MessageBox MB_OK "xml::CloneNode$\n$$R0=$R0"<br /><br />        ${xml::Unload}<br /><br /><br />        ${xml::LoadFile} "file2.xml" $0<br />        MessageBox MB_OK "xml::LoadFile$\n$$0=$0"<br /><br />        ${xml::GotoPath} "/" $0<br />        MessageBox MB_OK "xml::GotoPath$\n$$0=$0"<br /><br />        ${xml::InsertBeforeNode} "$R0" $0<br />        MessageBox MB_OK "xml::InsertBeforeNode$\n$$0=$0"<br /><br />        ${xml::FreeNode} "$R0" $0<br />        MessageBox MB_OK "xml::FreeNode$\n$$0=$0"<br /><br />        ${xml::SaveFile} "file2.xml" $0<br />        MessageBox MB_OK "xml::SaveFile$\n$$0=$0"<br /><br />        ${xml::Unload}<br />SectionEnd<br /></code>
</pre>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Comperio</span><br />
      <span class="post-time small text-muted">31st July 2006 03:48 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">I'm trying to create an XML file from scratch using this plugin. Is this possible? If so, can someone post an example of how I might accomplish this?</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Instructor</span><br />
      <span class="post-time small text-muted">31st July 2006 15:56 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">FileWrite</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Comperio</span><br />
      <span class="post-time small text-muted">1st August 2006 00:48 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">darn...<br />
      I was hoping that I could build an XML file in memory using the plugin and then output the whole thing to a file. (It would be a cool enhancement for sure.)<br />
      <br />
      I guess for now, I'll just write my own FileWrite functions to get me by for now.<br />
      <br />
      Thanks for the feedback!</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">emmett_m</span><br />
      <span class="post-time small text-muted">16th August 2006 07:00 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Hi, I am hoping you can help me, I tried some of the code examples found in \NSIS\Examples\XMLXMLTest.nsi. And tried to apply these examples with what I want with little success, here is what I am trying to achieve.<br />
      <br />
      I have the following xml file (VS.Net config file):<br />
      <font color="blue">&lt;?xml version="1.0" encoding="utf-8" ?&gt;<br />
      &lt;configuration&gt;<br />
      &lt;configSections&gt;<br />
      &lt;/configSections&gt;<br />
      <br />
      &lt;appSettings&gt;<br />
      &lt;add key="somekey" value="some value"/&gt;<br />
      &lt;/appSettings&gt;<br />
      <br />
      &lt;connectionStrings&gt;<br />
      &lt;add name="ConnString" connectionString="TRYING TO MODIFY THIS TEXT"<br />
      providerName="System.Data.SqlClient" /&gt;<br />
      &lt;/connectionStrings&gt;<br />
      &lt;/configuration&gt;</font><br />
      <br />
      When the installer runs, I am trying to change the text in the connectionString attribute of the &lt;add&gt; element. I have placed the file in the same directory as my install script, and the script includes the following code:<br />
      <font color="blue"><br />
      !include "XML.nsh"<br />
      <br />
      var /global ReplacementString<br />
      var /global fhandle<br />
      <br />
      ${xml::LoadFile} "appname.exe.config" $fhandle<br />
      MessageBox MB_OK "$fhandle" <font color="silver">; always returns -1</font><br />
      <br />
      ${xml::GotoPath} "/configuration/connectionStrings/add" $fhandle<br />
      ${xml::SetAttribute} "connectionString" "$ReplacementString" $fhandle<br />
      ${xml::SaveFile} "$INSTDIR\appname.exe.config" $fhandle<br />
      ${xml::Unload} <font color="silver">; unload plugin</font><br /></font><br />
      When attempting to open the file it always returns -1, can anybody tell me what the obvious mistake that I am making, and yes the file is in UTF8 format, I have however tried saving the format of the file from Notepad, into different formats in desperation, with no help (as I expected).</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Instructor</span><br />
      <span class="post-time small text-muted">16th August 2006 08:17 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">I have no problem. Make sure that the file exist and try to specify full path to it.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">emmett_m</span><br />
      <span class="post-time small text-muted">16th August 2006 09:00 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">That is interesting, I tried as you suggested to supply the full path to the file, which is the same location as the setup program, and it works. However I thought when you specified a file like:<br />
      <br />
      ${xml::LoadFile} "appname.exe.config" $fhandle<br />
      <br />
      That it would use the file from the same directory as the installer, it would seem not. Also I tried the following:<br />
      <br />
      ${xml::LoadFile} "$EXEDIR\appname.exe.config" $fhandle<br />
      <br />
      Which seems to be what I should have done. Thanks for your time ;-)</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Comm@nder21</span><br />
      <span class="post-time small text-muted">17th August 2006 18:47 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">as the plugin is extracted to $PLUGINSDIR i guess it searches the file there, not in $EXEDIR.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">emmett_m</span><br />
      <span class="post-time small text-muted">18th August 2006 00:59 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Just in case somebody else comes across this problem, what I really wanted to do was have the .config file wrapped up into the installer, and manipulate that version, to do this I did the following:<br />
      <br />
      <font color="blue">Section "MainSection" SEC01<br />
      SetOutPath "$INSTDIR"<br />
      SetOverwrite ifnewer<br />
      File "appname.exe.config" <font color="silver">; reads file into memory and wraps(compresses) into installer</font><br />
      Section<br />
      <br />
      ${xml::LoadFile} "appname.exe.config" $fhandle <font color="silver">; modify the config file compressed in installer</font><br /></font><br />
      <br />
      This seems to work great.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">JDaniels13</span><br />
      <span class="post-time small text-muted">24th August 2006 22:49 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">I recently needed to edit existing .NET (Framework 1.1) config files within an NSIS install. Using some of the info here and the XML plugin docs, I was able to put something together that actually appears to work for changing keys in .NET 1.1 config files. Below is what I came up with. (There are some extra message boxes for debugging that should be removed prior to using.) Is there an easier way??!! I was truly surprised at the lack of discussion of this topic. I didn't want to write a .NET program in C# or VB.NET because I wanted it all to be in the NSIS setup, for simplicity's sake.<br />
      <br />
      <br />
      !include "XML.nsh"<br />
      <br />
      var /global IOResult<br />
      var /global NewNodeHandle<br />
      var /global CurrentValue<br />
      var /global ElementName<br />
      <br />
      !macro EditDotNETConfigFile ConfigFile KeyPath KeyName KeyValue<br />
      ${xml::LoadFile} ${ConfigFile} $IOResult<br />
      ${xml::GotoPath} ${KeyPath} $IOResult<br />
      IntCmp $IOResult 0 pathLookupSucceeded noAppSettings<br />
      pathLookupSucceeded:<br />
      MessageBox MB_OK "pathLookupSucceeded for ${KeyPath}"<br />
      checkAttributeExistence:<br />
      ${xml::GetAttribute} "key" $CurrentValue $IOResult<br />
      ; Did we find an existing instance of our config setting?<br />
      IntCmp $IOResult 0 checkKeyAttributeValue toNextElement<br />
      checkKeyAttributeValue:<br />
      MessageBox MB_OK "checkKeyAttributeValue current value is $CurrentValue vs desired key ${KeyName}"<br />
      ; OK, found one, is it our desired key? Case-sensitive compare.<br />
      StrCmpS $CurrentValue ${KeyName} foundKeyAttribute toNextElement<br />
      toNextElement:<br />
      MessageBox MB_OK "checkKeyAttributeValue $CurrentValue didn't match ${KeyName}"<br />
      ; Didn't find the &lt;add key= " attribute name we wanted, check next "&lt;add " element<br />
      ${xml::NextSiblingElement} "add" $ElementName $IOResult<br />
      MessageBox MB_OK "toNextElement name is $ElementName IOResult is $IOResult"<br />
      IntCmp $IOResult 0 checkAttributeExistence noExistingEntry<br />
      <br />
      foundKeyAttribute:<br />
      ${xml::GetAttribute} "value" $CurrentValue $IOResult<br />
      MessageBox MB_OK "foundKeyAttribute check value attribute $CurrentValue vs desired key ${KeyValue}"<br />
      ; Did we find an existing instance of our config setting?<br />
      StrCmp $CurrentValue ${KeyValue} valueUnchanged valueChanged<br />
      valueChanged:<br />
      ${xml::SetAttribute} "value" "${KeyValue}" $IOResult<br />
      IntCmp $IOResult 0 setAttributeWorked setAttributeFailed<br />
      setAttributeWorked:<br />
      goto saveConfigFile<br />
      <br />
      noExistingEntry:<br />
      MessageBox MB_OK "GetAttribute could not find existing value for ${KeyName}"<br />
      ${xml::CreateNode} '&lt;add key="${KeyName}" value="${KeyValue}" /&gt;' $NewNodeHandle<br />
      ${xml::InsertAfterNode} $NewNodeHandle $IOResult<br />
      goto saveConfigFile<br />
      setAttributeFailed:<br />
      MessageBox MB_OK "SetAtribute failed for ${KeyName}"<br />
      goto cleanUp<br />
      noAppSettings:<br />
      MessageBox MB_OK "XPath not resolved for ${KeyPath}"<br />
      goto cleanUp<br />
      saveConfigFile:<br />
      ${xml::SaveFile} ${ConfigFile} $IOResult<br />
      valueUnchanged:<br />
      ; Just fall thru and unload<br />
      cleanUp:<br />
      ${xml::Unload} ; unload plugin<br />
      !macroend<br />
      <br />
      ; Called as follows:<br />
      <br />
      !insertmacro EditDotNETConfigFile "c:\InetPub\wwwroot\MyWebSite\Web.config" "configuration/appSettings/add" "connectionString" "MyTestConnString1a"<br />
      <br />
      <br />
      P.S. I tried the nsisXML plugin but it wanted to do "extra" things to the tags in the .NET config files, so I came back to this XML plugin and it's what I got to work first.</p>
    </div>
    <hr />
    <!-- Bootstrap core CSS -->
    <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
                <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
                <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->

    <div class="container">
      <!-- Put navigation bar here -->

      <ol class="breadcrumb">
        <li><a href="../index.html" class="glyphicon glyphicon-home"></a></li>

        <li><a href="f-65.html">NSIS Discussion</a></li>

        <li class="active">XML plugin</li>
      </ol>

      <p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=227162">XML plugin</a></p><br />

      <div class="post">
        <p class="post-meta"><span class="post-author text-primary">JDaniels13</span><br />
        <span class="post-time small text-muted">24th August 2006 22:58 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

        <p class="post-content"><strong>A .NET 1.1 config file used in testing</strong><br />
        &lt;?xml version="1.0" encoding="utf-8" ?&gt;<br />
        &lt;configuration&gt;<br />
        &lt;appSettings&gt;<br />
        &lt;add key="@CBR_CBRFILE" value="Initialization.cbr" /&gt;<br />
        &lt;!-- Environment Setup Type should be "PROD" or "DEV" or "QA" --&gt;<br />
        &lt;add key="Site.Environment" value="QA" /&gt;<br />
        &lt;!-- Environment Setup End --&gt;<br />
        &lt;!-- Security Setup --&gt;<br />
        &lt;add key="ConnectionString" value="Case sensitive, shouldn't match this" /&gt;<br />
        &lt;!--Socket Setup (used for refund transaction) --&gt;<br />
        &lt;!--add key="SocketPort" value="3805" / --&gt;<br />
        &lt;!--add key="SocketTimeout" value="30000" / --&gt;<br />
        &lt;/appSettings&gt;<br />
        &lt;/configuration&gt;<br />
        <br />
        So after calling the macro, the file would be like this:<br />
        <br />
        &lt;?xml version="1.0" encoding="utf-8" ?&gt;<br />
        &lt;configuration&gt;<br />
        &lt;appSettings&gt;<br />
        &lt;add key="@CBR_CBRFILE" value="Initialization.cbr" /&gt;<br />
        &lt;!-- Environment Setup Type should be "PROD" or "DEV" or "QA" --&gt;<br />
        &lt;add key="Site.Environment" value="QA" /&gt;<br />
        &lt;!-- Environment Setup End --&gt;<br />
        &lt;!-- Security Setup --&gt;<br />
        &lt;add key="ConnectionString" value="Case sensitive, shouldn't match this" /&gt;<br />
        &lt;add key="connectionString" value="This is the one that should get matched and changed" /&gt;<br />
        &lt;!--Socket Setup (used for refund transaction) --&gt;<br />
        &lt;!--add key="SocketPort" value="3805" / --&gt;<br />
        &lt;!--add key="SocketTimeout" value="30000" / --&gt;<br />
        &lt;/appSettings&gt;<br />
        &lt;/configuration&gt;<br />
        <br />
        <br />
        The problem with .NET config files is that all the elements in the appsettings section are "&lt;add ", so you have to then navigate through each element looking for the attributes "key", to find the node you want, and then once you find it, set the "value" attribute for that node. Thus all the code for navigating within the duplicate-named "&lt;add " elements.<br />
        <br />
        If someone has an easier way, please share it! I didn't see an NSIS plugin for .NET config file editing, is there one I missed?</p>
      </div>
      <hr />

      <div class="post">
        <p class="post-meta"><span class="post-author text-primary">JDaniels13</span><br />
        <span class="post-time small text-muted">24th August 2006 23:41 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

        <p class="post-content">The thing that the nsisXML has going for it is it supports XPath, including the attribute specs in the XPath query. I understand there is a Tiny XPath company to TinyXML, but the XPath functionality is not integrated into the XML plugin.<br />
        <br />
        Here's what I had for the nsisXML plugin version of the .NET 1.1 config file editing macro:<br />
        <br />
        !macro EditDotNETConfigFile2 ConfigFile KeyXPath KeyName KeyValue<br />
        SetPluginUnload alwaysoff<br />
        nsisXML::create<br />
        nsisXML::load ${ConfigFile}<br />
        nsisXML::select ${KeyXPath} /* '/main/child[@attrib="value2"]' */<br />
        IntCmp $2 0 notFound<br />
        ; nsisXML::removeChild<br />
        nsisXML::createElement "add"<br />
        nsisXML::setText " "<br />
        nsisXML::appendChild<br />
        nsisXML::getAttribute ${KeyName}<br />
        DetailPrint "Attribute ${KeyName} is $3"<br />
        nsisXML::setAttribute "key" ${KeyName}<br />
        nsisXML::setAttribute "value" ${KeyValue}<br />
        MessageBox MB_OK "attribute set"<br />
        SetPluginUnload manual<br />
        nsisXML::save ${ConfigFile}<br />
        Goto end<br />
        notFound:<br />
        MessageBox MB_OK "XPath not resolved"<br />
        DetailPrint "XPath not resolved"<br />
        end:<br />
        !macroend<br />
        <br />
        ; Called like this:<br />
        !insertmacro EditDotNETConfigFile2 "c:\InetPub\wwwroot\MyWebSite\Web2.config" '/configuration/appSettings/add[@key="connectionString"]' "connectionString" "TestConnString2"<br />
        <br />
        It was very handy to use XPath to go right to the "&lt;add " element node with the "key= " attribute value I wanted. Would have saved much of the navigation code I had to write in the (TinyXML-based) XML plugin.</p>
      </div>
      <hr />

      <div class="post">
        <p class="post-meta"><span class="post-author text-primary">mtyler</span><br />
        <span class="post-time small text-muted">6th September 2006 18:10 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

        <p class="post-content"><strong>I have integrated TinyXPath with this plugin</strong><br />
        If anyone is interested, I have integrated the TinyXPath library with this plugin. It worked like a charm the very first time (surprised the heck out of me). Here are the steps:<br />
        <br />
        1) Download TinyXPath from<br />
        <a href="http://tinyxpath.sourceforge.net/" target="_blank">http://tinyxpath.sourceforge.net/</a><br />
        <br />
        2) Compile the TinyXPath LIB according to the instructions here <a href="http://tinyxpath.sourceforge.net/doc/index.html" target="_blank">http://tinyxpath.sourceforge.net/doc/index.html</a><br />
        <br />
        3) Copy the tinyxpath.lib file along with all the TinyXPath .h (header files), excluding the TinyXML header files, to the XML Plugin source directory.<br />
        <br />
        4) Add</p>
        <pre>
<code>#include "xpath_static.h"</code>
</pre>to the top of xml.cpp (XML Plugin source file)<br />
        <br />
        5) Add the following code block to xml.cpp:<br />
        <br />
        <pre>
<code>extern "C" void __declspec(dllexport) _GotoXPath(HWND hwndParent, int string_size, <br />                       char *variables, stack_t **stacktop)<br />{<br />        EXDLL_INIT();<br />        {<br />                popstring(szBuf);<br /><br />                nodeTmp = TinyXPath::XNp_xpath_node(node, szBuf);<br />                if(nodeTmp)<br />                {<br />                        node=nodeTmp;<br />                        pushstring("0");<br />                        return;<br />                }<br />                else<br />                {<br />                        pushstring("-1");<br />                }<br />        }<br />}</code>
</pre><br />
        <br />
        <br />
        6) Compile the XML Plugin source to the xml.dll file. Place the new xml.dll file in the NSIS/plugins directory (duh!)<br />
        <br />
        7) Add the following code block to the XML.nsh file located in the NSIS/include directory:<br />
        <br />
        <pre>
<code><br />!define xml::GotoXPath `!insertmacro xml::GotoXPath`<br /><br />!macro xml::GotoXPath _PATH _ERR<br />    xml::_GotoXPath /NOUNLOAD `${_PATH}`<br />    Pop ${_ERR}<br />!macroend<br /></code>
</pre><br />
        <br />
        Viola! You're done. Use
        <pre>
<code>${xml::GotoXPath} "path" $errvar</code>
</pre>in your installer script and the current node gets changed to the first node matching the XPath expression. If I have time, or someone else beats me to it, iterative expression matching could easily be added by storing the XPath state (by using the xpath_processor.h rather than xpath_static.h).<br />
        <br />
        Ask if you need any help. Let me know if this helps. And thank you "Instructor" for the Xml Plugin (way better than the rest of them)
      </div>
      <hr />

      <div class="post">
        <p class="post-meta"><span class="post-author text-primary">JDaniels13</span><br />
        <span class="post-time small text-muted">6th September 2006 18:48 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

        <p class="post-content">Thanks for your efforts! I'm not very handy with C++ builds; could you post the resulting XML.dll here?</p>
      </div>
      <hr />

      <div class="post">
        <p class="post-meta"><span class="post-author text-primary">mtyler</span><br />
        <span class="post-time small text-muted">6th September 2006 19:29 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

        <p class="post-content"><strong>Here is the new xml.dll file</strong><br />
        This site will not allow me to upload a DLL. I've zipped to see if it will accept it. You will need to modify xml.nsh according to my message.<br />
        <br />
        Let me know if it works for you.</p>
      </div>
      <hr />

      <div class="post">
        <p class="post-meta"><span class="post-author text-primary">mtyler</span><br />
        <span class="post-time small text-muted">7th September 2006 01:43 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

        <p class="post-content">PLEASE NOTE:<br />
        <br />
        I hope that I have not overstepped my bounds by providing a modified version of xml.dll to this forum. The modification is based on the latest code base from "Instructor" and TinyXPath, but there are no promises of accuracy, reliability or safety, expressed or implied. Use at your own risk!<br />
        <br />
        It would be nice if "Instructor" integrated this addition into the next build of his XML Plugin, giving it full XPath capabilities.</p>
      </div>
      <hr />

      <div class="post">
        <p class="post-meta"><span class="post-author text-primary">jeichhorn</span><br />
        <span class="post-time small text-muted">8th September 2006 08:55 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

        <p class="post-content">I am trying to use the ${xml::GotoXPath} command added by mtyler.<br />
        <br />
        Here is my test.xml:<br />
        <br /></p>
        <pre>
<code>&lt;?xml version="1.0" encoding="utf-8" ?&gt;<br />&lt;test&gt; <br />        &lt;c1&gt;content1&lt;/c1&gt;<br />        &lt;c2&gt; <br />                &lt;c3&gt;c3_content1&lt;/c3&gt;<br />                &lt;c3&gt;c3_content2&lt;/c3&gt;<br />                &lt;c3&gt;c3_content3&lt;/c3&gt;<br />        &lt;/c2&gt;<br />&lt;/test&gt;<br /></code>
</pre><br />
        <br />
        I am trying to select the element /test/c2/c3 with the content 'c2_content2'.<br />
        <br />
        When i use the xpath<br />
        <pre>
<code>${xml::GotoXPath} "//c3[text()='c3_content2']" $0</code>
</pre><br />
        the element is selected as expected, but when i use<br />
        <pre>
<code>${xml::GotoXPath} "/test/c2/c3[text()='c3_content2']" $0</code>
</pre><br />
        it does not find the element (result is -1).<br />
        <br />
        Do i use the GotoXPath function in a wrong way in my second example?<br />
        <br />
        Thanks for help.<br />
        <br />
        JÃ¶rg
      </div>
      <hr />

      <div class="post">
        <p class="post-meta"><span class="post-author text-primary">mtyler</span><br />
        <span class="post-time small text-muted">8th September 2006 18:01 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

        <p class="post-content">The immediate workaround for your problem is to execute</p>
        <pre>
<code>${xml::RootElement} $1 $0</code>
</pre>after loading the document and before conducting any static XPath queries that begin with the root element. Any XPath that is based on the top level element will work, including yours.<br />
        <br />
        The way the TinyXML works is to have a node above the top level element for the document itself. From this node you can get the document name and access XML comments that are outside the scope of the top level element. The XML plugin maintains it state as the current or last node that was read. This enables you to jump around from a relative perspective. But, from a technical perspective, conducting a static XPath query from the document node will not work.<br />
        <br />
        I considered modifying the GotoXPath function to account for this, but I think that it will defeat the purpose of the document node. So use the workaround specified above or use the XPath query Descendant notation along with the root element (even though this is not entirely accurate; you should use xml::RootElement):<br />
        <pre>
<code>//test/c2/c3[text()='c3_content2']</code>
</pre><br />
        <br />
        The original GotoPath function looks for a leading slash in the path designation and moves the current node to the root element before it locates the desired element. This works well for this function because it is a simple navigation function. The TinyXPath library is a robust XPath processor that will not benefit from the same logic used by the GotoPath function. Therefore, the suggestions I made above should become the norm.<br />
        <br />
        As usual, I hope that this has helped. Feel free to ask for assistance. I am appreciative of all the great tools and technologies supported by this community.
      </div>
      <hr />

      <div class="post">
        <p class="post-meta"><span class="post-author text-primary">Instructor</span><br />
        <span class="post-time small text-muted">10th September 2006 14:48 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

        <p class="post-content"><b>Changed</b>: Compiled statically without msvcrt.lib, now plugin work on Win95.<br />
        <b>Added</b>: Integrated TinyXPath v1.2.4 (thanks <b>mtyler</b>).<br />
        <b>Added</b>: ${xml::XPathString} -compute a string XPath expression.<br />
        <b>Added</b>: ${xml::XPathNode} -compute a node XPath expression and goes to it.<br />
        <b>Added</b>: ${xml::XPathAttribute} -compute an attribute XPath expression and goes to it.<br />
        <b>Added</b>: ${xml::CurrentAttribute} -returns name and value of the current attribute.<br />
        <b>Updated</b>: TinyXml to v2.5.1<br />
        <b>Updated</b>: StackFunc.h to v2.0<br />
        <br />
        <br />
        "<b>XML</b>" plugin v1.8<br />
        <br />
        <a href="http://nsis.sourceforge.net/XML_plug-in" target="_blank">Download from Wiki</a></p>
      </div>
      <hr />

      <div class="post">
        <p class="post-meta"><span class="post-author text-primary">rtpHarry</span><br />
        <span class="post-time small text-muted">24th November 2006 11:50 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

        <p class="post-content"><strong>possible bug in system</strong><br />
        I almost abandoned this plugin yesterday when I was writing my installer. Now I have found a work around for it and I think its a great plugin again! ;)<br />
        <br />
        The problem arose when I tried to open an xml file for the second time. The first time I loaded the file (through a function attached to a custom page) it worked fine with this code (as I see it used in the forums as well):<br />
        <br /></p>
        <pre>
<span style="color: #007700">${</span><span style="color: #0000BB">xml</span><span style="color: #007700">::</span><span style="color: #0000BB">LoadFile</span><span style="color: #007700">}</span><span style="color: #DD0000">"client-list.xml"</span><span style="color: #007700">$</span><span style="color: #0000BB">0
<br /></span>

<!-- php buffer end -->
                
                
                
</pre>
        <hr />
        <pre>
        
The second time I used it was in a Section (for the install files part) and it failed with -1 every time until I saw somebody suggest for a different problem to prepend $EXEDIR to the start which fixed it.<br /><br />
        PHP Code:
        
                
</pre>
        <hr />
        <pre>
                <code style="white-space:nowrap">
                
                        <!-- php buffer start --></code><span style="color: #000000">
<span style="color: #007700">${</span><span style="color: #0000BB">xml</span><span style="color: #007700">::</span><span style="color: #0000BB">LoadFile</span><span style="color: #007700">}</span><span style="color: #DD0000">"$EXEDIR\client-list.xml"</span><span style="color: #007700">$</span><span style="color: #0000BB">8
<br /></span>
</span>
<!-- php buffer end -->
                
                
                
</pre>
        <hr />
        <pre>
        

                
</pre>
      </div>
      <hr />

      <div class="post">
        <p class="post-meta"><span class="post-author text-primary">atul123</span><br />
        <span class="post-time small text-muted">6th December 2006 14:02 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

        <p class="post-content">Where can I find examples of "How to use this XML plugin?"</p>
      </div>
      <hr />

      <div class="post">
        <p class="post-meta"><span class="post-author text-primary">niklasu</span><br />
        <span class="post-time small text-muted">17th January 2007 19:47 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

        <p class="post-content"><strong>XPathNode and XPathAttribute</strong><br /></p>

        <blockquote>
          <i>Originally posted by Instructor</i><br />
          <b>Added</b>: ${xml::XPathString} -compute a string XPath expression.<br />
          <b>Added</b>: ${xml::XPathNode} -compute a node XPath expression and goes to it.<br />
          <b>Added</b>: ${xml::XPathAttribute} -compute an attribute XPath expression and goes to it.
        </blockquote>I'm trying to use XPathAttribute to change a setting in a web.config file, like this:<br />
        PHP Code:
        <hr />
        <code style="white-space:nowrap"><!-- php buffer start --></code><span style="color: #000000"><span style="color: #007700">${</span><span style="color: #0000BB">xml</span><span style="color: #007700">::</span><span style="color: #0000BB">LoadFile</span><span style="color: #007700">}</span><span style="color: #DD0000">"$INSTDIR\Web.config"</span><span style="color: #007700">$</span><span style="color: #0000BB">0<br /></span> <span style="color: #007700">${</span><span style="color: #0000BB">xml</span><span style="color: #007700">::</span><span style="color: #0000BB">XPathAttribute</span><span style="color: #007700">}</span><span style="color: #DD0000">"/configuration/appSettings/add***91;@key='EPsConnection'***93;"</span><span style="color: #007700">$</span><span style="color: #0000BB">0<br /></span> <span style="color: #007700">${</span><span style="color: #0000BB">xml</span><span style="color: #007700">::</span><span style="color: #0000BB">SetAttribute</span><span style="color: #007700">}</span><span style="color: #DD0000">"value""somevalue"</span><span style="color: #007700">$</span><span style="color: #0000BB">0<br /></span> <span style="color: #007700">${</span><span style="color: #0000BB">xml</span><span style="color: #007700">::</span><span style="color: #0000BB">SaveFile</span><span style="color: #007700">}</span><span style="color: #DD0000">"$INSTDIR\Web.config"</span><span style="color: #007700">$</span><span style="color: #0000BB">0<br /></span> <span style="color: #007700">${</span><span style="color: #0000BB">xml</span><span style="color: #007700">::</span><span style="color: #0000BB">Unload</span><span style="color: #007700">}</span> But everytime the xml:XPathAttribute statement executes the installer crashes with the following message:<br /></span>
        <pre>
<code><br />Microsoft Visual C++ Runtime Library<br />Assertion failed!<br /><br />Program: setup.exe<br />File: tinyxml.cpp<br />Line: 173<br /><br />Expression: node-&gt;GetDocument() == 0 || node-&gt;GetDocument() == this-&gt;GetDocument()<br /></code>
</pre><br />
        (And I get the same error when using XPathNode too...)<br />
        What am I doing wrong here?
      </div>
      <hr />

      <div class="post">
        <p class="post-meta"><span class="post-author text-primary">Instructor</span><br />
        <span class="post-time small text-muted">18th January 2007 21:38 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

        <p class="post-content"></p>
        <pre>
<code>${xml::LoadFile} "$INSTDIRWeb.config" $0<br /><b>${xml::RootElement} $0 $1</b><br />${xml::XPathAttribute} "/configuration/appSettings/add[@key='EPsConnection']" $0<br />${xml::SetAttribute} "value" "some value" $0<br />${xml::SaveFile} "$INSTDIRWeb.config" $0<br />${xml::Unload}</code>
</pre>
      </div>
      <hr />

      <div class="post">
        <p class="post-meta"><span class="post-author text-primary">Yathosho</span><br />
        <span class="post-time small text-muted">3rd February 2007 13:10 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

        <p class="post-content">could you put this on the wiki please?</p>
      </div>
      <hr />

      <div class="post">
        <p class="post-meta"><span class="post-author text-primary">Commerzpunk</span><br />
        <span class="post-time small text-muted">9th February 2007 09:53 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

        <p class="post-content"></p>

        <blockquote>
          <i>Originally posted by Instructor</i><br />
          <b>1. Not.<br />
          2. I'm not plaining this.<br />
          <br />
          But you can use ${xml::CloneNode}<br />
          <br /></b>
          <pre>
<b><code><br />Section<br />        ${xml::LoadFile} "file.xml" $0<br />        MessageBox MB_OK "xml::LoadFile$\n$$0=$0"<br /><br />        ${xml::GotoPath} "/" $0<br />        MessageBox MB_OK "xml::GotoPath$\n$$0=$0"<br /><br />        ${xml::CloneNode} $R0<br />        MessageBox MB_OK "xml::CloneNode$\n$$R0=$R0"<br /><br />        ${xml::Unload}<br /><br /><br />        ${xml::LoadFile} "file2.xml" $0<br />        MessageBox MB_OK "xml::LoadFile$\n$$0=$0"<br /><br />        ${xml::GotoPath} "/" $0<br />        MessageBox MB_OK "xml::GotoPath$\n$$0=$0"<br /><br />        ${xml::InsertBeforeNode} "$R0" $0<br />        MessageBox MB_OK "xml::InsertBeforeNode$\n$$0=$0"<br /><br />        ${xml::FreeNode} "$R0" $0<br />        MessageBox MB_OK "xml::FreeNode$\n$$0=$0"<br /><br />        ${xml::SaveFile} "file2.xml" $0<br />        MessageBox MB_OK "xml::SaveFile$\n$$0=$0"<br /><br />        ${xml::Unload}<br />SectionEnd<br /></code></b>
</pre>
          <hr />
        </blockquote>
      </div>
      <hr />
      I really tried hard to get this working for me.<br />
      The installer always crashed, when I tried to "InsertBeforeNode".<br />
      <br />
      Now, I used this code and changed it, had several hundered crashes.<br />
      <br />
      Here is the working result (for me):<br />
      <br />
      <pre>
<code><br />        ${xml::LoadFile} "file1.xml" $0<br />        MessageBox MB_OK "xml::LoadFile$\n$$0=$0"<br /><br />        ${xml::GotoPath} "Root/I" $0<br />        MessageBox MB_OK "xml::GotoPath$\n$$0=$0"<br /><br />        ${xml::CloneNode} $R0<br />        MessageBox MB_OK "xml::CloneNode$\n$$R0=$R0"<br /><br />        ${xml::LoadFile} "file2.xml" $0<br />        MessageBox MB_OK "xml::LoadFile$\n$$0=$0"<br />        <br />        ${xml::RootElement} $0 $1 # THATS THE SOLUTION FOR NO CRASHING!<br />        MessageBox MB_OK "xml::RootElement$\n$$0=$0"<br />        MessageBox MB_OK "xml::RootElement$\n$$1=$1"<br />        <br />        ${xml::GotoPath} "I" $0<br />        MessageBox MB_OK "xml::GotoPath$\n$$0=$0"<br />        <br />        ${xml::InsertBeforeNode} "$R0" $0<br />        MessageBox MB_OK "xml::InsertBeforeNode$\n$$0=$0"<br /><br />        ${xml::SaveFile} "file2.xml" $0<br />        MessageBox MB_OK "xml::SaveFile$\n$$0=$0"<br /><br />        ${xml::Unload}<br /></code>
</pre><br />
      <br />
      Messageboxes are for information and debugging only, of course!<br />
      <br />
      Greets,<br />
      <br />
      HA<br />

      <div class="post">
        <p class="post-meta"><span class="post-author text-primary">eafonsof</span><br />
        <span class="post-time small text-muted">10th May 2007 20:31 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

        <p class="post-content"><strong>Modify "value" attribute.</strong><br />
        Hi there, I tried the following commands to modify the attribute named "value". It's not working as I expected. Does anybody know what's missing or wrong?<br />
        Thanks in advance.<br />
        <br />
        ;Format of config file:<br />
        ;&lt;?xml version="1.0" encoding="Windows-1252"?&gt;<br />
        ;&lt;configuration&gt;<br />
        ; &lt;appSettings&gt;<br />
        ; &lt;add key="key1" value="value1" /&gt;<br />
        ; &lt;add key="key2" value="value2" /&gt;<br />
        ; &lt;add key="key3" value="value3" /&gt;<br />
        ;<br />
        ; &lt;!-- Some comments --&gt;<br />
        ; &lt;add key="key4" value="value4" /&gt;<br />
        ; &lt;/appSettings&gt;<br />
        ;&lt;/configuration&gt;<br />
        <br />
        ${xml::LoadFile} "$configFile" $0<br />
        ${xml::RootElement} $0 $1<br />
        ${xml::XPathAttribute} "/configuration/appSettings/add[@key='${KEY4}']" $0<br />
        ${xml::SetAttribute} "value" "$newValue" $0<br />
        ${xml::SaveFile} "$configFile" $0<br />
        ${xml::Unload}<br />
        <br />
        After this, the attribute "value" is set as an attribute of "&lt;configuration" instead of the corresponding "&lt;add" node.<br />
        <br />
        i.e.<br />
        ;<br />
        ;&lt;?xml version="1.0" encoding="Windows-1252"?&gt;<br />
        ;&lt;configuration value="new_value4"&gt;<br />
        ; &lt;appSettings&gt;<br />
        ; &lt;add key="key1" value="value1" /&gt;<br />
        ; &lt;add key="key2" value="value2" /&gt;<br />
        ; &lt;add key="key3" value="value3" /&gt;<br />
        ;<br />
        ; &lt;!-- Some comments --&gt;<br />
        ; &lt;add key="key4" value="value4" /&gt;<br />
        ; &lt;/appSettings&gt;<br />
        ;&lt;/configuration&gt;</p>
      </div>
      <hr />

      <div class="post">
        <p class="post-meta"><span class="post-author text-primary">Instructor</span><br />
        <span class="post-time small text-muted">18th May 2007 20:40 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

        <p class="post-content"></p>
        <pre>
<code>${xml::LoadFile} "$configFile" $0<br />${xml::RootElement} $0 $1<br />${xml::<b>XPathNode</b>} "/configuration/appSettings/add[@key='${KEY4}']" $0<br />${xml::SetAttribute} "value" "$newValue" $0<br />${xml::SaveFile} "$configFile" $0<br />${xml::Unload}</code>
</pre>
      </div>
      <hr />

      <div class="post">
        <p class="post-meta"><span class="post-author text-primary">Instructor</span><br />
        <span class="post-time small text-muted">1st June 2007 13:14 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

        <p class="post-content"><b>Updated</b>: TinyXml to v2.5.3<br />
        <b>Updated</b>: TinyXPath to v1.3.0<br />
        <br />
        <br />
        "<b>XML</b>" plugin v1.9<br />
        <br />
        <a href="http://nsis.sourceforge.net/XML_plug-in" target="_blank">Download from Wiki</a></p>
      </div>
      <hr />

      <div class="post">
        <p class="post-meta"><span class="post-author text-primary">DrDan</span><br />
        <span class="post-time small text-muted">4th July 2007 10:08 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

        <p class="post-content"><strong>Question about the plugin</strong><br />
        I'm working on an installer that uses this plug-in. Now, depending on the contents in my XML I need to run an external progam (in fact another NSIS uninstaller) that will read in the XML file and make changes to it.<br />
        <br />
        The steps I am following are:<br />
        <br />
        1) Open the XML file in the main installer<br />
        2) Manipulate as required<br />
        3) Determine if an external uninstaller is required<br />
        4) If an external uninstaller is required, then save the XML file, run the external uninstaller, re-load the XML file and carry on.<br />
        5) If no external uninstaller is required, carry on.<br />
        <br />
        My question is, in step 4, should I also unload the XML plug-in (i.e. call ${xml::Unload}) before running the external uninstaller?<br />
        <br />
        Thanks.</p>
      </div>
      <hr />

      <div class="post">
        <p class="post-meta"><span class="post-author text-primary">Wizarth</span><br />
        <span class="post-time small text-muted">10th July 2007 06:20 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

        <p class="post-content"><strong>SizeOf</strong><br />
        Edit: Sorry, wrong thread.</p>
      </div>
      <hr />

      <div class="post">
        <p class="post-meta"><span class="post-author text-primary">walb07</span><br />
        <span class="post-time small text-muted">20th August 2007 10:46 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

        <p class="post-content"><strong>Problem to parse XML with &lt;!DOCTYPE ... []&gt; element</strong><br />
        Hi,<br />
        <br />
        I've problems to parse an XML file which contains DTD description between xml header and first root element<br />
        <br />
        Method ${xml::RootElement} returns with "-1". If I change the &lt;!DOCTYPE ..[]&gt; to a comment &lt;!--DOCTYPE ...[]&gt; which isn't really feasible it will work.<br />
        <br />
        It would be helpful to support the DOCTYPE dtag by default.<br />
        <br />
        example:<br />
        <br />
        &lt;?xml version="1.0" encoding="ISO-8859-1"?&gt;<br />
        &lt;!DOCTYPE RootElement [<br />
        &lt;!ELEMENT RootElement (System+)&gt;<br />
        &lt;!ELEMENT System EMPTY&gt;<br />
        <br />
        &lt;!ATTLIST RootElement Version CDATA #REQUIRED&gt;<br />
        ...<br />
        ]&gt;<br />
        &lt;RootElement&gt;<br />
        ...<br />
        &lt;/RootElement&gt;<br />
        <br />
        with regards,<br />
        Dierk</p>
      </div>
      <hr />

      <div class="post">
        <p class="post-meta"><span class="post-author text-primary">jogijhelumi</span><br />
        <span class="post-time small text-muted">22nd January 2008 11:09 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

        <p class="post-content">I'm trying to use XPathNode for expressions with namespace i.e. fns: Deployment<br />
        , but it fails and return error code -1.<br />
        <br />
        Is there any trick/workaround to use it in this way.</p>
      </div>
      <hr />

      <div class="post">
        <p class="post-meta"><span class="post-author text-primary">FkYkko</span><br />
        <span class="post-time small text-muted">29th January 2008 16:24 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

        <p class="post-content">Hi I'm wondering if the attached plugin in this thread is the latest version of this plugin? It seems to me that the include file (xml.nsh) differs from the source code regarding some functions? For example, RemoveChild seems to return an error code while the include file and documentation does not specify any variable for this method. The RemoveAllChild function is not implemented in the source but is is availible in the documentation and include file?<br />
        Are there any updates regarding this? Maybe set up a simple sourceforge page to be able to update it?<br />
        <br />
        or is there some other XML plugin which is generally used and better supported?<br />
        <br />
        p.s. jogijhelumi: <a href="http://tinyxpath.sourceforge.net/" target="_blank">tinyxpath.sourceforge.net/</a> says that namespaces are not supported yet d.s.</p>
      </div>
      <hr />

      <div class="post">
        <p class="post-meta"><span class="post-author text-primary">Instructor</span><br />
        <span class="post-time small text-muted">30th January 2008 15:31 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

        <p class="post-content"><b>Updated</b>: TinyXPath to v1.3.1<br />
        <br />
        <b>Fixed</b>: missing "xml::_RemoveAllChild" in DLL.<br />
        <b>Fixed</b>: ${xml::RemoveNode} incorrectly documented.<br />
        <br />
        <br />
        "<b>XML</b>" plugin v2.0<br />
        <br />
        <a href="http://nsis.sourceforge.net/XML_plug-in" target="_blank">Download from Wiki</a></p>
      </div>
      <hr />

      <div class="post">
        <p class="post-meta"><span class="post-author text-primary">FkYkko</span><br />
        <span class="post-time small text-muted">31st January 2008 08:01 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

        <p class="post-content">Thanks for the quick reply.<br />
        As it happens, I still have some problems with this plugin and have changed to nsisXML (by W) which works after some rewrites.</p>
      </div>
      <hr />

      <div class="post">
        <p class="post-meta"><span class="post-author text-primary">Tzzz</span><br />
        <span class="post-time small text-muted">21st March 2008 16:38 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

        <p class="post-content"><strong>XML::Xxxx functions: doc to improve</strong><br />
        Hello,<br />
        <br />
        It seems to have ben many misunderstanding since the new XML::Xxxx functions were launched:<br />
        <br />
        Quote:</p>
        <hr />

        <div class="post">
          <p class="post-meta"><span class="post-author text-primary">xbarns</span><br />
          <span class="post-time small text-muted">26th March 2008 12:48 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

          <p class="post-content">Hi all,<br />
          <br />
          i need to edit a xml structure like this<br />
          <br /></p>
          <pre>
<span style="color: #007700">&lt;</span><span style="color: #0000BB">Configuration
<br /></span><span style="color: #007700">&lt;</span><span style="color: #0000BB">ConfigModulename</span><span style="color: #007700">=</span><span style="color: #DD0000">"BlaBla"</span><span style="color: #007700">&gt;
<br />&lt;/</span><span style="color: #0000BB">ConfigModule</span><span style="color: #007700">&gt;
<br />&lt;</span><span style="color: #0000BB">ConfigModulename</span><span style="color: #007700">=</span><span style="color: #DD0000">"FirebirdBridge"</span><span style="color: #0000BB">DefaultConfig</span><span style="color: #007700">=</span><span style="color: #DD0000">"FALSE"</span><span style="color: #007700">&gt;
<br />&lt;</span><span style="color: #0000BB">Sectionname</span><span style="color: #007700">=</span><span style="color: #DD0000">"FirebirdBridge"</span><span style="color: #0000BB">description</span><span style="color: #007700">=</span><span style="color: #DD0000">"ConfigurationforFirebirdDBBridge"</span><span style="color: #007700">&gt;
<br />&lt;</span><span style="color: #0000BB">Dataname</span><span style="color: #007700">=</span><span style="color: #DD0000">"Host"</span><span style="color: #0000BB">type</span><span style="color: #007700">=</span><span style="color: #DD0000">"string"</span><span style="color: #007700">&gt;</span><span style="color: #0000BB">127.0.0.1</span><span style="color: #007700">&lt;/</span><span style="color: #0000BB">Data</span><span style="color: #007700">&gt;
<br />&lt;</span><span style="color: #0000BB">Dataname</span><span style="color: #007700">=</span><span style="color: #DD0000">"Database"</span><span style="color: #0000BB">type</span><span style="color: #007700">=</span><span style="color: #DD0000">"string"</span><span style="color: #007700">&gt;</span><span style="color: #0000BB">C</span><span style="color: #007700">:</span><span style="color: #0000BB">ProgramFilesTestDatabaseTest</span><span style="color: #007700">.</span><span style="color: #0000BB">FDB</span><span style="color: #007700">&lt;/</span><span style="color: #0000BB">Data</span><span style="color: #007700">&gt;
<br />&lt;</span><span style="color: #0000BB">Dataname</span><span style="color: #007700">=</span><span style="color: #DD0000">"User"</span><span style="color: #0000BB">type</span><span style="color: #007700">=</span><span style="color: #DD0000">"string"</span><span style="color: #007700">&gt;</span><span style="color: #0000BB">User</span><span style="color: #007700">&lt;/</span><span style="color: #0000BB">Data</span><span style="color: #007700">&gt;
<br />&lt;</span><span style="color: #0000BB">Dataname</span><span style="color: #007700">=</span><span style="color: #DD0000">"Password"</span><span style="color: #0000BB">type</span><span style="color: #007700">=</span><span style="color: #DD0000">"string"</span><span style="color: #007700">&gt;</span><span style="color: #0000BB">Password</span><span style="color: #007700">&lt;/</span><span style="color: #0000BB">Data</span><span style="color: #007700">&gt;
<br />&lt;/</span><span style="color: #0000BB">Section</span><span style="color: #007700">&gt;
<br />&lt;/</span><span style="color: #0000BB">ConfigModule</span><span style="color: #007700">&gt;
<br />&lt;/</span><span style="color: #0000BB">Configuration</span><span style="color: #007700">&gt;
</span>
</pre>In order to change the "&lt;Data name="Database" type="string"&gt;C:\Program Files\Test\Database\Test.FDB&lt;/Data&gt;" is there any other way then looping through the nodes and comparing attributes ?<br />
          <br />
          i am already looping through the "ConfigModule" Nodes and comparing, is there an easier way?<br />
          <br />
          Here is the code i have so far:<br />
          <br />
          <pre>
<span style="color: #007700">${</span><span style="color: #0000BB">xml</span><span style="color: #007700">::</span><span style="color: #0000BB">LoadFile</span><span style="color: #007700">}</span><span style="color: #DD0000">"$EXEDIR\scMaster.ctf"</span><span style="color: #007700">$</span><span style="color: #0000BB">0
<br />loop</span><span style="color: #007700">:
<br />${</span><span style="color: #0000BB">xml</span><span style="color: #007700">::</span><span style="color: #0000BB">FindNextElement</span><span style="color: #007700">}</span><span style="color: #DD0000">"ConfigModule"</span><span style="color: #007700">$</span><span style="color: #0000BB">0</span><span style="color: #007700">$</span><span style="color: #0000BB">1
<br /></span><span style="color: #007700">${</span><span style="color: #0000BB">xml</span><span style="color: #007700">::</span><span style="color: #0000BB">ElementPath</span><span style="color: #007700">}$</span><span style="color: #0000BB">0
<br /></span><span style="color: #007700">${</span><span style="color: #0000BB">xml</span><span style="color: #007700">::</span><span style="color: #0000BB">GetAttribute</span><span style="color: #007700">}</span><span style="color: #DD0000">"name"</span><span style="color: #007700">$</span><span style="color: #0000BB">1</span><span style="color: #007700">$</span><span style="color: #0000BB">2
<br /><br /></span><span style="color: #007700">${IF}$</span><span style="color: #0000BB">1</span><span style="color: #007700">==</span><span style="color: #DD0000">"FirebirdBridge"
<br /><br /></span><span style="color: #007700">${</span><span style="color: #0000BB">xml</span><span style="color: #007700">::</span><span style="color: #0000BB">GotoPath</span><span style="color: #007700">}</span><span style="color: #DD0000">"$0/Section/Data"</span><span style="color: #007700">$</span><span style="color: #0000BB">1
<br /><br />Loophereagain</span><span style="color: #007700">?
<br /><br /><br />${ELSE}
<br /></span><span style="color: #0000BB">Gotoloop
<br /></span><span style="color: #007700">${ENDIF}
<br /><br />${</span><span style="color: #0000BB">xml</span><span style="color: #007700">::</span><span style="color: #0000BB">FindCloseElement</span><span style="color: #007700">}
<br />${</span><span style="color: #0000BB">xml</span><span style="color: #007700">::</span><span style="color: #0000BB">SaveFile</span><span style="color: #007700">}</span><span style="color: #DD0000">"$EXEDIR\scMaster2.ctf"</span><span style="color: #007700">$</span><span style="color: #0000BB">0
<br /></span><span style="color: #007700">${</span><span style="color: #0000BB">xml</span><span style="color: #007700">::</span><span style="color: #0000BB">Unload</span><span style="color: #007700">}
</span>
</pre><br />
          Thanks for helping :)
        </div>
        <hr />

        <div class="post">
          <p class="post-meta"><span class="post-author text-primary">freeDB_man</span><br />
          <span class="post-time small text-muted">26th April 2008 14:05 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

          <p class="post-content">I tried to use this plug-in with the special build of NSIS that has a string length limitation of 8192 instead of 1024 but the plug-in is indifferent to the change and only reads 1024 chars.<br />
          <br />
          Any workaround?</p>
        </div>
        <hr />

        <div class="post">
          <p class="post-meta"><span class="post-author text-primary">spitze</span><br />
          <span class="post-time small text-muted">11th June 2008 08:46 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

          <p class="post-content">Hi all,<br />
          first of all great plugin. But i have a problem which i cannot solve.<br />
          I want to insert a line in an XML file.<br />
          <br />
          The XML file looks like:<br />
          <br />
          <br /></p>
          <pre>
<code>&lt;?xmlversion</code><span style="color: #007700">=</span><span style="color: #DD0000">"1.0"</span><span style="color: #0000BB">encoding</span><span style="color: #007700">=</span><span style="color: #DD0000">"iso-8859-1"</span><span style="color: #0000BB">standalone</span><span style="color: #007700">=</span><span style="color: #DD0000">"no"</span><span style="color: #0000BB">?&gt;
<br /></span>&lt;adtf:configurationxmlns:adtv="adtv"&gt;
<br />&lt;general_settings&gt;
<br />&lt;propertyname="gui_refresh_rate"value="25"/&gt;
<br />&lt;/general_settings&gt;
<br />&lt;module_directories&gt;
<br />&lt;/module_directories&gt;
<br />&lt;template_directories/&gt;
<br />&lt;/adtf:configuration&gt;
<!-- php buffer end -->
                
                
                
</pre>
          <hr />
          <pre>
        
Now i want to insert:<br /><br />
        PHP Code:
        
                
</pre>
          <hr />
          <pre>
                <code style="white-space:nowrap">
                
                        <!-- php buffer start --></code><span style="color: #000000">
<span style="color: #007700">&lt;</span><span style="color: #0000BB">directorypath</span><span style="color: #007700">=</span><span style="color: #DD0000">"C:\programfiles\Test"</span><span style="color: #007700">/&gt;
</span></span>
</pre>between<br />
          <br />
          <pre>
<span style="color: #007700">&lt;</span><span style="color: #0000BB">module_directories</span><span style="color: #007700">&gt;
<br />&lt;/</span><span style="color: #0000BB">module_directories</span><span style="color: #007700">&gt;
</span>
</pre><br />
          I tried this piece of code<br />
          <br />
          <pre>
<span style="color: #007700">${</span><span style="color: #0000BB">xml</span><span style="color: #007700">::</span><span style="color: #0000BB">FindNextElement</span><span style="color: #007700">}</span><span style="color: #DD0000">"module_directories"</span><span style="color: #007700">$</span><span style="color: #0000BB">0</span><span style="color: #007700">$</span><span style="color: #0000BB">1
<br /></span><span style="color: #007700">${</span><span style="color: #0000BB">xml</span><span style="color: #007700">::</span><span style="color: #0000BB">CreateNode</span><span style="color: #007700">}</span><span style="color: #DD0000">'&lt;directorypath="C:\programfiles\Test"/&gt;'</span><span style="color: #007700">$</span><span style="color: #0000BB">4
<br /></span><span style="color: #007700">${</span><span style="color: #0000BB">xml</span><span style="color: #007700">::</span><span style="color: #0000BB">InsertAfterNode</span><span style="color: #007700">}$</span><span style="color: #0000BB">4</span><span style="color: #007700">$</span><span style="color: #0000BB">5
<br /></span>

<!-- php buffer end -->
                
                
                
</pre>
          <hr />
          <pre>
        
The Output is:<br /><br />
        PHP Code:
        
                
</pre>
          <hr />
          <pre>
                <code style="white-space:nowrap">
                
                        <!-- php buffer start --></code><span style="color: #000000">
<span style="color: #007700">&lt;</span><span style="color: #0000BB">module_directories</span><span style="color: #007700">/&gt;
<br />&lt;</span><span style="color: #0000BB">directorypath</span><span style="color: #007700">=</span><span style="color: #DD0000">"C:\programfiles\Test"</span><span style="color: #007700">/&gt;
</span></span>
</pre>but it should be:<br />
          <br />
          <pre>
<span style="color: #007700">&lt;</span><span style="color: #0000BB">module_directories</span><span style="color: #007700">&gt;
<br />&lt;</span><span style="color: #0000BB">directorypath</span><span style="color: #007700">=</span><span style="color: #DD0000">"C:\programfiles\Test"</span><span style="color: #007700">/&gt;
<br />&lt;/</span><span style="color: #0000BB">module_directories</span><span style="color: #007700">&gt;
</span>
</pre>Any suggestions??<br />
          Thanx
        </div>
        <hr />

        <div class="post">
          <p class="post-meta"><span class="post-author text-primary">Instructor</span><br />
          <span class="post-time small text-muted">11th June 2008 10:28 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

          <p class="post-content"></p>
          <pre>
<code>${xml::FindNextElement} "module_directories" $0 $1 <br />${xml::CreateNode} '&lt;directory path="C:program filesTest"/&gt;' $4 <br /><font color="red">${xml::InsertEndChild}</font> $4 $5</code>
</pre>
        </div>
        <hr />

        <div class="post">
          <p class="post-meta"><span class="post-author text-primary">radorl</span><br />
          <span class="post-time small text-muted">27th December 2008 12:11 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

          <p class="post-content">I'm editing XML file which uses &amp;#DDDD; notation for non-ASCII characters. I noticed that after saving of modified XML file all &amp;#DDDD; characters were replaced by original two-byte UTF-8 codes.<br />
          <br />
          Is there some way how to instruct this wonderful plugin to use &amp;#DDDD; notation?</p>
        </div>
        <hr />

        <div class="post">
          <p class="post-meta"><span class="post-author text-primary">casioclave</span><br />
          <span class="post-time small text-muted">20th March 2009 08:36 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

          <p class="post-content"><strong>need some help</strong><br />
          Hi. Can U help me to change value in this stiring &lt;value&gt;en&lt;/value&gt; from "en" to "ru"<br />
          <br />
          &lt;?xml version="1.0" encoding="utf-8" ?&gt;<br />
          &lt;configuration&gt;<br />
          &lt;configSections&gt;<br />
          &lt;sectionGroup name="userSettings" type="System.Configuration.UserSettingsGroup, System, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089" &gt;<br />
          &lt;section name="inVisit.Properties.Settings" type="System.Configuration.ClientSettingsSection, System, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089" allowExeDefinition="MachineToLocalUser" requirePermission="false" /&gt;<br />
          &lt;/sectionGroup&gt;<br />
          &lt;/configSections&gt;<br />
          &lt;connectionStrings&gt;<br />
          &lt;clear /&gt;<br />
          &lt;add name="LocalSqlServer" connectionString="data source=.\SQLEXPRESS;Integrated Security=SSPI;AttachDBFilename=|DataDirectory|aspnetdb.mdf;User Instance=true"<br />
          providerName="System.Data.SqlClient" /&gt;<br />
          &lt;add name="inVisit.Properties.Settings.ivConnection" connectionString="Data Source=.\sqlexpress;AttachDbFilename=;Initial Catalog=ivData;Integrated Security=True;Connect Timeout=30"<br />
          providerName="" /&gt;<br />
          &lt;/connectionStrings&gt;<br />
          &lt;userSettings&gt;<br />
          &lt;inVisit.Properties.Settings&gt;<br />
          &lt;setting name="WinFormState" serializeAs="String"&gt;<br />
          &lt;value&gt;Normal&lt;/value&gt;<br />
          &lt;/setting&gt;<br />
          &lt;setting name="WinFormSize" serializeAs="String"&gt;<br />
          &lt;value&gt;800, 600&lt;/value&gt;<br />
          &lt;/setting&gt;<br />
          ...<br />
          &lt;setting name="Language" serializeAs="String"&gt;<br />
          &lt;value&gt;en&lt;/value&gt;<br />
          &lt;/setting&gt;<br />
          &lt;setting name="AutoCheckOut" serializeAs="String"&gt;<br />
          &lt;value&gt;False&lt;/value&gt;<br />
          &lt;/setting&gt;<br />
          <br />
          &lt;/userSettings&gt;<br />
          &lt;/configuration&gt;</p>
        </div>
        <hr />

        <div class="post">
          <p class="post-meta"><span class="post-author text-primary">mattm591</span><br />
          <span class="post-time small text-muted">26th May 2009 15:03 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

          <p class="post-content">I am trying to use this plugin to get values from an XML structure.<br />
          <br />
          The document looks something like this:<br />
          <br />
          &lt;xml&gt;<br />
          &lt;groups&gt;<br />
          &lt;group id="1"&gt;<br />
          &lt;name&gt;Group 1&lt;/name&gt;<br />
          &lt;/group&gt;<br />
          &lt;group id="2"&gt;<br />
          &lt;name&gt;Group 2&lt;/name&gt;<br />
          &lt;/group&gt;<br />
          &lt;group id="3"&gt;<br />
          &lt;name&gt;Group 3&lt;/name&gt;<br />
          &lt;/group&gt;<br />
          &lt;/groups&gt;<br />
          &lt;/xml&gt;<br />
          <br />
          I want to get the values of id and name and am currently working on getting value. After loading the document I can get the value of the first group (id 1) by doing this,<br /></p>
          <pre>
<span style="color: #007700">${</span><span style="color: #0000BB">xml</span><span style="color: #007700">::</span><span style="color: #0000BB">GotoPath</span><span style="color: #007700">}</span><span style="color: #DD0000">"/xml/groups/group"</span><span style="color: #007700">$</span><span style="color: #0000BB">0
<br /></span><span style="color: #007700">${</span><span style="color: #0000BB">xml</span><span style="color: #007700">::</span><span style="color: #0000BB">GetAttribute</span><span style="color: #007700">}</span><span style="color: #DD0000">"id"</span><span style="color: #007700">$</span><span style="color: #0000BB">0</span><span style="color: #007700">$</span><span style="color: #0000BB">1
<br /></span>

<!-- php buffer end -->
                
                
                
</pre>
          <hr />
          <pre>
        
but I cannot get any others.<br /><br />The code I am trying uses {xml::NextAttribute} and no matter what I do I alway get -1 returned for $2 and $0 and $1 are null. I originally tried it like this to get the loop, but it doesn't work even if I only run it once.<br />
        PHP Code:
        
                
</pre>
          <hr />
          <pre>
                <code style="white-space:nowrap">
                
                        <!-- php buffer start --></code><span style="color: #000000">
<span style="color: #007700">${</span><span style="color: #0000BB">xml</span><span style="color: #007700">::</span><span style="color: #0000BB">NextAttribute</span><span style="color: #007700">}$</span><span style="color: #0000BB">0</span><span style="color: #007700">$</span><span style="color: #0000BB">1</span><span style="color: #007700">$</span><span style="color: #0000BB">2
<br /></span><span style="color: #007700">${While}$</span><span style="color: #0000BB">2</span><span style="color: #007700">!=-</span><span style="color: #0000BB">1
<br /></span><span style="color: #007700">${</span><span style="color: #0000BB">xml</span><span style="color: #007700">::</span><span style="color: #0000BB">NextAttribute</span><span style="color: #007700">}$</span><span style="color: #0000BB">0</span><span style="color: #007700">$</span><span style="color: #0000BB">1</span><span style="color: #007700">$</span><span style="color: #0000BB">2
<br />MessageBoxMB_OK</span><span style="color: #007700">$</span><span style="color: #0000BB">0
<br /></span><span style="color: #007700">${EndWhile}
</span></span>
</pre>Can anyone please tell me what I'm doing wrong and how I can access these values.
        </div>
        <hr />

        <div class="post">
          <p class="post-meta"><span class="post-author text-primary">mattm591</span><br />
          <span class="post-time small text-muted">27th May 2009 15:37 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

          <p class="post-content">Ok I have managed to get it working.<br />
          <br />
          For anyone else with a similar issue here is what I did. (I used LastChild and PreviousSibling because I wanted to get the xml in reverse, replace with FirstChild and NextSibling to go through in order). Also, I make use of LogicLib which you will need to include if you're copying this example.<br />
          <br /></p>
          <pre>
<span style="color: #007700">${</span><span style="color: #0000BB">xml</span><span style="color: #007700">::</span><span style="color: #0000BB">GotoPath</span><span style="color: #007700">}</span><span style="color: #DD0000">"/xml/groups"</span><span style="color: #007700">$</span><span style="color: #0000BB">0
<br /></span><span style="color: #007700">${</span><span style="color: #0000BB">xml</span><span style="color: #007700">::</span><span style="color: #0000BB">LastChild</span><span style="color: #007700">}</span><span style="color: #DD0000">"group"</span><span style="color: #007700">$</span><span style="color: #0000BB">1</span><span style="color: #007700">$</span><span style="color: #0000BB">0
<br /><br /></span><span style="color: #007700">${While}$</span><span style="color: #0000BB">0</span><span style="color: #007700">==</span><span style="color: #0000BB">0
<br /><br /></span><span style="color: #FF8000">#getthegroupid
<br /></span><span style="color: #007700">${</span><span style="color: #0000BB">xml</span><span style="color: #007700">::</span><span style="color: #0000BB">GetAttribute</span><span style="color: #007700">}</span><span style="color: #DD0000">"id"</span><span style="color: #007700">$</span><span style="color: #0000BB">1</span><span style="color: #007700">$</span><span style="color: #0000BB">3
<br /><br /></span><span style="color: #FF8000">#getthegroupname
<br /></span><span style="color: #007700">${</span><span style="color: #0000BB">xml</span><span style="color: #007700">::</span><span style="color: #0000BB">FirstChildElement</span><span style="color: #007700">}</span><span style="color: #DD0000">"name"</span><span style="color: #007700">$</span><span style="color: #0000BB">3</span><span style="color: #007700">$</span><span style="color: #0000BB">4
<br /></span><span style="color: #007700">${</span><span style="color: #0000BB">xml</span><span style="color: #007700">::</span><span style="color: #0000BB">GetText</span><span style="color: #007700">}$</span><span style="color: #0000BB">2</span><span style="color: #007700">$</span><span style="color: #0000BB">3
<br /><br /></span><span style="color: #FF8000">#movetonextgroup
<br /></span><span style="color: #007700">${</span><span style="color: #0000BB">xml</span><span style="color: #007700">::</span><span style="color: #0000BB">Parent</span><span style="color: #007700">}$</span><span style="color: #0000BB">3</span><span style="color: #007700">$</span><span style="color: #0000BB">4
<br /></span><span style="color: #007700">${</span><span style="color: #0000BB">xml</span><span style="color: #007700">::</span><span style="color: #0000BB">PreviousSibling</span><span style="color: #007700">}</span><span style="color: #DD0000">"group"</span><span style="color: #007700">$</span><span style="color: #0000BB">1</span><span style="color: #007700">$</span><span style="color: #0000BB">0
<br /><br /></span><span style="color: #007700">${EndWhile}
</span>
</pre>
        </div>
        <hr />

        <div class="post">
          <p class="post-meta"><span class="post-author text-primary">sag47</span><br />
          <span class="post-time small text-muted">18th October 2009 23:26 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

          <p class="post-content">Here is a nice small example of using this plugin. In my installer header I included XML.nsh.<br />
          <br /></p>
          <pre>
<code>include "XML.nsh"</code>
</pre><br />
          <br />
          Here is a sample XML file that you should extract to the temp folder ($TEMP).<br />
          <br />
          <pre>
<code>&lt;?xml version='1.0' encoding='UTF-8' ?&gt;<br /><br />&lt;account version='1.0'&gt;<br />        &lt;account&gt;<br />                &lt;protocol&gt;prpl-jabber&lt;/protocol&gt;<br />                &lt;name&gt;&lt;/name&gt;<br />                &lt;settings&gt;<br />                        &lt;setting name='use-global-buddyicon' type='bool'&gt;1&lt;/setting&gt;<br />                        &lt;setting name='require_tls' type='bool'&gt;1&lt;/setting&gt;<br />                        &lt;setting name='ft_proxies' type='string'&gt;gtalk.google.com:7777&lt;/setting&gt;<br />                        &lt;setting name='check-mail' type='bool'&gt;0&lt;/setting&gt;<br />                        &lt;setting name='connect_server' type='string'&gt;gtalk.google.com&lt;/setting&gt;<br />                        &lt;setting name='old_ssl' type='bool'&gt;0&lt;/setting&gt;<br />                        &lt;setting name='auth_plain_in_clear' type='bool'&gt;0&lt;/setting&gt;<br />                        &lt;setting name='buddy_icon_timestamp' type='int'&gt;0&lt;/setting&gt;<br />                        &lt;setting name='port' type='int'&gt;443&lt;/setting&gt;<br />                        &lt;setting name='custom_smileys' type='bool'&gt;1&lt;/setting&gt;<br />                &lt;/settings&gt;<br />                &lt;settings ui='gtk-gaim'&gt;<br />                        &lt;setting name='auto-login' type='bool'&gt;1&lt;/setting&gt;<br />                &lt;/settings&gt;<br />        &lt;/account&gt;<br />&lt;/account&gt;</code>
</pre><br />
          <br />
          Basically what I wanted to do in the XML file above was to set text inside of the &lt;name&gt;&lt;/name&gt; XML node to text that is dependent on user options in my installer. Here's my NSIS code that I use to modify the above XML:<br />
          <pre>
<span style="color: #007700">${</span><span style="color: #0000BB">xml</span><span style="color: #007700">::</span><span style="color: #0000BB">LoadFile</span><span style="color: #007700">}</span><span style="color: #DD0000">"$TEMP\\accounts.xml"</span><span style="color: #007700">$</span><span style="color: #0000BB">0
<br />IntCmp</span><span style="color: #007700">$</span><span style="color: #0000BB">00</span><span style="color: #007700">+</span><span style="color: #0000BB">2</span><span style="color: #007700">+</span><span style="color: #0000BB">1</span><span style="color: #007700">+</span><span style="color: #0000BB">2
<br />MessageBoxMB_OK</span><span style="color: #007700">|</span><span style="color: #0000BB">MB_ICONSTOP</span><span style="color: #DD0000">"Errorloadingaccounts.xml!"
<br /></span><span style="color: #007700">${</span><span style="color: #0000BB">xml</span><span style="color: #007700">::</span><span style="color: #0000BB">RootElement</span><span style="color: #007700">}$</span><span style="color: #0000BB">1</span><span style="color: #007700">$</span><span style="color: #0000BB">0
<br /></span><span style="color: #007700">${</span><span style="color: #0000BB">xml</span><span style="color: #007700">::</span><span style="color: #0000BB">FirstChildElement</span><span style="color: #007700">}</span><span style="color: #DD0000">""</span><span style="color: #007700">$</span><span style="color: #0000BB">1</span><span style="color: #007700">$</span><span style="color: #0000BB">0
<br /></span><span style="color: #007700">${</span><span style="color: #0000BB">xml</span><span style="color: #007700">::</span><span style="color: #0000BB">FirstChildElement</span><span style="color: #007700">}</span><span style="color: #DD0000">"name"</span><span style="color: #007700">$</span><span style="color: #0000BB">1</span><span style="color: #007700">$</span><span style="color: #0000BB">0
<br />DetailPrint</span><span style="color: #DD0000">"Setting***91;email***93;sam@gtalk.google.com***91;/email***93;/Home"
<br /></span><span style="color: #007700">${</span><span style="color: #0000BB">xml</span><span style="color: #007700">::</span><span style="color: #0000BB">SetText</span><span style="color: #007700">}</span><span style="color: #DD0000">"sam@gtalk.google.com/Home"</span><span style="color: #007700">$</span><span style="color: #0000BB">0
<br />IntCmp</span><span style="color: #007700">$</span><span style="color: #0000BB">00</span><span style="color: #007700">+</span><span style="color: #0000BB">2</span><span style="color: #007700">+</span><span style="color: #0000BB">1</span><span style="color: #007700">+</span><span style="color: #0000BB">2
<br />MessageBoxMB_OK</span><span style="color: #007700">|</span><span style="color: #0000BB">MB_ICONSTOP</span><span style="color: #DD0000">"Errorsettingusername!"
<br /></span><span style="color: #007700">${</span><span style="color: #0000BB">xml</span><span style="color: #007700">::</span><span style="color: #0000BB">SaveFile</span><span style="color: #007700">}</span><span style="color: #DD0000">""</span><span style="color: #007700">$</span><span style="color: #0000BB">0
<br />IntCmp</span><span style="color: #007700">$</span><span style="color: #0000BB">00</span><span style="color: #007700">+</span><span style="color: #0000BB">2</span><span style="color: #007700">+</span><span style="color: #0000BB">1</span><span style="color: #007700">+</span><span style="color: #0000BB">2
<br />MessageBoxMB_OK</span><span style="color: #007700">|</span><span style="color: #0000BB">MB_ICONSTOP</span><span style="color: #DD0000">"Errorsavingaccounts.xml!"
<br /></span><span style="color: #007700">${</span><span style="color: #0000BB">xml</span><span style="color: #007700">::</span><span style="color: #0000BB">Unload</span><span style="color: #007700">}
</span>
</pre>Commands above explained...[list=1][*]${xml::LoadFile} "$TEMP\accounts.xml" $0 loads my XML file to be modified.[*]${xml::RootElement} $1 $0 selects the root node &lt;account version='1.0'&gt;[*]${xml::FirstChildElement} "" $1 $0 selects the first childnode located in the root node (which happens to be &lt;account&gt;). No argument means select the first childnode no matter what its name is.[*]${xml::FirstChildElement} "name" $1 $0 selects the first childnode within the node accounts &gt; accounts that has the name "name" or &lt;name&gt;&lt;/name&gt;.[*]${xml::SetText} "sam@gtalk.google.com/Home" $0 sets the text inside of &lt;name&gt;&lt;/name&gt; so the result is &lt;name&gt;sam@gtalk.google.com/Home&lt;/name&gt;[*]${xml::SaveFile} "" $0 saves changes that I've made to my XML file. No argument means save to the same file that was originally opened[*]${xml::Unload} unloads the XML plugin since I'm done modifying my XML file.[*]If you're wondering about <a href="http://nsis.sourceforge.net/Docs/Chapter4.html#4.9.4.13" target="_blank">IntCmp</a> $0 0 +2 +1 +2, $0 is the error code returned by the given XML command. IntCmp compares the integer variable $0 with the integer 0 (zero). If $0 is equal to 0 then go down +2 commands (skipping the error message). If $0 is less than 0 then go down +1 command (show the error message). If $0 is greater than 0 then go down +2 commands (skip the error message). <a href="http://nsis.sourceforge.net/Docs/Chapter4.html#4.4" target="_blank">Skipping commands</a> like that ignores comments.[/list=1]<br />
          <br />
          Here is what my XML file looks like after being modified...<br />
          <pre>
<code>&lt;?xml version='1.0' encoding='UTF-8' ?&gt;<br /><br />&lt;account version='1.0'&gt;<br />        &lt;account&gt;<br />                &lt;protocol&gt;prpl-jabber&lt;/protocol&gt;<br />                &lt;name&gt;sam@gtalk.google.com/Home&lt;/name&gt;<br />                &lt;settings&gt;<br />                        &lt;setting name='use-global-buddyicon' type='bool'&gt;1&lt;/setting&gt;<br />                        &lt;setting name='require_tls' type='bool'&gt;1&lt;/setting&gt;<br />                        &lt;setting name='ft_proxies' type='string'&gt;gtalk.google.com:7777&lt;/setting&gt;<br />                        &lt;setting name='check-mail' type='bool'&gt;0&lt;/setting&gt;<br />                        &lt;setting name='connect_server' type='string'&gt;gtalk.google.com&lt;/setting&gt;<br />                        &lt;setting name='old_ssl' type='bool'&gt;0&lt;/setting&gt;<br />                        &lt;setting name='auth_plain_in_clear' type='bool'&gt;0&lt;/setting&gt;<br />                        &lt;setting name='buddy_icon_timestamp' type='int'&gt;0&lt;/setting&gt;<br />                        &lt;setting name='port' type='int'&gt;443&lt;/setting&gt;<br />                        &lt;setting name='custom_smileys' type='bool'&gt;1&lt;/setting&gt;<br />                &lt;/settings&gt;<br />                &lt;settings ui='gtk-gaim'&gt;<br />                        &lt;setting name='auto-login' type='bool'&gt;1&lt;/setting&gt;<br />                &lt;/settings&gt;<br />        &lt;/account&gt;<br />&lt;/account&gt;</code>
</pre><br />
          <br />
          Note: I changed XML values from my actual installer for the sake of this quick example to help get others started. So I would ignore the actual content because it has no use at all.<br />
          <br />
          It took only a couple of minutes of reading the documentation that came with the XML plugin for NSIS that I created the above functions. So read the documentation for a better explanation of all of the capabilities possible with this wonderful plugin.<br />
          <br />
          Sam Gleske
        </div>
        <hr />

        <div class="post">
          <p class="post-meta"><span class="post-author text-primary">ChocJunkie</span><br />
          <span class="post-time small text-muted">9th November 2009 10:31 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

          <p class="post-content">What's the difference between using</p>
          <pre>
<code>${FirstChildElement} "name" $var1 $var2</code>
</pre>and
          <pre>
<code>${FirstChild} "name" $var1 $var2</code>
</pre>for getting a element child? Especially, I'm interested what ${FirstChildElement} exists for, if the task can be done using ${FistChild}. A child can only be of type text or element. So that ${FirstChild} "Name" does search for a element child, doesn't it?<br />
          <br />
          Thanks :)<br />
          <br />
          CJ
        </div>
        <hr />

        <div class="post">
          <p class="post-meta"><span class="post-author text-primary">ChocJunkie</span><br />
          <span class="post-time small text-muted">25th November 2009 10:46 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

          <p class="post-content">It think the plugin is missing a flug that declares the XML.nsh as already included!?<br />
          <br />
          CJ</p>
        </div>
        <hr />

        <div class="post">
          <p class="post-meta"><span class="post-author text-primary">phungus420</span><br />
          <span class="post-time small text-muted">18th December 2009 16:25 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

          <p class="post-content">I'm not a programmer by trade and cannot figure out how to do what I need to do. As background I have an installer for a video game mod, however it only works if the user has patched the game, and it's a frequent issue where users don't patch and then complain that the mod causes a crash. I wanted to have the installer abort if the game isn't patched, and used a registry check, which works fine for 90% of users. Unfortunately a certain distributer (STEAM) does not sign a version key to their registry, so I can't check the version number using the registry for steam users. Also the script is a bit overly complex with all the various registry checks it needs to do anyway.<br />
          <br />
          There is a simpler way, the game has an XML document that contains the version number. I tried to use the text reading function by Stu, but it fails, I assume because it's an XML file and not a text document. So looking around I found this plug in. Common sense would show that this plug in can be used to do what I want, unfortunately I can not figure out how to use it.<br />
          <br />
          Basically I want to open up an XML file, I know how to get NSIS to find the file on the user's computer. Then I want to open it, go to line 10, and read what's there and return true if it's version is 319 and false if not. The specific XML tag is this:<br /></p>
          <pre>
<code>        &lt;Define&gt;<br />                &lt;DefineName&gt;CIV4_VERSION&lt;/DefineName&gt;<br />                &lt;iDefineIntVal&gt;319&lt;/iDefineIntVal&gt;<br />        &lt;/Define&gt;</code>
</pre><br />
          The iDefineIntVal is on line 10, and will always be on line 10. This is why this method would be superior to the registry check I'm currently using (which fails for some users).<br />
          <br />
          Does anyone know how to read this, and get a true/false (or 1/0 etc) response if it's what it should be?
        </div>
        <hr />

        <div class="post">
          <p class="post-meta"><span class="post-author text-primary">msroboto</span><br />
          <span class="post-time small text-muted">18th December 2009 19:11 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

          <p class="post-content">nsisXML::select /NOUNLOAD '/Define/iDefineIntVal'<br />
          ${If} $1 != "0"<br />
          nsisXML::getText /NOUNLOAD<br />
          ;the result should be in $3<br />
          ${If} $3 == "319"<br />
          ;do what you want<br />
          ${Endif}<br />
          ${Endif}</p>
        </div>
        <hr />

        <div class="post">
          <p class="post-meta"><span class="post-author text-primary">phungus420</span><br />
          <span class="post-time small text-muted">18th December 2009 19:48 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

          <p class="post-content"></p>

          <blockquote>
            <i>Originally posted by msroboto</i><br />
            <b>nsisXML::select /NOUNLOAD '/Define/iDefineIntVal'<br />
            ${If} $1 != "0"<br />
            nsisXML::getText /NOUNLOAD<br />
            ;the result should be in $3<br />
            ${If} $3 == "319"<br />
            ;do what you want<br />
            ${Endif}<br />
            ${Endif}</b>
          </blockquote>Thanks for the response and help. But I can't figure this out. Where am I defining the file I am loading from? Also the whole document is iDefineIntVal tags like the above, I need it to read specifically the one on line 10, or the one that the XML is defining as CIV4_VERSION. As an example here is a snippet of the XML file:<br />
          <br />
          <pre>
<code>        &lt;Define&gt;<br />                &lt;DefineName&gt;CIV4_VERSION&lt;/DefineName&gt;<br />                &lt;iDefineIntVal&gt;319&lt;/iDefineIntVal&gt;<br />        &lt;/Define&gt;<br />        &lt;Define&gt;<br />                &lt;DefineName&gt;MIN_VERSION&lt;/DefineName&gt;<br />                &lt;iDefineIntVal&gt;000&lt;/iDefineIntVal&gt;<br />        &lt;/Define&gt;<br />        &lt;Define&gt;<br />                &lt;DefineName&gt;SAVE_VERSION&lt;/DefineName&gt;<br />                &lt;iDefineIntVal&gt;302&lt;/iDefineIntVal&gt;<br />        &lt;/Define&gt;<br />...</code>
</pre><br />
          Obviously I just want the CIV4_VERSION tag. So how do I:<br />
          1)define the XML file I'm reading this from (this file is on the User's computer, and I set the path off of the install directory; I can run a check for if the file exists easily, so defining it is easy, I just don't understand how to pass that to the XML NSIS function here)<br />
          2)Define which tag to read
        </div>
        <hr />

        <div class="container">
          <!-- Put navigation bar here -->

          <ol class="breadcrumb">
            <li><a href="../index.html" class="glyphicon glyphicon-home"></a></li>

            <li><a href="f-65.html">NSIS Discussion</a></li>

            <li class="active">XML plugin</li>
          </ol>

          <p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=227162">XML plugin</a></p><br />

          <div class="post">
            <p class="post-meta"><span class="post-author text-primary">ChocJunkie</span><br />
            <span class="post-time small text-muted">7th January 2010 10:13 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

            <p class="post-content">I have a problem in understanding the <i>xml::unload</i> function. What exactly does it do?<br />
            Does it unload the plugin or the loaded xml file?<br />
            If it unloads the plugin, how can I unload the loaded file?<br />
            <br />
            Thanks. :)<br />
            <br />
            CJ</p>
          </div>
          <hr />

          <div class="post">
            <p class="post-meta"><span class="post-author text-primary">pengyou</span><br />
            <span class="post-time small text-muted">7th January 2010 15:27 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

            <p class="post-content">From the XML plugin documentation</p>

            <blockquote>
              ${xml::Unload}<br />
              Unload plugin
            </blockquote>
          </div>
          <hr />

          <div class="post">
            <p class="post-meta"><span class="post-author text-primary">ChocJunkie</span><br />
            <span class="post-time small text-muted">7th January 2010 16:08 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

            <p class="post-content"></p>

            <blockquote>
              If it unloads the plugin, how can I unload the loaded file?
            </blockquote>
          </div>
          <hr />

          <div class="post">
            <p class="post-meta"><span class="post-author text-primary">pengyou</span><br />
            <span class="post-time small text-muted">7th January 2010 16:20 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

            <p class="post-content">Why do you want to "unload" the file?<br />
            <br />
            If you have used the XML plugin to modify the file then use the plugin's "SaveFile" command.</p>
          </div>
          <hr />

          <div class="post">
            <p class="post-meta"><span class="post-author text-primary">ChocJunkie</span><br />
            <span class="post-time small text-muted">8th January 2010 08:05 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

            <p class="post-content">I just want to read the file, I don't need it to be in memory any more, if I've got what I was looking for. So I would like to erase/unload the file from the memory.</p>
          </div>
          <hr />

          <div class="post">
            <p class="post-meta"><span class="post-author text-primary">xbarns</span><br />
            <span class="post-time small text-muted">25th January 2010 14:23 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

            <p class="post-content">Hi all,<br />
            <br />
            i am trying to use the plugin with the Unicode Version of NSIS but it won't even open the file correctly.<br />
            <br />
            Am i just stupid or does it not work correctly with Unicode NSIS? (2.45)<br />
            <br />
            I use the following script to test....<br />
            <br /></p>
            <pre>
<code><br />Name TestSetupSmall<br />                <br />OutFile TestSetupSmall.exe<br />;Request application privileges for Windows Vista<br />RequestExecutionLevel highest    <br /> <br />!include "XML.nsh"<br /><br />ShowInstDetails Show<br /><br />Page Instfiles<br /><br />Function .onInit<br />    InitPluginsDir<br />FunctionEnd<br /><br /><br />Section TEST<br /><br />        SetOutPath $TEMP<br />        File test.xml<br />        <br />        ${xml::LoadFile} "$TEMP\test.xml" $0 <br />        <br />        DetailPrint "-$0-"<br />        <br />        <br />SectionEnd<br /></code>
</pre><br />
            <br />
            The provided example does not work either.<br />
            <br />
            Any help would be much appreciated.<br />
            <br />
            Thanks.
          </div>
          <hr />

          <div class="post">
            <p class="post-meta"><span class="post-author text-primary">garygumdrops</span><br />
            <span class="post-time small text-muted">17th February 2010 00:25 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

            <p class="post-content"><strong>Problem if element has missing text when save</strong><br />
            I think there is a bug with elements with blank text when the XML doc is saved:<br />
            <br />
            &lt;?xml version="1.0" encoding="utf-8" ?&gt;<br />
            &lt;Settings&gt;<br />
            &lt;Setting1&gt;hello&lt;/Setting1&gt;<br />
            &lt;Setting2&gt;&lt;/Setting2&gt;<br />
            &lt;/Settings&gt;<br />
            <br />
            if you save this using ${xml::save}<br />
            you'll see that the last element is not what it should be and appear as:<br />
            &lt;Setting2 /&gt;<br />
            when it should be:<br />
            &lt;Setting2&gt;&lt;/Setting2&gt;<br />
            <br />
            Everything is good if the element has any text inside it.</p>
          </div>
          <hr />

          <div class="post">
            <p class="post-meta"><span class="post-author text-primary">pengyou</span><br />
            <span class="post-time small text-muted">17th February 2010 00:48 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

            <p class="post-content">To an XML parser, the elements &lt;sample/&gt; and &lt;sample&gt;&lt;/sample&gt; are the sameâ€”they're both empty sample elements.<br />
            <br />
            See Extensible Markup Language (XML) 1.0 (Fifth Edition):<br />
            <a href="http://www.w3.org/TR/REC-xml/#dt-empty" target="_blank">http://www.w3.org/TR/REC-xml/#dt-empty</a></p>
          </div>
          <hr />

          <div class="post">
            <p class="post-meta"><span class="post-author text-primary">garygumdrops</span><br />
            <span class="post-time small text-muted">17th February 2010 00:52 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

            <p class="post-content">Oh yes I see now, thanks for pointing that out :-)</p>
          </div>
          <hr />

          <div class="post">
            <p class="post-meta"><span class="post-author text-primary">gringoloco023</span><br />
            <span class="post-time small text-muted">14th July 2010 08:57 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

            <p class="post-content">FYI:<br />
            <br />
            xml::_Coordinate isn't pushing an error/success value<br />
            So the macro, ${xml::Coordinate}, pops one to many !<br />
            <br />
            BTW: great plug-in, anything else seems to work fine, and MSXML.dll independent :-)</p>
          </div>
          <hr />

          <div class="post">
            <p class="post-meta"><span class="post-author text-primary">guineapig</span><br />
            <span class="post-time small text-muted">19th August 2010 14:24 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

            <p class="post-content">Hi all,<br />
            I'm trying to use the xml plugin with nsis unicode v2.46 but it does not work.<br />
            The plugin does not load the xml file and return error code is an unknown char (the classic square char). Before spending too much time on it, I would like to know if there are some known compatibility issue.<br />
            <br />
            thank you very much</p>
          </div>
          <hr />

          <div class="post">
            <p class="post-meta"><span class="post-author text-primary">gringoloco023</span><br />
            <span class="post-time small text-muted">19th August 2010 17:35 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

            <p class="post-content">try the NsisXML plug-in by Wizou, although it works great and also works with utf-16 xml files, it is msxml.dll depended !<br />
            <br />
            Another possibility which I personally am very happy with is calling the Xml plug-in from instructor with a special header file for unicode nsis. but utf-16 files are not supported (alternatively they could be re-encoded to utf-8 and back again)</p>
          </div>
          <hr />

          <div class="post">
            <p class="post-meta"><span class="post-author text-primary">guineapig</span><br />
            <span class="post-time small text-muted">23rd August 2010 15:59 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

            <p class="post-content">it works...<br />
            thank you very much...</p>
          </div>
          <hr />

          <div class="post">
            <p class="post-meta"><span class="post-author text-primary">ssamuels_sv</span><br />
            <span class="post-time small text-muted">11th February 2011 21:50 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

            <p class="post-content"><strong>Remote XML File</strong><br />
            I'm curious if anyone knows how to link this plug-in with a file that is hosted on a server. I know that the plug-in can read a file locally, but it would be helpful in my application to read the file remotely rather than have to distribute the file along with the installer. I want to use a generic installer and have it go grab the information that it needs.<br />
            <br />
            Or does anyone know of another plug-in that will simply grab a remote file so that this plug-in can parse the XML tree?<br />
            <br />
            Thanks in advance.</p>
          </div>
          <hr />

          <div class="post">
            <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
            <span class="post-time small text-muted">11th February 2011 22:24 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

            <p class="post-content">NSISdl or InetC<br />
            <br />
            Stu</p>
          </div>
          <hr />

          <div class="post">
            <p class="post-meta"><span class="post-author text-primary">ssamuels_sv</span><br />
            <span class="post-time small text-muted">11th February 2011 23:09 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

            <p class="post-content">Thank you. I just figured that out and was going to say, never mind. Thanks for the quick reply. I tried inetc, but I'll take a look at NSISdl as well.</p>
          </div>
          <hr />

          <div class="post">
            <p class="post-meta"><span class="post-author text-primary">loyalp</span><br />
            <span class="post-time small text-muted">11th May 2011 18:49 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

            <p class="post-content"><strong>comments</strong><br />
            I've just started using this plugin, and so far have it doing everything I need for inserting some new lines in a web.config file. I do not see to be able to figure out how to get a new comment inserted, however.<br />
            <br />
            xml file is setup like:<br />
            <br />
            &lt;?xml version="1.0" ?&gt;<br />
            &lt;configuration&gt;<br />
            &lt;appSettings&gt;<br />
            &lt;add key="LogLevel" value="4" /&gt;<br />
            &lt;/appSettings&gt;<br />
            &lt;/configuration&gt;<br />
            <br />
            I'm adding several new &lt;add key= statements, but would also like to insert a comment at the same level.<br />
            <br />
            Final product would be:<br />
            <br />
            &lt;?xml version="1.0" ?&gt;<br />
            &lt;configuration&gt;<br />
            &lt;appSettings&gt;<br />
            &lt;!--Some Comment--&gt;<br />
            &lt;add key="LogLevel" value="4" /&gt;<br />
            &lt;add key="something" value="" /&gt;<br />
            &lt;add key="something" value="" /&gt;<br />
            &lt;add key="something" value="" /&gt;<br />
            &lt;add key="something" value="" /&gt;<br />
            &lt;/appSettings&gt;<br />
            &lt;/configuration&gt;<br />
            <br />
            I've tried:<br />
            <br /></p>
            <pre>
<code><br />                ${xml::LoadFile} "$INSTDIR\Web.config" $0<br />                ${xml::RootElement} $0 $1<br />                ${xml::XPathNode} "/configuration/appSettings" $0<br />                ${xml::CreateNode} "&lt;'!-- Some Comment--'/&gt;" $4<br />                ${xml::InsertEndChild} $4 $5<br /><br /></code>
</pre><br />
            <br />
            and also ${xml::CreateNode} "&lt;'!-- Some Comment--'/&gt;" $4.<br />
            <br />
            What am I missing here?
          </div>
          <hr />

          <div class="post">
            <p class="post-meta"><span class="post-author text-primary">fefer</span><br />
            <span class="post-time small text-muted">5th December 2011 09:25 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

            <p class="post-content">I create Installer that load xml file and read the node value<br />
            <br />
            I stop the installer running, I change the xml file node value and I run the Installer again<br />
            <br />
            at the second time the installer shows me that the value didn't change, and when I run oit again it's show me the value changed<br />
            <br />
            Way the istaller show me the prev value?</p>
          </div>
          <hr />

          <div class="post">
            <p class="post-meta"><span class="post-author text-primary">T.Slappy</span><br />
            <span class="post-time small text-muted">5th December 2011 10:40 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

            <p class="post-content">The XML file is packed inside installer or not?<br />
            Maybe other process/application is working with this file too?</p>
          </div>
          <hr />

          <div class="post">
            <p class="post-meta"><span class="post-author text-primary">gretty</span><br />
            <span class="post-time small text-muted">13th August 2012 03:52 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

            <p class="post-content">I am attempting to add a large XML element to an existing XML file but it keeps failing to add the new node. What do you think is going wrong?<br />
            <br />
            I've tried making the XML element smaller(reducing OVERRIDES_TEXT) and that allows me to successfully add the new element/node to the XML file. But I need all the text(xml) in OVERRIDES_TEXT to be added to the element(I cant remove any of it).<br />
            <br />
            Any ideas on how I could achieve this?<br />
            <br /></p>
            <pre>
<code><br />${xml::LoadFile} "${xmlFileName}" $R0<br />${xml::GotoPath} "${elementPath}" $R0<br />${xml::CreateNode} '&lt;Overrides&gt;${OVERRIDES_TEXT}&lt;/Overrides&gt;' $R0<br />${xml::InsertAfterNode} $R0 $R1  # always fails here $R1 = -1<br /><br /># below is the string that causes the error<br />!define OVERRIDES_TEXT "&lt;Override&gt;\<br />                &lt;Key&gt;EXDS_CUSTOMISATION_REVISION&lt;/Key&gt;\<br />                &lt;Value&gt;1&lt;/Value&gt;\<br />                &lt;State&gt;0&lt;/State&gt;\<br />            &lt;/Override&gt;\<br />            &lt;Override&gt;\<br />                &lt;Key&gt;CUSTOMER_USER_4D&lt;/Key&gt;\<br />                &lt;Value&gt;C:\12d\10.00\Customers\EXDS_Customisation\EXDS_User&lt;/Value&gt;\<br />                &lt;State&gt;0&lt;/State&gt;\<br />            &lt;/Override&gt;\<br />            &lt;Override&gt;\<br />                &lt;Key&gt;CUSTOMER_LIB_4D&lt;/Key&gt;\<br />                &lt;Value&gt;C:\12d\10.00\Customers\EXDS_Customisation\EXDS_User_Lib&lt;/Value&gt;\<br />                &lt;State&gt;0&lt;/State&gt;\<br />            &lt;/Override&gt;\<br />            &lt;Override&gt;\<br />                &lt;Key&gt;USER_4D&lt;/Key&gt;\<br />                &lt;Value&gt;C:\12d\10.00\User&lt;/Value&gt;\<br />                &lt;State&gt;0&lt;/State&gt;\<br />            &lt;/Override&gt;\<br />            &lt;Override&gt;\<br />                &lt;Key&gt;USER_LIB_4D&lt;/Key&gt;\<br />                &lt;Value&gt;C:\12d\10.00\User_Lib&lt;/Value&gt;\<br />                &lt;State&gt;0&lt;/State&gt;\<br />            &lt;/Override&gt;\<br />            &lt;Override&gt;\<br />                &lt;Key&gt;EXDS_USER_LIB&lt;/Key&gt;\<br />                &lt;Value&gt;&lt;/Value&gt;\<br />                &lt;State&gt;0&lt;/State&gt;\<br />            &lt;/Override&gt;\<br />            &lt;Override&gt;\<br />                &lt;Key&gt;EXDS_USER&lt;/Key&gt;\<br />                &lt;Value&gt;&lt;/Value&gt;\<br />                &lt;State&gt;0&lt;/State&gt;\<br />            &lt;/Override&gt;\<br />            &lt;Override&gt;\<br />                &lt;Key&gt;VERSION_12D_MODEL&lt;/Key&gt;\<br />                &lt;Value&gt;10.0&lt;/Value&gt;\<br />                &lt;State&gt;0&lt;/State&gt;\<br />            &lt;/Override&gt;\<br />            &lt;Override&gt;\<br />                &lt;Key&gt;CPATH&lt;/Key&gt;\<br />                &lt;Value&gt;$$CUSTOMER_LIB_4D:$$CUSTOMER_USER_4D:$$USER_LIB_4D:$$USER_4D:$$LIB_4D:$$SET_UPS_4D&lt;/Value&gt;\<br />                &lt;State&gt;0&lt;/State&gt;\<br />            &lt;/Override&gt;\<br />            &lt;Override&gt;\<br />                &lt;Key&gt;AUTHORIZATION_4D&lt;/Key&gt;\<br />                &lt;Value&gt;C:\12d\10.00\nodes.4d&lt;/Value&gt;\<br />                &lt;State&gt;0&lt;/State&gt;\<br />            &lt;/Override&gt;\<br />            &lt;Override&gt;\<br />                &lt;Key&gt;USE_NAMES_COMMENT_4D&lt;/Key&gt;\<br />                &lt;Value&gt;1&lt;/Value&gt;\<br />                &lt;State&gt;0&lt;/State&gt;\<br />            &lt;/Override&gt;\<br />            &lt;Override&gt;\<br />                &lt;Key&gt;FILE_READ_ADD_TO_VIEW_4D&lt;/Key&gt;\<br />                &lt;Value&gt;1&lt;/Value&gt;\<br />                &lt;State&gt;0&lt;/State&gt;\<br />            &lt;/Override&gt;\<br />            &lt;Override&gt;\<br />                &lt;Key&gt;GENIO_WILDCARD_4D&lt;/Key&gt;\<br />                &lt;Value&gt;*.inp&lt;/Value&gt;\<br />                &lt;State&gt;1&lt;/State&gt;\<br />            &lt;/Override&gt;\<br />            &lt;Override&gt;\<br />                &lt;Key&gt;RUN_MACROS_FILE_4D&lt;/Key&gt;\<br />                &lt;Value&gt;$$USER\macros.4d&lt;/Value&gt;\<br />                &lt;State&gt;0&lt;/State&gt;\<br />            &lt;/Override&gt;\<br />            &lt;Override&gt;\<br />                &lt;Key&gt;PROJECT_DETAILS_4D&lt;/Key&gt;\<br />                &lt;Value&gt;$$USER\project_details.dtl&lt;/Value&gt;\<br />                &lt;State&gt;0&lt;/State&gt;\<br />            &lt;/Override&gt;\<br />            &lt;Override&gt;\<br />                &lt;Key&gt;REPORT_HEADER_4D&lt;/Key&gt;\<br />                &lt;Value&gt;1&lt;/Value&gt;\<br />                &lt;State&gt;0&lt;/State&gt;\<br />            &lt;/Override&gt;\<br />            &lt;Override&gt;\<br />                &lt;Key&gt;AUTO_TIN_SYNC_4D&lt;/Key&gt;\<br />                &lt;Value&gt;1&lt;/Value&gt;\<br />                &lt;State&gt;0&lt;/State&gt;\<br />            &lt;/Override&gt;\<br />            &lt;Override&gt;\<br />                &lt;Key&gt;AUTO_MODEL_SYNC_4D&lt;/Key&gt;\<br />                &lt;Value&gt;1&lt;/Value&gt;\<br />                &lt;State&gt;0&lt;/State&gt;\<br />            &lt;/Override&gt;\<br />            &lt;Override&gt;\<br />                &lt;Key&gt;SHARE_CHECK_INTERVAL_4D&lt;/Key&gt;\<br />                &lt;Value&gt;300&lt;/Value&gt;\<br />                &lt;State&gt;0&lt;/State&gt;\<br />            &lt;/Override&gt;\<br />            &lt;Override&gt;\<br />                &lt;Key&gt;SHARED_ELEMENT_COLOUR_4D&lt;/Key&gt;\<br />                &lt;Value&gt;blue&lt;/Value&gt;\<br />                &lt;State&gt;0&lt;/State&gt;\<br />            &lt;/Override&gt;\<br />            &lt;Override&gt;\<br />                &lt;Key&gt;SHARING_ELEMENT_COLOUR_4D&lt;/Key&gt;\<br />                &lt;Value&gt;red&lt;/Value&gt;\<br />                &lt;State&gt;0&lt;/State&gt;\<br />            &lt;/Override&gt;\<br />            &lt;Override&gt;\<br />                &lt;Key&gt;DEFAULT_PLAN_PLOT_SCALE_4D&lt;/Key&gt;\<br />                &lt;Value&gt;500&lt;/Value&gt;\<br />                &lt;State&gt;0&lt;/State&gt;\<br />            &lt;/Override&gt;\<br />            &lt;Override&gt;\<br />                &lt;Key&gt;DWG_PLOT_SEED_FILE_4D&lt;/Key&gt;\<br />                &lt;Value&gt;$$USER\EXDS_Acad_Plot_Template.dwt&lt;/Value&gt;\<br />                &lt;State&gt;0&lt;/State&gt;\<br />            &lt;/Override&gt;\<br />            &lt;Override&gt;\<br />                &lt;Key&gt;DEFAULT_RASTER_DPI_4D&lt;/Key&gt;\<br />                &lt;Value&gt;600&lt;/Value&gt;\<br />                &lt;State&gt;0&lt;/State&gt;\<br />            &lt;/Override&gt;\<br />            &lt;Override&gt;\<br />                &lt;Key&gt;OPENGL_VIEW_BACKING_STORE_4D&lt;/Key&gt;\<br />                &lt;Value&gt;2&lt;/Value&gt;\<br />                &lt;State&gt;0&lt;/State&gt;\<br />            &lt;/Override&gt;\<br />            &lt;Override&gt;\<br />                &lt;Key&gt;MULTI_LINE_TEXT_4D&lt;/Key&gt;\<br />                &lt;Value&gt;1&lt;/Value&gt;\<br />                &lt;State&gt;0&lt;/State&gt;\<br />            &lt;/Override&gt;\<br />            &lt;Override&gt;\<br />                &lt;Key&gt;NEW_MTF_EDITOR_AUTOPAN_DEFAULT_4D&lt;/Key&gt;\<br />                &lt;Value&gt;1&lt;/Value&gt;\<br />                &lt;State&gt;0&lt;/State&gt;\<br />            &lt;/Override&gt;\<br />            &lt;Override&gt;\<br />                &lt;Key&gt;WINDOWS_VEHICLE_PATH_4D&lt;/Key&gt;\<br />                &lt;Value&gt;C:\Apps\VPath&lt;/Value&gt;\<br />                &lt;State&gt;0&lt;/State&gt;\<br />            &lt;/Override&gt;\<br />            &lt;Override&gt;\<br />                &lt;Key&gt;chainage_equality_4d&lt;/Key&gt;\<br />                &lt;Value&gt;1&lt;/Value&gt;\<br />                &lt;State&gt;0&lt;/State&gt;\<br />            &lt;/Override&gt;\<br />            &lt;Override&gt;\<br />                &lt;Key&gt;XML_4D&lt;/Key&gt;\<br />                &lt;Value&gt;1&lt;/Value&gt;\<br />                &lt;State&gt;0&lt;/State&gt;\<br />            &lt;/Override&gt;\<br />            &lt;Override&gt;\<br />                &lt;Key&gt;USE_V10_BOXING_CALCS_4D&lt;/Key&gt;\<br />                &lt;Value&gt;1&lt;/Value&gt;\<br />                &lt;State&gt;0&lt;/State&gt;\<br />            &lt;/Override&gt;"<br /></code>
</pre>
          </div>
          <hr />

          <div class="post">
            <p class="post-meta"><span class="post-author text-primary">MSG</span><br />
            <span class="post-time small text-muted">13th August 2012 06:31 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

            <p class="post-content">Please don't paste such huge amounts of text in a post - use either an attachment or pastebin.<br />
            <br />
            Your problem is probably that the string you're trying to write is much bigger than ${NSIS_MAX_STRLEN}. The default NSIS builds have a max length of 1024 bytes. There is also a large string build of NSIS which supports op to 8192 bytes. But I don't think you're using the xml plugin properly. I've never used it myself, but what you're doing is telling it to write a single, huge textline "&lt;Override&gt;&lt;Key&gt;EXDS_CUSTOMISATION_REVISION&lt;/Key&gt;&lt;Value&gt;1&lt;/Value&gt;&lt;State&gt;0&lt;/State&gt;&lt;/Override&gt;&lt;Override&gt;&lt;Key&gt;CUSTOMER_USER_4D&lt;/Key&gt;&lt;Value&gt;C:\12d\10.00\Customers\EXDS_Customisation\EXDS_User&lt;/Value&gt;" etcetc. You could use FileWrite for that, so I doubt that's how the XML plugin is supposed to be used.</p>
          </div>
          <hr />

          <div class="post">
            <p class="post-meta"><span class="post-author text-primary">dacode</span><br />
            <span class="post-time small text-muted">17th August 2012 18:09 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

            <p class="post-content">@Instructor -<br />
            <br />
            I would like to use this XML plugin as well as the Registry plugin by instructor, however, I do not see any license.<br />
            <br />
            Are all NSIS plugins licensed under the NSIS license?</p>
          </div>
          <hr />

          <div class="post">
            <p class="post-meta"><span class="post-author text-primary">PoRtAbLe_StEaLtH</span><br />
            <span class="post-time small text-muted">6th January 2013 06:29 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

            <p class="post-content"><strong>Great Help</strong><br />
            Quote:</p>
            <hr />
            <br />
            <br />
            thanks.. this helped me tremendously..<br />
            <pre>
<span style="color: #007700">&lt;</span><span style="color: #0000BB">Configuration
<br /></span><span style="color: #007700">&lt;</span><span style="color: #0000BB">ConfigModulename</span><span style="color: #007700">=</span><span style="color: #DD0000">"BlaBla"</span><span style="color: #007700">&gt;
<br />&lt;/</span><span style="color: #0000BB">ConfigModule</span><span style="color: #007700">&gt;
<br />&lt;</span><span style="color: #0000BB">ConfigModulename</span><span style="color: #007700">=</span><span style="color: #DD0000">"FirebirdBridge"</span><span style="color: #0000BB">DefaultConfig</span><span style="color: #007700">=</span><span style="color: #DD0000">"FALSE"</span><span style="color: #007700">&gt;
<br />&lt;</span><span style="color: #0000BB">Sectionname</span><span style="color: #007700">=</span><span style="color: #DD0000">"FirebirdBridge"</span><span style="color: #0000BB">description</span><span style="color: #007700">=</span><span style="color: #DD0000">"ConfigurationforFirebirdDBBridge"</span><span style="color: #007700">&gt;
<br />&lt;</span><span style="color: #0000BB">Dataname</span><span style="color: #007700">=</span><span style="color: #DD0000">"Host"</span><span style="color: #0000BB">type</span><span style="color: #007700">=</span><span style="color: #DD0000">"string"</span><span style="color: #007700">&gt;</span><span style="color: #0000BB">127.0.0.1</span><span style="color: #007700">&lt;/</span><span style="color: #0000BB">Data</span><span style="color: #007700">&gt;
<br />&lt;</span><span style="color: #0000BB">Dataname</span><span style="color: #007700">=</span><span style="color: #DD0000">"Database"</span><span style="color: #0000BB">type</span><span style="color: #007700">=</span><span style="color: #DD0000">"string"</span><span style="color: #007700">&gt;</span><span style="color: #0000BB">C</span><span style="color: #007700">:</span><span style="color: #0000BB">ProgramFilesTestDatabaseTest</span><span style="color: #007700">.</span><span style="color: #0000BB">FDB</span><span style="color: #007700">&lt;/</span><span style="color: #0000BB">Data</span><span style="color: #007700">&gt;
<br />&lt;</span><span style="color: #0000BB">Dataname</span><span style="color: #007700">=</span><span style="color: #DD0000">"User"</span><span style="color: #0000BB">type</span><span style="color: #007700">=</span><span style="color: #DD0000">"string"</span><span style="color: #007700">&gt;</span><span style="color: #0000BB">User</span><span style="color: #007700">&lt;/</span><span style="color: #0000BB">Data</span><span style="color: #007700">&gt;
<br />&lt;</span><span style="color: #0000BB">Dataname</span><span style="color: #007700">=</span><span style="color: #DD0000">"Password"</span><span style="color: #0000BB">type</span><span style="color: #007700">=</span><span style="color: #DD0000">"string"</span><span style="color: #007700">&gt;</span><span style="color: #0000BB">Password</span><span style="color: #007700">&lt;/</span><span style="color: #0000BB">Data</span><span style="color: #007700">&gt;
<br />&lt;/</span><span style="color: #0000BB">Section</span><span style="color: #007700">&gt;
<br />&lt;/</span><span style="color: #0000BB">ConfigModule</span><span style="color: #007700">&gt;
<br />&lt;/</span><span style="color: #0000BB">Configuration</span><span style="color: #007700">&gt;
</span>
</pre><b>Correct XPath</b>:<br />
            <pre>
<code>/Configuration/ConfigModule/Section/Data[@name="Host"]</code>
</pre><br />
            <br />
            <b>I was using</b>: (Wrong)<br />
            <pre>
<code>/Configuration/ConfigModule[@name="FirebirdBridge"]/Section[@name="FirebirdBridge"]/Data[@name="Host"]</code>
</pre>

            <table cellpadding="6" cellspacing="0" border="0" width="100%">
              <tr>
                <td class="alt2">
                  <hr />
                  Originally Posted by <strong>xbarns</strong> (Post 2325026) Hi all,<br />
                  <br />
                  i need to edit a xml structure like this<br />
                  <br />
                  <pre>
<span style="color: #007700">&lt;</span><span style="color: #0000BB">Configuration
<br /></span><span style="color: #007700">&lt;</span><span style="color: #0000BB">ConfigModulename</span><span style="color: #007700">=</span><span style="color: #DD0000">"BlaBla"</span><span style="color: #007700">&gt;
<br />&lt;/</span><span style="color: #0000BB">ConfigModule</span><span style="color: #007700">&gt;
<br />&lt;</span><span style="color: #0000BB">ConfigModulename</span><span style="color: #007700">=</span><span style="color: #DD0000">"FirebirdBridge"</span><span style="color: #0000BB">DefaultConfig</span><span style="color: #007700">=</span><span style="color: #DD0000">"FALSE"</span><span style="color: #007700">&gt;
<br />&lt;</span><span style="color: #0000BB">Sectionname</span><span style="color: #007700">=</span><span style="color: #DD0000">"FirebirdBridge"</span><span style="color: #0000BB">description</span><span style="color: #007700">=</span><span style="color: #DD0000">"ConfigurationforFirebirdDBBridge"</span><span style="color: #007700">&gt;
<br />&lt;</span><span style="color: #0000BB">Dataname</span><span style="color: #007700">=</span><span style="color: #DD0000">"Host"</span><span style="color: #0000BB">type</span><span style="color: #007700">=</span><span style="color: #DD0000">"string"</span><span style="color: #007700">&gt;</span><span style="color: #0000BB">127.0.0.1</span><span style="color: #007700">&lt;/</span><span style="color: #0000BB">Data</span><span style="color: #007700">&gt;
<br />&lt;</span><span style="color: #0000BB">Dataname</span><span style="color: #007700">=</span><span style="color: #DD0000">"Database"</span><span style="color: #0000BB">type</span><span style="color: #007700">=</span><span style="color: #DD0000">"string"</span><span style="color: #007700">&gt;</span><span style="color: #0000BB">C</span><span style="color: #007700">:</span><span style="color: #0000BB">ProgramFilesTestDatabaseTest</span><span style="color: #007700">.</span><span style="color: #0000BB">FDB</span><span style="color: #007700">&lt;/</span><span style="color: #0000BB">Data</span><span style="color: #007700">&gt;
<br />&lt;</span><span style="color: #0000BB">Dataname</span><span style="color: #007700">=</span><span style="color: #DD0000">"User"</span><span style="color: #0000BB">type</span><span style="color: #007700">=</span><span style="color: #DD0000">"string"</span><span style="color: #007700">&gt;</span><span style="color: #0000BB">User</span><span style="color: #007700">&lt;/</span><span style="color: #0000BB">Data</span><span style="color: #007700">&gt;
<br />&lt;</span><span style="color: #0000BB">Dataname</span><span style="color: #007700">=</span><span style="color: #DD0000">"Password"</span><span style="color: #0000BB">type</span><span style="color: #007700">=</span><span style="color: #DD0000">"string"</span><span style="color: #007700">&gt;</span><span style="color: #0000BB">Password</span><span style="color: #007700">&lt;/</span><span style="color: #0000BB">Data</span><span style="color: #007700">&gt;
<br />&lt;/</span><span style="color: #0000BB">Section</span><span style="color: #007700">&gt;
<br />&lt;/</span><span style="color: #0000BB">ConfigModule</span><span style="color: #007700">&gt;
<br />&lt;/</span><span style="color: #0000BB">Configuration</span><span style="color: #007700">&gt;
</span>
</pre>In order to change the "&lt;Data name="Database" type="string"&gt;C:\Program Files\Test\Database\Test.FDB&lt;/Data&gt;" is there any other way then looping through the nodes and comparing attributes ?<br />
                  <br />
                  i am already looping through the "ConfigModule" Nodes and comparing, is there an easier way?<br />
                  <br />
                  Here is the code i have so far:<br />
                  <br />
                  <pre>
<span style="color: #007700">${</span><span style="color: #0000BB">xml</span><span style="color: #007700">::</span><span style="color: #0000BB">LoadFile</span><span style="color: #007700">}</span><span style="color: #DD0000">"$EXEDIR\scMaster.ctf"</span><span style="color: #007700">$</span><span style="color: #0000BB">0
<br />loop</span><span style="color: #007700">:
<br />${</span><span style="color: #0000BB">xml</span><span style="color: #007700">::</span><span style="color: #0000BB">FindNextElement</span><span style="color: #007700">}</span><span style="color: #DD0000">"ConfigModule"</span><span style="color: #007700">$</span><span style="color: #0000BB">0</span><span style="color: #007700">$</span><span style="color: #0000BB">1
<br /></span><span style="color: #007700">${</span><span style="color: #0000BB">xml</span><span style="color: #007700">::</span><span style="color: #0000BB">ElementPath</span><span style="color: #007700">}$</span><span style="color: #0000BB">0
<br /></span><span style="color: #007700">${</span><span style="color: #0000BB">xml</span><span style="color: #007700">::</span><span style="color: #0000BB">GetAttribute</span><span style="color: #007700">}</span><span style="color: #DD0000">"name"</span><span style="color: #007700">$</span><span style="color: #0000BB">1</span><span style="color: #007700">$</span><span style="color: #0000BB">2
<br /><br /></span><span style="color: #007700">${IF}$</span><span style="color: #0000BB">1</span><span style="color: #007700">==</span><span style="color: #DD0000">"FirebirdBridge"
<br /><br /></span><span style="color: #007700">${</span><span style="color: #0000BB">xml</span><span style="color: #007700">::</span><span style="color: #0000BB">GotoPath</span><span style="color: #007700">}</span><span style="color: #DD0000">"$0/Section/Data"</span><span style="color: #007700">$</span><span style="color: #0000BB">1
<br /><br />Loophereagain</span><span style="color: #007700">?
<br /><br /><br />${ELSE}
<br /></span><span style="color: #0000BB">Gotoloop
<br /></span><span style="color: #007700">${ENDIF}
<br /><br />${</span><span style="color: #0000BB">xml</span><span style="color: #007700">::</span><span style="color: #0000BB">FindCloseElement</span><span style="color: #007700">}
<br />${</span><span style="color: #0000BB">xml</span><span style="color: #007700">::</span><span style="color: #0000BB">SaveFile</span><span style="color: #007700">}</span><span style="color: #DD0000">"$EXEDIR\scMaster2.ctf"</span><span style="color: #007700">$</span><span style="color: #0000BB">0
<br /></span><span style="color: #007700">${</span><span style="color: #0000BB">xml</span><span style="color: #007700">::</span><span style="color: #0000BB">Unload</span><span style="color: #007700">}
</span>
</pre><br />
                  Thanks for helping :)
                  <hr />
                </td>
              </tr>
            </table><br />

            <div class="post">
              <p class="post-meta"><span class="post-author text-primary">xbarns</span><br />
              <span class="post-time small text-muted">8th July 2013 12:01 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

              <p class="post-content"><strong>Accidental Replace of " (double quote)</strong><br />
              Hi All,<br />
              <br />
              i use the plugin to replace certain values in an unattend.xml (used for Windows NT6 deployment, e.g. License Key, Company name aso.).<br />
              <br />
              But when i do this it will change a line<br />
              <br />
              &lt;CommandLine&gt;%systemdrive%\ASetup\LockScr.exe "%systemdrive%\ASetup\asetup.bmp"&lt;/CommandLine&gt;<br />
              <br />
              to<br />
              <br />
              &lt;CommandLine&gt;%systemdrive%\ASetup\LockScr.exe &amp;quot;%systemdrive%\ASetup\asetup.bmp&amp;quot;&lt;/CommandLine&gt;<br />
              <br />
              is there any way to preven the change from " to &amp;quot; ?<br />
              <br />
              It seems to happen as a "by product" since i do not edit anything near the occurence of the &lt;CommandLine&gt; tags.<br />
              <br />
              Thanks a lot, any help is appreciated....<br />
              x</p>
            </div>
            <hr />

            <div class="footer">
              <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
            </div>
          </div><script src="../js/highlight.pack.js" type="text/javascript">
</script> <script type="text/javascript">
//<![CDATA[
          hljs.initHighlightingOnLoad();
          //]]>
          </script>
        </div>

        <table cellpadding="6" cellspacing="0" border="0" width="100%">
          <tr>
            <td class="alt2">
              <hr />
              Added: ${xml::XPathString} -compute a string XPath expression.<br />
              Added: ${xml::XPathNode} -compute a node XPath expression and goes to it.<br />
              Added: ${xml::XPathAttribute} -compute an attribute XPath expression and goes to it. I think that Instructor could get rid of most of them by improving the examples from its documentation:<br />
              In particular :<br />
              - Use of ${xml::RootElement} $0 $1 seems to fix many issues; please comment its use in XML::XPathNode, XML::XPathAttribute and XML::XPathString functions documentation whenever needed.<br />
              - Use of ${xml::XPathNode} "/configuration/components/component[@id='applicationSettings.default']/parameters/dbServerName" $0 is badly documented, i.e.:<br />
              . - XPath expression (e.g. "/a/b/@attr") is documented only for ${xml::XPathAttribute}, not for ${xml::XPathNode} whereas it seems to be afix for many cases.<br />
              . - Why is it that one shall use ${xml::XPathnode} prior to use a ${xml::SetAttribute} while logic would say to better use ${xml::XPathAttribute} instead. Instructor provides this kind of fixing but never fully explains why it is this way. Either fix ${xml::XPathAttribute} so that it allows to do what users think it should do, either fix the documentation so that its use is clearer compared to ${xml::XPathNode}.<br />
              <br />
              Thank you very much for your plugin.
            </td><!-- Bootstrap core CSS -->
            <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
            <!--[if lt IE 9]>
                <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
                <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->
          </tr>
        </table>
      </div>
    </div>
  </div>
</body>
</html>
