<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="update a system DLL that is in use." />

  <title>update a system DLL that is in use. - NSIS Forums</title><!-- Bootstrap core CSS -->
  <link rel="stylesheet" type="text/css" href="//netdna.bootstrapcdn.com/bootswatch/3.0.1/readable/bootstrap.min.css" />
  <link rel="stylesheet" href="../css/style.css" type="text/css" /><!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!--[if lt IE 9]>
                <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
                <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->
</head>

<body>
  <div class="container">
    <!-- Put navigation bar here -->

    <ol class="breadcrumb">
      <li><a href="../index.html" class="glyphicon glyphicon-home"></a></li>

      <li><a href="f-65.html">NSIS Discussion</a></li>

      <li class="active">update a system DLL that is in use.</li>
    </ol>

    <p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=92310">update a system DLL that is in use.</a></p><br />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kervin</span><br />
      <span class="post-time small text-muted">25th June 2002 15:58 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>update a system DLL that is in use.</strong><br />
      I know this has been discussed a lot, and I did go through the replies I could find but done of them seem to work.<br />
      <br />
      I need to update a system DLL that is always locked. I heard there was a way to do this on win2k without rebooting, but even replace with a reboot would be great at this point.<br />
      <br />
      At the core of each example I see on this, the 'file' command is used to copy the DLL. But 'file' does not seem to replace locked files.<br />
      <br />
      How can I mark a DLL to be replaced on reboot? Similar to <a href="http://support.microsoft.com/default.aspx?scid=kb;EN-US;q184408" target="_blank">http://support.microsoft.com/default...;EN-US;q184408</a><br />
      <br />
      PS. GetDLLVersion doesn't work on my custom made DLL. Does anyone know, by chance how the DLL should communicate it's version to this function?<br />
      <br />
      thanks,<br />
      --Kervin</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Sunjammer</span><br />
      <span class="post-time small text-muted">25th June 2002 18:51 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>DllGetVersion spec.</strong><br /></p>

      <blockquote>
        PS. GetDLLVersion doesn't work on my custom made DLL. Does anyone know, by chance how the DLL should communicate it's version to this function?
      </blockquote>See attached file for instructions on the DllGetVersion interface that a dll can implement if you so desire.<br />
      <br />
      [edit: note this is not the only way of exporting version information, you can also include version information in an embedded resource in your dll... the DllGetVersion mechanism is the Microsoft standard way of supplying a version number for their system dlls though]
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Sunjammer</span><br />
      <span class="post-time small text-muted">25th June 2002 18:55 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">For some reason when I edited my post above the attachment vanished, any idea if this is a vBulletin bug?</p>
    </div>
    <hr />

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]>
  </script>
</body>
</html>
