<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="description" content="super noob question about VB runtime libraries"><title>super noob question about VB runtime libraries - NSIS Forums</title><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script><link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css"><link rel="stylesheet" href="../css/style.css" type="text/css"></head><body><div class="container"><ol class="breadcrumb"><li><a href="../index.html" class="glyphicon glyphicon-home"></a></li><li><a href="f-65.html">NSIS Discussion</a></li><li class="active">super noob question about VB runtime libraries</li></ol><p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=267690">super noob question about VB runtime libraries</a></p><br><div class="post"><p class="post-meta"><span class="post-author text-primary">Zerodyme</span><br><span class="post-time small text-muted">13th March 2007 12:20 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>super noob question about VB runtime libraries</strong><br>hi, im new in this of creating installers and have just found NSIS. i have a few questions:<br><br>1) i've read lost of topics about installin VB runtime librearies and have read the manual, but cant find if the function:<br><br>!insertmacro InstallLib REGDLL $ALREADY_INSTALLED REBOOT_NOTPROTECTED "msvbvm60.dll" "$SYSDIR\msvbvm60.dll" "$SYSDIR"<br><br>rewrite the dll if its version is older. how can i prevent a dll file to not being rewritten?<br><br>2)how can i see if the dll has been registered or decremeanted correctly? since i have installed Visual Studio in my PC i dont know if it is going to work in another computer, and i dont want to risk its files<br><br>3)how can i register my application to appear in "Control Panel&gt;Install/Uninstall programs"?<br><br>thanks in advance and sorry if they are answered already and i missed the post.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Davion</span><br><span class="post-time small text-muted">13th March 2007 17:02 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Hi Zerodyme,<br><br>I'm using the example code to install the VB6 Runtime in my installer too and it works fine.<br><br>If there's an error there will be a message in the log screen, so you should show it. If you don't show the log screen be patient and write a log to the hdd ;)<br><br>on 3)<br><br>to have your App in the Software List you have to write RegKeys for it.<br><br>Have a look on "HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Uninstall"<br><br>you'll find there many entries from which you can figure out how to set the entries you need.<br><br>Greetz Dave</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Zerodyme</span><br><span class="post-time small text-muted">14th March 2007 08:54 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Thanks a lot Dave! third point works fine now :) about point 1 and 2 i explain: the example install 7 files<br><br>msvbvm60.dll<br>oleaut32.dll<br>olepro32.dll<br>oleaut32.dll<br>comcat.dll<br>asycfilt.dll<br>stdole2.tlb<br><br>but using the visual studio installer and seeing the SETUP.LST file, it appears much more files. do i have to have to use the "!insertmacro InstallLib" function for all of them or just copy those files with "FILE" function? the files in question are:<br><br>hh.exe<br>itircl.dll<br>itss.dll<br>hhctrl.ocx<br>RDO20ES.DLL<br>RDOCURS.DLL<br>MSRDO20.DLL<br>MSCMCES.DLL<br>MSCOMCTL.OCX<br>CMDLGES.DLL<br>comdlg32.ocx<br>MSCOMES.DLL<br>MSCOMM32.OCX<br>VB5DB.DLL<br>MSREPL35.DLL<br>MSRD2X35.DLL<br>expsrv.dll<br>vbajet32.dll<br>MSJINT35.DLL<br>MSJTER35.DLL<br>MSJET35.DLL<br>dao350.dll<br>STDFTES.DLL<br>msstdfmt.dll</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Davion</span><br><span class="post-time small text-muted">14th March 2007 11:03 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">ok, now I understand what's with this.<br><br>The example in the Docs is for the pure VB6 Runtime, but if you have Components like the MS Common Controls you will need more, thats right.<br><br>Not all of those runtime files have to be registered, so you should try or google first which of them need to.<br><br></p><blockquote>do i have to have to use the "!insertmacro InstallLib" function for all of them or just copy those files with "FILE" function?</blockquote>You may use the FILE function for the Systemfiles that don't need a registration<br>e.g. the hh.exe and in the other Case the InstallLib macro.<br><br>But I would say you should use the InstallLib for all the DLL and OCX files using either the option "DLL" for those not to reg or "REGDLL" for those which need to be registered.<br><br>Of course, the non DLL or OCX Files should be installed with the Files Function always.<br><br>I hope this helps<br><br>greetz Dave<br><br>btw: I hope you excuse my mistakes in the above posts, my english has become a bit rusty ;)</div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Zerodyme</span><br><span class="post-time small text-muted">15th March 2007 08:40 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">no prob about your english, im also a non english speaker and make a lot of mistakes! :D about the files mentioned, i tried to google if the files must be registered or not, im still searching. but also saw the SETUP.LST file of the VB6 installer and in some files it says "DLLSelfRegister" and in others nop. so i suppose those files must use REGDLLL parameter, but i need confirmation. thanks a lot for your patience</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Davion</span><br><span class="post-time small text-muted">15th March 2007 08:54 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">What about writing a batch file which tries to register the files?<br><br>If there is no need to register a DLL or OCX there will be a message that the entry point isn't found.<br><br>Create a new txt-File with<br><br>regsvr32 "itircl.dll"<br>pause<br>regsvr32 "tss.dll"<br>pause<br>.<br>.<br>.<br><br>and so on.<br><br>If they are in the System32 or the WinDir you don't need the full path I think.<br><br>If a file cant be registered there will be an errormessage otherwise there will be a message like "Registering of xyz hast succeeded".</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Zerodyme</span><br><span class="post-time small text-muted">15th March 2007 09:55 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">thanks a lot! i tried what you told me and yes, the ones in the SETUP.LST with "DLLSelfRegister" could be registered using<br><br>regsvr32 "itircl.dll"<br><br>the ones without it couldnt be registered. now i have a tip of which files must be registered and how to test it, thank you Dave!</p></div><hr><div class="footer"><p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p></div></div><script src="../js/highlight.pack.js" type="text/javascript"></script><script type="text/javascript">//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]></script></body></html>