<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="description" content="Closing an Application if running"><title>Closing an Application if running - NSIS Forums</title><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script><link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css"><link rel="stylesheet" href="../css/style.css" type="text/css"><!--[if lt IE 9]><script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script><script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script><![endif]--></head><body><div class="container"><ol class="breadcrumb"><li><a href="../index.html" class="glyphicon glyphicon-home"></a></li><li><a href="f-65.html">NSIS Discussion</a></li><li class="active">Closing an Application if running</li></ol><p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=90573">Closing an Application if running</a></p><br><div class="post"><p class="post-meta"><span class="post-author text-primary">simham_uk</span><br><span class="post-time small text-muted">10th June 2002 14:25 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>Closing an Application if running</strong><br>Can anyone explain how to, if possible, detect if an application is running (I have seen ways of detecting Windows, but what if it has no window - systray icon only), and if so, stop it.<br><br>I'm trying to create an AutoUpdate thingy if possible.<br><br>Thanks!</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Smile2Me</span><br><span class="post-time small text-muted">10th June 2002 14:48 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Hmmm, I seem to repeat myself :( :<br><br>Search the Forum and find for instance:<br><a href="http://forums.winamp.com/showthread.php?s=&amp;threadid=87330" target="_blank">http://forums.winamp.com/showthread....threadid=87330</a><br><br>Please everyone search the Forum before posting. A lot of questions have already been answered! Check <a href="http://forums.winamp.com/showthread.php?s=&amp;threadid=62363" target="_blank">this</a> out!<br><br>-Hendri.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">kichik</span><br><span class="post-time small text-muted">10th June 2002 15:24 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Message to the systray icon goes to a window proc of the window that it belongs to. The window can be hidden but it is there. You need to find the name or the class name of the window that this icon belongs to and then send it WM_CLOSE.<br><br>You can find some usuful info in the post Smile2Me sent you.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">simham_uk</span><br><span class="post-time small text-muted">10th June 2002 20:06 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>Thanks!</strong><br>The Kill WA3 function worked just fine, thanks guys!!</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">kichik</span><br><span class="post-time small text-muted">11th June 2002 08:54 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Which one worked? I hope you didn't use TerminateProcess, it is pretty brutal and unwanted.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">simham_uk</span><br><span class="post-time small text-muted">11th June 2002 09:41 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Hi Amir<br><br>I used the FindWindow and SendMessage to close it and it worked great.<br><br>I have nearly completed an online updater (my first decent project with NSIS).<br><br>It will:<br><br><br>- close the app if still running (actually it will wait for 1 app to stop, then it will close another itself and continue)<br>- Check existing versions and write to CURversions.ini<br>- Download NEWVersions.ini and compare<br>- Download files as needed (zip2exe's with no popups)<br>- Extract to their locations (Reg and UnReg DLL's as required)<br>- Run the app again when done<br><br>etc, etc.<br><br>It still needs improvement I'm sure!<br><br>My only concern is how do I ensure they have an internet connection. Will the downloader invoke the default connection if required? (I'm thinking of Dialup's).<br><br>I read another post on this subject where someone was developing a DLL to do this, and had proxy support as well, but the thread died in July last year....I'll send them a message and see if it got finished. The only thing I didn't like was that it prompted for the Updates to continue and stuff. My solution is to be automated. It would be easy to add an ini entry to set if you want prompted before updating!!<br><br>I have attached my .nsi and the CURVersions.ini for anyone to see and comment on.<br><br>Thanks for all your help Amir, and everyone else!!</p></div><hr><div class="footer"><p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p></div></div><script src="../js/highlight.pack.js" type="text/javascript"></script><script type="text/javascript">//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]></script></body></html>