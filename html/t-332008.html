<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="description" content="A problem when deleting a folder"><title>A problem when deleting a folder - NSIS Forums</title><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script><link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css"><link rel="stylesheet" href="../css/style.css" type="text/css"><!--[if lt IE 9]><script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script><script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script><![endif]--></head><body><div class="container"><ol class="breadcrumb"><li><a href="../index.html" class="glyphicon glyphicon-home"></a></li><li><a href="f-65.html">NSIS Discussion</a></li><li class="active">A problem when deleting a folder</li></ol><p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=332008">A problem when deleting a folder</a></p><br><div class="post"><p class="post-meta"><span class="post-author text-primary">JohnChen</span><br><span class="post-time small text-muted">29th June 2011 16:41 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>A problem when deleting a folder</strong><br>After I call rmdir /r to delete a folder, the folder is not removed. Then if I manaully delete this folder, it is gone. That means the folder is not held by anyone. So why isn't it removed initially?</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">demiller9</span><br><span class="post-time small text-muted">29th June 2011 17:06 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Most often it is because some program (could even be your installer) has their current working directory on that folder. The installer current working directory is changed by using SetOutPath. Try setting the installer cwd to $Temp before doing the RmDir.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">JohnChen</span><br><span class="post-time small text-muted">29th June 2011 18:03 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"></p><blockquote><small>Originally posted by demiller9</small><br>Most often it is because some program (could even be your installer) has their current working directory on that folder. The installer current working directory is changed by using SetOutPath. Try setting the installer cwd to $Temp before doing the RmDir.</blockquote>I will try what you suggested to see if I still have the same issue. Actually the issue that the folder is not removed doesn't happen every time. I am not sure whether it is caused by trying to remove a current working directory. Thanks.</div><hr><div class="footer"><p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p></div></div><script src="../js/highlight.pack.js" type="text/javascript"></script><script type="text/javascript">//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]></script></body></html>