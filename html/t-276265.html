<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="description" content="Network installs"><title>Network installs - NSIS Forums</title><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script><link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css"><link rel="stylesheet" href="../css/style.css" type="text/css"></head><body><div class="container"><ol class="breadcrumb"><li><a href="../index.html" class="glyphicon glyphicon-home"></a></li><li><a href="f-65.html">NSIS Discussion</a></li><li class="active">Network installs</li></ol><p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=276265">Network installs</a></p><br><div class="post"><p class="post-meta"><span class="post-author text-primary">wacaveman</span><br><span class="post-time small text-muted">21st August 2007 21:34 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>Network installs</strong><br>I just completed an installer that pushes stuff across the network. I had to resort to some ugly calls which use psexec and ExecWait. Are there any plans to implement some remote-install routines, or tweak some of NSIS functions such that it is more net-friendly?<br><br>Currently, I had to jump through a ton of hoops to get it to work the way we needed to. There are a lot of areas which would have made things lots cleaner.<br><br>Firstly, finding out how much free space existed on the network drive needed a system call, using DriveSpace returns zero.<br>Ex:<br>System::Call '${sysGetDiskFreeSpaceEx}(r1,.,,.r2)'<br>; convert the large integer byte values into managable kb<br>System::Int64Op $2 / 1024<br>Pop $2<br><br>Secondly, I needed an external call to psexec (see sysinternals.com, which is now a part of microsoft). It basically copies a file to the Admin$ share of the target computer, then executes it on the local machine (and allows you to pass command-line flags, specify working directory, etc.).<br>Ex:<br>ExecWait '"$INSTDIR\psexec.exe" $Machine -w c:\Translator -c TranslatorSetup.exe /S /D=c:\Translator' $0<br><br>Anyway, the second call brings up an ugly DOS box while it executes, and you need to have the separate installer, play hopskotch with the separate install to get it to a temp directory, etc. Plus we have to do a bunch of stuff using net find as external calls to validate names and find computer groups within our domain and such. Something a bit more embedded within the control of the installer would be kind of nice.<br><br>Thanks,<br><br>-Kevin</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">kichik</span><br><span class="post-time small text-muted">21st August 2007 21:49 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">You can use nsExec or DosExec to avoid the DOS box.<br><br>I don't see this as part of NSIS duties. Pushing installers to computers on the network is a job for something that could be better at that instead of an installer that'd drop an installer on another computer and remotely execute it. Something like SMS should be built or used. It can be a complement product for NSIS that might be closely integrated, but doesn't seem fit to be a part of NSIS.<br><br>That said, I'm all for more power. So if small things can be done to make something simpler while still keeping other things simple and small, it can be considered.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">wacaveman</span><br><span class="post-time small text-muted">21st August 2007 22:25 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Capability to push the installer would be awesome, like use a flag and specify the target computer. Setup.exe /T=\\PC104_TEST /D="c:\Program files\foobie" or something like that. It probably wouldn't be that much work in reality.<br><br>I have been doing silent installers for quite some time using NSIS, and there are a ton of ways to make improvements (not that it isn't great). Network install capability and the language are it's greatest shortcomings, when compared to other installers. I just wanted to pitch a few ideas to help keep NSIS in-line with the competition.<br><br>Anyway, for what it's worth. My installers usually have a ton of hacks in them just to make the outcome the way I want it to be. It would be nice if some of these things made it into the language out-of-the-box.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">kichik</span><br><span class="post-time small text-muted">21st August 2007 22:43 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Adding such a parameter to the installer would be replicating psexec, which is not a simple application and doesn't fit, in my opinion, in the installer itself.<br><br>As I said, minor features that might help get this done easier and might help other things as well, we can consider. But something that does exactly this and serves no other purpose has no place in the basics of every installer, in my opinion.</p></div><hr><div class="footer"><p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p></div></div><script src="../js/highlight.pack.js" type="text/javascript"></script><script type="text/javascript">//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]></script></body></html>