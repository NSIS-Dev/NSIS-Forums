<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="SetCurrentDirectory" />

  <title>SetCurrentDirectory - NSIS Forums</title><!-- Bootstrap core CSS -->
  <link rel="stylesheet" type="text/css" href="//netdna.bootstrapcdn.com/bootswatch/3.0.1/readable/bootstrap.min.css" />
  <link rel="stylesheet" href="../css/style.css" type="text/css" /><!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!--[if lt IE 9]>
                <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
                <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->
</head>

<body>
  <div class="container">
    <!-- Put navigation bar here -->

    <ol class="breadcrumb">
      <li><a href="../index.html" class="glyphicon glyphicon-home"></a></li>

      <li><a href="f-65.html">NSIS Discussion</a></li>

      <li class="active">SetCurrentDirectory</li>
    </ol>

    <p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=85334">SetCurrentDirectory</a></p><br />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">tenfour</span><br />
      <span class="post-time small text-muted">20th April 2002 08:02 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>SetCurrentDirectory</strong><br />
      In a nutshell: How do you get NSIS to set the current directory, ala SetCurrentDirectory()?<br />
      <br />
      Here's my issue: I need to UnRegDLL a COM DLL in the uninstall section. That COM DLL is dependent on another DLL that's in the same dir as it, but of course loading the COM DLL fails because it can't find the dependency... the logical way to solve this is to use SetCurrentDirectory() to put the current directory in with the COM DLL, unregister it, and continue along.<br />
      <br />
      I can't seem to find a way to change the current directory in code though :/</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Smile2Me</span><br />
      <span class="post-time small text-muted">20th April 2002 10:12 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><a href="http://firehose.net/free/nsis/makensis.htm#SetOutPath" target="_blank">http://firehose.net/free/nsis/makensis.htm#SetOutPath</a><br />
      <br />
      SetOutPath controls the current dir.<br />
      <br />
      -Hendri.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">tenfour</span><br />
      <span class="post-time small text-muted">20th April 2002 19:54 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">That's what I thought, but that doesn't work. SetOutPath appears only controls how NSIS will handle relative paths, it doesn't actually SetCurrentDirectory.<br />
      <br />
      I've tried your suggestion, but UnRegDLL doesn't use $OUTDIR as the current directory.<br />
      <br />
      tenfour</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Smile2Me</span><br />
      <span class="post-time small text-muted">21st April 2002 09:14 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">tenfour,<br />
      <br />
      I'm not sure that I understand what you want to do, but anyway, here's a dll that sets and gets (for checking purpose) the current dir. Does it work now?<br />
      <br />
      Good luck, greetz,<br />
      -Hendri.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
      <span class="post-time small text-muted">21st April 2002 14:17 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Here is one without using any DLL or source changing:<br />
      <a href="http://forums.winamp.com/showthread.php?s=&amp;threadid=79913" target="_blank">http://forums.winamp.com/showthread....threadid=79913</a></p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">tenfour</span><br />
      <span class="post-time small text-muted">21st April 2002 23:17 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Wow, thank you so much :) I didn't see that other thread.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Smile2Me</span><br />
      <span class="post-time small text-muted">22nd April 2002 07:40 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">I forgot about this thread, sorry.<br />
      <br />
      -Hendri.</p>
    </div>
    <hr />

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]>
  </script>
</body>
</html>
