<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="Copying multiple files to different folders" />

  <title>Copying multiple files to different folders - NSIS Forums</title><!-- Bootstrap core CSS -->
  <link rel="stylesheet" type="text/css" href="//netdna.bootstrapcdn.com/bootswatch/3.0.1/readable/bootstrap.min.css" />
  <link rel="stylesheet" href="../css/style.css" type="text/css" /><!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!--[if lt IE 9]>
                <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
                <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->
</head>

<body>
  <div class="container">
    <!-- Put navigation bar here -->

    <ol class="breadcrumb">
      <li><a href="../index.html" class="glyphicon glyphicon-home"></a></li>

      <li><a href="f-65.html">NSIS Discussion</a></li>

      <li class="active">Copying multiple files to different folders</li>
    </ol>

    <p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=312921">Copying multiple files to different folders</a></p><br />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">rayc76</span><br />
      <span class="post-time small text-muted">24th September 2009 01:00 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>Copying multiple files to different folders</strong><br />
      What I want to do is something very simple (I believe):<br />
      <br />
      1) I want to copy Files "A" to folder A (e.g., c:\folderA)<br />
      2) I want to copy Files "B" to folder B (e.g., c:\folderB)<br />
      <br />
      The NSIS script copies, but it copying more than I want. For example,<br />
      1) In addition to copying Files A to folder A, itâ€™s also copying Files B to folder A.<br />
      2) NSIS creates folder B and copies Files B to folder B, but itâ€™s also putting Files A to Folder B.<br />
      <br />
      I only want Files A in the Folder A and I want only Files B in the B Folder.<br />
      <br />
      I have 2 Sections -- one for Files A and one for Files B.<br />
      <br />
      No doubt I'm missing something about the NSIS syntax. Below is a snippet.<br />
      <br />
      ###### FILES A #######<br />
      !insertmacro MUI_PAGE_DIRECTORY<br />
      # this shows Install Btn<br />
      !insertmacro MUI_PAGE_INSTFILES<br />
      <br />
      <br />
      ###### FILES B #######<br />
      !insertmacro MUI_PAGE_DIRECTORY<br />
      # this shows Install Btn<br />
      !insertmacro MUI_PAGE_INSTFILES<br />
      <br />
      Then below this code I have my two Sections.<br />
      <br />
      Any suggestions on how to copy only the files I want in the appropriate folders?<br />
      <br />
      Thanks.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">watzr</span><br />
      <span class="post-time small text-muted">24th September 2009 05:05 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">As I understand you dont need to keep two sections to do this task. Instead you can follow "CopyFiles" command as follows.<br />
      <br />
      ;-------------------------------------------------<br />
      <br />
      Name "TestForum" ; The name of the installer<br />
      OutFile "TestForum.exe" ; The file to write<br />
      <br />
      Page instfiles<br />
      <br />
      Section ""<br />
      CopyFiles /FILESONLY "Folder\FileA.txt" "FolderA\FileA.txt"<br />
      CopyFiles /FILESONLY "Folder\FileB.txt" "FolderB\FileB.txt"<br />
      SectionEnd<br />
      <br />
      ;--------------------------------------------------<br />
      <br />
      For further details refer "CopyFiles" command in NSIS user manual.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">rayc76</span><br />
      <span class="post-time small text-muted">27th September 2009 05:43 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Thanks for the reply. I tried the CopyFiles, but it not giving me what I want. I can meet my objective if I create run two separate NSIS script -- one to copy a set of OCXs to one folder (determined by the user) and one to copy some data files to another folder (also detemined by the user).<br />
      <br />
      I was trying to combine these two actions into one NSIS script. As I mentioned in my initial response, when I do that my script copies my OCXs to the correct folder, but it also includes the data files. In addition, it copies my Data Files to its correct folder, but also includes my OCXs.<br />
      <br />
      Any one out there have any suggestions. Otherwise I going use two NSIS script. This works, but not elegant, but I can't spend much more time on this. I don't like being yelled at :-) Thanks!</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">jpderuiter</span><br />
      <span class="post-time small text-muted">28th September 2009 08:09 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">I think what you need is a second Directory page, so the user can select a folder for "Files A" and a folder for "Files B", right?<br />
      You can make a custom page with two edit boxes, one for each folder, or insert two directory pages.<br />
      For the last option, see:<br />
      <a href="http://nsis.sourceforge.net/Setting_Default_Location_for_2nd_(Data)_Directory_Page" target="_blank">http://nsis.sourceforge.net/Setting_...Directory_Page</a><br />
      <br />
      EDIT: Sorry, that link is deprecated. But you can add a second directory page. Search the forum for some examples</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">noemig</span><br />
      <span class="post-time small text-muted">6th February 2012 20:39 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>Copying files from one folder on the installation Directory to SysWow64 or System32</strong><br />
      Hello,<br />
      <br />
      I am trying to copy some files from the installation directory to SysWow64 or system32, depending is the OS is 32 or 64.<br />
      <br />
      The code is written as :<br />
      <br />
      Section "DLL"<br />
      <br />
      ${If} ${RunningX64}<br />
      <br />
      SetOutPath "$WINDIR\SysWOW64"<br />
      DetailPrint "Installer running on 64-bit host"<br />
      File /r "DFORMD.DLL"<br />
      File /r "DFORRT.DLL"<br />
      File /r "Expsrv.dll"<br />
      File /r JETCOMP.exe<br />
      <br />
      ${Else}<br />
      <br />
      SetOutPath "$WINDIR\System32"<br />
      File /r "DFORMD.DLL"<br />
      File /r "DFORRT.DLL"<br />
      File /r "Expsrv.dll"<br />
      File /r "JETCOMP.exe"<br />
      <br />
      ${EndIf}<br />
      <br />
      <br />
      SectionEnd<br />
      <br />
      The installer is copying the entire folder that contains those DLL from the installation directory to SYSWOW64 or System32.<br />
      <br />
      Can somebody give me a clue on how to solve this ?<br />
      <br />
      Thanks.<br />
      <br />
      noemig</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">MSG</span><br />
      <span class="post-time small text-muted">7th February 2012 08:20 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Edit: double</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">MSG</span><br />
      <span class="post-time small text-muted">7th February 2012 08:22 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">noemig: Please do not ask the same question twice.<br />
      <a href="http://forums.winamp.com/showthread.php?t=341810" target="_blank">http://forums.winamp.com/showthread.php?t=341810</a></p>
    </div>
    <hr />

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]>
  </script>
</body>
</html>
