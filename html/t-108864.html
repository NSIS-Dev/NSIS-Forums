<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="description" content="branching an Execwait??"><title>branching an Execwait?? - NSIS Forums</title><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script><link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css"><link rel="stylesheet" href="../css/style.css" type="text/css"></head><body><div class="container"><ol class="breadcrumb"><li><a href="../index.html" class="glyphicon glyphicon-home"></a></li><li><a href="f-65.html">NSIS Discussion</a></li><li class="active">branching an Execwait??</li></ol><p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=108864">branching an Execwait??</a></p><br><div class="post"><p class="post-meta"><span class="post-author text-primary">Geoshine</span><br><span class="post-time small text-muted">8th October 2002 02:33 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>branching an Execwait??</strong><br>Hey folks.<br><br>Here's my problem. From my installer, I need to kick off an MSI install. So far as I've been able to tell, I actually need to call the msiexec from an Execwait in order for this to work. Nothing else seems to achieve the desired results. However, one problem. If the OS is '95 or '98 (and assuming they have the installer), I need to call it like this:<br></p><pre>
<code>ExecWait '"msiexec.exe" $INSTDIR\SFRelease.msi'</code>
</pre><br>However, if its NT, 2K or XP, I need this:<br><pre>
<code>ExecWait '"msiexec.exe" /i $INSTDIR\SFRelease.msi'</code>
</pre><br>The only way I've found to distinguish between those is to make a system call or something to do 'set OS', which should echo back the current version. Then I can do some sort of compare on that, and branch to a different Execwait depending on the result.<br><br>So my question is 2-fold. First, can anyone think of any easier way to accomplish the above? And whether you think of something new, or just agree with my above assessment, can someone please provide some code snippets for the nsi file? I'm still quite new to this, and bit lost on how to do branching.<br><br>Thanks very much for your time.<br><br>- Geo</div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Joost Verburg</span><br><span class="post-time small text-muted">8th October 2002 09:28 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Have a look at Examples\functions.htm (GetWindowsVersion)</p></div><hr><div class="footer"><p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p></div></div><script src="../js/highlight.pack.js" type="text/javascript"></script><script type="text/javascript">//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]></script></body></html>