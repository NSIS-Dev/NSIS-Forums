<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="NSIS OnChange" />

  <title>NSIS OnChange - NSIS Forums</title><!-- Bootstrap core CSS -->
  <link rel="stylesheet" type="text/css" href="//netdna.bootstrapcdn.com/bootswatch/3.0.1/readable/bootstrap.min.css" />
  <link rel="stylesheet" href="../css/style.css" type="text/css" /><!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!--[if lt IE 9]>
                <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
                <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->
</head>

<body>
  <div class="container">
    <!-- Put navigation bar here -->

    <ol class="breadcrumb">
      <li><a href="../index.html" class="glyphicon glyphicon-home"></a></li>

      <li><a href="f-65.html">NSIS Discussion</a></li>

      <li class="active">NSIS OnChange</li>
    </ol>

    <p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=321281">NSIS OnChange</a></p><br />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">jrlarkin87</span><br />
      <span class="post-time small text-muted">30th July 2010 22:38 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>NSIS OnChange</strong><br />
      Hey All,<br />
      <br />
      I am a Java/C# coder that has been pushed into the NSIS world and require some assistance. I currently have an Installer screen that sets values in a Drop box(drop list) during the show page method. When that list is changed I need to use another function to get another value to set for a different field. To Simplify I need to set a new field based off of what the old field is without going to a knew page. I need to simulate an onchange in NSIS I am using the ini pages so I cant use the nsDialog::OnChange. Can someone please help to direct me in the right direction even if its only better documentation.<br />
      <br />
      Thanks,</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
      <span class="post-time small text-muted">30th July 2010 22:51 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">You have to use nsDialogs.<br />
      <br />
      Stu</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">jrlarkin87</span><br />
      <span class="post-time small text-muted">30th July 2010 23:14 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Is that possible with the ini visual editor stuff in eclipse?? Can I use nsDialog to take control of a pre-existing field?? Sorry for my lack of knowledge on the subject, but I have yet to find any good references for NSIS other then the forums.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">jrlarkin87</span><br />
      <span class="post-time small text-muted">30th July 2010 23:38 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">So I made a little progress I guess your supposed to use like a NOTIFY flag not sure how to use it yet, but seems to be the key.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Animaether</span><br />
      <span class="post-time small text-muted">31st July 2010 02:23 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">in theory if nothing else you should be able to use the NSD_OnChange functionality with a dialog built originally from InstallOptions(2/Ex) - as long as you set the OnChange event -before- the page is displayed. You can get the hwnd of the control (Which you'll need for the OnChange) out of the INI after initialization<br />
      <br />
      However.. I'd recommend re-building the page with nsDialogs entirely. There's already an example that's similar to the sort of thing you would need:<br />
      <a href="http://nsis.sourceforge.net/Move_data_between_ListBoxes" target="_blank">http://nsis.sourceforge.net/Move_data_between_ListBoxes</a><br />
      <br />
      If you do insist on continuing with InstallOptions(2/Ex), then you do indeed need the NOTIFY flag on the droplist control. I'm not sure if the original InstallOptions supports it on that control so you might have to switch to InstallOptionsEx. Once the NOTIFY event works correctly, the page's Leave function will be triggered - at which point you'll have to read the INI file and read the state of the page to see which user action triggered that leave event.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">jrlarkin87</span><br />
      <span class="post-time small text-muted">2nd August 2010 18:25 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Hey Guys,<br />
      <br />
      Thanks for the replies so far. So I figured out how to use the flag to an extent. I can then use a switch statement to determine what action to take. I am having a new problem though!? The flag sends me to the Leave Page Function. I read that Choice A was changed, and based on the information from Choice A I write a new selection for Choice B. However, after it shows a message box(which I have used to verify that the function I desired was indeed being called). It doesn't change choice B as it should. Currently the code is simply using the MUI_OPTIONS_WRITE macro... Any Suggestions on what to do in order to get the changes to stick when it aborts the leave page function?</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">jrlarkin87</span><br />
      <span class="post-time small text-muted">2nd August 2010 19:28 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Noticed Something if I set off the flag, it writes the changed value and I hit next. Once I go back to the page it suddenly shows up?</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">jrlarkin87</span><br />
      <span class="post-time small text-muted">2nd August 2010 23:05 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Hey,<br />
      <br />
      Alright I am getting better results using GetDlgItem and then I can set text boxes with SW_SETTEXT. Id like to know what WinMessaging has for populating the droplist and setting its state? Is it as simple as SETState? EW that sounds good ill try that lol if there are any more solid answers please let me know!<br />
      <br />
      P.S: I now know more about NSIS then I ever wanted to know!<br />
      <br />
      Thanks,<br />
      J</p>
    </div>
    <hr />

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]>
  </script>
</body>
</html>
