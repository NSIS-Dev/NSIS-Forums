<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="Exclude UNC paths?" />

  <title>Exclude UNC paths? - NSIS Forums</title>
  <script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script>
  <!-- Bootstrap core CSS -->

  <link rel="stylesheet" type="text/css" href="//netdna.bootstrapcdn.com/bootswatch/3.0.1/readable/bootstrap.min.css" />
  <link rel="stylesheet" href="../css/style.css" type="text/css" /><!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!--[if lt IE 9]>
                <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
                <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->
</head>

<body>
  <div class="container">
    <!-- Put navigation bar here -->

    <ol class="breadcrumb">
      <li><a href="../index.html" class="glyphicon glyphicon-home"></a></li>

      <li><a href="f-65.html">NSIS Discussion</a></li>

      <li class="active">Exclude UNC paths?</li>
    </ol>

    <p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=271456">Exclude UNC paths?</a></p><br />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">bnicer</span><br />
      <span class="post-time small text-muted">20th May 2007 01:24 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>Exclude UNC paths?</strong><br />
      Hi. Thanks to HotButteredSoul's UNC path function I can't decide whether to exclude only non-mapped locations beginning with a backward slash, or whether to block mapped locations also, that begin with a backward slash in UNC format. From my point of view, mapped locations aren't ideal, because they put the uninstaller on one machine and the uninstall registry entries on another. I'd just as soon exclude network installations, and if, as experienced by HotButteredSoul, mapped drives "can cause issues", what choice do I have? Some users might have good reasons to install onto a remote computer, however since UNC path names break the installer the way some networks are configured (like mine - mapped paths converted to UNC send the installer into a loop), it seems inevitable that you snub them. No network installations. I'm posting this in case someone knows another way to detect mapped drives. The get_universal_name function is good stuff, but it could be useless on older Windows. I'll check.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
      <span class="post-time small text-muted">20th May 2007 18:27 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">You can call GetDriveType using the System plug-in and compare the result to DRIVE_REMOTE.</p>
      <pre>
<code>!include LogicLib.nsh<br />#...<br />!define DRIVE_REMOTE 4<br />System::Call 'kernel32::GetDriveType(t "J:\") i.r0'<br />${If} $0 == ${DRIVE_REMOTE}<br />  # bad installation directory<br />${EndIf}</code>
</pre>
    </div>
    <hr />

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]>
  </script>
</body>
</html>
