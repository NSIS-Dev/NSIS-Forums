<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="Change order of the message ?" />

  <title>Change order of the message ? - NSIS Forums</title>
  <script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script>
  <!-- Bootstrap core CSS -->

  <link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css" />
  <link rel="stylesheet" href="../css/style.css" type="text/css" /><!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!--[if lt IE 9]>
                <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
                <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->
</head>

<body>
  <div class="container">
    <!-- Put navigation bar here -->

    <ol class="breadcrumb">
      <li><a href="../index.html" class="glyphicon glyphicon-home"></a></li>

      <li><a href="f-65.html">NSIS Discussion</a></li>

      <li class="active">Change order of the message ?</li>
    </ol>

    <p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=297972">Change order of the message ?</a></p><br />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kukomamasan</span><br />
      <span class="post-time small text-muted">28th September 2008 13:40 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>Change order of the message ?</strong><br />
      Hi all i got a little problem getting some message to display after another ?<br />
      <br />
      here is what i got:<br />
      <br />
      ; Script generated by the HM NIS Edit Script Wizard.<br />
      ; HM NIS Edit Wizard helper defines<br />
      !define PRODUCT_NAME "Bobs Mappack 1.3"<br />
      !define PRODUCT_VERSION "1.3"<br />
      !define PRODUCT_UNINST_KEY "Software\Microsoft\Windows\CurrentVersion\Uninstall\${PRODUCT_NAME}"<br />
      !define PRODUCT_UNINST_ROOT_KEY "HKLM"<br />
      SetCompressor /SOLID lzma<br />
      SetCompressorDictSize 64<br />
      ; MUI 1.67 compatible ------<br />
      !include "MUI.nsh"<br />
      ; MUI Settings<br />
      !define MUI_ABORTWARNING<br />
      !define MUI_ICON "${NSISDIR}\Contrib\Graphics\Icons\modern-install.ico"<br />
      !define MUI_UNICON "${NSISDIR}\Contrib\Graphics\Icons\modern-uninstall.ico"<br />
      ; Directory page<br />
      !insertmacro MUI_PAGE_DIRECTORY<br />
      ; Instfiles page<br />
      !insertmacro MUI_PAGE_INSTFILES<br />
      ; Finish page<br />
      !insertmacro MUI_PAGE_FINISH<br />
      ; Uninstaller pages<br />
      !insertmacro MUI_UNPAGE_INSTFILES<br />
      ; Language files<br />
      !insertmacro MUI_LANGUAGE "English"<br />
      ; Reserve files<br />
      !insertmacro MUI_RESERVEFILE_INSTALLOPTIONS<br />
      ; MUI end ------<br />
      Name "${PRODUCT_NAME}"<br />
      OutFile "C:\Bobs Mappack 1.3.exe"<br />
      ShowInstDetails show<br />
      ShowUnInstDetails show<br />
      Function .onInit<br />
      ReadRegStr $R0 HKLM "SOFTWARE\Microsoft\Windows\CurrentVersion\App Paths\GhostRecon.exe" "path"<br />
      StrCmp $R0 "" NotPresent Present<br />
      notpresent:<br />
      StrCpy $INSTDIR "$programfiles\Red Storm Entertainment\Ghost Recon\Mods"<br />
      MessageBox MB_OK "Path to ghost recon was not found, plz verify this path, or browse to ghost recon\mods\ and install"<br />
      goto done<br />
      present:<br />
      strcpy $instdir $R0\Mods<br />
      done:<br />
      functionend<br />
      Section "MainSection" SEC01<br />
      SetOutPath "$INSTDIR\Bobs Mappack 1_3"<br />
      SetOverwrite on<br />
      File /r "G:\Ghost Recon\mods\Bobs Mappack 1_3\*.*"<br />
      sectionend<br />
      Section -AdditionalIcons<br />
      CreateDirectory "$SMPROGRAMS\Bobs Mappack 1.3"<br />
      CreateShortCut "$SMPROGRAMS\Bobs Mappack 1.3\Uninstall Bobs Mappack 1.3.lnk" "$INSTDIR\Remove_Bobs Mappack 1.3.exe"<br />
      SectionEnd<br />
      Section -Post<br />
      WriteUninstaller "$INSTDIR\Remove_Bobs Mappack 1.3.exe"<br />
      WriteRegStr ${PRODUCT_UNINST_ROOT_KEY} "${PRODUCT_UNINST_KEY}" "DisplayName" "$(^Name)"<br />
      WriteRegStr ${PRODUCT_UNINST_ROOT_KEY} "${PRODUCT_UNINST_KEY}" "UninstallString" "$INSTDIR\Remove_Bobs Mappack 1.3.exe"<br />
      WriteRegStr ${PRODUCT_UNINST_ROOT_KEY} "${PRODUCT_UNINST_KEY}" "DisplayVersion" "${PRODUCT_VERSION}"<br />
      SectionEnd<br />
      Function un.onUninstSuccess<br />
      HideWindow<br />
      MessageBox MB_ICONINFORMATION|MB_OK "$(^Name) was successfully removed from your computer."<br />
      FunctionEnd<br />
      Function un.onInit<br />
      MessageBox MB_ICONQUESTION|MB_YESNO|MB_DEFBUTTON2 "Are you sure you want to completely remove $(^Name) and all of its components?" IDYES +2<br />
      Abort<br />
      FunctionEnd<br />
      Section Uninstall<br />
      Delete "$SMPROGRAMS\Bobs Mappack 1.3\Bobs Mappack 1.3.lnk"<br />
      rmdir "$SMPROGRAMS\Bobs Mappack 1.3"<br />
      RMDIR /r "$INSTDIR\Bobs Mappack 1_3"<br />
      Delete "$INSTDIR\Remove_Bobs Mappack 1.3.exe"<br />
      DeleteRegKey ${PRODUCT_UNINST_ROOT_KEY} "${PRODUCT_UNINST_KEY}"<br />
      SetAutoClose true<br />
      SectionEnd<br />
      <br />
      Problem is when i start the installer i get an error window saying "Path to ghost recon was not found, plz verify this path, or browse to ghost recon\mods\ and install" before all else in the installer.<br />
      <br />
      Now error message is what i wanted, but can i have that error message saying it in the install path window?<br />
      so ppl just dident forget what they clicked ok to? ;)<br />
      so i want install path window to come first, then the error message ? can it be done ?</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Yathosho</span><br />
      <span class="post-time small text-muted">28th September 2008 14:53 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">you should place the message in the leave function of the directory-page<br /></p>
      <pre>
<code>Page directory "" "" "DirectoryLeave"<br /><br />...<br /><br />Function DirectoryLeave<br />  MessageBox MB_YESNO "Continue?" IDYES +2<br />  Abort<br />FunctionEnd</code>
</pre><br />
      please attach your script in future, rather than pasting it
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kukomamasan</span><br />
      <span class="post-time small text-muted">29th September 2008 08:59 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">ok im a noob here, i dont know much of the stuff here<br />
      you said place something in the page directory ? i dont see that?<br />
      <br />
      Page directory "" "" "DirectoryLeave"<br />
      <br />
      ...<br />
      <br />
      Function DirectoryLeave<br />
      MessageBox MB_YESNO "Continue?" IDYES +2<br />
      Abort<br />
      FunctionEnd<br />
      <br />
      i guess i should place above some where?<br />
      and ... should be the message?</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kukomamasan</span><br />
      <span class="post-time small text-muted">30th September 2008 12:53 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Ok i found out how above should be put in, thx.<br />
      Now its almost as i want it, but can the message be displayed right away the directory page open up?(now it waits for me to click install before message pops up), and also if the registry key was found it make that the new directory path, but then i have to click next, and install while the directory page is the same? hope that can be fixed too.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kukomamasan</span><br />
      <span class="post-time small text-muted">2nd October 2008 17:07 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">ok i found out how to avoid the 2 same install windows, i only had to remove:<br />
      <br />
      !insertmacro MUI_PAGE_DIRECTORY<br />
      ; Instfiles page<br />
      <br />
      hehe, dunno why it acted up, just because i add an message in the directory dialog.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kukomamasan</span><br />
      <span class="post-time small text-muted">2nd October 2008 19:21 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Well since i had to add almost 2 identical script lines, which i saw was not leading anywhere to my goal, i replaced it with an search option, to look for the right place to install, i guess this is better?<br />
      <br />
      Edit: i was having problems uploading the changed file, in here it was not changed ???, gonna try again</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kukomamasan</span><br />
      <span class="post-time small text-muted">2nd October 2008 19:28 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">another try<br />
      this works almost like i want it to, but i still need to fix the massagebox, (path was not found ect..) it only appear when you press install, i want that box showing when directory window shows up? , so ppl know allready to browse to another location.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kukomamasan</span><br />
      <span class="post-time small text-muted">4th October 2008 12:51 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">ok, since no one has an answer :-), i figured out to try something else, and this works ok i guess<br />
      <br />
      Function .onVerifyInstDir<br />
      IfFileExists $INSTDIR\ghostrecon.exe PathGood<br />
      Abort<br />
      PathGood:<br />
      FunctionEnd<br />
      <br />
      well it somehow fullfill my wishes to pick the right directory. Though i can not use messageboxes with above, since that message box would show like 20 times before you get to the right location hehe, but your not able to install to any another directory than where ghostrecon.exe is located, so thats good enough for me, since there is no other alternative i guess.<br />
      <br />
      Edit: What i really want is, directory page show up, then the error message, that the path is wrong, then user select another path, right/wrong , if right no message, proceed with installation, if wrong, display same message, can that be made ?</p>
    </div>
    <hr />

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]>
  </script>
</body>
</html>
