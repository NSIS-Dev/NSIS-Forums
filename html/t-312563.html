<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="Error Wrapping MS Patch - Please go to the control panel to install and configure sy" />

  <title>Error Wrapping MS Patch - Please go to the control panel to install and configure sy - NSIS Forums</title>
  <script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script>
  <!-- Bootstrap core CSS -->

  <link rel="stylesheet" type="text/css" href="//netdna.bootstrapcdn.com/bootswatch/3.0.1/readable/bootstrap.min.css" />
  <link rel="stylesheet" href="../css/style.css" type="text/css" /><!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!--[if lt IE 9]>
                <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
                <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->
</head>

<body>
  <div class="container">
    <!-- Put navigation bar here -->

    <ol class="breadcrumb">
      <li><a href="../index.html" class="glyphicon glyphicon-home"></a></li>

      <li><a href="f-65.html">NSIS Discussion</a></li>

      <li class="active">Error Wrapping MS Patch - Please go to the control panel to install and configure sy</li>
    </ol>

    <p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=312563">Error Wrapping MS Patch - Please go to the control panel to install and configure sy</a></p><br />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">SB5591</span><br />
      <span class="post-time small text-muted">17th September 2009 15:18 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>Error Wrapping MS Patch - Please go to the control panel to install and configure sy</strong><br />
      I'm stumped.<br />
      <br />
      I'm wrapping a KB (WindowsXP-KB915865-v11-x86-ENU.exe) from Microsoft that installs an Office 2007 component needed by Visio 2007.<br />
      <br />
      When I run the following code snippet from my .nsi script:<br />
      <br />
      Push 'WindowsXP-KB915865-v11-x86-ENU.exe'<br />
      Call ExecCommand<br />
      <br />
      I get the following popup message:<br />
      <br />
      "Please go to the control panel to install and configure system components"<br />
      <br />
      I'm not a NSIS expert but have wrapped a few .MSI installs with no problems.<br />
      <br />
      This is my first attempt to wrap a KB patch that installs a component like this.<br />
      <br />
      Any suggestions would be much appreciated.<br />
      <br />
      Thanks,<br />
      <br />
      Steve</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">jpderuiter</span><br />
      <span class="post-time small text-muted">17th September 2009 18:18 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">I was not able to reproduce the message you got, so I'm not sure what may have caused that.<br />
      <br />
      Since I don't know what "ExecCommand" does, here some comments you might already have tried:<br />
      <br />
      When you call WindowsXP-KB915865-v11-x86-ENU.exe /? from the command prompt, you will see all available command line switches.<br />
      <br />
      One of these is /passive: Unattended mode (progress bar only).<br />
      When I use it like this:</p>
      <pre>
<code>ExecWait '"$TEMP\WindowsXP-KB915865-v11-x86-ENU.exe" /passive'</code>
</pre><br />
      it installs without a problem.<br />
      <br />
      BTW:<br />
      I found that when you call "C:\Windows\System32\Setup.exe", your message will appear.<br />
      One way this can happen is when an Autorun.ini is found with a "open=Setup.exe" entry without an actual Setup.exe in the same directory.<br />
      Maybe this helps?
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">SB5591</span><br />
      <span class="post-time small text-muted">17th September 2009 18:45 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">jpderuiter:<br />
      <br />
      I see you're calling it a little differently. I'll give that a try.<br />
      <br />
      Thanks,<br />
      <br />
      Steve</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">SB5591</span><br />
      <span class="post-time small text-muted">17th September 2009 21:06 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">jpderuiter:<br />
      <br />
      Yep, that works. Unfortunately I need to do a silent install and am using the /quiet switch.<br />
      <br />
      From my testing seems like this (the popup message:"Please go to the control panel to install and configure system components") only pops up when you (I) use the /quiet switch.<br />
      <br />
      The entire install is silent, as it should be, then at the end bingo, the popup.<br />
      <br />
      What a bummer!<br />
      <br />
      Any other ideas on suppressing this popup?<br />
      <br />
      Thanks,<br />
      <br />
      Steve</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">jpderuiter</span><br />
      <span class="post-time small text-muted">17th September 2009 21:38 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">ok, that's strange.<br />
      Not happening on my machine.<br />
      <br />
      Did you have a look at the log file: C:\WINDOWS\KB915865.log<br />
      <br />
      You can extract the package to e.g. c:\KB915865_ENU using</p>
      <pre>
<code>WindowsXP-KB915865-v11-x86-ENU.exe  -x:c:\KB915865_ENU</code>
</pre><br />
      Maybe you can find something related there.
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">jpderuiter</span><br />
      <span class="post-time small text-muted">17th September 2009 21:57 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">BTW, does this only happen when you run it from an NSIS script, or always?</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">SB5591</span><br />
      <span class="post-time small text-muted">17th September 2009 22:09 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">jpderuiter:<br />
      <br />
      Thanks for the suggestion. I've extracted the KB and am looking at my testing. I think my logic was flawed and I'm re-running the tests to isolate this better.<br />
      <br />
      I've looked at the log file but didn't find anything useful to isolate this.<br />
      <br />
      So odd, if I run WindowsXP-KB915865-v11-x86-ENU.exe outside of a .nsi script it never gives the popup. When running from a script I seem to get this popup. I'm not sure why it would be having this behavior when fired from NSIS.<br />
      <br />
      I sure appreciate all your suggestions!<br />
      <br />
      Thanks,<br />
      <br />
      Steve</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">jpderuiter</span><br />
      <span class="post-time small text-muted">17th September 2009 22:55 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">What when you use the ExecDos plug-in?<br />
      I use this plugin most of the time, mainly because of the ASYNC option, but I also found it working better then the other commands / plug-ins.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">SB5591</span><br />
      <span class="post-time small text-muted">18th September 2009 16:37 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">jpderuiter:<br />
      <br />
      I'm not using ExecDos and will have to check that out.<br />
      <br />
      Thanks,<br />
      <br />
      Steve</p>
    </div>
    <hr />

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]>
  </script>
</body>
</html>
