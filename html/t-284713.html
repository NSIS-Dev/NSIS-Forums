<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="description" content="Wrap multiple MSI's(newbie)"><title>Wrap multiple MSI's(newbie) - NSIS Forums</title><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script><link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css"><link rel="stylesheet" href="../css/style.css" type="text/css"></head><body><div class="container"><ol class="breadcrumb"><li><a href="../index.html" class="glyphicon glyphicon-home"></a></li><li><a href="f-65.html">NSIS Discussion</a></li><li class="active">Wrap multiple MSI's(newbie)</li></ol><p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=284713">Wrap multiple MSI's(newbie)</a></p><br><div class="post"><p class="post-meta"><span class="post-author text-primary">oreillyr</span><br><span class="post-time small text-muted">10th January 2008 12:18 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>Wrap multiple MSI's(newbie)</strong><br>HI All,<br><br>I have a requirement for a client to wrap three MSI's into a single file install. NSIS was recommended to me as the solution! Is it possible to use NSIS to achieve this? I have had a look and dont see MSI's mentioned(possibly not looked efficiently!. When looking at some of the scripts it mentions the installdir however I am looking for something that you can run from the desktop which will just kick off the MSI's one after another, the InstallDir being taken care of in the MSI's themselves. Sorry if I have missed something simple!Could someone point me in the right direction either to a previous post or some sample script involving multiple MSI install? Thanks in advance!</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Red Wine</span><br><span class="post-time small text-muted">10th January 2008 12:36 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Probably you did not perform a deep search into the forum.<br>These are regular expressions for nsis. You can extract msi's into $PLUGINSDIR and call msiexec for each one.<br>You're able to check if the required version of msiexec is installed on the target and download it if needed.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">oreillyr</span><br><span class="post-time small text-muted">10th January 2008 14:03 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Thanks for the reply. Could you give me the URL for one such post please? I have been searching through since and have not found any! cheers</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Red Wine</span><br><span class="post-time small text-muted">10th January 2008 14:26 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">There's s huge "database" here. Just for reference...<br><br><a href="http://forums.winamp.com/search.php?s=&amp;action=showresults&amp;searchid=10686684&amp;sortby=&amp;sortorder=" target="_blank">http://forums.winamp.com/search.php?...by=&amp;sortorder=</a><br><br>Also you may want to review the documentation,<br><br><a href="http://nsis.sourceforge.net/Docs/Chapter4.html#4.9.1" target="_blank">http://nsis.sourceforge.net/Docs/Chapter4.html#4.9.1</a><br><br><a href="http://nsis.sourceforge.net/Docs/Chapter4.html#4.1" target="_blank">http://nsis.sourceforge.net/Docs/Chapter4.html#4.1</a></p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">oreillyr</span><br><span class="post-time small text-muted">10th January 2008 14:53 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Thanks mate. Will be more thorough when next searching ;)</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">oreillyr</span><br><span class="post-time small text-muted">11th January 2008 14:01 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Could anyone post a complete sample script which just installs 1 MSI and I will hopefully be able to work out how to do the rest please? I am not a developer/scripter by any stretch of the imagination! I am having trouble with the installdir concept as the MSI will take care of all that anyway. Do I need to set an installdir? Any help would be appreciated!</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br><span class="post-time small text-muted">11th January 2008 15:09 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Use File and then ExecWait.<br><br>Stu</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">oreillyr</span><br><span class="post-time small text-muted">11th January 2008 15:53 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Could you expand a bit? Post a snippet perhaps?<br>Cheers,<br>Rob</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Red Wine</span><br><span class="post-time small text-muted">11th January 2008 17:12 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">You don't need to use InstallDir unless you installer has to extract a custom installation beyond msi's.<br>My suggestion is to use $PLUGINSDIR as I mentioned above.<br><br>Also, you may want to search wiki to grab useful info.<br><br><a href="http://nsis.sourceforge.net/List_of_all_pages_in_NSIS_repository" target="_blank">http://nsis.sourceforge.net/List_of_...SIS_repository</a></p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br><span class="post-time small text-muted">11th January 2008 17:18 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"></p><pre>
<code>InitPluginsDir<br>SetOutPath $PLUGINSDIR<br>File setup.msi<br>ExecWait `msiexec.exe /qn /i "setup.msi"` $R0<br>${If} $R0 != 0<br>  DetailPrint `Application installation failed: $R0`<br>  Abort<br>${EndIf}</code>
</pre><br>
      Pretty self explanatory. Look up the instructions if you need more information.<br>
      <br>
      Stu
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">oreillyr</span><br>
      <span class="post-time small text-muted">14th January 2008 11:13 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Self explanatory when you know how ;) Thanks for your help guys</p>
    </div>
    <hr>

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]></script></body></html>