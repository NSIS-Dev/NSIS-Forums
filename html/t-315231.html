<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="description" content="Autorun under windows 7"><title>Autorun under windows 7 - NSIS Forums</title><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script><link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css"><link rel="stylesheet" href="../css/style.css" type="text/css"><!--[if lt IE 9]><script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script><script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script><![endif]--></head><body><div class="container"><ol class="breadcrumb"><li><a href="../index.html" class="glyphicon glyphicon-home"></a></li><li><a href="f-65.html">NSIS Discussion</a></li><li class="active">Autorun under windows 7</li></ol><p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=315231">Autorun under windows 7</a></p><br><div class="post"><p class="post-meta"><span class="post-author text-primary">thegrinch</span><br><span class="post-time small text-muted">10th December 2009 12:58 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>Autorun under windows 7</strong><br>Hi,<br><br>I know that autorun issues are a bit offtopic here, but since we all have to deploy our apps from time to time :-), I think a few other prople should have encountered the same problem as me.<br><br>I am deploying 3 (NSIS-) installers on one CD, call them installer_a.exe, installer_b.exe, installer_c.exe.<br><br>I burn them on a cd together with a autorun.inf, which looks like<br></p><pre>
<code><br>[autorun]<br>shell\insta\command=installer_a.exe<br>shell\insta=Installation of application A<br>shell\instb\command=installer_b.exe<br>shell\instb=Installation of application B<br>shell\instc\command=installer_c.exe<br>shell\instc=Installation of application C<br></code>
</pre><br>
      On windows xp, this configuration will automatically execute installer_a.exe when inserting the CD.<br>
      <br>
      ---edit---<br>
      ah, I forgot to say that the three options are shown in the context-menu of the cd-drive in windows explorer.<br>
      ---/edit---<br>
      <br>
      On windows 7, it does not execute any installer, instead this windows-dialog pops up, asking what I want to do with the CD. This would be absolutely fine, if this dialog contained the 3 specified items "Installation of .."<br>
      <br>
      How do you handle autorun issues under windows 7?<br>
      What about Windows vista?<br>
      To be honest, up to now I tried to circumvent all contacts to these new versions of Windows.<br>
      <br>
      Thank you for your great support in advance,<br>
      best regards,<br>
      Olli
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Anders</span><br>
      <span class="post-time small text-muted">10th December 2009 13:51 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Is that the whole .inf file? You should have a open=app.exe (or shellexecute=foo) entry or shell=insta<br>
      <br>
      As to why your items are not displayed, I don't know, but I do know that autorun has had issues with people faking the Open in explorer entry, so maybe they don't allow you to display a full list in 7</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">thegrinch</span><br>
      <span class="post-time small text-muted">10th December 2009 16:56 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Thanks for your reply.<br>
      <br>
      I have tested all these options:<br>
      <br>
      shell=insta<br>
      <br>
      open=installer_a.exe<br>
      <br>
      but they don't work.<br>
      <br>
      How do you all handle an autostart option on your cds?</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Yathosho</span><br>
      <span class="post-time small text-muted">10th December 2009 18:31 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">how are you testing your autorun.inf? you might have to burn it on a cd (or create a cd image) to be certain. microsoft modified the default behaviour of autorun lately.<br>
      <br>
      "In Windows XP, Windows Vista, and Windows Server 2003, AutoRun entries were populated for all devices that had mass storage and had a validly formatted AutoRun.inf file in the root directory. This included CDs, DVDs, USB thumb drives, external hard disks, and any volume that exposed itself as mass storage. This update disables AutoRun entries in AutoPlay, and displays only entries that are populated from CD and DVD drives. Effectively, this prevents AutoPlay from working with USB media."<br>
      <br>
      -<a href="http://support.microsoft.com/kb/971029" target="_blank">http://support.microsoft.com/kb/971029</a></p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">thegrinch</span><br>
      <span class="post-time small text-muted">10th December 2009 18:40 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Actually, I have burned (in every sense :-) ) over 10 cds today.<br>
      <br>
      So, I really tried to have a realistic testing environment.</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Yathosho</span><br>
      <span class="post-time small text-muted">10th December 2009 19:16 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">i just tested the original windows 7 dvd and it's autorun doesn't execute the installer (on windows 7). neither do i get an autorun option from the context-menu. holding the shift-key while opening the context-menu usually displays hidden entries - but nothing from the autorun.inf shows up. the only thing that works is the dvd icon being displayed.<br>
      <br>
      so, it looks like this is the way windows 7 is supposed to behave.</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">thegrinch</span><br>
      <span class="post-time small text-muted">10th December 2009 20:33 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">hmm, so this sucks, or what?<br>
      there must be some way to have your app start when inserting the cd!<br>
      maybe they changed the whole procedure, and we're just too blind to see it?<br>
      What about vista? do the same problems occur there too?</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">redxii</span><br>
      <span class="post-time small text-muted">10th December 2009 22:13 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Does "open=" at least present you a choice to run the installer? Starting with Vista they showed a dialog asking you what to do, one of the choices to run setup/installer.<br>
      <br>
      Having programs automatically execute from a CD or other media when inserted is a really bad idea. It doesn't have to be from a John Doe, it can be a big name like Sony who stealthily installed their DRM rootkit via autorun, and exploiting the fact that most people always ran as administrator because that was how Windows set it up.</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">thegrinch</span><br>
      <span class="post-time small text-muted">10th December 2009 22:32 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Yes, yes, I totally agrre with you.<br>
      <br>
      What I want is *not* to open a setup or something like that (eg. a small selfmade menu that would take the users choice).<br>
      <br>
      My cd will contain 3 installers, and I would really like to use this built-in feature of windows.<br>
      <br>
      also, because I have never seen such a menu-helper app that looks good and works as expected everywhere.</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Leo77</span><br>
      <span class="post-time small text-muted">11th December 2009 21:17 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Have you digitally signed the autorun? I've seen the updates I provide my customers not execute on Vista if it was not signed. I actually made my autorun with NSIS. I'll have to see if it displays on Win7.</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">thegrinch</span><br>
      <span class="post-time small text-muted">13th December 2009 01:09 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">No I did not sign the setup.<br>
      <br>
      I have given up the idea of using the built-in options of windows. I will try to set up a small exe that offers a menu to the user</p>
    </div>
    <hr>

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]></script></body></html>