<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="description" content="Using the $Desktop Directive with Delete"><title>Using the $Desktop Directive with Delete - NSIS Forums</title><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script><link rel="preload" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css" as="style" onload="this.rel='stylesheet'"><link rel="preload" href="../css/style.css" as="style" onload="this.rel='stylesheet'"><noscript><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css"><link rel="stylesheet" href="../css/style.css"></noscript><script>!function(a){"use strict";var b=function(b,c,d){function e(a){return h.body?a():void setTimeout(function(){e(a)})}function f(){i.addEventListener&&i.removeEventListener("load",f),i.media=d||"all"}var g,h=a.document,i=h.createElement("link");if(c)g=c;else{var j=(h.body||h.getElementsByTagName("head")[0]).childNodes;g=j[j.length-1]}var k=h.styleSheets;i.rel="stylesheet",i.href=b,i.media="only x",e(function(){g.parentNode.insertBefore(i,c?g:g.nextSibling)});var l=function(a){for(var b=i.href,c=k.length;c--;)if(k[c].href===b)return a();setTimeout(function(){l(a)})};return i.addEventListener&&i.addEventListener("load",f),i.onloadcssdefined=l,l(f),i};"undefined"!=typeof exports?exports.loadCSS=b:a.loadCSS=b}("undefined"!=typeof global?global:this);!function(a){if(a.loadCSS){var b=loadCSS.relpreload={};if(b.support=function(){try{return a.document.createElement("link").relList.supports("preload")}catch(b){return!1}},b.poly=function(){for(var b=a.document.getElementsByTagName("link"),c=0;c<b.length;c++){var d=b[c];"preload"===d.rel&&"style"===d.getAttribute("as")&&(a.loadCSS(d.href,d,d.getAttribute("media")),d.rel=null)}},!b.support()){b.poly();var c=a.setInterval(b.poly,300);a.addEventListener&&a.addEventListener("load",function(){b.poly(),a.clearInterval(c)}),a.attachEvent&&a.attachEvent("onload",function(){a.clearInterval(c)})}}}(this);</script></head><body><div class="container"><ol class="breadcrumb"><li><a href="../index.html" class="glyphicon glyphicon-home"></a></li><li><a href="f-65.html">NSIS Discussion</a></li><li class="active">Using the $Desktop Directive with Delete</li></ol><p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=112824">Using the $Desktop Directive with Delete</a></p><br><div class="post"><p class="post-meta"><span class="post-author text-primary">kcostain</span><br><span class="post-time small text-muted">4th November 2002 21:42 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>Using the $Desktop Directive with Delete</strong><br>Hello,<br><br>I am using NSIS 1.98. I have been trying to delete Desktop shortcuts in my Uninstall section. The following is my code:<br><br>Section Uninstall<br>SetShellVarContext "Current"<br>Delete "$DESKTOP\L1.lnk"<br>Delete "$DESKTOP\L2.lnk"<br>Delete "$DESKTOP\L1Uninstall.lnk"<br>DeleteRegKey HKEY_LOCAL_MACHINE "Software\Microsoft\Windows\CurrentVersion\Uninstall\L1"<br>DeleteRegKey HKEY_LOCAL_MACHINE "SOFTWARE\L1"<br>Delete "$INSTDIR\*.*"<br>RMDir "$INSTDIR"<br>SectionEnd<br><br>I am using Windows XP and I have the permission to delete these files. It doesnt matter where the Delete directive is, or if I use the SetShellVarContext, it still fails.<br><br><br>Any Ideas?<br>Kevin Costain</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">kichik</span><br><span class="post-time small text-muted">5th November 2002 15:37 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Do you get the right directory when you use:<br><br>MessageBox MB_OK $DESKTOP?</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">kcostain</span><br><span class="post-time small text-muted">5th November 2002 15:46 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>Thanks..</strong><br>That was it.. I had the wrong directory, once I fixed that - it worked..<br><br>Kevin</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">kichik</span><br><span class="post-time small text-muted">5th November 2002 15:53 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">I don't understand... Did NSIS get the desktop folder wrong or did you just needed some other folder?</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">kcostain</span><br><span class="post-time small text-muted">5th November 2002 16:40 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">If I was to look at it, I was trying to change the Context of the folders assuming that the default context was "All" (I had set this using a SetShellVarContext "All" command in an earlier section), this wasn't working with or without the command:<br><br>SetShellVarContext "Current"<br><br>The key here is, once I used MessageBox to debug the actual directory, I was able to see that the default was "current" and I needed to set "All" again.<br><br>Thanks for the help...<br><br>Kevin</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">kichik</span><br><span class="post-time small text-muted">5th November 2002 17:14 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Please note that there is a bug with SetShellVarContext All and Windows 9x in NSIS 1.98. Instead of falling back to current it will give you the temp folder. This bug has been fixed in NSIS 2.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">kcostain</span><br><span class="post-time small text-muted">6th November 2002 01:05 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Thanks for the info, how can I get a copy of NSIS 2? I looked at the <a href="http://www.nullsoft.com/free/nsis/" target="_blank">http://www.nullsoft.com/free/nsis/</a> page and 1.98 is still there.... ?</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">hotice</span><br><span class="post-time small text-muted">6th November 2002 01:11 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"></p><blockquote><i>Originally posted by kcostain</i><br><b>Thanks for the info, how can I get a copy of NSIS 2? I looked at the <a href="http://www.nullsoft.com/free/nsis/" target="_blank">http://www.nullsoft.com/free/nsis/</a> page and 1.98 is still there.... ?</b></blockquote>pls visit nsis.sf.net</div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">kcostain</span><br><span class="post-time small text-muted">6th November 2002 01:14 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">I've been there... only a pre-release is available.. I guess I could use that but I'm not sure if that will create more problems then its worth...</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">virtlink</span><br><span class="post-time small text-muted">6th November 2002 10:58 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"></p><blockquote><i>Originally posted by kcostain</i><br><b>Thanks for the info, how can I get a copy of NSIS 2? I looked at the <a href="http://www.nullsoft.com/free/nsis/" target="_blank">http://www.nullsoft.com/free/nsis/</a> page and 1.98 is still there.... ?</b></blockquote><blockquote><i>Originally posted by hotice</i><br><b>pls visit nsis.sf.net</b></blockquote><blockquote><i>Originally posted by kcostain</i><br><b>I've been there... only a pre-release is available.. I guess I could use that but I'm not sure if that will create more problems then its worth...</b></blockquote>The pre-release version of NSIS 2 works fine. I haven't encountered any bugs yet (except in the documentation). And, any bugs that are found will be fixed immideatly. Download<br><a href="http://nsis.sourceforge.net/nightly/nsis.zip" target="_blank">http://nsis.sourceforge.net/nightly/nsis.zip</a><br>for the latest version (NSIS 2.0b). It is updated twice a day!</div><hr><div class="footer"><p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p></div></div><script type="text/javascript" src="../js/highlight.pack.js" async></script><script type="text/javascript">//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]></script></body></html>