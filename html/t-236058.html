<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="description" content="SelfDel plug-in"><title>SelfDel plug-in - NSIS Forums</title><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script><link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css"><link rel="stylesheet" href="../css/style.css" type="text/css"><!--[if lt IE 9]><script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script><script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script><![endif]--></head><body><div class="container"><ol class="breadcrumb"><li><a href="../index.html" class="glyphicon glyphicon-home"></a></li><li><a href="f-65.html">NSIS Discussion</a></li><li class="active">SelfDel plug-in</li></ol><p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=236058">SelfDel plug-in</a></p><br><div class="post"><p class="post-meta"><span class="post-author text-primary">Takhir</span><br><span class="post-time small text-muted">21st January 2006 13:31 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>SelfDel plug-in</strong><br>In the kichik' post (multi-volume discussion thread) I found link to another thread and finally link to article with self deletion techniques description. It was very interesting for me, because very long ago I wrote my own installers and tested most of variants described in the article, but not the last one :) So first I wrote application with additional RMDir (original code included variables for this, but not the code), and then converted it to NSIS plug-in.<br>Put dll to your NSIS plug-ins dir. Build included sample and run it. Installer creates uninstaller in the 'unsd' subfolder and link in the current folder to uninstaller with _? parameter. A bit strange, but 'unsd' folder appeares after F5 only, may be because of repeating names in folder, so press F5. Run 'unsd' link, after this link should dissappear, Close uninstaller when it finishes. After this (process exited) still remaining in memory plug-in's code removes uninstaller and folder. On my home XP this works :)<br><br><a href="http://nsis.sourceforge.net/SelfDel_plug-in" target="_blank">http://nsis.sourceforge.net/SelfDel_plug-in</a></p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Instructor</span><br><span class="post-time small text-muted">22nd January 2006 23:31 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Great! One thing: could plug-in calls from on.unGUIInit function? In section cursor looks perplexed, when plugin wait for exit.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Takhir</span><br><span class="post-time small text-muted">23rd January 2006 07:20 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Thanks, Instructor, now looks better in the un.onGUIEnd :)<br>Finally this is more concept, then plug-in, but may be useful for huge uninstallers right now. I also tested plug-in in office on 98SE/XP/2000/2003. On 2003 this worked with little delay (2 sec), but result was correct. And hidden Explorer process (56 kB) exits after folder deletion on all systems. Code author declared Win95 compatibility, but I could not find virgin 95 for test.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">fishsauce</span><br><span class="post-time small text-muted">9th February 2008 05:31 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Explorer dies on Vista with this plugin... any other ways for an installer to self destruct?</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br><span class="post-time small text-muted">9th February 2008 15:55 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Write another executable which when ran waits 2 seconds and then deletes your installer. So, extract it from your main install, and run it on exit. To ensure that that executable is deleted as well, do a Delete /rebootok after executing it so that it is deleted on reboot. You'd need to pass the original executable's path to the secondary one either via the command line or via the registry.<br><br>Stu</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">fishsauce</span><br><span class="post-time small text-muted">11th February 2008 22:57 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Okay, I'll try doing that. I was hoping there's some kind of compiler flag that we can just put on our installer to take advantage of whatever mechanism the NSIS-generated uninstallers use right now to delete themselves.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br><span class="post-time small text-muted">11th February 2008 23:21 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">The uninstallers work in the same way I would think. They copy themselves to the temp folder and run from there instead then that copy is possibly deleted on reboot or maybe then as you say.<br><br>Stu</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br><span class="post-time small text-muted">17th July 2011 22:31 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">I have fixed this plug-in to work on x64 and added a Unicode build.<br><br>Edit: Now self-deletes on reboot on failure if possible.<br><br>Stu</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br><span class="post-time small text-muted">10th August 2011 12:08 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Realised the plug-in wasn't working on XP or lower any more. Fixed that and added a /REBOOT switch which will reboot the machine after the installer has been deleted. It can be used in conjunction with /RMDIR.<br><br><a href="http://nsis.sourceforge.net/SelfDel_plug-in" target="_blank">http://nsis.sourceforge.net/SelfDel_plug-in</a><br><br>Stu</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br><span class="post-time small text-muted">17th September 2012 19:02 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">New version. Fixes self-deletion on Windows 7/8 32-bit.<br><br><a href="http://nsis.sourceforge.net/SelfDel_plug-in" target="_blank">http://nsis.sourceforge.net/SelfDel_plug-in</a><br><br>Stu</p></div><hr><div class="footer"><p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p></div></div><script src="../js/highlight.pack.js" type="text/javascript"></script><script type="text/javascript">//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]></script></body></html>