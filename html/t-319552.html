<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="Unattended Java install successful, files deleted after reboot" />

  <title>Unattended Java install successful, files deleted after reboot - NSIS Forums</title>
  <script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script>
  <!-- Bootstrap core CSS -->

  <link rel="stylesheet" type="text/css" href="//netdna.bootstrapcdn.com/bootswatch/3.0.1/readable/bootstrap.min.css" />
  <link rel="stylesheet" href="../css/style.css" type="text/css" /><!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!--[if lt IE 9]>
                <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
                <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->
</head>

<body>
  <div class="container">
    <!-- Put navigation bar here -->

    <ol class="breadcrumb">
      <li><a href="../index.html" class="glyphicon glyphicon-home"></a></li>

      <li><a href="f-65.html">NSIS Discussion</a></li>

      <li class="active">Unattended Java install successful, files deleted after reboot</li>
    </ol>

    <p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=319552">Unattended Java install successful, files deleted after reboot</a></p><br />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">brettw7</span><br />
      <span class="post-time small text-muted">31st May 2010 01:37 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>Unattended Java install successful, files deleted after reboot</strong><br />
      I'm experiencing a difficult to diagnose problem running an unattended install of Java SDK. The problem is really twofold.<br />
      <br />
      First problem. Sometimes the unattended Java install fails, but if I run the install a second time (in the same invocation of NSIS), it succeeds. I have actually put in "retry" code, which is a serious hack, like this:<br />
      <br />
      !ifdef WIN64<br />
      File "/oname=$TEMP\jdk1.6.0_18.exe" ..\..\..\Products\jdk-6u18-windows-x64.exe<br />
      !else<br />
      File "/oname=$TEMP\jdk1.6.0_18.exe" ..\..\..\Products\jdk-6u18-windows-i586.exe<br />
      !endif<br />
      # This copy files is a hack for Windows Server 2003<br />
      CopyFiles /silent "$TEMP\jdk1.6.0_18.exe" "$TEMP\java_install.exe"<br />
      ExecWait '"$TEMP\java_install.exe" /passive ADDLOCAL="ToolsFeature" IEXPLORER=0 MOZILLA=0 REBOOT=Suppress' $0<br />
      # This is also a hack for Windows Server 2003<br />
      ${If} "$0" != "0"<br />
      DetailPrint "Java install returned $0"<br />
      ExecWait '"$TEMP\java_install.exe" /passive ADDLOCAL="ToolsFeature" IEXPLORER=0 MOZILLA=0 REBOOT=Suppress' $0<br />
      DetailPrint "Second Java install returned $0"<br />
      ${EndIf}<br />
      <br />
      Sometimes the first install exits prematurely and a non-zero exit code is returned (and the installation of Java is indeed "partial"). However, the second invocation (of the same installer) invariably succeeds.<br />
      <br />
      I am curious if anyone has any clues as to why this happens?<br />
      <br />
      Secondly, and more serious and mysterious to me is:<br />
      <br />
      On Windows 2008 after installation, our Java server -- run as a service -- successfully starts. It can be stopped and started at will. However, [on some systems] after a reboot of Windows 2008, some of the Java files (rt.jar among them) in the Java SDK installation have been deleted and the service will no longer start. It's as if these files were "rolled back" or removed by Windows.<br />
      <br />
      Does anyone have any clues as to why this might happen?<br />
      <br />
      Regards</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
      <span class="post-time small text-muted">3rd June 2010 12:17 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Firstly I would identify a machine which you can reproduce the problem on and run the Java silent install manually. You should also get in contact with Sun regarding this problem. I don't think NSIS is at fault here.<br />
      <br />
      Also why do you have to extract as jdk1.6.0_18.exe and then copy to java_install.exe? Why not just extract as java_install.exe in the first place?<br />
      <br />
      Stu</p>
    </div>
    <hr />

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]>
  </script>
</body>
</html>
