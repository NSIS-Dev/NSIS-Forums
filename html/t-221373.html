<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="ExecWait doesn't work" />

  <title>ExecWait doesn't work - NSIS Forums</title><!-- Bootstrap core CSS -->
  <link rel="stylesheet" type="text/css" href="//netdna.bootstrapcdn.com/bootswatch/3.0.1/readable/bootstrap.min.css" />
  <link rel="stylesheet" href="../css/style.css" type="text/css" /><!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!--[if lt IE 9]>
                <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
                <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->
</head>

<body>
  <div class="container">
    <!-- Put navigation bar here -->

    <ol class="breadcrumb">
      <li><a href="../index.html" class="glyphicon glyphicon-home"></a></li>

      <li><a href="f-65.html">NSIS Discussion</a></li>

      <li class="active">ExecWait doesn't work</li>
    </ol>

    <p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=221373">ExecWait doesn't work</a></p><br />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">stefano7625</span><br />
      <span class="post-time small text-muted">13th July 2005 18:11 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>ExecWait doesn't work</strong><br />
      Hi People!<br />
      <br />
      I have a problem with more instance of ExecWait.<br />
      I have tried to execute this code:<br />
      -------------------------------------<br />
      !define APP_NAME "Pippo"<br />
      Name "${APP_NAME} Test"<br />
      OutFile "${APP_NAME}.exe"<br />
      InstallDir $PROGRAMFILES\${APP_NAME}<br />
      !include "MUI.nsh"<br />
      !insertmacro MUI_LANGUAGE "English"<br />
      <br />
      Section "Dummy Section " SecDummy<br />
      <br />
      SetOutPath "$EXEDIR\Pluto"<br />
      File Prova.bat<br />
      ExecWait '"mysql\setup.exe"'<br />
      <br />
      SetOutPath "$EXEDIR"<br />
      ExecWait '"Prova.bat"'<br />
      MessageBox MB_OK "Error"<br />
      <br />
      SectionEnd<br />
      -------------------------------------<br />
      <br />
      The problem is this:<br />
      <br />
      The second execution of ExecWait starts before that first execution of ExecWait ends.<br />
      <br />
      I'd be very pleased if somebody could help me!<br />
      <br />
      Best regards,<br />
      <br />
      -- Stefano</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">DennisFeiock</span><br />
      <span class="post-time small text-muted">13th July 2005 21:41 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">I have seen this before myself. Most of the NSIS installers I make are just wrappers for other installs...<br />
      <br />
      What that setup.exe probably does is extract itself out somewhere to an msi, some ini files, instmsia.exe, and instmsiw.exe.<br />
      <br />
      So as soon as the setup.exe has completed extracting those out, it runs the msi for the install your trying to run and closes the setup.exe.<br />
      <br />
      So NSIS sees that setup.exe has ended, and goes on to the next step.<br />
      <br />
      What you need to do is hunt around for any files that the setup.exe extracts, and call your ExecWait on those. You might have to figure out what switches are needed. (/qn, /qr, any transforms and such for msi's)<br />
      <br />
      Hope this helps you<br />
      - DF</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
      <span class="post-time small text-muted">13th July 2005 23:19 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Sounds like you're trying to execute an InstallShield installer?<br />
      <br />
      <a href="http://forums.winamp.com/showthread.php?s=&amp;threadid=125550&amp;highlight=execwait+installshield" target="_blank">http://forums.winamp.com/showthread....+installshield</a><br />
      <br />
      -Stu</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">stefano7625</span><br />
      <span class="post-time small text-muted">14th July 2005 08:00 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Thanks for your responses.<br />
      <br />
      I have tried to do this instruction<br />
      <br />
      C:\Test\setup.exe /r /f"C:\Test\Setup.iss"<br />
      <br />
      that install program and produce Setup.iss file:<br />
      <br />
      [InstallShield Silent]<br />
      Version=v4.90.000<br />
      File=Response File<br />
      [DlgOrder]<br />
      Dlg0=SdWelcome-0<br />
      Count=5<br />
      Dlg1=SdShowInfoList-0<br />
      Dlg2=SdAskDestPath-0<br />
      Dlg3=SetupType-0<br />
      Dlg4=SdFinish-0<br />
      [SdWelcome-0]<br />
      Result=1<br />
      [SdShowInfoList-0]<br />
      Result=1<br />
      [SdAskDestPath-0]<br />
      szDir=C:\mysql<br />
      Result=1<br />
      [SetupType-0]<br />
      Result=301<br />
      szDir=<br />
      [Application]<br />
      Name=MySQL Servers and Clients 5.0.0a-alpha<br />
      Version=MySQL Servers and Clients 5.0.0a-alpha<br />
      Company=MySQL AB<br />
      [SdFinish-0]<br />
      Result=1<br />
      bOpt1=0<br />
      bOpt2=0<br />
      <br />
      When I try to execute silent installation in this way<br />
      <br />
      C:\Test\setup.exe /s<br />
      <br />
      it doesn't work. It produce a file Setup.log that contains:<br />
      <br />
      [InstallShield Silent]<br />
      Version=v4.90.000<br />
      File=Log File<br />
      [ResponseResult]<br />
      ResultCode=-3<br />
      <br />
      <br />
      ResultCode=-3 means<br />
      "Required data not found in the Setup.iss file"<br />
      <br />
      Anyone knows where I mistake?<br />
      <br />
      <br />
      -- Stefano</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">DennisFeiock</span><br />
      <span class="post-time small text-muted">14th July 2005 13:10 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">When you run the install like so:<br />
      setup.exe -r<br />
      <br />
      It will create an answer file called setup.iss in your Windows directory.<br />
      <br />
      You will need to copy the iss file out of there, and package it with your NSIS installer.<br />
      <br />
      Then, you will need to do something like this:<br />
      <br />
      ExecWait '"$INSTDIR\setup.exe" -s -f1 "$INSTDIR\setup.iss"'<br />
      <br />
      - DF</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
      <span class="post-time small text-muted">14th July 2005 17:31 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Did you read my post?<br />
      Try executing the setup with the /sms switch.<br />
      <br />
      -Stu</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">stefano7625</span><br />
      <span class="post-time small text-muted">15th July 2005 07:49 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">I have tried both solutions but they didn't work.<br />
      <br />
      1. ExecWait '"$INSTDIR\setup.exe" -s -f1 "$INSTDIR\setup.iss"'<br />
      <br />
      Are you sure that is $INSTDIR and not $EXEDIR?<br />
      <br />
      2. setup /sms (from command line)<br />
      <br />
      It launch install program but doesn't wait.<br />
      <br />
      <br />
      -- Stefano</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
      <span class="post-time small text-muted">15th July 2005 08:06 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">1. It depends where the installer is. If it's in the same folder as the current installer or in a subfolder, then you should use $EXEDIR.<br />
      <br />
      So this<br />
      ExecWait '"mysql\setup.exe"'<br />
      should really be<br />
      ExecWait '"$EXEDIR\mysql\setup.exe"'<br />
      just to be safe.<br />
      <br />
      You could also check this out:<br />
      <a href="http://forums.winamp.com/showthread.php?s=&amp;threadid=221310" target="_blank">http://forums.winamp.com/showthread....hreadid=221310</a><br />
      <br />
      He used "start /WAIT" (in command-prompt) which you could try using with nsExec::Exec.<br />
      <br />
      -Stu</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">stefano7625</span><br />
      <span class="post-time small text-muted">15th July 2005 08:40 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Here's the command that I tried:<br />
      <br />
      C:\Test\mysql&gt;start /WAIT /D"C:\Test" setup.exe /S "_?=C:\mysql"<br />
      <br />
      It produce setup.log with this contents:<br />
      <br />
      [InstallShield Silent]<br />
      Version=v4.90.000<br />
      File=Log File<br />
      [ResponseResult]<br />
      ResultCode=-3<br />
      <br />
      <br />
      -- Stefano</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
      <span class="post-time small text-muted">15th July 2005 09:03 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">You don't want to use "_?=C:\mysql" as that is for NSIS uninstallers only. /S will make the InstallShield installer run silently, so obviously if you do not want it to run in silent, don't use /S.<br />
      <br />
      -Stu</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">stefano7625</span><br />
      <span class="post-time small text-muted">15th July 2005 09:38 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">I tried with:<br />
      <br />
      1. C:\Test\mysql&gt;start /WAIT /D"C:\Test" setup.exe<br />
      <br />
      2. C:\Test\mysql&gt;start /WAIT /D"C:\Test" setup.exe "_?=C:\mysql"<br />
      <br />
      3. C:\Test\mysql&gt;start /WAIT setup.exe<br />
      <br />
      It doesn't work.<br />
      If I want to run silently installation, is this<br />
      <br />
      C:\Test\mysql&gt;start /WAIT /D"C:\Test" setup.exe /S<br />
      <br />
      the correct command? Why it doesn't work?<br />
      <br />
      -- Stefano</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
      <span class="post-time small text-muted">15th July 2005 10:16 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">I just found this page:<br />
      <a href="http://documentation.installshield.com/robo/projects/helplib/IHelpSetup_EXECmdLine.htm" target="_blank">http://documentation.installshield.c...EXECmdLine.htm</a><br />
      <br />
      Try "/s /w" (with ExecWait too if you like).<br />
      <br />
      If you use start, multiple parameters must be surrounded by quotes.<br />
      <br />
      -Stu</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">DennisFeiock</span><br />
      <span class="post-time small text-muted">15th July 2005 13:11 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">The error log that it is creating is because you arent specifing the answer file for the silent install. Or that would be my best guess at least...<br />
      <br />
      What does this do for you?<br />
      <br />
      C:\Test\mysql&gt;start /WAIT /D"C:\Test" setup.exe -s -f1 "C:\Test\setup.iss"<br />
      <br />
      Also, according to the documentation that Afrow UK linked to:<br />
      "For an InstallScript MSI project, the command Setup.exe /s runs the installation in silent mode, by default based on the responses contained in a response file called Setup.iss in the same directory (response files are created by running Setup.exe with the /r option)."<br />
      <br />
      The -f1 argument just lets you specify a different location for the ISS file.<br />
      <br />
      - DF</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">stefano7625</span><br />
      <span class="post-time small text-muted">15th July 2005 13:40 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">I have tried to execute command with "/s /w" but it doesn't work.<br />
      <br />
      Furthermore, this command:<br />
      <br />
      C:\Test\mysql&gt;start /WAIT /D"C:\Test" setup.exe -s -f1 "C:\Test\setup.iss"<br />
      <br />
      produce setup.log that has the same content already specified.<br />
      <br />
      <br />
      -- Stefano</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
      <span class="post-time small text-muted">15th July 2005 17:40 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">START /? will tell you that [parameters] are one parameter for START seperated by quotes.<br />
      <br />
      And so,<br />
      C:\Test\mysql&gt;start /WAIT /D"C:\Test" setup.exe "-s -f1 C:\Test\setup.iss"<br />
      <br />
      -Stu</p>
    </div>
    <hr />

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]>
  </script>
</body>
</html>
