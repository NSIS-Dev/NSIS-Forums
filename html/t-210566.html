<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="Reading the last line of a file on successfull Java Install" />

  <title>Reading the last line of a file on successfull Java Install - NSIS Forums</title><!-- Bootstrap core CSS -->
  <link rel="stylesheet" type="text/css" href="//netdna.bootstrapcdn.com/bootswatch/3.0.1/readable/bootstrap.min.css" />
  <link rel="stylesheet" href="../css/style.css" type="text/css" /><!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!--[if lt IE 9]>
                <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
                <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->
</head>

<body>
  <div class="container">
    <!-- Put navigation bar here -->

    <ol class="breadcrumb">
      <li><a href="../index.html" class="glyphicon glyphicon-home"></a></li>

      <li><a href="f-65.html">NSIS Discussion</a></li>

      <li class="active">Reading the last line of a file on successfull Java Install</li>
    </ol>

    <p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=210566">Reading the last line of a file on successfull Java Install</a></p><br />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">0x539</span><br />
      <span class="post-time small text-muted">16th March 2005 10:09 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>Reading the last line of a file on successfull Java Install</strong><br />
      Hi<br />
      <br />
      I'm try to write a script that will automatically install Java if needed. So far I'm detecting through the registry what version of java is installed and downloading it if appropriate. My problem comes in that I don't know how to tell whether it has been successfully installed if need be. At the moment I've got it writing a log file for the install. What I want to do is parse the log file to get the last line which looks like this...<br />
      <br />
      "MSI (s) (98:58): Product: Java 2 Runtime Environment, SE v1.4.2_06 -- Installation operation completed successfully."<br />
      <br />
      I then want to use the StrStr function in the manual to look for the string "Installation operation completed successfully"<br />
      <br />
      My read-the-last-line function looks like this...<br />
      <br />
      Function ReadLastLine<br />
      ClearErrors<br />
      FileOpen $0 "setup.log" "r"<br />
      loop:<br />
      FileRead $0 $1 100<br />
      ;Dumpstate::debug<br />
      DetailPrint $1<br />
      IfErrors done<br />
      Goto loop<br />
      done:<br />
      DetailPrint $1<br />
      FileClose $0<br />
      Push $1<br />
      FunctionEnd<br />
      <br />
      It doesn't matter what I put for the max length, it always only reads in one character from the file.<br />
      <br />
      I'd be grateful for any help.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Takhir</span><br />
      <span class="post-time small text-muted">16th March 2005 11:33 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">May be installer's exit code also can help (MSI in your case), ExecWait sets user' variable with this value.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Instructor</span><br />
      <span class="post-time small text-muted">16th March 2005 17:10 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Function LineRead<br />
      <a href="http://nsis.sourceforge.net/archive/nsisweb.php?page=620&amp;instances=0,11,311" target="_blank">http://nsis.sourceforge.net/archive/...ances=0,11,311</a></p>
    </div>
    <hr />

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]>
  </script>
</body>
</html>
