<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="Conditional standard pages" />

  <title>Conditional standard pages - NSIS Forums</title><!-- Bootstrap core CSS -->
  <link rel="stylesheet" type="text/css" href="//netdna.bootstrapcdn.com/bootswatch/3.0.1/readable/bootstrap.min.css" />
  <link rel="stylesheet" href="../css/style.css" type="text/css" /><!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!--[if lt IE 9]>
                <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
                <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->
</head>

<body>
  <div class="container">
    <!-- Put navigation bar here -->

    <ol class="breadcrumb">
      <li><a href="../index.html" class="glyphicon glyphicon-home"></a></li>

      <li><a href="f-65.html">NSIS Discussion</a></li>

      <li class="active">Conditional standard pages</li>
    </ol>

    <p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=305875">Conditional standard pages</a></p><br />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">sylvinhio</span><br />
      <span class="post-time small text-muted">30th April 2009 13:50 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>Conditional standard (built-in) pages</strong><br />
      Hello,<br />
      <br />
      In my installer, I've got standard pages, and custom pages called like that:<br />
      <br />
      !insertmacro MUI_PAGE_WELCOME<br />
      Page Custom ChoixTypeInstall ChoixTypeInstallLeave " : Choix type installation"<br />
      Page Custom ChoixParamsInstall ChoixParamsInstallLeave " : ParamÃ¨tres d'installation de DOMEVIH"<br />
      Page Custom PgInstall PgInstallLeave " : ParamÃ¨tres d'installation de PostgreSQL"<br />
      Page Custom SavePassword SavePasswordLeave " : Connexion au serveur de base de donnÃ©es"<br />
      Page Custom ChoixInstallBase ChoixInstallBaseLeave " : Choix installation base"<br />
      !insertmacro MUI_PAGE_DIRECTORY<br />
      !insertmacro MUI_PAGE_STARTMENU Application $StartMenuGroup<br />
      !insertmacro MUI_PAGE_INSTFILES<br />
      Page Custom ChoixRep ChoixRepLeave " : SÃ©lection rÃ©pertoires"<br />
      !insertmacro MUI_PAGE_FINISH<br />
      <br />
      I wanted the standard page "!insertmacro MUI_PAGE_DIRECTORY" to be skipped" in certain conditions coming from my custom pages...<br />
      <br />
      How can I do ?</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Anders</span><br />
      <span class="post-time small text-muted">30th April 2009 15:34 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">call abort in the pre callback function to skip a page, read the MUI docs to find the name of the define to use</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">sylvinhio</span><br />
      <span class="post-time small text-muted">30th April 2009 15:38 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Whet do you mean using the terms "the define to use" ?<br />
      <br />
      Thanks a lot</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">sylvinhio</span><br />
      <span class="post-time small text-muted">30th April 2009 16:52 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">In fact, I want the page !insertmacro MUI_PAGE_DIRECTORY not being displayed at each time...<br />
      <br />
      And I didn't find anything on the doc...</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Anders</span><br />
      <span class="post-time small text-muted">30th April 2009 17:06 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">If you tried to RTFM, you would find MUI_PAGE_CUSTOMFUNCTION_PRE<br />
      <br />
      so:<br />
      function maybeAbort<br />
      ;maybe call abort here<br />
      functionEnd<br />
      <br />
      ...<br />
      page custom foo bar<br />
      !define MUI_PAGE_CUSTOMFUNCTION_PRE maybeAbort<br />
      !insertmacro MUI_PAGE_DIRECTORY</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">sylvinhio</span><br />
      <span class="post-time small text-muted">30th April 2009 18:03 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">I had found that example but didn't succes in trying it...<br />
      <br />
      I tried like that with your example (I need to skip these three files when the consition is not ok):<br />
      <br />
      !define MUI_PAGE_CUSTOMFUNCTION_PRE maybeAbort<br />
      !insertmacro MUI_PAGE_DIRECTORY<br />
      <br />
      !define MUI_PAGE_CUSTOMFUNCTION_PRE maybeAbort<br />
      !insertmacro MUI_PAGE_STARTMENU Application $StartMenuGroup<br />
      <br />
      !define MUI_PAGE_CUSTOMFUNCTION_PRE maybeAbort<br />
      !insertmacro MUI_PAGE_INSTFILES<br />
      <br />
      Page Custom MyPageFunction ""<br />
      <br />
      function maybeAbort<br />
      ${If} $Condition == "false"<br />
      Abort<br />
      ${EndIf}<br />
      functionEnd<br />
      <br />
      <br />
      The problem is that when the condition is not OK, my three pages are hidden, but I've got an empty page displayed before my last page (MyPageFunction).<br />
      <br />
      If I'm not using the INST_FILES page, that empty page is not displayed and I've got directly my last page :<br />
      <br />
      !define MUI_PAGE_CUSTOMFUNCTION_PRE maybeAbort<br />
      !insertmacro MUI_PAGE_DIRECTORY<br />
      <br />
      !define MUI_PAGE_CUSTOMFUNCTION_PRE maybeAbort<br />
      !insertmacro MUI_PAGE_STARTMENU Application $StartMenuGroup<br />
      <br />
      Page Custom MyPageFunction ""<br />
      <br />
      <br />
      <br />
      Maybe the INST_FILES page has a different behaviour than others... ?<br />
      <br />
      Thanks a lot for your help !!!</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
      <span class="post-time small text-muted">30th April 2009 19:16 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">What do you mean by an empty page exactly? Are you not creating a page with nsDialogs or InstallOptions in it yet?<br />
      <br />
      Stu</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">demiller9</span><br />
      <span class="post-time small text-muted">30th April 2009 23:28 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">sylvinhio, I think the INSTFILES page might act differently. I think you probably would not want to skip it because that page is the page that executes the Sections in your script and normally does the installation.<br />
      <br />
      Don</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">sylvinhio</span><br />
      <span class="post-time small text-muted">4th May 2009 09:12 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Hi,<br />
      <br />
      Thanks for your answers.<br />
      Effectively, I want to skip the INSTFILES page too, because in one case in my setup, I needn't to copy files, and treatments are done in previous pages (upadte config files, install framework, ...)<br />
      <br />
      So I don't want the INSTFILES page to be displayed.<br />
      And my problem, as I told you previously, is that when trying to skip the INSTFILES, I've got an empty page displayed, with only PREV, NEXT and CANCEL buttons displayed.<br />
      <br />
      Thanks for helping me</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">sylvinhio</span><br />
      <span class="post-time small text-muted">20th May 2009 09:43 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Hello,<br />
      <br />
      Is there any soluce to skip that empty page ?<br />
      <br />
      Thanks</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">justme123</span><br />
      <span class="post-time small text-muted">21st December 2009 16:52 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">i'm also seeing this behaviour. Anyone got an Idea how to solve it?<br />
      <br />
      I tried to use Abort in MUI_PAGE_CUSTOMFUNCTION_SHOW instead of PRE but it didn't work (kinda expected).<br />
      <br />
      Actually i don't want to skip the page completely but change the (sub)title labels if a condition is met(a variable tells if the installer is in 'install' or 'upgrade' mode). So i thought using 2 Versions of the page but showing only one would do the trick (this works for the finish page):<br /></p>
      <pre>
<code><br />!define MUI_PAGE_CUSTOMFUNCTION_PRE skipIfUpgrade<br />!define MUI_INSTFILESPAGE_FINISHHEADER_TEXT "Installation done"<br />!insertmacro MUI_PAGE_INSTFILES<br />!define MUI_PAGE_CUSTOMFUNCTION_PRE showIfUpgrade<br />!define MUI_INSTFILESPAGE_FINISHHEADER_TEXT "Upgrade done"<br />!insertmacro MUI_PAGE_INSTFILES<br /></code>
</pre><br />
      <br />
      but for instfiles it creates an additional empty page that requires a 'next' cklick to close it.<br />
      <br />
      using conditional defines in the pre funtion of a single instfiles page didn't work for me either :/
    </div>
    <hr />

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]>
  </script>
</body>
</html>
