<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="description" content="InstallOptions Modification"><title>InstallOptions Modification - NSIS Forums</title><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script><link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css"><link rel="stylesheet" href="../css/style.css" type="text/css"><!--[if lt IE 9]><script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script><script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script><![endif]--></head><body><div class="container"><ol class="breadcrumb"><li><a href="../index.html" class="glyphicon glyphicon-home"></a></li><li><a href="f-65.html">NSIS Discussion</a></li><li class="active">InstallOptions Modification</li></ol><p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=149731">InstallOptions Modification</a></p><br><div class="post"><p class="post-meta"><span class="post-author text-primary">dselkirk</span><br><span class="post-time small text-muted">19th September 2003 19:01 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>InstallOptions Modification</strong><br>Hey. I required certain functionality to a dialog so I modified the InstallOptions plugin to include the following.<br><br>Added Button support:<br>- will return the field name instead of success, back, etc.<br><br>Added Callback or Validation before the dialog closes:<br>- after calling the show method, call the clean method to close the dialog.<br><br>Added /TIMEOUT to allow data refresh:<br>- will return "timeout" instead of success, back, etc.<br><br>This was made more for my requirements but if you have a use for it, glad to hear. If anyone can see any problems or has any suggestions I would appreciate them.<br><br>Thanks</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Yathosho</span><br><span class="post-time small text-muted">19th September 2003 19:32 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">since i'm using beta 4 cvs, i have the following problem using installoptions. the script does not use modern ui!<br><br>when the components page is displayed, the captions say "$NAME Setup: Installtion Options", which should be displayed on the IO page instead. in beta 3 the page was called with <i>Page custom SetCustom ": Page Title"</i>. this does no longer work. is it my fault or is that a bug?</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">dselkirk</span><br><span class="post-time small text-muted">19th September 2003 19:58 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">try the following:<br>Page custom SetCustom "" ": Page Title"</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Yathosho</span><br><span class="post-time small text-muted">19th September 2003 20:07 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">it still appears on the components page, and it doesnt use my text (still Installation Options).</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Joost Verburg</span><br><span class="post-time small text-muted">19th September 2003 20:11 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Does a caption of a custom page appear on the components page? That's weird. Can you attach your script and a screenshot?</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">dselkirk</span><br><span class="post-time small text-muted">19th September 2003 20:16 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">not trying to call installoptions from within the the component page are you? Like this...<br><br>Page components CustomPage<br>Function CustomPage<br>installoptions::dialog "test.ini"<br>Pop $0<br>FunctionEnd</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Yathosho</span><br><span class="post-time small text-muted">19th September 2003 20:17 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">it is NO mui installer. this code is a template, in case you're wondering about thos ##'s.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">dselkirk</span><br><span class="post-time small text-muted">19th September 2003 20:23 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">when I compile it I get the component dialog with the title<br>"##PACKTITLE##CATALOGUE Setup: Install Options"<br>Then I get the custom dialog with this title<br>"##PACKTITLE##CATALOGUE Setup: Page Title"<br><br>Thats the way it should be</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Joost Verburg</span><br><span class="post-time small text-muted">19th September 2003 20:33 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Installation Options is the normal text for the component page (you can set options for the installation). This is not related to the InstallOptions plug-in.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Yathosho</span><br><span class="post-time small text-muted">19th September 2003 20:35 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">oh ok, so i was only confused by the terminology. anyway, the io page doesnt have that caption for me, its only "name setup".</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Yathosho</span><br><span class="post-time small text-muted">19th September 2003 21:40 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">works now</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">dselkirk</span><br><span class="post-time small text-muted">19th September 2003 21:44 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">good to hear</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">jfn</span><br><span class="post-time small text-muted">22nd September 2003 10:31 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">dselkirk<br><br>I would like to use your modified verstion of the InstallOptions plug-in.<br><br>Any change you could upload/attach an archive that contains the compiled dll too?<br><br>Thanks</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">dselkirk</span><br><span class="post-time small text-muted">22nd September 2003 13:37 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Here ya go.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br><span class="post-time small text-muted">22nd September 2003 18:50 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Any chance this code will get added to the official dll?<br>I think that <i>any</i> additions could be added...<br><br>Edit: BTW, the added Button support...<br>Does that allow to add another button, or just support on the current buttons?<br>I think it would be nice if we could add a clickable active button which would call an NSIS function...<br>E.g. add a "Settings" button on our IO page to call Function Settings, which would ExecWait another installer containing the settings dialog.<br><br>-Stu</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">dselkirk</span><br><span class="post-time small text-muted">22nd September 2003 20:13 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Fixed an offset issue with returning the appropriate button field name. Had to take in account the FileRequest and DirRequest types that have 2 controls.<br><br>Afrow UK: take a look ate test.nsi for an example.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">kichik</span><br><span class="post-time small text-muted">22nd September 2003 20:15 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">This modification will be reviewed and possibly merged after NSIS 2 comes out. I don't really want to add new features now, I want to concentrate on bug fixing and testing.<br><br>BTW, to validate before the page ends you can use the leave function.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">DOCa Cola</span><br><span class="post-time small text-muted">23rd September 2003 16:53 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"></p><blockquote><i>Originally posted by kichik</i><br><b>I don't really want to add new features now, I want to concentrate on bug fixing and testing.</b></blockquote>That means no integrated 7-zip support before nsis 2 release?</div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">kichik</span><br><span class="post-time small text-muted">23rd September 2003 17:15 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">It's already in progress so it won't stop now.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">deguix</span><br><span class="post-time small text-muted">1st October 2003 01:01 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Have a bug with this modification:<br><br>I used it in my installer as a page. After going to the page with your InstallOptions, going a page back (Start Menu) and returning again, it doesn't show the page anymore. Tried everything but it continues. Maybe I can put a screenshot here but not now. Thanks for a great modificated InstallOptions!</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">dselkirk</span><br><span class="post-time small text-muted">1st October 2003 02:06 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">are you calling InstallOptions::clean before you go back?</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">deguix</span><br><span class="post-time small text-muted">3rd October 2003 00:34 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Yes.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">eccles</span><br><span class="post-time small text-muted">5th December 2003 22:28 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">The standard InstallOptions in the latest NSIS development version now supports most of these features (all except the timeout idea). It has been done slightly differently but the effect is the same.<br><br>See the latest InstallOptions documentation and the new testnotify.nsi example script for all the juicy details!</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">dselkirk</span><br><span class="post-time small text-muted">7th December 2003 21:30 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Great work!</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">flizebogen</span><br><span class="post-time small text-muted">8th December 2003 12:16 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">I tested the new version by using the new examples. I've only a small question. What kind of SendMessage Parameter can enable/disable a checkbox?</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">kichik</span><br><span class="post-time small text-muted">8th December 2003 12:45 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">You can't do that with messages. For that you need the EnalbeWindow Win32 API function which is also available as a script instruction. TestNotify.nsi example shows how to use it.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">flizebogen</span><br><span class="post-time small text-muted">8th December 2003 13:37 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">works like a charm. I've two more questions:<br><br>1. How can i change the state of a checkbox? Using WriteIniStr doesn't - probably because IO doesn't re-read the ini file.<br><br>2. I have a input Field with the following settings:<br><br>[Field 5]<br>Type=Text<br>Left=20<br>Right=50<br>Top=80<br>Bottom=95<br>MinLen=3<br>MaxLen=3<br>Flags=ONLY_NUMBERS<br><br>If i don't use the leave page the input is checked. I.e. you can't continue until the length requirements are met. But if i use a leave page the input isn't checked. Any reasons?</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">kichik</span><br><span class="post-time small text-muted">8th December 2003 14:08 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"></p><ol style="list-style-type: decimal"><li>Use <a href="http://msdn.microsoft.com/library/en-us/shellcc/platform/commctls/buttons/buttonreference/buttonmessages/bm_setcheck.asp" target="_blank">BM_SETCHECK</a> (!define BM_SETCHECK 0x00F1)</li><li>The validation function was called after the leave function. Thanks, fixed.</li></ol></div><hr><div class="footer"><p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p></div></div><script src="../js/highlight.pack.js" type="text/javascript"></script><script type="text/javascript">//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]></script></body></html>