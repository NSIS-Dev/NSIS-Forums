<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="description" content="Behavior of installation directory selection dialog"><title>Behavior of installation directory selection dialog - NSIS Forums</title><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script><link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css"><link rel="stylesheet" href="../css/style.css" type="text/css"></head><body><div class="container"><ol class="breadcrumb"><li><a href="../index.html" class="glyphicon glyphicon-home"></a></li><li><a href="f-65.html">NSIS Discussion</a></li><li class="active">Behavior of installation directory selection dialog</li></ol><p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=300815">Behavior of installation directory selection dialog</a></p><br><div class="post"><p class="post-meta"><span class="post-author text-primary">froesccn</span><br><span class="post-time small text-muted">8th December 2008 10:36 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>Behavior of installation directory selection dialog</strong><br>It seems that MUI_PAGE_DIRECTORY always appends "SOMELASTDIR" to the selected path if the default INSTDIR was set to something like "SOMEPATH\SOMELASTDIR". Is there an option to suppress this? I suppose it is a safety precaution for those uninstallers which dare to call<br>"RMDir /r $INSTDIR",<br>but I'd really like to pick any directory name.<br><br>Of course, I could always process the string later, but then I have to be very careful that the selected INSTDIR is different from the default INSTDIR, otherwise nothing may be removed (and with things like UNC and short file names you never feel quite confident that the same string will be returned for the same path).<br><br>Also, when the dialog appends SOMELASTDIR to the selection, it would be more logical if the initial directory selection when opening the dialog would be SOMEPATH, not SOMEPATH\SOMELASTDIR.<br><br>Furthermore, when a path is selected which is different from the default INSTDIR, and the user clicks "Browse" again, the initial directory seems to be wrong (I get My Documents).<br><br>Finally, if the user is logged in with a normal account but starts the installer with "Run As ..." to get administrator privileges, the dialog does not get updated when a new folder is created or renamed in the dialog. But this is probably an issue of the system dialog (tested on W2K SP4 and XP SP3).</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">kichik</span><br><span class="post-time small text-muted">8th December 2008 11:13 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Append a backslash to InstallDir.</p><pre>
<code>InstallDir "$PROGRAMFILES\NSIS<b>\</b>"</code>
</pre></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">froesccn</span><br><span class="post-time small text-muted">8th December 2008 13:38 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Thank you, this works. I was looking into the documentation<br>for MUI, it didn't occur to me to search for this special<br>behavior under InstallDir, especially as I do my own<br>initialization of $INSTDIR in onInit.<br><br>It's a bit confusing, am I correct in assuming that<br>$INSTDIR will never end with "\" even if InstallDir<br>ends with "\"? Is InstallDir handled differently<br>from StrCpy $INSTDIR "..."?</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">kichik</span><br><span class="post-time small text-muted">8th December 2008 20:15 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">$INSTDIR can never end with a backslash, no matter how you set it. This is to make sure it always points to a valid path.</p></div><hr><div class="footer"><p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p></div></div><script src="../js/highlight.pack.js" type="text/javascript"></script><script type="text/javascript">//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]></script></body></html>