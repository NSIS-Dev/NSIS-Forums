<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="start menu alignment" />

  <title>start menu alignment - NSIS Forums</title><!-- Bootstrap core CSS -->
  <link rel="stylesheet" type="text/css" href="//netdna.bootstrapcdn.com/bootswatch/3.0.1/readable/bootstrap.min.css" />
  <link rel="stylesheet" href="../css/style.css" type="text/css" /><!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!--[if lt IE 9]>
                <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
                <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->
</head>

<body>
  <div class="container">
    <!-- Put navigation bar here -->

    <ol class="breadcrumb">
      <li><a href="../index.html" class="glyphicon glyphicon-home"></a></li>

      <li><a href="f-65.html">NSIS Discussion</a></li>

      <li class="active">start menu alignment</li>
    </ol>

    <p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=228143">start menu alignment</a></p><br />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">tlalit</span><br />
      <span class="post-time small text-muted">11th October 2005 10:37 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>start menu alignment</strong><br />
      Hi,<br />
      I'm using the Modern UI Language files everything looks align in the right way (RTL) except for the alignment to right text in hebrew in the start menu, when I'm using mixed text (hebrew and english) it's show's in the wrong order (not align to the right), is there a way to fix that?</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
      <span class="post-time small text-muted">11th October 2005 12:11 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">It works just fine for me. What OS are you using? Can you attach an example script?</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">tlalit</span><br />
      <span class="post-time small text-muted">11th October 2005 12:50 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">the script is:<br />
      strcpy $TM_UNINSTALLER_LINK "úåñó outlook ùì çáøä"<br />
      !insertmacro MUI_STARTMENU_WRITE_BEGIN "Application"<br />
      SetShellVarContext All<br />
      CreateDirectory "$SMPROGRAMS\$STARTMENU_FOLDER"<br />
      CreateShortCut "$SMPROGRAMS\$STARTMENU_FOLDER\$TM_UNINSTALLER_LINK.lnk" "$INSTDIR\uninst-tmOutlookPlugin.exe"<br />
      SetShellVarContext Current<br />
      !insertmacro MUI_STARTMENU_WRITE_END<br />
      <br />
      <br />
      but when I open the start menu (after installation) it's not aligned, I'm using winXP (english)</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
      <span class="post-time small text-muted">11th October 2005 13:26 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Ah, the start menu... I thought you were talking about the start menu page in the installer itself.<br />
      <br />
      You can insert an RLE (Right-to-Left Embedding) sign at the beginning of the name. However, NSIS doesn't support Unicode natively, so the System plug-in would have to be used. Attached is an example that creates a shortcut with the RLE mark.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">tlalit</span><br />
      <span class="post-time small text-muted">11th October 2005 14:30 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">can you please explain to me what each line of the "System::Call" do?<br />
      I'm trying to merge it to my code, but I don't seem to get the desire result.<br />
      <br />
      Thanks,<br />
      Tali</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
      <span class="post-time small text-muted">11th October 2005 14:45 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">I've added some comments to the example. Basically, the example creates a temporary shortcut and renames it to the desired name with the RLE mark. To rename, it creates a Unicode buffer, appends $SMPROGRAMS, the RLE mark and the desired shortcut name. It then passes this buffer to MoveFileW in order to rename the temporary shortcut to the desired name.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">tlalit</span><br />
      <span class="post-time small text-muted">11th October 2005 17:36 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">can you please tell me what's wrong with this script?<br />
      instead of CreateShortcut I wrote CreateDirectory<br />
      (because I need to align the startMenu folderName<br />
      !insertmacro MUI_PAGE_STARTMENU "Application" $STARTMENU_FOLDER)</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
      <span class="post-time small text-muted">11th October 2005 17:56 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Oish, what a stupid mistake. The RLE wasn't written when I added the comments because the comment of the line above ends with a backslash. That causes the line that appends the RLE to be appended to the line above and be considered as a comment. Simply remove the backslash from the end of the of line or add another character after it and it will work.<br />
      <br />
      I really must do something about this extended comment... :(</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">tlalit</span><br />
      <span class="post-time small text-muted">16th October 2005 12:57 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">HI,<br />
      <br />
      first of all - Thanks for the quick answers...<br />
      I manage doing the shortcuts, but now I have a problem with the directory ubder the SMPROGRAMS...<br />
      I think I need to append the RLE to the $STARTMENU_FOLDER variable, because every time I'm adding a link under $SMPROGRAMS\$STARTMENU_FOLDER\ its not added to the RLE FolderName, so I'm having two folders under StartMenu - 1 - RLE (and empty) and the other is not RLE (with shortcuts).<br />
      this is exapmle of the shortcut created under the wrong folder:<br />
      <br />
      CreateShortcut "$SMPROGRAMS\$STARTMENU_FOLDER\temp.lnk" "$INSTDIR\uninst-tmOutlookPlugin.exe"<br />
      System::Call "*(&amp;w2048 '$SMPROGRAMS\$STARTMENU_FOLDER\') i .r0"<br />
      System::Call "kernel32::lstrcatW(i r0, *i 0x202b)"<br />
      System::Call "kernel32::lstrcatW(i r0, w '$TM_UNINSTALLER_LINK.lnk')"<br />
      System::Call "kernel32::DeleteFileW(i r0)"<br />
      System::Call "kernel32::MoveFileW(w '$SMPROGRAMS\$STARTMENU_FOLDER\temp.lnk', i r0)"<br />
      System::Free $0</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
      <span class="post-time small text-muted">16th October 2005 13:07 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">You can't use the RLE mark in $STARTMENU_FOLDER because NSIS doesn't support Unicode. It'd be simpler to first create everything and then adding the RLE mark. Instead of creating temp.lnk, create the correct structure, including all the folders and the links, and only then add the RLE mark where needed.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">tlalit</span><br />
      <span class="post-time small text-muted">16th October 2005 18:35 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">after making the RLE link I have new problem:<br />
      when deleting the startMenu folder (uninstall section) there are leftovers of the link that was changed to be RLE, but all other links were remove.<br />
      <br />
      this is the code (it worked before):<br />
      SetShellVarContext All<br />
      !insertmacro MUI_STARTMENU_GETFOLDER "Application" $R0<br />
      RMDir /r "$SMPROGRAMS\$R0"<br />
      SetShellVarContext Current</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
      <span class="post-time small text-muted">16th October 2005 18:40 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">The name is different now, it contains the RLE mark. You'd need to a similar method to delete the files. The code that I've posted deletes the link before it renames the temporary one. You can use the exact same code, removing just the MoveFileW call.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">tlalit</span><br />
      <span class="post-time small text-muted">17th October 2005 09:09 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Thank you very much - it helped...<br />
      have happy holidays.</p>
    </div>
    <hr />

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]>
  </script>
</body>
</html>
