<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="description" content="Win Xp $SYSDIR fails but full path OK"><title>Win Xp $SYSDIR fails but full path OK - NSIS Forums</title><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script><link rel="preload" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css" as="style" onload="this.rel='stylesheet'"><link rel="preload" href="../css/style.css" as="style" onload="this.rel='stylesheet'"><noscript><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css"><link rel="stylesheet" href="../css/style.css"></noscript><script>!function(a){"use strict";var b=function(b,c,d){function e(a){return h.body?a():void setTimeout(function(){e(a)})}function f(){i.addEventListener&&i.removeEventListener("load",f),i.media=d||"all"}var g,h=a.document,i=h.createElement("link");if(c)g=c;else{var j=(h.body||h.getElementsByTagName("head")[0]).childNodes;g=j[j.length-1]}var k=h.styleSheets;i.rel="stylesheet",i.href=b,i.media="only x",e(function(){g.parentNode.insertBefore(i,c?g:g.nextSibling)});var l=function(a){for(var b=i.href,c=k.length;c--;)if(k[c].href===b)return a();setTimeout(function(){l(a)})};return i.addEventListener&&i.addEventListener("load",f),i.onloadcssdefined=l,l(f),i};"undefined"!=typeof exports?exports.loadCSS=b:a.loadCSS=b}("undefined"!=typeof global?global:this);!function(a){if(a.loadCSS){var b=loadCSS.relpreload={};if(b.support=function(){try{return a.document.createElement("link").relList.supports("preload")}catch(b){return!1}},b.poly=function(){for(var b=a.document.getElementsByTagName("link"),c=0;c<b.length;c++){var d=b[c];"preload"===d.rel&&"style"===d.getAttribute("as")&&(a.loadCSS(d.href,d,d.getAttribute("media")),d.rel=null)}},!b.support()){b.poly();var c=a.setInterval(b.poly,300);a.addEventListener&&a.addEventListener("load",function(){b.poly(),a.clearInterval(c)}),a.attachEvent&&a.attachEvent("onload",function(){a.clearInterval(c)})}}}(this);</script></head><body><div class="container"><ol class="breadcrumb"><li><a href="../index.html" class="glyphicon glyphicon-home"></a></li><li><a href="f-65.html">NSIS Discussion</a></li><li class="active">Win Xp $SYSDIR fails but full path OK</li></ol><p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=339324">Win Xp $SYSDIR fails but full path OK</a></p><br><div class="post"><p class="post-meta"><span class="post-author text-primary">mshsrfc</span><br><span class="post-time small text-muted">13th December 2011 15:06 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>Win Xp $SYSDIR fails but full path OK</strong><br>Hi<br><br>I have just started usiing NSIS and all going well with main files until I tried to use<br>$SYSDIR for 2 files in the System32 folder.<br><br><br>SetOutPath "$SYSDIR"<br>StrCpy $INSTDIR $SYSDIR<br>File "$INSTDIR\CNTRL32.dll"<br><br>Got compile error below :-<br><br>File: "$INSTDIR\CNTRL32.dll" -&gt; no files found.<br>Usage: File [/nonfatal] [/a] ([/r] [/x filespec [...]] filespec [...] |<br>/oname=outfile one_file_only)<br>Error in script "C:\Program Files\ITP\DevaMC2008.nsi" on line 77 -- aborting creation process<br><br><br>Used a message box to output $SYSDIR and got :-<br><br>c:\windows\system32<br><br>Replaced $INSTDIR with full path as below and got no complie errors and<br>the file is installed correctly.<br><br>SetOutPath "$SYSDIR"<br>StrCpy $INSTDIR $SYSDIR<br>File "c:\windows\system32\CNTRL32.dll"<br><br>I have searched the net and this forum but no solution, has anyone got any ideas?<br><br>Full nsi file below<br><br>Mike<br><br>Command line:<br>"C:\Program Files\NSIS\makensis.exe" /NOTIFYHWND 132394 "C:\Program Files\ITP\DevaMC2008.nsi"<br><br>MakeNSIS v2.46 - Copyright 1995-2009 Contributors<br>See the file COPYING for license details.<br>Credits can be found in the Users Manual.<br><br>Processing config:<br>Processing plugin dlls: "C:\Program Files\NSIS\Plugins\*.dll"<br>- AdvSplash::show<br>- Banner::destroy<br>- Banner::getWindow<br>- Banner::show<br>- BgImage::AddImage<br>- BgImage::AddText<br>- BgImage::Clear<br>- BgImage::Destroy<br>- BgImage::Redraw<br>- BgImage::SetBg<br>- BgImage::SetReturn<br>- BgImage::Sound<br>- Dialer::AttemptConnect<br>- Dialer::AutodialHangup<br>- Dialer::AutodialOnline<br>- Dialer::AutodialUnattended<br>- Dialer::GetConnectedState<br>- InstallOptions::dialog<br>- InstallOptions::initDialog<br>- InstallOptions::show<br>- LangDLL::LangDialog<br>- Math::Script<br>- NSISdl::download<br>- NSISdl::download_quiet<br>- Splash::show<br>- StartMenu::Init<br>- StartMenu::Select<br>- StartMenu::Show<br>- System::Alloc<br>- System::Call<br>- System::Copy<br>- System::Free<br>- System::Get<br>- System::Int64Op<br>- System::Store<br>- TypeLib::GetLibVersion<br>- TypeLib::Register<br>- TypeLib::UnRegister<br>- UserInfo::GetAccountType<br>- UserInfo::GetName<br>- UserInfo::GetOriginalAccountType<br>- VPatch::GetFileCRC32<br>- VPatch::GetFileMD5<br>- VPatch::vpatchfile<br>- nsDialogs::Create<br>- nsDialogs::CreateControl<br>- nsDialogs::CreateItem<br>- nsDialogs::CreateTimer<br>- nsDialogs::GetUserData<br>- nsDialogs::KillTimer<br>- nsDialogs::OnBack<br>- nsDialogs::OnChange<br>- nsDialogs::OnClick<br>- nsDialogs::OnNotify<br>- nsDialogs::SelectFileDialog<br>- nsDialogs::SelectFolderDialog<br>- nsDialogs::SetRTL<br>- nsDialogs::SetUserData<br>- nsDialogs::Show<br>- nsExec::Exec<br>- nsExec::ExecToLog<br>- nsExec::ExecToStack<br><br>!define: "MUI_INSERT_NSISCONF"=""<br><br>Changing directory to: "C:\Program Files\ITP"<br><br>Processing script file: "C:\Program Files\ITP\DevaMC2008.nsi"<br>!define: "PRODUCT_NAME"="DevaMC2008"<br>!define: "PRODUCT_VERSION"="11.12.8"<br>!define: "PRODUCT_PUBLISHER"="ITP Group"<br>!define: "PRODUCT_WEB_SITE"="http://www.itpgroup.co.uk"<br>!define: "PRODUCT_DIR_REGKEY"="Software\Microsoft\Windows\CurrentVersion\App Paths\DevaMC2008.exe"<br>!include: "C:\Program Files\NSIS\Include\Library.nsh"<br>!include: closed: "C:\Program Files\NSIS\Include\Library.nsh"<br>!include: "C:\Program Files\NSIS\Include\UpgradeDLL.nsh"<br>!define: "UPGRADEDLL_INCLUDED"=""<br>!include: closed: "C:\Program Files\NSIS\Include\UpgradeDLL.nsh"<br>!include: "C:\Program Files\NSIS\Include\MUI2.nsh"<br>!include: "C:\Program Files\NSIS\Contrib\Modern UI 2\MUI2.nsh"<br>NSIS Modern User Interface version 2.0 - Copyright 2002-2009 Joost Verburg (C:\Program Files\NSIS\Contrib\Modern UI 2\MUI2.nsh:8)<br>!define: "MUI_INCLUDED"=""<br>!define: "MUI_SYSVERSION"="2.0"<br>!define: "MUI_VERBOSE"="3"<br>!include: closed: "C:\Program Files\NSIS\Contrib\Modern UI 2\MUI2.nsh"<br>!include: closed: "C:\Program Files\NSIS\Include\MUI2.nsh"<br>!define: "MUI_ABORTWARNING"=""<br>!define: "MUI_ICON"="..\..\AxelRelease\icon00.ico"<br>!insertmacro: MUI_PAGE_WELCOME<br>!insertmacro: end of MUI_PAGE_WELCOME<br>!insertmacro: MUI_PAGE_LICENSE<br>!insertmacro: end of MUI_PAGEDECLARATION_LICENSE<br>!insertmacro: end of MUI_PAGE_LICENSE<br>!insertmacro: MUI_PAGE_COMPONENTS<br>!insertmacro: end of MUI_PAGE_COMPONENTS<br>!insertmacro: MUI_PAGE_INSTFILES<br>!insertmacro: end of MUI_PAGE_INSTFILES<br>!define: "MUI_FINISHPAGE_RUN"="$INSTDIR\DevaMC2008.exe"<br>!insertmacro: MUI_PAGE_FINISH<br>!insertmacro: end of MUI_PAGE_FINISH<br>!insertmacro: MUI_LANGUAGE<br>!insertmacro: end of MUI_LANGUAGE<br>Name: "DevaMC2008 11.12.8"<br>OutFile: "C:\AxelRelease\extra32\interface\ITPDEVAMC2008\SetupDevaMC.exe"<br>InstallDir: "$PROGRAMFILES\itp"<br>InstallRegKey: "HKLM\Software\Microsoft\Windows\CurrentVersion\App Paths\DevaMC2008.exe\"<br>ShowInstDetails: show<br>Section: "MainSection" -&gt;(SEC01)<br>SetShellVarContext: all<br>Var: "HKLM_ITP"<br>Var: "SERIAL_NUMBER"<br>Var: "INI_PATH"<br>StrCpy $HKLM_ITP "Software\ITP Group" () ()<br>ReadRegStr $SERIAL_NUMBER HKLM\$HKLM_ITP\Serial Number<br>StrCpy $INI_PATH "$INSTDIR\$SERIAL_NUMBER" () ()<br>SetOutPath: "$INSTDIR"<br>SetOverwrite: ifnewer<br>File: "DevaMC2008.exe" [compress] 922556/3139584 bytes<br>CreateDirectory: "$SMPROGRAMS\ITP Group"<br>CreateShortCut: "$SMPROGRAMS\ITP Group\DevaMC2008.lnk"-&gt;"$INSTDIR\DevaMC2008.exe" icon:,0, showmode=0x0, hotkey=0x0, comment=<br>CreateShortCut: "$DESKTOP\DevaMC2008.lnk"-&gt;"$INSTDIR\DevaMC2008.exe" icon:,0, showmode=0x0, hotkey=0x0, comment=<br>SetOutPath: "$INSTDIR\Help\DevaMC2008"<br>File: "DevaMC2008-CN.chm" [compress] 688402/694995 bytes<br>File: "DevaMC2008-EN.chm" [compress] 1197352/1203204 bytes<br>SetOutPath: "$INSTDIR\Lang\DevaMC"<br>File: "DevaMC2008_English.txt" [compress] 5403/25820 bytes<br>File: "DevaMC2008_Chinese.txt" [compress] 5429/19546 bytes<br>SetOutPath: "$INSTDIR"<br>File: "XpiEditor.exe" [compress] 69996/168960 bytes<br>CreateShortCut: "$SMPROGRAMS\ITP Group\XpiEditor.lnk"-&gt;"$INSTDIR\XpiEditor.exe" icon:,0, showmode=0x0, hotkey=0x0, comment=<br>File: "FifoPlot.exe" [compress] 31141/94208 bytes<br>File: "PMD-1208-FS.EXE" [compress] 263063/819200 bytes<br>File: "PMD_1208_FS.chm" [compress] 189887/197675 bytes<br>CreateShortCut: "$SMPROGRAMS\ITP Group\PMD-1208-FS.lnk"-&gt;"$INSTDIR\PMD-1208-FS.exe" icon:,0, showmode=0x0, hotkey=0x0, comment=<br>File: "PMDZERO.exe" [compress] 8029/24576 bytes<br>CreateShortCut: "$SMPROGRAMS\Startup\PMDZERO.lnk"-&gt;"$INSTDIR\PMDZERO.exe" icon:,0, showmode=0x0, hotkey=0x0, comment=<br>SetOutPath: "$SYSDIR"<br>StrCpy $INSTDIR "$SYSDIR" () ()<br>File: "$INSTDIR\CNTRL32.dll" -&gt; no files found.<br>Usage: File [/nonfatal] [/a] ([/r] [/x filespec [...]] filespec [...] |<br>/oname=outfile one_file_only)<br>Error in script "C:\Program Files\ITP\DevaMC2008.nsi" on line 77 -- aborting creation process</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">MSG</span><br><span class="post-time small text-muted">13th December 2011 17:44 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Please either use pastebin or an attachment to share huge amounts of code.<br><br>Your mistake is simple: $SYSDIR and $INSTDIR are runtime variables. The File command is a compiletime command, so $SYSDIR and $INSTDIR do not have any value yet. The path parameter of File should point at where the file is on your development computer, not on the computer of whoever will be running your installer.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Anders</span><br><span class="post-time small text-muted">13th December 2011 20:37 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Use $%windir%</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">mshsrfc</span><br><span class="post-time small text-muted">15th December 2011 11:23 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Thanks Anders<br><br>Sorted now</p></div><hr><div class="footer"><p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p></div></div><script type="text/javascript" src="../js/highlight.pack.js" async></script><script type="text/javascript">//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]></script></body></html>