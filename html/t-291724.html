<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="description" content="Proper DIR for downloaded file"><title>Proper DIR for downloaded file - NSIS Forums</title><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script><link rel="preload" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css" as="style" onload="this.rel='stylesheet'"><link rel="preload" href="../css/style.css" as="style" onload="this.rel='stylesheet'"><noscript><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css"><link rel="stylesheet" href="../css/style.css"></noscript><script>!function(a){"use strict";var b=function(b,c,d){function e(a){return h.body?a():void setTimeout(function(){e(a)})}function f(){i.addEventListener&&i.removeEventListener("load",f),i.media=d||"all"}var g,h=a.document,i=h.createElement("link");if(c)g=c;else{var j=(h.body||h.getElementsByTagName("head")[0]).childNodes;g=j[j.length-1]}var k=h.styleSheets;i.rel="stylesheet",i.href=b,i.media="only x",e(function(){g.parentNode.insertBefore(i,c?g:g.nextSibling)});var l=function(a){for(var b=i.href,c=k.length;c--;)if(k[c].href===b)return a();setTimeout(function(){l(a)})};return i.addEventListener&&i.addEventListener("load",f),i.onloadcssdefined=l,l(f),i};"undefined"!=typeof exports?exports.loadCSS=b:a.loadCSS=b}("undefined"!=typeof global?global:this);!function(a){if(a.loadCSS){var b=loadCSS.relpreload={};if(b.support=function(){try{return a.document.createElement("link").relList.supports("preload")}catch(b){return!1}},b.poly=function(){for(var b=a.document.getElementsByTagName("link"),c=0;c<b.length;c++){var d=b[c];"preload"===d.rel&&"style"===d.getAttribute("as")&&(a.loadCSS(d.href,d,d.getAttribute("media")),d.rel=null)}},!b.support()){b.poly();var c=a.setInterval(b.poly,300);a.addEventListener&&a.addEventListener("load",function(){b.poly(),a.clearInterval(c)}),a.attachEvent&&a.attachEvent("onload",function(){a.clearInterval(c)})}}}(this);</script></head><body><div class="container"><ol class="breadcrumb"><li><a href="../index.html" class="glyphicon glyphicon-home"></a></li><li><a href="f-65.html">NSIS Discussion</a></li><li class="active">Proper DIR for downloaded file</li></ol><p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=291724">Proper DIR for downloaded file</a></p><br><div class="post"><p class="post-meta"><span class="post-author text-primary">ruk888</span><br><span class="post-time small text-muted">13th May 2008 01:04 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>Proper DIR for downloaded file</strong><br>Hello, Bit of a noob here, so I apologize in advance for anything stupid I may ask :)<br><br><br>I'm using NSIS to create an updater. Basically sends user to a webpage if update is detected.<br><br>I'd like this app to be for all users. I'm installing it to Program Files, but because it downloads a file for comparison, that file needs to be placed in a directory writable for all users.<br><br>I was going to go with $TEMP, but am not sure if that is the best practice. I also considered having the program create a folder in $APPDATA when run, but that would leave folders/files upon uninstall.<br><br>Also if $TEMP is the proper location, should it be "$TEMP\my.ini or "$TEMP\MyProg\my.ini<br><br>I appreciate any help offered. Thanks</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Anders</span><br><span class="post-time small text-muted">13th May 2008 04:47 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">SetShellVarContext all + $APPDATA<br><br>or<br><br>use the accesscontrol plugin to give write access for everyone to the .ini $programfiles</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">ruk888</span><br><span class="post-time small text-muted">13th May 2008 06:08 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Thanks for the response.<br><br>SetShellVarContext all + $APPDATA is writing to common app data correct? If so, the docs state IE5+ is required. Thats something I may want to avoid.<br><br>Is there something dangerous or a problem with using $TEMP?<br><br>Again, thanks for the help. Its greatly appreciated.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Anders</span><br><span class="post-time small text-muted">13th May 2008 06:28 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">$temp is per user, you said writeable for all users</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">ruk888</span><br><span class="post-time small text-muted">13th May 2008 07:17 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">I saw in the Docs "$TEMP The system temporary directory (usually C:\Windows\Temp but detected at runtime)." and thought this was a common area.<br><br>Ok, so I can use common app data to make sure everything is uninstalled but only if IE5+ is present.<br><br>Or I can use $TEMP, or $APPDATA (IE4+ needed to detect $APPDATA) and possibly leave a folder and a file behind on uninstall.<br><br>I'm not keen on making a dir in Program files writable to all users, seems risky.<br><br>Is there some other option I'm overlooking? I don't like the idea of leaving a file behind, but opening a security hole bothers me more.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Anders</span><br><span class="post-time small text-muted">13th May 2008 07:40 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">you don't have to give write access to the whole dir, just the .ini. But why do all users need access to the file you download? Why not just download to $temp, check version and tell the user to upgrade or whatever if needed. Or, download to $temp, extract whatever info you need from that file and save it in the HKLM part of the registry</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">ruk888</span><br><span class="post-time small text-muted">13th May 2008 08:34 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">I think you described what I am doing. Here's the code I'm using.<br><br><font color="royalblue">InetLoad::load "http://someserver.com/New_Version.ini" "$TEMP\New_Version.ini"<br><br>ReadINIStr $4 "$EXEDIR\Old_Version.ini" Version version<br>ReadINIStr $5 "$TEMP\New_Version.ini" Version version<br>${VersionCompare} $4 $5 $R0<br>;then do something based on returned value</font><br><br>I just want to make sure that what I am doing is correct. The only problem is see here is that New_Version.ini will not be uninstalled if the App is removed.<br><br>Again, thanks for your time and patience</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Anders</span><br><span class="post-time small text-muted">13th May 2008 10:29 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">leaving a small text file behind in $temp is not a big deal, but you could put it in $pluginsdir instead and it will get auto deleted, or delete it from $temp after you use ReadInistr</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">ruk888</span><br><span class="post-time small text-muted">13th May 2008 12:47 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Thanks Anders. The $PLUGINSDIR sounds ideal.</p></div><hr><div class="footer"><p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p></div></div><script src="../js/highlight.pack.js" type="text/javascript"></script><script type="text/javascript">//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]></script></body></html>