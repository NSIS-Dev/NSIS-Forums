<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="Firebird connection" />

  <title>Firebird connection - NSIS Forums</title>
  <script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script>
  <!-- Bootstrap core CSS -->

  <link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css" />
  <link rel="stylesheet" href="../css/style.css" type="text/css" /><!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!--[if lt IE 9]>
                <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
                <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->
</head>

<body>
  <div class="container">
    <!-- Put navigation bar here -->

    <ol class="breadcrumb">
      <li><a href="../index.html" class="glyphicon glyphicon-home"></a></li>

      <li><a href="f-65.html">NSIS Discussion</a></li>

      <li class="active">Firebird connection</li>
    </ol>

    <p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=269287">Firebird connection</a></p><br />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">AstraS</span><br />
      <span class="post-time small text-muted">10th April 2007 08:49 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>Firebird connection</strong><br />
      In my custom page user input connection params (ect connection strig, database pats, login, password)<br />
      How can i check it?</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
      <span class="post-time small text-muted">10th April 2007 20:19 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">You can use an external utility like <a href="http://www.di-mgt.com.au/osqlUtility.htm" target="_blank">osql</a> to connect to the database with the supplied parameters.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">AstraS</span><br />
      <span class="post-time small text-muted">10th April 2007 21:10 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">thx. But how can i use it ?</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
      <span class="post-time small text-muted">10th April 2007 21:15 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Execute it using the parameters given by the user. If it doesn't return an error, you've made a valid connection and the connection parameters are correct.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">AstraS</span><br />
      <span class="post-time small text-muted">10th April 2007 21:41 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">thx tvice, but i dont understend how can i use it from my installer :(<br />
      (sorry for stupid question)</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
      <span class="post-time small text-muted">10th April 2007 21:47 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">You can execute it using ExecWait or the nsExec plug-in. Both provide the result. ExecWait in the third parameter and nsExec on the stack.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">AstraS</span><br />
      <span class="post-time small text-muted">11th April 2007 07:41 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">thx It is work. But it is new problem, i should use only freeware/open sorce and other not commercial soft, but this util from Microsoft, and i think that it's not free :(</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
      <span class="post-time small text-muted">11th April 2007 20:51 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><a href="http://www.firstsql.com/iodbc/" target="_blank">iodbc</a> is licensed under GPL.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
      <span class="post-time small text-muted">11th April 2007 23:19 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">There are also a plug-in for this task.<br />
      <br />
      <a href="http://nsis.sourceforge.net/NsODBC_plug-in" target="_blank">http://nsis.sourceforge.net/NsODBC_plug-in</a></p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Comperio</span><br />
      <span class="post-time small text-muted">11th April 2007 23:43 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">AstraS,<br />
      Your original question was regarding setting up a Firebird database from NSIS. As Kichik pointed out, you can use a command line utility to do so.<br />
      <br />
      If you look at the <a href="http://www.firebirdsql.org/manual/qsg2-config.html" target="_blank">Firebird documentation</a>, you will find a tool called <b>gsec</b>, which looks like it should give you what you need. (I have not actually worked with Firebird databases before, but from the description, it seems like it would work.)<br />
      <br />
      From Firebird's website:<br /></p>

      <blockquote>
        Firebird comes with a command-line user management tool called gsec. Although its functions can also be performed by a number of third-party GUI utilities, you should at least have a basic knowledge of gsec, since this is the official tool and it's <b>present in <u>every</u> Firebird server installation.</b>
      </blockquote>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">AstraS</span><br />
      <span class="post-time small text-muted">12th April 2007 23:19 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">thx all.<br />
      but all of this is not what i want.<br />
      i'll try to write it again.<br />
      in my installer there are firebird database.<br />
      before installation complete, user input login pass and path(to .fdb) file, and installer should check it. If pass login and path is correct the installation complete sucsesfully and if not correct installer somthing to do.<br />
      sorry for english</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">AstraS</span><br />
      <span class="post-time small text-muted">12th April 2007 23:25 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">PS and there are two important things<br />
      1. it is should work with Firebird<br />
      2. and be freeware or GNU or.....</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
      <span class="post-time small text-muted">13th April 2007 11:34 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">How is this not what you want? It gives you access to the Firebird database so you can try and connect to it using the details provided by the user. If the connection fails, the credentials are wrong. Aside from osql, which is Microsoft's, everything else mentioned is completely free and Comperio's suggestion is even a part of Firebird itself.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">AstraS</span><br />
      <span class="post-time small text-muted">13th April 2007 13:23 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">thx kichik<br />
      but my script not work :( and i don't know why.<br />
      i check it and all of this methods work whithout my script</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Comperio</span><br />
      <span class="post-time small text-muted">13th April 2007 14:43 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">If the methods work outside of the script, then it's probably in the way that you are calling them within your install.<br />
      <br />
      Maybe if you attach a minimal example illustrating the problem, then someone could help get you pointed in the right direction.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">AstraS</span><br />
      <span class="post-time small text-muted">13th April 2007 18:50 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">this is my test example<br />
      <br />
      ;--------------------------------<br />
      ;Include Modern UI<br />
      <br />
      !include "MUI.nsh"<br />
      <br />
      XPStyle on<br />
      ;Name and file<br />
      Name "B2 server"<br />
      OutFile "Setup.exe"<br />
      <br />
      ;Default installation folder<br />
      InstallDir "$PROGRAMFILES\B\B2"<br />
      <br />
      <br />
      !define MUI_ABORTWARNING<br />
      !insertmacro MUI_PAGE_INSTFILES<br />
      <br />
      Function CheckDB<br />
      ExecWait '"$INSTDIR\gsec.exe" -user sysdba -pass masterkey -database c:\P\B2.fdb' $0<br />
      DetailPrint "some program returned $0"<br />
      FunctionEnd<br />
      <br />
      ;--------------------------------<br />
      Section "Main" SecMain<br />
      <br />
      SetOutPath "$INSTDIR"<br />
      File "gsec.exe"<br />
      call CheckDB<br />
      Delete $INSTDIR\gsec.exe<br />
      RMDir $INSTDIR<br />
      SectionEnd</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">AstraS</span><br />
      <span class="post-time small text-muted">13th April 2007 21:42 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">help me please!</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Comperio</span><br />
      <span class="post-time small text-muted">14th April 2007 06:44 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Your script seems like it should work. But, are you sure you got your command correct? From the <a href="http://www.firebirdsql.org/manual/fbutils-gsec-cmdline.html" target="_blank">gsec documentation</a>, you are only specifying a few options, but no real command. (in other words, you haven't told it to actually <b><u>do</u></b> anything). (By the way, what <u>are</u> you trying to accomplish anyway?)<br />
      <br />
      Does the same command run from a RUN box on the target computer? (You may want to also try it from a command prompt just to see what type of message you may be getting back.)<br />
      <br />
      It might be helpful to read through the <a href="http://www.firebirdsql.org/pdfmanual/Firebird-1.5-QuickStart.pdf" target="_blank">Firebird documentation</a>. There's some good info there that may help.<br />
      <br />
      Again, I've never actually used a Firebird database before so this is probably all I can offer you. From what I can tell so far, it looks like you just need to figure out the proper tools. Maybe someone else can give you something more...</p>
    </div>
    <hr />

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]>
  </script>
</body>
</html>
