<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="ending a running exe" />

  <title>ending a running exe - NSIS Forums</title>
  <script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script>
  <!-- Bootstrap core CSS -->

  <link rel="stylesheet" type="text/css" href="//netdna.bootstrapcdn.com/bootswatch/3.0.1/readable/bootstrap.min.css" />
  <link rel="stylesheet" href="../css/style.css" type="text/css" /><!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!--[if lt IE 9]>
                <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
                <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->
</head>

<body>
  <div class="container">
    <!-- Put navigation bar here -->

    <ol class="breadcrumb">
      <li><a href="../index.html" class="glyphicon glyphicon-home"></a></li>

      <li><a href="f-65.html">NSIS Discussion</a></li>

      <li class="active">ending a running exe</li>
    </ol>

    <p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=147585">ending a running exe</a></p><br />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">khal_nayak</span><br />
      <span class="post-time small text-muted">30th August 2003 10:11 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>ending a running exe</strong><br />
      i have a small application which keeps running with windows but if i wanna provide an update for it, i cant replace the exe file as it will be running. is there any way i can end task it through NSIS or some way i can remove the registry entry and then restart the installer to continue with the rest of the installation?</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
      <span class="post-time small text-muted">30th August 2003 12:01 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">There are so many forum threads discussing this... Please search the forum. Here's one for example:<br />
      <br />
      <a href="http://forums.winamp.com/showthread.php?s=&amp;threadid=128743" target="_blank">http://forums.winamp.com/showthread....hreadid=128743</a></p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">khal_nayak</span><br />
      <span class="post-time small text-muted">30th August 2003 22:18 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">i have read all those threads bout killing an application but all dont seem the ideal way of doing it. Is it possible to pass certain parameters to the insaller so that i can make it detect if the older version of the application is running then ask the user to restart the pc and mean while remove the entry from the registry so the application doesnt run again, then after restarting, the installer should continue from where it left not asking the user to click anything or do anything and deleting the older file and replacing it with the new. the main thing that i want is to be able to pass some parameters to the installer so when it restarts, it comes in the silent install mode and complete the rest of the updating. the other way is to re run the installer and ask the user for all the details again, if some switches were written then it can do specified tasks.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
      <span class="post-time small text-muted">31st August 2003 11:21 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Assuming you can't close the application and that you must reboot, you can use $CMDLINE to check the command line parameters passed on to the installer. To make the installer start up silent all you need to do is pass /S and NSIS will take care of the rest. To check if the installer is silent by command line you can use <a href="http://nsis.sourceforge.net/archive/viewpage.php?pageid=79" target="_blank">IsSilent</a>. To get the command line parameters alone, without the executable path use <a href="http://nsis.sourceforge.net/Docs/AppendixB.html#B.3" target="_blank">GetParameters</a>.<br />
      <br />
      If I were you I would try to avoid the reboot and seek a way to close the process that doesn't involve TerminateProcess. Maybe if you specify the application you're trying to close someone can help you with it. If it is a service you can use Sunjammer's services handler plug-in from the <a href="http://nsis.sourceforge.net/archive/download.php" target="_blank">archive's downloads page</a>.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">khal_nayak</span><br />
      <span class="post-time small text-muted">2nd September 2003 11:15 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">can u plz type some code for me to check if a file is open or running, meaning locked or not</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
      <span class="post-time small text-muted">2nd September 2003 11:23 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">It's very simple, just try to open it using FileOpen.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">khal_nayak</span><br />
      <span class="post-time small text-muted">2nd September 2003 14:44 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">i tried to use that same command but wasnt able to get the installer compiled as some problem with the variables. i would appreciate it if u just typed that 3 to 4 line code.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
      <span class="post-time small text-muted">2nd September 2003 14:48 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Here's one:<br />
      <br />
      <a href="http://forums.winamp.com/showthread.php?s=&amp;threadid=137714&amp;highlight=fileopen" target="_blank">http://forums.winamp.com/showthread....light=fileopen</a></p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">khal_nayak</span><br />
      <span class="post-time small text-muted">2nd September 2003 14:51 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">thanx m8</p>
    </div>
    <hr />

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]>
  </script>
</body>
</html>
