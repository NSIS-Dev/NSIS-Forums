<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="I can not see Uninstall in WindowsSystem/Software under WinXP" />

  <title>I can not see Uninstall in WindowsSystem/Software under WinXP - NSIS Forums</title><!-- Bootstrap core CSS -->
  <link rel="stylesheet" type="text/css" href="//netdna.bootstrapcdn.com/bootswatch/3.0.1/readable/bootstrap.min.css" />
  <link rel="stylesheet" href="../css/style.css" type="text/css" /><!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!--[if lt IE 9]>
                <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
                <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->
</head>

<body>
  <div class="container">
    <!-- Put navigation bar here -->

    <ol class="breadcrumb">
      <li><a href="../index.html" class="glyphicon glyphicon-home"></a></li>

      <li><a href="f-65.html">NSIS Discussion</a></li>

      <li class="active">I can not see Uninstall in WindowsSystem/Software under WinXP</li>
    </ol>

    <p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=179116">I can not see Uninstall in WindowsSystem/Software under WinXP</a></p><br />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Biarchiv</span><br />
      <span class="post-time small text-muted">6th May 2004 10:10 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>I can not see Uninstall in WindowsSystem/Software under WinXP</strong><br />
      Hello,<br />
      <br />
      i can not see my Uninstall entry in WinXP Software?<br />
      In other WinOS it is right.<br />
      <br />
      Why?</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">evilO</span><br />
      <span class="post-time small text-muted">6th May 2004 10:23 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Hi :)<br />
      <br />
      Which registry entries do you create? Could you attach the script or give more details?<br />
      <br />
      evilO/Olive</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Biarchiv</span><br />
      <span class="post-time small text-muted">6th May 2004 18:47 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Hello,<br />
      <br />
      thanks your your post.<br />
      <br />
      I have it attached.<br />
      <br />
      Whats wrong?</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Yathosho</span><br />
      <span class="post-time small text-muted">6th May 2004 18:53 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">InstallDirRegKey checks for existing registry entries. to write a registry-entry use <a href="http://nsis.sourceforge.net/Docs/Chapter4.html#4.9.2.16" target="_blank">WriteRegStr</a>, to read it use <a href="http://nsis.sourceforge.net/Docs/Chapter4.html#4.9.2.12" target="_blank">ReadRegStr</a>.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">deguix</span><br />
      <span class="post-time small text-muted">7th May 2004 03:32 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">The real effect of InstallDirRegKey is that it checks the value of the specific registry key and returns it to $INSTDIR.<br />
      <br />
      Now about the first question from Biarchiv: you need to create the key on HKCU (you're creating now on HKLM).</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Romu</span><br />
      <span class="post-time small text-muted">29th June 2004 14:47 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">I've got the same problem (except I didn't test with other OSes than XP).<br />
      <br />
      Creating the key under HKLM or HKCU does the same result, the key is not created and so the values.<br />
      <br />
      I've used the example provided in the NSIS archive.<br />
      <br />
      Any idea to check ??<br />
      <br />
      Thanks.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">MotoSlave</span><br />
      <span class="post-time small text-muted">2nd July 2004 16:11 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">The following two lines from your NSI script should be just fine.<br /></p>
      <pre>
<code>  WriteRegStr HKLM "Software\Microsoft\Windows\CurrentVersion\Uninstall\WinHKI" "DisplayName" "WinHKI V1.3e"<br />  WriteRegStr HKLM "Software\Microsoft\Windows\CurrentVersion\Uninstall\WinHKI" "UninstallString" '"$INSTDIR\uninstall.exe"'<br /></code>
</pre>I tried your example NSI script, with dummy files, and it worked fine for me (on WinXP Professional). The registry entries are created as they should be and, since they are, when I open Add/Remove Programs the "WinHKI V1.3e" entry is there as one would expect. In fact, I do almost exactly the same thing as your following code snippet in my installers and I've never had a problem, on any version of Windows.<br />
      <br />
      I don't know why it's not working for you, but there's nothing wrong with those two lines in particular. Is the installer completing the install with no errors or aborts on your test system, and have you tried it on other similar WinXP machines? That's about the only thing I can think of off the top of my head.<br />
      <br />
      Additionally, on which registry tree to use, HKLM or HKCU. If the software is for all users on the local machine, use HKLM. If the software is for the current user only, use HKCU.
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">zimsms</span><br />
      <span class="post-time small text-muted">2nd July 2004 16:22 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">It's most likely permissions. Only the Administrator has permission to write to HKLM. As for HKCU you should be able to write whatever you want.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Romu</span><br />
      <span class="post-time small text-muted">2nd July 2004 16:25 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Thanks for your answers guys, but I have admin privileges on my computer.<br />
      <br />
      I'll do some additionnal tests as soon as I have time for that and let you know.<br />
      <br />
      But anyway, thanks a lot for your help.</p>
    </div>
    <hr />

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]>
  </script>
</body>
</html>
