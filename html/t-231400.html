<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="description" content="Issues related to Start menu shortcuts orders during installation"><title>Issues related to Start menu shortcuts orders during installation - NSIS Forums</title><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script><link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css"><link rel="stylesheet" href="../css/style.css" type="text/css"></head><body><div class="container"><ol class="breadcrumb"><li><a href="../index.html" class="glyphicon glyphicon-home"></a></li><li><a href="f-65.html">NSIS Discussion</a></li><li class="active">Issues related to Start menu shortcuts orders during installation</li></ol><p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=231400">Issues related to Start menu shortcuts orders during installation</a></p><br><div class="post"><p class="post-meta"><span class="post-author text-primary">Swapan Das</span><br><span class="post-time small text-muted">19th November 2005 10:09 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>Issues related to Start menu shortcuts orders during installation</strong><br>Purpose of my Installer is:<br>1) Create a folder by name PosPlus (default c:\PosPlus)<br>2) Create a sub-folder by name 'samples' in c:\posPlus<br>This 'samples' sub-folder contains a few application related text files.<br>These text files are also copied in this sub-folder.<br>3) Copy/extract pos.exe to c:\PosPlus<br>4) Copy/extract databack.exe to c:\PosPlus<br>5) Copy/extract uninst.exe to c:\PosPlus<br>6) Copy/extract PosPlus.chm to c:\PosPlus<br>7) Create desktop shortcut for main application:pos.exe<br>8) Create shortcut in Windows Start Menu-&gt;Program-&gt;<br>in following order:<br>Start Menu--&gt;Program--&gt;Pos Plus--&gt;Pos Plus<br>--&gt;Backup Manager<br>--&gt;Pos Manual<br>--&gt;Samples<br>--&gt;Uninstall<br><br>My problem is that the installer is smoothly installing all the steps mentioned-above,<br>but the shortcuts in the start menu for Pos Plus are not comming as per my above order.<br>The 'Uninstall' shortcut is comming as the first option and the others are also not in<br>the same order as shown above.<br><br>One more thing I want to do is that I want to show my sub-folder Samples and its contents in<br>this start menu. For this I added this line my script :<br><br>CreateDirectory "$SMPROGRAMS\PosPlus\Samples"<br><br>This helped me in showing the folder "Samples"(empty). Yes it is showing 'empty' although<br>it contains many text files inside it.<br><br>What I want :<br><br>Start Menu--&gt;Program--&gt;Pos Plus--&gt;Pos Plus<br>--&gt;Backup Manager<br>--&gt;Pos Manual<br>--&gt;Samples----&gt;t1.txt(shortcut)<br>----&gt;t2.txt(shortcut)<br>---&gt;....... and so on when the user clicks samples<br>and when he clicks t1.txt then that file opens<br>up in notepad.<br>--&gt;Uninstall<br><br>A fraction of script is given below to understand my issue:<br><br>Section "Complete" SEC01<br>SetOutPath "$INSTDIR"<br>SetOverwrite ifnewer<br>File "AppFolder\pos.exe"<br>CreateDirectory "$SMPROGRAMS\PosPlus"<br>CreateDirectory "$SMPROGRAMS\PosPlus\Samples"<br>;CreateShortCut "$SMPROGRAMS\PosPlus\Samples" "$INSTDIR\Samples"<br>CreateShortCut "$SMPROGRAMS\PosPlus\Pos Plus .lnk" "$INSTDIR\pos.exe"<br>CreateShortCut "$SMPROGRAMS\PosPlus\Backup Manager.lnk" "$INSTDIR\databack.exe"<br>CreateShortCut "$DESKTOP\Pos Plus.lnk" "$INSTDIR\pos.exe"<br>File "AppFolder\databack.exe"<br>File "AppFolder\Format.txt"<br>File "AppFolder\PosPlus.chm"<br>CreateShortCut "$SMPROGRAMS\PosPlus\Pos Manual.lnk" "$INSTDIR\PosPlus.chm"<br>SetOutPath "$INSTDIR\Samples"<br>SetOverwrite try<br>File "AppFolder\Samples\T1.TXT"<br>File "AppFolder\Samples\T2.TXT"<br>File "AppFolder\Samples\T5.TXT"<br>File "AppFolder\Samples\T7.TXT"<br>File "AppFolder\Samples\T8.TXT"<br>File "AppFolder\Samples\T9.TXT"<br>File "AppFolder\Samples\T10.TXT"<br>File "AppFolder\Samples\T11.TXT"<br>File "AppFolder\Samples\T12.TXT"<br>File "AppFolder\Samples\T13.TXT"<br>File "AppFolder\Samples\T17.TXT"<br>File "AppFolder\Samples\T18.TXT"<br>File "AppFolder\Samples\T19.TXT"<br>File "AppFolder\Samples\T20.TXT"<br>File "AppFolder\Samples\Format.TXT"<br>SectionEnd<br><br>Section -AdditionalIcons<br>;WriteIniStr "$INSTDIR\${PRODUCT_NAME}.url" "InternetShortcut" "URL" "${PRODUCT_WEB_SITE}"<br>;CreateShortCut "$SMPROGRAMS\PosPlus\Website.lnk" "$INSTDIR\${PRODUCT_NAME}.url"<br>CreateShortCut "$SMPROGRAMS\PosPlus\Uninstall.lnk" "$INSTDIR\uninst.exe"<br>SectionEnd<br><br>Section -Post<br>WriteUninstaller "$INSTDIR\uninst.exe"<br>WriteRegStr HKLM "${PRODUCT_DIR_REGKEY}" "" "$INSTDIR\PosPlus.exe"<br>WriteRegStr ${PRODUCT_UNINST_ROOT_KEY} "${PRODUCT_UNINST_KEY}" "DisplayName" "$(^Name)"<br>WriteRegStr ${PRODUCT_UNINST_ROOT_KEY} "${PRODUCT_UNINST_KEY}" "UninstallString" "$INSTDIR\uninst.exe"<br>WriteRegStr ${PRODUCT_UNINST_ROOT_KEY} "${PRODUCT_UNINST_KEY}" "DisplayIcon" "$INSTDIR\PosPlus.exe"<br>WriteRegStr ${PRODUCT_UNINST_ROOT_KEY} "${PRODUCT_UNINST_KEY}" "DisplayVersion" "${PRODUCT_VERSION}"<br>WriteRegStr ${PRODUCT_UNINST_ROOT_KEY} "${PRODUCT_UNINST_KEY}" "URLInfoAbout" "${PRODUCT_WEB_SITE}"<br>WriteRegStr ${PRODUCT_UNINST_ROOT_KEY} "${PRODUCT_UNINST_KEY}" "Publisher" "${PRODUCT_PUBLISHER}"<br>SectionEnd<br><br><br>Thanks in advance,<br>With regards,<br>Swapan Das</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br><span class="post-time small text-muted">19th November 2005 10:23 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">As iceman_k has already mentioned in your previous thread, Windows manages the order of the shortcuts in the Start menu sorting them by name. You cannot sort it through the installer. The only thing you can do is place a + in front of the main shortcut name to make sure that it's always at the top.<br><br>-Stu</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Swapan Das</span><br><span class="post-time small text-muted">21st November 2005 05:17 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Dear Stu,<br>Thanks for the reply.<br>You said windows manages the shortcuts in the Start menu by sorting them name-wise. Then why my Uninstall shortcut will appear at the top:<br>Start Menu--&gt;Program--&gt;Pos Plus--&gt;Pos Plus<br>--&gt;Backup Manager<br>--&gt;Pos Manual<br>--&gt;Samples<br>--&gt;Uninstall<br>And Please note the shortcuts of NSIS<br>---&gt;Contrib --&gt;AdvSplash Readme<br>--&gt;...and all the files<br>shortcuts.<br>Similarly I want to show my subfolder "samples" (which is<br>under my main folder PosPlus) and shortcuts for all the<br>text files inside the "samples" folder in the same fashion as startmenu-&gt;Programs-&gt;NSIS-&gt;Contrib-&gt;AdvSplash Readme.<br><br>Please help me. Its very urgent for me.<br><br>With regards,<br>Swapan das</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">iceman_k</span><br><span class="post-time small text-muted">21st November 2005 15:21 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Windows does <b>not</b> sort alphabetically by default.<br>The user has to manually specify alphabetical sorting.<br>Windows uses some internal logic to sort the menu items.<br><br><u><b>Edit</b></u><br>Windows uses the following registry value to store the order of the menu items.<br>Key: HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Explorer\MenuOrder\Start Menu\Programs\XYZ<br>Value: Order<br><br>where XYZ is your program group.<br><br>The Order registry value is REG_BINARY, so if you can decode it then you can manually rearrange the order of the items.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">rutsche</span><br><span class="post-time small text-muted">20th September 2007 09:53 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">i solved the problem by first installing my application, then changing the order manualy. Next I copied the "Order" value, which windows created and used it in my nsi file. e.g.:<br>WriteRegBin HKCU "Software\Microsoft\Windows\CurrentVersion\Explorer\MenuOrder\Start Menu\Programs\XYZ" "Order" 00890888003.....<br><br>it works :)</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br><span class="post-time small text-muted">20th September 2007 13:36 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">That's a good solution.<br><br>Stu</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Swapan Das</span><br><span class="post-time small text-muted">21st September 2007 05:49 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Thanks rutsche for replying to my this old thread. You did a brilliant 'trick'. Since I'm pre-occupied with many other things now, hope to test it in near future.<br><br>Regards,<br>Swapan</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Wizou</span><br><span class="post-time small text-muted">4th November 2007 03:38 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">check out my new <a href="http://wiz0u.free.fr/prog/nsisStartMenu" target="_blank">nsisStartMenu Plugin</a><br>(no registry trick, the work is done by Windows Shell)</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Wizou</span><br><span class="post-time small text-muted">4th November 2007 20:56 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">My plugin works by forcing the Shell to do a premature update of your startmenu folder's menu, so that you can be sure that the shortcuts you created <b>before</b> the call will show up before the shortcuts you create <b>after</b> the call.<br><br>Note: the <a href="http://wiz0u.free.fr/prog/nsisStartMenu" target="_blank">nsisStartMenu.dll</a> exports a function that can be used outside NSIS installers</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Swapan Das</span><br><span class="post-time small text-muted">5th November 2007 06:02 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Thanks Wizou for coming to my this old thread and giving your solution for it.<br><br>Anybody who has applied above solutions to resolve this issue do let me know if its working fine and the windows version he/she is using while testing for this issue. Be specific you applied which solution, rutsche's or Wizou's.<br><br>Currently I'm into different things, so unable to test these solutions for this issue which troubled me a lot during my initial days of installer creation.<br><br>Regards,<br>Swapan<br>[ps.:how's everybody there, esp. RedWine?!]</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Spilly</span><br><span class="post-time small text-muted">21st August 2008 22:30 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">If you only want your shortcuts in the start menu to display in alphabetical order, then you can just delete the key referring to your products entry.<br><br>The next time the start menu shortcuts are accessed, they will be displayed alphabetically.<br><br>Example.<br><br>DeleteRegKey "Software\Microsoft\Windows\CurrentVersion\Explorer\MenuOrder\Start Menu\Programs\XYZ"</p></div><hr><div class="footer"><p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p></div></div><script src="../js/highlight.pack.js" type="text/javascript"></script><script type="text/javascript">//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]></script></body></html>