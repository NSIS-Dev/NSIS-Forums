<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="description" content="Updating and Overwriting OCX"><title>Updating and Overwriting OCX - NSIS Forums</title><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script><link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css"><link rel="stylesheet" href="../css/style.css" type="text/css"></head><body><div class="container"><ol class="breadcrumb"><li><a href="../index.html" class="glyphicon glyphicon-home"></a></li><li><a href="f-65.html">NSIS Discussion</a></li><li class="active">Updating and Overwriting OCX</li></ol><p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=155590">Updating and Overwriting OCX</a></p><br><div class="post"><p class="post-meta"><span class="post-author text-primary">alan93</span><br><span class="post-time small text-muted">8th November 2003 23:10 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>Updating and Overwriting OCX</strong><br>I have a few questions that I couldn not find or understand in the documentation was wondering if i could ask here.<br><br>I am wanting to overwrite some OCX if newer, currently when the installer runs and it tries to install when the OCX is already there, it throws up a message box to Retry, Ignore, or Cancel.<br><br><br>So i use<br></p><pre>
<code>SetOverwrite ifnewer</code>
</pre><br><br>fine<br><br>Does this only have to be done before File command once? or in each Section where File command is used?<br><br>and I only want to install install the OCX if it doesn't exist or if its newer.<br><br>so tyring to understand examples I saw<br><br><pre>
<code>IfFileExists "$INSTDIR\NSIS.exe" 0 +3</code>
</pre><br><br>What's the 0 and what's the +3?<br><br>Also , should I unregister an OCX if I am updating it then re-register it after its updated or overwritten?</div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Vytautas</span><br><span class="post-time small text-muted">8th November 2003 23:22 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">The 0 means that the script continues on the next line and +3 means the script will continue from the third line from this point, skipping 2 line. You could also replace these numbers with labels so the script is more resistant to modification. i.e. if you add extra lines you would not need to change the amount of line to skip.<br><br>Vytautas</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">alan93</span><br><span class="post-time small text-muted">8th November 2003 23:42 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Tried to delete this post but couldn't so I changed it.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">o_owd</span><br><span class="post-time small text-muted">9th November 2003 08:59 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">look in the docs at "appedinx B : Useful functions". you will find "Add a shared DLL", "Remove a shared DLL" and "Upgrade a DLL". i use them. they work very good.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">alan93</span><br><span class="post-time small text-muted">10th November 2003 13:48 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>Ok</strong><br>Great I'll check that out. I am just overwriting with "ifnewer" and I no longer get the "cancel/abort/ignore" message.<br><br>I guess I dont need to re-register an OCX when overwriting. I am unregistering it on uninstall though.<br><br>One strange thing I notice is that when I have Regdll in a section named "" it doesn't HIDE the process.<br><br>Not sure what "" for a section name hides exactly. ?</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Joost Verburg</span><br><span class="post-time small text-muted">10th November 2003 15:34 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">I recommend you to use UpgradeDLL. If you just overwrite a shared OCX it might break other applications in the future.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">alan93</span><br><span class="post-time small text-muted">10th November 2003 16:24 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>ok</strong><br>This happens to be an OCX that is exclusive to my program that I am distributing, but I will check out UpgradeDLL aslo<br><br>thanks.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">alan93</span><br><span class="post-time small text-muted">10th November 2003 16:29 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>whats with this forum???</strong><br>This was supposed to be a reply to another message but got diverted when i logged in.<br><br>Can't even delete it.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Joost Verburg</span><br><span class="post-time small text-muted">10th November 2003 17:04 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">If it's exclusive for your application and the OCX is distributed with the application, there is no need to use UpgradeDLL.</p></div><hr><div class="footer"><p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p></div></div><script src="../js/highlight.pack.js" type="text/javascript"></script><script type="text/javascript">//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]></script></body></html>