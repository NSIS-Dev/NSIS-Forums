<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="description" content="Scripting Question"><title>Scripting Question - NSIS Forums</title><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script><link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css"><link rel="stylesheet" href="../css/style.css" type="text/css"><!--[if lt IE 9]><script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script><script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script><![endif]--></head><body><div class="container"><ol class="breadcrumb"><li><a href="../index.html" class="glyphicon glyphicon-home"></a></li><li><a href="f-65.html">NSIS Discussion</a></li><li class="active">Scripting Question</li></ol><p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=66306">Scripting Question</a></p><br><div class="post"><p class="post-meta"><span class="post-author text-primary">Slyde</span><br><span class="post-time small text-muted">21st November 2001 21:27 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>Scripting Question</strong><br>Hi All!<br>I am a developer currently working on using this most excellent installer for Quake III mods a friend of mine makes. His newest will be using the NSIS for packaging and I can say that i could not be more pleased with it. In the time it took me to find info on .msi creation, I wrote the basic script for the package in NSIS. ROCK! I am having a bit of trouble with one part though.<br>Being that it is a Quake III mod, all installations on all computers have to be in the Same dir under the Quake III program folder (i.e. &lt;Q3&gt;\BQ3) for network play to work properly. I am thinking there is a way to make sure that the dir is the same by appending it to the dir you install to, like how ICQ does always having ICQ as the dir name...but I am not sure how to do it =( Is there anyone who would be willing to help provide a simple script to do such a thing? I have been playing around with the Strcpy functions...but not coming up with much. would appreciate any help I can get on this! Thank you!</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Smile2Me</span><br><span class="post-time small text-muted">22nd November 2001 08:09 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">If Q3 makes some registry settings, try to find the Q3 root in the<br>registry (ReadRegStr $0 HKLM "Software\Q3" "Q3Root" might work) and<br>use StrCpy $0 "$0\BQ3"<br>and set the $INSTDIR to this value.<br><br>Or you could ask the user to find the Q3 dir by DirRequest or the<br>main program of Q3 by FileRequest using InstallOptions.<br><br>I hope this answers your question...<br><br>- :D Hendri :D -</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Slyde</span><br><span class="post-time small text-muted">24th November 2001 23:47 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>Thank you!</strong><br>Smile2Me:<br>Thank you! I will most certainly try this out. there must be a dir listing for Q3 and I sure hope I find it. I apologize for not responding sooner. Just got back from Thanxgiving family-visit. =) Thanx again mate!</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Ackbar</span><br><span class="post-time small text-muted">25th November 2001 00:50 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">I'd like to know how you are catching the compiler output. Thats pretty cool :)</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Slyde</span><br><span class="post-time small text-muted">25th November 2001 05:20 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>Compiler Output</strong><br>Ackbar:<br><br>In running Win2k, I use the cmd interface lots and I just scroll through everything it prints when it compiles. This is mucho nice for error detection, which thank the head Llamas, is very easy to understand if you've ever programmed. (Thankyouthankyouthankyou). I didn't know if you were asking me or not, if not, then ignore this message =D</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Ackbar</span><br><span class="post-time small text-muted">25th November 2001 05:40 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">How do you capture whats being scrolled by the command interface? thanks :)</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Smile2Me</span><br><span class="post-time small text-muted">25th November 2001 09:59 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Slyde,<br><br>it's ok, have fun, greetz,<br><br>- :D Hendri :D -</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Slyde</span><br><span class="post-time small text-muted">25th November 2001 17:47 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>Capture from Commandline</strong><br>Ackbar:<br>Basically, just reading it. if you needed to capture, you'd just need to highlight with the mouse and then right click, whenever you are in cmd and do that, what you had highlighted is copied and you can paste in other places. Ctrl+C and Ctrl+V don't work there. it's all done with the right mouse button. like, fi you had to paste something to cmd, just highlight in the otehr window, copy it and go to cmd and right click anywhere on the cmd screen, and it's pasted. that's all there is to it =)</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Ackbar</span><br><span class="post-time small text-muted">25th November 2001 17:50 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Nice Joke :) Nah I actually figured it out. I was after capturing the return data from a shelled application through a program :)</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Slyde</span><br><span class="post-time small text-muted">26th November 2001 05:57 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>Smile2Me is Great! Give Us Chocolate Cake!</strong><br>ReadRegStr $0 HKLM "Software\Id\Quake III Arena" "INSTALLPATH"<br>StrCpy $0 "$0\BQ3"<br>StrCpy $INSTDIR $0<br><br>Not as advanced as i would like, but it works just fine, and since the user can't change it, there is no way the mod would get installed to the wrong dir. Thanx for the help mate! It was a life-saver!<br><br>*prances around Smile2Me singing praises*</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Smile2Me</span><br><span class="post-time small text-muted">26th November 2001 07:21 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Slyde,<br><br>You can change your code:<br>ReadRegStr $0 HKLM "Software\Id\Quake III Arena" "INSTALLPATH"<br>StrCpy $0 "$0\BQ3"<br>StrCpy $INSTDIR $0<br><br>into:<br>ReadRegStr $0 HKLM "Software\Id\Quake III Arena" "INSTALLPATH"<br>StrCpy $INSTDIR "$0\BQ3"<br><br>to save some bytes...<br><br>And thanx for your kind words :D<br>It's nice to help out friends...<br><br>- :D Hendri :D -</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">PepCid</span><br><span class="post-time small text-muted">28th November 2001 15:01 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"></p><blockquote><i>Originally posted by Ackbar</i><br><b>Nice Joke :) Nah I actually figured it out. I was after capturing the return data from a shelled application through a program :)</b></blockquote>Here is your solution:<br><br><a href="http://msdn.microsoft.com/library/default.asp?url=/library/en-us/dllproc/prothred_4uus.asp" target="_blank">http://msdn.microsoft.com/library/de...thred_4uus.asp</a><br><br>The above link links to "Creating a Child Process with Redirected Input and Output" in the MSDN<br><br>Grz,<br><br>Michel</div><hr><div class="footer"><p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p></div></div><script src="../js/highlight.pack.js" type="text/javascript"></script><script type="text/javascript">//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]></script></body></html>