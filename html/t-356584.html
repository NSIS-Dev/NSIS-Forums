<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="description" content="HTTPHelper plugin (or, how to send an HTTP Request?)"><title>HTTPHelper plugin (or, how to send an HTTP Request?) - NSIS Forums</title><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script><link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css"><link rel="stylesheet" href="../css/style.css" type="text/css"></head><body><div class="container"><ol class="breadcrumb"><li><a href="../index.html" class="glyphicon glyphicon-home"></a></li><li><a href="f-65.html">NSIS Discussion</a></li><li class="active">HTTPHelper plugin (or, how to send an HTTP Request?)</li></ol><p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=356584">HTTPHelper plugin (or, how to send an HTTP Request?)</a></p><br><div class="post"><p class="post-meta"><span class="post-author text-primary">BubbaBubbs</span><br><span class="post-time small text-muted">1st March 2013 21:21 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>HTTPHelper plugin (or, how to send an HTTP Request?)</strong><br>Does anyone know the status of the HTTPHelper plugin for NSIS?<br><br>Several months ago, I downloaded HTTPHelper.dll. Unfortunately, I forgot where I downloaded it from. I am now trying to Google it, but cannot find any mention of it. I would like to know the following:<br><br>1. Has HTTPHelper been maintained? Who's the author?<br>2. Where can I download it from?<br>3. Documentation<br>4. Is the source code available?<br><br>I ran 'strings' on HTTPHelper.dll, and found "Copyright (C) 1999-2012 Mark Russinovich", but am not sure if he is, indeed, the author. I pinged Mark at <a href="http://blogs.technet.com/b/markrussinovich/contact.aspx" target="_blank">http://blogs.technet.com/b/markrussinovich/contact.aspx</a>, but have not heard back.<br><br>Here's what I am struggling with:<br>In my NSIS installer, I am using<br><br>HTTPHelper::SendHttpRequest &lt;URL&gt;<br><br>to send simple InstallerStart and InstallerFinished status logs to my server. I do not need to process the HTTP response. The important thing, however, is that the User-Agent header of the HTTP request be the same as that of IE that's installed on the machine (for technical and business reasons.)<br>This works fine on Windows XP, Vista, 7, and IE 7-through-9.<br>On Win8/IE 10, however, the User-Agent for the above HTTPHelper::SendHttpRequest is:<br><br>Mozilla/5.0 (compatible; MSIE 9.0)<br><br>even though if I'm browsing using IE it correctly sets<br><br>Mozilla/5.0 (compatible; MSIE 10.0; Windows NT 6.2; Trident/6.0)<br><br>This is probably because the various User-Agent string seem to be hardcoded â€“ "strings HTTPHelper.dll" shows:<br><br>Mozilla/4.0 (compatible; MSIE 6.0)<br>Mozilla/4.0 (compatible; MSIE 7.0)<br>Mozilla/4.0 (compatible; MSIE 8.0)<br>Mozilla/5.0 (compatible; MSIE 9.0)<br><br>I am hoping that the up-to-date version of HTTPHelper would correctly set User-Agent to MSIE 10.0. Or, if I could get a hold of the source code maybe I could fix it and recompile it.<br><br>Also, I doubt there is a way to programmatically set/force the User-Agent header because the only three exported functions of HTTPHelper.dll are SendHttpRequest, OpenFirefox, OpenInternetExplorer. I have tried calling OpenInternetExplorer [&lt;URL&gt;] hoping that User-Agent would be correctly set if I sent by HTTP request by launching IE. But I can't get OpenInternetExplorer (or OpenFirefox) to work. I probably got the syntax wrong but, again, I don't have the documentation.<br><br>Does anyone know if there is another NSIS plugin that would allow me to accomplish the goal?<br><br>Thanks</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">kichik</span><br><span class="post-time small text-muted">3rd March 2013 07:29 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">I have never before heard of this plug-in. I had no idea Mark Russinovich even uses NSIS. It seems like you're out of luck though, as Microsoft hired him to hide most of his work on the Windows internals. I'm not sure why that would include HTTPRequest though...<br><br>You can do this manually with InetC and the /USERAGENT flag.<br><br><a href="http://nsis.sourceforge.net/Inetc_plug-in" target="_blank">http://nsis.sourceforge.net/Inetc_plug-in</a></p></div><hr><div class="footer"><p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p></div></div><script src="../js/highlight.pack.js" type="text/javascript"></script><script type="text/javascript">//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]></script></body></html>