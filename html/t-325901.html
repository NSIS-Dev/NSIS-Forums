<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="description" content="Allow update of license and program"><title>Allow update of license and program - NSIS Forums</title><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script><link rel="preload" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css" as="style" onload="this.rel='stylesheet'"><link rel="preload" href="../css/style.css" as="style" onload="this.rel='stylesheet'"><noscript><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css"><link rel="stylesheet" href="../css/style.css"></noscript><script>!function(a){"use strict";var b=function(b,c,d){function e(a){return h.body?a():void setTimeout(function(){e(a)})}function f(){i.addEventListener&&i.removeEventListener("load",f),i.media=d||"all"}var g,h=a.document,i=h.createElement("link");if(c)g=c;else{var j=(h.body||h.getElementsByTagName("head")[0]).childNodes;g=j[j.length-1]}var k=h.styleSheets;i.rel="stylesheet",i.href=b,i.media="only x",e(function(){g.parentNode.insertBefore(i,c?g:g.nextSibling)});var l=function(a){for(var b=i.href,c=k.length;c--;)if(k[c].href===b)return a();setTimeout(function(){l(a)})};return i.addEventListener&&i.addEventListener("load",f),i.onloadcssdefined=l,l(f),i};"undefined"!=typeof exports?exports.loadCSS=b:a.loadCSS=b}("undefined"!=typeof global?global:this);!function(a){if(a.loadCSS){var b=loadCSS.relpreload={};if(b.support=function(){try{return a.document.createElement("link").relList.supports("preload")}catch(b){return!1}},b.poly=function(){for(var b=a.document.getElementsByTagName("link"),c=0;c<b.length;c++){var d=b[c];"preload"===d.rel&&"style"===d.getAttribute("as")&&(a.loadCSS(d.href,d,d.getAttribute("media")),d.rel=null)}},!b.support()){b.poly();var c=a.setInterval(b.poly,300);a.addEventListener&&a.addEventListener("load",function(){b.poly(),a.clearInterval(c)}),a.attachEvent&&a.attachEvent("onload",function(){a.clearInterval(c)})}}}(this);</script></head><body><div class="container"><ol class="breadcrumb"><li><a href="../index.html" class="glyphicon glyphicon-home"></a></li><li><a href="f-65.html">NSIS Discussion</a></li><li class="active">Allow update of license and program</li></ol><p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=325901">Allow update of license and program</a></p><br><div class="post"><p class="post-meta"><span class="post-author text-primary">mvpetrovich</span><br><span class="post-time small text-muted">13th January 2011 04:48 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>Allow update of license and program</strong><br>I am new to NSIS. After 12 years of Installshield Express, I've grown tired of its expense and lack of flexibility. After some effort I basically have my software installation scripts working -- only one slight problem, it does not work on Windows Vista. With my Installshield installations, I had to have two different installation programs for my software -- one for first-time installation, and one for upgrading. I think I have solved this by using NSIS for a single installation program.<br><br>I have a simple installation with a single executable and some optional data files.<br><br>I need advice on the best approach to do the following.<br><br>Once someone installs the software, they need to be able to update the license information. Currently that is stored in HKLM. The license information is updated via a software dialog, so I know that it will be written only if it is valid.<br><br>The second thing I need to be able to do is upgrade the software by overwriting the executable program. With Installshield about 20% of my end users require uninstall of the program before they can upgrade - a problem I cannot duplicate on any of our in-house systems.<br><br>I am thinking to use the AccessControl plug-in.<br><br>I would need to make the HKLM "Software\vendor\program\License" with write permissions.<br><br>I do not like the idea of making the executable writable, except by the subsequent installation program, but may have to do so.<br><br>I am sure this is a common inquiry, but could not find this with my search terms. I appreciate any help.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">MSG</span><br><span class="post-time small text-muted">13th January 2011 07:11 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">If you use HKLM, you always must ask for admin privileges at installation. And since you installed as admin once, it doesn't make sense to 'upgrade' it at userlevel. Your upgrader will simply have to request admin access as well.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">mvpetrovich</span><br><span class="post-time small text-muted">13th January 2011 14:22 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">I was able to do exactly what I had requested using:<br><br></p><pre>
<code>AccessControl::GrantOnRegKey HKLM "Software\vendor\program\License" "Everyone" "FullAccess"</code>
</pre><br><br>This allows updating the license by the user.<br>There is also not a problem with upgrading the files.<br><br>This is great!!</div><hr><div class="footer"><p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p></div></div><script src="../js/highlight.pack.js" type="text/javascript"></script><script type="text/javascript">//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]></script></body></html>