<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="description" content="Installer log"><title>Installer log - NSIS Forums</title><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script><link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css"><link rel="stylesheet" href="../css/style.css" type="text/css"></head><body><div class="container"><ol class="breadcrumb"><li><a href="../index.html" class="glyphicon glyphicon-home"></a></li><li><a href="f-65.html">NSIS Discussion</a></li><li class="active">Installer log</li></ol><p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=217233">Installer log</a></p><br><div class="post"><p class="post-meta"><span class="post-author text-primary">MichaelFlya</span><br><span class="post-time small text-muted">27th May 2005 21:34 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>Installer log</strong><br>I am looking for ways to make a log and<br>uninstall from it. So far I have found a<br>way based on this <a href="http://nsis.sourceforge.net/archive/viewpage.php?pageid=556" target="_blank">Script</a> by Afrow Uk.<br><br>I need to understand how to get a few<br>things to work by log automatically.<br><br>1. Uninstall folders that were created.<br><br>It doesn't seem to do it. Altho I can do<br>it by writting it in the Uninstaller section.<br><br>Attached is the Script I have put together.<br><br>If you know of better ways to do log<br>installations please let me know !!!<br><br>-MichaelFlya-</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br><span class="post-time small text-muted">27th May 2005 22:45 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">You probably missed this bit at the top:<br></p><blockquote>Note: ${SetOutPath} must be used in reverse order of the directory tree, for example:<br>${SetOutPath} "$INSTDIR\dir\subdir\anotherdir"<br>...<br>${SetOutPath} "$INSTDIR\dir\subdir"<br>...<br>${SetOutPath} "$INSTDIR\dir"<br>...<br>...else directories will not be removed on uninstall.</blockquote>It won't delete the folders if they aren't empty.<br>If you're really lazy then just change<br>RMDir $R0 #is dir<br>to<br>RMDir /r $R0 #is dir<br><br>Edit: I changed it to use RMDir /r now. I think that otherwise people will just get annoyed.<br><br>-Stu</div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">MichaelFlya</span><br><span class="post-time small text-muted">27th May 2005 23:05 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Well I understand that, but the Log puts<br>directories before the file deletions.<br><br>In that Script it only installs for example<br>INSTALLERDIR1 with files in it. There is no<br>Subfolders. I can't move SetOutPath there<br>is no point in it. So it just doesn't write the<br>log right. It should write The log to where<br>the directories are after the files not before.<br><br>-MichaelFlya-</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br><span class="post-time small text-muted">28th May 2005 11:09 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Could you show me the code?<br><br>-Stu</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">MichaelFlya</span><br><span class="post-time small text-muted">28th May 2005 14:23 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Well I have no idea why you couldn't<br>see the attachment on the first post,<br>but here you go I will attach it again.<br><br>And since I am posting again I will just<br>explain a few more questions I had on<br>the to do list. If you can help me out.<br><br>2.<br>How could I make a log for a zip ? I have<br>installations from sites that use zips and<br>sometimes the contents may change and<br>in order for me to uninstall them properly<br>I would need a log of what was unzipped.<br><br>3.<br>How would I use it with *.* so all contents<br>in the folder would be on log ?<br><br>4.<br>How could shortcuts also be logged ?<br><br>5.<br>How can Registry Keys be logged ?<br><br>6.<br>How can anything else besides folders and<br>files be logged ? .. lol.<br><br><br>-MichaelFlya-</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">MichaelFlya</span><br><span class="post-time small text-muted">31st May 2005 23:51 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">The thing I need to log the most at the moment<br>is a compressed zip folder. Is there a way to log<br>a Zip while you extract it? That way I can remove<br>only what was unzipped.<br><br>-MichaelFlya-</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">MichaelFlya</span><br><span class="post-time small text-muted">5th June 2005 19:36 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">I found a DLL that allows me to do some things.<br>I am wondering if it's uses can be expanding on.<br><br>(NsisLog.dll)<br>Here is two links where you can find out about it:<br>1.<a href="http://nsis.sourceforge.net/archive/nsisweb.php?page=526&amp;instances=0" target="_blank">Nsislog About DLL</a><br>2.<a href="http://nsis.sourceforge.net/archive/download.php" target="_blank">Nsislog Download DLL</a><br><br><br><br>Using this code with Afrow UK's code.<br>(Not that it is needed to use together):<br><br></p><pre>
<code><br>Section -closelogfile<br> FileClose $UninstLog<br>  nsislog::log "$INSTDIR\uninstall.log" "$INSTDIR\INSTALLERDIR1"<br>  nsislog::log "$INSTDIR\uninstall.log" "$INSTDIR\INSTALLERDIR2"<br>  SetFileAttributes "$INSTDIR\${UninstLog}" READONLY|SYSTEM<br>SectionEnd<br></code>
</pre><br>
      <br>
      Only place it can go because the NsisLog.dll can't write to the<br>
      file until the file is closed from Afrow UK's process and it has<br>
      to go right before the SetFileAttributes are set to read only.<br>
      <br>
      Also on another note I can get that same effect to work right<br>
      with Afrow Uk's code and properly too if I do, for Example<br>
      change the code for "INSTALLERDIR1" like this:<br>
      <br>
      <br>
      (From the script I attached on a post above)<br>
      <br>
      <pre>
<code><br>Section "Install Main"<br> ${SetOutPath} "$INSTDIR\INSTALLERDIR1"<br> ${File} ".\dir1\" "Doc1.txt"<br> ${File} ".\dir1\" "Doc2.txt"<br> ${File} ".\dir1\" "Doc3.txt"<br>SectionEnd<br></code>
</pre><br>
      Change to:<br>
      <br>
      <br>
      <pre>
<code><br>Section "Install Main"<br>SetOutPath "$INSTDIR\INSTALLERDIR1"<br> ${File} ".\dir1\" "Doc1.txt"<br> ${File} ".\dir1\" "Doc2.txt"<br> ${File} ".\dir1\" "Doc3.txt"<br>${SetOutPath} "$INSTDIR\INSTALLERDIR1"<br>SectionEnd<br></code>
</pre><br>
      <br>
      That will write the log right, but it shouldn't have to be<br>
      done that way. Back to the NsisLog.dll it looks like it would<br>
      do more than just files &amp; folders. I have some more testing<br>
      to do on it and more searching to do. I haven't yet found<br>
      good or I should say "Complete" ways to make a log to<br>
      uninstall from.<br>
      <br>
      <br>
      -MichaelFlya-
    </div>
    <hr>

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]></script></body></html>