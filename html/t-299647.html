<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="description" content="semi-silent installer and InstFiles"><title>semi-silent installer and InstFiles - NSIS Forums</title><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script><link rel="preload" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css" as="style" onload="this.rel='stylesheet'"><link rel="preload" href="../css/style.css" as="style" onload="this.rel='stylesheet'"><noscript><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css"><link rel="stylesheet" href="../css/style.css"></noscript><script>!function(a){"use strict";var b=function(b,c,d){function e(a){return h.body?a():void setTimeout(function(){e(a)})}function f(){i.addEventListener&&i.removeEventListener("load",f),i.media=d||"all"}var g,h=a.document,i=h.createElement("link");if(c)g=c;else{var j=(h.body||h.getElementsByTagName("head")[0]).childNodes;g=j[j.length-1]}var k=h.styleSheets;i.rel="stylesheet",i.href=b,i.media="only x",e(function(){g.parentNode.insertBefore(i,c?g:g.nextSibling)});var l=function(a){for(var b=i.href,c=k.length;c--;)if(k[c].href===b)return a();setTimeout(function(){l(a)})};return i.addEventListener&&i.addEventListener("load",f),i.onloadcssdefined=l,l(f),i};"undefined"!=typeof exports?exports.loadCSS=b:a.loadCSS=b}("undefined"!=typeof global?global:this);!function(a){if(a.loadCSS){var b=loadCSS.relpreload={};if(b.support=function(){try{return a.document.createElement("link").relList.supports("preload")}catch(b){return!1}},b.poly=function(){for(var b=a.document.getElementsByTagName("link"),c=0;c<b.length;c++){var d=b[c];"preload"===d.rel&&"style"===d.getAttribute("as")&&(a.loadCSS(d.href,d,d.getAttribute("media")),d.rel=null)}},!b.support()){b.poly();var c=a.setInterval(b.poly,300);a.addEventListener&&a.addEventListener("load",function(){b.poly(),a.clearInterval(c)}),a.attachEvent&&a.attachEvent("onload",function(){a.clearInterval(c)})}}}(this);</script></head><body><div class="container"><ol class="breadcrumb"><li><a href="../index.html" class="glyphicon glyphicon-home"></a></li><li><a href="f-65.html">NSIS Discussion</a></li><li class="active">semi-silent installer and InstFiles</li></ol><p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=299647">semi-silent installer and InstFiles</a></p><br><div class="post"><p class="post-meta"><span class="post-author text-primary">Animaether</span><br><span class="post-time small text-muted">7th November 2008 10:51 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>semi-silent installer and InstFiles</strong><br>I'm currently making an installer semi-silent by allowing for unattended installation using a sort of 'preferences file'.<br><br>When a preference is invalid or missing, I still want the user interface to show up - which seems to exclude a silent installer as I can't switch silent mode anywhere outside of .onInit.<br><br>So instead for any page where I do have a valid 'preference', I simply call Abort in the Pre function so that the page never shows, and set any variables/etc. to the appropriate values based on the preference which might otherwise be handled in any Post function.<br><br>This all works quite lovely, but then in comes the special InstFiles page. Calling Abort in its Pre or Show (does it even have one - using MUI?) functions does absolutely bupkis.<br>I can stick HideWindow in the pre function, or in the first section, but that will still flash InstFiles onto the screen for a fraction of a second.<br><br>Now personally I don't mind the InstFiles page popping up - any unattended install isn't going to care about a dialog, as long as the application finishes and exits okay, and personally I like having -some- visual confirmation of things happening even with a silent installation. But for the user expecting a completely invisible installation, I'd still like to be able to hide it completely without any UI flash.<br><br>So... can it be done at all, or am I SOL and just need to deal with the flash? If it -can- be done... how?<br><br>Most of the threads deal with the opposite.. a silent installer that users -do- still want to show the InstFiles page for.. go figure :)<br><br>Thanks in advance!</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">kichik</span><br><span class="post-time small text-muted">7th November 2008 22:58 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">You should use silent installer and set it in .onInit if silent installers is what you want. Simply make sure everything you need is present in the preferences file before you set the silent mode.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Animaether</span><br><span class="post-time small text-muted">8th November 2008 06:38 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">yeah, that's the thing - I don't want a silent installer, but I think what you're saying is.. (pseudocode)<br><br></p><pre>
<code><br>If (not using a preferences file) then (<br>  proceed with installation as a full UI installer<br>)<br>else (<br>  if (all preference values are found and valid) then (<br>    set installation type silent, which hides instFiles<br>  )<br>  else (<br>    proceed with semi-silent installer (some pages may display), instFiles shows up as well as a result<br>  )<br>)<br></code>
</pre><br>
      <br>
      Which is a good idea and I'll have to see how easy that is to implement - duplicating and/or moving code out of pages and to .onInit - thanks :)<br>
      <br>
      I take it that the "don't show instFiles in a non-silent installer" is one of the things that can't be done, though? :)
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br>
      <span class="post-time small text-muted">8th November 2008 10:24 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">You don't have to move the code to .onInit, it can stay in the sections. Only silent installers execute sections code outside of the instfiles page.</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Animaether</span><br>
      <span class="post-time small text-muted">8th November 2008 18:21 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">That'd be fine if all code was within sections - but a lot of it is in pre/post functions for other / custom pages.. those don't seem to get called if the installer is in silent mode.</p>
    </div>
    <hr>

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]></script></body></html>