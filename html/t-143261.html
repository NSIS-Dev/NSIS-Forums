<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="Shortcut Icon" />

  <title>Shortcut Icon - NSIS Forums</title>
  <script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script>
  <!-- Bootstrap core CSS -->

  <link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css" />
  <link rel="stylesheet" href="../css/style.css" type="text/css" /><!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!--[if lt IE 9]>
                <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
                <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->
</head>

<body>
  <div class="container">
    <!-- Put navigation bar here -->

    <ol class="breadcrumb">
      <li><a href="../index.html" class="glyphicon glyphicon-home"></a></li>

      <li><a href="f-65.html">NSIS Discussion</a></li>

      <li class="active">Shortcut Icon</li>
    </ol>

    <p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=143261">Shortcut Icon</a></p><br />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">jcagle</span><br />
      <span class="post-time small text-muted">23rd July 2003 03:01 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>Shortcut Icon</strong><br />
      I have created a VB application that uses a "home-made" icon for the .exe icon. Do I need to copy this icon to the destination hard drive in order to use it for shortcut icons??? I tried simply pointing to the application itself, but that didn't seem to work. So, I guess my full question is:<br />
      <br />
      Is there a way to pull the icon from the .exe or, do I need to copy the icon to the hard drive and use that in the path for my shortcut icon?<br />
      <br />
      Thanks in advance!!</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">dajvid</span><br />
      <span class="post-time small text-muted">23rd July 2003 04:48 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Although I haven't touched VB for a little while, if I recall correctly, you should be able to specify the icon for the application in VB before you compile it.<br />
      <br />
      Is that what you were after? (I found it a little hard to understand what exactly you were asking) Otherwise, you can specify the icon file and index when you create a shortcut in NSIS (it's just in the Users Manual).<br />
      <br />
      Ta,<br />
      Dave.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">jcagle</span><br />
      <span class="post-time small text-muted">23rd July 2003 13:40 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">I'll try to be clearer:<br />
      <br />
      I have a VB application where I've assigned it an icon during compile time...and this works fine. When I install this .exe and make a desktop shortcut to this .exe on the destination machine, the shortcut does NOT display the icon. I attempted to set the icon parameter of the "CreateShortcut" method in NSIS to the .exe...hoping that the shortcut would pick-up the icon from that .exe...but, it doesn't appear to work. So, I've ended up copying the actual .ico onto the destination machine and setting the CreateShortcut icon parameter to this .ico...which works.<br />
      <br />
      My question is:<br />
      Is there a way to get the CreateShortcut icon parameter to pull the icon from the .exe? I would rather not copy my .ico onto the destination machine...if possible.<br />
      <br />
      Thanks again, and sorry for the confusion my first posting may have caused!</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Vytautas</span><br />
      <span class="post-time small text-muted">23rd July 2003 13:58 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">This code should work:</p>
      <pre>
<code>CreateShortCut "$SMPROGRAMS\Example\Example.lnk" "$INSTDIR\vbprog.exe" "" "$INSTDIR\vbprog.exe" 0</code>
</pre><br />
      Vytautas
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">jcagle</span><br />
      <span class="post-time small text-muted">23rd July 2003 14:21 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">That's exactly what I tried, Vytautas, but it doesn't seem to work. I'll try it again when I get to my home PC...but, I'm expecting it not to work. Any other suggestions?</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Vytautas</span><br />
      <span class="post-time small text-muted">23rd July 2003 14:24 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Make sure that you include the empty quotes <b>""</b>. Also does the shortcut display any icon and if so what does it look like, attach a screenshot if possible.<br />
      <br />
      Vytautas</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">jcagle</span><br />
      <span class="post-time small text-muted">23rd July 2003 15:21 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">The icon that gets displayed is the default .exe windows icon...you know, the white box with a blue bar across the top. I'm away from my home PC right now or else I'd post a screen shot. You can see the icon I'm talking about by simply creating hello.txt and renaming it to hello.exe in a folder within windows.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">ramon18</span><br />
      <span class="post-time small text-muted">28th July 2003 12:36 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">You can analyse the problem using the Explorer's<br />
      properties TAB -&gt; ChangeIcon, then you can see how many icons your exe have and which index is the correct,<br />
      <br />
      good luck,<br />
      Ramon</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">jcagle</span><br />
      <span class="post-time small text-muted">28th July 2003 13:04 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Thanks, that's a good idea, ramon18!</p>
    </div>
    <hr />

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]>
  </script>
</body>
</html>
