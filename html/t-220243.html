<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="description" content="Unexpected $PLUGINSDIR directory launch"><title>Unexpected $PLUGINSDIR directory launch - NSIS Forums</title><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script><link rel="preload" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css" as="style" onload="this.rel='stylesheet'"><link rel="preload" href="../css/style.css" as="style" onload="this.rel='stylesheet'"><noscript><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css"><link rel="stylesheet" href="../css/style.css"></noscript><script>!function(a){"use strict";var b=function(b,c,d){function e(a){return h.body?a():void setTimeout(function(){e(a)})}function f(){i.addEventListener&&i.removeEventListener("load",f),i.media=d||"all"}var g,h=a.document,i=h.createElement("link");if(c)g=c;else{var j=(h.body||h.getElementsByTagName("head")[0]).childNodes;g=j[j.length-1]}var k=h.styleSheets;i.rel="stylesheet",i.href=b,i.media="only x",e(function(){g.parentNode.insertBefore(i,c?g:g.nextSibling)});var l=function(a){for(var b=i.href,c=k.length;c--;)if(k[c].href===b)return a();setTimeout(function(){l(a)})};return i.addEventListener&&i.addEventListener("load",f),i.onloadcssdefined=l,l(f),i};"undefined"!=typeof exports?exports.loadCSS=b:a.loadCSS=b}("undefined"!=typeof global?global:this);!function(a){if(a.loadCSS){var b=loadCSS.relpreload={};if(b.support=function(){try{return a.document.createElement("link").relList.supports("preload")}catch(b){return!1}},b.poly=function(){for(var b=a.document.getElementsByTagName("link"),c=0;c<b.length;c++){var d=b[c];"preload"===d.rel&&"style"===d.getAttribute("as")&&(a.loadCSS(d.href,d,d.getAttribute("media")),d.rel=null)}},!b.support()){b.poly();var c=a.setInterval(b.poly,300);a.addEventListener&&a.addEventListener("load",function(){b.poly(),a.clearInterval(c)}),a.attachEvent&&a.attachEvent("onload",function(){a.clearInterval(c)})}}}(this);</script></head><body><div class="container"><ol class="breadcrumb"><li><a href="../index.html" class="glyphicon glyphicon-home"></a></li><li><a href="f-65.html">NSIS Discussion</a></li><li class="active">Unexpected $PLUGINSDIR directory launch</li></ol><p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=220243">Unexpected $PLUGINSDIR directory launch</a></p><br><div class="post"><p class="post-meta"><span class="post-author text-primary">grahama</span><br><span class="post-time small text-muted">29th June 2005 17:59 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>Unexpected $PLUGINSDIR directory launch</strong><br>At the end of my installer script, I am using ExecShell to open a file downloaded to the $PLUGINSDIR with:<br>ExecShell "open" '"$PLUGINSDIR\${FILENAME}.mov"'</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br><span class="post-time small text-muted">29th June 2005 18:55 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Try just:<br>ExecShell "open" "$PLUGINSDIR\${FILENAME}.mov"<br><br>What is ${FILENAME} at that time (check with a MessageBox for example).<br><br>-Stu</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">grahama</span><br><span class="post-time small text-muted">29th June 2005 20:36 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Ok, I think I finally narrowed it down...<br>;<br>If I disable every occurence of 'setoutpath' execept for the mySpash Function below, the unexpected directory launch is the last setoutpath command in the function...$DESKTOP in this case.<br>;<br>If I disable ALL setoutpath commands, the project directory [where the exe is compiled] unexpectedly launches...<br>Is there a way to suppress these directory launches ?<br>strange bug...<br>;<br>Function mySplash<br>InitPluginsDir<br>SetOutPath "$PLUGINSDIR"<br>File /oname=$PLUGINSDIR\splash.bmp "${FILENAME}.bmp"<br>advsplash::show 1500 600 400 0xFFFFFF $PLUGINSDIR\splash.bmp<br>Pop $0<br>Delete $PLUGINSDIR\splash.bmp<br>SetOutPath "$DESKTOP"<br>FunctionEnd</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br><span class="post-time small text-muted">29th June 2005 20:47 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Could you attach your script?<br><br>-Stu</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">grahama</span><br><span class="post-time small text-muted">30th June 2005 00:25 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">it is a bit long, but the main function that seems to be causing/controlling the directory launch is mySplash..<br>Editing the setoutpath location on the last line of the function will control which directory launches.<br>;<br>if I disable the mySplash function, then the directory of the compiled exe launches<br>;<br>Also, the directory launch only occurs on a full install located in 'Section "FullInstall" SecDummy'</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br><span class="post-time small text-muted">30th June 2005 13:50 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">I noticed this:<br>Function InstallQuickTimeFromDVD<br>ExecWait '"$qtInstallerLoc"'<br>FunctionEnd<br>Could this be it?<br><br>Edit: Nevermind, that's a website URL.<br><br>-Stu</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br><span class="post-time small text-muted">30th June 2005 13:53 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">I noticed that you're using a s**t load of variables. These can take up a lot of memory on run time, and a lot of them could easily have been used as !define's instead (which are only used on compile-time.)<br><br>The only thing that could possibly be causing this is the double quotes on all the exec's (e.g. '"file.ext"'. This isn't necessary. Try changing them all.<br><br>-Stu</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">grahama</span><br><span class="post-time small text-muted">30th June 2005 16:28 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">thanks Afrow :)<br>I'll give it a try<br>thanks for taking a look<br>yes, the variables got a bit out of control on this project<br>If I use this one as a shell for another project, I'll be slashing and burning as far as variables go<br>g</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">grahama</span><br><span class="post-time small text-muted">30th June 2005 18:50 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">changed all exec commands to :<br>ExecWait '$R0'<br>or<br>ExecShell 'open' '$R0'<br><br>is there anything else that could be causing the directory launch</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br><span class="post-time small text-muted">30th June 2005 19:02 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">I couldn't find anything. Could you make a cut down version of your script which we can test that produces the problem. We can't test the current one because we don't have the files and stuff to go with it.<br><br>-Stu</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">grahama</span><br><span class="post-time small text-muted">30th June 2005 19:13 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">thanks Afrow :)<br>let me see what I can come up with<br>might be better for me to zip the whole project which is fairly small as all the major stuff is downloaded from the server<br>I'll include the extra plugins too...<br>and give a link to the .zip'd project</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br><span class="post-time small text-muted">30th June 2005 19:20 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Yeh that will work also :)<br><br>-Stu</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">grahama</span><br><span class="post-time small text-muted">1st July 2005 01:08 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Hi Afrow :)<br>I sent you a private message with a project link<br>thanks for taking a look as I am very stumped<br><br>g</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br><span class="post-time small text-muted">1st July 2005 11:05 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">You mean e-mail or on here... I haven't got any new PM's.<br>I'm currently at college (no NSIS compiler here!) I'll be getting home about 7GMT tonight so I'll take a good look then.<br><br>-Stu</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">grahama</span><br><span class="post-time small text-muted">1st July 2005 17:57 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">yes, I sent you a priave email on this discussion board<br>I'll send you another one just in case.<br>;<br>what are you studying ? College for me was about 10 years ago...Got so burned out after graduation, I could not enjoy reading books for 1 year. Kind of sad.<br>g</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br><span class="post-time small text-muted">1st July 2005 20:26 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Pure maths, business, accounting and computing.<br><br>So when is the directory actually launched?<br><br>There's a lot of warnings after compile. You might want to check them all out.<br><br>-Stu</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">grahama</span><br><span class="post-time small text-muted">1st July 2005 22:02 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">;Pure math<br>Differential equations and such ?<br>I got a Finance Economics BS...and then became a professional composer for TV commercials..strange paths<br>at least, my degree made me lose my fear of numbers for writing budgets.<br>;<br>I checked the warnings out. At first glance, it seems none of them would cause a window launch. Most of them are from the writeXML.nsh file which is a bit older and needs house cleaning. I removed the writeXML.nsh to see if its functions were causing the problem. Directory still launches :(<br>;<br>The directory launches ONLY on a Full Install where the 3rd party installer QuickTimeInstaller.exe is executed. On the final ExecShell:<br>ExecShell 'open' '$PLUGINSDIR\${FILENAME}.mov' on line 437 in the function 'FullInstall' in the .nsi file, the window launches...Wierd<br>;<br>g</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br><span class="post-time small text-muted">2nd July 2005 00:08 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">What happens if the ExecShell line is commented out?<br><br>-Stu</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">grahama</span><br><span class="post-time small text-muted">2nd July 2005 01:04 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">the directory still launches :(<br>;<br>If I disable the launch of the 3rd party installer, , ExecWait '$PLUGINSDIR\QuickTimeFullInstaller.exe' $0<br>the directory does NOT launch.<br>;<br>Strangely, the 3rd Party Installer is not asking for a SPECIFIC directory launch as the last setoupath command controls which directory pops up<br>;<br>is there some system call that would supress the launch ?<br>g</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br><span class="post-time small text-muted">2nd July 2005 12:32 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">SetOutPath will be setting the working directory for QuickTimeFullInstaller.exe<br>Try placing SetOutPath "" before the ExecWait instruction.<br><br>-Stu</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">grahama</span><br><span class="post-time small text-muted">2nd July 2005 17:59 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">If I clear the Working Directory,the $EXEDIR directory pops up.<br>Seems like the option at this point is to redesign the 3rd party installer and combine it with my NSIS installer :( I guess it is too much for a billion dollar company to make a decent installer package. In my experience, Apple is pretty consistently at war with its own developers.<br>;<br>Is there some way to 'listen' for a directory launch call and squash it before it executes? Maybe, a system command can save the day. Otherwise, I'll have to open up another can of worms.<br>;<br>thanks for walking me thru the debug,Afrow :)<br>g</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Anders</span><br><span class="post-time small text-muted">2nd July 2005 19:43 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">What about setting the working dir to a folder that doesnt exist or a invalid directory name? (Not sure if SetOutPath catches this, if it does u could call the raw api)</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">grahama</span><br><span class="post-time small text-muted">3rd July 2005 01:51 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">will try the above :)<br>Also, the directory only launches in Win2000 and 98<br>For XP, everything works just fine..<br>weird<br>g</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">grahama</span><br><span class="post-time small text-muted">3rd July 2005 17:19 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">I setoutpath'd to "blah\blah\nonextistent"<br>seems the command was ignored<br>;<br>strangely, when I setoutpath to the above, the installer waited an extra 2 seconds before it launched the directory<br>maybe it was thinking ;)<br>;<br>At this point, if faced with this kind of thing, would you guys create your own distribution of a major piece of software? Wonder if there are any legalities lurking there ? Or, would you roll with bug and use the opened directory to house a ReadMe file and some goodies...<br>g</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br><span class="post-time small text-muted">4th July 2005 09:07 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Don't forget that SetOutPath will recursively create the path that you give it, so giving it a bad path might confuse it! Or it will create the directory path in the root.<br><br>Sounds like it's the QuickTimeFullInstaller.exe at fault here. What if you make it run another executable... does a folder still open?<br><br>-Stu</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">grahama</span><br><span class="post-time small text-muted">4th July 2005 18:32 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">I narrowed it down to ANOTHER executable ,QTPluginInstaller.exe, called WITHIN QuicktimeFullInstaller.exe.<br>;<br>As long as QTPluginInstaller.exe is run, the working directory will launch. Thankfully, the problem is only for 2000/98 and does not happen on XP.<br>;<br>If I can't get a response from Apple/QuickTime a week after this week's holiday, I'll redesign the installer. Sometimes Apple responds quickly, and sometimes they do not respond at all despite repeated attempts.<br>;<br>Thankfully, I have an exe that converts reg values to a nsis script...so it should not be too hard. Lots of files and reg values...<br>;<br>Maybe this is a good thing....<br>Executing 3rd party installer within a main installer is kind of kludgy anyway and looks a bit ugly.<br>g</p></div><hr><div class="footer"><p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p></div></div><script type="text/javascript" src="../js/highlight.pack.js" async></script><script type="text/javascript">//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]></script></body></html>