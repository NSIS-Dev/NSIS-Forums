<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="description" content="How to 'Quit' from a custom page's leave function!?"><title>How to 'Quit' from a custom page's leave function!? - NSIS Forums</title><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script><link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css"><link rel="stylesheet" href="../css/style.css" type="text/css"><!--[if lt IE 9]><script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script><script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script><![endif]--></head><body><div class="container"><ol class="breadcrumb"><li><a href="../index.html" class="glyphicon glyphicon-home"></a></li><li><a href="f-65.html">NSIS Discussion</a></li><li class="active">How to 'Quit' from a custom page's leave function!?</li></ol><p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=140929">How to 'Quit' from a custom page's leave function!?</a></p><br><div class="post"><p class="post-meta"><span class="post-author text-primary">psyke</span><br><span class="post-time small text-muted">3rd July 2003 03:49 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>How to 'Quit' from a custom page's leave function!?</strong><br>Hello,<br><br>I am using the latest nightly snapshot of NSIS and have run into something. I want to kill or 'Quit' an installer from a custom page's leave function.<br><br>However, as far as I can see, the 'Quit' statement when executed from a custom page's leave function does NOT exit the installer. Instead, it behaves as if I had written 'Abort' instead. I.e. it causes the installer to remain on the current page.<br><br>Is this the correct behaviour for the 'Quit' statement in this context? If so, how can I force the installer to exit from a custom page's leave function?<br><br>Thanks in advance. :)<br><br>(BTW to reproduce the issue I am describing you can download the attached modification of Contrib\InstallOptions\test.nsi - only lines 70 and 71 are new, the rest is the original script.)</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">psyke</span><br><span class="post-time small text-muted">3rd July 2003 03:55 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Just a sort of mini follow-up...<br><br>Actually what I really want to do is have the custom page's leave function call another function which causes the installer to exit. The problem is exactly as described earlier though, the installer won't quit.<br><br>The leave functio calls the quitting function just fine, but the isntaller doesn't quit and instead just sits on the current page.<br><br>Once again, I've attached a straightforward modification of Contrib\InstallOptions\test.nsi.<br><br>Thanks again. :)</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">pengyou</span><br><span class="post-time small text-muted">3rd July 2003 10:45 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Why not have the leave function set an exit code in a register (or on the stack) then the function that creates the custom page can check to see if the installer should quit?<br><br>Here is a modified version of your script that I hope does what you want.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">psyke</span><br><span class="post-time small text-muted">3rd July 2003 12:32 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">pengyou: Thank you, your suggestion does achieve what I want. :) I will use this approach unless a more direct solution emerges.<br><br>Ideally I would like to be able to use 'Quit' directly (the documentation for the command and the documenatation for page callbacks does not indicate that Quit cannot be used in a custom page's leave function) or something along those lines.<br><br>I find it interesting that 'Quit' behaves as expected when used in a page creation function and then differently in the leave function.<br><br>Thanks again for your suggestion pengyou. :)</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">pengyou</span><br><span class="post-time small text-muted">3rd July 2003 12:51 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Glad I was able to help!<br><br>Custom page "leave" functions only appeared a few months ago and are a big improvement. I find them very useful when validating user input, even if there are a few limitations (so far I've not come across anything major).</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">psyke</span><br><span class="post-time small text-muted">3rd July 2003 13:29 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">I agree pengyou, NSIS has become so much better over the past few months that it almost cannot be believed. :D<br><br>I've been toying with my installer and I got it to commit suicide... It was a little more complex than I thought though because the Suicide/Quit function is being called from *several* points in the script. So I needed to add some flags to check if it was called from the custom page's leave function, in which case it sets an exit code which is then checked in the custom page's create function. This stuff doesn't happen of course for all other calls to the Suicide/Quit function.<br><br>However, the Suicide/Quit function is *supposed* to be a cleanup function: do some things, then terminate the installer with extreme prejudice - I don't want control to return from the Suicide/Quit function under any circumstances - this is why I added a 'Quit' statement to it on the first place.<br><br>So is it possible to 'Quit' or somehow terminate an installer from a function called from a custom page's leave function? ;)<br><br>(An example of what I'm trying to do is in the attachment to the second post in this thread. The 'Suicide' function *has* to be called from the custom page's leave function, and the 'Suicide' function has to Quit the installer, it cannot return control. :|)</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">kichik</span><br><span class="post-time small text-muted">4th July 2003 14:23 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Quit should work from custom page's leave function. I'll check it out.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">psyke</span><br><span class="post-time small text-muted">4th July 2003 15:10 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Thank you Kichik, it's nice to know that 'Quit' is supposed quit the installer even from a custom page's leave function.<br><br>I greatly appreciate that you are willing to look into this matter, I can't imagine what the demands on your time must be like.<br><br>Thanks again. :)</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">ramon18</span><br><span class="post-time small text-muted">8th July 2003 11:22 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Hi,<br><br>This problem is fixed now, check CVS later<br><br>Ramon</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">psyke</span><br><span class="post-time small text-muted">9th July 2003 19:47 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Thanks Ramon, I got the latest snapshot and it's working great now. :D<br><br>Once again, many thanks. :)</p></div><hr><div class="footer"><p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p></div></div><script src="../js/highlight.pack.js" type="text/javascript"></script><script type="text/javascript">//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]></script></body></html>