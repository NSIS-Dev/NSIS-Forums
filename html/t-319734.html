<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="description" content="What Is Root Dir For NSIS Script?"><title>What Is Root Dir For NSIS Script? - NSIS Forums</title><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script><link rel="preload" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css" as="style" onload="this.rel='stylesheet'"><link rel="preload" href="../css/style.css" as="style" onload="this.rel='stylesheet'"><noscript><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css"><link rel="stylesheet" href="../css/style.css"></noscript><script>!function(a){"use strict";var b=function(b,c,d){function e(a){return h.body?a():void setTimeout(function(){e(a)})}function f(){i.addEventListener&&i.removeEventListener("load",f),i.media=d||"all"}var g,h=a.document,i=h.createElement("link");if(c)g=c;else{var j=(h.body||h.getElementsByTagName("head")[0]).childNodes;g=j[j.length-1]}var k=h.styleSheets;i.rel="stylesheet",i.href=b,i.media="only x",e(function(){g.parentNode.insertBefore(i,c?g:g.nextSibling)});var l=function(a){for(var b=i.href,c=k.length;c--;)if(k[c].href===b)return a();setTimeout(function(){l(a)})};return i.addEventListener&&i.addEventListener("load",f),i.onloadcssdefined=l,l(f),i};"undefined"!=typeof exports?exports.loadCSS=b:a.loadCSS=b}("undefined"!=typeof global?global:this);!function(a){if(a.loadCSS){var b=loadCSS.relpreload={};if(b.support=function(){try{return a.document.createElement("link").relList.supports("preload")}catch(b){return!1}},b.poly=function(){for(var b=a.document.getElementsByTagName("link"),c=0;c<b.length;c++){var d=b[c];"preload"===d.rel&&"style"===d.getAttribute("as")&&(a.loadCSS(d.href,d,d.getAttribute("media")),d.rel=null)}},!b.support()){b.poly();var c=a.setInterval(b.poly,300);a.addEventListener&&a.addEventListener("load",function(){b.poly(),a.clearInterval(c)}),a.attachEvent&&a.attachEvent("onload",function(){a.clearInterval(c)})}}}(this);</script></head><body><div class="container"><ol class="breadcrumb"><li><a href="../index.html" class="glyphicon glyphicon-home"></a></li><li><a href="f-65.html">NSIS Discussion</a></li><li class="active">What Is Root Dir For NSIS Script?</li></ol><p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=319734">What Is Root Dir For NSIS Script?</a></p><br><div class="post"><p class="post-meta"><span class="post-author text-primary">jepboro</span><br><span class="post-time small text-muted">7th June 2010 08:01 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>What Is Root Dir For NSIS Script?</strong><br>I'v never used nsis before and now I am using a script I've adapted from a sample install script I found on the web.<br><br>It seems I've done something wrong because it always aborts after failing to find an icon file which is clearly there.<br><br>If I change the icon address from the MUI thing and instead write in a string with the full path: C:\myprog\myprogicon.ico it find the icon file alright and processes it and moves on... only to fail a little further for an identical reason.<br><br>So it seems to me that path is the problem. Somehow the right path is not defined.<br><br>Is this right? Could this be it? How do I properly set it or define those MUI things or whatever to make it work?<br><br>Here's the last part of the NSIS log of the failure:<br><br><br><br>!define: "myprog_INSTALLDIR"="myprog"<br>!define: "myprog_EXENAME"="myprog"<br>Name: "My Little Progr"<br>OutFile: "myprog_win32_installer.exe"<br>InstallDir: "$PROGRAMFILES\myprog"<br>InstallRegKey: "HKCU\Software\myprog\"<br>SetCompressor: lzma<br>ShowInstDetails: show<br>ShowUninstDetails: show<br>Var: "StartMenuFolder"<br>!define: "MUI_ICON"="myprog\myprogicon.ico"<br>!define: "MUI_WELCOMEPAGE_TITLE"="Install Myrpog"<br>!define: "MUI_WELCOMEPAGE_TEXT"="Myprog is a free open source prog written in the python programming language, available under the terms of the GNU General Public License.<br><br>!insertmacro: MUI_PAGE_WELCOME<br>Error while loading icon from "myprog\myprogicon.ico": can't open file<br>Error in macro MUI_INTERFACE on macroline 64<br>Error in macro MUI_PAGE_INIT on macroline 3<br>Error in macro MUI_PAGE_WELCOME on macroline 5<br>Error in script "C:\myprog\myprog_install_script.nsi" on line 62 -- aborting creation process</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">MSG</span><br><span class="post-time small text-muted">7th June 2010 09:02 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">The root dir for an nsis script is the directory where the nsis script is stored. So if your script is C:\Projects\YourProject\YourScript.nsi, the compiler will be looking for the ico file in C:\Projects\YourProject\myprog\myprogicon.ico. Note that the installer icon location is a compiletime specification (requiring a compiletime path as I explained), while icon locations for start menu/desktop shortcuts are runtime specifications (requiring a runtime path such as $INSTDIR\icon.ico).</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">jepboro</span><br><span class="post-time small text-muted">7th June 2010 09:14 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Thank you very much for your reply.<br><br>That's what I thought would be the case. You can see from the last line of the output where the script is:<br><br>Error in script "C:\myprog\myprog_install_script.nsi" on line 62 -- aborting creation process<br><br>So I copied the script into C:\ and ran it from there.<br><br>Thinking it should then look in C:\myprog for the icon and all other files, which is where they are.<br><br>But:<br><br>No better. Exactly the same result. That's when I was stumped and turned to the web and forums and here...<br><br>:(<br><br>p.s.<br><br>Here's the full output except I've cut out most of the long list of included "plugin.dlls"<br><br><br>MakeNSIS v2.46 - Copyright 1995-2009 Contributors<br>See the file COPYING for license details.<br>Credits can be found in the Users Manual.<br><br>Processing config:<br>Processing plugin dlls: "C:\Program Files\NSIS\Plugins\*.dll"<br>- AdvSplash::show<br>ialHangup<br>- Dialer::AutodialOnline<br>- Dialer::AutodialUnattended<br>-<br><br>- nsExec::Exec<br>- nsExec::ExecToLog<br>- nsExec::ExecToStack<br><br>!define: "MUI_INSERT_NSISCONF"=""<br><br>Changing directory to: "C:"<br><br>Processing script file: "C:\myprog_install_script.nsi"<br>!include: "C:\Program Files\NSIS\Include\MUI2.nsh"<br>!include: "C:\Program Files\NSIS\Contrib\Modern UI 2\MUI2.nsh"<br>NSIS Modern User Interface version 2.0 - Copyright 2002-2009 Joost Verburg (C:\Program<br><br>Files\NSIS\Contrib\Modern UI 2\MUI2.nsh:8)<br>!define: "MUI_INCLUDED"=""<br>!define: "MUI_SYSVERSION"="2.0"<br>!define: "MUI_VERBOSE"="3"<br>!include: closed: "C:\Program Files\NSIS\Contrib\Modern UI 2\MUI2.nsh"<br>!include: closed: "C:\Program Files\NSIS\Include\MUI2.nsh"<br>!define: "myprog_NAME"="myprog"<br>!define: "myprog_VERSION"="1.2.1"<br>!define: "myprog_INSTALLDIR"="myprog"<br>!define: "myprog_EXENAME"="myprog"<br>Name: "myprog"<br>OutFile: "myprog-1.2.1_win32_installer.exe"<br>InstallDir: "$PROGRAMFILES\myprog"<br>InstallRegKey: "HKCU\Software\myprog\"<br>SetCompressor: lzma<br>ShowInstDetails: show<br>ShowUninstDetails: show<br>Var: "StartMenuFolder"<br>!define: "MUI_ICON"="myprog\myprogicon.ico"<br>!define: "MUI_WELCOMEPAGE_TITLE"="Install myprog"<br>!define: "MUI_WELCOMEPAGE_TEXT"="myprog is a free open source prog."<br><br><br>!insertmacro: MUI_PAGE_WELCOME<br>Error while loading icon from "myprog\myprogicon.ico": can't open file<br>Error in macro MUI_INTERFACE on macroline 64<br>Error in macro MUI_PAGE_INIT on macroline 3<br>Error in macro MUI_PAGE_WELCOME on macroline 5<br>Error in script "C:\myprog_install_script.nsi" on line 62 -- aborting creation process<br><br>==========================<br><br>I wonder where can I see these macros to check them out if that'd help?<br><br>I've googled and I've seen there's tons - tons - of help with nsis. Unfortunately there's too much! I can't make my way through it. I can't distinguish which bit it is I want to find the answers I want. Every page I went to had an alphabetical breakdown of sub-subjects and left me floundering as to which one to look in.<br>Looking in a few likely ones just left me with a headache, didn't provide the answer.<br><br>I was hoping this script was a basic template and I could just alter it to suit but it is not working out like that.<br><br>Could you direct me to a basic, totally stripped down, template that i can use like that? To make the most basic of installers just as a starting point?</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">MSG</span><br><span class="post-time small text-muted">7th June 2010 11:45 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"></p><blockquote><small>Originally posted by jepboro</small><br>Could you direct me to a basic, totally stripped down, template that i can use like that? To make the most basic of installers just as a starting point?</blockquote>That would definitely be NSIS\Examples\Example1.nsi and Example2.nsi. Use the command reference to find out what the commands do: <a href="http://nsis.sourceforge.net/Docs/Chapter4.html" target="_blank">http://nsis.sourceforge.net/Docs/Chapter4.html</a><br><br>As for the icon problem, you shouldn't put anything in C:\, because the root directory of your boot drive is special. Just like you shouldn't put anything in c:\Windows, etc. Anyway, if the compiler says it cannot open the icon file, then it probably cannot open the icon file. Either the file is locked (icon editor?) or the file doesn't exist (wrong filename?).</div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br><span class="post-time small text-muted">7th June 2010 17:15 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Makensis works relative to where the script being built is. It has nothing to do with the root. If your icon is in the same folder as the script then you just specify the icon file name.<br><br>Stu</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">MSG</span><br><span class="post-time small text-muted">7th June 2010 17:26 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"></p><blockquote><small>Originally posted by Afrow UK</small><br>Makensis works relative to where the script being built is. It has nothing to do with the root. If your icon is in the same folder as the script then you just specify the icon file name.</blockquote>Yeah, what he meant by 'root' was just the working dir.</div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">jepboro</span><br><span class="post-time small text-muted">10th June 2010 04:41 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Yep, that's right. I meant the working dir, sorry.<br><br>The file does exist. I mentioned that when I gave the precise path it found the file okay - oh, well, didn't complain about the file at all.<br><br>and I can click on the file and have it open and show an icon, so that's okay.<br><br>Thanks for the clues on a 'basic' script and such. I'll check it all out. I did find two basic scripts, perhaps even they were the ones you point to, and they didn't solve the problem for me because of being too different to the one I started with. Which, I think I mentioned, I cut and pasted and modified to suit my own prog.<br><br>Looks like I am going to have to do the hard yards, get down to it and figure out what each part of the script is really about and what is needed and what isn't... suss it all out, learn something.<br><br>I've been trying to get out of it easily and its not working.....<br><br>Actually I've sort of been looking for an nsis page that says something like "To make an installer for your exe file "yourfile.exe" just replace every occurrence of 'ourfile.exe' in the following script with 'yourfile.exe'<br><br>But I guess it simply cannot be that simple. Virtually everything you write for windows has dependencies nowadays, I suppose and single standalone .exe files are rarer and rarer. A prog that catered to them would be catering to a niche market I guess...<br><br>I'll go see if I can actually do some thinking.... ouch....<br><br>thanks for the help<br><br>:)<br><br>p.s. Shouldn't put anything in the C: root dir? Then a 3.7Gig C:\ dir with 1,127 objects would be sort of going the wrong way?</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">MSG</span><br><span class="post-time small text-muted">10th June 2010 07:48 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"></p><blockquote><small>Originally posted by jepboro</small><br>The file does exist. I mentioned that when I gave the precise path it found the file okay - oh, well, didn't complain about the file at all.</blockquote>Well like I said, if the compiler cannot open the file, then it probably cannot open it for some reason. For your icon problem, that's all you have to figure out. The rest of the nsi script doesn't have much to do with this.<br><br><blockquote><small>Originally posted by jepboro</small><br>p.s. Shouldn't put anything in the C: root dir? Then a 3.7Gig C:\ dir with 1,127 objects would be sort of going the wrong way?</blockquote>Uhm... Yeah, that would indeed be quite wrong. I would suggest putting it in a subdirectory.</div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">jepboro</span><br><span class="post-time small text-muted">10th June 2010 12:22 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">It's alright. I am getting somewhere now. I had to write the full pathname for that 'file' thing just as I had to for the icon thing and then it raced away, doing its thing. Manufactured an install .exe, even. Doesn't work properly but I think I know why that is. I just couldn't understand why nsis couldn't find those files and I still don't know, but I don't care right now, horse before the cart, let me get on with producing the .exe and a viable installer for it, that's all.<br><br>thanks a lot for your help, all.<br><br>I might move that c: collection to a subdir but, apart from an increasing hassle finding things I've put there, I see no disadvantage in having a full root dir. What problem do you see, in fact, or is it just a 'neatness' thing?</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">demiller9</span><br><span class="post-time small text-muted">10th June 2010 15:32 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"></p><blockquote>I see no disadvantage in having a full root dir</blockquote>Well, one problem I'm aware of is that if the root dir gets <i>too</i> full the computer won't boot, saying "NTLDR is missing". Even deleting files at that time doesn't cure that problem.<br><br>People here at work occasionally have unzipped our project to the root of their computer (25000 files in that zip) and that's the result. It can be repaired, but needs a special program on a bootable cd to fix. Microsoft thinks they've fixed it (see <a href="http://support.microsoft.com/kb/320397" target="_blank">http://support.microsoft.com/kb/320397</a>) but we still have the problem.</div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">jepboro</span><br><span class="post-time small text-muted">11th June 2010 00:04 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Well that's a valid point if I get nearly 25000 entries. But until then...<br><br>On the side of having many things in the c dir it can be said that much goes there by default so you don't have to fight against the tide and, secondly, it is handy to have things in one heap, it makes for easier searching.<br><br>I've also got another 600gig or so of directories and files and searching for stuff on C:, annoying though I often find it, is easier than searching through all that lot.<br><br>There's a 'filing clerk' skill required that I don't seem to have in any great measure...<br><br>:)</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">againmistake</span><br><span class="post-time small text-muted">11th June 2010 06:10 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">yes that cool</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br><span class="post-time small text-muted">11th June 2010 11:01 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">I never use Windows search due to the fact that I store everything in a folder tree. Each installer has its own folder and sub folders. You sound like my dad who's filled up my old computer with crap because he doesn't know how not to :p He's generally very untidy in real life too...<br><br>I suppose though from using computers at an early age I've been able to learn how to organise stuff. It's too late for some though lol<br><br>Stu</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">jepboro</span><br><span class="post-time small text-muted">12th June 2010 00:26 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Yes, I'm probably even older than your dad.... It might not be quite as simple as you think, though. You've been with computers all your life, you say, and that's perhaps pertinent - you've got no life before computers, me and your dad, we do.<br><br>We've got a whole life prior to your life and 'leftovers' and things pertinent to it that we keep. On the computer, in drawers, in boxes, in the shed....<br><br>'We' probably keep a whole swag of things just for you - been keeping things for the kids since they were babies - 'Here's your bag, it was where you left it..', here's this, here's that...<br><br>And right here on my computer things ain't as bad as perhaps they sound. Sequoia shows me the situation in overview and I check it out quite frequently. 80% of my C: dir drive is My Documents and Program Files.<br><br>There's 387 objects in my Program Files and that means more than 300 installed programs, doesn't it? And that's a reflection of my wide ranging interests and a trail back through time showing how those interests have wandered around.<br><br>The internet, mate, is the most wonderful thing ever happened to the working people of the world, the 'peasants' of the world. We've got more there than ordinary people have ever, ever had. We are immeasurably rich with access to knowledge and abilities..... I've been chasing around in that space besides myself with glee ever since it began (that space), before it began (the internet), just chasing around inside a computer. Picking up riches here and there and everywhere and keeping many of them.<br><br>I knew a guy perhaps like yourself, had the neatest hard drive I've ever seen. He was ruthless and swift deleting temp files and dirs and uninstalling progs he no longer used and deleting data no longer used. He kept no history. He did no 'task switching' - he was interested in only one thing at a time.<br><br>He never kept anything for its own sake. Had no other interest except the job in hand.<br><br>It's a bit like a picture, you see, a painting. I'm painting a rich picture with thousands of colours and shades of colour and entities.... or perhaps a richly woven tapestry might be a better analogy...<br><br><br>That guy painted a primary coloured picture like a cartoon, without shades and anything unnecessary.... That's his bag, that was his bag, his way of doing it.<br><br>My Documents is 70gig of pictures and videos created myself, stock-in-trade, so to speak (not really, I don't 'trade') stuff I work with making dvd's for the family and is like the old time 'family album' but much, much richer than any family album ever existed in the old days.<br><br>It's a work. It's a storehouse. It's a wonder. How young are you? Too young to know about kids, babies? Then you wouldn't be aware of the importance, the significance, of keeping these memories, how valuable they are to so many people, self included.<br><br>My whole computer is a work, a storehouse, a wonderland... I guarantee a person who chose could wander around in my computer, investigating here and there, following this trail and that, and never come out and be totally occupied and satisfied for years - years, that's how much stuff is in there.<br><br>It is a bag of tools. It is a bag of toys. It is a theatre and a sound stage, a school... a pile of materials waiting to be used... There's 200gig of movies on the E: drive. There's a terabyte of backup storage on the I: drive. There's what was once a whole computer on the F: drive (I mean, that's the only disk that computer had and now it's here just as it was )<br><br>There's programmes on my computer that I wrote back in 1987 - possibly before you were even alive. Programmes in Cobol and Fortran. No there's not. I'm a liar. I just took a look and they're not there. Sorry. But I know where they are I think. In the box of old hard drives I have (can you believe a 100Meg hard drive? How about 40Meg?). That's part of the 'mess', I thought I had all them carefully preserved and copied again and again onto each new drive and still existing on these drives now. Apparently not. But there's progs written '90 in Clipper and xBase. Perhaps before you were born. You've had computers all your life, you say, we've had computers all your life and before....<br><br><br>And, of course, nothing to do with it being a full, wonderfully messy (perhaps) computer, but just because it is also an ordinary computer, it has access to the internet, the whole world, all those online people... like now... adding to the riches of it.......<br><br>When I was a kid we had the backyard and the street. Not even television. Not even a motor car in our family. Books from the library only....<br><br>I'm very happy with my computer and the way it is organised even if i do have to hunt around a bit sometimes - well, especially because I have to rummage around a bit sometimes....<br><br>talk a bit too much sometimes, don't I?<br><br>:)</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">MSG</span><br><span class="post-time small text-muted">12th June 2010 07:59 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Sure I can believe a 40Meg harddrive. Can you believe 5? Not everyone's as young as you may think. :)<br><br>Interesting story, albeit it rather beside the topic at hand, and as much as I can admire your appreciation of the possibilities of PCs, there's one thing I'd like to point out in relation to it: There are also a lot of impossibilities. Having some experience with how non-geeks use their computers, I can surmise from the way you describe your PC that you're playing a rather risky game. You cannot trust PCs. It's all well and good, until they blow up in your face. And there is one thing that becomes exceedingly difficult with increasing messiness of your PC: Making backups. It's something worth considering.</p></div><hr><div class="footer"><p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p></div></div><script type="text/javascript" src="../js/highlight.pack.js" async></script><script type="text/javascript">//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]></script></body></html>