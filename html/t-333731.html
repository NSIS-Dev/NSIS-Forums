<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="description" content="UAC Problem with Admin Users"><title>UAC Problem with Admin Users - NSIS Forums</title><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script><link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css"><link rel="stylesheet" href="../css/style.css" type="text/css"><!--[if lt IE 9]><script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script><script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script><![endif]--></head><body><div class="container"><ol class="breadcrumb"><li><a href="../index.html" class="glyphicon glyphicon-home"></a></li><li><a href="f-65.html">NSIS Discussion</a></li><li class="active">UAC Problem with Admin Users</li></ol><p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=333731">UAC Problem with Admin Users</a></p><br><div class="post"><p class="post-meta"><span class="post-author text-primary">vinzon.soliza</span><br><span class="post-time small text-muted">18th August 2011 06:09 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>UAC Problem with Admin Users</strong><br>I used NSIS Installer with UAC plugin, because my programs requires regular users to install it with admin privileges. My desired functionality work properly with the regular users however when I'm installing it on an admin user's account it doesn't work, I can write registry on HKLM that means I may have admin rights, however I cannot successfully register my shellextentions and also after install I noticed my program was always asked by the UAC to elevate. this happens in Vista\7 admin users only. I'm using $APPDATA for my InstallDir, do you have any Idea why this is happening?<br><br>BTW: When I change my InstallDir to like $VIDEO it work properly so I'm assuming there is something wrong or there's something I missed when using the $APPDATA of admin users?</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">MSG</span><br><span class="post-time small text-muted">18th August 2011 06:38 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Just an idea:<br>If UAC is turned on: Even admin users need to elevate. Make sure you do.<br>If UAC is turned off: You shouldn't try to elevate if you're already admin. Make sure you don't.<br><br>As for your application requesting elevation, that's not related to NSIS. You'll need to fix your application yourself. (Probably need to fix the manifest.)</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">vinzon.soliza</span><br><span class="post-time small text-muted">18th August 2011 06:55 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Thanks for the Idea. UAC is turned on: I'm elevating because when I run the installer the UAC will popup and since I'm installing it in admin user It will just ask if I will allow it or not.<br>My application's manifest was set to "AsInvoker" and also I didn't have the requesting elevation problem when I used other Installer.<br>When I changed my InstallDir to other directory like $VIDEO (just to test if it will work in other directory) it works.<br><br>I'm only having this issue with the admin users, it works with the regular users.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">vinzon.soliza</span><br><span class="post-time small text-muted">19th August 2011 10:04 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Hi guys I solved my problem, MSG your right it's not NSIS causing my application to elevate this is because of my machine there's is an existing registry in the AppCompatFlag layers making it runasadmin. Thanks!</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">kraucer</span><br><span class="post-time small text-muted">10th March 2012 00:34 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Hello,<br><br>The VLC Player installer uses NSIS, correct? I think an update of Windows Vista is deny the installation of VLC. This is happening two weeks make. I do download the VLC (<a href="http://sourceforge.net/projects/vlc/files/2.0.0/win32/vlc-2.0.0-win32.exe/download" target="_blank">http://sourceforge.net/projects/vlc/...2.exe/download</a>) and run the installer displays the following screen:<br><a href="http://www.image-share.com/ijpg-1340-186.html&quot;%20border=&quot;0&quot;%20target=&quot;_blank&quot;%3E%3Cimg%20src=&quot;http://www.image-share.com/upload/1340/186m.jpg&quot;%20alt=&quot;image%20jpg%201340-186" target="_blank">http://www.image-share.com/ijpg-1340...e jpg 1340-186</a><br><br>Someone is having the same problem? Any idea?</p></div><hr><div class="footer"><p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p></div></div><script src="../js/highlight.pack.js" type="text/javascript"></script><script type="text/javascript">//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]></script></body></html>