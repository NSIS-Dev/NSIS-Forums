<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="description" content="Create a build that can install 2 different packages by user wish"><title>Create a build that can install 2 different packages by user wish - NSIS Forums</title><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script><link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css"><link rel="stylesheet" href="../css/style.css" type="text/css"></head><body><div class="container"><ol class="breadcrumb"><li><a href="../index.html" class="glyphicon glyphicon-home"></a></li><li><a href="f-65.html">NSIS Discussion</a></li><li class="active">Create a build that can install 2 different packages by user wish</li></ol><p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=299612">Create a build that can install 2 different packages by user wish</a></p><br><div class="post"><p class="post-meta"><span class="post-author text-primary">believer</span><br><span class="post-time small text-muted">6th November 2008 14:54 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>Create a build that can install 2 different packages by user wish</strong><br>I need suggestion about my technical problem:<br>I want to create a build that let to user to choose 1 of 2 options (packages) for installation, but<br>1. How can I add window with radio choice?<br>2. After user has chosen a package, how can I pass him to right installation path?<br>Now I have this version:<br>***********************************************************<br><br>!define TAKING "files_to_take"<br>!addincludedir "${TAKING}\inc"<br>!addincludedir "..\common_lib"<br><br>#Things you can change are here<br>!define VERSION "1.0"<br>!define PROD_VERSION "1.0"<br>!define MUTEX "NewSetup"<br>!define BRAND "Copyright Home Ltd."<br>!define COMPLETED "Setup has finished successfully."<br><br>!define RELEASEDIR "releases\"<br>!define IMAGES "${TAKING}\img"<br>!define FILEBASE "game"<br>!define TEMPFILES "${TAKING}\temp"<br>!define DISTRO1 "${TAKING}\folder1"<br>!define DISTRO2 "${TAKING}\folder2"<br>!define DEST "C:\game"<br>!define TESTFILE "game.exe"<br><br>#additional file version information here<br>!define Product_Name "Game"<br>!define Company_Name "Home"<br>!define File_Description "Setup Package v.${VERSION}"<br>SetCompressor /FINAL lzma # Set the compression type<br>#-------------Pre-Execution Includes------<br># Support for "IF" "FOR" and other logic constructs<br>#-------------Imports from common functions<br>!define fnCheckForMutex<br>!define fnDumpLog<br>#!define fnGetFilePath<br>!include "LogicLib.nsh"<br>!include "common.nsh"<br>!include "Sections.nsh"<br>!include "WinMessages.nsh"<br>!include "UMUI.nsh"<br><br>#-------------Modern Interfce Settings-------------------<br>!define MUI_ABORTWARNING<br>!define MUI_CUSTOMFUNCTION_GUIINIT myGUIInit<br>#------Page Macros-----------------------------<br>!insertmacro MUI_PAGE_WELCOME<br>!define MUI_PAGE_CUSTOMFUNCTION_PRE prelic<br>!insertmacro MUI_PAGE_LICENSE "${TAKING}\inc\lic.txt"<br>!insertmacro MUI_PAGE_INSTFILES<br><br>!insertmacro MUI_LANGUAGE "English"<br>!insertmacro MUI_LANGUAGE "French"<br><br>#---------------Global things---------------------<br>Name "${Product_Name} v.${PROD_VERSION}"<br>ShowInstDetails show<br>CompletedText "${COMPLETED}"<br>InstallDir "${DEST}"<br>BrandingText "${BRAND}"<br>OutFile ${RELEASEDIR}\${FILEBASE}_v${PROD_VERSION}_${VERSION}.exe<br><br>#----------------Version Information ------------------<br>VIAddVersionKey "ProductName" "${Product_Name} v.${PROD_VERSION}"<br>VIAddVersionKey "Comments" "${Comments}"<br>VIAddVersionKey "CompanyName" "${Company_Name}"<br>VIAddVersionKey "FileDescription" "${File_Description}"<br>VIAddVersionKey "FileVersion" "${VERSION}"<br>VIProductVersion "${PROD_VERSION}"<br>VIAddVersionKey "LegalCopyright" "Home"<br><br>#-----Global Variables----------------------<br>var setup_type<br>var instal_type<br>#----------Sections-------------------------<br><br># The Main Section is here - this one is the 2nd executed<br>Section -First<br>DetailPrint "The setup type is $setup_type."<br>SetOutPath "${DEST}"<br>#${If} $setup_type == "fresh"<br># DetailPrint "Executing fresh installation."<br>#SetOutPath "${DEST}"<br># SetOverwrite on<br># File /r ${DISTRO}\*.*<br>#${ElseIf} $setup_type == "upgrade"<br>#------- UPGRADE to a newer version of MATIC<br># DetailPrint "Upgrading current version ..."<br># SetOutPath ${DEST}<br># SetOverwrite on<br>#File /r "${DISTRO}\*.exe"<br># SetOverwrite off<br># File /r "${DISTRO}\*.*"<br># ClearErrors<br>#${EndIf}<br>WriteUninstaller "$INSTDIR\Uninstall.exe"<br>SectionEnd<br><br>#-----------FunishUp---------------<br>Section -Finishup<br><br>DetailPrint "**********Finishup section.***************"<br>DetailPrint "Create All those nice icons and shortcuts."<br><br>SetShellVarContext all<br>SetOutPath $INSTDIR<br><br>CreateDirectory "$SMPROGRAMS\game"<br>CreateShortCut "$SMPROGRAMS\game\game.lnk" "$INSTDIR\game.exe"<br>CreateShortCut "$SMPROGRAMS\game\UninstallerGame.lnk" "$INSTDIR\Uninstall.exe"<br>CreateShortCut "$DESKTOP\game.lnk" "$INSTDIR\game.exe"<br>DetailPrint "Dumping the log to file."<br>Push "$TEMP\${Product_Name}_Setup_v_${VERSION}_install.log"<br><br>Call DumpLog<br>SectionEnd<br>#---------Functions ---------------------<br><br>Section "Uninstall"<br>Delete $INSTDIR\Uninstall.exe ; delete self<br>Delete $INSTDIR\*.*<br>Delete $INSTDIR\folder1\*.*<br>Delete $INSTDIR\folder2\*.*<br>RMDir $INSTDIR\folder1<br>RMDir $INSTDIR\folder2<br>RMDir $INSTDIR<br>SectionEnd<br><br>#--------------------On Init------------------------------<br>Function .onInit<br>#Check for Multiple instances<br>#Put any other mutex checks or "... is running" tests<br>${MutexErr} "${MUTEX}" "This installation is already running." ""<br>${MutexErr} "MATIC.EXE" "Matic is running. Close it and run this setup again." ""<br>${If} ${FileExists} "${DEST}\${TESTFILE}"<br>StrCpy $setup_type "upgrade"<br>${Else}<br>StrCpy $setup_type "fresh"<br>${EndIf}<br><br>MessageBox MB_OK "Now choose one of 2 kinds of installation modes: YES=new1 or NO=new2"<br><br>MessageBox MB_YESNO "Again, YES=new1 or NO=new2. Choose right version!" IDYES new1<br>Exec :new2<br>new1:<br><br>InitPluginsDir<br>File "/oname=$PLUGINSDIR\button.bmp" \<br>"${NSISDIR}\Contrib\skinnedbutton\skins\ishield.bmp"<br>FunctionEnd<br><br>Function new1<br>${If} $setup_type == "fresh"<br>DetailPrint "Executing fresh installation."<br>SetOutPath "${DEST}"<br>SetOverwrite on<br>File /r ${DISTRO1}\*.*<br>${ElseIf} $setup_type == "upgrade"<br>DetailPrint "Upgrading current version ..."<br>SetOutPath ${DEST}<br>SetOverwrite on<br>File /r "${DISTRO1}\*.exe"<br>SetOverwrite off<br>File /r "${DISTRO1}\*.ini"<br>File /r "${DISTRO1}\*.udl"<br>ClearErrors<br>${EndIf}<br>FunctionEnd<br><br>Function new2<br>${If} $setup_type == "fresh"<br>DetailPrint "Executing fresh installation."<br>SetOutPath "${DEST}"<br>SetOverwrite on<br>File /r ${DISTRO2}\*.*<br>${ElseIf} $setup_type == "upgrade"<br>DetailPrint "Upgrading current version ..."<br>SetOutPath ${DEST}<br>SetOverwrite on<br>File /r "${DISTRO2}\*.exe"<br>SetOverwrite off<br>File /r "${DISTRO2}\*.ini"<br>File /r "${DISTRO2}\*.udl"<br>ClearErrors<br>${EndIf}<br>FunctionEnd<br><br>Function SaveLog<br>Push "$TEMP\${Product_Name}_Setup_v_${VERSION}_install.log"<br>Call DumpLog<br>FunctionEnd<br><br>Function .onInstFailed<br>MessageBox MB_OK "Try your installation again in next time."<br>Call SaveLog<br>FunctionEnd<br><br>Function myGUIInit<br>skinnedbutton::skinit /NOUNLOAD "$PLUGINSDIR\button.bmp"<br>Pop $0<br>StrCmp $0 "success" noerror<br>MessageBox MB_ICONEXCLAMATION|MB_OK "skinned button error: $0"<br>noerror:<br>FunctionEnd<br><br>Function prelic<br>${If} $setup_type != "fresh"<br>Abort<br>${Endif}<br>FunctionEnd<br><br>Function .onInstSuccess<br>MessageBox MB_YESNO "Congratulation, installation completed sucessfully. Do you want view readme?" IDNO NoReadme<br>Exec notepad.exe ; view readme or whatever, if you want.<br>NoReadme:<br>FunctionEnd<br>***********************************************************<br><br>Again, this version didn't work properly because it can't reference to nwe1 or new2 functions. Hope to your help!<br>PS: I just started to work with NSIS scripts</p></div><hr><div class="footer"><p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p></div></div><script src="../js/highlight.pack.js" type="text/javascript"></script><script type="text/javascript">//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]></script></body></html>