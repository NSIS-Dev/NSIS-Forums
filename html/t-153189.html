<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="description" content="Need some advice on slashconverting"><title>Need some advice on slashconverting - NSIS Forums</title><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script><link rel="preload" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css" as="style" onload="this.rel='stylesheet'"><link rel="preload" href="../css/style.css" as="style" onload="this.rel='stylesheet'"><noscript><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css"><link rel="stylesheet" href="../css/style.css"></noscript><script>!function(a){"use strict";var b=function(b,c,d){function e(a){return h.body?a():void setTimeout(function(){e(a)})}function f(){i.addEventListener&&i.removeEventListener("load",f),i.media=d||"all"}var g,h=a.document,i=h.createElement("link");if(c)g=c;else{var j=(h.body||h.getElementsByTagName("head")[0]).childNodes;g=j[j.length-1]}var k=h.styleSheets;i.rel="stylesheet",i.href=b,i.media="only x",e(function(){g.parentNode.insertBefore(i,c?g:g.nextSibling)});var l=function(a){for(var b=i.href,c=k.length;c--;)if(k[c].href===b)return a();setTimeout(function(){l(a)})};return i.addEventListener&&i.addEventListener("load",f),i.onloadcssdefined=l,l(f),i};"undefined"!=typeof exports?exports.loadCSS=b:a.loadCSS=b}("undefined"!=typeof global?global:this);!function(a){if(a.loadCSS){var b=loadCSS.relpreload={};if(b.support=function(){try{return a.document.createElement("link").relList.supports("preload")}catch(b){return!1}},b.poly=function(){for(var b=a.document.getElementsByTagName("link"),c=0;c<b.length;c++){var d=b[c];"preload"===d.rel&&"style"===d.getAttribute("as")&&(a.loadCSS(d.href,d,d.getAttribute("media")),d.rel=null)}},!b.support()){b.poly();var c=a.setInterval(b.poly,300);a.addEventListener&&a.addEventListener("load",function(){b.poly(),a.clearInterval(c)}),a.attachEvent&&a.attachEvent("onload",function(){a.clearInterval(c)})}}}(this);</script></head><body><div class="container"><ol class="breadcrumb"><li><a href="../index.html" class="glyphicon glyphicon-home"></a></li><li><a href="f-65.html">NSIS Discussion</a></li><li class="active">Need some advice on slashconverting</li></ol><p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=153189">Need some advice on slashconverting</a></p><br><div class="post"><p class="post-meta"><span class="post-author text-primary">Mosestycoon</span><br><span class="post-time small text-muted">19th October 2003 15:53 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>Need some advice on slashconverting</strong><br>Dear Guys -<br><br>Can somebody help me on slashconverting? I have to open a file parse it through the slash-converting function (convert backslashes to normal slashes) and close it under the same name!<br><br>I found this slash-converter <a href="http://nsis.sourceforge.net/archive/nsisweb.php?page=155&amp;instances=0,11,122" target="_blank">here @ the archive</a> but didn't understood how to get it work...<br><br>Thx in advance<br>Mo</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">kichik</span><br><span class="post-time small text-muted">19th October 2003 16:23 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Open the file, read a line, pass it to the function, write the output to another file, repeat until you've read the entire file, close both files and replace the old one with the new one.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Mosestycoon</span><br><span class="post-time small text-muted">19th October 2003 16:56 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">So I can use this function? What I don't understood are the comments above:<br></p><pre>
<code>; Push $filenamestring (e.g. 'c:\this\and\that\filename.htm')<br>; Push "\"<br>; Call StrSlash<br>; Pop $0<br>; $0 == 'c:/this/and/that/filename.htm'</code>
</pre><br>
      <br>
      Mo
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Joost Verburg</span><br>
      <span class="post-time small text-muted">19th October 2003 17:08 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">It's an example of usage.<br>
      <br>
      Push "line that contains a \"<br>
      Push "\" ;Char to convert<br>
      Call StrSplash<br>
      Pop $R0 ;Or another variable<br>
      ;Now $R0 will contain the same string with \ converted to /<br>
      <br>
      You will have to use this function for the lines you read from the file.</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br>
      <span class="post-time small text-muted">19th October 2003 17:08 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">That file name is just an example of a string conatining backslashes. You should push the line you read from the file instead of that.</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Mosestycoon</span><br>
      <span class="post-time small text-muted">19th October 2003 17:12 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Uuuhh,<br>
      <br>
      could please give me an example? I tried some things, but with no luck!</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br>
      <span class="post-time small text-muted">19th October 2003 17:13 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">What's wrong with Joost's example?</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Mosestycoon</span><br>
      <span class="post-time small text-muted">19th October 2003 17:18 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">I don't know the lines which have to be converted. This can vary from and I don't know the exact content to be converted, because these lines (with an $INSTDIR) are set with the installation process, so this depends on the path set by the user...</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br>
      <span class="post-time small text-muted">19th October 2003 17:26 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">You're not supposed to push constant strings to that function, you're supposed to push it strings that you read from the file.<br>
      <br>
      If it's $INSTDIR that you're trying to convert, why not preconvert it? Just push $INSTDIR to that function and have your file replacement functions replace your file constants with the converted $INSTDIR instead of the original one.</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Mosestycoon</span><br>
      <span class="post-time small text-muted">19th October 2003 17:38 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Because I don't know how!<br>
      <br>
      I have one function for editing the file. This replaces some place holder with an installation path:<br></p>
      <pre>
<code>Function ModibWebAdmin<br>ClearErrors<br>FileOpen $0 "$INSTDIR\test.tmp.php" "r"<br>GetTempFileName $R0<br>FileOpen $1 $R0 "w"<br>loop:<br>   FileRead $0 $2<br>   IfErrors done<br>   StrCmp $2 "@@BINPATH@@$\r$\n" 0 +3<br>      FileWrite $1 "define($\'BINPATH$\', $\'$INSTDIR\DB\FireBird\bin\$\');$\r$\n"<br>      Goto loop<br>   StrCmp $2 "@@TMPPATH@@$\r$\n" 0 +3<br>      FileWrite $1 "define($\'TMPPATH$\', $\'$INSTDIR\DB\FireBird\tmp\$\');$\r$\n"<br>          Goto loop<br>   StrCmp $2 "@@DEFAULTPATH@@$\r$\n" 0 +3<br>      FileWrite $1 "define($\'DEFAULT_PATH$\',    $\'$INSTDIR\DB\FireBird\$\');$\r$\n"<br>          Goto loop<br>   FileWrite $1 $2<br>      Goto loop<br>done:<br>   FileClose $0<br>   FileClose $1<br>   Delete "$INSTDIR\test.tmp.php"<br>   Rename $R0 "$INSTDIR\test.tmp1.php"<br>FunctionEnd</code>
</pre><br>
      <br>
      But these replaced lines show the path with backslashes. Don't know why but these file (php-script) doesn't work with backslashes. So these lines should be converted. I would have prepared the file with '/' instead of '\', but I have no influence on the front part set through $INSTDIR ...<br>
      <br>
      So what was your idea on Push $INSTDIR? How can this be achieved?
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br>
      <span class="post-time small text-muted">19th October 2003 17:53 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Use this:<br>
      <br>
      Push $INSTDIR<br>
      Push "\"<br>
      Call StrSlash<br>
      Pop $0<br>
      <br>
      $0 will contain the string you should use instead of $INSTDIR in the file replacement function.</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Mosestycoon</span><br>
      <span class="post-time small text-muted">19th October 2003 17:56 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Okay I think I almost got it kichik :-D<br>
      <br>
      One last question:<br></p>
      <pre>
<code>Push $INSTDIR<br>Push "\"<br>Call StrSlash<br>Pop $0 </code>
</pre><br>
      <br>
      Can this be used in a section (at any place), or do I have to make a seperate function out of it which has to be called with
      <pre>
<code> Call FunctionName</code>
</pre><br>
      <br>
      Mo!
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br>
      <span class="post-time small text-muted">19th October 2003 17:59 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">It can be used anywhere you want as long as you know $INSTDIR will be set to the right value (after directory selection page) and that $0 will not change until the file replacement function is called.</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Mosestycoon</span><br>
      <span class="post-time small text-muted">19th October 2003 18:45 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">I can't get it work...<br>
      Could somebody review and correct it, pleeaaase<br>
      <br>
      Mo</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br>
      <span class="post-time small text-muted">19th October 2003 19:17 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">You are still using $INSTDIR in the Replace function. Use $R0 instead.</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Mosestycoon</span><br>
      <span class="post-time small text-muted">19th October 2003 19:22 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">YEEEEAAAAAAHHHHHH !!!! :up:<br>
      <br>
      Got it!<br>
      Thx Kichik (you rock!) great help!<br>
      Mo<br>
      :D<br>
      <br>
      P.S.: can the used variables be cleared at the end or do they have no effect on following functions and sections?</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br>
      <span class="post-time small text-muted">19th October 2003 19:25 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">As long as you don't call that function again you can clear it. If you're worried you might need it sometime you can use Var to create a special variable just for it (assuming you're using the latest CVS version).</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Mosestycoon</span><br>
      <span class="post-time small text-muted">19th October 2003 19:49 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">So best/safest would be<br></p>
      <pre>
<code> Var NAME_OF_VAR</code>
</pre><br>
      (in the beginning of the script)<br>
      and than call it at the line<br>
      <pre>
<code>Pop $NAME_OF_VAR</code>
</pre><br>
      Is that right?
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br>
      <span class="post-time small text-muted">19th October 2003 19:56 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Yes, and in the replacement function too. Replace $R0 with $NAME_OF_VAR.</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Mosestycoon</span><br>
      <span class="post-time small text-muted">19th October 2003 20:06 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">So thx kichik: Your my man! :D</p>
    </div>
    <hr>

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]></script></body></html>