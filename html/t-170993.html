<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="update dlls via cab files?" />

  <title>update dlls via cab files? - NSIS Forums</title>
  <script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script>
  <!-- Bootstrap core CSS -->

  <link rel="stylesheet" type="text/css" href="//netdna.bootstrapcdn.com/bootswatch/3.0.1/readable/bootstrap.min.css" />
  <link rel="stylesheet" href="../css/style.css" type="text/css" /><!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!--[if lt IE 9]>
                <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
                <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->
</head>

<body>
  <div class="container">
    <!-- Put navigation bar here -->

    <ol class="breadcrumb">
      <li><a href="../index.html" class="glyphicon glyphicon-home"></a></li>

      <li><a href="f-65.html">NSIS Discussion</a></li>

      <li class="active">update dlls via cab files?</li>
    </ol>

    <p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=170993">update dlls via cab files?</a></p><br />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">treborhudson</span><br />
      <span class="post-time small text-muted">25th February 2004 22:00 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>update dlls via cab files?</strong><br />
      I'm creating an installer that I need to check for a specific window media decoder version. The easiest way to do this is to tell Windows to install the CAB file that contains the latest version of the file and let windows handle the dependencies and registry stuff. Does NSIS support anything like this? I'm told that the windows API has this built in.<br />
      <br />
      Thanks.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Joost Verburg</span><br />
      <span class="post-time small text-muted">25th February 2004 22:19 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">A CAB file itself does not contain installation information. These things are usually setup using an application or included INF file.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">treborhudson</span><br />
      <span class="post-time small text-muted">25th February 2004 23:14 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Thanks for the quick reply.<br />
      <br />
      I don't have a good handle on the process then.<br />
      <br />
      Could someone quickly explain the process to go through so NSIS can ensure that the system I'm installing on has or gets installed a newer version of the codec?<br />
      <br />
      I'm guessing here:<br />
      Find the .dll or .cab file that needs to be installed.<br />
      Check windows version.<br />
      (Something with .inf files)<br />
      Execute a NSIS command that calls some windows bit of functionality that does the heavy lifting.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Joost Verburg</span><br />
      <span class="post-time small text-muted">25th February 2004 23:20 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Microsoft distributes installers for Windows Media Playes codecs. If you don't want to handle the installation yourself you can extract such an installer to a temporary location ($PLUGINSDIR after using InitPlugisDir) and run the installer silently.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">treborhudson</span><br />
      <span class="post-time small text-muted">27th February 2004 01:20 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">OK. I'm using MessageBox MB_YESNO to ask the user if they want to install a new media player version. If they say NO, it jumps past this line (doesn't execute it):<br />
      <br />
      ExecWait "$INSTDIR\upgrades\MPSetup.exe"<br />
      <br />
      However, since I'm calling another installation program, it warns me in the WMP setup that another installation hasn't finished yet and is going to abort.<br />
      <br />
      How can I call another installer while mine is running? OR How can I close my installer but queue up another (possibly 2 other) installer(s) when it finishes?</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">heXor</span><br />
      <span class="post-time small text-muted">27th February 2004 08:01 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">There are different solutions to this problem.<br />
      The most professional is not to show any message box, but to have a customized page using the InstallOptions plugin.<br />
      <br />
      In a customized page you could have two radiobuttons the user can choose between. Install the codecs or do not install them. Ofcourse that there can be a checkbox too...<br />
      <br />
      Anyway, if you use the MessageaBox, you will have 2 possibilities to start the other installation.<br />
      <br />
      1. From a section in your NSIS script<br />
      2. From an installer page, when you leave the page and goto next page for example.<br />
      <br />
      Calling the other installtion should be done as do now, i.e to use the ExecWait command. NSIS installation will wait until "$INSTDIR\upgrades\MPSetup.exe" finishes and then NSIS continues.<br />
      <br />
      I don't really understand if you want to start another instance of the NSIS installation or if you want to call another program, so this you will have to explain more...<br />
      <br />
      Quiting the NSIS installation is easy..just write "Quit" in your NSIS script and the installation will exit...</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">treborhudson</span><br />
      <span class="post-time small text-muted">27th February 2004 16:57 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">So is launching a 2nd installer from a messagebox the reason the 2nd installer won't continue?<br />
      <br />
      I only want my 1 instance of the NSIS installer I'm writing, but I need to offer to install the new Windows Media Player (WMP) if they are on Windows 98. (I haven't added the OS check yet, but that seems simple enough)<br />
      <br />
      My main blocker at the moment is that the WMP installer will not run when called from my NSIS installer. It prompts me that another installation is currently active and needs to be shut down before the WMP installer will continue... Press OK to abort. That kind of thing.<br />
      <br />
      Thanks.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Joost Verburg</span><br />
      <span class="post-time small text-muted">27th February 2004 18:36 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">That is weird. An NSIS installer should not make a difference for the other installer. Does it work when executing it manually using the same parameters?</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">treborhudson</span><br />
      <span class="post-time small text-muted">27th February 2004 18:54 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Yes.<br />
      <br />
      What we are reverting to for this installation is to copy over the WMP executable to the hard drive. Then when our program launches, check for Windows 98 and offer to install WMP from there. When we run the installer at that time, it works just fine.<br />
      <br />
      I'd like to install all necessary things at the same time, but for now, this is an acceptable solution.<br />
      <br />
      I'd be happy to provide more information.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">heXor</span><br />
      <span class="post-time small text-muted">27th February 2004 19:21 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">I also think it's weird...<br />
      The other installer should not interfere with NSIS...those two installers have nothing to do with each other.<br />
      <br />
      Anyway, I suggest this:<br />
      Create a very simple NSIS installation. You can create a simple NSIS installation by just creating a section and writing the OutFile command. You can take one of the simple examples you find in your NSIS examples folder.<br />
      <br />
      Unpack your exe file (the installer you're trying to run) and then run it with the ExecWait command. If you get the same error, then please post that installation together with the NSIS script file to this forum. The we'll have a look at it.<br />
      <br />
      It's very difficult to know what the problem is.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">treborhudson</span><br />
      <span class="post-time small text-muted">28th February 2004 01:58 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">I won't be able to get back to this until Monday, but I made a test installer and I slightly misread the text and the problem. Here is the exact text:<br />
      <br />
      "Another program installation was not completed. You must restart your computer to complete that installation before upgrading Windows. Click Cancel, restart your computer, and then try installing Windows Media Player 9 Series again."<br />
      <br />
      Options: Next, Cancel<br />
      <br />
      If I click Next, it proceeds to the next installation page where one would presume it normally starts the installation.<br />
      <br />
      So it seems the WMP installer somehow knows that it was called by another installer?<br />
      <br />
      All my install does is copy the executable to the INSTDIR and prompts the user to install it and calls ExecWait to call the .exe file. I can post the file if need be.<br />
      <br />
      Thanks!</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">heXor</span><br />
      <span class="post-time small text-muted">28th February 2004 10:09 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Please post the simple installer.<br />
      We'll have al look at it.<br />
      <br />
      Regards<br />
      /Paul</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">heXor</span><br />
      <span class="post-time small text-muted">1st March 2004 07:08 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Maybe you can try something else:<br />
      Instead of unpacking to the $PLUGINSDIR, try to unpack to c:\ - only for testing purposes, ofcourse.<br />
      <br />
      Try to run the other installer from c:\ and see if you get the same warning message. Maybe it doesn't like to be started from a temp directory...</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">treborhudson</span><br />
      <span class="post-time small text-muted">1st March 2004 18:11 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">I posted 3 files here:<br />
      <a href="http://kuanyin.orcasinc.com/~rob/" target="_blank">http://kuanyin.orcasinc.com/~rob/</a><br />
      <br />
      The test.nsi is the script. The Test.exe is the result of that script. The MPSetup.exe is the 2nd installer that gets called (and is included in Test.exe).<br />
      <br />
      Thanks for the help!</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">treborhudson</span><br />
      <span class="post-time small text-muted">2nd March 2004 00:06 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Ignore my last few posts... it's the cause of an ID-10-T error.<br />
      <br />
      For some reason my system was in a weird state and after following the instructions of the WMP installer by rebooting, everything is fine. Even launching the WMP installer from within my installer no longer shows the error.<br />
      <br />
      Thanks for the help. Time to slap my forehead now. :|</p>
    </div>
    <hr />

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]>
  </script>
</body>
</html>
