<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="Service Questions" />

  <title>Service Questions - NSIS Forums</title>
  <script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script>
  <!-- Bootstrap core CSS -->

  <link rel="stylesheet" type="text/css" href="//netdna.bootstrapcdn.com/bootswatch/3.0.1/readable/bootstrap.min.css" />
  <link rel="stylesheet" href="../css/style.css" type="text/css" /><!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!--[if lt IE 9]>
                <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
                <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->
</head>

<body>
  <div class="container">
    <!-- Put navigation bar here -->

    <ol class="breadcrumb">
      <li><a href="../index.html" class="glyphicon glyphicon-home"></a></li>

      <li><a href="f-65.html">NSIS Discussion</a></li>

      <li class="active">Service Questions</li>
    </ol>

    <p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=195662">Service Questions</a></p><br />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">gregory.p.cliff</span><br />
      <span class="post-time small text-muted">5th October 2004 14:30 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>Service Questions</strong><br />
      I am using dselkirk's service functions to create, stop, and delete services. These all seem to work fine except for one issue with the uninstaller. The binpath to the services is in the install location, and if the services are running, when I stop and delete them, the command to recursively remove the INSTALLDIR fails. I think this is just a timing thing as I can delete the INSTALLDIR manually after running the uninstaller.<br />
      <br />
      Additionally for what its worth if the services are not running when I run the uninstaller the whole thing goes off w/o a hitch.<br />
      <br />
      Is there any way to tell the uninstaller to "sleep" for a second or two prior to attempting to remove the INSTALLDIR after stopping and deleting the services, or is there a better way to stop and delete the services?<br />
      <br />
      Thanks.<br />
      <br />
      Greg</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
      <span class="post-time small text-muted">5th October 2004 18:59 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Sleep 10000 ; Pause for 10 seconds<br />
      <br />
      -Stu</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">gregory.p.cliff</span><br />
      <span class="post-time small text-muted">6th October 2004 15:47 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Thanks, I should have checked for that. Sorry for being a bonehead</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">mdlazreg</span><br />
      <span class="post-time small text-muted">1st April 2005 18:02 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Hi,<br />
      <br />
      I am trying to install a windows service and I am stuck if any one can help me please.<br />
      <br />
      1)<br />
      I tried using dselkirk's service functions described at :<br />
      <a href="http://nsis.sourceforge.net/archive....php?pageid=345" target="_blank">http://nsis.sourceforge.net/archive....php?pageid=345</a><br />
      <br />
      but my script would not even compile giving me the error :<br />
      <br />
      Error: unterminated string parsing line at macro:FUNC_SERVICE:21<br />
      Error in macro FUNC_SERVICE on macroline 21<br />
      <br />
      Whats wrong with this library?!<br />
      <br />
      2)<br />
      I also tried to use this plugin:<br />
      <a href="http://nsis.sourceforge.net/archive....php?pageid=385" target="_blank">http://nsis.sourceforge.net/archive....php?pageid=385</a><br />
      <br />
      but even if it does start, stop a service it does not offer how to install a service...<br />
      <br />
      It would be great if this plugin can be enhanced by some expert:).<br />
      <br />
      3)<br />
      <br />
      I also would like to know how can I find if a service is running by the name of its executable. I can not search for it by name because I have no idea what name my customer has chosen. So I would like to find the service by the name of the program itself... Is this possible?!<br />
      <br />
      4)<br />
      <br />
      The service I want install has to take some arguments. But<br />
      <a href="http://nsis.sourceforge.net/archive....php?pageid=345" target="_blank">http://nsis.sourceforge.net/archive....php?pageid=345</a><br />
      seems to take only the path to the program not the arguments to the program.<br />
      <br />
      Thank you for any help.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
      <span class="post-time small text-muted">1st April 2005 20:24 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">As for the Service Library, use the <a href="http://nsis.sourceforge.net/archive/savescript.php?pageid=345&amp;script=1" target="_blank">save script</a> link instead of copying and pasting. Word wrapping is turned on.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">mdlazreg</span><br />
      <span class="post-time small text-muted">2nd April 2005 00:58 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Thanks Kichik. Now it does compile.<br />
      <br />
      I was also wrong on 2). Looking at the documentation, the creation of a service is there. Sorry about that.<br />
      <br />
      I am left with 3) and 4).<br />
      <br />
      3)How can I find out if a service is running if I do not know the name of the service. All I know is the name of the program itself.<br />
      <br />
      4)And how can I pass arguments to the program I want to install as a service.<br />
      <br />
      Thanks a lot for your help.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">mdlazreg</span><br />
      <span class="post-time small text-muted">5th April 2005 18:13 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Hi,<br />
      <br />
      I found the solution for 4). Actually it is possible to use the library at<br />
      <a href="http://nsis.sourceforge.net/archive....php?pageid=345" target="_blank">http://nsis.sourceforge.net/archive....php?pageid=345</a><br />
      <br />
      and giving it path="program.exe arg1 arg2..."</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">mdlazreg</span><br />
      <span class="post-time small text-muted">6th April 2005 18:54 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Hi,<br />
      <br />
      I found a workaround for 3) by using the FindProc plugin.<br />
      <br />
      I have a question of any one can help please:<br />
      <br />
      After my installer has created a service. It is unable to start it!. And even if I go the Services conrol panel and try to start it, it gives me the following error :<br />
      <br />
      Error 1067.<br />
      <br />
      Ps1: I have admin privileges on the machine I am installing on.<br />
      Ps2: If I run the command manually, it does run. But it gives an error if it is through the service...<br />
      <br />
      Thank you for any help.</p>
    </div>
    <hr />

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]>
  </script>
</body>
</html>
