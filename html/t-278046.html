<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="Uninst on what you inst'd" />

  <title>Uninst on what you inst'd - NSIS Forums</title>
  <script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script>
  <!-- Bootstrap core CSS -->

  <link rel="stylesheet" type="text/css" href="//netdna.bootstrapcdn.com/bootswatch/3.0.1/readable/bootstrap.min.css" />
  <link rel="stylesheet" href="../css/style.css" type="text/css" /><!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!--[if lt IE 9]>
                <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
                <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->
</head>

<body>
  <div class="container">
    <!-- Put navigation bar here -->

    <ol class="breadcrumb">
      <li><a href="../index.html" class="glyphicon glyphicon-home"></a></li>

      <li><a href="f-65.html">NSIS Discussion</a></li>

      <li class="active">Uninst on what you inst'd</li>
    </ol>

    <p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=278046">Uninst on what you inst'd</a></p><br />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">stonkers</span><br />
      <span class="post-time small text-muted">28th September 2007 20:44 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>Uninst on what you inst'd</strong><br />
      &nbsp; OK, looking for a little strategy advice. I've run into something new to me. Most client side app's deal with this, but I mostly build release files for items that live on their own tier and don't have any conflict when installing.<br />
      <br />
      I've got this one application that's become a thorn in my side though... It has about 10 installers that can live on 1 to 10 different machines. Each one of the apps lives in the same directory, and thus, when they go on the same machine, the uninstallers tend to uninstall the other installed files. So I need to figure out 2 things:<br />
      <br />
      1) How do I only uninstall what the previous installer installed?<br />
      2) If there are shared files, how do I know that they're potentially shared files, and thus, not uninstall them?<br />
      <br />
      All advise will be much appreciated!<br />
      <br />
      Thanks Once Again,<br />
      Eric &lt;&gt;&lt;</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Joel</span><br />
      <span class="post-time small text-muted">29th September 2007 00:37 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">I can help you on #1<br />
      If the old installer is made by you..you can config the old installer to install a setup.cfg or whatever name, but basically an ini file to write the components installed and later you can read it in new installer. You can save installations paths in registry.<br />
      <br />
      If the installer is not made by you, well...you can try deleting the files<br /></p>
      <pre>
<code>
Delete $SOMEDIR*.* ; also trt /r for recursive 
<br />&gt;
</code>
</pre>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">CancerFace</span><br />
      <span class="post-time small text-muted">29th September 2007 15:35 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Similar to what Joel suggested, how about using extended logging with your installer, then employ the <a href="http://nsis.sourceforge.net/Delete_Files_From_Log" target="_blank">Delete Files From Log</a> function from the wiki in your uninstaller? This is something that you can call from another uninstaller as well, keeping track of what each app is installing/uninstalling.<br />
      <br />
      As for shared components, they are always a thorn in one's side. However there are several ways to deal with them, assuming that you are responsible for installing them. What I tend to do, although I am not sure if it is the best strategy, is use the shared DLL key in the registry (<i>HKLM\Software\Microsoft\Windows\CurrentVersion\SharedDLLs</i>) for files that many apps will share. I use <a href="http://nsis.sourceforge.net/Add_a_shared_DLL" target="_blank">this</a> macro to install a shared component and <a href="http://nsis.sourceforge.net/Remove_a_shared_DLL" target="_blank">this</a> to remove it. The shared files do not have to be DLL/OCX/TLB nor do they have to reside in $SYSDIR which makes this approach quite generic and useful.<br />
      <br />
      Alternatively you can use the <a href="http://nsis.sourceforge.net/Docs/AppendixB.html" target="_blank">InstallLib</a> macro for shared components.<br />
      <br />
      CF</p>
    </div>
    <hr />

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]>
  </script>
</body>
</html>