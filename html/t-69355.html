<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="description" content="Install Options DLL Suggestions/Questions"><title>Install Options DLL Suggestions/Questions - NSIS Forums</title><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script><link rel="preload" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css" as="style" onload="this.rel='stylesheet'"><link rel="preload" href="../css/style.css" as="style" onload="this.rel='stylesheet'"><noscript><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css"><link rel="stylesheet" href="../css/style.css"></noscript><script>!function(a){"use strict";var b=function(b,c,d){function e(a){return h.body?a():void setTimeout(function(){e(a)})}function f(){i.addEventListener&&i.removeEventListener("load",f),i.media=d||"all"}var g,h=a.document,i=h.createElement("link");if(c)g=c;else{var j=(h.body||h.getElementsByTagName("head")[0]).childNodes;g=j[j.length-1]}var k=h.styleSheets;i.rel="stylesheet",i.href=b,i.media="only x",e(function(){g.parentNode.insertBefore(i,c?g:g.nextSibling)});var l=function(a){for(var b=i.href,c=k.length;c--;)if(k[c].href===b)return a();setTimeout(function(){l(a)})};return i.addEventListener&&i.addEventListener("load",f),i.onloadcssdefined=l,l(f),i};"undefined"!=typeof exports?exports.loadCSS=b:a.loadCSS=b}("undefined"!=typeof global?global:this);!function(a){if(a.loadCSS){var b=loadCSS.relpreload={};if(b.support=function(){try{return a.document.createElement("link").relList.supports("preload")}catch(b){return!1}},b.poly=function(){for(var b=a.document.getElementsByTagName("link"),c=0;c<b.length;c++){var d=b[c];"preload"===d.rel&&"style"===d.getAttribute("as")&&(a.loadCSS(d.href,d,d.getAttribute("media")),d.rel=null)}},!b.support()){b.poly();var c=a.setInterval(b.poly,300);a.addEventListener&&a.addEventListener("load",function(){b.poly(),a.clearInterval(c)}),a.attachEvent&&a.attachEvent("onload",function(){a.clearInterval(c)})}}}(this);</script></head><body><div class="container"><ol class="breadcrumb"><li><a href="../index.html" class="glyphicon glyphicon-home"></a></li><li><a href="f-65.html">NSIS Discussion</a></li><li class="active">Install Options DLL Suggestions/Questions</li></ol><p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=69355">Install Options DLL Suggestions/Questions</a></p><br><div class="post"><p class="post-meta"><span class="post-author text-primary">dbareis</span><br><span class="post-time small text-muted">20th December 2001 10:50 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>Install Options DLL Suggestions/Questions</strong><br>Hi,<br><br>1. Would it be possible for InstallOptions to remember the state in the registry so when someone reinstalls, potentially months later it will remember the users previous choices.<br><br>2. Would it be possible to provide an alias to a field so I don't have to read field number 5 when this might change at any time if I redesign my dialog. I would wish to name each one I am interested in, particularly if (1) implemented.<br><br>3. Can the INI handling be improved to handle $INSTDIR, $R0 etc.<br><br>4. It would be a good idea to have a $NSIS which points to the NSIS base directory on the current box, allowing you to access Installoptions.dll etc.<br><br>5. The common functions which are in the download, can I suggest that NSIS include a mechanism to imbed named standard functions from a "library" so cut &amp; paste is not required and they can be improved by all and automatically update on the next build.<br><br>6. To get around (3), I tried to read the INI and create a new one thinking that $INSTDIR etc would get expanded (and allowing me to store info in registry), however there appears to be no mechanism to cause expansion of variables (as there is for env vars).<br><br>7. I think basic string manipulations such as split, replace, pos, join, case translation should be provided (at least as includable functions)...<br><br><br>8. It would help if there were more examples in the manual...<br><br>Sorry for the long list but I have just started using the InstallOptions DLL and that is the issues I have come accross...<br><br>I do by the way like the InstallOptions DLL and how it integrates reasonably well with NSIS (which is why I started using it).<br><br>Bye<br>Dennis</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Smile2Me</span><br><span class="post-time small text-muted">20th December 2001 11:02 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Dennis,<br><br>some answers to your questions:<br><br>it's possible to save to the registry after reading the results from the INI. That should cover your first point. Furthermore, you can create a basic INI file (eg. without strings for labels) and fill in the details at runtime using WriteINIStr. Then you can use all available variables to set label strings or other items (eg. I have a basic INI with 7 fields and I use it for 4 different pages with questions or install info. Then, using InstOpts.dll like this you can use StrCpy to do the necessary string operations.<br><br>I hope this answers at least a few of your questions,<br><br>good luck, greetz, Hendri.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">dbareis</span><br><span class="post-time small text-muted">20th December 2001 11:08 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"></p><blockquote><i>Originally posted by Smile2Me</i><br><b>Dennis,<br><br>some answers to your questions:<br><br>it's possible to save to the registry after reading the results from the INI. That should cover your first point. Furthermore, you can create a basic INI file (eg. without strings for labels) and fill in the details at runtime using WriteINIStr. Then you can use all available variables to set label strings or other items (eg. I have a basic INI with 7 fields and I use it for 4 different pages with questions or install info. Then, using InstOpts.dll like this you can use StrCpy to do the necessary string operations.<br></b></blockquote>Would it be possible to send me some sample code of this? If so please send to <a href="mailto:dbareis@labyrinth.net.au">dbareis@labyrinth.net.au</a> (just what you have - I can work it out).<br><br>Thanks,<br>Dennis</div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Smile2Me</span><br><span class="post-time small text-muted">20th December 2001 14:08 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">dennis,<br><br>the e-mail is on its way.<br><br>good luck, greetz, Hendri.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">petersa</span><br><span class="post-time small text-muted">24th December 2001 11:29 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Hi Dennis,<br><br>I don't think I completely understand dot point 4, but I think you're looking for $EXEDIR, which is the directory containing the installer?<br><br>Cheers from Melbourne!</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">dbareis</span><br><span class="post-time small text-muted">24th December 2001 22:57 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"></p><blockquote><i>Originally posted by petersa</i><br><b>Hi Dennis,<br><br>I don't think I completely understand dot point 4, but I think you're looking for $EXEDIR, which is the directory containing the installer?<br><br>Cheers from Melbourne!</b></blockquote>Yes you are right $EXEDIR sounds like it will do the trick, at least to me this was not obvious from the description in the doco.<br><br>Cheers from Melbourne also!<br><br>Bye<br>Dennis</div><hr><div class="footer"><p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p></div></div><script src="../js/highlight.pack.js" type="text/javascript"></script><script type="text/javascript">//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]></script></body></html>