<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="description" content="http + ftp download plug-in"><title>http + ftp download plug-in - NSIS Forums</title><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script><link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css"><link rel="stylesheet" href="../css/style.css" type="text/css"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="description" content=" http + ftp download plug-in"><title>http + ftp download plug-in - NSIS Forums</title><link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css"><link rel="stylesheet" href="../css/style.css" type="text/css"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="description" content=" http + ftp download plug-in"><title>http + ftp download plug-in - NSIS Forums</title><link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css"><link rel="stylesheet" href="../css/style.css" type="text/css"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="description" content=" http + ftp download plug-in"><title>http + ftp download plug-in - NSIS Forums</title><link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css"><link rel="stylesheet" href="../css/style.css" type="text/css"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="description" content=" http + ftp download plug-in"><title>http + ftp download plug-in - NSIS Forums</title><link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css"><link rel="stylesheet" href="../css/style.css" type="text/css"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="description" content=" http + ftp download plug-in"><title>http + ftp download plug-in - NSIS Forums</title><link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css"><link rel="stylesheet" href="../css/style.css" type="text/css"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="description" content=" http + ftp download plug-in"><title>http + ftp download plug-in - NSIS Forums</title><link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css"><link rel="stylesheet" href="../css/style.css" type="text/css"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="description" content=" http + ftp download plug-in"><title>http + ftp download plug-in - NSIS Forums</title><link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css"><link rel="stylesheet" href="../css/style.css" type="text/css"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="description" content=" http + ftp download plug-in"><title>http + ftp download plug-in - NSIS Forums</title><link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css"><link rel="stylesheet" href="../css/style.css" type="text/css"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="description" content=" http + ftp download plug-in"><title>http + ftp download plug-in - NSIS Forums</title><link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css"><link rel="stylesheet" href="../css/style.css" type="text/css"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="description" content=" http + ftp download plug-in"><title>http + ftp download plug-in - NSIS Forums</title><link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css"><link rel="stylesheet" href="../css/style.css" type="text/css"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="description" content=" http + ftp download plug-in"><title>http + ftp download plug-in - NSIS Forums</title><link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css"><link rel="stylesheet" href="../css/style.css" type="text/css"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="description" content=" http + ftp download plug-in"><title>http + ftp download plug-in - NSIS Forums</title><link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css"><link rel="stylesheet" href="../css/style.css" type="text/css"></head><body><div class="container"><ol class="breadcrumb"><li><a href="../index.html" class="glyphicon glyphicon-home"></a></li><li><a href="f-65.html">NSIS Discussion</a></li><li class="active">http + ftp download plug-in</li></ol><p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=198596">http + ftp download plug-in</a></p><br><div class="post"><p class="post-meta"><span class="post-author text-primary">Takhir</span><br><span class="post-time small text-muted">7th November 2004 16:11 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>http + ftp download plug-in</strong><br>Attached plugin supports http and ftp downloads. Included script sample downloads 2 mp3 files (one for each protocol). I wrote it fast (from code pieces I had :) ) and used the simplest InternetOpenUrl() way to do this, so functionality is limited (ftp restart may not work, WM_NOTIFY_OUTER_NEXT skipped, english only, ...). And dialog design is ugly :( (any ideas?)<br>But finally http works good (many thanks to MS guys), I even tested download restart after disconnect (but this require more tests). Re-get defaults: disabled, pause 5 sec.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Takhir</span><br><span class="post-time small text-muted">8th November 2004 05:57 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">wording improved :)</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Takhir</span><br><span class="post-time small text-muted">9th November 2004 07:43 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Empty file size fields looks lonely :) on ftp download, so I added ftp file size request. If ftp server not allows directory browsing (like dl.zvuki.ru does), InternetOpenUrl() fails and new connect (and time) required for file download, so I reworked this to common ftp session with single InternetConnect(). Script sample requests big (14 MB) file from MS ftp site (file size available), so better replace this with your own link.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Fred556</span><br><span class="post-time small text-muted">11th November 2004 15:22 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Can this plugin download silent and with process?<br><br>can can shellexecute it.<br><br>I am new in NSIS can you include a simple example?<br><br>Thanks...</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Takhir</span><br><span class="post-time small text-muted">11th November 2004 17:52 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">This may be interesting - start download at the very beginning and run 2 processes, installation itself and file download (or I misunderstood something?).<br>It is possible to run dll as a process using rundll(32).dll, only new plug-in dll entry point required for this (short function). Programming side of problem is simple, but I'd like to understand first how to make working ftp reget using FtpCommand() call (size and restart commands). After this - may be.<br>If you want hide plug-in dialog in it's current state - comment ShowWindow() line in source code and rebuild project.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">kichik</span><br><span class="post-time small text-muted">11th November 2004 19:46 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">What are the minimum requirements for this plug-in? It takes proxy settings from IE, right? I have been meaning to write a new NSISdl based on IE's downloading engine to solve all of those proxy problems. If you're already at it, how about you add an option to download more than one file in a row, I review the code, and we slap a NSISdl2 tag on it?</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">grahama</span><br><span class="post-time small text-muted">11th November 2004 20:28 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">yea :)<br>I am having a lot of problems with corporate networks using proxy settings<br>a new NSISdl would be fantastic<br>g</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Takhir</span><br><span class="post-time small text-muted">12th November 2004 12:44 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"></p><blockquote><i>Originally posted by kichik</i><br><i>What are the minimum requirements for this plug-in? It takes proxy settings from IE, right?</i></blockquote>I also had a full range of chunked HTTP + proxy problems in one of my apps when used socket based http client :( . What is good for net learning, sometimes is bad for business :) But few years ago Win95 compatibility requirement was taken off (in later Win versions IE and Inet API is always on place), and I could re-work it to Inet API.<br>Minimum requirements... HTTP without problems. I also thought about re-get functionality (for installers trying to download dotnetfx via dial-up) and about ftp, but it looks like both idias are not claimed by developers :)<br>OK, simple and stable http download without re-get, but more then one file. I thought about local path definition only (instead of every local file parameter), but this limits functionality with static server files only (not cgi/php), so parameters line is following:<br><br>InetLoad::load URL1 local_file1 [URL2 local_file2 [...]]<br><br>ftp works, but it not requests file size - InternetOpenUrl() functionality is limited.</div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Takhir</span><br><span class="post-time small text-muted">13th November 2004 09:14 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><b><i>to Kichik</i></b><br>I also thought a little about extended requirements and result attached, better ftp and simple (hidden) re-get. But more code - more bugs :) You can use any version.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Takhir</span><br><span class="post-time small text-muted">13th November 2004 12:16 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">I fixed one bug in last (extended) version and improved download status displaying.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">grahama</span><br><span class="post-time small text-muted">14th November 2004 20:56 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">is inetload working with proxy networks...or is that a future thing ?<br>g</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Takhir</span><br><span class="post-time small text-muted">15th November 2004 08:18 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Good question. Plug-in works in my proxy tests, but this is 10% of success only :( - independent test results required. I see non-zero downloads count, may be somebody (grahama) also can test plug-in :) Another request - english spelling in the InetLoad.cpp (and may be dialog window).<br>Thanks.<br>Attached version functionality is almost the same as in the previous post, I only made an attempt to remember "coding rules" and re-formatted source text (for possible cvs commits :).</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">grahama</span><br><span class="post-time small text-muted">15th November 2004 19:47 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">will do and report back... :)<br><br>g</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">grahama</span><br><span class="post-time small text-muted">15th November 2004 20:57 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">could add a Silent feature ?<br>something like:<br>inetLoad::load /SILENT "http://blah.com/blah.jpg" "$EXEDIR\blah.jpg"<br><br><br>will possibly get this thing tested today :)<br>g</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">grahama</span><br><span class="post-time small text-muted">15th November 2004 23:53 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">great news :)<br>initial tests from a client came back successful...<br>I'll go there myself to make sure later in the week...<br>but this is very good news as nothing was getting thru with nsisdl<br>g</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Takhir</span><br><span class="post-time small text-muted">16th November 2004 10:55 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Many thanks, grahama. I'll add this option (I tested right now - plug-in can take string from the stack and push it back if this is not /silent parameter :) ), but let's wait a little for another replies.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Takhir</span><br><span class="post-time small text-muted">17th November 2004 07:48 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">New plug-in version with /SILENT support (optional).<br>Usage:<br>InetLoad::load [/SILENT] URL1 local_file1 [URL2 local_file2 [...]]<br><br>Returns "OK" string if download successful<br><br>Pop $0<br>StrCmp $0 "OK" dlok<br>MessageBox ...<br>Quit<br>dlok:<br>...</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">grahama</span><br><span class="post-time small text-muted">17th November 2004 19:44 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">thanks for the Silent Feature Takhir<br><br>is there a way I could pass along download info to the MUI interface like Nsisdl does ? very cool stuff :)<br>g</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Takhir</span><br><span class="post-time small text-muted">18th November 2004 18:17 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">NSISdl uses "files" page for progress bar and status display. My variant uses it's own dialog window and may work even from .onInit function (without installer page) - I know situations when this is important. And I guess it is better to use more space for all these numbers and names displaying - url, local file, file size, done, transfer rate, remaining time, total time, percents. Another words I'd like to keep my dialog :)<br>I see 2 situations: 1) installer is visible and plug-in window appears as it is; 2) totally silent install and plug-in is also hidden (some logic may require in the plug-in call).<br>But it may be good to add something meaning above general prograss bar (1006 static, where installer shows file names) :) , for example "InetLoad plug-in".</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">kichik</span><br><span class="post-time small text-muted">18th November 2004 18:42 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">In the latest CVS version, NSIS passes the silent flag which you can check.<br><br>I prefer the download dialog to show inside the NSIS dialog. It looks nicer.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Takhir</span><br><span class="post-time small text-muted">19th November 2004 11:57 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Situation: program requires system SP to be installed ( &gt;100 MB), this was found in .onInit function, but where to download SP? File copy page IMHO is not good place for this, might be better to do this after License page or even in .onInit function. But where to show progress bar if Installer’ dialog window not exists yet or have some other controls in this place (middle of the box). Or developers must create custom page for plug-in? I still guess that dialog box is better way (while dialog design is ugly ). Also: when user closes plug-in dialog window, plug-in’s main (dialog) thread tries to stop or terminate i/o thread – not bad when i/o hangs. When embedded to installer page this is not so obvious.<br>I added <i>extra-&gt;exec_flags-&gt;silent</i> support in some #ifdef’s to keep compatibility with current NSIS version (&lt;=2.02). Code attached.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">kichik</span><br><span class="post-time small text-muted">19th November 2004 12:05 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">No files should be downloaded in .onInit and anywhere else but the instfiles page. In my opnion, that's an annoying installer. I prefer installers to start "installing" only once I click install and verify all the parameters. But that can an option.<br><br>In NSISdl, another progress bar is created for the download status.<br><br>Clicking the Cancel button is more obvious than closing the download window.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Takhir</span><br><span class="post-time small text-muted">19th November 2004 12:34 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">I saw new progress bar created by NSISdl, but this is OK on instfiles page only, where this place is free. On the instfiles page - yes, this works fine.<br>When plug-in window is visible, installer page (if any) is unavailable, and (I hope) user will find how to close plug-in window. Or I can add there Cancel button (very easy in VS GUI).<br>The only place to start installation - yes, this is the best way, but life is very strange thing :) NSIS gives a lot of user vars to plug-in (but not silent state), this looks as very specific option (back door), so why not to give opportunity to download file in advance?</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">kichik</span><br><span class="post-time small text-muted">19th November 2004 12:37 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">The dialog area is free when a plug-in is called inside a custom page callback function.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">grahama</span><br><span class="post-time small text-muted">21st November 2004 16:57 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">for myself, I use banners in the beginning to alert the user of a version check....I download an ini file and compare it to the values in the registry...because the inetLoad plugin is larger the banner...it looks a little strange...This is only cosmetic, but I thought it was worth bringing up:)<br>having all the strings passed to the MUI [instead of the plugin dialog window] would be helpful in this particular situation...</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">grahama</span><br><span class="post-time small text-muted">24th November 2004 19:40 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Ok, I went over to Univision's [the client] corporate office and inetload did not work with their proxy network :( [nsisdl does not work either] My client launched the wrong installer...and told me it worked....<br>I am kind of at my wits end with this...Is there another installer product that works with proxy or is this something in the queue for NSIS...here is something odd that might be of note. My Apple powerbook[OS X] using Virtual PC [Win2k] gets thru their network on DHCP. Using the same installer app on THEIR pc does not get thru..... What would this point to ?<br>many thanks as I considering hard drugs at this point ;)<br>g</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Jnuw</span><br><span class="post-time small text-muted">14th December 2004 18:13 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">I'm having a problem too with my work's proxy. When i try to use inetload to download a text file, the text file's contents are overwritten with the page can not be display message, and the following:<br><br>HTTP 407 Proxy Authentication Required - The ISA Server requires authorization to fulfill the request. Access to the Web Proxy service is denied. (12209)<br>Internet Security and Acceleration Server<br><br>Any ideas? Thanks all.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Takhir</span><br><span class="post-time small text-muted">15th December 2004 11:08 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">It’s not easy to debug program if you cannot touch the problem with your own hands J<br>I made one minor improvement for error 407 (proxy authorization), might be good to test it. But the main question is in explicit proxy authorization if IE registry parameters (already used) are not enough for connection. This require user_name and password. I see 2 simple ways to resolve the problem, silent InternetSetOption(INTERNET_OPTION_PROXY_PASSWORD + INTERNET_OPTION_PROXY_USERNAME) if these parameters presents in the plug-in call (something like “load /PASSWD=passwd …”) or popup dialog (InternetErrorDlg for example), where user can enter name and passwd for proxy auth (not works in the silent mode). Both variants may present in program, of course. First is good for corporate network distribution, second – for Inet downloads. If this is what you need – I’ll be in office in Monday and can make changes next week.<br>Also few words about http server authorization (error 401) – it is possible to define name and password in the URL, program extracts both parameters (if any. I did this for FTP if anonymous user is not accepted).</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Jnuw</span><br><span class="post-time small text-muted">15th December 2004 16:33 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">SUCCESS!! Your new inetload cut right through my company's proxy! Thank you so much Takhir.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Jnuw</span><br><span class="post-time small text-muted">15th December 2004 22:14 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Takhir, I found a minor issue. Your plugin is still working beautifully, and getting through my proxy with out any problems, so thanks again.<br><br>I'm using your plugin with nsis 2.03, no MUI, and with a silent install. I'm just using message boxes and banners. If I run the InetLoad::load command with the /SILENT switch, all future message boxes appear in the background behind other windows. If I remove the /SILENT switch from the InetLoad::load, which is fine, message boxes appear in front as they should. I tried using the BringToFront command, but that did not work. Just wanted to let you know about this, but all in all, your plugin is working great!</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Takhir</span><br><span class="post-time small text-muted">16th December 2004 09:13 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Could not reproduce with 2.02 - works fine, but this happens with 2.03 (on my home Win98SE) :( And $HWNDPARENT is NULL, we cannot use SetForegroundWindow() syscall to improve your situation. May be NSIS devs can say something? Plug-in always creates it's dialog window (required for download sync), it is hidden in silent mode and has NULL parent, but I don't know how this can cause later abnormal bihavior of 2.03.<br>BTW - question to NSIS developers - while I see $HWNDPARENT == 0 in the 'SilentInstall silent' mode, can I use it instead of new 'extra-&gt;exec_flags-&gt;silent &gt; 0' flag ? Is this a reliable way?</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Jnuw</span><br><span class="post-time small text-muted">16th December 2004 14:43 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">No problem Takhir, thanks for looking into the minor problem. I don't mind running your plugin in non-silent mode, which corrects the problem. I'm still very pleased that your plugin gets through my proxy, so thanks again.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Takhir</span><br><span class="post-time small text-muted">16th December 2004 16:29 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">You can simply download and install 2.02 version - InetLoad worked fine with it silent mode. Problems appears in 2.03 only (and this not the first situation with 2.03).<br>Attached version recognizes silent installer mode even without /SILENT flag in the plug-in's call.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">kichik</span><br><span class="post-time small text-muted">16th December 2004 18:25 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">extra-&gt;exec_flags-&gt;silent != 0 is the most reliable way to detect silent installers. That is what NSIS itself uses.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">grahama</span><br><span class="post-time small text-muted">17th December 2004 05:43 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">great :)<br>I am no longer having proxy problems either...Just tried it again today at their corp headquaters. Is there any possibility that this plugin could be integrated into the the MUI ? In my case, it would look a bit slicker....as I was using nsisdl...<br>great job, Takhir :)<br>g</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Takhir</span><br><span class="post-time small text-muted">17th December 2004 07:28 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">I'll think about command line switch to support both modes ;)</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br><span class="post-time small text-muted">17th December 2004 11:01 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"></p><blockquote><i>Originally posted by Takhir</i><br><b>I'll think about command line switch to support both modes ;)</b></blockquote>That would be a very good idea. I'm also using NSISdl, so if you could implement NSISdl's dialogue features into yours (including the text string settings) then that would be awsome.<br><br>-Stu</div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">mrtech</span><br><span class="post-time small text-muted">18th December 2004 05:56 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">I just started using this little dittie, but had to put the whole dialog into silent mode. With the ns dl'er the full path was that was downloading was not shown, I preferred that. Is there a switch you can add for /hideurlprefix or /showfilenameonly or something like that, thanks.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Takhir</span><br><span class="post-time small text-muted">18th December 2004 09:24 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">First draft, but I could load some files with it :)<br>Requires 2.03 – new plug-in parameter in this version is the only way to auto-recognize silent install without explicit /SILENT parameter on any step including .onInit (where main installer window not exists yet).<br>/TIMEOUT parameter not implemented because MSDN describes many timeout flags (connect, receive, control send and receive, data send and receive…), so I guess would be better to left defaults.<br>/POPUP key displays detailed download dialog instead of embedded progress bar. Very useful in .onInit function (i.e. not in Section). So default is old (NSISdl) GUI :(<br>/SILENT key explicitly prevents from displaying of any plug-in' output (both popup dialog and embedded progress bar). Not required if 'SilentInstall silent' mode is defined in installation script.<br>Now plug-in displays short file name (like NSISdl did)<br>And I still hope that NSIS developers can solve 2.03 problem with new windows going to background in the silent mode (this worked fine in 2.02).</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br><span class="post-time small text-muted">18th December 2004 12:44 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">I tried the plugin with the NSISdl interface. I found one problem...<br><br>My title control (1006) has a transparent background (because you can't <i>not</i> have a transparent background when setting text colour using SetCtlColors for some reason). When I use InetLoad I get two layers of text on it: InetLoad plug-in and [download name].<br><br>Edit: Could you also change it to "Downloading [download name]..."<br><br>To fix the problem you need to refresh the label control by hiding it and showing it again and then set its text.<br><br>-Stu</p></div><hr><div class="container"><ol class="breadcrumb"><li><a href="../index.html" class="glyphicon glyphicon-home"></a></li><li><a href="f-65.html">NSIS Discussion</a></li><li class="active">http + ftp download plug-in</li></ol><p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=198596">http + ftp download plug-in</a></p><br><div class="post"><p class="post-meta"><span class="post-author text-primary">Takhir</span><br><span class="post-time small text-muted">18th December 2004 15:47 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Might be better to give me test script, but I did some changes - redraw not tested.<br>1006 redraw (RedrawWindow(with erase background))<br>Downloading ...<br>Connecting now appears at the beginning of download.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br><span class="post-time small text-muted">18th December 2004 20:50 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">The problem is still there with the overlapping text.<br>Compile this example; it shows the problem.<br><br>-Stu</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Takhir</span><br><span class="post-time small text-muted">19th December 2004 07:47 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Updated. Tested on Win98 SE and WinXP Pro.<br>And I still hope that InetLoad sounds better then NSISdl ;)</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br><span class="post-time small text-muted">19th December 2004 14:28 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Works beautifully, well done!<br>I will convert my installer over to InetLoad :)<br><br>-Stu</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br><span class="post-time small text-muted">19th December 2004 15:23 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Ok, I found some really dodgy weird bug.<br><br>If I Push two things onto the stack before calling InetLoad, InetLoad always fails and returns either "File Open Error" or "URL Parts Error".<br>InetLoad returns "File Open Error" if I have two empty strings ("") onto the stack, and "URL Parts Error" if I have two non-empty strings on the stack (ie "blah").<br>If I Pop one of them off immediately, InetLoad works as normal!<br>It seems that if I have more than one item on the NSIS stack, InetLoad fails.<br><br>This example shows the problem...<br>Compile it and you'll get the problem straight away.<br><br>Edit: Have you got code in there to read the URL and the save-to-file from the stack? Nothing in the readme about it!!!<br>And it's not reading from the top of the stack either, more like either at the bottom of somewhere in-between!<br><br>-Stu</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br><span class="post-time small text-muted">19th December 2004 15:33 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Could you just remove the stack support? For some reason because I'm using the stack a lot in this installer InetLoad messes the stack up completely (it seems to move things on the stack around!)<br><br>-Stu</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br><span class="post-time small text-muted">19th December 2004 15:38 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">If I Push this onto the stack first:<br>"ja"<br>"ja"<br>"$EXEDIR\GameVer.muf"<br>"http://myweb.tiscali.co.uk/imker/Updater/Games/hostile.gdf"<br>""<br>"$EXEDIR\GameVer.muf"<br>"http://myweb.tiscali.co.uk/imker/Updater/Games/hostile.gdf"<br><br>Then I call InetLoad, the stack becomes just:<br>"ja"<br><br>Definately something strange going on there :p<br><br>-Stu</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Takhir</span><br><span class="post-time small text-muted">19th December 2004 15:43 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">This is not a bug, Kichik asked to add multiple files support, as many as plug-in can find in stack. This is why plug-in reads stack till the bottom. If plug-in cannot read both URL and file_name (one string presents), it exits with OK code, but if 2 strings comes from stack and one is not URL or another is not a valid file path - it fails with some code.<br>And one more redraw of 1006 control on exit added, sorry, it's for 'Completed'.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br><span class="post-time small text-muted">19th December 2004 15:59 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">You need something in the plugin to check when the URL's Pushed on to the stack end. E.g.<br><br>Push "start urls"<br>Push "url 1"<br>Push "save to"<br>Push "url 2"<br>Push "save to"<br>InetLoad::Load /SILENT<br><br>InetLoad just needs to keep Popping off the stack until it finds the string "start urls" (or something).<br>Currently it's Popping <b>everything</b> off the stack <i>in case</i> that it's another download URL. This is silly because we might need to use the stack for other strings as well. We call InetLoad and after that they're all gone!<br><br>Edit: I don't think Kichik told you, but this has to be the default behaviour. Check out all the NSISdl macro's on the archive which do exactly the same thing...<br><br>-Stu</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Takhir</span><br><span class="post-time small text-muted">19th December 2004 16:28 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">I can add /END parameter for such situations, for example<br><br>Push "bla"<br>InetLoad::load /POPUP "http://myweb.tiscali.co.uk/imker/Updater/Games/hostile.gdf" "$EXEDIR\GameVer.muf" /END<br>Pop $R0<br>MessageBox MB_OK $R0<br>Pop $R0<br>MessageBox MB_OK $R0<br>Second MessageBox says "bla" in my test ;)</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br><span class="post-time small text-muted">19th December 2004 16:49 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Ah very cool! :)<br><br>I will try it out in a few minutes (when my map finishes compiling).<br><br>-Stu</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br><span class="post-time small text-muted">19th December 2004 16:54 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Just curious then... How does the plugin know whether to get the URL's from the stack or from the command-line. If no extra params exist on the command-line then it reads from the stack?<br><br>If it reads from the stack, then how does it know when to stop?<br>I might think about using the stack to pass multiple URL's...<br><br>-Stu</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Takhir</span><br><span class="post-time small text-muted">19th December 2004 17:42 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Plug-in takes all parameters from the stack only. And I thought this is mainroad of NSIS plug-in usage (or I misunderstood something?). Installer pushes command line parameters to stack before plug-in call, plug-in uses popstring() for [IN] parameters and pushstring() for [OUT] result (because all plug-in entry points are 'void' type). I guess :)</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br><span class="post-time small text-muted">19th December 2004 18:26 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Oh I see now. I didn't know that sorry :D<br><br>It now works bloody perfect, excellent! I can now distribute my installer (wahoo!)<br><br>-Stu :D</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Takhir</span><br><span class="post-time small text-muted">5th January 2005 19:38 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Last version archive page <a href="http://nsis.sourceforge.net/archive/nsisweb.php?page=671&amp;instances=0,32" target="_blank">http://nsis.sourceforge.net/archive/...instances=0,32</a></p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Takhir</span><br><span class="post-time small text-muted">11th January 2005 07:55 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">I tested new version, it supports MSI banner mode, two parameters set this window caption and text "/BANNER CAPTION TEXT". Multilined text may be created using $\n character in the TEXT string, up to 3 lines I could add there. Plug-in displays package first icon in the top left corner of the banner window. Progress bar appears when (and if) file size comes from server, so if file size is unavailable (chunked reply, very seldom for static files) or file size is &lt; 8 kB and line is fast, progress bar may stay hidden.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">mrtech</span><br><span class="post-time small text-muted">18th February 2005 21:16 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">I've just notice a little issue with the status returned after downloading. I've seen this on Win2k &amp; XPsp1 systems so far, what happens is that InetLoad return "1" instead of "Ok" after succesfully downloading a file. Here's my code snippet that I'm using with 2.05:<br></p><pre>
<code>  InetLoad::load "${PRODUCT_URL}$WEBFILE" "$TEMP\$WEBFILE"<br><br>  MessageBox MB_YESNO|MB_ICONQUESTION "$0" 0 0<br>  StrCmp $0 "Ok" 0 dlskip<br><br>  ExecWait '"$TEMP\$WEBFILE" /q'<br><br>  Delete '"$TEMP\$WEBFILE"'<br>dlskip:<br></code>
</pre><br>
        <br>
        Had to change "Ok" to "1" to get it to work again. Using the archive 1/18/2005 build.
      </div>
      <hr>

      <div class="post">
        <p class="post-meta"><span class="post-author text-primary">robber98</span><br>
        <span class="post-time small text-muted">18th February 2005 22:56 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

        <p class="post-content"></p>

        <blockquote>
          <i>Originally posted by mrtech</i><br>
          <b>I've just notice a little issue with the status returned after downloading. I've seen this on Win2k &amp; XPsp1 systems so far, what happens is that InetLoad return "1" instead of "Ok" after succesfully downloading a file. Here's my code snippet that I'm using with 2.05:<br></b>
          <pre>
<b><code>  InetLoad::load "${PRODUCT_URL}$WEBFILE" "$TEMP\$WEBFILE"<br><br>  MessageBox MB_YESNO|MB_ICONQUESTION "$0" 0 0<br>  StrCmp $0 "Ok" 0 dlskip<br><br>  ExecWait '"$TEMP\$WEBFILE" /q'<br><br>  Delete '"$TEMP\$WEBFILE"'<br>dlskip:<br></code></b>
</pre><b><br>
          <br>
          Had to change "Ok" to "1" to get it to work again. Using the archive 1/18/2005 build.</b>
        </blockquote>Don't you have to pop the return value after InetLoad? I don't see it from your code.
      </div>
      <hr>

      <div class="post">
        <p class="post-meta"><span class="post-author text-primary">mrtech</span><br>
        <span class="post-time small text-muted">19th February 2005 00:24 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

        <p class="post-content">oops, thanks.</p>
      </div>
      <hr>

      <div class="post">
        <p class="post-meta"><span class="post-author text-primary">Takhir</span><br>
        <span class="post-time small text-muted">21st February 2005 12:48 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

        <p class="post-content">2 updates: Resume option (for really bad connections :) ) and ftp "file not found" check out. If resume option set (/RESUME "Do u want to retry?") and error occure (except "not found"), plug-in first asks user to check connection. Many thanks to Afrow UK and azmoviez for ideas and help.</p>
      </div>
      <hr>

      <div class="post">
        <p class="post-meta"><span class="post-author text-primary">Yurik</span><br>
        <span class="post-time small text-muted">2nd March 2005 15:17 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

        <p class="post-content">Takhir,<br>
        is it possible to set proxy settings (proxy/port/user/password) for your plugin inside the NSIS script?<br>
        Thanks</p>
      </div>
      <hr>

      <div class="post">
        <p class="post-meta"><span class="post-author text-primary">Takhir</span><br>
        <span class="post-time small text-muted">3rd March 2005 12:36 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

        <p class="post-content">Proxy authorization support added. New command line options:<br>
        <br>
        /PROXY IP:PORT - overwrites current proxy settings, not required in most cases, because IE settings will be used by default.<br>
        /USERNAME LOGIN - proxy username<br>
        /PASSWORD PASSWD - proxy password<br>
        <br>
        For example<br>
        InetLoad::load /PROXY 55.55.55.55:8080 /USERNAME nick /PASSWORD jagger ....<br>
        <br>
        BTW URL can also include target server login/password, CrackUrl function recognizes it, something like this (remove spaces after : , :+p= :p ) : http://username: password@www.whatever.com/secret/eyesonly.htm<br>
        <br>
        Many thanks to Yurik for tests.</p>
      </div>
      <hr>

      <div class="post">
        <p class="post-meta"><span class="post-author text-primary">Takhir</span><br>
        <span class="post-time small text-muted">9th March 2005 09:44 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

        <p class="post-content">I have few similar requests, so new option:<br>
        /POPUP PREFIX<br>
        sets first part of the popup dialog caption (prefix), for example<br>
        /POPUP "Some text"<br>
        displays:<br>
        Some text - Connecting...<br>
        You cannot skip this parameter, but can use<br>
        /POPUP ""<br>
        for default ("InetLoad plug-in").</p>
      </div>
      <hr>

      <div class="post">
        <p class="post-meta"><span class="post-author text-primary">kichik</span><br>
        <span class="post-time small text-muted">25th March 2005 12:00 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

        <p class="post-content">I have tested the plug-in on Windows XP SP2. The HTTP download went well, but the FTP download failed. I have Windows Firewall turned on and it popped up a message asking me if I want to allow the installer to connect. InetLoad gave me an error message before I could unblock it. When I tried it again, after it was unblocked, it just failed with the same error message - "Open URL Error". The URL in the example seems OK. I was able to open it using Firefox.</p>
      </div>
      <hr>

      <div class="post">
        <p class="post-meta"><span class="post-author text-primary">Takhir</span><br>
        <span class="post-time small text-muted">25th March 2005 13:49 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

        <p class="post-content">Now I work on XP Pro SP2 too, new project <a href="http://www.modya.com" target="_blank">http://www.modya.com</a> requires this :(<br>
        MS Firewall bihaviour is so strange :) I deleted InetLoad from exclusions list, firewall popuped "restricted access" dialog, but I could see on the NSIS window under this dialog (I not closed it) that 25 MB download was continued and finished with OK status ...<br>
        Nevertheless, first question - MS Firewall connection error, simple patch: /RESUME "" option, I re-tested this, plug-in popups messagebox and continued download attempts after I clicked "Retry". Better way - specific firewall error, this case plug-in can auto-enable resume option (if install is not 'silent'). I wrote above that I could not reproduce situation, so KichiK please test attached dll, it should display messagebox with lasterror and InternetGetLastResponseInfo (if any). The only code I saw in the similar situations earlier with other programs was 12002 (when Firewall threated conection as virus atack).<br>
        Second question - InetLoad is in the Firewall list, but still connect error occure - no ideas right now..</p>
      </div>
      <hr>

      <div class="post">
        <p class="post-meta"><span class="post-author text-primary">kichik</span><br>
        <span class="post-time small text-muted">25th March 2005 15:16 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

        <p class="post-content">I didn't get any new message box using the attached DLL. Still the same "Download Status: Open URL Error". I should have included the "Download Status:" part in the last message. It seems the download does start because it updates the file size field (17kb). But then the firewall dialog opens and the failure message pops up.</p>
      </div>
      <hr>

      <div class="post">
        <p class="post-meta"><span class="post-author text-primary">dujuan</span><br>
        <span class="post-time small text-muted">26th March 2005 01:30 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

        <p class="post-content">Great plugin!<br>
        Does this plugin support timeout parameter like nsisdl ?</p>
      </div>
      <hr>

      <div class="post">
        <p class="post-meta"><span class="post-author text-primary">Takhir</span><br>
        <span class="post-time small text-muted">26th March 2005 13:47 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

        <p class="post-content">Attached version supports ;)<br>
        InternetSetOption flags include few timeout parameters, but I guess connect is what you want.<br>
        Also:<br>
        1. ftp client works in the passive mode, all modern servers support this.<br>
        2. On firewall error plug-in (if not in the silent mode) auto-enables Resume option and displays message box, so user can solve firewall problem and click Retry.</p>
      </div>
      <hr>

      <div class="post">
        <p class="post-meta"><span class="post-author text-primary">delboy</span><br>
        <span class="post-time small text-muted">28th March 2005 15:01 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

        <p class="post-content">Really cool, will set about updating our installers!<br>
        Quick question - when i used NSISDL i hacked together a method of allowing the user to quit out of the installer and pick up the download when they reran it (not very pretty but it helps for people downloading large files over dial up)<br>
        Is there a way of doing this more elegantly using the retry functionality you have in here (ie is there some way of persisting the status of download and picking it up again)?</p>
      </div>
      <hr>

      <div class="post">
        <p class="post-meta"><span class="post-author text-primary">Takhir</span><br>
        <span class="post-time small text-muted">28th March 2005 16:28 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

        <p class="post-content">1. If connection to server was lost, but some data were received during last session, plug-in makes a short pause, reconnects and continues download from the current position. A some kind of re-get.<br>
        2. If /RESUME "" option set, plug-in on any error except "file not found" first asks user (retry-cancel), this helps on dial-up connection and firewall problems.<br>
        2.5 On GetLastError()==12002 or 12003 (in most cases firewall related) plug-in auto-enables /RESUME option, but please note that english default text will be used in the message box (many thanks again to Stu from Shropshire for the great text :) ).<br>
        Finally plug-in returns "OK" or error description string (full set of strings in the InetLoad.cpp file), so on error you can ask user again or terminate installation. You can find all plug-in command line options in the Readme.txt (including 3 display modes).<br>
        I hope all these tricks may help to solve some common download problems :)</p>
      </div>
      <hr>

      <div class="post">
        <p class="post-meta"><span class="post-author text-primary">delboy</span><br>
        <span class="post-time small text-muted">1st April 2005 14:04 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

        <p class="post-content">Hi Takhir, Is persisting the download session possible, such that a user may actually quit out of the installation and on the next run auto resume the download? obviosuly the logic behind this would be in the nsis script itself, but its more a question of how easy it would be to have say a retry now retry later and cancel options on that connection failure box.</p>
      </div>
      <hr>

      <div class="post">
        <p class="post-meta"><span class="post-author text-primary">seniorquico</span><br>
        <span class="post-time small text-muted">14th April 2005 05:03 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

        <p class="post-content">I've got an interesting problem with Inetload. I haven't really found any info on something like this, but I've been scratching my head for a few hours and I just can't seem to figure it out. I copied the Inetload command from the example in the plugin archive and added a file of my own on a new command right after it, just like so (on multiple lines to try not to break page's design):<br></p>
        <pre>
<code>InetLoad::load /POPUP "http://www.dreamgirlswallpaper.co.uk/<br>    fiveyearsonline/wallpaper/Cameron_Diaz/camerond09big.JPG"<br>     "$EXEDIR\cd.jpg"<br>InetLoad::load /POPUP "ftp://my_server/patches/patch1.exe" "$EXEDIR\patch1.exe"<br></code>
</pre><br>
        The above code WORKS without any problems. But now the interesting thing (at least to me), the moment I delete the first line, the Cameron Diaz pic dl, the whole thing stops working! To be more specific, the installer downloads the file just like it did previously, but as soon as it obtains the file, the installer crashes! I started to play around with this some more, and I further came to the conclusion that if I even change the Cameron Diaz pic to ANYTHING else, the installer crashes after obtaining the files. Now, I don't know if this is a cruel joke to make us all download that file, but I really can't figure this problem out. But, I'm just a "simple" web programmer so what do I know about these complex NSIS scripts and plugins. Any help would be GREATLY appreciated.
      </div>
      <hr>

      <div class="post">
        <p class="post-meta"><span class="post-author text-primary">Takhir</span><br>
        <span class="post-time small text-muted">14th April 2005 07:29 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

        <p class="post-content">First of all if you are using latest plug-in version, popup parameter includes 'prefix' text, to use default it should be /POPUP ""<br>
        Code above should not work because first download result - 'OK' string (from Cameron :) ) is in the stack yet, please use Pop $1 (for example) after every download to clean stack. Otherwise 'OK' string will be first parameter for the next plug-in call. If you are using stack for other vars, use /END parameter (see Readme) to stop plug-in's stack reading at the end of this command line. Plug-in also supports few downloads from one command line.<br>
        And now some single ftp download, re-tested:<br></p>
        <pre>
<code><br>Section "Dummy Section" SecDummy<br><br>    InetLoad::load /POPUP "Readme.txt from MS FTP" "ftp://ftp.microsoft.com/MISC/ReadMe1.txt" "$EXEDIR\rm.txt" /END<br>    Pop $0 # return value = exit code, "OK" if OK<br>    MessageBox MB_OK "Download Status: $0"<br><br>SectionEnd<br></code>
</pre><br>
        <br>
        Status 'OK', file looks correct too. I aslo tested big ftp download with login:password in the LAN, and not found any problems. And I hope that bad syntax only might cause crash :)
      </div>
      <hr>

      <div class="post">
        <p class="post-meta"><span class="post-author text-primary">dujuan</span><br>
        <span class="post-time small text-muted">15th April 2005 10:55 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

        <p class="post-content">Does this plug support rtsp or mms protocol ?</p>
      </div>
      <hr>

      <div class="post">
        <p class="post-meta"><span class="post-author text-primary">Takhir</span><br>
        <span class="post-time small text-muted">15th April 2005 11:23 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

        <p class="post-content">http and ftp only. rtsp(tcp) - no, rtsp over http - I am not sure, but if you want (and can) save all content to file (using http as transport) - may be (not tested). But please note, http and ftp support GET method only. Probably the same with mms.</p>
      </div>
      <hr>

      <div class="post">
        <p class="post-meta"><span class="post-author text-primary">Takhir</span><br>
        <span class="post-time small text-muted">18th April 2005 09:10 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

        <p class="post-content">CrackUrl() string buffers length bug fixed (256-&gt;NSIS string_size).</p>
      </div>
      <hr>

      <div class="post">
        <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br>
        <span class="post-time small text-muted">23rd April 2005 13:01 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

        <p class="post-content">Hey Takhir, just wondering why with InetLoad I only get a maximum of 30kbps download speeds on all servers when through browsers I usually get 80-120kbps.<br>
        <br>
        Other people have the same problem too.<br>
        <br>
        Edit: Same problem with NSISdl too :(<br>
        <br>
        -Stu</p>
      </div>
      <hr>

      <div class="post">
        <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br>
        <span class="post-time small text-muted">23rd April 2005 20:18 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

        <p class="post-content">I was wondering if you could implement the NXS progress banner into InetLoad, so we could have just a simple progress bar when downloading small files between pages.<br>
        <br>
        Also, how easy would it be to write a BitTorrent plugin that works. I've tried the one on the archive (written in Python) but it doesn't seem to work at all.<br>
        The actual example is very poor too.<br>
        <br>
        -Stu</p>
      </div>
      <hr>

      <div class="post">
        <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br>
        <span class="post-time small text-muted">23rd April 2005 22:18 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

        <p class="post-content">Now I'm trying to get InetLoad to execute a PHP script on the internet. Everytime it says File Open Error, when the script is executed fine through my browser.<br>
        I've even tried setting the Content-length header and then it works in NSISdl, but still not with InetLoad.<br>
        <br>
        I tried the post example script you made, but that doesn't work for me either. I'm wondering if it's the server, but if it works with NSISdl then surely it can't be...<br>
        <br>
        Please help :(<br>
        <br>
        Edit: LOL now it's working. Because I'm using CallInstDLL to call the plugin, I had the URL and local file Push order swapped :p<br>
        <br>
        -Stu</p>
      </div>
      <hr>

      <div class="post">
        <p class="post-meta"><span class="post-author text-primary">Jnuw</span><br>
        <span class="post-time small text-muted">25th April 2005 21:43 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

        <p class="post-content"></p>

        <blockquote>
          <i>Originally posted by Afrow UK</i><br>
          <b>Hey Takhir, just wondering why with InetLoad I only get a maximum of 30kbps download speeds on all servers when through browsers I usually get 80-120kbps.<br>
          <br>
          Other people have the same problem too.<br>
          <br>
          Edit: Same problem with NSISdl too :(<br>
          <br>
          -Stu</b>
        </blockquote>Stu, I just tested it on my work PC, i was getting around 1360kbps which is about 90% of our T1. I'm using the InetLoad from 3/3/05, which is probably <a href="http://forums.winamp.com/attachment.php?s=&amp;postid=1606030" target="_blank">this one</a>. Hope this helps.<br>
        <br>
        Jnuw
      </div>
      <hr>
      
      
      

      <div class="container">
        

        <ol class="breadcrumb">
          <li><a href="../index.html" class="glyphicon glyphicon-home"></a></li>

          <li><a href="f-65.html">NSIS Discussion</a></li>

          <li class="active">http + ftp download plug-in</li>
        </ol>

        <p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=198596">http + ftp download plug-in</a></p><br>

        <div class="post">
          <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br>
          <span class="post-time small text-muted">26th April 2005 13:53 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

          <p class="post-content">Thanks, I'll try it.<br>
          <br>
          -Stu</p>
        </div>
        <hr>

        <div class="post">
          <p class="post-meta"><span class="post-author text-primary">tbrandner</span><br>
          <span class="post-time small text-muted">6th May 2005 18:59 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

          <p class="post-content"><strong>Long 50 second delay after download</strong><br>
          Wow, inetload is a great plug-in!<br>
          <br>
          I have a packaged installer that grabs a file over the 'net, and it's working great aside from a small problem that happens after a successful download.<br>
          <br>
          After a successful download, there is about a 50 second delay before the installer continues. I've put message box popups at each step of the installer, and the delay is immediately after the inetload:load command.<br>
          <br>
          Any idea where this delay is coming from? It doesn't seem to have anything to do with the size of the download...?<br>
          <br>
          Thanks,<br>
          <br>
          Tony</p>
        </div>
        <hr>

        <div class="post">
          <p class="post-meta"><span class="post-author text-primary">Takhir</span><br>
          <span class="post-time small text-muted">10th May 2005 20:14 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

          <p class="post-content">Now I am online again and I'll check all problems tomorrow.<br>
          tbrandner: I saw delay on the plug-in exit (cannot remember precisely when &amp; where), but this happened after last plug-in operator (probably in the NSIS code). Can you give me script sample?<br>
          Afrow UK: last version worked with my office 8 Mbit/sec line. I can test script sample if required. And I need to understand bittorent protocol first, I'll try :)</p>
        </div>
        <hr>

        <div class="post">
          <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br>
          <span class="post-time small text-muted">10th May 2005 21:43 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

          <p class="post-content">Thanks Takhir. If you can get BitTorrent to work, that would be amazing!<br>
          <br>
          -Stu</p>
        </div>
        <hr>

        <div class="post">
          <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br>
          <span class="post-time small text-muted">11th May 2005 13:23 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

          <p class="post-content">It's ok Takhir, thanks to immadster the author of XBTT <a href="http://sourceforge.net/projects/xbtt/" target="_blank">http://sourceforge.net/projects/xbtt/</a> has agreed to make a BitTorrent plugin for NSIS.<br>
          <br>
          Not sure exactly how long it will take though.<br>
          <br>
          -Stu</p>
        </div>
        <hr>

        <div class="post">
          <p class="post-meta"><span class="post-author text-primary">Yathosho</span><br>
          <span class="post-time small text-muted">12th May 2005 09:59 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

          <p class="post-content">i'm just switched from NSISdl to InetLoad, as NSISdl does not support URL encoded login/password. i'm using a function that reads a set of URLs from a text-file and downloads one file after another. i experienced that InetLoad uses to crashes my installer quite often, without a recognizable pattern.<br>
          <br>
          edit: this only seems to happen when running InetLoad in a loop. when i downloaded 10 files with 10 InetLoad commands i experience no problems. any fix or workaround?</p>
        </div>
        <hr>

        <div class="post">
          <p class="post-meta"><span class="post-author text-primary">Takhir</span><br>
          <span class="post-time small text-muted">12th May 2005 11:38 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

          <p class="post-content"><b>Yathosho:</b> This may be blank space in the URL or \r - \n at the end of line. I can fix, but I'd like to understand the problem first. Script sample? :)<br>
          <b>Afrow UK:</b> Just tested SP download 130 MB - 13 sec in the 100 Mb LAN.</p>
        </div>
        <hr>

        <div class="post">
          <p class="post-meta"><span class="post-author text-primary">Takhir</span><br>
          <span class="post-time small text-muted">12th May 2005 12:09 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

          <p class="post-content"><i>Originally posted by Afrow UK<br>
          I was wondering if you could implement the NXS progress banner into InetLoad, so we could have just a simple progress bar when downloading small files between pages.</i><br>
          <br>
          Following "banner" mode has not Cancel button (but Esc key works):<br>
          <br>
          /BANNER CAPTION TEXT<br>
          <br>
          For example:<br>
          InetLoad::load /banner "Cameron Diaz" "coming soon" "ftp://...."<br>
          <br>
          I cannot remeber right now why I removed x button from the banner dialog, but I can put it back :)</p>
        </div>
        <hr>

        <div class="post">
          <p class="post-meta"><span class="post-author text-primary">Yathosho</span><br>
          <span class="post-time small text-muted">12th May 2005 12:25 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

          <p class="post-content">afrow: could this be a <a href="http://www.tweakxp.com/display.aspx?id=282" target="_blank">Qos</a> related problem?<br>
          <br>
          takhir: send you a private message!</p>
        </div>
        <hr>

        <div class="post">
          <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br>
          <span class="post-time small text-muted">12th May 2005 17:40 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

          <p class="post-content">Yathosho I couldn't find anything related on that link...<br>
          <br>
          And thanks for the banner Takhir, I'll have a look at that now.<br>
          <br>
          Edit: Oh it doesn't have a progress bar though. I've already got a banner showing but a progress bar would be nice too.<br>
          <br>
          -Stu</p>
        </div>
        <hr>

        <div class="post">
          <p class="post-meta"><span class="post-author text-primary">Wishdoctor</span><br>
          <span class="post-time small text-muted">18th May 2005 00:56 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

          <p class="post-content"><strong>Assistance needed</strong><br>
          Hello all,<br>
          <br>
          I am a poor downtrodden Senior Tech (well..thats how I feel at the moment anyway). Have been using NSIS for +-8 months to convert those pesky batch files to something even my junior engineers couldn't mess up.. then came SALESmen...who saw what I could do and asked a favour...could I create an installer for an offering that installs multiple 3rd party apps silently...no problem I say...and I get it working...THEN they change the goalposts with a live demo ...TOMORROW!!!<br>
          Just had to tell the story as I feel a lot of techs and devs will have had the same experience...anyway...goalpost change was to download the installers from an FTP site rather than sending out disks to the client...great, but there are multiple files in the ftp locations.<br>
          <br>
          And here is the question...maybe I am just tired and cranky...inetload is excellent but I can't find a way to download all the files in an FTP location without specifying them individually...please tell me I am missing something and it is easy - either way, I think I will go and apply a hammer to the frontal lobe while I wait for a response. The way my brain is working, some example basic code would help.<br>
          Thanks</p>
        </div>
        <hr>

        <div class="post">
          <p class="post-meta"><span class="post-author text-primary">Takhir</span><br>
          <span class="post-time small text-muted">18th May 2005 07:12 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

          <p class="post-content">Afrow UK: progress bar appears on the banner if file size info is available. May not appera on the short files (&lt;8 kB). Known problem - this is not 'cross page' banner (like nxs is), plug-in returns when download is complitted only (or error occure).<br>
          <br>
          Wishdoctor:<br>
          &gt; TOMORROW!!!<br>
          Not implemented :(<br>
          This require ftp 'mput' command, but I don't know (right now) how to handle ftp control and data connections in this case. Needs some investigation.<br>
          You can also pack server files to the single archive file and use one of NSIS decompression plug-ins.</p>
        </div>
        <hr>

        <div class="post">
          <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br>
          <span class="post-time small text-muted">24th May 2005 15:23 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

          <p class="post-content">Don't know if this is a bug or by design but calling the plugin from a Section in /silent mode still brings up "InetLoad plugin" in the details text label at the top.<br>
          <br>
          I'd like to display "Downloading [file]..." (w/ DetailPrint) there instead which just gets overwritten.<br>
          <br>
          -Stu</p>
        </div>
        <hr>

        <div class="post">
          <p class="post-meta"><span class="post-author text-primary">Takhir</span><br>
          <span class="post-time small text-muted">25th May 2005 06:51 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

          <p class="post-content">This is option. You can change this with following code beginning line 832 of InetLoad.cpp<br></p>
          <pre>
<code><br>   if(hwndParent != NULL &amp;&amp;<br>      (childwnd = FindWindowEx(hwndParent, NULL, "#32770", NULL)) != NULL)<br>{<br>      if(!silent) SetDlgItemText(childwnd, 1006, PLUGIN_NAME);<br>}<br>   else InitCommonControls();<br></code>
</pre><br>
          And rebuild project (Release).<br>
          Idea was to left "InetLoad" word somewhere :) May be I'll remove it in the next version (with POST option support, if it will be successfully tested not on my comp only).
        </div>
        <hr>

        <div class="post">
          <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br>
          <span class="post-time small text-muted">25th May 2005 11:15 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

          <p class="post-content">Umm I'm using Visual C++ 2003 and I get these errors on compile:<br>
          d:\Program Files\NSIS\Contrib\inetload\InetLoad.cpp(48): error C2365: 'FtpCommandA' : redefinition; previous definition was a 'function'<br>
          d:\Program Files\NSIS\Contrib\inetload\InetLoad.cpp(521): error C2659: '=' : overloaded function as left operand<br>
          <br>
          -Stu</p>
        </div>
        <hr>

        <div class="post">
          <p class="post-meta"><span class="post-author text-primary">Takhir</span><br>
          <span class="post-time small text-muted">25th May 2005 19:46 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

          <p class="post-content">Special build - text for 1006 control as /silent 'some text' option. It looks like NSIS cleans this field before plug-in call, so you cannot use script to set text. Usage sample in the attached file.</p>
        </div>
        <hr>

        <div class="post">
          <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br>
          <span class="post-time small text-muted">25th May 2005 21:36 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

          <p class="post-content">Mmm I tried that DLL and I think it's taking 'some text' as a download URL.<br>
          <br>
          If I use /SILENT "blah" [url] download fails but if I use /SILENT [url] it does not fail.<br>
          <br>
          -Stu</p>
        </div>
        <hr>

        <div class="post">
          <p class="post-meta"><span class="post-author text-primary">Takhir</span><br>
          <span class="post-time small text-muted">26th May 2005 16:34 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

          <p class="post-content">Sorry, wrong file :(</p>
        </div>
        <hr>

        <div class="post">
          <p class="post-meta"><span class="post-author text-primary">MichaelFlya</span><br>
          <span class="post-time small text-muted">27th May 2005 14:56 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

          <p class="post-content">I need this To Work With InetLoad.<br>
          <br></p>
          <pre>
<code><br>    Pop $0<br><br>         MessageBox MB_YESNOCANCEL "Message" IDYES LABEL1 IDNO LABLE2<br>                 Quit<br></code>
</pre><br>
          <br>
          What do I Say After Pop $0 to Get it to<br>
          Pass The MessageBox and Quit Code if<br>
          Successful?<br>
          <br>
          -MichaelFlya-
        </div>
        <hr>

        <div class="post">
          <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br>
          <span class="post-time small text-muted">27th May 2005 15:34 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

          <p class="post-content">Pop $R0<br>
          StrCmp $R0 ok +3<br>
          MessageBox MB_YESNOCANCEL "Message"<br>
          Quit<br>
          <br>
          -Stu</p>
        </div>
        <hr>

        <div class="post">
          <p class="post-meta"><span class="post-author text-primary">MichaelFlya</span><br>
          <span class="post-time small text-muted">27th May 2005 16:05 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

          <p class="post-content">Thx Works Well !!<br>
          <br>
          -MichaelFlya-</p>
        </div>
        <hr>

        <div class="post">
          <p class="post-meta"><span class="post-author text-primary">Takhir</span><br>
          <span class="post-time small text-muted">6th June 2005 09:47 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

          <p class="post-content">Updated - not skips current download if "Enter" key was pressed.<br>
          And /SILENT now with text parameter, use<br>
          /SILENT ""<br>
          to display default "InetLoad plug-in" in the 1006 control (install progress text on the top of the NSIS window).</p>
        </div>
        <hr>

        <div class="post">
          <p class="post-meta"><span class="post-author text-primary">MichaelFlya</span><br>
          <span class="post-time small text-muted">6th June 2005 17:00 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

          <p class="post-content">Great Thanks Takhir !!! "Enter" Button seems to no longer<br>
          be a problem.<br>
          <br>
          (Please help me troubleshoot.)<br>
          <br>
          While in /BANNER mode, on the Banner it will show what I<br>
          want, but above the loading bar it just shows "InetLoad<br>
          plug-in", I'd rather it be what I want.<br>
          <br>
          I may be wrong, you may have put it in some how. It seems<br>
          you need one more text input for the dialog shown above<br>
          the details while in the Banner mode. like the Silent mode<br>
          now has. If you have it already how would you do it?<br>
          <br></p>
          <pre>
<code><br>    InetLoad::load /BANNER "Displays on banner." "Displays on banner." "URL for file" "Directory for file"<br></code>
</pre><br>
          <br>
          You have two text fields available, can you add three?<br>
          <br>
          I think it is "Set TEXT2DISPLAY to 1006 control". I don't<br>
          know how to set that manually. How would I?<br>
          <br>
          -MichaelFlya-
        </div>
        <hr>

        <div class="post">
          <p class="post-meta"><span class="post-author text-primary">Takhir</span><br>
          <span class="post-time small text-muted">6th June 2005 18:03 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

          <p class="post-content">In the Banner or Popup modes this text appears on the background window (NSIS dialog), so user can see: 1) installer's Fileinst page; 2) files installation step - "InetLoad plug-in" text in the 1006 field; 3) Inet file download progress on the popup or banner window. In the NSISdl or Silent modes level (3) is absent and details can be moved to second level, but IMHO this is not realy need for Popup and Banner. And I'd like to left "InetLoad" text somewhere on the screen ;)<br>
          It looks like installer (NSIS) clears this field before plug-in call, so it is not possible to set 1006 control text from script - it will be removed.<br>
          But, any case, thanks, I'll think about you idea :)</p>
        </div>
        <hr>

        <div class="post">
          <p class="post-meta"><span class="post-author text-primary">MichaelFlya</span><br>
          <span class="post-time small text-muted">6th June 2005 18:53 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

          <p class="post-content">Oh ok. It would be nice to say something besides InetLoad<br>
          the user doesn't need to see that. On long downloads it is<br>
          there for a long time. It is off topic for the installation.<br>
          Thank you very much for taking the time to respond. :)<br>
          <br>
          Here is an idea that I would need somewhere down the line<br>
          and saves time. Your idea is to tell the plug-in to go to a<br>
          url then specify it's place on the hard drive to download to.<br>
          Then do it again for another file on the same line.<br>
          <br>
          I think you should have another mode that allows you to<br>
          tell the plug-in to grab files from one url on the Internet<br>
          then without having to type the directory or url again just<br>
          specify the files.<br>
          <br>
          so something like this:<br>
          <br></p>
          <pre>
<code><br>InetLoad::load /NewSwitch /ExistingSwitch "Text" "Text" "URL" "Directory to download to" "File_01" "File_02" "File_03" "File_04/Etc"<br></code>
</pre><br>
          <br>
          That way you do not have to say "URL for file"<br>
          or "Directory for file" again, over and over.<br>
          <br>
          I know you can rewrite the name with a second field after<br>
          the file, but in this case it could just keep the same name.<br>
          <br>
          Could make one more Switch for those who want to rename<br>
          like this:<br>
          <br>
          <pre>
<code><br>"File_01" "Rename" "File_02" "Rename" "File_03" "Rename" "File_04" "Rename/Etc"<br></code>
</pre><br>
          <br>
          <br>
          -MichaelFlya-
        </div>
        <hr>

        <div class="post">
          <p class="post-meta"><span class="post-author text-primary">MuskieMikie</span><br>
          <span class="post-time small text-muted">13th June 2005 22:03 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

          <p class="post-content">I'm experiencing the 50 sec delay after inetload downloads the file. This only occurs when downloading from ftp. http is fine.<br>
          <br>
          Section "MainSection" SEC01<br>
          SetOutPath $INSTDIR<br>
          InetLoad::load "ftp://ftpsdk:Rfloatpt@ftp.ati.com/AdbeRdr70_enu.exe" "AdbeRdr70_enu.exe"<br>
          ExecWait '"AdbeRdr70_enu.exe"'<br>
          SectionEnd</p>
        </div>
        <hr>

        <div class="post">
          <p class="post-meta"><span class="post-author text-primary">Takhir</span><br>
          <span class="post-time small text-muted">14th June 2005 07:27 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

          <p class="post-content">This is second request with 50 sec delay problem, but I still cannot reproduce it. Right now I tested following code and Adobe installation started immediately after download was completed (12.8 MB :) ):<br></p>
          <pre>
<code><br>Section "Dummy Section" SecDummy<br>SetOutPath $INSTDIR<br>InetLoad::load "ftp://ftpsdk:Rfloatpt@ftp.ati.com/AdbeRdr70_enu.exe" "AdbeRdr70_enu.exe" /end<br>ExecWait '"AdbeRdr70_enu.exe"'<br>SectionEnd<br></code>
</pre>
        </div>
        <hr>

        <div class="post">
          <p class="post-meta"><span class="post-author text-primary">Takhir</span><br>
          <span class="post-time small text-muted">21st June 2005 16:51 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

          <p class="post-content">2 new options: /NOCANCEL and /NOPROXY<br>
          First option prevents download from being interupted by user (locks Esc, Alt-F4, Cancel handling).<br>
          Second - disables proxy settings for this connection (if any). InternetOpen() uses INTERNET_OPEN_TYPE_DIRECT instead of default INTERNET_OPEN_TYPE_PRECONFIG.</p>
        </div>
        <hr>

        <div class="post">
          <p class="post-meta"><span class="post-author text-primary">Mæster</span><br>
          <span class="post-time small text-muted">21st June 2005 17:54 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

          <p class="post-content"></p>

          <blockquote>
            InternetOpen() uses INTERNET_OPEN_TYPE_DIRECT instead of default INTERNET_OPEN_TYPE_PRECONFIG.
          </blockquote>So this will bypass any proxy?
        </div>
        <hr>

        <div class="post">
          <p class="post-meta"><span class="post-author text-primary">Takhir</span><br>
          <span class="post-time small text-muted">21st June 2005 18:24 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

          <p class="post-content">Not tested, because I have not proxy at home :), but looks simple, and MSDN says this flag "INTERNET_OPEN_TYPE_DIRECT - Resolves all host names locally."<br>
          "INTERNET_OPEN_TYPE_PRECONFIG - Retrieves the proxy or direct configuration from the registry."<br>
          BTW it is possible to disable proxy using HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Internet Settings ProxyEnable, but plug-in's parameter limits changes with this session only.</p>
        </div>
        <hr>

        <div class="post">
          <p class="post-meta"><span class="post-author text-primary">Mæster</span><br>
          <span class="post-time small text-muted">21st June 2005 19:03 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

          <p class="post-content"></p>

          <blockquote>
            "INTERNET_OPEN_TYPE_PRECONFIG - Retrieves the proxy or direct configuration from the registry."<br>
            BTW it is possible to disable proxy using HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Internet Settings ProxyEnable, but plug-in's parameter limits changes with this session only.
          </blockquote>Seems, that all that stuff (only) deals with the internet explorer proxy settings. So if the proxy settings are not set within ie (registry) that probably wont work with other external proxies. But thats all theory, I dont have a proxy for myself - so I couldnt test it.<br>
          <br>
          Because writing an Internet Updater with NSIS I am searching a long time for a nsisdl solution (or something similar) which can handle proxies which are not specified inside the ie settings (in the usually registry keys).<br>
          <br>
          Regards,<br>
          Mæster.
        </div>
        <hr>

        <div class="post">
          <p class="post-meta"><span class="post-author text-primary">Takhir</span><br>
          <span class="post-time small text-muted">21st June 2005 19:53 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

          <p class="post-content">InetLoad uses WinInet API, by default IE proxy settings will be used. But /PROXY "IP:PORT" option (string will be used as a part of INTERNET_PROXY_INFO structure) option can change proxy list for plug-in.</p>
        </div>
        <hr>

        <div class="post">
          <p class="post-meta"><span class="post-author text-primary">Megiddo_Guest</span><br>
          <span class="post-time small text-muted">25th June 2005 03:53 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

          <p class="post-content">Can you make it so it won't take the focus ( comes to the front ) every time it downloads a file? I'm making a system that downloads about 6000 (small) files in a row, and it quite effectively keeps you from doing anything else.</p>
        </div>
        <hr>

        <div class="post">
          <p class="post-meta"><span class="post-author text-primary">Takhir</span><br>
          <span class="post-time small text-muted">26th June 2005 13:21 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

          <p class="post-content"><b>Megiddo_Guest</b><br>
          At the very beginnig this feature was requested by Jnum for silent mode, but I did it for all cases. OK, please test attached version - should be not so annoying in non-silent mode.</p>
        </div>
        <hr>

        <div class="post">
          <p class="post-meta"><span class="post-author text-primary">Mario Jr.</span><br>
          <span class="post-time small text-muted">26th June 2005 15:45 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

          <p class="post-content">Is it possible to create something like a patch client to download the latest version using nsis and this plugin? If so can someone maybe give me an hint?</p>
        </div>
        <hr>

        <div class="post">
          <p class="post-meta"><span class="post-author text-primary">Takhir</span><br>
          <span class="post-time small text-muted">26th June 2005 16:22 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

          <p class="post-content">1. Create installer without uninstall section, for example Updater.exe with package download and install functionality. Include it to your distribution package, add link to Start menu. Or execute it in the silent mode once a week from your application. It should send request to server with current version number, server can return new package or "no version yet"\ :)<br>
          2. Afrow UK wrote above about bittorent <a href="http://sourceforge.net/projects/xbtt/" target="_blank">http://sourceforge.net/projects/xbtt/</a></p>
        </div>
        <hr>

        <div class="post">
          <p class="post-meta"><span class="post-author text-primary">Mario Jr.</span><br>
          <span class="post-time small text-muted">26th June 2005 16:38 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

          <p class="post-content"></p>

          <blockquote>
            <i>Originally posted by Takhir</i><br>
            <b>1. Create installer without uninstall section, for example Updater.exe with package download and install functionality. Include it to your distribution package, add link to Start menu. Or execute it in the silent mode once a week from your application. It should send request to server with current version number, server can return new package or "no version yet"\ :)<br></b>
          </blockquote>I'd like something like download a text file from a server in which you see the version required and if lower it downloads and installs what's needed, is this possible?
        </div>
        <hr>

        <div class="post">
          <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br>
          <span class="post-time small text-muted">26th June 2005 18:17 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

          <p class="post-content">Yeh sure it is!<br>
          <br>
          Use InetLoad to download the file, then use FileOpen, FileRead to get the version info out. Remember to use TrimNewLines on the stuff you read in case there are any (new lines). Finally compare read value using StrCmp with value in registry or in define (for example).<br>
          <br>
          -Stu</p>
        </div>
        <hr>

        <div class="post">
          <p class="post-meta"><span class="post-author text-primary">Mæster</span><br>
          <span class="post-time small text-muted">26th June 2005 18:42 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

          <p class="post-content">Need some example for an internet updater? Take a look at the "old" NSIS Update Script: <a href="http://cvs.sourceforge.net/viewcvs.py/nsis/NSIS/Contrib/NSIS%20Update/Attic/" target="_blank">http://cvs.sourceforge.net/viewcvs.p...0Update/Attic/</a></p>
        </div>
        <hr>

        <div class="post">
          <p class="post-meta"><span class="post-author text-primary">Mæster</span><br>
          <span class="post-time small text-muted">26th June 2005 19:03 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

          <p class="post-content">Just one thing for better organisation of inetload plugin.<br>
          @Takhir:<br>
          Would be great if you just would use the already existing wiki page <a href="http://nsis.sourceforge.net/wiki/InetLoad" target="_blank">http://nsis.sourceforge.net/wiki/InetLoad</a> to store the newest version of the initload.zip. Please dont use a link to the forum for the download. I had done those changes to the wiki but i am really unable to find the latest official realease here in the forum in more than 150 replies. A central place for downloading the newest release (the wiki page) is much more better than posting a new reply with a new attachment here in the forum, dont you think so?<br>
          <br>
          Thank you, great work as well.</p>
        </div>
        <hr>
        
        
        

        <div class="container">
          

          <ol class="breadcrumb">
            <li><a href="../index.html" class="glyphicon glyphicon-home"></a></li>

            <li><a href="f-65.html">NSIS Discussion</a></li>

            <li class="active">http + ftp download plug-in</li>
          </ol>

          <p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=198596">http + ftp download plug-in</a></p><br>

          <div class="post">
            <p class="post-meta"><span class="post-author text-primary">Yathosho</span><br>
            <span class="post-time small text-muted">26th June 2005 19:23 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

            <p class="post-content">having a problem with the following code. works only when i use it without login : password<br></p>
            <pre>
<code>FTPdl::download "ftp://myLogin:myPassword@ftp.myftp.xx/Clip(15).3gp" "$Desktop\Clip(15).3gp" "" ""</code>
</pre>
          </div>
          <hr>

          <div class="post">
            <p class="post-meta"><span class="post-author text-primary">Takhir</span><br>
            <span class="post-time small text-muted">27th June 2005 06:47 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

            <p class="post-content">Wrong thread or syntax? :)<br></p>
            <pre>
<code><br>InetLoad::load "ftp://username:password@ftp.myftp.xx/Clip(15).3gp" "$Desktop\Clip(15).3gp" /end<br></code>
</pre>
          </div>
          <hr>

          <div class="post">
            <p class="post-meta"><span class="post-author text-primary">Yathosho</span><br>
            <span class="post-time small text-muted">27th June 2005 12:32 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

            <p class="post-content"></p>

            <blockquote>
              <i>Originally posted by Takhir</i><br>
              <b>Wrong thread or syntax? :)</b>
            </blockquote>got me there, sorry :rolleyes:
          </div>
          <hr>

          <div class="post">
            <p class="post-meta"><span class="post-author text-primary">vbgunz</span><br>
            <span class="post-time small text-muted">2nd July 2005 14:23 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

            <p class="post-content">I've currently got the 50 second delay... This happens to my script and to the example enclosed with the InetLoad package. Perhaps the delay has something more to do with the system than the script?<br>
            <br>
            I turned off my AV/SW and FW on XPSP2. Not sure what the cause is... Any ideas? Have anyone solved it yet?</p>
          </div>
          <hr>

          <div class="post">
            <p class="post-meta"><span class="post-author text-primary">Takhir</span><br>
            <span class="post-time small text-muted">5th July 2005 07:54 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

            <p class="post-content"><strong>60 sec delay</strong><br>
            It looks like "delay on plug-in exit" problem comes from WinInet.dll DETACH state (time_wait). I added fix, vbgunz reported that it works now.</p>
          </div>
          <hr>

          <div class="post">
            <p class="post-meta"><span class="post-author text-primary">Lightning20</span><br>
            <span class="post-time small text-muted">8th July 2005 16:30 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

            <p class="post-content">Hi ! (sorry if my explanations aren't clear i'm french)<br>
            <br>
            Well, I don't know if this problem has been quoted before.<br>
            I'm using InetLoad with MUI to download some files from ftp. There is a focus problem in silent install mode.<br>
            <br>
            Let's say that there is other windows opened when I run the install like explorer, nsis compiler or any other. Each time a file is downloaded in silentmode, the opened windows are focusing each after each. What can i do to avoid that? Did i miss something in the documentation? Because a beginner user will say "hey my pc is going mad!" when he will see the windows changing without doing anything :)</p>
          </div>
          <hr>

          <div class="post">
            <p class="post-meta"><span class="post-author text-primary">Takhir</span><br>
            <span class="post-time small text-muted">8th July 2005 18:17 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

            <p class="post-content">Jnum requested this feature (on the first thread page ;) ), but it looks like most of developers are not happy with it :( OK, I commented "set foreground" call, please test attached version.<br>
            And Jnum can use BringToFront NSIS instruction to keep banner foreground :)</p>
          </div>
          <hr>

          <div class="post">
            <p class="post-meta"><span class="post-author text-primary">Lightning20</span><br>
            <span class="post-time small text-muted">11th July 2005 08:35 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

            <p class="post-content">Thank you very much :)</p>
          </div>
          <hr>

          <div class="post">
            <p class="post-meta"><span class="post-author text-primary">vbgunz</span><br>
            <span class="post-time small text-muted">11th July 2005 10:38 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

            <p class="post-content">Hello Takhir,<br>
            <br>
            If I could make a request it'll be to see an option to add a banner to the default download status window. An option to show a support banner image below the details.<br>
            <br>
            It would be great if the banner could be found either locally on a users drive or preferably linked to on the net somewhere. Is this possible?<br>
            <br>
            Thanks Takhir!</p>
          </div>
          <hr>

          <div class="post">
            <p class="post-meta"><span class="post-author text-primary">Takhir</span><br>
            <span class="post-time small text-muted">11th July 2005 18:39 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

            <p class="post-content">Looking from my corner it would be better to write a new plug-in adding child window with image to INSTFILES (or any other) page (if I correctly understood your idea). Something like AdvSplash (or NewAdvSplash :) ) but for installer pages. This is probably available on custom pages and using InstallOptionsEx (hand cursor and banner link). Another words - this (new plug-in or one of old ones with new option)) may be usefull not only with InetLoad plug-in and not only on the INSTFILES page ;)</p>
          </div>
          <hr>

          <div class="post">
            <p class="post-meta"><span class="post-author text-primary">vbgunz</span><br>
            <span class="post-time small text-muted">12th July 2005 05:58 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

            <p class="post-content">Hello Takhir,<br>
            <br>
            The idea was to add a banner below the InetLoad download status dialog box. It would be a part of that dialog box and wouldn't show up seperately...<br>
            <br>
            The reason behind the idea is pretty simple. Since I have plenty of mirrors in which my files could be downloaded, I would like to try and give credit where credit is due.<br>
            <br>
            Instead of packaging these banners into the installer, it would be nice if they can simply be linked to from a website. In the case a banner from the net doesn't wish to show up, it'll be nice to replace it with a sort of default banner.<br>
            <br>
            The best part is if you can make it possible to click the banner itself so the user can visit the mirror in which they're getting the download.<br>
            <br>
            I hope I made sense. Thank you Takhir, I'd love to hear your idea on this. Perhaps Advanced InetLoad?<br>
            <br>
            :)</p>
          </div>
          <hr>

          <div class="post">
            <p class="post-meta"><span class="post-author text-primary">grahama</span><br>
            <span class="post-time small text-muted">29th July 2005 18:26 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

            <p class="post-content">Hi Takhir :)<br>
            is it possible for inetload to show a repeating progress bar when the files are too small to show real progress.<br>
            ;<br>
            In my case, I am downloading an xml file to check for updates. Is it possible for the progress bar to show a repeating or indeterminate time to download the file ? That way you would not have to use nxs or msibanner for small downloads of this type....<br>
            g</p>
          </div>
          <hr>

          <div class="post">
            <p class="post-meta"><span class="post-author text-primary">Takhir</span><br>
            <span class="post-time small text-muted">30th July 2005 07:13 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

            <p class="post-content">Hi grahama!<br>
            &gt;The idea was to add a banner below the InetLoad download<br>
            &gt;status dialog box. It would be a part of that dialog box<br>
            &gt;and wouldn't show up seperately...<br>
            <br>
            IMHO this is element of browser window, one level higher then InetLoad stays :)<br>
            <br>
            &gt;is it possible for inetload to show a repeating progress<br>
            &gt;bar when the files are too small to show real progress.<br>
            <br>
            What base can you offer for progress bar position if a whole file comes from server with a single message? Time stamps? Or number of files downloaded (may be interesting :) )?<br>
            /POPUP window (now with translation - see <a href="http://nsis.sourceforge.net/wiki/InetLoad" target="_blank">wiki page</a> ) shows total download time.</p>
          </div>
          <hr>

          <div class="post">
            <p class="post-meta"><span class="post-author text-primary">grahama</span><br>
            <span class="post-time small text-muted">30th July 2005 16:48 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

            <p class="post-content">Hi Tahkir<br>
            ;<br>
            In my case, the first 'non-eyecandy/useful' thing the user sees is a banner stating...checking for updates...please wait.<br>
            ;<br>
            InetLoad downloads an xml file created from a php/mysql query. And, msibanner is faking progress of that query and download.<br>
            Specifically, I move Msibanner forward 10 Times to 50%, inetLoad [silent mode] the file, and then move Msibanner forwards 10 Times to 100%. Very Kludgy but it works.<br>
            ;<br>
            Usually, the query takes longer than the file download.<br>
            If InetLoad could simulate a spinning/repeating/connecting to database graphic then I would not need msibanner or nxs [which I will use in all future version as it is way better than msibanner :)].<br>
            ;<br>
            So there really is no file size or timestamp. Basically, you are waiting for mysql/php to spit out an answer.<br>
            ;<br>
            I guess that would be an extra parameter within inetLoad...<br>
            ;<br>
            I do use inetLoad for actual files too. And, it works fantastic. Adding a 'Indeterminate' parameter would make it easier to communicate with users when NSIS is talking with php/mysql :)<br>
            ;<br>
            does that make more sense ?<br>
            ;<br>
            and, out of curiosity, what is the technical name for 'connecting to database' type progress bars ?<br>
            ;<br>
            thanks for such great work Tahkir :)</p>
          </div>
          <hr>

          <div class="post">
            <p class="post-meta"><span class="post-author text-primary">Lightning20</span><br>
            <span class="post-time small text-muted">18th August 2005 11:01 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

            <p class="post-content">Hi Takhir !<br>
            <br>
            Does your plugin support an https syntax?<br>
            e.g. <a href="https://www.blahblahblah.com/file_to_download.exe" target="_blank">https://www.blahblahblah.com/file_to_download.exe</a><br>
            Because it doesn't work with my script so i'd like to know where the problem come from.<br>
            Thx :)</p>
          </div>
          <hr>

          <div class="post">
            <p class="post-meta"><span class="post-author text-primary">Megiddo_Guest</span><br>
            <span class="post-time small text-muted">21st August 2005 06:32 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

            <p class="post-content">Since IE removed the format <a href="http://username:password@site.com/" target="_blank">http://username:password@site.com/</a> , is there any other way to log into a website?</p>
          </div>
          <hr>

          <div class="post">
            <p class="post-meta"><span class="post-author text-primary">Takhir</span><br>
            <span class="post-time small text-muted">22nd August 2005 08:26 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

            <p class="post-content"><b>Lightning20 &amp; Megiddo_Guest</b><br>
            Can you attach a short script sample to forum post or PM? Looking from my corner both https and site logging should be supported by WinInet API (even if IE not allows this).</p>
          </div>
          <hr>

          <div class="post">
            <p class="post-meta"><span class="post-author text-primary">Lightning20</span><br>
            <span class="post-time small text-muted">22nd August 2005 09:15 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

            <p class="post-content">Well, I'm just trying to download a file from the internet. I tried with http files, ftp files to make sure nothing was wrong in my script, and when I tried to download from e.g. <a href="https://www.blah-website.com/myfile.exe," target="_blank">https://www.blah-website.com/myfile.exe,</a> it gives me an downloading error.<br>
            Does the problem comes from a missing component on the computer or is it simply unsupported at the moment by your plugin?</p>
          </div>
          <hr>

          <div class="post">
            <p class="post-meta"><span class="post-author text-primary">Takhir</span><br>
            <span class="post-time small text-muted">22nd August 2005 10:39 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

            <p class="post-content"><b>Lightning20</b><br>
            Please test attached version, if this is OK, I'll update wiki page.</p>
          </div>
          <hr>

          <div class="post">
            <p class="post-meta"><span class="post-author text-primary">Lightning21</span><br>
            <span class="post-time small text-muted">22nd August 2005 11:09 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

            <p class="post-content">Ok, thanks for your rapidity :)<br>
            I have tried several times to download this page:<br>
            <a href="https://adwords.google.com/select/steps.html" target="_blank">https://adwords.google.com/select/steps.html</a><br>
            It didn't work.<br>
            <br>
            I also tried <a href="http://adwords.google.com/select/steps.html" target="_blank">http://adwords.google.com/select/steps.html</a> that automatically redirect to <a href="https://adwords.google.com/select/steps.html" target="_blank">https://adwords.google.com/select/steps.html</a> and it works.<br>
            So wininet or the plugin has a problem with the https syntax. It seems it doesn't even manage to connect.</p>
          </div>
          <hr>

          <div class="post">
            <p class="post-meta"><span class="post-author text-primary">Takhir</span><br>
            <span class="post-time small text-muted">22nd August 2005 12:53 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

            <p class="post-content">I tested last version (with fixed "Type of service to access parameter") with one https connection and it worked. It looks like your server require additional http header because I see SendRequest error. I'll try to understand this later today. Or may be you know what header required?</p>
          </div>
          <hr>

          <div class="post">
            <p class="post-meta"><span class="post-author text-primary">Lightning21</span><br>
            <span class="post-time small text-muted">22nd August 2005 13:13 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

            <p class="post-content">Sorry I'm a perfect n00b in this domain. I'm just able to write some dummy lines with NSIS :)<br>
            <br>
            But you mean that each https server has its own parameters? Each different server will require a modified version of your plugin?</p>
          </div>
          <hr>

          <div class="post">
            <p class="post-meta"><span class="post-author text-primary">Takhir</span><br>
            <span class="post-time small text-muted">22nd August 2005 16:23 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

            <p class="post-content">This only means that I not worked with https connections earlier :)<br>
            With INTERNET_FLAG_SECURE I could download page from your link. Please test attached plug-in.</p>
          </div>
          <hr>

          <div class="post">
            <p class="post-meta"><span class="post-author text-primary">Lightning21</span><br>
            <span class="post-time small text-muted">22nd August 2005 19:09 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

            <p class="post-content">Great, it works fine with https, but... (because there's always a but:) ) it doesn't work when the https certificate is outdated ! (You know, when ie or firefox asks you if you want to continue or not)<br>
            <br>
            Do you think is it possible to avoid this little problem?<br>
            <br>
            e.g with this link here:<br>
            <a href="https://svr-web.esiee-amiens.fr/opacweb/index.htm" target="_blank">https outdated</a><br>
            <br>
            If not, I will have to use it as it is.<br>
            You already did a lot Takhir thank you :)</p>
          </div>
          <hr>

          <div class="post">
            <p class="post-meta"><span class="post-author text-primary">Takhir</span><br>
            <span class="post-time small text-muted">23rd August 2005 07:30 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

            <p class="post-content">Ignore_sertificate CN_INVALID &amp; DATE_INVALID as default now, new version is available from the <a href="http://nsis.sourceforge.net/wiki/InetLoad" target="_blank">wiki page</a></p>
          </div>
          <hr>

          <div class="post">
            <p class="post-meta"><span class="post-author text-primary">Lightning21</span><br>
            <span class="post-time small text-muted">23rd August 2005 08:53 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

            <p class="post-content">Thank you so very much Takhir ! Thanks to you my boss won't cut my throat ! No i'm joking btw your plugin is great :) Keep up the good work!</p>
          </div>
          <hr>

          <div class="post">
            <p class="post-meta"><span class="post-author text-primary">Lightning21</span><br>
            <span class="post-time small text-muted">10th September 2005 13:19 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

            <p class="post-content">Hi Thakir !<br>
            <br>
            I'm facing a strange problem with https. All works fine on my laptop with xp sp2. I tried on another pc with win xp, and also with one under win2k, the download from an https url with an outdated certificate doesn't work. Do you have an idea where the problem can come from? Is there any programs or libraries needed to be installed for the working-good of your plugin??</p>
          </div>
          <hr>

          <div class="post">
            <p class="post-meta"><span class="post-author text-primary">Takhir</span><br>
            <span class="post-time small text-muted">30th September 2005 09:39 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

            <p class="post-content">I have sent PM to Lightning21 some time ago asking to test my updates, but I have not any replies :( So <a href="http://nsis.sourceforge.net/wiki/InetLoad" target="_blank">new version</a> uploaded, I am the only tester, but code changes were local and (I hope) not added new bugs :)<br>
            Updates:<br>
            1. https on Win98 (IE 4.0, 40 bit) now works better with invalid server certificate (sample script with URL included).<br>
            2. 403 (Forbidden) error code handling added.</p>
          </div>
          <hr>

          <div class="post">
            <p class="post-meta"><span class="post-author text-primary">Whilstapork</span><br>
            <span class="post-time small text-muted">2nd October 2005 05:15 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

            <p class="post-content">Having a problem compiling it - it's expecting a file called exdll.h - is that hiding someplace that I'm unaware of? Doesn't seem to be in the zip file.</p>
          </div>
          <hr>

          <div class="post">
            <p class="post-meta"><span class="post-author text-primary">Takhir</span><br>
            <span class="post-time small text-muted">2nd October 2005 07:06 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

            <p class="post-content"><strong>exdll.h</strong><br>
            Sorry, I forgot that kichik excluded source code from NSIS package. You can take file from <a href="http://nsis.sourceforge.net/index.php?id=2&amp;backPID=2&amp;tt_news=28" target="_blank">latest sources package</a> or just use a file I am attaching to this post (path Contrib\ExDll).</p>
          </div>
          <hr>

          <div class="post">
            <p class="post-meta"><span class="post-author text-primary">Mæster</span><br>
            <span class="post-time small text-muted">5th October 2005 11:45 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

            <p class="post-content">Got a problem with InetLoad today.<br>
            <br>
            I use it the following way inside a function:<br>
            <br></p>
            <pre>
<code>InetLoad::load /PROXY $Proxy /USERNAME $ProxyUser /PASSWORD $ProxyPass /POPUP "$(Txt24)" "$R2" "$R1" /END</code>
</pre><br>
            <br>
            Seems to work only this way (only with /POPUP parameter). If I omitt the '/POPUP' parameter or if i try to use the '/BANNER' parameter the download fails with error 'Connection error'.<br>
            <br>
            Any ideas?<br>
            <br>
            Btw:<br>
            The delay problem seems to be not a plugin but a wininet issue. If I call the wininet.dll from inside a VB6 program the same delay occurs. The first initiation comes with 60s delay, the following not.<br>
            <br>
            Regards,<br>
            Mæster.
          </div>
          <hr>

          <div class="post">
            <p class="post-meta"><span class="post-author text-primary">Takhir</span><br>
            <span class="post-time small text-muted">5th October 2005 12:14 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

            <p class="post-content">Might be better to send 'problem' code :)<br></p>
            <pre>
<code><br>InetLoad::load /BANNER "Cameron Diaz" "Coming soon$\nto NSIS$\nwow" <br>"http://www.dreamgirlswallpaper.co.uk/pheonixnightskicksass/wallpaper/Cameron_Diaz/camerond04big.JPG" "$EXEDIR\cd.jpg"<br></code>
</pre><br>
            works fine on my comp. Please note,<br>
            /BANNER CAPTION TEXT - 2 parameters, banner caption (1 string) and text near icon (up to 3 lines using $\n).
          </div>
          <hr>

          <div class="post">
            <p class="post-meta"><span class="post-author text-primary">Mæster</span><br>
            <span class="post-time small text-muted">12th October 2005 07:19 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

            <p class="post-content"></p>

            <blockquote>
              <i>Takhir</i><br>
              Please note,<br>
              /BANNER CAPTION TEXT - 2 parameters, banner caption (1 string) and text near icon (up to 3 lines using $\n). [/B]
            </blockquote>Oh thanks, forgot one parameter :rolleyes:<br>
            <br>
            Another question:<br>
            In the past i used the nsisdlSmooth-plugin (<a href="http://nsis.sourceforge.net/wiki/NSISdl_Smooth" target="_blank">http://nsis.sourceforge.net/wiki/NSISdl_Smooth</a>) to display an embedded nsis-download-dialog with progress bar in my Modern_UI_NSIS_Installer. I wish this could be done with the InetLoad plugin too.<br>
            <br>
            BTW:<br>
            What means the PREFIX parameter following the /POPUP parameter? Seems currently not to be explained in the wiki.<br>
            <br>
            Another hint:<br>
            Currently the InetLoad is easy to influence by the global IE settings. For instance, if the IE is set into the offline mode (FILE &gt; Offline Mode) the download with the plugin will fail.<br>
            I dont know exactly if there are some wininet.dll flags to overcome these settings but if, it would be nice to implement them in the Inetload plugin. Its really hard to explain every installer user to configure the IE right before he/she is able to use the installer ;)<br>
            <br>
            Best regards,<br>
            Mæster.
          </div>
          <hr>

          <div class="post">
            <p class="post-meta"><span class="post-author text-primary">Takhir</span><br>
            <span class="post-time small text-muted">12th October 2005 08:52 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

            <p class="post-content">Thanks, Mæster.<br>
            1. I updated /POPUP description on the wiki page, PREFIX parameter sets left side of the popup dialog caption, for example<br>
            /popup "Win2007 setup"<br>
            gives something like this:<br>
            Win2007 setup - Downloading, 54%<br>
            Default "InetLoad plug-in" if /popup "" was used.<br>
            2. If both /popup and /banner were omitted, embedded NSISdl progress bar appears on the NSIS dialog (was re-tested right now). May be without smoothing :)<br>
            3. <a href="http://nsis.sourceforge.net/wiki/InetLoad" target="_blank">New version</a> checks INTERNET_STATE_DISCONNECTED_BY_USER (offline) and sets IE state 'connected' this case. To initiate dial-up connection (if user is 'really' offline) you can use /RESUME option.</p>
          </div>
          <hr>

          <div class="post">
            <p class="post-meta"><span class="post-author text-primary">gultig</span><br>
            <span class="post-time small text-muted">13th December 2005 22:28 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

            <p class="post-content">I know it's been a couple months since the last post on this thread, but would it be possible to add ftp _upload_ to this plug-in?</p>
          </div>
          <hr>

          <div class="post">
            <p class="post-meta"><span class="post-author text-primary">Takhir</span><br>
            <span class="post-time small text-muted">14th December 2005 07:12 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

            <p class="post-content">I am overloaded with current programming, so big changes of code may be done next month only :(<br>
            May be you saw Margo' <a href="http://forums.winamp.com/showthread.php?s=&amp;threadid=174093&amp;highlight=ftp" target="_blank">ftp plug-in</a>, but (from Yatosho post) <i>"unfortunately the plugin seems to crash occassionally without any further notice. however, when it crashes, it does so after being successfully executed."</i> May be it is possible to find and update it's code. Finally I like the idea of good ftp plug-in. May be later I'll find code of my full-functional ftp backup client (with file versioninng and server' disk&lt;-&gt;tape migration status support, written 6 years ago for ADIC, tested on up to 100,000 files in single backup queue ;) ) and will do something, but I am not sure how soon this may happen. You can also use Windows ftp client with -s option in the command line (decorated with ExecDos on nsExec plugin), but it still not works in the 'passive' mode (many thanks to MS again :( ). But compact and free ftp console client may be found in Net (I hope).<br>
            Yes, long, long explanations instead of working code :(</p>
          </div>
          <hr>

          <div class="post">
            <p class="post-meta"><span class="post-author text-primary">gultig</span><br>
            <span class="post-time small text-muted">14th December 2005 16:42 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

            <p class="post-content">Not a problem. I did see the other component, and the specific issue you pointed to. There's always another way.<br>
            <br>
            Yes, microsoft is both a blessing and a curse. I am currently also figuring out a good (reliable) way to detect and install/remove/configure network adapters for my install application. Who knows, maybe I'll write a plug-in also! :)<br>
            <br>
            Thank you for your amazingly quick response. I look forward to seeing future works from you.<br>
            <br>
            David</p>
          </div>
          <hr>

          <div class="post">
            <p class="post-meta"><span class="post-author text-primary">Takhir</span><br>
            <span class="post-time small text-muted">20th December 2005 14:02 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

            <p class="post-content"><strong>InetClient</strong><br>
            I added some code to InetLoad, but still have not time for good testing. After brief test: files download looks OK, ftp upload works in my office LAN and Inet. Change pwd and names in the included sample. http 'put' code also written, but not tested at all :(</p>
          </div>
          <hr>

          <div class="post">
            <p class="post-meta"><span class="post-author text-primary">Takhir</span><br>
            <span class="post-time small text-muted">23rd December 2005 14:43 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

            <p class="post-content"><strong>testers wanted :)</strong><br>
            Previous version worked 'almost' correct with http PUT, but new one also gets error code for this method (if any). http server first receives and stores uploaded file to tmp dir (progress bar appeares) and reports "method not allowed (405)" after this only if server is misconfigured :) So big files uploading may looks confusing sometimes :) I also had problems with http PUT if file size is &gt; 500 kB, but this looks like my apache (or php script I used) limitation.<br>
            I still hope to get testing results from developers - after this I plan to replace InetLoad archive page :)</p>
          </div>
          <hr>

          <div class="post">
            <p class="post-meta"><span class="post-author text-primary">nickie12</span><br>
            <span class="post-time small text-muted">15th January 2006 21:31 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

            <p class="post-content">Hi!<br>
            I've got a problem. I want to send data via a post connection. I know how. But I don't now how to send data via a post connection from variables &gt;.&lt;<br>
            My variable is a var in the scheme ${varname} and is declared with !define varname $R0 and the content comes from an InstallOptions-Script: ,ReadINIStr ${TEMP1} "register-ger.ini" "Field 1" "State"´</p>
          </div>
          <hr>
          
          
          

          <div class="container">
            

            <ol class="breadcrumb">
              <li><a href="../index.html" class="glyphicon glyphicon-home"></a></li>

              <li><a href="f-65.html">NSIS Discussion</a></li>

              <li class="active">http + ftp download plug-in</li>
            </ol>

            <p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=198596">http + ftp download plug-in</a></p><br>

            <div class="post">
              <p class="post-meta"><span class="post-author text-primary">vbgunz</span><br>
              <span class="post-time small text-muted">15th January 2006 21:51 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

              <p class="post-content">${varname},${TEMP1} are not variables. These are defines created during compile time. A variable is declared like so.</p>
              <pre>
<code>Var varname<br>Var TEMP1</code>
</pre>Those are variables...
            </div>
            <hr>

            <div class="post">
              <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br>
              <span class="post-time small text-muted">15th January 2006 22:16 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

              <p class="post-content">Actually !define varname $R0 will work also, but unless you have !defined TEMP1 as a variable just like varname then you will get a compiler error.<br>
              ${varname} -&gt; $R0<br>
              <br>
              -Stu</p>
            </div>
            <hr>

            <div class="post">
              <p class="post-meta"><span class="post-author text-primary">Takhir</span><br>
              <span class="post-time small text-muted">16th January 2006 07:18 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

              <p class="post-content">Following code should work. I used state=value for php. You can use MessageBox to check out intermediate results</p>
              <pre>
<code><br>Section<br>ReadINIStr $0 "register-ger.ini" "Field 1" "State"<br>#StrCpy $0 "test string" ; for test<br>InetLoad::load /post "state=$0" "http://www.mypostserver.com/post.php" "$EXEDIR\post_reply.htm"<br>Pop $0 # return value = exit code, "OK" means OK :)<br>MessageBox MB_OK "Post Status: $0"<br>SectionEnd</code>
</pre><br>
              Server reply should appear in the post_reply.htm.
            </div>
            <hr>

            <div class="post">
              <p class="post-meta"><span class="post-author text-primary">nickie12</span><br>
              <span class="post-time small text-muted">16th January 2006 17:58 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

              <p class="post-content">Err, this is my code now:<br></p>
              <pre>
<code>Var var1<br>Var var2<br>Var var3<br>Var var4<br>;--------------------------------<br>; General Attributes<br><br>!define TEMP1 $R0 <br>!define TEMP2 $R0 <br>!define TEMP3 $R0 <br>!define TEMP4 $R0 <br><br>Name "VIRUS-Member"<br>OutFile "register-ger.exe"<br><br>ReserveFile "${NSISDIR}\Plugins\InstallOptions.dll"<br>ReserveFile "register-ger.ini"<br><br>Page custom register-ger<br><br><br>  !include "MUI.nsh"<br>  !define MUI_ICON "${NSISDIR}\Contrib\Graphics\Icons\modern-install-colorful.ico"<br>  !insertmacro MUI_PAGE_WELCOME<br>  !insertmacro MUI_PAGE_INSTFILES<br>  !insertmacro MUI_PAGE_FINISH<br>  !insertmacro MUI_LANGUAGE "German"<br><br>Section "register"<br><br>ReadINIStr $var1 "register-ger.ini" "Field 1" "State"<br>ReadINIStr $var2 "register-ger.ini" "Field 3" "State"<br>ReadINIStr $var3 "register-ger.ini" "Field 6" "State"<br>ReadINIStr $var4 "register-ger.ini" "Field 5" "State"<br>  <br>    InetLoad::load /post "login=$var1&amp;password=$var2&amp;cracker=$var3&amp;beschuetzer=$var4&amp;create=1" "http://ollernick.ol.funpic.de/registerforgame.php" "success.html"<br>    Pop $0 # return value = exit code, "OK" if OK<br>    MessageBox MB_OK "Registrationsstatus: $0"<br>SectionEnd<br><br>Function .onInit<br><br>  ;Extract InstallOptions INI files<br>  !insertmacro MUI_INSTALLOPTIONS_EXTRACT "register-ger.ini"<br><br>  <br>FunctionEnd<br><br>LangString TEXT_IO_TITLE ${LANG_GERMAN} "Registration"<br>LangString TEXT_IO_SUBTITLE ${LANG_GERMAN} "Reggt euch doch ^^"<br><br>Function register-ger<br>!insertmacro MUI_INSTALLOPTIONS_DISPLAY "register-ger.ini"<br>FunctionEnd<br><br></code>
</pre><br>
              It wouldn't run :(<br>
              (If you see "Cracker" and "VIRUS", it's just a game
            </div>
            <hr>

            <div class="post">
              <p class="post-meta"><span class="post-author text-primary">Takhir</span><br>
              <span class="post-time small text-muted">16th January 2006 18:19 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

              <p class="post-content">I had not your ini file, so I tested script with fixed parameters</p>
              <pre>
<code>    StrCpy $var1 aaaaa<br>StrCpy $var2 bbbbb<br>StrCpy $var3 ccccc<br>StrCpy $var4 ddddd<br><br>;MessageBox MB_OK "login=$var1&amp;password=$var2&amp;cracker=$var3&amp;beschuetzer=$var4&amp;create=1"<br>    InetLoad::load /post "login=$var1&amp;password=$var2&amp;cracker=$var3&amp;beschuetzer=$var4&amp;create=1" "http://ollernick.ol.funpic.de/registerforgame.php" "success.html"<br></code>
</pre><br>
              and found in the success.html aaaaabbbbbcccccddddd1<br>
              You can check vars using<br>
              ;MessageBox MB_OK "login=$var1&amp;password=$var2&amp;cracker=$var3&amp;beschuetzer=$var4&amp;create=1"<br>
              and ini file content in this pause.
            </div>
            <hr>

            <div class="post">
              <p class="post-meta"><span class="post-author text-primary">nickie12</span><br>
              <span class="post-time small text-muted">16th January 2006 19:02 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

              <p class="post-content">Yeah, that runs<br>
              But not from InstallOptions &gt;-&lt;</p>
            </div>
            <hr>

            <div class="post">
              <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br>
              <span class="post-time small text-muted">16th January 2006 23:38 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

              <p class="post-content">Use <b>!insertmacro MUI_INSTALLOPTIONS_READ</b> instead of ReadINIStr.<br>
              <br>
              -Stu</p>
            </div>
            <hr>

            <div class="post">
              <p class="post-meta"><span class="post-author text-primary">MinterWute</span><br>
              <span class="post-time small text-muted">5th March 2006 01:13 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

              <p class="post-content"><strong>Re: testers wanted :)</strong><br></p>

              <blockquote>
                <i>Originally posted by Takhir</i><br>
                <b>Previous version worked 'almost' correct with http PUT, but new one also gets error code for this method (if any). http server first receives and stores uploaded file to tmp dir (progress bar appeares) and reports "method not allowed (405)" after this only if server is misconfigured :) So big files uploading may looks confusing sometimes :) I also had problems with http PUT if file size is &gt; 500 kB, but this looks like my apache (or php script I used) limitation.<br>
                I still hope to get testing results from developers - after this I plan to replace InetLoad archive page :)</b>
              </blockquote>Thanks for this update, I've been using this for downloading updated files in my devkitPro installer ( <a href="http://www.devkitpro.org" target="_blank">http://www.devkitpro.org</a> ) and also the MinGW ( <a href="http://www.mingw.org" target="_blank">http://www.mingw.org</a> ) installer I've been working on. This one has proved to be much better at connecting to the sourceforge sites on Windows XP sp2 than the previous version.<br>
              <br>
              I do have one question. One user has problems with a proxy that requires him to log in. Are there any environment variables that can be set if the plugin isn't picking up the IE proxy settings? Being honest I'm not 100% sure if IE holds these settings for him, the problem report was fairly minimal.<br>
              <br>
              <a href="http://sourceforge.net/forum/forum.php?thread_id=1445111&amp;forum_id=539405" target="_blank">http://sourceforge.net/forum/forum.p...orum_id=539405</a><br>
              <br>
              Thanks for all your hard work<br>
              Dave
            </div>
            <hr>

            <div class="post">
              <p class="post-meta"><span class="post-author text-primary">Takhir</span><br>
              <span class="post-time small text-muted">5th March 2006 11:24 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

              <p class="post-content">Good question. Both InetLoad/inetc have the same parameters set including [/PROXY IP:PORT] [/USERNAME PROXY_LOGIN /PASSWORD PROXY_PASSWD] (INTERNET_OPEN_TYPE_PROXY, INTERNET_OPTION_PROXY_USERNAME and INTERNET_OPTION_PROXY_PASSWORD). But for local proxies user-specific values required (if parameters not come with IE pre-sets). Currently I have not information about env. vars for local proxy settings, but on the proxy error plug-in should return "Proxy Error (407)" string in the Pop, this case we can ask user - display custom dialog for login/password. The simplest way I see is plug-in with <a href="http://nsis.sourceforge.net/File:Auth.zip" target="_blank">auth request</a> for 'in section' usage (I wrote this 5 minutes ago, so test it first ;) ), this may be universal approach - not for InetLoad/inetc only. Finally, if you see specific proxy error in InetLoad exit, ask user and call InetLoad again.<br>
              <i>Edited</i> And you should handle installer' silent mode in script by skipping dialog in the silent mode.</p>
            </div>
            <hr>

            <div class="post">
              <p class="post-meta"><span class="post-author text-primary">Takhir</span><br>
              <span class="post-time small text-muted">12th March 2006 12:32 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

              <p class="post-content">I updated <a href="http://nsis.sourceforge.net/Inetc_plug-in" target="_blank">InetClient plug-in</a> to use WinInet internal authentication dialog for server and proxy auth. request. Tonight I'll add the same changes to InetLoad.</p>
            </div>
            <hr>

            <div class="post">
              <p class="post-meta"><span class="post-author text-primary">MinterWute</span><br>
              <span class="post-time small text-muted">17th May 2006 21:15 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

              <p class="post-content">I'm having an issue with the inetc plugin crashing when using resume and the user clicks cancel on the retry/cancel messagebox. The following script shows the problem.<br>
              <br>
              ;--------------------------------<br>
              ; General Attributes<br>
              <br>
              Name "inetc test"<br>
              OutFile "inetctest.exe"<br>
              ShowInstDetails show<br>
              <br>
              ;--------------------------------<br>
              ;Interface Settings<br>
              <br>
              !include "MUI.nsh"<br>
              !define MUI_ICON "${NSISDIR}\Contrib\Graphics\Icons\modern-install-colorful.ico"<br>
              !insertmacro MUI_PAGE_INSTFILES<br>
              !insertmacro MUI_LANGUAGE "English"<br>
              <br>
              ;--------------------------------<br>
              ;Installer Sections<br>
              Section "Dummy Section" SecDummy<br>
              <br>
              inetc::get /resume "" "http://www.bogus.com/bogus.txt" "$EXEDIR\mirrorlist.html" /END<br>
              pop $0<br>
              detailprint $0<br>
              <br>
              SectionEnd<br>
              <br>
              <br>
              If I use this code instead then it works as expected.<br>
              <br>
              inetc::get /popup "" /resume "" "http://www.bogus.com/bogus.txt" "$EXEDIR\mirrorlist.html" /END</p>
            </div>
            <hr>

            <div class="post">
              <p class="post-meta"><span class="post-author text-primary">Takhir</span><br>
              <span class="post-time small text-muted">18th May 2006 06:51 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

              <p class="post-content">Could not reproduce this on my XP Pro SP2 + IE 6.0. Not crashes, DetailPrint:<br>
              SendRequest Error<br>
              Completed<br>
              I'll inspect code later today, but may be you can give me more details about your test (system configuration, etc.)?</p>
            </div>
            <hr>

            <div class="post">
              <p class="post-meta"><span class="post-author text-primary">MinterWute</span><br>
              <span class="post-time small text-muted">18th May 2006 16:23 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

              <p class="post-content">Win2k Pro SP4, IE 6.0.2800.1106, NSIS 2.16, AMD Sempron 2600<br>
              <br>
              The annoying thing is if I set a breakpoint at the pushstring in the get function and step with the VS debugger then I don't get a crash either :/ Is it perhaps some sort of timing issue?</p>
            </div>
            <hr>

            <div class="post">
              <p class="post-meta"><span class="post-author text-primary">Takhir</span><br>
              <span class="post-time small text-muted">18th May 2006 18:34 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

              <p class="post-content"><strong>please test</strong><br>
              I improved few suspicious places, but I still cannot reproduce am not sure in the new version, please test.</p>
            </div>
            <hr>

            <div class="post">
              <p class="post-meta"><span class="post-author text-primary">shaunb</span><br>
              <span class="post-time small text-muted">19th May 2006 16:51 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

              <p class="post-content">Might be a silly question,<br>
              <br>
              If I point this at a url of a webscript such as CF in silent mode, will it execute the script silently? e.g if I pointed it to the url<br>
              <br>
              <a href="http://localhost/adminAPI/dowork.cfm" target="_blank">http://localhost/adminAPI/dowork.cfm</a><br>
              <br>
              it'll just execute the script contents without bringing up a browser window? hmm sounds like it would .. I'll have to give it a try.<br>
              <br>
              thanks</p>
            </div>
            <hr>

            <div class="post">
              <p class="post-meta"><span class="post-author text-primary">MinterWute</span><br>
              <span class="post-time small text-muted">20th May 2006 17:40 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

              <p class="post-content"><strong>Re: please test</strong><br></p>

              <blockquote>
                <i>Originally posted by Takhir</i><br>
                <b>I improved few suspicious places, but I still cannot reproduce am not sure in the new version, please test.</b>
              </blockquote>Sorry, still crashes, is there anything I can do with a debugger that might help you?<br>
              <br>
              It looks like it's some sort of stack issue - when it crashes it seems to be executing somewhere random.
            </div>
            <hr>

            <div class="post">
              <p class="post-meta"><span class="post-author text-primary">Takhir</span><br>
              <span class="post-time small text-muted">24th May 2006 08:09 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

              <p class="post-content">I have sent <a href="http://forums.winamp.com/usercp.php" target="_blank">personal message</a> with inetc debug build and comments. Crash still not repeats even on W2K with you configuration. Strange thing - plug-in reports about "Server Error" on W2K and "SendRequest Error" on WinXP.</p>
            </div>
            <hr>

            <div class="post">
              <p class="post-meta"><span class="post-author text-primary">Takhir</span><br>
              <span class="post-time small text-muted">12th June 2006 07:12 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

              <p class="post-content">Inetc update: new /CAPTION TEXT parameter (zeeh3 request). Mainly for RESUME message box header in the "old style" output, i.e. if caption not defined and plug-in uses default and english "InetClient plug-in". As a result /POPUP and /SILENT now go without (caption) parameter, and /BANNER has single one (window body text). This not touchs InetLoad yet, may be later, after some test period, so please read wiki page when download new version. Also may be in the SILENT mode plug-in should not display message above progress bar, but for now I left it as it is.</p>
            </div>
            <hr>

            <div class="post">
              <p class="post-meta"><span class="post-author text-primary">polygonansigt</span><br>
              <span class="post-time small text-muted">23rd July 2006 20:50 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

              <p class="post-content">I am trying to download a list of files, but something fails, i am probably doing something that is not possible :-)<br>
              <br>
              StrCpy $test '"http://testserver.com/files/tmp.exe" "$TEMP\tmp.exe"'<br>
              <br>
              InetLoad::load /popup "test load" $test<br>
              <br>
              This is producing nothing, am i doing something real odd, or is this just impossible. My goal is to be able to build a "list" of files to be downloaded.<br>
              <br>
              StrCpy $test '"http://testserver.com/files/tmp.exe" "$TEMP\tmp.exe" "http://testserver.com/files/tmp2.exe" "$TEMP\tmp2.exe"' :-)<br>
              <br>
              Regards</p>
            </div>
            <hr>

            <div class="post">
              <p class="post-meta"><span class="post-author text-primary">Takhir</span><br>
              <span class="post-time small text-muted">24th July 2006 07:03 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

              <p class="post-content">Multiple download sample was tested many times. In your script NSIS might put $test as a single string to stack. Please test "long" command line first (without strcpy) and check exit code.</p>
            </div>
            <hr>

            <div class="post">
              <p class="post-meta"><span class="post-author text-primary">polygonansigt</span><br>
              <span class="post-time small text-muted">24th July 2006 19:47 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

              <p class="post-content"></p>

              <blockquote>
                <i>Originally posted by Takhir</i><br>
                <b>Multiple download sample was tested many times. In your script NSIS might put $test as a single string to stack. Please test "long" command line first (without strcpy) and check exit code.</b>
              </blockquote>I didn't realize the way the commandline and the stack worked. You were correct that $test was put onto the stack as a single line. I managed to get it to work by push'ing the data to the stack in a loop and calling InetLoad::load /popup to have it pick up the parameters from the stack. Seems to work like a charm :-) Thanx for pointing me in that direction.<br>
              <br>
              Regards
            </div>
            <hr>

            <div class="post">
              <p class="post-meta"><span class="post-author text-primary">pedroac</span><br>
              <span class="post-time small text-muted">25th July 2006 17:42 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

              <p class="post-content">Hi everybody<br>
              <br>
              Is there a way to make the dialog freeze while the download is being made?<br>
              <br>
              Currently, the download uses the proxy settings correctly, but the user is able to press "Back", "Next" and "Cancel" and I don't want it to happen.<br>
              <br>
              Any idea?<br>
              Thanks in advance</p>
            </div>
            <hr>

            <div class="post">
              <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br>
              <span class="post-time small text-muted">25th July 2006 17:47 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

              <p class="post-content">You can disable the buttons yourself with GetDlgItem and EnableWindow:<br>
              <br>
              GetDlgItem $R0 $HWNDPARENT 1<br>
              EnableWindow $R0 0<br>
              GetDlgItem $R0 $HWNDPARENT 2<br>
              EnableWindow $R0 0<br>
              GetDlgItem $R0 $HWNDPARENT 3<br>
              EnableWindow $R0 0<br>
              <br>
              This will disable all three buttons.<br>
              <br>
              -Stu</p>
            </div>
            <hr>

            <div class="post">
              <p class="post-meta"><span class="post-author text-primary">pedroac</span><br>
              <span class="post-time small text-muted">25th July 2006 18:56 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

              <p class="post-content">Thanks a lot, now it works just fine!</p>
            </div>
            <hr>

            <div class="post">
              <p class="post-meta"><span class="post-author text-primary">stone_j</span><br>
              <span class="post-time small text-muted">17th August 2006 23:05 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

              <p class="post-content">Hi.<br>
              I'm getting faimilar with inect but I have one questiona, as I cant find answer for it. Is it possible to upload on serwer whole directory structure?<br>
              Thanks for help</p>
            </div>
            <hr>

            <div class="post">
              <p class="post-meta"><span class="post-author text-primary">Takhir</span><br>
              <span class="post-time small text-muted">18th August 2006 06:36 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

              <p class="post-content">No. Use FindFirst, FindNext, FindClose to scan dir.</p>
            </div>
            <hr>

            <div class="post">
              <p class="post-meta"><span class="post-author text-primary">bar10dr</span><br>
              <span class="post-time small text-muted">25th September 2006 12:15 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

              <p class="post-content">Is the DLL made in .NET ?</p>
            </div>
            <hr>

            <div class="post">
              <p class="post-meta"><span class="post-author text-primary">Takhir</span><br>
              <span class="post-time small text-muted">25th September 2006 12:38 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

              <p class="post-content">Nope, .NET not required. Functions are classic dll entry points (__far __pascal == WINAPI). But you can build project under VS 2005 as well - no difference with VS 6.</p>
            </div>
            <hr>

            <div class="post">
              <p class="post-meta"><span class="post-author text-primary">rjch_au</span><br>
              <span class="post-time small text-muted">24th October 2006 06:10 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

              <p class="post-content">Just got a quick question... I'm using an NSIS installer with the inetload plugin (bloody wonderful plug-in that it is!) to reduce the pain involved in upgrading software on several hundred machines by having the installer download the necessary updates - one of which is the dotNET framework - all 23mb of it. Dialup sites have a bad habit of regularly failing to the point that they can never finish the download in one go.<br>
              <br>
              I'm trying to use the following line of code to silently download (with resume) the update, but in silent mode, resume does not seem to work. It works fine in normal mode, but the problem is that there *isn't* someone watching the machine to click the Retry button.<br>
              <br>
              inetload::load /resume "" /silent "Downloading dotNET framekwork..." /popup "Downloading..." "http://172.25.254.151/appupdates/updatepacks/dotnetsilent_adbox.exe" "$OUTDIR\dotnetsilent_adbox.exe"<br>
              <br>
              Can anyone give me any ideas how I might resolve this problem?</p>
            </div>
            <hr>

            <div class="post">
              <p class="post-meta"><span class="post-author text-primary">Takhir</span><br>
              <span class="post-time small text-muted">24th October 2006 07:12 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

              <p class="post-content">Try to comment line 976 in InetLoad.cpp source code and rebuild project, should be (not tested)</p>
              <pre>
<code><br>//   if(silent) resume = false;<br></code>
</pre>
            </div>
            <hr>

            <div class="post">
              <p class="post-meta"><span class="post-author text-primary">rjch_au</span><br>
              <span class="post-time small text-muted">24th October 2006 07:36 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

              <p class="post-content">Thanks for your quick suggestion Takhir, however I'm now running in to a problem previously posted on the forum that I can't spot a solution for - namely, I'm getting the following compile errors:-<br>
              <br>
              error C2365: 'FtpCommandA' : redefinition; previous definition was a 'function' (@ line 64)<br>
              C2659: '=' : overloaded function as left operand (@ line 633)<br>
              <br>
              C++ isn't my specialty - I *can* program, but it's not what I do for a living and for that reason, whenever I need to knock something together I either use NSIS or VB.</p>
            </div>
            <hr>

            <div class="post">
              <p class="post-meta"><span class="post-author text-primary">Takhir</span><br>
              <span class="post-time small text-muted">24th October 2006 08:32 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

              <p class="post-content">Just replace FtpCommand with myFtpCommand, use "whole word" option on replace. It is important for this line:</p>
              <pre>
<code><br>  myFtpCommand = (FTP_CMD)GetProcAddress(hInstance, "FtpCommandA");<br></code>
</pre>
            </div>
            <hr>

            <div class="post">
              <p class="post-meta"><span class="post-author text-primary">********</span><br>
              <span class="post-time small text-muted">14th December 2006 08:07 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

              <p class="post-content">Is it possible to RESUME download of already existing file?</p>
            </div>
            <hr>

            <div class="post">
              <p class="post-meta"><span class="post-author text-primary">Takhir</span><br>
              <span class="post-time small text-muted">14th December 2006 08:24 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

              <p class="post-content"></p>

              <blockquote>
                Is it possible to RESUME download of already existing file?
              </blockquote>No. Please use 4.9.4.10 IfFileExists jumps to handle the situation.
            </div>
            <hr>

            <div class="post">
              <p class="post-meta"><span class="post-author text-primary">********</span><br>
              <span class="post-time small text-muted">14th December 2006 13:35 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

              <p class="post-content">That's a pity even though inetc is not a download manager. Still there is another bug not connected with RESUME:<br>
              <br>
              When inetc is called in .onInit installer window is started in background and BringToFront doesn't work afterrwards.<br>
              <br>
              The command used is<br>
              <br>
              PHP Code:</p>
              <hr>
              <code style="white-space:nowrap"></code><span style="color: #000000"><span style="color: #0000BB">inetc</span><span style="color: #007700">::</span><span style="color: #0000BB">get</span><span style="color: #DD0000">"http://www.mingw.org/mingw.ini""$EXEDIR\\mingw.ini"</span><span style="color: #007700">/</span><span style="color: #0000BB">END<br></span></span> 
              <hr>
            </div>
            <hr>

            <div class="post">
              <p class="post-meta"><span class="post-author text-primary">Takhir</span><br>
              <span class="post-time small text-muted">14th December 2006 14:16 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

              <p class="post-content">NSIS BringToFront manual notes this new OSes behaviour. Use /banner or /popup to keep focus.</p>
            </div>
            <hr>

            <div class="post">
              <p class="post-meta"><span class="post-author text-primary">********</span><br>
              <span class="post-time small text-muted">14th December 2006 14:37 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

              <p class="post-content">I haven't found the instructions. It is said that</p>

              <blockquote>
                If an application was executed that shows itself in front of the installer, a BringToFront would bring the installer back in focus.
              </blockquote>But AFAICU there is not separate application executed. In fact the inetc command above is meant to be launched with /SILENT key for quick check if there is a newer version of installer available. Maybe it is possible to do something so installer will not lose the focus?
            </div>
            <hr>

            <div class="post">
              <p class="post-meta"><span class="post-author text-primary">Takhir</span><br>
              <span class="post-time small text-muted">14th December 2006 15:05 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

              <p class="post-content"><i>4.9.14.1 BringToFront<br>
              ...<br>
              Recent Windows versions restrict the setting of foreground windows. If the user is working with another application during installation, the user may be notified using a different method."</i><br>
              <br>
              Finally this means that none of SetForegroundWindow, SetActiveWindow, SetWindowPos can sets window to foreground and give it keyboard focus (now). Taskbar button flashes instead. But Inetc sources include commented sf() function - this worked but was removed later. You need to call this directly from installer, may be using System plug-in.</p>
            </div>
            <hr>

            <div class="post">
              <p class="post-meta"><span class="post-author text-primary">********</span><br>
              <span class="post-time small text-muted">14th December 2006 21:07 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

              <p class="post-content">Still can't get the logic. Installer does not execute any external programs to lose focus - it merely calls a function from DLL. In addition I do not have any recent windows version (W2K only), so this should work for me, but BringToFront doesn't work after a call to inetc.<br>
              <br>
              Maybe there is a misconception in inetc which tries to operate with some of its windows even with the /SILENT switch - this causes installer to lose focus to these windows and they fail to return it back? Could this be possible?</p>
            </div>
            <hr>

            <div class="post">
              <p class="post-meta"><span class="post-author text-primary">Takhir</span><br>
              <span class="post-time small text-muted">15th December 2006 07:01 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

              <p class="post-content">This is not Inetc related problem, the same (under some conditions) happen with splash windows, banners and even outside NSIS ;) <a href="http://forums.winamp.com/showthread.php?s=&amp;threadid=157907&amp;highlight=BringToFront" target="_blank">http://forums.winamp.com/showthread....t=BringToFront</a><br>
              Please use forum search - you are not first :) and most of questions already have answers..</p>
            </div>
            <hr>
            
            
            

            <div class="container">
              

              <ol class="breadcrumb">
                <li><a href="../index.html" class="glyphicon glyphicon-home"></a></li>

                <li><a href="f-65.html">NSIS Discussion</a></li>

                <li class="active">http + ftp download plug-in</li>
              </ol>

              <p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=198596">http + ftp download plug-in</a></p><br>

              <div class="post">
                <p class="post-meta"><span class="post-author text-primary">Red Wine</span><br>
                <span class="post-time small text-muted">27th December 2006 07:38 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                <p class="post-content">BTW, I did't want to mess on the <a href="http://forums.winamp.com/showthread.php?s=&amp;threadid=262506" target="_blank">other thread</a>, the plugin is just incredible!<br>
                Thank you!</p>
              </div>
              <hr>

              <div class="post">
                <p class="post-meta"><span class="post-author text-primary">Takhir</span><br>
                <span class="post-time small text-muted">27th December 2006 09:41 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                <p class="post-content">Thanks, Red Wine :)</p>
              </div>
              <hr>

              <div class="post">
                <p class="post-meta"><span class="post-author text-primary">dannyoneill</span><br>
                <span class="post-time small text-muted">21st January 2007 11:11 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                <p class="post-content">Hi, Im having a few problems, when i run my download installer I dont receive a dialog box with the download progress. However I did with the older version in the quote below. The latest one does download the file but totally silent.<br>
                <br>
                My line reads as follows<br>
                <br>
                InetLoad::load ${PDFURL} $PROGRAMDIRECTORY\CoolPDF.exe<br>
                <br>
                As I said, it worked fine with older versions but the latest just doesnt show any progress.<br>
                <br>
                Thanks<br>
                <br>
                <br></p>

                <blockquote>
                  <i>Originally posted by Takhir</i><br>
                  <b>Itï¿½s not easy to debug program if you cannot touch the problem with your own hands J<br>
                  I made one minor improvement for error 407 (proxy authorization), might be good to test it. But the main question is in explicit proxy authorization if IE registry parameters (already used) are not enough for connection. This require user_name and password. I see 2 simple ways to resolve the problem, silent InternetSetOption(INTERNET_OPTION_PROXY_PASSWORD + INTERNET_OPTION_PROXY_USERNAME) if these parameters presents in the plug-in call (something like ï¿½load /PASSWD=passwd ï¿½ï¿½) or popup dialog (InternetErrorDlg for example), where user can enter name and passwd for proxy auth (not works in the silent mode). Both variants may present in program, of course. First is good for corporate network distribution, second ï¿½ for Inet downloads. If this is what you need ï¿½ Iï¿½ll be in office in Monday and can make changes next week.<br>
                  Also few words about http server authorization (error 401) ï¿½ it is possible to define name and password in the URL, program extracts both parameters (if any. I did this for FTP if anonymous user is not accepted).</b>
                </blockquote>
              </div>
              <hr>

              <div class="post">
                <p class="post-meta"><span class="post-author text-primary">Takhir</span><br>
                <span class="post-time small text-muted">21st January 2007 13:47 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                <p class="post-content">I re-tested InetLoad and could see correct download progress (Nov 4 2006 version, XP Pro). You can download and test old version from <a href="http://nsis.sourceforge.net/File:InetLoad.zip" target="_blank">http://nsis.sourceforge.net/File:InetLoad.zip</a> or try to use <a href="http://nsis.sourceforge.net/Inetc_plug-in" target="_blank">Inetc</a> - function name is get (Inetc::get) and embedded dialog code was improved there.</p>
              </div>
              <hr>

              <div class="post">
                <p class="post-meta"><span class="post-author text-primary">dannyoneill</span><br>
                <span class="post-time small text-muted">21st January 2007 18:59 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                <p class="post-content">Its weird, use the old version in the post above and all works, use the latest and it just wont show.<br>
                <br>
                Do I need any other commands to make it show or should<br>
                <br>
                InetLoad::load ${PDFURL} $PROGRAMDIRECTORY\CoolPDF.exe<br>
                <br>
                work?<br>
                <br>
                Thanks</p>
              </div>
              <hr>

              <div class="post">
                <p class="post-meta"><span class="post-author text-primary">Takhir</span><br>
                <span class="post-time small text-muted">22nd January 2007 07:21 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                <p class="post-content">I compared last source with March 12, 2006 version and don't see any related code changes. What is your 'old' version? And (again :) ) Inetc behaviour is more stable in old (NSISdl) display mode.<br>
                In your code following might be better (the same for Inetc)</p>
                <pre>
<code><br>InetLoad::load ${PDFURL} "$PROGRAMDIRECTORY\CoolPDF.exe" /end<br>Pop $R0</code>
</pre>
              </div>
              <hr>

              <div class="post">
                <p class="post-meta"><span class="post-author text-primary">Backland</span><br>
                <span class="post-time small text-muted">22nd January 2007 12:41 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                <p class="post-content">dannyoneill,<br>
                <br>
                Are you by any chance making multiple calls to the plugin? e.g. downloading more than 1 file.</p>
              </div>
              <hr>

              <div class="post">
                <p class="post-meta"><span class="post-author text-primary">dannyoneill</span><br>
                <span class="post-time small text-muted">24th January 2007 08:06 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                <p class="post-content">at the moment im downloading one then later another. But I have tried it with just one file. Old plugin fine, new one nope.<br>
                <br>
                I can make the full script available if thats of any help. Its for CoolPDF Portable.</p>
              </div>
              <hr>

              <div class="post">
                <p class="post-meta"><span class="post-author text-primary">Backland</span><br>
                <span class="post-time small text-muted">24th January 2007 14:01 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                <p class="post-content">hmmm... I have had similar problems with Inetc and downloading more than 1 file where the progress is not displayed at all.<br>
                <br>
                Attaching your script is probably a good idea.</p>
              </div>
              <hr>

              <div class="post">
                <p class="post-meta"><span class="post-author text-primary">Takhir</span><br>
                <span class="post-time small text-muted">24th January 2007 14:12 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                <p class="post-content">Good idea is to attach a short script reproducing the problem ;)</p>
              </div>
              <hr>

              <div class="post">
                <p class="post-meta"><span class="post-author text-primary">pengyou</span><br>
                <span class="post-time small text-muted">24th January 2007 14:16 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                <p class="post-content"></p>

                <blockquote>
                  I have had similar problems with Inetc and downloading more than 1 file where the progress is not displayed at all
                </blockquote>Are you using Inetc in NSISdl mode? Some servers do not supply the size information so Inetc cannot provide a progress bar which "moves" (because it does not know how big the file is). The progress bar stays "empty".<br>
                <br>
                Try using Inetc's POPUP mode - in the popup the plugin will tell you if the size is unavailable but it will show you how much data is being downloaded so you can tell something is happening.
              </div>
              <hr>

              <div class="post">
                <p class="post-meta"><span class="post-author text-primary">Takhir</span><br>
                <span class="post-time small text-muted">24th January 2007 14:27 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                <p class="post-content">I forgot to note that progress bar may not appear if file size is less then 8 kB (data bufer).</p>
              </div>
              <hr>

              <div class="post">
                <p class="post-meta"><span class="post-author text-primary">Backland</span><br>
                <span class="post-time small text-muted">24th January 2007 15:08 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                <p class="post-content">I'm using Inetc in NSISdl mode, file is &gt; 8kb and server definitely sends filesize as 90% of the time the progressbar shows up for the first download, but completely disappears for the second one and any others after that.<br>
                <br>
                The label showing status message always works fine though.</p>
              </div>
              <hr>

              <div class="post">
                <p class="post-meta"><span class="post-author text-primary">michael.hejwosz</span><br>
                <span class="post-time small text-muted">27th January 2007 10:01 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                <p class="post-content"><strong>a minor problem</strong><br>
                I am using your wonderful plugin yet I seem to be having a little problem I do not know what it is related to.<br>
                <br>
                I am using the /TRANSLATE switch with the following, among a few, text: "Downloading SuperMemo 2006 (13.01 Beta I from Jan 22, 2007)..." (skip the quotation marks)<br>
                Yet the text displayed about the first progress bar sheds the last 4 chars: ")..."<br>
                Could you please tell me what the reason is??<br>
                <br>
                Thank you in advance,<br>
                Mike</p>
              </div>
              <hr>

              <div class="post">
                <p class="post-meta"><span class="post-author text-primary">Takhir</span><br>
                <span class="post-time small text-muted">27th January 2007 16:30 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                <p class="post-content">I've put to wiki new version with increased string buffers. Next time please attach a short sample demonstrating the problem, it's not easy to find situation basing on the text 'among a few' :)</p>
              </div>
              <hr>

              <div class="post">
                <p class="post-meta"><span class="post-author text-primary">michael.hejwosz</span><br>
                <span class="post-time small text-muted">27th January 2007 18:29 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                <p class="post-content"><strong>label too narrow??</strong><br>
                Thank you. Unfortunately, the problem persists.<br>
                <br>
                Here can you find a more detailed description with a screenshot: <a href="http://forums.winamp.com/showthread.php?s=&amp;threadid=264467" target="_blank">http://forums.winamp.com/showthread....hreadid=264467</a><br>
                Thank you for your help.<br>
                Mike</p>
              </div>
              <hr>

              <div class="post">
                <p class="post-meta"><span class="post-author text-primary">cbexaminr</span><br>
                <span class="post-time small text-muted">30th January 2007 03:34 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                <p class="post-content"><strong>possible inetc problem</strong><br>
                Making mention of this here in case it comes to appropriate individuals attention sooner than the actual bug report...<br>
                <br>
                For description of possible problem, please see:<br>
                <a href="http://sourceforge.net/tracker/index.php?func=detail&amp;aid=1647321&amp;group_id=22049&amp;atid=373085" target="_blank">http://sourceforge.net/tracker/index...49&amp;atid=373085</a><br>
                <br>
                Thanks.</p>
              </div>
              <hr>

              <div class="post">
                <p class="post-meta"><span class="post-author text-primary">Takhir</span><br>
                <span class="post-time small text-muted">30th January 2007 07:19 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                <p class="post-content">I added KillTimer to wiki release, but probably you used pre Sep 7, 2006 version in NSISdl mode. System should kill all timers and messages queue when window destroyed.</p>
              </div>
              <hr>

              <div class="post">
                <p class="post-meta"><span class="post-author text-primary">michael.hejwosz</span><br>
                <span class="post-time small text-muted">30th January 2007 10:28 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                <p class="post-content">I have managed to solve my problem. The original line of source code looks as follows:<br>
                Downloading SuperMemo ${strSMYear4D} ($strSMVerTag from $strSMVerDate)...<br>
                The values of the last two variables (i.e. $strSMVerTag and $strSMVerDate) are read from a text file downloaded from the web. The reason why ")..." kept being truncated was that the value of $strSMVerDate had new line at the end of it.<br>
                It is solved now. Thank you for your help.<br>
                <br>
                On a related topic. The InetLoad readme text file advises to peek into the source code (i.e. InetLoad.cpp) for a full set of status strings. I am particularly interested in error status codes. I did look into the code but found not entirely satisfactory for an FAQ I am planning to write accompanying the installer. Since InetLoad is based on WinInet API, is there somewhere a list of error codes I could be referred to??</p>
              </div>
              <hr>

              <div class="post">
                <p class="post-meta"><span class="post-author text-primary">cbexaminr</span><br>
                <span class="post-time small text-muted">30th January 2007 10:51 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                <p class="post-content">The release I have contains last comment dated 1-jan-2007. (This may not be what was used in the actual build of the released mingw installer - I didn't build that one, I'm just trying to figure out why it sometimes crashes on me.)<br>
                <br>
                But, for the wiki release...<br>
                <br>
                I see no mention of a KillTimer() call in inetc.cpp.<br>
                <br>
                I searched everything expanded from the archive, and get no hits on "KillTimer".<br>
                <br>
                I do see a call and comment that is presumably used to generate an extra call to WM_TIMER functionality, i.e. PostMessage(hDlg, WM_TIMER, 1, 0); // show url &amp; fn, do it sync<br>
                <br>
                (The comment mentions "sync", however I believe to be synchronous, would need to be using SendMessage(), not PostMessage().)<br>
                <br>
                ***Where are the changes that actually kill the timer? Is it done by some means other than KillTimer()? What changes were made in the sep 7, 2006 to accomplish this? (Failed to find inetc in NSIS CVS to explore myself...)<br>
                <br>
                Thanks in advance for the info.<br>
                <br>
                (The crash address appears to be inside of progress_callback(), which appears to only be invoked from the WM_TIMER handling code. As I've tried to re-build the installer locally, obtaining all correct versions (except maybe add-ins, which I apparently can't obtain), and have failed to reproduce the crash, (although I get a display problem possibly from inetc), I'll acknowledge it may indeed be fixed... But I'm interested in knowing how it was addressed/fixed, since I don't see how the timer is being destroyed.)</p>
              </div>
              <hr>

              <div class="post">
                <p class="post-meta"><span class="post-author text-primary">Takhir</span><br>
                <span class="post-time small text-muted">30th January 2007 11:58 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                <p class="post-content">2 michael.hejwosz: you can find errors in inetc.cpp file.<br>
                <br>
                2 cbexaminr: Thanks for your help. InetLoad/Inetc crashes in NSISdl (no popup) mode found earlier but I supposed sutiation was fixed with Backland help in september. All versions are here <a href="http://nsis.sourceforge.net/File:Inetc.zip" target="_blank">http://nsis.sourceforge.net/File:Inetc.zip</a> Unfortunatelly I could not reproduce crash on my comp, so please let me know if you can find 'problem' line in code.<br>
                In the today's morning (MSK) version KillTimer was line 953. WM_TIMER handler additionally includes now IsWindow() check for (IMHO weird) situation when window already destroyed, but message loops still delivers events. PostMessage is called at the very beginning of download and should not cause crash, but any way this should be fixed now.</p>
              </div>
              <hr>

              <div class="post">
                <p class="post-meta"><span class="post-author text-primary">michael.hejwosz</span><br>
                <span class="post-time small text-muted">30th January 2007 11:58 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                <p class="post-content">Can someone help me map the error messages found @ <a href="http://msdn2.microsoft.com/en-us/library/aa385465.aspx" target="_blank">http://msdn2.microsoft.com/en-us/library/aa385465.aspx</a> to the following piece of the source code??<br>
                enum STATUS_CODES {<br>
                ST_OK = 0,<br>
                ST_CONNECTING,<br>
                ST_DOWNLOAD,<br>
                ST_CANCELLED,<br>
                ST_URLOPEN,<br>
                ST_PAUSE,<br>
                ERR_TERMINATED,<br>
                ERR_DIALOG,<br>
                ERR_INETOPEN,<br>
                ERR_URLOPEN,<br>
                ERR_TRANSFER,<br>
                ERR_FILEOPEN,<br>
                ERR_FILEWRITE,<br>
                ERR_REGET,<br>
                ERR_CONNECT,<br>
                ERR_OPENREQUEST,<br>
                ERR_SENDREQUEST,<br>
                ERR_CRACKURL,<br>
                ERR_NOTFOUND,<br>
                ERR_THREAD,<br>
                ERR_PROXY,<br>
                ERR_FORBIDDEN,<br>
                ERR_REQUEST,<br>
                ERR_SERVER,<br>
                ERR_AUTH<br>
                };<br>
                Thank you in advance,<br>
                Mike</p>
              </div>
              <hr>

              <div class="post">
                <p class="post-meta"><span class="post-author text-primary">MinterWute</span><br>
                <span class="post-time small text-muted">2nd February 2007 16:06 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                <p class="post-content">Takhir: I've just been trying the latest inetc with NSIS 2.23 and the progress dialog is not being redrawn properly for some reason. This is on Windows 2000 Pro.<br>
                <br>
                Does something need changed for the latest NSIS? I did try rebuilding with the latest exdll header without success.</p>
              </div>
              <hr>

              <div class="post">
                <p class="post-meta"><span class="post-author text-primary">Backland</span><br>
                <span class="post-time small text-muted">2nd February 2007 17:07 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                <p class="post-content">MinterWute,<br>
                <br>
                I have similar problems with this as well on both XP/2000. I'm still working on a script to reproduce the issue for Takhir.<br>
                <br>
                Its not a bad idea that you attach your script for examination. Please also note Inetc is last updated on 30th of Jan.</p>
              </div>
              <hr>

              <div class="post">
                <p class="post-meta"><span class="post-author text-primary">Takhir</span><br>
                <span class="post-time small text-muted">2nd February 2007 18:29 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                <p class="post-content">Thanks, Backland, script may help. Right now I re-tested latest inetc on my home XP Pro with following script</p>
                <pre>
<code>SetDetailsView hide<br> inetc::get "http://ineum.narod*****spr_2004.htm" "$EXEDIR\spr4.htm" \<br>  "http://ineum.narod*****spr_2005.htm" "$EXEDIR\spr5.htm"<br>Pop $0<br> inetc::get "http://ineum.narod*****spr_2006.htm"  "$EXEDIR\spr6.htm"<br>Pop $2</code>
</pre>but could not reproduce redraw issue :(
              </div>
              <hr>

              <div class="post">
                <p class="post-meta"><span class="post-author text-primary">cbexaminr</span><br>
                <span class="post-time small text-muted">3rd February 2007 03:00 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                <p class="post-content">1) Redraw issue<br>
                I and another individual (who I guess is the maintainer of the mingw installer) also have the redraw problem.<br>
                <br>
                You can grab the mingw installer source, and probably see the issue. To the best of my knowledge neither of us have done anything but use a different (latest) inetc - the script code is apparently the same. The url to browse that stuff is:<br>
                <a href="http://mingw.cvs.sourceforge.net/mingw/MinGW/" target="_blank">http://mingw.cvs.sourceforge.net/mingw/MinGW/</a><br>
                <br>
                The instructions to check it out with command line cvs are at:<br>
                <a href="http://sourceforge.net/cvs/?group_id=2435" target="_blank">http://sourceforge.net/cvs/?group_id=2435</a><br>
                <br>
                2)earlier reported crash - older version of inetc<br>
                I have learned that the crashing version of inetc was the 10 june version. Further research indicates that the crash was occurring at the location where a routine ParentWndProc() should have been (before the pages were released.)<br>
                <br>
                It appears that this routine is no longer part of the current inetc source, and so I will assume that problem is no longer a problem.</p>
              </div>
              <hr>

              <div class="post">
                <p class="post-meta"><span class="post-author text-primary">Takhir</span><br>
                <span class="post-time small text-muted">3rd February 2007 08:17 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                <p class="post-content">OK, redraw is the only problem in current version, so let's find where and why :) OS, IE ver., NSIS ver, latest Inetc, short script reproducing the problem. To test this I have XP Pro and win98 with home dial-up and all OSes and most of connection types in office. Please attach script to post.</p>
              </div>
              <hr>

              <div class="post">
                <p class="post-meta"><span class="post-author text-primary">Meefer</span><br>
                <span class="post-time small text-muted">4th February 2007 12:11 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                <p class="post-content"><a href="http://Jennifer-Lopez-Doing-A-Huge-Black-Man.info" target="_blank">http://Jennifer-Lopez-Doing-A-Huge-Black-Man.info</a></p>
              </div>
              <hr>

              <div class="post">
                <p class="post-meta"><span class="post-author text-primary">Backland</span><br>
                <span class="post-time small text-muted">4th February 2007 12:18 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                <p class="post-content">seems the forum is blocking external links, can you guys post your links as plain text (probably by removing the <a href="http://www" target="_blank">http://www</a>)<br>
                <br>
                google.com</p>
              </div>
              <hr>

              <div class="post">
                <p class="post-meta"><span class="post-author text-primary">Red Wine</span><br>
                <span class="post-time small text-muted">4th February 2007 12:24 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                <p class="post-content">@ Backland, the forum blocks external links that added from new registered users ;)<br>
                I bet the blocked link above is just spammers attempt to add their craps in this forum.<br>
                <br>
                If for instance you try to submit an external link, I bet won't be blocked ;)</p>
              </div>
              <hr>

              <div class="post">
                <p class="post-meta"><span class="post-author text-primary">Backland</span><br>
                <span class="post-time small text-muted">4th February 2007 12:35 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                <p class="post-content">Thanks Red Wine, testing <a href="http://www.google.com" target="_blank">http://www.google.com</a><br>
                <br>
                cbexaminr added 2 links just a few posts above, i think those were to the installer which has the redraw issues.</p>
              </div>
              <hr>

              <div class="post">
                <p class="post-meta"><span class="post-author text-primary">Red Wine</span><br>
                <span class="post-time small text-muted">4th February 2007 12:44 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                <p class="post-content"></p>

                <blockquote>
                  <i>Originally posted by Backland</i><br>
                  <b>Thanks Red Wine, testing <a href="http://www.google.com" target="_blank">http://www.google.com</a><br>
                  <br>
                  cbexaminr added 2 links just a few posts above, i think those were to the installer which has the redraw issues.</b>
                </blockquote>You probably realize that a strong protection from spammers requires some patience from the rest of new registered users ;)
              </div>
              <hr>

              <div class="post">
                <p class="post-meta"><span class="post-author text-primary">cbexaminr</span><br>
                <span class="post-time small text-muted">5th February 2007 10:14 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                <p class="post-content">browse mingw installer source tree:<br>
                mingw.cvs.sourceforge.net/mingw/MiGW/<br>
                <br>
                to checkout mingw installer source follow instructions at:<br>
                sourceforge.net/cvs/?group_id=2435<br>
                <br>
                Sorry it's not "reduced script" - but it's what I can point you toward.<br>
                <br>
                (hope these "links" pass the filtering - funny, I don't think the "preview" showed the links blacked out in original post. There is no www on the items, just h t t p : / / .)</p>
              </div>
              <hr>

              <div class="post">
                <p class="post-meta"><span class="post-author text-primary">MinterWute</span><br>
                <span class="post-time small text-muted">5th February 2007 16:59 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                <p class="post-content">Using SetDetailsView show gives the redraw error for me with your small script. This used to work with previous versions but maybe it's something that I shouldn't have been doing?<br>
                <br></p>
                <pre>
<code><br>  SetDetailsView show<br>  inetc::get /RESUME "" "http://downloads.sourceforge.net/devkitpro/libnds-20060719.tar.bz2" "$EXEDIR\libnds-20060719.tar.bz2" /END<br>  Pop $0<br>  MessageBox MB_OK "Download Status: $0"<br><br></code>
</pre>
              </div>
              <hr>

              <div class="post">
                <p class="post-meta"><span class="post-author text-primary">Takhir</span><br>
                <span class="post-time small text-muted">6th February 2007 09:23 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                <p class="post-content">I tested script from my previous post on the following OSes: Win98 SE (IE5), Win2000 SP2, WinXP Pro SP2, Win2003 SP1, Vista Ultimate Final Release (IE7) - no problems with redraw. Last Inetc Jan 30, 2007. NSIS 2.22. With 'SetDetailsView show' dialog looks ugly (tested on XP), but redraw was correct. May be progress bar smothing in not-XP style would be better.<br>
                <i>Edited: I used 2 versions of dotnetfx.exe (20 MB) for LAN downloads.</i></p>
              </div>
              <hr>

              <div class="post">
                <p class="post-meta"><span class="post-author text-primary">Takhir</span><br>
                <span class="post-time small text-muted">19th February 2007 10:12 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                <p class="post-content">New <a href="http://nsis.sourceforge.net/Inetc_plug-in" target="_blank">Inetc</a> version.<br>
                1. /POPUP option now with text (again), /POPUP "HOST_ALIAS" - this allow to hide real URL in popup mode and (if encoded) login/password(!).<br>
                2. Transfer speed calculation improved (for paused state mainly).<br>
                3. Redirection sample added (I received request for HTTP 301/302, and even added code, but finally found that WinInet does this internally). But redirection prohibitted for https (right now I cannot remember why :) ).</p>
              </div>
              <hr>

              <div class="post">
                <p class="post-meta"><span class="post-author text-primary">pedroac</span><br>
                <span class="post-time small text-muted">19th February 2007 20:20 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                <p class="post-content">In my tests, this DOES NOT WORK if you don't have .NET installed</p>
              </div>
              <hr>

              <div class="post">
                <p class="post-meta"><span class="post-author text-primary">Takhir</span><br>
                <span class="post-time small text-muted">20th February 2007 08:20 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                <p class="post-content">I tested last build at home on XP Pro, <b>without .NET</b> and now in office on Win98 and Win2000 (no .NET as well), Inetc works correct on all these comps. If you have problem with all plug-ins (NSISdl, InetLoad, Inetc) it's a good time to check your own script ;)<br>
                BTW did you built NSIS from sources?</p>
              </div>
              <hr>

              <div class="post">
                <p class="post-meta"><span class="post-author text-primary">Mr Inches</span><br>
                <span class="post-time small text-muted">24th February 2007 01:22 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                <p class="post-content">The .NET install usually includes versions of the MS C Runtime libraries (DLLs).<br>
                <br>
                Is it possible that one of these is getting clobbered and causing the problem? (assuming that the problem is only evident on computer with the .NET framework installed.)<br>
                <br>
                What about the presence of VS 2005, it uses a different version of the MS CRT again (8.0)?<br>
                <br>
                Duncan</p>
              </div>
              <hr>

              <div class="post">
                <p class="post-meta"><span class="post-author text-primary">pedroac</span><br>
                <span class="post-time small text-muted">26th February 2007 10:03 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                <p class="post-content">I concluded that this problem was only happening in a single PC, there must be something wrong with the .NET libraries (the problem is that even with all the .NET versions unistalled the problem keeps happening...)</p>
              </div>
              <hr>
              
              
              

              <div class="container">
                

                <ol class="breadcrumb">
                  <li><a href="../index.html" class="glyphicon glyphicon-home"></a></li>

                  <li><a href="f-65.html">NSIS Discussion</a></li>

                  <li class="active">http + ftp download plug-in</li>
                </ol>

                <p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=198596">http + ftp download plug-in</a></p><br>

                <div class="post">
                  <p class="post-meta"><span class="post-author text-primary">ts77</span><br>
                  <span class="post-time small text-muted">1st March 2007 12:20 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                  <p class="post-content">Is there a chance to use the "chmod" command if uploading with ftp?<br>
                  I'm building an installer for a webapp using this great plugin but I couldn't find a way to call chmod remotely :( (beside using a plain ftp-client ;)).</p>
                </div>
                <hr>

                <div class="post">
                  <p class="post-meta"><span class="post-author text-primary">empezar</span><br>
                  <span class="post-time small text-muted">25th March 2007 12:47 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                  <p class="post-content">InetLoad steals focus everytime it downloads a new file, even if I minimize the installer, it grabs the focus.<br>
                  <br>
                  Extremely annoying.<br>
                  <br>
                  Other than that, InetLoad has saved me :)</p>
                </div>
                <hr>

                <div class="post">
                  <p class="post-meta"><span class="post-author text-primary">Takhir</span><br>
                  <span class="post-time small text-muted">25th March 2007 15:46 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                  <p class="post-content"><b>ts77</b><br>
                  all is possible, only time is a problem :(<br>
                  <br>
                  <b>empezar</b><br>
                  Looks like you are using very old InetLoad version.. This feature was removed more then year ago (sf() function). While some focus tricks still may present in NSISdl display mode. Try to use <a href="http://nsis.sourceforge.net/Inetc_plug-in" target="_blank">http://nsis.sourceforge.net/Inetc_plug-in</a><br>
                  You can also put more url/file pairs to stack and download all you need in 'single' InetLoad/Inetc session. /NOUNLOAD option in the command line may help as well.</p>
                </div>
                <hr>

                <div class="post">
                  <p class="post-meta"><span class="post-author text-primary">empezar</span><br>
                  <span class="post-time small text-muted">25th March 2007 16:08 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                  <p class="post-content">what's the difference between inetc and inetload?</p>
                </div>
                <hr>

                <div class="post">
                  <p class="post-meta"><span class="post-author text-primary">empezar</span><br>
                  <span class="post-time small text-muted">26th March 2007 18:15 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                  <p class="post-content">My installer is crashing all over the place with both this and inetc plugin.<br>
                  <br>
                  I'm downloading about 82 files using this macro:<br>
                  <br></p>
                  <pre>
<code>!macro DownloadDistfile PACKAGE<br>  StrCpy $R0 ${PACKAGE}<br>  ${Unless} ${FileExists} "$DISTFILES_PATH\$R0"<br>    FileWrite $DISTLOG "$R0$\r$\n"<br>    inetc::get "$DISTFILES_URL/$R0" "$DISTFILES_PATH\$R0"<br>    Pop $0<br>    ${Unless} $0 == "OK"<br>      ${If} $0 == "Cancelled"<br>        call .abortDownload<br>      ${Else}<br>        DetailPrint "Error downloading: $R0"<br>      ${EndIf}<br>    ${Else}<br>      DetailPrint "Successfully downloaded: $R0"<br>    ${EndUnless}<br>  ${Else}<br>    DetailPrint "Skipping: $R0"<br>  ${EndUnless}<br>!macroend</code>
</pre><br>
                  <br>
                  and calling them all like this:<br>
                  <br>
                  <pre>
<code>!insertmacro DownloadDistfile package.zip</code>
</pre><br>
                  <br>
                  in 82 different sections.<br>
                  <br>
                  this is the only code in each section, so this is all the code used from the start of the installer to the end, and it crashes after a while, not always during the same download!<br>
                  <br>
                  <br>
                  oh and by the way, that focus thing still bothers me. even with the inetc plugin.
                </div>
                <hr>

                <div class="post">
                  <p class="post-meta"><span class="post-author text-primary">Takhir</span><br>
                  <span class="post-time small text-muted">26th March 2007 19:06 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                  <p class="post-content">I re-tested serial download of 3 12MB files<br></p>
                  <pre>
<code>SetDetailsView hide<br>inetc::get "http://localhost/IMG_0188.tif" "$EXEDIR\IMG_0188.tif" /END<br>Pop $0<br>DetailPrint "Downloading: $0"<br>inetc::get "http://localhost/IMG_0189.tif" "$EXEDIR\IMG_0189.tif" /END<br>Pop $1<br>DetailPrint "Downloading: $1"<br>inetc::get "http://localhost/IMG_0190.tif" "$EXEDIR\IMG_0190.tif" /END<br>Pop $2<br>DetailPrint "Downloading: $2"<br>MessageBox MB_OK "Download Status: $0, $1, $2"</code>
</pre><br>
                  with minimized installer, all the time I had notepad opened and it never losed focus during download. So bothering<br>
                  problem not reproduces with my Apache.<br>
                  Crashes also not happened. I never tested 82 sections, this may be NSIS problem as well. Do you see any minimum sections number when the problem appear?<br>
                  Can you test your script with "inetc::get /NOUNLOAD ... /END"? this should decrease number of dll loads/unloads.
                </div>
                <hr>

                <div class="post">
                  <p class="post-meta"><span class="post-author text-primary">empezar</span><br>
                  <span class="post-time small text-muted">26th March 2007 23:15 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                  <p class="post-content">thanks, that solved it!<br>
                  <br>
                  also, forget what I said about the focus thing - i was testing with an old installer :D my bad.</p>
                </div>
                <hr>

                <div class="post">
                  <p class="post-meta"><span class="post-author text-primary">fabiochelly</span><br>
                  <span class="post-time small text-muted">27th March 2007 22:22 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                  <p class="post-content">Hi,<br>
                  <br>
                  is it possible to add a function to list files in a ftp directory?<br>
                  <br>
                  In fact, I need to download the list of existing files (with their dates) in a specific FTP directory.<br>
                  After that, I will display this list to the user so he can choose what file he wants to download.<br>
                  <br>
                  Is it possible to add a new method InetLoad::list?</p>
                </div>
                <hr>

                <div class="post">
                  <p class="post-meta"><span class="post-author text-primary">empezar</span><br>
                  <span class="post-time small text-muted">28th March 2007 17:14 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                  <p class="post-content">is it possible to pause downloading? say if a user presses Cancel, I want to display "Are you sure?" and have the download PAUSE. if they then press NO, the download should resume. I've only succeeded in making the download re-download, but that is not very good when we're talking 100MB+ files :)</p>
                </div>
                <hr>

                <div class="post">
                  <p class="post-meta"><span class="post-author text-primary">Takhir</span><br>
                  <span class="post-time small text-muted">28th March 2007 18:32 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                  <p class="post-content">Not in current version. BTW if plug-in loses connection it re-gets file from the current position, on permanent problems it displays customizable /resume message and also correctly continue download, but on Cancel (may be disabled) it even deletes local file.</p>
                </div>
                <hr>

                <div class="post">
                  <p class="post-meta"><span class="post-author text-primary">empezar</span><br>
                  <span class="post-time small text-muted">28th March 2007 18:59 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                  <p class="post-content">one more question. is it possible to display different messages on the same /BANNER download window?<br>
                  <br>
                  e.g. "Downloading file 1 of 3" -&gt; 2 of 3 -&gt; 3 of 3<br>
                  <br>
                  that is without it popping up another window?<br>
                  <br>
                  it's annoying when you have to download a lot of files during initialization and each file has its own window, as moving one window will only result in the next popping back up in the middle of the screen.</p>
                </div>
                <hr>

                <div class="post">
                  <p class="post-meta"><span class="post-author text-primary">fabiochelly</span><br>
                  <span class="post-time small text-muted">28th March 2007 22:40 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                  <p class="post-content">I've got a problem with one of my ftp servers.<br>
                  This server, hosted by infomaniak.ch returns a 404 when I try to get a file via FTP.<br>
                  <br>
                  If I try to upload a file via FTP on this server, it works fine<br>
                  If I try to get the same file but with a HTTP get, it works fine.<br>
                  If I try to get a file from any other server than this one, it works fine.<br>
                  Every other FTP client can download from this server without error (even Internet Explorer)<br>
                  <br>
                  Is there a way to find why I get a 404 from this server if I use a FTP get with inetc?</p>
                </div>
                <hr>

                <div class="post">
                  <p class="post-meta"><span class="post-author text-primary">Takhir</span><br>
                  <span class="post-time small text-muted">29th March 2007 06:57 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                  <p class="post-content"><b>empezar</b><br>
                  You can add as many url/file pairs to the command line as you want. To keep working with short command line use push to stack in the reverse order:</p>
                  <pre>
<code>Push /end<br>Push filen<br>Push urln<br>...<br>Push file1<br>Push url1<br>inetc::get</code>
</pre>This way plugin not re-creates dialog and not center it on every new file. But this is not compatible with various banner texts.<br>
                  <b>fabiochelly</b><br>
                  404 is common http status code, please check <a href="ftp://" target="_blank">ftp://</a> at the beginning of command line <a href="http://en.wikipedia.org/wiki/List_of_FTP_server_return_codes" target="_blank">http://en.wikipedia.org/wiki/List_of...r_return_codes</a> . Also for full path (from / ) use <a href="ftp://server//path/file," target="_blank">ftp://server//path/file,</a> but for current user home dir use single slash before path.
                </div>
                <hr>

                <div class="post">
                  <p class="post-meta"><span class="post-author text-primary">fabiochelly</span><br>
                  <span class="post-time small text-muted">29th March 2007 07:16 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                  <p class="post-content">I checked my host but everything seems correct:<br>
                  host: <a href="ftp://login:password@chelly.net/bp.exe" target="_blank">ftp://login:password@chelly.net/bp.exe</a><br>
                  <br>
                  I always get a 404! I really think that my problem comes from the fact that this server is configured differently.<br>
                  I think there is a problem with your plugin if used with some rare servers or a specific configuration</p>
                </div>
                <hr>

                <div class="post">
                  <p class="post-meta"><span class="post-author text-primary">stb</span><br>
                  <span class="post-time small text-muted">31st March 2007 13:49 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                  <p class="post-content">Hi Takhir,<br>
                  <br>
                  I just downloaded the latest version of your InetC plugin and noticed that there are more dependencies than before.<br>
                  <br>
                  You now depend on msvcrt.dll (you did only depend on comctl32.dll and wininet.dll before).</p>
                </div>
                <hr>

                <div class="post">
                  <p class="post-meta"><span class="post-author text-primary">Takhir</span><br>
                  <span class="post-time small text-muted">31st March 2007 15:28 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                  <p class="post-content">No. I had a lot of msvcrt dependencies earlier, but removed 80% in last releases. Finally this is not a problem - plug-ins depend on wininet.dll, but any system with wininet has msvcrt.dll<br>
                  And I've sent pm to fabiochelly</p>
                </div>
                <hr>

                <div class="post">
                  <p class="post-meta"><span class="post-author text-primary">ART_Adventures</span><br>
                  <span class="post-time small text-muted">14th April 2007 11:27 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                  <p class="post-content">Does this plugin work if there is an @ character in the username for an FTP server? I seem to get a URL parts error.<br>
                  <br>
                  Thanks.</p>
                </div>
                <hr>

                <div class="post">
                  <p class="post-meta"><span class="post-author text-primary">Takhir</span><br>
                  <span class="post-time small text-muted">14th April 2007 12:14 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                  <p class="post-content">If InternetCrackUrl (used in plug-in to get url parts)reports url error - no, not supported. The only @ as password-host separator.</p>
                </div>
                <hr>

                <div class="post">
                  <p class="post-meta"><span class="post-author text-primary">ART_Adventures</span><br>
                  <span class="post-time small text-muted">14th April 2007 16:37 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                  <p class="post-content">I discovered, this can be resolved by susbtituting the first "@" character with "%40"</p>
                </div>
                <hr>

                <div class="post">
                  <p class="post-meta"><span class="post-author text-primary">Comperio</span><br>
                  <span class="post-time small text-muted">20th April 2007 04:39 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                  <p class="post-content">Just curious:<br>
                  A few posts back, fabiochelly asked:<br></p>

                  <blockquote>
                    is it possible to add a function to list files in a ftp directory?
                  </blockquote>Does this functionality exist in the current version? If so, how do you use it? If not, any chance it could be added?
                </div>
                <hr>

                <div class="post">
                  <p class="post-meta"><span class="post-author text-primary">Takhir</span><br>
                  <span class="post-time small text-muted">20th April 2007 07:03 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                  <p class="post-content"></p>

                  <blockquote>
                    Does this functionality exist in the current version? If so, how do you use it? If not, any chance it could be added?
                  </blockquote>1. No.<br>
                  2. See 1.<br>
                  3. inetc/inetload looks solid in current implementation, ftp/http, get/put/post - all the functions use 90% of common code (even write and read implemented in the same loop). ftp ls stays a bit apart and this is why I don't want to include it to these plug-ins. IMHO better way is to write a normal ftp plug-in. I even have a code of the ftp backup client (Explorer style, mirroring, files versioning, queues, file migration status for disk cache and so on..) I wrote few years ago for ADIC, but I cannot share this code and have time for small 'free' tasks only now :(
                </div>
                <hr>

                <div class="post">
                  <p class="post-meta"><span class="post-author text-primary">Comperio</span><br>
                  <span class="post-time small text-muted">20th April 2007 15:18 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                  <p class="post-content">Sounds fair enough. Thanks, Takhir! :)</p>
                </div>
                <hr>

                <div class="post">
                  <p class="post-meta"><span class="post-author text-primary">ART_Adventures</span><br>
                  <span class="post-time small text-muted">2nd May 2007 08:43 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                  <p class="post-content">Hi People,<br>
                  <br>
                  I seem to have a problem downloading text files via ftp. Some new line returns are missing. Should there be an argument to set the ftp to binary or ascii? If so, is there a way I can do this?<br>
                  <br>
                  Thanks in advance.</p>
                </div>
                <hr>

                <div class="post">
                  <p class="post-meta"><span class="post-author text-primary">ART_Adventures</span><br>
                  <span class="post-time small text-muted">5th May 2007 19:53 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                  <p class="post-content">Has anybody else found this?<br>
                  <br>
                  If I put a text file online via ftp. Say the following:<br>
                  <br>
                  "hello<br>
                  <br>
                  world<br>
                  <br>
                  end"<br>
                  <br>
                  The InetLoad plug-in will download the file without the line returns, as:<br>
                  <br>
                  "hello<br>
                  world<br>
                  end"</p>
                </div>
                <hr>

                <div class="post">
                  <p class="post-meta"><span class="post-author text-primary">NeoAlus</span><br>
                  <span class="post-time small text-muted">8th May 2007 11:48 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                  <p class="post-content"><strong>layout</strong><br>
                  NSISdl used the installer's "Cancel" button, and also expanded the progress bar to be the same size as the installation progress bar (in Modern UI mode). Is there a way to get inetc to act the same? (/NOCANCEL just removes the extra cancel button and does not enable the built-in button).</p>
                </div>
                <hr>

                <div class="post">
                  <p class="post-meta"><span class="post-author text-primary">Takhir</span><br>
                  <span class="post-time small text-muted">10th May 2007 12:06 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                  <p class="post-content">Just from vacations :)<br>
                  <b>ART_Adventures</b> change FTP_TRANSFER_TYPE_ASCII to FTP_TRANSFER_TYPE_BINARY in source code and rebuild plug-in. I cannot remember why ASCII was used :( But till now I had not problems with binary files download. Nevertheless I'll update wiki to fix your situation (after some tests).<br>
                  <b>NeoAlus</b> not in options - code correction required. Inetc inserts a small dialog with progress bar to NSIS window (3-rd level dialog), so this dilaog and it's controls to be resized. Looks reasonable, I'll try to add this feature soon.<br>
                  May be in weekend. A lot of other work now.</p>
                </div>
                <hr>

                <div class="post">
                  <p class="post-meta"><span class="post-author text-primary">Takhir</span><br>
                  <span class="post-time small text-muted">12th May 2007 17:18 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                  <p class="post-content">1. Plug-in uses ASCII mode for file size requests only (ftp), file download is always binary, so please check your server settings. I tested ASCII download from Wftpd.exe server and everything was correct.<br>
                  2. Extra Cancel button should exists by design. Second progress bar and text above it may be resized (see attached image), but I don't like this design so I'll leave plug-in as it is now. If you want I can send you inetc.cpp code with resizing I wrote today.</p>
                </div>
                <hr>

                <div class="post">
                  <p class="post-meta"><span class="post-author text-primary">SEK_Blackhawk</span><br>
                  <span class="post-time small text-muted">1st June 2007 03:48 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                  <p class="post-content">Is this plugin able to calculate the total file size and thus showing the total download time correctly? It works in 'batch' mode, but every file is download separately and therefore the total download time is unknown, if multiple files are requested. (at last if http download is used.)</p>
                </div>
                <hr>

                <div class="post">
                  <p class="post-meta"><span class="post-author text-primary">acrunner</span><br>
                  <span class="post-time small text-muted">4th June 2007 09:36 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                  <p class="post-content">Some builds threw out a "Url Parts Error" at the end of the downloading but the file is successfully downloaded and not deleted. What's wrong with it?</p>
                </div>
                <hr>

                <div class="post">
                  <p class="post-meta"><span class="post-author text-primary">Takhir</span><br>
                  <span class="post-time small text-muted">4th June 2007 09:48 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                  <p class="post-content">acrunner: Your stack contains other items, use /END at the end of command line. Otherwise plug-in reads stack till end or first error in URL - File pair.<br>
                  <br>
                  SEK_Blackhawk: no this option. You can show one of NSIS banners with progress bar showing size or number of files downloaded progress (inetc may be in the silent mode this case). To get files sizes from server use 'head' request. This banner worked correct <a href="http://nsis.sourceforge.net/Nxs_plug-in" target="_blank">http://nsis.sourceforge.net/Nxs_plug-in</a></p>
                </div>
                <hr>

                <div class="post">
                  <p class="post-meta"><span class="post-author text-primary">Joost Verburg</span><br>
                  <span class="post-time small text-muted">9th June 2007 22:49 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                  <p class="post-content">There really is a problem with Inetload FTP downloads and a recent version of the ProFTPD server. I also get 404 errors, even though the file exists. Try for example to download any file from <a href="ftp://ftp.lyx.org" target="_blank">ftp://ftp.lyx.org</a>.</p>
                </div>
                <hr>

                <div class="post">
                  <p class="post-meta"><span class="post-author text-primary">Takhir</span><br>
                  <span class="post-time small text-muted">10th June 2007 17:35 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                  <p class="post-content">Thanks, Joost,<br>
                  I could reproduce situation and found 'why' - see attached screenshot. The same answer in console: PHP Code:</p>
                  <hr>
                  <code style="white-space:nowrap"></code><span style="color: #000000"><span style="color: #0000BB">ftp</span><span style="color: #007700">&gt;</span><span style="color: #0000BB">literalSIZEapache</span><span style="color: #007700">-</span><span style="color: #0000BB">ant</span><span style="color: #007700">-</span><span style="color: #0000BB">1.7.0</span><span style="color: #007700">-</span><span style="color: #0000BB">bin</span><span style="color: #007700">.</span><span style="color: #0000BB">tar</span><span style="color: #007700">.</span><span style="color: #0000BB">bz2</span><span style="color: #007700">.</span><span style="color: #0000BB">md5<br>
                  550SIZE</span><span style="color: #007700">:</span><span style="color: #0000BB">Operationnotpermitted<br></span></span> 
                  <hr>
                  Server not 'eats' SIZE request and plug-in re-interprets 550 as 'file not found'. BTW 'ls -l' not gives extended info on this server as well. Finally I can make ftp working without file size, but IE displays this, so it is possible. Any Ideas?<br>
                  Edited after short googling: BTW ProFTPD 550 on SIZE has a great history :) <a href="http://www.google*****search?hl=ru&amp;q=ProFTPD+SIZE+problem+550&amp;lr=" target="_blank">http://www.google*****search?hl=ru&amp;q=...roblem+550&amp;lr=</a> And SIZE request fails even with FTP_TRANSFER_TYPE_BINARY for control connection.
                </div>
                <hr>

                <div class="post">
                  <p class="post-meta"><span class="post-author text-primary">Joost Verburg</span><br>
                  <span class="post-time small text-muted">10th June 2007 17:58 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                  <p class="post-content">FileZilla is able to display the file sizes, so they must be in some directory listing.</p>
                </div>
                <hr>

                <div class="post">
                  <p class="post-meta"><span class="post-author text-primary">Takhir</span><br>
                  <span class="post-time small text-muted">11th June 2007 10:50 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                  <p class="post-content">OK, both inetc &amp; inetload allow FTP download now even is server rejects SIZE request, but progress bar functionality will be unavailable while file size is unknown (the same happen with chunked http replies). And confusing '404' shold not appear any more.</p>
                </div>
                <hr>

                <div class="post">
                  <p class="post-meta"><span class="post-author text-primary">imecstatic</span><br>
                  <span class="post-time small text-muted">15th June 2007 10:23 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                  <p class="post-content"><strong>inetload crash on windows Vista</strong><br>
                  When I run setup on windows vista, sometimes it runs fine but sometimes it crashes.<br>
                  Every time crash occurs while downloading. I am using InetLoad for downloading through following command:<br>
                  <br>
                  InetLoad::load /TRANSLATE "Downloading %s" "Connecting ..." second minute hour s "%dkB (%d%%) of %dkB @ %d.%01dkB/s" "(%d %s%s remaining)" \<br>
                  "192.168.1.204/xyz.exe" "$INSTDIR\xyz.exe" /END<br>
                  <br>
                  Any help will be appreciated.</p>
                </div>
                <hr>

                <div class="post">
                  <p class="post-meta"><span class="post-author text-primary">Takhir</span><br>
                  <span class="post-time small text-muted">15th June 2007 13:13 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                  <p class="post-content">This happen sometimes in NSISdl mode you currently use. Happen in the part of code I took from NSISdl sources :) The best way is to use inetc plug-in where this part was fully re-worked. inetc::get .... Or popup/banner mode of InetLoad. <a href="http://nsis.sourceforge.net/Inetc_plug-in" target="_blank">http://nsis.sourceforge.net/Inetc_plug-in</a></p>
                </div>
                <hr>

                <div class="post">
                  <p class="post-meta"><span class="post-author text-primary">51819</span><br>
                  <span class="post-time small text-muted">18th June 2007 09:53 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                  <p class="post-content"></p>

                  <blockquote>
                    Section "Dummy Section" SecDummy<br>
                    <br>
                    # parameters: URL local_file [reget_attempts [pause_sec]]<br>
                    InetLoad::load "http://dl.zvuki*****6306/mp3/1.mp3" "$EXEDIR\pavarotti.mp3" 3 10<br>
                    Pop $0 # return value - exit code<br>
                    MessageBox MB_OK "HTTP Download Status: <font color="red">$0</font>"<br>
                    <br>
                    SectionEnd
                  </blockquote>I don't like MessageBox show "HTTP Download Status: <font color="red">OK</font>" when i completed Download<br>
                  i like MessageBox show "HTTP Download Status: <font color="red">over</font>"<br>
                  <br>
                  how can i do it show <font color="red">over</font>
                </div>
                <hr>

                <div class="post">
                  <p class="post-meta"><span class="post-author text-primary">empezar</span><br>
                  <span class="post-time small text-muted">30th July 2007 10:53 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                  <p class="post-content">is there a way of cancelling the installer by pressing the [x] button on the inetc download window during .onInit?<br>
                  <br>
                  what "termination code" does inetc provide when you press that [x] button, if any (again, during .onInit with /banner mode)? I've tried "Cancelled" and "Terminated", but I get seemingly random results, and they don't come right away, but after about 2 seconds, which seems a bit buggy to me.<br>
                  <br>
                  this is the code I use:<br>
                  <br></p>
                  <pre>
<code>GetTempFileName $NQUAKE_INI<br><br>  Start:<br>  inetc::get /NOUNLOAD /CAPTION "Initializing..." /BANNER "nQuake is initializing, please wait..." /TIMEOUT 5000 "${INSTALLER_URL}/nquake.ini" $NQUAKE_INI /END<br>  Pop $0<br>  ${Unless} $0 == "OK"<br>    ${If} $0 == "Terminated"<br>      MessageBox MB_OK|MB_ICONEXCLAMATION "Installation aborted."<br>      Abort<br>    ${Else}<br>      ${Unless} $RETRIES &gt; 0<br>        MessageBox MB_YESNO|MB_ICONEXCLAMATION "Are you trying to install nQuake offline?" IDNO Online<br>        StrCpy $OFFLINE 1<br>        Goto InitEnd<br>      ${EndUnless}<br>      Online:<br>      ${Unless} $RETRIES == 2<br>        MessageBox MB_RETRYCANCEL|MB_ICONEXCLAMATION "Could not download nquake.ini." IDCANCEL Cancel<br>        IntOp $RETRIES $RETRIES + 1<br>        Goto Start<br>      ${EndUnless}<br>      MessageBox MB_OK|MB_ICONEXCLAMATION "Could not download nquake.ini. Please try again later."<br>      Cancel:<br>      Abort<br>    ${EndIf}<br>  ${EndUnless}</code>
</pre>
                </div>
                <hr>

                <div class="post">
                  <p class="post-meta"><span class="post-author text-primary">Takhir</span><br>
                  <span class="post-time small text-muted">30th July 2007 11:34 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                  <p class="post-content">Plug-in should return "Cancelled" string if user pressed this button. Download thread exit may require some time if it waits for data from socket.</p>
                </div>
                <hr>

                <div class="post">
                  <p class="post-meta"><span class="post-author text-primary">empezar</span><br>
                  <span class="post-time small text-muted">30th July 2007 12:56 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                  <p class="post-content">okay.<br>
                  <br>
                  seems to work, though sometimes i still get the "could not download" message instead of "installation aborted". i can live with that though.</p>
                </div>
                <hr>
                
                
                

                <div class="container">
                  

                  <ol class="breadcrumb">
                    <li><a href="../index.html" class="glyphicon glyphicon-home"></a></li>

                    <li><a href="f-65.html">NSIS Discussion</a></li>

                    <li class="active">http + ftp download plug-in</li>
                  </ol>

                  <p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=198596">http + ftp download plug-in</a></p><br>

                  <div class="post">
                    <p class="post-meta"><span class="post-author text-primary">empezar</span><br>
                    <span class="post-time small text-muted">31st July 2007 12:09 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                    <p class="post-content">after further testing, I can say that I only get the "installation aborted" message when the download actually fails. I tried changing the download url to something that doesn't exist, and now everytime I press the [x] button, I get the wrong message ("are you trying to install nquake offline?").<br>
                    <br>
                    so apparently, inetc only returns "Cancelled" if the download was successful AND cancelled?</p>
                  </div>
                  <hr>

                  <div class="post">
                    <p class="post-meta"><span class="post-author text-primary">DgtHorse</span><br>
                    <span class="post-time small text-muted">23rd August 2007 17:13 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                    <p class="post-content"><strong>URL Parts Error</strong><br>
                    My installer works fine on my machine but as soon as i run it on another machine it seems to download and at the end get a URL Parts error. i am using inetc get command with the /END prefixed and still getting it.<br>
                    <br>
                    All i am downloading is the ASP.NET Ajax framework with the following command<br>
                    <br>
                    inetc::get /caption "Downloading AJAX ASP.NET Framework 1.0" /canceltext "Cancel Download" "http://download.microsoft.com/download/5/4/6/5462bcbd-e738-45fa-84ca-fa02b0c4e1c2/ASPAJAXExtSetup.msi" "$INSTDIR\ajax.msi" /TIMEOUT 5000 /END<br>
                    <br>
                    I do not know why it works on one and the other machine gets the URL Parts Error, anyone mind to shed some light on this? :)<br>
                    <br>
                    TIA</p>
                  </div>
                  <hr>

                  <div class="post">
                    <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br>
                    <span class="post-time small text-muted">23rd August 2007 17:32 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                    <p class="post-content">Does $INSTDIR exist?<br>
                    <br>
                    Stu</p>
                  </div>
                  <hr>

                  <div class="post">
                    <p class="post-meta"><span class="post-author text-primary">Takhir</span><br>
                    <span class="post-time small text-muted">23rd August 2007 18:16 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                    <p class="post-content">Move /TIMEOUT 5000 to the beginning of command line.</p>
                  </div>
                  <hr>

                  <div class="post">
                    <p class="post-meta"><span class="post-author text-primary">DgtHorse</span><br>
                    <span class="post-time small text-muted">23rd August 2007 18:51 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                    <p class="post-content">aha! That did the trick!<br>
                    Hmm, the fact that it worked on one machine and didn't in the other really did not strike me as writing the command erroneously :P</p>
                  </div>
                  <hr>

                  <div class="post">
                    <p class="post-meta"><span class="post-author text-primary">Backland</span><br>
                    <span class="post-time small text-muted">26th August 2007 03:13 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                    <p class="post-content">What is the OS on the two machines?</p>
                  </div>
                  <hr>

                  <div class="post">
                    <p class="post-meta"><span class="post-author text-primary">Joost Verburg</span><br>
                    <span class="post-time small text-muted">27th August 2007 18:30 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                    <p class="post-content">InetLoad frequently crashes on Windows Vista while downloading from an FTP server. Did you test the Vista compatibility?</p>
                  </div>
                  <hr>

                  <div class="post">
                    <p class="post-meta"><span class="post-author text-primary">Takhir</span><br>
                    <span class="post-time small text-muted">27th August 2007 18:38 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                    <p class="post-content">I tested InetLoad on Vista. Do you know any addition requirements for NSIS plug-ins on this OS? And please attach test script if you can reproduce crash. Might be good to compare situation with Inetc that not includes 'crashable' NSISdl code fragment. Thanks.</p>
                  </div>
                  <hr>

                  <div class="post">
                    <p class="post-meta"><span class="post-author text-primary">MrBlunden</span><br>
                    <span class="post-time small text-muted">30th August 2007 08:38 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                    <p class="post-content">InetLoad is great!<br>
                    I have a problem though: I'm using InetLoad to post installation status to a server.<br>
                    <br>
                    When I call it before the first custom page (MUI) it makes the installer run in the background.<br>
                    <br>
                    This is really bad cause when a user downloads my installation and the installer doesn't go to the front of the page, the user wouldn't know it's running.<br>
                    <br>
                    Any way to solve this?</p>
                  </div>
                  <hr>

                  <div class="post">
                    <p class="post-meta"><span class="post-author text-primary">Takhir</span><br>
                    <span class="post-time small text-muted">30th August 2007 08:59 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                    <p class="post-content">If new process (installer) creates any window during a short period of time, OS gives this window focus and sets it foreground. In your situation window appear too late (silent http request delay from .oninit function?). If you don't want to use InetLoad popup/banner, use one of NSIS banner plug-ins to catch foreground position. You can also try to use SetForegroundWindow call to move installer foreground, but this is not efficient in most OSes (InetLoad do this in silent mode for some reasons), see example in the attached script how to do this.</p>
                  </div>
                  <hr>

                  <div class="post">
                    <p class="post-meta"><span class="post-author text-primary">MrBlunden</span><br>
                    <span class="post-time small text-muted">30th August 2007 09:06 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                    <p class="post-content">Takhir, thanks for you quick response.<br>
                    <br>
                    Tried your code - Now after the post the installer flickers (windows xp) on the taskbar. No way to make the posting not steal focus?</p>
                  </div>
                  <hr>

                  <div class="post">
                    <p class="post-meta"><span class="post-author text-primary">Takhir</span><br>
                    <span class="post-time small text-muted">30th August 2007 09:14 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                    <p class="post-content">The only good way I know is to create new window when process starts. Try to use InetLoad' own (/popup, /banner) or another banner.<br>
                    Yes, on XP and later SetForeground causes flickering only.</p>
                  </div>
                  <hr>

                  <div class="post">
                    <p class="post-meta"><span class="post-author text-primary">empezar</span><br>
                    <span class="post-time small text-muted">22nd October 2007 19:09 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                    <p class="post-content">would it be possible to get some speed information on the /banner window?<br>
                    <br>
                    i want to have customized download texts (i.e. not "downloading &lt;filename&gt;" but rather "downloading &lt;file description"), but /banner makes the download speed text go away :(</p>
                  </div>
                  <hr>

                  <div class="post">
                    <p class="post-meta"><span class="post-author text-primary">Takhir</span><br>
                    <span class="post-time small text-muted">29th October 2007 07:02 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                    <p class="post-content">Sorry, I am overloaded with urgent job, but for now you can create your version of plug-in with this output in the /banner window static field by copying code from /popup output timer function (C experience required).</p>
                  </div>
                  <hr>

                  <div class="post">
                    <p class="post-meta"><span class="post-author text-primary">{_trueparuex^}</span><br>
                    <span class="post-time small text-muted">23rd January 2008 15:44 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                    <p class="post-content">Small suggestion. Use the INTERNET_FLAG_NO_CACHE_WRITE flag in HttpOpenRequest() to disable writing in the IE cache. At the moment all downloaded files goes into to the cache as well.<br>
                    <br>
                    I tried this my self and it seems to work so far. :)</p>
                  </div>
                  <hr>

                  <div class="post">
                    <p class="post-meta"><span class="post-author text-primary">Takhir</span><br>
                    <span class="post-time small text-muted">25th January 2008 09:04 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                    <p class="post-content">Thanks! I'll add this to the next release.<br>
                    BTW I prepared an dcompilled but not tested Unicode (TCHAR) version (because not sure that NSIS Unicode package will not damage current ANSI version), so if anybody want to test it - please send me private message (it's in Account on the page top).</p>
                  </div>
                  <hr>

                  <div class="post">
                    <p class="post-meta"><span class="post-author text-primary">{_trueparuex^}</span><br>
                    <span class="post-time small text-muted">30th January 2008 16:06 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                    <p class="post-content"></p>

                    <blockquote>
                      <i>Originally posted by Takhir</i><br>
                      <b>Thanks! I'll add this to the next release.</b>
                    </blockquote>There seems to be a problem with the resume ability while INTERNET_FLAG_NO_CACHE_WRITE is used. The MSDN page for InternetSetFilePointer() function state that...<br>

                    <blockquote>
                      ...subsequent calls to InternetReadFile might block or return pending if the data is not available from the cache and the server does not support random access.
                    </blockquote>On my tests resume didnt work on any of the servers that I tried. Either those servers didn't support "random access" (whatever that means :weird: ) or resume won't work at all while INTERNET_FLAG_NO_CACHE_WRITE is used. So I think it's better leave the cache writing on while resume is used.
                  </div>
                  <hr>

                  <div class="post">
                    <p class="post-meta"><span class="post-author text-primary">{_trueparuex^}</span><br>
                    <span class="post-time small text-muted">9th February 2008 14:22 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                    <p class="post-content">:o From the InternetSetFilePointer() MSDN page "... This handle must not have been created with the INTERNET_FLAG_DONT_CACHE or INTERNET_FLAG_NO_CACHE_WRITE value set."<br>
                    <br>
                    So using INTERNET_FLAG_NO_CACHE_WRITE breaks the resume for sure.<br>
                    <br>
                    I realized that there's a small bug in the Inetc code. This statement is always true because InternetSetFilePointer() return type is DWORD.<br></p>
                    <pre>
<code>if(!InternetSetFilePointer(hFile, cnt, NULL, FILE_BEGIN, 0))</code>
</pre><br>
                    You should use something like this.<br>
                    <pre>
<code>if((int)InternetSetFilePointer(hFile, cnt, NULL, FILE_BEGIN, 0) == -1)</code>
</pre><br>
                    --<br>
                    <br>
                    The IE cache writing still bothered me so I made a little research for alternative methods and I found this article.<br>
                    <a href="http://www.clevercomponents.com/articles/article015/resuming.asp" target="_blank">http://www.clevercomponents.com/arti...5/resuming.asp</a><br>
                    <br>
                    I implemented the range request method described in there to Inetc code. It works without the cache, but probably isn't reliable as the InternetSetFilePointer() method.
                  </div>
                  <hr>

                  <div class="post">
                    <p class="post-meta"><span class="post-author text-primary">Takhir</span><br>
                    <span class="post-time small text-muted">9th February 2008 18:31 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                    <p class="post-content">Thank you very much {_trueparuex^}<br>
                    I updated both inetc &amp; inetload plug-ins. Also new feature in inetc: /question cancel_text (was requested <a href="http://forums.winamp.com/showthread.php?s=&amp;threadid=285817" target="_blank">here</a>)<br>
                    About no_cache_write using 'range request' - interesting idea for big files (like night movie downloads). Let's check reliability and if OK we'll add your code to inetc. Or you can write new multuthreaded super-fast downloader ;)</p>
                  </div>
                  <hr>

                  <div class="post">
                    <p class="post-meta"><span class="post-author text-primary">{_trueparuex^}</span><br>
                    <span class="post-time small text-muted">10th February 2008 00:22 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                    <p class="post-content"></p>

                    <blockquote>
                      <i>Originally posted by Takhir</i><br>
                      <b>Thank you very much {_trueparuex^}<br>
                      I updated both inetc &amp; inetload plug-ins. Also new feature in inetc: /question cancel_text (was requested <a href="http://forums.winamp.com/showthread.php?s=&amp;threadid=285817" target="_blank">here</a>)<br>
                      About no_cache_write using 'range request' - interesting idea for big files (like night movie downloads). Let's check reliability and if OK we'll add your code to inetc. Or you can write new multuthreaded super-fast downloader ;)</b>
                    </blockquote>No problem :)<br>
                    <br>
                    ...1500 megawatt Aperture Science heavy-duty super-threaded super loader. :eek: Seriously that's not a bad idea at all.<br>
                    <br>
                    <br>
                    At least there shouldn't any difference on what servers the resume methods work...<br>
                    <a href="http://support.microsoft.com/kb/168408" target="_blank">http://support.microsoft.com/kb/168408</a><br>
                    <br>
                    But InternetSetFilePointer() definitely is more flexible and handles exceptions way better.
                  </div>
                  <hr>

                  <div class="post">
                    <p class="post-meta"><span class="post-author text-primary">{_trueparuex^}</span><br>
                    <span class="post-time small text-muted">10th February 2008 00:24 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                    <p class="post-content">There was bug in the content length / accept ranges check in my last file. So here's a new one.</p>
                  </div>
                  <hr>

                  <div class="post">
                    <p class="post-meta"><span class="post-author text-primary">janekschwarz</span><br>
                    <span class="post-time small text-muted">15th February 2008 08:46 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                    <p class="post-content">I think there is a bug in inetc::put. When I try to upload a file, the http header content-length is always 0. Here's an example:<br>
                    <br>
                    ======= Start =======<br>
                    PUT / HTTP/1.1<br>
                    Content-Type: octet-stream<br>
                    Content-Length: 0<br>
                    User-Agent: NSIS_Inetc (Mozilla)<br>
                    Host: XXXXXXXX.de:8812<br>
                    Connection: Keep-Alive<br>
                    Cache-Control: no-cache<br>
                    <br>
                    line1<br>
                    line2<br>
                    ======= End =======<br>
                    <br>
                    In the NSIS script I use this line:<br>
                    <br>
                    inetc::put "http://docstore.interchange.de:8812/" "$EXEDIR\testfile" /END<br>
                    <br>
                    When I upload the file with curl (curl -T testfile http://XXXXXXXX.de:8812) everything works as expected:<br>
                    <br>
                    ======= Start =======<br>
                    PUT /testfile HTTP/1.1<br>
                    User-Agent: curl/7.16.3 (i686-pc-cygwin) libcurl/7.16.3 OpenSSL/0.9.8g zlib/1.2.3 libssh2/0.15-CVS<br>
                    Host: XXXXXXXX.de:8812<br>
                    Accept: */*<br>
                    Content-Length: 16<br>
                    Expect: 100-continue<br>
                    <br>
                    line1<br>
                    line2<br>
                    ======= End =======<br>
                    <br>
                    On XXXXXXXX.de:8812 runs netcat (nc -l -p 8812) which does nothing more than capturing everything that comes in on port 8812. Inetc and curl connect directly to the server (no proxies).<br>
                    <br>
                    <br>
                    Is this a know problem? Unfortunately, I don't have Visual Studio available, so I can't dive in the code myself. But I'd love to help debugging it on the server side if needed.</p>
                  </div>
                  <hr>

                  <div class="post">
                    <p class="post-meta"><span class="post-author text-primary">Takhir</span><br>
                    <span class="post-time small text-muted">15th February 2008 13:35 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                    <p class="post-content">Thanks, janekschwarz. Bug was added in the Jan. 30, 2007 revision. Fixed now, please update your files.</p>
                  </div>
                  <hr>

                  <div class="post">
                    <p class="post-meta"><span class="post-author text-primary">janekschwarz</span><br>
                    <span class="post-time small text-muted">15th February 2008 13:47 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                    <p class="post-content">Thank you for the quick answer. I'll download the new version and report back.</p>
                  </div>
                  <hr>

                  <div class="post">
                    <p class="post-meta"><span class="post-author text-primary">janekschwarz</span><br>
                    <span class="post-time small text-muted">18th February 2008 16:30 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                    <p class="post-content">Takhir, thanks again for the fix. It works.<br>
                    <br>
                    Another question: Does http authentication work with inetc::put? I tried something simple (http://user:passwd@XXXXXXXX.de/puttest/put.php) and always get an 401 error back. Curl authenticates successfully.</p>
                  </div>
                  <hr>

                  <div class="post">
                    <p class="post-meta"><span class="post-author text-primary">Takhir</span><br>
                    <span class="post-time small text-muted">19th February 2008 08:29 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                    <p class="post-content">Thanks, janekschwarz! I could reproduce this issue, probably this configuration was not tested earlier. Short googling gave me few similar questions, but no answers yet. Server accepts PUT request, receives file, but returns 401 in EndRequest() status header. Download from the same protected folder (.htaccess overridden) works correct. Any ideas?</p>
                  </div>
                  <hr>

                  <div class="post">
                    <p class="post-meta"><span class="post-author text-primary">janekschwarz</span><br>
                    <span class="post-time small text-muted">19th February 2008 10:51 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                    <p class="post-content">I did an experiment. Authentication works if I set the Authorization header my self:<br>
                    <br>
                    inetc::put /HEADER "Authorization: Basic PXVzZXI6cGFzc3dk" "http://XXXXXXXX.de/puttest/put.php" "$EXEDIR\testfile" /END<br>
                    <br>
                    Maybe the trick is to send the Authorization headers preemptively.</p>
                  </div>
                  <hr>

                  <div class="post">
                    <p class="post-meta"><span class="post-author text-primary">Takhir</span><br>
                    <span class="post-time small text-muted">19th February 2008 16:04 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                    <p class="post-content">And thank you again, janekschwarz!<br>
                    I tested patch (internal base64 login:passwd encoding) and it worked fine. When (and if) sourceforge will work again I'll put new zip to server.</p>
                  </div>
                  <hr>

                  <div class="post">
                    <p class="post-meta"><span class="post-author text-primary">janekschwarz</span><br>
                    <span class="post-time small text-muted">21st February 2008 09:13 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                    <p class="post-content">Hi, thank you for the fix.<br>
                    <br>
                    I hate to admit it, but I found another problem: inetc::put through an authenticating proxy does not work. It gives up right after receiving the 407 status code from the proxy and does not ask for proxy credentials (example.nsi contained in the zip file does, so it works in principle).<br>
                    <br>
                    Any ideas?</p>
                  </div>
                  <hr>

                  <div class="post">
                    <p class="post-meta"><span class="post-author text-primary">Takhir</span><br>
                    <span class="post-time small text-muted">22nd February 2008 08:06 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                    <p class="post-content"><strong>Unicode</strong><br>
                    I attached unicode version on inetc plug-in to this post - worked correct during my (short) testing. Wiki version has the same TCHAR decoration, so the only difference with archive code is path to exdll.h. I'll convert project to VS 2005 with additional Unicode configurations and put to wiki later (after some tests, and I hope you will help me). Version with log prints (for debugging) is temporary available here <a href="http://ineum.narod*****inetc.htm" target="_blank">http://ineum.narod*****inetc.htm</a><br>
                    Have fun :)</p>
                  </div>
                  <hr>

                  <div class="post">
                    <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br>
                    <span class="post-time small text-muted">24th March 2008 12:37 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                    <p class="post-content">By the way there is a slight issue when using inetc on the install files page. If you haven't clicked the show details button, then everything is fine (inetc disables it, fine). If however, you do click the show details button before downloading, inetc shows over the log window without hiding it.<br>
                    <br>
                    Be nice if this code could go in the plug-in but this is how to sort it in NSIS script:<br></p>
                    <pre>
<code><br>  !macro DownloadPre<br>    FindWindow $R0 `#32770` `` $HWNDPARENT<br>    GetDlgItem $R0 $R0 1016<br>    System::Call user32::IsWindowVisible(iR0)i.R1<br>    StrCmp $R1 0 +2<br>      ShowWindow $R0 ${SW_HIDE}<br>  !macroend<br>  !define DownloadPre `!insertmacro DownloadPre`<br><br>  !macro DownloadPost<br>    StrCmp $R1 0 +2<br>      ShowWindow $R0 ${SW_SHOW}<br>  !macroend<br>  !define DownloadPost `!insertmacro DownloadPost`<br><br>...<br><br>  ${DownloadPre}<br>  inetc::get ...<br>  ${DownloadPost}<br></code>
</pre><br>
                    Just make sure you don't touch the $R0 and $R1 variables between DownloadPre and DownloadPost.<br>
                    <br>
                    Stu
                  </div>
                  <hr>

                  <div class="post">
                    <p class="post-meta"><span class="post-author text-primary">Takhir</span><br>
                    <span class="post-time small text-muted">24th March 2008 13:06 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                    <p class="post-content">Thanks, Stu, I'll try to add this feature to next release. Is 1016 unique value for this page-control?<br>
                    This morning I uploaded inetc version with (I hope) finally fixed PUT issue if proxy or HTTP server authorization required (many thanks to janekschwarz). Problem was in proxy/server auth request that came back after all data were already sent (and progress bar reached right border). New version for HTTP PUT first tests connection using OPTIONS request. The only remaining 'difficult' situation is PUT to HTTPS if proxy/server authorization data to be requested from user (in password/login dialog) because OPTIONS request to HTTPS failed in my tests.<br>
                    <a href="http://nsis.sourceforge.net/Inetc_plug-in" target="_blank">http://nsis.sourceforge.net/Inetc_plug-in</a></p>
                  </div>
                  <hr>

                  <div class="post">
                    <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br>
                    <span class="post-time small text-muted">24th March 2008 14:51 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                    <p class="post-content">Yes it is the id for the list view control.<br>
                    <br>
                    Stu</p>
                  </div>
                  <hr>

                  <div class="post">
                    <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br>
                    <span class="post-time small text-muted">24th March 2008 20:55 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                    <p class="post-content">Also, is it just me or does it not re-enable the show details button?<br>
                    <br>
                    Stu</p>
                  </div>
                  <hr>

                  <div class="post">
                    <p class="post-meta"><span class="post-author text-primary">Takhir</span><br>
                    <span class="post-time small text-muted">25th March 2008 08:04 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                    <p class="post-content">Inetc restores original button style after transfer complited. May be nothing to 'show' in your sample? ;)</p>
                  </div>
                  <hr>

                  <div class="post">
                    <p class="post-meta"><span class="post-author text-primary">l0k1</span><br>
                    <span class="post-time small text-muted">3rd April 2008 15:28 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                    <p class="post-content">If i use Inetc plugin in .OnInit function, installer never gets focus when launched.<br>
                    Ex :<br>
                    <br></p>
                    <pre>
<code><br>    !include "MUI2.nsh"<br>    Name "test"<br>    OutFile "Install.exe"<br>    RequestExecutionLevel Admin<br><br>    !InsertMacro MUI_PAGE_License $(license)<br>    !InsertMacro MUI_PAGE_INSTFILES<br>    Function .onInit<br>     ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;<br>     <br>    HTTP:<br>        InetC::Get /SILENT "http://www.google.com" "$TEMP\bug.txt" /END<br>        Pop $0<br>        StrCmp $0 "OK" OK                                                                                <br>    ERR:<br>        messagebox mb_ok "Error : $0" <br>    OK: <br>                                                                                                                                                            <br>    FunctionEnd<br>    Section <br>    SectionEnd<br></code>
</pre><br>
                    <br>
                    Another problem with close button :<br>
                    <br>
                    I have a script with AutoClose = True and InetC command in .OnInstSuccess function<br>
                    <br>
                    If a user click on the button before the page desappears then the execution of the script jump to a random location (always the same though).<br>
                    <br>
                    Any help ?<br>
                    thx
                  </div>
                  <hr>

                  <div class="post">
                    <p class="post-meta"><span class="post-author text-primary">Takhir</span><br>
                    <span class="post-time small text-muted">3rd April 2008 15:52 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                    <p class="post-content">1. You can find related discussion on page 5 of this thread.<br>
                    2. Any plug-in require installer running, may not work when on the exit step, so it's not a good idea to run inetc in .OnInstSuccess.</p>
                  </div>
                  <hr>

                  <div class="post">
                    <p class="post-meta"><span class="post-author text-primary">Vytautas</span><br>
                    <span class="post-time small text-muted">30th April 2008 11:00 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                    <p class="post-content">Is this a bug or am i doing something wrong?<br>
                    <br>
                    I'm trying to download a file from https using authentication, the username dialog comes up fine and works as expected when wrong and right usernames are entered.<br>
                    <br>
                    However is one clicks cancel on that dialog, inetc downloads the http error report and sets status to OK. Is there a way to detect if/when this happens?<br>
                    <br>
                    Vytautas</p>
                  </div>
                  <hr>

                  <div class="post">
                    <p class="post-meta"><span class="post-author text-primary">Takhir</span><br>
                    <span class="post-time small text-muted">30th April 2008 12:54 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                    <p class="post-content">This is a bug. InternetErrorDlg() returns ERROR_SUCCESS 0 on Cancel click (I hoped this to be ERROR_CANCELLED 1223 as MSDN declares). Thanks, Vytautas, I'll put updated to server version as soon as sourceforge will be up (with 2 other small changes).</p>
                  </div>
                  <hr>

                  <div class="post">
                    <p class="post-meta"><span class="post-author text-primary">Vytautas</span><br>
                    <span class="post-time small text-muted">30th April 2008 23:50 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                    <p class="post-content">Thank you, thats much better now :)</p>
                  </div>
                  <hr>
                  
                  
                  

                  <div class="container">
                    

                    <ol class="breadcrumb">
                      <li><a href="../index.html" class="glyphicon glyphicon-home"></a></li>

                      <li><a href="f-65.html">NSIS Discussion</a></li>

                      <li class="active">http + ftp download plug-in</li>
                    </ol>

                    <p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=198596">http + ftp download plug-in</a></p><br>

                    <div class="post">
                      <p class="post-meta"><span class="post-author text-primary">Vytautas</span><br>
                      <span class="post-time small text-muted">1st May 2008 01:23 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                      <p class="post-content">OK, Found another issue, when authentication is used even if the correct info is provided it displays canceled first time, then when retrying to authenticate it works OK.<br>
                      <br>
                      here is the sample code used<br>
                      <br></p>
                      <pre>
<code>downloadcrmsi:<br>        StrCpy $CR_Install "$INSTDIR\CRRedist2005_x86.msi"<br>        inetc::get /NOCANCEL "https://xyz.com/CRRedist2005_x86.msi" "$INSTDIR\CRRedist2005_x86.msi"<br>    Pop $1<br>        Dumpstate::debug<br>        ${If} $1 == "OK"<br>          Goto installcr<br>        ${Else}<br>          MessageBox MB_RETRYCANCEL "Download Failed!" IDRETRY downloadcrmsi<br>          Abort "Crystal Reports Runtime 10.2 Download Failed"<br>        ${EndIf}</code>
</pre><br>
                      as can be seen even when correct login is specified i get a download failed box come up, when retry is pressed it connect straight away without asking for authentication
                    </div>
                    <hr>

                    <div class="post">
                      <p class="post-meta"><span class="post-author text-primary">jiake</span><br>
                      <span class="post-time small text-muted">2nd May 2008 07:45 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                      <p class="post-content">If it better that if the plugins may support multilanguage. I'm Chinese, some plugins provide a header file to define multilanguge, some not. If all plugins support multilanguage, that is better.</p>
                    </div>
                    <hr>

                    <div class="post">
                      <p class="post-meta"><span class="post-author text-primary">Takhir</span><br>
                      <span class="post-time small text-muted">4th May 2008 07:42 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                      <p class="post-content">Vytautas: thanks again! I hope this is fixed now..<br>
                      jiake: yes, this would be better, but for now you can use /TRANSLATE option for /POPUP and NSISdl mode, /BANNER mode also has text parameters. Use LangString if you want to support few langs in your installer.</p>
                    </div>
                    <hr>

                    <div class="post">
                      <p class="post-meta"><span class="post-author text-primary">Vytautas</span><br>
                      <span class="post-time small text-muted">4th May 2008 08:43 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                      <p class="post-content">Thank you Takhir, that indeed seems to have fixed this problem.</p>
                    </div>
                    <hr>

                    <div class="post">
                      <p class="post-meta"><span class="post-author text-primary">{_trueparuex^}</span><br>
                      <span class="post-time small text-muted">10th May 2008 14:26 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                      <p class="post-content">Currently all 3xx errors are treated as redirection. You should add and exception for "304 not modified" status. Users may send "If-None-Match" or "If-Modified-Since" header to check if the file has changed on the server. :)</p>
                    </div>
                    <hr>

                    <div class="post">
                      <p class="post-meta"><span class="post-author text-primary">pengyou</span><br>
                      <span class="post-time small text-muted">20th May 2008 12:13 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                      <p class="post-content">I use Inetc's /RESUME option to display a message when Inetc is unable to download a file. This is useful for users who are still using dial-up connections.<br>
                      <br>
                      This /RESUME feature no longer works properly. If there is no connection to the internet the plugin now creates an empty file and does not return the "SendRequest Error". My installer then tries to use the empty file and fails because the file is zero bytes long.<br>
                      <br>
                      The Inetc plugin dated 1 April 2008 is OK - if there is no connection to the internet it returns the "SendRequest Error".<br>
                      <br>
                      The Inetc plugins dated 30 April, 4 May and 20 May 2008 do not return the "SendRequest Error" if the internet connection is down.</p>
                    </div>
                    <hr>

                    <div class="post">
                      <p class="post-meta"><span class="post-author text-primary">Takhir</span><br>
                      <span class="post-time small text-muted">20th May 2008 12:26 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                      <p class="post-content">Not reproduces. I unplugged LAN cable (ethernet) and resume popup appears as expected. Exit status is SendRequestError.</p>
                      <pre>
<code>Inetc::get /RESUME "" "http://kolobok/sfu_3.exe" "$EXEDIR\sfu.exe"<br>"$EXEDIR\u.jpg"<br>Pop $0<br>MessageBox MB_OK "Download Status: $0"</code>
</pre>May 20 version.
                    </div>
                    <hr>

                    <div class="post">
                      <p class="post-meta"><span class="post-author text-primary">pengyou</span><br>
                      <span class="post-time small text-muted">22nd May 2008 12:58 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                      <p class="post-content">The new Inetc plugin, dated 21 May 2008, fixes the problem so my installer now works properly.<br>
                      <br>
                      Thank you for fixing this problem so quickly.</p>
                    </div>
                    <hr>

                    <div class="post">
                      <p class="post-meta"><span class="post-author text-primary">daisywheel</span><br>
                      <span class="post-time small text-muted">12th July 2008 18:55 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                      <p class="post-content"><strong>/SILENT doesn't work</strong><br>
                      Hi,<br>
                      <br>
                      Take a look at code below.<br></p>
                      <pre>
<code><br>Name "test"<br>OutFile "test.exe"<br><br>;SilentInstall silent<br><br>!define UpdateConfigFile "update.ini"<br>!define UpdateURL "http://www.daisywheel.kiev.ua" ;<br><br><br>;---------------------------------------------------------------------------------<br>; Sections<br>;---------------------------------------------------------------------------------<br>Section<br><br>loop:<br><br>        MessageBox MB_OK "hi!"<br>        <br>    InetLoad::load /SILENT "${UpdateURL}/${UpdateConfigFile}" "$TEMP\${UpdateConfigFile}" <br>    ;InetLoad::load "${UpdateURL}/${UpdateConfigFile}" "$TEMP\${UpdateConfigFile}" <br>    Pop $0<br>    MessageBox MB_OK $0<br>    <br>    StrCmp $0 "OK" 0 loop<br>        <br><br>SectionEnd <br></code>
</pre><br>
                      <br>
                      When I add /SILENT to InetLoad::load call I get not "OK" response but "connecting" and file is not loaded.<br>
                      <br>
                      Is it a bug or do I misinterpret something?<br>
                      <br>
                      tnx,<br>
                      Roman
                    </div>
                    <hr>

                    <div class="post">
                      <p class="post-meta"><span class="post-author text-primary">Takhir</span><br>
                      <span class="post-time small text-muted">14th July 2008 07:40 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                      <p class="post-content">Please not /silent option description:<br>
                      [/SILENT TEXT2DISPLAY]<br>
                      SILENT<br>
                      Key hides plug-in' output (both popup dialog and embedded progress bar). Sets TEXT2DISPLAY to 1006 control, if /silent "" - displays "InetLoad plug-in" default. Not required if 'SilentInstall silent' mode was defined in script (NSIS 2.03 option).</p>
                    </div>
                    <hr>

                    <div class="post">
                      <p class="post-meta"><span class="post-author text-primary">********</span><br>
                      <span class="post-time small text-muted">29th August 2008 15:25 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                      <p class="post-content">Very nice POPUP dialog. I wonder if it is possible to embed it somehow into main window?</p>
                    </div>
                    <hr>

                    <div class="post">
                      <p class="post-meta"><span class="post-author text-primary">Takhir</span><br>
                      <span class="post-time small text-muted">1st September 2008 07:22 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                      <p class="post-content">This is NOT implemented in current version. But if you know C, you can change parent window for POPUP here</p>
                      <pre>
<code>if((hDlg = CreateDialog(g_hInstance,<br>MAKEINTRESOURCE(szBanner ? IDD_DIALOG2 : (popup ? IDD_DIALOG1 : IDD_DIALOG3)),<br>(popup ? hwndParent : childwnd), dlgProc)) != NULL)</code>
</pre>to
                      <pre>
<code>if((hDlg = CreateDialog(g_hInstance,<br>MAKEINTRESOURCE(szBanner ? IDD_DIALOG2 : (popup ? IDD_DIALOG1 : IDD_DIALOG3)),<br>(szBanner ? hwndParent : childwnd), dlgProc)) != NULL)</code>
</pre>and to change POPUP dialog properties to 'child' and 'no frame'. May be some other small changes require. After this plug-in shuld work with embedded POPUP window. ;)
                    </div>
                    <hr>

                    <div class="post">
                      <p class="post-meta"><span class="post-author text-primary">********</span><br>
                      <span class="post-time small text-muted">1st September 2008 11:32 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                      <p class="post-content">Thanks, but I'll better stick to official version. =)<br>
                      <br>
                      This /POPUP option caused some unpleasant moments with upgrading an old installer. New obligatory /POPUP parameter caused downloads to fail with "URL Parts Error" after the upgrade. New parameter was omitted in old installers and new inetc still consumed the following option as an argument making the command wrong.<br>
                      <br>
                      Now if /POPUP "" is specified, the URL field in popup window is empty while it should be not according to docs. I tested this on bundled Example.nsi Can anybody confirm?<br>
                      <br>
                      BTW, it would be nice to have this URL clickable or copyable for diagnosis of download problems.<br>
                      <br>
                      P.S. To track the issue the whole inetc history was recreated at Launchpad. <a href="https://code.launchpad.net/~techtonik/+junk/inetc" target="_blank">https://code.launchpad.net/~techtonik/+junk/inetc</a></p>
                    </div>
                    <hr>

                    <div class="post">
                      <p class="post-meta"><span class="post-author text-primary">Takhir</span><br>
                      <span class="post-time small text-muted">1st September 2008 13:51 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                      <p class="post-content">Thanks, ********, I updated <a href="http://nsis.sourceforge.net/File:Inetc.zip" target="_blank">inetc.zip</a>, now it displays URL if "". This was lost at least half of year ago :(<br>
                      To make URL copyable I should change control type from 'static' to 'edit'. To keep GUI integrity this should be done for all controls on this dialog, tested... New option required for 'clickable' URL.. So.. good idea, may be with next big changes :)<br>
                      I agree, parameters changes (/POPUP with text value) is not good for support, but this happen sometimes...</p>
                    </div>
                    <hr>

                    <div class="post">
                      <p class="post-meta"><span class="post-author text-primary">xbarns</span><br>
                      <span class="post-time small text-muted">11th September 2008 21:23 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                      <p class="post-content">I am trying to get your example_unicode.nsi to work with the NSIS 2.38.-1 Unicode, but it does not work :(<br>
                      <br>
                      I am using your original example_unicode.nsi from the latest .zip.<br>
                      <br>
                      The details window says<br>
                      <br>
                      Download Status: å‰•âŒæ…ç‘²â³ç‰…æ½²r, å‰•âŒæ…ç‘²â³ç‰…æ½²r, å‰•âŒæ…ç‘²â³ç‰…æ½²r<br>
                      Completed</p>
                    </div>
                    <hr>

                    <div class="post">
                      <p class="post-meta"><span class="post-author text-primary">vbplayr2000</span><br>
                      <span class="post-time small text-muted">7th October 2008 22:03 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                      <p class="post-content"><strong>"Download failed: OK" is result of script.</strong><br>
                      I'm close to getting this implemented, but I keep running into a roadblock at the point at which I need to download the file and write it to the TEMP directory. The script successfully creates the 'receiving' file (jre-6u7-win...exe) that the stream is to be written to, but I am lost as to what happens after that.<br>
                      <br>
                      The error message I see is "Download failed: OK"<br>
                      <br>
                      Here is the snippet of code where it fails:<br>
                      <br>
                      &lt;code&gt; DownloadJRE:<br>
                      ; Call ElevateToAdmin<br>
                      MessageBox MB_ICONINFORMATION "${PRODUCT_NAME} uses Java Runtime Environment ${JRE_VERSION}, it will now be downloaded and installed."<br>
                      StrCpy $2 "$TEMP\jre-6u7-windows-i586-p.exe"<br>
                      inetc::get /PROXY www-proxy.boeing.com:31060 /TIMEOUT=30000 ${JRE_URL} $2 /END<br>
                      ;InetLoad::load /POPUP "JRE downloading..." /TIMEOUT=30000 ${JRE_URL} $2 /END<br>
                      ;nsisdl::download /TIMEOUT=30000 ${JRE_URL} $2<br>
                      Pop $R0 ;Get the return value<br>
                      StrCmp $R0 "Download successful." +3<br>
                      MessageBox MB_ICONSTOP "Download failed: $R0"<br>
                      Abort<br>
                      ExecWait $2<br>
                      Delete $2<br>
                      <br>
                      ReadRegStr $R1 HKLM "SOFTWARE\JavaSoft\Java Runtime Environment" "CurrentVersion"<br>
                      ReadRegStr $R0 HKLM "SOFTWARE\JavaSoft\Java Runtime Environment\$R1" "JavaHome"<br>
                      StrCpy $R0 "$R0\bin\${JAVAEXE}"<br>
                      IfFileExists $R0 0 GoodLuck<br>
                      Call CheckJREVersion<br>
                      IfErrors GoodLuck JreFound<br>
                      <br>
                      ; 4) wishing you good luck<br>
                      GoodLuck:<br>
                      StrCpy $R0 "${JAVAEXE}"<br>
                      ; MessageBox MB_ICONSTOP "Cannot find appropriate Java Runtime Environment."<br>
                      ; Abort &lt;/code&gt;<br>
                      <br>
                      Thank you for any assistance you can provide.</p>
                    </div>
                    <hr>

                    <div class="post">
                      <p class="post-meta"><span class="post-author text-primary">Takhir</span><br>
                      <span class="post-time small text-muted">8th October 2008 13:01 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                      <p class="post-content">StrCmp $R0 OK +3</p>
                    </div>
                    <hr>

                    <div class="post">
                      <p class="post-meta"><span class="post-author text-primary">Ivan Andreevich</span><br>
                      <span class="post-time small text-muted">4th November 2008 01:22 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                      <p class="post-content">Privet<br>
                      <br>
                      I am downloading a 150 MB file. Everything works amazingly well in Windows XP, but it fails miserably in Windows Vista.<br>
                      <br>
                      My code:<br>
                      RequestExecutionLevel admin<br>
                      InetLoad::load /POPUP " " "http://url.com/file.exe" "$INSTDIR\file.exe"<br>
                      <br>
                      Any ideas?</p>
                    </div>
                    <hr>

                    <div class="post">
                      <p class="post-meta"><span class="post-author text-primary">Takhir</span><br>
                      <span class="post-time small text-muted">5th November 2008 17:51 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                      <p class="post-content">Vista Home Premium with updates, Kaspersky Internet Security 2009, 69 MB file download from Apache 2.2</p>
                      <pre>
<code>Name "InetClient Test"<br>OutFile "inetc.exe"<br>RequestExecutionLevel admin<br><br>!include "MUI.nsh"<br>!insertmacro MUI_PAGE_WELCOME<br>!insertmacro MUI_PAGE_INSTFILES<br>!insertmacro MUI_LANGUAGE "English"<br><br>Section "Dummy Section" SecDummy<br><br>    SetDetailsView hide<br>    inetc::get /popup " " "http://localhost/css/ltrm2_wwefg_win.exe" "$EXEDIR\light_room.exe" /end<br>    Pop $0<br>    MessageBox MB_OK "Download Status: $0"<br><br>SectionEnd</code>
</pre>works_for_me. NSIS 2.40 exe 1.5 MB download from sourceforge.net is OK too. May be this is your Vista security limitations?
                    </div>
                    <hr>

                    <div class="post">
                      <p class="post-meta"><span class="post-author text-primary">Ivan Andreevich</span><br>
                      <span class="post-time small text-muted">5th November 2008 19:31 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                      <p class="post-content">I was confused as I was using InetLoad and you are supporting inetc here :) Can you add a note that inetc is a more up to date version than InetLoad on the InetLoad wiki? I wouldn't have used it in the first place.<br>
                      <br>
                      I have made some custom modifications to the C code, and it seems that it's some of those that break under Vista for one reason or another. I tested the vanilla version, and there is no problem, so you can disregard my previous message altogether.</p>
                    </div>
                    <hr>

                    <div class="post">
                      <p class="post-meta"><span class="post-author text-primary">xbarns</span><br>
                      <span class="post-time small text-muted">1st December 2008 14:29 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                      <p class="post-content">Hi,<br>
                      <br>
                      as i wrote above i cannot get it to work with a NSIS Unicode Build (2.38-1) any Ideas on this? I am building the inetc.exe with the "example_unicode.nsi" from the Zip.<br>
                      <br>
                      Does anyone else get this to run?<br>
                      <br>
                      Thanks.</p>
                    </div>
                    <hr>

                    <div class="post">
                      <p class="post-meta"><span class="post-author text-primary">Takhir</span><br>
                      <span class="post-time small text-muted">1st December 2008 16:47 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                      <p class="post-content">Last time I've built and included inetcu.dll to Wiki package in February 2008... Attached version was created from latest (Sept. 1, 2008) sources. Unfortunatelly on new comp I have not NSIS Unicode installed, so attached Unicode plug-in variant is not tested...</p>
                    </div>
                    <hr>

                    <div class="post">
                      <p class="post-meta"><span class="post-author text-primary">xbarns</span><br>
                      <span class="post-time small text-muted">1st December 2008 17:25 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                      <p class="post-content">Works like a charm, thanks a lot :)</p>
                    </div>
                    <hr>

                    <div class="post">
                      <p class="post-meta"><span class="post-author text-primary">zxn</span><br>
                      <span class="post-time small text-muted">15th January 2009 12:50 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                      <p class="post-content">Does plugin support FTP-over-HTTP proxy servers?<br>
                      <br>
                      Thanks a lot</p>
                    </div>
                    <hr>

                    <div class="post">
                      <p class="post-meta"><span class="post-author text-primary">Takhir</span><br>
                      <span class="post-time small text-muted">16th January 2009 07:50 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                      <p class="post-content"></p>

                      <blockquote>
                        Does plugin support FTP-over-HTTP proxy servers?
                      </blockquote>Not worked in my test (Connection Error). Plugin should use IE proxy settings by default, but I also tested manual proxy settings - not helps. Windows XP CLI ftp client not worked as well. Browsers are OK, so probably WinInet.dll has less ftp functionality then IE or Mozilla.
                    </div>
                    <hr>

                    <div class="post">
                      <p class="post-meta"><span class="post-author text-primary">redxii</span><br>
                      <span class="post-time small text-muted">19th January 2009 08:39 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                      <p class="post-content">I tested with Windows 7 and IE8 w/ XP SP3 and at least inetc::get worked fine.<br>
                      <br>
                      Just thought I'd report.</p>
                    </div>
                    <hr>

                    <div class="post">
                      <p class="post-meta"><span class="post-author text-primary">gudy</span><br>
                      <span class="post-time small text-muted">5th June 2009 03:16 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                      <p class="post-content">when used in the .onInit function, inetc prevents the main installer window from being shown in the forefront.<br>
                      <br>
                      I guess that this is because you create a dialog, even when the /silent option is passed, and that dialog must become the forefront one (even when displayed as SW_HIDE), and then when the installer shows its dialog, it can't bring it to front.<br>
                      <br>
                      Any way this could get fixed?</p>
                    </div>
                    <hr>

                    <div class="post">
                      <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br>
                      <span class="post-time small text-muted">18th June 2009 19:19 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                      <p class="post-content">Just found an interesting problem using this plugin on a machine. I am still doing tests but here's the situation:<br>
                      <br>
                      Running the installer in the place of userinit.exe (meaning it runs before userinit.exe is executed and therefore before explorer.exe).<br>
                      <br>
                      The plugin downloads the Adobe Flash Player ActiveX plugin for Internet Explorer. It gets to 100% and then the installer freezes. Soon after this the entire machine freezes, first being the task bar followed by the desktop and then any other programs running (for example, LogMeIn also stops functioning).<br>
                      <br>
                      Hopefully it is this machine that is the problem, but either way do you see any possible reasons for this?<br>
                      <br>
                      Edit: It was happening during silent install as well but I have only found it is the plugin by running in non silent mode - or rather I assume it is the plugin as it still shows the downloading progress bar at 100%.<br>
                      <br>
                      Stu</p>
                    </div>
                    <hr>

                    <div class="post">
                      <p class="post-meta"><span class="post-author text-primary">Takhir</span><br>
                      <span class="post-time small text-muted">19th June 2009 11:26 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                      <p class="post-content">gudy: thanks, but this is very long story of attempts to keep installer foreground in such situations. BTW the same problem has place with few other plug-ins. I can test fixes if you have ideas. Might be good to have solution for both silent and not silent modes.<br>
                      Afrow: I am not realy understand when plug-in was running. If we are talking about calling this dll from Windows service (i.e. from SESSION, not from Desktop) - I never tested ths mode. I only can say that task bar and desktop are Windows Explorer subsystems, they freezes when Explorer is (almost) died.</p>
                    </div>
                    <hr>

                    <div class="post">
                      <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br>
                      <span class="post-time small text-muted">20th June 2009 16:41 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                      <p class="post-content">It appears to be a problem with the machine so sorry about that!<br>
                      <br>
                      Stu</p>
                    </div>
                    <hr>

                    <div class="post">
                      <p class="post-meta"><span class="post-author text-primary">nachoesmith</span><br>
                      <span class="post-time small text-muted">16th July 2009 14:22 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                      <p class="post-content">Hi there,<br>
                      <br>
                      Do you have any experience with checking the hostname inside the CN field of a server certificate?<br>
                      <br>
                      One of the checks that I need to have is that the server name inside the certificate ends in the correct domain. Of course, this would be in addition to the checks that wininet would do for you, which is that the name of the server connected to is the same as that in the CN field of the cert from the server, and that the cert is issued by a trusted authority.<br>
                      <br>
                      I'm guessing that the easiest way to do this is to probably call InternetQueryOption just after InternetConnect, with the parameter INTERNET_OPTION_SECURITY_CERTIFICATE_STRUCT , which would return a INTERNET_CERTIFICATE_INFO struct. The lpszSubjectInfo member should contain the information I need, once I figure out how to tear it apart. What do you think?<br>
                      <br>
                      I was thinking that the domain that I'd be checking for would be passed in as a parameter.<br>
                      <br>
                      What would be the process for having this submitted back to you so that it could be included in the standard release?</p>
                    </div>
                    <hr>

                    <div class="post">
                      <p class="post-meta"><span class="post-author text-primary">Takhir</span><br>
                      <span class="post-time small text-muted">16th July 2009 19:15 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                      <p class="post-content">This is first request for server certificate fields verification, IMHO no sence to overload plug-in with seldom used features. But you can create your own version of plug-in with this feature and even add it to NSIS wiki ;)</p>
                    </div>
                    <hr>

                    <div class="post">
                      <p class="post-meta"><span class="post-author text-primary">spidercc</span><br>
                      <span class="post-time small text-muted">26th August 2009 10:58 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                      <p class="post-content">Hi,<br>
                      <br>
                      is there a way, or will there be a way, to start the download in async. mode.<br>
                      <br>
                      Right now, i copy wget and start it async. with ExecDos,<br>
                      but using InetLoad would look much better.</p>
                    </div>
                    <hr>

                    <div class="post">
                      <p class="post-meta"><span class="post-author text-primary">Takhir</span><br>
                      <span class="post-time small text-muted">26th August 2009 12:27 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                      <p class="post-content">Right now - no :(.</p>
                    </div>
                    <hr>

                    <div class="post">
                      <p class="post-meta"><span class="post-author text-primary">redxii</span><br>
                      <span class="post-time small text-muted">5th October 2009 21:13 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                      <p class="post-content">Is there an updated unicode build, you can probably include both call the unicode one 'inetcu.dll' or something.</p>
                    </div>
                    <hr>

                    <div class="post">
                      <p class="post-meta"><span class="post-author text-primary">garygumdrops</span><br>
                      <span class="post-time small text-muted">23rd November 2009 20:09 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                      <p class="post-content"><strong>McAfee trojan alert for inetload.dll</strong><br>
                      Has anyone else had any problems with McAfee Virus scanning whining about the Inetload DLL having a 'generic!bg.hpk' virus?<br>
                      It's deleted my inetload.dll and broke my build but has been working for ages up until now. Perhaps McAfee has updated the virus definitions and only picked up on this today.</p>
                    </div>
                    <hr>

                    <div class="post">
                      <p class="post-meta"><span class="post-author text-primary">MSG</span><br>
                      <span class="post-time small text-muted">24th November 2009 09:41 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                      <p class="post-content">garygumdrops: There are many posts about such problems. Search before you post, please.</p>
                    </div>
                    <hr>

                    <div class="post">
                      <p class="post-meta"><span class="post-author text-primary">stb</span><br>
                      <span class="post-time small text-muted">24th November 2009 13:35 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                      <p class="post-content">Please report false positives: <a href="http://www.mcafee.com/us/threat_center/dispute/dispute_form.asp" target="_blank">http://www.mcafee.com/us/threat_cent...spute_form.asp</a><br>
                      <br>
                      Look at: <a href="http://nsis.sourceforge.net/NSIS_False_Positives" target="_blank">http://nsis.sourceforge.net/NSIS_False_Positives</a></p>
                    </div>
                    <hr>

                    <div class="post">
                      <p class="post-meta"><span class="post-author text-primary">morty3</span><br>
                      <span class="post-time small text-muted">1st December 2009 22:56 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                      <p class="post-content"><strong>Downloading JDK</strong><br>
                      Hi all,<br>
                      <br>
                      I have some troubles downloading JRE and JDK from Sun's homepage.<br>
                      <br>
                      I simply use the following code:<br>
                      <br></p>
                      <pre>
<code><br>inetc::get  $0 "$TEMP\Setup.exe" /END<br>Pop $0 # return value = exit code, "OK" if OK<br>DetailPrint "Download result = $0"<br></code>
</pre><br>
                      <br>
                      where $0 contains the url.<br>
                      <br>
                      Now this only works with the JRE online installer[1], trying to download JRE offline[2] or JDK offline[3] installer does the following:<br>
                      The download finishes in just a couple of seconds (although the files aren't that small), exit code is "OK", but the download is obviously not complete.<br>
                      If I add the /POPUP option, I get a Connection Error.<br>
                      <br>
                      Can anybody reproduce this and think of an sulotion?<br>
                      <br>
                      I really like the plugin, please kept up that good work!<br>
                      <br>
                      Thanks in advance,<br>
                      morty<br>
                      <br>
                      Um, how do I add URL correctly?<br>
                      <br>
                      [1] <a href="http://javadl.sun.com/webapps/download/AutoDL?BundleId=33787" target="_blank">JRE online</a><br>
                      [2] <a href="ttp://cds.sun.com/is-bin/INTERSHOP.enfinity/WFS/CDS-CDS_Developer-Site/en_US/-/USD/VerifyItem-Start/jre-6u17-windows-i586.exe?BundledLineItemUUID=CvJIBe.l2KQAAAEl.4MJakvE&amp;OrderID=JudIBe.l2b0AAAEl5YMJakvE&amp;ProductID=AnJIBe.nksgAAAEk.dlUGm0.&amp;FileName=/jre-6u17-windows-i586.exe" target="_blank">JRE offline</a><br>
                      <br>
                      [3] <a href="https://cds.sun.com/is-bin/INTERSHOP.enfinity/WFS/CDS-CDS_Developer-Site/en_US/-/USD/VerifyItem-Start?BundledLineItemUUID=nklIBe.lLXYAAAElx9UJakvG&amp;OrderID=KzlIBe.lPJwAAAElvdUJakvG&amp;ProductID=C5JIBe.oOF4AAAEkIuhn5G0y&amp;FileName=/jdk-6u17-windows-i586.exe" target="_blank">JDK offline</a>
                    </div>
                    <hr>

                    <div class="post">
                      <p class="post-meta"><span class="post-author text-primary">Takhir</span><br>
                      <span class="post-time small text-muted">2nd December 2009 07:04 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                      <p class="post-content"><strong>Re: Downloading JDK</strong><br>
                      I tested following script with first of your URLs <a href="http://javadl.sun.com/webapps/download/AutoDL?BundleId=33787" target="_blank">http://javadl.sun.com/webapps/downlo...BundleId=33787</a><br>
                      <br></p>
                      <pre>
<code>Name "InetClient GET Test"<br>OutFile "get.exe"<br><br>  !include "MUI.nsh"<br>  !define MUI_ICON "${NSISDIR}\Contrib\Graphics\Icons\modern-install-colorful.ico"<br>  !insertmacro MUI_PAGE_WELCOME<br>  !insertmacro MUI_PAGE_INSTFILES<br>  !insertmacro MUI_LANGUAGE "English"<br><br>Section "Dummy Section" SecDummy<br><br>    SetDetailsView hide<br><br>; single file, NSISdl-style embedded progress bar with specific cancel button text<br>    inetc::get /canceltext "interrupt!" "http://javadl.sun.com/webapps/download/AutoDL?BundleId=33787" "$EXEDIR\jre.exe" /end<br>    Pop $1<br><br>    MessageBox MB_OK "Download Status: $1"<br>SectionEnd<br><br><br>;--------------------------------<br>;Installer Functions<br><br>Function .onInit<br><br>FunctionEnd</code>
</pre>and found 698kB file as a result. When started this exe displays JRE installation window (see attachment).<br>
                      Please check /POPUP mandatory parameters in your script.
                    </div>
                    <hr>
                    
                    
                    

                    <div class="container">
                      

                      <ol class="breadcrumb">
                        <li><a href="../index.html" class="glyphicon glyphicon-home"></a></li>

                        <li><a href="f-65.html">NSIS Discussion</a></li>

                        <li class="active">http + ftp download plug-in</li>
                      </ol>

                      <p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=198596">http + ftp download plug-in</a></p><br>

                      <div class="post">
                        <p class="post-meta"><span class="post-author text-primary">morty3</span><br>
                        <span class="post-time small text-muted">2nd December 2009 07:23 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                        <p class="post-content">Hi Takhir,<br>
                        <br>
                        thanks for the quick reply. The first URL works with my script too, it is the second and third URL that don't work.</p>
                      </div>
                      <hr>

                      <div class="post">
                        <p class="post-meta"><span class="post-author text-primary">Takhir</span><br>
                        <span class="post-time small text-muted">2nd December 2009 07:33 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                        <p class="post-content">Sorry :)<br>
                        Please test last link (https) in a browser - my Mozilla displays "Download Java SE Development Kit 6u17 for Solaris x86, Multi-language" page, not exe. The same I get from inetc - 28 kB file, when renamed it is viewable in borwser as well.</p>
                      </div>
                      <hr>

                      <div class="post">
                        <p class="post-meta"><span class="post-author text-primary">StephanB86</span><br>
                        <span class="post-time small text-muted">3rd December 2009 08:04 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                        <p class="post-content">Still got some problems using ftp::put<br>
                        <br>
                        When using:<br>
                        <b>Works:</b><br>
                        inetc::put /CAPTION "service pack upload" "ftp://user:pass@192.168.0.150:8021/5mb.bin" "c:\Dell\5mb.bin"<br>
                        <br>
                        <b>Fails:</b><br>
                        inetc::put /CAPTION "service pack upload" "ftp://user:pass@192.168.0.150:8021/Application/5mb.bin" "c:\Dell\5mb.bin"<br>
                        <br>
                        The only difference is the Directory on the FTP server. The directory exists. What else should I use?</p>
                      </div>
                      <hr>

                      <div class="post">
                        <p class="post-meta"><span class="post-author text-primary">Takhir</span><br>
                        <span class="post-time small text-muted">3rd December 2009 12:33 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                        <p class="post-content">Please note that most of ftp servers work with paths relative to logged user home dir.</p>
                      </div>
                      <hr>

                      <div class="post">
                        <p class="post-meta"><span class="post-author text-primary">StephanB86</span><br>
                        <span class="post-time small text-muted">3rd December 2009 12:48 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                        <p class="post-content">I know. But logging on with any other FTP client is placed in to root. Local FTP server that's running on a device with WinCE. For testing purposes it's running localy.<br>
                        By running the working version it's placed in the root correctly. And I'm really sure that the directory exists :)</p>
                      </div>
                      <hr>

                      <div class="post">
                        <p class="post-meta"><span class="post-author text-primary">Takhir</span><br>
                        <span class="post-time small text-muted">3rd December 2009 12:53 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                        <p class="post-content">To be sure it goes to FS root (if permitted) you can use host//path</p>
                      </div>
                      <hr>

                      <div class="post">
                        <p class="post-meta"><span class="post-author text-primary">StephanB86</span><br>
                        <span class="post-time small text-muted">3rd December 2009 13:07 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                        <p class="post-content">That does the trick! Thanks a lot!</p>
                      </div>
                      <hr>

                      <div class="post">
                        <p class="post-meta"><span class="post-author text-primary">StephanB86</span><br>
                        <span class="post-time small text-muted">4th December 2009 10:34 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                        <p class="post-content">Creating dirs ain't possible with this?</p>
                      </div>
                      <hr>

                      <div class="post">
                        <p class="post-meta"><span class="post-author text-primary">Takhir</span><br>
                        <span class="post-time small text-muted">4th December 2009 16:40 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                        <p class="post-content">It should. If current user has permissions.</p>
                      </div>
                      <hr>

                      <div class="post">
                        <p class="post-meta"><span class="post-author text-primary">StephanB86</span><br>
                        <span class="post-time small text-muted">7th December 2009 07:53 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                        <p class="post-content">Current user gots al the permissions he need. I get the Reget error. Any example?<br>
                        Or just like:<br>
                        inetc::put /CAPTION "service pack upload" "ftp://user:pass@192.168.0.150:8021//Application/NewDir/5mb.bin" "c:\Dell\5mb.bin"</p>
                      </div>
                      <hr>

                      <div class="post">
                        <p class="post-meta"><span class="post-author text-primary">Takhir</span><br>
                        <span class="post-time small text-muted">7th December 2009 17:12 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                        <p class="post-content">This work for me</p>
                        <pre>
<code><br>;--------------------------------<br>; General Attributes<br><br>Name "Inetc ftp mkdir Test"<br>OutFile "ftp_mkdir.exe"<br><br><br>;--------------------------------<br>;Interface Settings<br><br>!include "MUI.nsh"<br>!define MUI_ICON "${NSISDIR}\Contrib\Graphics\Icons\modern-install-colorful.ico"<br>!insertmacro MUI_PAGE_INSTFILES<br>!insertmacro MUI_LANGUAGE "English"<br><br><br>;--------------------------------<br>;Installer Sections<br><br>Section "Dummy Section" SecDummy<br><br>; use your own URL and login@pwd. Password hidden from user with /popup "ALIAS"<br><br>    inetc::put /caption "service pack upload" /popup "" "ftp://takhir:somepwd@localhost/subdir/inetc.dll" "$EXEDIR\inetc.dll"<br>    Pop $0<br>    MessageBox MB_OK "Upload Status: $0"<br><br>SectionEnd</code>
</pre><br>
                        Sorry, CLI output is in Russian, but it is not difficult to understand
                        <pre>
<code>&gt;dir /S /W<br> Ð¢Ð¾Ð¼ Ð² ÑƒÑÑ‚Ñ€Ð¾Ð¹ÑÑ‚Ð²Ðµ C Ð¸Ð¼ÐµÐµÑ‚ Ð¼ÐµÑ‚ÐºÑƒ OS<br> Ð¡Ð¾Ð´ÐµÑ€Ð¶Ð¸Ð¼Ð¾Ðµ Ð¿Ð°Ð¿ÐºÐ¸ C:\Users\takhir\Documents\wftpd\shared<br>[.]      [..]     [subdir]<br>               0 Ñ„Ð°Ð¹Ð»Ð¾Ð²              0 Ð±Ð°Ð¹Ñ‚<br> Ð¡Ð¾Ð´ÐµÑ€Ð¶Ð¸Ð¼Ð¾Ðµ Ð¿Ð°Ð¿ÐºÐ¸ C:\Users\takhir\Documents\wftpd\shared\subdir<br>[.]         [..]        inetc.dll<br>               1 Ñ„Ð°Ð¹Ð»Ð¾Ð²         20_480 Ð±Ð°Ð¹Ñ‚<br>     Ð’ÑÐµÐ³Ð¾ Ñ„Ð°Ð¹Ð»Ð¾Ð²:<br>               1 Ñ„Ð°Ð¹Ð»Ð¾Ð²         20_480 Ð±Ð°Ð¹Ñ‚<br>               5 Ð¿Ð°Ð¿Ð¾Ðº  130_276_462_592 Ð±Ð°Ð¹Ñ‚ ÑÐ²Ð¾Ð±Ð¾Ð´Ð½Ð¾</code>
</pre>
                      </div>
                      <hr>

                      <div class="post">
                        <p class="post-meta"><span class="post-author text-primary">StephanB86</span><br>
                        <span class="post-time small text-muted">8th December 2009 08:31 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                        <p class="post-content">It's not working for me. User got the permission to read/edit/create/execute.<br></p>
                        <pre>
<code><br>    inetc::put /caption "service pack upload" /popup "" "ftp://myuser:mypass@192.168.0.150:8021//Application/Test//inetc.dll" "C:\DELL\5mb.bin"<br>    Pop $0<br>    MessageBox MB_OK "Upload Status: $0"<br></code>
</pre><br>
                        Returns: Upload Status: Reget Error<br>
                        <br>
                        *For testing I created a 5mb.bin*<br>
                        <br>
                        With CLI and ftp open it's possible. Also tried several attempts using extra slashes.
                      </div>
                      <hr>

                      <div class="post">
                        <p class="post-meta"><span class="post-author text-primary">skuallpa</span><br>
                        <span class="post-time small text-muted">2nd February 2010 08:50 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                        <p class="post-content">Hello,<br>
                        <br>
                        I have a problem with the unicode build of inetc. I am trying to send post values to a script on my website.<br>
                        <br>
                        This is my command line:<br>
                        <br></p>
                        <pre>
<code>inetc::post "t=i&amp;v=2" /SILENT /TIMEOUT 2500 "https://www.mywebsite.com/myscript.php"  "$TEMP\BD-827364682984.txt" /END</code>
</pre><br>
                        <br>
                        Bot nothing is send, as if the connexion could not be established.<br>
                        <br>
                        Thanks in advance for your help
                      </div>
                      <hr>

                      <div class="post">
                        <p class="post-meta"><span class="post-author text-primary">Takhir</span><br>
                        <span class="post-time small text-muted">2nd February 2010 16:18 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                        <p class="post-content">I see one bug in code for UNICODE - POST message size should be defined in bytes, not in characters. But probably content-type header should be also changed to</p>
                        <pre>
<code>Content-Type: text/html; charset=utf-16</code>
</pre>Or this should be 16LE ?<br>
                        BTW does ANSI version works with your request?
                      </div>
                      <hr>

                      <div class="post">
                        <p class="post-meta"><span class="post-author text-primary">Takhir</span><br>
                        <span class="post-time small text-muted">4th February 2010 16:47 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                        <p class="post-content">Idea to send Unicode string in http body is very attractive, but my experiments with Unicode POSTs were dissapointing. An it looks like browser sends form data as multibyte even if form was downloaded in page with utf encoding. So I just added body string convertion to multibyte, this worked in my tests. Please test attached dll.</p>
                      </div>
                      <hr>

                      <div class="post">
                        <p class="post-meta"><span class="post-author text-primary">skuallpa</span><br>
                        <span class="post-time small text-muted">5th February 2010 08:07 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                        <p class="post-content">Hello Takhir,<br>
                        <br>
                        I have just tested the dll that you have attached and all work well. The problem is corrected (post values are sent correctly)<br>
                        <br>
                        Thanks a lot for your work!<br>
                        <br>
                        Regards</p>
                      </div>
                      <hr>

                      <div class="post">
                        <p class="post-meta"><span class="post-author text-primary">robod</span><br>
                        <span class="post-time small text-muted">25th February 2010 09:26 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                        <p class="post-content">Zdravstvuj Takhir :-),<br>
                        <br>
                        I'm wondering if you could help me with this.<br>
                        <br>
                        I've got a php script which allows me to upload a file (just a normal HTML form with upload). I'd like to post data to that script and upload a file.<br>
                        <br>
                        So, the question is - is it possible to use inetc::post to upload a file?<br>
                        I guess I can use the TEXT2POST field, but I would have to MIME encode the file as a text and I'm worried that it will not be long enough.<br>
                        <br>
                        If it's not possible, have you (or anyone else) got a better idea how to do it? Alternatively, would you be able to enhance inetc, so it's possible?<br>
                        <br>
                        I can't use put as it's a IIS server and I can't enable webdav (to allow put).<br>
                        <br>
                        Thanks,<br>
                        <br>
                        Rob</p>
                      </div>
                      <hr>

                      <div class="post">
                        <p class="post-meta"><span class="post-author text-primary">Takhir</span><br>
                        <span class="post-time small text-muted">25th February 2010 16:17 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                        <p class="post-content">I don't have ready solution for this :( Code sample may help, but I am not sure if I'll can find time for big changes in plug-in right now. I found one MS code sample, but it not sends file name to server while for normal (html form) uploads I can easy get file name in php...</p>
                      </div>
                      <hr>

                      <div class="post">
                        <p class="post-meta"><span class="post-author text-primary">SinusPi</span><br>
                        <span class="post-time small text-muted">2nd March 2010 19:09 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                        <p class="post-content">I added the capability of using files as POST data, so as not to be limited by the NSIS variable size.<br>
                        <br>
                        Usage: /FILE "filename" among inetc::post options. The 'content' parameter still needed, so it amounts to<br>
                        inetc::post "blah" /FILE "filename" .....<br>
                        <br>
                        Attached: source file with the modification, and a .dll with it compiled in. Non-Unicode, I somehow couldn't get those settings to compile, but didn't have time to figure it out at all.</p>
                      </div>
                      <hr>

                      <div class="post">
                        <p class="post-meta"><span class="post-author text-primary">Takhir</span><br>
                        <span class="post-time small text-muted">3rd March 2010 10:38 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                        <p class="post-content">I like simple solutions ;)<br>
                        Few minor improvements and testing required, but idea looks good. Inet samples use HttpSendRequestEx() and InternetWriteFile(), but your approach may work as well - need to test this at least on 1MB files. And IMHO some corrections required: POST body size should be file size, not strlen() in this case (jpeg file may have a lot of zeroes); additional error handling for file IO required (part of file may be locked... in theory :) ); first parameter may be used as file name, /FILE option this case will be without parameter. And may be good to think about MIME-encoding of file to be sent, and about content headers like <i>Content-Disposition: form-data; name="ImageData"; filename="somefile.jpg" Content-Type: image/jpeg</i> - this sends file name I wrote above (sample from <a href="http://pics.livejournal.com/doc/protocol/tut.data.simple.bml" target="_blank">http://pics.livejournal.com/doc/prot...ata.simple.bml</a> ).<br>
                        But any case this looks good, thanks for your help, SinusPi!</p>
                      </div>
                      <hr>

                      <div class="post">
                        <p class="post-meta"><span class="post-author text-primary">robod</span><br>
                        <span class="post-time small text-muted">12th March 2010 11:13 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                        <p class="post-content">Hi there,<br>
                        <br>
                        Not sure if it helps, but here is how can this be implemented. The example is using python and wget, but shows the necessary steps that are involved in posting a file:<br>
                        <a href="http://www.noah.org/wiki/WGET_CGI_Post" target="_blank">http://www.noah.org/wiki/WGET_CGI_Post</a><br>
                        (<a href="http://www.noah.org/wiki/WGET_CGI_Post" target="_blank">www.noah.org/wiki/WGET_CGI_Post</a>)<br>
                        <br>
                        And this is what the post request looks like when uploading a file in FireFox:<br>
                        <br>
                        Content-Type: multipart/form-data; boundary=---------------------------188752843329869<br>
                        Content-Length: 76298<br>
                        <br>
                        -----------------------------188752843329869<br>
                        Content-Disposition: form-data; name="file"; filename="HttpAnalysisPluginSP14.zip"<br>
                        Content-Type: application/x-zip-compressed<br>
                        <br>
                        &lt;The base64 encoded data go here&gt;<br>
                        <br>
                        -----------------------------188752843329869<br>
                        Content-Disposition: form-data; name="submit" Submit<br>
                        -----------------------------188752843329869--</p>
                      </div>
                      <hr>

                      <div class="post">
                        <p class="post-meta"><span class="post-author text-primary">Wizou</span><br>
                        <span class="post-time small text-muted">13th April 2010 15:10 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                        <p class="post-content">Hello..<br>
                        I need also to use the POST request with /FILE support (to skip NSIS string limitations)<br>
                        Where can we get this updated version of inetc?<br>
                        Is it available yet?<br>
                        <br>
                        BTW, thanks for the plugin :)<br>
                        <br>
                        Olivier</p>
                      </div>
                      <hr>

                      <div class="post">
                        <p class="post-meta"><span class="post-author text-primary">robbertdam</span><br>
                        <span class="post-time small text-muted">11th May 2010 14:15 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                        <p class="post-content"><strong>Download fails</strong><br>
                        Hi, great plugin. I use it in my installer to download &amp; install the .NET framework when it is not yet installed. It works perfect 99% of the time.<br>
                        <br>
                        However, once in a while a customer calls that it does not work. When they retry it does work. I'm not entirely sure but the problems seems to occus when my installer is executed immediately from Firefox. I've tried to reproduce it on a virtual machine, and it occurs exactly one time. After that it keeps working fine.<br>
                        <br>
                        Is this a known issue? If not, I'm happy to help to debug this issue. Is there a way to get logs or anything?<br>
                        <br>
                        Thanks,<br>
                        Robbert Dam</p>
                      </div>
                      <hr>

                      <div class="post">
                        <p class="post-meta"><span class="post-author text-primary">Takhir</span><br>
                        <span class="post-time small text-muted">14th July 2010 18:56 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                        <p class="post-content">/FILE option now available in inetc. This is not classic file post implementation, but this work and file content is available as http input. File name (tail of TEXT2POST parameter) added to HTTP headers as Filename: header. Samples included into new package. Please test before using ;).<br>
                        Also please note new sample on wiki page <a href="http://nsis.sourceforge.net/Inetc_plug-in" target="_blank">http://nsis.sourceforge.net/Inetc_plug-in</a> from Edward Marshall &amp; Jonathan Beddoes - how to restore installer window after silent calls from .onGUIInit</p>
                      </div>
                      <hr>

                      <div class="post">
                        <p class="post-meta"><span class="post-author text-primary">Wizou</span><br>
                        <span class="post-time small text-muted">15th July 2010 02:04 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                        <p class="post-content">Thanks for the addition, Takhir! We will check that out and get back to you if any problem..</p>
                      </div>
                      <hr>

                      <div class="post">
                        <p class="post-meta"><span class="post-author text-primary">punkomat</span><br>
                        <span class="post-time small text-muted">14th September 2010 08:36 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                        <p class="post-content"><strong>Progress bar size</strong><br>
                        How can I make the download progress bar have the same size with the global installer progress bar ? (I'm using MUI)<br>
                        Now it's kind of goofy looking:<br>
                        <br>
                        <a href="http://img259.imageshack.us/img259/3368/45369592.png" target="_blank">http://img259.imageshack.us/img259/3368/45369592.png</a></p>
                      </div>
                      <hr>

                      <div class="post">
                        <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br>
                        <span class="post-time small text-muted">14th September 2010 10:19 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                        <p class="post-content">You'll need to modify the plug-in.<br>
                        <br>
                        Stu</p>
                      </div>
                      <hr>

                      <div class="post">
                        <p class="post-meta"><span class="post-author text-primary">punkomat</span><br>
                        <span class="post-time small text-muted">14th September 2010 11:08 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                        <p class="post-content">Thanks, I took your suggestion. If anyone needs this, just modify inetc.rc and rebuild:<br>
                        <br></p>
                        <pre>
<code>IDD_DIALOG3 DIALOG DISCARDABLE  0, 0, <font color="red">300</font>, 62<br>STYLE DS_CONTROL | WS_CHILD | WS_VISIBLE<br>FONT 8, "MS Sans Serif"<br>BEGIN<br>    CONTROL         "Progress1",IDC_PROGRESS1,"msctls_progress32",0x0,0,23,<br>                    <font color="red">300</font>,11<br>    CTEXT           "",IDC_STATIC1,0,8,266,11<br>    PUSHBUTTON      "Cancel",IDCANCEL,<font color="red">213</font>,41,80,16<br>END</code>
</pre><br>
                        <br>
                        When recompiling with a newer Visual Studio, make sure you link against libcmt.lib and not msvcrt.lib as by default, otherwise you will require msvcrXY.dll at runtime depending on your VS version. The statically linked plugin is a tad larger, but works everywhere.
                      </div>
                      <hr>

                      <div class="post">
                        <p class="post-meta"><span class="post-author text-primary">Animaether</span><br>
                        <span class="post-time small text-muted">14th September 2010 11:24 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                        <p class="post-content">Probably better if the plugin conformed to the UI at hand.. I'm guessing your adjustments would break its working with a Classic interface (or UMUI, XPUI, etc.) / other font sizes (inherent dialog unit&lt;&gt;pixel changes.. original plugin suffers from this as well).<br>
                        <br>
                        I used the WndSubClass plugin to handle some of that.. lot more trouble than it's worth, though ;)</p>
                      </div>
                      <hr>

                      <div class="post">
                        <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br>
                        <span class="post-time small text-muted">14th September 2010 11:47 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                        <p class="post-content">@punkomat: also make sure you tell VS not to embed a manifest otherwise (I believe) the CRT dependency remains.<br>
                        @Animaether: that mod should work fine because it's in dialog units not pixels.<br>
                        <br>
                        Stu</p>
                      </div>
                      <hr>

                      <div class="post">
                        <p class="post-meta"><span class="post-author text-primary">Animaether</span><br>
                        <span class="post-time small text-muted">14th September 2010 12:15 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                        <p class="post-content">Doesn't it presume the parent dialog being 300 units wide, though?</p>
                      </div>
                      <hr>

                      <div class="post">
                        <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br>
                        <span class="post-time small text-muted">14th September 2010 12:40 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                        <p class="post-content">Ah sorry yes that is true.<br>
                        <br>
                        Stu</p>
                      </div>
                      <hr>

                      <div class="post">
                        <p class="post-meta"><span class="post-author text-primary">sevenalive</span><br>
                        <span class="post-time small text-muted">20th December 2010 06:59 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                        <p class="post-content"><strong>Url parts error</strong><br>
                        I have a weird error using this plugin: I get a Url Parts error when downloading a certain file. The other files are fine, I tried deleting and reuploading the file, I tried a different file with same filename, so it's a url issue. It only occurs on XP (which I test in a VM). On my native Win7 OS, it works fine.<br>
                        <br></p>
                        <pre>
<code>  !insertmacro DownloadFile "http://sevenupdate.com/apps/SevenUpdate/SevenUpdate.Helper.exe" "$INSTDIR\SevenUpdate.Helper.exe"</code>
</pre><br>
                        <br>
                        Here is my complete script: <a href="http://code.google.com/p/sevenupdate/source/browse/Installer/SevenUpdate.nsi" target="_blank">http://code.google.com/p/sevenupdate...evenUpdate.nsi</a>
                      </div>
                      <hr>

                      <div class="post">
                        <p class="post-meta"><span class="post-author text-primary">Takhir</span><br>
                        <span class="post-time small text-muted">20th December 2010 10:58 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                        <p class="post-content">may be too many quotas? what about inetc::get ${SOURCE} ${DEST} /END ?<br>
                        Also options should stay before url/file pairs inetc::get /TIMEOUT=30000 /NOPROXY "${SOURCE}" "${DEST}" /END</p>
                      </div>
                      <hr>

                      <div class="post">
                        <p class="post-meta"><span class="post-author text-primary">rhlobo</span><br>
                        <span class="post-time small text-muted">20th December 2010 17:45 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                        <p class="post-content"><strong>Url Parts error</strong><br></p>

                        <blockquote>
                          <small>Originally posted by sevenalive</small><br>
                          I have a weird error using this plugin: I get a Url Parts error when downloading a certain file. The other files are fine, I tried deleting and reuploading the file, I tried a different file with same filename, so it's a url issue. It only occurs on XP (which I test in a VM). On my native Win7 OS, it works fine.
                        </blockquote>I am having a similar issue. Did you found out the origin of the problem??
                      </div>
                      <hr>

                      <div class="post">
                        <p class="post-meta"><span class="post-author text-primary">sevenalive</span><br>
                        <span class="post-time small text-muted">21st December 2010 00:51 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                        <p class="post-content">No not yet, I am sure it's related to the plugin and XP because Win7 it works fine. Also I already tried moving the params before the urls, gives me File Open Error instead.</p>
                      </div>
                      <hr>

                      <div class="post">
                        <p class="post-meta"><span class="post-author text-primary">Takhir</span><br>
                        <span class="post-time small text-muted">21st December 2010 07:49 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                        <p class="post-content">Verify that your "$INSTDIR exists when you start download to this folder.</p>
                      </div>
                      <hr>

                      <div class="post">
                        <p class="post-meta"><span class="post-author text-primary">bsmith1</span><br>
                        <span class="post-time small text-muted">28th January 2011 16:39 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                        <p class="post-content"><strong>/BANNER with SilentInstall</strong><br>
                        Hello,<br>
                        <br>
                        I use NSIS to run a Java program, so I run it in SilentInstall.<br>
                        However, before it runs, I check if java.exe is present, if not I download the JRE using Inetc::get.<br>
                        <br>
                        My issue is that in "SilentInstall silent" mode, the /BANNER or /POPUP do not show the downloading progress windows.<br>
                        I know this was done on purpose since it is supposed to be "silent", however is there an option or a way to implement that the progress windows shows up, like a /NOSILENT option?<br>
                        <br>
                        That would be great!<br>
                        Thanks</p>
                      </div>
                      <hr>

                      <div class="post">
                        <p class="post-meta"><span class="post-author text-primary">Wizou</span><br>
                        <span class="post-time small text-muted">28th January 2011 23:59 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                        <p class="post-content"></p>

                        <blockquote>
                          <small>Originally posted by bsmith1</small><br>
                          Hello,<br>
                          <br>
                          I use NSIS to run a Java program, so I run it in SilentInstall.<br>
                          However, before it runs, I check if java.exe is present, if not I download the JRE using Inetc::get.<br>
                          <br>
                          My issue is that in "SilentInstall silent" mode, the /BANNER or /POPUP do not show the downloading progress windows.<br>
                          I know this was done on purpose since it is supposed to be "silent", however is there an option or a way to implement that the progress windows shows up, like a /NOSILENT option?<br>
                          <br>
                          That would be great!<br>
                          Thanks
                        </blockquote>You could embed in your silent NSIS launcher another not-silent NSIS installer that would take care of the download part.
                      </div>
                      <hr>

                      <div class="post">
                        <p class="post-meta"><span class="post-author text-primary">bsmith1</span><br>
                        <span class="post-time small text-muted">30th January 2011 11:34 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                        <p class="post-content"></p>

                        <blockquote>
                          <small>Originally posted by Wizou</small><br>
                          You could embed in your silent NSIS launcher another not-silent NSIS installer that would take care of the download part.
                        </blockquote>Thank you Wizou for this workaround. I will give it a try.<br>
                        <br>
                        Cheers
                      </div>
                      <hr>
                      
                      
                      

                      <div class="container">
                        

                        <ol class="breadcrumb">
                          <li><a href="../index.html" class="glyphicon glyphicon-home"></a></li>

                          <li><a href="f-65.html">NSIS Discussion</a></li>

                          <li class="active">http + ftp download plug-in</li>
                        </ol>

                        <p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=198596">http + ftp download plug-in</a></p><br>

                        <div class="post">
                          <p class="post-meta"><span class="post-author text-primary">Takhir</span><br>
                          <span class="post-time small text-muted">30th January 2011 12:52 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                          <p class="post-content"></p>

                          <blockquote>
                            <small>Originally posted by bsmith1</small><br>
                            I know this was done on purpose since it is supposed to be "silent", however is there an option or a way to implement that the progress windows shows up, like a /NOSILENT option?
                          </blockquote>Yes, this is possible to implement, I even tested 'small' changes and found that for installer with /S dialog appears in the center of screen. Looks a bit ugly for silent install, IMHO would be better to move it to the right bottom corner. Or to left top. May be /NOSILENT /POSITION X:Y (percents, pixels?). So we need to understant a full set of options for this feature. Code update for this may take time (and I need to find this time in my schedule :( ).
                        </div>
                        <hr>

                        <div class="post">
                          <p class="post-meta"><span class="post-author text-primary">Necku</span><br>
                          <span class="post-time small text-muted">14th February 2011 01:14 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                          <p class="post-content">/RESUME seems buggy for me.<br>
                          <br>
                          If I enable it without the extra text parameter then the download errors with "connecting". If I add the extra text, then I properly get a pop up, however clicking retry seems to do nothing and the pop up just comes up over and again and the download never resumes, when clicking cancel I get "reget error". Any idea on what could be going on ?<br>
                          <br>
                          -Using win7 64bit<br>
                          -compiled non unicode script<br>
                          -file is in direct download and support resuming (through firefox or download manager)<br>
                          -no other options used for inetc<br>
                          -tried disabling device or unplugging cable gives same result<br>
                          <br>
                          Help appreciated!</p>
                        </div>
                        <hr>

                        <div class="post">
                          <p class="post-meta"><span class="post-author text-primary">Takhir</span><br>
                          <span class="post-time small text-muted">14th February 2011 11:51 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                          <p class="post-content">/RESUME RETRY_QUESTION - parameter is mandatory. On error during download plug-in asks you what to do - continue download or fail with rising some error (reget error in this case). If network cable still disconnected, Resume popup will appears again. Normal behavior is to restore connection (where is my VPN! :) ) and press Resume button after this only.</p>
                        </div>
                        <hr>

                        <div class="post">
                          <p class="post-meta"><span class="post-author text-primary">Necku</span><br>
                          <span class="post-time small text-muted">14th February 2011 13:40 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                          <p class="post-content">Thanks for the reply Takhir!<br>
                          <br>
                          For the parameter: yes I was confused by the existence of a default value. Seeking for example I figured it was used if you use an empty string "" as parameter, problem solved.<br>
                          <br>
                          However for the pop up, this is exactly my issue, the plugin seems to fail to detect my connection is available again. i.e. after plugging the cable back in and even if internet works perfectly, the pop up with retry/cancel error will keep showing up, refusing to restore the download.</p>
                        </div>
                        <hr>

                        <div class="post">
                          <p class="post-meta"><span class="post-author text-primary">Necku</span><br>
                          <span class="post-time small text-muted">14th February 2011 18:01 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                          <p class="post-content">Looks like I owe you an apology. Your files work perfectly. As the history page show (<a href="http://nsis.sourceforge.net/File:Inetc.zip" target="_blank">http://nsis.sourceforge.net/File:Inetc.zip</a>) someone else applied modifications on your plugin which caused the bug, using the last version uploaded by yourself (16:04, 13 July 2010) works perfectly. I don't know why/who modified it but you might want to revert it.<br>
                          <br>
                          Thanks for your awesome work :)</p>
                        </div>
                        <hr>

                        <div class="post">
                          <p class="post-meta"><span class="post-author text-primary">Takhir</span><br>
                          <span class="post-time small text-muted">14th February 2011 18:04 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                          <p class="post-content">Sorry, after reading code :) : Reget error for http means that InternetSetFilePointer() failed with (REST for ftp). So connection itself was already established, but server could not continue download from this position. Dynamic content names, unknown file size in reply, server functionality limitations - what else? Could you reproduce this on another server? On static content/file?</p>
                        </div>
                        <hr>

                        <div class="post">
                          <p class="post-meta"><span class="post-author text-primary">Takhir</span><br>
                          <span class="post-time small text-muted">14th February 2011 18:25 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                          <p class="post-content">Thanks, Necku, presisely, JohnTHaller added 2 flags "for cleanliness", but "This handle must not have been created with the INTERNET_FLAG_DONT_CACHE or INTERNET_FLAG_NO_CACHE_WRITE value set." Main idea from the very beginning was to add reget support. But I'll think a little is this a bug or feature :). May be well need to rollback inetc version.</p>
                        </div>
                        <hr>

                        <div class="post">
                          <p class="post-meta"><span class="post-author text-primary">Necku</span><br>
                          <span class="post-time small text-muted">14th February 2011 18:31 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                          <p class="post-content">You're welcome, I'm happy as long as it works :D<br>
                          <br>
                          On a side note I'll pm you the URL I used for tests so you can see by yourself :)</p>
                        </div>
                        <hr>

                        <div class="post">
                          <p class="post-meta"><span class="post-author text-primary">Takhir</span><br>
                          <span class="post-time small text-muted">14th February 2011 19:02 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                          <p class="post-content">Unfortunatelly I cannot login to sourceforge now (server internal error), so I am attaching patched version here for the moment. New flags will be used if resume option not set only. Necku, if you will have time, please test this ;)</p>
                        </div>
                        <hr>

                        <div class="post">
                          <p class="post-meta"><span class="post-author text-primary">Necku</span><br>
                          <span class="post-time small text-muted">14th February 2011 19:59 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                          <p class="post-content"></p>

                          <blockquote>
                            <small>Originally posted by Takhir</small><br>
                            Unfortunatelly I cannot login to sourceforge now (server internal error), so I am attaching patched version here for the moment. New flags will be used if resume option not set only. Necku, if you will have time, please test this ;)
                          </blockquote>Works like a charm :)
                        </div>
                        <hr>

                        <div class="post">
                          <p class="post-meta"><span class="post-author text-primary">cole2k</span><br>
                          <span class="post-time small text-muted">25th February 2011 16:06 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                          <p class="post-content">First I'd like to say thanks for the plugin, it looks to be exactly what I've been looking for.<br>
                          <br>
                          I am having a small issue with inetc::get it works for the most part, but on my server logs it's showing as POST instead of GET.<br>
                          <br>
                          The version I'm using is the one you posted above on the 14th.<br>
                          <br>
                          Example:<br>
                          <br>
                          Section "Dummy Section" SecDummy<br>
                          inetc::get /USERAGENT "Some Browser" \<br>
                          "http://somesite.com/somepage.html" "$EXEDIR\somepage.html"<br>
                          Pop $0<br>
                          MessageBox MB_OK "Download Status: $0"<br>
                          SectionEnd</p>
                        </div>
                        <hr>

                        <div class="post">
                          <p class="post-meta"><span class="post-author text-primary">Takhir</span><br>
                          <span class="post-time small text-muted">25th February 2011 17:02 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                          <p class="post-content">I re-tested 2 last versions and in apache logs I see:<br>
                          127.0.0.1 - - [25/Feb/2011:19:45:35 +0300] "GET /aut_1986.htm HTTP/1.1" 200 17952<br>
                          127.0.0.1 - - [25/Feb/2011:19:55:11 +0300] "GET /aut_1986.htm HTTP/1.1" 200 17952<br>
                          for the following script:<br>
                          inetc::get /useragent "Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 5.1)" "http://localhost/aut_1986.htm" "$EXEDIR\aut.html" /end<br>
                          In code I see 3 situations where POST may have place: 1) inetc::post(); 2) /file ; 3) /NOUNLOAD in previous POST request. Any other ideas?<br>
                          <br>
                          Latest release is here <a href="http://nsis.sourceforge.net/File:Inetc.zip" target="_blank">http://nsis.sourceforge.net/File:Inetc.zip</a></p>
                        </div>
                        <hr>

                        <div class="post">
                          <p class="post-meta"><span class="post-author text-primary">cole2k</span><br>
                          <span class="post-time small text-muted">25th February 2011 18:13 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                          <p class="post-content">Thanks Takhir,<br>
                          I've tried your example with the latest version and it works fine. My problem appears to be with the agent string I've been trying to use.<br>
                          <br>
                          Works fine:<br>
                          Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 5.1)<br>
                          <br>
                          Causes POST:<br>
                          Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 6.1; WOW64; Trident/4.0; SLCC2; .NET CLR 2.0.50727; .NET CLR 3.5.30729; .NET CLR 3.0.30729; Media Center PC 6.0; .NET4.0C; .NET CLR 1.1.4322; InfoPath.2)</p>
                        </div>
                        <hr>

                        <div class="post">
                          <p class="post-meta"><span class="post-author text-primary">Takhir</span><br>
                          <span class="post-time small text-muted">26th February 2011 06:50 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                          <p class="post-content">You are right, cole2k, string size limit 128 chars in current version for user agent. Most of strings in inetc allocated dynamically with size 1k or 8k depending on NSIS build, but not user agent. Most of servers support at least 8kB fields. I'll fix this in next release.</p>
                        </div>
                        <hr>

                        <div class="post">
                          <p class="post-meta"><span class="post-author text-primary">yyv</span><br>
                          <span class="post-time small text-muted">30th March 2011 14:53 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                          <p class="post-content"><strong>/resume</strong><br>
                          Dear sirs,<br>
                          I’m trying to use your plugin with parameter/RESUME<br>
                          Everything seems to work normally.<br>
                          We started downloading, then disconnected the network cable, downloading broke and a message requesting to resume/cancel the downloading appeared. We connected the cable, clicked “resume” and downloading continued.<br>
                          But actually, there is no real downloading. The plugin downloads everything from the start till the moment of break and then continues downloading.<br>
                          For example, I’m downloading a 600 mb file.<br>
                          When 200 mb are downloaded, I disconnect the network and then connect it.<br>
                          The downloading process seems to continue but the progress bar doesn’t move ahead.<br>
                          Once the plugin downloads those 200 mb once again he continues the further download.<br>
                          Is this the way the plugin operates or is it an error?<br>
                          What can we do to resume the downloading from the point of downloading break?<br>
                          Thank you.</p>
                        </div>
                        <hr>

                        <div class="post">
                          <p class="post-meta"><span class="post-author text-primary">klopfdreh</span><br>
                          <span class="post-time small text-muted">4th April 2011 15:17 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                          <p class="post-content">Hello,<br>
                          <br>
                          first of all thanks a lot for that great plugin!<br>
                          <br>
                          I saw that there is a new release with this resume flag and I tried it by myself. I've the same issue as yyv.<br>
                          <br>
                          In addition to that there are sometimes errors while downloading files that are bigger in size while there is kaspersky running on that client. The antivirus scanner trys to check the complete file after download and then the inetc.dll is running into a timeout which is not regarding due to an issue of the connection. This problem appears on several systems - windows xp / vista / 7.<br>
                          <br>
                          Any ideas?<br>
                          <br>
                          Thanks a lot again and hopefully we will se a lot of updates to this plugin in feature!</p>
                        </div>
                        <hr>

                        <div class="post">
                          <p class="post-meta"><span class="post-author text-primary">Takhir</span><br>
                          <span class="post-time small text-muted">4th April 2011 18:24 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                          <p class="post-content">I prepared small patch for reget feature, but we still have this problem on nginx server (apache is OK), so please wait few days.<br>
                          No ideas about virus protection....</p>
                        </div>
                        <hr>

                        <div class="post">
                          <p class="post-meta"><span class="post-author text-primary">klopfdreh</span><br>
                          <span class="post-time small text-muted">5th April 2011 07:04 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                          <p class="post-content">@Takhir - what I also found out so far about the "kaspersky issue" is that downloads of the same files in browsers also take for about ~30 seconds till they are finished. During this time the progress bar and the percentage info stucks on 99%,too.<br>
                          <br>
                          The delay until the Internet Explorer throws an error is much later then of inetc.dll. Maybe it is regarding how the WinInet lib is used of both (please correct me if I'm wrong).<br>
                          <br>
                          What I have tried so far is to reset the browser settings. Reference to microsoft answer: <a href="http://answers.microsoft.com/en-us/ie/forum/ie8-windows_other/downloads-stuck-at-99/4e280fdd-7ff5-4a45-8e1d-1c2e972b886b" target="_blank">Download stucks at 99% Solution</a> - still the same issue.<br>
                          <br>
                          Is there a delay not regarding an connection timeout that can be configured till the download will be aborted?<br>
                          <br>
                          Thanks a lot again for your fast answer!</p>
                        </div>
                        <hr>

                        <div class="post">
                          <p class="post-meta"><span class="post-author text-primary">klopfdreh</span><br>
                          <span class="post-time small text-muted">5th April 2011 11:05 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                          <p class="post-content">I looked into your source code and there are a lot of other TIMEOUT settings that can be applied to "hinternet" - and in the past, some of them, weren't implemented.<br>
                          <br>
                          InternetSetOption(hSession, INTERNET_OPTION_SEND_TIMEOUT, &amp;timeout, sizeof(DWORD));<br>
                          InternetSetOption(hSession, INTERNET_OPTION_DATA_SEND_TIMEOUT, &amp;timeout,<br>
                          sizeof(DWORD));<br>
                          InternetSetOption(hSession, INTERNET_OPTION_RECEIVE_TIMEOUT, &amp;timeout,<br>
                          sizeof(DWORD));<br>
                          InternetSetOption(hSession, INTERNET_OPTION_DATA_RECEIVE_TIMEOUT, &amp;timeout,<br>
                          sizeof(DWORD));<br>
                          InternetSetOption(hSession, INTERNET_OPTION_CONTROL_RECEIVE_TIMEOUT,<br>
                          &amp;timeout, sizeof(DWORD));<br>
                          InternetSetOption(hSession, INTERNET_OPTION_CONTROL_SEND_TIMEOUT, &amp;timeout,<br>
                          sizeof(DWORD));<br>
                          <br>
                          The reason why I did this is, because I tried to increase the timeout and shut down my http server during the download. After that the error message appeared in exaclty the same time.<br>
                          <br>
                          Maybe it is a bug?!</p>
                        </div>
                        <hr>

                        <div class="post">
                          <p class="post-meta"><span class="post-author text-primary">Takhir</span><br>
                          <span class="post-time small text-muted">5th April 2011 11:40 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                          <p class="post-content">May be. But MSDN says that DATA_SEND/RECEIVE_TIMEOUT related to ftp only. CONTROL_RECEIVE is identical to RECEIVE. So the only flag that can help with big files download via HTTP is INTERNET_OPTION_RECEIVE_TIMEOUT (probably no separation of HTTP header and data).<br>
                          Currently plug-in can use not default INTERNET_OPTION_CONNECT_TIMEOUT only (if set in parameters - /timeout). I do not remember why it was added in 2005 :), but IMHO this option is good. This way we can change IE default setting for connection t/o. If you can test RECEIVE_TIMEOUT flag and confirm that this resolves situation with antivirus (this may be true if Kaspersky catches data before Inetc), I'll add this new option.<br>
                          Thanks, Takhir</p>
                        </div>
                        <hr>

                        <div class="post">
                          <p class="post-meta"><span class="post-author text-primary">klopfdreh</span><br>
                          <span class="post-time small text-muted">5th April 2011 13:57 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                          <p class="post-content">I tried various settings now in<br>
                          HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Internet Settings<br>
                          <br>
                          ReceiveTimeout (REG_DWORD) = 300000<br>
                          KeepAliveTimeout (REG_DWORD) = 300000<br>
                          ServerInfoTimeout (REG_DWORD) = 300000<br>
                          <br>
                          But I had no success, because I received the error message every ~3000 Milliseconds and not as expected ~5 minutes.<br>
                          <br>
                          So I had a deeper look into the source code.<br>
                          <br>
                          Please correct me if I'm wrong, but you are using a thread which is waiting if there is a transfer and if not it will abort after 3000 milliseconds, right?<br>
                          <br>
                          Line: WaitForSingleObject(hThread, 3000) == WAIT_TIMEOUT<br>
                          <br>
                          Could it be that the timeout which is going to be set via RECEIVE_TIMEOUT and CONNECT_TIMEOUT should influence this timeout, because the thread would exit to early?<br>
                          <br>
                          In my opinion the changes of the RECEIVE_TIMEOUT would be only a little (~5 lines -&gt; cmd line parsing and call in the function itself), so I would add it to the next version, to set it as needed.<br>
                          <br>
                          P.S.: A few options are not mentioned in the wiki (for example: nocookies).</p>
                        </div>
                        <hr>

                        <div class="post">
                          <p class="post-meta"><span class="post-author text-primary">Yathosho</span><br>
                          <span class="post-time small text-muted">6th April 2011 23:43 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                          <p class="post-content">could it be the plugin ignores the default font rendering settings when used in /BANNER mode? it seems to ignore the fact i have cleartype enabled.</p>
                        </div>
                        <hr>

                        <div class="post">
                          <p class="post-meta"><span class="post-author text-primary">klopfdreh</span><br>
                          <span class="post-time small text-muted">18th April 2011 12:44 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                          <p class="post-content">Hello again,<br>
                          <br>
                          @Takhir : Anything new to Yathosho and my objections?</p>
                        </div>
                        <hr>

                        <div class="post">
                          <p class="post-meta"><span class="post-author text-primary">Takhir</span><br>
                          <span class="post-time small text-muted">19th April 2011 06:41 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                          <p class="post-content"></p>

                          <blockquote>
                            <small>Originally posted by klopfdreh</small><br>
                            Please correct me if I'm wrong, but you are using a thread which is waiting if there is a transfer and if not it will abort after 3000 milliseconds, right?<br>
                            <br>
                            Line: WaitForSingleObject(hThread, 3000) == WAIT_TIMEOUT
                          </blockquote>No, in this line plug-in waits transfer thread termination after Cancel button was pressed. On server termination DATA_RECEIVE_TIMEOUT probably defines time. If you tested InternetSetOption(hSession, INTERNET_OPTION_DATA_RECEIVE_TIMEOUT, &amp;timeout,<br>
                          sizeof(DWORD)); and this work as expected please let me know (or I'll test this when I'll have time - a lot of job now :( ). Both options - connection and receive timeouts have sence, so let's test and add new feature :).<br>
                          <br>
                          &gt; P.S.: A few options are not mentioned in the wiki (for example: nocookies).<br>
                          Thanks!<br>
                          <br>
                          &gt; could it be the plugin ignores the default font rendering settings when used in /BANNER mode? it seems to ignore the fact i have cleartype enabled.<br>
                          <br>
                          Yathosho, please send me minimum size sample script and I'll test this. Only english/russian/italian systems are available now for me :).
                        </div>
                        <hr>

                        <div class="post">
                          <p class="post-meta"><span class="post-author text-primary">klopfdreh</span><br>
                          <span class="post-time small text-muted">19th April 2011 07:26 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                          <p class="post-content">@Takhir: Thank a lot for the fast answer again. Well I don't have the environment to compile the source :( . Would you please so kind and test it?<br>
                          <br>
                          The way I did was simply to limit the transfer rate of the http server and shut it down, before the download was finished. The response always appears after ~3 Seconds, thats why I was supposing it could be the line I worte. And in the case of the virus scanner it also appears in ~3 Seconds, because the file is beeing scanned.<br>
                          <br>
                          It would be really really nice, because we are using your lib to update clients automatically in an environment with ~1500 users. :)<br>
                          <br>
                          I think it should be only a little change, just those lines that get the parameter out of the call and if the parameter contains the receive timeout the call of the internetSetOption.</p>
                        </div>
                        <hr>

                        <div class="post">
                          <p class="post-meta"><span class="post-author text-primary">klopfdreh</span><br>
                          <span class="post-time small text-muted">26th April 2011 07:20 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                          <p class="post-content">Now I tried to compile it with cygwin by myself and I got some errors during the compilation (picture)<br>
                          <br>
                          @Takhir: Because I can't compile it easily - would you be so kind and add/change the following lines to inetc.cpp and recompile it? I think it should work that way:<br>
                          <br>
                          <b>line 208:</b><br></p>
                          <pre>
<code>timeout,<br>receivetimeout = 0;</code>
</pre><br>
                          <br>
                          <b>line 799:</b><br>
                          <pre>
<code>if(receivetimeout &gt; 0)<br>        InternetSetOption(hSes, INTERNET_OPTION_DATA_RECEIVE_TIMEOUT, &amp;receivetimeout, sizeof(receivetimeout));</code>
</pre><br>
                          <br>
                          <b>line 1374:</b><br>
                          <pre>
<code>else if(lstrcmpi(url, _T("/receivetimeout")) == 0)<br>{<br>        popstring(url);<br>        receivetimeout = _tcstol(url, NULL, 10);<br>}</code>
</pre><br>
                          <br>
                          That would be very very nice of you. If you could do this and post a new build in here I would check if that will solve our problem!<br>
                          <br>
                          <b>Edit: I was able to solve the error with the exdll by using the exdll.h and the api.h of the current source of nsis but the error in inetc.cpp on line 648 still appears.</b>
                        </div>
                        <hr>

                        <div class="post">
                          <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br>
                          <span class="post-time small text-muted">26th April 2011 10:50 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                          <p class="post-content">You don't need to use strtol (you don't want a dependency on CRT). NSIS exposes popint() and myatoi() that you can use.<br>
                          <br>
                          Stu</p>
                        </div>
                        <hr>

                        <div class="post">
                          <p class="post-meta"><span class="post-author text-primary">klopfdreh</span><br>
                          <span class="post-time small text-muted">26th April 2011 10:59 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                          <p class="post-content">Ok, I solved it for my environment. I used dev-c (g++) within cygwin:<br>
                          <br>
                          g++ -c inetc.cpp -I/usr/include/mingw -lwininet -lcomctl32<br>
                          g++ -shared -o inetc.dll inetc.o -I/usr/include/mingw -lwininet -lcomctl32<br>
                          <br>
                          and I used the exdll.h and api.h attached to the post.<br>
                          <br>
                          @ Afrow UK: It is not my code. I only want to recompile and test the changes posted above.<br>
                          <br>
                          <b>Edit: Well my dll doesn't work! :D I hope I will get it running today.<br>
                          <br>
                          Edit2: Mmhhh I don't know why it is not working for me, the result if I compile the dll is, that the return value is not "OK". Example:<br>
                          <br>
                          inetc::get /NOCOOKIES /TIMEOUT 300000 /NOCANCEL /CAPTION "$(^Name)" /RESUME "..."<br>
                          <br>
                          Pop $R0<br>
                          <br>
                          MessageBox MB_OK $R0<br>
                          <br>
                          $R0 is always the first paramter I give into the dll call....<br></b></p>
                        </div>
                        <hr>

                        <div class="post">
                          <p class="post-meta"><span class="post-author text-primary">Takhir</span><br>
                          <span class="post-time small text-muted">26th April 2011 12:23 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                          <p class="post-content">I am sorry... and thank for your efforts!<br>
                          I am attaching build with your changes, please send me info if you need something else and I'll try to do this tonight.</p>
                        </div>
                        <hr>

                        <div class="post">
                          <p class="post-meta"><span class="post-author text-primary">klopfdreh</span><br>
                          <span class="post-time small text-muted">26th April 2011 12:49 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                          <p class="post-content">@Takhir: Thank you very very much! Maybe you are able to tell me what I did wrong with the compilation?<br>
                          <br>
                          I don't know why it doesn't worked for me - even NSIS was compiling fine...<br>
                          <br>
                          <b>Edit: I tried the new version with the internetreceive timeout and if I have the kaspersky virus scanner installed, it trys to check the download after the tranfer and then aborts. :cry: I've tested it on a vmware box already...</b><br>
                          <br>
                          <b>Edit2: BUUUUUTTTT!!! I tested the ReceiveTimeout in the registry again and then the download worked for me. Seems that the internetSetOption with INTERNET_OPTION_DATA_RECEIVE_TIMEOUT doesn't apply it to the current connection.<br>
                          <br>
                          Brrrr.... this smells like an ugly sh* but I'm going to set the dword previously:<br>
                          <br>
                          WriteRegDWORD HKCU "Software\Microsoft\Windows\CurrentVersion\Internet Settings\" 'ReceiveTimeout' 0x001b7740<br></b></p>
                        </div>
                        <hr>

                        <div class="post">
                          <p class="post-meta"><span class="post-author text-primary">Takhir</span><br>
                          <span class="post-time small text-muted">27th April 2011 18:33 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                          <p class="post-content">Thanks, klopfdreh<br>
                          <br>
                          Attached plug-in worked as expected (for me ).<br>
                          Finally: INTERNET_OPTION_RECEIVE_TIMEOUT sets what we need. Interesting information from MSDN 2005: INTERNET_OPTION_DATA_RECEIVE_TIMEOUT 8 Not implemented.<br>
                          Now Inetc options are /connecttimeout and /receivetimeout, both in seconds (not milliseconds!). I.e. 60 sec timeout will be /receivetimeout 60<br>
                          <br>
                          And ... this not took many time after I understood how to test timeout - simple php script with sleep() . Included to zip. please let me know if big files problem resolved.</p>
                        </div>
                        <hr>

                        <div class="post">
                          <p class="post-meta"><span class="post-author text-primary">klopfdreh</span><br>
                          <span class="post-time small text-muted">28th April 2011 09:00 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                          <p class="post-content">Great! Thanks a lot! I'm going to test it without the reg key and with this new version, now!<br>
                          <br>
                          <b>Edit: It is working like a charm, even without the registry entry - thank you very very much! :D</b><br>
                          <br>
                          I think we should add those changes to the wiki, too. It is a great change and really usefull!</p>
                        </div>
                        <hr>

                        <div class="post">
                          <p class="post-meta"><span class="post-author text-primary">Takhir</span><br>
                          <span class="post-time small text-muted">28th April 2011 09:30 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                          <p class="post-content">Thank you very much, klopfdreh! I'll add this patch shortly to archive.</p>
                        </div>
                        <hr>

                        <div class="post">
                          <p class="post-meta"><span class="post-author text-primary">Yathosho</span><br>
                          <span class="post-time small text-muted">4th May 2011 12:35 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                          <p class="post-content"></p>

                          <blockquote>
                            <small>Originally posted by Takhir</small><br>
                            Yathosho, please send me minimum size sample script and I'll test this. Only english/russian/italian systems are available now for me :).
                          </blockquote>(screenshot based on your cameron diaz example)<br>
                          <br>
                          is the banner using the system font? it should be antialiased according to my windows settings, but it's not.
                        </div>
                        <hr>

                        <div class="post">
                          <p class="post-meta"><span class="post-author text-primary">Yathosho</span><br>
                          <span class="post-time small text-muted">4th May 2011 12:42 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                          <p class="post-content">btw, i have tried to use InetLoad with three switches (/TIMEOUT 5000 /RESUME /BANNER) but the download only works when using just one of these. the documentation and examples don't deal with multiple switches, is it even possible to chain these?</p>
                        </div>
                        <hr>

                        <div class="post">
                          <p class="post-meta"><span class="post-author text-primary">zenpoy</span><br>
                          <span class="post-time small text-muted">23rd May 2011 09:27 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                          <p class="post-content">Hi all - I've noticed that when using embedded progress bar the text above the main progress bar is always printf("Downloading %s",filename), ignoring the caption switch. so I've changed the code a bit to make the text printf("%s",caption) if the caption switch exists.<br>
                          <br>
                          If you think the this is really a bug you can merge it. Anyway, this is what the I thought the expected behavior would be.<br>
                          <br>
                          Thanks,<br>
                          <br>
                          J</p>
                        </div>
                        <hr>

                        <div class="post">
                          <p class="post-meta"><span class="post-author text-primary">ManoKum80</span><br>
                          <span class="post-time small text-muted">26th May 2011 20:02 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                          <p class="post-content"><b>Feature Add Request -</b><br>
                          - If download file already exists, check hash, if OK do not re-download<br>
                          - Resume download even if user Cancels it, something like /NODELETE option on nsisdl v1.4<br>
                          - on resume prompt, window title is 'Inetc plugin', it should be either removed completely or changeable via some option<br>
                          <br>
                          Currently both above are available nsisdl v1.4 but it does not have authentication/proxy handling features that inetc can do.<br>
                          <br>
                          PS - let me know if above features are already available and i am missing something.<br>
                          Great thanks to all!</p>
                        </div>
                        <hr>

                        <div class="post">
                          <p class="post-meta"><span class="post-author text-primary">MSG</span><br>
                          <span class="post-time small text-muted">26th May 2011 20:07 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                          <p class="post-content"></p>

                          <blockquote>
                            <small>Originally posted by ManoKum80</small><br>
                            - If download file already exists, check hash, if OK do not re-download
                          </blockquote>This is actually trivial to implement in NSIS code. Use the md5dll plugin.
                        </div>
                        <hr>

                        <div class="post">
                          <p class="post-meta"><span class="post-author text-primary">zenpoy</span><br>
                          <span class="post-time small text-muted">15th June 2011 14:50 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                          <p class="post-content"><strong>Bug?</strong><br>
                          I think I found a bug in Inetc but I'm not sure - for some reason it clears the stack after cancelling. Does anyone see this behavior also?<br>
                          <br>
                          EDIT: It clears the stack when clicking cancel and then it pops up an are you sure dialog - while it continues to download - if it finishes to download while the dialog is still open and then I press "Yes" (which means - yes, I'm sure I want to cancel) It clears the stack. If everyone see this behavior - I think it's pretty critical...</p>
                        </div>
                        <hr>

                        <div class="post">
                          <p class="post-meta"><span class="post-author text-primary">Takhir</span><br>
                          <span class="post-time small text-muted">15th June 2011 14:57 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                          <p class="post-content"></p>

                          <blockquote>
                            <small>Originally posted by zenpoy</small><br>
                            I think I found a bug in Inetc but I'm not sure - for some reason it clears the stack after cancelling. Does anyone see this behavior also?
                          </blockquote>inetc can download few files, so stack can include few pairs of URL/file, on termination plug-in should remove tail from stack. Best of all is to use /end paramater in your command line.
                        </div>
                        <hr>
                        
                        
                        

                        <div class="container">
                          

                          <ol class="breadcrumb">
                            <li><a href="../index.html" class="glyphicon glyphicon-home"></a></li>

                            <li><a href="f-65.html">NSIS Discussion</a></li>

                            <li class="active">http + ftp download plug-in</li>
                          </ol>

                          <p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=198596">http + ftp download plug-in</a></p><br>

                          <div class="post">
                            <p class="post-meta"><span class="post-author text-primary">zenpoy</span><br>
                            <span class="post-time small text-muted">15th June 2011 15:02 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                            <p class="post-content">the command line I'm using is:<br>
                            <br>
                            Inetc::get /NOPROXY /QUESTION "" /CAPTION "Installing $TITLE" $IS_PROXY_ALLOWED $URL $R3 /END</p>
                          </div>
                          <hr>

                          <div class="post">
                            <p class="post-meta"><span class="post-author text-primary">zenpoy</span><br>
                            <span class="post-time small text-muted">15th June 2011 15:27 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                            <p class="post-content">Anyway - I think I fixed it I've changed dlgProc, case IDCANCEL to be:<br>
                            <br>
                            case IDCANCEL:<br>
                            if(nocancel) break;<br>
                            if(szQuestion) {<br>
                            msgboxAnswer = MessageBox(hDlg, szQuestion, szCaption, MB_ICONWARNING|MB_YESNO);<br>
                            if (msgboxAnswer == IDNO)<br>
                            break;<br>
                            else if (status == ST_DOWNLOAD)<br>
                            status = ST_CANCELLED;<br>
                            }</p>
                          </div>
                          <hr>

                          <div class="post">
                            <p class="post-meta"><span class="post-author text-primary">zenpoy</span><br>
                            <span class="post-time small text-muted">16th June 2011 08:39 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                            <p class="post-content"><strong>ok... now I've fixed it</strong><br>
                            Sorry for spamming the thread... The former solution wasn't a solution - it did not clear the stack but it returned a wrong status. So please ignore the last fix.<br>
                            <br>
                            There's a function called inetTransfer which pops pairs of url and file name and downloads them. what I did was to add two lines right after the loop that does that:<br>
                            <br>
                            if (lstrcmpi(url, _T("/end"))==0)<br>
                            pushstring(url);<br>
                            <br>
                            And in cleanup section I removed the status check - so now I always clean the stack.<br>
                            <br>
                            Hope it makes sense to anyone. If you want the fixed version, tell me.<br>
                            <br>
                            J.</p>
                          </div>
                          <hr>

                          <div class="post">
                            <p class="post-meta"><span class="post-author text-primary">Takhir</span><br>
                            <span class="post-time small text-muted">16th June 2011 11:41 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                            <p class="post-content"></p>

                            <blockquote>
                              <small>Originally posted by zenpoy</small><br>
                              Hope it makes sense to anyone. If you want the fixed version, tell me.<br>
                              J.
                            </blockquote>Thanks, zenpoy!<br>
                            If you can send me PM with updated source, I'll merge changes and build new release for wiki.<br>
                            Unfortunatelly I am overloaded with business tasks and had not time to dig into proble, sorry :(.<br>
                            Takhir
                          </div>
                          <hr>

                          <div class="post">
                            <p class="post-meta"><span class="post-author text-primary">zenpoy</span><br>
                            <span class="post-time small text-muted">27th July 2011 13:48 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                            <p class="post-content"><strong>What do you use to compile inetc?</strong><br>
                            When I'm using the inetc.dll out of the box (that is, out of the zip) it works fine in winxp sp2. When I use my x64 (win7) pc with both vs2008 and vs2010 to compile the source code it produces a dll that works in win7 but is not working in winxp sp2 (without any updates/vc++ packs or anything, completely fresh install).<br>
                            <br>
                            When I try to call inetc:<br>
                            <br></p>
                            <pre>
<code> <br>    strcpy $R0 "http://www.google.com/intl/en_com/images/srpr/logo2w.png"<br>    Inetc::get /SILENT /CONNECTTIMEOUT 10000 $R0 "image.png" /END<br>    dumpstate::debug</code>
</pre><br>
                            <br>
                            it leaves the args on the stack ( /SILENT /CONNECTTIMEOUT 10000 $R0 "image.png" /END)<br>
                            <br>
                            So how do you compile it to be compatible for xp sp2??<br>
                            <br>
                            Thanks
                          </div>
                          <hr>

                          <div class="post">
                            <p class="post-meta"><span class="post-author text-primary">Takhir</span><br>
                            <span class="post-time small text-muted">27th July 2011 14:23 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                            <p class="post-content">I compile it in VS 6 on XP or Vista. Resulting DLL depends on msvctr.dll but this is OK. You can change settings in later VS to multithreaded DLL, this case module size should increase, but without dependencies to runtimes. IMHO targetver.h should not produce any conflicts.</p>
                          </div>
                          <hr>

                          <div class="post">
                            <p class="post-meta"><span class="post-author text-primary">zenpoy</span><br>
                            <span class="post-time small text-muted">3rd August 2011 09:10 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                            <p class="post-content">Thanks! that helped... I tried to change to multithreasded DLL but still, it didn't work. So I used VS6 and it works like a charm.</p>
                          </div>
                          <hr>

                          <div class="post">
                            <p class="post-meta"><span class="post-author text-primary">Takhir</span><br>
                            <span class="post-time small text-muted">4th August 2011 07:53 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                            <p class="post-content">Oups... Sorry, 'multithreaded' only. No 'DLL' and no dependencies to runtimes this case. But any case VS 6 is better way.</p>
                          </div>
                          <hr>

                          <div class="post">
                            <p class="post-meta"><span class="post-author text-primary">zenpoy</span><br>
                            <span class="post-time small text-muted">4th August 2011 09:33 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                            <p class="post-content">I have now another issue with winxp32 sp2. In win7/vista and others I can redirect from https to http. but in winxp32sp2 I get error Redirection (302). I thought I should add something like:<br>
                            <br></p>
                            <pre>
<code><br><br>InternetQueryOption (hFile, INTERNET_OPTION_SECURITY_FLAGS,<br>                                                (LPVOID)&amp;rslt, &amp;(err = sizeof(rslt)));<br>rslt |= SECURITY_FLAG_IGNORE_REDIRECT_TO_HTTP;<br>InternetSetOption (hFile, INTERNET_OPTION_SECURITY_FLAGS,<br>                                                &amp;rslt, sizeof(rslt) );<br><br></code>
</pre><br>
                            <br>
                            but it didn't work - I'm not that familiar with the code, can you give me some guidance?
                          </div>
                          <hr>

                          <div class="post">
                            <p class="post-meta"><span class="post-author text-primary">Takhir</span><br>
                            <span class="post-time small text-muted">4th August 2011 10:04 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                            <p class="post-content">Inetc already has<br>
                            <br>
                            #define MY_REDIR_FLAGS INTERNET_FLAG_IGNORE_REDIRECT_TO_HTTP | INTERNET_FLAG_IGNORE_REDIRECT_TO_HTTPS<br>
                            <br>
                            for primary https URL. 'SECURITY_' flags are the same<br>
                            <br>
                            #define SECURITY_FLAG_IGNORE_REDIRECT_TO_HTTPS INTERNET_FLAG_IGNORE_REDIRECT_TO_HTTPS<br>
                            #define SECURITY_FLAG_IGNORE_REDIRECT_TO_HTTP INTERNET_FLAG_IGNORE_REDIRECT_TO_HTTP<br>
                            <br>
                            So I guess problem is in this XP settings or in WinInet.dll version supplied with this OS/SP.<br>
                            <br>
                            I am attaching test version with merged code for 'Cancel' issue (because it's not possible to send link in PM :( ). BTW I am not sure if anybody use this 'multiple download' mode. May be has sence to remove this option and download one file per Inetc call? For me this even simpler then long-long-long strings with name-URL pairs...</p>
                          </div>
                          <hr>

                          <div class="post">
                            <p class="post-meta"><span class="post-author text-primary">zenpoy</span><br>
                            <span class="post-time small text-muted">4th August 2011 13:53 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                            <p class="post-content">1. regarding the winint.dll and https-&gt;http redirection in xp sp2, I found out this <a href="http://support.microsoft.com/kb/907301" target="_blank">http://support.microsoft.com/kb/907301</a> issue, and applying the hotfix (which only replaces winint.dll and adds registry key) solves it! the bad news is that wininit.dll is a 'KnownDll' which means it always loaded from Windows\System32 and only OS can update it. I think the only way is to change the redirection to be like XP SP2 wants.<br>
                            <br>
                            2. regarding the 'cancel' bug - looks good :) The bug is not related to multiple downloads, I use only one download at a time, and I had this bug.</p>
                          </div>
                          <hr>

                          <div class="post">
                            <p class="post-meta"><span class="post-author text-primary">tperquin</span><br>
                            <span class="post-time small text-muted">19th October 2011 15:36 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                            <p class="post-content">Hello Takhir,<br>
                            <br>
                            First of thanks for the plugin. I however encountered a problem with the FTP PUT functionality of the plugin. It has to do when PUTing files that are in non-existing (on the FTP server) subdirectories.<br>
                            <br>
                            The plugin determines if a FTP PUT upload failed due to a non existing subdirectory and tries to create the necessary subdirectories.<br>
                            <br>
                            However the code that determines non-existing subdirectories relies on the FTP server's response. And I encountered a FTP server where the code in the plugin failed.<br>
                            <br>
                            I attached two images with the different responses by different FTP servers on non-existing directory.<br>
                            <br>
                            Code fix should be easy, around line 528 in inetc.cpp:<br></p>
                            <pre>
<code><br>                if(fput &amp;&amp; _tcsstr(buf, _T("550")) != NULL)<br>                {<br></code>
</pre><br>
                            Change to: (or what you prefer)<br>
                            <pre>
<code><br>                if(fput &amp;&amp; (_tcsstr(buf, _T("550")) != NULL ||  _tcsstr(buf, _T("553")) != NULL))<br>                {<br></code>
</pre><br>
                            <br>
                            I saw a few messages that also had problem with subdirectories and FTP PUT earlier in the thread. Those probably had to do with this as well.
                          </div>
                          <hr>

                          <div class="post">
                            <p class="post-meta"><span class="post-author text-primary">Takhir</span><br>
                            <span class="post-time small text-muted">19th October 2011 18:40 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                            <p class="post-content">Good job, tperquin, than you!<br>
                            I uploaded new release <a href="http://nsis.sourceforge.net/File:Inetc.zip" target="_blank">http://nsis.sourceforge.net/File:Inetc.zip</a></p>
                          </div>
                          <hr>

                          <div class="post">
                            <p class="post-meta"><span class="post-author text-primary">DaLiV</span><br>
                            <span class="post-time small text-muted">21st October 2011 11:12 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                            <p class="post-content">in .zip lost non-unicode version</p>
                          </div>
                          <hr>

                          <div class="post">
                            <p class="post-meta"><span class="post-author text-primary">Takhir</span><br>
                            <span class="post-time small text-muted">21st October 2011 11:48 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                            <p class="post-content">Oups... Fixed.</p>
                          </div>
                          <hr>

                          <div class="post">
                            <p class="post-meta"><span class="post-author text-primary">CritterNYC</span><br>
                            <span class="post-time small text-muted">26th October 2011 18:45 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                            <p class="post-content">It seems that inetc, even in a completely silent installer with no splash screen or other plugins, will still steal focus from another app when it is instantiated. Does anyone know of a fix for this?</p>
                          </div>
                          <hr>

                          <div class="post">
                            <p class="post-meta"><span class="post-author text-primary">Zinthose</span><br>
                            <span class="post-time small text-muted">17th November 2011 20:49 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                            <p class="post-content">It looks like inetc::head is corrupting the stack.<br>
                            <br></p>
                            <pre>
<code>    DetailPrint "Beer is placed on the stack.."<br>    Push "BEER"<br>    <br>    inetc::head "http://download.macromedia.com/pub/flashplayer/current/install_flash_player_ax_32bit.exe" "$TEMP\Temp.dat"<br>    Pop $0<br>    DetailPrint "Result of inetc::head = $0"<br>    <br>    DetailPrint "Reach for Beer..."<br>    Pop $0<br>    ${If} $0 == "BEER"<br>        DetailPrint "Sip... ahh... sweet sweet beer!"<br>    ${Else}<br>        DetailPrint "I'm sorry but inetc::head drank your beer.  :'-("<br>    ${EndIf}</code>
</pre><br>
                            <br>
                            Please won't someone find my beer?
                          </div>
                          <hr>

                          <div class="post">
                            <p class="post-meta"><span class="post-author text-primary">zenpoy</span><br>
                            <span class="post-time small text-muted">17th November 2011 20:57 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                            <p class="post-content">Zinthose, try putting /END as the last argument to tell inetc where is the end of your argument list:<br>
                            <br>
                            inetc::head "http://download.macromedia.com/pub/flashplayer/current/install_flash_player_ax_32bit.exe" "$TEMP\Temp.dat" /END</p>
                          </div>
                          <hr>

                          <div class="post">
                            <p class="post-meta"><span class="post-author text-primary">Zinthose</span><br>
                            <span class="post-time small text-muted">17th November 2011 21:05 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                            <p class="post-content">You found my beer!<br>
                            <br>
                            Weird bug though... need a tinfoil hat for this one. :tinfoil:</p>
                          </div>
                          <hr>

                          <div class="post">
                            <p class="post-meta"><span class="post-author text-primary">klopfdreh</span><br>
                            <span class="post-time small text-muted">8th December 2011 08:02 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                            <p class="post-content"><strong>Details button and information text in instfiles page</strong><br>
                            Hello!<br>
                            <br>
                            Since I wrote the last time into this thread the plugin is working like a charm, so thanks a lot first!<br>
                            <br>
                            I have only two little feature request regarding the detail button and the information which are being displayed.<br>
                            <br>
                            <b>1. Is it possible not to grey the button out, but instead to make it pushable and print the downloading information into the textarea on each refresh?</b><br>
                            <br>
                            Example:<br>
                            &lt;filename&gt;: 14071kb (6%) of 234523kb @ 1543.0kb/s (2 seconds remaining)<br>
                            &lt;filename&gt;: 32833kb (14%) of 234523kb @ 1543.0kb/s (2 seconds remaining)<br>
                            &lt;filename&gt;: 53940kb (23%) of 234523kb @ 1543.0kb/s (2 seconds remaining)<br>
                            .<br>
                            .<br>
                            .<br>
                            <br>
                            <b>2. Is there a way to show which file is downloading at the moment, because in my installer there is only the product name displayed on top of the installation bar?</b><br>
                            <br>
                            Example:<br>
                            <br>
                            Downloading: &lt;filename&gt;<br>
                            [ || || || || || || || || || || || || || || || || || || || || ]<br>
                            <br>
                            Thanks a lot!</p>
                          </div>
                          <hr>

                          <div class="post">
                            <p class="post-meta"><span class="post-author text-primary">dravster</span><br>
                            <span class="post-time small text-muted">5th February 2012 23:38 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                            <p class="post-content"><strong>Odd Error with Inetc::get</strong><br>
                            Using the below simple test code at both my work (win7) and home (xp) hosts I get<br>
                            the error "U" off the stack. I'm using NSIS 2.46 and the latest Inetc plugin from<br>
                            <a href="http://nsis.sourceforge.net/Inetc_plug-in" target="_blank">http://nsis.sourceforge.net/Inetc_plug-in</a>.<br>
                            <br>
                            <br>
                            <br></p>
                            <pre>
<code>Name "InetClient GET Test"<br>OutFile "get.exe"<br><br>!AddPluginDir ./plugins<br><br>!include "MUI.nsh"<br>!define MUI_ICON "${NSISDIR}\Contrib\Graphics\Icons\modern-install-colorful.ico"<br>!insertmacro MUI_PAGE_WELCOME<br>!insertmacro MUI_PAGE_INSTFILES<br>!insertmacro MUI_LANGUAGE "English"<br><br>Section "Dummy Section" SecDummy<br><br>    SetDetailsView hide<br>; single file, NSISdl-style embedded progress bar with specific cancel button text<br><br>    inetc::get /canceltext "interrupt!" "http://drav.net/test.md5" "$EXEDIR\test.md5" /end<br>;    NSISdl::download /TIMEOUT=30000 http://drav.net/test.md5 $TEMP\test.md5<br>    Pop $1<br>    MessageBox MB_OK "Download Status: $1"<br><br>SectionEnd<br><br>;--------------------------------<br>;Installer Functions<br><br>Function .onInit<br>FunctionEnd</code>
</pre><br>
                            <br>
                            The Error appears as so (and no file is downloaded).<br>
                            <br>
                            <a href="http://drav.net/error.jpg" target="_blank">http://drav.net/error.jpg</a>
                          </div>
                          <hr>

                          <div class="post">
                            <p class="post-meta"><span class="post-author text-primary">Takhir</span><br>
                            <span class="post-time small text-muted">6th February 2012 05:43 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                            <p class="post-content">test.md5 38 bytes, status OK. String may be trancated to first char only ('U') if you use Unicode plug-in version with multibyte installer.</p>
                          </div>
                          <hr>

                          <div class="post">
                            <p class="post-meta"><span class="post-author text-primary">dravster</span><br>
                            <span class="post-time small text-muted">6th February 2012 09:31 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                            <p class="post-content"><strong>Re: Odd Error with Inetc::get</strong><br>
                            Yep that was it, drop in the "plugin/Inetc.dll" file (rather than unicode/Inetc.dll) and volia - It works :D<br>
                            <br>
                            Cheers for the quick response (as ever!) Takhir!<br>
                            <br>
                            Regards<br>
                            <br>
                            D.</p>
                          </div>
                          <hr>

                          <div class="post">
                            <p class="post-meta"><span class="post-author text-primary">klopfdreh</span><br>
                            <span class="post-time small text-muted">2nd April 2012 07:08 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                            <p class="post-content"></p>

                            <blockquote>
                              <small>Originally posted by klopfdreh</small><br>
                              Hello!<br>
                              <br>
                              Since I wrote the last time into this thread the plugin is working like a charm, so thanks a lot first!<br>
                              <br>
                              I have only two little feature request regarding the detail button and the information which are being displayed.<br>
                              <br>
                              <b>1. Is it possible not to grey the button out, but instead to make it pushable and print the downloading information into the textarea on each refresh?</b><br>
                              <br>
                              Example:<br>
                              &lt;filename&gt;: 14071kb (6%) of 234523kb @ 1543.0kb/s (2 seconds remaining)<br>
                              &lt;filename&gt;: 32833kb (14%) of 234523kb @ 1543.0kb/s (2 seconds remaining)<br>
                              &lt;filename&gt;: 53940kb (23%) of 234523kb @ 1543.0kb/s (2 seconds remaining)<br>
                              .<br>
                              .<br>
                              .<br>
                              <br>
                              <b>2. Is there a way to show which file is downloading at the moment, because in my installer there is only the product name displayed on top of the installation bar?</b><br>
                              <br>
                              Example:<br>
                              <br>
                              Downloading: &lt;filename&gt;<br>
                              [ || || || || || || || || || || || || || || || || || || || || ]<br>
                              <br>
                              Thanks a lot!
                            </blockquote>Hello again,<br>
                            <br>
                            only wanted to say that I solved the "2." by settings the right caption, but point "1." would be really nice if it is possible. :D
                          </div>
                          <hr>

                          <div class="post">
                            <p class="post-meta"><span class="post-author text-primary">barabanger</span><br>
                            <span class="post-time small text-muted">5th June 2012 18:25 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                            <p class="post-content"></p>

                            <blockquote>
                              <small>Originally posted by CritterNYC</small><br>
                              It seems that inetc, even in a completely silent installer with no splash screen or other plugins, will still steal focus from another app when it is instantiated. Does anyone know of a fix for this?
                            </blockquote>I noticed same issue, at least when using inetc from another process. From what I discovered, to avoid this, WS_EX_NOACTIVATE style should be set in dialog template.
                          </div>
                          <hr>

                          <div class="post">
                            <p class="post-meta"><span class="post-author text-primary">klopfdreh</span><br>
                            <span class="post-time small text-muted">6th June 2012 09:27 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                            <p class="post-content">Hello everyone again,<br>
                            <br>
                            I got some troubles with the inetc plugin and a low speed http server. After an undefined time the download aborts and a dialog show an error that the connection isn't available. If I press retry the dialog is shown again - so there is a loop which always show the error message and retry/abort. If I press abort the process is aborted as expected. The error is not within the time of 1800 seconds - it appears randomly.<br>
                            <br>
                            I'm using the following call in our NSIS script:<br>
                            <br></p>
                            <pre>
<code><br>inetc::get /NOCOOKIES /CONNECTTIMEOUT 1800 /RECEIVETIMEOUT 1800 <br>/NOCANCEL /CAPTION "$(INETCHeader)${What}" /TRANSLATE <br>"$(INETC1)" "$(INETC2)" "$(INETC3)" "$(INETC4)" "$(INETC5)" <br>"$(INETC6)" "$(INETC7)" "$(INETC8)" /RESUME <br>"$(DownloadResumeWarning)" "$downloadURL${What}" <br>"$userhomeworkingdir\${What}" /END<br></code>
</pre><br>
                            <br>
                            Thanks a lot!
                          </div>
                          <hr>

                          <div class="post">
                            <p class="post-meta"><span class="post-author text-primary">negativesir</span><br>
                            <span class="post-time small text-muted">21st August 2012 05:28 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                            <p class="post-content"></p>

                            <blockquote>
                              <small>Originally posted by CritterNYC</small><br>
                              It seems that inetc, even in a completely silent installer with no splash screen or other plugins, will still steal focus from another app when it is instantiated. Does anyone know of a fix for this?
                            </blockquote>Yes, this has to do with <a href="http://msdn.microsoft.com/en-us/library/windows/desktop/ms645428(v=vs.85).aspx" target="_blank">WM_INITDIALOG</a> not returning false.<br>
                            <br>
                            From MSDN:<br>

                            <blockquote>
                              The dialog box procedure should return TRUE to direct the system to set the keyboard focus to the control specified by wParam. Otherwise, it should return FALSE to prevent the system from setting the default keyboard focus.
                            </blockquote>Here is the fix for it, compiled in Visual C++ 6.0, tested on Windows 95.
                          </div>
                          <hr>

                          <div class="post">
                            <p class="post-meta"><span class="post-author text-primary">T.Slappy</span><br>
                            <span class="post-time small text-muted">21st August 2012 09:10 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                            <p class="post-content">[OT] Thanks for the fix, but seriously you are using Visual C++ 6.0 and Win 95 ??? [/OT]</p>
                          </div>
                          <hr>

                          <div class="post">
                            <p class="post-meta"><span class="post-author text-primary">negativesir</span><br>
                            <span class="post-time small text-muted">21st August 2012 09:14 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                            <p class="post-content"></p>

                            <blockquote>
                              <small>Originally posted by T.Slappy</small><br>
                              [OT] Thanks for the fix, but seriously you are using Visual C++ 6.0 and Win 95 ??? [/OT]
                            </blockquote>Yea. NSIS supports Windows 95 or higher. If I compile the source with anything higher than Visual C++ 6.0, the resulting DLL will not work on Windows 95. I have a Virtual PC Windows 95 image which makes it easy and I just had to downloaded Visual C++ 6.0. I compiled on Windows 7 and copied it over to the VM and tested the installer with the DLL.
                          </div>
                          <hr>

                          <div class="post">
                            <p class="post-meta"><span class="post-author text-primary">T.Slappy</span><br>
                            <span class="post-time small text-muted">23rd August 2012 05:57 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                            <p class="post-content"></p>

                            <blockquote>
                              <small>Originally posted by negativesir</small><br>
                              Yea. NSIS supports Windows 95 or higher. If I compile the source with anything higher than Visual C++ 6.0, the resulting DLL will not work on Windows 95. I have a Virtual PC Windows 95 image which makes it easy and I just had to downloaded Visual C++ 6.0. I compiled on Windows 7 and copied it over to the VM and tested the installer with the DLL.
                            </blockquote>[OT]<br>
                            Thanks for explanation, nice job.<br>
                            <br>
                            I assume nobody uses version below Windows 2000 and also Microsoft does not support such old versions any more.<br>
                            [/OT]
                          </div>
                          <hr>

                          <div class="post">
                            <p class="post-meta"><span class="post-author text-primary">negativesir</span><br>
                            <span class="post-time small text-muted">23rd August 2012 06:17 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                            <p class="post-content"></p>

                            <blockquote>
                              <small>Originally posted by T.Slappy</small><br>
                              [OT]<br>
                              Thanks for explanation, nice job.<br>
                              <br>
                              I assume nobody uses version below Windows 2000 and also Microsoft does not support such old versions any more.<br>
                              [/OT]
                            </blockquote>I don't doubt that. I know Microsoft doesn't support Windows 9X but NSIS does! Let me put it this way, I have a duty.. no a.. moral obligation.. to ensure that my patch does not break the minimum OS requirements.
                          </div>
                          <hr>

                          <div class="post">
                            <p class="post-meta"><span class="post-author text-primary">T.Slappy</span><br>
                            <span class="post-time small text-muted">24th August 2012 08:03 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                            <p class="post-content"></p>

                            <blockquote>
                              <small>Originally posted by negativesir</small><br>
                              Let me put it this way, I have a duty.. no a.. moral obligation.. to ensure that my patch does not break the minimum OS requirements.
                            </blockquote>Like!!!
                          </div>
                          <hr>

                          <div class="post">
                            <p class="post-meta"><span class="post-author text-primary">thaman667</span><br>
                            <span class="post-time small text-muted">10th September 2012 15:29 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                            <p class="post-content">For me it's not showing any window with download information which is very annoying..</p>
                          </div>
                          <hr>

                          <div class="post">
                            <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br>
                            <span class="post-time small text-muted">10th September 2012 15:36 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                            <p class="post-content">Where are you calling the plug-in from? To show download progress you probably need to use it in a Section (and without /silent).<br>
                            <br>
                            Stu</p>
                          </div>
                          <hr>

                          <div class="post">
                            <p class="post-meta"><span class="post-author text-primary">zenpoy</span><br>
                            <span class="post-time small text-muted">8th November 2012 08:34 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                            <p class="post-content"><strong>Can I resolve the filename from the request with inetc?</strong><br>
                            I have a url which I download a file from during install, this url is using redirection and the name of the file is based on some of the get parameters I use. Anyway, is there a way to use inetc to use/extract the filename from the last redirection in the redirection chains and use that as the filename? I have no problem do the change myself and try it, but I don't have to much experience with wininet api.<br>
                            <br>
                            BTW - When I put the url in the browser (e.g. chrome) address bar it automatically uses the correct filename to save the file - this is the behaviour I would like to implement.<br>
                            <br>
                            Thanks</p>
                          </div>
                          <hr>

                          <div class="post">
                            <p class="post-meta"><span class="post-author text-primary">maliktous</span><br>
                            <span class="post-time small text-muted">3rd December 2012 13:04 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                            <p class="post-content"></p>

                            <blockquote>
                              <small>Originally posted by negativesir</small><br>
                              Yes, this has to do with <a href="http://msdn.microsoft.com/en-us/library/windows/desktop/ms645428(v=vs.85).aspx" target="_blank">WM_INITDIALOG</a> not returning false.<br>
                              <br>
                              Here is the fix for it, compiled in Visual C++ 6.0, tested on Windows 95.
                            </blockquote>Thank. You save my day.<br>
                            <br>
                            <b>Takhir</b>, are you planning to include this fix into new version?
                          </div>
                          <hr>

                          <div class="post">
                            <p class="post-meta"><span class="post-author text-primary">newuser10</span><br>
                            <span class="post-time small text-muted">14th May 2013 21:50 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                            <p class="post-content">Hey guys,<br>
                            <br>
                            Just a disclaimer, I'm still new to NSIS in general<br>
                            <br>
                            The INETC plugin seems to work very well in general, although I'm having an issue which appears to be intermittent.. Basically i am attempting to retrieve a large number of files, approx 2 GB in size spread over 150 files and the transfer of some files are failing intermittently.<br>
                            <br>
                            I am using the /resume switch and when the failure occurs it takes place somewhere in the middle of a file transfer, when I click on resume, I right away get the same popup coming up asking if i want to resume or cancel.<br>
                            <br>
                            If i close up the installation package entirely, it will usually go through that file no issue but then fail on another. I'm not seeing any patterns as to specific files failing over and over again, it looks like its completely random.<br>
                            <br>
                            I thought it might be network related so i ran wireshark to verify if the outbound httpd request goes through and it does.. Also, if i cancel that specific file the next few files go through without issue and since they are all retrieving from the same web server i don't believe its network related.<br>
                            <br>
                            I'm not sure where to look to get this resolved, can i enable any additional logging?<br>
                            <br>
                            I can post the script if necessary<br>
                            <br>
                            Thanks in advance</p>
                          </div>
                          <hr>

                          <div class="post">
                            <p class="post-meta"><span class="post-author text-primary">T.Slappy</span><br>
                            <span class="post-time small text-muted">20th May 2013 12:20 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                            <p class="post-content">Is there any safe way how to detect the source of the problem when downloading file fails (inetc::get) ?<br>
                            <br>
                            Sometimes I am getting ERR_SENDREQUEST which is "SendRequest Error" but I cannot found the problem.<br>
                            <br>
                            Here is code:<br></p>
                            <pre>
<code>boolqueryStatus</code><span style="color: #007700">(</span><span style="color: #0000BB">HINTERNEThFile</span><span style="color: #007700">)
<br>{
<br></span><span style="color: #0000BB">TCHARbuf</span><span style="color: #007700">***91;</span><span style="color: #0000BB">256</span><span style="color: #007700">***93;=</span><span style="color: #0000BB">_T</span><span style="color: #007700">(</span><span style="color: #DD0000">""</span><span style="color: #007700">);
<br></span><span style="color: #0000BB">DWORDrslt</span><span style="color: #007700">;
<br>if(</span><span style="color: #0000BB">HttpQueryInfo</span><span style="color: #007700">(</span><span style="color: #0000BB">hFile</span><span style="color: #007700">,</span><span style="color: #0000BB">HTTP_QUERY_STATUS_CODE</span><span style="color: #007700">,
<br></span><span style="color: #0000BB">buf</span><span style="color: #007700">,&amp;(</span><span style="color: #0000BB">rslt</span><span style="color: #007700">=</span><span style="color: #0000BB">sizeof</span><span style="color: #007700">(</span><span style="color: #0000BB">buf</span><span style="color: #007700">)),</span><span style="color: #0000BB">NULL</span><span style="color: #007700">))
<br>{
<br></span><span style="color: #0000BB">buf</span><span style="color: #007700">***91;</span><span style="color: #0000BB">3</span><span style="color: #007700">***93;=</span><span style="color: #0000BB">0</span><span style="color: #007700">;
<br>if(</span><span style="color: #0000BB">lstrcmp</span><span style="color: #007700">(</span><span style="color: #0000BB">buf</span><span style="color: #007700">,</span><span style="color: #0000BB">_T</span><span style="color: #007700">(</span><span style="color: #DD0000">"0"</span><span style="color: #007700">))==</span><span style="color: #0000BB">0</span><span style="color: #007700">||*</span><span style="color: #0000BB">buf</span><span style="color: #007700">==</span><span style="color: #0000BB">0</span><span style="color: #007700">)&lt;&lt;&lt;</span><span style="color: #0000BB">Theresultcodeiszero</span><span style="color: #007700">(</span><span style="color: #0000BB">0</span><span style="color: #007700">)-</span><span style="color: #0000BB">butwhy</span><span style="color: #007700">???
<br></span><span style="color: #0000BB">status</span><span style="color: #007700">=</span><span style="color: #0000BB">ERR_SENDREQUEST</span><span style="color: #007700">;
</span>
</pre>
                          </div>
                          <hr>

                          <div class="post">
                            <p class="post-meta"><span class="post-author text-primary">tom_q</span><br>
                            <span class="post-time small text-muted">1st August 2013 09:59 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                            <p class="post-content">Hi,<br>
                            <br>
                            I'm trying to use inetc to download files. I allow users to cancel the download, and to try to download the file a second time. I use the following code:<br>
                            <br></p>
                            <pre>
<code>Function OnDownloadPageClose<br>  Push $0<br>  ;Download the file<br>  inetc::get /BANNER "Download in progress." \<br>             /CAPTION "Downloading..." \<br>             "http://www.myuri.com/myfile.txt" \<br>             "$DownloadDirectory\myfile.txt" \<br>             /END<br>  Pop $0<br>  ${If} $0 == "OK"<br>    ExecWait "$DownloadDirectory\myfile.txt  -d$\"$DownloadDirectory$\" -s"<br>    Delete "$DownloadDirectory\myfile.txt"<br>  ${Else} ;an error occured<br>    MessageBox MB_YESNO|MB_ICONEXCLAMATION \<br>    "The file could not be downloaded. This may be due to a faulty \<br>Internet connection. Click 'Yes' to try again, or click 'No' to finish installation \<br>without downloading the optional files." \<br>    IDNO exit<br>    Delete "$DownloadDirectory\myfile.txt"  ; !! THIS DOES NOT WORK<br>    Pop $0<br>    Abort  ; do not go to the next installer page, so the user can try again.<br>  ${EndIf}<br>exit:<br>  Pop $0<br>FunctionEnd</code>
</pre><br>
                            <br>
                            This does not work, most likely because when the download is interrupted by the user (closing the download pop-up) the half-downloaded-file cannot be deleted. It is also impossible to delete the file manually for as long as the installer is running ("Another program is using this file").<br>
                            <br>
                            Edit: I get the same issue in other modes (besides banner mode) when clicking the cancel button. It seems like cancelled downloads are not properly handled -- the downloaded files are never closed. Then again it might just be that I have forgotten some essential operation.
                          </div>
                          <hr>

                          <div class="post">
                            <p class="post-meta"><span class="post-author text-primary">aerDNA</span><br>
                            <span class="post-time small text-muted">1st August 2013 14:42 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                            <p class="post-content">inetc automatically deletes the file on dl cancel; why it doesn't in your case, it's hard to say. Does the problem persist with some other file from a different server? Try using Unlocker to see if some 3rd party sw is hijacking the file. If you can't resolve the problem, a workaround can be to use GetTempFileName for the destination, then move the completed dl to target dir.</p>
                          </div>
                          <hr>
                          
                          
                          

                          <div class="container">
                            

                            <ol class="breadcrumb">
                              <li><a href="../index.html" class="glyphicon glyphicon-home"></a></li>

                              <li><a href="f-65.html">NSIS Discussion</a></li>

                              <li class="active">http + ftp download plug-in</li>
                            </ol>

                            <p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=198596">http + ftp download plug-in</a></p><br>

                            <div class="post">
                              <p class="post-meta"><span class="post-author text-primary">CritterNYC</span><br>
                              <span class="post-time small text-muted">20th August 2013 05:32 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                              <p class="post-content"></p>

                              <blockquote>
                                <small>Originally posted by negativesir</small><br>
                                Yes, this has to do with <a href="http://msdn.microsoft.com/en-us/library/windows/desktop/ms645428(v=vs.85).aspx" target="_blank">WM_INITDIALOG</a> not returning false.<br>
                                <br>
                                From MSDN:<br>
                                <br>
                                <br>
                                Here is the fix for it, compiled in Visual C++ 6.0, tested on Windows 95.
                              </blockquote>Thanks, negativesir. I've verified that this fixes the issue with stealing focus and otherwise works unaltered. I wasn't sure if you'd compiled as release or debug back when you'd submitted this, so I recompiled it using a clean VC++6 under a clean Windows XP of release builds of both ANSI and Unicode just to be sure. It's now been updated on the inetc plugin download page.
                            </div>
                            <hr>

                            <div class="post">
                              <p class="post-meta"><span class="post-author text-primary">CritterNYC</span><br>
                              <span class="post-time small text-muted">20th August 2013 05:36 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                              <p class="post-content"></p>

                              <blockquote>
                                <small>Originally posted by negativesir</small><br>
                                Here is the fix for it, compiled in Visual C++ 6.0, tested on Windows 95.
                              </blockquote>Thanks, negativesir! I've verified that this fixes the issues with stealing focus when in silent mode and does not affect other functionality. (for the curious an Abort was switched to return false where appropriate). I wasn't sure if you'd compiled as release or debug last year, so I recompiled using a clean VC++6 install on a clean Windows XP VM of the release config of both ANSI and Unicode. I've packaged it and updated the default download on the inetc plugins page.
                            </div>
                            <hr>

                            <div class="footer">
                              <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
                            </div>
                          </div><script src="../js/highlight.pack.js" type="text/javascript">
</script> <script type="text/javascript">
//<![CDATA[
                          hljs.initHighlightingOnLoad();
                          //]]></script></div></div></div></div></div></div></div></div></div></div></div></div></body></html>