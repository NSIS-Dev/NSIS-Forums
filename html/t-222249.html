<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="I would make an DropList for a custom page" />

  <title>I would make an DropList for a custom page - NSIS Forums</title>
  <script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script>
  <!-- Bootstrap core CSS -->

  <link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css" />
  <link rel="stylesheet" href="../css/style.css" type="text/css" /><!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!--[if lt IE 9]>
                <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
                <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->
</head>

<body>
  <div class="container">
    <!-- Put navigation bar here -->

    <ol class="breadcrumb">
      <li><a href="../index.html" class="glyphicon glyphicon-home"></a></li>

      <li><a href="f-65.html">NSIS Discussion</a></li>

      <li class="active">I would make an DropList for a custom page</li>
    </ol>

    <p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=222249">I would make an DropList for a custom page</a></p><br />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Sp33dy Gonzale$</span><br />
      <span class="post-time small text-muted">23rd July 2005 08:43 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>I would make an DropList for a custom page</strong><br />
      Hi<br />
      I make an installer for counter-strike and I would, that the user can choose on an custom page which netsettigs he has.<br />
      <br />
      This is my netsettings.ini:<br />
      <br /></p>
      <pre>
<code>[Settings]<br />NumFields=1<br /><br />[Field 1]<br />Type=Droplist<br />ListItems=LAN|56K Modem|ISDN|D-ISDN|S-DSL|A-DSL|Cable |Q-DSL|DSL mit FP<br />Left=2<br />Right=109<br />Top=1<br />Bottom=126</code>
</pre><br />
      <br />
      Here is an example:<br />
      <br />
      <a href="http://www.cs-expert.de/netsettings.php" target="_blank">http://www.cs-expert.de/netsettings.php</a><br />
      <br />
      How can I specify what happens whith the setting LAN, 56KMODEM...<br />
      <br />
      Example<br />
      <br />
      This is the code for lan:<br />
      <br />
      Lan:<br />
      [CODE]<br />
      ${FileJoin} "$INSTDIR\cstrike\userconfig.cfg" "$INSTDIR\Infos\Lan.cfg" "$INSTDIR\cstrike\userconfig.cfg"[CODE]<br />
      <br />
      <br />
      I hope you can understand what I mean. My english isn't very good
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
      <span class="post-time small text-muted">23rd July 2005 10:58 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">On the page leave function you need to read the State with ReadINIStr.<br />
      <br />
      -Stu</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Sp33dy Gonzale$</span><br />
      <span class="post-time small text-muted">23rd July 2005 11:45 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Hy thank you for the answer but I don't now what I should do now.<br />
      <br />
      Can you give me an expamle please?</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
      <span class="post-time small text-muted">23rd July 2005 17:11 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"></p>
      <pre>
<code>Page Custom showFunc leaveFunc<br /><br />Function leaveFunc<br /> ReadINIStr $R0 "$PLUGINSDIR\ioFile.ini" "Field 1" "State"<br />  StrCmp $R0 "LAN" 0 notLAN<br />   ${FileJoin} "$INSTDIR\cstrike\userconfig.cfg" "$INSTDIR\Infos\Lan.cfg" "$INSTDIR\cstrike\userconfig.cfg"<br />  notLAN:<br />FunctionEnd</code>
</pre><br />
      <br />
      -Stu
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Sp33dy Gonzale$</span><br />
      <span class="post-time small text-muted">24th July 2005 13:17 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Hy Afrow UK<br />
      <br />
      thank you!<br />
      <br />
      You always help me.<br />
      <br />
      But it isn't work. There comes always the error<br />
      <br /></p>
      <pre>
<code><br />ReadINIStr $R0 [Field 1]:State from $PLUGINSDIR\ioFile.ini<br />StrCmp expects 3-4 parameters, got 5.<br />Usage: StrCmp str1 str2 label_to_goto_if_equal [label_to_goto_if_not]<br />Error in script "H:\Eigene Dateien\Programme &amp; Games\Programme\Programme\NSIS\Projekte\Counter-Strike 1.6\Counter-Strike 1.6 Erweiterungs System\Counter-Strike 1.6 Erweiterungs System.nsi" on line 2062 -- aborting creation process</code>
</pre><br />
      <br />
      <br />
      This is my Code:<br />
      <br />
      <pre>
<code><br />Page custom NetsettingsPage PageLeaveNetsettings<br />ReserveFile "netsettings.ini"<br />!insertmacro MUI_INSTALLOPTIONS_EXTRACT "netsettings.ini"<br /><br /><br />; Page Leave Netsettings<br />Function PageLeaveNetsettings<br /><br />ReadINIStr $R0 "$PLUGINSDIR\ioFile.ini" "Field 1" "State"<br />StrCmp $R0 "LAN" 0 notLAN<br />${FileJoin} "$INSTDIR\cstrike\userconfig.cfg" "$INSTDIR\Infos\Lan.cfg" "$INSTDIR\cstrike\userconfig.cfg"<br />notLAN:<br /><br /><br />ReadINIStr $R0 "$PLUGINSDIR\ioFile.ini" "Field 1" "State"<br />StrCmp $R0 "56K Modem" 0 not56K Modem<br />${FileJoin} "$INSTDIR\cstrike\userconfig.cfg" "$INSTDIR\Infos\56K Modem.cfg" "$INSTDIR\cstrike\userconfig.cfg"<br />not56K Modem:<br /><br /><br />ReadINIStr $R0 "$PLUGINSDIR\ioFile.ini" "Field 1" "State"<br />StrCmp $R0 "ISDN" 0 notISDN<br />${FileJoin} "$INSTDIR\cstrike\userconfig.cfg" "$INSTDIR\Infos\ISDN.cfg" "$INSTDIR\cstrike\userconfig.cfg"<br />notISDN:<br /><br />ReadINIStr $R0 "$PLUGINSDIR\ioFile.ini" "Field 1" "State"<br />StrCmp $R0 "D-ISDN" 0 notD-ISDN<br />${FileJoin} "$INSTDIR\cstrike\userconfig.cfg" "$INSTDIR\Infos\D-ISDN.cfg" "$INSTDIR\cstrike\userconfig.cfg"<br />notD-ISDN:<br /><br />ReadINIStr $R0 "$PLUGINSDIR\ioFile.ini" "Field 1" "State"<br />StrCmp $R0 "S-DSL" 0 notS-DSL<br />${FileJoin} "$INSTDIR\cstrike\userconfig.cfg" "$INSTDIR\Infos\S-DSL.cfg" "$INSTDIR\cstrike\userconfig.cfg"<br />notS-DSL:<br /><br />ReadINIStr $R0 "$PLUGINSDIR\ioFile.ini" "Field 1" "State"<br />StrCmp $R0 "A-DSL" 0 notA-DSL<br />${FileJoin} "$INSTDIR\cstrike\userconfig.cfg" "$INSTDIR\Infos\A-DSL.cfg" "$INSTDIR\cstrike\userconfig.cfg"<br />notA-DSL:<br /><br />ReadINIStr $R0 "$PLUGINSDIR\ioFile.ini" "Field 1" "State"<br />StrCmp $R0 "Cable" 0 notCable<br />${FileJoin} "$INSTDIR\cstrike\userconfig.cfg" "$INSTDIR\Infos\Cable.cfg" "$INSTDIR\cstrike\userconfig.cfg"<br />notCable:<br /><br />ReadINIStr $R0 "$PLUGINSDIR\ioFile.ini" "Field 1" "State"<br />StrCmp $R0 "Q-DSL" 0 notQ-DSL<br />${FileJoin} "$INSTDIR\cstrike\userconfig.cfg" "$INSTDIR\Infos\Q-DSL.cfg" "$INSTDIR\cstrike\userconfig.cfg"<br />notQ-DSL:<br /><br />ReadINIStr $R0 "$PLUGINSDIR\ioFile.ini" "Field 1" "State"<br />StrCmp $R0 "DSL mit FP" 0 notDSL mit FP<br />${FileJoin} "$INSTDIR\cstrike\userconfig.cfg" "$INSTDIR\Infos\DSL mit FP.cfg" "$INSTDIR\cstrike\userconfig.cfg"<br />notDSL mit FP:<br /><br />FunctionEnd<br /></code>
</pre><br />
      <br />
      This is the code for the netsetting page
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Sp33dy Gonzale$</span><br />
      <span class="post-time small text-muted">24th July 2005 13:20 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Ah sorry i've forgot to write the code from the Netsettings Page<br />
      <br /></p>
      <pre>
<code><br /><br />Function NetsettingsPage<br />!insertmacro SectionFlagIsSet ${Section2} ${SF_SELECTED} ShowPage SkipPage<br />ShowPage:<br /><br />   !insertmacro MUI_HEADER_TEXT "Konfiguration des Erweiterungs System" "Wählen Sie, mit welcher Verbindung sie spielen."<br />   !insertmacro MUI_INSTALLOPTIONS_DISPLAY "netsettings.ini"<br /><br />SkipPage:<br /><br />FunctionEnd<br /><br /></code>
</pre>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Yathosho</span><br />
      <span class="post-time small text-muted">24th July 2005 14:27 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">there's a space in <b>StrCmp $R0 "56K Modem" 0 not56K Modem</b>, so it's being interpreted as 5 parameters. it should be "not56K-Modem" instead.<br />
      <br />
      same with "notDSL mit FP".</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Sp33dy Gonzale$</span><br />
      <span class="post-time small text-muted">24th July 2005 15:29 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Hy,<br />
      <br />
      thank you it compiles successfully. And the custom page starts too. But the e.g. LAN.cfg does't connect with the userconfig.cfg. Is it possible that file join doesn't works with *.cfg ?<br />
      <br />
      What could I do that it works?<br />
      <br />
      Thank you<br />
      <br />
      Marc</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Sp33dy Gonzale$</span><br />
      <span class="post-time small text-muted">24th July 2005 16:36 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Hy,<br />
      <br />
      thank you it compiles successfully. And the custom page starts too. But the e.g. LAN.cfg does't connect with the userconfig.cfg. Is it possible that file join doesn't works with *.cfg ?<br />
      <br />
      What could I do that it works?<br />
      <br />
      Thank you<br />
      <br />
      Marc</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
      <span class="post-time small text-muted">24th July 2005 19:55 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Just a guess but it could be because of this:<br />
      ${FileJoin} "<b>$INSTDIR\cstrike\userconfig.cfg</b>" "$INSTDIR\Infos\Cable.cfg" "<b>$INSTDIR\cstrike\userconfig.cfg</b>"<br />
      <br />
      The function will probably be reading from userconfig.cfg and trying to write to userconfig.cfg at the same time which will not work.<br />
      Make the last parameter "$INSTDIR\cstrike\userconfig.cfg.x" and then do:<br /></p>
      <pre>
<code>Delete "$INSTDIR\cstrike\userconfig.cfg"<br />Rename "$INSTDIR\cstrike\userconfig.cfg.x" "$INSTDIR\cstrike\userconfig.cfg"</code>
</pre><br />
      <br />
      -Stu
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Sp33dy Gonzale$</span><br />
      <span class="post-time small text-muted">25th July 2005 08:02 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Hy i've tried to make it with copy files:<br />
      <br /></p>
      <pre>
<code><br />; Netsettings Page<br />Function NetsettingsPage<br />!insertmacro SectionFlagIsSet ${Section3} ${SF_SELECTED} ShowPage SkipPage<br />ShowPage:<br /><br />   !insertmacro MUI_HEADER_TEXT "Konfiguration des Erweiterungs System" "Wählen Sie, mit welcher Verbindung sie spielen."<br />   !insertmacro MUI_INSTALLOPTIONS_DISPLAY "netsettings.ini"<br /><br />SkipPage:<br /><br />FunctionEnd<br /><br />; Page Leave Netsettings<br />Function PageLeaveNetsettings<br /><br />ReadINIStr $R0 "$PLUGINSDIR\ioFile.ini" "Field 1" "State"<br />StrCmp $R0 "LAN" 0 notLAN<br />CopyFiles /silent $INSTDIR\Infos\Netsettings\LAN\netsettings.cfg $INSTDIR\cstrike<br />CopyFiles /silent $INSTDIR\Infos\Netsettings\LAN\netsettings.cfg $INSTDIR\cstrike_german<br />notLAN:<br /><br /><br />ReadINIStr $R0 "$PLUGINSDIR\ioFile.ini" "Field 1" "State"<br />StrCmp $R0 "56K Modem" 0 not56K_Modem<br />CopyFiles /silent $INSTDIR\Infos\Netsettings\56K_Modem\netsettings.cfg $INSTDIR\cstrike<br />CopyFiles /silent $INSTDIR\Infos\Netsettings\56K_Modem\netsettings.cfg $INSTDIR\cstrike_german<br />not56K_Modem:<br /><br /><br />ReadINIStr $R0 "$PLUGINSDIR\ioFile.ini" "Field 1" "State"<br />StrCmp $R0 "ISDN" 0 notISDN<br />CopyFiles /silent $INSTDIR\Infos\Netsettings\ISDN\netsettings.cfg $INSTDIR\cstrike<br />CopyFiles /silent $INSTDIR\Infos\Netsettings\ISDN\netsettings.cfg $INSTDIR\cstrike_german<br />notISDN:<br /><br />ReadINIStr $R0 "$PLUGINSDIR\ioFile.ini" "Field 1" "State"<br />StrCmp $R0 "D-ISDN" 0 notD-ISDN<br />CopyFiles /silent $INSTDIR\Infos\Netsettings\D-ISDN\netsettings.cfg $INSTDIR\cstrike<br />CopyFiles /silent $INSTDIR\Infos\Netsettings\D-ISDN\netsettings.cfg $INSTDIR\cstrike_german<br />notD-ISDN:<br /><br />ReadINIStr $R0 "$PLUGINSDIR\ioFile.ini" "Field 1" "State"<br />StrCmp $R0 "S-DSL" 0 notS-DSL<br />CopyFiles /silent $INSTDIR\Infos\Netsettings\S-DSL\netsettings.cfg $INSTDIR\cstrike<br />CopyFiles /silent $INSTDIR\Infos\Netsettings\S-DSL\netsettings.cfg $INSTDIR\cstrike_german<br />notS-DSL:<br /><br />ReadINIStr $R0 "$PLUGINSDIR\ioFile.ini" "Field 1" "State"<br />StrCmp $R0 "A-DSL" 0 notA-DSL<br />CopyFiles /silent $INSTDIR\Infos\Netsettings\A-DSL\netsettings.cfg $INSTDIR\cstrike<br />CopyFiles /silent $INSTDIR\Infos\Netsettings\A-DSL\netsettings.cfg $INSTDIR\cstrike_german<br />notA-DSL:<br /><br />ReadINIStr $R0 "$PLUGINSDIR\ioFile.ini" "Field 1" "State"<br />StrCmp $R0 "Cable" 0 notCable<br />CopyFiles /silent $INSTDIR\Infos\Netsettings\Cable\netsettings.cfg $INSTDIR\cstrike<br />CopyFiles /silent $INSTDIR\Infos\Netsettings\Cable\netsettings.cfg $INSTDIR\cstrike_german<br />notCable:<br /><br />ReadINIStr $R0 "$PLUGINSDIR\ioFile.ini" "Field 1" "State"<br />StrCmp $R0 "Q-DSL" 0 notQ-DSL<br />CopyFiles /silent $INSTDIR\Infos\Netsettings\Q-DSL\netsettings.cfg $INSTDIR\cstrike<br />CopyFiles /silent $INSTDIR\Infos\Netsettings\Q-DSL\netsettings.cfg $INSTDIR\cstrike_german<br />notQ-DSL:<br /><br />ReadINIStr $R0 "$PLUGINSDIR\ioFile.ini" "Field 1" "State"<br />StrCmp $R0 "DSL mit FP" 0 notDSL_mit_FP<br />CopyFiles /silent $INSTDIR\Infos\Netsettings\DSL_mit_FP\netsettings.cfg $INSTDIR\cstrike<br />CopyFiles /silent $INSTDIR\Infos\Netsettings\DSL_mit_FP\netsettings.cfg $INSTDIR\cstrike_german<br />notDSL_mit_FP:<br /><br />FunctionEnd<br /></code>
</pre><br />
      <br />
      But it doesn't work. It doesn't copy the netsettings.cfg.<br />
      <br />
      Do anybody know why it doesn't work.
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">deguix</span><br />
      <span class="post-time small text-muted">25th July 2005 11:37 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">You need to create directories first for the CopyFiles target directories (example: "$INSTDIR\cstrike"). Use CreateDirectory instruction to create those directories. Or maybe the files indicated to copy don't exist. Please explain the situation more, like, put a MessageBox instruction on the start of the page leave function and verify which files or directories exist or not.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Sp33dy Gonzale$</span><br />
      <span class="post-time small text-muted">25th July 2005 13:05 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Hy all the directories exists.<br />
      <br />
      And all Files, too.<br />
      <br />
      But I don't know why it isn't works<br />
      <br />
      I've made an short installer.<br />
      <br />
      Could anybody show why it doesn't works ?<br />
      <br />
      Thank you</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Sp33dy Gonzale$</span><br />
      <span class="post-time small text-muted">27th July 2005 19:51 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Haven't you an idea?<br />
      <br />
      Please help me</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">iceman_k</span><br />
      <span class="post-time small text-muted">27th July 2005 21:36 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Try this.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Sp33dy Gonzale$</span><br />
      <span class="post-time small text-muted">28th July 2005 11:24 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Hy thank you it works (-: (-:<br />
      <br />
      Is it possible, that the user can only click on next when he has choose an option?<br />
      <br />
      In the netsettings.ini the State is :<br />
      <br />
      State=<br />
      <br />
      So there is an white field and when this white field is active the user shouldn't not click on next.<br />
      <br />
      How can I do this ?<br />
      <br />
      Thank you</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">iceman_k</span><br />
      <span class="post-time small text-muted">28th July 2005 16:23 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">In the custom page leave function, call Abort if the state is blank. Maybe also show a message box with the error to the user.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Sp33dy Gonzale$</span><br />
      <span class="post-time small text-muted">29th July 2005 07:53 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Hy isn't it possible only to make the next botton transparent and when the user has choose an option he can click on next?<br />
      <br />
      Like in the Install page. There the user can't click on abort.<br />
      <br />
      Can you give me an example ?<br />
      <br />
      <br />
      Thank you</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Sp33dy Gonzale$</span><br />
      <span class="post-time small text-muted">30th July 2005 10:04 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">PLS HELP ME</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">iceman_k</span><br />
      <span class="post-time small text-muted">30th July 2005 13:12 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Search the forum- this question has been asked before.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Sp33dy Gonzale$</span><br />
      <span class="post-time small text-muted">31st July 2005 09:25 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Hy I've search but I can't find it.<br />
      <br />
      My english isn't very good so it is difficult to understand.<br />
      <br />
      Pls help me.<br />
      <br />
      Can you write the code in the drop list.nsi which iceman_k has writes?<br />
      <br />
      Pls it would be very friendly when you help me.</p>
    </div>
    <hr />

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]>
  </script>
</body>
</html>
