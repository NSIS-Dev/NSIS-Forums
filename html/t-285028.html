<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="NSIS, Launch4j and VISTA" />

  <title>NSIS, Launch4j and VISTA - NSIS Forums</title>
  <script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script>
  <!-- Bootstrap core CSS -->

  <link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css" />
  <link rel="stylesheet" href="../css/style.css" type="text/css" /><!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!--[if lt IE 9]>
                <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
                <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->
</head>

<body>
  <div class="container">
    <!-- Put navigation bar here -->

    <ol class="breadcrumb">
      <li><a href="../index.html" class="glyphicon glyphicon-home"></a></li>

      <li><a href="f-65.html">NSIS Discussion</a></li>

      <li class="active">NSIS, Launch4j and VISTA</li>
    </ol>

    <p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=285028">NSIS, Launch4j and VISTA</a></p><br />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">only_johhny</span><br />
      <span class="post-time small text-muted">15th January 2008 15:49 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>NSIS, Launch4j and VISTA</strong><br />
      hello everybody,<br />
      <br />
      I have problems with my french java software installation under Vista in simple user mode...<br />
      <br />
      I install my software on VISTA with NSIS 2.31 in admin privilege mode (normal, i'am install soft in 'program file' dir, i doesn't have the choice sorry)...<br />
      <br />
      Install, uninstall Exe (files and shortcuts) need admin privilege mode (normal) and my EXE file (doing with launch4j who launch my main class with JAVA) not need to be launch in admin privilege mode....<br />
      <br />
      Problem:<br />
      --------<br />
      VISTA said my launch4j exe file must be launch in Admin mode !!! impossible to remove this VISTA privilege requirement, VISTA doesn't want and i don't know why ...<br />
      <br />
      I have try UAC plugin, SetShellVarContext on shortcuts creation, see on launch4j web site, see if not vista manifest are present etc.... i doesn't have solution, i don't understand :( :(<br />
      <br />
      please, i need help, thanks...</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Anders</span><br />
      <span class="post-time small text-muted">15th January 2008 16:08 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">you need a exe manifest that tells vista it does not need to elevate<br />
      <br />
      for nsis applications, this is done with RequestExecutionLevel user, for 3rd party stuff, you need to add the manifest yourself, either as a resource in the exe, or as a xml file with the same base name as the exe, example "myprogram.exe.manifest"</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">only_johhny</span><br />
      <span class="post-time small text-muted">15th January 2008 16:32 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">thanks a lot :) it's working !!...<br />
      <br />
      I'm very surprise cause i have already tested a other software i have made with launch4j under vista in simple user account(but in IS 5.1) and it was working good (no admin privilege needed) without put manifest on install...<br />
      <br />
      -&gt; Herited privileges from NSIS installer for all the files installed ???<br />
      <br />
      thanks a lot for your help :up: you save my a lot of time... :)</p>
    </div>
    <hr />

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]>
  </script>
</body>
</html>
