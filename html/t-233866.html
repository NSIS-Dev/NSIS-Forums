<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="Set Focus to a Field" />

  <title>Set Focus to a Field - NSIS Forums</title>
  <script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script>
  <!-- Bootstrap core CSS -->

  <link rel="stylesheet" type="text/css" href="//netdna.bootstrapcdn.com/bootswatch/3.0.1/readable/bootstrap.min.css" />
  <link rel="stylesheet" href="../css/style.css" type="text/css" /><!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!--[if lt IE 9]>
                <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
                <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->
</head>

<body>
  <div class="container">
    <!-- Put navigation bar here -->

    <ol class="breadcrumb">
      <li><a href="../index.html" class="glyphicon glyphicon-home"></a></li>

      <li><a href="f-65.html">NSIS Discussion</a></li>

      <li class="active">Set Focus to a Field</li>
    </ol>

    <p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=233866">Set Focus to a Field</a></p><br />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">MikeSchinkel</span><br />
      <span class="post-time small text-muted">23rd December 2005 13:02 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>Set Focus to a Field</strong><br />
      I'm trying to use the function on the wiki <a href="http://nsis.sourceforge.net/Set_Focus_to_a_Control" target="_blank">Set Focus to a Control</a> but there is only an abstract function call syntax and no tangible working example and I'm having a hard time figuring out how to call it.<br />
      <br />
      Can someone please help and give me a real simple example that would set the focus to the first text field in a custom dialog? Better yet, add it to the wiki too?<br />
      <br />
      Thanks in advance.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
      <span class="post-time small text-muted">23rd December 2005 15:27 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">It is quite simple really.<br />
      <br /></p>
      <pre>
<code>Page Custom ShowCustom1<br /><br />Var HWND<br /><br />Function .onInit<br />  !insertmacro MUI_INSTALLOPTIONS_EXTRACT "ioFile.ini"<br />FunctionEnd<br /><br />Function ShowCustom1<br /><br />  !insertmacro MUI_HEADERTEXT "blah" "blah"<br /><br />  !insertmacro MUI_INSTALLOPTIONS_INITDIALOG "ioFile.ini"<br />  Pop $HWND ;HWND (handle) of dialog<br /><br />    Push "$PLUGINSDIR\ioFile.ini" ;Page .ini file where the field can be found.<br />    Push "$HWND" ;Page handle you got when reserving the page.<br />    Push "1" ;Field number to set focus.<br />    Call SetFocus<br /><br />  !insertmacro MUI_INSTALLOPTIONS_SHOW<br /><br />FunctionEnd</code>
</pre><br />
      <br />
      -Stu
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">********</span><br />
      <span class="post-time small text-muted">23rd January 2007 19:32 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">From version 2.24 InstallOptions has native FOCUS flag</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Comm@nder21</span><br />
      <span class="post-time small text-muted">23rd January 2007 20:22 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">NSIS version 2.24 is still to be released :)<br />
      <br />
      InstallOptions will be v2.45 then.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">darshanaltekar</span><br />
      <span class="post-time small text-muted">20th March 2007 05:46 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">SetFocus is not working can anyone tell me why?<br />
      <br />
      <br />
      Page custom organisation_id_pre organisation_id_leave<br />
      <br />
      function organisation_id_pre<br />
      strcmp $ALREADY_INSTALLED "YES" 0 +2<br />
      abort<br />
      !insertmacro MUI_HEADER_TEXT "Required Information" "Please enter following required information"<br />
      InstallOptions::Dialog "$PLUGINSDIR\Organisation_id.ini"<br />
      Pop $HWND_org_id<br />
      functionend<br />
      <br />
      <br />
      <br />
      function organisation_id_leave<br />
      ReadINIStr $0 "$PLUGINSDIR\Organisation_id.ini" 'Field 2' "State" ;l$ip_addr "$PLUGINSDIR\Organisation_id.ini" 'Field 4' "State"<br />
      ReadINIStr $1 "$PLUGINSDIR\Organisation_id.ini" 'Field 3' "State"<br />
      ReadINIStr $2 "$PLUGINSDIR\Organisation_id.ini" 'Field 4' "State"<br />
      ReadINIStr $3 "$PLUGINSDIR\Organisation_id.ini" 'Field 5' "State"<br />
      <br />
      ${If} $0 &gt; '255'<br />
      messagebox mb_ok "IP address not valid from IP field 1"<br />
      Push "$PLUGINSDIR\Organisation_id.ini" ;Page .ini file where the field can be found.<br />
      Push "$HWND_org_id" ;Page handle you got when reserving the page.<br />
      Push "2" ;Field number to set focus.<br />
      Call SetFocus<br />
      !insertmacro MUI_INSTALLOPTIONS_SHOW<br />
      ; WriteINIStr "$PLUGINSDIR\Organisation_id.ini" 'Field 2' 'Flags' 'FOCUS'<br />
      ; FlushINI $TEMP\something.ini<br />
      ; !insertmacro MUI_INSTALLOPTIONS_READ $R1 "$PLUGINSDIR\Organisation_id.ini" "Field 2" "HWND"<br />
      ; SendMessage $R1 ${WM_SETFOCUS} 0 0<br />
      ; SendMessage $R1 ${WM_SETTEXT} 0 "STR:8080"<br />
      ; abort<br />
      ${EndIf}</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
      <span class="post-time small text-muted">20th March 2007 20:36 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Don't call MUI_INSTALLOPTIONS_SHOW in the leave function. That should only be called in the page callback function (organistaion_id_pre in your case).</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">darshanaltekar</span><br />
      <span class="post-time small text-muted">21st March 2007 11:03 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">If i dont display the page again how the chages will get reflect in UI ?</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
      <span class="post-time small text-muted">21st March 2007 20:56 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">If you call Abort, the page isn't left. If you call InstallOptions again, you just create another page with the old settings and will create trouble when the pages are destroyed.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">darshanaltekar</span><br />
      <span class="post-time small text-muted">22nd March 2007 13:01 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Then what i should i do to reflect the changes</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
      <span class="post-time small text-muted">23rd March 2007 08:35 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">As I said, call Abort.</p>
      <pre>
<code>Function leave<br />Abort # in case leaving the page should be stopped...<br />FunctionEnd</code>
</pre>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">mrtech</span><br />
      <span class="post-time small text-muted">20th July 2007 18:32 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">I was able to use this thread to set focus to a known field number, but how do I focus the next button?</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
      <span class="post-time small text-muted">20th July 2007 18:40 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"></p>
      <pre>
<code>!include WinMessages.nsh<br />#...<br />GetDlgItem $0 $HWNDPARENT 1<br />SendMessage $HWNDPARENT ${WM_NEXTDLGCTL} $0 1</code>
</pre>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">mrtech</span><br />
      <span class="post-time small text-muted">20th July 2007 19:05 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">tried a few things, but where in this logic would that go, i've commented out what I have my hacky SetFocus to remove focus from the text object that I have in there:<br />
      <br /></p>
      <pre>
<code><br />  !insertmacro MUI_INSTALLOPTIONS_INITDIALOG "eula.ini"<br /><br />  Pop $HWND ;HWND of dialog<br /><br />  ; this removes the focus from the text field on my custom<br />  ; form so that pressing enter continues the install flow.<br />  ;Push "eula.ini"found.<br />  ;Push "$HWND"<br />  ;Push "7" ; this is a custom label<br />  ;Call SetFocus<br /><br />  Call SetOtherGoodies ; <br /><br />  ; Now show the dialog<br />  !insertmacro MUI_INSTALLOPTIONS_SHOW<br /></code>
</pre>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
      <span class="post-time small text-muted">20th July 2007 19:10 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Ah, you want the focus to go there right away. I don't think that'd be possible without modifying InstallOptions. But why do it? Since the next button is the default button, it'd still go to the next page when you hit enter.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">mrtech</span><br />
      <span class="post-time small text-muted">20th July 2007 19:12 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">that's just it, it doesn't I have call just after the Pop to:<br />
      <br />
      !insertmacro MUI_INSTALLOPTIONS_READ $DLGITEM "eula.ini" "Field 4" "HWND"<br />
      SetCtlColors $DLGITEM 0x000000 0xFFFFFF<br />
      <br />
      Field 4 is my text box, focus is put there and pressing enter doesn't work.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
      <span class="post-time small text-muted">20th July 2007 19:14 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Have you tried using the FOCUS flag instead?</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">mrtech</span><br />
      <span class="post-time small text-muted">20th July 2007 19:18 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">that's another one, where does the focus flag go for the next button? been trying to do searches here in the forums for about 15-20 minutes, but no examples of where to use the focus flags, etc. pardon my moronic ways...</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
      <span class="post-time small text-muted">20th July 2007 19:20 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Not for the Next button, for the control you want focus for. Without any settings, the first control should receive focus and the Next button should still be the default button, so pressing enter should still go to the next page.<br />
      <br />
      There is no setting to set focus to the Next button, because there shouldn't be any need to do that.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">mrtech</span><br />
      <span class="post-time small text-muted">20th July 2007 19:29 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">how do I set the focus flag to one of my controls?</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
      <span class="post-time small text-muted">20th July 2007 19:32 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Just add Flags=FOCUS in the INI file.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">mrtech</span><br />
      <span class="post-time small text-muted">20th July 2007 19:38 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">ok, I had tried that on the label and link controls just to get the focus off of the text control, but I have to see what's up. thanks.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
      <span class="post-time small text-muted">20th July 2007 19:43 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">It won't work on those controls. It knows which controls can receive focus and will ignore the flag if they can't. But weren't you saying you wanted the focus on the Next button rather than off it?</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">mrtech</span><br />
      <span class="post-time small text-muted">20th July 2007 19:46 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">yeah, but if I can get the focus off the text control (as I have done with the SetFocus function) then the Next button will behave like the default button and continue when pressing enter.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
      <span class="post-time small text-muted">20th July 2007 19:48 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">It should behave that way with or without focus.<br />
      <br />
      How about you attach an example? I'm starting to get confused about what exactly happens and what exactly you want.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">mrtech</span><br />
      <span class="post-time small text-muted">20th July 2007 20:41 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">here's a stripped version of what I'm trying to do, thanks.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
      <span class="post-time small text-muted">20th July 2007 20:43 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">What's the BackButton plug-in?</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">mrtech</span><br />
      <span class="post-time small text-muted">20th July 2007 20:47 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">oops just remove that puppy</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
      <span class="post-time small text-muted">20th July 2007 20:54 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Ah, you didn't mention it's a multiline text field. It might have the same bug as with the richedit control where it eats up Enter and Escape even though it doesn't have the ES_WANTRETURN style. Instead of leaving them be, it acts on the dialog manager's behalf and sends WM_COMMAND to IDOK or WM_CLOSE to its parent dialog. But its parent dialog is just a internal dialog which doesn't handle this. Unlike richedit, edit controls don't have EN_MSGFILTER so if it's really the case, it'd require subclassing.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">mrtech</span><br />
      <span class="post-time small text-muted">20th July 2007 20:56 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">ok, I'll stick with my SetFocus hack for now, thanks.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
      <span class="post-time small text-muted">8th September 2007 20:48 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><a href="http://blogs.msdn.com/oldnewthing/archive/2007/08/20/4470527.aspx" target="_blank">Raymond Chen</a> confirms this is the same bug as with the Rich Edit control. His post also links to another post stating the solution, similar to what Sunjammer used for the RichEdit. I need to think how this can be implemented for nsDialogs as you obviously do want the controls eat the Enter key in some cases.</p>
    </div>
    <hr />

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]>
  </script>
</body>
</html>
