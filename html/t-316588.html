<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="Hiding finish page run program check box" />

  <title>Hiding finish page run program check box - NSIS Forums</title><!-- Bootstrap core CSS -->
  <link rel="stylesheet" type="text/css" href="//netdna.bootstrapcdn.com/bootswatch/3.0.1/readable/bootstrap.min.css" />
  <link rel="stylesheet" href="../css/style.css" type="text/css" /><!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!--[if lt IE 9]>
                <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
                <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->
</head>

<body>
  <div class="container">
    <!-- Put navigation bar here -->

    <ol class="breadcrumb">
      <li><a href="../index.html" class="glyphicon glyphicon-home"></a></li>

      <li><a href="f-65.html">NSIS Discussion</a></li>

      <li class="active">Hiding finish page run program check box</li>
    </ol>

    <p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=316588">Hiding finish page run program check box</a></p><br />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">jammusi</span><br />
      <span class="post-time small text-muted">27th January 2010 10:58 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>Hiding finish page run program check box</strong><br />
      Hi,<br />
      1. I'm trying to hide the finish page run text box (added with !define MUI_FINISHPAGE_RUN)<br />
      <br />
      2. This check box is defined for both Install and uninstall finish pages<br />
      <br />
      3. This is how i try to do that (within the finish page show page call back)<br />
      <br />
      <b><br />
      ;Find the internal window in the finish page<br />
      FindWindow $5 "#32770" "" $HWNDPARENT<br />
      <br />
      ;Get the check box handle<br />
      GetDlgItem $3 $5 "1203" ; 1203 - control id<br />
      <br />
      ;uncheck it<br />
      SendMessage $3 ${WM_LBUTTONDOWN} 0 0<br />
      SendMessage $3 ${WM_LBUTTONUP} 0 0 ;<br />
      <br />
      ;Hide the window<br />
      ShowWindow $3 ${SW_HIDE}<br /></b><br />
      <br />
      4. The problem is that this is not working always<br />
      <br />
      For example:</p>

      <ul>
        <li>If i display only the welcome and finish pages - it works</li>

        <li>If I add any other page (say Install files page) it doesn't work.</li>
      </ul><br />
      Debugging using dumpstate and WinSpy++ I can see that in the second case the code line<br />
      <b>FindWindow $5 "#32770" "" $HWNDPARENT</b><br />
      does not return the handle to the internal window but rather to another window I can not recognize - thus the check box is not found and the all thing does not succeed<br />
      <br />
      <u>Any idea why?</u><br />
      <br />
      5. Also I read in the thread <b>forums.winamp.com/showthread.php?postid=1364382</b> about the $MUI_HWND that is supposed to hold the internal windows handle. but this one is not populated for me.<br />
      <br />
      <u>Ideas please?</u><br />
      <br />
      Tx<br />
      <br />
      Jammusi
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">jpderuiter</span><br />
      <span class="post-time small text-muted">27th January 2010 11:39 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">First of all, why creating a checkbox, and then later hide it?<br />
      Or do you do that conditionally?<br />
      <br />
      Anyway, have a look at these threads:<br />
      <a href="http://forums.winamp.com/showthread.php?s=&amp;threadid=291799" target="_blank">http://forums.winamp.com/showthread....hreadid=291799</a><br />
      <a href="http://forums.winamp.com/showthread.php?s=&amp;threadid=273029" target="_blank">http://forums.winamp.com/showthread....hreadid=273029</a><br />
      <a href="http://forums.winamp.com/showthread.php?s=&amp;threadid=248633" target="_blank">http://forums.winamp.com/showthread....hreadid=248633</a></p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">jammusi</span><br />
      <span class="post-time small text-muted">27th January 2010 12:01 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">1. Yes I do conditionally ;-)<br />
      <br />
      2. The first link suggest using $mui.FinishPage for MUI2 and that $MUI_HWND does not work for MUI1 - this answer the second question. Cool but still<br />
      <br />
      What to do with $mui.FinishPage - can not find documentation for that<br />
      <br />
      3. Unless i miss something - it seems that the other links do the same as me</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
      <span class="post-time small text-muted">27th January 2010 15:02 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">The check box handle should already be stored in $mui.FinishPage.Run.<br />
      <br />
      Stu</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">jammusi</span><br />
      <span class="post-time small text-muted">27th January 2010 17:58 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Yep - mui.FinishPage.Run<br />
      That's the answer<br />
      <br />
      Thanks<br />
      <br />
      <b><u>BUT</u></b><br />
      <br />
      It took me few hours to understand the problem<br />
      <br />
      When I reference the mui.FinishPage.Run within the nsi file - all good<br />
      <br />
      I have though another nsi file holding common functions, which i include in some scripts.<br />
      The function hiding the checkbox is defined there.<br />
      It seems in that case the mui.FinishPage.Run was not defined as:<br />
      <b>StrCpy $0 $mui.FinishPage.Run</b><br />
      <br />
      Leaves $0 have the string value <b>"$mui.FinishPage.Run"</b> rather than the handle.<br />
      <br />
      Why is that?</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">MSG</span><br />
      <span class="post-time small text-muted">27th January 2010 21:37 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"></p>

      <blockquote>
        I have though another nsi file holding common functions, which i include in some scripts.<br />
        The function hiding the checkbox is defined there.<br />
        It seems in that case the mui.FinishPage.Run was not defined as:<br />
        <b>StrCpy $0 $mui.FinishPage.Run</b><br />
        <br />
        Leaves $0 have the string value <b>"$mui.FinishPage.Run"</b> rather than the handle.<br />
        <br />
        Why is that?
      </blockquote>That's because you included the common functions file before you included MUI2.nsh. Reverse the order and it should work. (Although perhaps you also need to define the pages before the variable becomes active, I'm not sure. Try it out.)<br />
      <br />
      <br />
      <br />
      Edit: On second thought... If a variable doesn't exist, it shouldn't become a string, should it? The value becoming "$mui.FinishPage.Run" seems rather weird. o__O
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">jammusi</span><br />
      <span class="post-time small text-muted">27th January 2010 22:07 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">I include mui2 first</p>
    </div>
    <hr />

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]>
  </script>
</body>
</html>
