<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="description" content="How can I add a shortcut to Startup folder?"><title>How can I add a shortcut to Startup folder? - NSIS Forums</title><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script><link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css"><link rel="stylesheet" href="../css/style.css" type="text/css"></head><body><div class="container"><ol class="breadcrumb"><li><a href="../index.html" class="glyphicon glyphicon-home"></a></li><li><a href="f-65.html">NSIS Discussion</a></li><li class="active">How can I add a shortcut to Startup folder?</li></ol><p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=245920">How can I add a shortcut to Startup folder?</a></p><br><div class="post"><p class="post-meta"><span class="post-author text-primary">Angry Coder</span><br><span class="post-time small text-muted">11th May 2006 02:27 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>How can I add a shortcut to Startup folder?</strong><br>Hello,<br><br>I am wondering how I add a shortcut of my program to Startup folder?<br><br>Please help. Thanks.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Comperio</span><br><span class="post-time small text-muted">11th May 2006 02:57 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"></p><pre>
<code><br>CreateShortCut "$SMPROGRAMS\Startup\My Program.lnk" "$INSTDIR\My Program.exe" \<br>  "some command line parameters" "$INSTDIR\My Program.exe" 2 SW_SHOWNORMAL \<br>  ALT|CTRL|SHIFT|F5 "a description"<br></code>
</pre><br>
      A Few notes:

      <ul>
        <li>$SMPROGRRAMS is a constant for the programs folder under the start menu. Default is for the user's start menu. For all users, use SetShellVarContext. Refer to NSIS help for more info</li>

        <li>The example CreateShortcut command is from the help files. For a complete list of all the options, refer to NSIS help files</li>
      </ul>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Angry Coder</span><br>
      <span class="post-time small text-muted">11th May 2006 03:14 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Thanks!<br>
      <br>
      What's "some command line parameters" or "a description"?<br>
      <br>
      Should I leave it as is?</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Comperio</span><br>
      <span class="post-time small text-muted">11th May 2006 03:20 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">"some command line parameters"<br>
      This would be extra command line parmaters for the EXE. Normally, this would be null ("").<br>
      <br>
      "a desciption"<br>
      This can be anything you want. It just serves as a way to describe the shortcut. It can be blank if you wish.</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Angry Coder</span><br>
      <span class="post-time small text-muted">11th May 2006 03:51 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Really appreciate your help. Thanks :)</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Angry Coder</span><br>
      <span class="post-time small text-muted">11th May 2006 04:05 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">But the <b>shortcut icon</b> is not showing. I am getting the default windows exe icon :(<br>
      <br>
      What's wrong?</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">JasonFriday13</span><br>
      <span class="post-time small text-muted">11th May 2006 05:19 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Keep it simple:<br></p>
      <pre>
<code>CreateShortCut "$SMPROGRAMS\Startup\My Program.lnk" "$INSTDIR\My Program.exe"</code>
</pre>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Anders</span><br>
      <span class="post-time small text-muted">11th May 2006 10:21 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">the correct folder variable is $SMSTARTUP not $SMPROGRAMS\Startup so the instructions should be: CreateShortCut "$SMSTARTUP\My Program.lnk" "$INSTDIR\My Program.exe"</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">JasonFriday13</span><br>
      <span class="post-time small text-muted">11th May 2006 22:47 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Good point. Our mistake.</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Angry Coder</span><br>
      <span class="post-time small text-muted">11th May 2006 23:54 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Thanks guys for your follow-ups. But as I have mentionned:<br>
      <br>
      The shortcut icon is not showing. I am getting the default windows exe icon... What's wrong?</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Comperio</span><br>
      <span class="post-time small text-muted">12th May 2006 02:57 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Is it just the icon that is messed up or is the entire shortcut screwed up? What was the exact command you used in your script?</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Angry Coder</span><br>
      <span class="post-time small text-muted">12th May 2006 03:02 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Everything is working fine, but the icon is not showing up.<br>
      <br>
      SetShellVarContext all<br>
      <br>
      CreateShortCut "$SMSTARTUP\my prog.lnk" "$INSTDIR\my prog.exe" \<br>
      "" "$INSTDIR\my prog.exe" 2 SW_SHOWNORMAL \<br>
      ALT|CTRL|SHIFT|F5 "Do not delete this shortcut!"<br>
      <br>
      I found this on the manual but I didn't get it.<br>
      <br></p>

      <blockquote>
        4.9.3.4 CreateShortCut<br>
        link.lnk target.file [parameters [icon.file [icon_index_number [start_options [keyboard_shortcut [description]]]]]]<br>
        Creates a shortcut 'link.lnk' that links to 'target.file', with optional parameters 'parameters'. The icon used for the shortcut is 'icon.file,icon_index_number'; for default icon settings use empty strings for both icon.file and icon_index_number. start_options should be one of: SW_SHOWNORMAL, SW_SHOWMAXIMIZED, SW_SHOWMINIMIZED, or an empty string. keyboard_shortcut should be in the form of 'flag|c' where flag can be a combination (using |) of: ALT, CONTROL, EXT, or SHIFT. c is the character to use (a-z, A-Z, 0-9, F1-F24, etc). Note that no spaces are allowed in this string. A good example is "ALT|CONTROL|F8". $OUTDIR is used for the working directory. You can change it by using SetOutPath before creating the Shortcut. description should be the description of the shortcut, or comment as it is called under XP. The error flag is set if the shortcut cannot be created (i.e. either of the paths (link or target) does not exist, or some other error).<br>
        <br>
        CreateDirectory "$SMPROGRAMS\My Company"<br>
        CreateShortCut "$SMPROGRAMS\My Company\My Program.lnk" "$INSTDIR\My Program.exe" \<br>
        "some command line parameters" "$INSTDIR\My Program.exe" 2 SW_SHOWNORMAL \<br>
        ALT|CTRL|SHIFT|F5 "a description"
      </blockquote>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Angry Coder</span><br>
      <span class="post-time small text-muted">12th May 2006 03:08 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Ok, it worked when I did:<br>
      <br>
      CreateShortCut "$SMSTARTUP\My Program.lnk" "$INSTDIR\My Program.exe" "hourglass.ico"<br>
      <br>
      But how can I add the comment: "Do not delete this shortcut"?</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Angry Coder</span><br>
      <span class="post-time small text-muted">12th May 2006 03:11 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">And...<br>
      <br>
      This is not working also:<br>
      <br>
      Section "Uninstall"<br>
      <br>
      Delete "$INSTDIR\Uninstall My Program.exe"<br>
      Delete "$INSTDIR\My Program.exe"<br>
      RMDir $INSTDIR<br>
      Delete "$SMSTARTUP\My Program.lnk" &lt;------- Everything is ok, except this line. It doesn't remove the shortcut!<br>
      <br>
      SectionEnd<br>
      <br>
      Please help. Thanks.</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">JasonFriday13</span><br>
      <span class="post-time small text-muted">12th May 2006 04:30 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Please, PLEEEEEESE do not double post. They are often ignored, or people will stop posting.<br>
      <br>
      Shortcut description:<br></p>
      <pre>
<code><br>CreateShortCut "$SMPROGRAMS\My Company\My Program.lnk" "$INSTDIR\My Program.exe" "" "hourglass.ico" "" "" "" "a description"</code>
</pre>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Angry Coder</span><br>
      <span class="post-time small text-muted">12th May 2006 05:44 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>It worked</strong><br>
      I'm really, Realllllly sorry :o</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">gbstack</span><br>
      <span class="post-time small text-muted">24th June 2013 07:28 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Actually you can add program path to registry "Run" key as well. If you add program to Start Menu/Startup folder, users can easily remove them by "Right Click-&gt;Delete". <a href="http://redino.net/blog/2013/06/nsis-start-program-automatically-when-windows-starts/" target="_blank">This post</a> describes how to start program automatically in several ways, Also RunOnce key is an available option.</p>
    </div>
    <hr>

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]></script></body></html>