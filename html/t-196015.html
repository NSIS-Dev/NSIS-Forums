<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="Function .onVerifyInstDir" />

  <title>Function .onVerifyInstDir - NSIS Forums</title><!-- Bootstrap core CSS -->
  <link rel="stylesheet" type="text/css" href="//netdna.bootstrapcdn.com/bootswatch/3.0.1/readable/bootstrap.min.css" />
  <link rel="stylesheet" href="../css/style.css" type="text/css" /><!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!--[if lt IE 9]>
                <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
                <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->
</head>

<body>
  <div class="container">
    <!-- Put navigation bar here -->

    <ol class="breadcrumb">
      <li><a href="../index.html" class="glyphicon glyphicon-home"></a></li>

      <li><a href="f-65.html">NSIS Discussion</a></li>

      <li class="active">Function .onVerifyInstDir</li>
    </ol>

    <p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=196015">Function .onVerifyInstDir</a></p><br />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Jnuw</span><br />
      <span class="post-time small text-muted">8th October 2004 19:48 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>Function .onVerifyInstDir</strong><br />
      Hey guys. First off, thanks for all the help I received so far. My installer is almost complete.<br />
      <br />
      I would like to use the .onVerifyInstDir function. However the code I’m using is causing the function to run every time the user changes even 1 letter of the install path. I would like it to only check the install dir. after they hit the "install" button, and return them to the Install Dir page to correct the path if not correct. Here is what I’m using:<br />
      <br />
      ;this is my directory page...<br />
      !insertmacro MUI_PAGE_DIRECTORY<br />
      <br />
      ;<br />
      ;bunch of stuff here...<br />
      ;<br />
      <br />
      Function .onVerifyInstDir<br />
      IfFileExists "$INSTDIR\GPLoans\GPAdmin.exe" 0 NotInGP<br />
      goto End<br />
      NotInGP:<br />
      MessageBox MB_OK|MB_ICONEXCLAMATION "The installation directory you chose, $INSTDIR, is not valid, please choose another."<br />
      Abort<br />
      End:<br />
      FunctionEnd<br />
      <br />
      I have read everything I can about .onVerifyInstDir in the help file and think that I’m missing something in regards to !ifdef, !ifndef, or gflag. However I just can't figure out these terms. Thanks for any help you all can lend.<br />
      <br />
      Jnuw</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">deguix</span><br />
      <span class="post-time small text-muted">8th October 2004 20:15 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">You can't do that with <i>Function .onVerifyInstDir</i> but you can use the leave function of that directory page. I'll give examples for you:<br />
      <br />
      - Modern UI:<br />
      <br />
      Use <i>!define MUI_PAGE_CUSTOMFUNCTION_LEAVE "function"</i> before <i>!insertmacro MUI_PAGE_DIRECTORY</i><br />
      <br />
      - Default UI:<br />
      <br />
      Use <i>Page instfiles "" "" "function"</i><br />
      <br />
      Where "function" is the leave function name. Example:<br />
      <br /></p>
      <pre>
<code>  !define MUI_PAGE_CUSTOMFUNCTION_LEAVE "DirectoryLeave"<br />!insertmacro MUI_PAGE_DIRECTORY<br /><br />Function DirectoryLeave<br />  IfFileExists "$INSTDIR\GPLoans\GPAdmin.exe" End<br />    MessageBox MB_OK|MB_ICONEXCLAMATION "The installation directory you chose, $INSTDIR, is not valid, please choose another."<br />    Abort<br />  End:<br />FunctionEnd</code>
</pre>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Jnuw</span><br />
      <span class="post-time small text-muted">8th October 2004 20:36 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">deguix - You rule. That did the trick. I have not been this happy at work since pizza day. Thanks a bunch.</p>
    </div>
    <hr />

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]>
  </script>
</body>
</html>
