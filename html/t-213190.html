<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="description" content="MUI_FINISHPAGE in modern.exe ?"><title>MUI_FINISHPAGE in modern.exe ? - NSIS Forums</title><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script><link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css"><link rel="stylesheet" href="../css/style.css" type="text/css"></head><body><div class="container"><ol class="breadcrumb"><li><a href="../index.html" class="glyphicon glyphicon-home"></a></li><li><a href="f-65.html">NSIS Discussion</a></li><li class="active">MUI_FINISHPAGE in modern.exe ?</li></ol><p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=213190">MUI_FINISHPAGE in modern.exe ?</a></p><br><div class="post"><p class="post-meta"><span class="post-author text-primary">Huette</span><br><span class="post-time small text-muted">14th April 2005 15:50 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>MUI_FINISHPAGE in modern.exe ?</strong><br>I want to customize the MUI_FINISHPAGE with Resource Hacker, but I can't find the right resource for that dialog. How can I find out where it is, except comparing the dialog-previews in Resource Hacker with my running setup?<br>Thx</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">kichik</span><br><span class="post-time small text-muted">14th April 2005 18:36 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">The finish page is an InstallOptions page, not a normal page found in modern.exe. You can edit ioSpecial.ini in $PLUGINSDIR in the pre function of the welcome and finish page.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Huette</span><br><span class="post-time small text-muted">15th April 2005 09:19 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">hmmm....pre function means?<br>i can't manage to show that label nor the header_text.<br>maybe you can tell me what i'm doing wrong.<br>- first i added a label to the ioSpecial.ini:<br>[Field 4]<br>Type=Label<br>Left=50<br>Right=86<br>Top=134<br>Bottom=142<br>- then i have to extract the ioSpecial.ini in .onInit-Function?<br>!insertmacro MUI_INSTALLOPTIONS_EXTRACT "ioSpecial.ini" doesn't work:<br>"!insertmacro: macro named "MUI_INSTALLOPTIONS_EXTRACT" not found!" ...no idea...<br>- page custom FinishpageEdit<br>!insertmacro MUI_PAGE_FINISH<br><br>- Function FinishpageEdit<br><br>!insertmacro MUI_HEADER_TEXT "Test" "TestSub"<br><br>!insertmacro MUI_INSTALLOPTIONS_DISPLAY "ioSpecial.ini"<br><br>FunctionEnd<br><br>...first edit header_text....if that works own label will follow...<br><br>anything missing? !include headerfile?</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">kichik</span><br><span class="post-time small text-muted">15th April 2005 22:53 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">pre function means MUI_PAGE_CUSTOMFUNCTION_PRE in this case. See the MUI readme for more information about using it.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Huette</span><br><span class="post-time small text-muted">18th April 2005 12:23 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">can somebody describe the function (not the content) of the ioSpecial.ini detailed? or can i read it somewhere?<br><br>instead of adding a new label, now i just try to enlarge the checkbox in the finishpage, so i can set a longer text (in mui languagefile). But where can i set the width and height of it? There are only two labels and one bitmap defined in the ioSpecial.ini . Where comes that checkbox from? In "Local Settings\Temp\" i can find another ioSpecial.ini with the settings of the finishpage (checkbox included), but changes are not decisive.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Huette</span><br><span class="post-time small text-muted">18th April 2005 16:25 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">if i could set the postition of the checkbox it would help me, too, because then i could add the text to the label above the checkbox (why is the label hidden by the checkbox, if it's text gets longer?). strange thing, that checkbox. no own component in modern.exe? integrated into the label? I ain't that hard to add a little text to the finishpage, is it?</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">kichik</span><br><span class="post-time small text-muted">19th April 2005 19:31 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">The MUI edits the INI on runtime according to the defines you add in the script. Take a look at the MUI_FUNCTION_FINISHPAGE macro in Contrib\Modern UI\System.nsh. Notice especially the following line which is called after the MUI finished writing into ioSpecial.ini:</p><pre>
<code>!insertmacro MUI_PAGE_FUNCTION_CUSTOM PRE</code>
</pre>That line calls your PRE function in which you can change ioSpecial.ini.</div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Comperio</span><br><span class="post-time small text-muted">20th April 2005 01:36 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">There's probably other ways to do this, but here's a trick you can use help eliminate some of the guesswork in editing the ioSpecial.ini file while keeping the same general look to the page:<br><br>The ioSpecial.ini file gets created in the plugins directory at runtime. If you were to temporarily insert the following code into your .onInit function, you'd know which folder was the PLUGINS folder:<br></p><pre>
<code><br>InitPluginsDir<br>MessageBox MB_OK "PluginsDir: $PLUGINSDIR"<br></code>
</pre><br>
      <br>
      Once this is in place, execute your installer. Make a note of this path and the click OK. (the path will change each time time you run the install). Continue with the install until you get to the finish page. Then, open the plugins folder. You should see the ioSpecial.ini. Make a copy of this file and store it somewhere. This can then be a "template" you can use to tweak your own page. (I prefer to use the built-in InstallOptions editor from HM NIS EDIT.) Once you know what you need to change, then it's just matter of inserting the proper WriteIniStr commands in your PRE function.<br>
      <br>
      Enjoy!:cool:
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Huette</span><br>
      <span class="post-time small text-muted">20th April 2005 07:25 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">thanks. i finished customizing my finishpage now. didn't really understand the MUI_INSTALLOPTIONS_WRITE line. now everything looks like it shoud.</p>
    </div>
    <hr>

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]></script></body></html>