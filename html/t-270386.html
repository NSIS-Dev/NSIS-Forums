<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="Callback Function?" />

  <title>Callback Function? - NSIS Forums</title><!-- Bootstrap core CSS -->
  <link rel="stylesheet" type="text/css" href="//netdna.bootstrapcdn.com/bootswatch/3.0.1/readable/bootstrap.min.css" />
  <link rel="stylesheet" href="../css/style.css" type="text/css" /><!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!--[if lt IE 9]>
                <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
                <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->
</head>

<body>
  <div class="container">
    <!-- Put navigation bar here -->

    <ol class="breadcrumb">
      <li><a href="../index.html" class="glyphicon glyphicon-home"></a></li>

      <li><a href="f-65.html">NSIS Discussion</a></li>

      <li class="active">Callback Function?</li>
    </ol>

    <p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=270386">Callback Function?</a></p><br />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">SportsQs</span><br />
      <span class="post-time small text-muted">30th April 2007 10:44 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>Callback Function?</strong><br />
      Hi,<br />
      I have a dll that is called from NSIS, in order to prepare the syatem for upgrade (is an EPOS application). I want to the instal to support a callback function, so that if the 'Prepare' fails, I can alert the user and abort the installation. The DLL is written in delphi (don't ask!), and the prepeare function has the following signature:<br />
      <br />
      function Prepare(CallbackMethod : TCallbackMethod) : Boolean<br />
      <br />
      <br />
      How do I pass the callback function to my dll to respond to callbacks?<br />
      <br />
      Thanks in advance<br />
      Peter</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Backland</span><br />
      <span class="post-time small text-muted">30th April 2007 13:14 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">You can consider writing a C++ NSIS plugin that acts as a wrapper around your Delphi dll<br />
      <br />
      Also, you can write a Plugin for NSIS in Delphi as well (if it makes things any easier)</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Comm@nder21</span><br />
      <span class="post-time small text-muted">30th April 2007 15:07 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">callback functions are not used for such things.<br />
      <br />
      therefore, you use return values.<br />
      <br />
      you just execute the function using the system.dll plugin for nsis and then check the return value of your function.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">SportsQs</span><br />
      <span class="post-time small text-muted">2nd May 2007 17:28 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"></p>

      <blockquote>
        <i>Originally posted by Comm@nder21</i><br />
        <b>callback functions are not used for such things.<br />
        <br />
        therefore, you use return values.<br />
        <br />
        you just execute the function using the system.dll plugin for nsis and then check the return value of your function.</b>
      </blockquote>Hi Comm@nder21,<br />
      If only it was that simple, unfortulately the dll function call is required to asynchronously callback with it's current state based on the operation it is currently performing. Just checking the return value is not enough, as I need to inform the user of the current state of the install. I'll be passing back things such as 'Install Started', 'Backing Up Database', 'Contacting devices' etc... and a load more.<br />
      So I need to call mydll::Prepare() with a NSIS function as a parameter which will then display the messages to the user as they are recieved.<br />
      <br />
      Peter
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
      <span class="post-time small text-muted">3rd May 2007 18:40 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">The System plug-in can handle <a href="http://nsis.sourceforge.net/Docs/System/System.html#callback" target="_blank">callbacks</a>. There is an example in the documentation.</p>
    </div>
    <hr />

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]>
  </script>
</body>
</html>
