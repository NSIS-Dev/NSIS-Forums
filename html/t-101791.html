<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="startup" />

  <title>startup - NSIS Forums</title>
<script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script>
<!-- Bootstrap core CSS -->

  <link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css" />
  <link rel="stylesheet" href="../css/style.css" type="text/css" /><!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!--[if lt IE 9]>
                <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
                <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->
</head>

<body>
  <div class="container">
    <!-- Put navigation bar here -->

    <ol class="breadcrumb">
      <li><a href="../index.html" class="glyphicon glyphicon-home"></a></li>

      <li><a href="f-65.html">NSIS Discussion</a></li>

      <li class="active">startup</li>
    </ol>

    <p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=101791">startup</a></p><br />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">parfo</span><br />
      <span class="post-time small text-muted">25th August 2002 16:32 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>startup</strong><br />
      Hi,<br />
      <br />
      Just started using NSIS, and it's really great. I learned 90% of what I needed in 10 minutes. Now I spend days to tweak everything "just right" including icons in the correct number of bits etc.<br />
      <br />
      I have a question about using $SMSTARTUP, my script results in "Error creating shortcut: C:\Document and Settings......".<br />
      <br />
      I have written that part of the script as:<br />
      <br />
      CreateShortCut "$SMSTARTUP\myapp.lnk /nw" "$INSTDIR\myapp.exe" "" "$INSTDIR\myapp.exe" 0<br />
      <br />
      What is wrong?</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">veekee</span><br />
      <span class="post-time small text-muted">25th August 2002 17:00 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">/nw args is not allowed in the shortcut math !<br />
      Use it as the trirg argument of the function (as long as i could remember... this is the 3rd) ;)</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">parfo</span><br />
      <span class="post-time small text-muted">25th August 2002 17:12 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Actually, even if I make it simpler by writing<br />
      <br />
      CreateShortCut "$SMSTARTUP\myapp.lnk" "$INSTDIR\myapp.exe"<br />
      <br />
      it still doesn't work. Same error, and won't show up in startup. Weird.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
      <span class="post-time small text-muted">25th August 2002 17:42 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Put a message box before the CreateShortcut line that will show you the $SMSTARTUP variable, and post here what it showed.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">parfo</span><br />
      <span class="post-time small text-muted">26th August 2002 11:14 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">In fact, now when I rewrite it as<br />
      CreateShortCut "$SMSTARTUP\myapp.lnk" "$INSTDIR\myapp.exe" "/nw"<br />
      it works fine, even though the manual says<br />
      &gt;&gt;&gt;start_options should be one of:SW_SHOWNORMAL,SW_SHOWMAXIMIZED,SW_SHOWMINIMIZED, or an empty string.<br />
      <br />
      Why is there a 2nd repetition of the target file in example2.nsi?<br />
      CreateShortCut "$SMPROGRAMS\Example2\Example2 (notepad).lnk" "$INSTDIR\notepad.exe" "" "$INSTDIR\notepad.exe" 0<br />
      <br />
      Seems to correspond to where the icon file should go, but the icon is correct also w/o it.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
      <span class="post-time small text-muted">26th August 2002 11:32 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">start_options is the 6th parameter. Your "/nw" is the parameters, command line arguments. In example2.nsi the second notepad.exe is just there to show how to set the icon. You can set it to something else too, myicon.ico for example.</p>
    </div>
    <hr />

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]>
  </script>
</body>
</html>
