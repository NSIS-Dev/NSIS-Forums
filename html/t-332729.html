<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="description" content="I just want to copy fileS"><title>I just want to copy fileS - NSIS Forums</title><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script><link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css"><link rel="stylesheet" href="../css/style.css" type="text/css"></head><body><div class="container"><ol class="breadcrumb"><li><a href="../index.html" class="glyphicon glyphicon-home"></a></li><li><a href="f-65.html">NSIS Discussion</a></li><li class="active">I just want to copy fileS</li></ol><p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=332729">I just want to copy fileS</a></p><br><div class="post"><p class="post-meta"><span class="post-author text-primary">jay_m</span><br><span class="post-time small text-muted">22nd July 2011 05:43 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>I just want to copy fileS</strong><br>I need to distribute files to my customers. They are stored in the shared user folder<br></p><blockquote>EX: C:\Users\Public\Documents\FOURLEAF\<br>\MACHINE\SAMPLE.CON<br>\MACHINE\OTHER.TMT<br>\FOLLOWER\SETTING\MAINFILE.SPT</blockquote>The folder structure will always be the same (at least to start) as will the file extensions. The file names will vary with each customer. I would like to create an executable that will simply copy these files into the folders. Assume that the user will always have admin privileges.<br><br>I want the easist way to package up these files and send them to my customers. I have looked at other extracting tools and NSIS looks good for what I want.<br><br>Thanks</div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">MSG</span><br><span class="post-time small text-muted">22nd July 2011 06:10 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">To learn NSIS, start with NSIS\Examples\Example1.nsi and Example2.nsi. Find out what all the commands do and why. (Use the command reference, <a href="http://nsis.sourceforge.net/Docs/Chapter4.html" target="_blank">http://nsis.sourceforge.net/Docs/Chapter4.html</a> ) Once you've done that, you'll be well underway to being able to answer your own question(s).</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">jay_m</span><br><span class="post-time small text-muted">22nd July 2011 13:34 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">I know that there are examples, and am capable of using them to teach myself the language. I just have such a simple case and want to get started that I hoped someone would be able to help.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">MSG</span><br><span class="post-time small text-muted">22nd July 2011 14:01 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">If you need to package multiple files in the installer, how about just using a wildcard?<br>File "C:\Users\Public\Documents\FOURLEAF\MACHINE\*.CON"<br><br>Either way, these forums aren't about writing installers for other people, it's about helping people learning/using the language to solve specific issues. Particularly for beginners, this means we point to the manual whenever applicable - we prefer to teach people the proverbial fishing, rather than force-feed them.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">jay_m</span><br><span class="post-time small text-muted">22nd July 2011 18:43 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Ok here is what I have so far....<br><br></p><pre>
<code>; Basic.nsi<br>;<br>; This script will install mastercam machine definitions in standard locations<br><br>; The name of the installer<br>Name "MLC Post Installer"<br><br>; Output filname<br>OutFile "MLCPostSetup.exe"<br> <br>Section "Copy"<br><br>; Change user context to ALL USERS<br>SetShellVarContext all<br><br>; Copy machine defs<br>SetOutPath "$DOCUMENTS\shared mcamx5\CNC_MACHINES\"<br>File *.control-5<br>File *.lmd-5<br>File *.mmd-5<br>File *.rmd-5<br><br>; Copy post files<br>SetOutPath "$DOCUMENTS\shared mcamx5\lathe\Posts"<br>File *.pst<br><br>SectionEnd</code>
</pre><br>
      <br>
      Now what I need a way to include the .lmd-5, .mmd-5, .rmd-5 only if they exist. There will only be on or the other files. Then I need to adjust where the "post" file get installed based on whether the .lmd-5, .mmd-5, or .rmd-5 files are included. The post file will be in ..\lathe\Posts for .lmd-5, ..\mill\Posts for .mmd-5 and ..\router\Posts for rmd-5.<br>
      <br>
      Thanks
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">demiller9</span><br>
      <span class="post-time small text-muted">22nd July 2011 22:44 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">I think you want to do something like this...<br></p>
      <pre>
<code>!include LogicLib.nsh<br>...<br>; Copy machine defs<br>SetOutPath "$DOCUMENTS\shared mcamx5\CNC_MACHINES\"<br>File *.control-5<br>${If}{FileExists} *.lmd-5<br>   File *.lmd-5<br>   strcpy $0 lathe<br>${EndIf}<br>${If}{FileExists} *.mmd-5<br>   File *.mmd-5<br>   strcpy $0 mill<br>${EndIf}<br>${If}{FileExists} *.rmd-5<br>   File *.rmd-5<br>   strcpy $0 router<br>${EndIf}<br><br>; Copy post files<br>SetOutPath "$DOCUMENTS\shared mcamx5\$0\Posts"<br>File *.pst<br></code>
</pre><br>
      <br>
      The compiler will include the ?md-5 files for all three machine types (lathe, mill, router), but will only extract the one that has existing files. This won't work right for new installations; I'd recommend using the Component page to select mill/lathe/router and put each into its own section. You can use the radio button logic to be sure that only one gets selected.<br>
      <br>
      Don
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">jay_m</span><br>
      <span class="post-time small text-muted">26th July 2011 14:01 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Thanks Don!<br>
      <br>
      I am pretty full this week, but I will get back on it next week. Looks like it will work. It is always a difficult process learning a new language when you want to do the most basic stuff.:D<br>
      <br>
      One question, you said it won't work for new installations? Is this if the folders do not exist? And could I do a check "if exists ...." to modify the behavior if the folder does not exist.<br>
      <br>
      Of course this really shouldn't be a problem because that folder structure will ALWAYS be there.</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">demiller9</span><br>
      <span class="post-time small text-muted">26th July 2011 15:42 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">The folder structure is not the problem (SetOutPath would create the structure), the problem is that the code needs to see existing files to decide which machine type you have (mill/router/lathe) and thus the correct files to extract.<br>
      <br>
      Adding the component page and letting the user choose the machine would do it; you could detect their machine if the installation already exists and pre-set the components for them.<br>
      <br>
      Don</p>
    </div>
    <hr>

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]></script></body></html>