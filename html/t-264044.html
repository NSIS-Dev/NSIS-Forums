<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="description" content="How to make installer wait between two operations/exe executions"><title>How to make installer wait between two operations/exe executions - NSIS Forums</title><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script><link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css"><link rel="stylesheet" href="../css/style.css" type="text/css"><!--[if lt IE 9]><script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script><script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script><![endif]--></head><body><div class="container"><ol class="breadcrumb"><li><a href="../index.html" class="glyphicon glyphicon-home"></a></li><li><a href="f-65.html">NSIS Discussion</a></li><li class="active">How to make installer wait between two operations/exe executions</li></ol><p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=264044">How to make installer wait between two operations/exe executions</a></p><br><div class="post"><p class="post-meta"><span class="post-author text-primary">Swapan Das</span><br><span class="post-time small text-muted">20th January 2007 07:01 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>How to make installer wait between two operations/exe executions</strong><br>Currently I'm into an issue <a href="http://forums.winamp.com/showthread.php?s=&amp;threadid=263995." target="_blank">http://forums.winamp.com/showthread....readid=263995.</a><br><br>But I'm posting this post as a new to attract wider members from our NSIS forum. Can anyone tell me how to run the following two nsExec::Exec commands one by one. The 2nd command should be executed only after the 1st command has been completed completely.<br><br>!define MUI_FINISHPAGE_RUN<br>!define MUI_FINISHPAGE_RUN_FUNCTION "ExecuteFinishPage"<br><br>Function ExecuteFinishPage<br>; MSDE 2000 setup gets executed<br>nsExec::Exec "$INSTDIR\setup.exe"<br>; after the msde installation<br>; I want to start the SqL Service Manager by:<br>nsExec::Exec "NET START MSSQLSERVER"<br>OR<br>nsExec::Exec "scm.exe -Action 1 -Service MSSQLSERVER -silent 2"<br>FunctionEnd<br><br>Please note that there is no error in both the nsExec commands, both runs perfectly. The problem is that the installer after executing the 1st command does not waits to get the MSDE setup gets its installation completed, it goes on to execute the next available command. I've supplied even a simple MessageBox command, and it gets executed soon after invoking the MSDE setup. And due to this, my 2nd command is unable to start the SQL Service Manager as at that time MSDE installation is yet to be completed.<br><br>I cannot use the 'SLEEP' command in between, as I don't know how long the MSDE setup will take to finish. And yes, I don't want to issue a 'REBOOT', and wants instantly to start the MSSQLSERVER Service after the MSDE setup. I'm running the msde setup(setup.exe) on default mode, this is good as the user can see the interface of msde installation.<br><br><br>Sorry guys for taxing your patience with my long discussion.<br><br>With regards,</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Swapan Das</span><br><span class="post-time small text-muted">20th January 2007 07:11 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">I've an idea:<br><br>nsExec::Exec "$INSTDIR\setup.exe /wait"<br><br>let me try this, and will get back to this thread.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Red Wine</span><br><span class="post-time small text-muted">20th January 2007 10:18 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Perhaps the 1st setup is a wrapper which starts another setup, in this case you need to know if this wrapper supports switches, and the syntax for these switches.<br>It might be better if you use ExecWait and capture the returned ErrorLevel.<br>As for NsExec better use it with ExecToStack, see the documentation,<br><a href="http://nsis.sourceforge.net/Docs/nsExec/nsExec.txt" target="_blank">http://nsis.sourceforge.net/Docs/nsExec/nsExec.txt</a></p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">kichik</span><br><span class="post-time small text-muted">20th January 2007 12:39 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Unattended has a page with a detailed list of all common installer switches. Use it to find out how to tell the MSDE installer to return only once it's done. For example, in some InstallShield installer, you must pass /SMS for that and For NSIS unisntallers, you must use _?=$INSTDIR. Also search the forum as this has been asked a few times before. Someone might have also posted the relevant switch from that page.<br><br><a href="http://unattended.sourceforge.net/installers.php" target="_blank">http://unattended.sourceforge.net/installers.php</a></p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">demiller9</span><br><span class="post-time small text-muted">20th January 2007 18:44 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"></p><blockquote><i>Originally posted by Swapan Das</i><br><b>I've an idea:<br><br>nsExec::Exec "$INSTDIR\setup.exe /wait"<br><br>let me try this, and will get back to this thread.</b></blockquote>The MSDE setup does not need to be told to wait, it needs a parameter for the sa administrator password: "setup.exe sapwd=&lt;YourNewSaAdministratorPassword&gt; /qn". The /qn switch will make it run silently.<br><br>Check the information on MSDN: <a href="http://download.microsoft.com/download/d/5/4/d5402c33-65de-4464-9d82-d1de2971d9db/ReadmeMSDE2000A.htm#_3464462_msde_2000_setup_parameters_wluf" target="_blank">http://download.microsoft.com/downlo...arameters_wluf</a></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Swapan Das</span><br><span class="post-time small text-muted">27th January 2007 06:19 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Thanks to all of you for the valuable suggestions.<br>I'm leaving town on an official tour for around 10 days.<br>So will be able to resolve my this issue after my return.<br>Will get back to this thread after 2 weeks.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">sanalnk</span><br><span class="post-time small text-muted">16th February 2007 07:10 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Hi<br>Iam also facing the same problem.I would love to know how did you solved the problem<br>"How to make installer wait between two operations/exe executions"</p></div><hr><div class="footer"><p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p></div></div><script src="../js/highlight.pack.js" type="text/javascript"></script><script type="text/javascript">//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]></script></body></html>