<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="I need to disable a NT service!" />

  <title>I need to disable a NT service! - NSIS Forums</title>
  <script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script>
  <!-- Bootstrap core CSS -->

  <link rel="stylesheet" type="text/css" href="//netdna.bootstrapcdn.com/bootswatch/3.0.1/readable/bootstrap.min.css" />
  <link rel="stylesheet" href="../css/style.css" type="text/css" /><!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!--[if lt IE 9]>
                <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
                <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->
</head>

<body>
  <div class="container">
    <!-- Put navigation bar here -->

    <ol class="breadcrumb">
      <li><a href="../index.html" class="glyphicon glyphicon-home"></a></li>

      <li><a href="f-65.html">NSIS Discussion</a></li>

      <li class="active">I need to disable a NT service!</li>
    </ol>

    <p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=185719">I need to disable a NT service!</a></p><br />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">flitzjoy</span><br />
      <span class="post-time small text-muted">6th July 2004 22:34 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>I need to disable a NT service!</strong><br />
      Yes, i´ve searched at NSIS archive about and found a item, but i can´t understand that!<br />
      <br />
      I need just a simple way to set the "dns client" service from 2K/XP at manual start.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Joost Verburg</span><br />
      <span class="post-time small text-muted">6th July 2004 23:09 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">There is a plug-in available in the NSIS Archive that handles system services.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">flitzjoy</span><br />
      <span class="post-time small text-muted">7th July 2004 14:59 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Yes, i´ve found that plugin.<br />
      At this page, <a href="http://nsis.sourceforge.net/archive/viewpage.php?pageid=385" target="_blank">http://nsis.sourceforge.net/archive/...php?pageid=385</a><br />
      <br />
      but this plugin only installs new services or drivers. I need a way for manage original Windows Services.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">PattonPending</span><br />
      <span class="post-time small text-muted">7th July 2004 15:50 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">For XP/2K services you should be able to use Sc.exe from the Windows 2000 Resource Kit. It has a bunch of options that allow you to configure services from the command line. Use it in conjunciton with a batch file you call from your install script to manipulate the service.<br />
      <br />
      Good Luck!<br />
      <br />
      Edit: The command should be something like SC config "DNS Client" start= disabled<br />
      <br />
      I'm not sure if that is the registered name of the service though. You might have to look in the registry and search for "DNS Client". If I had to guess I would say that the specific registry info would be under HKLM\System\CurrentControlSet\Services\DNSCache<br />
      <br />
      Let us know what you find out</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">pengyou</span><br />
      <span class="post-time small text-muted">7th July 2004 15:55 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Have you looked at the NSIS Service Lib:<br />
      <br />
      <a href="http://nsis.sourceforge.net/archive/viewpage.php?pageid=345" target="_blank">http://nsis.sourceforge.net/archive/...php?pageid=345</a></p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">flitzjoy</span><br />
      <span class="post-time small text-muted">7th July 2004 15:55 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">THX man! Sc.exe seems to resolve my problem!<br />
      :)</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">flitzjoy</span><br />
      <span class="post-time small text-muted">7th July 2004 16:14 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">In registry, the DNS Client is named as dnscache, i was thinking, if I change the<br />
      <br />
      HKLM\SYSTEM\CurrentControlSet\Services\Dnscache<br />
      "Start" from "0x00000002" to "0x00000004" and reboot the system.<br />
      <br />
      This will work?!<br />
      <br />
      ------------------------<br />
      *The hexdecimal codes for services starting modes<br />
      /* Start Type */<br />
      #define SERVICE_BOOT_START 0x00000000<br />
      #define SERVICE_SYSTEM_START 0x00000001<br />
      #define SERVICE_AUTO_START 0x00000002<br />
      #define SERVICE_DEMAND_START 0x00000003<br />
      #define SERVICE_DISABLED 0x00000004<br />
      (from <a href="http://nsis.sourceforge.net/archive....php?pageid=385" target="_blank">http://nsis.sourceforge.net/archive....php?pageid=385</a>)</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">PattonPending</span><br />
      <span class="post-time small text-muted">7th July 2004 16:28 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">You can either do that or just have a batch that calls "sc config Dnscache start= disabled". SC will modify whatever values are necessary in (I'm pretty sure) most of the control sets. (CurrentControlSet, ControlSet001, etc.) CurrentControlSet is the one that actually matters so far as the service, but some different modes for windows call of different sets of services (ie SafeMode, SafeMode w/ Command Prompt, SafeMode w/ Networking)<br />
      <br />
      Use whatever method you prefer, but I personally use SC.exe as its cleaner and easier than modifying all of those values directly.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">flitzjoy</span><br />
      <span class="post-time small text-muted">7th July 2004 16:40 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">PattonPending, I will follow your suggestion and use the SC.<br />
      I only want to ask a last question, do you know if this sc.exe is present in all Windows NT based versions (such NT4,2K,XP,2003)?</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">PattonPending</span><br />
      <span class="post-time small text-muted">7th July 2004 18:49 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">SC.exe will work with any version of windows that follows the NT4 services model.<br />
      <br />
      This means that it should work on NT4, 2000, XP Home, XP Pro. I have personally only used it on XP Pro and 2000, so I can't personally vouch for the other systems.<br />
      <br />
      <a href="http://msdn.microsoft.com/library/default.asp?url=/library/en-us/dndllpro/html/msdn_scmslite.asp" target="_blank">A Link to The Microsoft Site about SC.exe</a><br />
      <br />
      That page alone gives you a pretty good feel for the utility and all of the stuff that it can do.<br />
      <br />
      I'm personally using it to create a home-brewed backup system that runs in the background. You can also use SC.exe to create entirely new services, remove services entirely, and tweak everything about services from dependencies to security permissions.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">flitzjoy</span><br />
      <span class="post-time small text-muted">8th July 2004 02:31 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Well, now i do everything i want! thx you for the support!<br />
      i will visit the link, thx again...<br />
      <br />
      have a nice day... bye</p>
    </div>
    <hr />

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]>
  </script>
</body>
</html>
