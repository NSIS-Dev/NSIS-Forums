<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="Alternate install directories" />

  <title>Alternate install directories - NSIS Forums</title><!-- Bootstrap core CSS -->
  <link rel="stylesheet" type="text/css" href="//netdna.bootstrapcdn.com/bootswatch/3.0.1/readable/bootstrap.min.css" />
  <link rel="stylesheet" href="../css/style.css" type="text/css" /><!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!--[if lt IE 9]>
                <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
                <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->
</head>

<body>
  <div class="container">
    <!-- Put navigation bar here -->

    <ol class="breadcrumb">
      <li><a href="../index.html" class="glyphicon glyphicon-home"></a></li>

      <li><a href="f-65.html">NSIS Discussion</a></li>

      <li class="active">Alternate install directories</li>
    </ol>

    <p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=193336">Alternate install directories</a></p><br />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Mikos21</span><br />
      <span class="post-time small text-muted">12th September 2004 20:01 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>Alternate install directories</strong><br />
      I've been trying this for a few days now with no success.<br />
      Basically I want a install directory page that gives an option to install in one of two directories. I have the page display fine using Installoptions. However I have no idea on how to write the script that will determine which of the directories has been selected and which directory to therefore install to. Any help would be appreciated.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
      <span class="post-time small text-muted">12th September 2004 20:21 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">I'd have two radio buttons, one by each directory box.<br />
      <br />
      Use ReadINIStr to find the State of the radio buttons. If radio button #1 State is 0, then radio button #2 must be selected, else its State will be 1.<br />
      <br />
      -Stu</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Mikos21</span><br />
      <span class="post-time small text-muted">13th September 2004 00:34 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Afrow UK could you please provide more detail regarding ReadINIStr and how then to use the the state of the radio buttons to install in the chosen directory. I do have two radio buttons for the directories but the main problem is how to write the script. A brief example would definately help.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">deguix</span><br />
      <span class="post-time small text-muted">13th September 2004 00:50 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">If you use Modern UI, instead of using <i>ReadINIStr</i> you should use <i>!insertmacro MUI_INSTALLOPTIONS_READ</i>.<br />
      <br />
      An example of reading an INI file:</p>
      <pre>
<code>ReadINIStr $0 "MyINIFile.ini" "Field 3" "State"</code>
</pre>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Mikos21</span><br />
      <span class="post-time small text-muted">13th September 2004 02:13 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Thanks Afrow UK and deguix. I'm now further along but still uncertain about the next part. Now that I can read the 'state' what do I then add in the script that basically says ok if that's what has been selected now install these files to the selected directory ? I hope I'm being clear about what I'm asking.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Mikos21</span><br />
      <span class="post-time small text-muted">14th September 2004 03:55 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">I still can't figure it out. Can anyone please help with a brief example ?</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">John P.</span><br />
      <span class="post-time small text-muted">29th September 2004 10:54 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">I have a similar question, so I'll post it in this thread instead of starting a new one:<br />
      <br />
      <br />
      Instead of using radio buttons/chechboxes, I use a droplist in my custom MUI page.<br />
      <br />
      The listbox looks like this in the .ini:<br />
      <br /></p>
      <pre>
<code><br />[Settings]<br />NumFields=1<br /><br />[Field 1]<br />Type=Droplist<br />ListItems=U.S.(english)|UK(english)|French|German|Italian|Spanish<br />State=U.S.(english)<br />Left=40<br />Right=-40<br />Top=50<br />Bottom=70</code>
</pre><br />
      <br />
      Now - in the NSIS script, I have successfully made my custom page with the droplist appear before the Welcome page. So when I open the compiled installer now, the language select listbox comes up first.<br />
      <br />
      In the NSIS script, I have this so far:<br />
      <br />
      <pre>
<code><br />Function InstallLanguage  ;"InstallLanguage" defined with Page command<br />  !insertmacro MUI_HEADER_TEXT "$(TEXT_IO_TITLE)" "$(TEXT_IO_SUBTITLE)"<br />  !insertmacro MUI_INSTALLOPTIONS_DISPLAY "ioDX-IW.ini"<br />  !insertmacro MUI_INSTALLOPTIONS_READ $R0 "ioDX-IW.ini" "Field 1" "U.S.(english)"<br />  !insertmacro MUI_INSTALLOPTIONS_READ $R1 "ioDX-IW.ini" "Field 1" "UK(english)"<br />  !insertmacro MUI_INSTALLOPTIONS_READ $R2 "ioDX-IW.ini" "Field 1" "French"<br />  !insertmacro MUI_INSTALLOPTIONS_READ $R3 "ioDX-IW.ini" "Field 1" "German"<br />  !insertmacro MUI_INSTALLOPTIONS_READ $R4 "ioDX-IW.ini" "Field 1" "Italian"<br />  !insertmacro MUI_INSTALLOPTIONS_READ $R5 "ioDX-IW.ini" "Field 1" "Spanish"<br />FunctionEnd</code>
</pre><br />
      <br />
      Now, I want to continue that function with code that will let me change the install directory according to what the user selected.<br />
      <br />
      To do that, I would like to put the user-selection into a common variable, so that ${USER_SELECTION} for instance is the installdir for the language the user selected.<br />
      <br />
      It's the same install dir in my case, but in the install dir path there is one folder for each language, and I'm supposed to extract files to the proper language folder based on the language the user chose.<br />
      <br />
      Is that possible, and if so how do I do it?
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">John P.</span><br />
      <span class="post-time small text-muted">29th September 2004 11:58 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Would this code do what I want(mentioned above)?<br />
      <br /></p>
      <pre>
<code><br />Function InstallLanguage  ;"InstallLanguage" defined with Page command<br />  !insertmacro MUI_HEADER_TEXT "$(TEXT_IO_TITLE)" "$(TEXT_IO_SUBTITLE)"<br />  !insertmacro MUI_INSTALLOPTIONS_DISPLAY "ioDX-IW.ini"<br />  !insertmacro MUI_INSTALLOPTIONS_READ $R0 "ioDX-IW.ini" "Field 1" "U.S.(english)"<br />  !insertmacro MUI_INSTALLOPTIONS_READ $R0 "ioDX-IW.ini" "Field 1" "UK(english)"<br />  !insertmacro MUI_INSTALLOPTIONS_READ $R0 "ioDX-IW.ini" "Field 1" "French"<br />  !insertmacro MUI_INSTALLOPTIONS_READ $R0 "ioDX-IW.ini" "Field 1" "German"<br />  !insertmacro MUI_INSTALLOPTIONS_READ $R0 "ioDX-IW.ini" "Field 1" "Italian"<br />  !insertmacro MUI_INSTALLOPTIONS_READ $R0 "ioDX-IW.ini" "Field 1" "Spanish"<br /><br />${if} $R0 == 1<br />StrCpy $INST_DIR "content\examples\files\"<br />${endif}<br /><br />${if} $R0 == 1<br />StrCpy $INST_DIR "content\examples\files\english"<br />${endif}<br /><br />${if} $R0 == 1<br />StrCpy $INST_DIR "content\examples\files\french"<br />${endif}<br /><br />${if} $R0 == 1<br />StrCpy $INST_DIR "content\examples\files\german"<br />${endif}<br /><br />${if} $R0 == 1<br />StrCpy $INST_DIR "content\examples\files\italian"<br />${endif}<br /><br />${if} $R0 == 1<br />StrCpy $INST_DIR "content\examples\files\spanish"<br />${endif}<br />FunctionEnd<br /></code>
</pre><br />
      <br />
      -I would then put $INST_DIR in the file commands, like so:<br />
      <br />
      "$INSTDIR\$INST_DIR\example.bmp"<br />
      <br />
      (or how ever I'm supposed to write the variable into the path).<br />
      <br />
      Would that work?<br />
      <br />
      <br />
      <br />
      -Or, in the function above, would I have to write<br />
      <br />
      ${if} $R0 == U.S.(english)<br />
      StrCpy $INST_DIR "content\examples\files\"<br />
      ${endif}<br />
      <br />
      and so on?<br />
      <br />
      In other words, the listbox state name instead of 1?
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">John P.</span><br />
      <span class="post-time small text-muted">29th September 2004 13:29 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Well - that didn't work.<br />
      <br />
      Tried the last thing there, with putting the listbox names instead of 1.<br />
      <br />
      The script compiles without errors or warnings, but if I for instance choose French in the listbox, the installer just puts everything into $INSTDIR, instead of "$INSTDIR\$INST_DIR\".<br />
      <br />
      Can someone please help me out here?<br />
      I really need to get this working. :(<br />
      <br />
      Again - I need to get the User input from the listbox and use it to make a variable I can use as part of the install path, so that each language can have it's own path.<br />
      <br />
      Thanks in advance.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
      <span class="post-time small text-muted">29th September 2004 14:03 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">You're reading the states of all of the radio buttons into the same variable. Each time, you override the value before you check it. You should either read them into different variables or check right after you read.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">John P.</span><br />
      <span class="post-time small text-muted">29th September 2004 14:08 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Thanks for the reply. :)<br />
      <br />
      But should I use<br />
      <b>${if} $R0 == 1<br /></b><br />
      , or<br />
      <br />
      <b>${if} $R0 == U.S.(english)<br /></b><br />
      <br />
      (in other words '1' instead of the droplist name)?<br />
      <br />
      <br />
      [EDIT]-and it's a droplist, not radiobuttons.[/EDIT]</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
      <span class="post-time small text-muted">29th September 2004 14:16 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Oh, sorry. You're using a droplist, not radio buttons. The code should look something like this:</p>
      <pre>
<code>!insertmacro MUI_INSTALLOPTIONS_READ $R0 "ioDX-IW.ini" "Field 1" "STATE"<br />${if} $R0 == "U.S.(english)"<br />${elseif} $R0 == "French"<br />${elseif} $R0 == "German"<br />${endif}</code>
</pre>The selected item will be the value of STATE.
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">John P.</span><br />
      <span class="post-time small text-muted">29th September 2004 14:19 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Oh - thanks. :)<br />
      <br />
      I'll try to work from that. :)</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">John P.</span><br />
      <span class="post-time small text-muted">29th September 2004 14:46 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Haven't tested what you gave me yet, but I have another question:<br />
      <br />
      How do I skip a Custom Page?<br />
      <br />
      -My installer can be re-opened, and when the User re-opens it, it will skip past the Welcome page, License page, and Directory page.<br />
      <br />
      This all works already.<br />
      <br />
      But when I try to use the same function for the Custom Page, it doesn't affect it. Even though the mentioned pages are skipped, the Custom Page still appears first.<br />
      <br />
      Here's how it looks now:<br /></p>
      <pre>
<code><br />!define MUI_PAGE_CUSTOMFUNCTION_PRE SkipPages<br />Page custom InstallLanguage ;Custom page<br />!insertmacro MUI_PAGE_WELCOME<br />!define MUI_PAGE_CUSTOMFUNCTION_PRE SkipPages<br />!insertmacro MUI_PAGE_LICENSE "InternalReadme.rtf"<br />!define MUI_PAGE_CUSTOMFUNCTION_PRE SkipPages<br />!insertmacro MUI_PAGE_DIRECTORY<br />!define MUI_PAGE_CUSTOMFUNCTION_LEAVE checksections<br />!insertmacro MUI_PAGE_COMPONENTS<br />!insertmacro MUI_PAGE_INSTFILES<br />!insertmacro MUI_PAGE_FINISH<br /></code>
</pre><br />
      <br />
      This does not give any errors or warnings when compiling, and it works as intended with the "normal" pages, but doesn't do anything to the Custom Page.<br />
      <br />
      If I put another <i>!define MUI_PAGE_CUSTOMFUNCTION_PRE SkipPages</i> above the <i>!insertmacro MUI_PAGE_WELCOME</i>, then I <b>do</b> get an error; that it's already defined.<br />
      <br />
      <br />
      So how do I skip a Custom Page?
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
      <span class="post-time small text-muted">29th September 2004 14:49 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">MUI_PAGE_CUSTOMFUNCTION_PRE only works for MUI pages. Since you create the page yourself, you should skip it yourself. You can skip it by simply not calling InstallOptions in the page creation function (InstallLanguage).</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">John P.</span><br />
      <span class="post-time small text-muted">29th September 2004 15:17 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">OK, thanks - I think I know how.<br />
      <br />
      Oh, and the code you gave me above worked exactly as I wanted(with some adaptations), so thank you again. :)</p>
    </div>
    <hr />

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]>
  </script>
</body>
</html>
