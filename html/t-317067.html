<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="Inetc problem" />

  <title>Inetc problem - NSIS Forums</title>
  <script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script>
  <!-- Bootstrap core CSS -->

  <link rel="stylesheet" type="text/css" href="//netdna.bootstrapcdn.com/bootswatch/3.0.1/readable/bootstrap.min.css" />
  <link rel="stylesheet" href="../css/style.css" type="text/css" /><!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!--[if lt IE 9]>
                <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
                <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->
</head>

<body>
  <div class="container">
    <!-- Put navigation bar here -->

    <ol class="breadcrumb">
      <li><a href="../index.html" class="glyphicon glyphicon-home"></a></li>

      <li><a href="f-65.html">NSIS Discussion</a></li>

      <li class="active">Inetc problem</li>
    </ol>

    <p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=317067">Inetc problem</a></p><br />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">realpuff</span><br />
      <span class="post-time small text-muted">17th February 2010 01:25 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>Inetc problem</strong><br />
      Hi everyone,<br />
      <br />
      I tried to create an downloader using inetc::get but my code need to be fixed so I need your help!<br />
      <br />
      I have 2 download locations (links) and first one acts as main download link and the second one as backup just in case the first download link go down.<br />
      <br />
      Now I want my script to check link1 and if there error maybe due that user use a proxy then check link1 again with /NOPROXY and if file not found, link1 down or any error then I want to check link2. My code works but when the working link is found and the file is downloaded, this not run because I don't know how to set a condition that when link is working and file downloaded then the script to jumt to the Function .onGuiEnd instead execute the remaining code and try to download again. Here is my code:<br />
      <br />
      <br />
      SetCompressor LZMA<br />
      WindowIcon Off<br />
      CRCCheck On<br />
      AutoCloseWindow true<br />
      ShowInstDetails nevershow<br />
      ShowUnInstDetails nevershow<br />
      RequestExecutionLevel highest<br />
      <br />
      !define NAME "Downloader"<br />
      Name "${NAME}"<br />
      OutFile "Downloader.exe"<br />
      <br />
      !include "MUI.nsh"<br />
      !define MUI_ICON "Setup.ico"<br />
      !insertmacro MUI_PAGE_WELCOME<br />
      !insertmacro MUI_PAGE_INSTFILES<br />
      !insertmacro MUI_LANGUAGE "English"<br />
      <br />
      Section "Downloading file"<br />
      SetDetailsView hide<br />
      <br />
      inetc::get /NOPROXY "http://www.mydomain1.com/Setup.exe" "$PLUGINSDIR\Setup.exe" /END<br />
      Pop $0<br />
      <br />
      ${If} $0 != ""<br />
      inetc::get "http://www.mydomain1.com/Setup.exe" "$PLUGINSDIR\Setup.exe" /END<br />
      Pop $1<br />
      <br />
      ${If} $1 != ""<br />
      inetc::get /NOPROXY "http://www.mydomain2.com/Setup.exe" "$PLUGINSDIR\Setup.exe" /END<br />
      Pop $2<br />
      <br />
      ${If} $2 != ""<br />
      inetc::get "http://www.mydomain2.com/Setup.exe" "$PLUGINSDIR\Setup.exe" /END<br />
      Pop $3<br />
      <br />
      ${EndIf}<br />
      ${EndIf}<br />
      ${EndIf}<br />
      SectionEnd<br />
      <br />
      Function .onGUIEnd<br />
      SetOutPath $PLUGINSDIR<br />
      Exec "Setup.exe"<br />
      FunctionEnd</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
      <span class="post-time small text-muted">17th February 2010 17:46 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">I you'd read the inetc readme you'd know that it returns OK on success and not an empty string.<br />
      <br />
      Stu</p>
    </div>
    <hr />

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]>
  </script>
</body>
</html>
