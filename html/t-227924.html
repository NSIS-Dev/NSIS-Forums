<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="Richtx.ocx keeps needing replacement and reboot" />

  <title>Richtx.ocx keeps needing replacement and reboot - NSIS Forums</title>
  <script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script>
  <!-- Bootstrap core CSS -->

  <link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css" />
  <link rel="stylesheet" href="../css/style.css" type="text/css" /><!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!--[if lt IE 9]>
                <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
                <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->
</head>

<body>
  <div class="container">
    <!-- Put navigation bar here -->

    <ol class="breadcrumb">
      <li><a href="../index.html" class="glyphicon glyphicon-home"></a></li>

      <li><a href="f-65.html">NSIS Discussion</a></li>

      <li class="active">Richtx.ocx keeps needing replacement and reboot</li>
    </ol>

    <p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=227924">Richtx.ocx keeps needing replacement and reboot</a></p><br />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">bg123</span><br />
      <span class="post-time small text-muted">8th October 2005 05:56 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>Richtx.ocx keeps needing replacement and reboot</strong><br />
      The RegTool problem came to light because my setup wants to reboot every time I run it.<br />
      <br />
      The specific file that causes a problem is Richtx32.ocx<br />
      <br />
      I install it with:<br />
      !insertmacro InstallLib REGDLL $ALREADY_INSTALLED REBOOT_PROTECTED "${REDISTRIB}\richtx32.OCX" "$SYSDIR\richtx32.OCX" "$SYSDIR"<br />
      <br />
      It queues a rename of a file to become richtx32.ocx after reboot.<br />
      The existing one in system32 is older and lower version than the one my setup wants to replace it with. But after reboot it seems the old one is back again.<br />
      <br />
      existing v6.0.88.77 260096 bytes Created March 12, 2001 5:07:46PM<br />
      replace with v6.1.97.82 212240 bytes Created March 09, 2004 1:00:00AM<br />
      <br />
      <br />
      Why does it revert to the old one? Even if the file is in use, I thought $ALREADY_INSTALLED would make it not do anything (I run same setup repeatedly, my exe is there and the already installed test is done, it should be true)</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
      <span class="post-time small text-muted">8th October 2005 10:34 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">This is probably Windows. It stores a backup copy in $SYSDIR\dllcache. If the one in $SYSDIR changes in any way (file size etc), Windows will replace it with the backup copy.<br />
      <br />
      -Stu</p>
    </div>
    <hr />

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]>
  </script>
</body>
</html>
