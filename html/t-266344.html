<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="Search Multiple Drives" />

  <title>Search Multiple Drives - NSIS Forums</title>
  <script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script>
  <!-- Bootstrap core CSS -->

  <link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css" />
  <link rel="stylesheet" href="../css/style.css" type="text/css" /><!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!--[if lt IE 9]>
                <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
                <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->
</head>

<body>
  <div class="container">
    <!-- Put navigation bar here -->

    <ol class="breadcrumb">
      <li><a href="../index.html" class="glyphicon glyphicon-home"></a></li>

      <li><a href="f-65.html">NSIS Discussion</a></li>

      <li class="active">Search Multiple Drives</li>
    </ol>

    <p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=266344">Search Multiple Drives</a></p><br />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">ThorMX</span><br />
      <span class="post-time small text-muted">22nd February 2007 03:29 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>Search Multiple Drives</strong><br />
      Not too sure how to explain what exactly I am looking to do, but I'll do my best to explain it.<br />
      <br />
      The installer that I'm creating has to be able to edit the "boot.ini" file in order to start my application. After first glance this was easy to edit and it was working great. However, the more people that used it, the more I found that this file is not always located at the root of the C:\ drive. I need a way to find this "boot.ini" as it will be located on the active partition of the hard drive.<br />
      <br />
      Is/are there any ways to detect the partitions on a computer and determine which partition is active? From what I've found, it doesn't seem to be easy.<br />
      <br />
      My other thought would be to do a file search on the root of every hard drive detected. This wouldn't be such a problem other than all of the search functions require a path. Can you loop through a list of different hard drives? Any examples?<br />
      <br />
      Or do any of you guys have a better idea that would be more feasible?<br />
      <br />
      Thanks!</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Red Wine</span><br />
      <span class="post-time small text-muted">22nd February 2007 05:16 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Did you try %SYSTEMDRIVE% ?</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">ThorMX</span><br />
      <span class="post-time small text-muted">22nd February 2007 14:58 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">%SYSTEMDRIVE% is a no-go. It would work great so long as the drive you have Windows installed on is also the active partition. Here 2 examples:<br />
      <br />
      1. 1 hard drive, 1 partition. Everything will be located on your C:\ drive, this includes all boot items.<br />
      <br />
      2. multiple hard drives, multiple partitions. If you install Windows to the D:\ drive, your system drive will be the D:\ drive. However, all of your boot information will be stored on the active partition (most likely the C:\ partition or the partition that is set to active)<br />
      <br />
      Any other ideas?</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Red Wine</span><br />
      <span class="post-time small text-muted">22nd February 2007 20:30 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><a href="http://nsis.sourceforge.net/Docs/AppendixE.html#E.1.5" target="_blank">${GetDrives}</a> I couldn't think of something better.</p>
    </div>
    <hr />

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]>
  </script>
</body>
</html>
