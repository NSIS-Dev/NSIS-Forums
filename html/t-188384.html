<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="Newbie: Needs Help With Component Sections 1 over 4" />

  <title>Newbie: Needs Help With Component Sections 1 over 4 - NSIS Forums</title><!-- Bootstrap core CSS -->
  <link rel="stylesheet" type="text/css" href="//netdna.bootstrapcdn.com/bootswatch/3.0.1/readable/bootstrap.min.css" />
  <link rel="stylesheet" href="../css/style.css" type="text/css" /><!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!--[if lt IE 9]>
                <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
                <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->
</head>

<body>
  <div class="container">
    <!-- Put navigation bar here -->

    <ol class="breadcrumb">
      <li><a href="../index.html" class="glyphicon glyphicon-home"></a></li>

      <li><a href="f-65.html">NSIS Discussion</a></li>

      <li class="active">Newbie: Needs Help With Component Sections 1 over 4</li>
    </ol>

    <p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=188384">Newbie: Needs Help With Component Sections 1 over 4</a></p><br />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">PCEnhancer</span><br />
      <span class="post-time small text-muted">31st July 2004 03:42 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>Newbie: Needs Help With Component Sections 1 over 4</strong><br />
      Newbie: This it my first week 1/2 using Nullsoft and i have hit a brickwall<br />
      I need help with the Components Page Sections. I have 4 Sections each one is unique, but only 1 Section can installed, if two or more Sections are installed the last on that was writen to the haard drive is used. But that one may not be the one that is needed. So basically I need the Sections to swich off with only one Section or none being selected in the Components Page of my installer.<br />
      <br />
      <br />
      One way i know of to do this is like this. (But it only covers 2 Sections.) And I need it to cover 4 Sections. Please Help<br />
      <br />
      ;-----------------------<br />
      Function .onSelChange<br />
      Push $0<br />
      <br />
      StrCmp $R9 ${sec1}<br />
      <br />
      SectionGetFlags ${sec1} $0<br />
      IntOp $0 $0 &amp; ${SF_SELECTED}<br />
      IntCmp $0 ${SF_SELECTED} 0 done done<br />
      StrCpy $R9 ${sec1}<br />
      SectionGetFlags ${sec2} $0<br />
      IntOp $0 $0 &amp; ${SECTION_OFF}<br />
      SectionSetFlags ${sec2} $0<br />
      <br />
      Goto done<br />
      <br />
      check_sec1:<br />
      <br />
      SectionGetFlags ${sec2} $0<br />
      IntOp $0 $0 &amp; ${SF_SELECTED}<br />
      IntCmp $0 ${SF_SELECTED} 0 done done<br />
      StrCpy $R9 ${sec2}<br />
      SectionGetFlags ${sec1} $0<br />
      IntOp $0 $0 &amp; ${SECTION_OFF}<br />
      SectionSetFlags ${sec1} $0<br />
      done:<br />
      FunctionEnd<br />
      ;-----------------------<br />
      <br />
      An summery of what I have tryed to do so far is hopefully at the bottum of the page in .nsi format [Note] The .nsi file was Compiled with Venis IX.<br />
      <br />
      <br />
      <br />
      <br />
      <br />
      <br />
      <br />
      <br />
      <br />
      <br />
      Here is Summery.nsi<br />
      ;----------------------<br />
      <br />
      ;AUTHOR:PCEnhancer<br />
      ;REQUIRES:Windows 2000/XP<br />
      BrandingText "Cool v1.2"<br />
      ;--------------------------------<br />
      ;Include Modern UI<br />
      !include "MUI.nsh"<br />
      ;--------------------------------<br />
      ;General<br />
      <br />
      ;Name and file<br />
      !define APPNAME "Cool"<br />
      !define APPNAMEANDVERSION "Cool v1.2"<br />
      Name "${APPNAMEANDVERSION}"<br />
      OutFile "Cool Need Help.exe"<br />
      <br />
      ;Default installation folder<br />
      InstallDir "$DESKTOP\Cool"<br />
      InstallDirRegKey HKLM "Software\${APPNAME}" ""<br />
      ;--------------------------------<br />
      ;Variables<br />
      <br />
      Var MUI_TEMP<br />
      ;--------------------------------<br />
      ;Interface Configuration<br />
      <br />
      !define MUI_BGCOLOR 000000<br />
      !define MUI_COMPONENTSPAGE_SMALLDESC<br />
      !define MUI_COMPONENTSPAGE_TEXT_COMPLIST ""<br />
      !define MUI_COMPONENTSPAGE_TEXT_INSTTYPE ""<br />
      ;--------------------------------<br />
      ;Pages<br />
      <br />
      !insertmacro MUI_PAGE_COMPONENTS<br />
      !insertmacro MUI_PAGE_DIRECTORY<br />
      ;!insertmacro MUI_PAGE_INSTFILES<br />
      ;--------------------------------<br />
      ;Languages<br />
      <br />
      !insertmacro MUI_LANGUAGE "English"<br />
      ;--------------------------------<br />
      ;Installer Sections<br />
      <br />
      ;Set Section properties<br />
      SetOverwrite on<br />
      <br />
      ShowInstDetails "show"<br />
      ;--------------------------------<br />
      SubSection /e "Install Cool Cursors [ACTIVE]" "Hello"<br />
      <br />
      Section "Install Cursors as [ACTIVE]" sec1<br />
      SectionEnd<br />
      ;--------------------------------<br />
      Section "Install Cursors Burnt as [ACTIVE]" sec2<br />
      ;Wright Data "Cool Cursors" to Registry<br />
      SectionEnd<br />
      ;--------------------------------<br />
      Section "Install Cursors Solid as [ACTIVE]" sec3<br />
      ;Wright Data "Cool Cursors" to Registry<br />
      SectionEnd<br />
      ;--------------------------------<br />
      Section "Install Cursors Burnt Solid as [ACTIVE]" sec4<br />
      SectionEnd<br />
      SubSectionEnd<br />
      ;-------------------------------------------------------<br />
      <br />
      <br />
      ;HERE IS THE PROBLEM!!!!!!!!<br />
      ;--------------------------------------<br />
      Function .onInit<br />
      System::Call 'kernel32::CreateMutexA(i 0, i 0, t "myMutex") i .r1 ?e'<br />
      <br />
      Pop $R0<br />
      <br />
      StrCmp $R0 0 +3<br />
      MessageBox MB_OK "The installer is already running."<br />
      Abort<br />
      ;------------------------<br />
      Push $0<br />
      <br />
      StrCpy $R9 ${sec1} ; Gotta remember which section we are at now...<br />
      SectionGetFlags ${sec1} $0<br />
      IntOp $0 $0 | ${SF_SELECTED}<br />
      SectionSetFlags ${sec1} $0<br />
      <br />
      SectionGetFlags ${sec2} $0<br />
      IntOp $0 $0 &amp; ${SECTION_OFF}<br />
      SectionSetFlags ${sec2} $0<br />
      <br />
      SectionGetFlags ${sec3} $0<br />
      IntOp $0 $0 &amp; ${SECTION_OFF}<br />
      SectionSetFlags ${sec3} $0<br />
      <br />
      SectionGetFlags ${sec4} $0<br />
      IntOp $0 $0 &amp; ${SECTION_OFF}<br />
      SectionSetFlags ${sec4} $0<br />
      <br />
      Pop $0<br />
      FunctionEnd<br />
      <br />
      ;I Need Help With This Right Here.<br />
      ;-------------------------------------------<br />
      Function .onSelChange<br />
      Push $0<br />
      <br />
      StrCmp $R9 ${sec1} check_sec1<br />
      <br />
      SectionGetFlags ${sec1} $0<br />
      IntOp $0 $0 &amp; ${SF_SELECTED}<br />
      IntCmp $0 ${SF_SELECTED} 0 done done<br />
      StrCpy $R9 ${sec1}<br />
      SectionGetFlags ${sec2} $0<br />
      IntOp $0 $0 &amp; ${SECTION_OFF}<br />
      SectionSetFlags ${sec2} $0<br />
      <br />
      Goto done<br />
      <br />
      check_sec1:<br />
      <br />
      SectionGetFlags ${sec2} $0<br />
      IntOp $0 $0 &amp; ${SF_SELECTED}<br />
      IntCmp $0 ${SF_SELECTED} 0 done done<br />
      StrCpy $R9 ${sec2}<br />
      SectionGetFlags ${sec1} $0<br />
      IntOp $0 $0 &amp; ${SECTION_OFF}<br />
      SectionSetFlags ${sec1} $0<br />
      <br />
      Goto done<br />
      ;done:<br />
      ;-------------------------------------------<br />
      Pop $0<br />
      <br />
      Push $0<br />
      <br />
      StrCmp $R9 ${sec3} check_sec3<br />
      <br />
      SectionGetFlags ${sec3} $0<br />
      IntOp $0 $0 &amp; ${SF_SELECTED}<br />
      IntCmp $0 ${SF_SELECTED} 0 done done<br />
      StrCpy $R9 ${sec3}<br />
      SectionGetFlags ${sec4} $0<br />
      IntOp $0 $0 &amp; ${SECTION_OFF}<br />
      SectionSetFlags ${sec4} $0<br />
      <br />
      Goto done<br />
      <br />
      check_sec3:<br />
      <br />
      SectionGetFlags ${sec4} $0<br />
      IntOp $0 $0 &amp; ${SF_SELECTED}<br />
      IntCmp $0 ${SF_SELECTED} 0 done done<br />
      StrCpy $R9 ${sec4}<br />
      SectionGetFlags ${sec3} $0<br />
      IntOp $0 $0 &amp; ${SECTION_OFF}<br />
      SectionSetFlags ${sec3} $0<br />
      <br />
      done:<br />
      <br />
      Pop $0<br />
      FunctionEnd</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">mumuri</span><br />
      <span class="post-time small text-muted">31st July 2004 09:39 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Hello<br />
      <br />
      i ve got the same problems a few weeks ago,<br />
      <br />
      as fas as i remember, i only add this<br />
      Function .onSelChange<br />
      <br />
      <br />
      !insertmacro StartRadioButtons $1<br />
      !insertmacro RadioButton ${SecStandard}<br />
      !insertmacro RadioButton ${SecLocal}<br />
      !insertmacro RadioButton ${SecWeb}<br />
      !insertmacro EndRadioButtons<br />
      <br />
      FunctionEnd<br />
      SecStandard;SecLocal,SecWeb are the name of your section<br />
      <br />
      and you have to add this at the begining of your script<br />
      !include "Sections.nsh"<br />
      <br />
      I 'm not sure of this, but it should work.<br />
      If it doesn't work try to look on the example directory of your nsis folder, there is an example.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">PCEnhancer</span><br />
      <span class="post-time small text-muted">31st July 2004 10:44 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Thanks for your Reply. You were right about there an example in the nsis directory. I found "one-section.nsi" and altered it to this and now it works ok, there is a small bug with it in the SubSection, if in the installer you click on that sud section it highlight all the section but one. But hay it works so far. Thanks<br />
      <br />
      <br />
      Function .onInit<br />
      <br />
      Push $0<br />
      <br />
      StrCpy $1 ${sec9}<br />
      SectionGetFlags ${sec9} $0<br />
      IntOp $0 $0 | ${SF_SELECTED}<br />
      SectionSetFlags ${sec9} $0<br />
      <br />
      SectionGetFlags ${sec10} $0<br />
      IntOp $0 $0 &amp; ${SECTION_OFF}<br />
      SectionSetFlags ${sec10} $0<br />
      <br />
      SectionGetFlags ${sec11} $0<br />
      IntOp $0 $0 &amp; ${SECTION_OFF}<br />
      SectionSetFlags ${sec11} $0<br />
      <br />
      SectionGetFlags ${sec12} $0<br />
      IntOp $0 $0 &amp; ${SECTION_OFF}<br />
      SectionSetFlags ${sec12} $0<br />
      <br />
      Pop $0<br />
      <br />
      FunctionEnd<br />
      <br />
      Function .onSelChange<br />
      <br />
      !insertmacro StartRadioButtons $1<br />
      !insertmacro RadioButton ${sec1}<br />
      !insertmacro RadioButton ${sec2}<br />
      !insertmacro RadioButton ${sec3}<br />
      !insertmacro RadioButton ${sec4}<br />
      !insertmacro EndRadioButtons<br />
      <br />
      FunctionEnd<br />
      <br />
      <br />
      Replaces!!!<br />
      ;-----------<br />
      <br />
      Push $0<br />
      <br />
      StrCpy $R9 ${sec1} ; Gotta remember which section we are at now...<br />
      SectionGetFlags ${sec1} $0<br />
      IntOp $0 $0 | ${SF_SELECTED}<br />
      SectionSetFlags ${sec1} $0<br />
      <br />
      SectionGetFlags ${sec2} $0<br />
      IntOp $0 $0 &amp; ${SECTION_OFF}<br />
      SectionSetFlags ${sec2} $0<br />
      <br />
      SectionGetFlags ${sec3} $0<br />
      IntOp $0 $0 &amp; ${SECTION_OFF}<br />
      SectionSetFlags ${sec3} $0<br />
      <br />
      SectionGetFlags ${sec4} $0<br />
      IntOp $0 $0 &amp; ${SECTION_OFF}<br />
      SectionSetFlags ${sec4} $0<br />
      <br />
      Pop $0<br />
      FunctionEnd<br />
      <br />
      ;I Need Help With This Right Here.<br />
      ;-------------------------------------------<br />
      Function .onSelChange<br />
      Push $0<br />
      <br />
      StrCmp $R9 ${sec1} check_sec1<br />
      <br />
      SectionGetFlags ${sec1} $0<br />
      IntOp $0 $0 &amp; ${SF_SELECTED}<br />
      IntCmp $0 ${SF_SELECTED} 0 done done<br />
      StrCpy $R9 ${sec1}<br />
      SectionGetFlags ${sec2} $0<br />
      IntOp $0 $0 &amp; ${SECTION_OFF}<br />
      SectionSetFlags ${sec2} $0<br />
      <br />
      Goto done<br />
      <br />
      check_sec1:<br />
      <br />
      SectionGetFlags ${sec2} $0<br />
      IntOp $0 $0 &amp; ${SF_SELECTED}<br />
      IntCmp $0 ${SF_SELECTED} 0 done done<br />
      StrCpy $R9 ${sec2}<br />
      SectionGetFlags ${sec1} $0<br />
      IntOp $0 $0 &amp; ${SECTION_OFF}<br />
      SectionSetFlags ${sec1} $0<br />
      <br />
      Goto done<br />
      ;done:<br />
      ;-------------------------------------------<br />
      Pop $0<br />
      <br />
      Push $0<br />
      <br />
      StrCmp $R9 ${sec3} check_sec3<br />
      <br />
      SectionGetFlags ${sec3} $0<br />
      IntOp $0 $0 &amp; ${SF_SELECTED}<br />
      IntCmp $0 ${SF_SELECTED} 0 done done<br />
      StrCpy $R9 ${sec3}<br />
      SectionGetFlags ${sec4} $0<br />
      IntOp $0 $0 &amp; ${SECTION_OFF}<br />
      SectionSetFlags ${sec4} $0<br />
      <br />
      Goto done<br />
      <br />
      check_sec3:<br />
      <br />
      SectionGetFlags ${sec4} $0<br />
      IntOp $0 $0 &amp; ${SF_SELECTED}<br />
      IntCmp $0 ${SF_SELECTED} 0 done done<br />
      StrCpy $R9 ${sec4}<br />
      SectionGetFlags ${sec3} $0<br />
      IntOp $0 $0 &amp; ${SECTION_OFF}<br />
      SectionSetFlags ${sec3} $0<br />
      <br />
      done:<br />
      <br />
      Pop $0<br />
      FunctionEnd<br />
      <br />
      And it Works, Thanks Again.:)</p>
    </div>
    <hr />

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]>
  </script>
</body>
</html>
