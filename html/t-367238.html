<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="javaws and desktop shortcut creation" />

  <title>javaws and desktop shortcut creation - NSIS Forums</title><!-- Bootstrap core CSS -->
  <link rel="stylesheet" type="text/css" href="//netdna.bootstrapcdn.com/bootswatch/3.0.1/readable/bootstrap.min.css" />
  <link rel="stylesheet" href="../css/style.css" type="text/css" /><!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!--[if lt IE 9]>
                <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
                <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->
</head>

<body>
  <div class="container">
    <!-- Put navigation bar here -->

    <ol class="breadcrumb">
      <li><a href="../index.html" class="glyphicon glyphicon-home"></a></li>

      <li><a href="f-65.html">NSIS Discussion</a></li>

      <li class="active">javaws and desktop shortcut creation</li>
    </ol>

    <p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=367238">javaws and desktop shortcut creation</a></p><br />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">erik@winepos.com</span><br />
      <span class="post-time small text-muted">26th July 2013 17:33 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>javaws and desktop shortcut creation</strong><br />
      A little background first. A colleague of mine used NSIS a few years ago to create an installer for our Java application. It has been working but now we want to move to Java 7 which requires minor tweaking to the nsi script.<br />
      <br />
      I took the existing script he wrote and changed the name of the java file that is running and the associated arguments for running, namely I changed this:<br />
      <br />
      <font face="Lucida Console">ExecWait "$TEMP\j2re\jre-6u13-windows-i586-p-iftw.exe /passive ADDLOCAL=jrecore STATIC=1"</font><br />
      <br />
      to this:<br />
      <br />
      <font face="Lucida Console">ExecWait "$TEMP\j2re\jre-7u25-windows-i586.exe /s"</font><br />
      <br />
      At the very end of the script it runs a single javaws line that should copy shortcuts to the desktop (where $4 is the jnlp file location):<br />
      <br />
      <font face="Lucida Console">ExecWait "javaws -wait -shortcut -import -system $4"</font><br />
      <br />
      The previous installer we created with NSIS would prompt the user at the end to create shortcuts but the new installer is just failing.<br />
      <br />
      At this point I have three things to look at, namely the javaws command, the jnlp file we are using and the nsi script.<br />
      <br />
      Can anyone help me narrow down my problem?</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Anders</span><br />
      <span class="post-time small text-muted">26th July 2013 20:01 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">I would say all those exec calls are wrong, please use:<br /></p>

      <blockquote>
        ExecWait '"c:\full\path\to\app.exe" /param1 "par am2" /param3'
      </blockquote>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">erik@winepos.com</span><br />
      <span class="post-time small text-muted">26th July 2013 21:41 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">I did manage to get the shortcuts to install by commented this out but I am noticing some inconsistencies in the Java cache viewer:<br />
      <br /></p>
      <pre>
<code><font face="Lucida Console">SetShellVarContext all<br /><br />        ;these files are required for system-wide install of java web start applications<br />        CreateDirectory  "$WINDIR\Sun\Java\Deployment"<br />        SetOutPath "$WINDIR\Sun\Java\Deployment"<br />        File deployment.config<br />        File enterprise.properties</font></code>
</pre><br />
      <br />
      <br />
      Thanks Anders, I will try that out as well
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">erik@winepos.com</span><br />
      <span class="post-time small text-muted">30th July 2013 21:45 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">So it turns out my problem was that the previous script was not scrubbing the javaws cache files well enough so I added these lines:<br />
      <br />
      <br />
      ;for windows 7<br />
      RMDir /r /REBOOTOK "$PROFILE\AppData\LocalLow\Sun\Java\Deployment\cache"<br />
      RMDir /r /REBOOTOK "$PROFILE\AppData\LocalLow\Sun\Java\Deployment\SystemCache"<br />
      <br />
      ;for windows xp<br />
      RMDir /r /REBOOTOK "$LOCALAPPDATA\Sun\Java\Deployment\cache"<br />
      RMDir /r /REBOOTOK "$LOCALAPPDATA\Sun\Java\Deployment\SystemCache"</p>
    </div>
    <hr />

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]>
  </script>
</body>
</html>
