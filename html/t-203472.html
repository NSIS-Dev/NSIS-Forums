<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="description" content="MSIBANNER driven by InetLoad"><title>MSIBANNER driven by InetLoad - NSIS Forums</title><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script><link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css"><link rel="stylesheet" href="../css/style.css" type="text/css"><!--[if lt IE 9]><script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script><script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script><![endif]--></head><body><div class="container"><ol class="breadcrumb"><li><a href="../index.html" class="glyphicon glyphicon-home"></a></li><li><a href="f-65.html">NSIS Discussion</a></li><li class="active">MSIBANNER driven by InetLoad</li></ol><p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=203472">MSIBANNER driven by InetLoad</a></p><br><div class="post"><p class="post-meta"><span class="post-author text-primary">grahama</span><br><span class="post-time small text-muted">30th December 2004 20:10 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>MSIBANNER driven by InetLoad</strong><br>is there a way to have InetLoad drive MSIBanner for a very simple progress bar...be great to use it for updating small files... InetLoad in popup mode is still a little too complicated for my users ;) Just having a simple graphic-only progress bar in the .oninit would be quite cool :)</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Joel</span><br><span class="post-time small text-muted">31st December 2004 01:02 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">mmm, what's InetLoad? :/<br><br>MSIBanner have a simple progress bar... or I missed something?</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">grahama</span><br><span class="post-time small text-muted">31st December 2004 01:39 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">InetLoad is quite a cool ftp/http plugin created by Takir [sp?] that works with proxy networks. I am using the InetLoad plugin[not in POPUP mode] rather than NSISDL. NSISDL could not cut thru my client's proxy.<br>As far as MSIBANNER, I was wondering if you could feed it actual percentage download values rather than faking the progress bar with something like<br>Function bannerLoop<br>strcpy $count 0<br>strcpy $loopTotal 10<br>;<br>loop:<br>MSIBanner::UPDATE /NOUNLOAD "$bannerText"<br>sleep ${delay}<br>IntOp $count $count + 1<br>strcmp $count $loopTotal loopFinished loop<br>;<br>loopFinished:<br>strcpy $count "0"<br>FunctionEnd<br><br>many thanks for the plug Lobo as I am using it for a system check in the .onInit :)</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Joel</span><br><span class="post-time small text-muted">31st December 2004 02:46 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"></p><blockquote>I was wondering if you could feed it actual percentage</blockquote>I can try :)<br>But it will be after new year, I got to finish an old project first.<br><blockquote>many thanks for the plug Lobo as I am using it for a system check in the .onInit</blockquote>thanks to you.... :)<br>but, may I ask you: After the MSIBanner is destroy, the NSIS is in minimized state?</div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Takhir</span><br><span class="post-time small text-muted">31st December 2004 09:41 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">2 grahama: If you have MS VS installed, you can create your own version of plug-in dialog, just make some controls "not visible". As a variant - see attached zip.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">grahama</span><br><span class="post-time small text-muted">31st December 2004 17:24 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">many thanks, Takhir. That inetLoad plug is a real life saver. Thanks for the ability to integrate it back into the MUI.;really helped :)<br>To Lobot:<br>after I destroy the banner, a custom media player is launched or the user is taken to the 'First Install' page. I use NSIS to either launch the main file or install/update...then launch the main file.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">grahama</span><br><span class="post-time small text-muted">31st December 2004 17:43 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">inetLoadltd is Very Cool :)<br>Would it be difficult for POPUP to mimic MSIBANNER<br>1)inclusion of MUI_ICON in the header of the POPUP<br>2) inclusion of a text string variable...like $bannerText in the above function<br>3) use roughly the same dimensions of MSIBanner..or even make it definable<br>This would be perfect solution [and very slick] to downloading ini files and updating certain small files in the .onInit stage. For myself, I download an ini file and check that against the registry. If only a few [small]files need to be replaced/downloaded, I update them in the onInit stages. This is easiser on the user who does not have to go thru the whole installation process every time an individual file is updated. One big 'first install' is enough.<br>g</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Jnuw</span><br><span class="post-time small text-muted">31st December 2004 18:55 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"></p><blockquote><i>Originally posted by grahama</i> many thanks, Takhir. That inetLoad plug is a real life saver.</blockquote>Agreed, this is one of the best plugin i've seen.</div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Takhir</span><br><span class="post-time small text-muted">1st January 2005 07:56 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Thanks and Happy New Year!<br>We have 10 days New Year state holidays in Russia, so I'll probably can make changes in this (specific) version soon :) If grahama could send me required banner design (image), this would be easier for me. ineum(monkey)narod.ru<br>And this is a little program (120 kB package) with NSIS installer <a href="http://ineum.narod*****mgr_en.htm" target="_blank">http://ineum.narod*****mgr_en.htm</a> ;)</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Takhir</span><br><span class="post-time small text-muted">3rd January 2005 09:01 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">This is how I see it - InetLoad in .onInit with MSI banner design. New /BANNER parameter for the text to be displayed (this version only) - see Readme.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">RobGrant</span><br><span class="post-time small text-muted">4th January 2005 09:04 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Takhir - 10 days that's really cool! Do you get Christmas holiday as well?</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Takhir</span><br><span class="post-time small text-muted">4th January 2005 11:06 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Russia celebrates Christmas January 7, so holidays includes it ;)</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Takhir</span><br><span class="post-time small text-muted">5th January 2005 19:35 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Finally I wrote version with all 3 "display modes" support, direct link <a href="http://nsis.sourceforge.net/archive/download.php?file=InetLoad.zip" target="_blank">http://nsis.sourceforge.net/archive/...e=InetLoad.zip</a> and archive page <a href="http://nsis.sourceforge.net/archive/nsisweb.php?page=671&amp;instances=0,32" target="_blank">http://nsis.sourceforge.net/archive/...instances=0,32</a></p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">grahama</span><br><span class="post-time small text-muted">5th January 2005 22:27 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">wow<br>thanks Takhir<br>I just got back from vacation...no internet...kind of a relief...to be unplugged for a while<br>Banner mode will be very very slick and professional looking<br>Looking forward to checking out your great work :)<br>g</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">grahama</span><br><span class="post-time small text-muted">6th January 2005 02:46 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Hi Takhir, happy new year :)<br>do you think you can:<br>1) integrate the MUI_ICON into /BANNER mode<br>2) set up a header text for the inetLoad plug in /BANNER mode ...<br>an example of this for MSIBANNER would be<br>MSIBANNER::SHOW /NOUNLOAD "Welcome to Fonovisa" "Checking your system"<br>'Welcome to Fonovisa' becomes the header text [does not change]<br>and 'Checking your System' becomes the main text which can change each time you MSIBANNER::UPDATE<br>As long as the banner has not been destroyed, the header text for the plug will always say... Welcome to Fonovisa. pretty cool<br><br>many thanks for all of your hard work....<br>g</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Takhir</span><br><span class="post-time small text-muted">6th January 2005 07:25 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">1) do you want to define icon file in the command line?<br>2) finally it's possible to define caption text, but please note that plug-in currently implements "modal" dialog. This means that "load" call returns when plug-in finishes all it's jobs only. So UPDATE's are not possible now. MSI BANNER works in the modeless (detached) mode.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Takhir</span><br><span class="post-time small text-muted">6th January 2005 10:15 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Integration is a good idea, OK, I know how to extract first installer’s icon from exe file. Tested on 98 SE and XP Pro only, W2K test required :) Test package attached.</p></div><hr><div class="footer"><p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p></div></div><script src="../js/highlight.pack.js" type="text/javascript"></script><script type="text/javascript">//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]></script></body></html>