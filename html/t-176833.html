<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="description" content="NSIS screensaver install"><title>NSIS screensaver install - NSIS Forums</title><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script><link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css"><link rel="stylesheet" href="../css/style.css" type="text/css"><!--[if lt IE 9]><script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script><script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script><![endif]--></head><body><div class="container"><ol class="breadcrumb"><li><a href="../index.html" class="glyphicon glyphicon-home"></a></li><li><a href="f-65.html">NSIS Discussion</a></li><li class="active">NSIS screensaver install</li></ol><p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=176833">NSIS screensaver install</a></p><br><div class="post"><p class="post-meta"><span class="post-author text-primary">Spaz007</span><br><span class="post-time small text-muted">16th April 2004 07:21 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>NSIS screensaver install</strong><br>I'm building a screensaver for a project for my software engineering course and I want to put it in an installer. Here is the problem. After the installer copies everything over to the SYS32 dir it doesn't run correctly. It will run right only after I right click on the .SCR file and click on install. Then it runs great without any problems. Is there a way to make the NSIS installer call that install function?</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">magoo2002de</span><br><span class="post-time small text-muted">16th April 2004 11:20 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Hello Spaz007!<br>I look at my Registry. So I think you have to call the rundll32.exe like:<br></p><pre>
<code>rundll32.exe desk.cpl,InstallScreenSaver FullPathAndFilenameOfYourScreensaver</code>
</pre><br><font size="3"><b>NOT TESTED!!!</b></font></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Spaz007</span><br><span class="post-time small text-muted">16th April 2004 19:11 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">It didn't work but your help has given me a couple ideas on maybe how to do it.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">goofee691</span><br><span class="post-time small text-muted">11th October 2004 18:52 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">ok i have recently made a install for a screensaver first what version of windows are u useing cuz you may want to use $sysdir rather than useing system32<br><br>secondly run the screensaver at the end of the installer im not sure if this is required but i did it so more settings could be made im not sure how i did it but i will post the script in maybe 3 days just have to find it</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Takhir</span><br><span class="post-time small text-muted">12th October 2004 08:42 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">There are another modern tricks, but this works too (from Win95 to 2000 and XP)<br><br>SetOutPath $SYSDIR<br>File "${NAME_OF_YOUR}.scr"<br><br>; Set screensaver and make it active, DOS (short) name may require<br><br>WriteINIStr "$WINDIR\system.ini" "boot" "SCRNSAVE.EXE" "$SYSDIR\DOS_NAME_OF_YOUR.SCR"<br>System::Call 'user32.dll::SystemParametersInfo (17, 1, 0, 2)'</p></div><hr><div class="footer"><p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p></div></div><script src="../js/highlight.pack.js" type="text/javascript"></script><script type="text/javascript">//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]></script></body></html>