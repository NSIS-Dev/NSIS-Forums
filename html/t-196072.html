<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="description" content="how to copy files from one dir to another with file extention."><title>how to copy files from one dir to another with file extention. - NSIS Forums</title><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script><link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css"><link rel="stylesheet" href="../css/style.css" type="text/css"></head><body><div class="container"><ol class="breadcrumb"><li><a href="../index.html" class="glyphicon glyphicon-home"></a></li><li><a href="f-65.html">NSIS Discussion</a></li><li class="active">how to copy files from one dir to another with file extention.</li></ol><p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=196072">how to copy files from one dir to another with file extention.</a></p><br><div class="post"><p class="post-meta"><span class="post-author text-primary">saritha</span><br><span class="post-time small text-muted">9th October 2004 08:28 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>how to copy files from one dir to another with file extention.</strong><br>Hi Iam writing a Installer script what it does is ……it will copy a * .p12 files from temp to config dir<br><br><br><br>Temp and config are two different dir’s , both will have not only *.p12 ,but also another files.<br><br>Temp should only copy the *.p12 files from temp to config dir and remove old *p12 files from config dir<br><br><br><br>It will work only if we know the file name. ………Without knowing the filename how to copy only specific type of file’s from one dir to another with help of file extension.<br><br>Here am writing script, which is, not work bur I want to explain you in detail.<br><br><br>outfile "C:\Importcert1.exe"<br>section Import<br>StrCpy $R4 ""<br><br>loop:<br>IfFileExists "C:\Program Files\VistaWiz\OpenVPN\temp\*.p12" config no_config<br><br><br>no_config:<br>Strcmp $R4 "counter" endall<br>MessageBox MB_ICONEXCLAMATION|MB_OK \<br>'Could not find p12 Files In temp Dir .\<br>$\n "Without it you cannot run " ${APPNAMEANDVERSION}". \<br>$\n$\n Please Extract E-Mail Attachmet Into temp Dir Then Click Importcert Link.'<br>goto endForGood<br><br>doDel:<br>StrCpy $R4 "counter"<br>; KillProcDLL::KillProc "openvpn-gui.exe"<br>delete "C:\Program Files\VistaWiz\OpenVPN\config\*.p12"<br><br>config:<br>KillProcDLL::KillProc "openvpn-gui.exe"<br>StrCmp $R4 "" doDel<br>CopyFiles /SILENT "C:\Program Files\VistaWiz\OpenVPN\temp\*.p12" "C:\Program Files\VistaWiz\OpenVPN\config\*.p12"<br>delete "C:\Program Files\VistaWiz\OpenVPN\temp\*.p12"<br>goto loop<br><br>endall:<br>SetOutPath "C:\Program Files\VistaWiz\OpenVPN\bin\"<br>Exec "openvpn-gui.exe"<br><br><br>endForGood:<br>sectionend<br><br>Please help p me I really appreciate</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br><span class="post-time small text-muted">9th October 2004 11:42 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"></p><pre>
<code>CopyFiles /SILENT "C:\Program Files\VistaWiz\OpenVPN\temp\*.p12" "C:\Program Files\VistaWiz\OpenVPN\config"</code>
</pre><br><br>To delete all .p12 files in the temp dir, you should use FindFirst, FindNext etc:<br><br><pre>
<code>Function DeleteP12Files<br>Exch $R0<br>Push $R1<br>Push $R2<br> ClearErrors<br> FindFirst $R1 $R2 "$R0\*.p12"<br> Top:<br>  IfErrors Done<br><br>  Delete "$R0\$R2"<br><br>  ClearErrors<br>   FindNext $R1 $R2<br>  Goto Top<br> Done:<br><br> FindClose $R1<br>Pop $R2<br>Pop $R1<br>Pop $R0<br>FunctionEnd</code>
</pre><br>
      <br>
      Then call the function like so:<br>
      <pre>
<code>Push "C:\Program Files\VistaWiz\OpenVPN\temp"<br> Call DeleteP12Files</code>
</pre><br>
      This will delete all p12 files in that directory.<br>
      <br>
      -Stu
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">saritha</span><br>
      <span class="post-time small text-muted">9th October 2004 22:08 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Thank you very very much !</p>
    </div>
    <hr>

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]></script></body></html>