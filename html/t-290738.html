<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="Installer crash in Vista RTM" />

  <title>Installer crash in Vista RTM - NSIS Forums</title>
  <script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script>
  <!-- Bootstrap core CSS -->

  <link rel="stylesheet" type="text/css" href="//netdna.bootstrapcdn.com/bootswatch/3.0.1/readable/bootstrap.min.css" />
  <link rel="stylesheet" href="../css/style.css" type="text/css" /><!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!--[if lt IE 9]>
                <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
                <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->
</head>

<body>
  <div class="container">
    <!-- Put navigation bar here -->

    <ol class="breadcrumb">
      <li><a href="../index.html" class="glyphicon glyphicon-home"></a></li>

      <li><a href="f-65.html">NSIS Discussion</a></li>

      <li class="active">Installer crash in Vista RTM</li>
    </ol>

    <p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=290738">Installer crash in Vista RTM</a></p><br />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">canute</span><br />
      <span class="post-time small text-muted">23rd April 2008 21:19 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>Installer crash in Vista RTM</strong><br />
      I'm seeing an NSIS Installer / Uninstaller crash that seems to only occur in Vista RTM. The installer seems to work fine in XP and Vista SP1. However the setup needs to support RTM as well. The crash occurs seemingly at random throughout the install process, and doesn't happen all the time. It crashes with the following error report:<br />
      <br />
      Problem signature:<br />
      Problem Event Name: APPCRASH<br />
      Application Name: Setup.exe_unknown<br />
      Application Version: 0.0.0.0<br />
      Application Timestamp: 47eebf2f<br />
      Fault Module Name: comdlg32.dll_unloaded<br />
      Fault Module Version: 0.0.0.0<br />
      Fault Module Timestamp: 549bd09<br />
      Exception Code: c0000005<br />
      Exception Offset: 77154593<br />
      OS Version: 6.0.6000.2.0.0.256.1<br />
      Locale ID: 1033<br />
      Additional Information 1: 2b5e<br />
      Additional Information 2: d41d8cd98f00b204e9800998ecf8427e<br />
      Additional Information 3: 3080<br />
      Additional Information 4: 1ca6700788fcc8e9282daf2f5d93c6a5<br />
      <br />
      Read our privacy statement:<br />
      <a href="http://go.microsoft.com/fwlink/?linkid=50163&amp;clcid=0x0409" target="_blank">http://go.microsoft.com/fwlink/?link...3&amp;clcid=0x0409</a><br />
      <br />
      Anyone see anything like this before? Also is it possible to get map files for NSIS 2.35?</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
      <span class="post-time small text-muted">23rd April 2008 21:36 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Are you registering any DLL files? Try commenting those out and see if it still crashes.<br />
      <br />
      Installers work fine for me on Vista and I have received no reports of such crashes, so it might be something in the script.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">canute</span><br />
      <span class="post-time small text-muted">25th April 2008 16:30 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">I am using DLL files, but when I use the installer in silent mode (no dialogs or windows drawn), it works fine. Since the dlls are still doing what they're supposed to in silent mode, I don't think its the dll's, at least the ones I'm using.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
      <span class="post-time small text-muted">25th April 2008 16:35 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Try removing the registration of the DLL files. If it still crashes, attach a minimal script reproducing the problem (no need for File commands, RegDLL and installation of anything) and I'll take a look.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">canute</span><br />
      <span class="post-time small text-muted">30th April 2008 03:04 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">kichik,<br />
      <br />
      Thanks for your quick replies and suggestions. I believe I have successfully debugged the problem. It has something to do with plugin loading / unloading, which Vista RTM doesn't seem to like. I realized that it is safer to just leave SetPluginsUnload to 'alwaysoff'.</p>
    </div>
    <hr />

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]>
  </script>
</body>
</html>
