<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="a tool" />

  <title>a tool - NSIS Forums</title><!-- Bootstrap core CSS -->
  <link rel="stylesheet" type="text/css" href="//netdna.bootstrapcdn.com/bootswatch/3.0.1/readable/bootstrap.min.css" />
  <link rel="stylesheet" href="../css/style.css" type="text/css" /><!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!--[if lt IE 9]>
                <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
                <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->
</head>

<body>
  <div class="container">
    <!-- Put navigation bar here -->

    <ol class="breadcrumb">
      <li><a href="../index.html" class="glyphicon glyphicon-home"></a></li>

      <li><a href="f-65.html">NSIS Discussion</a></li>

      <li class="active">a tool</li>
    </ol>

    <p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=129234">a tool</a></p><br />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">doberlec</span><br />
      <span class="post-time small text-muted">21st March 2003 10:20 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>a tool</strong><br />
      I got a nifty little tool called "Nopey" which has been done in my "naughty years" in the internet. Quite versatile and easy to use. It's basically an executable file which can be used to control the users' computer in many ways. You can also gather a lot of info from the users' system. nsExec should be used to call it. I also included a little demo which shows you some very basic functions. Here is the command list:<br />
      <br />
      <b>commands:</b><br />
      info, zip, list, kill, char, color, mode, sysreboot, sysdown, sysabort,<br />
      net, logoff, poweroff, reboot, shutdown, cd, winamp, monitor, vol[ume],<br />
      regdump, child, ser[vice], err[code], dump, copy, sync, pause, resume,<br />
      sleep, show, hide, nc, runas, tweak<br />
      " &lt;commad&gt;/? " to get help about options and details<br />
      <br />
      <b>info:</b> system information<br />
      info system - basic system information<br />
      info os - OS information<br />
      info cpu - processor type, features, speed and other characteritics,<br />
      plus Intel and AMD cpu specific information, if available<br />
      info memory - memory usage<br />
      info snd - show basic mixer controls (left and right volume settings)<br />
      info sndtree - show mixer controls tree and current controls settings<br />
      (includes name, ID, current value and acceptable range)<br />
      info video - list video modes (win9x does not show display freqs)<br />
      for windows 9x, don't use it in text fullscreen mode<br />
      info ddraw - list DirectDraw video modes<br />
      info ide [caps] - list IDE ATA/ATAPI devices [show capabilities &amp; timings]<br />
      note: when in 9x mode, program hacks GDT, so disable<br />
      AV-monitors and other GDT-protecting software<br />
      info cd - identify all installed CD-ROMs (9x: GDT is also used)<br />
      info part[itions]- list partition tables on fixed drives (nt only)<br />
      info disk [X:]* - info about disk(s)<br />
      <br />
      <b>zip:</b> control ZipMagic state. this does not require ZMCMDLN.EXE<br />
      zip 0 - disable ZipMagic<br />
      zip0 - disable ZipMagic<br />
      zip 1 - enable ZipMagic<br />
      zip1 - enable ZipMagic<br />
      before enabling ZipMagic programs tries to load ZM32 or ZM32NT if they are<br />
      not loaded. on windows nt program starts ZMNTMON service and handles 'ShutDown'<br />
      key in registry for skipping message 'ZipMagic was not shutdown correctly'<br />
      <br />
      <b>list:</b> list system objects<br />
      list - show processes<br />
      list threads [&lt;procname&gt;] - show threads<br />
      list dlls [&lt;procname&gt;] - show loaded DLLs [in specified process]<br />
      note: relocated DLLs bases displayed with '*'<br />
      list map [&lt;procname&gt;] - process memory map (nt: show mapped files)<br />
      list vars [&lt;procname&gt;] - show process variables and environment (nt)<br />
      list res [&lt;procname&gt;] - show used resources for process (nt)<br />
      list drivers - show loaded drivers (nt)<br />
      list objects [-r] [&lt;root&gt;] - list nt kernel objects [recurse]<br />
      list files [&lt;procname&gt;] - show opened files (9x)<br />
      list handles [-n] [-f] [-t:&lt;obj&gt;] [&lt;procname&gt;] - show used handles (nt)<br />
      list pipes - list pipes (nt)<br />
      list mailslots - show mailslots (nt)<br />
      <br />
      <br />
      <b>kill:</b> terminate process<br />
      kill &lt;processname&gt; - terminate process by name<br />
      (may specify only some first chars of name)<br />
      note: all instances of process.exe will be killed<br />
      kill 0x78 - terminate process by ID (hex)<br />
      kill 120 - terminate process ID (dec)<br />
      it's possible to terminate several processes in one time, ex: kill proc1.exe proc2.exe<br />
      shortcuts:<br />
      ke - kill explorer.exe<br />
      kd - kill ntvdm.exe<br />
      <br />
      <br />
      <b>char:</b> print OEM/ANSI code tables<br />
      <br />
      <b>color:</b> print color map<br />
      <br />
      <b>mode:</b> show/change display mode<br />
      mode - show current display mode<br />
      mode [-test] [-permanent] xx [yy [c [fq]]]<br />
      mode xx - set horizontal resolution to xx,<br />
      autodetect vertical resolution<br />
      mode xx yy - set resolution to xx*yy<br />
      mode xx yy c - set resolution to xx*yy and color depth to c bits<br />
      mode xx yy fq - set resolution, color depth and monitor frequency<br />
      examples:<br />
      mode 800 - set 800x600, leave same color depth<br />
      mode 1024 768 16 - set 1024x768, high color<br />
      mode 640 480 8 75 - set 640x480, 256 colors, 75 herz<br />
      mode -test 1280 - try 1280x1024<br />
      mode -permanent 1024 - set 1024x768 as default video mode for current user<br />
      note: see 'ws info video' to get list of supported modes<br />
      note for windows 9x: don't use it in text fullscreen mode<br />
      <br />
      <b>sysreboot:</b> remote shutdown (NT only)<br />
      sysreboot n - reboot local machine after n seconds<br />
      sysreboot n &lt;computer&gt; - reboot computer after nn seconds<br />
      sysreboot n &lt;computer&gt; &lt;msg&gt; - reboot computer and display message<br />
      sysdown n - shutdown local machine after nn seconds<br />
      sysdown n &lt;computer&gt; - shutdown computer after nn seconds<br />
      sysdown n &lt;computer&gt; &lt;msg&gt; - shutdown computer and display message<br />
      sysabort - stop shutdown or reboot on local machine<br />
      sysabort &lt;computer&gt; - stop shutdown or reboot on computer<br />
      examples:<br />
      sysdown 0 - shutdown windows now<br />
      sysreboot 300 \\SERVER "you have 5 minutes, user!"<br />
      - reboot \\SERVER after 300 seconds<br />
      note: you must have enough access rights to computers in network<br />
      hint1: NOBODY can start new shutdown, if there is active one<br />
      hint2: almost all users have privileges to start/stop local shutdowns<br />
      <br />
      <b>net:</b> network commands<br />
      net view - view network resources<br />
      note: this command is under development for now<br />
      <br />
      <b>exit windows:</b><br />
      logoff | reboot | shutdown | poweroff [-force]<br />
      logoff - end windows session<br />
      reboot - reboot the computer<br />
      shutdown - shutdown the computer<br />
      poweroff - shutdown and turn power off<br />
      use flag -force to terminate programs without notifications<br />
      <br />
      <b>cd:</b> control CD-ROM<br />
      cd - show disk info and tracklist (uses cdplayer.ini)<br />
      cd driveinfo - show drive low-level info<br />
      cd speed &lt;n&gt; [-k[h]] - set maximum spindle speed (and keep [hide console])<br />
      cd play - play audio CD<br />
      cd play &lt;nn&gt; - play audio CD from track nn<br />
      cd play &lt;nn:mm:ss&gt; - play audio CD from track nn and time mm:ss<br />
      cd pause - pause CD-Audio<br />
      cd resume - resume CD-Audio from pause (win2k only)<br />
      cd stop - stop playing, stop disk in drive<br />
      cd eject | open - open drive door and eject disk<br />
      cd load | close - load disk and close drive door<br />
      cd grab - grab cd audio (nt) 'ws cd grab /?' for more help<br />
      note: you can append CD-ROM drive letter after command 'cd', ex:<br />
      cd D: - show info about disk in drive D:<br />
      cd E: eject - eject disk from CD-ROM drive E:<br />
      <br />
      <b>winamp:</b> console interface for winamp<br />
      winamp - show winamp version, status and song information<br />
      winamp clear - clear winamp playlist<br />
      winamp list - show playlist. current song is highlighted<br />
      winamp play - play current song<br />
      winamp play NN - play song number NN<br />
      winamp stop - stop playing<br />
      winamp pause - pause/unpause winamp<br />
      winamp next - play next song<br />
      winamp prev - play previous song<br />
      winamp restart - restart from first song<br />
      winamp fadeout - smooth stop<br />
      winamp last - stop after finishing current song<br />
      winamp close - unload winamp, save settings and playlist<br />
      winamp volume - set sound volume (in percents)<br />
      winamp file &lt;file|dir&gt;+ - add files or directories to playlist<br />
      winamp playfile&lt;file|dir&gt;+ - add files to playlist and play them<br />
      <br />
      <b>monitor:</b> switch monitor to low power consuming mode<br />
      monitor suspend - suspend mode<br />
      monitor doze | standby - standby mode<br />
      monitor on - normal mode<br />
      monitor poweroff - switch power off (not supported by most monitors)<br />
      <br />
      <b>volume:</b> change sound volume and mixer controls settings<br />
      volume - display master volume<br />
      volume master=&lt;nn&gt; - set master output volume (in percents)<br />
      volume midi=&lt;nn&gt; - set midi output volume<br />
      volume wave=&lt;nn&gt; - set wave output volume<br />
      volume &lt;control_ID&gt;=nn - set volume control state (see 'ws info sndtree'<br />
      for acceptable IDs and values)<br />
      examples:<br />
      vol master=100 - set full master volume<br />
      volume midi=50 - set volume for midi0 device to 50%<br />
      volume midi2=0 - mute second midi device<br />
      volume 0001=1 - mute all sounds<br />
      <br />
      <b>regdump:</b> dump registry to files, use it to defragment registry<br />
      note. if you can't access some hives, try this:<br />
      ws child -u winlogon.exe ws regdump<br />
      D:\haxor&gt;mel child /?<br />
      child: make child process from a given process (nt only)<br />
      (new process inherits security context of old process)<br />
      child [-u] [-d:Desktop] &lt;hostprocess&gt; &lt;newprocess&gt; [parameters]<br />
      switches:<br />
      -u - use alternative method (undocumented functions)<br />
      -d:&lt;Desktop&gt; - run process on specified desktop (inherited from hostprocess<br />
      by default, use -d to set 'WinSta0\Default')<br />
      example:<br />
      child -d winlogon cmd.exe - start shell with system privileges<br />
      note: you need SeDebugPrivilege, so it's not an exploit<br />
      note: you may use PID for hostprocess like as in 'kill' command<br />
      <br />
      <br />
      <b>service:</b> control windows nt services<br />
      service list [&lt;options&gt;*] - list services<br />
      service start &lt;service&gt;&lt;args&gt; - start service<br />
      service stop &lt;service&gt; - stop service<br />
      service pause &lt;service&gt; - pause running service<br />
      service cont[inue] &lt;service&gt; - resume paused service<br />
      service remove &lt;service&gt; - remove service<br />
      service install [&lt;service&gt;] &lt;fullpath&gt; - install service<br />
      options for list:<br />
      -k - include kernel drivers<br />
      -fs - include filesystem drivers<br />
      -w32 - include win32 services<br />
      -r - list running services<br />
      -s - list stopped services<br />
      -p - list paused services<br />
      -n - disable color output<br />
      &lt;name&gt; - show details about service<br />
      * - details about all services<br />
      note: you can add computer name, username and password before subcommand:<br />
      service \\test Administrator * start ntice - query password<br />
      service \\ws12 Test 123 list - use account of 'Test'<br />
      <br />
      <b>errcode:</b> display error message corresponding to win32 error code<br />
      errcode &lt;errcode&gt; - message corresonding win32 error code<br />
      errcode nt:&lt;errcode&gt; - message corresonding NTSTATUS code<br />
      examples:<br />
      errcode 0x20 - hex error code<br />
      errcode 32 - decimal error code<br />
      errcode 4D5 - hex error code<br />
      errcode nt:0x8000002 - NTSTATUS code<br />
      <br />
      <b>dump:</b> save process memory to disk (rip decrunched data)<br />
      dump [&lt;options&gt;*] &lt;process_name&gt; - save process data<br />
      options:<br />
      -r - save readonly data too (default: only read/write)<br />
      -s - save to single file (for automatic rippers)<br />
      -i - save data belongs to images too (default: private and mapped only)<br />
      (this flag is always set in 9x)<br />
      <br />
      <b>copy:</b> copy file or object (nt only)<br />
      copy [switches] &lt;source-names&gt; &lt;destination&gt;<br />
      switches:<br />
      -block=nnnn - buffer size<br />
      -max=nnnn - copy not more then nnnn bytes from each file<br />
      -so=nnnn - read source from specified offset (&lt;4Gb)<br />
      -do=nnnn - write to destination from specified offset (&lt;4Gb)<br />
      -a - append source to destination<br />
      -r - no read caching<br />
      -w - no write caching<br />
      -k - any key stops copy<br />
      -t - truncate destination at end of data<br />
      special names for source and destination:<br />
      hd0, hd1, ... - physical drives<br />
      pt0, pt1, ... - partition table of physical drive<br />
      a: b: ... - logical drives<br />
      bta, btb, ... - boot sector of drive<br />
      cd0, cd1, ... - cd-roms<br />
      zero - /dev/zero (source)<br />
      rnd - pseudo-random data (source)<br />
      <br />
      <b>sync:</b> flush disk write cache<br />
      sync - flush all fixed disks<br />
      sync [drive:]* - flush specified drives<br />
      <br />
      <b>pause:</b> pause process or thread (nt)<br />
      pause [processname|pid]* - pause all threads of process<br />
      pause -t:&lt;tid&gt;* - pause thread<br />
      <br />
      <b>resume:</b> resume process or thread (nt)<br />
      resume [processname|pid]* - resume all threads of process<br />
      resume -t:&lt;tid&gt;* - resume thread<br />
      <br />
      <b>sleep:</b> do pause<br />
      sleep &lt;nn&gt; - pause for &lt;nn&gt; msec<br />
      <br />
      <b>show:</b> show top-level windows<br />
      show -p &lt;processname&gt; - show all process windows<br />
      show &lt;windowtitle_substring&gt; - show windows with certain title<br />
      <br />
      <b>hide:</b> hide top-level windows<br />
      hide -p &lt;processname&gt; - hide all process windows<br />
      hide &lt;windowtitle_substring&gt; - hide windows with certain title<br />
      <br />
      <b>nc:</b> netcat utility<br />
      nc [&lt;switches&gt;] [host][:port] [&lt;switches&gt;]<br />
      switches:<br />
      -r - reconnect/relisten after closing connection<br />
      -hi - hide input stream<br />
      -ho - hide output stream<br />
      -l:&lt;file&gt; - log to file<br />
      -c&lt;nnnn&gt; - use codepage nnnn<br />
      when no hostname given, program goes to listen mode<br />
      <br />
      <b>runas:</b> create process in another security context (nt only)<br />
      runas [-a] [domain\]user[:password] process [params]*<br />
      switch -a means 'use alternative (NT4 style for 2k, 2k style for NT4) method'<br />
      when no password specified, it's queried<br />
      for windows NT4, you need a SeDebugPrivilege<br />
      <br />
      <b>tweak:</b> change various hidden configuration settings<br />
      tweak cpu [wa:0|1] [dp:0|1] [ewbe:0|1|2|3] - set cpu mode for K6,K6-2,K6-3<br />
      wa: write allocation, dp: data prefetch,<br />
      ewbe: write ordering (0-compatible, ..., 3-fastest)<br />
      default is max performance (wa:1 dp:1 ewbe:3)<br />
      tweak vdm [&lt;low&gt; &lt;hi&gt;] - allow DOS VDM to access ports range (win 2000 only)<br />
      default is 0x388 0x38F (adlib ports) - dos progs can play adlib music<br />
      <br />
      <br />
      As this App can also do a lot of damage the a system I would like to add, that I am in no way responsible for anything you do with it. Some functions might reboot your computer or even worse, if used in the wrong way, so be warned. Aside of this,if you do use its' potential in a non-harming way, it saves you a lot of headaches and script fumbling :)<br />
      <br />
      get it here:<br />
      <br />
      <b><a href="http://doberlec.freeyellow.com/files/" target="_blank">http://doberlec.freeyellow.com/files/</a></b><br />
      <br />
      have fun,<br />
      <br />
      doberlec<br />
      <br />
      P.s. The cmd-list given here is all you get from me documentation-wise.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
      <span class="post-time small text-muted">21st March 2003 12:53 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Great tool! Can you please add a page in the archive too?</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">doberlec</span><br />
      <span class="post-time small text-muted">21st March 2003 15:38 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">done :)</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Freezerman350</span><br />
      <span class="post-time small text-muted">27th July 2004 20:50 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Somebody can tell me why info cpu dont work ?</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Freezerman350</span><br />
      <span class="post-time small text-muted">27th July 2004 20:52 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">The program continu to run in my process but i think is freeze, my cpu is a 2.8 P4 intel</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Joel</span><br />
      <span class="post-time small text-muted">28th July 2004 03:11 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Contact the developer</p>
    </div>
    <hr />

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]>
  </script>
</body>
</html>
