<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="Installation directory defaults to window' system32" />

  <title>Installation directory defaults to window' system32 - NSIS Forums</title><!-- Bootstrap core CSS -->
  <link rel="stylesheet" type="text/css" href="//netdna.bootstrapcdn.com/bootswatch/3.0.1/readable/bootstrap.min.css" />
  <link rel="stylesheet" href="../css/style.css" type="text/css" /><!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!--[if lt IE 9]>
                <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
                <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->
</head>

<body>
  <div class="container">
    <!-- Put navigation bar here -->

    <ol class="breadcrumb">
      <li><a href="../index.html" class="glyphicon glyphicon-home"></a></li>

      <li><a href="f-65.html">NSIS Discussion</a></li>

      <li class="active">Installation directory defaults to window' system32</li>
    </ol>

    <p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=212009">Installation directory defaults to window' system32</a></p><br />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">John0xDEAD</span><br />
      <span class="post-time small text-muted">1st April 2005 19:39 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>Installation directory defaults to window' system32</strong><br />
      I've made my own script file for installing several software components here at work. Once I run the final executable installer and get to choose the installation directory, most of the time it is ok and it defaults to application name, however often it rather defaults to windows' system32!!!<br />
      <br />
      It is quite problematic if someone just expect to click next, next, next and finish. Somehow when the browse button is clicked even though nothing was selected, the installation directory sometime comes back to what is expected.<br />
      <br />
      I've actually "disabled" two computers here at work ( my fault) because of this. Since I was lazy and didn't specifically add all of the files in the de-installation sequence (but rather used Delete "$INSTDIR\*.*” to get rid of any remaining files, followed by RMDir "$INSTDIR") unfortunately, the two times the installation defaulted to windows’ system32 install directory…you can then figure out that happened …<br />
      <br />
      Any clue why it often defaults to system32 ? Does it have to do with “current dir”?<br />
      <br />
      In the script I do install few files in system32 but through the !insertmacro InstallLib macro.<br />
      <br />
      I am using the latest NSIS installer intallation ie.: 2.06<br />
      <br />
      And yes I have now fixed the de-installation sequence to be specific about files to delete :) Too bad that one have to learn lessons the hard way.<br />
      <br />
      Thank.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
      <span class="post-time small text-muted">1st April 2005 20:32 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">The current working directory is not used as the installation directory, unless you've used it to somehow calculate the installation directory. Not much can be said without the script. You should attach it so someone can check it out and tell you what might have gotten wrong.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">John0xDEAD</span><br />
      <span class="post-time small text-muted">1st April 2005 20:45 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">I didn't first posted the script, as I though it wouldn't usefull unless I also attach the equivalent entire tree (only relevant files) so someone can compile the script.<br />
      <br />
      Anyhow here it is.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
      <span class="post-time small text-muted">1st April 2005 20:48 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Here's your problem:</p>
      <pre>
<code>InstallDirRegKey HKLM "${PRODUCT_DIR_REGKEY}" ""<br /># ...<br />WriteRegStr HKLM "${PRODUCT_DIR_REGKEY}" "" "$SYSDIR\FTD2XXUN.EXE"</code>
</pre>You should be writing $INSTDIR to that key, not $SYSDIR.
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">John0xDEAD</span><br />
      <span class="post-time small text-muted">1st April 2005 22:04 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Wow, that was quick! You know your stuff quite well!<br />
      <br />
      I guess those particular lines slip me as I didn't added them myself.<br />
      <br />
      Thank you anyhow.</p>
    </div>
    <hr />

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]>
  </script>
</body>
</html>
