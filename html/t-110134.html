<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="need help regarding multini4 (instopts.dll)" />

  <title>need help regarding multini4 (instopts.dll) - NSIS Forums</title><!-- Bootstrap core CSS -->
  <link rel="stylesheet" type="text/css" href="//netdna.bootstrapcdn.com/bootswatch/3.0.2/readable/bootstrap.min.css" /><!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!--[if lt IE 9]>
                <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
                <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->
</head>

<body>
  <div class="container">
    <!-- Put navigation bar here -->

    <ol class="breadcrumb">
      <li><a href="../index.html" class="glyphicon glyphicon-home"></a></li>

      <li><a href="f-65.html">NSIS Discussion</a></li>

      <li class="active">need help regarding multini4 (instopts.dll)</li>
    </ol>

    <p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=110134">need help regarding multini4 (instopts.dll)</a></p><br />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">lvsram</span><br />
      <span class="post-time small text-muted">17th October 2002 00:43 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>need help regarding multini4 (instopts.dll)</strong><br />
      &nbsp; Hi,<br />
      As i have to insert 2 ini pages, i used InstOpts.dll similar to multini4 on sunjammer's site.I used same macros and same functions.<br />
      My problem is i am getting error when i use<br />
      ReadINIStr $3 "iniA.ini" "Field 3" State<br />
      Please help me.<br />
      <br />
      thanks in advance.<br />
      lvsram</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Freeman II</span><br />
      <span class="post-time small text-muted">17th October 2002 04:58 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">what error message did you get?</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">lvsram</span><br />
      <span class="post-time small text-muted">17th October 2002 15:34 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Now i found the problem that i haven't given the complete path of ini file.<br />
      But there is one thing i feel like knowing.<br />
      Is there any way to know what the error is?<br />
      Thank you very much for the response.<br />
      --lvsram</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
      <span class="post-time small text-muted">17th October 2002 16:26 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">No there isn't. NSIS doesn't return any error strings.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">lvsram</span><br />
      <span class="post-time small text-muted">17th October 2002 22:10 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>need help in testing values from fields / remain in same ini file</strong><br />
      &nbsp; now i am inserting 3 ini files by using multini4 from sunjammer site.<br />
      i am able to get the values. Now my problem is<br />
      1 . i want to make sure the user entered some value in the first and then only i want user to go to second page. and same thing for second and third pages.<br />
      2. Exactly where in the methods onCustomPage, onPageEntry, onPageExit,<br />
      do i have to check(i think mostly in onPageExit) ? and when i check if i find the blank values, how can i force the current page to be shown without going next page, unless user enters some value in the fields.<br />
      <br />
      please help me.<br />
      Thank you</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
      <span class="post-time small text-muted">17th October 2002 22:27 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">In the example (multini4.nsi) you have a function called onCustomPage. In it the DLL is called (CallInstDll "$TEMP\instopts.dll" dialog). All you need to do is condition the entire calling process (quoted below) with some StrCmp or IntCmp depending on the input from the last page.<br />
      <br /></p>
      <pre>
<code>Push "$TEMP\\ini$0.ini"
<br />&gt;CallInstDll "$TEMP\\instopts.dll" dialog
<br />Pop$0
<br />StrCmp$0 "success" Done
<br />  SetErrors
<br />  StrCmp$0 "back" Done
<br /> ; Something else - abort the installer.
<br />    Call CleanUpAll
<br />    Quit 
<br />&gt;
</code>
</pre>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">lvsram</span><br />
      <span class="post-time small text-muted">17th October 2002 22:46 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">sorry i didn't get exactly your point.<br /></p>
      <pre>
<code>

<br />&gt;Function onCustomPage
<br />    MessageBox MB_OK"start of onCustomPage 2val is $2" ;first place
<br />    Exch$2
<br />    MessageBox MB_OK"onCustomPage 2val is $2" ;second place
<br />   ; Show our custom InstOpts pages.
<br />   Push "$TEMP\ini$2.ini"
<br />   CallInstDll "$TEMP\InstOpts.dll" dialog
<br />    Pop$2
<br />    StrCmp$2 "success" Done
<br />    SetErrors
<br />    StrCmp$2 "back" Done
<br />   ; Something else - abort the installer.
<br />   MessageBox MB_OK "onCustomPage 2val in between is $2" ;third place
<br />    Call Cleanup
<br />    Quit
<br />  
<br />  Done:
<br />   MessageBox MB_OK "onCustomPage 2val is $2" ; fourth place
<br />    Pop$2
<br />  FunctionEnd 
<br />&gt;
</code>
</pre>you mean to say to put the checking lines after StrCmp $2 "back" Done<br />
      Thank you very much<br />
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
      <span class="post-time small text-muted">17th October 2002 23:00 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">After you call Exch $2 the page number is in $2 as long as you don't override it with Pop $2 in your example. Just pop the result to somewhere other than $2 ($0 for example) and then you should have the page letter during the whole function untill Pop $2.<br />
      <br />
      If for example you want to save in $R0 the result of the first IO page and then according to it show or not show the second page use:<br /></p>
      <pre>
<code>
onCustomPage
<br />  Exch$0
<br />  Push$1
<br /> ; Show our custom InstOpts pages.
<br /> StrCmp $0 "B" 0 +2 ; second page
<br />   ; // if value of $R0 from last page is
<br />   ; // "don't show" then don't show
<br />   StrCmp $R0 "don't show" Done 
<br /><br />  Push "$TEMP\\ini$0.ini"
<br /> CallInstDll "$TEMP\\instopts.dll" dialog
<br />  Pop$1
<br />  StrCmp$1 "success" ReadData
<br />    SetErrors
<br />    StrCmp$1 "back" ReadData
<br />     ; Something else - abort the installer.
<br />      Call CleanUpAll
<br />      Quit
<br /><br />ReadData:
<br /> StrCmp $0 "A" 0 +2 ; first page
<br />    ReadINIStr $R0"$TEMP\\ini$0.ini" "Field 5" State
<br /> ; else delete $R0 contents
<br />  StrCpy $R0 ""
<br /><br />&gt;Done:
<br /> Pop $1
<br />  Pop$0
<br />FunctionEnd 
<br />&gt;
</code>
</pre>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">lvsram</span><br />
      <span class="post-time small text-muted">21st October 2002 16:25 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Hi Kichik,<br />
      Thank you very much for fast replies.<br />
      Sorry to ask you the same question again and again.<br />
      As i am new and weak in push and pop knowledge, i feel so confused.<br />
      Please help me . I almost done my installation things 80% and when i complete this other 20% which is data validation, i will be done for now.<br />
      <br />
      I used the above code and it is not stopping at the first page still it is going to second page. This is the change i made to your code.<br />
      One more thing exactly i don't know how to control the pages like<br />
      there is a text field in page1 and i want to check that when the user is going to next page, and when the user is going to third page , i want to check a field in second page.<br />
      Second thing is i want to fill one field in a page explicitly myself<br />
      using writeInistr, i feel good place is after calling CallInstDll .<br />
      Please tell me the correct place.<br />
      Please make changes to the below code in your reply.<br />
      <br />
      Thank you very much.<br />
      <br /></p>
      <pre>
<code>
onCustomPage
<br />  MessageBox MB_OK"***91;0***93;start of onCustomPage before exch ,2val is $2" ;first place
<br />  Exch$2
<br />  MessageBox MB_OK "***91;0***93;onCustomPage after exch ,2val is $2" 
<br />  
<br /> ; Show our custom InstOpts pages.
<br /> StrCmp $2 "B" 0 +2 ; second page
<br />   ; // if value of $R9 from last page is
<br />   ; // "don't show" then don't show
<br />   StrCmp $R9 "don't show" Done 
<br /><br />  Push "$TEMP\myini$0.ini"
<br /> CallInstDll "$TEMP\instopts.dll" dialog
<br />  Pop$2
<br />  StrCmp$2 "success" ReadData
<br />    SetErrors
<br />    StrCmp$2 "back" ReadData
<br />     ; Something else - abort the installer.
<br />      Call Cleanup
<br />      Quit
<br /><br />ReadData:
<br /> StrCmp $2 "A" 0 +2 ; first page
<br />    ReadINIStr$3 "$TEMP\myini$2.ini" "Field 8" State
<br />    StrCmp$3 "" 0 +2
<br />    StrCpy $R9 "don't show"
<br /> ; else delete $R9 contents
<br />  StrCpy $R9 ""
<br /><br />&gt;Done:
<br /> Pop $2
<br />FunctionEnd 
<br />&gt;
</code>
</pre>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">lvsram</span><br />
      <span class="post-time small text-muted">23rd October 2002 17:26 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>please help me</strong><br />
      &nbsp; Hi any body,<br />
      please help me.<br />
      Thank you.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
      <span class="post-time small text-muted">24th October 2002 22:48 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"></p>

      <blockquote>
        Second thing is i want to fill one field in a page explicitly myself using writeInistr, i feel good place is after calling CallInstDll. Please tell me the correct place.
      </blockquote>If you want the change to be visible to the user you have to make the change before you call the DLL that will parse the INI file. If you do it after you call the DLL it will not show it.<br />
      <br />
      I have attached a correct script, I will explain about it later if you want, just tell me what you don't understand.
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">lvsram</span><br />
      <span class="post-time small text-muted">25th October 2002 17:16 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>small problem with attachment</strong><br />
      &nbsp; Hi Kichik,<br />
      Thank you very much for help.<br />
      I have copied your coded and tried, but this has small problem.<br />
      Go to First ini<br />
      Click next button<br />
      checking validity of the field in first ini<br />
      if the user left the field in first ini blank then i don't want to proceed forward to any page but keep him in same page. this is similar to all 3 ini pages.<br />
      When i copied your code this is helping not to go to second ini page but going to third ini page.<br />
      If you want i can send you my nsi and ini files.<br />
      <br />
      Thank you very much<br />
      <br />
      the code you sent and i made a change at one line<br />
      StrCmp $3 "" DontShow Show<br /></p>
      <pre>
<code>
;...
<br /> StrCmp $3 "" DontShow Show
<br />&gt;;... 
</code>
</pre><font size="1">no need to rewrite the whole script, only one line has changed... kichik</font>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
      <span class="post-time small text-muted">25th October 2002 18:29 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Use IO's MinLen, MaxLen and ValidateText fields to do the trick. Read more about it in the InstallOptions readme.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">lvsram</span><br />
      <span class="post-time small text-muted">25th October 2002 22:21 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Thank you. I did the above changes checking minlength.</p>
    </div>
    <hr />

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]>
  </script>
</body>
</html>
