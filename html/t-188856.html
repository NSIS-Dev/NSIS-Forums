<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="Newbie: Needs Help with Text to File + Registation Email" />

  <title>Newbie: Needs Help with Text to File + Registation Email - NSIS Forums</title><!-- Bootstrap core CSS -->
  <link rel="stylesheet" type="text/css" href="//netdna.bootstrapcdn.com/bootswatch/3.0.1/readable/bootstrap.min.css" />
  <link rel="stylesheet" href="../css/style.css" type="text/css" /><!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!--[if lt IE 9]>
                <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
                <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->
</head>

<body>
  <div class="container">
    <!-- Put navigation bar here -->

    <ol class="breadcrumb">
      <li><a href="../index.html" class="glyphicon glyphicon-home"></a></li>

      <li><a href="f-65.html">NSIS Discussion</a></li>

      <li class="active">Newbie: Needs Help with Text to File + Registation Email</li>
    </ol>

    <p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=188856">Newbie: Needs Help with Text to File + Registation Email</a></p><br />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">PCEnhancer</span><br />
      <span class="post-time small text-muted">4th August 2004 10:40 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>Newbie: Needs Help with Text to File + Registation Email</strong><br />
      Hi i'm back, My installer is now reaching the end of its completion. By it's not there yet. I am trying to build a Registation page that will put a copy of all the fields Entered into a "Regstation.Txt" file in the programs "$INSTDIR". The other thing that is causing me the even more trouble is trying to figure out how to get the Regstation information to Email its self to my email account. Please Help.<br />
      <br />
      :( I know this is a lot to ask but i wouldn't ask unless there was no other way. Tank you.<br />
      <br />
      Please Note that when this Project reaches its completion. I will be putting a large sample of its .nsi with all it Functions and a few of my files up for grabs in the <a href="http://nsis.sourceforge.net/nsisarchive/" target="_blank">http://nsis.sourceforge.net/nsisarchive/</a><br />
      with full credit to all who help(ed).<br />
      <br />
      Here is a very small sample what i have so far on the Regstation Page.<br />
      <br />
      ;Text to File - Registation Page<br />
      !include "MUI.nsh"<br />
      ;Name and file<br />
      Name "Text to File"<br />
      OutFile "Text.exe"<br />
      ;Default installation folder<br />
      InstallDir "$PROGRAMFILES\Text in Here"<br />
      ;Get installation folder from registry if available<br />
      InstallDirRegKey HKCU "Software\Text in Here" ""<br />
      <br />
      Page custom Regstation<br />
      !insertmacro MUI_PAGE_DIRECTORY<br />
      !insertmacro MUI_PAGE_INSTFILES<br />
      !insertmacro MUI_LANGUAGE "English"<br />
      <br />
      Section "Dummy Section" SecDummy<br />
      SectionEnd<br />
      ;--------------------------------<br />
      ;Installer Functions<br />
      Function .onInit<br />
      InitPluginsDir<br />
      File /oname=$PLUGINSDIR\Text.ini "Text.ini"<br />
      ;Extract InstallOptions INI files<br />
      !insertmacro MUI_INSTALLOPTIONS_EXTRACT "RegistrationDialog.ini"<br />
      FunctionEnd<br />
      Function Regstation<br />
      InstallOptions::dialog "$PLUGINSDIR\Text.ini"<br />
      FunctionEnd<br />
      <br />
      ;-----------------------<br />
      HERE IS THE: Text.ini<br />
      ;-----------------------<br />
      [Settings]<br />
      NumFields=10<br />
      Title=Registion Page<br />
      <br />
      [Field 1]<br />
      Type=Label<br />
      Text=*First Name*<br />
      Left=0<br />
      Right=90<br />
      Top=0<br />
      Bottom=9<br />
      <br />
      [Field 2]<br />
      Type=Text<br />
      Text=First name<br />
      Left=0<br />
      Right=103<br />
      Top=9<br />
      Bottom=22<br />
      <br />
      [Field 3]<br />
      Type=Label<br />
      Text=*E-Mail*<br />
      Left=1<br />
      Right=25<br />
      Top=25<br />
      Bottom=33<br />
      <br />
      [Field 4]<br />
      Type=Text<br />
      Text=E-Mail<br />
      Left=0<br />
      Right=103<br />
      Top=33<br />
      Bottom=46<br />
      <br />
      [Field 5]<br />
      Type=Groupbox<br />
      Text=O/S<br />
      Left=112<br />
      Right=162<br />
      Top=11<br />
      Bottom=46<br />
      <br />
      [Field 6]<br />
      Type=RadioButton<br />
      Text=Unknown<br />
      Flags=GROUP<br />
      State=1<br />
      Left=118<br />
      Right=160<br />
      Top=20<br />
      Bottom=27<br />
      <br />
      [Field 7]<br />
      Type=RadioButton<br />
      Text=WinXP<br />
      Left=118<br />
      Right=152<br />
      Top=27<br />
      Bottom=35<br />
      <br />
      [Field 8]<br />
      Type=RadioButton<br />
      Text=Other<br />
      Left=118<br />
      Right=152<br />
      Top=35<br />
      Bottom=43<br />
      <br />
      [Field 9]<br />
      Type=Label<br />
      Text=Yes, I would like to get updates by E-Mail<br />
      Left=25<br />
      Right=200<br />
      Top=62<br />
      Bottom=102<br />
      <br />
      [Field 10]<br />
      Type=Checkbox<br />
      State=1<br />
      Left=11<br />
      Right=21<br />
      Top=62<br />
      Bottom=72</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
      <span class="post-time small text-muted">4th August 2004 13:17 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">You cannot easily force the user's computer to silently send you an email. If that were possible, then that would leed to people getting hold of people's private data etc and that would/could be illegal.<br />
      <br />
      You can however, do</p>
      <pre>
<code>ExecShell "" "mailto:your.email&amp;website.com?subject=$title&amp;body=$text"</code>
</pre><br />
      Not sure if this will work with all E-mail client programs, but it works with Outlook/Outlook Express.<br />
      <br />
      To get hold of all the entered data, use ReadINIStr $var "IOfile.ini" "Field X" "State"<br />
      To collect it all into the your $text variable, use StrCpy $text "$var1&lt;html stuff&gt;$var2 etc"<br />
      <br />
      Remember if you are using the method that I suggested, you need to send HTML to the E-mail's body, not just pure text with new line breakes ($\r$\n == &lt;br /&gt;).<br />
      <br />
      Also, my examples use $text, $var, $var1 etc for variables. These have to be defined first, or you should just use the readily defined ones ($0-9, $R0-9)<br />
      <br />
      -Stu
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">deguix</span><br />
      <span class="post-time small text-muted">4th August 2004 13:49 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"></p>

      <blockquote>
        Not sure if this will work with all E-mail client programs, but it works with Outlook/Outlook Express.
      </blockquote>Remember that Internet Explorer has an option to choose what program to open for e-mails.
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">PCEnhancer</span><br />
      <span class="post-time small text-muted">4th August 2004 14:21 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">:) Thank you for your help. I will try what you have suggested and let you know how it works out. Theres just one thing Im not sure of, How do you send an HTML to the E-mail's body. Could you give me a sample of how "all" this should look?:confused: It would realy help. I am So lost. Thanks.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">OJglass</span><br />
      <span class="post-time small text-muted">4th August 2004 22:09 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">You would be better off to hit a website and pass the information you need in through query strings to a script that can then take some action based on the values that are passed to it.<br />
      <br />
      Personally i think it would be best to use the download plugin so you can verify (by receiving a .ini file for instance and parsing it) if the script received the information correctly.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">PCEnhancer</span><br />
      <span class="post-time small text-muted">5th August 2004 03:53 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Thank you for your help, but i am still very lost :confused:. The (ExecShell "" "mailto:your.email&amp;subject=$title&amp;body=$text") works ok but I am not sure how to use the "$title" or "$text" variables. And the (ReadINIStr $var "IOfile.ini" "Field X" "State") is not working for me, I think I have things mixed up.<br />
      <br />
      If you could wright a sample of how this needs to look it would Realy Realy Help. Thanks<br />
      <br />
      Also is there a way to make the "Next&gt;" buttion only on the custom page say Register and have it launch the "ExecShell"</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">flizebogen</span><br />
      <span class="post-time small text-muted">5th August 2004 07:34 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Besides the legal issues perhaps BLAT can help you. It's an open source command line email sender. <a href="http://blat.sf.net" target="_blank">http://blat.sf.net</a></p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">PCEnhancer</span><br />
      <span class="post-time small text-muted">7th August 2004 05:09 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Thanks for BLAT it will hopefully be a big help. But I am still in Confusion with (ReadINIStr $var "IOfile.ini" "Field X" "State") the ($text) variables, and the (StrCpy $text "$var1&lt;html stuff&gt;$var2).<br />
      <br />
      I really need to see an example or two, this part is killing me. every thing I have tried has failed. Please help.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">PCEnhancer</span><br />
      <span class="post-time small text-muted">15th August 2004 06:37 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Thank you for all your help, i have my Registation page almost done. the only thing that I still cant figure out is how to get BLAT to work. all the information is in a text file, I just need to get that text file to email its self to me using Blat or some other program during the installation. Please Help. Examples would be helpful. Thanks</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
      <span class="post-time small text-muted">16th August 2004 11:38 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">If it's an exe, you need to Exec it or, nsExec::Exec.<br />
      <br />
      You will need too extract it to a temp folder, so...<br />
      <br /></p>
      <pre>
<code>Function .onInit<br /> InitPluginsDir<br />FunctionEnd<br />Section<br /> SetOutPath $PLUGINSDIR<br /> File "blat.exe"<br /> File ...other blat files...<br /> nsExec::Exec "$PLUGINSDIR\blat.exe -options"<br />SectionEnd</code>
</pre>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">PCEnhancer</span><br />
      <span class="post-time small text-muted">16th August 2004 20:55 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Thank that helped<br />
      <br />
      only I used (nsExec::ExecToLog) it hides the window.<br />
      nsExec::ExecToLog "C:\blat.exe - a command"<br />
      <br />
      Thanks a lot everything.:)<br />
      <br />
      the only thing that i need to do now is figure out how to put a check box on the WELCOMEPAGE that will skip a page if checked [NOTE] I know how to skip pages, i just dont know how to put a check box on only the WELCOMEPAGE</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
      <span class="post-time small text-muted">17th August 2004 14:37 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">nsExec::ExecToLog should be used only on the InstFiles page. It grabs the output and prints it into the details window. You should use nsExec::Exec.<br />
      <br />
      -Stu</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">PCEnhancer</span><br />
      <span class="post-time small text-muted">18th August 2004 18:33 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Thanks but nsExec::ExecToLog works like ExecWait and if placed in the right spot like a Function, does not print on the InstFiles page. Tanks for your help.<br />
      <br />
      I Do have two more questions in:<br />
      ;--------------------------------<br />
      Function .onVerifyInstDir<br />
      IfFileExists "$INSTDIR" PathGood<br />
      MessageBox MB_YESNO|MB_TOPMOST " Are you sure you whant to install here. \<br />
      $\r$\n$\r$\nIf you choose install here the some things will not work. IDYES PathGood IDNO installold<br />
      installold:<br />
      MessageBox MB_YESNO|MB_TOPMOST "${APPNAME} Installation must be restarted to restore destination Folder $\n Restart Now? " \<br />
      IDNO PathGood IDYES<br />
      Quit ;Abort<br />
      PathGood:<br />
      FunctionEnd<br />
      ;------------------------------<br />
      How do you reset the "$INSTDIR" so that you do not have to restart the app?<br />
      <br />
      And in a text box how do make it tab over to the next box if more than one "word" is used, but only tab over in that one box and not the others. And is it possible to make the first letter in thows that one box automaticly swich to a capital while the fallowing letters are lower case<br />
      Thank you for your time and help.</p>
    </div>
    <hr />

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]>
  </script>
</body>
</html>
