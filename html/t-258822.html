<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="convertion from string to defined constant" />

  <title>convertion from string to defined constant - NSIS Forums</title>
  <script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script>
  <!-- Bootstrap core CSS -->

  <link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css" />
  <link rel="stylesheet" href="../css/style.css" type="text/css" /><!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!--[if lt IE 9]>
                <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
                <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->
</head>

<body>
  <div class="container">
    <!-- Put navigation bar here -->

    <ol class="breadcrumb">
      <li><a href="../index.html" class="glyphicon glyphicon-home"></a></li>

      <li><a href="f-65.html">NSIS Discussion</a></li>

      <li class="active">convertion from string to defined constant</li>
    </ol>

    <p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=258822">convertion from string to defined constant</a></p><br />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">bjorlykke</span><br />
      <span class="post-time small text-muted">3rd November 2006 09:30 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>convertion from string to defined constant</strong><br />
      I'm wondering if there is any way to convert a string to a defined constant. I've made some definitions like this (the number of defined constants could vary):<br />
      <br />
      !define DEF1 "help"<br />
      !define DEF2 "me"<br />
      !define DEF3 "please"<br />
      <br />
      And I want to create a loop where I increment the number in the defined name. I've tried something like this (without the loop, and without success...):<br />
      <br />
      StrCpy $R0 1<br />
      <br />
      StrCpy $R1 "DEF$R0" # $R1 is now "DEF1"<br />
      <br />
      ;Now I try to refer to $DEF1 without success<br />
      WriteRegStr HKLM "Path" "Name" "${$R1}"<br />
      <br />
      Is there any way to solve this? Alternatively another way to do this operation?<br />
      <br />
      Thanks...</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
      <span class="post-time small text-muted">3rd November 2006 10:56 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">You can't do that with StrCpy and friends because that's mixing runtime and build time. StrCpy is executed at runtime on the user's computer while the processing of defines is done at build time.<br />
      <br />
      You can use an <a href="http://nsis.sourceforge.net/Invoking_NSIS_run-time_commands_on_compile-time" target="_blank">external application</a> to calculate the sum of your variables and have it save the result in a .nsh file you can later !include.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">ZmAn3</span><br />
      <span class="post-time small text-muted">11th September 2008 18:40 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">I need some help I was trying to do the same thing with defines but since its compile time its not gonna work, Im trying to ,at run time set the custom nsdialogs page that is shown<br />
      based on info gathered in Function .onInit so i have<br />
      <br /></p>
      <pre>
<code><br />so like i have<br />Function .onInit<br />  !insertmacro MULTIUSER_INIT<br />;---misc code to check if $=ok or not here<br />${If} $1 != 'ok'<br />  !define PAGETOSHOW NsdialogsErrorPage<br />${EndIf}<br /><br />${If} $1 == "ok"<br />!define PAGETOSHOW NsdialogsEverythingGoodPage<br />${EndIf}<br />FunctionEnd<br /> <br /></code>
</pre><br />
      <br />
      then for the pages section I have<br />
      Page custom "${PAGETOSHOW}"<br />
      <br />
      soo this will dot work since defines are compile time Ive tryed it as a Var instead but then the page custom throws a error
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
      <span class="post-time small text-muted">12th September 2008 08:51 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Use GetFuncAddress instead and put the result in a global variable. Then, in the custom page function, use Call on that variable. Or simply add an ${If} in the custom page on the value of some variable and call the appropriate function.</p>
    </div>
    <hr />

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]>
  </script>
</body>
</html>
