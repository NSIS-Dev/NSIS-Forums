<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="description" content="nsDialogs"><title>nsDialogs - NSIS Forums</title><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script><link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css"><link rel="stylesheet" href="../css/style.css" type="text/css"><!--[if lt IE 9]><script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script><script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script><![endif]--></head><body><div class="container"><ol class="breadcrumb"><li><a href="../index.html" class="glyphicon glyphicon-home"></a></li><li><a href="f-65.html">NSIS Discussion</a></li><li class="active">nsDialogs</li></ol><p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=273670">nsDialogs</a></p><br><div class="post"><p class="post-meta"><span class="post-author text-primary">kichik</span><br><span class="post-time small text-muted">30th June 2007 17:18 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>nsDialogs</strong><br>&nbsp; It's time for something really new. I wrote a plug-in that should replace InstallOptions in the near future. It should be faster, more capable, far more customizable and easier to use. Currently it can create any type of control, call callback functions directory from the script and create dialogs without all the INI files overhead.<br><br>It supports specifying units in pixels, dialog units and percentage - both positive and negative. It has a callback for TEXT field changes and for the back button. It's way <i>faster</i>. It has complete control over the style of the generated controls, including extended styles.<br><br>When it's done, it'll be even possible to create a real-time InstallOptions to nsDialogs converter that'd simply read the INI file and create the dialog according to it.<br><br>At the moment, creating a control requires quite a lot of parameters, but in the future it'll have a library of macros or functions that'd allow easier creation that requires nothing more than a type and location - just like with InstallOptions.<br><br>Play with it and let me know if you have any suggestions or issues in mind. Attach cool examples here or useful macros you write and I'll probably include them when nsDialogs goes into CVS.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br><span class="post-time small text-muted">30th June 2007 17:28 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">That's very nice. Can ExecuteCodeSegment be used in any NSIS plugin?<br><br>Stu</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">kichik</span><br><span class="post-time small text-muted">30th June 2007 17:30 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Yes, any plug-in. It has been added in NSIS 2.03 and as far as I know, this is the first plug-in to use it.<br><br>edit: actually, there's already my incomplete <a href="http://forums.winamp.com/showthread.php?postid=1621339" target="_blank">nsXML</a>.<br>edit2: the <a href="http://nsis.sourceforge.net/UAC_plug-in" target="_blank">UAC plug-in</a> too...</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br><span class="post-time small text-muted">30th June 2007 18:23 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">I cannot believe that went unnoticed lol<br>I can use that in my ButtonEvent plugin :D<br><br>Edit: Done.<br><br>Stu</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Backland</span><br><span class="post-time small text-muted">30th June 2007 22:41 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Excellent work, sounds like a major improvement in terms of custom installer dialogs.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Comm@nder21</span><br><span class="post-time small text-muted">1st July 2007 17:57 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">looks nice :)</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">kichik</span><br><span class="post-time small text-muted">1st July 2007 18:22 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">And here's the first version of the script that converts existing INI files to a new dialog. Shouldn't be too hard to have it generate the script itself as well.<br><br>The plug-in itself has changed a bit and now takes the text parameter as the last parameter to nsDialogs::CreateItem.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">kichik</span><br><span class="post-time small text-muted">6th July 2007 12:46 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">And with browse buttons too.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Backland</span><br><span class="post-time small text-muted">10th July 2007 19:55 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">This is really great for for creating on the fly interfaces, but will it be able to setup event handlers for controls defined in the INI?</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">kichik</span><br><span class="post-time small text-muted">10th July 2007 21:16 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">The NOTIFY flag will eventually be supported by the IO2nsDialogs function. But you can already do the same when using nsDialogs directly with nsDialogs::OnClick and nsDialogs::OnChange which is not even supported by InstallOptions.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Backland</span><br><span class="post-time small text-muted">12th July 2007 08:22 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Is it possible to set nsDialogs::OnClick for controls created from an IO script? that would be the ultimate solution for getting the best of both formats.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">kichik</span><br><span class="post-time small text-muted">12th July 2007 17:21 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Yes. All the conversion does is read the INI file and use nsDialogs according to it. You can read the HWND from the INI and use nsDialogs::OnClick with it.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Animaether</span><br><span class="post-time small text-muted">14th July 2007 22:25 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">just wanted to say: very cool. I'll be awaiting the usual first few days of "zomg - it just imploded!" before tinkering with it myself, after which our highly customized installer will probably be moving to nsDialogs from InstallOptions. Should save a bunch of code and - more importantly - run faster (takes a second on some of the heavier dialogs on my P1.6M). Might keep the INIs, as currently there's no GUI interface designer for nsDialogs, is there? :)</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br><span class="post-time small text-muted">14th July 2007 22:27 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">That would be handy :D<br><br>Stu</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Red Wine</span><br><span class="post-time small text-muted">15th July 2007 21:55 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">I want to transfer some scripts where in custom page leave function there are several ReadINIStr conditions and actions' dependency.<br><br>How should I do that?<br>Are there any suggestions and/or tips?</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Red Wine</span><br><span class="post-time small text-muted">16th July 2007 13:30 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Well... I guess I should start from scratch, thanks :)</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Animaether</span><br><span class="post-time small text-muted">16th July 2007 13:53 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">your question is a bit vague, so I'm not sure what the answer would be. The way I'm reading it right now is that you're using the INI file as a form of variable storage - and depending on the multiple values in the INI file (in the variables), you take a particular action.<br><br>Sounds to me like you could...<br>A. Stick to using an INI file - except that for each control's callback you'll need to write out the value manually.<br>B. For each control's callback, write to a different text file. (Essentially the same as the ini - but more work)<br>C. For each control's callback, assign the value to a runtime variable - and instead of reading from an ini / text file, read the runtime variable.<br><br>In essence, nsDialogs makes creating the dialogs more flexible, faster (code execution-wise) and independent of ini file storage. Those are the immediate Pros. The immediate cons are that a lot of the automation is gone. I.e. changing a text box's text doesn't automatically store this - you'll have to store this yourself (in a variable of file), through a function that you have to write out, and then associate with the text box's change handler. So on the face of it - it's certainly a good bit more work. I suspect that as you get used to it, though, it'll prove to be a great enhancement.<br><br>Eventually some GUI editor for use with nsDialogs will come up and in each control's property sheet there'll just be a "code block to execute when changed" sort of text box, along with a small "code block name", which together simply set up all the Function handling and such for you.<br><br>Of course, if it remains something where you think "InstallOptions did just fine for me, and I'm more comfortable with it" - well, InstallOptions doesn't appear to be going away, and the InstallOptionsEx author(s) might have a thing or two to say about the Pros/Cons and decide to continue development there as well :)</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br><span class="post-time small text-muted">17th July 2007 22:54 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Just a suggestion, would be nice to have NSD_ macros for OnClick etc, and have GetFunctionAddress in them.<br><br>Stu</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Brummelchen</span><br><span class="post-time small text-muted">18th July 2007 03:30 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">/ot: would be nice to handle pluginsdir in memory - not on disk :p<br><br>still working on a "installer script language"? :D</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">kichik</span><br><span class="post-time small text-muted">18th July 2007 06:04 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Brummelchen, you can't load DLL files from memory. How is this related to a new scripting language?</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br><span class="post-time small text-muted">18th July 2007 15:59 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">If you don't want to use $PLUGINSDIR, extract the DLL yourself and use CallInstDLL instead. For example, the NSISArray plugin has built in support for this while still using the macros.<br><br>Stu</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Brummelchen</span><br><span class="post-time small text-muted">18th July 2007 17:37 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">as long i write installers i dont care on pluginsdir.<br>as i started with portables like portableapps.com i wish<br>to have that in memory - but ok, this is really /ot now.<br><br>i appreciate a newer gui with modern commands - but i dont<br>really get the point on mouse-effects or similar jokes<br>on an "installer script"<br><br>but - if nsis goes away from a simple installer script -<br>and it does - why not to ask for that option above!? ;)</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">kichik</span><br><span class="post-time small text-muted">18th July 2007 17:41 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Brummelchen, implement a memory-DLL loader and I'll include it.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Brummelchen</span><br><span class="post-time small text-muted">18th July 2007 17:48 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">"i'm afraid dave - i cant do this" :D<br>i am no programmer - i can do only scripts :(<br>but if that would be possible - much appreciated :)</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">kichik</span><br><span class="post-time small text-muted">18th July 2007 17:50 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"></p><blockquote>Brummelchen, you can't load DLL files from memory.</blockquote></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">tdue</span><br><span class="post-time small text-muted">19th July 2007 08:32 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Hello,<br><br>Is there an automated method of converting a IO ini file to a nsDialogs script? I THOUGHT the io.nsi file in the zip file posted earlier would do it, but that does not seem to be the case.<br><br>In any event I have been playing around with NSIS (and HM NIS Edit) for the last couple of days. My installer experience is limited to InstallShield 10.5 and the build-in MSI installer in Visual Studio. I must say I am vastly impressed with NSIS.<br><br>I am seriously lacking integration with Source Safe and Visual Studio though, but I guess I can manage without... for now ;)</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">kichik</span><br><span class="post-time small text-muted">20th July 2007 16:55 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">io.nsi only displays INI files using nsDialogs. In the future, it should also be able to create a script.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">bnicer</span><br><span class="post-time small text-muted">20th July 2007 16:59 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Well done!<br><br>I'd give my left toe in exchange for something that's better. Manually converting the controls seems to be the first step along the way. I've encountered a problem:<br><br>SetCtlColors $TEXT 0x000000 transparent<br><br>The nsDialogs Welcome.nsi example uses:<br><br>"" 0xffffff<br><br>Is "transparent" not supported?</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">kichik</span><br><span class="post-time small text-muted">20th July 2007 17:09 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">"transparent" is a feature of NSIS and not nsDialogs, so it's supported just like in InstallOptions. nsDialogs simply forwards relevant messages to NSIS for handling the colors.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">bnicer</span><br><span class="post-time small text-muted">20th July 2007 17:21 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Oddly enough,<br><br><font color="#7E0117">SetCtlColors $TEXT 0x000000 transparent</font><br><br>does not make the background transparent.<br><br><font color="#7E0117">SetCtlColors $TEXT 0x000000 0x0000ff</font><br><br>changes the background to blue. ???</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">vbguy</span><br><span class="post-time small text-muted">20th July 2007 17:47 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"></p><blockquote><i>Originally posted by bnicer</i><br><b>Oddly enough,<br><br><font color="#7E0117">SetCtlColors $TEXT 0x000000 transparent</font><br><br>does not make the background transparent.<br><br><font color="#7E0117">SetCtlColors $TEXT 0x000000 0x0000ff</font><br><br>changes the background to blue. ???</b></blockquote>0x0000ff is blue.<br><br>This is how you set controls to transparent:<br><br><font color="#7E0117">SetCtlColors $TEXT 0x000000 "transparent"</font></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">kichik</span><br><span class="post-time small text-muted">20th July 2007 17:51 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Add the WS_EX_TRANSPARENT extended style to the CreateItem call and it should work.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">bnicer</span><br><span class="post-time small text-muted">20th July 2007 18:04 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">I always get white.<br><br>Compile Welcome.nsi with a transparent text background.</p><pre>
Function nsDialogsWelcome
<br><br>    nsDialogs::Create /NOUNLOAD 1044
<br>    Pop $DIALOG
<br><br>    nsDialogs::CreateItem /NOUNLOAD STATIC 
<br><br>${WS_VISIBLE}|${WS_CHILD}|${WS_CLIPSIBLINGS} 0 120u 10u -130u 20u "Welcome to nsDialogs!"
<br>    Pop $HEADLINE
<br><br>    SendMessage $HEADLINE${WM_SETFONT} $HEADLINE_FONT 0
<br><br>    nsDialogs::CreateItem /NOUNLOAD STATIC 
<br><br>${WS_VISIBLE}|${WS_CHILD}|${WS_CLIPSIBLINGS} 0 120u 32u -130u -32u "nsDialogs is the next generation..."
<br>    Pop $TEXT
<br><br>    SetCtlColors $DIALOG"" 0xffffff
<br>    SetCtlColors $HEADLINE"" 0xffffff
<br>    SetCtlColors $TEXT 0xffffff "transparent"
<br><br>   nsDialogs::CreateItem /NOUNLOAD STATIC 
<br><br>${WS_VISIBLE}|${WS_CHILD}|${WS_CLIPSIBLINGS}|${SS_BITMAP} 0 0 0 109u 193u ""
<br>    Pop $IMAGECTL
<br><br>    StrCpy$0 $PLUGINSDIRwelcome.bmp
<br>    System::Call 'user32::LoadImage(i 0, t r0, i ${IMAGE_BITMAP}, i 497, i 0, i ${LR_LOADFROMFILE}) i.s'
<br>    Pop $IMAGE
<br>    
<br>    SendMessage $IMAGECTL${STM_SETIMAGE} ${IMAGE_BITMAP} $IMAGE
<br><br>    Call HideControls
<br><br>    nsDialogs::Show
<br><br>    Call ShowControls
<br><br>    System::Call gdi32::DeleteObject(i$IMAGE)
<br><br>&gt;FunctionEnd 
<br>&gt;

</pre>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br>
      <span class="post-time small text-muted">20th July 2007 18:13 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">That example doesn't use WS_EX_TRANSPARENT, you need to add it. Replace the 0 that comes after the styles with ${WS_EX_TRANSPARENT}. Don't forget to copy its definition from nsDialogs.nsh.</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">bnicer</span><br>
      <span class="post-time small text-muted">20th July 2007 18:18 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">WS_EX_TRANSPARENT extended style; how do I define it?<br>
      <br>
      I have, so far...</p>
      <pre>
<code>
nsDialogs::CreateItem /NOUNLOAD STATIC ${WS_VISIBLE}|${WS_CHILD}|${WS_CLIPSIBLINGS}|$(WS_EX_TRANSPARENT) 0 120u 32u -130u -32u "nsDialogs is the next generation..." 
</code>
</pre>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br>
      <span class="post-time small text-muted">20th July 2007 18:19 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Take the definition from nsDialogs.nsh and replce the zero before 120u with it.</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">bnicer</span><br>
      <span class="post-time small text-muted">20th July 2007 18:21 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Thanks. Our replies keep on crossing. I'll try that.</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">FoBoT</span><br>
      <span class="post-time small text-muted">21st July 2007 21:29 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">does the BrandingImage stuff work with this yet?<br>
      I copy/pasted the commands below into InstallOptions.nsi pointing to my .ini file<br>
      <br>
      ChangeUI all "${NSISDIR}\Contrib\UIs\modern.exe"<br>
      AddBrandingImage top 20<br>
      SetBrandingImage "$PLUGINSDIR\logo.bmp"<br>
      <br>
      from a working InstallOptions version and it displays correctly except the logo is missing from the top of the page</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">FoBoT</span><br>
      <span class="post-time small text-muted">21st July 2007 22:13 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">also, is the functionality in place yet to change the cancel/next button labels? for example my old .ini files has:<br>
      <br>
      [Settings]<br>
      NumFields=2<br>
      Title=Control Panel<br>
      CancelEnabled=1<br>
      CancelShow=1<br>
      BackEnabled=1<br>
      CancelButtonText=Exit<br>
      NextButtonText=Enter<br>
      <br>
      so that the cancel/next buttons display custom text<br>
      <br>
      thank you</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Animaether</span><br>
      <span class="post-time small text-muted">22nd July 2007 01:17 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">You can always do that manually, FoBoT. In fact, it's more flexible with nsDialogs as you can enable/disable / change texts on those buttons dynamically based on what the user is doing - with any dialog item rather than only those that would cause an InstallOptions exit.<br>
      <br></p>
      <pre>
<code><br>GetDlgItem $0 $HWNDPARENT 1 ; Next button<br>SendMessage $0 ${WM_SETTEXT} 0 "STR:Custom Next"<br>GetDlgItem $0 $HWNDPARENT 3 ; Next button<br>SendMessage $0 ${WM_SETTEXT} 0 "STR:Custom Back"<br></code>
</pre>
    </div>
    <hr>

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]></script></body></html>