<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="description" content="InstallOptionsEx"><title>InstallOptionsEx - NSIS Forums</title><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script><link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css"><link rel="stylesheet" href="../css/style.css" type="text/css"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="description" content=" InstallOptionsEx"><title>InstallOptionsEx - NSIS Forums</title><link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css"><link rel="stylesheet" href="../css/style.css" type="text/css"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="description" content=" InstallOptionsEx"><title>InstallOptionsEx - NSIS Forums</title><link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css"><link rel="stylesheet" href="../css/style.css" type="text/css"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="description" content=" InstallOptionsEx"><title>InstallOptionsEx - NSIS Forums</title><link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css"><link rel="stylesheet" href="../css/style.css" type="text/css"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="description" content=" InstallOptionsEx"><title>InstallOptionsEx - NSIS Forums</title><link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css"><link rel="stylesheet" href="../css/style.css" type="text/css"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="description" content=" InstallOptionsEx"><title>InstallOptionsEx - NSIS Forums</title><link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css"><link rel="stylesheet" href="../css/style.css" type="text/css"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="description" content=" InstallOptionsEx"><title>InstallOptionsEx - NSIS Forums</title><link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css"><link rel="stylesheet" href="../css/style.css" type="text/css"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="description" content=" InstallOptionsEx"><title>InstallOptionsEx - NSIS Forums</title><link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css"><link rel="stylesheet" href="../css/style.css" type="text/css"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="description" content=" InstallOptionsEx"><title>InstallOptionsEx - NSIS Forums</title><link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css"><link rel="stylesheet" href="../css/style.css" type="text/css"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="description" content=" InstallOptionsEx"><title>InstallOptionsEx - NSIS Forums</title><link rel="preload" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css" as="style" onload="this.rel='stylesheet'"><link rel="preload" href="../css/style.css" as="style" onload="this.rel='stylesheet'"><noscript><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css"><link rel="stylesheet" href="../css/style.css"></noscript><script>!function(a){"use strict";var b=function(b,c,d){function e(a){return h.body?a():void setTimeout(function(){e(a)})}function f(){i.addEventListener&&i.removeEventListener("load",f),i.media=d||"all"}var g,h=a.document,i=h.createElement("link");if(c)g=c;else{var j=(h.body||h.getElementsByTagName("head")[0]).childNodes;g=j[j.length-1]}var k=h.styleSheets;i.rel="stylesheet",i.href=b,i.media="only x",e(function(){g.parentNode.insertBefore(i,c?g:g.nextSibling)});var l=function(a){for(var b=i.href,c=k.length;c--;)if(k[c].href===b)return a();setTimeout(function(){l(a)})};return i.addEventListener&&i.addEventListener("load",f),i.onloadcssdefined=l,l(f),i};"undefined"!=typeof exports?exports.loadCSS=b:a.loadCSS=b}("undefined"!=typeof global?global:this);!function(a){if(a.loadCSS){var b=loadCSS.relpreload={};if(b.support=function(){try{return a.document.createElement("link").relList.supports("preload")}catch(b){return!1}},b.poly=function(){for(var b=a.document.getElementsByTagName("link"),c=0;c<b.length;c++){var d=b[c];"preload"===d.rel&&"style"===d.getAttribute("as")&&(a.loadCSS(d.href,d,d.getAttribute("media")),d.rel=null)}},!b.support()){b.poly();var c=a.setInterval(b.poly,300);a.addEventListener&&a.addEventListener("load",function(){b.poly(),a.clearInterval(c)}),a.attachEvent&&a.attachEvent("onload",function(){a.clearInterval(c)})}}}(this);</script></head><body><div class="container"><ol class="breadcrumb"><li><a href="../index.html" class="glyphicon glyphicon-home"></a></li><li><a href="f-65.html">NSIS Discussion</a></li><li class="active">InstallOptionsEx</li></ol><p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=181087">InstallOptionsEx</a></p><br><div class="post"><p class="post-meta"><span class="post-author text-primary">deguix</span><br><span class="post-time small text-muted">25th May 2004 00:34 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>InstallOptionsEx</strong><br>I modified the original version of InstallOptions to add some controls (not supported by all OS, or with others special requirements) and to make some additional changes:<br><br>- Removed NumFields from INI File "Settings" section.<br>- Added Animation and ProgressBar controls.<br>- Added ability of ComboBox and DropList controls of supporting images for each item in their list boxes.<br>- Added TRANSPARENT, CENTER and NOAUTOPLAY flags for Animation controls and SMOOTH and VERTICAL flags for ProgressBar controls.<br>- Added support of NOTIFY flag for Text, Password and ComboBox controls.<br><br>This is just beta version, it probably has some bugs and I don't know, I'm not responsible for problems it gonna make, as even it's <b>my first touch in C++</b>.<br><br>Included the .dll and its readme.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Joel</span><br><span class="post-time small text-muted">25th May 2004 01:09 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">I'll test it :)<br><br>// <b>edit by me</b></p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">deguix</span><br><span class="post-time small text-muted">25th May 2004 01:19 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">For the next version I'll be targeting the easiest controls to implement, as Trackbar.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">zimsms</span><br><span class="post-time small text-muted">25th May 2004 16:33 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">It would be cool if it supported the property grid control, very useful for pre-configuration setup....</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">deguix</span><br><span class="post-time small text-muted">25th May 2004 22:07 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">But one thing can be done even without C++, create an editor of InstallOptions pages which shows the page and edits it at the same time, using the great "Rect" page attribute (where you can assign a page with a part of the resource, if used correctly, it can even show several pages at the same time).<br><br>One problem is: how can I unload InstallOptions without going to other pages or quiting the program? Probably the idea of creating a .dll function called "Clear" (as I saw in another modification) would be great to add, but as you know, I don't have that kind of knowledge of how to do it (so help is appreciated here)...</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">deguix</span><br><span class="post-time small text-muted">31st May 2004 13:56 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">OK! New version beta 2 (5/31/2004):<br><br>- Added TrackBar and IPAddress controls.<br>- Added ability of Button controls of<br>supporting an image or icon.<br>- Added BACK_RECT, TOOLTIPS and NO_TICKS flags for<br>TrackBar controls and BITMAP and ICON flags for<br>Button controls.<br>- Added support of NOTIFY flag for IPAddress control.<br>- Removed TRANSPARENT and NOAUTOPLAY flags for Animation<br>control.<br><br>Included .dll and its Readme.<br><br><b>Main TODO</b> -&gt; Addition of new controls.<br><br>Any help to make this plugin even better is accepted at any times.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">deguix</span><br><span class="post-time small text-muted">7th June 2004 11:01 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">OK! New version beta 3 (6/7/2004):<br><br>- Added DateTime and MonthCalendar controls.<br>- Added UPDOWN flag for DateTime controls and NOTODAY, NOTODAYCIRCLE and WEEKNUMBERS flags for MonthCalendar controls.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">flizebogen</span><br><span class="post-time small text-muted">9th June 2004 10:22 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Your additions sounds great. How about adding a few samples to your package?</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">deguix</span><br><span class="post-time small text-muted">9th June 2004 11:25 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">I'm planning it for the next or the following version. I didn't do any until now because I was trying to change more things of it!<br><br>Planned:<br><br>- Addition of <i>UpDown</i> control. (not attached with other controls)<br>- Add ability of it to make other controls as its buddy control (<i>UpDown control</i>).<br>- Remove <i>FileRequest</i> and <i>DirRequest</i>.<br>- Add flags for <i>Button</i> controls to make it act like same as <i>FileRequest</i> and <i>DirRequest</i> but using a buddy control (don't need to the a <i>Text</i> control). Makes the <i>Text</i> control free to use its <i>NOTIFY</i> flag and the <i>Button</i> control to be user customized.<br>- Implement NSIS style <i>$\n</i>,<i>$\r</i> and <i>$\t</i>. Try to implement common variables ($0-9 $R0-9) as input and output.<br><br>I ever wanted to make that change of splitting <i>FileRequest</i> and <i>DirRequest</i> <i>Text</i> control from the <i>Button</i> control since I discovered: after using those controls, to get a control handle you had to use a control number different than the InstallOptions one. Now it will be balanced.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">deguix</span><br><span class="post-time small text-muted">12th June 2004 00:39 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">OK! New version beta 4 (6/11/2004):<br><br>- Added UpDown control.<br>- Removed FileRequest and DirRequest controls. Use Text and Button controls instead.<br>- Added FILEREQUEST and DIRREQUEST flags for Button controls and LEFT, HORIZONTAL and WRAP flags for UpDown controls.<br>- NSIS $\n, $\r and $\t imported to remove the need for conversions between NSIS characters and plugin's.<br><br>This version is about exactly as I planned before (except for the variables thing, I'm trying to implement that).</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">iceman_k</span><br><span class="post-time small text-muted">12th June 2004 02:53 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">How about the source code as well? Wouldn't hurt to get it peer reviewed.<br>A couple of questions-<br>a) What is the advantage of using NSIS style $\r $\n instead of \r \n?<br>b) What exactly are you trying to implement for the "variables" feature? I'm a little hazy on that.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">deguix</span><br><span class="post-time small text-muted">12th June 2004 11:50 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">I wasn't posting the source because to don't boost much my post count for each version that is launched. Anyways, I posted it below.<br><br>(If you see, there are comments of what I added or changed, but I didn't comment removed parts)<br><br>a) Because before implementing that, if you would write and/or read Install Options INI files, you had to convert the string from NSIS -&gt; Install Options and/or Install Options -&gt; NSIS to be supportable with one another. For example:<br><br>NSIS string: "// NSIS string test \\$\r$\n// NSIS second line \\"<br><br>Putting this exact NSIS string into an INI file from Install Options and making it show, it would appear like this:<br><br>// NSIS string test \$$// NSIS second line \<br><br>So I think this explained it.<br><br>2) I don't know why I posted it! I should be saying before "not a good idea" instead of "I'm trying to implement that" by now. Sometimes I paste the information without changes and forget the spelling...:(</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">iceman_k</span><br><span class="post-time small text-muted">12th June 2004 15:05 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Overall, I think this is pretty good. A couple of comments:<br>a) I still don't see any advantage of using "NSIS" syntax for special characters as opposed to the current "C" syntax that InstallOptions uses. In fact, I couldn't even get the "NSIS" syntax to work. Do you have an example showing how it works? See my attached script. It doesn't seem to work properly.<br>b) I agree with you, drop the whole "variables" thing. I don't see any advantage in implementing it.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">deguix</span><br><span class="post-time small text-muted">12th June 2004 19:09 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>InstallOptionsEx version beta 4 - DLL</strong><br>a) Fixed. Same version.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">deguix</span><br><span class="post-time small text-muted">12th June 2004 19:11 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>InstallOptionsEx version beta 4 - DLL Source</strong><br>...</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">iceman_k</span><br><span class="post-time small text-muted">13th June 2004 02:58 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">OK, I see that you have fixed the "NSIS" style escape characters. But I still don't see the advantage of it.<br>Either way I have do conversions- whether it uses the "C" style or the "NSIS" style.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">deguix</span><br><span class="post-time small text-muted">13th June 2004 03:22 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">As you insist, I'll put a define in the Source Code to use the old "C" style.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">bluenet</span><br><span class="post-time small text-muted">13th June 2004 06:08 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Is these any sample to show the new feature?</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">bluenet</span><br><span class="post-time small text-muted">13th June 2004 13:56 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Hi deguix<br>,NOTIFY flags in DropList control not work,Can you have a look?</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">iceman_k</span><br><span class="post-time small text-muted">13th June 2004 15:42 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Don't get me wrong- I think you've done a good job. I don't want to insist that you change anything. But if something as basic as the escape character is going to be changed, I think we should see a clear advantage for it.<br>The other thing of course is that it will not be compatible with MUI.<br><br>Another suggestion is to document which OS the new controls do not work on- since you did say that the InstallOptionsEx is not 100% supported by all Windows OS'es.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">deguix</span><br><span class="post-time small text-muted">13th June 2004 20:23 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"></p><blockquote>Is these any sample to show the new feature?</blockquote>Hmmm... I didn't launch any sample yet, I'm working on one.<br><br><blockquote>Hi deguix<br>,NOTIFY flags in DropList control not work,Can you have a look?</blockquote>Yep, it happens when you use the new feature for it: 16x16 Image for each item. This happens because it doesn't use the normal DropList but a modified instead. But I'll try to put the NOTIFY as soon as possible.<br><br><blockquote>Don't get me wrong- I think you've done a good job. I don't want to insist that you change anything. But if something as basic as the escape character is going to be changed, I think we should see a clear advantage for it.<br>The other thing of course is that it will not be compatible with MUI.</blockquote>I'm playing on conservative side now. I understand, everyone used "\r\n" way since InstallOptions had the MULTILINE support. I'll go back in that change, but I'll make a define for people who liked this change I made. As a matter of fact this project continues with the name "InstallOptions" at front of it, isn't it? The discussion of that ends here.<br><br><blockquote>Another suggestion is to document which OS the new controls do not work on- since you did say that the InstallOptionsEx is not 100% supported by all Windows OS'es.</blockquote>Thanks for the suggestion, I'll put this on the next version of InstallOptionsEx.</div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Joost Verburg</span><br><span class="post-time small text-muted">13th June 2004 21:43 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Isn't the problem with NSIS style escaping that NSIS converts them before writing to the INI file using WriteIniStr?</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">deguix</span><br><span class="post-time small text-muted">14th June 2004 03:07 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Ohhh :eek: ... that's why he doesn't see an advantage of that... How I am stupid! I have to punch my face after that. Anyways, I was going to back up that change...</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">iceman_k</span><br><span class="post-time small text-muted">14th June 2004 04:27 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Yep. The NSIS style escaping works if the text is already in the INI file. However, if you want to dynamically write to the INI file, you will have to convert everything.<br>Thanks Joost for explaining it better than I could.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">deguix</span><br><span class="post-time small text-muted">15th June 2004 00:20 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>InstallOptionsEx version beta 5 (before next version launching) - DLL</strong><br>Just to fix that, I made a version "before the launching of the next version". But I made some small additions that will have in the next version:<br><br>- NOTIFY flag for MonthCalendar, DateTime and UpDown controls.<br>- Returned to old "C" style escape characters.<br><br>These changes are <b>undocumentated</b>.<br><br>I'm making this version because of the full week of school work on me (because the school year is ending) and the final tests. Next version is planned to be launched next week (after Tuesday).</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">deguix</span><br><span class="post-time small text-muted">15th June 2004 00:24 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>InstallOptionsEx version beta 5 (before next version launching) - DLL Source</strong><br>...</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">bluenet</span><br><span class="post-time small text-muted">15th June 2004 00:43 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Thanks deguix,I like this EX version very much.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">deguix</span><br><span class="post-time small text-muted">15th June 2004 00:51 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">If you know, Ex is for "Expanded". Generally I did put for my functions the "Adv" for "Advanced". I just didn't put "Adv" on the plugin name because it doesn't have dramatic changes comparing with the normal InstallOptions. It just adds more controls and new features.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">deguix</span><br><span class="post-time small text-muted">27th June 2004 23:27 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>InstallOptionsEx version beta 5 - DLL</strong><br>- Added HotKey control.<br>- Added support of NOTIFY flag for MonthCalendar, DateTime, UpDown and HotKey controls.<br>- Added information to controls and options their minimum supportable OS.<br>- C style escape characters restored again.<br>- Fixed problems with new controls about the TabStop not working.<br><br>HotKey control doesn't have a 100% correct translation Input-&gt;Control-Control-&gt;Output: If you type "Ctrl + +" as input it will convert to "Ctrl +", and if you type some keys that I don't know their VK_ names (like some numpad keys) it won't output these. But for most of the keys the control will work correctly.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">deguix</span><br><span class="post-time small text-muted">27th June 2004 23:29 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>InstallOptionsEx version beta 5 - DLL Source</strong><br>...</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">bluenet</span><br><span class="post-time small text-muted">3rd July 2004 13:13 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">I found that droplist can not list item,but InstallOption can.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">deguix</span><br><span class="post-time small text-muted">3rd July 2004 19:38 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">What do you mean by that?</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">bluenet</span><br><span class="post-time small text-muted">3rd July 2004 23:50 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">This same code in here: <a href="http://forums.winamp.com/showthread.php?postid=1399824#post1399824" target="_blank">http://forums.winamp.com/showthread....24#post1399824</a><br>When change InstallOptions:: to InstallOptionsEx:: the droplist items missing.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">deguix</span><br><span class="post-time small text-muted">4th July 2004 07:37 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Everything is working fine for me.<br><br>InstallOptionsEx v.2.4 beta 5<br>NSIS 2.0 -&gt; latest development snapshot<br>Windows XP Home Edition -&gt; latest updates<br><br>What InstallOptionsEx, NSIS and Windows version do you use?</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">bluenet</span><br><span class="post-time small text-muted">4th July 2004 10:09 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">InstallOptionsEx v.2.4 beta 5<br>NSIS 2.0 Specail(Open LogSet command)<br>Windows Server 2003 Simplified Chinese<br><br>I upload the script and exefile here,would you have a look what wrong for me.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">deguix</span><br><span class="post-time small text-muted">4th July 2004 22:56 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Remove <i>Text=DropList</i> lines inside your .ini file for now.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">bluenet</span><br><span class="post-time small text-muted">5th July 2004 09:03 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">OK.Thanks deguix,the ini file create by HM NIS Edit,I forgot this.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">AlexBienheureux</span><br><span class="post-time small text-muted">9th July 2004 14:26 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">could you put an example which one sees all the possibilities?<br><br>thank you</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">deguix</span><br><span class="post-time small text-muted">10th July 2004 02:48 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">If I do it now, I have to change it for every version I launch as you know that it's a beta version. When it becomes stable I'll do one. This is not the right time to do that.<br><br>Now, about the changes for the next version, I've done some fixes to it, like that one from <i>bluenet</i>. But I'm not giving more details on it right now.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">VegetaSan</span><br><span class="post-time small text-muted">10th July 2004 16:18 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">OMG .. that's some nice shit ^^</p></div><hr><div class="container"><ol class="breadcrumb"><li><a href="../index.html" class="glyphicon glyphicon-home"></a></li><li><a href="f-65.html">NSIS Discussion</a></li><li class="active">InstallOptionsEx</li></ol><p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=181087">InstallOptionsEx</a></p><br><div class="post"><p class="post-meta"><span class="post-author text-primary">AlexBienheureux</span><br><span class="post-time small text-muted">15th July 2004 12:03 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"></p><blockquote><i>Originally posted by deguix</i><br><b>If I do it now, I have to change it for every version I launch as you know that it's a beta version. When it becomes stable I'll do one. This is not the right time to do that.<br><br>Now, about the changes for the next version, I've done some fixes to it, like that one from <i>bluenet</i>. But I'm not giving more details on it right now.</b></blockquote>*<br><br><br>ok, thank you !! :up:</div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">deguix</span><br><span class="post-time small text-muted">23rd July 2004 13:17 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>InstallOptionsEx version beta 6</strong><br>Ok, next version planned (and almost done) changes are:<br><br>- Support for changing font and colors of controls (which gives a wide range of commands). This is quite limited, but at least it gives a better look w/o using NSIS itself. Some controls that don't support this because:<br><br>&gt; Windows Themes can sometimes fill completely controls (Button).<br><br>&gt; Some controls don't call WM_OWNERDRAW or WM_CTLCOLORS* or don't have messages to change the colors or font (IPAddress, HotKey, UpDown, TrackBar, RadioButton, CheckBox, GroupBox).<br><br>&gt; ComboBox + ImageList = Special drawing (ComboBox /w Images).<br><br>- Fix that problem I already said in older posts.<br>- Fix the cutting of controls when its "right" or "bottom" values that are bigger than rectangle's.<br>- Small bugs from last version.<br><br>This version will appear here soon.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">deguix</span><br><span class="post-time small text-muted">25th July 2004 21:13 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>InstallOptionsEx version beta 6 - DLL</strong><br>- Added a wide range of commands for setting initial color and font formatting without using NSIS commands.<br>- Fixed the control extention beyond the rect height and width. This makes the control to resize itself when necessary.<br>- Added file verification before setting a bitmap or icon to DropList , ComboBox and Button controls.<br>- Fixed a stupid bug that made some controls flags to be set when you did not specify them.<br>- Fixed another stupid bug that made ProgresBar controls to do not show their indicator bar correctly.<br>- Added one laking information about the standalone keys for HotKey controls.<br>- Fixed other minor bugs.<br><br>Yeah, it has more fixes than I expected yesterday. By using the <i>ProgressBar</i> control I found 2 serious bugs.<br><br>Now what I expect for the next version is an appearance of the powerful <i>RichText</i> control (used by the actual NSIS license page) and more fixes as it is in a beta version. Any bug you find is very important to me.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">deguix</span><br><span class="post-time small text-muted">25th July 2004 21:14 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>InstallOptionsEx version beta 6 - DLL Source</strong><br>...</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br><span class="post-time small text-muted">25th July 2004 21:56 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">OMG This is neat! Thanks for all your hard work!<br><br>Cheers<br><br>-Stu</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">deguix</span><br><span class="post-time small text-muted">26th July 2004 03:16 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Hummm... Did you test it? I see 0 downloads up to now and you already commented...</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br><span class="post-time small text-muted">26th July 2004 14:06 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">I've got it now :)<br><br>I couldn't try it as I was at work :/<br><br>-Stu</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">deguix</span><br><span class="post-time small text-muted">26th July 2004 14:54 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Oh, no problems.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Yathosho</span><br><span class="post-time small text-muted">27th July 2004 13:01 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">have you thought of including lobo's tooltip plugin into IOex? would be a lot work less, if one could simple put the tooltip-text into the ini-file of a io-page.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">deguix</span><br><span class="post-time small text-muted">27th July 2004 13:18 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Another thing you would say is to include lobo's dialogs plugin into it.<br><br>Yes, I can include those additions, but you have to wait a while, since I'm working on other projects at the same time.<br><br>Just a question to lobo first. What are the control ID's of your tooltips? (if you know, tooltips are the same as normal controls)</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">deguix</span><br><span class="post-time small text-muted">27th July 2004 13:42 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Oh, I forgot to tell about some IOEx new features not mentioned in the documentation:<br><br>- You can specify the height and/or width of a control using the <b>Height</b> and/or <b>Width</b> INI value names. They are used instead of <i>Right</i> and/or <i>Bottom</i> INI value names.<br><br>- <b>ListItemsHeight</b> INI value name adjusts the height of each ListBox, ComboBox and DropList item. It's mentioned on the documentation from other INI value names, but it's not directly included.<br><br>If I forgot them, probably they are not even tested fully. Can you all test these for me?<br><br>(If it's better than I thought, what else good can be waiting for me now?)</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">deguix</span><br><span class="post-time small text-muted">11th August 2004 15:57 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"></p><blockquote>(If it's better than I thought, what else good can be waiting for me now?)</blockquote>One thing good that I discovered on this time that passed is that InstallOptionsEx first versions had the fixes of the InstallOptions 2.5 already (even MUCH before the time), so people who used this didn't have the Next button problem since beta 1.<br><br>Now the bad things: several bugs were found on the code, including one critical that DISABLED controls which were added the font and/or paint features didn't draw correctly. And there are some others which I don't want to comment right now.<br><br>Apparently now I have an image of ever doing buggy projects without testing fully (yeah, even StrFunc.nsh has one, but much less apparent than IOEx). If you see most of my older functions you can see 2 or 3 bugs each... I'm much more lucky with projects outside NSIS though where you can't find them easily.<br><br>(You can now see the list of projects I'm working now and to work after on my signature)</div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">deguix</span><br><span class="post-time small text-muted">11th August 2004 21:46 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">I wanted to make a small modification on ListBoxes when I'm fixing the "DISABLED controls not drawing correctly [sometimes]". I would like to change the colors of selected and deselected items of a DISABLED ListBox by default. I don't like the actual default IO's colors because sometimes you can think that a ListBox is enabled, but it's really disabled.<br><br>On the image the:<br><br>- Left DISABLED ListBox is from InstallOptions<br>- Right DISABLED ListBox is from InstallOptionsEx<br><br>The image:</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">bluenet</span><br><span class="post-time small text-muted">12th August 2004 01:34 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Tooltip is a good feature, I hope beta 7 would include it.Thanks deguix's work. :)</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">deguix</span><br><span class="post-time small text-muted">12th August 2004 03:37 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Hummm... I don't have a defined plan for the next version, but yeah, I'm thinking on some plugins combinations with IOEx for the future:<br><br>- Dialogs and tooltips -&gt; additional dialogs and tooltips support.<br>- Banner -&gt; creation of dialogs not based on resources (it's not really true but I have this idea when looking at it), timeout, extented NOTIFY for running NSIS codes when the dialog is being shown.<br>- AdvSplash -&gt; Alpha Blending, extended timeout, extended NOTIFY for running NSIS codes when a click is made to the image, modeless dialog boxes, special effects when showing window (it's not really true but I have this idea when looking at it).<br><br>...<br><br>About NOTIFY flag: I'm planning to change a little bit the way NOTIFY flags are handled:<br><br>- Create another INI value name for "Settings" page called "Notification" (or something like it) where you can get the type of the notification being sent by a control.<br><br>- Each field will have an additional INI value name called "Notification" where you can set the notification flags you want for the control.<br><br>What do you think of this?</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">deguix</span><br><span class="post-time small text-muted">12th August 2004 03:56 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Hummm... I don't have a defined plan for the next version, but yeah, I'm thinking on some plugins combinations with IOEx for the future:<br><br>- Dialogs and tooltips -&gt; additional dialogs and tooltips support.<br>- Banner -&gt; creation of dialogs not based on resources (it's not really true but I have this idea when looking at it), timeout, extented NOTIFY for running NSIS codes when the dialog is being shown.<br>- AdvSplash -&gt; Alpha Blending, extended timeout, extended NOTIFY for running NSIS codes when a click is made to the image, modeless dialog boxes, special effects when showing window (it's not really true but I have this idea when looking at it).<br><br>...<br><br>About NOTIFY flag: I'm planning to change a little bit the way NOTIFY flags are handled:<br><br>- Create another INI value name for "Settings" page called "Notification" (or something like it) where you can get the type of the notification being sent by a control.<br><br>- Each field will have an additional INI value name called "Notification" where you can set the notification flags you want for the control.<br><br>What do you think of this?<br><br><b>What I already done for InstallOptionsEx 2.5 beta 7:</b><br><br>- "Fixed the control extention beyond the rect height and width. This makes the control to resize itself when necessary." change removed. It's quite useful to have a way to do not show controls to the user sometimes...<br><br>- Fixed "Text" and "ListBox" control w/ DISABLED flag: Didn't redraw right.<br><br>- Added missing features which documentation from last version didn't mention.<br><br>- Added "FontName" INI value to all known controls that support font changes.<br><br>- Added "Dis*" commands for "ListBox" controls which enables to set colors for DISABLED controls.<br><br>- Added a new flag to "CheckBox" controls, the old and famous "3STATE" flag that allows you to set additonally an indeterminated (or grayed) state.<br><br>- "ListItems" for "Button" controls w/ "DIRREQUEST" flag is the text which appears above the Tree-View control of directories.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">deguix</span><br><span class="post-time small text-muted">14th August 2004 22:20 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>InstallOptionsEx 2.41 beta 7 - DLL</strong><br>This version brings a new system for control notifications. I'll explain a little bit how it works. Let's have an example INI file to start:<br><br>[Field 1]<br>Type=ComboBox<br>Left=0<br>Top=0<br>Width=100<br>Height=400<br>Notify=ONTEXTCHANGE<br><br>[Field 2]<br>Type=Button<br>Left=110<br>Top=0<br>Width=50<br>Height=12<br>Notify=ONDBLCLICK|ONKILLFOCUS<br>State=C:\MyDir<br><br>You can see there is a new INI value name for each field called "Notify", with this you can use notification flags for each control. I made the flags to be supported for more than one control to make easier the use of them. This INI value name is used for notification flags that, when the user does the action, triggers the calling to the validation function.<br><br>On the first field, there is a "ONTEXTCHANGE" notification flag which makes the plugin call the validation function after the text is changed by the user and after it appears on the screen.<br><br>On section "Field 2", there is "ONDBLCLICK" which makes the plugin to use "ShellExecute" and the text specified by "State" value (this is special for Buttons and Links). And there is a "ONKILLFOCUS" which is when a control loses focus.<br><br>Now, when for example the first field receives focus it won't call the validation function. Why? You didn't specify it to do it, so you change it to:<br><br>[Field 1]<br>Type=ComboBox<br>Left=0<br>Top=0<br>Width=100<br>Height=400<br>Notify=ONTEXTCHANGE|ONSETFOCUS<br><br>And now there is another addition to this system. After a control called the validation function it records what control did call it and the action the user did to the control:<br><br>[Settings]<br>State=2<br>Notify=ONTEXTCHANGE<br><br>This could be different if another action from the user is made:<br><br>[Settings]<br>State=2<br>Notify=ONSETFOCUS<br><br>As you saw, I added ONSETFOCUS and ONDBLCLICK and some other notification flags that the normal NOTIFY flag couldn't do. I made some other changes, so let's see them all:<br><br>- Rearranged control notification system:<br>- - Added Notify value name for "Settings" and "Field #" sections.<br>- - Added: ONSETFOCUS, ONKILLFOCUS, ONLISTOPEN, ONLISTCLOSE, ONSELCHANGE, ONTEXTCHANGE, ONTEXTUPDATE, ONCLICK, ONDBLCLICK, ONTEXTTRUNCATE, ONTEXTVSCROLL, ONSTART and ONSTOP notification flags.<br>- Added BackShow, NextEnabled and NextShow for "Settings" section.<br>- Fixed the control extention beyond the rect height and width addition of the last version removed.<br>- Fixed Text controls: "black" color was being set even when you didn't.<br>- Fixed ListBox controls: didn't appear as they were disabled.<br>- Added missing features to the documentation which last version's didn't mention.<br>- Added FontName for Label, Link, ListBox, ComboBox, DropList, Text and Password controls, DisBgColor, DisTxtColor, DisSelBgColor and DisSelTxtColor for ListBox control.<br>- ListItems for Button controls w/ DIRREQUEST flag is the text which appears above the Tree-View control of directories.<br>- Added a new flag to CheckBox controls, the old and famous "3STATE" flag that allows you to set additonally an indeterminated (or grayed) state.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">deguix</span><br><span class="post-time small text-muted">14th August 2004 22:22 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>InstallOptionsEx 2.41 beta 7 - DLL Source</strong><br>...</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">bluenet</span><br><span class="post-time small text-muted">15th August 2004 04:48 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">wonderful£¬Thanks deguix, I have a test.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">deguix</span><br><span class="post-time small text-muted">16th August 2004 22:34 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">On the next version I'll add ToolTips support (which is halfway done) and much less fixes because most of them I fixed on the last version...<br><br>Some more additions comparing with Lobo's ToolTips plugin are the ability to change text and background colors of ToolTips, additional flags, notifications? (thinking, not planned) and multiline support (searching for information).</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">deguix</span><br><span class="post-time small text-muted">18th August 2004 14:52 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>InstallOptionsEx 2.41 beta 8 - DLL</strong><br>I added the ToolTips feature to InstallOptionsEx in this version. See an example for INI file using all ToolTip value names:<br><br>[Field 1]<br>Type=Label<br>Left=0<br>Top=0<br>Width=100<br>Height=10<br>Text=Default Options:<br>ToolTipIcon=INFO<br>ToolTipTitle=Default options<br>ToolTipText=Makes the program to select all the default program options<br>ToolTipFlags=BALLOON<br>ToolTipTxtColor=0xFFFFFF<br>ToolTipBgColor=0x009900<br>ToolTipMaxWidth=300<br><br>ToolTip features:<br><br>- ToolTip types supported: Normal or Balloon.<br>- Colors of tooltips can be changed.<br>- Balloon tooltips are supported for those who have IE 5, for all Windows versions.<br>- Multiline is halfway supported. It does not supported escape characters, but there is ToolTipMaxWidth that makes the ToolTip to break lines when it does reach the width limit.<br>- XPStyle makes the Balloon tooltips icons to have a better quality.<br><br>ToolTip notes:<br><br>- ToolTips disappear when you click on their controls.<br>- Tracking and In-Place ToolTips aren't supported right now.<br><br>Changes comparing to the last version:<br><br>- Added ToolTips feature -&gt; Added ToolTipText, ToolTipFlags, ToolTipMaxWidth, ToolTipTxtColor, ToolTipBgColor, ToolTipIcon and ToolTipTitle value names.<br>- Fixed DISABLED ComboBox and DropList controls bug: Didn't redraw right.<br>- Fixed DISABLED ListBox controls bug: User specified colors didn't apply.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">deguix</span><br><span class="post-time small text-muted">18th August 2004 14:54 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>InstallOptionsEx 2.41 beta 8 - DLL Source</strong><br>...</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Comm@nder21</span><br><span class="post-time small text-muted">18th August 2004 21:59 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">nice work!</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">deguix</span><br><span class="post-time small text-muted">19th August 2004 13:57 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">I uploaded plugin's Archive page <a href="http://nsis.sourceforge.net/archive/viewpage.php?pageid=507" target="_blank">here</a>.<br><br>(Comm@nder21, two of the links in your signature are broken or going to wrong pages.)</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">bluenet</span><br><span class="post-time small text-muted">22nd August 2004 13:21 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">It seem a bug. When disable a text contrl, the text not change to gray. Link contrl can not "ExecShell" a file that local in some directory.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Comm@nder21</span><br><span class="post-time small text-muted">22nd August 2004 16:11 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">thanks, deguix, fixed :)</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">deguix</span><br><span class="post-time small text-muted">22nd August 2004 18:46 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"></p><blockquote>When disable a text contrl, the text not change to gray.</blockquote>I can't reproduce this bug. You have to say what IOEx version you are using, and if you're using XPStyle on or off.<br><br><blockquote>Link contrl can not "ExecShell" a file that local in some directory.</blockquote>Local directory = where the application is. If that file you specified doesn't exist, it won't work.</div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Deliverator</span><br><span class="post-time small text-muted">22nd August 2004 23:52 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">When using this with the Modern UI my Welcome and Finish pages are not displayed correctly.<br><br>The background of the window is gray, and the background of the text is white.<br><br>What am I doing wrong?</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">bluenet</span><br><span class="post-time small text-muted">23rd August 2004 01:37 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">I make a sample to show this. When click the checkbox and link you can see the two problem. Sorry my wrong, contrl is a Label not a Text.<br>The version is beta 8.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">deguix</span><br><span class="post-time small text-muted">23rd August 2004 11:48 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Fixed both on beta 9. (Deliverator's and bluenet's)</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">deguix</span><br><span class="post-time small text-muted">23rd August 2004 13:31 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>InstallOptions 2.41 beta 9 - DLL</strong><br>Mostly, this is a bug fixing version of IOEx from the older versions additions:<br><br>- Fixed DISABLED Label controls: didn't draw shadow.<br>- DISABLED Label and Link are now controls supported by DisTxtColor value name.<br>- Fixed Label and Link controls: didn't draw background color on the entire control.<br>- Shadow Text feature added. Added TxtShwColor, DisTxtShwColor, SelTxtShwColor and DisSelTxtShwColor.<br>- FIRST DLL optimizations: 0.5 kb smaller on decompressed build (no change for compressed build).<br>- Fixed text positioning of ComboBox, DropList and ListBox controls. They are now closer to the control border.<br>- Fixed focus rectangle not appearing on ComboBox and DropList.<br>- ListBox, ComboBox and DropList controls have automatic word ellipsis.<br>- FontOrientation and FontEscapement removed - because most of the drawing commands do not support this feature.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">deguix</span><br><span class="post-time small text-muted">23rd August 2004 13:32 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>InstallOptionsEx 2.41 beta 9 - DLL Source</strong><br>...</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">billym</span><br><span class="post-time small text-muted">1st September 2004 15:51 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">I have needed flash support (for short guides) in my installer's for a while but not able to code it. Could support for this control be added to InstallOptionsEx so we have the flash option. If not could someone please assist in creating a plugin for this purpose. Thanks in advance for any assistance.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">deguix</span><br><span class="post-time small text-muted">3rd September 2004 00:42 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">This I'm doing is just the beggining. It's better you to create a plugin for that.<br><br>I've just added some Windows controls because they're from the Operational System. Adding too many custom controls on one plugin makes its size to explode. (that's why exists an item on TODO list saying about implementing custom controls -&gt; separated sub-plugins for IO)</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">dilox77</span><br><span class="post-time small text-muted">4th September 2004 16:13 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Hi deguix!<br>Can you have a look here?<br><a href="http://forums.winamp.com/showthread.php?s=&amp;postid=1459067#post1459067" target="_blank">http://forums.winamp.com/showthread....67#post1459067</a><br>Do you think I can resolve my problem with your modified version of installoptions?<br>Thank's in advance.<br>dilox</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">deguix</span><br><span class="post-time small text-muted">4th September 2004 18:14 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">No. When I thought of it, people were only against this feature.<br><br>I put things on InstallOptionsEx depending on how many people would like the feature included and their reasons (not totally true but...). I only heard against, so I didn't include it. If you wanna this now, maybe it's still possible...<br><br>When there is too much request on one thing, I become estimulated (!) and then I do it, depending if I do know how to do it (there are sometimes problems with knowing something, as I only started coding with C when I modified IO, so common "C" mistakes are done).</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">dilox77</span><br><span class="post-time small text-muted">4th September 2004 20:04 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Ok.. but why people are against this feature? I think the possibility of inserting variables and codes into file .ini and having default value (and other kind of value) not fixed but variable, are great opportunities.<br>I don't know if and how it's possible to realize that in C.<br>I only hope you put this feature in your to-do list as soon as possible<br>:)<br>Bye, dilox</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">deguix</span><br><span class="post-time small text-muted">4th September 2004 22:13 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">I'm not working on InstallOptionsEx right now but if I can I'll try to implement that. Ok?<br><br>[EDIT]Now you know that I keep editing even much after I posted the original post. I wasn't expecting your answer right now...[/EDIT]</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">dilox77</span><br><span class="post-time small text-muted">4th September 2004 22:26 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Sincerly I don't understand what you mean, can you explain me better?<br>The problem is that if you make any changes to the installoptions file (through code, writeinistr, etc..) then you have to recompile the file .nsi that include it to see modifications to take effect. :(<br>You can not parse custompage during runtime.<br>Is this an unsolveble problem?<br>Hope don't...<br>Bye, dilox</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">deguix</span><br><span class="post-time small text-muted">4th September 2004 22:52 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"></p><blockquote>The problem is that if you make any changes to the installoptions file (through code, writeinistr, etc..) then you have to recompile the file .nsi that include it to see modifications to take effect.</blockquote>1) You didn't understand what "Variables" feature I'm talking about (but I never explained so I'll do it now):<br><br>You put a common variable ($0-$9, $R0-$R9) as text or state of a control and it will convert the variable into the actual contents of the variable at the time a page is reserved, showed (w/o reserving it) or updated by controls notifications.<br><br>2) About writting not taking effect until the next compilation:<br><br>The plugin reads information from the INI file everytime you reserve a page or show it directly (w/o reserving it). If the INI file is not updated at all if you try to change it before the reading of the INI file by the plugin, it's not <font color="green">my problem</font>, but a <font color="green">scripting problem</font> of yours.<br><br>As I don't know how your level of NSIS knowledge is, I'll explain the <i>scripting problem</i>:<br><br>If you use Modern UI and you are using the default way of including a custom page under the installer, use <i>!insertmacro MUI_INSTALLOPTIONS_WRITE</i> instead of using <i>WriteINIStr</i>. If you use Win9x, use <i>FlushINI</i> before and after writting to INI files.</div><hr><div class="container"><ol class="breadcrumb"><li><a href="../index.html" class="glyphicon glyphicon-home"></a></li><li><a href="f-65.html">NSIS Discussion</a></li><li class="active">InstallOptionsEx</li></ol><p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=181087">InstallOptionsEx</a></p><br><div class="post"><p class="post-meta"><span class="post-author text-primary">dilox77</span><br><span class="post-time small text-muted">4th September 2004 23:12 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">l</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">dilox77</span><br><span class="post-time small text-muted">4th September 2004 23:23 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Thank's for better explanations and for tring to implement this new feature! Have a good job! ;)<br>Bye, dilox</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">deguix</span><br><span class="post-time small text-muted">4th September 2004 23:37 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Sorry, when I keep editing posts generally the original post is rude. I try to make it less rude the more I edit, but sometimes it continues rude. This probably will change when I know totally how to benefit from the English language, so I can make more post editions before posting making it not hurt anyone...<br><br></p><blockquote>Thank's for better explanations and for tring to implement this new feature! Have a good job!</blockquote>I won't do this right now. See on my signature that I have much work to be done besides IOEx...</div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">bluenet</span><br><span class="post-time small text-muted">5th September 2004 05:27 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Hi, is these possible add a feature that Button Flags FILEREQUEST can select multi files?</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">deguix</span><br><span class="post-time small text-muted">5th September 2004 14:18 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"></p><blockquote>is these possible add a feature that Button Flags FILEREQUEST can select multi files?</blockquote>Hmmm... I don't know what to say. I'll have to see when I come back to IOEx development. (See my signature)</div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">bluenet</span><br><span class="post-time small text-muted">6th September 2004 02:03 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">The file open dialog can only select one file, some time I want to select mutli files, how can I do that?</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">deguix</span><br><span class="post-time small text-muted">6th September 2004 02:09 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">I understood your question. However I do not know right now how to do it (I actually heard a little about this but not enough). I'll only see it when I go back to IOEx development. Please, be patient until then.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">deguix</span><br><span class="post-time small text-muted">18th September 2004 01:32 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">I was looking lately though source codes from GUI's builders made for other programs so that I can get some knowledge from them. An example is the automatic control positioning. However as I'm not working on IOEx now, I cannot verify them right now.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">deguix</span><br><span class="post-time small text-muted">15th October 2004 00:31 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">I've discovered when adding a new feature that enables you to choose which character to use on password masking (hehe, couldn't resist :)), flags not even mentioned on InstallOptions (original) documentation:<br><br>- PASSWORD for <i>Text</i> controls (same as <i>Password</i> controls).<br>- DROPLIST for <i>ComboBox</i> controls (same as <i>DropList</i> controls).<br><br>I think this information should be added to IO docs, because even the unmeaningful things can mean something to someone. It's just a simple thing anyways...</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">kichik</span><br><span class="post-time small text-muted">15th October 2004 00:46 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Those are for internal usage of InstallOptions.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">deguix</span><br><span class="post-time small text-muted">16th October 2004 00:26 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Yeah, I know... As those can be used externally as well, I will add them to IOEx documentation.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Yathosho</span><br><span class="post-time small text-muted">16th October 2004 02:27 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">another suggestion: seperation lines for the droplist dialog</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">deguix</span><br><span class="post-time small text-muted">16th October 2004 11:35 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">OK, added to the TODO list.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">deguix</span><br><span class="post-time small text-muted">30th October 2004 00:01 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>InstallOptionsEx 2.41 beta 10 - DLL</strong><br>The greatest addition here is the variables support for ANY value of a value name. It can even be used several times on the same value. Get a look at the list of changes below:<br><br>- Fixed VSCROLL flag: wasn't supported by ListBox controls.<br>- Changed flag name: HORIZONTAL to HSCROLL.<br>- Mentioned PASSWORD for Text and DROPLIST for ComboBox controls on the documentation.<br>- Added new feature to Password controls: Password mask character (see Text INI value name).<br>- Added new features to Icon controls:<br>- Supports getting icons from executables, and dlls (see Text and State INI value names).<br>- Supports default Windows icons (see State INI value). Options: APPLICATION, EXCLAMATION, INFORMATION, QUESTION, STOP and WINLOGO.<br>- Added variables $0-$9, $R0-$R9 support before reserving or showing without reserving pages. It is supported on every value of a value name and can be used multiple times on the same value.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">deguix</span><br><span class="post-time small text-muted">30th October 2004 00:02 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>InstallOptionsEx 2.41 beta 10 - DLL Source</strong><br>...</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">deguix</span><br><span class="post-time small text-muted">7th November 2004 18:16 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>InstallOptionsEx 2.41 beta 11 - DLL</strong><br>The most important fix for this version is that all font related commands works for all control types. See what changed this version:<br><br>- "Flags" INI value optimizations:<br>&amp;nbsp;&amp;nbsp;- Removed the "not useful" BACK_RECT, NOTODAYCIRCLE, TRANSPARENT and CENTER flags. The second flag effect is implemented with NOTODAY and the last flag is implemented to the Animation control normal functionality.<br>&amp;nbsp;&amp;nbsp;- Removed VERTICAL flag. Use VSCROLL instead.<br>- Fixed ComboBox and DropList controls: Disabled controls now have their text on the right color by default.<br>- Fixed ListBox controls: Focus boundary rectangle wasn't being drawn.<br>- Font INI value names are now supportable by all controls.<br>- Fixed Link controls: They are underlined by default except when FontUnderline=0 is set.<br>- Changed importance level of Height and Width. Now if Right is specified, Width is ignored, and if Bottom is specified, Height is ignored.<br>- Fixed "Back" button appearance: It should appear only after the first page.<br>- Changed State and Notify INI value names from Settings INI section:<br>&amp;nbsp;&amp;nbsp;- Fixed: State had the value of 0 and Notify didn't even appear when OPEN_FILEREQUEST, SAVE_FILEREQUEST or DIRREQUEST were used on a Button control.<br>&amp;nbsp;&amp;nbsp;- As the appearance of these INI value names are imminent: If State = 0, the page returned a notification. If Notify = ONNEXT, ONBACK or ONCANCEL, the user clicked on next, back or cancel buttons, respectively.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">deguix</span><br><span class="post-time small text-muted">7th November 2004 18:17 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>InstallOptionsEx 2.41 beta 11 - DLL Source</strong><br>...</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">deguix</span><br><span class="post-time small text-muted">12th November 2004 23:56 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>InstallOptionsEx 2.41 beta 11 (Public Build #2) - DLL</strong><br>There had a bug that was appearing since beta 10 (when I implemented the variables) which made the "0" on values for INI value names useless. That means, the code treated it like the default value. I fixed this on this "before-the-next-release" version because this affects all commands that transform the value into an integer (mostly those with "0" and "1" as options).<br><br>This version only contains this fix as the difference between the original version.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">deguix</span><br><span class="post-time small text-muted">12th November 2004 23:58 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>InstallOptionsEx 2.41 beta 11 (Public Build #2) - DLL Source</strong><br>...</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">deguix</span><br><span class="post-time small text-muted">15th November 2004 01:23 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">In the future versions I'll focus more on the real-time acquirement of information from INI files. That means, the page will change everytime you change something on the INI file at run-time.<br><br>This will bring real advantages against the original InstallOptions:<br><br>- You could adjust the page controls without needing to show the page again.<br><br>- You woudn't need the System or other plugins just to change a control appearance. Hence this would help a lot those who are learning NSIS and don't know System plugin and experts who have a lot of codes for run-time actions.<br><br>- You could use an editor to do the first touches on an INI file and make final adjustments yourself afterwards with InstallOptionsEx easily, without the need of reshowing the page every time you want to do a change on the page.<br><br>- I could create new abities without worrying if the user could change them at run-time. For Example: Now you can't use WM_SETTEXT to set the text of a label because it's being drawn internally by the plugin. If I add this, you could change it, and even the shadow colors...</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">flizebogen</span><br><span class="post-time small text-muted">14th December 2004 14:32 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>Bug inleave Function?</strong><br>Sorry for bothering you again with installoptionsex, but i guess i found a bug.<br><br>I used the leave function for notification checks, but the Value "ONNEXT" in the Settings Sections is only filled if the page is destroyed. Every check and abort in the leave function led to an empty value, but as i re-read the variable in the instpage i noticed, that "ONNEXT" was written within. You should change the check to let the people abort if neccesary from within the leave function.<br><br>Tested with Build 11.2<br><br>Regards<br><br>flizebogen</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">deguix</span><br><span class="post-time small text-muted">14th December 2004 23:07 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Thanks. Fix already prepared for the next version.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">deguix</span><br><span class="post-time small text-muted">20th December 2004 10:02 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">For the next version, I also fixed icon problems based on their sizes, and added ability to support cursors and animated cursors. This time I warned about this because someone wanted it fixed.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">deguix</span><br><span class="post-time small text-muted">28th December 2004 16:50 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>InstallOptionsEx 2.4.1 beta 12 - DLL</strong><br>The greatest thing this version is the ability of updating pages when they're running. On the best side, it makes every feature of IOEx available without the knowledge of System plugin. On the other, it allows anyone to update it by hand, so it's better to secure it for now. It's basic for now. Now take a look on the other changes in this version:<br><br>- Added the ability to update the page when showing it. (There are still bugs to be fixed here.)<br>- DLL size reduced to 13.5kb. Increased speed to load pages by fixing internal memory leaks.<br>- Flags INI value name optimizations:<br>- - Added MULTISELECT flag for Button controls.<br>- - Fixed FILE_EXPLORER flag: had effect similar to HSCROLL flag.<br>- - HSCROLL and VSCROLL flags support for Button controls was removed.<br>- New documentation (which will be improved more in future versions).<br>- Removed HotKey control, for optimization purposes.<br>- Removed a ComboBox feature of setting images for each list item. It already had lots of problems since its inclusion.<br>- Fixed Icon controls: Didn't use the right icon size when told to do so.<br>- Icon controls additionally support cursors (*.cur) and animated cursors (*.ani).<br>- Fixed DateTime and MonthCalendar controls: Not enough space on buffers, changed date and time format.<br>- Made the focus rectangle on Link controls to occupy the control rectangle border, not the text rectangle border.<br>- New lines work again on Link controls.<br>- Fixed documentation: MonthCalendar controls can have a State INI value.<br><br>Another thing: The new documentation doubled it's size when not in a zip file but it was dramastically reduced inside one (interesting...). So that means, only 1 file for both the plugin and source.<br><br>As it uses the expand/collapse feature, you have to enable ActiveX to see it correctly. Please, warn me if there are any problems w/ the readme. If there are enough problems, I'm going to return to the old one.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">WebMatze</span><br><span class="post-time small text-muted">28th December 2004 19:57 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Hello deguix and thanks a lot for this very useful plugin. But i have a little problem since the beta 11 and always with the beta 12, when i use a link control it does not launch the link but open a dirrequest window, i tried everything but i cant get it work, i tried to use notify=onsetfocus and it opens a dirrequest window and then loads the link... I dont understand.<br><br>Can you please help me<br><br>[Field 2]<br>Type=Link<br>Notify=ONCLICK<br>Left=23<br>Right=61<br>Top=0<br>Bottom=10<br>State=http://www.dfsfddsf.tk/<br>Text=dfsfddsf</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">deguix</span><br><span class="post-time small text-muted">28th December 2004 21:07 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>InstallOptionsEx 2.4.1 beta 12 - DLL</strong><br>Whooops! I was testing the Link controls just before launching the new version that appeared right next to my eyes and I was still not seeing it! Thanks, fixed. Same version.<br><br>Can you find more? If so, I'm going to still use the same version if they are quick to be fixed like that one.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">WebMatze</span><br><span class="post-time small text-muted">29th December 2004 07:38 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>problem with buttons</strong><br>Hello i get another problem with the new beta 12 version, i use a button to quit my app and one to go to a section, and when i clic on these buttons it opens a browser window instead of executing the actions. I think the problem is that the ini state setting doesnt get updated when i clic on the buttons and i dont know why, i use a third button with a open_filerequest flag and this one works.<br>Do you have a idea of the problem?<br><br>here is my ini :<br><br>[Settings]<br>CancelShow=0<br>NextShow=0<br>BackShow=0<br><br>[Field 1]<br>Type=Label<br>Left=62<br>Right=70<br>Top=0<br>Bottom=10<br>Text=le<br><br>[Field 2]<br>Type=link<br>Text=gdsgs<br>Notify=ONCLICK<br>State=http://www.dfsgfsgfsd.tk<br>Left=23<br>Right=61<br>Top=0<br>Bottom=10<br><br>[Field 3]<br>Type=Label<br>Left=10<br>Right=-70<br>Top=20<br>Bottom=30<br>Text=install folder:<br><br>[Field 4]<br>Type=Link<br>Notify=ONCLICK<br>Left=190<br>Right=-1<br>Top=20<br>Bottom=30<br>State=<br>Text=<br><br>[Field 5]<br>Type=Text<br>Notify=ONTEXTCHANGE<br>Flags=READONLY<br>Left=10<br>Right=-10<br>Top=30<br>Bottom=42<br><br>[Field 6]<br>Type=Button<br>Text=Browse<br>Notify=ONCLICK<br>State=5<br>Flags=OPEN_FILEREQUEST|FILE_MUST_EXIST<br>Filter=<br>Left=164<br>Right=218<br>Top=65<br>Bottom=79<br><br>[Field 7]<br>Type=Icon<br>Left=190<br>Right=-1<br>Top=-0<br>Bottom=0<br><br>[Field 8]<br>Type=Label<br>Left=10<br>Right=65<br>Top=0<br>Bottom=10<br>Text=Par<br><br><br>[Field 9]<br>Type=Label<br>Left=71<br>Right=120<br>Top=0<br>Bottom=10<br>Text=<br><br>[Field 10]<br>Type=Button<br>Text=Quit<br>Notify=Onclick<br>Left=82<br>Right=136<br>Top=65<br>Bottom=79<br><br>[Field 11]<br>Flags=Disabled<br>Type=Button<br>Text=Patch<br>Notify=ONCLICK<br>Left=0<br>Right=54<br>Top=65<br>Bottom=79</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">flizebogen</span><br><span class="post-time small text-muted">29th December 2004 08:09 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">I Problem with the Validation Function in the previous beta isn't fixed but changed.<br><br>Now the Value "ONNEXT" is written everytime. Even if i simply click on a Button which acts as a Filerequest.<br><br>One note to the new docs. The collaps / expand feature is very nice but you should add an "expand all" button, for easier searching / printing.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">deguix</span><br><span class="post-time small text-muted">29th December 2004 10:41 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>InstallOptionsEx 2.4.1 beta 12 - DLL</strong><br>The buttons bug is (I think) fixed now. (As I should say, a stupid bug caused by the previous build fix)<br><br>For that suggestion about "collapse/expand all": I'm going to do that next version as I have to come up with the code.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">WebMatze</span><br><span class="post-time small text-muted">29th December 2004 12:01 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>Thank you</strong><br>Thanks a lot, it works great now.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">flizebogen</span><br><span class="post-time small text-muted">29th December 2004 13:30 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">My problem still exists.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">deguix</span><br><span class="post-time small text-muted">29th December 2004 22:44 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>InstallOptionsEx 2.4.1 beta 12 - DLL</strong><br>Now I fixed yours (try it please).</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Yathosho</span><br><span class="post-time small text-muted">12th January 2005 16:53 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">do you plan to add more examples to the documentation? i tried to use the tooltips, but failed miserably :p</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Toopak</span><br><span class="post-time small text-muted">12th January 2005 18:03 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Found two problems.<br><br>1. When i have a field with type=Password and i don't specify "Text=*" it crashes the installer.<br><br>2. I have 30 controls on my form and there are 2 checkboxes with notify ONCLICK method on them (I want to catch when the status of checkbox is changed). I could not figureout why but sometimes when I click on one of those checkboxes the form "blinks". It did not happen with original InstallOpptions.dll<br><br>+ I have a problem: I have two editboxes on the form. One is enabled so user can enter data into it and another one is disabled. I need to get the behaviour when a user types something in the 1st editbox so that string is copied to second (disabled) editbox. I managed to put ONTEXTCHANGE flag and catch the change and to read the string from the control, but it won't to accept the string in the second disabled editbox when I write it there. Any ideas why it can happen?<br><br>Thanks in advance!</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br><span class="post-time small text-muted">12th January 2005 18:47 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Have you tried<br>GetDlgItem $R0 $hwnd 20xx<br>SendMessage $R0 "${WM_SETTEXT}" 0 "STR:Text"<br><br>$hwnd is from using InstallOptionsEx::initDialog /NOUNLOAD "ioFile.ini"<br>20xx is control ID (1200 + Field number - 1)<br><br>-Stu</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Toopak</span><br><span class="post-time small text-muted">12th January 2005 20:20 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"></p><blockquote><i>Originally posted by Afrow UK</i><br><b>Have you tried<br>GetDlgItem $R0 $hwnd 20xx<br>SendMessage $R0 "${WM_SETTEXT}" 0 "STR:Text"<br><br>$hwnd is from using InstallOptionsEx::initDialog /NOUNLOAD "ioFile.ini"<br>20xx is control ID (1200 + Field number - 1)<br><br>-Stu</b></blockquote>I tried it... did not work for me :(</div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br><span class="post-time small text-muted">12th January 2005 20:39 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Works fine here (using InstallOptions.dll)</p><pre>
<code>InstallOptions::initDialog /NOUNLOAD "$PLUGINSDIR\dlg"<br>Pop $R0<br><br>GetDlgItem $R1 $R0 1201<br>SendMessage $R1 "${WM_SETTEXT}" 0 "STR:Some text"<br><br>InstallOptions::show</code>
</pre>You need to move it to the Leave function though of course (the GetDlgItem + SendMessage)<br>
          <br>
          Make sure you !include WinMessages.nsh too<br>
          <br>
          -Stu
        </div>
        <hr>

        <div class="post">
          <p class="post-meta"><span class="post-author text-primary">Toopak</span><br>
          <span class="post-time small text-muted">12th January 2005 21:05 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

          <p class="post-content"></p>

          <blockquote>
            <i>Originally posted by Afrow UK</i><br>
            <b>Works fine here (using InstallOptions.dll)</b>
            <pre>
<b><code>InstallOptions::initDialog /NOUNLOAD "$PLUGINSDIR\dlg"<br>Pop $R0<br><br>GetDlgItem $R1 $R0 1201<br>SendMessage $R1 "${WM_SETTEXT}" 0 "STR:Some text"<br><br>InstallOptions::show</code></b>
</pre><b>You need to move it to the Leave function though of course (the GetDlgItem + SendMessage)<br>
            <br>
            Make sure you !include WinMessages.nsh too<br>
            <br>
            -Stu</b>
          </blockquote>this code is in the leave function and it works perfect for the checkboxes (except that blinking effect). WinMessages.nsh is included (needed to add a few defines myself though). At this moment that blinking thing is major for me if i dont find a way to fix it i'll need to go back to InstallOptions. :(
        </div>
        <hr>

        <div class="post">
          <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br>
          <span class="post-time small text-muted">12th January 2005 21:10 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

          <p class="post-content">An example script showing it happen should help deguix fix it.<br>
          <br>
          -Stu</p>
        </div>
        <hr>

        <div class="post">
          <p class="post-meta"><span class="post-author text-primary">Toopak</span><br>
          <span class="post-time small text-muted">12th January 2005 21:30 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

          <p class="post-content"></p>

          <blockquote>
            <i>Originally posted by Afrow UK</i><br>
            <b>An example script showing it happen should help deguix fix it.<br>
            <br>
            -Stu</b>
          </blockquote>Man! I found it! :) THANKS for your help! :)<br>
          <br>
          I just did not know that "STR:" plays any role at all.... I thought it's just a "test" string you guys use....<br>
          <br>
          I'm going to update my install script... I'm 99% sure the whole thing will be alright now.<br>
          <br>
          2deguix: Man, You rock! Keep up the great work! :)
        </div>
        <hr>
        
        
        

        <div class="container">
          

          <ol class="breadcrumb">
            <li><a href="../index.html" class="glyphicon glyphicon-home"></a></li>

            <li><a href="f-65.html">NSIS Discussion</a></li>

            <li class="active">InstallOptionsEx</li>
          </ol>

          <p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=181087">InstallOptionsEx</a></p><br>

          <div class="post">
            <p class="post-meta"><span class="post-author text-primary">Toopak</span><br>
            <span class="post-time small text-muted">12th January 2005 22:18 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

            <p class="post-content">Ok.... I have reproduced blink effect.... Please see the scripts in the attachment. If you click "Use Win Auth" checkbox on the Profile DB group you'll see that blink. The second checkbox on PDM DB tab works just fine. The only difference is:<br>
            <br></p>
            <pre>
<code><br>StrCmp $0 1 +1 +4<br>WriteINIStr "$PLUGINSDIR\DBConnection.ini" "Field 9" "Flags" "DISABLED"<br>WriteINIStr "$PLUGINSDIR\DBConnection.ini" "Field 11" "Flags" "DISABLED"<br>Goto +3<br>WriteINIStr "$PLUGINSDIR\DBConnection.ini" "Field 9" "Flags" ""<br>WriteINIStr "$PLUGINSDIR\DBConnection.ini" "Field 11" "Flags" ""<br></code>
</pre><br>
            <br>
            I need to disable the controls so when user clicks back button and then returns to this page those controls are still disabled.<br>
            <br>
            Thanks in advance!
          </div>
          <hr>

          <div class="post">
            <p class="post-meta"><span class="post-author text-primary">deguix</span><br>
            <span class="post-time small text-muted">15th January 2005 23:56 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

            <p class="post-content">That blink effect is the page update I talked about which, unfortunately, didn't go well. It's slow because the DLL updates every control (the DLL only knows that the INI file has changed). Maybe a solution would be creating a new DLL call so you can inform what INI value name from a control changed in the INI file.</p>
          </div>
          <hr>

          <div class="post">
            <p class="post-meta"><span class="post-author text-primary">Toopak</span><br>
            <span class="post-time small text-muted">19th January 2005 22:26 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

            <p class="post-content">Basically I don't mind extra code in my install script to prevent this problem. I'm pretty far from C++ language (did not touch it for a few years) so I think you'll better make a decision based on your experience. :)<br>
            <br>
            Thanks for the hard work man!</p>
          </div>
          <hr>

          <div class="post">
            <p class="post-meta"><span class="post-author text-primary">deguix</span><br>
            <span class="post-time small text-muted">22nd January 2005 18:29 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

            <p class="post-content"><strong>InstallOptionsEx 2.4.1 beta 13 - DLL</strong><br>
            Toopak: Your bug is fixed. "Page update from its INI file" feature was removed though. At least it won't blink anymore on your pages :).<br>
            <br>
            flizebogen: I also added the Collapse/Expand All feature to the docs. I think you're going to like the speed to load the docs :D.<br>
            <br>
            See full list of changes:<br>
            <br>
            - Added VSCROLL for ComboBox and DropList controls, and READONLY flag for CheckBox and RadioButton controls.<br>
            - Text on Button controls is automatically wrapped if there has no sufficient space.<br>
            - Label, Bitmap and Icon controls can have Link controls underneath them so the "hand" cursor shows when pointing to those.<br>
            - The text of DateTime controls is now aligned to the right when RTL is activated.<br>
            - ListBox controls new feature: multiple vertical columns (see Text INI value name).<br>
            - Added "Collapse/Expand/Invert All" options to documentation.<br>
            - Optimized the documentation.<br>
            - Removed "page update from INI file changes" feature.<br>
            - Added TRANSPARENT flag for Bitmap controls.<br>
            <br>
            If kichik is going to launch the new InstallOptions next NSIS version (2.05), probably the next IOEx version will be 2.4.2 beta 1 :confused:. I organized IOEx betas like that so I can't revert it anymore (I forgot about that IO could change). But it's still usable :rolleyes:...</p>
          </div>
          <hr>

          <div class="post">
            <p class="post-meta"><span class="post-author text-primary">flizebogen</span><br>
            <span class="post-time small text-muted">23rd January 2005 14:24 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

            <p class="post-content">Thanks for the changes to the docs, now its a lot easier to search and print.</p>
          </div>
          <hr>

          <div class="post">
            <p class="post-meta"><span class="post-author text-primary">deguix</span><br>
            <span class="post-time small text-muted">24th January 2005 15:46 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

            <p class="post-content">Print? Wow, what a useful way to read one! Quite interesting...<br>
            <br>
            I was thinking, what would be a great thing to release on 2.4.2 beta 1. New control types, just like I did on 2.4.1 beta 1? Maybe.... With the extra time I got from the blizzard here with 30+ inches of snow (about 75 cm of height), no school for 2 days... :D I think it's a great time to implement TreeView controls isn't :)? But it is difficult because of the grouping of items :confused: (ListItems is in only one line). I don't know if this is a great way to group items in a group...:<br>
            <br>
            I|II{A|B{1|2|3}}|III{A|B|C}<br>
            <br>
            It would appear like:<br>
            <br>
            I<br>
            II<br>
            +-A<br>
            +-B<br>
            +-+-1<br>
            --+-2<br>
            --+-3<br>
            III<br>
            +-A<br>
            +-B<br>
            +-C<br>
            <br>
            Is there any other ideas that might be a good solution for grouping items together in one line?</p>
          </div>
          <hr>

          <div class="post">
            <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br>
            <span class="post-time small text-muted">24th January 2005 17:52 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

            <p class="post-content">How about:<br>
            I|II|&gt;A|&gt;B|&gt;&gt;1|&gt;&gt;2|&gt;&gt;3|III|&gt;A|&gt;B|&gt;C<br>
            <br>
            Basically &gt; makes it step inwards if you know what I mean.<br>
            I think this would be easier to use because you don't have to worry about missing a curly bracket off by accident, plus I'm sure it would be easier to parse the string in your source code too :D<br>
            <br>
            -Stu</p>
          </div>
          <hr>

          <div class="post">
            <p class="post-meta"><span class="post-author text-primary">deguix</span><br>
            <span class="post-time small text-muted">24th January 2005 19:37 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

            <p class="post-content"></p>

            <blockquote>
              I'm sure it would be easier to parse the string in your source code too
            </blockquote>It's just a little bit harder because the DLL won't know when the group will end or start (like on I|&gt;&gt;1) so it would need 2 extra loops, and also, it would need to record which level each item is being written to. But your idea is still brillant because of the easiness to use.<br>
            <br>
            Resuming both ideas:<br>
            <br>
            "{" and "}":<br>
            <br>
            - Strengths:<br>
            --- Small line.<br>
            --- The item left to the '{' is always the parent.<br>
            --- Fast DLL process.<br>
            <br>
            - Weaknesses:<br>
            --- Someone could forget a bracket.<br>
            --- Not easily to seen on HM NIS Edit.<br>
            --- Difficult to know which level an item is in.<br>
            <br>
            "&gt;":<br>
            <br>
            - Strengths:<br>
            --- Number of "&gt;" indicate the number of levels the item is.<br>
            --- Previous item with a any previous level than the item is the parent.<br>
            --- Neatly seen on HM NIS Edit.<br>
            <br>
            - Weaknesses:<br>
            --- Big line.<br>
            --- Slower than "{" and "}".<br>
            <br>
            Anyone else?
          </div>
          <hr>

          <div class="post">
            <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br>
            <span class="post-time small text-muted">24th January 2005 20:58 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

            <p class="post-content">Ah I see what you mean.<br>
            <br>
            I was thinking about placing + to make groups, but that still doesn't tell where a group should end.<br>
            I think your original idea would be best.<br>
            <br>
            -Stu</p>
          </div>
          <hr>

          <div class="post">
            <p class="post-meta"><span class="post-author text-primary">Toopak</span><br>
            <span class="post-time small text-muted">24th January 2005 21:49 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

            <p class="post-content"><strong>Re: InstallOptionsEx 2.4.1 beta 13 - DLL</strong><br></p>

            <blockquote>
              <i>Originally posted by deguix</i><br>
              Toopak: Your bug is fixed. "Page update from its INI file" feature was removed though. At least it won't blink anymore on your pages :).
            </blockquote>Thanks, man! Works great now! :)
          </div>
          <hr>

          <div class="post">
            <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br>
            <span class="post-time small text-muted">24th January 2005 21:58 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

            <p class="post-content">Hey it would be ideal to make some macros to do common tasks like check/uncheck check-boxes, add list-box items and so on (in Leave function).<br>
            <br>
            -Stu</p>
          </div>
          <hr>

          <div class="post">
            <p class="post-meta"><span class="post-author text-primary">deguix</span><br>
            <span class="post-time small text-muted">24th January 2005 22:44 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

            <p class="post-content">I planned to create a DLL call that warns the DLL about a change on the INI file:</p>

            <blockquote>
              Maybe a solution would be creating a new DLL call so you can inform what INI value name from a control changed in the INI file.
            </blockquote>It'll do everything you wish for that can be also changable on the INI file (if that approach works) without even using GetDlgItem. This enables also to use InstallOptionsEx to create more than 1 page at a time (which I don't know how to do at this point), and so it goes on. It's all matter of time... and also a little bit of luck with the weather around here...
          </div>
          <hr>

          <div class="post">
            <p class="post-meta"><span class="post-author text-primary">deguix</span><br>
            <span class="post-time small text-muted">26th January 2005 18:52 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

            <p class="post-content">As a TreeView control on generally would be compared to the Components page TreeView control, I'm trying to do these things below:<br>
            <br>
            - When you don't have CHECKBOXES flag activated, <i>State</i> INI value only indicates 1 item to be selected.<br>
            - When using the CHECKBOXES flag, <i>State</i> INI value indicates the state of every item used on <i>ListItems</i> INI value name.<br>
            <br>
            - <i>Text</i> INI value is the bitmap file where the checkboxes can be located. It's the same format as found on the components page. This is required or the checkboxes won't show. Requires at least: Internet Explorer 3.0.<br>
            <br>
            Maybe I should stop talking about it and do it. :blah:</p>
          </div>
          <hr>

          <div class="post">
            <p class="post-meta"><span class="post-author text-primary">deguix</span><br>
            <span class="post-time small text-muted">5th February 2005 03:05 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

            <p class="post-content">I was thinking lately about the usefulness of the <i>ValidateText</i> value name. After I included the notification system I don't think it's that useful anymore. You could do the same thing by using a notification like <i>ONTEXTCHANGE</i>, <i>StrLen</i> to verify the length of the string, and a <i>MessageBox</i> to show a string. Do you think I should keep it, or remove it from the next versions? (<i>MaxLen</i> and <i>MinLen</i> will still be usable to support some control abilities)</p>
          </div>
          <hr>

          <div class="post">
            <p class="post-meta"><span class="post-author text-primary">Brummelchen</span><br>
            <span class="post-time small text-muted">6th February 2005 06:01 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

            <p class="post-content">how to handle buttons ?<br>
            <br>
            i have 2 buttons on my IO and how do i read out which one was clicked ?<br>
            <br>
            it is to mention that these 2 buttons replaces 2 radiobuttons and depending on this it choses different IO pages following thereafter<br>
            <br>
            before:<br>
            o bla<br>
            o blubb<br>
            [next]<br>
            <br>
            after<br>
            [bla] [blubb]<br>
            (no next)<br>
            <br>
            PS how to open a HLP file from a button like LINK ???</p>
          </div>
          <hr>

          <div class="post">
            <p class="post-meta"><span class="post-author text-primary">deguix</span><br>
            <span class="post-time small text-muted">6th February 2005 16:11 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

            <p class="post-content"></p>

            <blockquote>
              i have 2 buttons on my IO and how do i read out which one was clicked ?
            </blockquote>Read the "State" value name of "Settings" section of your INI file using "ReadINIStr". Like:
            <pre>
<code>ReadINIFile $0 "YourPage.ini" "Settings" "State"</code>
</pre>But, in order for the page to notify you about button clicks, you have to put a notification flag on the "Notify" value name of the field you want on your INI file. Like:
            <pre>
<code>[Field 1]<br>Type=Button<br>Text=Blablabla<br>Left=0<br>Right=30<br>Top=0<br>Bottom=10<br>Notify=ONCLICK</code>
</pre>

            <blockquote>
              it is to mention that these 2 buttons replaces 2 radiobuttons and depending on this it choses different IO pages following thereafter
            </blockquote>In this case, you need to use WriteINIStr after the page was shown to change the "Type" value of those fields. Like:
            <pre>
<code>WriteINIStr "YourPage.ini" "Field 1" "Type" "Button"</code>
</pre>

            <blockquote>
              PS how to open a HLP file from a button like LINK ???
            </blockquote>Put the full path location where it's found on the "State" of that link control. Like:
            <pre>
<code>[Field 3]<br>Type=Link<br>Text=Click me<br>Left=100<br>Right=-1<br>Top=40<br>Bottom=70<br>State=C:\MyDir\MyHelpFile.hlp</code>
</pre>You can also put a variable $0-$9, $R0-$R9 to specify the path if you think it's easier:
            <pre>
<code><br>State=$R9\MyHelpFile.hlp</code>
</pre>
          </div>
          <hr>

          <div class="post">
            <p class="post-meta"><span class="post-author text-primary">Brummelchen</span><br>
            <span class="post-time small text-muted">7th February 2005 00:46 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

            <p class="post-content">doesn't work here<br></p>
            <pre>
<code>[Field 1]<br>Type=Button<br>Text=Save<br>Left=30<br>Right=130<br>Top=10<br>Bottom=30<br>State=<br>Notify=ONCLICK<br>FONTBOLD=1<br><br>[Field 2]<br>Type=Button<br>Text=Restore<br>Left=160<br>Right=260<br>Top=10<br>Bottom=30<br>State=<br>Notify=ONCLICK<br>FONTBOLD=1<br></code>
</pre><br>
            <br>
            State of INI [SETTINGS] is both 0<br>
            <pre>
<code>ReadINIStr $BUTTON "$PLUGINSDIR\menu01.ini" "Settings" "State"</code>
</pre><br>
            <pre>
<code>  !insertmacro MUI_INSTALLOPTIONS_READ $BUTTON "menu01.ini" "Settings" "State"<br></code>
</pre><br>
            <br>
            doesn't work either<br>
            <pre>
<code>State=$R9\MyHelpFile.hlp</code>
</pre><br>
            <br>
            nsis205, latest IOex 2.41b13<br>
            <br>
            The IO is called w/o any PAGE and hast no PRE or LEAVE functions.
          </div>
          <hr>

          <div class="post">
            <p class="post-meta"><span class="post-author text-primary">deguix</span><br>
            <span class="post-time small text-muted">7th February 2005 04:54 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

            <p class="post-content"></p>

            <blockquote>
              The IO is called w/o any PAGE and hast no PRE or LEAVE functions.
            </blockquote>That's why it's not working. It has to be read on the leave function. After the leave function, a page notification is always set (like ONNEXT, ONBACK or ONCANCEL) and state will always be 0.<br>
            <br>
            Secondly, remove the empty "State" INI value names from your fields. The plugin will think that you want to execute something and it won't return to the leave function.<br>
            <br>
            Thirdly, the "State" of a <i>Button</i> or <i>Link</i> field is the same thing as the first parameter of the Exec NSIS command. So that means if you are used to run an application like this with NSIS:
            <pre>
<code>Exec "C:\MyDir\MyApp.exe"</code>
</pre>You can just put exactly as it appears:
            <pre>
<code>State=C:\MyDir\MyApp.exe</code>
</pre>
          </div>
          <hr>

          <div class="post">
            <p class="post-meta"><span class="post-author text-primary">Brummelchen</span><br>
            <span class="post-time small text-muted">7th February 2005 09:58 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

            <p class="post-content">&gt;&gt; That's why it's not working. It has to be read on the leave function<br>
            <br>
            whoops - i should have a closer look to my script (now for 1.5 years - still no end)<br>
            <br>
            &gt; page custom selectaction<br>
            <br>
            Should PAGE end here ?<br></p>
            <pre>
<code>  InstallOptionsEx::dialog "menu01.ini"<br>    Pop $R0<br></code>
</pre><br>
            <br>
            The button state should be returned state in POP (differs from back next cancel) as well...<br>
            <br>
            ... after a while...<br>
            <br>
            ok i managed the leave function.<br>
            <br>
            but now i have next problem:<br>
            i have a 3rd button [Go] which selects a language.<br>
            <br>
            if i click there the code behind is working fine but the leave function does not get a new state - exactly: its empty ''<br>
            the Go-button return (aborts) back to the IO page which need to be redrawn in new language - nothing happens...<br>
            <br>
            <br>
            Help-Link - i tried now everything, it still doesn't work<br>
            <br>
            [Field 8]<br>
            Type=Link<br>
            Text=Online-Help<br>
            Left=30<br>
            Right=68<br>
            Top=120<br>
            Bottom=128<br>
            State=<br>
            <br>
            <pre>
<code>  !insertmacro MUI_INSTALLOPTIONS_WRITE "menu01.ini" "Field 8" "State" "$EXEPATH\onlinehelp.hlp"<br></code>
</pre><br>
            State, path and file are correct but nothing happens.
          </div>
          <hr>

          <div class="post">
            <p class="post-meta"><span class="post-author text-primary">Brummelchen</span><br>
            <span class="post-time small text-muted">14th February 2005 14:38 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

            <p class="post-content">let me guess - you have no clue ? :cry:</p>
          </div>
          <hr>

          <div class="post">
            <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br>
            <span class="post-time small text-muted">14th February 2005 16:44 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

            <p class="post-content">Don't you mean $EXEDIR or perhaps $INSTDIR not $EXEPATH...<br>
            <br>
            -Stu</p>
          </div>
          <hr>

          <div class="post">
            <p class="post-meta"><span class="post-author text-primary">Brummelchen</span><br>
            <span class="post-time small text-muted">14th February 2005 17:25 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

            <p class="post-content">sorry - yes - i mask some code ;)<br>
            <br>
            it is: strcpy $B2BPATH $exedir &gt; exepath ^^<br>
            <br>
            later it is<br>
            !insertmacro MUI_INSTALLOPTIONS_WRITE "menu01.ini" "Field 8" "State" "$B2BPATH\online.hlp"<br>
            <br>
            but that dont work as mentioned (although ini is ok)</p>
          </div>
          <hr>

          <div class="post">
            <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br>
            <span class="post-time small text-muted">14th February 2005 19:01 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

            <p class="post-content">Perhaps you could attach your script.<br>
            <br>
            -Stu</p>
          </div>
          <hr>

          <div class="post">
            <p class="post-meta"><span class="post-author text-primary">Brummelchen</span><br>
            <span class="post-time small text-muted">14th February 2005 21:07 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

            <p class="post-content">sorry, thats not really possible, only snippets<br>
            (it's a 40kb script with many subroutines and lots of<br>
            variables and some external language files)<br>
            <br></p>
            <pre>
<code>[Settings]<br>NumFields=8<br>Title=<br>BackEnabled=0<br>BackButtonText=&lt; Back<br>NextEnabled=1<br>NextButtonText=Next &gt;<br>CancelEnabled=1<br>CancelButtonText=Quit<br><br>CancelShow=1<br>NextShow=0<br>BackShow=0<br><br><br>[Field 1]<br>[Field 2]<br>[Field 3]<br>[Field 4]<br>[Field 5]<br>[Field 6]<br>[Field 7]<br><br>[Field 8]<br>Type=Link<br>Text=Online-Help<br>Left=30<br>Right=68<br>Top=120<br>Bottom=128      <br>State=<br></code>
</pre><br>
            <br>
            <pre>
<code><br>strcpy $B2BPATH $exedir<br>;for testing purpose only cause later the path <br>;is compared with the real installpath from registry<br><br>  !insertmacro MUI_INSTALLOPTIONS_WRITE "menu01.ini" "Field 8" "State" "$B2BPATH\online.hlp"<br><br>  InstallOptionsEx::dialog "$PLUGINSDIR\$LANGSHORTmenu01.ini"<br>    Pop $R0<br></code>
</pre><br>
            <br>
            The next normal IO is fully functional<br>
            <br>
            <pre>
<code>[Field 12]<br>Type=Link<br>Left=260<br>Right=310<br>Top=124<br>Bottom=134<br>State=Online.hlp<br>Text=Online Help<br></code>
</pre><br>
            <br>
            ... this way or i put the full path+file into it..<br>
            but not in IOex.<br>
            <br>
            do you need more information ?
          </div>
          <hr>

          <div class="post">
            <p class="post-meta"><span class="post-author text-primary">deguix</span><br>
            <span class="post-time small text-muted">16th February 2005 19:10 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

            <p class="post-content">Sorry, I was out of NSIS for a while, and I'm now at my school. But I can see from your code that you forgot about the Notify INI value name for Link and Button controls are always required. Clicks won't work if you don't specify this for those 2 controls. This is considered as a feature.</p>
          </div>
          <hr>

          <div class="post">
            <p class="post-meta"><span class="post-author text-primary">NHOCSUNG</span><br>
            <span class="post-time small text-muted">17th February 2005 16:41 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

            <p class="post-content">i just want to set the bitmap for Back, Next, Cancel button .... can you guy tell me how</p>
          </div>
          <hr>

          <div class="post">
            <p class="post-meta"><span class="post-author text-primary">Brummelchen</span><br>
            <span class="post-time small text-muted">20th February 2005 00:12 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

            <p class="post-content">&gt;&gt; you forgot about the Notify INI value name for Link<br>
            i need notify for link ???<br>
            Do u want to fool me ? ;)<br></p>

            <blockquote>
              Displays a static hot text that, when the mouse is passed over its area, the mouse cursor turns into a hand. When combined with Label, Bitmap and Icon controls, this makes their areas also make the mouse turn into a hand, and execute the action of this control. It's better to don't use any text with this trick.
            </blockquote>Please update your readme, thanks i reserved the old one<br>

            <blockquote>
              [...]See Notify value name below for more information on notifications.
            </blockquote>I'll try...<br>
            notify=onclick works without any additional code thx<br>
            <br>
            now the other point - i need to redraw the IO after abort - possible ?
          </div>
          <hr>

          <div class="post">
            <p class="post-meta"><span class="post-author text-primary">deguix</span><br>
            <span class="post-time small text-muted">20th February 2005 14:04 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

            <p class="post-content"></p>

            <blockquote>
              Please update your readme
            </blockquote>As IOEx is on betas this is not a thing that is going to be usually done. My priority is more on the plugin itself than docs so maybe some kind of information on docs could be still wrong after changes.<br>
            <br>

            <blockquote>
              now the other point - i need to redraw the IO after abort - possible ?
            </blockquote>That's what I'm trying to do on next versions. Fortunately I'm going to work more on IOEx this week because of the February school vacation.:D
          </div>
          <hr>

          <div class="post">
            <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br>
            <span class="post-time small text-muted">20th February 2005 14:41 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

            <p class="post-content"></p>

            <blockquote>
              <i>Originally posted by deguix</i><br>
              <b>That's what I'm trying to do on next versions. Fortunately I'm going to work more on IOEx this week because of the February school vacation.:D</b>
            </blockquote>Damn, this is my last day today :(<br>
            <br>
            -Stu
          </div>
          <hr>

          <div class="post">
            <p class="post-meta"><span class="post-author text-primary">deguix</span><br>
            <span class="post-time small text-muted">20th February 2005 16:48 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

            <p class="post-content">If I had school Saturdays and Sundays, and they took off those winter days off and holidays, about more than half of the year would be a vacation. :D (180 days of school in total)</p>
          </div>
          <hr>

          <div class="post">
            <p class="post-meta"><span class="post-author text-primary">Brummelchen</span><br>
            <span class="post-time small text-muted">20th February 2005 17:57 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

            <p class="post-content">@deguix<br>
            thx for help - i did it another way now, not less comfortable<br>
            <br>
            wish you happy holidays :)</p>
          </div>
          <hr>

          <div class="post">
            <p class="post-meta"><span class="post-author text-primary">robber98</span><br>
            <span class="post-time small text-muted">26th February 2005 01:28 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

            <p class="post-content">Hi deguix<br>
            <br>
            I tried out the transparent flags for BMP and it works! Thanks a lot!<br>
            <br>
            However, the custom page re-draw itself slowly (really slow). I am pretty sure that the flag slowing it down because once the flag removed, the custom page loaded just fine. Is there any work around that I could avoild this problem until next release? FYI, I have 4 BMP on custom page: a background image and 3 images with transpanent flag. Thanks in advance!!</p>
          </div>
          <hr>

          <div class="post">
            <p class="post-meta"><span class="post-author text-primary">deguix</span><br>
            <span class="post-time small text-muted">26th February 2005 01:39 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

            <p class="post-content">@robber98: I implemented exactly as on original InstallOptions. Try your INI file on it and see if it continues to slow down.<br>
            <br>
            I'm now accepting help including new features to the plugin. If anyone wants to make or made patches for this plugin, think they're useful, and want them to be implemented on IOEx, you're welcome. TreeView is not an easy control to implement (a month passed and still less than 50% of the TreeView is done) and about no features were added besides the control.<br>
            <br>
            I lately added a screenshot of the TreeView control to the IOEx Archive page. It's simple looking now, but I'll try to improve it more in the next days.</p>
          </div>
          <hr>

          <div class="post">
            <p class="post-meta"><span class="post-author text-primary">geoffrey_4js</span><br>
            <span class="post-time small text-muted">9th March 2005 16:33 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

            <p class="post-content">Hi,<br>
            I'm working on scripts that used installoptions.dll (not installoptionsex) and i've just downloaded and installed InstallOptionsEx and my question is : how to replace the use of installoptions by installoptionsex ?<br>
            <br>
            (I'm using W2000 SPa and NSIS 2.05)<br>
            <br>
            Geo</p>
          </div>
          <hr>

          <div class="post">
            <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br>
            <span class="post-time small text-muted">9th March 2005 17:02 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

            <p class="post-content">Have you read the InstallOptionsEx readme?<br>
            Place InstallOptionsEx.dll in yor Plugins folder and use InstallOptionsEx:: call.<br>
            <br>
            -Stu</p>
          </div>
          <hr>

          <div class="post">
            <p class="post-meta"><span class="post-author text-primary">geoffrey_4js</span><br>
            <span class="post-time small text-muted">9th March 2005 17:16 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

            <p class="post-content">I've read that (sorry but as I'm working on a code I've not done, and the guy has quit the company so many things are confusing for me), I will try futhermore (there're no InstallOptions:: call used in the code).<br>
            <br>
            EDIT : I've changed all InstallOptions:: call by InstallOptionsEx:: call in system.nsh. It compiles, it make InstallOptionsEx properties working (I've tried with NextEnabled=0) but MUI_PAGE_WELCOME doesn't displayed rightly.<br>
            <br>
            EDIT 2 : as written in the doc, I've also try to rename InstallOptionsEx.dll in InstallOptions.dll but the MUI_PAGE_WELCOME doesn't displayed rightly anymore.<br>
            <br>
            To be sure I've understant a main point : InstallOptionsEx is InstallOptions, but developped more deeply ?</p>
          </div>
          <hr>

          <div class="post">
            <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br>
            <span class="post-time small text-muted">9th March 2005 17:43 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

            <p class="post-content">Yes.<br>
            If you need to use InstallOptionsEx's features, then use it instead of just InstallOptions, else stick with default InstallOptions.<br>
            <br>
            -Stu</p>
          </div>
          <hr>

          <div class="post">
            <p class="post-meta"><span class="post-author text-primary">deguix</span><br>
            <span class="post-time small text-muted">10th March 2005 01:24 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

            <p class="post-content"></p>

            <blockquote>
              EDIT 2 : as written in the doc, I've also try to rename InstallOptionsEx.dll in InstallOptions.dll but the MUI_PAGE_WELCOME doesn't displayed rightly anymore.
            </blockquote>That's what I'm planning to next version, try to make support again to the "SendMessage" command on some controls that have been using the "custom draw".<br>
            <br>

            <blockquote>
              To be sure I've understant a main point : InstallOptionsEx is InstallOptions, but developped more deeply ?
            </blockquote>Yes, except for the docs which is not looking that "helpful" right now.
          </div>
          <hr>

          <div class="post">
            <p class="post-meta"><span class="post-author text-primary">geoffrey_4js</span><br>
            <span class="post-time small text-muted">10th March 2005 08:17 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

            <p class="post-content">So is it a way to use InstallOptionsEx instead of InstallOptions and having the pages displayed correctly ?<br>
            <br>
            Or should I use InstallOptions and use InstallOptionsEx with some dll call when I need it ? (I can't really figure out how both can works together... :-\ )</p>
          </div>
          <hr>

          <div class="post">
            <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br>
            <span class="post-time small text-muted">10th March 2005 08:45 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

            <p class="post-content">In MUI's System.nsh, just use InstallOptionsand in your installer script use InstallOptionsEx. As simple as that.<br>
            That means you get two InstallOptions dll's in your installer though.<br>
            <br>
            -Stu</p>
          </div>
          <hr>
          
          
          

          <div class="container">
            

            <ol class="breadcrumb">
              <li><a href="../index.html" class="glyphicon glyphicon-home"></a></li>

              <li><a href="f-65.html">NSIS Discussion</a></li>

              <li class="active">InstallOptionsEx</li>
            </ol>

            <p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=181087">InstallOptionsEx</a></p><br>

            <div class="post">
              <p class="post-meta"><span class="post-author text-primary">geoffrey_4js</span><br>
              <span class="post-time small text-muted">10th March 2005 10:24 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

              <p class="post-content">It's me again :)<br>
              <br>
              In my custom dialog, I've tried to use InstallOptionsEx but I can't extract the INI file.<br>
              <br>
              With InstallOptions.dll, I was doing that in tne .init function :<br></p>
              <pre>
<code><br>Function DlgJvmDetection.onInit<br>  !insertmacro MUI_INSTALLOPTIONS_EXTRACT_AS "${INCLUDES_DLGS_DIR}\DlgJvmDetection.ini" "DlgJvmDetection.ini"<br>FunctionEnd</code>
</pre><br>
              <br>
              And I've tried :<br>
              <pre>
<code><br>Function DlgJvmDetection.onInit<br>  InitPluginsDir<br>  File /oname=$PLUGINSDIR\DlgJvmDetection.ini DlgJvmDetection.ini<br>FunctionEnd</code>
</pre><br>
              <pre>
<code><br>Function DlgJvmDetection.onInit<br>  File /oname=${INCLUDES_DLGS_DIR}\DlgJvmDetection.ini DlgJvmDetection.ini<br>FunctionEnd<br></code>
</pre><br>
              <br>
              But I get a "File: "DlgJvmDetection.ini" -&gt; no files found." error in both of the case.<br>
              <br>
              EDIT : Ok, I've look inside system.nsh and solve my problem :<br>
              <pre>
<code><br>Function DlgJvmDetection.onInit<br>  InitPluginsDir<br>  File "/oname=$PLUGINSDIR\DlgJvmDetection.ini" "${INCLUDES_DLGS_DIR}\DlgJvmDetection.ini"<br>FunctionEnd</code>
</pre><br>
              <br>
              <br>
              EDIT 2 : I achieve to made all work together :D, thx for your help.<br>
              All I had to do is to add two macros (the two I was using with InstallOptions) :<br>
              <pre>
<code>!macro MUI_INSTALLOPTION****INITDIALOG FILE<br><br>  !verbose push<br>  !verbose ${MUI_VERBOSE}<br><br>  InstallOptionsEx::initDialog /NOUNLOAD "$PLUGINSDIR\${FILE}"<br><br>  !verbose pop<br><br>!macroend</code>
</pre><br>
              <br>
              <pre>
<code>!macro MUI_INSTALLOPTION****SHOW<br><br>  !verbose push<br>  !verbose ${MUI_VERBOSE}<br><br>  InstallOptionsEx::show<br>  Pop $MUI_TEMP1<br><br>  !verbose pop<br><br>!macroend</code>
</pre><br>
              <br>
              I've got (a last ?) question : for the moment, I put those macro in DlgJvmDetection.nsi containing the callbacks functions and some functions to go with my custom page INI (DlgJvmDetection.ini).<br>
              <br>
              I will probably have to use InstallOptionEx in other custom pages so what is better :<br>
              - to put those macros in system.nsh<br>
              - to create a system_ex.nsh containing the macro specific to InstallOptionEx ??
            </div>
            <hr>

            <div class="post">
              <p class="post-meta"><span class="post-author text-primary">deguix</span><br>
              <span class="post-time small text-muted">10th March 2005 12:22 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

              <p class="post-content">2. Answer:</p>

              <blockquote>
                to create a system_ex.nsh containing the macro specific to InstallOptionEx
              </blockquote>
            </div>
            <hr>

            <div class="post">
              <p class="post-meta"><span class="post-author text-primary">geoffrey_4js</span><br>
              <span class="post-time small text-muted">10th March 2005 14:09 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

              <p class="post-content">Thx for your quick help and advices. The library is done and used.<br>
              <br>
              I've got a new problem. I've got a LINK control, and would like that when clicked, it open an URL with Internet Explorer (to install a program,it needs IE :-\). My main webbrowser is Firefox, and if I just put an URL as STATE value for the LINK control, with notify=ONCLICK , it correctly open the link in Firefox.<br>
              <br>
              In the doc, there is written, for the STATE field option used with a LINK control : "Specifies something to be executed or opened (like "Exec" command from NSIS)."<br>
              <br>
              But I've tried many different syntax but it doesn't work (nothing happens when I click)<br>
              <br>
              (I'm using WriteIniStr in the .pre callback on my custom dialog)<br>
              <br>
              WriteIniStr "$PLUGINSDIR\DlgJvmDetection.ini" "Field 10" "State" "Exec '$WINDIR\explorer.exe ${JVM_DOWNLOAD_URL}'"<br>
              <br>
              WriteIniStr "$PLUGINSDIR\DlgJvmDetection.ini" "Field 10" "State" '"$WINDIR\explorer.exe" "${JVM_DOWNLOAD_URL}"'<br>
              <br>
              WriteIniStr "$PLUGINSDIR\DlgJvmDetection.ini" "Field 10" "State" 'Exec '"$WINDIR\explorer.exe ${JVM_DOWNLOAD_URL}"'<br>
              <br>
              WriteIniStr "$PLUGINSDIR\DlgJvmDetection.ini" "Field 10" "State" "$WINDIR\explorer.exe ${JVM_DOWNLOAD_URL}"<br>
              <br>
              Is it a syntax problem (with the " and '), or something else ?<br>
              <br>
              And secondly, does a way to center text in a LABEL control exist ?</p>
            </div>
            <hr>

            <div class="post">
              <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br>
              <span class="post-time small text-muted">10th March 2005 15:21 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

              <p class="post-content">Just pass it ${JVM_DOWNLOAD_URL}. You don't need to pass it the path to Windows explorer.<br>
              <br>
              -Stu</p>
            </div>
            <hr>

            <div class="post">
              <p class="post-meta"><span class="post-author text-primary">geoffrey_4js</span><br>
              <span class="post-time small text-muted">10th March 2005 15:23 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

              <p class="post-content">The problem is that if I do that, it will open the URL with the default web browser, but I want to force the use of IE.<br>
              <br>
              I've got that in my .ini at execution :<br></p>
              <pre>
<code><br>[Field 10]<br>Type=Link<br>Text=Windows Automated Downloads<br>Left=95<br>Right=292<br>Top=79<br>Bottom=87<br>Notify=ONCLICK<br>State="C:\WINNT\explorer.exe" "http://www.java.com/en/download/windows_automatic.jsp"</code>
</pre><br>
              <br>
              And if I paste "C:\WINNT\explorer.exe" "http://www.java.com/en/download/windows_automatic.jsp" in my windows workplace, it launch IE and open the right page.
            </div>
            <hr>

            <div class="post">
              <p class="post-meta"><span class="post-author text-primary">Pidgeot</span><br>
              <span class="post-time small text-muted">10th March 2005 16:32 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

              <p class="post-content">Try WriteIniStr "$PLUGINSDIR\DlgJvmDetection.ini" "Field 10" "State" '"$WINDIR\explorer.exe" ${JVM_DOWNLOAD_URL}'<br>
              or<br>
              WriteIniStr "$PLUGINSDIR\DlgJvmDetection.ini" "Field 10" "State" '"$PROGRAMFILES\Internet Explorer\iexplore.exe" ${JVM_DOWNLOAD_URL}'.</p>
            </div>
            <hr>

            <div class="post">
              <p class="post-meta"><span class="post-author text-primary">geoffrey_4js</span><br>
              <span class="post-time small text-muted">10th March 2005 17:03 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

              <p class="post-content">It stil doesn't work. What strange is, is that if I take the string in the State field and copy it in the command prompt, the page open in a IE window...</p>
            </div>
            <hr>

            <div class="post">
              <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br>
              <span class="post-time small text-muted">10th March 2005 18:04 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

              <p class="post-content">If you set up FireFox as your default web browser (go to Options &gt; General) then it will open URL's in Firefox not IE.<br>
              <br>
              -Stu</p>
            </div>
            <hr>

            <div class="post">
              <p class="post-meta"><span class="post-author text-primary">Pidgeot</span><br>
              <span class="post-time small text-muted">10th March 2005 19:01 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

              <p class="post-content">That would be the exact problem - the automatic Java installer only works for IE.<br>
              <br>
              You could try to detect whether or not IE is the default browser. If it isn't, change the link to go to the manual install page, <a href="http://www.java.com/en/download/manual.jsp." target="_blank">http://www.java.com/en/download/manual.jsp.</a><br>
              <br>
              If your app requires Java to run, you could also detect whether it is already installed (there's a function in the archive), and then use MUI_FINISHPAGE_RUN, although it's probably not the most elegant solution.</p>
            </div>
            <hr>

            <div class="post">
              <p class="post-meta"><span class="post-author text-primary">deguix</span><br>
              <span class="post-time small text-muted">10th March 2005 20:58 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

              <p class="post-content"></p>

              <blockquote>
                And secondly, does a way to center text in a LABEL control exist ?
              </blockquote>This is also planned on next versions. <b>EDIT</b>: I'll create 4 more value names called <i>Align</i>, <i>VAlign</i> (for control positionment), <i>TxtAlign</i>, <i>TxtVAlign</i> (for text).<br>
              <br>

              <blockquote>
                It stil doesn't work. What strange is, is that if I take the string in the State field and copy it in the command prompt, the page open in a IE window...
              </blockquote>IOEx uses the <a href="http://msdn.microsoft.com/library/default.asp?url=/library/en-us/shellcc/platform/shell/reference/functions/shellexecute.asp" target="_blank">ShellExecute</a> function from Win API. It requires the file location to be separated from the parameters on separate function parameters (meaning, separated into "lpFile" and "lpParameters"). So what you're trying to do is not possible right now. InstallOptions also has this problem.
            </div>
            <hr>

            <div class="post">
              <p class="post-meta"><span class="post-author text-primary">geoffrey_4js</span><br>
              <span class="post-time small text-muted">11th March 2005 08:11 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

              <p class="post-content">@Pidgeot : I didn't find the function in the archive but developpe my own. It's a good idea to test if IE is the default browser or not, and then choose the url. I will apply this solution.<br>
              <br>
              @deguix : the manuel is a bit confusing cause according to it, what I would like to do seems possible. Do you plan to add this functionnality to InstallOptionsEx ? (for exemple by addind a field in the ini (one for the app to launch and one for the parameters for exemple ??). So it's only possible to put :<br>
              - an url<br>
              - an exec without parameters<br>
              in the State field of a Link control ?</p>
            </div>
            <hr>

            <div class="post">
              <p class="post-meta"><span class="post-author text-primary">deguix</span><br>
              <span class="post-time small text-muted">11th March 2005 09:13 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

              <p class="post-content"></p>

              <blockquote>
                Do you plan to add this functionnality to InstallOptionsEx ? (for exemple by addind a field in the ini (one for the app to launch and one for the parameters for exemple ??).
              </blockquote>Yes, but how I still don't know at this point. I gonna figure this out later.<br>
              <br>

              <blockquote>
                So it's only possible to put :<br>
                - an url<br>
                - an exec without parameters<br>
                in the State field of a Link control ?
              </blockquote>Yeah.
            </div>
            <hr>

            <div class="post">
              <p class="post-meta"><span class="post-author text-primary">geoffrey_4js</span><br>
              <span class="post-time small text-muted">11th March 2005 09:44 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

              <p class="post-content">OK, i'll keep watching out this topic. Great great job indeed :up:, the whole NSIS stuff.</p>
            </div>
            <hr>

            <div class="post">
              <p class="post-meta"><span class="post-author text-primary">deguix</span><br>
              <span class="post-time small text-muted">11th March 2005 12:26 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

              <p class="post-content">TreeView control is complete for this version (I'll leave "ownerdraw" style for the next version). IOEx planned release date is probably sometime next week or a week after.<br>
              <br>
              To fix your problem, geoffrey_4js, I'm thinking on spliting the string by an "|". My objective is to make the syntax compact (not so many INI value names).</p>
            </div>
            <hr>

            <div class="post">
              <p class="post-meta"><span class="post-author text-primary">geoffrey_4js</span><br>
              <span class="post-time small text-muted">11th March 2005 14:00 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

              <p class="post-content">Your idea sounds good,so we could do something like that :<br>
              State="$WINDIR/explorer.exe"|"$URL"</p>
            </div>
            <hr>

            <div class="post">
              <p class="post-meta"><span class="post-author text-primary">flizebogen</span><br>
              <span class="post-time small text-muted">17th March 2005 07:18 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

              <p class="post-content">Either i didn't found it in the docs or it's not yet supported:<br>
              <br>
              I have a DropList with a lot of values. Is there a way to make this control editable? My list will never contain all possible values so i want to give the user the chance to enter a new value or chance an list entry.<br>
              <br>
              Any idea?<br>
              <br>
              (Using latest Version dated Jan 22 2005)<br>
              <br>
              regards<br>
              <br>
              flizebogen</p>
            </div>
            <hr>

            <div class="post">
              <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br>
              <span class="post-time small text-muted">17th March 2005 08:49 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

              <p class="post-content">You'd need a combo box for editing. I don't know if it's in IOEx (can't check here at college).<br>
              <br>
              -Stu</p>
            </div>
            <hr>

            <div class="post">
              <p class="post-meta"><span class="post-author text-primary">flizebogen</span><br>
              <span class="post-time small text-muted">17th March 2005 09:06 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

              <p class="post-content">Thanks, combobox is exactly what i'm looking for and works very well</p>
            </div>
            <hr>

            <div class="post">
              <p class="post-meta"><span class="post-author text-primary">deguix</span><br>
              <span class="post-time small text-muted">19th March 2005 22:45 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

              <p class="post-content"></p>

              <blockquote>
                Your idea sounds good,so we could do something like that :<br>
                State="$WINDIR/explorer.exe"|"$URL"
              </blockquote>I changed my idea over it. Maybe this new idea will go against the direction which this feature was going, but I now think that it should be removed from IOEx, because there is already a better way to doing that with NSIS (using "LeaveFunction" and <i>Exec</i> command). The same applies for "ValidateText" (using "LeaveFunction" and <i>MessageBox</i> command).<br>
              <br>
              What do you think about it, should I keep those two, or should I remove them from IOEx?
            </div>
            <hr>

            <div class="post">
              <p class="post-meta"><span class="post-author text-primary">kike_velez</span><br>
              <span class="post-time small text-muted">21st March 2005 08:30 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

              <p class="post-content">Hello<br>
              <br>
              Is posible works with InstallOptionEx in an IDE like HM Nis Edit?<br>
              <br>
              Thanks in advance</p>
            </div>
            <hr>

            <div class="post">
              <p class="post-meta"><span class="post-author text-primary">deguix</span><br>
              <span class="post-time small text-muted">21st March 2005 14:25 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

              <p class="post-content">Yes, but you should create "Unknown" controls for controls that don't exist on InstallOptions.</p>
            </div>
            <hr>

            <div class="post">
              <p class="post-meta"><span class="post-author text-primary">deguix</span><br>
              <span class="post-time small text-muted">22nd March 2005 09:31 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

              <p class="post-content"><strong>InstallOptionsEx 2.4.2 beta 1 - DLL</strong><br>
              Not so many things this version were implemented, but the implementation of TreeView was the feature I spent my time the most. Other big changes were the fix of a bug existant since 2.4.1 beta 10 about Password controls, and the inclusion 4 brand new INI value names for "Field #" INI section. Take a look at the changes:<br>
              <br>
              - Added new control type: TreeView.<br>
              - Major Fix: Password controls without a value for Text INI value name gave a fatal error.<br>
              - Added new flags to Flags INI value name: CHECKBOXES for TreeView controls, TRANSPARENT for Animation controls (second implementation).<br>
              - Removed flags from Flags INI value name: RIGHT for CheckBox and RadioButton controls, LEFT for UpDown controls.<br>
              - Added new INI value names for "Field #" INI sections: Align, VAlign, TxtAlign,and TxtVAlign.<br>
              - Removed ellipsis support for strings that pass control border boundaries on Label, Link, DropList, ComboBox and ListBox controls.<br>
              - Added tab character support for Label and Link controls.<br>
              Added carriage return, new line and tab characters support for DropList, ComboBox and ListBox controls.<br>
              - Adjusted rectangles of Label and Link controls so that the focus rectangle don't cut part of strings (only Link controls) and have at least 1 pixel of background color on the left and right of the control.<br>
              - Right-To-Left dialogs have the UpDown control to invert its position in relation to its buddy control.<br>
              - Forgot to mention about NOWORDWRAP flag for Text and Password controls in the documentation.<br>
              - MaxLen INI value name for TrackBar controls didn't calculate correctly the maximum number of items. Now if you specify 10, there will be 10 items.<br>
              - Aplied patch <a href="http://sourceforge.net/tracker/index.php?func=detail&amp;aid=1164307&amp;group_id=22049&amp;atid=373087" target="_blank">#1164307</a>.</p>
            </div>
            <hr>

            <div class="post">
              <p class="post-meta"><span class="post-author text-primary">dandaman32</span><br>
              <span class="post-time small text-muted">21st April 2005 21:12 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

              <p class="post-content">Would like a "display and continue script" function (for things like showing a trial version nag screen and disabling the Next button for 5 seconds)<br>
              <br>
              -dandaman32</p>
            </div>
            <hr>

            <div class="post">
              <p class="post-meta"><span class="post-author text-primary">dimator</span><br>
              <span class="post-time small text-muted">26th April 2005 01:50 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

              <p class="post-content"><strong>InstallOptionsEx Progress Bar Usage</strong><br>
              Hi, I'm curious to see a usage of the progressbar control. What I tried to do was this:<br>
              <br></p>
              <pre>
<code><br>Function MyPage<br>  InstallOptionsEx::initDialog /NOUNLOAD "$PLUGINSDIR\test.ini"<br>  Pop $hwnd<br>  InstallOptionsEx::show<br>  Pop $0<br><br>  StrCpy $R0 "0"<br><br>  loop:<br>    WriteINIStr "$PLUGINSDIR\test.ini" "Field 2" "State" "$R0"<br>  <br>    IntOp $R0 $R0 + 1<br>    Sleep 25<br>  IntCmp $R0 100 +1 loop +1<br>  <br>  cancel:<br><br>FunctionEnd<br></code>
</pre><br>
              <br>
              Where Field 2 is a progress bar of course, but I guess that's not the way, because IOEx::show does not return? Any suggestions?<br>
              <br>
              Thanks
            </div>
            <hr>

            <div class="post">
              <p class="post-meta"><span class="post-author text-primary">deguix</span><br>
              <span class="post-time small text-muted">26th April 2005 11:10 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

              <p class="post-content">You have to use <i>SendMessage</i> to adjust the current position with the message <i>PBM_SETPOS</i>:</p>
              <pre>
<code><br>  !define PBM_SETPOS 0x0402<br><br>  GetDlgItem $0 $hwnd 1201 ;field # + 1200 - 1<br>  StrCpy $R0 "0"<br><br>  loop:<br>    SendMessage $0 ${PBM_SETPOS} $R0 ""<br>  <br>    IntOp $R0 $R0 + 1<br>    Sleep 25<br>  IntCmp $R0 100 +1 loop +1<br>  <br>  cancel:<br></code>
</pre>Or using LogicLib.nsh:
              <pre>
<code><br>  !define PBM_SETPOS 0x0402<br><br>  GetDlgItem $0 $hwnd 1201 ;field # + 1200 - 1<br><br>  ${For} $R0 1 100<br>    SendMessage $0 ${PBM_SETPOS} $R0 ""<br>    Sleep 25<br>  ${Next}<br></code>
</pre>About the docs:<br>
              <br>
              - I found a problem in the new docs where "Notify" INI value name in "Field #" section disappeared. I'm gonna check this out later.
            </div>
            <hr>

            <div class="post">
              <p class="post-meta"><span class="post-author text-primary">dimator</span><br>
              <span class="post-time small text-muted">28th April 2005 00:15 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

              <p class="post-content">Having such loops block other UI activity by the user, so he can't for example click Cancel. I wonder if it's possible to include</p>
              <pre>
<code>System::Call ${sysGetMessage}</code>
</pre>and
              <pre>
<code>System::Call ${sysDispatchMessage}</code>
</pre>in the loop, to keep the UI responsive.<br>
              <br>
              I am not totally comfortable with how NSIS handles the message loop, so any ideas?
            </div>
            <hr>

            <div class="post">
              <p class="post-meta"><span class="post-author text-primary">dimator</span><br>
              <span class="post-time small text-muted">4th May 2005 03:04 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

              <p class="post-content"><strong>InstallOptionsEx timer auto-callback</strong><br>
              So, due to my complete confusion regarding how to update a progress bar without blocking the rest of the UI, I have decided to hack IOEx. What I want to do is to modify the following loop in showCfgDlg() (InstallerOptions.cpp):<br>
              <br></p>
              <pre>
<code><br>  while (!g_done) {<br>    MSG msg;<br>    int nResult = GetMessage(&amp;msg, NULL, 0, 0);<br>    if (!IsDialogMessage(hConfigWindow,&amp;msg) &amp;&amp; !IsDialogMessage(hMainWindow,&amp;msg))<br>    {<br>      TranslateMessage(&amp;msg);<br>      DispatchMessage(&amp;msg);<br>    }<br>  }<br></code>
</pre><br>
              <br>
              Somewhere in there, I want to add code that will callback a function in my NSIS installer. The callback will be... called based on a timer. So when setting up the IOEx dialog, I will pass a time parameter like 500 msecs, and the above while loop will determine if that time has elapsed and call my callback. Then, in my callback, I can update the progress bar, and do all the other things I need to do.<br>
              <br>
              (This whole idea is due to my frustration with all other attempts to update a progress bar automatically, without blocking the UI in a loop. I have attempted various user32::SetTimber/callback based approaches, but with no luck, so if someone can point me to the "right" way to do this, I'd be happy. :) )
            </div>
            <hr>

            <div class="post">
              <p class="post-meta"><span class="post-author text-primary">deguix</span><br>
              <span class="post-time small text-muted">4th May 2005 06:49 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

              <p class="post-content">Hmmm... there existed one InstallOptions modification in the past that used this feature... I could merge his idea to the plugin! I just wanted this feature to be implemented as the value name of "Settings" INI section, and to be known as a page notification (like ONTIMEOUT or something). What do you think?<br>
              <br>
              I forgot about that feature, thanks for reminding me! :D</p>
            </div>
            <hr>

            <div class="post">
              <p class="post-meta"><span class="post-author text-primary">dimator</span><br>
              <span class="post-time small text-muted">4th May 2005 21:08 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

              <p class="post-content">Sure, that is a good idea. My approach just calls the Page's leave function after a half a second (repeatedly), although that should probably be specifiable somehow, as in the INI as you said, but I have a deadline for a project, so my goal is to get it working for my needs asap.<br>
              <br>
              Looking forward to your update! If it's soon enough, I look forward to using it.</p>
            </div>
            <hr>

            <div class="post">
              <p class="post-meta"><span class="post-author text-primary">deguix</span><br>
              <span class="post-time small text-muted">5th May 2005 23:26 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

              <p class="post-content">Done, I just need to prepare docs. The feature included also halts when a notification from controls is called (like ONCLICK).</p>
            </div>
            <hr>

            <div class="post">
              <p class="post-meta"><span class="post-author text-primary">dimator</span><br>
              <span class="post-time small text-muted">5th May 2005 23:36 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

              <p class="post-content">Cool, I'm curious to learn how you implemented this. I'd be happy to beta test.</p>
            </div>
            <hr>

            <div class="post">
              <p class="post-meta"><span class="post-author text-primary">deguix</span><br>
              <span class="post-time small text-muted">7th May 2005 08:14 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

              <p class="post-content"><strong>InstallOptionsEx 2.4.2 beta 2 - DLL</strong><br>
              This version really don't have much. The only implementation is the <i>TimeOut</i> value name for "Settings" section. See the full list below:<br>
              <br>
              - Added <i>TimeOut</i> INI value name for "Settings" section. This enables the page to return after the specified time. When notifications are activated, the timer pauses until "Abort" is called on page's validation function. Also, it continues to repeat until the page is closed.<br>
              - Added <i>ONRCLICK</i> for <i>TreeView</i> controls.<br>
              - Fixed <i>ONCLICK</i> notification flag: Only captured single-clicks when <i>ONDBLCLICK</i> was not set.<br>
              - Added the missing <i>Notify</i> INI value name on the documentation.</p>
            </div>
            <hr>

            <div class="post">
              <p class="post-meta"><span class="post-author text-primary">dimator</span><br>
              <span class="post-time small text-muted">9th May 2005 23:55 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

              <p class="post-content">The TimeOut works great for my purposes. I'm glad I'll be able to keep my IOEx standard, instead of maintaining my patches. Thanks again.</p>
            </div>
            <hr>

            <div class="post">
              <p class="post-meta"><span class="post-author text-primary">pingcrosby</span><br>
              <span class="post-time small text-muted">10th June 2005 12:11 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

              <p class="post-content"><strong>InstallOptionsEx DropList Problem</strong><br>
              InstallOptionsEx "DropList" problem is showing the item lists all compressed togethor.<br>
              <br>
              To call invoke InstallOptionsEX .. i call<br></p>
              <pre>
<code><br>!macro MUI_RESERVEFILE_INSTALLOPTIONSEX<br>  !verbose push<br>  !verbose ${MUI_VERBOSE}<br>  ReserveFile "${NSISDIR}\Plugins\InstallOptionsEx.dll"<br>  !verbose pop<br>!macroend<br>  <br>!macro MUI_INSTALLOPTION****DISPLAY FILE<br>  !verbose push<br>  !verbose ${MUI_VERBOSE}<br>  InstallOptionsEX::dialog "$PLUGINSDIR\${FILE}"<br>  Pop $MUI_TEMP1<br>  !verbose pop<br>!macroend<br><br>!insertmacro MUI_INSTALLOPTION****DISPLAY my.ini<br>Function CustomPageFunction<br>   !insertmacro MUI_INSTALLOPTION****DISPLAY "my.ini"<br>FunctionEnd<br></code>
</pre><br>
              <br>
              With image below shows both a non InstallOptionsEX and InstallOptions droplist . As you can see one of the droplists shows the text in a somewhat "cramped" form.<br>
              <br>
              I have seen this before in Win32 but i cannot remember the reasons/fix.
            </div>
            <hr>

            <div class="post">
              <p class="post-meta"><span class="post-author text-primary">deguix</span><br>
              <span class="post-time small text-muted">10th June 2005 19:45 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

              <p class="post-content">The fix is to use <i>ListItemsHeight</i> to a higher value (the default is 10 pixels, I think). I knew of this problem before but I didn't know if there are any computer that uses larger fonts. Thanks for the report!<br>
              <br>
              You see, <i>ListItemsHeight</i> INI value name is similar to <i>Height</i> for other controls, but I just don't implement like this because that's the Windows default. You can suggest me this if you think it's better.</p>
            </div>
            <hr>

            <div class="post">
              <p class="post-meta"><span class="post-author text-primary">pingcrosby</span><br>
              <span class="post-time small text-muted">10th June 2005 21:30 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

              <p class="post-content">ListItemsHeight :: make sense. I just didnt see it in the .ini settings inside the documentation.<br>
              <br>
              If i may humbly make a couple of suggestions!<br>
              <br>
              Could you make a note as to why you may want to use ListItemsHeight in the documentation.<br>
              <br>
              Would you consider re-ordering the .ini file list in the documentation - ListItemsHeight sits between the Font... settings in my docs.<br>
              <br>
              ***<br>
              PS..<br>
              I really should just shut up and say thankyou for InstallOptionsEX - you ve done a fantastic job.<br>
              <br>
              Its made my installer very cool..<br>
              <br>
              Thanks</p>
            </div>
            <hr>

            <div class="post">
              <p class="post-meta"><span class="post-author text-primary">deguix</span><br>
              <span class="post-time small text-muted">11th June 2005 04:03 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

              <p class="post-content">Thanks. On the next version in the documentation, "ListItemsHeight" will be located right after "Left/Right/Top/Bottom/Height/Width".<br>
              <br></p>

              <blockquote>
                Could you make a note as to why you may want to use ListItemsHeight in the documentation.
              </blockquote>Do you mean if I could put in the docs why I chose "ListItemsHeight" instead of putting in place of the normal "Height", and not changing the actual value for "Height" to another INI value name, like "DropListHeight"?
            </div>
            <hr>

            <div class="post">
              <p class="post-meta"><span class="post-author text-primary">pingcrosby</span><br>
              <span class="post-time small text-muted">11th June 2005 11:13 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

              <p class="post-content"></p>

              <blockquote>
                Could you make a note as to why you may want to use ListItemsHeight in the documentation.
              </blockquote>Please ignore this - i wrote this when i was very tired and on further reading this morning it is nonsensical. All the information is already included in the documentation.<br>
              <br>
              Sorry to waste your time on this one.
            </div>
            <hr>

            <div class="post">
              <p class="post-meta"><span class="post-author text-primary">KenA</span><br>
              <span class="post-time small text-muted">20th June 2005 22:03 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

              <p class="post-content">Ok, I'm lost. :confused: Has anybody has a bit of code showing how to use the ProgressBar control with InstallOptionEx ?<br>
              <br>
              Thanks in advance,<br>
              <br>
              KenA</p>
            </div>
            <hr>

            <div class="post">
              <p class="post-meta"><span class="post-author text-primary">KenA</span><br>
              <span class="post-time small text-muted">21st June 2005 10:42 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

              <p class="post-content">Hi,<br>
              <br></p>

              <blockquote>
                I'm sorry to insist but nobody has a working piece of code using the ProgressBar control ? Or at least some pseudo code or explanations describing what should go in the pre page and what should go to the leave page ? So far I managed to either freeze the installer (I use the initDialog with /NOUNLOAD or quit with a crash without /NOUNLOAD, with no update of the control in either case. :(
              </blockquote>D'oh ! The latest version (and the latest help file in particular) posted in this forum opened my eyes, so problem solved !:D<br>
              <br>
              Deguix, thanks again for the great plugin even if sometimes I really struggle with the doc.:up:<br>
              <br>
              KenA
            </div>
            <hr>
            
            
            

            <div class="container">
              

              <ol class="breadcrumb">
                <li><a href="../index.html" class="glyphicon glyphicon-home"></a></li>

                <li><a href="f-65.html">NSIS Discussion</a></li>

                <li class="active">InstallOptionsEx</li>
              </ol>

              <p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=181087">InstallOptionsEx</a></p><br>

              <div class="post">
                <p class="post-meta"><span class="post-author text-primary">Yathosho</span><br>
                <span class="post-time small text-muted">28th June 2005 12:04 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                <p class="post-content">it would probably be a good idea to replace the seperators of ListItem ("|") with something else, so one can use it for a listed item. so far i have to replace all <b>|</b> with <b>$\</b> and all <b>$</b> with <b>$$</b>. how about making a future version of IOEx use something else (i.e. $\n)?</p>
              </div>
              <hr>

              <div class="post">
                <p class="post-meta"><span class="post-author text-primary">deguix</span><br>
                <span class="post-time small text-muted">28th June 2005 13:03 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                <p class="post-content"></p>

                <blockquote>
                  Deguix, thanks again for the great plugin even if sometimes I really struggle with the doc.:up:
                </blockquote>Sorry about that, maybe I'm better at programming IOEx than at developing docs...<br>
                <br>

                <blockquote>
                  it would probably be a good idea to replace the seperators of ListItem ("|") with something else, so one can use it for a listed item. so far i have to replace all | with $\ and all $ with $$. how about making a future version of IOEx use something else (i.e. $\n)?
                </blockquote>I might never told you this, but "\n" and "\r" actually work in ListBox, DropList and ComboBox controls. Also, $\n would bring confusion between NSIS syntax. Writing that with WriteINIStr would be not good at all.<br>
                <br>
                There is one thing I could do. I could create some escape characters for the characters used on lists: "\|", "\{" and "\}". It's quite unfare to don't let the user to use those characters as item names.<br>
                <br>
                EDIT: Wow! This thread is quite big! It's going to beat the record of the thread with the most posts in NSIS forums!
              </div>
              <hr>

              <div class="post">
                <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br>
                <span class="post-time small text-muted">28th June 2005 14:04 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                <p class="post-content">:D<br>
                <br>
                I have an idea. It would be cool to add 'tabs' (like on Desktop Properties). I could use this on one of my installers.<br>
                <br>
                Something like<br>
                <br>
                Type=Tabs<br>
                ...<br>
                Text=Tab 1|Tab 2<br>
                State=1<br>
                <br>
                Text = tab names<br>
                State = selected index<br>
                <br>
                The tab clicks would act like NOTIFY and we could use them to change to another IOEx form with the exact same tabs (but with the next one selected with State field).<br>
                <br>
                How easy would this be to implement?<br>
                <br>
                -Stu</p>
              </div>
              <hr>

              <div class="post">
                <p class="post-meta"><span class="post-author text-primary">deguix</span><br>
                <span class="post-time small text-muted">28th June 2005 22:42 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                <p class="post-content">Tabs are used to hold other controls. This would be a little easy because it only needs to know which controls are going to appear when one tab is selected. Also, the Tab control will need to hide or show the controls when a tab is selected.<br>
                <br>
                The simplest implementation would be using the value name that I'll add for the next version which is "RefFields" value name. This will be a list of fields to be hidden or shown when tabs are selected or unselected. This list will probably use "|" and "," characters to separate field indexes.<br>
                <br>
                The simplest answer then would be yes. I never thought on this idea until now. Thanks for bringing this up! :D</p>
              </div>
              <hr>

              <div class="post">
                <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br>
                <span class="post-time small text-muted">28th June 2005 23:09 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                <p class="post-content">Well, ok if you're up for it, that would be great :)<br>
                <br>
                -Stu</p>
              </div>
              <hr>

              <div class="post">
                <p class="post-meta"><span class="post-author text-primary">saivert</span><br>
                <span class="post-time small text-muted">30th June 2005 17:45 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                <p class="post-content"><strong>Nice, but really needed?</strong><br>
                Tabs are great, but I don't know how good looking tabs would be in a Wizard dialog. That's why you got multiple pages and next/back buttons. But since I'm a nice guy I wont overrule this completely. Here is my tips:<br>
                <br>
                Here is my pseudo INI layout:<br>
                <br></p>
                <pre>
<code><br>[Field 1]<br>Type=TabbedPages<br>Text=Tab 1|Tab 2|Tab 3<br>State=1<br>; You got separate IO pages<br>Pages=page1.ini|page2.ini|page3.ini<br>Tab= ;filled in by IOEx<br></code>
</pre><br>
                <br>
                State in this case contains the index of the tabpage that is visible (to follow the same scheme as the other controls).<br>
                You must read the [Settings]State key from the page INI of the visible page to check for clicks on controls within a page.
              </div>
              <hr>

              <div class="post">
                <p class="post-meta"><span class="post-author text-primary">deguix</span><br>
                <span class="post-time small text-muted">2nd July 2005 14:50 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                <p class="post-content">As I said, I had this idea:<br>
                <br></p>
                <pre>
<code><br>Type=Tab<br>ListItems=Tab 1|Tab 2<br>State=Tab 2<br>RefFields=1,2,4|3<br></code>
</pre><br>
                <br>
                That's the simplest, effective and most useful general solution to have the least amount of addition of structure to the DLL. I'm trying to find balance between size and features.<br>
                The only thing I need to implement here is the handling of Tab controls and the "RefFields" multiple field ID's to work with, nothing more.
              </div>
              <hr>

              <div class="post">
                <p class="post-meta"><span class="post-author text-primary">deguix</span><br>
                <span class="post-time small text-muted">2nd July 2005 16:02 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                <p class="post-content"><strong>InstallOptionsEx 2.4.2 beta 3 - DLL</strong><br>
                Lately, my betas were slowing down, which is not good for betatesters at all. Also, the TODO's from previous versions which weren't done are now giving a toll on me. Expect to don't have new controls, and to have fast, bugfixing only builds for some versions to come.<br>
                <br>
                For the plugin size, the most responsible for the increases are new INI value names. 3KB were added to the compressed build this version (19 KB now) and half of it were because of new INI value names. I'm expecting it to make somewhat near the 30KB mark at the end of beta development.<br>
                <br>
                Now, on to the new features. ListView control is the newest attraction on IOEx. It has features like CHECKBOXES flag (imported from TreeView control), view mode flags, and extra options just for the REPORT_VIEW (which will be futurely used by Header controls). But Link and Button controls aren't going to be passed aside that easily. They have 2 new dialog flags: COLORREQUEST and FONTREQUEST. Let's see the full list of changes:</p>

                <ul>
                  <li>Added new value names for "Field #" section: <i>RefField</i>, <i>StateImageList</i>, <i>SmallImageList</i>, <i>LargeImageList</i>, <i>HeaderItems</i>, <i>HeaderItemsAlign</i>, <i>HeaderWidth</i>.</li>

                  <li>Added new flags for <i>ListView</i> controls: <i>LIST_VIEW</i>, <i>ICON_VIEW</i>, <i>SMALLICON_VIEW</i>, and <i>REPORT_VIEW</i> and for <i>Link</i> and <i>Button</i> controls: <i>COLORREQUEST</i>, <i>FONTREQUEST</i>.</li>

                  <li><b>Older INI's braking notice:</b> All values supported by <i>OPEN_FILEREQUEST</i>, <i>SAVE_FILEREQUEST</i> and <i>DIRREQUEST</i> flags for <i>Link</i> and <i>Button</i><br>
                  controls on <i>State</i> value name and <i>UpDown</i> controls on <i>Text</i> value name were transfered to <i>RefField</i> value name.</li>

                  <li>Now <i>Link</i> and <i>Button</i> controls with <i>OPEN_FILEREQUEST</i>, <i>SAVE_FILEREQUEST</i>, <i>DIRREQUEST</i>, <i>COLORREQUEST</i>, <i>FONTREQUEST</i> flags output state values to <i>State</i> value name.</li>

                  <li><i>UpDown</i> controls now detect automatically the text from its buddy control. <i>State</i> value is not used anymore when the buddy control is set.</li>

                  <li><b>Older INI's braking notice:</b> All values for <i>TreeView</i> controls on <i>Text</i> value name ware transfered to <i>StateImageList</i> value name.</li>

                  <li>Fixed automatic Custom Draw setting for <i>Label</i>, <i>DropList</i>, <i>ComboBox</i>, and <i>ListBox</i>. Custom Draw setting will only be set if you specify one of the color commands values. Because of this, when this setting is disabled, the colors will be as the Windows' default, and some features like multiline for those controls (except <i>Label</i>) will be disabled. The good news is that this fixes problems when setting text to those controls or change some colors for now. To use custom draw in controls with default color values, use empty values like on "TxtColor=".</li>

                  <li>Added forgotten details about <i>Animation</i> controls support for the <i>State</i> INI value, types of animation supported, <i>TreeView</i> controls support for the <i>StateImageList</i> INI value, and the <i>ONSELCHANGE</i> notification flag.</li>

                  <li>Fixed problems with notifications that executed when other handled or non-handled notifications were activated.</li>

                  <li>Fixed checkbox state changes on <i>TreeView</i> controls when the space key was pressed.</li>

                  <li>Other small bugfixes.</li>
                </ul>Just a note on this version, this is what I know I couldn't do yet:

                <ul>
                  <li>the flag <i>EDITLABELS</i> is not finished.</li>

                  <li>the "\|" escape character is not implemented yet.</li>

                  <li>there is a bug on the last parameter of FONTREQUEST flag "State" INI value. The color is indicated as a decimal number.</li>
                </ul>
              </div>
              <hr>

              <div class="post">
                <p class="post-meta"><span class="post-author text-primary">deguix</span><br>
                <span class="post-time small text-muted">2nd July 2005 20:10 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                <p class="post-content"><strong>InstallOptionsEx 2.4.2 beta 3 post-build 1 - DLL</strong><br>
                I forgot to fix a bug before launching it:<br>
                <br>
                - ListItems of ListView controls have problems when setting empty item names.</p>
              </div>
              <hr>

              <div class="post">
                <p class="post-meta"><span class="post-author text-primary">deguix</span><br>
                <span class="post-time small text-muted">3rd July 2005 08:22 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                <p class="post-content"><strong>InstallOptionsEx 2.4.2 beta 3 post-build 2 - DLL</strong><br>
                I made two changes to this build:<br>
                <br>
                - Added <i>EDITLABELS</i> flag for <i>TreeView</i> and <i>ListView</i> controls.<br>
                - Fixed empty item names for <i>TreeView</i> controls.<br>
                <br>
                This increased the build size in 0.5 KB (now 19.5 KB). First, add features, then remove unnecessary ones and fix bugs.<br>
                <br>
                I think this strategy keeps me from forgetting what I changed in the plugin, because now I always have a list of what changed. I don't know, keep posting versions this quick would be good for posting numbers here in forums. At least, nobody has to wait anymore for features, because they come as fast as I implement them! :D</p>
              </div>
              <hr>

              <div class="post">
                <p class="post-meta"><span class="post-author text-primary">deguix</span><br>
                <span class="post-time small text-muted">3rd July 2005 22:04 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                <p class="post-content"><strong>InstallOptionsEx 2.4.2 beta 3 post-build 3 - DLL</strong><br>
                Another build, and more fixes and additions:<br>
                <br>
                - Added <i>MULTISELECT</i> for <i>ListView</i> controls (made single selection default in this case).<br>
                - Fixed the return of <i>State</i> and <i>ListItems</i> INI values for <i>Link</i> and <i>Button</i> controls with <i>COLORREQUEST</i> flag.</p>
              </div>
              <hr>

              <div class="post">
                <p class="post-meta"><span class="post-author text-primary">flizebogen</span><br>
                <span class="post-time small text-muted">4th July 2005 08:06 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                <p class="post-content">I have a question regarding the Beta 3 Post build 3:<br>
                <br>
                I have the following Ini Code:<br>
                <br></p>
                <pre>
<code><br><br>[Field 17]<br>Type=Text<br>Left=20<br>Right=120<br>Top=160<br>Bottom=175<br>State=<br>Flags=Disabled<br><br>[Field 18]<br>Type=Button<br>Left=130<br>Right=150<br>Top=160<br>Bottom=175<br>RefField=17<br>State=<br>Text=...<br>Flags=OPEN_FILEREQUEST<br>NOTIFY=ONCLICK<br>Filter=All Files|*.*<br>ToolTipIcon=INFO<br>ToolTipTitle=Messagetext<br>ToolTipText=Choose a File to add to your Mail<br>ToolTipFlags=BALLOON<br>ToolTipTxtColor=0x000000<br>ToolTipBgColor=0xE1FFFF<br>ToolTipMaxWidth=300<br><br></code>
</pre><br>
                <br>
                I use this 2 Controls to display which file the user had selected. In your Docs you're saying that the Reffield command is input only and that the output of the Filerequest control is the state value of that control. So my question is: Is it still possible that the output is given to another control?
              </div>
              <hr>

              <div class="post">
                <p class="post-meta"><span class="post-author text-primary">deguix</span><br>
                <span class="post-time small text-muted">4th July 2005 12:55 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                <p class="post-content">It's <i>RefFields</i>, sorry 'bout that.</p>
              </div>
              <hr>

              <div class="post">
                <p class="post-meta"><span class="post-author text-primary">flizebogen</span><br>
                <span class="post-time small text-muted">4th July 2005 13:45 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                <p class="post-content">Now i works - thanks</p>
              </div>
              <hr>

              <div class="post">
                <p class="post-meta"><span class="post-author text-primary">saivert</span><br>
                <span class="post-time small text-muted">5th July 2005 14:00 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                <p class="post-content"><strong>ININININ</strong><br>
                I still think my Tab idea is the best. It make the hole thing more structured as you can keep the fields for the different tabs in separate Ini files. Nothing more would be required really. You just have to read more than one INI in your page leave callback function.</p>
              </div>
              <hr>

              <div class="post">
                <p class="post-meta"><span class="post-author text-primary">deguix</span><br>
                <span class="post-time small text-muted">5th July 2005 18:57 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                <p class="post-content">Ok? How about the control IDs of the fields when importing other INI's, would fields have to start at 1 also in those INI's?<br>
                <br>
                1) If yes: This would need extra handling for additional types of control ID's (starting at 1300 for example), a variable containing the groups of tabs that occupy certain ID groups, and a defined limitation of number of controls a page can have. Also, there is the nesting of tabs inside others. What would be the ID's of the controls inside this tab control nested in another? They would have to be in the same ID group, so the division in the number of controls the group could have is halved, and thus the limitation could make the nesting of 5 tab controls, one inside another, to reduce considerably to just 1 control (if the actual limit of controls is 100). I'm not even counting how many INI files you would need to create for this nesting, because that would be in an huge number.<br>
                <br>
                2) If no: What's the reason for creating separated pages then? You'll be limited to use different ID's for the controls anyways. It's a lot better having only 1 INI to worry about. If you need to be in separate pages, why not concatenate the INI files at run-time? That would be easier than adding more KB's to your favorite plugin for nothing. People don't usually use this feature. This feature is not even GUI related.<br>
                <br>
                So, does everyone agree that my idea is better for the future of IOEx? :rolleyes:</p>
              </div>
              <hr>

              <div class="post">
                <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br>
                <span class="post-time small text-muted">5th July 2005 19:31 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                <p class="post-content">I think it's fine. It'll be easier to manage everything in one INI file as well I think.<br>
                <br>
                -Stu</p>
              </div>
              <hr>

              <div class="post">
                <p class="post-meta"><span class="post-author text-primary">saivert</span><br>
                <span class="post-time small text-muted">6th July 2005 05:28 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                <p class="post-content">So you mean that you want a very huge INI file?<br>
                And the controls that are on the tabs are hosted in their own childdialog anyway. You can't just place all contols on one dialog and then do show/hide of controls depending on what tab is selected. No real applications does this. They create separate dialogs for each tab and then swap between these page dialogs (moves active page dialog up z order and hides non-active page dialogs).<br>
                <br>
                Thus you can have separate INI files and you don't have to worry about control IDs as they are unique within each dialog anyway.</p>
              </div>
              <hr>

              <div class="post">
                <p class="post-meta"><span class="post-author text-primary">deguix</span><br>
                <span class="post-time small text-muted">6th July 2005 10:35 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                <p class="post-content">Ok, you have the reason in saying that controls have unique ID's and it does the basic job of Tab controls. :( I was not studying over this type of control yet (didn't read SDK). I was more thinking on fixing bugs and implementing missing features first, and just then implement controls.<br>
                <br>
                I still don't think I can do it for next versions, because, as I said, it's still a little difficult to manage INI files like that (independent window messages handling and other stuff).<br>
                <br>
                For this, IOEx would need the support to be used for multiple dialogs, and this is a major TODO. If I can get this going, I can also get the creation of independent dialogs which is also a major TODO. However, I need to work first on remodelating the source code for the implementation of external controls (major TODO). As I implemented almost all the controls that don't need the major TODO's (except for HotKey, ScrollBar, ToolBar, StatusBar) IOEx is getting closer and closer from major release.</p>
              </div>
              <hr>

              <div class="post">
                <p class="post-meta"><span class="post-author text-primary">saivert</span><br>
                <span class="post-time small text-muted">6th July 2005 17:26 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                <p class="post-content">I don't think you should work this much on IOEx. The original purpose of IOEx was to bring more control classes to the playground and not be a complete user-interface tool for NSIS. I don't think we need that much in a installer anyway. If NSIS evolved into being a complete apllication development platform, then maybe...<br>
                <br>
                What I would like is an easy way in the original InstallOptions plug-in to set and retrieve listbox items without using SendMessaget and GetDlgItem functions. What about simple functions called "ListboxGetItem", "ListboxSetItem", "ListboxGetCurSel", "ListboxDeleteItem" exported by the plug-in. I hate doing extensive string manipulations on the ListItems INI key (searching for a string matching the State and splitting on "|" character. And the NSIS script language was really not intended for this heavy string processing. The end result: You can drop a listbox and have add/remove buttons so people can configure some app right in the installer (add remove some items).</p>
              </div>
              <hr>

              <div class="post">
                <p class="post-meta"><span class="post-author text-primary">deguix</span><br>
                <span class="post-time small text-muted">6th July 2005 19:23 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                <p class="post-content">1)I don't know what's the future of NSIS, so I don't also know when I should stop developing on what I have. IOEx might be by far behind other user-interface programs, but at least there is something. If I didn't change it, then you would be stuck with IO and you would try to do it also. This also plays an experience role for me. Besides, NSIS is a really easy language to learn and with a powerful compiler that has a very low overhead and that compiles things very fast in slow computers.<br>
                <br>
                2) I know, that's what I'm doing right now. I'm verifying the possibility of organizing the plugin's structure to be more object-orientated, which would allow it to easily export individual functions from the DLL. I'm trying to find what's already available (MFC), get a small part of the things I find and modify them to IOEx's ways. After this optimization I could export any type of function you need. But I'm still looking for information, so don't trust totally on what I say here.<br>
                <br>
                Also, there is one more InstallOptions bug I discovered (without Ex): the text returned by a ComboBox and Text controls can be up to 2 times the actual buffer limit.</p>
              </div>
              <hr>

              <div class="post">
                <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br>
                <span class="post-time small text-muted">6th July 2005 19:31 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                <p class="post-content">I've always felt that NSIS would be an ideal platform for program development, but it's always lacked some really necessary controls. One thing we could also do with would be to add customised menu (ie File, Edit View etc) and maybe a status bar too.<br>
                <br>
                -Stu</p>
              </div>
              <hr>

              <div class="post">
                <p class="post-meta"><span class="post-author text-primary">deguix</span><br>
                <span class="post-time small text-muted">6th July 2005 19:37 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                <p class="post-content">Yes, of course, I'll get there. But I have no experience with menus whatsoever. What syntax would you suggest?</p>
              </div>
              <hr>

              <div class="post">
                <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br>
                <span class="post-time small text-muted">6th July 2005 21:06 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                <p class="post-content">I think you'd have to have a Field # for each menu item and it would do NOTIFY by default. You won't need to specify the position/size attributes because it will always be put on the top, in order of Field #. E.g.<br>
                <br>
                [Field 1]<br>
                Type=Menu<br>
                ListItems=Open|Save|Save As<br>
                <br>
                State would be the ListItem that was selected which we can check on the Leave function.<br>
                <br>
                As for sub-menus, that's something different - not sure if we could do that... in fact I doubt there would be any need to anyway. Basic menus are plenty!<br>
                <br>
                -Stu</p>
              </div>
              <hr>

              <div class="post">
                <p class="post-meta"><span class="post-author text-primary">saivert</span><br>
                <span class="post-time small text-muted">9th July 2005 05:23 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                <p class="post-content">The core of NSIS currently handles the UI in such a strict way that turning it into an application programming platform requires massive changes to the core. The wizard page based system only loads plug-ins in the context of a page, and not persistent through the entire application. My NSIS Debugger plug-in creates a new thread where it handles the message queue of a separate window, but that is a different thing. You can pull off many hacks to take over the wizard dialog of NSIS (my recently posted wansis plug-in demonstrates this) but ultimately in the end it is an installer and nothing else.</p>
              </div>
              <hr>

              <div class="post">
                <p class="post-meta"><span class="post-author text-primary">deguix</span><br>
                <span class="post-time small text-muted">9th July 2005 12:19 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                <p class="post-content">That's true. But if you treated NSIS differently than a installer system, then it would go away from the goal of being NSIS in the first place. Logically, if everybody would want NSIS to turn into an independent language, it would be harder on people looking for building installers effectivelly. I would prefer NSIS to be more of a programming language, but there are others who prefer NSIS as an ideal tool for creating installers. Even though NSIS have few things big programming languages have, those languages don't have an efficient tool for creating installers like NSIS is. kichik has done a good job on equilibrating both. This equilibrium is also thanks to brainsucker for creating the System plugin.</p>
              </div>
              <hr>

              <div class="post">
                <p class="post-meta"><span class="post-author text-primary">JasonFriday13</span><br>
                <span class="post-time small text-muted">18th July 2005 07:09 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                <p class="post-content">I agree. I once tried making an installer out of visual basic but that did't work. I see NSIS as an installer system that has its perks. Such as: easy writing of INI files; creates program shortcuts easily; writes to the registry easily; you can use custom graphics; use a background gradient; can use custom made pages; etc... I could go on about it, but to stop taking up space on the server I will stop now.<br>
                <br>
                I have never found such an installer system that was so easy to learn. I use HM NIS edit to edit my .nsi files. The first time I use NIS edit I went straight to the wizard so I could study the script it produced. My skills have increased dramatically. My hangman setup program is an example of my skills. I might post it on my thread "Just a thought.." just to show what could be done. :cool:</p>
              </div>
              <hr>

              <div class="post">
                <p class="post-meta"><span class="post-author text-primary">deguix</span><br>
                <span class="post-time small text-muted">24th July 2005 18:39 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                <p class="post-content"><strong>InstallOptionsEx 2.4.2 beta 3 post-build 4 - DLL</strong><br>
                Wow, I about deleted this build from my computer. Luckly there is a recycle bin which I don't clean often. I've changed these things below:<br>
                <br>
                - Added ListView and TreeView controls support for TxtColor and BgColor values.<br>
                - Fixed an interminable loop when <i>UpDown</i> controls had a buddy control that had the <i>ONTEXTCHANGE</i> or <i>ONTEXTUPDATE</i> notification flags.<br>
                <br>
                I can't promise much about beta 4. It's better to do something than be talking about it every time. Also, no more fast builds. I got tired of doing them when I have not much to offer.</p>
              </div>
              <hr>

              <div class="post">
                <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br>
                <span class="post-time small text-muted">24th July 2005 19:51 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                <p class="post-content">Will tabs still be added someday?<br>
                <br>
                -Stu</p>
              </div>
              <hr>

              <div class="post">
                <p class="post-meta"><span class="post-author text-primary">deguix</span><br>
                <span class="post-time small text-muted">25th July 2005 06:08 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                <p class="post-content">Yes, of course. But there are a lot of suggestions pending. If you want a feature right away, why don't you help me to add what you want quickly? I'd be glad to have my work changed by someone else :rolleyes:.</p>
              </div>
              <hr>

              <div class="post">
                <p class="post-meta"><span class="post-author text-primary">saivert</span><br>
                <span class="post-time small text-muted">25th July 2005 11:51 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                <p class="post-content">Yeah! There are a lot of people who know how to code, but which rather want to wait for others to do it instead.<br>
                <br>
                Come on... make something all of you...</p>
              </div>
              <hr>

              <div class="post">
                <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br>
                <span class="post-time small text-muted">25th July 2005 11:52 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                <p class="post-content">I'm still a C++ newb and the IO source especially scares me lol<br>
                I'll have a mess around with tabs later today and see if I can implement it into IO.<br>
                <br>
                -Stu</p>
              </div>
              <hr>

              <div class="post">
                <p class="post-meta"><span class="post-author text-primary">saivert</span><br>
                <span class="post-time small text-muted">25th July 2005 15:42 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                <p class="post-content">That's good to hear. I will try to fixup my <b>wansis</b> plug-in to support skinning of tabcontrols. Read more about it in the proper topic.</p>
              </div>
              <hr>

              <div class="post">
                <p class="post-meta"><span class="post-author text-primary">goldy1064</span><br>
                <span class="post-time small text-muted">29th July 2005 17:54 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                <p class="post-content"><strong>DropList Problem</strong><br>
                Don't know if this is a bug or not, but when I try to use the DropList on Win2k, it is all congested and you can't see the list drop down. I've attached the image and here's the code:<br>
                <br></p>
                <pre>
<code><br>[Field 15]<br>Type=Label<br>Text=Select Language:<br>Left=260<br>Right=315<br>Top=8<br>Bottom=18<br>Width=<br>Height=<br>FontHeight=8<br><br>[Field 16]<br>Type=DropList<br>ListItems=English|Japanese<br>State=English<br>Left=260<br>Right=350<br>Top=18<br>Bottom=<br>Width=<br>Height=<br>ListItemsHeight=12<br>Notify=ONSELCHANGE<br>Flags=DROPLIST<br></code>
</pre><br>
                Also, all of the items are there in the droplist because when the droplist has focus, I can use the keyboard.
              </div>
              <hr>

              <div class="post">
                <p class="post-meta"><span class="post-author text-primary">goldy1064</span><br>
                <span class="post-time small text-muted">29th July 2005 17:56 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                <p class="post-content">Oops, here's the image...</p>
              </div>
              <hr>

              <div class="post">
                <p class="post-meta"><span class="post-author text-primary">deguix</span><br>
                <span class="post-time small text-muted">29th July 2005 18:05 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                <p class="post-content">Set "ListItemsHeight" INI value to a number bigger than 15 (the default on the current version).</p>
              </div>
              <hr>

              <div class="post">
                <p class="post-meta"><span class="post-author text-primary">goldy1064</span><br>
                <span class="post-time small text-muted">29th July 2005 18:48 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                <p class="post-content">This doesn't seem to have any effect. Without ListItemsHeight, it works on XP, just not on 2k.</p>
              </div>
              <hr>

              <div class="post">
                <p class="post-meta"><span class="post-author text-primary">deguix</span><br>
                <span class="post-time small text-muted">29th July 2005 19:57 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                <p class="post-content">I misunderstood your problem. Set the "Bottom" value of your "DropList" to be big enough so that it appears correctly on Win2K (I never had Win2K, so I can't test it). Also, take out the "DROPLIST" flag. This is not needed if you're using a "DropList" type of control.</p>
              </div>
              <hr>

              <div class="post">
                <p class="post-meta"><span class="post-author text-primary">goldy1064</span><br>
                <span class="post-time small text-muted">1st August 2005 17:07 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                <p class="post-content">That worked, thanks!</p>
              </div>
              <hr>

              <div class="post">
                <p class="post-meta"><span class="post-author text-primary">deguix</span><br>
                <span class="post-time small text-muted">3rd August 2005 16:22 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                <p class="post-content"><strong>InstallOptionsEx 2.4.2 beta 4 - DLL</strong><br>
                This time there is some big things: new value names for <i>Settings</i> section that add more compatibility to IO.</p>

                <ul>
                  <li><i>MUnit</i> INI value name: it adds the ability to use pixels coordinates instead of the dialog units. IOEx just became compatible with InstallOptions 1 pages.</li>

                  <li>Reimplementation of <i>NumFields</i> INI value name: The only thing different from IO is that it now detects the number of fields existent in the INI file automatically as default.</li>
                </ul>See the full list of changes for this version:

                <ul>
                  <li>Added MUnit value name for Settings section and NotifyCursor for Field # section.</li>

                  <li>Added ListView and TreeView controls support for TxtColor and BgColor values.</li>

                  <li>Added EDITLABELS flag for TreeView and ListView controls and MULTISELECT for ListView controls (made single selection default in this case).</li>

                  <li>Fixed empty item names for TreeView and ListView controls.</li>

                  <li>Fixed the return of State and ListItems INI values for Link and Button controls with COLORREQUEST flag.</li>

                  <li>Fixed an interminable loop when UpDown controls had a buddy control that had the ONTEXTCHANGE or ONTEXTUPDATE notification flags.</li>

                  <li>Re-added NumFields from original InstallOptions for compatibility reasons.</li>

                  <li>Fixed the range of numbers for UpDown controls. Maximum value for MaxLen and MinLen is 2147483646 and the minimum is -2147483646. Also the default values for the two value names are 2147483646 and -2147483646, respectively.</li>
                </ul>I've discovered the problem that happens with non-WinXP systems about the ComboBox "Height" value:

                <ul>
                  <li>WinXP: 0 = ListItemsHeight + border height * 2 (control is required to show up).</li>

                  <li>Other Versions: 0 = 0 (control doesn't show up).</li>
                </ul>I tried to expand the notification system but I didn't get far. I knew that it would be better to have separate plugins to capture mouse movements and for key presses than making everything built-in inside one plug-in.
              </div>
              <hr>
              
              
              

              <div class="container">
                

                <ol class="breadcrumb">
                  <li><a href="../index.html" class="glyphicon glyphicon-home"></a></li>

                  <li><a href="f-65.html">NSIS Discussion</a></li>

                  <li class="active">InstallOptionsEx</li>
                </ol>

                <p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=181087">InstallOptionsEx</a></p><br>

                <div class="post">
                  <p class="post-meta"><span class="post-author text-primary">niteflyer</span><br>
                  <span class="post-time small text-muted">16th August 2005 14:45 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                  <p class="post-content"><strong>Bugs in DirRequster ?</strong><br>
                  Could you confirm 2 bugs in InstallOptionsEx 2.4.2.b4 regarding the flag DIRREQUEST for buttons:<br>
                  <br>
                  1) STATE will not be used as input to set the default folder of the DirRequester dialog. I know, this is not documented, but even the documented feature (the default folder will be previous selected one) does not work. REFFIELDS work, but only as documented for the output of the DirRequester. It would be nice to be able to initialize the dialog's default folder via STATE or the referenced textcontrol.<br>
                  <br>
                  2) LISTITEMS displays a pipe character (|) at the end of the string. I can only get rid of this by appending about 700 space characters to the string.<br>
                  <br>
                  Two hints for the documentation: you should mention that the NOTIFY-value is mandatory for a button to display a requester. I had no examples and was puzzling some hours to get it work like in 'old' InstallOptions.<br>
                  <br>
                  In "How to use - Step 6: Return Value" you mention the return value on the stack (this is documented for "InstallOptions" as well) but in your example for Step 3 (Call the DLL - "show") you "forget" to pop the return value from the stack. Does InstallOptionsEx provide no return value anymore or did you really forget the POP (there have to be 2 POPs) ?<br>
                  <br>
                  I am currently using NSIS 2.07.<br>
                  <br>
                  See my custom testpage in the attachment.</p>
                </div>
                <hr>

                <div class="post">
                  <p class="post-meta"><span class="post-author text-primary">deguix</span><br>
                  <span class="post-time small text-muted">16th August 2005 15:44 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                  <p class="post-content">1) There is actually no way to fix this without creating a new custom dialog for this occasion. The input of a folder is not accepted by the BROWSEINFO structure used by the SHBrowseForFolder. If you verify throughtly, even NSIS and InstallOptions have this problem. It always points to the "My Documents" folder first.<br>
                  <br>
                  That default value is actually the value when you read from the INI file, not the one which appears, because you can't input a folder name to the control. So, there is no reason for saying the default value that appears, because it's the Windows default = "My Documents". But still, is better to say what appears anyways for this misunderstanding to don't happen again.<br>
                  <br>
                  2) I'll fix that.<br>
                  <br>
                  3) Actually, any notification will be enough to bring up the dir request dialog. I'll fix this also.<br>
                  <br>
                  4) InstallOptions' example is also wrong on this (the example is copied from there). I'll remove the first push for it to make clear that the plug-in function has a return value.</p>
                </div>
                <hr>

                <div class="post">
                  <p class="post-meta"><span class="post-author text-primary">niteflyer</span><br>
                  <span class="post-time small text-muted">16th August 2005 16:58 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                  <p class="post-content">I don't see that NSIS or InstallOptions are having problems to set a default folder for SHBrowseForFolder (I did not take a look at the sourcecode). Even Delphi calls this function and it behaves like expected. I don't know how NSIS or InstallOptions are doing this, but Delphi seems to use SendMessage to select the folder [SendMessage(Wnd,BFFM_SETSELECTION,Longint(True),Longint(PChar(TBrowseFolderDlg(Data).FolderName))); in unit BrowseDlg]. Forgive me my insisting...</p>
                </div>
                <hr>

                <div class="post">
                  <p class="post-meta"><span class="post-author text-primary">deguix</span><br>
                  <span class="post-time small text-muted">16th August 2005 17:26 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                  <p class="post-content">Oh, I forgot to see the browse callback function, probably there is a way to select it after all. Thanks for giving me the crucial hint (BFFM_SETSELECTION). And I think the problem only happens with IOEx, because this SendMessage was already in the code... I don't like when this happens.</p>
                </div>
                <hr>

                <div class="post">
                  <p class="post-meta"><span class="post-author text-primary">goldy1064</span><br>
                  <span class="post-time small text-muted">16th August 2005 18:09 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                  <p class="post-content">I'm not sure if I found a bug or not, but whenever I try to set the label or link fields (at run-time) in Japanese, the Japanese text doesn't come out right. I have all my files (nsi,nsh,ini) in Shift-JIS. I commented in <a href="http://forums.winamp.com/showthread.php?s=&amp;threadid=224042" target="_blank">here</a> but I wasn't sure if it also applied here.<br>
                  <br>
                  Thanks.</p>
                </div>
                <hr>

                <div class="post">
                  <p class="post-meta"><span class="post-author text-primary">deguix</span><br>
                  <span class="post-time small text-muted">16th August 2005 18:16 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                  <p class="post-content">Can you post a screenshot about the characters appear? IOEx supports only calls ANSI functions and it doesn't support Unicode.</p>
                </div>
                <hr>

                <div class="post">
                  <p class="post-meta"><span class="post-author text-primary">goldy1064</span><br>
                  <span class="post-time small text-muted">16th August 2005 18:55 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                  <p class="post-content">Unfortunately I cannot post a screenshot because of work. The characters that do appear are Japanese, but they're not the ones that are suppose to be appearing.<br>
                  <br>
                  The weird thing, I thought, was that when I do a SetFont on the labels and links between init and show, the Japanese appears correct, but only on English WinXP running in Japanese.<br>
                  <br>
                  Here is an example of one field from the ini file and the corresponding code that sets it in the script.<br>
                  <br></p>
                  <pre>
<code><br>[Field 1]<br>Type=Link<br>Text=<br>Left=54<br>Right=188<br>Top=8<br>Bottom=22<br>Width=<br>Height=<br>Notify=ONCLICK<br>TxtColor=0x000000<br>BgColor=0xE9E8E5<br>NotifyCursor=HAND<br></code>
</pre><br>
                  <pre>
<code><br>LangString localizedString ${LANG_ENGLISH} "english"<br>LangString localizedString ${LANG_JAPANESE} "japanese"<br>...<br>WriteINIStr "$PLUGINSDIR\install_menu.ini" "Field 1" "Text" "$(localizedString)"<br>...<br>Function MenuPre<br>  Push $HWND<br>  InstallOptionsEx::initDialog /NOUNLOAD $PLUGINSDIR\install_menu.ini<br>  Pop $HWND ; HWND of window<br>  GetDlgItem $R0 $HWND 1200<br>  SendMessage $R0 ${WM_SETFONT} $MyFont 1<br>  InstallOptionsEx::show<br>FunctionEnd<br></code>
</pre><br>
                  The font is being set correctly. The langstring for japanese actually has Japanese in it. And I've saved all of my script files, ini files, etc. as Shift-JIS encoding.<br>
                  <br>
                  Thanks for the help.
                </div>
                <hr>

                <div class="post">
                  <p class="post-meta"><span class="post-author text-primary">deguix</span><br>
                  <span class="post-time small text-muted">16th August 2005 19:37 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                  <p class="post-content"></p>

                  <blockquote>
                    The weird thing, I thought, was that when I do a SetFont on the labels and links between init and show, the Japanese appears correct, but only on English WinXP running in Japanese.
                  </blockquote>Hmmm... this problem doesn't appear to be an IOEx issue. IOEx uses the exact font from the main window, which is from NSIS itself.<br>
                  <br>
                  I might know what this problem really is though, <i>SetFont</i> sets the charset to the default ANSI charset. You should use System plug-in and call the "CreateFont" from the Windows API with the SHIFTJIS_CHARSET charset for the font to show correctly. There is a thread talking about this:<br>
                  <br>
                  <a href="http://forums.winamp.com/showthread.php?s=&amp;threadid=219310&amp;highlight=SetFont" target="_blank">http://forums.winamp.com/showthread....hlight=SetFont</a>
                </div>
                <hr>

                <div class="post">
                  <p class="post-meta"><span class="post-author text-primary">goldy1064</span><br>
                  <span class="post-time small text-muted">16th August 2005 21:50 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                  <p class="post-content">I had had the system plug-in and call to CreateFont (based from that thread) and didn't think about changing the charset. However, I was using the DEFAULT_CHARSET, which should have worked on a Japanese system, right? Anyways, I changed it to:<br></p>
                  <pre>
<code><br>!define DEFAULT_CHARSET 0x01<br>!define SHIFTJIS_CHARSET 0x80<br>${If} $LANGUAGE == ${LANG_JAPANESE}<br>  StrCpy $CharSet ${SHIFTJIS_CHARSET}<br>${Else}<br>  StrCpy $CharSet ${DEFAULT_CHARSET}<br>${EndIf}<br>System::Call "gdi32::CreateFont(i 0, i 0, i 0, i 0, i 0, \<br>                i 0, i 0, i 0, i $CharSet, i ${OUT_DEFAULT_PRECIS}, \<br>                i ${CLIP_DEFAULT_PRECIS}, i ${DEFAULT_QUALITY}, \<br>                i ${DEFAULT_PITCH}, t 'Sans Serif') i .r0"<br></code>
</pre><br>
                  This doesn't work either. It will still change appropriately on my English WinXP system, but my Japanese WinXP system, still doesn't show correct Japanese.<br>
                  <br>
                  Thanks.<br>
                  <br>
                  EDIT:<br>
                  Also, the title bar caption and the button I have don't change on the English WinXP (ever). Is this because of how Windows works?
                </div>
                <hr>

                <div class="post">
                  <p class="post-meta"><span class="post-author text-primary">goldy1064</span><br>
                  <span class="post-time small text-muted">17th August 2005 23:18 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                  <p class="post-content">Well, I just tested IO vs IOEx with only a custom page and one button. The results: IO displayed correct Japanese on Japanese machine and IOEx displayed the word "2Button" instead of Japanese text on Japanese machine.<br>
                  <br>
                  If you need more information, just let me know.</p>
                </div>
                <hr>

                <div class="post">
                  <p class="post-meta"><span class="post-author text-primary">deguix</span><br>
                  <span class="post-time small text-muted">19th August 2005 12:56 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                  <p class="post-content">Could you test your code with the older versions published here? This might give me enough of a hint to correct your problem. Report to me which versions of IOEx work in the Japanese computer correctly. It would be even better if you fixed IOEx from there and sent me a patch to include in the next version (which should be posted here).</p>
                </div>
                <hr>

                <div class="post">
                  <p class="post-meta"><span class="post-author text-primary">Yathosho</span><br>
                  <span class="post-time small text-muted">19th August 2005 16:01 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                  <p class="post-content">can you estimate, when the "\|" escape character will be implemented?</p>
                </div>
                <hr>

                <div class="post">
                  <p class="post-meta"><span class="post-author text-primary">Fromcat</span><br>
                  <span class="post-time small text-muted">19th August 2005 16:17 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                  <p class="post-content">how can i display a dollar sign ($)? I looked at the code and it seems that $$ should do it, but it doesn't. am i missing something here?</p>
                </div>
                <hr>

                <div class="post">
                  <p class="post-meta"><span class="post-author text-primary">fromcat</span><br>
                  <span class="post-time small text-muted">19th August 2005 16:25 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                  <p class="post-content">also, in void WINAPI ConvertVariables(char *str) {<br>
                  p3 = getuservariable(myatoi(p1));<br>
                  while(*p3) {<br>
                  <br>
                  should check p3 before dereferencing. I can cause a crash by putting $R119 in a text label, causing p3 to be null.</p>
                </div>
                <hr>

                <div class="post">
                  <p class="post-meta"><span class="post-author text-primary">fromcat</span><br>
                  <span class="post-time small text-muted">19th August 2005 16:30 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                  <p class="post-content">ok, so i've been diving into the code and it seems the problem is the $$ is being converted twice<br>
                  <br>
                  ln 1680<br>
                  // Label Text - convert newline<br>
                  pField-&gt;pszText = myGetProfileStringDup("TEXT");<br>
                  <br>
                  is called<br>
                  <br>
                  which calls<br>
                  myGetProfileString()<br>
                  <br>
                  which calls<br>
                  ConvertVariables()<br>
                  <br>
                  then after that returns it calls ConvertVariables() again!</p>
                </div>
                <hr>

                <div class="post">
                  <p class="post-meta"><span class="post-author text-primary">fromcat</span><br>
                  <span class="post-time small text-muted">19th August 2005 16:32 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                  <p class="post-content">also, quick workaround, to get a $<br>
                  use $$$$ :)</p>
                </div>
                <hr>

                <div class="post">
                  <p class="post-meta"><span class="post-author text-primary">goldy1064</span><br>
                  <span class="post-time small text-muted">19th August 2005 17:33 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                  <p class="post-content">I didn't have time to look through all of the IOEx code to try and figure out where the fix should go because all I needed to expand off of IO was clickable bitmaps with a hand cursor for rollover, which was a quick fix.<br>
                  <br>
                  I did check back all the way to the 3/05 release of IOEx and that still wouldn't correctly display Japanese text. I'll keep looking back till I find something that does it correctly.</p>
                </div>
                <hr>

                <div class="post">
                  <p class="post-meta"><span class="post-author text-primary">Yathosho</span><br>
                  <span class="post-time small text-muted">19th August 2005 17:55 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                  <p class="post-content">there's an edit button too</p>
                </div>
                <hr>

                <div class="post">
                  <p class="post-meta"><span class="post-author text-primary">deguix</span><br>
                  <span class="post-time small text-muted">19th August 2005 18:31 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                  <p class="post-content"></p>

                  <blockquote>
                    ok, so i've been diving into the code and it seems the problem is the $$ is being converted twice
                  </blockquote>I fixed this region for the next version. It was really being called twice, and I fixed other small bugs also. But first, I need to finish the implementation of RichText control.<br>
                  <br>
                  I still think there should be only one starting escape character, not "$", but "\", because putting "$$" is probably making the text for those who use "$$" complicated... and the "\\" is already considered a "\", so I could also make "\r9" to be considered equals to $R9 in NSIS. But this is just an opinion...<br>
                  <br>

                  <blockquote>
                    I didn't have time to look through all of the IOEx code to try and figure out where the fix should go because all I needed to expand off of IO was clickable bitmaps with a hand cursor for rollover, which was a quick fix.
                  </blockquote>Did you try <i>NotifyCursor</i>?<br>
                  <br>
                  The other things that I added (yes added) in the next version are:<br>
                  - the combination of all image controls into just one control called "Image" (even "Animation" control got in, because it shows animation of images without sound).<br>
                  - added new image types using OLE and others using GDI+.<br>
                  - adjustment of the size of all buffers ("BufferSize" value name for "Settings" section), which made easier to discover fixes related to memory allocation/destruction (like the two ConvertVariables one).
                </div>
                <hr>

                <div class="post">
                  <p class="post-meta"><span class="post-author text-primary">goldy1064</span><br>
                  <span class="post-time small text-muted">19th August 2005 20:12 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                  <p class="post-content"></p>

                  <blockquote>
                    Did you try <i>NotifyCursor</i>?
                  </blockquote>Yes, but I <b>HAD</b> to have Japanese text working and IOEx wasn't supporting Japanese, which was why I had to revert back to IO and modify it to my needs. I'll try and figure out why (when I have time but I had a deadline...).
                </div>
                <hr>

                <div class="post">
                  <p class="post-meta"><span class="post-author text-primary">deguix</span><br>
                  <span class="post-time small text-muted">20th August 2005 05:51 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                  <p class="post-content">That's why it's said IOEx is a beta... until I'm satisfied with the features. That is, not really soon...</p>

                  <blockquote>
                    should check p3 before dereferencing. I can cause a crash by putting $R119 in a text label, causing p3 to be null.
                  </blockquote>I fixed that by adding a new variable called <i>p4</i>. This does the job done by <i>p1</i>, except that it correctly holds the variable number used by <i>getuservariable</i> function. <i>myatoi</i> function gets the entire number value that appears first, and so as in your example, the variable $INSTDIR would be used (10+11 = 21 = INST_INSTDIR -&gt; see defines in NSIS\Contrib\ExDLL\exdll.h).<br>
                  <br>
                  EDIT: I still need to check the existance of the variable though. I don't know how NSIS works totally, but it appears that $INSTDIR is not initialized when nothing is assigned to it.<br>
                  <br>
                  Thanks for the bug report.
                </div>
                <hr>

                <div class="post">
                  <p class="post-meta"><span class="post-author text-primary">niteflyer</span><br>
                  <span class="post-time small text-muted">23rd August 2005 18:58 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                  <p class="post-content"><strong>2 bugs in notify system</strong><br>
                  1) A click on a DirRequester-Button generates two notifies after the selection of a folder with the BrowseDialog: the first event notifies me of a change in the associated textcomponent (that's ok), and the second one notifies me of a click on the NextButton, which I did not touch - this is not ok. Cancelling the BrowseDialog generates only one notify (for the browsebutton).<br>
                  <br>
                  2) ONTEXTUPDATE does not generate a notify for a textcomponent. I have used ONTEXTCHANGE instead, which works for me, because STATE reflects the input after the keystroke - in contradiction to the documentation - so that it behaves like ONTEXTUPDATE should do.<br>
                  <br>
                  See the attached Testpage...<br>
                  <br>
                  By the way: I had some unreproducable exceptions, when going back to the custom page and opening the BrowseDialog for the 2nd or 3rd time.</p>
                </div>
                <hr>

                <div class="post">
                  <p class="post-meta"><span class="post-author text-primary">deguix</span><br>
                  <span class="post-time small text-muted">24th August 2005 10:28 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                  <p class="post-content">1) This is not a bug. If you go to the next page, then the page has to be saved and it calls the callback function normally, like IO's default. I'll treat this as a feature request.<br>
                  <br>
                  EDIT: I mean, a feature request for the implementation of notification flags for pages.<br>
                  <br>
                  2) Fixed. The docs I still need to fix.<br>
                  <br>
                  EDIT: Fixed. Note: The control always updates the text before sending the notification. The plugin doesn't handle aborting the new text operation at the moment when setting ONTEXTUPDATE.<br>
                  <br>
                  3) I'm trying to verify if there are more buffer problems with the plug-in accumulated from older versions. Just see previous comments from other people here. With the addition of BufferSize for Settings section, this can be verified easily.</p>
                </div>
                <hr>

                <div class="post">
                  <p class="post-meta"><span class="post-author text-primary">deguix</span><br>
                  <span class="post-time small text-muted">24th August 2005 13:53 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                  <p class="post-content">1) Hmmm... interesting problem. I verified your example again and I concluded that IOEx supports only 1 notification flag activation at a time. Another bug report for mee. There are just so many... :(<br>
                  <br>
                  Curiosity: I just saw the size of InstallOptions.cpp of the IOEx source, and I'm impressed of how much code has been added since lastest IO version:<br>
                  <br>
                  IO's: 48.6 KB.<br>
                  IOEx's: 220 KB.<br>
                  <br>
                  :eek:! 171.4 KB of difference! It's about 5x bigger than IO's! :D. Hmmm... I wonder where I spent all that time to get that mountain of code... :confused:</p>
                </div>
                <hr>

                <div class="post">
                  <p class="post-meta"><span class="post-author text-primary">niteflyer</span><br>
                  <span class="post-time small text-muted">24th August 2005 15:14 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                  <p class="post-content">Thank you for looking once more after it, because I did not understand answer. Regarding bug #1: the problem is, that I did not click the nextbutton! I have only selected a directory with the BrowseDialog but I want to stay on the current custompage, because in my project there will be more components on the same page. The solution would be an onclick-notify for "Field 2" (instead for field 0) regardless whether I've clicked 'OK' or 'Cancel' in the BrowseDialog. A notify for "Field 0" should only happen when I've clicked on the nextbutton...<br>
                  <br>
                  For an example, I have modified ioex.nsi to enable the nextbutton only when all textcomponents have an even number of characters. Maybe you can see my problem now...</p>
                </div>
                <hr>

                <div class="post">
                  <p class="post-meta"><span class="post-author text-primary">deguix</span><br>
                  <span class="post-time small text-muted">24th August 2005 15:48 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                  <p class="post-content">1) That's the "1 notification flag activation at a time" bug. As I said, I'll fix that later. No need for extra explainations.</p>
                </div>
                <hr>

                <div class="post">
                  <p class="post-meta"><span class="post-author text-primary">fer2000</span><br>
                  <span class="post-time small text-muted">31st August 2005 11:40 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                  <p class="post-content">A bug report:<br>
                  <br>
                  In InstallOptionsEx 2.4.2.b4, TxtAlign doesn't work if you don't set TxtColor to some value.<br>
                  For example:<br>
                  <br>
                  [Field 1]<br>
                  Type=Label<br>
                  Text=Hello<br>
                  Left=0<br>
                  Right=130<br>
                  Top=80<br>
                  Bottom=88<br>
                  TxtAlign=RIGHT<br>
                  TxtColor=0x0<br>
                  <br>
                  This works and the text is right aligned, but without the line TxtColor=0x0 the text is left aligned.<br>
                  <br>
                  Regards</p>
                </div>
                <hr>

                <div class="post">
                  <p class="post-meta"><span class="post-author text-primary">deguix</span><br>
                  <span class="post-time small text-muted">31st August 2005 22:16 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                  <p class="post-content">I'll verify when I get time to do it. I'm back to school, so it's harder to use the computers at home, principally because most of the time to develop IOEx is at the morning, and school takes part of that + a part of the afternoon, and the other person uses the computer for the rest of the day and night (until 4 o'clock in the morning). I'm sure he has a lot to do by the amount of time I give.<br>
                  <br>
                  I guess the problem happens because the plug-in doesn't set the flags on the control directly. It just aligns the text when it's customly drawn, making it not to work on non-custom drawn labels. It's seems easy to fix with a code change for me.</p>
                </div>
                <hr>

                <div class="post">
                  <p class="post-meta"><span class="post-author text-primary">deguix</span><br>
                  <span class="post-time small text-muted">2nd September 2005 15:01 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                  <p class="post-content">I have fixed this in the next version. Thank you for the bug report.</p>
                </div>
                <hr>

                <div class="post">
                  <p class="post-meta"><span class="post-author text-primary">Yathosho</span><br>
                  <span class="post-time small text-muted">2nd September 2005 15:37 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                  <p class="post-content"><b>@deguix</b>: asked this before, but i guess it was looked over after those many replies by fromcat. can you estimate when the "\|" escape character will be implemented? just so i can plan ahead.</p>
                </div>
                <hr>

                <div class="post">
                  <p class="post-meta"><span class="post-author text-primary">deguix</span><br>
                  <span class="post-time small text-muted">2nd September 2005 16:14 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                  <p class="post-content">Oh, sorry for not answering that before. I plan to add it to the next version, but I'm unsure of the quality of the implementation. The next version will be launched within this month (that's what I say instead of saying next 2 weeks). The new features are costing some annoying bugs in the code, which need to be fixed before release. The readme was not even touched, with the exception of the change log. So you see how I'm going...<br>
                  <br>
                  Do you have any time limits for this? I could make sure that I do things as fast as I can if you want me to.</p>
                </div>
                <hr>

                <div class="post">
                  <p class="post-meta"><span class="post-author text-primary">Yathosho</span><br>
                  <span class="post-time small text-muted">2nd September 2005 20:50 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                  <p class="post-content"></p>

                  <blockquote>
                    <i>Originally posted by deguix</i><br>
                    <b>Do you have any time limits for this? I could make sure that I do things as fast as I can if you want me to.</b>
                  </blockquote>thanks, but that's not necessary. just had to decide if i should release another beta or the final version (which would require that feature). knowing that i got some more time, i will just release another beta of my software.
                </div>
                <hr>

                <div class="post">
                  <p class="post-meta"><span class="post-author text-primary">fer2000</span><br>
                  <span class="post-time small text-muted">2nd September 2005 23:31 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                  <p class="post-content">I found another bug:<br>
                  <br>
                  In InstallOptionsEx 2.4.2.b4, if you use an IPAddress control with Flags=DISABLED, the control is not editable, ok, but it doesn't appear grayed out.<br>
                  <br>
                  Thanks, regards</p>
                </div>
                <hr>

                <div class="post">
                  <p class="post-meta"><span class="post-author text-primary">deguix</span><br>
                  <span class="post-time small text-muted">5th September 2005 10:36 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                  <p class="post-content">I don't know why the OS doesn't gray it out, but I can't do this right now. If there was an example on the web that shows how to implement this, then I would probably find a way to include it in the plug-in. I probably don't have enough knowledge to judge how to implement that.</p>
                </div>
                <hr>

                <div class="post">
                  <p class="post-meta"><span class="post-author text-primary">deguix</span><br>
                  <span class="post-time small text-muted">10th September 2005 05:38 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                  <p class="post-content">The "\|" (and "\{", "\}") feature was added. Any more small features/bug fixes/patches to include into the next version?<br>
                  <br>
                  I'm already thinking: "What am I going to do for 2.4.2 beta 6 right now?". Plenty of code revamp I would say. The code is getting messier and messier, and so huge... I need to split everything up for clarity. Maybe using a .cpp file for every control? This would make implementations for new controls easier.</p>
                </div>
                <hr>

                <div class="post">
                  <p class="post-meta"><span class="post-author text-primary">deguix</span><br>
                  <span class="post-time small text-muted">26th September 2005 06:52 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                  <p class="post-content">Maybe this time the release will be even slower than what I expected. I simply hated my previous implementation, but now it's a lot easier to split items of arrays.<br>
                  <br>
                  Yathosho, don't worry about IOEx due dates for releases. I always miscalculate due dates and this is how I'm. It's never ready in time... :( but always has something of better quality than expected in it... :)</p>
                </div>
                <hr>

                <div class="post">
                  <p class="post-meta"><span class="post-author text-primary">NeoAlus</span><br>
                  <span class="post-time small text-muted">30th September 2005 13:44 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                  <p class="post-content">I think my last post was swallowed. If not, I apologize for the duplicate.<br>
                  <br>
                  There was a bug in this function, where in the case of ListItems with variables after ConvertVariables() was called, the old string length nSize was returned. This lead to crashes and string truncation.<br>
                  <br>
                  DWORD WINAPI myGetProfileString(LPCTSTR lpKeyName)<br>
                  {<br>
                  *szResult = '\0';<br>
                  int nSize = GetPrivateProfileString(pszAppName, lpKeyName, "", szResult, BUFFER_SIZE, pszFilename);<br>
                  if (nSize &gt; 0)<br>
                  {<br>
                  ConvertVariables(szResult);<br>
                  nSize = lstrlen(szResult);<br>
                  }<br>
                  return nSize;<br>
                  }<br>
                  <br>
                  Also, closing a DIRREQUEST dialog in any way - 'x', 'cancel or 'ok' - seems to send a State=0 and Notify=ONNEXT to the main validation function, but not all the time - only if it's one of the first things you do on the page.<br>
                  <br>
                  Lastly, the default MUI/NSIS directory page shows disk usage requirements and free space. Is there access to those variables from inside IOex or NSIS?</p>
                </div>
                <hr>

                <div class="post">
                  <p class="post-meta"><span class="post-author text-primary">deguix</span><br>
                  <span class="post-time small text-muted">30th September 2005 22:33 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                  <p class="post-content">I made several changes now to ListItems, the buffer allocation... I need to review my changes, but from what I did up to now, all those bugs you said are fixed for the next version.<br>
                  <br>
                  Now, about the question, there are no NSIS variables for retrieving that information. You have to get them on your on using NSIS. Now NSIS questions shouldn't be in this thread.</p>
                </div>
                <hr>

                <div class="post">
                  <p class="post-meta"><span class="post-author text-primary">NeoAlus</span><br>
                  <span class="post-time small text-muted">6th October 2005 05:27 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                  <p class="post-content">I hate to ask you for a release when you're not ready, I hate when people ask me for that too.<br>
                  So, can you give me a hint on the DIRREQUEST closing bug? I'm trying to push out a new installer on Friday and it's the only piece looming over my head.</p>
                </div>
                <hr>

                <div class="post">
                  <p class="post-meta"><span class="post-author text-primary">deguix</span><br>
                  <span class="post-time small text-muted">6th October 2005 11:46 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                  <p class="post-content">Ok, I'll release it tomorrow morning with untested parts of the plug-in.</p>
                </div>
                <hr>
                
                
                

                <div class="container">
                  

                  <ol class="breadcrumb">
                    <li><a href="../index.html" class="glyphicon glyphicon-home"></a></li>

                    <li><a href="f-65.html">NSIS Discussion</a></li>

                    <li class="active">InstallOptionsEx</li>
                  </ol>

                  <p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=181087">InstallOptionsEx</a></p><br>

                  <div class="post">
                    <p class="post-meta"><span class="post-author text-primary">deguix</span><br>
                    <span class="post-time small text-muted">7th October 2005 21:07 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                    <p class="post-content"><strong>InstallOptionsEx 2.4.2 beta 5 - DLL + Source</strong><br>
                    Hmmm... this was not completed in today morning, but I wasn't satisfied to release it with annoying bugs, so I spend the time fixing some more bugs...<br>
                    <br>
                    Also, as you may have noticed, the files for all versions for IOEx are hosted in the NSIS Wiki now. After the first stable build is released, all of them will be deleted (or at least I think so).<br>
                    <br>
                    This version brings a lot of big changes. In this version, RichText and Image controls were implemented, along with the BufferSize key name for "Settings" section, the new notification queuing and escape characters for "|", "{" and "}", and more types of images. Other changes include:<br></p>

                    <ul>
                      <li>Added <i>RichText</i> control.</li>

                      <li>Added <i>BufferSize</i> value name for <i>Settings</i> section. A note though, everything, including <i>Type</i> value for all fields are affected.</li>

                      <li>Added <i>ReadOnlyTxtColor</i> and <i>ReadOnlyBgColor</i> value names for <i>Text</i> and <i>RichText</i> controls.</li>

                      <li>Added <i>ONTEXTSELCHANGE</i> notification flag for <i>RichText</i> controls.</li>

                      <li><i>Bitmap</i>, <i>Icon</i> and <i>Animation</i> controls have now fused together into a control called <i>Image</i>. The old control names are still supported for compatibility.</li>

                      <li><i>Image</i> controls now use GDI+ or OLE when needed. So there are new file types supported: .jpg, .jpeg, .gif (GDI+ or OLE), .png, .tiff, .wmf, .emf (GDI+ only).</li>

                      <li><b>Older INI files braking notice:</b> Renamed icon names for <i>ToolTipIcon</i> value name to <i>INFORMATION</i>,<i>EXCLAMATION</i> and <i>STOP</i>, as defined under the icon resources for the <i>State</i> value name for <i>Image</i> controls.</li>

                      <li>Added "\|" escape characters for <i>ListBox</i>, <i>DropList</i>, <i>ComboBox</i> controls.This applies to list based value names only.</li>

                      <li>Added "\|", "\{" and "\}" escape characters for <i>ListView</i> and <i>TreeView</i> controls. This applies to list based value names that do not use just numbers only.</li>

                      <li>Fixed internal memory leaks and bugs.</li>

                      <li>For <i>Link</i> and <i>Button</i> controls using <i>DIRREQUEST</i> flag:</li>
                    </ul>

                    <ol style="list-style-type: upper-alpha">
                      <li>Fixed the non-disabling "OK" button when a non-folder item was selected (like My Computer).</li>

                      <li>Added ability for the <i>State</i> INI value name to specify the initial folder shown in the <i>DIRREQUEST</i> dialog.</li>
                    </ol>

                    <ul>
                      <li>Now <i>FONTREQUEST</i> and <i>COLORREQUEST</i> flags for <i>Button</i> and <i>Link</i> controls output the control state even if a value is specified for the <i>RefFields</i> value name.</li>

                      <li>Fixed string not being truncated at the maximum buffer size allowed when <i>Text</i> and <i>Password</i> controls returned (IO bug).</li>

                      <li>Fixed <i>Link</i> and <i>Button</i> controls with <i>DIRREQUEST</i> flag: "|" character was appended everytime to the end of <i>ListItems</i> value name.</li>

                      <li>Corrected the formula to convert pixels into points for <i>Link</i> and <i>Button</i> controls with <i>FONTREQUEST</i> flag.</li>

                      <li>Fixed <i>Link</i> and <i>Button</i> controls <i>State</i> value name return value when used with <i>FILE_OPENREQUEST</i> and <i>MULTISELECT</i> flags: String was truncated to the first 1023 characters (1024 w/ the terminator character).</li>

                      <li><i>State</i> INI value name for <i>ComboBox</i> controls now uses the text specified for the state if it is not one of the items specified in <i>ListItems</i>.</li>

                      <li><i>HSCROLL</i> and <i>VSCROLL</i> flags won't work anymore if specified for controls that do not support this flag. The effect is simply useless.</li>

                      <li>Re-added <i>EXTENDEDSELCT</i> and <i>REQ_SAVE</i> flags for compatibility purposes with IO.</li>

                      <li>Fixed bugs #<a href="http://sourceforge.net/tracker/index.php?func=detail&amp;aid=1287731&amp;group_id=22049&amp;atid=373085" target="_blank">1287731</a> and #<a href="http://sourceforge.net/tracker/index.php?func=detail&amp;aid=1283528&amp;group_id=22049&amp;atid=373085" target="_blank">1283528</a>.</li>
                    </ul><br>
                    I didn't have much time to test everything, but now you have a chance to test what's new. Also, I still need to implement flags for the <i>Image</i> control and some more code for transparency.<br>
                    <br>
                    One more thing, I couldn't put support for "\\" characters for most of the controls that support the use of a list of items for input and/or output. I might be able to add that to the next version later.<br>
                    <br>
                    <b>To download IOEx, go to <a href="http://nsis.sf.net/wiki/InstallOptionsEx" target="_blank">InstallOptionsEx wiki page</a></b>
                  </div>
                  <hr>

                  <div class="post">
                    <p class="post-meta"><span class="post-author text-primary">Jamyn</span><br>
                    <span class="post-time small text-muted">7th October 2005 21:10 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                    <p class="post-content"><strong>Background of Welcome/Finish</strong><br></p>

                    <blockquote>
                      Posted by Deliverator on 08-22-2004 11:52 PM:<br>
                      <br>
                      When using this with the Modern UI my Welcome and Finish pages are not displayed correctly.<br>
                      <br>
                      The background of the window is gray, and the background of the text is white.<br>
                      <br>
                      What am I doing wrong?
                    </blockquote>It seems this problem is back again? When replacing InstallOptions.dll with InstallOptionsEx.dll, the background of the page is not rendered correctly. I have attached a screenshot of:<br>
                    <br>
                    NSIS\Examples\Modern UI\WelcomeFinish.nsi<br>
                    <br>
                    Picture 1: With standard InstallOptions.<br>
                    Picture 2: With InstallOptionsEX<br>
                    <br>
                    I know it has already been stated that ModernUI may not work with InstallOptionsEX for various things, but I hope this particular problem may be fixed in the future? InstallOptionsEX has many features I like to use :) Thanks very much for writing it, by the way.<br>
                    <br>
                    (PS: I tried to manually set the background color with<br>
                    <br>
                    SetCtlColors $MUI_HWND "" "${MUI_BGCOLOR}"<br>
                    GetDlgItem $MUI_TEMP1 $MUI_HWND 1203<br>
                    SetCtlColors $MUI_TEMP1 "" "${MUI_BGCOLOR}"<br>
                    [...]<br>
                    <br>
                    But it does not seem to fix the issue.
                  </div>
                  <hr>

                  <div class="post">
                    <p class="post-meta"><span class="post-author text-primary">deguix</span><br>
                    <span class="post-time small text-muted">7th October 2005 21:50 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                    <p class="post-content">I still didn't update the file. I have to upload every single file from this thread to wiki yet. You were downloading an older version of IOEx. I didn't think it would take that long to upload all those files, but now I know. Sorry if I didn't tell you that before...</p>
                  </div>
                  <hr>

                  <div class="post">
                    <p class="post-meta"><span class="post-author text-primary">deguix</span><br>
                    <span class="post-time small text-muted">7th October 2005 22:11 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                    <p class="post-content">Now it's ok to download, but I didn't upload older versions to wiki. This is still not a big issue. If you want older versions, just search the thread.</p>
                  </div>
                  <hr>

                  <div class="post">
                    <p class="post-meta"><span class="post-author text-primary">NeoAlus</span><br>
                    <span class="post-time small text-muted">8th October 2005 00:57 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                    <p class="post-content">The new version works great, thanks. A few notes:<br>
                    <br>
                    I thought the ComboBox (DropList) control had a broken pulldown menu on Windows 98. But it's a common problem, and here's the scoop:<br>
                    <br>
                    "The reason is that when you specify the height of the control, you are specifying it's height when OPEN not when closed. ... you can use SetWindowPos() to increase the height, or specify a greater height when creating it in the first place."<br>
                    <br>
                    Specifying a greater height in the .ini works as expected.<br>
                    <br>
                    msvs 7.1 users will need this:<br>
                    <br>
                    #ifndef USER_TIMER_MAXIMUM<br>
                    #define USER_TIMER_MAXIMUM 0x7FFFFFFF<br>
                    #endif<br>
                    #ifndef USER_TIMER_MINIMUM<br>
                    #define USER_TIMER_MINIMUM 0x0000000A<br>
                    #endif<br>
                    <br>
                    There's an alternative, which is to set the winver I think, but the above works just fine.</p>
                  </div>
                  <hr>

                  <div class="post">
                    <p class="post-meta"><span class="post-author text-primary">Yathosho</span><br>
                    <span class="post-time small text-muted">8th October 2005 03:53 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                    <p class="post-content">i don't quite understand how to use the "\|" escape characters. i also think the more feature are getting implemented, the more the overview of the documentation suffers.</p>
                  </div>
                  <hr>

                  <div class="post">
                    <p class="post-meta"><span class="post-author text-primary">deguix</span><br>
                    <span class="post-time small text-muted">8th October 2005 08:24 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                    <p class="post-content">Hehe. Don't blame me. Maintaining both plug-in and documentation is quite difficult.<br>
                    <br>
                    This escape character only works for any value name which supports to input or output a list of items. A list of items is a list containing items that has the "|" character basically separating them (there are also some which use "{" and "}").<br>
                    <br>
                    One exception for this is when a value name supports to input or output a list of items with only numbers, because there are only numbers + the "|" character allowed in there. "\|" is not a number.<br>
                    <br>
                    When you use it in those conditions stated above, it results into a "|" character.<br>
                    <br>
                    Common example: "ListItems" value name.<br>
                    <br>
                    The use for "\{" and "\}" is even more complicated. They only work for those values that actually use "{" and "}". Example: "State" value name for <i>ListView</i> and <i>TreeView</i> controls.<br>
                    <br>
                    Also, don't forget that "\\", "\n" and "\r" are not supported on most of the value names supporting list of items as input or output, except for "ListItems" and "State" value names for <i>ComboBox</i> and <i>DropList</i> controls. The "\\" -&gt; "\" effect is applied before the "\|" -&gt; "|" effect is applied. This is the thing that I should fix in the next version.<br>
                    <br>
                    One "simple" code example of the usage:</p>
                    <pre>
<code>[Field 1]<br>Type=TreeView<br>Left=0<br>Right=-1<br>Top=0<br>Bottom=-1<br>ListItems=\{\\\|A\|\\\}{\{\\\|A1\|\\\}|\{\\\|A2\|\\\}}\{\\\|B\|\\\}<br>State=0{1|2}3<br>Flags=CHECKBOXES<br>StateImageList=C:\Dev\NSIS Source\Contrib\Graphics\Checks\modern.bmp<br></code>
</pre>You can't apply this to the "State" value name in this case because the <i>CHECKBOXES</i> flag turns it into a "number-only" list of items. Also, see that the "\\" -&gt; "\" transformation doesn't happen in there.<br>
                    <br>
                    Just a note: you always should use the flag <i>CHECKBOXES</i> w/ the <i>StateImageList</i> value name, or the flag won't work. Also the file has to exist, so you should change the path first.<br>
                    <br>
                    <b>BUG:</b> When <i>StateImageList</i> points to an invalid file, it still applies the <i>CHECKBOXES</i> flag normally. This flag uses the default checkboxes when this happens. Those checkboxes don't have the features this <i>TreeView</i> control has.
                  </div>
                  <hr>

                  <div class="post">
                    <p class="post-meta"><span class="post-author text-primary">Yathosho</span><br>
                    <span class="post-time small text-muted">31st October 2005 12:15 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                    <p class="post-content"><strong>a feature request</strong><br>
                    would it be possible to add a feature, which allows me to specify a default directory for contols (i.e. filerequest).<br>
                    <br>
                    let's say the user has to specify a file in on of my ioex pages and that it's most likely that this file is stored in a specific directory (i.e. my documents). i would love to have the option to specify this directory, when the installer initialises. when clicking on browse (filerequest dialog), it would start browsing in that specified directory.</p>
                  </div>
                  <hr>

                  <div class="post">
                    <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br>
                    <span class="post-time small text-muted">31st October 2005 13:37 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                    <p class="post-content">I'm not sure if this would work, but you could try storing an initial path in the box (State), and get rid of the text when the page is shown (with SendMessage ... "STR:").<br>
                    <br>
                    -Stu</p>
                  </div>
                  <hr>

                  <div class="post">
                    <p class="post-meta"><span class="post-author text-primary">iceman_k</span><br>
                    <span class="post-time small text-muted">1st November 2005 15:06 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                    <p class="post-content">deguix, IMHO you should stop taking feature requests for a while and concentrate on stabilizing and documenting what you currently have.<br>
                    I want to add support for InstallOptionsEx to EclipseNSIS, but I am hesitant because IOEx is in constant flux.</p>
                  </div>
                  <hr>

                  <div class="post">
                    <p class="post-meta"><span class="post-author text-primary">deguix</span><br>
                    <span class="post-time small text-muted">2nd November 2005 00:41 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                    <p class="post-content">No problem. I'll try to fix the maximum amount of bugs that appear. There aren't many though (except in docs). But I generally find more because I have to test most of the stuff; bugs generally aren't reported to me, even with the huge amount of people that read this thread.<br>
                    <br>
                    Maybe I should put this plug-in somewhere like sourceforge. It will probably be more organized, and will support some direct feedback without cluttering the forums more than they are already... a dump of this would probably take many days.<br>
                    <br></p>

                    <blockquote>
                      would it be possible to add a feature, which allows me to specify a default directory for contols (i.e. filerequest).<br>
                      <br>
                      let's say the user has to specify a file in on of my ioex pages and that it's most likely that this file is stored in a specific directory (i.e. my documents). i would love to have the option to specify this directory, when the installer initialises. when clicking on browse (filerequest dialog), it would start browsing in that specified directory.
                    </blockquote>Well, okay... what should I do then? Put it in "ListItems" or to make the plug-in to select the path from the file path automatically by using an extra flag? If "MULTISELECT" flag is specified, would the path of the first file be used if you want me to add the extra flag feature?<br>
                    <br>
                    Could I ask you a question? Do you think the plug-in is confusing to use (except for the documentation which needs adjustments)?
                  </div>
                  <hr>

                  <div class="post">
                    <p class="post-meta"><span class="post-author text-primary">iceman_k</span><br>
                    <span class="post-time small text-muted">2nd November 2005 04:29 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                    <p class="post-content">I think moving the project to SourceForge would be a great idea. It will add more structure to your development, with clearly defined trackers for bugs, feature requests, etc. You can better manage what you are doing. Plus you get all the associated stuff for free (e.g., source control, release mechanism, etc.). Also, you may be able to recruit other developers to help out with it.<br>
                    The plugin can be overwhelming, I feel, for a new user since it has sooo much stuff in it (given that the documentation is not synced up yet).</p>
                  </div>
                  <hr>

                  <div class="post">
                    <p class="post-meta"><span class="post-author text-primary">deguix</span><br>
                    <span class="post-time small text-muted">11th November 2005 00:10 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                    <p class="post-content">Next version, 2.4.2 beta 6, is going to have removed the GPL code for allowing more types of images. Does anyone have any suggestions for a free code (no GPL, no commercial licenses) replacing the current GPL code for this? If yes, then I can include it readly. Also, part of it is not considered GPL because it was taken from another source, so I can modify it to not be a copy anymore. Thus, general support for .jpg, .jpge, and .gif image types is still on IOEx.<br>
                    <br>
                    I'll only talk about the other modifications when I release it.</p>
                  </div>
                  <hr>

                  <div class="post">
                    <p class="post-meta"><span class="post-author text-primary">Animaether</span><br>
                    <span class="post-time small text-muted">11th November 2005 00:55 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                    <p class="post-content">Just for reference, I think the last message on the GPL found its basis at :<br>
                    WINAMP.COM | Forums &gt; Developer Center &gt; NSIS Discussion &gt; Changing the form<br>
                    <a href="http://forums.winamp.com/showthread.php?threadid=230625" target="_blank">http://forums.winamp.com/showthread.php?threadid=230625</a><br>
                    -----<br>
                    GPL: <a href="http://www.gnu.org/copyleft/gpl.html" target="_blank">http://www.gnu.org/copyleft/gpl.html</a><br>
                    I don't mind the GPL so much myself - I admire its premise, actually.<br>
                    The problem, at least to me, is that I've never found it quite clear what happens when you include a -compiled- piece of GPL code in your product or distribution.<br>
                    <br>
                    I.e. if somebody were to use InstallOptionsEx with the GPL code in there, I can only imagine that it would consitute one of the two basic things..<br>
                    - you're distributing a GPL'd product<br>
                    - you're dynamically linking to a lib (the dll is 'separate' in the installer and gets extracted - so it doesn't become an integral part to the installer code itself)<br>
                    So as far as I can tell - using InstallOptionsEx with the GPL'd code in the binary doesn't mean your entire installer becomes GPL - much less so any other software you may be installing with the installer.<br>
                    <br>
                    However, it does leave questions such as :<br>
                    - do I need to include the GPL text with my installer ?<br>
                    - do I need to display that GPL code is being used ?<br>
                    - do I need to give users access to the source code of InstallOptionsEx if they were to ask for it ? and/or include it ?<br>
                    etc.<br>
                    I believe the answer to all the above is 'yes', but I'm not a lawyer :)<br>
                    <br>
                    -----<br>
                    Lastly, separate of the GPL, InstallOptionsEx has its own licensing requirement;<br>
                    "3. This notice may not be removed or altered from any distribution."<br>
                    Similar questions - where, when and how should said notice be included ? Or does it apply to distributions of the InstallOptionsEx -package- only ? i.e. doesn't apply if you're simply using the plugin in your installer.<br>
                    <br>
                    Thanks in advance :)</p>
                  </div>
                  <hr>

                  <div class="post">
                    <p class="post-meta"><span class="post-author text-primary">deguix</span><br>
                    <span class="post-time small text-muted">11th November 2005 12:25 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                    <p class="post-content">The maximum thing needed is to inform the user about IOEx and where it's source code is when there is GPL code, which is already not good for me.<br>
                    <br></p>

                    <blockquote>
                      Lastly, separate of the GPL, InstallOptionsEx has its own licensing requirement;<br>
                      "3. This notice may not be removed or altered from any distribution."<br>
                      Similar questions - where, when and how should said notice be included ? Or does it apply to distributions of the InstallOptionsEx -package- only ? i.e. doesn't apply if you're simply using the plugin in your installer.
                    </blockquote>Well, this part shows the reasoning of this:<br>

                    <blockquote>
                      [...] to alter it and redistribute it freely, subject to the following restrictions
                    </blockquote>This "and" shows that it applies only when altering the code <b>and</b> redistributing it.
                  </div>
                  <hr>

                  <div class="post">
                    <p class="post-meta"><span class="post-author text-primary">Animaether</span><br>
                    <span class="post-time small text-muted">11th November 2005 12:31 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                    <p class="post-content">Ahhh okay... I'm not a lawyer, etc. but I think phrased that way it's actually two separate terms... e.g.<br>
                    "to alter it, subject to the following restrictions"<br>
                    "to redistribute it freely, subject to the following restrictions"'<br>
                    <br>
                    The intended meaning, I *think*, would be phrased as "to alter and redistribute it freely, subject to the following restrictions"<br>
                    <br>
                    Regardless though - cool, thanks for clarification :)</p>
                  </div>
                  <hr>

                  <div class="post">
                    <p class="post-meta"><span class="post-author text-primary">deguix</span><br>
                    <span class="post-time small text-muted">12th November 2005 18:06 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                    <p class="post-content">I just forgot to say that it won't have the features I planned for it, it will be just a quick version to fix the GPL issue and some other fixes I picked up. Also, as NSIS 2.11 was released with InstallOptions version 2.44, it's going to be called "IOEx 2.44 beta 1" (Next time I should consider how I put versions on my projects, now I can only go forth to version 3 or to make patches for IO with IOEx code).</p>
                  </div>
                  <hr>

                  <div class="post">
                    <p class="post-meta"><span class="post-author text-primary">deguix</span><br>
                    <span class="post-time small text-muted">13th November 2005 16:36 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                    <p class="post-content"><strong>InstallOptionsEx 2.4.4 beta 1 - DLL + Source</strong><br>
                    New version released. No much was changed, as expected. See the full list of changes for this version:</p>

                    <ul>
                      <li>Removed GPL'd code from the plug-in. Removed support for GDI+, which in turn, removed newer systems support of .png, .tiff, and .emf files.</li>

                      <li>Added support for the key "F2" on <i>TreeView</i> and <i>ListView</i> controls.</li>

                      <li>Fixed the selection of the last item with the "End" key in a <i>ListView</i> control without the <i>CHECKBOXES</i> flag and without using <i>LargeImageList</i> INI key.</li>

                      <li>Fixed: When StateImageList points to an invalid file, it still applies the <i>CHECKBOXES</i> flag normally.</li>

                      <li>Fixed: When a label was not changed in TreeView or ListView controls that use the <i>EDITLABELS</i> flags, it was emptied.</li>
                    </ul><b>To download IOEx, go to <a href="http://nsis.sf.net/InstallOptionsEx" target="_blank">InstallOptionsEx wiki page</a></b>
                  </div>
                  <hr>

                  <div class="post">
                    <p class="post-meta"><span class="post-author text-primary">Takhir</span><br>
                    <span class="post-time small text-muted">13th November 2005 17:08 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                    <p class="post-content">BTW <a href="http://nsis.sourceforge.net/Embedded_Banner" target="_blank">this plug-in</a> supports png and other formats without GDI ;)<br>
                    May be problems with some complex variants of tiff formats on systems with old IEs (or may be not, I cannot remember this precisely in the sunday evening) :)</p>
                  </div>
                  <hr>

                  <div class="post">
                    <p class="post-meta"><span class="post-author text-primary">deguix</span><br>
                    <span class="post-time small text-muted">13th November 2005 17:29 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                    <p class="post-content">Yes, I saw your plug-in source code one time, but I didn't got the inclusion to work. I might try to do that again later, or you could submit a patch, if you can read a big amount of code... Just search for IMAGE_TYPE_OLE and you can find the current OLE implementation I have. I think your code is somewhat based on that.</p>
                  </div>
                  <hr>

                  <div class="post">
                    <p class="post-meta"><span class="post-author text-primary">nandhp</span><br>
                    <span class="post-time small text-muted">21st November 2005 20:51 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                    <p class="post-content">I have an AVI being displayed in an Image with the TRANSPARENT flag, and it's only transparent on Windows XP with XPStyle on. What do I have to do to get a transparent Animate?</p>
                  </div>
                  <hr>

                  <div class="post">
                    <p class="post-meta"><span class="post-author text-primary">deguix</span><br>
                    <span class="post-time small text-muted">21st November 2005 22:02 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                    <p class="post-content">Reproduced. I just can't understand, it works for some avi, but not for others. Does your avi have a sound channel in it and is of type "MS-RLE" of 8-bits? I've tested two avi files, one with sound w/ 8-bits "MS-RLE" type, and another without, to see if transparency went ok. The one w/ sound had this transparency problem.<br>
                    <br>
                    Maybe the new version of the control for WinXP fixes this problem. This is not mentioned in MSDN.</p>
                  </div>
                  <hr>

                  <div class="post">
                    <p class="post-meta"><span class="post-author text-primary">nandhp</span><br>
                    <span class="post-time small text-muted">22nd November 2005 10:13 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                    <p class="post-content">I'm looking at properties on the file in Windows XP and on the summary tab under "Video" it says it is an 8-bit MS-RLE, 4fps 3kbps, and under "Audio" says "4 seconds". I used the "AVIEdit" tool from some oldish version of the windows SDK to create the AVI. Does this help?<br>
                    <br>
                    <b>Edit:</b> Made a mistake, that's the wrong AVI, the one above works fine. The one that doesn't work says: Under video, the correct avi is 15fps, 1164kbps, 24 bit sample size, uncompressed. Under audio it says "2 seconds". I think I need to try converting it to MS-RLE. A 3MB AVI for 2 seconds of video is just stupid.</p>
                  </div>
                  <hr>

                  <div class="post">
                    <p class="post-meta"><span class="post-author text-primary">nandhp</span><br>
                    <span class="post-time small text-muted">24th November 2005 10:38 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                    <p class="post-content">I managed to convert it to RLE and it worked fine. The problem was I needed to convert it to 8-bit, otherwise the codec wouldn't appear. So I opened the uncompressed avi in quicktime pro, exported it as a uncompressed avi in 8-bit color, load it back into aviedit, and exported it to RLE there. Thanks quicktime!</p>
                  </div>
                  <hr>

                  <div class="post">
                    <p class="post-meta"><span class="post-author text-primary">flyakite</span><br>
                    <span class="post-time small text-muted">25th November 2005 14:42 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                    <p class="post-content">I hate asking questions that I feel I should have been able to find the answer to, but I couldn't, so I have to ask.<br>
                    <br>
                    Is there a way to change the cursor to a Hand, when it is over an Image control using a GIF image?<br>
                    <br>
                    Basically I'm using the Image control with a GIF image, and the NOTIFY=ONCLICK event to call the leave/validate function which in turn will open up a link. But I would like the cursor to be a hand, so that people realize the image is clickable.</p>
                  </div>
                  <hr>

                  <div class="post">
                    <p class="post-meta"><span class="post-author text-primary">Takhir</span><br>
                    <span class="post-time small text-muted">25th November 2005 19:36 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                    <p class="post-content"><i>Yes, I saw your plug-in source code one time, but I didn't got the inclusion to work. I might try to do that again later, or you could submit a patch, if you can read a big amount of code... Just search for IMAGE_TYPE_OLE and you can find the current OLE implementation I have. I think your code is somewhat based on that.</i><br>
                    <br>
                    Attached short 'page' sample shows how IImgCtx may be used: ownerdraw control and paint on wm_drawitem. Both Ole and Ctx support transparency, so you can skip 'window region' part for them.<br>
                    I also updated my plug-in - it's 'the best' version was lost during last archive crash.</p>
                  </div>
                  <hr>

                  <div class="post">
                    <p class="post-meta"><span class="post-author text-primary">deguix</span><br>
                    <span class="post-time small text-muted">29th November 2005 11:17 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                    <p class="post-content"></p>

                    <blockquote>
                      Is there a way to change the cursor to a Hand, when it is over an Image control using a GIF image?
                    </blockquote>Try <i>NotifyCursor=HAND</i>.<br>
                    <br>
                    Now, about the IImgCtx interface: is there anywhere a list of image types supported by the older IE versions and when this interface was started to be used on IE? This is just to know what image types it adds.
                  </div>
                  <hr>

                  <div class="post">
                    <p class="post-meta"><span class="post-author text-primary">Takhir</span><br>
                    <span class="post-time small text-muted">29th November 2005 11:40 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                    <p class="post-content">(Found in russian): It appeared in Internet Explorer 4.0 and supports BMP, GIF, JPEG, ICO, WMF, EMF, PNG, XBM, CUR, TIFF (may be others).<br>
                    About some tiff limitations I read here <a href="http://codeproject.com/bitmap/JianImgCtxDecoder.asp" target="_blank">http://codeproject.com/bitmap/JianImgCtxDecoder.asp</a></p>
                  </div>
                  <hr>

                  <div class="post">
                    <p class="post-meta"><span class="post-author text-primary">deguix</span><br>
                    <span class="post-time small text-muted">29th November 2005 19:23 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                    <p class="post-content">Thanks. I'm not working on the plug-in now, but when I will, I'll implement this.</p>
                  </div>
                  <hr>

                  <div class="post">
                    <p class="post-meta"><span class="post-author text-primary">SeanB</span><br>
                    <span class="post-time small text-muted">19th December 2005 16:48 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                    <p class="post-content">Hi - I've just downloaded the latest version of IOEx from the link given above, and I have the problem with the Welcome and Finish pages not displaying correctly. Was this not fixed? Do I have the wrong version of the file?</p>
                  </div>
                  <hr>

                  <div class="post">
                    <p class="post-meta"><span class="post-author text-primary">deguix</span><br>
                    <span class="post-time small text-muted">20th December 2005 10:52 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                    <p class="post-content">Hmmm... There are probably 2 problems in the latest version:<br>
                    - some problem when using "Text" INI key name for "Image" controls.<br>
                    - trying to color the dialog itself - which is probably unhandled by the plug-in at all.<br>
                    <br>
                    I still couldn't even start to work on features for next version though, so I can't expect it to be released even on next month. You should pretty much try to go around the problems, but right now I can't say much than just that.</p>
                  </div>
                  <hr>

                  <div class="post">
                    <p class="post-meta"><span class="post-author text-primary">michaelcsikos</span><br>
                    <span class="post-time small text-muted">21st December 2005 01:06 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                    <p class="post-content"><strong>FileRequest - Text &amp; Button example?</strong><br>
                    I can't seem to find an example anywhere of an InstallOptionsEx Text &amp; Button FileRequest dialog. Could someone please post an example .ini file? Thanks!</p>
                  </div>
                  <hr>

                  <div class="post">
                    <p class="post-meta"><span class="post-author text-primary">deguix</span><br>
                    <span class="post-time small text-muted">21st December 2005 10:44 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                    <p class="post-content"></p>
                    <pre>
<code><br>[Field 1]<br>Type=Text<br>Left=0<br>Right=100<br>Top=0<br>Bottom=10<br><br>[Field 2]<br>Type=Button<br>Text=...<br>Left=110<br>Right=125<br>Top=0<br>Bottom=10<br>Flags=OPEN_FILEREQUEST<br>RefFields=1<br>Notify=ONCLICK<br></code>
</pre>
                  </div>
                  <hr>

                  <div class="post">
                    <p class="post-meta"><span class="post-author text-primary">michaelcsikos</span><br>
                    <span class="post-time small text-muted">22nd December 2005 01:55 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                    <p class="post-content">Thanks Deguix, you're the man!<br>
                    <br>
                    I converted from IO to IOex, and now have two problems:<br>
                    <br>
                    1. For some reason the file Filter isn't working for me. It truncates the last character of the name, showing "DB Config Fil", and all files are still visible. I've tried lots of different examples, including copying directly from the readme.<br>
                    <br>
                    <font face="courier new"><font size="1">[Field 1]<br>
                    Type=Text<br>
                    Left=8<br>
                    Right=283<br>
                    Top=21<br>
                    Bottom=34<br>
                    <br>
                    [Field 2]<br>
                    Type=Button<br>
                    Text=Browse<br>
                    Left=192<br>
                    Right=242<br>
                    Top=68<br>
                    Bottom=84<br>
                    Flags=OPEN_FILEREQUEST<br>
                    Filter=DB Config File|*.xml<br>
                    RefFields=1<br>
                    Notify=ONCLICK</font></font><br>
                    <br>
                    2. When a file is selected and Open is clicked, the Installer goes to the next page immediately, instead of going back to the DBConfigXML custom page and waiting for the user to click Install.<br>
                    <br>
                    <font face="courier new"><font size="1">Function DBConfigXML<br>
                    !insertmacro MUI_HEADER_TEXT "$(TEXT_IO_TITLE)" "$(TEXT_IO_SUBTITLE)"<br>
                    Push $R0<br>
                    ${Plugin}::dialog $PLUGINSDIR\DBConfigXML.ini<br>
                    Pop $R0<br>
                    FunctionEnd<br>
                    <br>
                    Function ValidateDBConfigXML<br>
                    ReadINIStr $DB_CONFIG_FILE "$PLUGINSDIR\DBConfigXML.ini" "Field 1" "State"<br>
                    IfFileExists "$DB_CONFIG_FILE" OK<br>
                    MessageBox MB_OK|MB_ICONSTOP 'File does not exist.'<br>
                    Abort<br>
                    OK:<br>
                    FunctionEnd</font></font><br>
                    <br>
                    Thanks in advance.</p>
                  </div>
                  <hr>

                  <div class="post">
                    <p class="post-meta"><span class="post-author text-primary">deguix</span><br>
                    <span class="post-time small text-muted">22nd December 2005 12:20 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                    <p class="post-content"></p>

                    <blockquote>
                      1. For some reason the file Filter isn't working for me. It truncates the last character of the name, showing "DB Config Fil", and all files are still visible. I've tried lots of different examples, including copying directly from the readme.
                    </blockquote>When I comeback for IOEx development, I'll look at it.<br>
                    <br>

                    <blockquote>
                      2. When a file is selected and Open is clicked, the Installer goes to the next page immediately, instead of going back to the DBConfigXML custom page and waiting for the user to click Install.
                    </blockquote>This is normal because a notification flag is used. You should use abort in the custom page function when this is used.
                  </div>
                  <hr>

                  <div class="post">
                    <p class="post-meta"><span class="post-author text-primary">akn</span><br>
                    <span class="post-time small text-muted">2nd January 2006 13:24 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                    <p class="post-content"><strong>Custom page bitmap disappeared after replacing IO with IOEx</strong><br>
                    Hi,<br>
                    I've problem with bitmaps on custom pages.<br>
                    I've downloaded InstallOptionsEx plug-in and saved InstallOptionsEx.dll on InstallOptions.dll in NSIS directory.<br>
                    After that images on custom pages are not displayed.<br>
                    With InstallOptions.dll installator worked properly.<br>
                    Any help will be appreciated.</p>
                  </div>
                  <hr>

                  <div class="post">
                    <p class="post-meta"><span class="post-author text-primary">deguix</span><br>
                    <span class="post-time small text-muted">4th January 2006 12:40 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                    <p class="post-content">Because futuraly I want to patch InstallOptions with changes I mostly developed, I'll be working only on InstallOptionsEx for a while, and no other projects will be involved.<br>
                    <br>
                    All those bugs were confirmed and all are my fault. Damn. These bugs are the ones confirmed:<br>
                    <br>
                    - Image controls bug: Some image types don't work - bitmaps for example. Internal problems can range from not recognizing the file as image and not identifying the image type as to be destroyed.<br>
                    - Filter key name bug: Last character is cropped. Internal problem is the replacement of last char with "\0".<br>
                    - Dialog coloring bug: Since IOEx 2.4.1 beta 6 (version which custom drawn controls were implemented). I didn't check this one out yet.</p>
                  </div>
                  <hr>

                  <div class="post">
                    <p class="post-meta"><span class="post-author text-primary">SuperPat</span><br>
                    <span class="post-time small text-muted">12th February 2006 18:45 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                    <p class="post-content">I Need to use InstallOptionsEx, but unfortunately, with the lastest version, the background don't work correctly and the bitmaps are not draw.<br>
                    <br>
                    But you know it already.<br>
                    <br>
                    Thus can you give online the lastest version where this two bugs did not exist?<br>
                    <br>
                    Thank you in advance.</p>
                  </div>
                  <hr>

                  <div class="post">
                    <p class="post-meta"><span class="post-author text-primary">deguix</span><br>
                    <span class="post-time small text-muted">13th February 2006 04:53 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                    <p class="post-content"><strong>InstallOptionsEx 2.4.4 beta 2 - DLL + Source</strong><br>
                    Sorry about that. New Release:</p>

                    <ul>
                      <li>Fixed: Image controls implementation was coded poorly.</li>

                      <li>Fixed: Dialog box now can be colored (bug introduced IOEx 2.4.1 beta 6).</li>

                      <li>Fixed: Filter key value had last character chop down.</li>

                      <li>Fixed: Filter key value's first item in array is the only one detected.</li>

                      <li>Fixed: Filter key value can overrun the buffer by one byte besides the "BufferSize" limit for characters.</li>

                      <li>Added: Ability to convert "\\" to "\" in lists.</li>

                      <li>Fixed: The ListItems value name for ComboBox and DropList controls can't have the combination "\\" and "\|". This needs to be verified.</li>
                    </ul>I'm very unhappy with the progress of this project. I was hoping to be able to use its multithreading capabilities to allow the creation of multiple windows.<br>
                    <br>
                    I actually have almost no interest in an old project, which was the inspiration for all of those changes in this plugin, so you can only expect me to don't implement much at all to this plugin anymore. Maybe someone else might be interested in continuing this on, principally because my needs were realized already, and the TODO list contains suggestions - which are not always what the developer needs. I couldn't even adapt myself to newer plug-in versions, and my programs still use older versions of my own plug-in.
                  </div>
                  <hr>

                  <div class="post">
                    <p class="post-meta"><span class="post-author text-primary">dandaman32</span><br>
                    <span class="post-time small text-muted">16th February 2006 05:48 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                    <p class="post-content"><strong>Documentation overhaul</strong><br>
                    Perhaps you should consider changing the documentation layout-wise - increase the indentation on sub-sections etc becuase the current version can be a bit hard to read.<br>
                    <br>
                    I've attached an updated basic.js file that makes the text areas padded by 0.2in. Only change was:<br></p>
                    <pre>
<code>document.write('&lt;div id="' + pszDivisionPrefix + nTable + '" class=sc&gt;&lt;table ');</code>
</pre><br>
                    changed to<br>
                    <pre>
<code>document.write('&lt;div id="' + pszDivisionPrefix + nTable + '" class=sc&gt;&lt;table style="padding: 0.2in;" ');</code>
</pre><br>
                    <br>
                    hope this helps<br>
                    nice plugin :)<br>
                    <br>
                    -dandaman32
                  </div>
                  <hr>
                  
                  
                  

                  <div class="container">
                    

                    <ol class="breadcrumb">
                      <li><a href="../index.html" class="glyphicon glyphicon-home"></a></li>

                      <li><a href="f-65.html">NSIS Discussion</a></li>

                      <li class="active">InstallOptionsEx</li>
                    </ol>

                    <p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=181087">InstallOptionsEx</a></p><br>

                    <div class="post">
                      <p class="post-meta"><span class="post-author text-primary">SuperPat</span><br>
                      <span class="post-time small text-muted">17th February 2006 19:08 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                      <p class="post-content">The new version does not work better :-(<br>
                      <br>
                      Look at the WelcomeFinish example.</p>
                    </div>
                    <hr>

                    <div class="post">
                      <p class="post-meta"><span class="post-author text-primary">deguix</span><br>
                      <span class="post-time small text-muted">17th February 2006 20:44 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                      <p class="post-content">Hmmm... shit! I forgot to post the dll of the newer version! Fixed. Sorry for the forgotten new dll file.</p>
                    </div>
                    <hr>

                    <div class="post">
                      <p class="post-meta"><span class="post-author text-primary">SuperPat45</span><br>
                      <span class="post-time small text-muted">18th February 2006 16:15 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                      <p class="post-content">Thank you very much</p>
                    </div>
                    <hr>

                    <div class="post">
                      <p class="post-meta"><span class="post-author text-primary">SuperPat</span><br>
                      <span class="post-time small text-muted">18th February 2006 16:47 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                      <p class="post-content">There are two other bug:<br>
                      <br>
                      The checkBox, radiobutton, textbox (and maybe others) cannot have their background color and their text color changed by the SetCtlColors instruction.<br>
                      <br>
                      I have also an other problem with a page which use a ListBox:<br>
                      It post a MessageBox with the title "error" with the list of the items of the messagebox. If I click on ok, it repost the same messagebox but with the first character in less and so on until there do not remain any character and it jump the page... This page work well with the original InstallOption.</p>
                    </div>
                    <hr>

                    <div class="post">
                      <p class="post-meta"><span class="post-author text-primary">WebMatze</span><br>
                      <span class="post-time small text-muted">18th February 2006 18:23 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                      <p class="post-content">I found a problem with the new DLL that has been upload today, the real 2.44 beta2, I used IOEx to display the installer icon, and it doesn't work anymore, the only thing that works is to display an external icon using the text field in the ini, but i cant use the default installer icon(internal)<br>
                      I worked without problem with the previous IOEx version.</p>
                    </div>
                    <hr>

                    <div class="post">
                      <p class="post-meta"><span class="post-author text-primary">deguix</span><br>
                      <span class="post-time small text-muted">19th February 2006 16:49 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                      <p class="post-content"><strong>InstallOptionsEx 2.4.4 beta 2 PB 1 - DLL</strong><br>
                      I released the Post Build #1 with quick fixes for the bugs discussed.<br>
                      <br>
                      I've also implemented dandaman32's suggestion of padding to docs text tables - I used 2% of indentation for text tables (instead of 0.2in) in the style.css file -&gt; better for smaller resolutions. Still, I don't know how it would look in a 640x480 resolution.<br>
                      <br>
                      <a href="http://nsis.sourceforge.net/InstallOption****plug-in" target="_blank">InstallOptionsEx wiki page</a></p>
                    </div>
                    <hr>

                    <div class="post">
                      <p class="post-meta"><span class="post-author text-primary">WebMatze</span><br>
                      <span class="post-time small text-muted">19th February 2006 19:22 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                      <p class="post-content">Thanks for the quick fix...</p>
                    </div>
                    <hr>

                    <div class="post">
                      <p class="post-meta"><span class="post-author text-primary">SuperPat</span><br>
                      <span class="post-time small text-muted">19th February 2006 21:37 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                      <p class="post-content">Thanks for the fix of my bugs.</p>
                    </div>
                    <hr>

                    <div class="post">
                      <p class="post-meta"><span class="post-author text-primary">dandaman32</span><br>
                      <span class="post-time small text-muted">20th February 2006 06:45 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                      <p class="post-content"></p>

                      <blockquote>
                        Still, I don't know how it would look in a 640x480 resolution.
                      </blockquote>Nobody uses elinks anymore :)<br>
                      I have a linux server that runs maybe a pentium 200mhz and a 2.5gig hd and trustix 3.0 rc1 ...the only time i use gnome 2.10 is when i'm testing its website with firefox, and even then the video runs at 1024x768.<br>
                      <br>
                      -dandaman32
                    </div>
                    <hr>

                    <div class="post">
                      <p class="post-meta"><span class="post-author text-primary">deguix</span><br>
                      <span class="post-time small text-muted">20th February 2006 08:10 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                      <p class="post-content"></p>

                      <blockquote>
                        Thanks for the quick fix.../Thanks for the fix of my bugs.
                      </blockquote>After that, I had to make up for my mistake somewhere :).<br>
                      <br>

                      <blockquote>
                        and even then the video runs at 1024x768
                      </blockquote>That's the resolution I thought about when I used those precentages, so it won't have problems.
                    </div>
                    <hr>

                    <div class="post">
                      <p class="post-meta"><span class="post-author text-primary">SuperPat</span><br>
                      <span class="post-time small text-muted">20th February 2006 18:28 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                      <p class="post-content">I still found another bug:<br>
                      <br>
                      with the Link control:<br>
                      <br>
                      In the finish page, when I define:<br>
                      !define MUI_FINISHPAGE_LINK "Text Link"<br>
                      !define MUI_FINISHPAGE_LINK_LOCATION "http://www.address.com"<br>
                      The background is not colored, and the text link does not appear. Moreover, when I click on this link, Nothing occurs :-(</p>
                    </div>
                    <hr>

                    <div class="post">
                      <p class="post-meta"><span class="post-author text-primary">SuperPat</span><br>
                      <span class="post-time small text-muted">21st February 2006 15:32 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                      <p class="post-content">Another small thing:<br>
                      <br>
                      The vertical scrollbar (VSCROLL) don't work with a multiline textbox, contrary to the horizontal scrollbar (HSCROLL).</p>
                    </div>
                    <hr>

                    <div class="post">
                      <p class="post-meta"><span class="post-author text-primary">goldy1064</span><br>
                      <span class="post-time small text-muted">21st February 2006 20:26 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                      <p class="post-content">I have finally backtracked to where the East Asain strings will work with IOEx. 2.4.1b9 is the first version while backtracking that I was able to get strings to appear correctly using IOEx. If you need/want more information, just let me know.</p>
                    </div>
                    <hr>

                    <div class="post">
                      <p class="post-meta"><span class="post-author text-primary">goldy1064</span><br>
                      <span class="post-time small text-muted">23rd February 2006 19:31 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                      <p class="post-content">It appears that the function ConvertVariables, called from myGetProfileString on line 874 in InstallOptions.h, is what is garbling the data because when I comment out that function call, my strings appear correctly.<br>
                      <br>
                      For testing purposes, you can change your system locale for non-Unicode applications to Japanese, Chinese, etc. to see the strings show up correctly.</p>
                    </div>
                    <hr>

                    <div class="post">
                      <p class="post-meta"><span class="post-author text-primary">deguix</span><br>
                      <span class="post-time small text-muted">24th February 2006 18:16 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                      <p class="post-content"><strong>InstallOptionsEx 2.4.4 beta 2 PB 2 - DLL</strong><br>
                      I released Post Build #2 with more quick fixes for the recent bugs discussed. String manipulation functions were ravamped with old modified InstallOptions functions to support multibyte code pages. VSCROLL flag was fixed for <i>Text</i> and <i>Password</i> controls.<br>
                      <br>
                      Changes for the adaptation with Modern UI: <i>Link</i> controls will always have the color set in the ini file, or if defaults are used and SetCtlColors is used, then it will use the SetCtlColors colors, and if that instruction is not used, only then it will use the default colors. Also, <i>NotifyCursor</i> is now set to "HAND" by default when using those controls. It is still needed to use <i>Notify</i> key to have the <i>ONCLICK</i> notification flag though - This allows to use other notifications with <i>Link</i> controls without always firing the <i>ONCLICK</i> notification flag when not needed.<br>
                      <br>
                      Thus, the use of !define MUI_PAGE_CUSTOMFUNCTION_PRE and !insertmacro MUI_INSTALLOPTIONS_WRITE are required in Modern UI if you want to implement links using InstallOptionsEx.<br>
                      <br>
                      <a href="http://nsis.sourceforge.net/InstallOption****plug-in" target="_blank">InstallOptionsEx wiki page</a></p>
                    </div>
                    <hr>

                    <div class="post">
                      <p class="post-meta"><span class="post-author text-primary">goldy1064</span><br>
                      <span class="post-time small text-muted">24th February 2006 21:30 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                      <p class="post-content">FYI: 2.4.4b2PB2 I think was compiled in Debug mode because every time the screen is redrawn, I get a messagebox display 0.</p>
                    </div>
                    <hr>

                    <div class="post">
                      <p class="post-meta"><span class="post-author text-primary">deguix</span><br>
                      <span class="post-time small text-muted">24th February 2006 21:41 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                      <p class="post-content">My bad... Fixed.</p>
                    </div>
                    <hr>

                    <div class="post">
                      <p class="post-meta"><span class="post-author text-primary">SuperPat</span><br>
                      <span class="post-time small text-muted">25th February 2006 11:54 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                      <p class="post-content">It work fine, thanks.</p>
                    </div>
                    <hr>

                    <div class="post">
                      <p class="post-meta"><span class="post-author text-primary">SuperPat</span><br>
                      <span class="post-time small text-muted">25th February 2006 13:25 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                      <p class="post-content">Is is still me,<br>
                      <br>
                      In the lastest version (2.44) of InstallOption, I can read in the version history:<br>
                      "Added HWND and HWND2 entries to the INI file to avoid messy calculations of the correct control id."<br>
                      <br>
                      Can you add this into InstallOptionEx?<br>
                      <br>
                      Because it is very usefull and I need it in one of my install.<br>
                      <br>
                      Thanks in advance.</p>
                    </div>
                    <hr>

                    <div class="post">
                      <p class="post-meta"><span class="post-author text-primary">SuperPat</span><br>
                      <span class="post-time small text-muted">26th February 2006 12:52 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                      <p class="post-content">hello,<br>
                      <br>
                      There is a option which could be interresting:<br>
                      <br>
                      That InstallOptionEx can, automatically, sort the itemslist alphabetically before posting them in the listbox, treeview, droplist, combobox...<br>
                      <br>
                      Because it is rather complicated to do it in NSIS script because the StrCmp instruction cant compare if a string is inferior or supperior.</p>
                    </div>
                    <hr>

                    <div class="post">
                      <p class="post-meta"><span class="post-author text-primary">deguix</span><br>
                      <span class="post-time small text-muted">26th February 2006 20:10 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                      <p class="post-content"></p>

                      <blockquote>
                        In the lastest version (2.44) of InstallOption, I can read in the version history:<br>
                        "Added HWND and HWND2 entries to the INI file to avoid messy calculations of the correct control id."<br>
                        <br>
                        Can you add this into InstallOptionEx?
                      </blockquote>There is no messy ID calculation: the field you chose + 1200 - 1 is always the field you want... thus, it's the same as using GetDlgItem, so there is no point in it.<br>
                      <br>

                      <blockquote>
                        That InstallOptionEx can, automatically, sort the itemslist alphabetically before posting them in the listbox, treeview, droplist, combobox...<br>
                        <br>
                        Because it is rather complicated to do it in NSIS script because the StrCmp instruction cant compare if a string is inferior or supperior.
                      </blockquote>There's this <a href="http://nsis.sourceforge.net/Array_plug-in" target="_blank">Array plug-in</a> for that. I don't need to implement what's already have been implemented in another plug-in (removed from TODO).
                    </div>
                    <hr>

                    <div class="post">
                      <p class="post-meta"><span class="post-author text-primary">goldy1064</span><br>
                      <span class="post-time small text-muted">28th February 2006 00:23 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                      <p class="post-content">I have a bunch of different labels on my page and none of them are tabstops anymore (and I don't have that flag set to make them notabstop). Is there a new setting somewhere that I'm missing?</p>
                    </div>
                    <hr>

                    <div class="post">
                      <p class="post-meta"><span class="post-author text-primary">deguix</span><br>
                      <span class="post-time small text-muted">28th February 2006 10:14 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                      <p class="post-content">There's nothing wrong. Label controls can't be focused, so they are always not "tabstopped". There is no sense in adding a "tab stop" option for that type of control, unless if you make it a "link" by using notification messages. Maybe unifying both "label" and "link" controls would solve this problem...</p>
                    </div>
                    <hr>

                    <div class="post">
                      <p class="post-meta"><span class="post-author text-primary">goldy1064</span><br>
                      <span class="post-time small text-muted">28th February 2006 17:22 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                      <p class="post-content">Yeah, I'm using a label as a link because I have a background image and it was causing me issues when I would use a link control and not a label because the link control would cause unpredictable behaviour, it seemed. For instance, when I would click a link, the link worked, but it would sometimes also register a state change on another control or it would not allow my exit button to work (using a modified resource file with no Cancel button but instead a custom button).<br>
                      <br>
                      What you could do is get rid of the link control and instead have a label control do both (since it can) and have a flag for it called TABSTOP. Just a thought.</p>
                    </div>
                    <hr>

                    <div class="post">
                      <p class="post-meta"><span class="post-author text-primary">deguix</span><br>
                      <span class="post-time small text-muted">28th February 2006 22:17 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                      <p class="post-content">I'll test this later and think about making Label and Link to be only one control - still, this provides some more compatibility problems with Modern UI.<br>
                      <br>
                      Now InstallOptionsEx plug-in project can be found in SourceForge: <a href="http://sourceforge.net/projects/nsis-ioex" target="_blank">http://sourceforge.net/projects/nsis-ioex</a>. I'll upload stuff there in a week. You can already start posting bug reports, suggestions and patches too. I'm not planning on creating a web-site though - it would be a waste of effort.<br>
                      <br>
                      If someone else would like to be a project admin, if you have some time to maintain the project there, then you could suggest here too. Even with some enough time I'm having, I'm still not really focusing much in this project, and I'm just lazy in working in a project...</p>
                    </div>
                    <hr>

                    <div class="post">
                      <p class="post-meta"><span class="post-author text-primary">T.Slappy</span><br>
                      <span class="post-time small text-muted">1st March 2006 21:46 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                      <p class="post-content">How can I add VSCROLL to RichEdit?<br>
                      Is it Supported??</p>
                    </div>
                    <hr>

                    <div class="post">
                      <p class="post-meta"><span class="post-author text-primary">T.Slappy</span><br>
                      <span class="post-time small text-muted">1st March 2006 21:47 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                      <p class="post-content"><strong>RichEdit</strong><br>
                      I have the newest version but it do nothing if I add VSCROLL flag</p>
                    </div>
                    <hr>

                    <div class="post">
                      <p class="post-meta"><span class="post-author text-primary">deguix</span><br>
                      <span class="post-time small text-muted">3rd March 2006 15:03 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                      <p class="post-content">Sorry, I'll do that after I finish uploading stuff to the sf project page. I already uploaded CVS files, but I just don't know how can I make automated CVS builds of the plug-in like NSIS dev snapshots.</p>
                    </div>
                    <hr>

                    <div class="post">
                      <p class="post-meta"><span class="post-author text-primary">naxan</span><br>
                      <span class="post-time small text-muted">10th March 2006 00:14 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                      <p class="post-content">good job!<br>
                      <br>
                      But:<br>
                      There is a bug in TreeView with Checkboxes.<br>
                      When i unselect Checkboxes and select them again State is still 0.<br>
                      I used ONSELCHANGE as notifier.<br>
                      <br>
                      btw. ONSELCHANGE is working probably also not correct.<br>
                      it recognizes only focus changes on treeView-items.<br>
                      ONSELCHANGE should get Checkboxchanges or iam wrong?<br>
                      <br>
                      It would be also nice if you could implement a focusState for treeView-items. So the selectet itemLabel can be read out.</p>
                    </div>
                    <hr>

                    <div class="post">
                      <p class="post-meta"><span class="post-author text-primary">deguix</span><br>
                      <span class="post-time small text-muted">10th March 2006 09:30 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                      <p class="post-content">:o<br>
                      <br>
                      I couldn't reproduce the first one and third bugs, because I can't even get the CHECKBOXES working. :( The second one was reproduced, so I do expect those others to be true. I even got another bug: ending a level is normal, but ending two levels or more at once will make these levels except the first one and the main level to add an extra empty item, like when using "{<b>{</b>". This came with the multibyte charsets fix.<br>
                      <br>
                      Now about the focus state, you can get it using TVM_* messages with the System plug-in. I'm also accepting help from the NSIS coding side to make functions available for either compile-time or run-time for the plug-in. Those functions would be great for operations like to get the focus state from an item in the TreeView control.<br>
                      <br>
                      I got everything uploaded and ready in the sf, so I'll be working on IOEx in the weekend. I still got to accomodate myself to upload commits to the CVS.</p>
                    </div>
                    <hr>

                    <div class="post">
                      <p class="post-meta"><span class="post-author text-primary">quotient</span><br>
                      <span class="post-time small text-muted">21st March 2006 06:49 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                      <p class="post-content">I think I've found a bug with the Button control when using:<br>
                      <br>
                      1. The OPEN_FILEREQUEST flag;<br>
                      2. The RefFields=Field_ID key; &amp;<br>
                      3. TIMEOUT=time_in_ms key in the Settings section.<br>
                      <br>
                      I use the TIMEOUT key to leave the page and decrement a counter (countdown timer) before updating the page with a WM_SETTEXT and returning (via Abort). When a control is clicked the countdown stops and no more WM_SETTEXT messages are sent, but the TIMEOUT notification still occurs.<br>
                      <br>
                      I can successfully use the Button control to browse the file system and select a file but as soon as the browsing dialog closes (if I double-click the file or click the “Open” or “Cancel” buttons) the page returns a State value of “0” (the page) and a Notify value of “ONNEXT”…! If I disable the TIMEOUT function, the problem disappears. Similarly, if I increase the TIMEOUT value to about 8000ms the problem becomes less frequent… Everything else seems to work…<br>
                      <br>
                      Here are some of the pertinent elements of the dialog *.ini file, FYI:<br>
                      <br>
                      [Settings]<br>
                      NumFields=20<br>
                      TimeOut=1000<br>
                      NextButtonText=Configure...<br>
                      <br>
                      [Field 1]<br>
                      Type=Label<br>
                      Left=61<br>
                      Top=130<br>
                      Right=185<br>
                      Bottom=137<br>
                      Text=Seconds until these options are used:<br>
                      TxtColor=0x0000FF<br>
                      <br>
                      [Field 2]<br>
                      Type=Label<br>
                      Left=189<br>
                      Top=130<br>
                      Right=205<br>
                      Bottom=137<br>
                      Text=30<br>
                      ; TxtColor=0x0000FF remarked out as it breaks WM_SETTEXT function… :(<br>
                      …<br>
                      <br>
                      [Field 11]<br>
                      Type=Text<br>
                      Left=147<br>
                      Top=104<br>
                      Right=239<br>
                      Bottom=117<br>
                      State=c:\unattend.txt<br>
                      Flags=DISABLED<br>
                      <br>
                      [Field 12]<br>
                      Type=Button<br>
                      Left=243<br>
                      Top=104<br>
                      Right=282<br>
                      Bottom=117<br>
                      Text=&amp;Browse...<br>
                      RefFields=11<br>
                      Notify=ONCLICK<br>
                      Flags=OPEN_FILEREQUEST|FILE_EXPLORER|DISABLED<br>
                      …<br>
                      <br>
                      Any chance you can help me with this one?</p>
                    </div>
                    <hr>

                    <div class="post">
                      <p class="post-meta"><span class="post-author text-primary">quotient</span><br>
                      <span class="post-time small text-muted">21st March 2006 10:28 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                      <p class="post-content"><i>Edit to previous post:</i><br>
                      <br>
                      Fields 11 &amp; 12 are disabled when the page shows, but if a user clicks a related checkbox, Field 10 (not shown above), <b>EnableWindow $HWND 1</b> is used to enable the controls. Removal of the DISABLED flag had no effect on the problem.<br>
                      <br>
                      NSIS 2.15 and IOEx 2.4.4b2a2 are in use.<br>
                      <br>
                      Any help or alternative solutions appreciated.<br>
                      <br>
                      Excellent plug-in btw.</p>
                    </div>
                    <hr>

                    <div class="post">
                      <p class="post-meta"><span class="post-author text-primary">deguix</span><br>
                      <span class="post-time small text-muted">27th March 2006 12:01 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                      <p class="post-content">I cannot promise anything, but I'll return to make updates to this plug-in this week, even if not published. I see I'm going to have some new school projects to do, but I'll try to speed up development anyways. I plan to stop developing other projects for other communities to work on this one.<br>
                      <br>
                      I still didn't make many changes yet and I couldn't verify how your problem happens quotient. Hopefully, I'll find the answer this week.</p>
                    </div>
                    <hr>

                    <div class="post">
                      <p class="post-meta"><span class="post-author text-primary">NeoAlus</span><br>
                      <span class="post-time small text-muted">29th March 2006 03:38 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                      <p class="post-content"><strong>crashing</strong><br>
                      Using:<br>
                      2.4.4 beta 2 PB 2<br>
                      NSIS 2.15<br>
                      <br>
                      I get a crash anytime I have any $ variables in my ini file.<br>
                      This worked previously.<br>
                      Here's the ini that used to work:<br>
                      <br>
                      [Field 1]<br>
                      Type=Label<br>
                      Text=Setup will install $5 in the following folder. To install in a different folder, click Browse and select another folder. Click Next to continue.<br>
                      Left=0<br>
                      Right=-1<br>
                      Top=0<br>
                      Bottom=30<br>
                      <br>
                      [Field 2]<br>
                      Type=Label<br>
                      Text=Select the install type:<br>
                      Left=0<br>
                      Right=80<br>
                      Top=40<br>
                      Bottom=56<br>
                      <br>
                      [Field 3]<br>
                      Type=DropList<br>
                      ListItems=Default Install|Custom Location<br>
                      State=Default Install<br>
                      Notify=ONSELCHANGE<br>
                      Left=80<br>
                      Right=-80<br>
                      Top=38<br>
                      Bottom=94<br>
                      <br>
                      [Field 4]<br>
                      Type=GroupBox<br>
                      Text=Destination Folder<br>
                      Left=0<br>
                      Right=-1<br>
                      Top=70<br>
                      Bottom=105<br>
                      <br>
                      [Field 5]<br>
                      Type=Text<br>
                      State=$4<br>
                      Left=10<br>
                      Right=-75<br>
                      Top=85<br>
                      Bottom=97<br>
                      <br>
                      [Field 6]<br>
                      Type=Button<br>
                      Flags=DIRREQUEST<br>
                      Text=B&amp;rowse...<br>
                      Notfy=ONCLICK<br>
                      ListItems=Select the folder to install $5 in:<br>
                      RefFields=5<br>
                      Notify=ONCLICK<br>
                      State=$4<br>
                      Left=-67<br>
                      Right=-12<br>
                      Top=83<br>
                      Bottom=98</p>
                    </div>
                    <hr>

                    <div class="post">
                      <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br>
                      <span class="post-time small text-muted">29th March 2006 14:46 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                      <p class="post-content">I'm not sure why it crashes with $, but anyway you can't just put a $var in the INI file and hope that it is going to be replaced with the value of the variable itself (unless the plugin itself does this now?)<br>
                      You should write the new strings containing the variables at run time with WriteINIStr.<br>
                      <br>
                      -Stu</p>
                    </div>
                    <hr>

                    <div class="post">
                      <p class="post-meta"><span class="post-author text-primary">NeoAlus</span><br>
                      <span class="post-time small text-muted">29th March 2006 18:38 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                      <p class="post-content">Well, it did work previously.<br>
                      Also, WriteINIStr would only affect the strings on load, while one of those $ vars ($4) is used to display the user's current choice, which could change many times after load.</p>
                    </div>
                    <hr>

                    <div class="post">
                      <p class="post-meta"><span class="post-author text-primary">deguix</span><br>
                      <span class="post-time small text-muted">29th March 2006 19:44 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                      <p class="post-content">well, this probably happens after the fix about multibyte strings showing correctly (latest alpha). You can try a previous alpha (Post-Build) from the 2.4.4 beta 2 release. It doesn't have this multibyte strings fix.</p>
                    </div>
                    <hr>

                    <div class="post">
                      <p class="post-meta"><span class="post-author text-primary">goldy1064</span><br>
                      <span class="post-time small text-muted">29th March 2006 22:11 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                      <p class="post-content">Just wondering if you were thinking of giving the label controls tabstop functionality like I had mentioned a little while ago?<br>
                      <br>
                      Thanks.</p>
                    </div>
                    <hr>

                    <div class="post">
                      <p class="post-meta"><span class="post-author text-primary">NeoAlus</span><br>
                      <span class="post-time small text-muted">29th March 2006 22:26 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                      <p class="post-content">Thanks deguix, 2.4.4 beta 2 (PB 1) works great for me.</p>
                    </div>
                    <hr>

                    <div class="post">
                      <p class="post-meta"><span class="post-author text-primary">deguix</span><br>
                      <span class="post-time small text-muted">30th March 2006 12:48 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                      <p class="post-content">Tabstop is done, merge of Label and Link controls is still not done... I'm not using CVS yet, because I often have to call back a change.</p>
                    </div>
                    <hr>
                    
                    
                    

                    <div class="container">
                      

                      <ol class="breadcrumb">
                        <li><a href="../index.html" class="glyphicon glyphicon-home"></a></li>

                        <li><a href="f-65.html">NSIS Discussion</a></li>

                        <li class="active">InstallOptionsEx</li>
                      </ol>

                      <p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=181087">InstallOptionsEx</a></p><br>

                      <div class="post">
                        <p class="post-meta"><span class="post-author text-primary">deguix</span><br>
                        <span class="post-time small text-muted">30th March 2006 14:12 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                        <p class="post-content">Thinking about several months about this, I should abandon this project now.<br>
                        <br>
                        First and main reason is that I don't like hacking environments like the Windows GUI - there are many glitches with everything. I like working in an already solid environment or an unstable one with the ability to change how it works. NSIS is stable, but Windows API is "stable" with bugs, which is more like unstable for me.<br>
                        <br>
                        Second is the continuity of a project. I don't like to change the same code over and over again, I like to create new things instead, without rewriting old code once again.<br>
                        <br>
                        Third, I like language standards and low-level coding to improve high-level coding, and I like when there exists a "model" code that can be changed later to create variations.<br>
                        <br>
                        Thank you for at least saying that this is a good project, and making suggestions and mentioning bugs. I see that someone will take advantage of some of the code for his own purpose.</p>
                      </div>
                      <hr>

                      <div class="post">
                        <p class="post-meta"><span class="post-author text-primary">goldy1064</span><br>
                        <span class="post-time small text-muted">30th March 2006 17:09 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                        <p class="post-content">Ok, cool. That's going to help out a lot. Thanks!</p>
                      </div>
                      <hr>

                      <div class="post">
                        <p class="post-meta"><span class="post-author text-primary">Comm@nder21</span><br>
                        <span class="post-time small text-muted">30th March 2006 22:22 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                        <p class="post-content">thanx for all you did man!<br>
                        <br>
                        though i never used it, its for sure a great plugin!<br>
                        <br>
                        i'll pack it with the plugin rollup package i plan to release in the next months :)</p>
                      </div>
                      <hr>

                      <div class="post">
                        <p class="post-meta"><span class="post-author text-primary">deguix</span><br>
                        <span class="post-time small text-muted">31st March 2006 19:46 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                        <p class="post-content">It would be better to standardize the code first, so that only necessary plug-ins would be used and implemented in the package.</p>
                      </div>
                      <hr>

                      <div class="post">
                        <p class="post-meta"><span class="post-author text-primary">iceman_k</span><br>
                        <span class="post-time small text-muted">5th April 2006 15:18 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                        <p class="post-content"></p>

                        <blockquote>
                          I don't like to change the same code over and over again, I like to create new things instead, without rewriting old code once again.
                        </blockquote>Unfortunately, the reality of software development is that old code needs to rewritten/fixed several times until it passes some predefined level of acceptability. And <b>THEN</b> go on to the new stuff. Just the nature of the business. :)<br>
                        (Doesn't seem to stop Microsoft, however :D)<br>
                        Anyway, good luck with whatever you decide to do next.<br>
                        I suppose I will shelve my plans for IOEx support in EclipseNSIS- I was waiting for it to get out of beta stage. :(
                      </div>
                      <hr>

                      <div class="post">
                        <p class="post-meta"><span class="post-author text-primary">SuperPat</span><br>
                        <span class="post-time small text-muted">30th April 2006 21:22 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                        <p class="post-content"><strong>Problem with the TreeView</strong><br>
                        Good evening,<br>
                        <br>
                        I have a problem with the treeview:<br>
                        <br>
                        When I select a subitem, only the parent item is reported in "State"<br>
                        <br>
                        [Field 3]<br>
                        Type=TreeView<br>
                        Left=0<br>
                        Right=-1<br>
                        Top=41<br>
                        Bottom=-12<br>
                        Notify=ONSELCHANGE<br>
                        ListItems=A|B|C|D|E{F|G}H|I{K|L|M}N|O<br>
                        State=E<br>
                        <br>
                        In this example, if I select "F" or "G", "state" will be equal at "E" intead of "E{F}" or "E{G}" as it should.<br>
                        <br>
                        Can you fix this?</p>
                      </div>
                      <hr>

                      <div class="post">
                        <p class="post-meta"><span class="post-author text-primary">deguix</span><br>
                        <span class="post-time small text-muted">3rd May 2006 01:28 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                        <p class="post-content">Well, I'm in a vacation, and the project is abandoned. But I might return developing it later, if I develop another project needing this.<br>
                        <br>
                        You could always test older versions to "fix" whatever the problem you need. Still, thank you for continuing to report stuff.</p>
                      </div>
                      <hr>

                      <div class="post">
                        <p class="post-meta"><span class="post-author text-primary">Brummelchen</span><br>
                        <span class="post-time small text-muted">15th May 2006 03:24 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                        <p class="post-content">how to perform a file request?<br>
                        <br>
                        please give me a code example for ini + nsi.<br>
                        <br>
                        thx</p>
                      </div>
                      <hr>

                      <div class="footer">
                        <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
                      </div>
                    </div><script type="text/javascript" src="../js/highlight.pack.js" async>
</script> <script type="text/javascript">
//<![CDATA[
                    hljs.initHighlightingOnLoad();
                    //]]></script></div></div></div></div></div></div></div></div></div></body></html>