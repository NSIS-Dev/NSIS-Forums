<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="description" content="Possible for NSIS to install Visual C++ packages?"><title>Possible for NSIS to install Visual C++ packages? - NSIS Forums</title><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script><link rel="preload" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css" as="style" onload="this.rel='stylesheet'"><link rel="preload" href="../css/style.css" as="style" onload="this.rel='stylesheet'"><noscript><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css"><link rel="stylesheet" href="../css/style.css"></noscript><script>!function(a){"use strict";var b=function(b,c,d){function e(a){return h.body?a():void setTimeout(function(){e(a)})}function f(){i.addEventListener&&i.removeEventListener("load",f),i.media=d||"all"}var g,h=a.document,i=h.createElement("link");if(c)g=c;else{var j=(h.body||h.getElementsByTagName("head")[0]).childNodes;g=j[j.length-1]}var k=h.styleSheets;i.rel="stylesheet",i.href=b,i.media="only x",e(function(){g.parentNode.insertBefore(i,c?g:g.nextSibling)});var l=function(a){for(var b=i.href,c=k.length;c--;)if(k[c].href===b)return a();setTimeout(function(){l(a)})};return i.addEventListener&&i.addEventListener("load",f),i.onloadcssdefined=l,l(f),i};"undefined"!=typeof exports?exports.loadCSS=b:a.loadCSS=b}("undefined"!=typeof global?global:this);!function(a){if(a.loadCSS){var b=loadCSS.relpreload={};if(b.support=function(){try{return a.document.createElement("link").relList.supports("preload")}catch(b){return!1}},b.poly=function(){for(var b=a.document.getElementsByTagName("link"),c=0;c<b.length;c++){var d=b[c];"preload"===d.rel&&"style"===d.getAttribute("as")&&(a.loadCSS(d.href,d,d.getAttribute("media")),d.rel=null)}},!b.support()){b.poly();var c=a.setInterval(b.poly,300);a.addEventListener&&a.addEventListener("load",function(){b.poly(),a.clearInterval(c)}),a.attachEvent&&a.attachEvent("onload",function(){a.clearInterval(c)})}}}(this);</script></head><body><div class="container"><ol class="breadcrumb"><li><a href="../index.html" class="glyphicon glyphicon-home"></a></li><li><a href="f-65.html">NSIS Discussion</a></li><li class="active">Possible for NSIS to install Visual C++ packages?</li></ol><p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=367574">Possible for NSIS to install Visual C++ packages?</a></p><br><div class="post"><p class="post-meta"><span class="post-author text-primary">wrybread</span><br><span class="post-time small text-muted">29th July 2013 20:25 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>Possible for NSIS to install Visual C++ packages?</strong><br>I'd like to install the Visual C++ 2010 Redistributable from an NSIS installer. Is that possible?<br><br>I've seen many other installers do this, but I don't think I've seen an NSIS package do it.<br><br>FYI, this is the VC++ package I'm referring to:<br><br><a href="http://www.microsoft.com/en-us/download/details.aspx?id=5555" target="_blank">http://www.microsoft.com/en-us/downl...s.aspx?id=5555</a><br><br>Thanks for any tips.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">nawfal</span><br><span class="post-time small text-muted">30th July 2013 07:09 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Can't you bundle the redistributable yourself in the installer, copy it to some temp location, and then run the exe from there? Or do you want it all silently? Or do you want nsis to check for redistributable itself in the machine, and download from the internet if not installed?</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">wrybread</span><br><span class="post-time small text-muted">30th July 2013 20:40 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Thanks for the reply.<br><br>Ideally I'd like to check for the presence of VC2010 and install it if necessary. No need to download it, I can package it with my installer.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">nawfal</span><br><span class="post-time small text-muted">31st July 2013 00:02 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">You can check registry. See this link <a href="http://blogs.msdn.com/b/astebner/archive/2010/05/05/10008146.aspx" target="_blank">http://blogs.msdn.com/b/astebner/arc.../10008146.aspx</a><br><br>Something like:<br><br></p><pre>
<code>!include x64.nsh<br><br><br><br>${If} ${RunningX64}<br>        ReadRegStr $1 HKLM "SOFTWARE\Microsoft\VisualStudio\10.0\VC\VCRedist\x64" "Installed"<br>        StrCmp $1 1 installed<br>${Else}<br>        ReadRegStr $1 HKLM "SOFTWARE\Microsoft\VisualStudio\10.0\VC\VCRedist\x86" "Installed"<br>        StrCmp $1 1 installed<br>${EndIf}<br><br>;not installed, so run the installer<br>ExecWait 'MyPathWhereInstallerIs\vc++2010setup.exe'<br><br>installed:<br>;we are done</code>
</pre><br>
      <br>
      You could use the logic If in LogicLib to do the conditional check to make code look better.
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">wrybread</span><br>
      <span class="post-time small text-muted">1st August 2013 05:30 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Thanks hugely, works beautifully.</p>
    </div>
    <hr>

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]></script></body></html>