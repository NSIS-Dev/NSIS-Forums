<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="description" content="current user vs administrator"><title>current user vs administrator - NSIS Forums</title><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script><link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css"><link rel="stylesheet" href="../css/style.css" type="text/css"><!--[if lt IE 9]><script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script><script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script><![endif]--></head><body><div class="container"><ol class="breadcrumb"><li><a href="../index.html" class="glyphicon glyphicon-home"></a></li><li><a href="f-65.html">NSIS Discussion</a></li><li class="active">current user vs administrator</li></ol><p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=195874">current user vs administrator</a></p><br><div class="post"><p class="post-meta"><span class="post-author text-primary">amhigh</span><br><span class="post-time small text-muted">7th October 2004 17:07 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>current user vs administrator</strong><br>Dear ALL:<br><br>I have a script which uses the following to set a environment variable:<br><br>WriteRegStr HKCU "Environment" "ART" "$INSTDIR\Art.exe"<br><br>but when a user "art" login to WinXP, who does not own the administrator privillege,<br>so this user click the setup.exe and press the right mouse to select administrator<br>to run this setup.exe. After it installs, the variable "ART" is set but under the<br>administraor account, not the current user "art". How can I solve this problem?<br>(same if for the shortcut problem -- the following statement<br><br>CreateShortCut "$DESKTOP\AART.lnk" "$INSTDIR\bin\AART.exe"<br><br>create a shortcut to administrator desktop, but not the current user "art" desktop!)</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">kichik</span><br><span class="post-time small text-muted">10th October 2004 15:09 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">I think the easiest and probably the best solution all around would be checking if the user is admin and then installing for all of the users, not just the current user.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">amhigh</span><br><span class="post-time small text-muted">12th October 2004 03:26 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"></p><blockquote><i>Originally posted by kichik</i><br><b>I think the easiest and probably the best solution all around would be checking if the user is admin and then installing for all of the users, not just the current user.</b></blockquote>If I install to all user, how can I do for the un-install? The un-installer can take away the setting for the current user only. Is there any example script that I reference?<br><br>Thanks.</div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">kichik</span><br><span class="post-time small text-muted">12th October 2004 22:24 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">The uninstaller can take it out for all users just as the installer can put it for all users. Note that I'm not talking about putting a shortcut for every user, but putting it in a common directory. For example:</p><pre>
<code>SetShellVarContext all<br>CreateShortcut $DESKTOP\prog.lnk $INSTDIR\prog.exe</code>
</pre>
    </div>
    <hr>

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]></script></body></html>