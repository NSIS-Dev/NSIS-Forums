<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="description" content="installer window loosing focus"><title>installer window loosing focus - NSIS Forums</title><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script><link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css"><link rel="stylesheet" href="../css/style.css" type="text/css"></head><body><div class="container"><ol class="breadcrumb"><li><a href="../index.html" class="glyphicon glyphicon-home"></a></li><li><a href="f-65.html">NSIS Discussion</a></li><li class="active">installer window loosing focus</li></ol><p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=309064">installer window loosing focus</a></p><br><div class="post"><p class="post-meta"><span class="post-author text-primary">dfranklin72</span><br><span class="post-time small text-muted">30th July 2009 09:59 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>installer window loosing focus</strong><br>using custom page leave function seems to make the installer window loose focus while its processing a task. Is there something Iâ€™m doing wrong?</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Anders</span><br><span class="post-time small text-muted">30th July 2009 11:06 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">processing task = running external program?</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">dfranklin72</span><br><span class="post-time small text-muted">30th July 2009 11:24 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">I'm running a number of batch sripts and installs in the leave function. Im also using the leave to post HTML data.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br><span class="post-time small text-muted">30th July 2009 12:13 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Running batches using ExecWait or what?<br><br>Stu</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">dfranklin72</span><br><span class="post-time small text-muted">30th July 2009 13:27 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">a mixture of:<br>nsExec::Exec<br>exewait<br>and some pluggins:<br><br>inetc::post<br>ebanner<br><br>the idea was to check some credentials with the post then run scripts with the output from the post. This intern modifies the packages and then runs them. while playing some images and showing progress all in a custom page.<br><br>Simple?</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br><span class="post-time small text-muted">30th July 2009 13:28 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Leave function isn't the place to do this stuff. Can't you do it during install?<br><br>Stu</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">dfranklin72</span><br><span class="post-time small text-muted">30th July 2009 13:33 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">I have moved most of the process this morning into the install section of MUI but I still have the problem with the user signup and serial activation. It currently requires the user to input details then it send them in a post via web services for validation checks. Do I need to run this in a single function and add a submit button to the page?</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">dfranklin72</span><br><span class="post-time small text-muted">30th July 2009 13:35 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">page custom serial serialleave<br><br><br>Function serial<br><br>nsDialogs::Create 1044<br>Pop $Dialog<br>${If} $Dialog == error<br>Abort<br><br>${EndIF}<br>GetDlgItem $R0 $HWNDPARENT 1<br>EnableWindow $R0 0<br><br>${NSD_CreateText} 37 230 50 20 $Serial1<br>Pop $Text5<br>${NSD_CreateText} 127 230 50 20 $Serial2<br>Pop $Text6<br>${NSD_CreateText} 217 230 50 20 $Serial3<br>Pop $Text7<br>${NSD_CreateText} 307 230 50 20 $Serial4<br>Pop $Text8<br>${NSD_SetFocus} $Text5<br><br><br>${NSD_SetTextLimit} $Text5 4<br>${NSD_SetTextLimit} $Text6 4<br>${NSD_SetTextLimit} $Text7 4<br>${NSD_SetTextLimit} $Text8 4<br><br><br>${NSD_OnChange} $text8 enableNext<br><br>${NSD_CreateBitmap} 0u 0u 100% 100% ""<br>Pop $Image<br>${NSD_SetImage} $Image $PLUGINSDIR\page2 $ImageHandle<br>nsDialogs::Show<br>${NSD_FreeImage} $ImageHandle<br>nsDialogs::Show<br><br><br><br>FunctionEnd<br><br>Function SerialLeave<br><br>GetDlgItem $R0 $HWNDPARENT 1<br>EnableWindow $R0 0<br><br>${NSD_GetText} $Text5 $Serial1<br>${NSD_GetText} $Text6 $Serial2<br>${NSD_GetText} $Text7 $Serial3<br>${NSD_GetText} $Text8 $Serial4<br><br>inetc::post "ProtectorSerialKey=$Serial1$Serial2$Serial3$Serial4" /SILENT /HEADER "Content-Type:application/x-www-form-urlencoded" \<br>"hostX.X.X.X" "$TEMP\post_reply.txt"<br><br>Push "$TEMP\post_reply.txt"<br>push "Serial Key registered"<br>Call FileSearch<br>Pop $0<br>${if} $0 = 1<br>#MessageBox MB_OK|MB_ICONINFORMATION "Serial Key registered OK"<br>call enableNEXT<br>${else}<br>Push "$TEMP\post_reply.txt"<br>Push "Serial Key not recognised"<br>Call FileSearch<br>Pop $0<br>${if} $0 = 1<br>MessageBox MB_OK|MB_ICONINFORMATION "Serial Key not recognised"<br>abort<br>${else}<br>Push "$TEMP\post_reply.txt"<br>Push "Serial Key has already been registered"<br>Call FileSearch<br>Pop $0<br>${if} $0 = 1<br>MessageBox MB_OK|MB_ICONINFORMATION "Serial key already registered"<br>abort<br>${else}<br>MessageBox MB_OK|MB_ICONINFORMATION "An unknown error has occured please contact your Service provider"<br>abort<br>${endif}<br><br>${endif}<br>${endif}<br>${NSD_FreeImage} $ImageHandle<br><br><br><br>FunctionEnd</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br><span class="post-time small text-muted">30th July 2009 14:39 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">You just have to show your serial page before installing.<br><br>Stu</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">dfranklin72</span><br><span class="post-time small text-muted">30th July 2009 14:50 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">not sure what you mean.<br><br>I run the serial function, wait for the results then a seperate signup function then install. I need the results of the serial function to complete the signup. this means I can't just place the posts in the install section.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br><span class="post-time small text-muted">30th July 2009 15:55 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">What you have now is fine. Send the web request in your page's leave function. Everything else can be done in a section.<br><br>Stu</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">dfranklin72</span><br><span class="post-time small text-muted">30th July 2009 15:56 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Its still loosing focus in the leave function which makes it look a bit strange?</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br><span class="post-time small text-muted">30th July 2009 17:28 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">You mean the installer window no longer has focus or some of your serial box fields when Abort is called?<br><br>NSIS has a BringToFront instruction. To set focus on the text fields you can use NSD_SetFocus.<br><br>Stu</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">dfranklin72</span><br><span class="post-time small text-muted">30th July 2009 17:29 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">its the installer window.</p></div><hr><div class="footer"><p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p></div></div><script src="../js/highlight.pack.js" type="text/javascript"></script><script type="text/javascript">//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]></script></body></html>