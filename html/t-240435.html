<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="description" content="Function InternetConnect from NSIS Documentation doesn't work!"><title>Function InternetConnect from NSIS Documentation doesn't work! - NSIS Forums</title><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script><link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css"><link rel="stylesheet" href="../css/style.css" type="text/css"><!--[if lt IE 9]><script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script><script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script><![endif]--></head><body><div class="container"><ol class="breadcrumb"><li><a href="../index.html" class="glyphicon glyphicon-home"></a></li><li><a href="f-65.html">NSIS Discussion</a></li><li class="active">Function InternetConnect from NSIS Documentation doesn't work!</li></ol><p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=240435">Function InternetConnect from NSIS Documentation doesn't work!</a></p><br><div class="post"><p class="post-meta"><span class="post-author text-primary">java.jago</span><br><span class="post-time small text-muted">10th March 2006 13:32 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>Function InternetConnect from NSIS Documentation doesn't work!</strong><br>Hi,<br><br>Function InternetConnect from NSIS Documentation doesn't work!<br><br>The problem is: the function thinks I am connected to the internet - althought I am definetily not!<br><br>Does anybody know a solution (perhaps demonstrated with a short script) how to determine if the user is online - and if he isn't ask him in a loop to do so ?<br><br>Cheers,<br>jago</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">kichik</span><br><span class="post-time small text-muted">10th March 2006 14:33 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">The documentation doesn't contain any function named InternetConnect. Are you talking about ConnectInternet from the Dialer plug-in's documentation?<br><br>That function uses wininet's <a href="http://windowssdk.msdn.microsoft.com/library/en-us/wininet/wininet/internetattemptconnect.asp" target="_blank">InternetAttemptConnect</a>. It seems this function settles for an active Ethernet connection and only fires up the dialer, if only a modem is connected to the system. You can find more discussion about this at:<br><br><a href="http://groups.google.com/group/microsoft.public.inetsdk.programming.wininet/browse_thread/thread/41756cc91b5c7806/5c19c40bd1692c2e?lnk=st&amp;q=InternetAttemptConnect&amp;rnum=18#5c19c40bd1692c2e" target="_blank">http://groups.google.com/group/micro...19c40bd1692c2e</a><br><br>Checking for an internet connection isn't simple, especially with many connection methods floating around and firewalls that can block your pings. Your best test will be to mimic the actual process you want to perform, in a smaller form. For example, if you want to download a big file from your website, download a very small file from the same server for testing.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Jamyn</span><br><span class="post-time small text-muted">10th March 2006 14:35 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>Hmmm.</strong><br>I think the example from the documentation does not take into account that you can have a private IP, and still not be "online" (to the internet).<br><br><a href="http://nsis.sourceforge.net/IP_plug-in" target="_blank">This</a> is a little big, but it may do the job. Basically, you could check to see if they have one of four types of IPs:<br><br>1) a loopback IP (127.0.0.1): not online.<br>2) no-dhcp ip: 169.254.x.x: not online.<br>3) a private IP (192.168.x or whatever): maybe online.<br>4) a normal IP (64.28.x.x): online<br><br>So in cases 1 and 2, they are not online. In case 3, they are possibly online - you could try pinging google.com for a reply, maybe. And in case 4, they are online.<br><br>It's a little bulky for what you're trying to do, though. Maybe there is a simpler solution.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">sag47</span><br><span class="post-time small text-muted">4th January 2007 19:47 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>InternetConnect function fixed</strong><br>Here is a fixed function for InternetConnect in the Dialer documentation. It is actually better than the example provided because it allows the user to retry to connect. I've attached a script example using it as well.<br><br>I used it to program an updater for my software UHARC CMD.<br>Get it at <a href="http://www.pages.drexel.edu/~sag47/uharc" target="_blank">http://www.pages.drexel.edu/~sag47/uharc</a><br><br>I provide the source with it and it includes a ton of NSIS script examples that can help you write your own software.<br>SAM<br><br>I believe this is what you are looking for.<br></p><pre>
<code><br>Function InternetConnect<br>  Start:<br>; Check for internet Connection<br>    Push $R0<br>    Dialer::GetConnectedState<br>    Pop $R0<br>    StrCmp $R0 "online" connected<br>      MessageBox MB_RETRYCANCEL|MB_TOPMOST|MB_SETFOREGROUND|MB_ICONEXCLAMATION "Can't connect to internet!" idRetry Start<br>      Quit ;Remove to make error not fatal<br>    connected:<br>    Pop $R0<br>FunctionEnd<br></code>
</pre><br>
      Keywords:<br>
      Detect internet connection<br>
      Detect internet<br>
      Detect connection<br>
      check for internet connection<br>
      check for internet<br>
      check for connection<br>
      dialer plugin<br>
      dialer<br>
      dialer internetconnect<br>
      dialer internetconnect function<br>
      getconnectedstate<br>
      dialer::getconnectedstate<br>
      nsisdl plugin<br>
      nsisdl check internet first
    </div>
    <hr>

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]></script></body></html>