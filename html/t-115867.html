<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="description" content="MUI_FINISHPAGE_RUN Problem"><title>MUI_FINISHPAGE_RUN Problem - NSIS Forums</title><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script><link rel="preload" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css" as="style" onload="this.rel='stylesheet'"><link rel="preload" href="../css/style.css" as="style" onload="this.rel='stylesheet'"><noscript><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css"><link rel="stylesheet" href="../css/style.css"></noscript><script>!function(a){"use strict";var b=function(b,c,d){function e(a){return h.body?a():void setTimeout(function(){e(a)})}function f(){i.addEventListener&&i.removeEventListener("load",f),i.media=d||"all"}var g,h=a.document,i=h.createElement("link");if(c)g=c;else{var j=(h.body||h.getElementsByTagName("head")[0]).childNodes;g=j[j.length-1]}var k=h.styleSheets;i.rel="stylesheet",i.href=b,i.media="only x",e(function(){g.parentNode.insertBefore(i,c?g:g.nextSibling)});var l=function(a){for(var b=i.href,c=k.length;c--;)if(k[c].href===b)return a();setTimeout(function(){l(a)})};return i.addEventListener&&i.addEventListener("load",f),i.onloadcssdefined=l,l(f),i};"undefined"!=typeof exports?exports.loadCSS=b:a.loadCSS=b}("undefined"!=typeof global?global:this);!function(a){if(a.loadCSS){var b=loadCSS.relpreload={};if(b.support=function(){try{return a.document.createElement("link").relList.supports("preload")}catch(b){return!1}},b.poly=function(){for(var b=a.document.getElementsByTagName("link"),c=0;c<b.length;c++){var d=b[c];"preload"===d.rel&&"style"===d.getAttribute("as")&&(a.loadCSS(d.href,d,d.getAttribute("media")),d.rel=null)}},!b.support()){b.poly();var c=a.setInterval(b.poly,300);a.addEventListener&&a.addEventListener("load",function(){b.poly(),a.clearInterval(c)}),a.attachEvent&&a.attachEvent("onload",function(){a.clearInterval(c)})}}}(this);</script></head><body><div class="container"><ol class="breadcrumb"><li><a href="../index.html" class="glyphicon glyphicon-home"></a></li><li><a href="f-65.html">NSIS Discussion</a></li><li class="active">MUI_FINISHPAGE_RUN Problem</li></ol><p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=115867">MUI_FINISHPAGE_RUN Problem</a></p><br><div class="post"><p class="post-meta"><span class="post-author text-primary">YsFred4</span><br><span class="post-time small text-muted">28th November 2002 02:11 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>MUI_FINISHPAGE_RUN Problem</strong><br>I have an installer where the finish page run progam needs to have a parameter to run correctly. I have tried all of the combinations of ' and " and $\" and none of them work correctly. I can run the same command from an Exec command.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Joost Verburg</span><br><span class="post-time small text-muted">28th November 2002 09:54 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">The Modern UI already puts quotes around the whole string, to prevent problems on Win9x.<br><br>Try:<br><br></p><pre>
<code><br>!define MUI_FINISHPAGE_RUN "Program.exe$\" $\"Parameter"<br></code>
</pre>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">YsFred4</span><br>
      <span class="post-time small text-muted">28th November 2002 11:24 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">The problem is that does some strnage things. It actually changed the parameter filename. Here is what the makeNSISW shows:<br>
      <br></p>
      <pre>
<code>!define: "MUI_FINISHPAGE_RUN"="$INSTDIR\program.exe" "$INSTDIR\parameter.ysf8"</code>
</pre><br>
      <br>
      The final 8 is not what I have in the script. If I add a space after the ysf then the filename ends up being right, but it still does not work. In either case the My Computer comes up and not the application.
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Joost Verburg</span><br>
      <span class="post-time small text-muted">28th November 2002 15:27 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Because you can also use Language Strings, the Modern UI copies the value to a variable and adds quotes.<br>
      <br>
      Did you try my code?</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">YsFred4</span><br>
      <span class="post-time small text-muted">28th November 2002 15:34 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Yep. the posting is the result that the makeNSISW window shows when I used your code. Here is the code that I used:<br>
      <br></p>
      <pre>
<code>!define MUI_FINISHPAGE_RUN "$INSTDIR\program.exe$\" $\"$INSTDIR\${SHORTNAME}.ysf"</code>
</pre><br>
      All it does is bring up explorer at the My Computer level.
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Joost Verburg</span><br>
      <span class="post-time small text-muted">28th November 2002 15:41 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">I think I found the bug. Wait a sec, I'll upload a new version.<br>
      <br>
      edit: Ok, done. Note that you also have download the latest NSIS source and recompile NSIS, because of another related bug :)</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">YsFred4</span><br>
      <span class="post-time small text-muted">28th November 2002 16:19 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Well I tried it out and it is still not working. I put a MessageBox in teh system script file to see what it was trying to execute and it showed an empty string. I have to get going now, but I hope that we can figure this out soon.</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br>
      <span class="post-time small text-muted">28th November 2002 16:45 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">It's working. I double checked it. Use the latest version from CVS. You will have to recompile makensis because there are some other stuff in progress so I couldn't upload a copmiled version.<br>
      <br>
      Hmm... Well, at least my part of the bug ;)</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">YsFred4</span><br>
      <span class="post-time small text-muted">28th November 2002 19:15 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Thanks. I will give it a shot when I get back home.</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">YsFred4</span><br>
      <span class="post-time small text-muted">29th November 2002 12:49 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Well I made 1 change to the system.nsh file to get it to work now.<br>
      <br></p>
      <pre>
<code>StrCpy ${MUI_TEMP1} '${MUI_FINISHPAGE_RUN}'</code>
</pre><br>
      <br>
      Using the single quotes there instead of the double quotes fixed my issue. Plus the other one that you fixed to have it not put extra characters in help alot too.
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Joost Verburg</span><br>
      <span class="post-time small text-muted">29th November 2002 16:56 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">That means that you are using double quotes in your string. You should escape 'em all using $\".</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">YsFred4</span><br>
      <span class="post-time small text-muted">30th November 2002 03:40 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">This is my exact string... no edits.<br>
      <br></p>
      <pre>
<code>!define MUI_FINISHPAGE_RUN "$INSTDIR\clockdown.exe$\" $\"$INSTDIR\${SHORTNAME}.ysf"<br></code>
</pre><br>
      <br>
      This does not work unless I make the system change. As you can see they are escapes. I think that the fact that the string goes thru a StrCpy and then the Exec might have something to do with it. It works now, so I am not too worried.
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Joost Verburg</span><br>
      <span class="post-time small text-muted">6th December 2002 12:20 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">When parsing the defines, the compiler already converts the escapes. I think that should be changed.</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">YsFred4</span><br>
      <span class="post-time small text-muted">6th December 2002 15:05 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Glad to hear why its doing it. I love the look and feel of the modern UI. I keep releasing new products about every week or two with it. With over 85K downloads in the last 7 months, there have been no complaints of NSIS at all.</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Joost Verburg</span><br>
      <span class="post-time small text-muted">6th December 2002 15:43 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">An updated version of the Modern UI with an additional define for parameters will be uploaded soon.</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Joost Verburg</span><br>
      <span class="post-time small text-muted">6th December 2002 16:54 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Done :D Please check it, because beta 0 will be realeased today :)</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">YsFred4</span><br>
      <span class="post-time small text-muted">6th December 2002 18:30 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">When is the release? I might not be able to get to it until about 7-8pm EST. If I need to check sooner I can, just need to know.</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Joost Verburg</span><br>
      <span class="post-time small text-muted">6th December 2002 18:43 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">It will be released in about an hour. But it's ok, I've tested it :D</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">YsFred4</span><br>
      <span class="post-time small text-muted">6th December 2002 18:52 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Ok. Thanks for all the work Joost.</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">YsFred4</span><br>
      <span class="post-time small text-muted">7th December 2002 02:53 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">It works great now. Thanks.</p>
    </div>
    <hr>

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]></script></body></html>