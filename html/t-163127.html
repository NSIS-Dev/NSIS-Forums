<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="Unistall silent option and desktop refresh" />

  <title>Unistall silent option and desktop refresh - NSIS Forums</title><!-- Bootstrap core CSS -->
  <link rel="stylesheet" type="text/css" href="//netdna.bootstrapcdn.com/bootswatch/3.0.1/readable/bootstrap.min.css" />
  <link rel="stylesheet" href="../css/style.css" type="text/css" /><!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!--[if lt IE 9]>
                <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
                <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->
</head>

<body>
  <div class="container">
    <!-- Put navigation bar here -->

    <ol class="breadcrumb">
      <li><a href="../index.html" class="glyphicon glyphicon-home"></a></li>

      <li><a href="f-65.html">NSIS Discussion</a></li>

      <li class="active">Unistall silent option and desktop refresh</li>
    </ol>

    <p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=163127">Unistall silent option and desktop refresh</a></p><br />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Raj2003</span><br />
      <span class="post-time small text-muted">4th January 2004 02:49 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>Unistall silent option and desktop refresh</strong><br />
      Hi,<br />
      <br />
      NSIS Version: NSIS20a7<br />
      <br />
      When user install a new version, I check the user already has older version of our product so that I can do a upgrade. Here upgrade is install new version and uninstall the older version!<br />
      <br />
      All works fine if I do the followng:<br />
      1. install new version<br />
      ExecWait '"$0\Uninstall.exe" _=$0'<br />
      2. uninstall older version.<br />
      <br />
      If the do the following, I get the desktop refresh issue:<br />
      1. install new version<br />
      ExecWait '"$0\Uninstall.exe" /S _=$0'<br />
      2. uninstall /S older version - now my destop icon is still displayed and if I do a manual refresh it goes away (right mouse button on desktop and clik "Refresh"). So the uninstall works fine but no refresh!<br />
      <br />
      NOTE: Without /S option it refreshes properly.<br />
      <br />
      In my *.nsi script I tried the following to refresh the desktop by SendMessage:<br />
      SendMessage 65535 26 0 0 ;<br />
      <br />
      Screen flikers (refresh happens) but my old Icon is still visible.<br />
      <br />
      Someone help me to resolve this issue.<br />
      <br />
      Thanks....<br />
      Raj<br />
      :D</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Joost Verburg</span><br />
      <span class="post-time small text-muted">4th January 2004 11:14 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">That is weird. Are you the code is executed succesfully? Try to add a messagebox.<br />
      <br />
      You are also using a very old alpha version of NSIS 2. Upgrading is highly recommended.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Raj2003</span><br />
      <span class="post-time small text-muted">5th January 2004 03:31 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Installed the latest NSIS 2.0 RC1 and tested the same, It seems the problem still exists.<br />
      <br />
      Any quick fix?<br />
      <br />
      Thanks,<br />
      Raj</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Joost Verburg</span><br />
      <span class="post-time small text-muted">5th January 2004 08:10 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Can you post the script code? The desktop should refresh automatically. Maybe it's a problem with your system, try another computer.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">scully13</span><br />
      <span class="post-time small text-muted">9th June 2004 13:22 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">I couldn't get the "SendMessage 65535 26 0 0" to work either from a script. So, I wrote a DLL to refresh the desktop for me. I've attached it here with source if anybody else needs it. I only tested it under Win XP Pro so if anybody has any problems with it let me know. I also included an example script that creates 2 shortcuts on the desktop but 3 show up. Then it refreshes the desktop to only show the 2 that should be there. The bug appears to be a Windows bug because you can recreate the same problem by manually creating the shortcuts too. There are other instances that will cause the desktop shortcuts to mess up but this eaxmple was the easiest to recreate and test with.</p>
    </div>
    <hr />

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]>
  </script>
</body>
</html>
