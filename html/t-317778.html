<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="description" content="Silent Installer Return"><title>Silent Installer Return - NSIS Forums</title><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script><link rel="preload" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css" as="style" onload="this.rel='stylesheet'"><link rel="preload" href="../css/style.css" as="style" onload="this.rel='stylesheet'"><noscript><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css"><link rel="stylesheet" href="../css/style.css"></noscript><script>!function(a){"use strict";var b=function(b,c,d){function e(a){return h.body?a():void setTimeout(function(){e(a)})}function f(){i.addEventListener&&i.removeEventListener("load",f),i.media=d||"all"}var g,h=a.document,i=h.createElement("link");if(c)g=c;else{var j=(h.body||h.getElementsByTagName("head")[0]).childNodes;g=j[j.length-1]}var k=h.styleSheets;i.rel="stylesheet",i.href=b,i.media="only x",e(function(){g.parentNode.insertBefore(i,c?g:g.nextSibling)});var l=function(a){for(var b=i.href,c=k.length;c--;)if(k[c].href===b)return a();setTimeout(function(){l(a)})};return i.addEventListener&&i.addEventListener("load",f),i.onloadcssdefined=l,l(f),i};"undefined"!=typeof exports?exports.loadCSS=b:a.loadCSS=b}("undefined"!=typeof global?global:this);!function(a){if(a.loadCSS){var b=loadCSS.relpreload={};if(b.support=function(){try{return a.document.createElement("link").relList.supports("preload")}catch(b){return!1}},b.poly=function(){for(var b=a.document.getElementsByTagName("link"),c=0;c<b.length;c++){var d=b[c];"preload"===d.rel&&"style"===d.getAttribute("as")&&(a.loadCSS(d.href,d,d.getAttribute("media")),d.rel=null)}},!b.support()){b.poly();var c=a.setInterval(b.poly,300);a.addEventListener&&a.addEventListener("load",function(){b.poly(),a.clearInterval(c)}),a.attachEvent&&a.attachEvent("onload",function(){a.clearInterval(c)})}}}(this);</script></head><body><div class="container"><ol class="breadcrumb"><li><a href="../index.html" class="glyphicon glyphicon-home"></a></li><li><a href="f-65.html">NSIS Discussion</a></li><li class="active">Silent Installer Return</li></ol><p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=317778">Silent Installer Return</a></p><br><div class="post"><p class="post-meta"><span class="post-author text-primary">Zilatica</span><br><span class="post-time small text-muted">16th March 2010 23:10 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>Silent Installer Return</strong><br>Is there a way to make a silent install block until completed and return a value? For example, I want to silently run my install from the command line (batch file) and return 0 for success and 1 or more to represent a failure.<br><br>Is this possible?</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Animaether</span><br><span class="post-time small text-muted">16th March 2010 23:32 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Whether your installer 'blocks' until completed depends on your batch file method. By default, it should wait for your installer to exit.<br>( There are some batch utilities that let you run a program and continue with the batch process even while that program is still running - you'd have to look into their documentation on how to stop this ).<br><br>To set a return value, see the SetErrorLevel instruction.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br><span class="post-time small text-muted">18th March 2010 23:48 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Use start /wait<br><br>Stu</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Zilatica</span><br><span class="post-time small text-muted">4th May 2010 23:05 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">I'm calling the uninstaller.exe silently from another installer, both generated from nsis. I call the uninstaller.exe using ExecWait, but ExecWait doesn't block (or rather I don't think the uninstaller blocks).<br><br>To verify this I added a sleep command for 1 minute. Then on the installer I wrapped the Exec wait call with message boxes and they happen one right after the other, with no 1 minute delay. I verified the uninstaller indeed blocks for one minute even silently by calling it from the command line. The files it is uninstalling get removed after about a minute.<br><br>So, again, can you explain how to make a silent uninstaller block until it completes executing? Are there some make nsis flags I have to pass, or perhaps a directive at the top of my script?<br><br><br><br>Thanks,<br>Zach</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Zilatica</span><br><span class="post-time small text-muted">4th May 2010 23:07 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Eh, I don't mean the uninstaller blocks, I mean there is a 1 minute delay after calling the uninstaller before the side effects (files removed) happen.<br><br>The uninstaller has the 1 minute delay before performing actions, but the installer's "ExecWait" which calls upon this uninstaller doesn't wait for this 1 minute delay, meaning the execwait isn't blocking until completion of the uninstaller.<br><br>I need this for an upgrade sequence I'm writing. Basically, I install version 1.0.0, then I want to run installer for 1.0.1 which will run the uninstaller of 1.0.0 with flags passed to leave the data intact, followed by installing the 1.0.1 files.<br><br>Can you help?</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Zilatica</span><br><span class="post-time small text-muted">4th May 2010 23:14 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">I also read from the NSIS.chm (D.1 Error Levels):<br>Note that uninstallers copy themselves to the temporary directory and execute from there so the original uninstaller can be deleted. This means the error level the uninstaller sets is not available to the executing process, unless it simulates this copy process and executes the copied uninstaller.<br><br>So, the uninstaller may not be blocking because it is being copied and then executed as a spawned process executing from another location. Can I, myself, call this extraction and manage it so that I can achieve the blocking behavior?</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br><span class="post-time small text-muted">5th May 2010 09:49 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><a href="http://nsis.sourceforge.net/When_I_use_ExecWait_uninstaller.exe_it_doesn%27t_wait_for_the_uninstaller" target="_blank">http://nsis.sourceforge.net/When_I_u...he_uninstaller</a><br><br>Stu</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Zilatica</span><br><span class="post-time small text-muted">5th May 2010 14:35 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">You sir, are the shiznit.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Zilatica</span><br><span class="post-time small text-muted">5th May 2010 22:35 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">So, one last quick question. Is there a way to do the same thing with the installer.exe? The /D="path" for installer doesn't do it and neither does the _?="path"<br><br>Basically, you know of a page that you can point me to that will tell me how to make the ExecWait block for the installer?</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br><span class="post-time small text-muted">5th May 2010 23:25 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">It does block unless the installer you are launching has been scripted to do otherwise (i.e. launch another process). It is only the uninstaller that does this by default (by copying itself to a temp folder and re-executing itself from there).<br><br>Stu</p></div><hr><div class="footer"><p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p></div></div><script type="text/javascript" src="../js/highlight.pack.js" async></script><script type="text/javascript">//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]></script></body></html>