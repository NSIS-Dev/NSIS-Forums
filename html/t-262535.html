<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="ExecWait: Bypass Executed Wrapper and Capture Actual Setup?" />

  <title>ExecWait: Bypass Executed Wrapper and Capture Actual Setup? - NSIS Forums</title>
  <script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script>
  <!-- Bootstrap core CSS -->

  <link rel="stylesheet" type="text/css" href="//netdna.bootstrapcdn.com/bootswatch/3.0.1/readable/bootstrap.min.css" />
  <link rel="stylesheet" href="../css/style.css" type="text/css" /><!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!--[if lt IE 9]>
                <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
                <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->
</head>

<body>
  <div class="container">
    <!-- Put navigation bar here -->

    <ol class="breadcrumb">
      <li><a href="../index.html" class="glyphicon glyphicon-home"></a></li>

      <li><a href="f-65.html">NSIS Discussion</a></li>

      <li class="active">ExecWait: Bypass Executed Wrapper and Capture Actual Setup?</li>
    </ol>

    <p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=262535">ExecWait: Bypass Executed Wrapper and Capture Actual Setup?</a></p><br />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Red Wine</span><br />
      <span class="post-time small text-muted">27th December 2006 05:32 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>Exec: Bypass Executed Wrapper and Capture Actual Setup?</strong><br />
      Hi,<br />
      what I'm trying to achieve is this: As you probably know, Firefox uses NSIS to install, though, the actual installer is wrapped into a 7z sfx module that extracts the installer in $TEMP, execute it and then removes the files from $TEMP and terminates. This wrapper always returns 0, even if the user has canceled the installation.<br />
      In my setup, I download firefox, install it, and continue the installation depended that firefox is already successfully installed. I prefer to show firefox installation window to the end users, so they have the choise to select installation's options, rather than execute the firefox installer silently with -ms parameter. The problem here is this, if for some reason, the end users cancel firefox installation, I'm not able to capture it, because the wrapper returns 0 anyway.<br />
      I'm thinking of 2 works around of this issue. The 1st is after firefox installer execution to read the registry and find if firefox installed/updated, if not, then halt my setup and pop up a warning. This one I can achieve easily.<br />
      The 2nd is to exec the wrapper and start a loop over the actual firefox installer window while it is running, and grab its output once the window is closed. This is what actually I'm trying to achieve.<br />
      As mentioned, this window is a NSIS installer, so when it closes it returns errorlevel. So, how I would be able to capture this output from my NSIS installer?<br />
      Suggestions are welcome plz.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
      <span class="post-time small text-muted">29th December 2006 10:30 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">For this specific case, I don't know any switches you can pass the wrapper so it'd wait for the internal setup. But as you know what the wrapper is, you can unwrap it yourself using 7z.exe and then execute the internal setup using ExecWait. For other cases, there's <a href="http://unattended.sourceforge.net/installers.php" target="_blank">unattended</a>.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Red Wine</span><br />
      <span class="post-time small text-muted">29th December 2006 11:25 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"></p>

      <blockquote>
        But as you know what the wrapper is, you can unwrap it yourself using 7z.exe and then execute the internal setup using ExecWait.
      </blockquote>Hi kichik,<br />
      Always glad to see you around :-)<br />
      I'm afraid the work around you mentioned is the obvious one, that's why I haven't think about it :-)<br />
      <br />
      BTW 1 Plz let me know what you suggest as more accurate work around, this one or the registry thing that I mentioned above?<br />
      <br />
      BTW 2 I have another desperate query here <a href="http://forums.winamp.com/showthread.php?s=&amp;threadid=262083" target="_blank">http://forums.winamp.com/showthread....hreadid=262083</a> , could you take a look if you don't mind?<br />
      <br />
      regards
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
      <span class="post-time small text-muted">29th December 2006 12:32 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Unpacking the internal setup is much safer and easier to do. Instead of looping through the registry, you simply ExecWait.</p>
    </div>
    <hr />

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]>
  </script>
</body>
</html>
