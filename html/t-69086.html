<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="How to make MyApp that install with NSIS list in system restore point?" />

  <title>How to make MyApp that install with NSIS list in system restore point? - NSIS Forums</title>
  <script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script>
  <!-- Bootstrap core CSS -->

  <link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css" />
  <link rel="stylesheet" href="../css/style.css" type="text/css" /><!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!--[if lt IE 9]>
                <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
                <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->
</head>

<body>
  <div class="container">
    <!-- Put navigation bar here -->

    <ol class="breadcrumb">
      <li><a href="../index.html" class="glyphicon glyphicon-home"></a></li>

      <li><a href="f-65.html">NSIS Discussion</a></li>

      <li class="active">How to make MyApp that install with NSIS list in system restore point?</li>
    </ol>

    <p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=69086">How to make MyApp that install with NSIS list in system restore point?</a></p><br />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Didin17</span><br />
      <span class="post-time small text-muted">18th December 2001 05:02 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>How to make MyApp that install with NSIS list in system restore point?</strong><br />
      How to make MyApp that install with NSIS list in system restore point, like in Win ME or Win XP<br />
      <br />
      I'm sorry about my English.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">DuaneJeffers</span><br />
      <span class="post-time small text-muted">18th December 2001 06:03 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">From my knowledge of WinME/XP, the system restore function is built in to the Windows Kernel and it just checks to see and restore to a better version. System Restore doesn't check programs and things. (I had an experience with this. When I was done, I was using NSIS v 1.1j ... When I was supposed to have NSIS Version 1.44. And I had no MS Word, so anything can happen).<br />
      <br />
      -Duane</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">prodangle</span><br />
      <span class="post-time small text-muted">23rd December 2001 15:21 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">With System restore, windows simply reverts back to the state the system was in the last time a restore point was created, so you'd have to create a restore point just after installing your app. As for creating a restore point, I have no idea how - but I imagine if there was a way it would add a good 15 minutes onto the programs installation time. If that's going to happen - you'd be as well to use Microsoft's own installer. I imagine it would handle the system restore stuff a lot better and wouldn't miss anything out. Otherwise, you could simply show a messagebox asking whether the user would like to create a restore point, and if so run<br />
      <br />
      %SystemRoot%\System32\restore\rstrui.exe<br />
      <br />
      I believe this will be at a differant location for win me<br />
      <br />
      First you'd obviously have to check that the OS the person is using supports system restore, and whether or not it is turned on (I always turn system restore off). You could use the OS detection script found in functions.htm for the first bit, and check the following reg key to see whether it is turned on or not<br />
      <br />
      HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows NT\CurrentVersion\SystemRestore\DisableSR: 0x00000001<br />
      <br />
      My advice would be don't bother though. If your application isn't so clunky that it might actually do damage to the operating system, then a simple uninstall should be good enough :)</p>
    </div>
    <hr />

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]>
  </script>
</body>
</html>
