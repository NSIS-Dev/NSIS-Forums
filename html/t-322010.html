<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="Delay between uninstall and upgrade" />

  <title>Delay between uninstall and upgrade - NSIS Forums</title><!-- Bootstrap core CSS -->
  <link rel="stylesheet" type="text/css" href="//netdna.bootstrapcdn.com/bootswatch/3.0.1/readable/bootstrap.min.css" />
  <link rel="stylesheet" href="../css/style.css" type="text/css" /><!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!--[if lt IE 9]>
                <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
                <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->
</head>

<body>
  <div class="container">
    <!-- Put navigation bar here -->

    <ol class="breadcrumb">
      <li><a href="../index.html" class="glyphicon glyphicon-home"></a></li>

      <li><a href="f-65.html">NSIS Discussion</a></li>

      <li class="active">Delay between uninstall and upgrade</li>
    </ol>

    <p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=322010">Delay between uninstall and upgrade</a></p><br />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">burroughs123</span><br />
      <span class="post-time small text-muted">27th August 2010 14:59 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>Delay between uninstall and upgrade</strong><br />
      During an upgrade, I uninstall the previous version of the software silently (using: ExecWait '"$INSTDIR\uninstaller.exe" /S _?=$INSTDIR') then install the latest software. There is around a 30-40 second time period between the time when the uninstall is removing files and when the Welcome dialog appears for the new installer. During this time, there is no GUI interface showing the end user that anything is happening. Is there any way to display a dialog from the new installer detailing that the uninstall is taking place? Some end users may just rerun the new installer. Please note that before the upgrade (uninstall old software then install new software) occurs a Message Box prompts the user to confirm upgrading the software.<br />
      <br />
      thanks for your time,<br />
      Steve</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">demiller9</span><br />
      <span class="post-time small text-muted">27th August 2010 15:57 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">The message box that confirms they want to upgrade could warn them about the delay before the Welcome screen appears. Personally, I think the uninstall shouldn't happen until they press "Install" on some later screen. I think they should be able to see all the screens and cancel if they don't want to run the new installer.<br />
      <br />
      Don</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
      <span class="post-time small text-muted">27th August 2010 16:02 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Show a Banner (Banner plug-in included with NSIS)?<br />
      <br />
      Edit: and demiller9 has a good point. You should never touch the system until after they click Install.<br />
      <br />
      Stu</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Animaether</span><br />
      <span class="post-time small text-muted">27th August 2010 16:17 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">The way I've solved this is by making the silent uninstall be optionally not-so-silent.<br />
      <br />
      I.e.<br />
      A. if a user really, really wanted to.. they could execute the uninstaller silently and they truly wouldn't see a thing.<br />
      B. if the user simply launches the uninstaller (via control panel, start menu, or launching directly), they get the full-blown GUI.<br />
      C. if my installer launches the uninstaller as part of its proceedings, it adds a little flag on the command line. That tells the uninstaller that it should skip all the pages and such asking if the user really wants to uninstall and that they're welcome to re-install at a later time, defaults the uninstaller to keeping the registry settings on installation location (no-brainer there)... -but- still presents the UninstFiles page so that the user can see what's going on and can see progress of uninstallation.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">burroughs123</span><br />
      <span class="post-time small text-muted">27th August 2010 16:29 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Thank you for all the suggestions.</p>
    </div>
    <hr />

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]>
  </script>
</body>
</html>
