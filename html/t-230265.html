<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="Add/Remove Programm registry information" />

  <title>Add/Remove Programm registry information - NSIS Forums</title><!-- Bootstrap core CSS -->
  <link rel="stylesheet" type="text/css" href="//netdna.bootstrapcdn.com/bootswatch/3.0.1/readable/bootstrap.min.css" />
  <link rel="stylesheet" href="../css/style.css" type="text/css" /><!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!--[if lt IE 9]>
                <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
                <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->
</head>

<body>
  <div class="container">
    <!-- Put navigation bar here -->

    <ol class="breadcrumb">
      <li><a href="../index.html" class="glyphicon glyphicon-home"></a></li>

      <li><a href="f-65.html">NSIS Discussion</a></li>

      <li class="active">Add/Remove Programm registry information</li>
    </ol>

    <p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=230265">Add/Remove Programm registry information</a></p><br />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Comm@nder21</span><br />
      <span class="post-time small text-muted">6th November 2005 16:50 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>Add/Remove Programm registry information</strong><br />
      i revisited chapter <b>D.2 Add uninstall information to Add/Remove Programs</b> from NSIS manual and added more information i found in my registry :)<br />
      <br />
      so this is the new sheet:<br /></p>

      <blockquote>
        Required values<br />
        <br />
        DisplayName (string) - Name of the application<br />
        UninstallString (string) - Path and filename of the uninstaller. You should always quote the path to make sure spaces in the path will not disrupt Windows to find the uninstaller.<br />
        <br />
        <br />
        Optional values<br />
        <br />
        Some of the following values will not be used by older Windows versions.<br />
        <br />
        InstallLocation (string) - Installation directory ($INSTDIR)<br />
        InstallSource (string) - Location where the application was installed from<br />
        InstallDate (string) - Date on which the installation took place, format: YYYYMMDD (maybe based on OS localisation)<br />
        <br />
        DisplayIcon (string) - Path, filename and index of the icon that will be displayed next to your application name<br />
        DisplayVersion (string) - Displayed version of the application<br />
        <br />
        EstimatedSize (DWORD) - Size whitch the application uses on the harddrive<br />
        <br />
        Publisher (string) - (Company) name of the publisher<br />
        Contact (string) - Contact information<br />
        ProductID (string) - Product ID of the application<br />
        Comments (string) - Comments that will be shown under "Support Information"<br />
        Readme (string) - Readme in plaintext or as URL (file://C:\readme.txt is a valid URL)<br />
        Language (DWORD) - Language ID of the programm, same as in NSIS<br />
        <br />
        ModifyPath (string) - Path and filename of the application modify program<br />
        RepairPath (string) - Path and filename of the application repair program<br />
        <br />
        RegOwner (string) - Registered owner of the application<br />
        RegCompany (string) - Registered company of the application<br />
        <br />
        HelpLink (string) - Link to the support website<br />
        HelpTelephone (string) - Telephone number for support<br />
        <br />
        URLUpdateInfo (string) - Link to the website for application updates<br />
        URLInfoAbout (string) - Link to the application home page<br />
        <br />
        Version (DWORD) - Version number of the application<br />
        VersionMajor (DWORD) - Major version number of the application<br />
        VersionMinor (DWORD) - Minor version number of the application<br />
        <br />
        NoModify (DWORD) - 1 if uninstaller has no option to modify the installed application<br />
        NoRepair (DWORD) - 1 if the uninstaller has no option to repair the installation<br />
        <br />
        Note: If both NoModify and NoRepair are set to 1 and ModifyPath is set, the button displays "Remove" instead of "Modify/Remove".<br />
        <br />
        <br />
        Patches only:<br />
        (requires WinXP SP2 or Win2003 SP1 or greater)<br />
        <br />
        ParentDisplayName (string) - Name of application which is patched by this one<br />
        ParentKeyName (string) - Name of key this one is a child of<br />
        <br />
        Note: If both ParentDisplayName and ParentKeyName are set, the application is hidden as long as "Show Updates" is unchecked in the Add/Remove dialog.
      </blockquote>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Animaether</span><br />
      <span class="post-time small text-muted">6th November 2005 19:26 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">With regards to EstimatedSize, could you review the following Talk: page ?<br />
      <a href="http://nsis.sourceforge.net/Talk:Add_uninstall_information_to_Add/Remove_Programs" target="_blank">http://nsis.sourceforge.net/Talk:Add...emove_Programs</a><br />
      <br />
      by the way, typo in the descriptions: "whitch" = "which"</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">deguix</span><br />
      <span class="post-time small text-muted">7th November 2005 04:00 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Next time, Animaether, start discussions in the forum, not in the wiki. You know the wiki is not good for the purpose of posting messages. I'll quote the question here and delete that talk page.<br />
      <br /></p>

      <blockquote>
        <i>Originally posted by Animaether</i><br />
        <b>[The "Add uninstall information to Add/Remove Programs" wiki page] unfortunately doesn't cover setting the application size for the Add/Remove programs dialog. This size is reported on the Add/Remove programs page and can be used to sort by size, for example. If not supplied, you may see such magical sizes as 500GB for a 2MB program.<br />
        <br />
        I found the following information:<br />
        The first is to set the EstimatedSize key to a hex value representing your application's size in bytes;<br />
        WriteRegDWORD ROOT_KEY "UNINSTKEY" "EstimatedSize" 0x002625A0 ; 2.5MB in hex<br />
        <br />
        However, from the page I got it from, it becomes clear that Windows may just pick a size willy-nilly due to it 'finding' your application elsewhere (i.e. not your application!)<br />
        <a href="http://blogs.msdn.com/oldnewthing/archive/2004/07/09/178342.aspx" target="_blank">http://blogs.msdn.com/oldnewthing/ar...09/178342.aspx</a><br />
        <br />
        This is partially due to the A(dd) R(emove) P(rograms) cache.<br />
        So the second is that ARP cache information should be written to as well :<br />
        <a href="http://forums.winamp.com/showthread.php?threadid=128462&amp;highlight=estimatedsize" target="_blank">http://forums.winamp.com/showthread....=estimatedsize</a><br />
        <br />
        However, from that thread it is evident that you need a plugin and some pretty nasty manual coding to get it to work - assuming it works at all as the thread doesn't say.<br />
        <br />
        Any thoughts on handling this properly ?</b>
      </blockquote>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Animaether</span><br />
      <span class="post-time small text-muted">7th November 2005 04:14 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Yeah, I added it there because...<br />
      1. I was new here %)<br />
      and<br />
      2. Typically, that's what a wiki's Discussion/Talk page is for - discussing that particular wiki page ;)<br />
      also<br />
      3. There didn't appear to -be- any thread on these forums dealing with add/remove programs information as far as displaying the size of the installation goes :)<br />
      <br />
      Thanks for the move, though :)</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Comm@nder21</span><br />
      <span class="post-time small text-muted">8th November 2005 14:28 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">*up*<br />
      <br />
      is this going to be included in the official docs, or should i rather create a wiki page?</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
      <span class="post-time small text-muted">8th November 2005 19:54 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Can you please attach that as a patch to Docs\src\usefulinfos.but?</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">deguix</span><br />
      <span class="post-time small text-muted">8th November 2005 21:05 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"></p>

      <blockquote>
        2. Typically, that's what a wiki's Discussion/Talk page is for - discussing that particular wiki page
      </blockquote>Well, ok. Maybe I should have left that page intact then. But people don't usually watch the recent changes page in the wiki. Also, wiki is too poor when organizing who posted what, even when you put your name: anyone could edit someone else's question, which is not good at all, in my opinion.<br />
      <br />
      Maybe a rating system should be set up in the future so that people wouldn't have their comments edited by someone else, except by a sysop user.
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">stb</span><br />
      <span class="post-time small text-muted">10th November 2005 10:36 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Regarding the "new" keys:<br />
      <br />
      Are these Microsoft keys? I mean, are they used (maybe in future) by Windows? I did some research myself some time ago and added a few more info than could be found in MSDN to the Uninstall section. But many installers add there own keys, and this is what I want to avoid.<br />
      <br />
      So what about RepairPath, Version*, ProductID and Reg*?<br />
      <br />
      And: InstallSource and Language seem to be used by Microsoft and many others, but are they evaluated by something else than Uninstallers?<br />
      <br />
      And: QuietUninstallString may be useful, too.</p>
    </div>
    <hr />

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]>
  </script>
</body>
</html>
