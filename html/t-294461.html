<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="Notice/Message before a page.." />

  <title>Notice/Message before a page.. - NSIS Forums</title><!-- Bootstrap core CSS -->
  <link rel="stylesheet" type="text/css" href="//netdna.bootstrapcdn.com/bootswatch/3.0.1/readable/bootstrap.min.css" />
  <link rel="stylesheet" href="../css/style.css" type="text/css" /><!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!--[if lt IE 9]>
                <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
                <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->
</head>

<body>
  <div class="container">
    <!-- Put navigation bar here -->

    <ol class="breadcrumb">
      <li><a href="../index.html" class="glyphicon glyphicon-home"></a></li>

      <li><a href="f-65.html">NSIS Discussion</a></li>

      <li class="active">Notice/Message before a page..</li>
    </ol>

    <p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=294461">Notice/Message before a page..</a></p><br />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">XxXGoD</span><br />
      <span class="post-time small text-muted">14th July 2008 01:26 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>Notice/Message before a page..</strong><br />
      How can i put a message up just before the directory page apears... cos i want to tell them something before it apears or when it apears...</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">LoRd_MuldeR</span><br />
      <span class="post-time small text-muted">14th July 2008 01:29 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Use the page show_function or pre_function!<br />
      <br />
      More info at "4.5.4 Page" in the documentation ;)</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">XxXGoD</span><br />
      <span class="post-time small text-muted">14th July 2008 03:13 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">I added:<br />
      <br />
      <br />
      Function .onVerifyInstDir<br />
      MessageBox MB_OK "My message"<br />
      FunctionEnd<br />
      <br />
      <br />
      But it shows at end of component page and start of directory page...</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">yelkrebb</span><br />
      <span class="post-time small text-muted">14th July 2008 03:30 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Maybe this will help.<br />
      <br />
      MUI_PAGE_CUSTOMFUNCTION_PRE MyMessage<br />
      MUI_PAGE_DIRECTORY<br />
      <br />
      Function MyMessage<br />
      MessageBox MB_OK "My message"<br />
      FunctionEnd<br />
      <br />
      ~Berks</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">XxXGoD</span><br />
      <span class="post-time small text-muted">14th July 2008 03:32 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Ermm, Im using ExperienceUI<br />
      <br />
      SO MUI_PAGE_DIRECTORY...etc dont work</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">yelkrebb</span><br />
      <span class="post-time small text-muted">14th July 2008 03:35 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">I see.. Sorry.<br />
      <br />
      How about this one..<br />
      <br />
      !define XPUI_PAGE_CUSTOMFUNCTION_PRE MyMessage<br />
      !insertmacro XPUI_PAGE_DIRECTORY<br />
      <br />
      Function MyMessage<br />
      MessageBox MB_OK "My message"<br />
      FunctionEnd<br />
      <br />
      ~Berks</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">LoRd_MuldeR</span><br />
      <span class="post-time small text-muted">14th July 2008 03:49 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"></p>

      <blockquote>
        <i>Originally posted by XxXGoD</i><br />
        <b>I added:<br />
        <br />
        <br />
        Function .onVerifyInstDir<br />
        MessageBox MB_OK "My message"<br />
        FunctionEnd<br />
        <br />
        <br />
        But it shows at end of component page and start of directory page...</b>
      </blockquote>The .onVerifyInstDir function will be called every time the user changes the directory on the directory page. It will be called even when the user changes only one single character of the directory. And it will be called when a new folder is highlighted in the "Browse..." dialog. Therefore this function is not suitable for displaying message boxes. Make a custom "pre_function" as described in chapter "4.5.4 Page" of the NSIS manual. Reading the manual can help a lot...<br />
      <br />
      You must do it like:<br />
      <br />
      <pre>
<code>; pages<br />page directory MyPreDirectoryFunction<br /><br />[..]<br /><br />Function MyPreDirectoryFunction<br />  MessageBox MB_OK "Be warned, you'll have to choose a directory now!"<br />FunctionEnd</code>
</pre>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">XxXGoD</span><br />
      <span class="post-time small text-muted">14th July 2008 13:55 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">LoRd_MuldeR<br />
      <br />
      That doesn't work for me.<br />
      <br />
      <br />
      yelkrebb that pops up one and works for me but i cant seem to make it pop up at the directory page, it pops up at the start just after my spash screen</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">LoRd_MuldeR</span><br />
      <span class="post-time small text-muted">14th July 2008 14:34 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">My code is correct, though ExperienceUI does hide the actual "page" commands in it's macros! So you will have to use the Syntax provided by ExperienceUI instead of the "native" NSIS syntax in that case. Should be documented in the ExperienceUI manual...<br />
      <br />
      This is how I think it should work:<br /></p>
      <pre>
<code>; page macros<br />!define XPUI_PAGE_CUSTOMFUNCTION_PRE MyMessage<br />!insertmacro XPUI_PAGE_DIRECTORY<br /><br />; custom functions<br />Function MyMessage<br />  MessageBox MB_OK "My message"<br />FunctionEnd</code>
</pre><br />
      <br />
      Make sure you put the XPUI_PAGE_CUSTOMFUNCTION_PRE define *directly* before the XPUI_PAGE_DIRECTORY macro! Do *not* put any other page macros in between! That's at least how it works with MUI, MUI2 and UMUI...
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">XxXGoD</span><br />
      <span class="post-time small text-muted">14th July 2008 15:03 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"></p>
      <pre>
<code>!insertmacro: XPUI_PAGE_DIRECTORY<br />!insertmacro: XPUI_PAGECHECKS<br />Call must be used with function names starting with "un." in the uninstall section.<br />Usage: Call function_name | [:label_name]<br />Error in macro XPUI_PAGE_CUSTOMFUNCTION on macroline 3<br />Error in macro XPUI_PAGE_DIRECTORY on macroline 38<br />Error in script "C:\Documents and Settings\Ryan\Desktop\h1o.nsi" on line 110 -- aborting creation process</code>
</pre><br />
      <br />
      <br />
      Doesn't work for some reason...<br />
      <br />
      The reason im using XPUI is because it looks nicer than normal installers and cant seem to make normal installers look like XPUI
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">LoRd_MuldeR</span><br />
      <span class="post-time small text-muted">14th July 2008 15:29 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Are doing this for the UNinstaller ???<br />
      <br />
      Please post your complete script code...<br />
      <br />
      <br />
      [EDIT]<br />
      <br />
      This is from XPUI docs, took my one click in Google to find ;)<br />
      <br /></p>

      <blockquote>
        <b>Using custom page/GUI functions</b><br />
        <br />
        XPUI_CUSTOMFUNCTION_GUIINIT myFunction - Define this to call custom function "myFunction" during the installer's GUI initialization.<br />
        <br />
        XPUI_CUSTOMFUNCTION_GUIEND myFunction - Define this to call custom function "myFunction" during the installer's GUI de-initialization. Use this to unload any plugins you have and delete any temporary files that you dumped on to the user's hard drive.<br />
        <br />
        XPUI_PAGE_CUSTOMFUNCTION_PRE myFunction - Call function "myFunction" during the early initialization of an installer page.<br />
        <br />
        XPUI_PAGE_CUSTOMFUNCTION_SHOW myFunction - Call function "myFunction" right before an installer page shows.<br />
        <br />
        XPUI_PAGE_CUSTOMFUNCTION_LEAVE myFunction - Call function "myFunction" while an installer page is unloading.<br />
        <br />
        NOTE: After defining the XPUI_PAGE_CUSTOMFUNCTION symbols, insert the page of your choice, and that will be the page that calls your custom functions. You will need to define the CUSTOMFUNCTION symbols for every page that you want a custom function for.
      </blockquote>[EDITÂ²]<br />
      <br />
      If you used XPUI before, you might want to check out UMUI as well:<br />
      <a href="http://sourceforge.net/project/showfiles.php?group_id=146999&amp;package_id=161955" target="_blank">http://sourceforge.net/project/showf...kage_id=161955</a>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">XxXGoD</span><br />
      <span class="post-time small text-muted">14th July 2008 15:50 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">I fixed it<br />
      <br />
      Had to do:<br /></p>
      <pre>
<code><br />        ${Page} Welcome<br />;       ${LicensePage} "E:\Documents and Settings\User\Desktop\lic.rtf"<br />        ${Page} Components<br />        !define XPUI_PAGE_CUSTOMFUNCTION_PRE AccountDir<br />        ${Page} Directory<br />        ${Page} InstFiles<br />        ${Page} Finish</code>
</pre><br />
      <br />
      Have to put the define in where the page's are and then move the rest of what you said below the pages<br />
      <br />
      <br />
      I have been reading the INI section of the documentation and am wondering if:<br />
      <br />
      Can i edit a <b>text</b> file and add a line at the bottom of it adding the text<br />
      <br />
      exec autoexec.cfg
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">LoRd_MuldeR</span><br />
      <span class="post-time small text-muted">14th July 2008 16:00 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">As I said: You must put the XPUI_PAGE_CUSTOMFUNCTION_PRE define right before the page macro. Don't put anything in between, especially no other page macro!<br />
      <br />
      <br />
      Append lines to a text file this way:<br />
      <br /></p>
      <pre>
<code>  ; open file<br />  ClearErrors<br />  FileOpen $0 "autoexec.cfg" a<br />  IfErrors FileErrors<br /><br />  ; seek to the end of the file<br />  FileSeek $0 0 END<br /><br />  ; append a few lines<br />  FileWrite $0 "Rabbit$\r$\n"<br />  FileWrite $0 "Umbrella$\r$\n"<br />  FileWrite $0 "Joker$\r$\n"<br /><br />  ; close file<br />  FileClose $0<br /><br />  FileErrors:</code>
</pre>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">XxXGoD</span><br />
      <span class="post-time small text-muted">14th July 2008 17:15 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">What does the foloowing do:<br />
      <br />
      $\r$\n</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Comperio</span><br />
      <span class="post-time small text-muted">14th July 2008 17:37 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">$\r$\n are symbols for a carriage return ($\r) and new line ($\n) character.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">XxXGoD</span><br />
      <span class="post-time small text-muted">14th July 2008 18:19 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Works perfectly, however on some peoples pc's it wont be there..<br />
      <br />
      How can i add it so IF that file isn't there it will put it there, but if it is it wont... but the other files what im putting in i want to overright</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">LoRd_MuldeR</span><br />
      <span class="post-time small text-muted">14th July 2008 18:27 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">You can check for file existence with IfFileExists command ;)<br />
      <br />
      Also, the above code should work, no matter if the file exists before or not...</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">XxXGoD</span><br />
      <span class="post-time small text-muted">14th July 2008 19:28 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"></p>

      <blockquote>
        <i>Originally posted by LoRd_MuldeR</i><br />
        <b>You can check for file existence with IfFileExists command ;)<br />
        <br />
        Also, the above code should work, no matter if the file exists before or not...</b>
      </blockquote>But theres 1 file what i dont want it to overwrite.<br />
      <br />
      I want it to only put the file in if there is no file there....<br />
      <br />
      EDIT:<br />
      <pre>
<code><br />IfFileExists $INSTDIR\autoexec.cfg autoexecfound<br />File "C:\Documents and Settings\Ryan\Desktop\autoexec.cfg"<br />     autoexecfound:<br />  ClearErrors<br />  FileOpen $0 "$INSTDIR\autoexec.cfg" a<br />  IfErrors FileErrors<br />  FileSeek $0 0 END<br />  FileWrite $0 "TestLine$\r$\n"<br />  FileClose $0<br />  FileErrors:</code>
</pre><br />
      <br />
      Is that right?<br />
      <br />
      So if the file is there it's going to jump the step: File "C:\Documents and Settings\Ryan\Desktop\autoexec.cfg"
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">LoRd_MuldeR</span><br />
      <span class="post-time small text-muted">14th July 2008 20:36 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">You code should extract a the "autoexec.cfg" to the $INSTDIR folder, but *only* when there is no such file yet. If the file already exists, that part will be skipped. In both cases one line, namely "TestLine", will be appended to the "autoexec.cfg" file. One tip though: You can not be sure that the last line of the user's "autoexec.cfg" file has a carriage return at it's end. So it might be more safe to do it this way:<br />
      <br /></p>
      <pre>
<code>  IfFileExists $INSTDIR\autoexec.cfg autoexecfound<br />  File "C:\Documents and Settings\Ryan\Desktop\autoexec.cfg"<br />  <br />  autoexecfound:<br />  <br />  ClearErrors<br />  FileOpen $0 "$INSTDIR\autoexec.cfg" a<br />  IfErrors FileErrors<br />  FileSeek $0 0 END<br />  FileWrite $0 "$\r$\n" ; &lt;-- THIS IS NEW<br />  FileWrite $0 "TestLine$\r$\n"<br />  FileClose $0<br /><br />  FileErrors:</code>
</pre>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">LoRd_MuldeR</span><br />
      <span class="post-time small text-muted">14th July 2008 20:48 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Or even better:<br />
      <br /></p>
      <pre>
<code>IfFileExists $INSTDIR\autoexec.cfg autoexecfound<br />  File "C:\Documents and Settings\Ryan\Desktop\autoexec.cfg"<br />  <br />  autoexecfound:<br />  <br />  ClearErrors<br />  FileOpen $0 "$INSTDIR\autoexec.cfg" a<br />  IfErrors FileErrors<br />  FileSeek $0 1 END<br />  FileReadByte $0 $1<br />  StrCmp $1 10 CarriageReturnFound:<br />  FileWrite $0 "$\r$\n"<br /><br />  CarriageReturnFound:<br />  FileWrite $0 "TestLine$\r$\n"<br />  FileClose $0<br /><br />  FileErrors:</code>
</pre>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">XxXGoD</span><br />
      <span class="post-time small text-muted">14th July 2008 20:50 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">yeah, awesome i learnt alot today :D</p>
    </div>
    <hr />

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]>
  </script>
</body>
</html>
