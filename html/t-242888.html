<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="description" content="Copy a file and run file on Another local machine"><title>Copy a file and run file on Another local machine - NSIS Forums</title><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script><link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css"><link rel="stylesheet" href="../css/style.css" type="text/css"><!--[if lt IE 9]><script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script><script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script><![endif]--></head><body><div class="container"><ol class="breadcrumb"><li><a href="../index.html" class="glyphicon glyphicon-home"></a></li><li><a href="f-65.html">NSIS Discussion</a></li><li class="active">Copy a file and run file on Another local machine</li></ol><p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=242888">Copy a file and run file on Another local machine</a></p><br><div class="post"><p class="post-meta"><span class="post-author text-primary">JATO</span><br><span class="post-time small text-muted">7th April 2006 18:43 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>Copy a file and run file on Another local machine</strong><br>IT Helpdesk.. trying to automate a Batch file fix... want to use NSIS to copy the Batch file to a workstation and then have it execute as THAT user not as the helpdesk person who copied it over.<br><br>I know how to copy it over using a UNC path<br>I know how to use EXEC -- but won't EXEC execute as the person who copied the file.. not the machine it was copied to?<br><br>I could have the person on the phone click on the batch file...but thought it would be cooler if it just RAN on it's own.<br><br>Please advise.. I've seen references to Exec and ShellExec but nothing that addresses my issue directly.<br><br>thanks</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">kichik</span><br><span class="post-time small text-muted">7th April 2006 19:51 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">As far as I know, you can't run a program as another user without the user's password or another application already running under the user's control.<br><br>However, you can write to the user's registry by manually loading the hive. That way, you can have your application execute when the user logs in. Put it in the RunOnce registry key.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">JATO</span><br><span class="post-time small text-muted">7th April 2006 20:01 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">thanks.. yeah, thought about doing that..but since we're a helpdesk.. we want to save time and NOT have people reboot if we can help it.<br>I'll just have the employee double click on the Batch file manually after it's copied over.<br><br>if anyone else has a better work around besides RunOnce or starting a service... please let me know</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Brummelchen</span><br><span class="post-time small text-muted">7th April 2006 20:04 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">"runas.exe" is your friend</p></div><hr><div class="footer"><p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p></div></div><script src="../js/highlight.pack.js" type="text/javascript"></script><script type="text/javascript">//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]></script></body></html>