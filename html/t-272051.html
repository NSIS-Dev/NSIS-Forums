<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="description" content="Problem with additional Game Explorer tasks"><title>Problem with additional Game Explorer tasks - NSIS Forums</title><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script><link rel="preload" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css" as="style" onload="this.rel='stylesheet'"><link rel="preload" href="../css/style.css" as="style" onload="this.rel='stylesheet'"><noscript><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css"><link rel="stylesheet" href="../css/style.css"></noscript><script>!function(a){"use strict";var b=function(b,c,d){function e(a){return h.body?a():void setTimeout(function(){e(a)})}function f(){i.addEventListener&&i.removeEventListener("load",f),i.media=d||"all"}var g,h=a.document,i=h.createElement("link");if(c)g=c;else{var j=(h.body||h.getElementsByTagName("head")[0]).childNodes;g=j[j.length-1]}var k=h.styleSheets;i.rel="stylesheet",i.href=b,i.media="only x",e(function(){g.parentNode.insertBefore(i,c?g:g.nextSibling)});var l=function(a){for(var b=i.href,c=k.length;c--;)if(k[c].href===b)return a();setTimeout(function(){l(a)})};return i.addEventListener&&i.addEventListener("load",f),i.onloadcssdefined=l,l(f),i};"undefined"!=typeof exports?exports.loadCSS=b:a.loadCSS=b}("undefined"!=typeof global?global:this);!function(a){if(a.loadCSS){var b=loadCSS.relpreload={};if(b.support=function(){try{return a.document.createElement("link").relList.supports("preload")}catch(b){return!1}},b.poly=function(){for(var b=a.document.getElementsByTagName("link"),c=0;c<b.length;c++){var d=b[c];"preload"===d.rel&&"style"===d.getAttribute("as")&&(a.loadCSS(d.href,d,d.getAttribute("media")),d.rel=null)}},!b.support()){b.poly();var c=a.setInterval(b.poly,300);a.addEventListener&&a.addEventListener("load",function(){b.poly(),a.clearInterval(c)}),a.attachEvent&&a.attachEvent("onload",function(){a.clearInterval(c)})}}}(this);</script></head><body><div class="container"><ol class="breadcrumb"><li><a href="../index.html" class="glyphicon glyphicon-home"></a></li><li><a href="f-65.html">NSIS Discussion</a></li><li class="active">Problem with additional Game Explorer tasks</li></ol><p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=272051">Problem with additional Game Explorer tasks</a></p><br><div class="post"><p class="post-meta"><span class="post-author text-primary">necrophilissimo</span><br><span class="post-time small text-muted">31st May 2007 06:44 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>Problem with additional Game Explorer tasks</strong><br>I have a problem with additional Game Explorer tasks; I can't get them to work. Only the obligatory "Play" task appears no matter what I do. I've tried both Games plug-in and Game Explorer script example, both following the examples to the letter, but neither shows results. Any suggestions?</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">kichik</span><br><span class="post-time small text-muted">31st May 2007 18:42 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Try validating the paths where the shortcuts are created to make sure they are written where they should. Also make sure you have a unique identifier for each task. When all else fails, attach a minimal example of a script that doesn't work and we'll see what we can do.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">necrophilissimo</span><br><span class="post-time small text-muted">10th June 2007 15:17 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">I located the problem, which is all my fault - in a way. Before swapping to near-perfect NSIS I tried to code my own MSI thing and with zippo experience on the subject, and believe it or not, I managed to remove the entire ProgramData\Microsoft\Windows\GameExplorer during a buggy uninstall test! I had backups of the folder, but copying it back didn't help, as I no longer can't get any subfolders created there. The games do show up in Game Explorer, but I guess that's through Windows registery, not from Game Explorer folder - it can't be, cause NSIS nowdays doesn't create folders there.<br><br>Since I have hundreds of gigabytes of on-going production content on my harddrive I can't exactly re-install the system and thanks to the fact I'm using HP machine, I don't have Windows Vista DVD for OS-only re-install, just the horrible 2-DVD system recovery monster that will wipe everything. So; Any suggestions? Or do I just wave Game Explorer goodbye for time being?</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">kichik</span><br><span class="post-time small text-muted">10th June 2007 18:25 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Try re-registering gameux.dll.</p><pre>
<code>Start-&gt;Run-&gt;regsvr32.exe gameux.dll</code>
</pre></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">necrophilissimo</span><br><span class="post-time small text-muted">11th June 2007 15:03 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Thanks, that brought GameExplorer from the dead, but I still don't get things working. I stripped the entire installer into very basics, but no. Nothing is installed to GameExplorer folder, no folders, no tasks, nothing.<br><br>I hate to ask anyone to do the dirty work for me, but it seems I have no choice - I'm simply out of ideas. Attached is the NSI stripped to bare bones and to just one exe (example thingy I've been used for testing, not the real deal). The core points where I guess I'm messing things up are:<br><br>WriteRegStr HKLM "Software\Microsoft\Windows\CurrentVersion\Uninstall\Game" "DisplayName" "Game"<br>WriteRegStr HKLM "Software\Microsoft\Windows\CurrentVersion\Uninstall\Game" "UninstallString" '"$INSTDIR\uninstall.exe"'<br>WriteRegDWORD HKLM "Software\Microsoft\Windows\CurrentVersion\Uninstall\Game" "NoModify" 1<br>WriteRegDWORD HKLM "Software\Microsoft\Windows\CurrentVersion\Uninstall\Game" "NoRepair" 1<br>WriteUninstaller "uninstall.exe"<br><br>${GameExplorer_GenerateGUID}<br>Pop $0<br>${GameExplorer_AddGame} all $INSTDIR\Game.exe $INSTDIR $INSTDIR\Game.exe $0<br><br>and:<br><br>SetShellVarContext all<br><br>; Remove from game explorer<br>${If} ${AtLeastWinVista}<br>File GameuxInstallHelper.dll<br>System::Call "GameuxInstallHelper::RetrieveGUIDForApplication(t '$INSTDIR\Game.exe', *g .r0)"<br>Pop $0<br>${GameExplorer_RemoveGame} $0<br>${EndIf}</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">kichik</span><br><span class="post-time small text-muted">16th June 2007 11:27 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">The code seems fine. Are you sure the GDF is valid?</p></div><hr><div class="footer"><p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p></div></div><script src="../js/highlight.pack.js" type="text/javascript"></script><script type="text/javascript">//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]></script></body></html>