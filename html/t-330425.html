<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="nsArray plug-in" />

  <title>nsArray plug-in - NSIS Forums</title><!-- Bootstrap core CSS -->
  <link rel="stylesheet" type="text/css" href="//netdna.bootstrapcdn.com/bootswatch/3.0.1/readable/bootstrap.min.css" />
  <link rel="stylesheet" href="../css/style.css" type="text/css" /><!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!--[if lt IE 9]>
                <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
                <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->
</head>

<body>
  <div class="container">
    <!-- Put navigation bar here -->

    <ol class="breadcrumb">
      <li><a href="../index.html" class="glyphicon glyphicon-home"></a></li>

      <li><a href="f-65.html">NSIS Discussion</a></li>

      <li class="active">nsArray plug-in</li>
    </ol>

    <p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=330425">nsArray plug-in</a></p><br />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
      <span class="post-time small text-muted">7th May 2011 19:46 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>nsArray plug-in</strong><br />
      &nbsp; Wrote this light weight array plug-in which will be used in the nsL Assembler to support native language constructs for arrays. I figure people will also use it in their NSIS projects too.<br />
      <br />
      <a href="http://nsis.sourceforge.net/File:NsArray.zip" target="_blank">http://nsis.sourceforge.net/File:NsArray.zip</a><br /></p>

      <ul>
        <li>6KB DLL (versus 20KB for NSISArray)</li>

        <li>Low memory usage<br />
        - Linked lists<br />
        - Allocates small blocks of memory rather than one continuous block</li>

        <li>Much faster<br />
        - Uses memory pointers<br />
        - E.g. sorting copies memory pointers, not the data itself</li>

        <li>Very simple usage<br />
        - Bare minimum set of functions</li>

        <li>No limit on the number of arrays</li>

        <li>Designed to be used by NSIS Assembler (<a href="http://nslassembler.sf.net" target="_blank">http://nslassembler.sf.net</a>)</li>
      </ul><br />
      Stu
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">zeeh3</span><br />
      <span class="post-time small text-muted">8th May 2011 02:17 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Very cool, thank you for the new plugin :)</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">disruptor108</span><br />
      <span class="post-time small text-muted">26th May 2011 20:11 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Thanks for making this.<br />
      <br />
      A couple things I've noticed while using it:<br />
      <br />
      *After deleting an array, the length of the array is still 1.<br />
      *Removing items from an array do not shorten the length.<br />
      <br />
      I can provide my code examples if necessary.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
      <span class="post-time small text-muted">26th May 2011 20:24 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Ah thanks I probably forgot to reduce the counters. Will fix soon thanks. I'm thinking of allowing associative arrays (akin to PHP arrays) rather than indexed ones. Think that would be a good idea?<br />
      <br />
      Stu</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">disruptor108</span><br />
      <span class="post-time small text-muted">26th May 2011 21:01 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Personally, I have no preference one way or the other. I've been doing fine with indexes, but if changing to associative arrays works for others I can change my code.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
      <span class="post-time small text-muted">26th May 2011 21:07 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Well it would work like PHP arrays so you can have both index-associated and key-associated elements in the same array. Perhaps I'll fix these small bugs first though.<br />
      <br />
      Stu</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
      <span class="post-time small text-muted">2nd June 2011 10:37 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Finally fixed those bugs (and a couple more):</p>

      <blockquote>
        1.0.0.1 - 2nd June 2011<br />
        * Fixed decrementing of element and array counters on element and array<br />
        deletion.<br />
        * Fixed memory leak of array name on array deletion.<br />
        * Fixed bad pointers remaining after last element and array deletion.
      </blockquote>This will be the last version (hopefully) to only support indexed arrays. The next version I plan to have associative and indexed arrays in one, akin to PHP. The changes I had in mind to allow for this are:<br />
      <br />
      * "New" will no longer initialise the values of an array. One can just use "Insert" (will reduce some of the code size).<br />
      * "Insert" will take an optional prefix argument for each element in the format "/key=val" where val can be an index or a string. Omitting /key will result in the element being inserted at its natural index (which is the last highest index + 1).<br />
      * "Remove" and "Get" will no longer take index ranges, but instead will take a list of keys/indices followed by /end.<br />
      <br />
      Stu
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
      <span class="post-time small text-muted">2nd July 2011 16:42 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">New plug-in version which supports associative arrays (as well as indexed). The plug-in usage and functionality has changed quite a lot since the previous version but the DLL is still the same size.<br />
      <br />
      <a href="http://nsis.sourceforge.net/File:NsArray.zip" target="_blank">http://nsis.sourceforge.net/File:NsArray.zip</a><br />
      <br />
      Stu</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">MSG</span><br />
      <span class="post-time small text-muted">2nd July 2011 17:13 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Nice updating spree you got going there, Stu. :)</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">singman</span><br />
      <span class="post-time small text-muted">26th September 2011 16:45 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>Error with ToString</strong><br />
      &nbsp; If I follow the example on the DLL archive, I get that ouput :<br />
      <br />
      <font color="navy"><br />
      MyArray = {0}<br />
      MyArray[0] is 11<br />
      MyArray[1] is 14<br />
      MyArray[4] is blah<br />
      MyArray[5] is /key=jajaj<br />
      MyArray[jajaj] is<br />
      Set MyArray[jajaj] = 22<br />
      MyArray[jajaj] is<br />
      MyArray = {0}<br />
      MyArray length: 1<br />
      MyArray length: 1<br />
      MyArray = {0}<br />
      MyArray = {1}<br />
      MyArray length: 1<br />
      MyArray2 values sorted numerically = {1}<br />
      MyArray2 sorted by keys = {1}<br />
      MyArray2 = {1}<br />
      MyArray2[0] is<br />
      MyArray2[1] is 14<br />
      MyArray2 = {1}<br />
      MyArray2 length: 1<br />
      MyArray2Keys = {0}<br />
      MyArray2 = {0}<br />
      MyArray2 length: 7<br />
      Completed<br /></font><br />
      <br />
      I think every ToString call return something wrong.<br />
      Quote from documentation :<br />
      <br />
      <i>nsArray::ToString my_array<br />
      Pop $var<br />
      <br />
      Returns a string representation of `my_array` which includes keys and<br />
      values in the format key1 =&gt; value1, key2 =&gt; value2, etc.. The error<br />
      flag is set if the array does not exist or if the result cannot<br />
      completely fit into the output buffer (NSIS_MAX_STRLEN) although as<br />
      much as can fit into the output buffer will still be returned.</i></p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
      <span class="post-time small text-muted">29th September 2011 10:15 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Will take a look sometime today.<br />
      <br />
      Stu</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
      <span class="post-time small text-muted">2nd October 2011 10:55 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">I have no problems with the example script. Make sure you are using the correct plug-in (i.e. Unicode or ANSI).<br />
      <br />
      Edit: If there is ever a problem, the error flag is set.<br />
      <br />
      Stu</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">singman</span><br />
      <span class="post-time small text-muted">3rd October 2011 13:22 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Great !<br />
      I was using the Unicode version but my NSIS is no longer compiled with Unicode.<br />
      <br />
      Thanks.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
      <span class="post-time small text-muted">12th October 2011 20:01 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">New plug-in version:</p>

      <blockquote>
        1.1.0.2 - 12th October 2011<br />
        * Added GetAt function.<br />
        * Added addition sort flag (16) to retain keys/indices order when sorting values.<br />
        * Removed New function. Set function now creates the array if it doesn't already exist.
      </blockquote>Stu
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
      <span class="post-time small text-muted">12th February 2012 17:39 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">New plug-in version:</p>

      <blockquote>
        1.1.1.0 - 12th February 2012<br />
        * Added Split function.<br />
        * Added /noempty switch to Join function.<br />
        * Sort function now supports ORing (|) for its sort flags.<br />
        * Replaced Delete function with Clear function.<br />
        * Replace GetAt function with /at=position switch on Get function.<br />
        * Added Get /at=-1 for array element iteration.<br />
        * Added /at=position and /val=value switches for Remove function.<br />
        * Implemented script header replacements for Copy, CopyKeys and ToString functions.<br />
        * Added script header ForEachIn LogicLib loop.
      </blockquote>The ForEachIn loop can be used like so:
      <pre>
<code>${ForEachIn} my_array $key $value<br />  DetailPrint "my_array[$key] =&gt; $value"<br />${Next}</code>
</pre><br />
      <br />
      Stu
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
      <span class="post-time small text-muted">12th February 2012 20:04 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">New plug-in version:</p>

      <blockquote>
        1.1.1.1 - 12th February 2012<br />
        * Optimised Get /at=-1 by using an pointer instead of a counter.<br />
        * Added Get /at=-2 to iterate in reverse order.<br />
        * Added script header ForEachInReverse LogicLib loop.
      </blockquote>Stu
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
      <span class="post-time small text-muted">13th February 2012 10:44 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">New plug-in version (hopefully the last for a while):</p>

      <blockquote>
        1.1.1.2 - 13th February 2012<br />
        * Replaced /at=-1 with /next for Get function.<br />
        * Replaced /at=-2 with /prev for Get function.<br />
        * Added /reset switch to Get function to reset /next or /prev iteration.<br />
        * The /at=position switch for Get and Remove functions now support negative numbers.<br />
        * Added call to Get /reset before entering ForEachIn loop.<br />
        * Fixed incorrect usage of Split function in the readme.
      </blockquote>Stu
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">vicokoby</span><br />
      <span class="post-time small text-muted">6th March 2012 00:09 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">When set a array outside of section, this init with some empty elements<br />
      <br />
      For example:<br />
      <br />
      Page custom CreateMyPage LeaveMyPage<br />
      <br />
      <br />
      Function CreateMyPage<br />
      <br />
      InstallOptions<br />
      FunctionEnd<br />
      <br />
      Function LeaveMyPage<br />
      <br />
      FunctionEnd</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">vicokoby</span><br />
      <span class="post-time small text-muted">6th March 2012 00:32 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">#When set a array outside any section, this aray have some empty elements,<br />
      por example in the function of a custom page.#<br />
      <br />
      Page custom MyPage LeaveMyPage<br />
      Page instfiles<br />
      <br />
      Function MyPage<br />
      Push $R0<br />
      <br />
      InstallOptions::dialog $PLUGINSDIR\someIni.ini<br />
      Pop $R0<br />
      FunctionEnd<br />
      <br />
      Function LeaveMyPage<br />
      <br />
      nsArray::Set MyArray 'one'<br />
      nsArray::Set MyArray 'two'<br />
      nsArray::Set MyArray 'three'<br />
      nsArray::Length MyArray<br />
      Pop $1 ; $1 = 4 instead 3<br />
      NsArray::Get MyArray 0<br />
      Pop $0 ; $0 = ´´ ( Empty String)<br />
      <br />
      #This only occur into a custom page function#<br />
      Function<br />
      <br />
      Section MySection<br />
      Call LeaveMyPage ; When the call is from here, no there problems with the array<br />
      SectionEnd</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
      <span class="post-time small text-muted">6th March 2012 10:45 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">nsArray::Set takes multiple values so you need to put /end on the end, i.e.</p>
      <pre>
<code>nsArray::Set MyArray one two three /end</code>
</pre>If you don't add /end, values left on the NSIS stack will get added.<br />
      <br />
      Edit: Maybe I should add a first argument of /list to add multiple elements in a single call to Set (i.e. /end can be omitted without /list).<br />
      <br />
      Stu
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">vicokoby</span><br />
      <span class="post-time small text-muted">6th March 2012 14:40 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">I must /end when I put a single elment?<br />
      <br />
      eg.: nsArray::Set MyArray ´Single´ /end</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
      <span class="post-time small text-muted">6th March 2012 17:53 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">At the moment yes because of what I said. NSIS passes arguments to plug-ins using the stack and because Set can have multiple arguments there is no way of knowing if the argument was on the stack already or passed as a plug-in argument in the call. This is why /end is necessary and not optional. Some other plug-ins require the use of /end too.<br />
      <br />
      Stu</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
      <span class="post-time small text-muted">20th March 2012 23:23 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">New version uploaded. Set and Remove calls no longer need the /end suffix when adding/removing a single element. If you want to specify multiple elements, start the list with /list and end it with /end. The readme has examples.<br />
      <br />
      <a href="http://nsis.sourceforge.net/File:NsArray.zip" target="_blank">http://nsis.sourceforge.net/File:NsArray.zip</a><br />
      <br />
      Stu</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Yathosho</span><br />
      <span class="post-time small text-muted">2nd June 2012 13:50 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">feature requests:<br />
      -unique (removes duplicate values)<br />
      -merge (two arrays)</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
      <span class="post-time small text-muted">2nd June 2012 17:06 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">You can do both of those with the existing functions plus some loops. Perhaps I will add them to the script header when I have time.<br />
      <br />
      Stu</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Yathosho</span><br />
      <span class="post-time small text-muted">2nd June 2012 17:36 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">just a suggestion, after all the same could be said about sorting</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
      <span class="post-time small text-muted">2nd June 2012 21:52 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Actually you could only do sorting with the existing functions if the array is indexed only (i.e. how would you sort if the array is associative?) Also the internal Sort function simply moves the pointers around rather than the actual data. This is far more efficient and does not require any new memory allocation or deallocation or data copying. Also writing the quick sort algorithm in NSIS code would not be very straight forward (bubble sort would be easier but is less efficient).<br />
      <br />
      Removing duplicates and merging arrays both require memory deallocation and allocation so writing an internal function would serve little benefit over an NSIS script equivalent and would only add additional size to the DLL.<br />
      <br />
      Stu</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">TVNST</span><br />
      <span class="post-time small text-muted">22nd August 2012 14:11 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">I checked the plugin code in order to maybe get a hint about what was causing the memory corruption problems I got, and there's some potential issue with the Set command and its key words.<br />
      <br />
      According to my interpretation of the code, there's no accurate distinguishing between a value and a key word. Therefore the function is not able to recognize if a string value accidently has the same text as a known keyword like "/list", "/end" or "/key".<br />
      <br />
      For example, if just one value is added and this value accidently starts with "/key=", it will set the error flag and abort the installation in my case.<br />
      If a list of parameters is added and one of the values is accidently "/end", like...<br />
      nsArray::Set array /list "Bla" "/end" "BlaBla" /end<br />
      ... the last two parameters are not interpreted anymore, and might pollute the NSIS stack, because there's not condition for "/end" to be the last available parameter.<br />
      <br />
      It would be better to have different function names for each type since every keyword reduces the set of valid values.<br />
      Since I have to add values read from various registry values, there's pretty much any value possible including the key words.<br />
      I will now check the values to add for the keywords first and use a workaround it that happens. Fore example, it's possible to add the "/list" value with the following statement:<br />
      nsArray::Set array /list "/list" /end</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
      <span class="post-time small text-muted">28th August 2012 19:31 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Yes that is indeed a problem which I was well aware of when I wrote the functions. I suppose a SetList function would not hurt and I am perhaps over-obsessed with making the plug-in as small as possible.<br />
      <br />
      I have run both the ANSI and Unicode builds through the debugger and have had no memory access violations. There could still be some but I would have a look at the other plug-ins you use.<br />
      <br />
      Stu</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">TVNST</span><br />
      <span class="post-time small text-muted">29th August 2012 13:49 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">I checked the basic functions of the plugin and the code is rather clean.<br />
      I highly doubt the memory corruptions are caused by your plugin as well.<br />
      <br />
      I also validated our own plugin code, but althouh I found memeory leaks but I couldn't find any memory corruptions.<br />
      However, I replaced some unsave functions like sprintf with their safer variant with array size limitation.<br />
      <br />
      However, our installer still has some sporadic stability problems which might be caused by another plugin.<br />
      We also upgraded to the newest NSIS version but that didn't help either.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
      <span class="post-time small text-muted">3rd September 2012 22:07 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">New version:</p>

      <blockquote>
        1.1.1.4 - 3rd September 2012<br />
        * Replaced Set /list with SetList.<br />
        * Replaced Remove /list with RemoveList.
      </blockquote>Please update your code accordingly if you switch to the new version.<br />
      <br />
      Stu
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">T.Slappy</span><br />
      <span class="post-time small text-muted">12th December 2012 07:23 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">What is correct usage of nsArray::Get? I think nsArray corrupts my stack but I cannot find the problem.<br />
      <br />
      This is my code - Is this usage correct?<br />
      1)<br /></p>
      <pre>
<code>ClearErrors
<br />nsArray</code>::Get UrlTree $CompleteGroup
<br />&gt;${If} ${Errors}
<br />    ${DebugMsg} "UrlTree($CompleteGroup) is not set!"
<br />&gt;${Else}
<br />    Pop $CompleteTotal
<br />   ; There are some files
<br />&gt;${EndIf} 
</pre><br />
      In documentation I saw this usage:<br />
      2)<br />
      <pre>
<code>  ClearErrors
<br />  nsArray</code>::Get MyArray 2
<br />  Pop $R0
<br /> ${If} ${Errors}
<br />   DetailPrint `Error!`
<br />  ${EndIf} 
</pre><br />
      So in my example (1): I do POP only if ${Errors} is fine.<br />
      <br />
      But the docs say (2): do the POP, then check ${Errors}.<br />
      <br />
      I have many values in stack, so I think POP in (2) will remove element from stack even in case the nsArray does not contain required element.<br />
      <br />
      Is this assumption correct?
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
      <span class="post-time small text-muted">12th December 2012 13:12 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Yes that is an error in the example script. It will not push anything onto the stack if an error occurs (element not found).<br />
      <br />
      Stu</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Fretje</span><br />
      <span class="post-time small text-muted">28th January 2013 15:33 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Is there a way to sort an array with version numbers using the versioncompare logic? I'm using "numeric" now, and it doesn't give the right result:<br />
      <br />
      * 4.2.6_32<br />
      * 5.1.10.2_32<br />
      * 5.1.8.2_32<br />
      * 5.1.9.0_32<br />
      <br />
      should be:<br />
      <br />
      * 4.2.6_32<br />
      * 5.1.8.2_32<br />
      * 5.1.9.0_32<br />
      * 5.1.10.2_32<br />
      <br />
      fretje</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
      <span class="post-time small text-muted">28th January 2013 19:13 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">See attached.<br />
      <br />
      Stu</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Fretje</span><br />
      <span class="post-time small text-muted">29th January 2013 10:46 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Thank you very much for the very fast reply, Stu.<br />
      This is exactly what I needed!</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Yathosho</span><br />
      <span class="post-time small text-muted">30th January 2013 12:11 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">btw, the readme still mentions the old syntax for nsArray_ToString</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Marshallx7</span><br />
      <span class="post-time small text-muted">9th May 2013 15:23 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Couldn't find this documented anywhere and I think it is worth mentioning:<br />
      /at= does not work with the Set command.<br />
      Further more /key= only works on keynames, not indexes, as follows:<br /></p>
      <pre>
<code><br />nsArray::Set "myArray" "0"<br />nsArray::Set "myArray" "1"<br />nsArray::Set "myArray" "2"<br />nsArray::Set "myArray" "3"<br />;array now = {"0", "1", "2", "3"}<br />nsArray::Remove "myArray" /at=1<br />;array now = {"0", "2", "3"}<br />nsArray::Set "myArray" /key=2 "three"<br />;array now = {"0", "three", "3"}<br /></code>
</pre><br />
      Because elements with no specified keyname are presumably given a keyNAME of their initial index.<br />
      The above is <b>correct behaviour</b> as you might have keynames that consist only of numbers.<br />
      <br />
      If you want to have /at= functionality with the Set command then you can add it yourself using the following macro<br />
      <pre>
<code><br />!macro ArraySetAt arrayname index value<br />    Push $R0<br />    ClearErrors<br />    nsArray::Get "${arrayname}" "/at=${index}"<br />    ${IfNot} ${Errors}<br />        Pop $R0 ;key<br />        Exch $R0 ;discard value<br />        Pop $R0 ;discard value<br />        nsArray::Set "${arrayname}" "/key=$R0" "${value}"<br />    ${EndIf}<br />    Pop $R0<br />!macroend<br /></code>
</pre>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
      <span class="post-time small text-muted">11th May 2013 17:56 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"></p>

      <blockquote>
        <small>Originally posted by Marshallx7</small><br />
        /at= does not work with the Set command.
      </blockquote>That is correct - the readme does not show any uses of /at= with the Set instruction, but I could add it.<br />

      <blockquote>
        <small>Originally posted by Marshallx7</small><br />
        Further more /key= only works on keynames, not indexes
      </blockquote>This is not true. Your array after the Remove call is:<br />
      <pre>
<code>myArray = {0 =&gt; 0, 2 =&gt; 2, 3 =&gt; 3}</code>
</pre><br />
      After your Set call, it becomes:<br />
      <pre>
<code>myArray = {0 =&gt; 0, 2 =&gt; three, 3 =&gt; 3}</code>
</pre><br />
      There is no distinction between numeric keys and string keys. It is just that numeric keys are assigned when no key is specified when adding elements.<br />
      <br />
      Edit: You probably assumed that removing element with index 1 would result in the indexes after it being decreased by 1 also. This does not happen in hashed arrays because then the association is lost. I suppose the plug-in needs a reindex function. For example in PHP you'd use array_values().<br />
      <br />
      Stu
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Marshallx7</span><br />
      <span class="post-time small text-muted">12th May 2013 10:36 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Sorry I wasn't clear before, yes - what you say the arrays would be is what I concur with, I just didn't mention the keynames.<br />
      <br />
      I fully accept that this is intended behaviour, and I did run my own tests to be sure, because I need Set /at functionality.<br />
      <br />
      To make my position clear to anyone reading, there are NO bugs in nsArray (that I can see) - just Set /at functionality is not (presently) a feature (but you can emulate it using my macro above).<br />
      <br />
      A reindex method might be useful, but I imagine it is more resource intensive than a Set /at command. Using Get /at, Remove /at and Set /at would mean a reindex is not necessary, because you can then choose to either use associative keynames (without /at) or positional indexes (with /at)</p>
    </div>
    <hr />

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]>
  </script>
</body>
</html>