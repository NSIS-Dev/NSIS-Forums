<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="Secret Keyboard Input" />

  <title>Secret Keyboard Input - NSIS Forums</title><!-- Bootstrap core CSS -->
  <link rel="stylesheet" type="text/css" href="//netdna.bootstrapcdn.com/bootswatch/3.0.1/readable/bootstrap.min.css" />
  <link rel="stylesheet" href="../css/style.css" type="text/css" /><!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!--[if lt IE 9]>
                <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
                <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->
</head>

<body>
  <div class="container">
    <!-- Put navigation bar here -->

    <ol class="breadcrumb">
      <li><a href="../index.html" class="glyphicon glyphicon-home"></a></li>

      <li><a href="f-65.html">NSIS Discussion</a></li>

      <li class="active">Secret Keyboard Input</li>
    </ol>

    <p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=254618">Secret Keyboard Input</a></p><br />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">torpark</span><br />
      <span class="post-time small text-muted">2nd September 2006 05:59 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>Secret Keyboard Input</strong><br />
      I have a program that installs with non-visible UI. I am always debugging it because it runs from a USB device, and on different OSes.<br />
      <br />
      I would like to be able to add a string or hotkey combo that would allow me to set a flag. This flag causes a message boxes to pop up at each different section.<br />
      <br />
      I have everything set up except for the ability to silently capture this keyboard input. Anyone have any ideas? Let us say that I want to put it in while the splash screen is up, or during the first 5 seconds of the program, etc.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
      <span class="post-time small text-muted">2nd September 2006 12:40 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">You can have it passed on as a command line switch. Use <a href="http://nsis.sourceforge.net/Docs/AppendixE.html#E.1.12" target="_blank">GetOptions</a> to retrieve it from the command line.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">torpark</span><br />
      <span class="post-time small text-muted">2nd September 2006 18:20 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Having some trouble with it.<br />
      <br />
      After the Function .onInit but before Section "Main" I placed the example code:<br /></p>

      <blockquote>
        Section "Test"<br />
        ${GetOptions} "/S /T" "/T" $R0<br />
        <br />
        IfErrors 0 +2<br />
        MessageBox MB_OK "Not found" IDOK +2<br />
        MessageBox MB_OK "Found"<br />
        SectionEnd
      </blockquote>and at the end of the file I placed the code for the function GetOptions<br />
      <br />

      <blockquote>
        Function GetOptions<br />
        !define GetOptions `!insertmacro GetOptionsCall`<br />
        <br />
        !macro GetOptionsCall _PARAMETERS _OPTION _RESULT<br />
        Push `${_PARAMETERS}`<br />
        Push `${_OPTION}`<br />
        Call GetOptions<br />
        Pop ${_RESULT}<br />
        !macroend<br />
        <br />
        Exch $1<br />
        Exch<br />
        Exch $0<br />
        Exch<br />
        ...<br />
        <br />
        ...<br />
        Pop $2<br />
        Pop $1<br />
        Exch $0<br />
        FunctionEnd
      </blockquote>I did this just to test the workings of it. Well it doesn't work. Compile error:<br />
      <br />

      <blockquote>
        Section: "Test"<br />
        Invalid command: ${GetOptions}
      </blockquote>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
      <span class="post-time small text-muted">2nd September 2006 18:32 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">That's not the correct usage. The <a href="http://nsis.sourceforge.net/Docs/AppendixE.html#E.2.1" target="_blank">top of that documentation section</a> shows the correct usage. You must first include TextFunc.nsh, then !insertmacro GetOptions and only then you can use the function. There's no need to copy the function code to your script.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">torpark</span><br />
      <span class="post-time small text-muted">2nd September 2006 19:55 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">I think you mean !include "FileFunc.nsh"<br />
      <br />
      Okay, I've got it running, but it is still confusing.<br />
      <br />
      I just want it to check if i added "/debug" to the end.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">torpark</span><br />
      <span class="post-time small text-muted">2nd September 2006 19:57 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">I'm using:<br />
      <br /></p>

      <blockquote>
        ${GetOptions} "/debug" "/" $R0<br />
        MessageBox MB_OK "r0= $R0"
      </blockquote>yet<br />
      <br />
      $R0 = null value, instead of "debug"
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
      <span class="post-time small text-muted">2nd September 2006 20:04 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">How is it not working? Does it simply ignore /debug? Is it the same code as above? If so, replace "/S /T" with $CMDLINE.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">torpark</span><br />
      <span class="post-time small text-muted">2nd September 2006 20:08 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"></p>

      <blockquote>
        Section "Test"<br />
        ClearErrors<br />
        ${GetOptions} $CMDLINE "/" $R0<br />
        MessageBox MB_OK "r0= $R0"<br />
        SectionEnd
      </blockquote>at the command line i enter "program.exe /debug" and the popup box returns "r0="
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">torpark</span><br />
      <span class="post-time small text-muted">2nd September 2006 20:12 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Okay, I've changed the code to just use GetParameters instead, since there will only be one switch.<br />
      <br /></p>

      <blockquote>
        Section "Test"<br />
        ClearErrors<br />
        ${GetParameters} $DEBUG<br />
        MessageBox MB_OK "debug= $DEBUG"<br />
        SectionEnd
      </blockquote>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
      <span class="post-time small text-muted">2nd September 2006 20:14 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"></p>
      <pre>
<code>${GetParameters} $1<br />DetailPrint $1<br />${GetOptions} $1 "/debug=" $0<br />DetailPrint $0</code>
</pre>
      <pre>
<code>installer.exe /debug=yes</code>
</pre>
    </div>
    <hr />

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]>
  </script>
</body>
</html>
