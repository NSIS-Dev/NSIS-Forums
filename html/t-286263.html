<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="Repeat Install Page for user Input" />

  <title>Repeat Install Page for user Input - NSIS Forums</title><!-- Bootstrap core CSS -->
  <link rel="stylesheet" type="text/css" href="//netdna.bootstrapcdn.com/bootswatch/3.0.1/readable/bootstrap.min.css" />
  <link rel="stylesheet" href="../css/style.css" type="text/css" /><!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!--[if lt IE 9]>
                <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
                <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->
</head>

<body>
  <div class="container">
    <!-- Put navigation bar here -->

    <ol class="breadcrumb">
      <li><a href="../index.html" class="glyphicon glyphicon-home"></a></li>

      <li><a href="f-65.html">NSIS Discussion</a></li>

      <li class="active">Repeat Install Page for user Input</li>
    </ol>

    <p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=286263">Repeat Install Page for user Input</a></p><br />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">jimpy22</span><br />
      <span class="post-time small text-muted">4th February 2008 13:03 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>Repeat Install Page for user Input</strong><br />
      Hi,<br />
      <br />
      I have searched the forums for a way to repeat a custom page which collects a servername, IP address and MAC address from a user during install without success. I use a 'standard' custom page and ioA.ini file to collect the input in text input boxes.<br />
      <br />
      I write these numbers into a csv file and I want the installer to keep asking the user if they have another set of server details to add into the csv file until they have reached the end. The minimum number of entries will be one server, but there may be multpile. Ideally I would like the installer to detect that the user has put no more details into the servername, IP address and MAC address input boxes and then continue through the installer.<br />
      <br />
      Is this possible? Thanks in anticipation.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Animaether</span><br />
      <span class="post-time small text-muted">4th February 2008 16:47 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">in your custom page's Leave function, you could check if the value of the installoptions status is 0 (Next button pressed), write out the data, then pop up a YES_NO messagebox that asks the user if they want to add more data. If they answer 'yes', call Abort (the same page remains displayed) and clear any fields that might need clearing (blank slate). If they answer 'no', simply don't do anything - it will carry on. Checking if the fields are empty as an additional means of carrying on should be straightforward as well.<br />
      <br />
      Alternatively, and this is probably cleaner, add a button on that same form that reads something like "Add another...". In the Leave function, check if that button was pressed, then do much the same as before. This prevents a pop-up messagebox that tends to hinder workflow.<br />
      <br />
      Also, if you expect that a user may enter multiple values, consider whether your target audience may be knowledgeable enough to work with a multi-line text field, entering IP / MAC addresses per-line. This would save a lot of code on your end, and possibly a lot of frustration on the user's end.<br />
      ( If your target audience requires hand-holding, this may seem too confusing, so it is something you need to give a good bit of thought. )</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">jimpy22</span><br />
      <span class="post-time small text-muted">25th February 2008 14:37 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Sorry for the slow reply to this - have been away for a week or two.<br />
      <br />
      My installer is copied below and it is the custom page B that I want to repeatedly collect the 3 user inputs and write them to the csv file until the user has entered all server details. The user will always enter at least one set of data.<br />
      <br />
      I am trying to add another button called 'Add another machine' to the custom page B, and then call abort if this button is selected. In addition to this if the 'add another button' is slected then I want to write the current set of inputs into the csv before collecting the next set that the user enters.<br />
      <br />
      I have copied my installer so far (I have removed the 'obvious' lines), but am struggling to get further at the moment. Any assitance appreciated to complete the two above steps. Searching through the forums has not helped me so far.<br />
      <br />
      Thanks again.<br />
      <br />
      Start of installer.......................<br />
      <br />
      !include "MUI.nsh"<br />
      !include "LogicLib.nsh"<br />
      <br />
      <br />
      ; Welcome page<br />
      !insertmacro MUI_PAGE_WELCOME<br />
      ; License page<br />
      !insertmacro MUI_PAGE_LICENSE<br />
      ; Directory page<br />
      !insertmacro MUI_PAGE_DIRECTORY<br />
      ;Page to enter the IP Address of system and Number of Systems, drive to map and biometric enabled<br />
      Page custom CustomPageA<br />
      ;Page to enter the IP Address, MAC address and name of server for WOL feature<br />
      Page custom CustomPageB<br />
      ;Instfiles page<br />
      !insertmacro MUI_PAGE_INSTFILES<br />
      ; Finish page<br />
      !insertmacro MUI_PAGE_FINISH<br />
      ;--------------------------------<br />
      <br />
      ; Language files<br />
      !insertmacro MUI_LANGUAGE "English"<br />
      ;--------------------------------<br />
      <br />
      <br />
      ReserveFile "ioA.ini"<br />
      ReserveFile "ioB.ini"<br />
      !insertmacro MUI_RESERVEFILE_INSTALLOPTIONS<br />
      <br />
      <br />
      Name "${PRODUCT_NAME} ${PRODUCT_VERSION}"<br />
      OutFile "xxx.exe"<br />
      InstallDir "$PROGRAMFILES\XXXX"<br />
      ShowInstDetails hide<br />
      <br />
      Section "MainSection" SEC01<br />
      <br />
      .....................................................................<br />
      <br />
      .....................................................................<br />
      ;Read a value from an InstallOptions INI file<br />
      !insertmacro MUI_INSTALLOPTIONS_READ $R0 "ioA.ini" "Field 2" "State" ;"IP"<br />
      !insertmacro MUI_INSTALLOPTIONS_READ $R1 "ioA.ini" "Field 4" "State" ;"X"<br />
      !insertmacro MUI_INSTALLOPTIONS_READ $R2 "ioA.ini" "Field 5" "State" ;for biometrics<br />
      !insertmacro MUI_INSTALLOPTIONS_READ $R3 "ioA.ini" "Field 7" "State" ;for drive letter<br />
      !insertmacro MUI_INSTALLOPTIONS_READ $R5 "ioB.ini" "Field 2" "State" ;for servername<br />
      !insertmacro MUI_INSTALLOPTIONS_READ $R8 "ioB.ini" "Field 4" "State" ;for mac address<br />
      !insertmacro MUI_INSTALLOPTIONS_READ $R7 "ioB.ini" "Field 6" "State" ;for ip address<br />
      <br />
      .....................................................................<br />
      <br />
      SectionEnd<br />
      <br />
      Section -Post<br />
      .............................................<br />
      <br />
      .............................................<br />
      SectionEnd<br />
      <br />
      <br />
      section -mapped_drive<br />
      <br />
      ..............................................<br />
      <br />
      ..............................................<br />
      <br />
      sectionend<br />
      <br />
      section -write_csv_file<br />
      fileopen $R4 "C:\program files\XXXXX\servermacs.csv" a<br />
      filewrite $R4 '$R5,$R8,$R7$\r$\n'<br />
      fileclose $R4<br />
      sectionend<br />
      <br />
      ;Installer Functions<br />
      <br />
      Function .onInit<br />
      <br />
      ;Extract InstallOptions INI files<br />
      !insertmacro MUI_INSTALLOPTIONS_EXTRACT "ioA.ini"<br />
      !insertmacro MUI_INSTALLOPTIONS_EXTRACT "ioB.ini"<br />
      FunctionEnd<br />
      <br />
      LangString TEXT_IO_TITLE ${LANG_ENGLISH} "Registration System Set Up"<br />
      LangString TEXT_IO_SUBTITLE ${LANG_ENGLISH} "This Page will set up your Registration System"<br />
      <br />
      Function CustomPageA<br />
      <br />
      !insertmacro MUI_HEADER_TEXT "$(TEXT_IO_TITLE)" "$(TEXT_IO_SUBTITLE)"<br />
      !insertmacro MUI_INSTALLOPTIONS_DISPLAY "ioA.ini"<br />
      <br />
      FunctionEnd<br />
      <br />
      Function CustomPageB<br />
      <br />
      !insertmacro MUI_HEADER_TEXT "$(TEXT_IO_TITLE)" "Please enter description, MAC Address and IP for each kiosk for the wake on LAN feature. (PAERS Server kiosk first)"<br />
      !insertmacro MUI_INSTALLOPTIONS_DISPLAY "ioB.ini"<br />
      <br />
      FunctionEnd</p>
    </div>
    <hr />

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]>
  </script>
</body>
</html>
