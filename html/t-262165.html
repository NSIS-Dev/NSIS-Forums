<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="Mui_page_drive" />

  <title>Mui_page_drive - NSIS Forums</title><!-- Bootstrap core CSS -->
  <link rel="stylesheet" type="text/css" href="//netdna.bootstrapcdn.com/bootswatch/3.0.2/readable/bootstrap.min.css" /><!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!--[if lt IE 9]>
                <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
                <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->
</head>

<body>
  <div class="container">
    <!-- Put navigation bar here -->

    <ol class="breadcrumb">
      <li><a href="../index.html" class="glyphicon glyphicon-home"></a></li>

      <li><a href="f-65.html">NSIS Discussion</a></li>

      <li class="active">Mui_page_drive</li>
    </ol>

    <p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=262165">Mui_page_drive</a></p><br />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Boyito</span><br />
      <span class="post-time small text-muted">20th December 2006 20:05 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>Mui_page_drive</strong><br />
      &nbsp; Hello, its me again<br />
      <br />
      There is a way to use something like MUI_PAGE_DIRECTORY but not to select directories, I need to select the disc drive letter where im going to install ( something like I put in the subject of this post )?<br />
      <br />
      TIA</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Red Wine</span><br />
      <span class="post-time small text-muted">20th December 2006 20:11 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Build a custom page with DirRequest. See <a href="http://nsis.sourceforge.net/Docs/InstallOptions/Readme.html" target="_blank">InstallOptions manual</a> and examine included InstallOptions examples.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Comm@nder21</span><br />
      <span class="post-time small text-muted">20th December 2006 20:16 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">you could simply customize the directory page.<br />
      <br />
      first, you'll need to do "AllowRootDirInstall true", then you need to write a function:<br />
      <br /></p>
      <pre>
<code>
onVerifyInstDir
<br />  IfFileExists $INSTDIR</code>*.* 0 invalid
<br />  StrLen$0 $INSTDIR
<br />  IntCmpU$0 3 0 0 invalid
<br />  Return
<br /> invalid:
<br />  Abort
<br />FunctionEnd 
<br />&gt;

</pre>this will make users to select valid drives only :)
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Boyito</span><br />
      <span class="post-time small text-muted">20th December 2006 20:59 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Thanks RW &amp; Comm@nder21<br />
      <br />
      I will try</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Boyito</span><br />
      <span class="post-time small text-muted">20th December 2006 21:02 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Excellent Comm@nder21<br />
      Works like i need<br />
      <br />
      Thanks again</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Comm@nder21</span><br />
      <span class="post-time small text-muted">22nd December 2006 15:21 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">:) you're welcome!</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Red Wine</span><br />
      <span class="post-time small text-muted">22nd December 2006 21:27 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">I didn't realise that you were talking about the standard directory page, sorry, I thought you're trying to achieve a custom directory request.<br />
      For the standard directory page you don't need the .onVerifyInstDir function, because when you browse/type for a directory, the standard directory page automatically checks if the directory is valid and if there is enough disk space, and then enables the next/install button. It's not possible to proceed if you browse/type for an invalid/out of space directory. All you need is the "allowrootdirinstall true", in order to install on the root of a valid drive.<br />
      The .onVerifyInstDir function as described in NSIS manual (4.7.2.1.10 .onVerifyInstDir) is suitable for some special actions, e.g. if you want to verify that the selected directory contains some specific file(s). This means that the function does not verify the selected directory, instead at the time when users have browse/type a directory, the function verifies either the existence of a specific file or the entire directory.<br />
      You may add the function of the following example to set the directory dialog pointing on target's system drive.<br /></p>
      <pre>
<code>outfile test.exe<br />showinstdetails show<br />allowrootdirinstall true<br /><br />!include WinMessages.nsh<br /><br />page directory "" dir_show<br />page instfiles<br /><br /><br />section<br />SetOutPAth '$INSTDIR'<br />file ; your file here<br />file ; your file here<br />SetOutPAth '$INSTDIR\Boo'<br />File ; your file here<br />sectionend<br /><br />Function dir_show<br />ExpandEnvStrings $R0 '%SYSTEMDRIVE%'<br />FindWindow $R1 "#32770" "" $HWNDPARENT<br />GetDlgItem $R2 $R1 '1019'<br />SendMessage $R2 ${WM_SETTEXT} 1 "STR:$R0\"<br />FunctionEnd</code>
</pre><br />
      Happy Holidays!
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Comm@nder21</span><br />
      <span class="post-time small text-muted">23rd December 2006 16:02 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">you did not understand what he wanted to achieve.<br />
      <br />
      he does not want to LET the user install the program on a partition root, but FORCE him to :)<br />
      <br />
      therefore you need .onVerifyInstDir<br />
      <br />
      and you're wrong. the function is named correctly, because in this function, you can define your own method of verifying if the user chose a correct/valid installation directory.<br />
      this can happen by check for existing files, but also by checking for a special layout of the path, e.g. it would be possible to let the user install only to pathnames that include the character 'g' in it :)</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Red Wine</span><br />
      <span class="post-time small text-muted">24th December 2006 01:11 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"></p>

      <blockquote>
        you did not understand what he wanted to achieve.<br />
        <br />
        he does not want to LET the user install the program on a partition root, but FORCE him to
      </blockquote>Ah! apologies... that was very dumb of me.<br />
      <br />

      <blockquote>
        and you're wrong. the function is named correctly, because in this function, you can define your own method of verifying if the user chose a correct/valid installation directory.
      </blockquote>Even with my sad english...<br />
      Did I mention something different up there?<br />
      <br />
      Happy Holidays!
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Red Wine</span><br />
      <span class="post-time small text-muted">24th December 2006 09:53 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"></p>

      <blockquote>
        The .onVerifyInstDir function as described in NSIS manual (4.7.2.1.10 .onVerifyInstDir) is suitable for some special actions, e.g. if you want to verify that the selected directory contains some specific file(s). This means that the function does not verify the selected directory, <font color="red">instead</font> at the time when users have browse/type a directory, the function verifies either the existence of a specific file or the entire directory.
      </blockquote>Sorry... Wrong expression! <font color="red">instead</font> -&gt; <font color="red">indeed</font>.<br />
      Again Happy Holidays
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Comm@nder21</span><br />
      <span class="post-time small text-muted">24th December 2006 12:41 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"></p>

      <blockquote>
        This means that the function does not verify the selected directory, instead at the time when users have browse/type a directory,
      </blockquote>this is what iritated me :)<br />
      <br />
      but yes, merry christmas!!!
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">mtech</span><br />
      <span class="post-time small text-muted">28th February 2007 15:23 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Hi,<br />
      I want a similar environment. The only difference is the User just selects the Hard-drive and that's it. he cant select any other directories only the root hard-drives..<br />
      <br />
      thanks</p>
    </div>
    <hr />

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]>
  </script>
</body>
</html>