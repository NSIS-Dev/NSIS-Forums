<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="Path Manipulation - square box character?" />

  <title>Path Manipulation - square box character? - NSIS Forums</title>
  <script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script>
  <!-- Bootstrap core CSS -->

  <link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css" />
  <link rel="stylesheet" href="../css/style.css" type="text/css" /><!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!--[if lt IE 9]>
                <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
                <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->
</head>

<body>
  <div class="container">
    <!-- Put navigation bar here -->

    <ol class="breadcrumb">
      <li><a href="../index.html" class="glyphicon glyphicon-home"></a></li>

      <li><a href="f-65.html">NSIS Discussion</a></li>

      <li class="active">Path Manipulation - square box character?</li>
    </ol>

    <p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=139857">Path Manipulation - square box character?</a></p><br />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">SprinklerHead</span><br />
      <span class="post-time small text-muted">23rd June 2003 16:25 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>Path Manipulation - square box character?</strong><br />
      This is in reference to the path manipulation functions here:<br />
      <a href="http://nsis.sourceforge.net/archive...e.php?pageid=91" target="_blank">http://nsis.sourceforge.net/archive...e.php?pageid=91</a><br />
      <br />
      I am using the path manipulation functions mentioned above. On Win9x based machines the functions add a path to the end of autoexec.bat (SET PATH=%PATH%;mydir). But on some machines there is a weird square character just above the SET PATH line. I am not positive what this square character is, but SET PATH never gets executed. Any ideas?</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">SprinklerHead</span><br />
      <span class="post-time small text-muted">23rd June 2003 16:26 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Try that link again...<br />
      <br />
      <a href="http://nsis.sourceforge.net/archive/viewpage.php?pageid=91" target="_blank">http://nsis.sourceforge.net/archive/....php?pageid=91</a></p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
      <span class="post-time small text-muted">25th June 2003 12:56 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Does that square character appear after the line too? Can you please attach the autoexec.bat file? What version of Windows have you tested it on?</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">SprinklerHead</span><br />
      <span class="post-time small text-muted">25th June 2003 14:01 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">The square character does not occur after the line, only just before it. This occurred on several Windows 98 machines. I have tested on all versions of Windows. It seems to only occur on some Windows 98 machines.<br />
      <br />
      My guess is that the square box character is an end of file character or a non-printable character. My gut feeling is that some autoexec.bat files have this character and some don't. That would explain why it only occurs on some Windows 98 boxes, not all.<br />
      <br />
      I fixed the machine here in the office that had this problem already, so I no longer have an autoexec.bat to send you. If another user reports the problem (one called last week but I told him how to fix), I will get them to email it to me and I will post it here.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">SprinklerHead</span><br />
      <span class="post-time small text-muted">25th June 2003 15:32 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Here is an example autoexec.bat file.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">pengyou</span><br />
      <span class="post-time small text-muted">25th June 2003 22:25 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">As you suspected, in the cases where things go wrong there is an end-of-file character at the end of the file to which you are adding the path. In your ZIP file, the first line ends with ASCII codes 13, 10, 26 (the normal sequence at the end of a line is ASCII 13, 10).<br />
      <br />
      One solution would be check that the file does not end with ASCII code 26 before you append the new data.<br />
      <br />
      The thread at <a href="http://forums.winamp.com/showthread.php?threadid=130099" target="_blank">http://forums.winamp.com/showthread.php?threadid=130099</a> may give you some ideas of how to go about this.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
      <span class="post-time small text-muted">27th June 2003 20:15 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Yey for DOS :(<br />
      <br />
      On my todo.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">SprinklerHead</span><br />
      <span class="post-time small text-muted">17th July 2003 18:33 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">I wrote a Delphi dll that can add a path to any 95 or NT based platform.<br />
      <br />
      It handles the square box character problem described above by searching for the ASCII character #26 on a line by itself and deleting that line if found.<br />
      <br />
      It also checks to see if the path you are adding is already in the system path. If it is, then it doesn't add it. This could save the user a reboot on 95 platforms. For NT based platforms, it automatically calls SendMessage - you don't have to call that in your install script.<br />
      <br />
      For 95 based platforms, autoexec.bat gets modified. For NT platforms, the Path data in the key HKLM\System\CurrentControlSet\Control\Session Manager\Environment\ gets modified.<br />
      <br />
      To add a path:<br /></p>
      <pre>
<code>Path::AddToPath $INSTDIR<br />Pop $0 ;&lt;--- will be either "Reboot" or "NoReboot"</code>
</pre><br />
      <br />
      To remove a path:<br />
      <pre>
<code>Path::RemoveFromPath $INSTDIR<br />Pop $0 ;&lt;--- will be either "Reboot" or "NoReboot"</code>
</pre><br />
      <br />
      The path must exist prior to a call to AddToPath or RemoveFromPath (GetShortPathName doesn't work right unless the Path exists).<br />
      <br />
      After this lengthy post the forum won't allow me to post the zip file because it's too big! Well, if someone wants it I can email it to you.
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Joost Verburg</span><br />
      <span class="post-time small text-muted">17th July 2003 20:18 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Please create an archive page for your plug-in and mail the plug-in to one of the admins.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">SprinklerHead</span><br />
      <span class="post-time small text-muted">18th July 2003 18:49 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Err, what's an archive page?</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">YtseJam</span><br />
      <span class="post-time small text-muted">18th July 2003 18:56 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><a href="http://nsis.sourceforge.net/archive" target="_blank">http://nsis.sourceforge.net/archive</a></p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
      <span class="post-time small text-muted">29th November 2003 17:34 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Finally fixed.</p>
    </div>
    <hr />

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]>
  </script>
</body>
</html>
