<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="description" content="Detection of MSDE at user's computer"><title>Detection of MSDE at user's computer - NSIS Forums</title><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script><link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css"><link rel="stylesheet" href="../css/style.css" type="text/css"><!--[if lt IE 9]><script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script><script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script><![endif]--></head><body><div class="container"><ol class="breadcrumb"><li><a href="../index.html" class="glyphicon glyphicon-home"></a></li><li><a href="f-65.html">NSIS Discussion</a></li><li class="active">Detection of MSDE at user's computer</li></ol><p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=261052">Detection of MSDE at user's computer</a></p><br><div class="post"><p class="post-meta"><span class="post-author text-primary">Swapan Das</span><br><span class="post-time small text-muted">4th December 2006 11:42 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>Detection of MSDE at user's computer</strong><br>Hello Everybody,<br><br>Warm greetings from India!<br><br>I'm making an installer to install MSDE 2000. Its working fine (thanks for the help esp. to Bruno). Now I'm doing some refinement to it. How can I detect whether MSDE is installed in the user's computer or not. For the time being version/instance checking is not required...just want to check MSDE of any version is installed or not before I start MSDE Installation from NSIS Installer.<br><br>With regards,<br><br>p.s.:I've gone through materials on this forum related to this issue, but unable to decipher any simple and short solution to it.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Red Wine</span><br><span class="post-time small text-muted">4th December 2006 12:56 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Did you try from NSIS manual 4.9.4.10 IfFileExists,<br>or E.1.2 Locate, or get values from regisrty?</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Swapan Das</span><br><span class="post-time small text-muted">5th December 2006 11:56 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Yes, for the time being I'm using IfFileExists to detect MSDE in user's computer. But this method is not proper as the MSDE may be installed into any other location other then the default location. I'm giving the code, for others :<br><br>${If} ${FileExists} "$PROGRAMFILES\Microsoft SQL Server\80\Tools\Binn\sqlmangr.exe"<br>MessageBox MB_ICONEXCLAMATION|MB_OK "MSDE already installed!$\nSetup is terminating the installation process."<br>Quit<br>${Endif}<br><br>But friends, this is not the actual solution! I'm looking for some way to trap it from the registry. Precisely, if there is a way to read from the control panel's 'Add/Remove program lists. Is someone listening?!<br><br>With regards,</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">bholliger</span><br><span class="post-time small text-muted">5th December 2006 12:31 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Hi Swapan Das!<br><br>I found an article. They mention a registry key. Maybe you can have a look in the registry of your installation and see what's in there.<br><br>HKEY_LOCAL_MACHINE\Software\Microsoft\MSSQLServer (\Setup)<br><br>[1] <a href="http://www.betav.com/Files/Content/Whitepapers/msde_files/msde.htm" target="_blank">http://www.betav.com/Files/Content/W...files/msde.htm</a><br><br>Have a nice day!<br><br>Cheers<br><br>Bruno</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Red Wine</span><br><span class="post-time small text-muted">5th December 2006 12:43 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">I see...<br>You may want to read the NSIS manual at 4.9.2 Registry, INI, File Instructions.<br>ex<br>ReadRegStr $R0 HKLM "Software\Microsoft\Windows\CurrentVersion\Uninstall\&lt;MSDE Record&gt;" "UninstallString"<br>StrCmp $R0 '' _notInstalled</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">bholliger</span><br><span class="post-time small text-muted">5th December 2006 12:50 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Huh, there's a wiki article about SQL Server. It might be useful for you.<br><br><a href="http://nsis.sourceforge.net/How_to_tell_what_version_of_SQLServer_is_installed" target="_blank">http://nsis.sourceforge.net/How_to_t...r_is_installed</a><br><br>Cheers<br><br>Bruno</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Swapan Das</span><br><span class="post-time small text-muted">8th December 2006 07:30 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Dear Friends!<br><br>Thanks a lot for all the help. After going through this issue while considering all the suggestions from all of you, I came with one solution.<br><br>If anyone is interested, can try my this tested code:<br><br>ReadRegStr $R0 HKLM \<br>"SOFTWARE\Microsoft\MSSQLServer\Setup" SQLPath ;ProductCode<br>${If} $R0 == ""<br>;MessageBox MB_ICONEXCLAMATION|MB_OK "SQL Server not detected, press any key to install"<br>${Else}<br>MessageBox MB_ICONEXCLAMATION|MB_OK "SQL Server/MSDE already installed!$\nSQL Path:$R0$\nSetup is terminating the installation process."<br>Quit<br>${EndIf}<br><br><br>With regards,<br>Swapan</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Red Wine</span><br><span class="post-time small text-muted">8th December 2006 10:09 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">cool :-)</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Swapan Das</span><br><span class="post-time small text-muted">8th December 2006 10:35 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">I've also posted a separate post for this at:<br><a href="http://forums.winamp.com/showthread.php?s=&amp;threadid=261330" target="_blank">http://forums.winamp.com/showthread....hreadid=261330</a></p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">bholliger</span><br><span class="post-time small text-muted">8th December 2006 11:06 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Hi Swapan!<br><br>Thank you very much for this posting!<br><br>Could you create a wiki page on nsis.sf.net? There is a special section which deals with software detection. It would be nice to have this one there!<br><br>Cheers<br><br>Bruno</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Swapan Das</span><br><span class="post-time small text-muted">8th December 2006 11:14 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Thanks Bruno!<br><br>I'll definitely do it. But give me some time as I'm pre-occupied with many tasks at office. You know office job!</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">bholliger</span><br><span class="post-time small text-muted">8th December 2006 11:27 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">No worries! It's just great to collect those information in a central place so everyone has easy access... :-)</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">TypoBound</span><br><span class="post-time small text-muted">9th December 2006 13:40 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">I found it handier to look for the instance instead. If it doesn't exist, I then check for the SQL service. I can then poll that to see if my database already exists or prompt for install.<br><br>In any case, you don't have to worry about where it is installed by looking for services. I use the same approach for IIS. If I don't find the service I throw up a prompt to install and execute sysocmgr on yes or abort virtual web page install on no. At least for me this has made a very clean approach for handling missing prerequisits.</p></div><hr><div class="footer"><p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p></div></div><script src="../js/highlight.pack.js" type="text/javascript"></script><script type="text/javascript">//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]></script></body></html>