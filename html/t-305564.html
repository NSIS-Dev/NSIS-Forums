<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="NSIS - Dynamic custom pages" />

  <title>NSIS - Dynamic custom pages - NSIS Forums</title>
  <script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script>
  <!-- Bootstrap core CSS -->

  <link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css" />
  <link rel="stylesheet" href="../css/style.css" type="text/css" /><!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!--[if lt IE 9]>
                <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
                <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->
</head>

<body>
  <div class="container">
    <!-- Put navigation bar here -->

    <ol class="breadcrumb">
      <li><a href="../index.html" class="glyphicon glyphicon-home"></a></li>

      <li><a href="f-65.html">NSIS Discussion</a></li>

      <li class="active">NSIS - Dynamic custom pages</li>
    </ol>

    <p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=305564">NSIS - Dynamic custom pages</a></p><br />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">sylvinhio</span><br />
      <span class="post-time small text-muted">21st April 2009 09:40 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>NSIS - Dynamic custom pages</strong><br />
      Hello,<br />
      <br />
      I'm using NSIS with Eclipse plugin to build custom pages.<br />
      My custom pages are ".ini" files and used like that:<br />
      Page Custom MyPage MyPageLeave " : This is my page"<br />
      <br />
      In a custom page, I have "2 group boxes":<br />
      <br />
      The first group box contains 2 radio buttons<br />
      The second contains a textbox<br />
      <br />
      When checking a radio button, I want to disable the textbox.<br />
      When checking the other radio button, I want to enable the textbox.<br />
      <br />
      Is it possible ?<br />
      <br />
      Thanks a lot</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Anders</span><br />
      <span class="post-time small text-muted">21st April 2009 10:08 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">NOTIFY flag</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">sylvinhio</span><br />
      <span class="post-time small text-muted">21st April 2009 11:01 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Hi, thanks for your answer... it's seems to work.<br />
      <br />
      No my problems are:<br />
      <br />
      1/ When my radio is checked, the "leave" function is invoked. In my leave function, I'm setting values like<br />
      <br />
      WriteINIStr $R0 "Field 7" "State" "localhost"<br />
      WriteINIStr $R0 "Field 7" "Flags" "DISABLED"<br />
      <br />
      My my page is not reloaded so my changes are not uploaded on the page. How can I do that ?<br />
      <br />
      2/ When my radio is checked, the "leave" function is invoked. How can I make the difference between the "leave" function invoked by my NOTIFY flag and the leave function invoked when the page is leaved ?<br />
      <br />
      Thank you very much for your help</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Anders</span><br />
      <span class="post-time small text-muted">21st April 2009 11:05 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">the installoptions readme tells you how</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">sylvinhio</span><br />
      <span class="post-time small text-muted">21st April 2009 12:59 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">In the documentation, it's written that changes on the new version "Made pages refresh after an aborted leave function".<br />
      <br />
      But if I'm doing "Abort" in the leave function, my page is not refreshed !!<br />
      <br />
      I didn't find anything about how I can make the difference between the "leave" function invoked by my NOTIFY flag and the leave function invoked when the page is leaved.<br />
      <br />
      Can you help me or tell me in which part of the documentation I can find that information ?<br />
      <br />
      Thanks</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Anders</span><br />
      <span class="post-time small text-muted">21st April 2009 13:09 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"></p>

      <blockquote>
        Your validation/leave function can read the "State" value from the "Settings" section to determine which control caused the notification, if any, and perform some appropriate action followed by an Abort instruction (to tell NSIS to return to the page). The Examples\InstallOptions folder contains an example script showing how this might be used.
      </blockquote>Your page is not refreshed, you need to update the controls and not the .ini
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">sylvinhio</span><br />
      <span class="post-time small text-muted">21st April 2009 13:46 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Hi,<br />
      <br />
      Sorry but I didn't find how to change control value instead of ini values.<br />
      <br />
      The only thing I found was :<br />
      <br />
      Writing to INI files<br />
      <br />
      The INSTALLOPTIONS_WRITE macro allows you to write values to the INI file to change texts or control settings on runtime:<br />
      <br />
      !insertmacro INSTALLOPTIONS_WRITE "myFile.ini" "Field #" "Name" "Value"<br />
      <br />
      But that doesn't update my control value...<br />
      <br />
      <br />
      I forgot to tell I'm using NSIS InstallOptions....</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">sylvinhio</span><br />
      <span class="post-time small text-muted">21st April 2009 15:13 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">I have tried with the following instructions (the field number of the text i want to update is 2):<br />
      <br />
      GetDlgItem $R1 $HWNDPARENT 1201 ;1200 + Field number - 1<br />
      MessageBox MB_OK "R1 = $R1"<br />
      SendMessage $R1 ${WM_SETTEXT} "STR:MY NEW VALUE" 0<br />
      <br />
      The messagebox instruction always displays R1 = 0</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">sylvinhio</span><br />
      <span class="post-time small text-muted">21st April 2009 16:25 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">I have found how to set the text value :<br />
      <br />
      ;Get the HWND ID of the field<br />
      ReadINIStr $idChampIP "$R0" "Field 2" "HWND"<br />
      <br />
      ,;Sets the value to "localhost"<br />
      SendMessage $idChampIP ${WM_SETTEXT} 1 "STR:localhost"<br />
      <br />
      But I would like to set the flag "DISABLED" to 1 on this field<br />
      <br />
      I have tried that without success ("2" means that this is the 2nd flag but I'm not sure it works like that)<br />
      <br />
      SendMessage $idChampIP ${BM_SETCHECK} 1 "2"<br />
      <br />
      <br />
      Don't know how it works and can't find any documentation givin' all the constants we can use 'BM_, WM_, ...)<br />
      <br />
      Can someone help me please ?<br />
      <br />
      Thanks</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
      <span class="post-time small text-muted">21st April 2009 19:04 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">EnableWindow<br />
      <br />
      I recommend you switch to MUI2 and nsDialogs.<br />
      <br />
      Stu</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">sylvinhio</span><br />
      <span class="post-time small text-muted">21st April 2009 21:49 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">I just want to disable the text box, not the entire Page.<br />
      How can I use that flag ? I thought that "EnableWindow" had effect on the entire page....</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">sylvinhio</span><br />
      <span class="post-time small text-muted">22nd April 2009 09:19 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Tu sum up I've gt two problems, after searching all the day in the documentation and code examples.<br />
      <br />
      1/ How to dynamically disable a textbox<br />
      <br />
      I have found how to set the text value :<br />
      <br />
      ;Get the HWND ID of the field<br />
      ReadINIStr $idChampIP "$R0" "Field 2" "HWND"<br />
      <br />
      ,;Sets the value to "localhost"<br />
      SendMessage $idChampIP ${WM_SETTEXT} 1 "STR:localhost"<br />
      <br />
      But I would like to set the flag "DISABLED" to 1 on this field<br />
      <br />
      I have tried that without success ("2" means that this is the 2nd flag but I'm not sure it works like that)<br />
      <br />
      SendMessage $idChampIP ${BM_SETCHECK} 1 "2"<br />
      <br />
      <br />
      Don't know how it works and can't find any documentation givin' all the constants we can use 'BM_, WM_, ...)<br />
      <br />
      2/ When I'm in a "leave" function of a custom page, how to know if I'm coming from the NOITIFY event of a control or from the "NEXT button click".<br />
      <br />
      <br />
      If someone can help me...<br />
      <br />
      Thanks a lot</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Anders</span><br />
      <span class="post-time small text-muted">22nd April 2009 09:36 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">1)<br />
      ReadINIStr $idChampIP "$R0" "Field 2" "HWND"<br />
      EnableWindow $idChampIP 0<br />
      <br />
      2)<br />
      read the state value in the settings section IIRC, like I said, read the docs, and the docs will tell you to check testnotify.nsi<br />
      <br />
      as far as docs for WM_,BM_ etc, check <a href="http://www.MSDN.com" target="_blank">www.MSDN.com</a></p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">sylvinhio</span><br />
      <span class="post-time small text-muted">22nd April 2009 14:47 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Thanks a lot, everything works fine !!!</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">glambert</span><br />
      <span class="post-time small text-muted">5th May 2009 09:38 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Hi,<br />
      <br />
      I've got a custom page with 2 radio buttons on it, whatever I do on it I can't go through to the next page.<br />
      <br />
      My code is -<br />
      <br /></p>
      <pre>
<code><br />Function ShowDLLPage<br />  InstallOptions::initDialog "$PLUGINSDIR\dlltype.ini"<br />  Pop $0<br />  InstallOptions::show<br />  Pop $0<br />FunctionEnd<br /><br />Function ProcessDLLPage<br />  ReadINIStr $0 "$PLUGINSDIR\dlltype.ini" "Settings" "State"<br />  StrCmp $0 1 pcs<br />  StrCmp $0 2 lv<br />  Abort<br /><br />  pcs:<br />    FileOpen $9 $INSTDIR\config\mode.conf w<br />    FileWrite $9 "1"<br />    FileClose $9<br />    Abort<br />  lv:<br />    FileOpen $9 $INSTDIR\config\mode.conf w<br />    FileWrite $9 "0"<br />    FileClose $9<br />    Abort<br />FunctionEnd<br /></code>
</pre><br />
      <br />
      at first I thought, it must be the Abort's, but when I removed them, just clicking on the radio buttons went through to the next page and didn't do the file writing stuff at all.<br />
      <br />
      can anyone point out where i'm going wrong here?
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
      <span class="post-time small text-muted">5th May 2009 10:16 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Depending on your NSIS version you may need to use /NOUNLOAD on your InitDialog call.<br />
      <br />
      Edit: If it is not that, check the INI file exists and that it does not contain errors.<br />
      <br />
      Stu</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">glambert</span><br />
      <span class="post-time small text-muted">5th May 2009 10:26 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"></p>

      <blockquote>
        <i>Originally posted by Afrow UK</i><br />
        <b>Depending on your NSIS version you may need to use /NOUNLOAD on your InitDialog call.<br />
        <br />
        Edit: If it is not that, check the INI file exists and that it does not contain errors.<br />
        <br />
        Stu</b>
      </blockquote>Hi Stu,<br />
      <br />
      I appreciate the quick reply.<br />
      <br />
      It didn't fix it unfortunately. My version of NSIS is 2.42<br />
      <br />
      The INI file is -<br />
      <br />
      <pre>
<code><br />[Settings]<br />NumFields=2<br />Title="Choose Install Type"<br /><br />[Field 1]<br />Type="RadioButton"<br />Text="PCS"<br />Flags=NOTIFY<br />State=0<br />Left=10<br />Right=100<br />Top=17<br />Bottom=25<br /><br />[Field 2]<br />Type="RadioButton"<br />Text="LV"<br />Flags=NOTIFY<br />State=1<br />Left=10<br />Right=100<br />Top=30<br />Bottom=38<br /></code>
</pre><br />
      <br />
      EDIT: it is going through to the "leave" page when it isn't allowing the next button to be clicked, I checked the file it should be writing to and it is working properly.
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
      <span class="post-time small text-muted">5th May 2009 10:51 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">So the file exists in $PLUGINSDIR?<br />
      You should try the InstallOptions helper script header.<br />
      <br />
      But first try replacing both plugin calls with just a call to InstallOptions::Dialog<br />
      <br />
      Stu</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">glambert</span><br />
      <span class="post-time small text-muted">5th May 2009 11:01 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"></p>

      <blockquote>
        <i>Originally posted by Afrow UK</i><br />
        <b>So the file exists in $PLUGINSDIR?<br />
        You should try the InstallOptions helper script header.<br />
        <br />
        But first try replacing both plugin calls with just a call to InstallOptions::Dialog<br />
        <br />
        Stu</b>
      </blockquote>Hi Stu,<br />
      <br />
      in the .onInit function I'm doing -<br />
      <br />
      <pre>
<code><br />InitPluginsDir<br />  File /oname=$PLUGINSDIR\dlltype.ini "dlltype.ini"<br /></code>
</pre><br />
      <br />
      I have changed initDialog to Dialog and still no joy with it.<br />
      <br />
      Are there any errors in my ini file that you can see? Do I have to do something special for the next button?
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
      <span class="post-time small text-muted">5th May 2009 11:04 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">I assume you have Page Custom ShowDLLPage ProcessDLLPage?<br />
      What is the value of $0 after the ::Dialog call?<br />
      <br />
      Stu</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">glambert</span><br />
      <span class="post-time small text-muted">5th May 2009 11:10 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"></p>

      <blockquote>
        <i>Originally posted by Afrow UK</i><br />
        <b>I assume you have Page Custom ShowDLLPage ProcessDLLPage?<br />
        What is the value of $0 after the ::Dialog call?<br />
        <br />
        Stu</b>
      </blockquote>Yes -<br />
      <br />
      <pre>
<code><br />  !insertmacro MUI_PAGE_INSTFILES<br />  Page custom ShowDLLPage ProcessDLLPage<br /></code>
</pre><br />
      <br />
      I set an alert to come up with the value of $0.<br />
      <br />
      When I click the following, these values appear -<br />
      <br />
      PCS = 1<br />
      LV = 2<br />
      Next = 0
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">glambert</span><br />
      <span class="post-time small text-muted">5th May 2009 15:47 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">resolved by using nsDialogs</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
      <span class="post-time small text-muted">5th May 2009 16:40 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Shame you had to go down that route (even though it is best to switch anyway). Would be nice to know what went wrong.<br />
      <br />
      Stu</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">jpderuiter</span><br />
      <span class="post-time small text-muted">5th May 2009 17:22 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">If I recall correctly 'Flags' in [Field 1] should be NOTIFY|GROUP</p>
    </div>
    <hr />

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]>
  </script>
</body>
</html>
