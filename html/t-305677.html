<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="Windows 7 - RequestExecutionLevel ?" />

  <title>Windows 7 - RequestExecutionLevel ? - NSIS Forums</title><!-- Bootstrap core CSS -->
  <link rel="stylesheet" type="text/css" href="//netdna.bootstrapcdn.com/bootswatch/3.0.1/readable/bootstrap.min.css" />
  <link rel="stylesheet" href="../css/style.css" type="text/css" /><!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!--[if lt IE 9]>
                <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
                <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->
</head>

<body>
  <div class="container">
    <!-- Put navigation bar here -->

    <ol class="breadcrumb">
      <li><a href="../index.html" class="glyphicon glyphicon-home"></a></li>

      <li><a href="f-65.html">NSIS Discussion</a></li>

      <li class="active">Windows 7 - RequestExecutionLevel ?</li>
    </ol>

    <p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=305677">Windows 7 - RequestExecutionLevel ?</a></p><br />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kando234</span><br />
      <span class="post-time small text-muted">24th April 2009 09:30 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>Windows 7 - RequestExecutionLevel ?</strong><br />
      Hi,<br />
      <br />
      another small problem I experienced...<br />
      I really donÂ´t get this and maybe someone<br />
      out here has an idea whatÂ´s going on.<br />
      <br />
      My old installation routine - i call it (1) from now on - (guess it was built with NSIS version &lt; 2) works fine on windows 7...<br />
      <br />
      But my new installation routine - (2) - (same source,<br />
      just added a few sections) doesnÂ´t.<br />
      <br />
      HereÂ´s what happens on Windows 7:<br />
      <br />
      (1) UAC Warning,<br />
      <a href="http://img27.imageshack.us/img27/3365/unbenanntmtp.png" target="_blank">looks like this</a><br />
      (if url does not appear: img27.imageshack.us/img27/3365/unbenanntmtp.png<br />
      <br />
      -&gt; I click allow -&gt; everything works as expected<br />
      <br />
      (2): Security warning due to unknown publisher<br />
      (we know that from Vista and XP) - <a href="http://www.tweak-uac.com/UAC-unknown-publisher.png" target="_blank">looks like this</a> (i googled an image, if url does not appear: tweak-uac.com/UAC-unknown-publisher.png)<br />
      <br />
      -&gt; I click "Run" -&gt; Installer works fine but isnÂ´t allowed to create folders or shortcuts<br />
      <br />
      <b>P.S.:</b><br />
      RequestExecutionLevel for both installers is set to:<br />
      <br />
      RequestExecutionLevel user<br />
      <br />
      <br />
      Thanks for any hint you can provide on why those installation routines work different (I want it the way the old installation routine worked ... without changing user -&gt; admin, or is it impossible without changing it to admin ?)</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Animaether</span><br />
      <span class="post-time small text-muted">24th April 2009 16:23 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">where are you trying to create the folders/shortcuts? They may be off-limits to writing except for admins (short of an admin messing with permissions).</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kando234</span><br />
      <span class="post-time small text-muted">24th April 2009 18:44 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Folders in<br />
      C:\Program Files\[blabla]<br />
      <br />
      and<br />
      <br />
      shortcuts in startmenu and desktop.<br />
      <br />
      The old installer works fine with RequestLevel user !<br />
      But the new one doesnÂ´t ... It cannot create folders<br />
      or shortcuts in Vista or Windows 7.<br />
      <br />
      Is there something the new version of NSIS changed ?</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Animaether</span><br />
      <span class="post-time small text-muted">24th April 2009 18:53 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">yes, but did your old installer actually try to write to c:\program files\[blabla]?<br />
      <br />
      If not - there's your problem :) Any installer that wants to write files to the Program Files folder, write to the HKLM registry and several more bits and pieces require administrator rights.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kando234</span><br />
      <span class="post-time small text-muted">24th April 2009 19:46 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Of course I tried the same folders in "Program Files" but as you can see both installers request different authorization.... very strange.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Anders</span><br />
      <span class="post-time small text-muted">25th April 2009 12:15 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">there was no RequestExecutionLevel in &lt;v2, so what you are saying does not make any sense.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Comperio</span><br />
      <span class="post-time small text-muted">25th April 2009 17:57 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">I'll add a few more things:<br />
      <br />
      RequestExecutionLevel was added with 2.21. So even the very first releases of 2.x did not have it.<br />
      <br />
      And are SURE that you have RequestExecutionLevel properly set?<br />
      <br />
      I know Windows Vista has the ability to try to auto-detect if an EXE is an installation or not based on file names, embedded vendor info, and other "signatures". So it's possible you'd get the UAC prompt in some cases in which there was no application manifest.<br />
      <br />
      I did some searching and found this tool that may help you 'peek inside' your EXE to show you any embedded application manifest to allow you to see if it actually has the proper executionlevel set: (<a href="http://weblogs.asp.net/kennykerr/archive/2007/07/10/manifest-view-1-0.aspx" target="_blank">http://weblogs.asp.net/kennykerr/arc...-view-1-0.aspx</a>)<br />
      <br />
      I haven't tried it, but I thought I'd mentioned it as a way for you to double-check each of your EXEs to see if they actually have the manifest set properly. (There is another tool in one of the MS SDKs that I've used before that does a similar thing, but unfortunately, I don't remember the name of it off hand...)</p>
    </div>
    <hr />

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]>
  </script>
</body>
</html>
