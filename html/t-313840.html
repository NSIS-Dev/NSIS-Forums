<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="Correct sub-folders for &quot;current user&quot;-mode" />

  <title>Correct sub-folders for "current user"-mode - NSIS Forums</title><!-- Bootstrap core CSS -->
  <link rel="stylesheet" type="text/css" href="//netdna.bootstrapcdn.com/bootswatch/3.0.1/readable/bootstrap.min.css" />
  <link rel="stylesheet" href="../css/style.css" type="text/css" /><!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!--[if lt IE 9]>
                <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
                <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->
</head>

<body>
  <div class="container">
    <!-- Put navigation bar here -->

    <ol class="breadcrumb">
      <li><a href="../index.html" class="glyphicon glyphicon-home"></a></li>

      <li><a href="f-65.html">NSIS Discussion</a></li>

      <li class="active">Correct sub-folders for "current user"-mode</li>
    </ol>

    <p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=313840">Correct sub-folders for "current user"-mode</a></p><br />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">TrifonovS</span><br />
      <span class="post-time small text-muted">15th October 2009 06:28 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>Correct sub-folders for "current user"-mode</strong><br />
      Hi,<br />
      Sorry if this problem was already discussed, but I couldn't find the answer.<br />
      I use MultiUser.nsh in my script and I have the following define:<br />
      !define MULTIUSER_INSTALLMODE_DEFAULT_CURRENTUSER<br />
      The dialog for selection of the mode is not shown, so the installation is fixed to "current user".<br />
      The shortcuts and writing to the Windows registry is OK, but the installer places my application on a wrong subfolder. I mean that Program Files (x86) on Vista and 7 is virtual, so the installer must place the application in the sub-folder User\... (specific for the user). I expected that if the correct mode is selected, then the variables like $PROGRAMFILES, $INSTDIR, $COMMONFILES will have the correct content, but it is not so. Can you give me an advice what to do to install my application in the correct subfolder for the current user only?<br />
      Thanks!</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">MSG</span><br />
      <span class="post-time small text-muted">15th October 2009 12:43 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>Re: Correct sub-folders for "current user"-mode</strong><br /></p>

      <blockquote>
        <i>Originally posted by TrifonovS</i><br />
        <b>I expected that if the correct mode is selected, then the variables like $PROGRAMFILES, $INSTDIR, $COMMONFILES will have the correct content, but it is not so.</b>
      </blockquote>Actually it is. It's not NSIS's fault that a normal user doesn't have write priviledges to $PROGRAMFILES. Use LocalAppData as installation folder, instead.
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">TrifonovS</span><br />
      <span class="post-time small text-muted">16th October 2009 06:55 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Thanks! It works now. I use $PROGRAMFILES or $LOCALAPPDATA, depending on the selected installation mode.</p>
    </div>
    <hr />

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]>
  </script>
</body>
</html>
