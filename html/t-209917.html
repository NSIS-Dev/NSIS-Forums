<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="Scheduled tasks" />

  <title>Scheduled tasks - NSIS Forums</title>
  <script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script>
  <!-- Bootstrap core CSS -->

  <link rel="stylesheet" type="text/css" href="//netdna.bootstrapcdn.com/bootswatch/3.0.1/readable/bootstrap.min.css" />
  <link rel="stylesheet" href="../css/style.css" type="text/css" /><!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!--[if lt IE 9]>
                <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
                <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->
</head>

<body>
  <div class="container">
    <!-- Put navigation bar here -->

    <ol class="breadcrumb">
      <li><a href="../index.html" class="glyphicon glyphicon-home"></a></li>

      <li><a href="f-65.html">NSIS Discussion</a></li>

      <li class="active">Scheduled tasks</li>
    </ol>

    <p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=209917">Scheduled tasks</a></p><br />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">mynab</span><br />
      <span class="post-time small text-muted">9th March 2005 13:09 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>Scheduled tasks</strong><br />
      Hello,<br />
      <br />
      I am trying to setup scheduled tasks and properly set the user /password that I get through a custom page. I use a script that I got somewhere (can't remember exactly but probably here) that uses ITaskScheduler and ITask. I therefore does something like:<br />
      <br />
      System::Call '$R2-&gt;30(w "user", w "password")'<br />
      <br />
      but it does not seem to work. Does anyone has any success with this?<br />
      <br />
      Thanks,<br />
      mynab</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
      <span class="post-time small text-muted">9th March 2005 16:05 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Please search the forum in future...<br />
      <a href="http://forums.winamp.com/showthread.php?s=&amp;threadid=147686&amp;highlight=task" target="_blank">http://forums.winamp.com/showthread....highlight=task</a><br />
      <br />
      -Stu</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">mynab</span><br />
      <span class="post-time small text-muted">10th March 2005 17:03 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Please read the messages in the future...<br />
      The thread you mention is the one I got the script from. I am trying to enhance this script to add a call to ITask to set the user and password on the task I create. Anyone?<br />
      <br />
      -Mynab</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
      <span class="post-time small text-muted">10th March 2005 18:10 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Sorry but your original post did not contain information about the direct source.<br />
      <br />
      Try t instead of w<br />
      <br />
      -Stu</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
      <span class="post-time small text-muted">10th March 2005 18:23 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">According to MSDN, SetAccountInformation requires Unicode string, so w is ok.<br />
      <br />
      What's the return value of the method?</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">mynab</span><br />
      <span class="post-time small text-muted">11th March 2005 08:21 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Not sure if it's right but what I did is add i.R9 at the end of my System::Call line and then do a MessageBox with $R9 and it displays 0 which is equal to S_OK. So it seems Windows does not complain.<br />
      <br />
      However if I then go to the scheduled tasks panel and run my task it fails. If I open the task set the password and then run it again it is OK so I guess I really have to set the password on the task even though the task should be run by the same user as the one that installs the software (Administrator in that case).<br />
      <br />
      mynab</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">mynab</span><br />
      <span class="post-time small text-muted">16th March 2005 15:34 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Anyone on this?<br />
      <br />
      mynab</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
      <span class="post-time small text-muted">17th March 2005 20:50 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Can you post the complete code snippet so it can be tested?</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">mynab</span><br />
      <span class="post-time small text-muted">31st March 2005 15:38 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Sorry kichik,<br />
      <br />
      did not see your post and switched to something else. Just tought I should give an update on this.<br />
      <br />
      I finally discovered and started to use the schtasks command. Much more powerful than the at command as it allows for everything I needed except multiple scheduling for the same task. It might not be available on older systems but it is at least on XP Pro and 2003 Server. Just type schtasks /? at the command prompt to get a detailed explanation of all the command line switches.<br />
      <br />
      Regards,<br />
      mynab</p>
    </div>
    <hr />

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]>
  </script>
</body>
</html>
