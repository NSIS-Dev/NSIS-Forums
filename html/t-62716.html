<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="Debug versions?" />

  <title>Debug versions? - NSIS Forums</title><!-- Bootstrap core CSS -->
  <link rel="stylesheet" type="text/css" href="//netdna.bootstrapcdn.com/bootswatch/3.0.1/readable/bootstrap.min.css" />
  <link rel="stylesheet" href="../css/style.css" type="text/css" /><!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!--[if lt IE 9]>
                <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
                <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->
</head>

<body>
  <div class="container">
    <!-- Put navigation bar here -->

    <ol class="breadcrumb">
      <li><a href="../index.html" class="glyphicon glyphicon-home"></a></li>

      <li><a href="f-65.html">NSIS Discussion</a></li>

      <li class="active">Debug versions?</li>
    </ol>

    <p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=62716">Debug versions?</a></p><br />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">tony@tgtsoft.co</span><br />
      <span class="post-time small text-muted">16th October 2001 01:22 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>Debug versions?</strong><br />
      Question about the source below. If you aren't into the source read-on.<br />
      <br />
      Ok, I need an install with some customized functions. So I called them from my exe with ShellExecute, and was I though I was finshed. No problems yet.<br />
      <br />
      My boss doesn't like the idea of "another" exe, so he insisted that I add some keywords execute my functions. Blah, blah. So I added them, and still no problem.<br />
      <br />
      Now I want to debug my code and then the problems start.<br />
      <br />
      First off the stuff wouldn't build at all until I took out<br />
      /entrypoint:"WinMain", and increased the compilier stack size with /Zm500.<br />
      <br />
      Now that I got it to build, I couldn't execute the debug version of my install because VSS thad it didn't have the symbols. I assumed that it was because stuff (headers, data, and other stuff) is tacked on the end of the .exe. So I put that carp into a seperate file, and have exehead look on the seperate file, instead on the end of itself.<br />
      <br />
      So with a bit of hacking I can now debug the install.<br />
      <br />
      Now I want to do the same with the uninstall, but before I wonder/wander into the code again, I wanted to see if others have ventured this deep into the code.<br />
      <br />
      Is this a lost cause?<br />
      Is there an easier way?<br />
      <br />
      The easier question is how do I create an uninstall file with a debug exehead. I see that they are almost the same, but not quite. What functions should I start looking at.<br />
      <br />
      Tony Stratton</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">pjw62</span><br />
      <span class="post-time small text-muted">16th October 2001 19:20 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">You could just debug your code in a seperate exe file if that is appropriate (e.g. you dont need to use some function of NSIS). I think you may be mistaken about the uninstall exe header though, it is the same except it has the uninstall icon.. run a file comparer and I think you will find (as I did)..<br />
      changes occur in the range 862Ch through 88FEh, which incidentally falls in the primary icon reosurce.<br />
      Failing that just browse through the source to see what happens (try searching for NSIS_CONFIG_UNINSTALL_SUPPORT, the main uninstaller generation is in ui.c, begins line 822, allocs mem for exe header, reads from orig. installer exe after getting pointer to string for name of exe in string table, if the there is an uninstall icon specified then expand and copy to specified offset in new exe uninstall file etc etc etc) ..</p>
    </div>
    <hr />

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]>
  </script>
</body>
</html>
