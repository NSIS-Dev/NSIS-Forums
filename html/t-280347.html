<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="description" content="Scheduling a tastk"><title>Scheduling a tastk - NSIS Forums</title><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script><link rel="preload" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css" as="style" onload="this.rel='stylesheet'"><link rel="preload" href="../css/style.css" as="style" onload="this.rel='stylesheet'"><noscript><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css"><link rel="stylesheet" href="../css/style.css"></noscript><script>!function(a){"use strict";var b=function(b,c,d){function e(a){return h.body?a():void setTimeout(function(){e(a)})}function f(){i.addEventListener&&i.removeEventListener("load",f),i.media=d||"all"}var g,h=a.document,i=h.createElement("link");if(c)g=c;else{var j=(h.body||h.getElementsByTagName("head")[0]).childNodes;g=j[j.length-1]}var k=h.styleSheets;i.rel="stylesheet",i.href=b,i.media="only x",e(function(){g.parentNode.insertBefore(i,c?g:g.nextSibling)});var l=function(a){for(var b=i.href,c=k.length;c--;)if(k[c].href===b)return a();setTimeout(function(){l(a)})};return i.addEventListener&&i.addEventListener("load",f),i.onloadcssdefined=l,l(f),i};"undefined"!=typeof exports?exports.loadCSS=b:a.loadCSS=b}("undefined"!=typeof global?global:this);!function(a){if(a.loadCSS){var b=loadCSS.relpreload={};if(b.support=function(){try{return a.document.createElement("link").relList.supports("preload")}catch(b){return!1}},b.poly=function(){for(var b=a.document.getElementsByTagName("link"),c=0;c<b.length;c++){var d=b[c];"preload"===d.rel&&"style"===d.getAttribute("as")&&(a.loadCSS(d.href,d,d.getAttribute("media")),d.rel=null)}},!b.support()){b.poly();var c=a.setInterval(b.poly,300);a.addEventListener&&a.addEventListener("load",function(){b.poly(),a.clearInterval(c)}),a.attachEvent&&a.attachEvent("onload",function(){a.clearInterval(c)})}}}(this);</script></head><body><div class="container"><ol class="breadcrumb"><li><a href="../index.html" class="glyphicon glyphicon-home"></a></li><li><a href="f-65.html">NSIS Discussion</a></li><li class="active">Scheduling a tastk</li></ol><p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=280347">Scheduling a tastk</a></p><br><div class="post"><p class="post-meta"><span class="post-author text-primary">bulgin</span><br><span class="post-time small text-muted">30th October 2007 16:39 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>Scheduling a tastk</strong><br>I've read the post regarding scheduling a task found here:<br><br><br>http://forums.winamp.com/showthread.php?threadid=147686&amp;highlight=Task<br><br>I am a little new to .dlls and such and have a few questions regarding this script. If I post here could someone possibly offer assistance. I've tried using the AT command which works if the user has permissions to do that, but in many cases the user cannot use the AT command to schedule events so the thread referencing the system dlls and such piqued my interest but I'm a little fuzzy on how to use it. The attached script in the above reference thread URL returns an error when I run it (it compiles, but returns an error when I execute the executable).<br><br>Thanks</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">kichik</span><br><span class="post-time small text-muted">30th October 2007 18:58 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">The complete example is available at:<br><br><a href="http://nsis.sourceforge.net/Scheduled_Tasks" target="_blank">http://nsis.sourceforge.net/Scheduled_Tasks</a><br><br>If you're unable to make it work, attach what you've got so far, explain what you've tried and how it fails and someone will surely be able to help you.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">bulgin</span><br><span class="post-time small text-muted">30th October 2007 23:30 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Okay, I figured out how to change the times, etc. My only question now is what would one do to make this a silent operation without the MB. Can you simply delete<br><br>MessageBox MB_OK "Backup job Scheduled task creation result: $0"<br><br>and put silentinstall at the top of the script?<br><br>Thanks</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">bulgin</span><br><span class="post-time small text-muted">31st October 2007 02:33 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Actually, now I'm confused. I can get the task to be scheduled, but not run. I believe I'm having difficulty understanding the following section. The program I want to execute resides in $TEMP and it is called backup.exe.... so what would the parameters be to run that? I've changed them as follows but although the task gets scheduled, it doesn't run. backup.exe does not need any additional parameters to run. I have set this to run silently.<br><br>Section "SiteSecureBackup"<br>SetOutPath $TEMP<br>push "My Task"<br>push "My Task Comment"<br>push "c:\$TEMP\My Task backup.exe"<br>push "c:\$TEMP:"<br>push "My Program Args"<br>push \<br>"*(&amp;l2, &amp;i2 0, \<br>&amp;i2 2006, &amp;i2 1, &amp;i2 1, \<br>&amp;i2 0, &amp;i2 0, &amp;i2 0, \<br>&amp;i2 0, &amp;i2 0, \<br>i 0, i 0, \<br>i 0, \<br>i 1, \<br>&amp;i2 1, &amp;i2 00, &amp;i2 0, i 0, &amp;i2 0) i.s"<br>Call CreateTask<br>Pop $0<br>result: $0"<br>SectionEnd</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">demiller9</span><br><span class="post-time small text-muted">31st October 2007 04:49 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">You've scheduled it to run on Jan 1, 2006. I think you've missed that date already.<br><br>$TEMP already has a drive letter. Don't put another drive letter in front of it.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">bulgin</span><br><span class="post-time small text-muted">31st October 2007 05:10 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Yes, I noticed that mistake and corrected both the drive letter and date shortly after posting, however, with the new settings I still receive an error. The schtasks command shows a task is scheduled but it fails to run. I am entering the correct credentials for the user and password. I am still confused over some of the values for the settings, i.e., : What is supposed to be put into the area where the original coder has placed "My Program Args"? Can this only run with the credentials of the logged in user? It compiles without a problem, shows that a task is scheduled, but fails to run. I have the "program_to_run.exe" in the Temp directory. I'm perplexed. Any assistance would be greatly appreciated.<br><br>Section "SiteSecureBackup"<br>SetOutPath $TEMP<br>push "MyTask"<br>push "My Task Comment"<br>push "C:\Documents and Settings\user\Local<br>Settings\Temp\MyTask program_to_run.exe"<br>push "C:\Documents and Settings\user\Local<br>Settings\Temp"<br>push "My Program Args"<br>push "*(&amp;l2, &amp;i2 0, &amp;i2 2007, &amp;i2 9, &amp;i2 2, &amp;i2 0,<br>&amp;i2 0, &amp;i2 0, &amp;i2 23, &amp;i2 45, i 0, i 0, i 0, i 1, &amp;i2<br>1, &amp;i2 0x2, &amp;i2 0, i 0, &amp;i2 0) i.s"<br>push "Username"<br>push "Userpassword"<br>Call CreateTask<br>Pop $0<br>MessageBox MB_OK "Backup job Scheduled task creation<br>result: $0"<br>SectionEnd<br><br>; eof<br>SectionEnd</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">demiller9</span><br><span class="post-time small text-muted">31st October 2007 06:29 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">"My Program Args" is a string that you use for any command line switches you need, or "" if you don't need any.<br><br>Your latest code sample shows the schedule is for Sep 2, 2007. Is that what you wanted to schedule?<br><br>Is your program called "program_to_run.exe" (what you said you want to run) or "MyTask program_to_run.exe" (as you have in the code sample)?<br><br>Don</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">bulgin</span><br><span class="post-time small text-muted">31st October 2007 16:38 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Okay, thank you for your help and clarifying those settings. I can now get it to run using the credentials of the logged in user. But if I replace those credentials with "", it fails to run. Is that how it's supposed to be? Must it always run with the credentials of the logged in user?<br><br>Thank you</p></div><hr><div class="footer"><p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p></div></div><script src="../js/highlight.pack.js" type="text/javascript"></script><script type="text/javascript">//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]></script></body></html>