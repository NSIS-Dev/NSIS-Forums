<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="description" content="Get File path and use as variable"><title>Get File path and use as variable - NSIS Forums</title><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script><link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css"><link rel="stylesheet" href="../css/style.css" type="text/css"></head><body><div class="container"><ol class="breadcrumb"><li><a href="../index.html" class="glyphicon glyphicon-home"></a></li><li><a href="f-65.html">NSIS Discussion</a></li><li class="active">Get File path and use as variable</li></ol><p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=301697">Get File path and use as variable</a></p><br><div class="post"><p class="post-meta"><span class="post-author text-primary">eliteeservices</span><br><span class="post-time small text-muted">4th January 2009 22:04 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>Get File path and use as variable</strong><br>How is this possible:<br><br>find an installation of a program by searching for the filename (program could be installed in any folder:<br><br>$programfiles\abc1<br>$programfiles\abc2<br><br>Wherever it is installed, the file will exist. Then, set the path to where it is found, i.e. if it's in abc1 then copy entire directory structure from abc3 to abc1.<br><br>Is this possible / how is it?</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Joel</span><br><span class="post-time small text-muted">4th January 2009 22:13 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Try one of this:<br><a href="http://nsis.sourceforge.net/Search_for_a_File_or_Directory_" target="_blank">http://nsis.sourceforge.net/Search_f..._or_Directory_</a>(Alternative)<br><a href="http://nsis.sourceforge.net/Search_For_a_File" target="_blank">http://nsis.sourceforge.net/Search_For_a_File</a><br><a href="http://nsis.sourceforge.net/Locate_plugin" target="_blank">http://nsis.sourceforge.net/Locate_plugin</a><br><br>Just don't expect Windows keep track of every file you copy or install, without registering its path.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br><span class="post-time small text-muted">4th January 2009 23:52 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">You don't need to use any recursion for this. Just a simple loop will do:<br><br></p><pre>
<code>StrCpy $INSTDIR ``<br>ClearErrors<br>FindFirst $R0 $R1 $PROGRAMFILES\*.*<br>${DoUnless} ${Errors}<br>  ${If} $R1 != .<br>  ${AndIf} $R1 != ..<br>  ${AndIf} ${FileExists} $PROGRAMFILES\$R1\*.* # is it a folder?<br>  ${AndIf} ${FileExists} $PROGRAMFILES\$R1\some_file.exe<br>    StrCpy $INSTDIR $PROGRAMFILES\$R1<br>    ${Break} # found install dir; break out of loop<br>  ${EndIf}<br>  ClearErrors<br>  FindNext $R0 $R1<br>${Loop}<br>FindClose $R0<br><br>${If} $INSTDIR == ``<br>  MessageBox MB_OK|MB_ICONINFORMATION `App not found blah!`<br>  Abort<br>${EndIf}</code>
</pre><br>
      <br>
      Stu
    </div>
    <hr>

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]></script></body></html>