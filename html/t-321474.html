<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="description" content="Custiomised Installer - please help"><title>Custiomised Installer - please help - NSIS Forums</title><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script><link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css"><link rel="stylesheet" href="../css/style.css" type="text/css"><!--[if lt IE 9]><script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script><script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script><![endif]--></head><body><div class="container"><ol class="breadcrumb"><li><a href="../index.html" class="glyphicon glyphicon-home"></a></li><li><a href="f-65.html">NSIS Discussion</a></li><li class="active">Custiomised Installer - please help</li></ol><p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=321474">Custiomised Installer - please help</a></p><br><div class="post"><p class="post-meta"><span class="post-author text-primary">captedgar</span><br><span class="post-time small text-muted">7th August 2010 15:33 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>Custiomised Installer - please help</strong><br>Hi<br>I'm new to NSIS Installer scripts. I have about 100 odd servers on which i have to manually uninstall the older version of a software and install a new one.<br>i have managed to write up the following code. Can u please guide me how i can achieve the steps underlined in red<br><br></p><pre>
<code>;Define Application name<br>name 'New Software Install'<br><br>;Define Installer name<br>outFile "\\&lt;Server 1&gt;\c$\Documents and Settings\VikasNarasimha\Desktop\Software-Install\Software-1.0.1.5-install.exe"<br><br><font color="red">set environmental path like in DOS command, the following is the path<br>set PATH=%SystemRoot%\Microsoft.NET\Framework\v2.0.50727;%PATH%</font><br><br><font color="red">Change Directory<br>cd "c:\PROGRAM FILES\Software-Install\Software1.0.1.4\"</font><br><br><font color="red">Unregister a .dll associated to the older version in the above directory<br>regasm /u /tlb Software4.dll</font><br><br>; Uninstall section <br>Section "Uninstall"<br>Delete $INSTDIR\Software-1.0.1.4-install.exe ; should delete older version<br>RMDir $INSTDIR<br>SectionEnd <br><br>; Install section <br>Section "Install"<br>InstallDir "\\&lt;Server 2&gt;\c$\PROGRAM FILES\Software-Install\Software1.0.1.5\"<br>setOutPath $INSTDIR<br>sectionEnd<br><br><font color="red">set environmental path like in DOS command, the following is the path<br>set PATH=%SystemRoot%\Microsoft.NET\Framework\v2.0.50727;%PATH%</font><br><br><font color="red">Change Directory<br>cd "c:\PROGRAM FILES\Software-Install\Software1.0.1.5\"</font><br><br><font color="red">Register a .dll associated to the newer version in the above directory<br>regasm /u /tlb Software5.dll</font></code>
</pre>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">MSG</span><br>
      <span class="post-time small text-muted">7th August 2010 21:23 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">You can use the nsExec plugin, or some other exec plugins, to execute regasm. I'm not familiar with regasm specifically, but I'd expect you don't really need to set the working directory. Just add the path before the filename.<br>
      <br>
      As for setting an environment variable, that's been asked before. You can find the solution using the Search function.</p>
    </div>
    <hr>

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]></script></body></html>