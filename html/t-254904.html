<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="Problem with a newly written plugin" />

  <title>Problem with a newly written plugin - NSIS Forums</title><!-- Bootstrap core CSS -->
  <link rel="stylesheet" type="text/css" href="//netdna.bootstrapcdn.com/bootswatch/3.0.1/readable/bootstrap.min.css" />
  <link rel="stylesheet" href="../css/style.css" type="text/css" /><!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!--[if lt IE 9]>
                <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
                <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->
</head>

<body>
  <div class="container">
    <!-- Put navigation bar here -->

    <ol class="breadcrumb">
      <li><a href="../index.html" class="glyphicon glyphicon-home"></a></li>

      <li><a href="f-65.html">NSIS Discussion</a></li>

      <li class="active">Problem with a newly written plugin</li>
    </ol>

    <p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=254904">Problem with a newly written plugin</a></p><br />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Wabiloo</span><br />
      <span class="post-time small text-muted">5th September 2006 21:44 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>Problem with a newly written plugin</strong><br />
      Hi!<br />
      <br />
      A friend of mine wrote a plugin to allow me to encode and encrypt passwords.<br />
      <br />
      The idea is that I need to MD5 hash a password and then convert it to hexadecimal or Base64 for storage in an XML file.<br />
      This plugin works great when I execute the installer on my own computer. However, on other (newly installed) computers, it just doesn't and returns the un-encrypted password.<br />
      <br />
      For the following code:<br /></p>
      <pre>
<code><br />Encoder::ToBase64 "Hello, world!"<br />Pop $1<br />DetailPrint "Base64 encode: $\"$1$\""<br /><br />Encoder::FromBase64 $1<br />Pop $2<br />DetailPrint "Base64 decode: $\"$2$\""<br /><br />Encoder::ToHex "Hello, world!"<br />Pop $3<br />DetailPrint "Hex encode: $\"$3$\""<br /><br />Encoder::FromHex $3<br />Pop $4<br />DetailPrint "Hex decode: $\"$4$\""<br /><br />Encoder::MD5Hash "Hello, world!"<br />Pop $5<br />DetailPrint "MD5: $\"$5$\""<br /></code>
</pre><br />
      <br />
      The expected output is:<br />
      <pre>
<code><br />Base64 encode: "SGVsbG8sIHdvcmxkIQ=="<br />Base64 decode: "Hello, world!"<br />Hex encode: "48656c6c6f2c20776f726c6421"<br />Hex decode: "Hello, world!"<br />MD5: "lÃ“UmÃ« Â¥KÃŠ L9GËœ9"<br /></code>
</pre><br />
      <br />
      but instead I get:<br />
      <pre>
<code><br />C:\DOCUME~1\TestUser\LOCALS~1\Temp\nsq2F.tmp\Encoder.dll<br />C:\DOCUME~1\TestUser\LOCALS~1\Temp\nsq2F.tmp\Encoder.dll<br />C:\DOCUME~1\TestUser\LOCALS~1\Temp\nsq2F.tmp\Encoder.dll<br />Base64 encode: "Hello, world!"<br />C:\DOCUME~1\TestUser\LOCALS~1\Temp\nsq2F.tmp\Encoder.dll<br />Base64 decode: "Hello, world!"<br />C:\DOCUME~1\TestUser\LOCALS~1\Temp\nsq2F.tmp\Encoder.dll<br />Hex encode: "Hello, world!"<br />C:\DOCUME~1\TestUser\LOCALS~1\Temp\nsq2F.tmp\Encoder.dll<br />Hex decode: "Hello, world!"<br />C:\DOCUME~1\TestUser\LOCALS~1\Temp\nsq2F.tmp\Encoder.dll<br />MD5: "Hello, world!"<br /></code>
</pre><br />
      <br />
      So clearly something doesn't quite work. Already, I can't quite figure out why I get so many paths repeated over and over again<br />
      Unfortunately, my friend is not available anymore to help and I'm not versed into the dark arts of C++ and plugin writing.<br />
      <br />
      I would be eternally grateful if someone could have a look at it and see what's going wrong.<br />
      As soon as something is stable and working, I'll add it to the Wiki.<br />
      <br />
      I attach the sources and compiled plugin.<br />
      (BTW, my friend commented that "the included exdll.h is not the same on from the Nullsoft SDK, it has a couple of my own signatures in so make sure you reference the right<br />
      one if you do a build!")
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">JasonFriday13</span><br />
      <span class="post-time small text-muted">6th September 2006 01:59 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">From a quick look, this line in exdll:<br /></p>
      <pre>
<code>#define NSISPlugin(name)        void __declspec(dllexport)<br /></code>
</pre>should be:<br />
      <pre>
<code>#define NSISPlugin(name)        extern "C" void __declspec(dllexport)</code>
</pre>because the source is a .cpp file. It appears it dosen't make a difference to the plugin at the moment. I will spend the next hour or so looking though the code for you.
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">JasonFriday13</span><br />
      <span class="post-time small text-muted">6th September 2006 03:23 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">The base64 routines would not compile on my machine, so I commented out the references to it to compile it.<br />
      <br />
      I have attached a test NSIS .exe showing the hex and MD5 conversion. The next step is to find a base 64 converter on the internet.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">JasonFriday13</span><br />
      <span class="post-time small text-muted">6th September 2006 04:35 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">I though I might as well add the modified code that made the example above possible.<br />
      <br />
      Note: make that change to exdll that I noted above.</p>
    </div>
    <hr />

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]>
  </script>
</body>
</html>
