<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="Defining Section Order at Runtime." />

  <title>Defining Section Order at Runtime. - NSIS Forums</title>
  <script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script>
  <!-- Bootstrap core CSS -->

  <link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css" />
  <link rel="stylesheet" href="../css/style.css" type="text/css" /><!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!--[if lt IE 9]>
                <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
                <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->
</head>

<body>
  <div class="container">
    <!-- Put navigation bar here -->

    <ol class="breadcrumb">
      <li><a href="../index.html" class="glyphicon glyphicon-home"></a></li>

      <li><a href="f-65.html">NSIS Discussion</a></li>

      <li class="active">Defining Section Order at Runtime.</li>
    </ol>

    <p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=293244">Defining Section Order at Runtime.</a></p><br />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Sheik</span><br />
      <span class="post-time small text-muted">17th June 2008 15:23 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>Defining Section Order at Runtime.</strong><br />
      Hi all,<br />
      <br />
      This issue has been a nagging one for me, for awhile.<br />
      <br />
      I wonder if anyone else has found a solution to it, or perhaps a workaround?<br />
      <br />
      Lets say I have an Installer that has 6-8 sections.<br />
      <br />
      I want to define an order to said sections at runtime, based on what sections they select to be installed.<br />
      <br />
      So perhaps if they select "all", then I have one set of orders, but if they only select 4 of 8, then I want to have a different order of Install...<br />
      <br />
      Is there any way to do this?<br />
      Can I define an order of how the sections run/get installed during runtime?</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Red Wine</span><br />
      <span class="post-time small text-muted">17th June 2008 16:01 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Unselected sections won't get executed, where exactly is the issue that you're referring?</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Sheik</span><br />
      <span class="post-time small text-muted">17th June 2008 16:45 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Hi Red Wine,<br />
      <br />
      I need the section order changed, based on what sections they decide to install.<br />
      <br />
      For instance, lets say I have 4 sections:<br />
      <br />
      The default order:<br />
      1) Install sub1<br />
      2) Install main.<br />
      3) Install sub2<br />
      4) Install sub3<br />
      <br />
      HOWEVER, lets say that I want this order to ONLY install this way if they select all the sections to install.<br />
      But lets say I want this order to change, if they DON'T select sub2 to install.<br />
      In that case, I want this order to be changed to say:<br />
      <br />
      1) Install main<br />
      2) Install sub3<br />
      3) Install sub1<br />
      <br />
      This is a simplified case, I actually have 8-9 sections, all of which have certain orders they need to be installed, based on which other sections they have select/not selected...<br />
      <br />
      I need a way to define the order at runtime, in which these sections are run/installed...<br />
      <br />
      Scott</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Red Wine</span><br />
      <span class="post-time small text-muted">17th June 2008 17:40 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">I guess you should add a different order of the sections (with different section id's of course) and associate each order with a certain install type.<br />
      Makensis won't compile twice same files so the size of the installer would remain the same but you have to write a lot of complicated code.<br />
      I guess it should work as you expect though I haven't try it my self.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Comperio</span><br />
      <span class="post-time small text-muted">18th June 2008 05:06 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Or another idea:<br />
      Make all your current sections just an empty "shell" and install everything from one hidden section. Have the hidden section execute things in an order based on the section flags of the other sections. (use sections.nsh and logiclib.nsh to make coding easier.)<br />
      <br />
      It might take you a bit to come up with the correct logic, but once you had it down, it might be easier to manage.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Sheik</span><br />
      <span class="post-time small text-muted">18th June 2008 06:20 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Hi all,<br />
      <br />
      Yeah, Comperio, that is currently the way I was doing it... But I was really hoping to be in the "spirit" of sections, and actually install/uninstall files in their respective section namespace...<br />
      <br />
      I am actually writing a new patch for NSIS right now, that hopefully kichik will accept it.<br />
      <br />
      I am adding 2 new commands:<br />
      SectionSetOrder<br />
      SectionGetOrder<br />
      <br />
      It adds a new flag internally to the "section struct", that allows users to specify the order of installation for each section.<br />
      <br />
      By default, all sections are set to an order of 0, which means to use the regular "in order" way.<br />
      But if we come across a value for "order" that is non-zero, it will override the regular "in order" way, and will install/uninstall based on 1 -&gt; X, where X is a bigger number.<br />
      <br />
      The code itself is obviously very small, as I am just reusing a lot of existing code, mostly the SectionSetSize/SectionGetSize commands.<br />
      <br />
      I have most of the patch done, and will finish it up tomorrow, as well as submit it tomorrow as well...</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Sheik</span><br />
      <span class="post-time small text-muted">18th June 2008 18:43 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Hi all,<br />
      <br />
      I have finished the patch, and submitted it to sourceforge here:<br />
      <a href="http://sourceforge.net/tracker/index.php?func=detail&amp;aid=1997092&amp;group_id=22049&amp;atid=373087" target="_blank">http://sourceforge.net/tracker/index...49&amp;atid=373087</a><br />
      <br />
      Add 2 new commands to allow defining Section Order at Runtime.<br />
      <br />
      This patch allows us to define, at runtime, the order in which sections<br />
      will be installed.<br />
      <br />
      I have added 2 new commands, called:<br />
      SectionSetOrder<br />
      SectionGetOrder<br />
      <br />
      I have added a new int variable in the struct section, called "order".<br />
      By default, "order" for each section is set to 0, indicating no ordering<br />
      preference.<br />
      <br />
      The SectionSetOrder command allows users to set the new order so you can<br />
      run section installs in a different order.<br />
      <br />
      Most of this patch just uses the "SectionSetSize/SectionGetSize" code as<br />
      its guide.<br />
      <br />
      I wrote this patch, specifically because I have a situation where I have 8<br />
      or 9 sections, and depending upon which sections are enabled/disabled, I<br />
      need to change the order of the way I install each section.<br />
      <br />
      My topic on the NSIS Forum is here:<br />
      <a href="http://forums.winamp.com/showthread.php?s=&amp;threadid=293244" target="_blank">http://forums.winamp.com/showthread....hreadid=293244</a><br />
      <br />
      Below is the copy/paste of the patch.<br />
      If you accept this patch, and would like a .patch file instead, let me<br />
      know.<br />
      <br />
      Please consider adding this patch, thank you!</p>
    </div>
    <hr />

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]>
  </script>
</body>
</html>
