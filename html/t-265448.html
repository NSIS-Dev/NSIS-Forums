<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="delete setup.exe as last action?" />

  <title>delete setup.exe as last action? - NSIS Forums</title><!-- Bootstrap core CSS -->
  <link rel="stylesheet" type="text/css" href="//netdna.bootstrapcdn.com/bootswatch/3.0.1/readable/bootstrap.min.css" />
  <link rel="stylesheet" href="../css/style.css" type="text/css" /><!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!--[if lt IE 9]>
                <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
                <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->
</head>

<body>
  <div class="container">
    <!-- Put navigation bar here -->

    <ol class="breadcrumb">
      <li><a href="../index.html" class="glyphicon glyphicon-home"></a></li>

      <li><a href="f-65.html">NSIS Discussion</a></li>

      <li class="active">delete setup.exe as last action?</li>
    </ol>

    <p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=265448">delete setup.exe as last action?</a></p><br />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">xirisone</span><br />
      <span class="post-time small text-muted">9th February 2007 09:11 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>delete setup.exe as last action?</strong><br />
      Hi,<br />
      <br />
      I need to delete my NSIS 'setup.exe' as last step of the setup itself. I can not use a BAT-file which calls setup.exe first and then deletes the file.<br />
      <br />
      Can a NSIS setup delete it's own setup.exe as last action?<br />
      <br />
      TIA,<br />
      xirisone</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Takhir</span><br />
      <span class="post-time small text-muted">9th February 2007 09:16 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><a href="http://forums.winamp.com/showthread.php?s=&amp;threadid=236058&amp;highlight=selfdel" target="_blank">http://forums.winamp.com/showthread....hlight=selfdel</a></p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">xirisone</span><br />
      <span class="post-time small text-muted">9th February 2007 10:11 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">do I have to replace 'SelfDel' with the name of my MySetup.exe in your example.nsi?<br />
      <br />
      !define APP_NAME SelfDel # old<br />
      !define APP_NAME MySetup # new<br />
      <br />
      TIA,<br />
      xirisone (newbie)</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">xirisone</span><br />
      <span class="post-time small text-muted">9th February 2007 11:00 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">@Takhir<br />
      got you dll working - nearly....<br />
      Problem: link and folder 'unsd' are not deleted.<br />
      My script attached. Did I include the code from your example.nsi wrongly?<br />
      <br />
      TIA,<br />
      xirisone</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Takhir</span><br />
      <span class="post-time small text-muted">9th February 2007 11:14 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Included sample removes uninstaller, if you want to remove setup.exe use following code</p>
      <pre>
<code><br />Function .onGUIEnd<br />  SelfDel::del<br />FunctionEnd</code>
</pre>but please note that in the silent mode this may not work (no function call in NSIS). The same line at the end of last mandatory section should work always, but cursor on the finish page will be with 'waiting'.
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">xirisone</span><br />
      <span class="post-time small text-muted">9th February 2007 12:03 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">@Takhir<br />
      removing the setup.exe works fine with you example, the link and the folder 'unsd' are not deleted. Could you check my test.nsi? That would be VERY nice.<br />
      TIA,<br />
      xirisone</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Takhir</span><br />
      <span class="post-time small text-muted">9th February 2007 12:23 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">I guess you don't need to create links at all. The sample included to SelfDel.zip describes the most complex situation - uninstaller deletion inplace. To simulate uninstall it creates subdir, writes uninstaller and creates link (simulating start menu). You don't need this, just add <b>the only</b> line from my post above after # prepare automatic delete of Installer....<br />
      BTW I re-tested included to zip sample and it worked as requested.<br />
      Uninstaller auto deletes itself, this not require a plug-in.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">xirisone</span><br />
      <span class="post-time small text-muted">9th February 2007 13:00 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">@Takhir<br />
      You're right!!!! Just using:<br />
      <br />
      Function .onGUIEnd<br />
      SelfDel::del<br />
      FunctionEnd<br />
      <br />
      does the job.<br />
      Thank you VERY much!<br />
      <br />
      xirisone</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Red Wine</span><br />
      <span class="post-time small text-muted">9th February 2007 21:19 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"></p>

      <blockquote>
        <i>Originally posted by xirisone</i><br />
        <b>@Takhir<br />
        You're right!!!! Just using:<br />
        <br />
        Function .onGUIEnd<br />
        SelfDel::del<br />
        FunctionEnd<br />
        <br />
        does the job.<br />
        Thank you VERY much!<br />
        <br />
        xirisone</b>
      </blockquote>What about if users for some reason decided to install the application later and click cancel e.g. on license page or components page or every included page?<br />
      It deletes the installer and nothing is installed.<br />
      Compile the following example and hit cancel on some page.<br />
      <br />
      Not the best behaviour if I've downloaded a large (e.g. 100 mb) installer on a slow internet connection and I have to download again and perhaps I'll get again the same strange result.<br />
      <br />
      Perhaps you should add a messagebox informing users not to click cancel otherwise they have to re-download the installer.<br />
      <pre>
<code>!define APP_NAME SelfDel<br /><br />Name "${APP_NAME}"<br />OutFile "${APP_NAME}.exe"<br />InstallDir "$PROGRAMFILES\${APP_NAME}"<br /><br />Page Components<br />Page Directory<br />Page InstFiles<br /><br />Section "Dummy Section" <br /><br />    SetOutPath "$INSTDIR"<br /><br />SectionEnd<br /><br /><br />Function .onGUIEnd<br /><br />    SelfDel::del<br /><br />FunctionEnd</code>
</pre>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Takhir</span><br />
      <span class="post-time small text-muted">10th February 2007 09:24 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Just to keep xirisone informed: <a href="http://nsis.sourceforge.net/SelfDel_plug-in" target="_blank">SelfDel plug-in page</a></p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Red Wine</span><br />
      <span class="post-time small text-muted">10th February 2007 10:42 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">@ Takhir,<br />
      probably you need to update the above provided link, currently it is a link to page that doesn't exist.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Takhir</span><br />
      <span class="post-time small text-muted">10th February 2007 10:48 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Thanks, Red Wine. Updated.</p>
    </div>
    <hr />

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]>
  </script>
</body>
</html>
