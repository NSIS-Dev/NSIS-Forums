<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="description" content="IMPORTANT: Bug with CopyFiles in latest CVS"><title>IMPORTANT: Bug with CopyFiles in latest CVS - NSIS Forums</title><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script><link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css"><link rel="stylesheet" href="../css/style.css" type="text/css"></head><body><div class="container"><ol class="breadcrumb"><li><a href="../index.html" class="glyphicon glyphicon-home"></a></li><li><a href="f-65.html">NSIS Discussion</a></li><li class="active">IMPORTANT: Bug with CopyFiles in latest CVS</li></ol><p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=131964">IMPORTANT: Bug with CopyFiles in latest CVS</a></p><br><div class="post"><p class="post-meta"><span class="post-author text-primary">psyke</span><br><span class="post-time small text-muted">16th April 2003 18:18 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>IMPORTANT: Bug with CopyFiles in latest CVS</strong><br>Hello, I am quite confident that I have found <i>some</i> kind of problem with CopyFiles in the latest development snapshot.<br><br>The bug can be experienced with Examples\bigtest.nsi. Essentially the installer crashes when it hits the CopyFiles instruction on line 192.<br><br>To reproduce bug:<br>1. get latest NSIS version from sourceforge<br>2. compile ${NSISDIR}\Examples\bigtest.ini<br>3. run bigtest.exe (you can disable all sections except for 'Test CopyFiles' since that's what we're interested in ;))<br>4. CRASH!!<br><br>This is happening on XP Pro no service packs.<br><br>To verify that it is the CopyFiles instruction, I commented out line 192 and went through steps 2 - 4. No crash.<br><br>I hope this can be resolved without too much difficulty, I don't have a copy of the April 14th snapshot handy so I can't go ahead with my installer unless CopyFiles works. ;)<br><br>Oh, I'm attaching a screenshot that is in chronological order from top to bottom showing exactly what happens.<br><br>Cheers. :)<br><br>Salaam/Peace</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">kichik</span><br><span class="post-time small text-muted">16th April 2003 19:51 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">I have uploaded a recompiled version of makensis.exe. It solves the problem. Last time we got rid of this problem by simply updating the Platform SDK, and as far as I know Joost (who uploaded the last makensis.exe) has the latest Platform SDK. If he really did have it then I intend to go a little deeper this time and find out the cause for this beyond the Platform SDK.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">psyke</span><br><span class="post-time small text-muted">16th April 2003 19:56 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Thanks Kichik. :)<br><br>I'll head over and grab that new makenisis then. Hope it was just a platform SDK issue so you don't have to spend any more time on this.<br><br>Salaam/Peace.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">kichik</span><br><span class="post-time small text-muted">16th April 2003 20:06 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">From a first glimpse over this it seems something with the import table is seriously defected with whatever is causing this. The numbers are off by a set number for every imported DLL. As I have focused more on the resource section of the PE format when I learned about it (for the full color icons, etc.) I don't yet fully understand the import table structure so I'll have to go learn some more :)</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">kichik</span><br><span class="post-time small text-muted">16th April 2003 20:45 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">He forgot to install the latest Platform SDK on his new computer. Phew! :D<br><br>From what I have read up until now I have discovered that the hint number that helps Windows search for the export was wrong for almost all of the imported functions. I don't understand why it disrupted SHFileOperation and nothing else, I guess we'll never know... A corporate secret or something like that :D</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">psyke</span><br><span class="post-time small text-muted">16th April 2003 21:13 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">lol - i guess so, they've got plenty of secrets. ;)<br><br>I'm glad it was just a matter of needing the latest PSDK. :)<br><br>Thanks for your help. :)<br><br>Salaam/Peace.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Sunjammer</span><br><span class="post-time small text-muted">17th April 2003 09:01 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">It may be that all of the other functions were being looked up by name and for some reason SHFileOperation was being looked up by ordinal which would from what you've said be wrong.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">kichik</span><br><span class="post-time small text-muted">17th April 2003 11:17 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Nope, it was looked by name too :weird:</p></div><hr><div class="footer"><p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p></div></div><script src="../js/highlight.pack.js" type="text/javascript"></script><script type="text/javascript">//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]></script></body></html>