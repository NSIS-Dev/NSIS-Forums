<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="How to run a program and wait till it finishes before an uninstall continues?" />

  <title>How to run a program and wait till it finishes before an uninstall continues? - NSIS Forums</title>
  <script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script>
  <!-- Bootstrap core CSS -->

  <link rel="stylesheet" type="text/css" href="//netdna.bootstrapcdn.com/bootswatch/3.0.1/readable/bootstrap.min.css" />
  <link rel="stylesheet" href="../css/style.css" type="text/css" /><!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!--[if lt IE 9]>
                <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
                <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->
</head>

<body>
  <div class="container">
    <!-- Put navigation bar here -->

    <ol class="breadcrumb">
      <li><a href="../index.html" class="glyphicon glyphicon-home"></a></li>

      <li><a href="f-65.html">NSIS Discussion</a></li>

      <li class="active">How to run a program and wait till it finishes before an uninstall continues?</li>
    </ol>

    <p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=139665">How to run a program and wait till it finishes before an uninstall continues?</a></p><br />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">vbgunz</span><br />
      <span class="post-time small text-muted">20th June 2003 20:57 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>How to run a program and wait till it finishes before an uninstall continues?</strong><br />
      I need to run a program before an uninstall completes. My application installs services onto the users system and an uninstall will not work as it can not delete any of the services in use.<br />
      <br />
      I have a batch file which shuts down all the services... I need to call it and have it finish *before* the uninstall continues...<br />
      <br />
      This should be possible I hope... Can someone please help me with this?<br />
      <br />
      Thank you for any information on this :)</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Joost Verburg</span><br />
      <span class="post-time small text-muted">20th June 2003 21:18 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Use ExecWait.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">vbgunz</span><br />
      <span class="post-time small text-muted">20th June 2003 22:32 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">I placed the Execwait command as the first command in the section "section uninstall". It seems to work like a charm. Wise?<br />
      <br />
      Thank you Joost for this information :)</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Brummelchen</span><br />
      <span class="post-time small text-muted">22nd June 2003 23:57 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">i would put execwait in the "Function un.onInit" - this is executed before all other uninstall stuff.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">vbgunz</span><br />
      <span class="post-time small text-muted">23rd June 2003 01:47 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Thank you Brummelchen,<br />
      <br />
      I previously had it at the top of the uninstall function call but it seems your method is just as good and will be my preferred method from now on. Thank you<br />
      <br />
      Now I just have to get these executables to launch in minimized mode or appear not at all...<br />
      <br />
      Thanks again :)</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">vbgunz</span><br />
      <span class="post-time small text-muted">23rd June 2003 02:08 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">I looked further into the nsExec function and I think it works without displaying the dos box... I really hope so and this NSIS is getting cooler by the moment. Thank you to everyone for your help :)</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Sunjammer</span><br />
      <span class="post-time small text-muted">23rd June 2003 08:51 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Yes that is the whole point of nsExec, plus it allows you to capture output into the stack or to the details window!</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Joost Verburg</span><br />
      <span class="post-time small text-muted">23rd June 2003 10:11 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Putting it in the section is better than using un.onInit, because:<br />
      <br />
      1) It won't be executed if the user quits the uninstaller before uninstalling<br />
      2) There is a dialog when the user has to wait</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Brummelchen</span><br />
      <span class="post-time small text-muted">23rd June 2003 10:39 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">@Joost<br />
      <br />
      In that (1) point you're right - but look yourself what i did<br />
      <br /></p>
      <pre>
<code>Function un.onInit<br />  MessageBox MB_ICONQUESTION|MB_YESNO|MB_DEFBUTTON2 "&lt;bla&gt; would you like to uninstall '${MUI_PRODUCT}' and all its components?" IDYES +2<br />  Abort<br />FunctionEnd</code>
</pre><br />
      <br />
      My first question in the uninstaller<br />
      <br />
      (2) he is using something like execwait - there is no option to display a messagebox while waiting?<br />
      I have problems to understand inserting sections while using the MUI or InsertOptions to get messages.
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Joost Verburg</span><br />
      <span class="post-time small text-muted">23rd June 2003 12:32 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Ok, but most people use a confirm page.<br />
      <br />
      If you put it in a section, you will see the normal installation window (with details, information etc.).</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">vbgunz</span><br />
      <span class="post-time small text-muted">23rd June 2003 19:45 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">So far I have ExecWait in the "un.onInit" function area below "Abort" and it seems to do its job pretty good. I've tested it with continuing ahead and in quitting the uninstall early by saying no.<br />
      <br />
      It seems to so far work without problems. Joost are you referring to the nsExec command in the "un.onInit function area"? That is the command I would like to use but I have no real idea on how to get it to run for an uninstallation.<br />
      <br />
      The nsExec will not run in either of the uninstall functions or section areas.<br />
      <br />
      So far ExecWait seems to do its job *but* it is unable to do it with parameters to minimize or hide dos boxes like nsExec does. Is their a solution or a way to call nsExec for an uninstallation?<br />
      <br />
      Thank you</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Joost Verburg</span><br />
      <span class="post-time small text-muted">24th June 2003 00:01 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">What is the problem? nsExec should work.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">vbgunz</span><br />
      <span class="post-time small text-muted">24th June 2003 00:21 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">This works using ExecWait in 2.0b3<br /></p>
      <pre>
<code>Function un.onInit<br />  MessageBox...<br />  Abort<br />  ExecWait "$INSTDIR\Core_Shut_Down.bat"<br />FunctionEnd</code>
</pre><br />
      And this Works in 2.0b3<br />
      <pre>
<code>Section Uninstall<br />  ExecWait "$INSTDIR\Core_Shut_Down.bat"<br />  ...</code>
</pre><br />
      <br />
      But neither of these work in regards to nsExec in 2.0b3<br />
      <pre>
<code>Function un.onInit<br />  MessageBox...<br />  Abort<br />  nsExec::Exec "$INSTDIR\Core_Shut_Down.bat"<br />FunctionEnd</code>
</pre><br />
      And neither does this work in 2.0b3<br />
      <pre>
<code>Section Uninstall<br />  nsExec::Exec "$INSTDIR\Core_Shut_Down.bat"<br />  ...</code>
</pre><br />
      <br />
      Currently nsExec works in a section only during install but how do I tell uninstall to execute a section before going through with the uninstall? I am considering anything that works in either minimizing or hiding the dos boxes all together... Preferably nsExec.<br />
      <br />
      Thank you Joost
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">vbgunz</span><br />
      <span class="post-time small text-muted">24th June 2003 01:28 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Ok I just successfully tweaked my script so to be fully compliant with the latest dev build of 2.0b4. I will get to work on this. Thank you Everyone!</p>
    </div>
    <hr />

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]>
  </script>
</body>
</html>
