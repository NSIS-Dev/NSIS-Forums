<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="description" content="Problems with CopyFiles"><title>Problems with CopyFiles - NSIS Forums</title><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script><link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css"><link rel="stylesheet" href="../css/style.css" type="text/css"><!--[if lt IE 9]><script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script><script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script><![endif]--></head><body><div class="container"><ol class="breadcrumb"><li><a href="../index.html" class="glyphicon glyphicon-home"></a></li><li><a href="f-65.html">NSIS Discussion</a></li><li class="active">Problems with CopyFiles</li></ol><p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=364363">Problems with CopyFiles</a></p><br><div class="post"><p class="post-meta"><span class="post-author text-primary">nc10</span><br><span class="post-time small text-muted">20th June 2013 15:48 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>Problems with CopyFiles</strong><br>Hi,<br><br>sorry i'm new in working with nsis.<br><br>I want to copy files using CopyFiles:<br><br>CopyFiles "$INSTDIR\$Save" "$INSTDIR\saved"<br><br>$Save is a relative path like logs\log.txt<br><br>The command obove does not work!!! But if the command is:<br>CopyFiles "$INSTDIR\logs\log.txt" "$INSTDIR\saved" it WORKS!<br><br>I can not understand why! Why can't i use a Variable in the source?<br><br>Thanks for helping!<br><br>NC10</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">MSG</span><br><span class="post-time small text-muted">21st June 2013 10:29 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">As far as I know CopyFiles is a normal runtime command so, unlike the File command, you should be able to use variables as parameters. If it's not working, most probably the value of the variable is wrong. Put this before the command to check:<br>MessageBox MB_OK "$INSTDIR\$Save"<br>It could also be that the $INSTDIR\saved doesn't exist yet, in which case it would copy it to a file called 'saved' inside $INSTDIR. First SetOutPath "$INSTDIR\saved" to create the directory.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">nc10</span><br><span class="post-time small text-muted">26th June 2013 15:11 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Thank you very much!<br>I think the command CopyFiles also can't handle Variables as Parameters. If i use !define it works.<br><br>So far: I have another Problem.<br>I want to read out filenames (relative pathes) out of a file with FileRead,<br>like: FileRead $0 $Save (in a Loop)<br>So $Save contains the first line of a file and in my case it contains a relative path,<br>for example "logging.log".<br>If i compare $Save with "logging.log", it does not match.<br>Means: ${If} $Save == "logging.log" MessageBox "JA" ${EndIf} does not work!!!<br>Although DetailPrint $Save prints "logging.log"<br>I cannot understand why! I really need help! Maybe there is any Encoding Problem? What can i do?<br><br>Thank you for help!</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">MSG</span><br><span class="post-time small text-muted">26th June 2013 15:19 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"></p><blockquote><small>Originally posted by nc10</small><br>${If} $Save == "logging.log" MessageBox "JA" ${EndIf} does not work!!!</blockquote>You've got the LogicLib formatting wrong. Also the MessageBox is incorrect.<br>${If} $Save == "logging.log"<br>MessageBox MB_OK "JA"<br>${EndIf}<br><br>But like I said, you can just use MessageBox MB_OK "$save"</div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">nc10</span><br><span class="post-time small text-muted">26th June 2013 15:47 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Hey thanks for answer:<br>But i cannot see any difference?!?!<br>my code:<br>${If} $Save == "logging.log"<br>MessageBox MB_OK "Ja!"<br>${EndIf}<br><br>(I only forgot to write MB_OK and the formatting in the post is wrong, in my code it is right)<br><br>What's wrong?</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">jpderuiter</span><br><span class="post-time small text-muted">26th June 2013 22:00 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Please note that the If statement is case sensitive.<br>Also check if there are leading or trailing spaces in $Save.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br><span class="post-time small text-muted">27th June 2013 14:58 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">The == and != operators are not case sensitive. S== and S!= are, however.<br><br>Stu</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">jpderuiter</span><br><span class="post-time small text-muted">27th June 2013 22:15 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Ah, sorry, you're right, I was too quick on checking the wiki page.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">nc10</span><br><span class="post-time small text-muted">1st July 2013 09:00 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"></p><blockquote>Also check if there are leading or trailing spaces in $Save.</blockquote>Thanks. Good Tip! Now i use a function which trims leading and trailing spaces. Now it works.<br>Now my Code:<br><br>FileOpen $0 "$INSTDIR\test_text.txt" r ; open and read line by line<br>Loop:<br>IfErrors Done<br>FileRead $0 $Line<br>;DetailPrint "$Line!"<br>${un.Trim} $withoutSpaces $Line<br>Goto Loop<br>Done:<br>FileClose $0<br><br>The code works, but one more problem: At the end of the file, my loop always reads (and print) an empty line. I don't know why. I thought the loop only works until either a newline (or carriage return newline pair) occurs, or until a null byte is read (see docu).<br>Any idea?<br>Thanks.</div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">jpderuiter</span><br><span class="post-time small text-muted">1st July 2013 11:20 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Maybe obvious, but are you sure there's not actually a newline at the end of your file?</p></div><hr><div class="footer"><p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p></div></div><script src="../js/highlight.pack.js" type="text/javascript"></script><script type="text/javascript">//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]></script></body></html>