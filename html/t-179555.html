<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="description" content="installer doesn't work on Windows 98"><title>installer doesn't work on Windows 98 - NSIS Forums</title><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script><link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css"><link rel="stylesheet" href="../css/style.css" type="text/css"></head><body><div class="container"><ol class="breadcrumb"><li><a href="../index.html" class="glyphicon glyphicon-home"></a></li><li><a href="f-65.html">NSIS Discussion</a></li><li class="active">installer doesn't work on Windows 98</li></ol><p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=179555">installer doesn't work on Windows 98</a></p><br><div class="post"><p class="post-meta"><span class="post-author text-primary">bramm</span><br><span class="post-time small text-muted">10th May 2004 20:50 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>installer doesn't work on Windows 98</strong><br>The installer for Vim 6.3a, generated with NSIS 2, works fine on Windows XP but several people reported it hangs on the license page when using Windows 98. That page then is blank, no text and no buttons to click on. Cursor turns into an hourglass.<br><br>I'm not sure if this is a bug or something I'm doing wrong. Currently I guess it's a bug, because it worked fine with NSIS 1.92.<br><br>You can find the file here: <a href="ftp://ftp.vim.org/pub/vim/unstable/pc/gvim63a.exe" target="_blank">ftp://ftp.vim.org/pub/vim/unstable/pc/gvim63a.exe</a><br>The installer script gvim.nsi can be found here: <a href="http://cvs.sourceforge.net/viewcvs.py/vim/vim/nsis" target="_blank">http://cvs.sourceforge.net/viewcvs.py/vim/vim/nsis</a><br><br>I'm using LZMA compression, could that be a reason?<br><br>I currently don't have a Windows 98 system, thus can't do debugging.<br>Suggestions are welcome!</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Joost Verburg</span><br><span class="post-time small text-muted">10th May 2004 21:53 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">I can reproduce this issue. It occurs once in a while on a Windows 98 installation.<br><br>I think your actions in .onInit may interfere with the interface. Try running the external application silently using the nsExec plug-in.<br><br>Your script also uses deprecated NSIS 1 commands. This is not related to this issue, but using page commands and the standard language files is recommended.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">bramm</span><br><span class="post-time small text-muted">11th May 2004 12:11 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"></p><blockquote><i>Originally posted by Joost Verburg</i><br><b>I can reproduce this issue. It occurs once in a while on a Windows 98 installation.</b></blockquote>I am glad you are able to reproduce the problem.<br><br><blockquote><b>I think your actions in .onInit may interfere with the interface. Try running the external application silently using the nsExec plug-in.</b></blockquote>I am afraid I cannot run this application silently. When a previous installation of Vim is detected the user will be prompted if it should be uninstalled.<br><br>Perhaps there is another way to run the application that works around the problem? Note that it worked just fine with NSIS 1.<br><br><blockquote><b>Your script also uses deprecated NSIS 1 commands. This is not related to this issue, but using page commands and the standard language files is recommended.</b></blockquote>I did convert the NSIS 1 script to NSIS 2, fixing what didn't work. What deprecated commands are still there? A pointer to the relevant documentation would be sufficient.</div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Joost Verburg</span><br><span class="post-time small text-muted">11th May 2004 12:34 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">NSIS 2 has a new page system. You only have to add page commands, there is no need to set texts like DirText etc. yourself.<br><br>I notice that the background gradient does not show when the license page is blank. The only interface-related command in .onInit is BringToFront, try whether that one makes any difference.<br><br>Also try with and without background gradient.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">bramm</span><br><span class="post-time small text-muted">11th May 2004 14:10 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">I finally decided to reboot into Windows 98 (have to bring down my Unix system, don't like that) and try it out myself. Unfortunately it works fine on my system. That means I cannot even try debugging it.<br><br>I have uploaded another installer, with the gradient and the BringToFront removed. Please give it a try: <a href="ftp://ftp.vim.org/pub/vim/unstable/pc/gvim63a1.exe" target="_blank">ftp://ftp.vim.org/pub/vim/unstable/pc/gvim63a1.exe</a></p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Joost Verburg</span><br><span class="post-time small text-muted">11th May 2004 14:27 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">This one seems to work fine, please ask the users who reported the problem to test it too.<br><br>Btw, why not integrate the uninstallation etc. in the NSIS installer?</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">bramm</span><br><span class="post-time small text-muted">11th May 2004 16:27 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"></p><blockquote><i>Originally posted by Joost Verburg</i><br><b>This one seems to work fine, please ask the users who reported the problem to test it too.</b></blockquote>I'm glad this works. Would you like me to make a version with only the background gradient removed, so that we know that causes the problem? Or do you already know that omitting BringToFront is not relevant? It should be reported as a bug anyway.<br><br><blockquote><b>Btw, why not integrate the uninstallation etc. in the NSIS installer?</b></blockquote>It is rather complicated and must also be available when not using NSIS. Thus duplicating this code or even re-implementing it in NSIS script is unattractive.</div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Joost Verburg</span><br><span class="post-time small text-muted">11th May 2004 16:47 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Please create four small installers without any files included (except those used in .onInit).<br><br>1) With all features<br>2) Without BringToFront<br>3) Without background gradient<br>4) Without both</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">bramm</span><br><span class="post-time small text-muted">11th May 2004 17:10 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">OK, you can find four executables here: <a href="ftp://ftp.vim.org/pub/vim/unstable/tryout" target="_blank">ftp://ftp.vim.org/pub/vim/unstable/tryout</a><br><br>The first "yes" or "no" is for BGGradient, the second for BringToFront.<br><br>Hopefully you can reproduce the problem with these mutilated installers!</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Joost Verburg</span><br><span class="post-time small text-muted">12th May 2004 10:14 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Only yes_yes seems to cause the problem.<br><br>The usage of BringToFront is no a good idea anyway in combination with a background gradient, because everything goes to the background.</p></div><hr><div class="footer"><p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p></div></div><script src="../js/highlight.pack.js" type="text/javascript"></script><script type="text/javascript">//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]></script></body></html>