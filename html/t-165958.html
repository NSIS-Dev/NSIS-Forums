<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="description" content="Need SetCurInstType Instruction Help"><title>Need SetCurInstType Instruction Help - NSIS Forums</title><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script><link rel="preload" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css" as="style" onload="this.rel='stylesheet'"><link rel="preload" href="../css/style.css" as="style" onload="this.rel='stylesheet'"><noscript><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css"><link rel="stylesheet" href="../css/style.css"></noscript><script>!function(a){"use strict";var b=function(b,c,d){function e(a){return h.body?a():void setTimeout(function(){e(a)})}function f(){i.addEventListener&&i.removeEventListener("load",f),i.media=d||"all"}var g,h=a.document,i=h.createElement("link");if(c)g=c;else{var j=(h.body||h.getElementsByTagName("head")[0]).childNodes;g=j[j.length-1]}var k=h.styleSheets;i.rel="stylesheet",i.href=b,i.media="only x",e(function(){g.parentNode.insertBefore(i,c?g:g.nextSibling)});var l=function(a){for(var b=i.href,c=k.length;c--;)if(k[c].href===b)return a();setTimeout(function(){l(a)})};return i.addEventListener&&i.addEventListener("load",f),i.onloadcssdefined=l,l(f),i};"undefined"!=typeof exports?exports.loadCSS=b:a.loadCSS=b}("undefined"!=typeof global?global:this);!function(a){if(a.loadCSS){var b=loadCSS.relpreload={};if(b.support=function(){try{return a.document.createElement("link").relList.supports("preload")}catch(b){return!1}},b.poly=function(){for(var b=a.document.getElementsByTagName("link"),c=0;c<b.length;c++){var d=b[c];"preload"===d.rel&&"style"===d.getAttribute("as")&&(a.loadCSS(d.href,d,d.getAttribute("media")),d.rel=null)}},!b.support()){b.poly();var c=a.setInterval(b.poly,300);a.addEventListener&&a.addEventListener("load",function(){b.poly(),a.clearInterval(c)}),a.attachEvent&&a.attachEvent("onload",function(){a.clearInterval(c)})}}}(this);</script></head><body><div class="container"><ol class="breadcrumb"><li><a href="../index.html" class="glyphicon glyphicon-home"></a></li><li><a href="f-65.html">NSIS Discussion</a></li><li class="active">Need SetCurInstType Instruction Help</li></ol><p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=165958">Need SetCurInstType Instruction Help</a></p><br><div class="post"><p class="post-meta"><span class="post-author text-primary">jnjosh1979</span><br><span class="post-time small text-muted">21st January 2004 16:53 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>Need SetCurInstType Instruction Help</strong><br>Hi.<br><br>I am having a problem with my SetCurInstType Instruction. It seems to be acting wierd. I am using NSIS2rc2 with the following code. I am trying to use 2 InstTypes and based on a variable which i set, install the correct section.<br><br>Heres the code:<br>;&lt;----at beginning of script-----&gt;<br>InstType "Software Version A"<br>InstType "Software Version B"<br><br>;&lt;----section area of script-------&gt;<br>Section "Program Files A"<br>SectionIn 1<br>;&lt;--blah code blah--&gt;<br>SectionEnd<br><br>Section "Program Files B"<br>SectionIn 2<br>;&lt;--blah code blah--&gt;<br>SectionEnd<br><br>;&lt;----in the .onInit function-------&gt;<br>;// installing to software 'A'<br>StrCmp ${SOFTVER} "A" 0 LookAgain<br>SetCurInstType 1<br>goto CleanExit<br><br>LookAgain:<br>;// installing to software 'B'<br>StrCmp ${SOFTVER} "B" 0 Error1<br>SetCurInstType 2<br>goto CleanExit<br><br>Error1:<br>MessageBox MB_OK "Hey, what are you doing! Go Home..."<br>CleanExit:<br>;&lt;-----------&gt;<br><br>I have found an entry in the forum saying that SetCurInstType is a zero-based instruction unlike SectionIn, but when I use 0 and 1 rather than 1 and 2, it does the same thing.<br><br>Please Help and Thanks in advance,<br>Josh</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Joost Verburg</span><br><span class="post-time small text-muted">21st January 2004 17:01 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Do you have a components page?<br><br>SetCurInstType only works with a components page, otherwise just put the checks in a section.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">stnchris</span><br><span class="post-time small text-muted">18th February 2004 19:43 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">somewhat releated...<br><br>If the installer has a components page, but is run in silent mode, the sections seem to ignore the value set by SetCurInstType. That is, GetCurInstType sees that the values have been set, but the Sections that are run are the ones for the zero-th install type.<br><br>See attached .nsi that demonstrates the problem. In .onInit, it pops up a message box asking which install type to use. If you say 'no', it should switch to the second install type.<br><br>In nonsilent mode, this works. In silent mode, the section for the first install type is run, even though GetCurInstType reports that the second install type has been set.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Joost Verburg</span><br><span class="post-time small text-muted">18th February 2004 22:38 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">This behavior is documented and is a limitation of the current implementation of this instruction.<br><br>A better implementation is already on the to-do list.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">OriginalSinner</span><br><span class="post-time small text-muted">21st January 2005 21:26 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>SetCurInstType in components page only</strong><br></p><blockquote><i>Originally posted by Joost Verburg</i><br><b>A better implementation is already on the to-do list.</b></blockquote>Has this made it to the top of the todo list yet :)<br><br>It would be useful to be able to Abort the Components page if the install type had already been set in the reg for example.<br><br>I know it could be scripted but this means adding something to each section and when you have 40 sub/sections it makes the script a bit ugly.<br><br>Just wondered if it was going to make it into a release anytime soon.<br><br>Cheers,<br>Phil</div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">kichik</span><br><span class="post-time small text-muted">21st January 2005 21:28 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">It has already been removed from the TODO list. SetCurInstType works without the components page on the latest CVS version.</p></div><hr><div class="footer"><p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p></div></div><script src="../js/highlight.pack.js" type="text/javascript"></script><script type="text/javascript">//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]></script></body></html>