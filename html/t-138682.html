<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="description" content="Uninstall Error"><title>Uninstall Error - NSIS Forums</title><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script><link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css"><link rel="stylesheet" href="../css/style.css" type="text/css"><!--[if lt IE 9]><script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script><script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script><![endif]--></head><body><div class="container"><ol class="breadcrumb"><li><a href="../index.html" class="glyphicon glyphicon-home"></a></li><li><a href="f-65.html">NSIS Discussion</a></li><li class="active">Uninstall Error</li></ol><p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=138682">Uninstall Error</a></p><br><div class="post"><p class="post-meta"><span class="post-author text-primary">Jermbox</span><br><span class="post-time small text-muted">11th June 2003 20:27 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>Uninstall Error</strong><br>I am getting this strange error when I try to start the uninstall exe. I get a popup that says "Error launching Installer". I pulled everything out of the uninstall section except the basics, and still get the same results. See code below:<br><br>; Write the uninstall keys for Windows<br>WriteRegStr HKLM "Software\Microsoft\Windows\CurrentVersion\Uninstall\RT Workstation" "DisplayName" "RT Workstation (remove only)"<br>WriteRegStr HKLM "Software\Microsoft\Windows\CurrentVersion\Uninstall\RT Workstation" "UninstallString" "$INSTDIR\Uninst.exe"<br>WriteUninstaller "$INSTDIR\Uninst.exe"<br>SectionEnd<br><br>Section "Shortcuts"<br>;Add Shortcuts<br>SectionEnd<br><br>UninstallText "This will uninstall RT Workstation from your system"<br>UninstallIcon "E:\Files\Projects\Install\isicon.ico"<br><br>Section Uninstall<br>;Delete Files<br><br>; Directories To Remove During Uninstall<br>RMDir /r "$INSTDIR\BIN"<br><br>; Delete Uninstaller And Unistall Registry Entries<br>Delete "$INSTDIR\Uninst.exe"<br><br>SectionEnd<br><br>I looked around in this forum but can't seem to find any info on this error. Anyone have any ideas?<br><br>Thanks in advance,<br><br>J</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Joel</span><br><span class="post-time small text-muted">11th June 2003 20:54 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">From where you are uninstalling, via:<br>Control panel (add/remove), start menu, or other shortcut?</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">ramon18</span><br><span class="post-time small text-muted">11th June 2003 21:29 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Can you upload you script (simplified)?</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Jermbox</span><br><span class="post-time small text-muted">11th June 2003 21:41 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>Script</strong><br>Here is the script... thinned out the install files list but the rest is normal.<br><br>To Lobo, I have tried it both from CP,start menu and the actual unistall file itself... no luck.<br><br>Thanks in advance,<br><br>J</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">ramon18</span><br><span class="post-time small text-muted">11th June 2003 21:44 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Your attach failed!?! maybe you should zip it out?</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Jermbox</span><br><span class="post-time small text-muted">11th June 2003 22:21 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>Try again</strong><br>Let try this again ...</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">ramon18</span><br><span class="post-time small text-muted">11th June 2003 22:29 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>Working fine</strong><br>Run for me like a charm!<br><br>Perhaps problems with your OS or something, have you tried executing "Uninst.exe" directly from explorer or from a MS-DOS prompt?<br><br><br>good luck<br>Ramon</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Jermbox</span><br><span class="post-time small text-muted">11th June 2003 22:43 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>Hmmm</strong><br>Thats strange ...<br><br>tried the exe on both my XP Pro box and on a 2000 box with the same results. Mind if I ask what version of NSIS you are using? I built the installer with nsis20b3. Not sure if that matters much.<br><br>Anyways, thanks for looking.<br><br>J</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">ramon18</span><br><span class="post-time small text-muted">11th June 2003 22:47 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Can you upload the Uninst.exe? (zipped)<br><br>I can try it on my box, this will tell if the problem is NSIS version,<br><br>btw: my version is current CVS developing version<br><br>cyas<br>Ramon</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">micolithe</span><br><span class="post-time small text-muted">11th June 2003 22:48 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">It looks like a registry error.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Jermbox</span><br><span class="post-time small text-muted">12th June 2003 14:18 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>uninst file</strong><br>Ramon - Here is the uninst.exe file generated during the install process.<br><br>J</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">kichik</span><br><span class="post-time small text-muted">12th June 2003 14:19 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">What is the content of the $TEMP variable on your computer? Does it exist? Are there any files named *~NSISu_.exe in your temporary directory? How many of them? If there are any files like that, what happens if you delete them? Does the uninstaller work again? Does it create a new one?</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">kichik</span><br><span class="post-time small text-muted">12th June 2003 14:20 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">What OS are you working on?</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Jermbox</span><br><span class="post-time small text-muted">12th June 2003 14:48 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>Answers</strong><br>?: What is the content of the $TEMP variable on your computer?<br><br>Temp=%USERPROFILE%\Local Settings\Temp<br><br>?: Does it exist?<br><br>Yes<br><br>?: Are there any files named *~NSISu_.exe in your temporary directory?<br><br>There is one file in dir, A~NSISu_.exe<br><br>?: If there are any files like that, what happens if you delete them? Does the uninstaller work again? Does it create a new one?<br><br>When I delete the A~NSISu_ file and run the uninstall exe again it gives same error and generates another A~NSISu_ file in the Temp dir.<br><br><br><br>This machine is running WinXP Pro SP-1 but also tried it on Win2K SP-3 with same results. The only thing simlar is they both have nsis20b3 installed.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">kichik</span><br><span class="post-time small text-muted">12th June 2003 14:53 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Does the value of $TEMP literally contains %USERPROFILE% or have you taken this from another place such as the registry.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Jermbox</span><br><span class="post-time small text-muted">12th June 2003 15:00 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">The value of the variable is actually %userprofile%\Local Settings\Temp , but when checked on the command line with a SET command it resolves itself to the actual dir path. When you had asked about that in your earlier post I thought maybe there might be some issue with the uninstaller being able to resolve the %userprofile% variable as the TEMP value. So, I created a dir C:\temp and adjusted the temp variable. Re-ran install and attempted uninstall with same results</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">kichik</span><br><span class="post-time small text-muted">12th June 2003 16:17 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Can you please run the attached installer (installs nothing, just uses NSIS scripting), copy the results (right click on the list) and attach it here as a text file?<br><br>I just want to be sure of some facts before we continue.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Jermbox</span><br><span class="post-time small text-muted">12th June 2003 16:22 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Looks like the attachment didn't stick, could you post it again please.<br><br>Thanks.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">kichik</span><br><span class="post-time small text-muted">12th June 2003 16:24 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Oops... Here it is.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Jermbox</span><br><span class="post-time small text-muted">12th June 2003 16:35 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>Results</strong><br>TEMP<br>C:\Temp<br>TEMP from HKCU\Environment<br>C:\Temp<br>TMP from HKCU\Environment<br>C:\Temp<br>TEMP from HKLM\...\Environment<br>%SystemRoot%\TEMP<br>TMP from HKLM\...\Environment<br>%SystemRoot%\TEMP<br>ReadEnvStr $0 TEMP<br>C:\Temp<br>ReadEnvStr $0 TMP<br>C:\Temp<br>ExpandEnvStrings $0 %TEMP%<br>C:\Temp<br>ExpandEnvStrings $0 %TMP%<br>C:\Temp<br>RegOpenKeyEx returned 0<br>RegQueryValueEx returned 0<br>TEMP is 1<br>RegQueryValueEx returned 0<br>TMP is 1<br>RegCloseKey returned 0<br>Completed</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">kichik</span><br><span class="post-time small text-muted">12th June 2003 16:47 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Well, I was actually more interseted in the old settings.<br><br>Is there any message box appearing before the "Can't launch installer" message box in the attached uninstaller?</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Jermbox</span><br><span class="post-time small text-muted">12th June 2003 17:14 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>Hmmm</strong><br>Ok .... this is going to sound strange but here is something interesting:<br><br>I downloaded the uninst file you posted, un-zipped to the desktop and it ran without error. I then took my uninst file from the root of C:\ and brought it to the desktop and it ran fine. Copied it back to the root, ran it and got the original error. I then copied your uninst file to C:\ and also got the error. Not really sure what this means.<br>Ideas?<br><br>J<br><br>:attached error message</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">kichik</span><br><span class="post-time small text-muted">12th June 2003 17:23 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Ooh! Now I see what's the thing is. It's not a bug, it's a feature :)<br><br>NSIS doesn't consider the root directory of drives to be a valid installation directory unless forced to (using AllowRootDirInstall).<br><br>The error might be vague but just imagine what would have happened if you'd a RMDir /r Windows in your uninstall script...</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Jermbox</span><br><span class="post-time small text-muted">12th June 2003 17:45 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Wow... what a long road we traveled to get to this point. :)<br><br>Kichik / Ramon18, Thanks alot for your help getting this figured out.<br>I appreciate your time and effort.<br><br>J.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">DrPeggs</span><br><span class="post-time small text-muted">29th November 2007 08:44 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">I realise this is an ancient thread but i had the same issue today when a user installed to c:\ and then couldnt uninstall<br><br>I understand the reason for having the AllowRootDirInstall flag but my question is - why on earth let people install to root if they cant uninstall? i.e. shouldnt AllowRootDirInstall (or rather the lack of) apply to the install process as well as the uninstall?<br><br>or am i being dim?</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">kichik</span><br><span class="post-time small text-muted">29th November 2007 17:24 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">The following simple script works perfectly fine for me and it shows AllowRootDirInstall affects both the installer and the uninstaller. Are you sure you're using the greatest and latest and that your script uses AllowRootDirInstall?</p><pre>
<code>Name test<br>OutFile test.exe<br><br>AllowRootDirInstall true<br><br>Section<br>WriteUninstaller C:\uninst.exe<br>Exec "C:\uninst.exe"<br>SectionEnd<br><br>Section uninstall<br>SectionEnd</code>
</pre>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">DrPeggs</span><br>
      <span class="post-time small text-muted">4th December 2007 09:21 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">hi<br>
      i am running version 2.30 which i realise isn't the latest and the string AllowRootDirInstall does not appear anywhere in my script, which is why i was surprised it allowed installation to C:\ if it didnt allow uninstallation.<br>
      Anyway, i now see how it is meant to be used so can get round the problem if necessary</p>
    </div>
    <hr>

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]></script></body></html>