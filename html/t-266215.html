<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="Upx &amp; Nsis" />

  <title>Upx &amp; Nsis - NSIS Forums</title>
  <script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script>
  <!-- Bootstrap core CSS -->

  <link rel="stylesheet" type="text/css" href="//netdna.bootstrapcdn.com/bootswatch/3.0.1/readable/bootstrap.min.css" />
  <link rel="stylesheet" href="../css/style.css" type="text/css" /><!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!--[if lt IE 9]>
                <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
                <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->
</head>

<body>
  <div class="container">
    <!-- Put navigation bar here -->

    <ol class="breadcrumb">
      <li><a href="../index.html" class="glyphicon glyphicon-home"></a></li>

      <li><a href="f-65.html">NSIS Discussion</a></li>

      <li class="active">Upx &amp; Nsis</li>
    </ol>

    <p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=266215">Upx &amp; Nsis</a></p><br />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">amckern</span><br />
      <span class="post-time small text-muted">20th February 2007 13:38 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>Upx &amp; Nsis</strong><br />
      Hey!<br />
      <br />
      I was just messing around with UPX 2.03 (<a href="http://upx.sourceforge.net/" target="_blank">http://upx.sourceforge.net/</a> OR <a href="http://en.wikipedia.org/wiki/UPX" target="_blank">http://en.wikipedia.org/wiki/UPX</a>) and found I can compress almost 20KB out of some of Null soft installers, while I can dump 30kb-190kb out of my own.<br />
      <br />
      Now, I know this is a complex question but:<br />
      <br />
      Am I destroying the content of these installers? (I am making back ups before I UPX them)<br />
      <br />
      Is it only the NSIS scripting language that is getting compressed inside the installers, or has UPX found the actual program that the installer is meant to install, and is compacting it as well?<br />
      <br />
      Examples<br />
      <br />
      nsis-2.24-setup.exe<br />
      <br />
      1480945 bytes to 1467121 bytes (99.07%) = 13824 bytes / 13.5 KB smaller<br />
      <br />
      <b>Original File<br />
      <a href="http://i19.tinypic.com/402t2pz.png" target="_blank">http://i19.tinypic.com/402t2pz.png</a><br />
      <br />
      UPX File<br />
      <a href="http://i5.tinypic.com/4btncsp.png" target="_blank">http://i5.tinypic.com/4btncsp.png</a><br />
      <br />
      Stats</b><br />
      <a href="http://i13.tinypic.com/3zq5v29.png" target="_blank">http://i13.tinypic.com/3zq5v29.png</a><br />
      <br />
      Setup_Prime_TCS.exe<br />
      <br />
      382761948 bytes to 382749148 bytes = 12800 Bytes / 12.5 KB smaller<br />
      <br />
      <b>Script<br />
      <a href="http://developer.valvesoftware.com/wiki/Source_Mod_Installers" target="_blank">http://developer.valvesoftware.com/w...Mod_Installers</a><br />
      <br />
      Before<br />
      <a href="http://i12.tinypic.com/30cnh1x.png" target="_blank">http://i12.tinypic.com/30cnh1x.png</a><br />
      <br />
      After<br />
      <a href="http://i19.tinypic.com/35lbtyh.png" target="_blank">http://i19.tinypic.com/35lbtyh.png</a><br />
      <br />
      Stats</b><br />
      <a href="http://i13.tinypic.com/4hrs4t2.png" target="_blank">http://i13.tinypic.com/4hrs4t2.png</a></p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
      <span class="post-time small text-muted">20th February 2007 15:58 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">UPX compresses the overhead, i.e. the execution code.<br />
      <br />
      -Stu</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Backland</span><br />
      <span class="post-time small text-muted">20th February 2007 16:15 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">You can also use UPX on your installer at compile time with the !packhdr command.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">amckern</span><br />
      <span class="post-time small text-muted">20th February 2007 23:24 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Because I normally use HM NSIS, where about would I stick !packhdr - and will that UPX the correct files at compile time, instead of having to run them through the external tool?<br />
      <br />
      I also saw that UPX reserves its self a slice of ram at run time, would this be a hack way to safe guard your self against buffer over runs? Or is it the other way around, and will have a more significant chance of causing them?</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
      <span class="post-time small text-muted">21st February 2007 00:15 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">You just put it in your script.<br />
      Documentation shows this example:<br /></p>
      <pre>
<code>!packhdr "$%TEMP%\exehead.tmp" '"C:\Program Files\UPX\upx.exe" "$%TEMP%\exehead.tmp"'</code>
</pre><br />
      <br />
      -Stu
    </div>
    <hr />

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]>
  </script>
</body>
</html>
