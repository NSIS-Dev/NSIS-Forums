<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="description" content="Cancel button issue with multiple custom pages"><title>Cancel button issue with multiple custom pages - NSIS Forums</title><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script><link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css"><link rel="stylesheet" href="../css/style.css" type="text/css"></head><body><div class="container"><ol class="breadcrumb"><li><a href="../index.html" class="glyphicon glyphicon-home"></a></li><li><a href="f-65.html">NSIS Discussion</a></li><li class="active">Cancel button issue with multiple custom pages</li></ol><p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=261594">Cancel button issue with multiple custom pages</a></p><br><div class="post"><p class="post-meta"><span class="post-author text-primary">zbd</span><br><span class="post-time small text-muted">11th December 2006 23:45 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>Cancel button issue with multiple custom pages</strong><br>Hi, I have a few custom pages in my installer, all doing different things, but if the user clicks "Cancel" on any of these pages, it just takes them to the next page (it shows the abort message too). Just wondering if i can make the "Cancel" button directly exit the installer, or exit normally, or just at all would be great.<br><br>The function for the custom pages are like this but it happens with all the custom pages it seems:<br></p><pre>
<code><br>Function InstallMap<br>         call InstallMapData<br>         <br>         ${If} $need_map == "no"<br>               goto map_exists<br>         ${ElseIf} $need_map == "yes"<br>              Call InstallMapPack<br>              ;Display the InstallOptions dialog<br>              InstallOptions::dialog "$PLUGINSDIR\installmap.ini"<br>              Pop $0<br>         ${EndIf}<br>map_exists:<br>FunctionEnd<br></code>
</pre><br>
      <br>
      thanks for any help<br>
      -zbd
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">bholliger</span><br>
      <span class="post-time small text-muted">12th December 2006 00:43 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Hi zbd!<br>
      <br>
      Could you attach the whole piece of code?<br>
      <br>
      Cheers<br>
      <br>
      Bruno</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">zbd</span><br>
      <span class="post-time small text-muted">12th December 2006 01:04 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>script attached</strong><br>
      Hi again Bruno,<br>
      I must warn this is very mashed up and a lot of unnecessary stuff in there, i will try and tell u which lines the things that matter are.<br>
      Script is attached...<br>
      <br>
      Line ~ 50 - 70 - Var's i'm using for the pages<br>
      Line 124 - 131 - Custom pages<br>
      Line 162 - 240 - Custom page Functions<br>
      Line 335 - 340 - InstallCAB used in most of the custom pages<br>
      Line 420 - 500 - One of the components being checked and installed<br>
      Line 464 - Variable being set to show page or not<br>
      Line 841 - 875 - .onInit ini files etc being extracted/reserved<br>
      <br>
      <br>
      It just seems strange to me that it will give me the abort warning message when i click "Cancel", then i click yes and it just goes to the next page.<br>
      <br>
      Hope you can help, thanks<br>
      Zbd</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">bholliger</span><br>
      <span class="post-time small text-muted">12th December 2006 01:31 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Hi zbd!<br>
      <br>
      I couldn't spot anything wrong. Is it working with MUI? I don't know XPUI, sorry.<br>
      <br>
      Cheers<br>
      <br>
      Bruno</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">zbd</span><br>
      <span class="post-time small text-muted">12th December 2006 01:48 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">I think its almost exactly the same, but yeah i'm using a skinning system with XPUI, Its very strange, seems to happen with every custom page.<br>
      Is there a way i can make a custom AbortWarning?<br>
      I would have to detect when they clicked the Cancel button tho<br>
      <br>
      Thanks Bruno</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">bholliger</span><br>
      <span class="post-time small text-muted">12th December 2006 01:54 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Hi zbd!<br>
      <br>
      Hmmm, this behaviour is really weird!<br>
      <br>
      It is possible to create your own abort warning. Write your code in the .onUserAbort callback function:<br>
      <br></p>
      <pre>
<code><br> Function .onUserAbort<br>   MessageBox MB_YESNO "Abort install?" IDYES NoCancelAbort<br>     Abort ; causes installer to not quit.<br>   NoCancelAbort:<br> FunctionEnd<br></code>
</pre><br>
      Cheers<br>
      <br>
      Bruno
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">zbd</span><br>
      <span class="post-time small text-muted">12th December 2006 01:59 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">sorry, newb-ness kicking in,<br>
      I tried just putting that function in my code, it says it exists already? i cant find it</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">bholliger</span><br>
      <span class="post-time small text-muted">12th December 2006 02:06 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Ok, XPUI must have occupied this function for its own stuff. Have a look into the documentation of XPUI. It might provide the possibility to create your own function.<br>
      <br>
      MUI has a similar behaviour with .onGUIInit. If you want to execute your own code, you have to create your own myGUIInit function and introduce a line like this one:<br>
      <br>
      !define MUI_CUSTOMFUNCTION_GUIINIT myGUIInit<br>
      <br>
      Cheers<br>
      <br>
      Bruno</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">zbd</span><br>
      <span class="post-time small text-muted">12th December 2006 02:22 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Ur a champ Bruno, it's almost doing what i want now, i just renamed that last .onUserAbort func and included !define MUI_CUSTOMFUNCTION_ABORT "UserAbort" so it is using the Function you gave.<br>
      <br>
      It is now closing the installer as soon as i press Cancel, there is no Abort Warning, but I can deal with that i hope.<br>
      <br>
      Thanks for ur help, its very much appreciated.<br>
      Zbd</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">bholliger</span><br>
      <span class="post-time small text-muted">12th December 2006 02:25 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">You're welcome.<br>
      <br>
      Well I guess you could use this code anyway.<br>
      <br></p>
      <pre>
<code><br>    Function UserAbort<br>       MessageBox MB_YESNO "Abort install?" IDYES NoCancelAbort<br>         Abort ; causes installer to not quit.<br>       NoCancelAbort:<br>     FunctionEnd<br></code>
</pre><br>
      <br>
      Cheers<br>
      <br>
      Bruno
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">zbd</span><br>
      <span class="post-time small text-muted">12th December 2006 02:27 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Yeah, willdo<br>
      <br>
      thanks again mate, Zbd</p>
    </div>
    <hr>

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]></script></body></html>