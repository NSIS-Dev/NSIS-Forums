<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="using NSIS to install windowsInstaller" />

  <title>using NSIS to install windowsInstaller - NSIS Forums</title>
  <script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script>
  <!-- Bootstrap core CSS -->

  <link rel="stylesheet" type="text/css" href="//netdna.bootstrapcdn.com/bootswatch/3.0.1/readable/bootstrap.min.css" />
  <link rel="stylesheet" href="../css/style.css" type="text/css" /><!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!--[if lt IE 9]>
                <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
                <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->
</head>

<body>
  <div class="container">
    <!-- Put navigation bar here -->

    <ol class="breadcrumb">
      <li><a href="../index.html" class="glyphicon glyphicon-home"></a></li>

      <li><a href="f-65.html">NSIS Discussion</a></li>

      <li class="active">using NSIS to install windowsInstaller</li>
    </ol>

    <p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=141745">using NSIS to install windowsInstaller</a></p><br />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">krisbabu</span><br />
      <span class="post-time small text-muted">10th July 2003 14:34 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>using NSIS to install windowsInstaller</strong><br />
      Hi..<br />
      <br />
      I have a problem with my installer. I want to install mycomponent.msi(windowsInstaller) .is it possible?.<br />
      <br />
      Am using the flg command and it throws error.<br />
      <br />
      Exec "${MSIExecPaht}msiExec /q /i "License.msi" TargetDIr = "$InSTDir"<br />
      <br />
      Bye<br />
      Krisbabu</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
      <span class="post-time small text-muted">10th July 2003 14:39 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">You have a problem with the quotes. Use ' as the outer quote and it should be OK. You should also quote the path to the executable just in case it contains spaces. So the line should look like this:<br />
      <br />
      Exec '"${MSIExecPath}msiExec" /q /i "License.msi" TargetDir = "$INSTDIR"'</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">krisbabu</span><br />
      <span class="post-time small text-muted">10th July 2003 14:55 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Hi kichek..<br />
      The code that i used Exactly the one u suggested,But still it thro' error.I tried using nsExec::Exec '"${MSIExecPath}msiExec" /q /i "License.msi" TargetDir = "$INSTDIR"' too,but it's return value was Error.<br />
      Thanks for ur reply<br />
      krisbabu</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
      <span class="post-time small text-muted">10th July 2003 14:59 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">What error?</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">krisbabu</span><br />
      <span class="post-time small text-muted">11th July 2003 06:35 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">hi kichek..<br />
      it gave the return as error and i didn't get any more information.<br />
      <br />
      here is my code:<br />
      Exec '"${MSISEXECPATH}msiExec" /q /i "License.msi" TARGETDIR = "$INSTDIR"'<br />
      pop $0 #return value/error/timeout<br />
      DetailPrint "Return value $0"<br />
      <br />
      Here<br />
      ${MSISEXECPATH} -&gt; msiExec path<br />
      TARGETDIR = $INSTDIR" -&gt; is parameter so that i can send targetdir, which is defined in License.msi<br />
      Thanks<br />
      krisbabu</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
      <span class="post-time small text-muted">11th July 2003 11:36 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">That's not how you get the return value. Exec doesn't return any return value because it doesn't wait for the program to finish. Only ExecWait and nsExec return the return value. With ExecWait you specify the output variable in another parameter and only with nsExec you pop it from the stack.<br />
      <br />
      First of all make sure ${MSISEXECPATH} has an ending back-slash so the path is completely right (you can also just output "${MSISEXECPATH}msiExec"), next make sure it can find License.msi. If License.msi is not in the current working directory ($EXEDIR or $OUTDIR if SetOutPath was used) then either specify a full path or set the current working directory (using SetOutPath) to the directory of License.msi.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">krisbabu</span><br />
      <span class="post-time small text-muted">18th July 2003 09:08 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Hi,<br />
      I got it.The mistake was with the coding.There was extra Space.It is like this<br />
      <br />
      Exec ' "${MSIExecPath}msiExec" /q /i "License.msi" TargetDir = "$INSTDIR" '<br />
      <br />
      Now it is as follows:<br />
      <br />
      <br />
      ExecWait Exec '"${MSIExecPath}msiExec" /q /i "License.msi" TargetDir = "$INSTDIR"' - No Space bt ' and "<br />
      Thanks<br />
      Krisbabu</p>
    </div>
    <hr />

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]>
  </script>
</body>
</html>
