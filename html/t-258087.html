<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="Get all usernames under XP" />

  <title>Get all usernames under XP - NSIS Forums</title>
  <script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script>
  <!-- Bootstrap core CSS -->

  <link rel="stylesheet" type="text/css" href="//netdna.bootstrapcdn.com/bootswatch/3.0.1/readable/bootstrap.min.css" />
  <link rel="stylesheet" href="../css/style.css" type="text/css" /><!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!--[if lt IE 9]>
                <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
                <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->
</head>

<body>
  <div class="container">
    <!-- Put navigation bar here -->

    <ol class="breadcrumb">
      <li><a href="../index.html" class="glyphicon glyphicon-home"></a></li>

      <li><a href="f-65.html">NSIS Discussion</a></li>

      <li class="active">Get all usernames under XP</li>
    </ol>

    <p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=258087">Get all usernames under XP</a></p><br />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Defcon0</span><br />
      <span class="post-time small text-muted">22nd October 2006 17:21 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>Get all usernames under XP</strong><br />
      Hello,<br />
      I want to install a program for all users on my pc (also with limited users).<br />
      For this I have the opportunity to install the config files to the All Users\Application Data - Directory.<br />
      But this has a disadvantage: Everyone uses the same config.<br />
      How can I install my program to every single user's<br />
      C:\Docs and Settings\<i>username</i>\Application Data - Dir ?<br />
      <br />
      Is this possible ?<br />
      <br />
      Thanks in forward.<br />
      <br />
      Bye</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Animaether</span><br />
      <span class="post-time small text-muted">23rd October 2006 10:18 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Are you using $APPDATA to get at that application data dir? If so, you just need to use:<br /></p>
      <pre>
<code>SetShellVarContext current</code>
</pre><br />
      before the line with $APPDATA to get the current user's application data dir.<br />
      <br />
      Don't forget to switch back to all users after that if you need it!
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Defcon0</span><br />
      <span class="post-time small text-muted">23rd October 2006 10:46 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">I tried this before.<br />
      Changing this Variable makes $APPDATA look like this<br />
      C:\Docs and Settings\All Users\Application Data<br />
      instead of this<br />
      C:\Docs and Settings\username\Application Data<br />
      <br />
      But the consequence is that all Users on the PC use the same config.<br />
      <br />
      Is there a workaround ?</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">flizebogen</span><br />
      <span class="post-time small text-muted">23rd October 2006 12:30 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">IMHO you should install the config under All Users. If a user starts your app for the very first time your has to copy the config files found in "All Users" to the current users.<br />
      <br />
      If this is not possible than write an small NSIS Script as your app start script. If the current user has no config then copy it, if the user already has the config skip copying and start your app.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Defcon0</span><br />
      <span class="post-time small text-muted">23rd October 2006 12:54 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">I made it the following. The Config isn't installed at all. I made my application write it completely by itself.<br />
      So there's no problem anymore.<br />
      <br />
      Tahnks !!</p>
    </div>
    <hr />

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]>
  </script>
</body>
</html>
