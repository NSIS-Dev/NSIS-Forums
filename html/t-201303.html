<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="GetAdaptersInfo problem" />

  <title>GetAdaptersInfo problem - NSIS Forums</title><!-- Bootstrap core CSS -->
  <link rel="stylesheet" type="text/css" href="//netdna.bootstrapcdn.com/bootswatch/3.0.1/readable/bootstrap.min.css" />
  <link rel="stylesheet" href="../css/style.css" type="text/css" /><!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!--[if lt IE 9]>
                <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
                <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->
</head>

<body>
  <div class="container">
    <!-- Put navigation bar here -->

    <ol class="breadcrumb">
      <li><a href="../index.html" class="glyphicon glyphicon-home"></a></li>

      <li><a href="f-65.html">NSIS Discussion</a></li>

      <li class="active">GetAdaptersInfo problem</li>
    </ol>

    <p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=201303">GetAdaptersInfo problem</a></p><br />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">aadya</span><br />
      <span class="post-time small text-muted">6th December 2004 12:17 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>GetAdaptersInfo problem</strong><br />
      Hi Guys,<br />
      I have an issue arising out of the solution in the following link:<br />
      <a href="http://forums.winamp.com/showthread.php?s=&amp;threadid=181908&amp;highlight=mathscript" target="_blank">http://forums.winamp.com/showthread....ght=mathscript</a><br />
      <br />
      If i use the math::script lines, the installer crashes.<br />
      If i do not use, i fear i am getting an incorrect decimal representation of the address.<br />
      For e.g. if the output by ipconfig /all is AB-CD. Its decimal representation is 43981. Lets assume the output from the code above gives a decimal value 'X', the reciprocal HEX of 'X' comes out to be CDAB (CD-AB).<br />
      <br />
      In Plain words, the hexadecimal value of the mac address upon usage of the code above, is the reverse output of ipconfig/all.<br />
      <br />
      Could any one shed any light on this please?<br />
      <br />
      thanks.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
      <span class="post-time small text-muted">6th December 2004 17:32 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Have you tried the exact example? If not, can you attach a test script?</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">aadya</span><br />
      <span class="post-time small text-muted">7th December 2004 08:36 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Hi Kichik,<br />
      The script:<br />
      <br />
      <br />
      !define maxsize 4096<br />
      <br />
      System::Alloc ${maxsize}<br />
      pop $3<br />
      System::Call 'iphlpapi::GetAdaptersInfo(i r3r4, *l ${maxsize} r2)i.r1'<br />
      strcmp $1 0 0 finish ;in case of errors<br />
      <br />
      cont:<br />
      strcmp $4 0 finish ; no more adapters<br />
      System::Call '*$4(i.r4,i,&amp;t260.r5, &amp;t132.r6, i.r7, l.r8)'<br />
      <br />
      ;Math::Script "hex={'0','1','2','3','4','5','6','7','8','9','A','B','C','D','E','F'};"<br />
      ;Math::Script "s=''; a=r8; b=r7; #{b--&gt;0,s=s+hex[a/16%16]+hex[a%16]+#[b&gt;0,'-','']; a=a/256;}; r9=s;"<br />
      <br />
      MessageBox mb_ok "Adapter name is $5 desc $6 addr len $7 macaddr $8"<br />
      goto cont<br />
      <br />
      finish:<br />
      System::Free $3<br />
      <br />
      ; last plugin call must not have /NOUNLOAD so NSIS will be able to delete the temporary DLL<br />
      SetPluginUnload manual<br />
      ; do nothing<br />
      System::Free 0<br />
      Math::Script ""<br />
      <br />
      Its exactly the same as in the example. My guess is that problem lies in the second "Math::script" line. Its too cryptic to know whats going on...<br />
      <br />
      Appreciate your help again!</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">aadya</span><br />
      <span class="post-time small text-muted">7th December 2004 08:58 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Hi Kichik,<br />
      <br />
      Interesting...works now!<br />
      I was missing the following line...<br />
      "SetPluginUnload alwaysoff"<br />
      and hence the crash.<br />
      <br />
      thanks for your attention.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">grahama</span><br />
      <span class="post-time small text-muted">22nd January 2005 04:48 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">how can the above script be adapted to work in 98 ?</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
      <span class="post-time small text-muted">22nd January 2005 11:35 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">GetAdaptersInfo is available on Windows 98. It should work.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">grahama</span><br />
      <span class="post-time small text-muted">22nd January 2005 20:05 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">no.... :( checked it again<br />
      does work in 2000 though....<br />
      anyone know what it could be ?</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">pengyou</span><br />
      <span class="post-time small text-muted">23rd January 2005 00:12 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Both scripts (the one here and the one in the other thread) work on my Win98SE system. The name string ($5) is empty but the other information is OK.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">grahama</span><br />
      <span class="post-time small text-muted">23rd January 2005 07:16 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">ok<br />
      must be an improper install on the Win 98 computer I am using for testing...<br />
      no big surprise as the computer is a wreck ;)<br />
      thanks for checking for me :)</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Takhir</span><br />
      <span class="post-time small text-muted">23rd January 2005 08:48 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">May require adapter to be installed.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">theboth</span><br />
      <span class="post-time small text-muted">9th February 2005 23:05 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Please! =)<br />
      <br />
      I would like to know if anyone out there has taken this solution just a little farther and use something like the wsock32::inet_ntoa to convert the adapters address into human readable format?<br />
      <br />
      please any help and examples would be much apreciated.<br />
      <br />
      thanks.</p>
    </div>
    <hr />

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]>
  </script>
</body>
</html>
