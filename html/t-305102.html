<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="description" content="Replace string in text file at compile time"><title>Replace string in text file at compile time - NSIS Forums</title><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script><link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css"><link rel="stylesheet" href="../css/style.css" type="text/css"></head><body><div class="container"><ol class="breadcrumb"><li><a href="../index.html" class="glyphicon glyphicon-home"></a></li><li><a href="f-65.html">NSIS Discussion</a></li><li class="active">Replace string in text file at compile time</li></ol><p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=305102">Replace string in text file at compile time</a></p><br><div class="post"><p class="post-meta"><span class="post-author text-primary">qwertymodo</span><br><span class="post-time small text-muted">8th April 2009 06:15 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>Replace string in text file at compile time</strong><br>I need to replace a string inside of a text file at compile time, in the same way that the ReplaceInFile header does. I know that I COULD write a separate script that does it via the command-line, then call<br><br></p><pre>
<code><br>!system '"${NSISDIR}\makensis.exe" "textreplacescript.nsi"' = 0<br>!system '"textreplace.exe" "commandlineargs"' = 0<br>!delfile "textreplace.exe"<br></code>
</pre><br>
      <br>
      Is there an easier way?
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">jpderuiter</span><br>
      <span class="post-time small text-muted">8th April 2009 14:54 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><a href="http://nsis.sourceforge.net/TextReplace_plugin" target="_blank">http://nsis.sourceforge.net/TextReplace_plugin</a><br>
      <br>
      Sorry, I was too quick...<br>
      This will not work at compile time.</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">qwertymodo</span><br>
      <span class="post-time small text-muted">9th April 2009 02:35 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Hmm... well in the mean time I'll try the other way...</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">qwertymodo</span><br>
      <span class="post-time small text-muted">12th April 2009 10:56 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">So, the whole point of this question was that I have portable-ized a few programs for the U3 platform, and anyone who has ever perused PortableApps.com knows how useful NSIS is for creating portable application launchers. Unfortunately, I did have to go the route I had indicated, but it ended up not being so bad. I actually added a few more functions in this manner as well. My one gripe was having to use separate helper scripts, which just made the source folder all ugly.<br>
      <br>
      Then I discovered the wonders of !system 'echo ... &gt;&gt; mytempfile'<br>
      <br>
      Well, one thing led to another, and it was just too cool using runtime commands at compile time, and then I was like "hey I'll bet I could take all of these helper scripts I'm writing and merge them all into one!"<br>
      <br>
      Yes, I did actually managed to write a very useful script whose output file does NOTHING.<br>
      <br>
      ...I get the feeling that no one else has done this before...<br>
      <br>
      ...perhaps with good reason...<br>
      <br>
      <br>
      <br>
      <br>
      ...I scare myself sometimes...</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">{_trueparuex^}</span><br>
      <span class="post-time small text-muted">12th April 2009 12:04 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Try this.<br>
      <br></p>
      <pre>
<code>!define /file BUNCHASTUFF somefile.txt<br><br>!searchreplace NEWSTUFF "${BUNCHASTUFF}" "foo" "bar"<br>...<br><br>!delfile somefile.txt<br>!appendfile somefile.txt "${NEWSTUFF}"</code>
</pre><br>
      <br>
      Also you could use the NSIS !echo command instead of using !system command to call echo in your script.<br>
      <br>
      PaR
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">{_trueparuex^}</span><br>
      <span class="post-time small text-muted">12th April 2009 18:51 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">I just realized that code probably won't work with script files or with any other files that breaks the parameter quoting. :(<br>
      <br>
      PaR</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">qwertymodo</span><br>
      <span class="post-time small text-muted">14th April 2009 06:12 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Hmm... I'll have to try that. Can !echo be used with &gt;&gt; the same as the system echo can? I mean, what is the actual difference? And as for breaking parameter quoting, I can usually get around that with $\"</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br>
      <span class="post-time small text-muted">10th May 2009 13:19 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">There's no !echo, only !appendfile and it works on all platforms and doesn't depend on the existence of echo or platform dependent command line parsing.</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">qwertymodo</span><br>
      <span class="post-time small text-muted">10th May 2009 21:28 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Well, there is an !echo command, I guess it just outputs only to the compiler, but thanks for pointing me at !appendfile, it's exactly what I needed.<br>
      <br>
      ...also, I'm not sure what you mean by platform-independent, as I'm pretty sure NSIS is Windows only anyways...</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br>
      <span class="post-time small text-muted">11th May 2009 00:38 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">NSIS can build on other platforms other than Windows (but only build installers that run on Windows).<br>
      <br>
      Stu</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">qwertymodo</span><br>
      <span class="post-time small text-muted">11th May 2009 04:57 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Oh, right, I knew that... just for some reason I wasn't thinking about the fact that it's a compile-time command, which would depend on the compiling system :P Anyway, problem solved, so thanks for the input :)</p>
    </div>
    <hr>

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]></script></body></html>