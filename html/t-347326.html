<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="NSIS works with LangString incorrectly" />

  <title>NSIS works with LangString incorrectly - NSIS Forums</title><!-- Bootstrap core CSS -->
  <link rel="stylesheet" type="text/css" href="//netdna.bootstrapcdn.com/bootswatch/3.0.1/readable/bootstrap.min.css" />
  <link rel="stylesheet" href="../css/style.css" type="text/css" /><!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!--[if lt IE 9]>
                <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
                <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->
</head>

<body>
  <div class="container">
    <!-- Put navigation bar here -->

    <ol class="breadcrumb">
      <li><a href="../index.html" class="glyphicon glyphicon-home"></a></li>

      <li><a href="f-65.html">NSIS Discussion</a></li>

      <li class="active">NSIS works with LangString incorrectly</li>
    </ol>

    <p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=347326">NSIS works with LangString incorrectly</a></p><br />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">SirHally</span><br />
      <span class="post-time small text-muted">24th August 2012 11:30 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>NSIS works with LangString incorrectly</strong><br />
      I have an installer, it builds automatically (on TFS) by using NSIS command line features<br />
      <br /></p>
      <pre>
<code>    "..\..\NSIS\makensis.exe"  /DBUILD_NUMBER=28311 /DPRODUCT_LANGUAGE=English "MTService_setup.nsi"</code>
</pre><br />
      <br />
      The installer must use only one language, which specified in PRODUCT_LANGUAGE parameter. I've done it in the following way<br />
      <br />
      <pre>
<code>    !insertmacro MUI_LANGUAGE "${PRODUCT_LANGUAGE}"</code>
</pre><br />
      <br />
      When I build installer in such way, the common language of the interface is correct. But it uses default system language for LangString. So, if default system language is not English, it shows LangString on another language in the English installer.<br />
      <br />
      I've tried to change script to avoid command line parameters (for test purposes)<br />
      <br />
      <pre>
<code>    !insertmacro MUI_LANGUAGE "English"</code>
</pre><br />
      <br />
      It doesn't work too.<br />
      <br />
      I've tried to change script to<br />
      <br />
      <pre>
<code><br />!insertmacro MUI_LANGUAGE "English"<br />!insertmacro MUI_LANGUAGE "Russian"<br /><br />Function .onInit<br /><br />  !insertmacro MUI_LANGDLL_DISPLAY<br /><br />FunctionEnd<br /></code>
</pre><br />
      <br />
      It works, but, of course, it shows language selection dialog. I want to use specific ${PRODUCT_LANGUAGE} without any dialog.<br />
      <br />
      So, how can I fix it?
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
      <span class="post-time small text-muted">24th August 2012 11:48 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Try <a href="http://nsis.sourceforge.net/Language_Detection_From_Windows_UI_Language" target="_blank">http://nsis.sourceforge.net/Language...ws_UI_Language</a>.<br />
      <br />
      Stu</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">SirHally</span><br />
      <span class="post-time small text-muted">24th August 2012 12:26 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"></p>

      <blockquote>
        Try <a href="http://nsis.sourceforge.net/Language...ws_UI_Language" target="_blank">http://nsis.sourceforge.net/Language...ws_UI_Language</a>.
      </blockquote>Unfortunatelly, it doesn't work for me. There wasn't any changes, LangString use system default language.<br />
      <br />
      <a href="http://i.stack.imgur.com/N6f1s.png" target="_blank">http://i.stack.imgur.com/N6f1s.png</a><br />
      <br />
      I've tried to add<br />
      <br />
      <pre>
<code><br />  StrCpy $LANGUAGE ${LANG_ENGLISH}<br /></code>
</pre><br />
      <br />
      in .onInit function, but it doesn't work too
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
      <span class="post-time small text-muted">24th August 2012 13:55 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Something is wrong with your script. Half of those texts <i>are</i> LangStrings. The rest are set via the old language file format (nlf) but are still selected on the value of $LANGUAGE. Is it just the section descriptions? Where have you put your language strings for those? Are they after !insertmacro MUI_LANGUAGE ...?<br />
      <br />
      Stu</p>
    </div>
    <hr />

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]>
  </script>
</body>
</html>
