<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="description" content=".nsi Script Question"><title>.nsi Script Question - NSIS Forums</title><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script><link rel="preload" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css" as="style" onload="this.rel='stylesheet'"><link rel="preload" href="../css/style.css" as="style" onload="this.rel='stylesheet'"><noscript><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css"><link rel="stylesheet" href="../css/style.css"></noscript><script>!function(a){"use strict";var b=function(b,c,d){function e(a){return h.body?a():void setTimeout(function(){e(a)})}function f(){i.addEventListener&&i.removeEventListener("load",f),i.media=d||"all"}var g,h=a.document,i=h.createElement("link");if(c)g=c;else{var j=(h.body||h.getElementsByTagName("head")[0]).childNodes;g=j[j.length-1]}var k=h.styleSheets;i.rel="stylesheet",i.href=b,i.media="only x",e(function(){g.parentNode.insertBefore(i,c?g:g.nextSibling)});var l=function(a){for(var b=i.href,c=k.length;c--;)if(k[c].href===b)return a();setTimeout(function(){l(a)})};return i.addEventListener&&i.addEventListener("load",f),i.onloadcssdefined=l,l(f),i};"undefined"!=typeof exports?exports.loadCSS=b:a.loadCSS=b}("undefined"!=typeof global?global:this);!function(a){if(a.loadCSS){var b=loadCSS.relpreload={};if(b.support=function(){try{return a.document.createElement("link").relList.supports("preload")}catch(b){return!1}},b.poly=function(){for(var b=a.document.getElementsByTagName("link"),c=0;c<b.length;c++){var d=b[c];"preload"===d.rel&&"style"===d.getAttribute("as")&&(a.loadCSS(d.href,d,d.getAttribute("media")),d.rel=null)}},!b.support()){b.poly();var c=a.setInterval(b.poly,300);a.addEventListener&&a.addEventListener("load",function(){b.poly(),a.clearInterval(c)}),a.attachEvent&&a.attachEvent("onload",function(){a.clearInterval(c)})}}}(this);</script></head><body><div class="container"><ol class="breadcrumb"><li><a href="../index.html" class="glyphicon glyphicon-home"></a></li><li><a href="f-65.html">NSIS Discussion</a></li><li class="active">.nsi Script Question</li></ol><p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=290232">.nsi Script Question</a></p><br><div class="post"><p class="post-meta"><span class="post-author text-primary">aeroelim</span><br><span class="post-time small text-muted">14th April 2008 22:29 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>.nsi Script Question</strong><br>I was creating a .nsi script to test and practice making a .nsi script.<br>This is my code so far:<br><br></p><pre>
<code>Name "Test1"   <br>;<br>Page directory<br>Page instfiles<br>;<br>;                                                                 <br>InstallDir $PROGRAMFILES\NSIS_Test <br>;<br>Section "!TestProgram"                <br>SetOutPath $INSTDIR<br>File test1.txt<br>File test2.txt<br>File test3.txt<br>;<br>SectionEnd<br>;<br>;<br>Section /o "Uninstall"<br>WriteUninstaller $INSTDIR\Uninstal.exe<br>  Delete $INSTDIR\test1.txt<br>  Delete $INSTDIR\test2.txt<br>  RMDir $INSTDIR<br>SectionEnd</code>
</pre><br>
      <br>
      Now heres my question:<br>
      Before I compile how do I set the test1.txt, test2.txt, test3.txt to be included? Because when I compile it says those files are missing, so how do I include them into the script beyond putting in the "File xxx" tag? Can somebody please help me, thanks!
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">AaronLS</span><br>
      <span class="post-time small text-muted">14th April 2008 22:34 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">As you have it written, when you compile, NSIS compiler will look for those three txt files in the same directory as your nsi script. Do you have three files of those names in the same directory as the *.nsi file?</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">aeroelim</span><br>
      <span class="post-time small text-muted">14th April 2008 23:46 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Oh! You have to put it in the same folder as your *.nsi file! Thanks AaronLS, also I have a question for you, do you know any links to good tutorials on writting *.nsi script files?</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">AaronLS</span><br>
      <span class="post-time small text-muted">15th April 2008 00:02 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">;) You can get really fancy and specify a relative path such as:<br>
      File "SubDirectory/file.txt"<br>
      File "../SameLevelDirectory/file.txt"<br>
      <br>
      I began my NSIS adventure by running NSIS fromt he Start menu and choosing "NSIS Users Manual" under documentation and reading through a good portion of the manual. For example, there is lots more information about the "File" command.<br>
      <br>
      Tutorials:<br>
      <a href="http://nsis.sourceforge.net/Category:Tutorials" target="_blank">http://nsis.sourceforge.net/Category:Tutorials</a><br>
      <br>
      That website has lots of other sections with good information.</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">aeroelim</span><br>
      <span class="post-time small text-muted">15th April 2008 00:23 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Thanks, but I have one more question.<br>
      <br>
      I can't seem to get the uninstaller to work..<br>
      Here is my code now<br></p>
      <pre>
<code><br>Name "Test1"   <br>;<br>OutFile installer.exe<br>;<br>Page components<br>Page directory<br>Page instfiles<br><br>;<br>;                                                               <br><br>  <br>InstallDir $PROGRAMFILES\NSIS_Test <br>;<br>Section /o "TestProgram"              <br>SetOutPath $INSTDIR<br>File test1.txt<br>File test2.txt<br>File test3.txt<br>;<br>SectionEnd<br>;<br>Section /o "Uninstaller"<br>WriteUninstaller $INSTDIR\uninstall.exe<br>SectionEnd<br><br>Section "!Optional Program Files"<br>SetOutPath $INSTDIR\Test<br>File test4.txt<br>File test5.txt<br>SectionEnd<br>;<br>Section "!Optional Program Filesv2"<br>SetOutPath $INSTDIR\Test\Test2<br>File test6.txt<br>SectionEnd<br>;<br>;<br>Section /o "Uninstall"<br>  Delete $INSTDIR\uninstall.exe<br>  Delete $INSTDIR\test1.txt<br>  Delete $INSTDIR\test2.txt<br>  Delete $INSTDIR\test3.txt<br>  Delete $INSTDIR\Test\test4.txt<br>  Delete $INSTDIR\Test\test5.txt<br>  Delete $INSTDIR\Test\Test2\test6.txt<br>SectionEnd<br></code>
</pre><br>
      <br>
      But when I run the uninstaller in the end it doesn't do anything, it just says "Completed" but no files were removes. How do I fix this?
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">AaronLS</span><br>
      <span class="post-time small text-muted">15th April 2008 00:44 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Remove the /o from the Uninstaller section and see if that helps.</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">aeroelim</span><br>
      <span class="post-time small text-muted">15th April 2008 00:46 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">AaronLS, how do you put the installer in ModernUI?<br>
      I've tried<br>
      <br>
      MUI_PAGE_WELCOME and other MUI_PAGE's but it says unknown command. Then I tried<br>
      !insertmacro MUI_PAGE_WELCOME but then it says it can't find the macro. How do i fix this?</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">AaronLS</span><br>
      <span class="post-time small text-muted">15th April 2008 00:51 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">You have to include MUI.nsh or<br>
      !include "MUI2.nsh"<br>
      <br>
      I think there is a few MUI example scripts in the NSIS install directory under examples:<br>
      C:\program files\NSIS\Examples\Modern UI\</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Koopa</span><br>
      <span class="post-time small text-muted">15th April 2008 00:55 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">E.g.<br></p>
      <pre>
<code><br>!include "MUI.nsh"<br><br>; MUI Settings<br>!define MUI_ABORTWARNING<br>!define MUI_HEADERIMAGE<br>!define MUI_HEADERIMAGE_BITMAP "${NSISDIR}\Contrib\Graphics\Header\orange.bmp"<br>!define MUI_WELCOMEFINISHPAGE_BITMAP "${NSISDIR}\Contrib\Graphics\Wizard\orange.bmp"<br>!define MUI_COMPONENTSPAGE_CHECKBITMAP "${NSISDIR}\Contrib\Graphics\Checks\simple-round.bmp"<br>!define MUI_ICON "${NSISDIR}\Contrib\Graphics\Icons\orange-install.ico"<br>!define MUI_UNICON "${NSISDIR}\Contrib\Graphics\Icons\orange-uninstall.ico"<br><br>!insertmacro MUI_PAGE_WELCOME<br>!insertmacro MUI_PAGE_DIRECTORY<br>!insertmacro MUI_PAGE_COMPONENTS<br>!insertmacro MUI_PAGE_INSTFILES<br>!insertmacro MUI_PAGE_FINISH<br>!define MUI_UNINSTALLER</code>
</pre>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">aeroelim</span><br>
      <span class="post-time small text-muted">15th April 2008 01:06 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">how do you add text to a page in MUI_? I tried doing:<br></p>
      <pre>
<code>MUI_WELCOMEPAGE_TEXT "text"</code>
</pre>under the !insertmacro MUI_PAGE_WELCOME but it doesn't work to add any text or anything, how do I do this?
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">AaronLS</span><br>
      <span class="post-time small text-muted">15th April 2008 01:10 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">You need !define and I think it needs to come before the page declaration if I remember correctly.<br>
      <br></p>
      <pre>
<code><br>!define MUI_WELCOMEPAGE_TEXT "text"<br>!insertmacro MUI_PAGE_WELCOME<br></code>
</pre>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">aeroelim</span><br>
      <span class="post-time small text-muted">15th April 2008 22:34 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Now im running into this problem... Im trying to put a function to do a .onMouseOverSection function command but everything I try it just gives me an error in the compile..<br>
      <br>
      (Note I want to put a mouseover message on the "Test Program" <b>SECTION</b>. Thanks!)<br>
      <br>
      This is my whole code so far :<br></p>
      <pre>
<code><br>Name "TestInst"<br><br>OutFile installer1_1.exe<br><br><br>Function .onMouseOverSection<br>FindWindow $RO "Test Program" $HWNDPARENT $TESTPROGRAM<br>SendMessage $RO ${WM_SETTEXT} 0 "STR: REQUIRED TEST PROGRAM SECTION PLEASE DO"<br>FunctionEnd<br><br>Function .onInit<br>  MessageBox MB_YESNO "This will install My Program. Do you wish to continue?" IDYES gogogo<br>    Abort<br>  gogogo:<br>FunctionEnd<br>Function un.onInit<br>  MessageBox MB_YESNO "This will completely remove 'MY PROGRAM' from your computer.  Do you wish to continue?" IDYES gogogo<br>    Abort<br>  gogogo:<br>FunctionEnd<br>!include MUI2.nsh<br>!define MUI_WELCOMEPAGE_TITLE "Welcome to test install!"<br>!define MUI_WELCOMEPAGE_TEXT "Welcome to test install! This is an installer testing my script creating skills!"<br>!insertmacro MUI_PAGE_WELCOME<br>!insertmacro MUI_PAGE_COMPONENTS<br>!insertmacro MUI_PAGE_DIRECTORY<br>!insertmacro MUI_PAGE_INSTFILES<br>!define MUI_FINISHPAGE_TITLE "Congratulations!"<br>!define MUI_FINISHPAGE_TEXT "Your install has completed succesfully if you have made it to this page! GRATZ!"<br>!define MUI_FINISHPAGE_BUTTON "Finish and Close"<br>!insertmacro MUI_PAGE_FINISH<br><br>!define MUI_WELCOMEPAGE_TEXT "Welcome to the uninstaller for the Test Program!"<br>!insertmacro MUI_UNPAGE_WELCOME<br>!insertmacro MUI_UNPAGE_CONFIRM<br>!insertmacro MUI_UNPAGE_INSTFILES<br>!define MUI_FINISHPAGE_TEXT "The Test Program has completed un-installation! The program is now completely removed from your computer. If you wish you can check to see if the Directory is still there but it shouldn't be!"<br>!insertmacro MUI_UNPAGE_FINISH<br><br>InstallDir $PROGRAMFILES\_TEST<br><br>Section "!Test Program"<br>MessageBox MB_OK "The Installation has started! Please Wait while the installation continues"<br>SetOutPath $INSTDIR<br>File 1.txt<br>File 2.txt<br>File readme.txt<br>File help.txt<br>SetOutPath $INSTDIR\materials<br>File wep1.txt<br>File wep2.txt<br>SetOutPath $INSTDIR\maps<br>File 2tower.txt<br>File aces.txt<br>File city.txt<br>SectionEnd<br><br>Section /o "Custom Maps"<br>SetOutPath $INSTDIR\maps<br>File red.txt<br>File blue.txt<br>File yellow.txt<br>File green.txt<br>SectionEnd<br><br>Section /o "Uninstaller"<br>WriteUninstaller $INSTDIR\Uninstall.exe<br>SectionEnd<br><br>Section "Uninstall"<br>Delete $INSTDIR\Uninstall.exe<br>Delete $INSTDIR\maps\red.txt<br>Delete $INSTDIR\maps\blue.txt<br>Delete $INSTDIR\maps\yellow.txt<br>Delete $INSTDIR\maps\green.txt<br>Delete $INSTDIR\maps\2tower.txt<br>Delete $INSTDIR\maps\aces.txt<br>Delete $INSTDIR\maps\city.txt<br>RMDir $INSTDIR\maps<br>Delete $INSTDIR\materials\wep1.txt<br>Delete $INSTDIR\materials\wep2.txt<br>RMDir $INSTDIR\materials<br>Delete $INSTDIR\readme.txt<br>Delete $INSTDIR\help.txt<br>Delete $INSTDIR\1.txt<br>Delete $INSTDIR\2.txt<br>RMDir $INSTDIR<br>SectionEnd<br></code>
</pre>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">AaronLS</span><br>
      <span class="post-time small text-muted">15th April 2008 22:52 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">The compile errors indicates line 7 is the problem, and also gives this output:<br></p>

      <blockquote>
        Usage: FindWindow $(user_var: handle output) WindowClass [WindowTitle] [Window_Parent] [Child_After]
      </blockquote>This means there is a probalem with your FindWindow statement.<br>
      <br>
      According to the FindWindow documentation in the manual, the first parameter must be a user var. You are using $R0, but you should be using a variable you declared such as :<br>
      <br>
      <pre>
<code>Var /GLOBAL $FoundWindow</code>
</pre>
    </div>
    <hr>

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]></script></body></html>