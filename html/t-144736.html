<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="Remove task bar item" />

  <title>Remove task bar item - NSIS Forums</title>
  <script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script>
  <!-- Bootstrap core CSS -->

  <link rel="stylesheet" type="text/css" href="//netdna.bootstrapcdn.com/bootswatch/3.0.1/readable/bootstrap.min.css" />
  <link rel="stylesheet" href="../css/style.css" type="text/css" /><!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!--[if lt IE 9]>
                <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
                <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->
</head>

<body>
  <div class="container">
    <!-- Put navigation bar here -->

    <ol class="breadcrumb">
      <li><a href="../index.html" class="glyphicon glyphicon-home"></a></li>

      <li><a href="f-65.html">NSIS Discussion</a></li>

      <li class="active">Remove task bar item</li>
    </ol>

    <p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=144736">Remove task bar item</a></p><br />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
      <span class="post-time small text-muted">4th August 2003 22:46 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>Remove task bar item</strong><br />
      If I am unable to create a tray icon, is it possible to hide the programs' task bar item?<br />
      Also, once hiding it, I would like to be able to show it again.<br />
      <br />
      Thanks<br />
      <br />
      -Stu</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
      <span class="post-time small text-muted">5th August 2003 12:09 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">If it cannot be done using the System plugin, can it be done from changing somthing in the UI exe with Resource Hacker?<br />
      <br />
      -Stu</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
      <span class="post-time small text-muted">5th August 2003 12:44 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">It can be done using the System plug-in. You need to call GetWindowLong and SetWindowLong. Search Google for C code that does this and try to convert it to System.dll calls.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
      <span class="post-time small text-muted">5th August 2003 12:51 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">I've looked at those on MSDN to no avail.<br />
      All I want to do now is remove the task bar item for my settings exe that is executed from my main installer.<br />
      I no-longer want to be able to get it back again.<br />
      <br />
      Help! :(<br />
      <br />
      -Stu</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
      <span class="post-time small text-muted">5th August 2003 13:05 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">First result on Google for "SetWindowLong taskbar":<br />
      <a href="http://www.experts-exchange.com/Programming/Programming_Languages/Delphi/Q_10081312.html" target="_blank">http://www.experts-exchange.com/Prog..._10081312.html</a><br />
      <br />
      Convert that to System.dll and it should work. If you have .NET Framework search for the constants (GWL_EXSTYLE, WE_EX_..., etc.) in the .h files in the Include directory of the framework. If you can't find it, add VB to the search term, they always define the constants there.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
      <span class="post-time small text-muted">5th August 2003 14:43 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">This is a small attempt; i'm sure it is extremely incomplete or completely wrong!<br />
      <br />
      System::Call 'Win32::SetWindowLong($HWNDPARENT, GWL_EXSTYLE)'<br />
      <br />
      -Stu</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
      <span class="post-time small text-muted">5th August 2003 14:49 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">I also found this:<br />
      <a href="http://upc.pkmn.co.uk/win32/task.shtml" target="_blank">http://upc.pkmn.co.uk/win32/task.shtml</a><br />
      <br />
      -Stu</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
      <span class="post-time small text-muted">9th August 2003 14:11 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">I know a plugin is being made to do this, but what would be the System plugin way?<br />
      I just want to use the System plugin code for now to see what advantages/disadvantages it will make.<br />
      <br />
      -Stu</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
      <span class="post-time small text-muted">9th August 2003 14:15 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">You were on the right track, why did you stop? You should define GWL_EXSTYLE as the right value, add another parameter to the function call (SetWindowLong takes 3 not 2) and add 'A' to the function name.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
      <span class="post-time small text-muted">9th August 2003 14:30 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">!define GWL_EXSTYLE -20<br />
      <br />
      System::Call 'Win32::SetWindowLongA($HWNDPARENT, ${GWL_EXSTYLE}, )'<br />
      <br />
      I'm not at all sure what GWL_EXSTYLE should be.<br />
      I could only find<br />
      Const GWL_EXSTYLE = (-20)<br />
      on some web hits.<br />
      <br />
      Also, have I added another parameter correctly?<br />
      <br />
      -Stu</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
      <span class="post-time small text-muted">9th August 2003 14:35 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Looking on MSDN, is this what I want?<br />
      <br />
      WS_EX_NOACTIVATE<br />
      <br />
      Description:<br />
      Windows 2000/XP: A top-level window created with this style does not become the foreground window when the user clicks it. The system does not bring this window to the foreground when the user minimizes or closes the foreground window.<br />
      To activate the window, use the SetActiveWindow or SetForegroundWindow function.<br />
      <br />
      The window does not appear on the taskbar by default. To force the window to appear on the taskbar, use the WS_EX_APPWINDOW style.<br />
      <br />
      -Stu</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
      <span class="post-time small text-muted">9th August 2003 15:49 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">You have to call it in .onGUIInit or it won't take affect. The code is:<br />
      <br /></p>

      <blockquote>
        !define GWL_EXSTYLE -20<br />
        !define WS_EX_APPWINDOW 0x040000<br />
        !define WS_EX_TOOLWINDOW 0x000080<br />
        <br />
        Function .onGUIInit<br />
        System::Call "user32::GetWindowLongA(i $HWNDPARENT, i ${GWL_EXSTYLE}) i .s"<br />
        Pop $1<br />
        IntOp $2 ${WS_EX_APPWINDOW} ~<br />
        IntOp $1 $1 &amp; $2<br />
        IntOp $1 $1 | ${WS_EX_TOOLWINDOW}<br />
        System::Call "user32::SetWindowLongA(i $HWNDPARENT, i ${GWL_EXSTYLE}, i r1)"<br />
        FunctionEnd
      </blockquote>There are some problems with this. It won't show on the alt+tab window and the window itself becomes distorted. Try editing the UI and add those styles to it, it should at least help with the the distortion.
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
      <span class="post-time small text-muted">9th August 2003 17:18 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Yikes, I knew it wouldn't be that simple :(<br />
      <br />
      Thanks, it works perfect (on WinXP)<br />
      I've added the styles to the ui too.<br />
      <br />
      It's good that it doesn't show in Alt+Tab too, because my installer is executing this dialog with ExecWait anyway.<br />
      <br />
      -Stu</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">tarwal2</span><br />
      <span class="post-time small text-muted">19th August 2003 21:28 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">I used a different (slightly easier) approach to this same problem.<br />
      <br />
      Basically I moved all of the content from my main install section to the GUIInit function and then changed my main install section to a single line reading: "SetAutoClose true".<br />
      <br />
      I never see the installation window and everything works perfectly :)</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
      <span class="post-time small text-muted">20th August 2003 14:26 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Shouldn't you have placed it all in onInit?<br />
      <br />
      -Stu</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">tarwal2</span><br />
      <span class="post-time small text-muted">20th August 2003 16:11 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">I don't think $HWNDPARENT works properly in .onInit...althought it might work. Since I'm trying to use a tray icon in my setup I assumed I would have the problem where the tray icon disappears where you mouse over it unless I put all of the stuff in my GUIInit function.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
      <span class="post-time small text-muted">20th August 2003 16:24 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Oh ok, when you said installing files, that's different.<br />
      Yes, $HWNDPARENT only exists onGUIInit, and not onInit.<br />
      <br />
      -Stu</p>
    </div>
    <hr />

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]>
  </script>
</body>
</html>
