<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="Latency period at the execution" />

  <title>Latency period at the execution - NSIS Forums</title>
  <script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script>
  <!-- Bootstrap core CSS -->

  <link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css" />
  <link rel="stylesheet" href="../css/style.css" type="text/css" /><!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!--[if lt IE 9]>
                <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
                <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->
</head>

<body>
  <div class="container">
    <!-- Put navigation bar here -->

    <ol class="breadcrumb">
      <li><a href="../index.html" class="glyphicon glyphicon-home"></a></li>

      <li><a href="f-65.html">NSIS Discussion</a></li>

      <li class="active">Latency period at the execution</li>
    </ol>

    <p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=294847">Latency period at the execution</a></p><br />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Corpio</span><br />
      <span class="post-time small text-muted">21st July 2008 10:40 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>Latency period at the execution</strong><br />
      Hello,<br />
      <br />
      I have an important latency period between the installer execution and the first page display. So users can believe the installer is not running during this period !!!<br />
      <br />
      An automatic message should be displayed to inform users of the "verifying package" and "unpacking data" ??????<br />
      Yes : Why it is not displayed ??<br />
      No : How can I display these messages ??<br />
      <br />
      Thanks.<br />
      <br />
      PS: I don't use MUI.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">LoRd_MuldeR</span><br />
      <span class="post-time small text-muted">21st July 2008 11:20 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Reserve all Plugin DLL's and all other files that are extracted during the initialization of your installer and the the "latency period" should be gone. Use the ReserveFile instruction at the top of your script...</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Corpio</span><br />
      <span class="post-time small text-muted">21st July 2008 13:38 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Thanks LoRd_MuldeR, I thought also about this solution so I apply it and the latency period is now correct.<br />
      But I don't understand why I had not the messages "<i>verifying package: ??%</i>" and "<i>unpacking data: ??%</i>" at the beginning whereas they have to be displayed automatically (when these tasks are too long) !!</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Corpio</span><br />
      <span class="post-time small text-muted">21st July 2008 14:08 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">I have an other problem !!!!<br />
      Using the function <i>ReserveFile</i>, the latency period is now correct ... at the installer execution but now I have a latency period between a <i>components</i> page and a <i>custom</i> page (using <i>nsDialogs</i> plugin) !!!!!</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">LoRd_MuldeR</span><br />
      <span class="post-time small text-muted">21st July 2008 14:16 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Are you sure the "nsDialogs" plugin DLL and all files required to display the page are reserved as well? You should reserve those files right after the files required for initialization. Then the delay should be gone...</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Corpio</span><br />
      <span class="post-time small text-muted">21st July 2008 15:11 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">I have different situations depending on reservations done.<br />
      <br />
      All plugins and images reserved :<br />
      =&gt; latency period between the <i>components</i> page and a <i>custom</i> page<br />
      <br />
      All plugins reserved (no images reserved) :<br />
      =&gt; latency period between the language selection and the first page (a <i>custom</i> page)<br />
      <br />
      All images reserved (no plugins reserved)<br />
      Or No plugins and no images reserved<br />
      =&gt; latency period at the installer execution (before the language selection)</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">LoRd_MuldeR</span><br />
      <span class="post-time small text-muted">21st July 2008 15:18 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"></p>

      <blockquote>
        <i>Originally posted by Corpio</i><br />
        <b>All plugins and images reserved :<br />
        =&gt; latency period between the <i>components</i> page and a <i>custom</i> page</b>
      </blockquote>Obviously you forgot something or you reserved in a sub-optimal order...<br />
      <br />
      (...or it's already as fast as it can be)
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Corpio</span><br />
      <span class="post-time small text-muted">21st July 2008 15:29 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Have you an exemple of a sub-optimal order ?</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">LoRd_MuldeR</span><br />
      <span class="post-time small text-muted">21st July 2008 15:37 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"></p>
      <pre>
<code>ReserveFile "Data\VeryLargeFile.dat"<br />ReserveFile "Installer\CustomPage.ini"<br /><br />Section<br />  SetOutPath $INSTDIR<br />  File "Data\VeryLargeFile.dat"<br />SectionEnd<br /><br />Function .onInit<br />  InitPluginsDir<br />  File /oname=$PLUGINSDIR\page.ini "Installer\CustomPage.ini"<br />FunctionEnd</code>
</pre>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Corpio</span><br />
      <span class="post-time small text-muted">21st July 2008 15:45 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">The problem here is the reservations order, the file <i>"Data\VeryLargeFile.dat"</i> has to be reserved in last !!<br />
      But why ????<br />
      - because we use it before the other<br />
      - because it is the biggest</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">LoRd_MuldeR</span><br />
      <span class="post-time small text-muted">21st July 2008 15:54 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Because files are added to the "data block" of the installer in the same order they appear in the script. The .onInit function is called on initialization of the installer, but in the script it appears last. Normally "CustomPage.ini" would be added <i>last</i> to the data block, although we want it to be at the very beginning of the data block! ReserveFile can be used to workaround that problem. But only when used in the correct place and in a correct order. The earlier you access a file <i>at runtime</i>, the more we want to have that file at the beginning of the data block. In my example I reserved "VeryLargeFile.dat" <i>before</i> "CustomPage.ini", which is a bad idea, obviously! Of course you cannot have all files at the very beginning, but usually Plugin DLL's as well as other resources required for initialization and custom pages should be reserved. Again in the order they are accessed (extracted) at runtime! Reserving files that are only extracted in a "normal" section should not be reserved, normally. Also reserving "big" files <i>before</i> other files might destroy the efficiency of ReserveFile, so better limit it to "small" files...</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Corpio</span><br />
      <span class="post-time small text-muted">22nd July 2008 15:28 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Now I think I have understand how it works but I don't find a solution. I tried to reserve all files or comment a part of my code but I have always a latency period somewhere.<br />
      <br />
      No <i>ReserveFile</i><br />
      =&gt; latency period between the installer execution and the language selection<br />
      <br />
      <i>ReserveFile "LangDLL.dll"</i><br />
      =&gt; latency period between the language selection and the <i>custom</i> welcome page<br />
      <br />
      <i>ReserveFile "LangDLL.dll"<br />
      ReserveFile "nsDialogs.dll"<br />
      ReserveFile "background.bmp"</i><br />
      =&gt; latency period between the <i>components</i> page and a <i>custom</i> page with <i>RadioButton</i>s and a <i>FileRequest</i> created with nsDialogs<br />
      <br />
      If I comment my <i>RadioButton</i>s<br />
      =&gt; latency period on click on the <i>BrowseButton</i><br />
      <br />
      I use no other plugins (except in <i>Section</i>s), no other images, no INI files ... So I don't know what to do !!!</p>
    </div>
    <hr />

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]>
  </script>
</body>
</html>
