<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="description" content="Looking for a Font installation example"><title>Looking for a Font installation example - NSIS Forums</title><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script><link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css"><link rel="stylesheet" href="../css/style.css" type="text/css"><!--[if lt IE 9]><script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script><script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script><![endif]--></head><body><div class="container"><ol class="breadcrumb"><li><a href="../index.html" class="glyphicon glyphicon-home"></a></li><li><a href="f-65.html">NSIS Discussion</a></li><li class="active">Looking for a Font installation example</li></ol><p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=172162">Looking for a Font installation example</a></p><br><div class="post"><p class="post-meta"><span class="post-author text-primary">Cecilio</span><br><span class="post-time small text-muted">5th March 2004 16:58 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>Looking for a Font installation example</strong><br>Could any one give me an example of installing a font using the Vytautas scripts FontName.nsh &amp; FontReg.nsh ?<br><br>I'm trying this code:<br><br></p><blockquote>InstalarFont:<br>ClearErrors<br>StrCpy $FONT_DIR $FONTS<br>!insertmacro InstallTTFFont '..\Fonts\LeMusNot.ttf'<br>SendMessage ${HWND_BROADCAST} ${WM_FONTCHANGE} 0 0 /TIMEOUT=5000<br>IfErrors +1 FinInstalarFont<br>MessageBox MB_RETRYCANCEL|MB_ICONEXCLAMATION $(ERROR_InstalarFont) IDRETRY InstalarFont<br>MessageBox MB_YESNO|MB_ICONQUESTION $(MSG_CONTINUE) IDYES +2<br>Abort "$(MSG_ABORT)"<br>FinInstalarFont:</blockquote>But I'm getting errors in compilation. Any suggestion?<br><br>Thank you very much</div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">apollo51</span><br><span class="post-time small text-muted">5th March 2004 20:27 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Did you check these already?<br><a href="http://nsis.sourceforge.net/archive/viewpage.php?pageid=392" target="_blank">http://nsis.sourceforge.net/archive/...php?pageid=392</a><br><a href="http://nsis.sourceforge.net/archive/viewpage.php?pageid=400" target="_blank">http://nsis.sourceforge.net/archive/...php?pageid=400</a></p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Cecilio</span><br><span class="post-time small text-muted">6th March 2004 16:31 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Yes, thank you. I did checked both pages. In fact I took the macros from there. But I am having problems using them and I do not know how to continue.<br><br>My problem is that in compilation, I get the following messages:<br><br></p><blockquote>[SMALL]!insertmacro: InstallTTFFont<br>Push: $R0<br>Push: $R1<br>Push: $R2<br>!define: "Index"="Line215.5"<br>SetOutPath: "$FONT_DIR"<br>IfFileExists: "$FONT_DIR\..\Fonts\LeMusNot.ttf" ? Line215.5 :<br>File: "LeMusNot.ttf" 17192 bytes<br>ReadRegStr $R0 HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\CurrentVersion<br>IfErrors ?Line215.5-9x:Line215.5-NT<br>StrCpy $R1 "Software\Microsoft\Windows NT\CurrentVersion\Fonts" () ()<br>Goto: Line215.5-GO<br>StrCpy $R1 "Software\Microsoft\Windows\CurrentVersion\Fonts" () ()<br>Goto: Line215.5-GO<br>ClearErrors<br>!insertmacro: FontName<br>Push: $FONT_DIR\..\Fonts\LeMusNot.ttf<br>Call "TranslateFontName"<br>Invalid command: FontName::Name<br>Error in macro FontName on macroline 3<br>Error in macro InstallTTFFont on macroline 25<br>Error in script "C:\LenMus\LenMus\Instalacion\Instalar.nsi" on line 215 -- aborting creation process<br>[/SMALL]</blockquote>And I don't know how to debug this. Line 3 of macro FontName is this:<br>Fontname::Name<br><br>I supose it is a call to the Name function in FontName.dll plugin but I do not know either how to continue nor what to do. Thas's why I was trying to find a full example, to try to find differences from my code.<br><br>Thank you anyway.</div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">kichik</span><br><span class="post-time small text-muted">6th March 2004 18:51 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Put the FontName plug-in in the Plugins directory.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Cecilio</span><br><span class="post-time small text-muted">6th March 2004 20:45 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Thank you very much. But I already did put the file FontName.dll in the plugins directory. Should I put any thing else there or do something to register this dll?<br><br>Also there are two includes in my source file:<br>!include "FontReg.nsh"<br>!include "FontName.nsh"<br>Both files are in the NSIS\include directory<br><br>Thank you.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Joost Verburg</span><br><span class="post-time small text-muted">6th March 2004 21:51 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">You can also use the code in this topic (standard System plug-in):<br><br><a href="http://forums.winamp.com/showthread.php?s=&amp;threadid=137726&amp;highlight=register+font" target="_blank">http://forums.winamp.com/showthread....=register+font</a></p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">kichik</span><br><span class="post-time small text-muted">6th March 2004 22:04 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">If "FontName::Name" is an invalid command you've put it in the wrong place or put the wrong file. Put FontName.dll in the Plugins directory where NSISdl.dll, System.dll and BgImage.dll are. Make sure it is named FontName.dll.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Cecilio</span><br><span class="post-time small text-muted">7th March 2004 12:18 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Thank you very much for your answers.<br><br>To Joost Verburg: I tested the code taken from an example found in the forum. The example was named "main menu.nsi" (Sorry, I can't find the page from where I downloaded it). It works OK.<br>But I was looking for a more modular and robust solution that could be maintained in the future as part of the NSIS core. That's why I was trying to use the Vytautas macros.<br>Thank you anyway for your suggestion. And thank you very much for MUI and all your good work.<br><br>To kichik: The dll is in the right place. I will download a new version of the dll and re-check everything. I will tell you later. Thank you very much for your help.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Cecilio</span><br><span class="post-time small text-muted">7th March 2004 12:42 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">I downloaded again the FontName plugin (version 0.6) and re-checked. The same problem. By the way, I sent to Vitautas the spanish translation to be incorporated to the macro. Here it is just in case any one needs it:<br></p><pre>
<code><br>  StrCmp $LANGUAGE 1034 0 End-1034 ; Spanish (traditional) <br>    Push "Versión del font incorrecta"<br>    Push "Error de dirección de archivo mapeado: %u"<br>    Push "Error de archivo mapeado: %u"<br>    Push "Tamaño de archivo erroneo: %u"<br>    Push "Manipulador de archivo erroneo: %u"<br>    Push "Plugin de NSIS para FontName %s "<br>    goto ${Index}<br>  End-1034:<br></code>
</pre>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Joost Verburg</span><br>
      <span class="post-time small text-muted">7th March 2004 12:44 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Is the FontName plug-in listed in the compiler output (at the beginning)?<br>
      <br>
      You can also put the other code that uses the System plug-in in a macro.</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Cecilio</span><br>
      <span class="post-time small text-muted">7th March 2004 13:58 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Yes, but they appears as follows:<br></p>

      <blockquote>
        ...<br>
        - Dialer::AutodialUnattended<br>
        - Dialer::GetConnectedState<br>
        - VPatch::vpatchfile<br>
        - FontName.DLL::name<br>
        - FontName.DLL::version
      </blockquote>umh! is it right to be "FontNAme.DLL::name" instead of "FontName::Name?
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Cecilio</span><br>
      <span class="post-time small text-muted">7th March 2004 14:42 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">The cause of the problem is found. The FonName-0.6.exe installer installs the "FontName.dll" as "FontName.DLL" (upper case extention). Somehow the extention ".DLL" is not interpreted correctly and it is assumed the name "FontName.DLL.dll". Changing the extention to lower case ".dll" fixes "my" problem (not the deeper problem).<br>
      <br>
      Thank you very very much for all your help. I appreciate it very much.<br>
      <br>
      I will send a message to Vytatutas to keep him informed about all this.<br>
      <br>
      Thank you everybody again. Kind regards.</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Vytautas</span><br>
      <span class="post-time small text-muted">8th March 2004 03:13 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Thanks cecilio for spotting that error. I will upload the fix installer later today, don't have the files on this PC. :) Also I will include the Spanish tyranslation you provided in the PM.<br>
      <br>
      Although I think it would be a good idea to fix this plugin detection error in NSIS code as well. ;)<br>
      <br>
      Vytautas</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br>
      <span class="post-time small text-muted">11th March 2004 19:33 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Fixed in latest CVS version.</p>
    </div>
    <hr>

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]></script></body></html>