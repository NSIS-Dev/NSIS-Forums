<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="description" content="Install without triggering UAC?"><title>Install without triggering UAC? - NSIS Forums</title><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script><link rel="preload" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css" as="style" onload="this.rel='stylesheet'"><link rel="preload" href="../css/style.css" as="style" onload="this.rel='stylesheet'"><noscript><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css"><link rel="stylesheet" href="../css/style.css"></noscript><script>!function(a){"use strict";var b=function(b,c,d){function e(a){return h.body?a():void setTimeout(function(){e(a)})}function f(){i.addEventListener&&i.removeEventListener("load",f),i.media=d||"all"}var g,h=a.document,i=h.createElement("link");if(c)g=c;else{var j=(h.body||h.getElementsByTagName("head")[0]).childNodes;g=j[j.length-1]}var k=h.styleSheets;i.rel="stylesheet",i.href=b,i.media="only x",e(function(){g.parentNode.insertBefore(i,c?g:g.nextSibling)});var l=function(a){for(var b=i.href,c=k.length;c--;)if(k[c].href===b)return a();setTimeout(function(){l(a)})};return i.addEventListener&&i.addEventListener("load",f),i.onloadcssdefined=l,l(f),i};"undefined"!=typeof exports?exports.loadCSS=b:a.loadCSS=b}("undefined"!=typeof global?global:this);!function(a){if(a.loadCSS){var b=loadCSS.relpreload={};if(b.support=function(){try{return a.document.createElement("link").relList.supports("preload")}catch(b){return!1}},b.poly=function(){for(var b=a.document.getElementsByTagName("link"),c=0;c<b.length;c++){var d=b[c];"preload"===d.rel&&"style"===d.getAttribute("as")&&(a.loadCSS(d.href,d,d.getAttribute("media")),d.rel=null)}},!b.support()){b.poly();var c=a.setInterval(b.poly,300);a.addEventListener&&a.addEventListener("load",function(){b.poly(),a.clearInterval(c)}),a.attachEvent&&a.attachEvent("onload",function(){a.clearInterval(c)})}}}(this);</script></head><body><div class="container"><ol class="breadcrumb"><li><a href="../index.html" class="glyphicon glyphicon-home"></a></li><li><a href="f-65.html">NSIS Discussion</a></li><li class="active">Install without triggering UAC?</li></ol><p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=293908">Install without triggering UAC?</a></p><br><div class="post"><p class="post-meta"><span class="post-author text-primary">Spilly</span><br><span class="post-time small text-muted">2nd July 2008 17:54 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>Install without triggering UAC?</strong><br>Hey guys,<br>I'm guessing the answer is no, but is it possible to install a file in Vista, without triggering the UAC, if ran by an application that has already been given permission through the UAC?<br><br>For instance, App1 triggers an event which requires an install of a certain library, which should be invisible to the user. It's downloaded and installed in the background, with the user notified that they are ready to use the feature they want.<br><br>If there's a solution outside of NSIS you can point me to, that might work as well.<br><br>Thanks!</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Comperio</span><br><span class="post-time small text-muted">2nd July 2008 21:29 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">hmm...<br>Seems that RequestExecutionLevel should maybe offer a choice of "asInvoker". You might want to submit a <a href="http://sourceforge.net/tracker/?group_id=22049&amp;atid=373088" target="_blank">feature request</a> for this.<br><br>The only other way I would know how would be to somehow edit the embedded manifest of the compiled installation. Unfortunately, I have not been able to come up with any tool that helps you do that.<br><br>(Or, if your EXE doesn't require admin, then you could set ReqestExecutionLevel to "user". (Or you could use "highest", but that would still trigger the UAC prompt if the user were part of the admin group.)</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">pengyou</span><br><span class="post-time small text-muted">2nd July 2008 21:55 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"></p><blockquote>Seems that RequestExecutionLevel should maybe offer a choice of "asInvoker". You might want to submit a feature request for this.</blockquote>There is no need for a feature request:<br><br>"RequestExecutionLevel user" actually inserts "asInvoker" in the manifest.</div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Comperio</span><br><span class="post-time small text-muted">2nd July 2008 22:54 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">ahh... Clever... That's good info, pengyou!<br>(This fact should be documented, but I didn't see it. Alas, that's probably another topic...)<br><br>@Spilly:<br>After I thought about your first post, I came up with some other points:</p><ul><li>I assume you when you say you have already given permission, you mean that have been elevated to admin correct? If so, then whatever you launch with said application should inherit the permissions. (At least that's what I understand of how UAC works.)<br></li><li>An exception to the above statement might be that if said application has it's own manifest that starts as a normal user and then tries to do some type of admin process, then it may try to prompt again for permission. In that case, the only thing I can think of is to contact the author of said application to fix their code. (or there might be a tool out there that lets you "hack" the embedded manifest.)<br></li><li>If the said application is one created with NSIS, then just add <b><i>RequestExecutionLevel user</i></b> to force it to use <i>asInvoker</i> (which should guarantee the behavior you desire.)</li></ul>Hopefully, I made that clear as mud... ;)</div><hr><div class="footer"><p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p></div></div><script src="../js/highlight.pack.js" type="text/javascript"></script><script type="text/javascript">//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]></script></body></html>