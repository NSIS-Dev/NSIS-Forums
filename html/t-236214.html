<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="description" content="Codec pack installer?"><title>Codec pack installer? - NSIS Forums</title><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script><link rel="preload" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css" as="style" onload="this.rel='stylesheet'"><link rel="preload" href="../css/style.css" as="style" onload="this.rel='stylesheet'"><noscript><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css"><link rel="stylesheet" href="../css/style.css"></noscript><script>!function(a){"use strict";var b=function(b,c,d){function e(a){return h.body?a():void setTimeout(function(){e(a)})}function f(){i.addEventListener&&i.removeEventListener("load",f),i.media=d||"all"}var g,h=a.document,i=h.createElement("link");if(c)g=c;else{var j=(h.body||h.getElementsByTagName("head")[0]).childNodes;g=j[j.length-1]}var k=h.styleSheets;i.rel="stylesheet",i.href=b,i.media="only x",e(function(){g.parentNode.insertBefore(i,c?g:g.nextSibling)});var l=function(a){for(var b=i.href,c=k.length;c--;)if(k[c].href===b)return a();setTimeout(function(){l(a)})};return i.addEventListener&&i.addEventListener("load",f),i.onloadcssdefined=l,l(f),i};"undefined"!=typeof exports?exports.loadCSS=b:a.loadCSS=b}("undefined"!=typeof global?global:this);!function(a){if(a.loadCSS){var b=loadCSS.relpreload={};if(b.support=function(){try{return a.document.createElement("link").relList.supports("preload")}catch(b){return!1}},b.poly=function(){for(var b=a.document.getElementsByTagName("link"),c=0;c<b.length;c++){var d=b[c];"preload"===d.rel&&"style"===d.getAttribute("as")&&(a.loadCSS(d.href,d,d.getAttribute("media")),d.rel=null)}},!b.support()){b.poly();var c=a.setInterval(b.poly,300);a.addEventListener&&a.addEventListener("load",function(){b.poly(),a.clearInterval(c)}),a.attachEvent&&a.attachEvent("onload",function(){a.clearInterval(c)})}}}(this);</script></head><body><div class="container"><ol class="breadcrumb"><li><a href="../index.html" class="glyphicon glyphicon-home"></a></li><li><a href="f-65.html">NSIS Discussion</a></li><li class="active">Codec pack installer?</li></ol><p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=236214">Codec pack installer?</a></p><br><div class="post"><p class="post-meta"><span class="post-author text-primary">Nabukodonosor</span><br><span class="post-time small text-muted">23rd January 2006 13:48 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>Codec pack installer?</strong><br>Ok, here the idea. You can see the picture bellow. First 3 items are irrelevant. The Graphs item is the issue. It should extract graph files for the applications MyTheatre, ProgDVB and Skyview. So, when I select ProgDVB and BlazeVideo codec for example, when I click on the Install button bellow, I should be asked for the ProgDVB plugins folder so the installation can extract graph files there. If I choose both ProgDVB and MyTheatre for example, I should be asked for plugins folder for both the ProgDVB AND MyTheatre.<br><br>Just to mention, the first 3 items go to my $INSTDIR, i.e. C:\Program Files\My codec pack\. So this goes here, a for the graphs items I need to choose the location.<br><br>How to do this?<br><br><a href="http://img63.imageshack.us/img63/2748/pack7il.jpg" target="_blank">http://img63.imageshack.us/img63/2748/pack7il.jpg</a></p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Comm@nder21</span><br><span class="post-time small text-muted">23rd January 2006 13:57 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">add a userpage with all needed directory requests, and enable/disable them depending on the selection.<br>you can do this in the SHOW function of the custom page.<br><br>see modernui readme and installoptions readme for details about creating custom pages with modern ui.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Nabukodonosor</span><br><span class="post-time small text-muted">23rd January 2006 14:34 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">OK, i'll try to make this right. Thanks m8!</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Nabukodonosor</span><br><span class="post-time small text-muted">23rd January 2006 16:17 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">OK, here's the thing. I don't know where to start with questions.<br>1. On the picture bellow you can see that when I select some random way installation folder (C:\1) it adds the Nabukodonosor's DVB pack on it. And i don't want that. Here is my part of the script for that thing:<br><br></p><pre>
<code>Section "BlazeVideo/Moonlight/Overlay" SEC55<br>  SetOutPath "$INSTDIR"<br>  File "Graphs\ProgDVB\tv.blazevideo.xgr"<br>SectionEnd</code>
</pre><br>
      <br>
      How to avoid this addon?<br>
      <br>
      2.On the first picture, I want to install first 3 items in the exactly specified folder (C:\Program Files\Nabukodonosor's DVB Pack). But when I select the installation folder for my graph files (2nd picture), my first 3 item ALSO ectract in the selected folder. And I don't want that either. So, my scipt for that right now is like this:<br>
      <pre>
<code>Section "Blaze Video Decoder 4.5.0.2" SEC02<br>  SetOutPath "$INSTDIR\Video\Blaze Video Decoder 4.5.0.2"<br>  File "Video\Blaze Video Decoder 4.5.0.2\Blaze VideoDecoder.ax"<br>SectionEnd</code>
</pre><br>
      <br>
      So, I assume I need to change that $INSTDIR into absolute address like C:\Program Files\Nabukodonosor's DVB Pack? Is that right? Is there any other way?<br>
      <br>
      3. Can you explain me the enable/disable thing you've mentioned? I can't figure that out.<br>
      <br>
      <br>
      <br>
      <br>
      <a href="http://img370.imageshack.us/img370/9981/pack26na.jpg" target="_blank">http://img370.imageshack.us/img370/9981/pack26na.jpg</a>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Nabukodonosor</span><br>
      <span class="post-time small text-muted">24th January 2006 13:05 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Anyone?</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br>
      <span class="post-time small text-muted">24th January 2006 18:31 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Add a backslash to InstallDir. Read about InstallDir in the documentation for more information.</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Nabukodonosor</span><br>
      <span class="post-time small text-muted">24th January 2006 20:39 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">I've solved that. Thanks for the solution. I've also solved 2nd problem. What about the 3rd question?</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Nabukodonosor</span><br>
      <span class="post-time small text-muted">24th January 2006 20:46 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">One more thing. For example I know that $PROGRAMFILES is C:\Program files. But how to specify only C:\? I want to extract something in f.a. C:\folder1, but what if someone doesn't have C:\ but D:\ or even E:\??? I've solved a similar problem with C:\Program files\some folder with changing it to $PROGRAMFILES\some folder. How to do this with C:\some folder? WHats the equivalent for root folder?</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Comm@nder21</span><br>
      <span class="post-time small text-muted">24th January 2006 22:42 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">nothing.<br>
      <br>
      use this one:<br>
      <br>
      Var /GLOBAL ROOT<br>
      StrCpy $ROOT $PROGRAMFILES 0 3<br>
      <br>
      $ROOT is now C:\ or D:\ or whatever ...<br>
      <br>
      btw: thanx that you take care of this case!<br>
      most software companies don't. some even hardcode "C:\Program Files" and destroy e.g. german file structures ("C:\Programme" by default) with such behaviours.</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Nabukodonosor</span><br>
      <span class="post-time small text-muted">24th January 2006 23:24 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Can you PLEASE explain to me how to do that thing in your first message? The thing with 3 directory selection. I'm stuck with that!</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Comm@nder21</span><br>
      <span class="post-time small text-muted">25th January 2006 13:27 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">!define MUI_PAGE_CUSTOMFUNCTION_PRE "function1"<br>
      !insertmacro MUI_PAGE_DIRECTORY<br>
      !define MUI_PAGE_CUSTOMFUNCTION_PRE "function2"<br>
      !insertmacro MUI_PAGE_DIRECTORY<br>
      !define MUI_PAGE_CUSTOMFUNCTION_PRE "function3"<br>
      !insertmacro MUI_PAGE_DIRECTORY<br>
      <br>
      :)</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Nabukodonosor</span><br>
      <span class="post-time small text-muted">25th January 2006 16:03 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">OK, i'll try this. Thanks.</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Nabukodonosor</span><br>
      <span class="post-time small text-muted">25th January 2006 17:18 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">That didn't help me. I'm 5 days in all this, so a need more help. :-( I tried with this article:<br>
      <a href="http://nsis.sourceforge.net/Two_installations_in_one_installer" target="_blank">http://nsis.sourceforge.net/Two_inst..._one_installer</a><br>
      but it's for two installations and I need for 3. Also it has one section that's bad for my project:<br>
      ## Also if no sections are selected, warn the user!<br>
      <br>
      I've tried to delete that section, but then I got error after error.<br>
      Can someone please adapt this code for 3 installation and without this last thing? Or at least explain to me how to do it step by step. There's no other way for me. All the other work is over, only this thing to finish and it's all over. Please guys!</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Nabukodonosor</span><br>
      <span class="post-time small text-muted">25th January 2006 19:23 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">OK, i've pulled it off, with the script above, just modified it. BUT, there is a problem. It extracts the Skyview graphs (see the 1st picture) in all 3 folders. I've must mistaken somewhere in the loop. Here's the script (only relevant part):<br>
      <br></p>
      <pre>
<code>## Create $PLUGINSDIR<br>Function .onInit2<br> InitPluginsDir<br>FunctionEnd<br><br>Function IsPROG1Selected<br>Push $R0<br>Push $R1<br><br> StrCpy $R0 ${PROG1_StartIndex} # Group 1 start<br><br>  Loop:<br>   IntOp $R0 $R0 + 1<br>   SectionGetFlags $R0 $R1                      # Get section flags<br>    IntOp $R1 $R1 &amp; ${SF_SELECTED}<br>    StrCmp $R1 ${SF_SELECTED} 0 +3              # If section is selected, done<br>     StrCpy $R0 1<br>     Goto Done<br>    StrCmp $R0 ${PROG1_EndIndex} 0 Loop<br><br> Done:<br>Pop $R1<br>Exch $R0<br>FunctionEnd<br><br>Function IsPROG2Selected<br>Push $R0<br>Push $R1<br><br> StrCpy $R0 ${PROG2_StartIndex}    # Group 2 start<br><br>  Loop:<br>   IntOp $R0 $R0 + 1<br>   SectionGetFlags $R0 $R1                      # Get section flags<br>    IntOp $R1 $R1 &amp; ${SF_SELECTED}<br>    StrCmp $R1 ${SF_SELECTED} 0 +3              # If section is selected, done<br>     StrCpy $R0 1<br>     Goto Done<br>    StrCmp $R0 ${PROG2_EndIndex} 0 Loop<br><br> Done:<br>Pop $R1<br>Exch $R0<br>FunctionEnd<br><br>Function IsPROG3Selected<br>Push $R0<br>Push $R1<br><br> StrCpy $R0 ${PROG3_StartIndex} # Group 3 start<br><br>  Loop:<br>   IntOp $R0 $R0 + 1<br>   SectionGetFlags $R0 $R1                      # Get section flags<br>    IntOp $R1 $R1 &amp; ${SF_SELECTED}<br>    StrCmp $R1 ${SF_SELECTED} 0 +3              # If section is selected, done<br>     StrCpy $R0 1<br>     Goto Done<br>    StrCmp $R0 ${PROG3_EndIndex} 0 Loop<br><br> Done:<br>Pop $R1<br>Exch $R0<br>FunctionEnd<br><br>## Here we are selecting first sections to install<br>## by unselecting all the others!<br>Function SelectFilesA<br><br> # We need to save the state of the Group 2 Sections<br> # for the next InstFiles page<br>Push $R0<br>Push $R1<br><br> StrCpy $R0 ${PROG2_StartIndex} # Group 2 start<br><br>  Loop:<br>   IntOp $R0 $R0 + 1<br>   SectionGetFlags $R0 $R1                                  # Get section flags<br>    WriteINIStr "$PLUGINSDIR\sections.ini" Sections $R0 $R1 # Save state<br>    !insertmacro UnselectSection $R0                        # Then unselect it<br>    StrCmp $R0 ${PROG2_EndIndex} 0 Loop<br><br> # Don't install prog 1?<br> Call IsPROG1Selected<br> Pop $R0<br> StrCmp $R0 1 +4<br>  Pop $R1<br>  Pop $R0<br>  Abort<br><br> # Set current $INSTDIR to PROG1_InstDir define<br> StrCpy $INSTDIR "${PROG1_InstDir}"<br><br>Pop $R1<br>Pop $R0<br>FunctionEnd<br><br>## Here we need to unselect all Group 1 sections<br>## and then re-select those in Group 2 (that the user had selected on<br>## Components page)<br>Function SelectFilesB<br>Push $R0<br>Push $R1<br><br> StrCpy $R0 ${PROG1_StartIndex}    # Group 1 start<br><br>  Loop:<br>   IntOp $R0 $R0 + 1<br>    !insertmacro UnselectSection $R0            # Unselect it<br>    StrCmp $R0 ${PROG1_EndIndex} 0 Loop<br><br> Call ResetFiles<br><br> # Don't install prog 2?<br> Call IsPROG2Selected<br> Pop $R0<br> StrCmp $R0 1 +4<br>  Pop $R1<br>  Pop $R0<br>  Abort<br><br> # Set current $INSTDIR to PROG2_InstDir define<br> StrCpy $INSTDIR "${PROG2_InstDir}"<br><br>Pop $R1<br>Pop $R0<br>FunctionEnd<br><br>## This will set all sections to how they were on the components page<br>## originally<br>Function ResetFiles<br>Push $R0<br>Push $R1<br><br> StrCpy $R0 ${PROG2_StartIndex}    # Group 2 start<br><br>  Loop:<br>   IntOp $R0 $R0 + 1<br>   ReadINIStr "$R1" "$PLUGINSDIR\sections.ini" Sections $R0 # Get sec flags<br>    SectionSetFlags $R0 $R1                               # Re-set flags for this sec<br>    StrCmp $R0 ${PROG2_EndIndex} 0 Loop<br><br>Pop $R1<br>Pop $R0<br>FunctionEnd<br><br>Function SelectFilesC<br><br> # We need to save the state of the Group 3 Sections<br> # for the next InstFiles page<br>Push $R0<br>Push $R1<br><br> StrCpy $R0 ${PROG2_StartIndex} # Group 3 start<br><br>  Loop:<br>   IntOp $R0 $R0 + 1<br>   SectionGetFlags $R0 $R1                                  # Get section flags<br>    WriteINIStr "$PLUGINSDIR\sections.ini" Sections $R0 $R1 # Save state<br>    !insertmacro UnselectSection $R0                        # Then unselect it<br>    StrCmp $R0 ${PROG2_EndIndex} 0 Loop<br><br> # Don't install prog 3?<br> Call IsPROG3Selected<br> Pop $R0<br> StrCmp $R0 1 +4<br>  Pop $R1<br>  Pop $R0<br>  Abort<br><br> # Set current $INSTDIR to PROG1_InstDir define<br> StrCpy $INSTDIR "${PROG3_InstDir}"<br><br>Pop $R1<br>Pop $R0<br>FunctionEnd</code>
</pre><br>
      <br>
      <br>
      I can't see the problem. It's all greek to me. :D
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br>
      <span class="post-time small text-muted">26th January 2006 18:33 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">You should use the <a href="http://nsis.sourceforge.net/Docs/Chapter2.html#2.3.5.1" target="_blank">LogicLib</a> for loops, it's simpler.<br>
      <br>
      I don't see where it extract Skyview in that script. Attach the entire script or at least include the extraction code.<br>
      <br>
      Please attach large scripts next time.</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Nabukodonosor</span><br>
      <span class="post-time small text-muted">26th January 2006 22:54 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">OK, here's the entire script.</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Nabukodonosor</span><br>
      <span class="post-time small text-muted">27th January 2006 01:03 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Done it! yeah!!<br>
      <br>
      I didn't include the deselect script for the third item:<br>
      <br></p>
      <pre>
<code>StrCpy $R0 ${PROG1_StartIndex}    # Group 1 start<br><br>  Loop:<br>   IntOp $R0 $R0 + 1<br>    !insertmacro UnselectSection $R0            # Unselect it<br>    StrCmp $R0 ${PROG1_EndIndex} 0 Loop</code>
</pre>
    </div>
    <hr>

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]></script></body></html>