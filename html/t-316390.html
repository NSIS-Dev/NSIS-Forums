<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="PROGRAMFILES Windows 7" />

  <title>PROGRAMFILES Windows 7 - NSIS Forums</title>
  <script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script>
  <!-- Bootstrap core CSS -->

  <link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css" />
  <link rel="stylesheet" href="../css/style.css" type="text/css" /><!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!--[if lt IE 9]>
                <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
                <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->
</head>

<body>
  <div class="container">
    <!-- Put navigation bar here -->

    <ol class="breadcrumb">
      <li><a href="../index.html" class="glyphicon glyphicon-home"></a></li>

      <li><a href="f-65.html">NSIS Discussion</a></li>

      <li class="active">PROGRAMFILES Windows 7</li>
    </ol>

    <p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=316390">PROGRAMFILES Windows 7</a></p><br />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">reace</span><br />
      <span class="post-time small text-muted">19th January 2010 14:11 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>PROGRAMFILES Windows 7</strong><br />
      Hi all,<br />
      <br />
      I got a problem with the PROGRAMFILES folder on Windows 7 (german version).<br />
      <br />
      Windows 7 detects the variable $PROGRAMFILES as<br />
      <br />
      "C:\Program Files"<br />
      <br />
      But in Windows 7 only exists "C:\Programme" therefore the files will be installed in "C:\Programme" and not in "C:\Program Files".<br />
      <br />
      I write the path into the registry so that an external software can read the path from the entry to start it.<br />
      But because NSIS detects "Program Files" instead of the real folder "Programme" the software can't be executed. The shortcuts point to "C:\Program Files" which doesn't exist.<br />
      <br />
      Is there a way to fix that?<br />
      <br />
      Thanks for help :(</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Zinthose</span><br />
      <span class="post-time small text-muted">19th January 2010 15:20 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">AFAIK, NSIS gets the path from the %ProgramFiles% environment variable. Could your environment variables be corrupt?<br />
      <br />
      To see what current setting is, from a command prompt window, run</p>
      <pre>
<code>ECHO PROGRAMFILES=%PROGRAMFILES%</code>
</pre><br />
      <br />
      It it's wrong then something in Windows is broke.
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">CrushBug</span><br />
      <span class="post-time small text-muted">19th January 2010 17:04 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">It is important to understand that in Windows 7, if you are looking through Explorer on a non-English OS, Explorer will show you "C:\Programme" EVEN THOUGH the actual file name of the directory is "C:\Program Files" in the file system.<br />
      <br />
      To verify this, you need to use another file system browser (I would recommend Total Commander - <a href="http://www.ghisler.com/" target="_blank">http://www.ghisler.com/</a> ) and look at the root of your C: drive. You will find a hidden .ini file in the root of Program Files that will tell Explorer what name it should display instead of the actual file system name. This makes it easier for them to localize the OS without having to localize the file system. I have personally looked at French Windows 7 and I see this.<br />
      <br />
      NSIS (thankfully) will not lie to you and it will show you the factual file system names.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Anders</span><br />
      <span class="post-time small text-muted">19th January 2010 18:18 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"></p>

      <blockquote>
        <i>Originally posted by Zinthose</i><br />
        <b>AFAIK, NSIS gets the path from the %ProgramFiles% environment variable.</b>
      </blockquote>Wrong, NSIS does not use any environment variables, it only uses documented API functions like SHGet*(). The windows api to retrieve the temp dir does use %temp% internally, so that is the only one that could have a problem
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Zinthose</span><br />
      <span class="post-time small text-muted">19th January 2010 18:41 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Anders, It dose make more sense to me to use API Calls but I got the notion from somewhere.<br />
      <br />
      I dug around in the documentation and found <a href="http://nsis.sourceforge.net/Docs/Chapter3.html#3.1.3" target="_blank">3.1.3</a>. It is clearly only used to the build environment and not the installer. But likely were I got the erroneous idea... :(<br />
      <br />
      My Bad.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Anders</span><br />
      <span class="post-time small text-muted">19th January 2010 18:51 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Yes, the compiler has a couple, but that is because they SHOULD be possible to edit (and some of them are non standard with no shell constant)</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">reace</span><br />
      <span class="post-time small text-muted">22nd January 2010 13:24 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Thanks for your answers!<br />
      <br />
      @Crashbug: You are right, its easier for Microsoft, but not for me, because the program cant read the correct path ;) But thanks for the hint with total commander and the ini file!<br />
      <br />
      Well, its not that bad, I will try to avoid the use of $PROGRAMFILES for this application.<br />
      <br />
      Have a nice day!</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">CrushBug</span><br />
      <span class="post-time small text-muted">23rd January 2010 00:48 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">It's "CrushBug" =)<br />
      <br />
      The program is reading the correct path. It is not wrong. What I am trying to say is that Explorer is lying to you and not NSIS and not the file system. It also sounds like that other program is not handling the file system properly.<br />
      <br />
      I will double check one of our installers on French and see what happens because I know our stuff works.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Joel</span><br />
      <span class="post-time small text-muted">23rd January 2010 14:55 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">/* off topic */<br />
      Remove Win 7<br />
      <br />
      <br />
      I tested windows 7 and the paths displayed on nsis directory page are wrong, maybe some unfinished job, I don't know...I still use XP for testing apps.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Koopa</span><br />
      <span class="post-time small text-muted">23rd January 2010 16:16 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">CrushBug is right. The internal Windows 7 name is 'C:\Program Files', the Explorer shows 'C:\Programme' on your German system, though.<br />
      <br />
      If you install your application in the detected 'C:\Program Files' folder, it will be correctly installed in the your 'C:\Programme' folder.<br />
      <br />
      Just ignore what you see, the path will be correctly detected and after installation, you will see, that all things went well. ;)<br />
      <br />
      Joel:<br />
      <br />
      I'm not seeing any Windows 7 related path issues. All of my installers work well. For the above 'issue' you simply can ignore it, the files will be installed in the correct path, even if you'd guess, that the file path is wrong.</p>
    </div>
    <hr />

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]>
  </script>
</body>
</html>
