<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="description" content="two questions"><title>two questions - NSIS Forums</title><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script><link rel="preload" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css" as="style" onload="this.rel='stylesheet'"><link rel="preload" href="../css/style.css" as="style" onload="this.rel='stylesheet'"><noscript><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css"><link rel="stylesheet" href="../css/style.css"></noscript><script>!function(a){"use strict";var b=function(b,c,d){function e(a){return h.body?a():void setTimeout(function(){e(a)})}function f(){i.addEventListener&&i.removeEventListener("load",f),i.media=d||"all"}var g,h=a.document,i=h.createElement("link");if(c)g=c;else{var j=(h.body||h.getElementsByTagName("head")[0]).childNodes;g=j[j.length-1]}var k=h.styleSheets;i.rel="stylesheet",i.href=b,i.media="only x",e(function(){g.parentNode.insertBefore(i,c?g:g.nextSibling)});var l=function(a){for(var b=i.href,c=k.length;c--;)if(k[c].href===b)return a();setTimeout(function(){l(a)})};return i.addEventListener&&i.addEventListener("load",f),i.onloadcssdefined=l,l(f),i};"undefined"!=typeof exports?exports.loadCSS=b:a.loadCSS=b}("undefined"!=typeof global?global:this);!function(a){if(a.loadCSS){var b=loadCSS.relpreload={};if(b.support=function(){try{return a.document.createElement("link").relList.supports("preload")}catch(b){return!1}},b.poly=function(){for(var b=a.document.getElementsByTagName("link"),c=0;c<b.length;c++){var d=b[c];"preload"===d.rel&&"style"===d.getAttribute("as")&&(a.loadCSS(d.href,d,d.getAttribute("media")),d.rel=null)}},!b.support()){b.poly();var c=a.setInterval(b.poly,300);a.addEventListener&&a.addEventListener("load",function(){b.poly(),a.clearInterval(c)}),a.attachEvent&&a.attachEvent("onload",function(){a.clearInterval(c)})}}}(this);</script></head><body><div class="container"><ol class="breadcrumb"><li><a href="../index.html" class="glyphicon glyphicon-home"></a></li><li><a href="f-65.html">NSIS Discussion</a></li><li class="active">two questions</li></ol><p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=223898">two questions</a></p><br><div class="post"><p class="post-meta"><span class="post-author text-primary">mondofan</span><br><span class="post-time small text-muted">13th August 2005 19:38 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>two questions</strong><br>hi, it's me again<br>i have two questions which i haven't found answers to here<br><br>1) about the ExecShell command, i want to print a document (*.txt or *.doc), "open" works fine for viewing it, and "print" prints it. however, it immediately sends it to default printer, is there any way to display print dialog (the one where you can choose printer, settings, etc) first?<br><br>2) i have tried to do "log" textarea (similar to the one used in install dialog). i am using custom page made with installoptions and "text" item. i process list of files and i want to write some message about every single one of them upon their completion. if i do it "get whole content, add a new line and display it sending WM_SETTEXT message", it works only for small lists of files (since size of string in nsis is very limited). there must me another way - just adding a new line on bottom of the content. i remember the trick i used to do this when i played with winapi - select whole content (EM_SETSEL "0" "-1"), get selection boundaries (EM_GETSEL lower upper), select the EMPTY end of the content (EM_SETSEL upper upper) and then replace it with the text i want to add (EM_REPLACESEL "0" "new text"). the question: both setsel and replacesel messages seem to work fine in nsis, but how to tame getsel message? i cannot find a way to pass parameters to it (it should return the boundaries in it), does anyone know how can i do it?<br><br>thanks in advance</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br><span class="post-time small text-muted">13th August 2005 20:26 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">1. I think print calls notepad with the /P switch. There's also a /PT switch:<br>/PT &lt;filename&gt; &lt;printername&gt; &lt;driverdll&gt; &lt;port&gt;<br>But I don't think that'll do what you want.<br><br>2. Use the special build NSIS which has an 8192 character string length.<br><br>-Stu</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">mondofan</span><br><span class="post-time small text-muted">14th August 2005 00:01 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">thanks for reply<br>ad 1) you are right, but i'd still prefer the print dialog variant (i will continue to search)<br><br>ad 2) that might help, but there is still a limit, btw does it mean that nsis cannot handle sending messages that return some data?</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br><span class="post-time small text-muted">14th August 2005 11:33 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">If data returned with SendMessage is greater than the 8192 buffer, you'll just end up getting the rest of it cut off.<br><br>-Stu</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">mondofan</span><br><span class="post-time small text-muted">15th August 2005 07:05 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">this shouldn't be a problem, EM_GETSEL should return two numbers (ie selection range), but i don't know how to pass those parameters (SendMessage $0 ${EM_GETSEL} $1 $2 doesn't work, both $1 and $2 return without value ($0 contains HWND, that isn't problem))</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br><span class="post-time small text-muted">15th August 2005 10:38 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">I don't know why it's not working, but why not use a ListBox control instead?<br><br>-Stu</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">deguix</span><br><span class="post-time small text-muted">15th August 2005 12:50 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><i>SendMessage</i> cannot return values in the parameters of the function. Use the System plug-in to call the SendMessageA function from user32.dll.<br><br>It should be something like this:<br></p><pre>
<code>System::Call "user32::SendMessage(i,i,i,i)i (r0,${EM_GETSEL},.r1,.r2)"</code>
</pre></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">mondofan</span><br><span class="post-time small text-muted">16th August 2005 06:34 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">works perfectly, thanks deguix</p></div><hr><div class="footer"><p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p></div></div><script src="../js/highlight.pack.js" type="text/javascript"></script><script type="text/javascript">//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]></script></body></html>