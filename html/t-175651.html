<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="Driver Installation Query" />

  <title>Driver Installation Query - NSIS Forums</title>
  <script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script>
  <!-- Bootstrap core CSS -->

  <link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css" />
  <link rel="stylesheet" href="../css/style.css" type="text/css" /><!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!--[if lt IE 9]>
                <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
                <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->
</head>

<body>
  <div class="container">
    <!-- Put navigation bar here -->

    <ol class="breadcrumb">
      <li><a href="../index.html" class="glyphicon glyphicon-home"></a></li>

      <li><a href="f-65.html">NSIS Discussion</a></li>

      <li class="active">Driver Installation Query</li>
    </ol>

    <p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=175651">Driver Installation Query</a></p><br />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">ptgoel</span><br />
      <span class="post-time small text-muted">7th April 2004 08:18 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>Driver Installation Query</strong><br />
      Hi,<br />
      <br />
      i am looking forward to install my device driver along with my application. For this purpose i have written a small code(install.exe) which installs the driver via command line. e.g.<br />
      <br />
      install -i xxx<br />
      <br />
      This will install xxx driver on Windows System. i want to execute the same command while installing via package, so that user intervension is not needed.<br />
      <br />
      Does NSIS offers something like this kind of facility to execute our own command? If yes! how to do that.<br />
      <br />
      if not! can you suggest me some way of doing this.<br />
      <br />
      regards,<br />
      Aman</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Bennyyy</span><br />
      <span class="post-time small text-muted">7th April 2004 10:29 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">hi<br />
      <br />
      use this:<br />
      <br />
      nsExec::Exec "Install.exe -i XXX"</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">ptgoel</span><br />
      <span class="post-time small text-muted">8th April 2004 06:58 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Hi,<br />
      <br />
      ;install driver<br />
      nsExec::Exec "InstallVD.exe -l C:\Documents and Settings\Administrator\Desktop\VD\Driver\VD.inf -c p -i VD"<br />
      <br />
      I added this command in the code. but it is not working(on command line it works). am i supposed to specify something else too.<br />
      <br />
      rite now InstallVD.exe is in VD directory. am i supposed to put it in some other directory.<br />
      <br />
      regards</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">deguix</span><br />
      <span class="post-time small text-muted">8th April 2004 11:23 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"></p>

      <blockquote>
        but it is not working(on command line it works).
      </blockquote>So you have to put the correct location where "InstallVD.exe" is located.
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">ptgoel</span><br />
      <span class="post-time small text-muted">8th April 2004 12:42 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">done! but still not working<br />
      <br />
      This is what i did.<br />
      <br />
      nsExec::Exec "C:\InstallVD.exe -l C:\Documents and Settings\Administrator\Desktop\VD\Driver\VD.inf -c p -i VD"<br />
      <br />
      it compiles without any problem. but at installation time it doesn't work.<br />
      <br />
      regards</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Bennyyy</span><br />
      <span class="post-time small text-muted">9th April 2004 13:38 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">use this<br />
      (i found it in the nsis user manual)<br />
      <br />
      4.9.1.3 ExecShell action command [parameters][SW_SHOWNORMAL | SW_SHOWMAXIMIZED | SW_SHOWMINIMIZED]<br />
      <br />
      Execute the specified program using ShellExecute. Note that action is usually "open", "print", etc, but can be an empty string to use the default action. Parameters and the show type are optional. $OUTDIR is used for the working directory. The error flag is set if the process could not be launched.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">deguix</span><br />
      <span class="post-time small text-muted">9th April 2004 15:18 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Probably because one of the files aren't in those folders when you call this command. Use <i>IfFileExists</i> command to check if those files are in the correct locations.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">PanicMan</span><br />
      <span class="post-time small text-muted">23rd November 2004 10:47 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Does this work? If yes, can you give this exe to me? i have the same problem...</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">KenA</span><br />
      <span class="post-time small text-muted">23rd November 2004 11:26 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Hi,<br />
      <br />
      try this syntax (beware of the quotes within quotes):<br />
      <br />
      nsExec::Exec '"InstallVD.exe" -l C:\Documents and Settings\Administrator\Desktop\VD\Driver\VD.inf -c p -i VD'<br />
      <br />
      hope it helps,<br />
      <br />
      KenA</p>
    </div>
    <hr />

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]>
  </script>
</body>
</html>
