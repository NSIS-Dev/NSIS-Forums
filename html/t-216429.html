<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="Installer Checks for update using XML" />

  <title>Installer Checks for update using XML - NSIS Forums</title><!-- Bootstrap core CSS -->
  <link rel="stylesheet" type="text/css" href="//netdna.bootstrapcdn.com/bootswatch/3.0.1/readable/bootstrap.min.css" />
  <link rel="stylesheet" href="../css/style.css" type="text/css" /><!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!--[if lt IE 9]>
                <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
                <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->
</head>

<body>
  <div class="container">
    <!-- Put navigation bar here -->

    <ol class="breadcrumb">
      <li><a href="../index.html" class="glyphicon glyphicon-home"></a></li>

      <li><a href="f-65.html">NSIS Discussion</a></li>

      <li class="active">Installer Checks for update using XML</li>
    </ol>

    <p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=216429">Installer Checks for update using XML</a></p><br />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">MichaelFlya</span><br />
      <span class="post-time small text-muted">19th May 2005 10:29 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>Installer Checks for update using XML</strong><br />
      How do I use NSIS to Check for an Update using a XML File?<br /></p>
      <pre>
<code><br /><font color="blue">&lt;?xml version="1.0" encoding="ISO-8859-1" ?&gt; </font><br /><font color="red">-</font> <font color="blue">&lt;</font><font color="darkred">ProgramName</font><font color="blue">&gt;</font><br /><font color="blue">  &lt;</font><font color="darkred">version</font><font color="blue">&gt;</font><b>5.405</b><font color="blue">&lt;/</font><font color="darkred">version</font><font color="blue">&gt;</font><br />  <font color="blue">&lt;/</font><font color="darkred">ProgramName</font><font color="blue">&gt;</font><br /></code>
</pre><br />
      <br />
      <br />
      Lets just say I am Checking something that is Version 5.403<br />
      And I use the XML file above Located at a URL Link. It Tells<br />
      the Installer that the Most Recent Version is Higher than the<br />
      Version Being Installed...<br />
      <br />
      How would I go about this?<br />
      <br />
      -MichaelFlya-
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Joel</span><br />
      <span class="post-time small text-muted">19th May 2005 14:40 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">At this moment there isn't a *official* XML parser plugin for nsis, <a href="http://forums.winamp.com/showthread.php?s=&amp;threadid=210994&amp;highlight=XML" target="_blank">here</a>, <a href="http://forums.winamp.com/showthread.php?s=&amp;threadid=199405&amp;highlight=XML" target="_blank">here</a>, are some un-official plugins.<br />
      <br />
      Search the forum and you find other ways to parse a XML, although if your tree only has <b>version</b> as element, try a loop until you find it.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">MichaelFlya</span><br />
      <span class="post-time small text-muted">19th May 2005 17:45 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Thanks Joel,<br />
      <br />
      Ok to start off how do I call your XML.dll Properly to<br />
      Parse it on Node (Version) And Ask if What is Under<br />
      the Node is Greater than a Given Number, In this Case<br />
      Greater than 5.403 is 5.405, Then Take Action one<br />
      way or the other depending on if it ends up Greater or<br />
      Lesser.<br />
      <br />
      Lets start at a Line like this... Unless otherwise.<br />
      <br /></p>
      <pre>
<code><br />Parse:<br />XML::TextElementFromNode ${XMLFILE}"ProgramName" "Version"<br /></code>
</pre><br />
      <br />
      ---<br />
      Possibly if OldValue&lt;NewValue Activate "FunctionName"<br />
      Other wise Some other Function Gets Activated. Might be<br />
      A Type of Fork in the Road for me to Take an Action. Not<br />
      that any of my Examples mean anything in the way that<br />
      you do it for XML.dll.<br />
      -------<br />
      <br />
      <br />
      <br />
      I had Read those Links Already actually, I had been<br />
      Searching for a while and finally Decided to post ...<br />
      <br />
      -MichaelFlya-
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">MichaelFlya</span><br />
      <span class="post-time small text-muted">19th May 2005 20:14 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Ok well If it Can't than Perhaps Maybe It can be Done With<br />
      the one Called nsXML.dll. How would that be Done? And if not<br />
      than Where can I get the thing I am Looking for?<br />
      <br />
      -MichaelFlya-</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
      <span class="post-time small text-muted">19th May 2005 21:09 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">I used this to get text between two tags in an HTML file, so it should work here too:<br />
      <a href="http://nsis.sourceforge.net/archive/nsisweb.php?page=693&amp;instances=0,11,311" target="_blank">http://nsis.sourceforge.net/archive/...ances=0,11,311</a><br />
      <br />
      -Stu</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">MichaelFlya</span><br />
      <span class="post-time small text-muted">19th May 2005 22:06 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Afrow Uk, (About your Link)<br />
      <br />
      I Have no idea what to do with this... What to change I<br />
      mean. Also When I Get it Going to where it Grabs in this<br />
      Case in Between &lt;version&gt; &amp; &lt;/version&gt; Which Should<br />
      return 5.405, How would I say 5.403 is Less than The<br />
      text Returned.<br />
      <br />
      Than say if Text Returned is Greater than<br />
      5.403 (Call FunctionNameUPDATE) If 5.403<br />
      is just Equal to the text Returned it will<br />
      than (Call FunctionNameNOUPDATE)<br />
      <br />
      -MichaelFlya-</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">MichaelFlya</span><br />
      <span class="post-time small text-muted">19th May 2005 22:33 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Please Help me Get the Text... And if you want, Also<br />
      Please Add how to Check Version Number by Less and<br />
      Greater. That would be the next Question Anyway lol.<br />
      <br />
      Attached a Script.<br />
      <br />
      Thanks !!!<br />
      <br />
      -MichaelFlya-</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">MichaelFlya</span><br />
      <span class="post-time small text-muted">20th May 2005 00:58 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Here is the XML to go along with the NSI Script.<br />
      <br />
      -MichaelFlya-</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
      <span class="post-time small text-muted">20th May 2005 11:28 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"></p>
      <pre>
<code>${GetBetween} "&lt;version&gt;" "&lt;/version&gt;" "$INSTDIR\currentversion.xml" "$R0"<br />${VersionCompare} "$R0" "5.405" "$R0"<br />StrCmp $R0 0 0 +2<br /> MessageBox MB_OK "Versions equal" IDOK Done<br />StrCmp $R0 1 0 +2<br /> MessageBox MB_OK "Version one newer" IDOK Done<br />StrCmp $R0 2 0 +2<br /> MessageBox MB_OK "Version two newer"<br />Done:</code>
</pre><br />
      <br />
      VersionCompare: <a href="http://nsis.sourceforge.net/archive/nsisweb.php?page=759&amp;instances=0,11,122,754" target="_blank">http://nsis.sourceforge.net/archive/...s=0,11,122,754</a><br />
      <br />
      Edit: Make sure you put functions code (from archive pages) in the script before you actually use them.<br />
      <br />
      -Stu
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">MichaelFlya</span><br />
      <span class="post-time small text-muted">21st May 2005 08:05 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Thanks Afrow UK, I am Starting to Get somewhere....<br />
      <br />
      I am Still having Problems... I don't know, I have<br />
      attached what I made and Theres still a few bugs. It<br />
      seems to Never Retrieve The Value of the XML File<br />
      Correctly. So I Changed one of the Lines to test it.<br />
      <br />
      Function VersionCompare is Working Fine Using this.<br />
      <br />
      ${VersionCompare} "5.405" "5.403" "$R0"<br />
      <br />
      It also I Guess is only Checking the Last two Digits.<br />
      All I know is it Makes 5.405 More than 5.403, But if<br />
      I change 5.403 to 5.8 it is less than 5.405 For Some<br />
      Reason.<br />
      <br />
      What can be done to make it work with all Digits?<br />
      Why Isn't it Grabbing the XML Value Correctly?<br />
      <br />
      <br />
      -MichaelFlya-</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Instructor</span><br />
      <span class="post-time small text-muted">21st May 2005 08:25 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"></p>

      <blockquote>
        I change 5.403 to 5.8 it is less than 5.405 For Some<br />
        Reason.
      </blockquote>
      <pre>
<code>${VersionCompare} "5.405" "5.8" "$R0"<br />;$R0=1</code>
</pre>It's correct. Because
      <pre>
<code>${VersionCompare} "5.10" "5.8" "$R0"<br />;$R0=1</code>
</pre>Right comparison (in your case):
      <pre>
<code>${VersionCompare} "5.4.05" "5.8" "$R0"<br />;$R0=2</code>
</pre>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">MichaelFlya</span><br />
      <span class="post-time small text-muted">21st May 2005 13:01 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">I need to add a Decimal every Time after the first Decimal?<br />
      <br />
      When using this Method I must Make my Versions like:<br />
      0.0.0.0.0.0.0.0.0.0.0.0.0.0.0<br />
      <br />
      <br />
      -MichaelFlya-</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">MichaelFlya</span><br />
      <span class="post-time small text-muted">21st May 2005 13:27 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">As far as Function GetBetween Goes, Using Detail<br />
      Print like this:<br />
      <br /></p>
      <pre>
<code><br />DetailPrint "$R0"<br /></code>
</pre><br />
      <br />
      It Should Return The Version Number of the XML.<br />
      But it turns up Blank. I figure once the Code for<br />
      that Function is Working Properly I will get a Result<br />
      from the XML. This is what I need to have worked<br />
      out at the Moment.<br />
      <br />
      Oh and After Function VersionCompare I see it Is<br />
      used to say 1 or 2.<br />
      <br />
      -MichaelFlya-
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">MichaelFlya</span><br />
      <span class="post-time small text-muted">21st May 2005 14:17 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Ahh Something Small I have now Figured it out....<br />
      <br /></p>
      <pre>
<code><br />${GetBetween} "&lt;version&gt;" "&lt;/version&gt;" ".\currentversion.xml" "$R0"<br /></code>
</pre><br />
      <br />
      That helped on Returning the Value Found in XML. I must<br />
      have not Set the Install Directory. Instead I set OutFile.<br />
      <br />
      <br />
      But now For Function VersionCompare. Making the Number in<br />
      the XML file 5.1 Instead of 5.405 and Doing this with the Line<br />
      of Code:<br />
      <br />
      Code:<br />
      <pre>
<code><br />${VersionCompare} "$R0" "5.0" "$R0"<br /></code>
</pre><br />
      <br />
      Everything works When I change 5.0 in the Script to a<br />
      more Higher Version than 5.1 it works as I want. Plus<br />
      when I change 5.1 in the XML to what ever. So now I<br />
      can Work With this. A good Explanation on why it's<br />
      best to do 0.0.0.0.0 Decimals is needed but ok to Use.<br />
      <br />
      <br />
      Both Afrow Uk And Instructor, All I can say is Thanks !!!!<br />
      <br />
      And Joel When ever I need to Write a XML With the<br />
      Installer I am sure those Links will Come in handy,<br />
      Thanks !!!!<br />
      <br />
      <br />
      <br />
      <br />
      -MichaelFlya-
    </div>
    <hr />

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]>
  </script>
</body>
</html>
