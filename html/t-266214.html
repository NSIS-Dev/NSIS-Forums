<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="Windows 2003 Server &amp; Services" />

  <title>Windows 2003 Server &amp; Services - NSIS Forums</title>
  <script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script>
  <!-- Bootstrap core CSS -->

  <link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css" />
  <link rel="stylesheet" href="../css/style.css" type="text/css" /><!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!--[if lt IE 9]>
                <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
                <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->
</head>

<body>
  <div class="container">
    <!-- Put navigation bar here -->

    <ol class="breadcrumb">
      <li><a href="../index.html" class="glyphicon glyphicon-home"></a></li>

      <li><a href="f-65.html">NSIS Discussion</a></li>

      <li class="active">Windows 2003 Server &amp; Services</li>
    </ol>

    <p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=266214">Windows 2003 Server &amp; Services</a></p><br />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Nniol</span><br />
      <span class="post-time small text-muted">20th February 2007 13:30 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>Windows 2003 Server &amp; Services</strong><br />
      Hi,<br />
      <br />
      I use Sunjammer Dll for controlling access to Windows services:<br />
      http://nsis.sourceforge.net/How_do_I_start/stop/create/remove/check_a_service<br />
      <br />
      However there seems to be compatability issues with Windows 2003 Server<br />
      <br />
      Any ideas??<br />
      <br />
      Nniol</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Nniol</span><br />
      <span class="post-time small text-muted">20th February 2007 13:31 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Dll HTML Link<br />
      <br />
      http://nsis.sourceforge.net/How_do_I_start/stop/create/remove/check_a_service</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Nniol</span><br />
      <span class="post-time small text-muted">20th February 2007 13:33 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">nsis.sourceforge.net/How_do_I_start/stop/create/remove/check_a_service</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
      <span class="post-time small text-muted">20th February 2007 21:06 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Untick "Automatically parse URLs" when you post and the URLs will not be hidden.<br />
      <br />
      As for the problem itself, what exactly do you mean by compatability issues and do the other solutions exhibit the same behavior?</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Nniol</span><br />
      <span class="post-time small text-muted">22nd February 2007 08:57 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">With some versions of WIndows 2003 Server it works, and with others it doesn't......<br />
      <br />
      But only on 2003, just wondering if Microsoft have changed their code or something<br />
      <br />
      <br />
      <br />
      NNiol</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
      <span class="post-time small text-muted">23rd February 2007 11:48 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">And what exactly do you mean by not working? Is the service created but not started? Does it crash when creating the service? Does it set the wrong name? And what about the other available solutions for service creation?</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Nniol</span><br />
      <span class="post-time small text-muted">23rd February 2007 11:54 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">it is querying whether a service exists...<br />
      On all other computer it returns that the service installed by installer A is there, but on Windows 2003 the same servie returns not present</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
      <span class="post-time small text-muted">23rd February 2007 12:00 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Nniol, I can't help you unless you start giving me some more details. What is querying whether a service exists? What about other methods of service creation?</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Nniol</span><br />
      <span class="post-time small text-muted">23rd February 2007 12:15 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">The problem is within the DLL, the DLL runs fine and doesn't crash it just returns a wrong result...<br />
      <br />
      The service is started and running. The call from within NSIS is:<br />
      services::IsServiceInstalled "$ServiceKeyName"<br />
      <br />
      Where $ServiceKeyname is<br />
      StrCpy $ServiceKeyName "Office Document Server"<br />
      <br />
      ON all other servers this works fine and returns Yes if installed and no otherwise, however on Windows 2003 it no even if the service is there.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
      <span class="post-time small text-muted">23rd February 2007 12:21 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">And how is the service created?</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Nniol</span><br />
      <span class="post-time small text-muted">23rd February 2007 12:40 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">From a Windows executable<br />
      something like<br />
      <br />
      ODSServer.exe -install</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
      <span class="post-time small text-muted">23rd February 2007 12:42 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Are you sure it doesn't use another name on Windows 2003 or different set of privileges? It's possible, though unlikely, that it refuses the query privilege from some users.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Nniol</span><br />
      <span class="post-time small text-muted">23rd February 2007 12:50 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">OK...<br />
      <br />
      Will ask the App. Devs about this,<br />
      <br />
      Thank you</p>
    </div>
    <hr />

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]>
  </script>
</body>
</html>
