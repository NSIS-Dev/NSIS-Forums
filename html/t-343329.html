<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="win7/vista install template" />

  <title>win7/vista install template - NSIS Forums</title>
  <script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script>
  <!-- Bootstrap core CSS -->

  <link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css" />
  <link rel="stylesheet" href="../css/style.css" type="text/css" /><!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!--[if lt IE 9]>
                <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
                <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->
</head>

<body>
  <div class="container">
    <!-- Put navigation bar here -->

    <ol class="breadcrumb">
      <li><a href="../index.html" class="glyphicon glyphicon-home"></a></li>

      <li><a href="f-65.html">NSIS Discussion</a></li>

      <li class="active">win7/vista install template</li>
    </ol>

    <p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=343329">win7/vista install template</a></p><br />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">gclass</span><br />
      <span class="post-time small text-muted">21st March 2012 14:34 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>win7/vista install template</strong><br />
      Hi<br />
      I am about to write for the first time uninstall data to the registry.<br />
      the installer just need to place a file and create desktop and start menu short cuts.<br />
      <br />
      I looked for some information, and found this template:<br />
      <a href="http://nsis.sourceforge.net/Sample_installation_script_for_an_application" target="_blank">http://nsis.sourceforge.net/Sample_i...an_application</a><br />
      <br />
      and this one as for the permission level:<br />
      <a href="http://nsis.sourceforge.net/Shortcuts_removal_fails_on_Windows_Vista" target="_blank">http://nsis.sourceforge.net/Shortcut..._Windows_Vista</a><br />
      <br />
      I wonder if this will cover all and the installer will have the most chances to work properly on most machines?<br />
      <br />
      or if there is a template I can learn from?<br />
      <br />
      thx<br />
      G</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
      <span class="post-time small text-muted">21st March 2012 19:22 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">If you require administrator access for installation you still need to check the user is an administrator using the UserInfo plug-in (as that page states). You need administrator access if your shortcut will be placed for all users, you are writing to HKLM registry or you are writing files to Program Files or Windows. If you are not writing to any of these locations (uninstall registry can go in HKCU), you can just use RequestExecutionLevel user.<br />
      <br />
      But yes, that is enough to ensure a standard installation will work on all Windows versions (including Windows 8) *.<br />
      <br />
      * that can execute 32-bit programs I should add :)<br />
      <br />
      Stu</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">gclass</span><br />
      <span class="post-time small text-muted">23rd March 2012 12:53 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Hi Stu,<br />
      Thank you for your kind reply :)<br />
      I managed to code it properly and it is working as expected on xp,vista and 7.<br />
      <br />
      thinking about admin permissions, I wonder how "appropriate" it is to install software to c:\somefolder and place desktop shortcut in case NSIS do not get admin privileges?<br />
      <br />
      thx</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
      <span class="post-time small text-muted">23rd March 2012 13:46 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">You can't write to C:\somefolder without admin privileges. The only folder you can write to is the user's profile folders, such as $APPDATA. This is where you would install to for per-user installs, create per-user shortcuts and write HKCU uninstall registry.<br />
      <br />
      Stu</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">gclass</span><br />
      <span class="post-time small text-muted">23rd March 2012 14:04 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">thanks Stu,<br />
      really helpful and useful<br />
      :)</p>
    </div>
    <hr />

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]>
  </script>
</body>
</html>
