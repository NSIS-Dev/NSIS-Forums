<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="Need curly buttons" />

  <title>Need curly buttons - NSIS Forums</title><!-- Bootstrap core CSS -->
  <link rel="stylesheet" type="text/css" href="//netdna.bootstrapcdn.com/bootswatch/3.0.1/readable/bootstrap.min.css" />
  <link rel="stylesheet" href="../css/style.css" type="text/css" /><!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!--[if lt IE 9]>
                <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
                <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->
</head>

<body>
  <div class="container">
    <!-- Put navigation bar here -->

    <ol class="breadcrumb">
      <li><a href="../index.html" class="glyphicon glyphicon-home"></a></li>

      <li><a href="f-65.html">NSIS Discussion</a></li>

      <li class="active">Need curly buttons</li>
    </ol>

    <p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=318272">Need curly buttons</a></p><br />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Alfaromeo</span><br />
      <span class="post-time small text-muted">10th April 2010 06:20 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>Need curly buttons</strong><br />
      Using UMUI . I need oval shaped buttons instead of rectangle. Please advise</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Alfaromeo</span><br />
      <span class="post-time small text-muted">13th April 2010 07:48 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Anybody can help . basically any runtime API I can use to change the shape of the buttons .Needed urgently.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Animaether</span><br />
      <span class="post-time small text-muted">13th April 2010 13:13 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">I don't think there's any particularly easy way to do this without defining your own controls in e.g. visual studio, then exporting them as a DLL, and then adding them to your dialogs with nsDialogs.<br />
      I could be mistaken, though.<br />
      <br />
      The only semi-easy way I can think of is to build up your UI out of bitmaps and using nsDialogs' onClick event to detect a click on a bitmap and optionally toggle that bitmap (to show the user that they clicked).<br />
      That way you could define any shape of button you want.. although they would still fall into the rectangular layouts of bitmaps (like early HTML maps). This -could- be refined by using the System plugin with getWindowRect and getCursorPos to determine where in the bitmap a user clicked. Not sure how easy it would be to read out a mask bitmap to correlate the clicked position to a control's shape, though.<br />
      <br />
      Below is an example showing a toggle button behavior. For a regular button you'd change the bitmap, sleep for a fraction of a second, and then change it back. ( There's no mouseDown / mouseUp events in nsDialogs )<br /></p>
      <pre>
<span style="color: #007700">!</span><span style="color: #0000BB">addincludedir</span><span style="color: #DD0000">"."<br /></span><span style="color: #007700">!</span><span style="color: #0000BB">addplugindir</span><span style="color: #DD0000">"."<br /><br /></span><span style="color: #007700">!include</span><span style="color: #DD0000">"LogicLib.nsh"<br /></span><span style="color: #007700">!include</span><span style="color: #DD0000">"MUI2.nsh"<br /></span><span style="color: #007700">!include</span><span style="color: #DD0000">"winMessages.nsh"<br /></span><span style="color: #007700">!include</span><span style="color: #DD0000">"nsDialogs.nsh"<br /><br /></span><span style="color: #0000BB">OutFile</span><span style="color: #DD0000">"test.exe"<br /><br /></span><span style="color: #0000BB">Section<br />SectionEnd<br /><br /></span><span style="color: #007700">Var</span><span style="color: #0000BB">dialog<br /></span><span style="color: #007700">Var</span><span style="color: #0000BB">hwnd<br /></span><span style="color: #007700">Var</span><span style="color: #0000BB">null<br /><br /></span><span style="color: #007700">Var</span><span style="color: #0000BB">hwnd_listbox<br /></span><span style="color: #007700">Var</span><span style="color: #0000BB">hwnd_bitmap<br /></span><span style="color: #007700">Var</span><span style="color: #0000BB">res_bmp<br /><br />PageCustomcustomPage<br /></span><span style="color: #007700">Function</span><span style="color: #0000BB">customPage<br />nsDialogs</span><span style="color: #007700">::</span><span style="color: #0000BB">Create1018<br />Pop$dialog<br /><br /></span><span style="color: #FF8000">/*Unpackbitmapfilesinadvance*/<br /></span><span style="color: #0000BB">InitPluginsDir<br />SetOutPath</span><span style="color: #DD0000">"$PluginsDir"<br /></span><span style="color: #0000BB">File</span><span style="color: #DD0000">"a.bmp"<br /></span><span style="color: #0000BB">File</span><span style="color: #DD0000">"b.bmp"<br /><br /></span><span style="color: #007700">${</span><span style="color: #0000BB">NSD_CreateBitmap</span><span style="color: #007700">}</span><span style="color: #0000BB">25</span><span style="color: #007700">%</span><span style="color: #0000BB">0190171</span><span style="color: #DD0000">""<br /></span><span style="color: #0000BB">Pop$hwnd_bitmap<br /></span><span style="color: #007700">${</span><span style="color: #0000BB">NSD_SetImage</span><span style="color: #007700">}</span><span style="color: #0000BB">$hwnd_bitmap</span><span style="color: #DD0000">"$PluginsDir\a.bmp"</span><span style="color: #0000BB">$res_bmp<br />nsDialogs</span><span style="color: #007700">::</span><span style="color: #0000BB">SetUserData$hwnd_bitmap</span><span style="color: #DD0000">"a.bmp"<br /></span><span style="color: #007700">${</span><span style="color: #0000BB">NSD_OnClick</span><span style="color: #007700">}</span><span style="color: #0000BB">$hwnd_bitmapcustompage</span><span style="color: #007700">.</span><span style="color: #0000BB">bitmap</span><span style="color: #007700">.</span><span style="color: #0000BB">onclick<br /><br /><br />nsDialogs</span><span style="color: #007700">::</span><span style="color: #0000BB">Show<br /></span><span style="color: #007700">${</span><span style="color: #0000BB">NSD_FreeImage</span><span style="color: #007700">}</span><span style="color: #0000BB">$res_bmp<br />FunctionEnd<br /><br /></span><span style="color: #007700">Function</span><span style="color: #0000BB">custompage</span><span style="color: #007700">.</span><span style="color: #0000BB">bitmap</span><span style="color: #007700">.</span><span style="color: #0000BB">onclick<br />Pop$hwnd<br /><br /></span><span style="color: #FF8000">/*Getcontrol'srectonscreen*/<br /></span><span style="color: #0000BB">System</span><span style="color: #007700">::</span><span style="color: #0000BB">Call</span><span style="color: #DD0000">"*(i,i,i,i)i.r1"<br /></span><span style="color: #0000BB">System</span><span style="color: #007700">::</span><span style="color: #0000BB">Call</span><span style="color: #DD0000">"User32::GetWindowRect(i,i)i($hwnd,r1).r2"<br /></span><span style="color: #0000BB">System</span><span style="color: #007700">::</span><span style="color: #0000BB">Call</span><span style="color: #DD0000">"*$1(i,i,i,i)i(.r2,.r3,.r4,.r5)"<br /><br /></span><span style="color: #FF8000">/*Getmousecursor'spositiononscreen*/<br /></span><span style="color: #0000BB">System</span><span style="color: #007700">::</span><span style="color: #0000BB">Call</span><span style="color: #DD0000">"*(l,l)i.r6"<br /></span><span style="color: #0000BB">System</span><span style="color: #007700">::</span><span style="color: #0000BB">Call</span><span style="color: #DD0000">"User32::GetCursorPos(i)i(r6).r7"<br /></span><span style="color: #0000BB">System</span><span style="color: #007700">::</span><span style="color: #0000BB">Call</span><span style="color: #DD0000">"*$6(i,i)i(.r7,.r8)"<br /><br /></span><span style="color: #FF8000">/*Derivemousecursorpositionrelativetocontrol*/<br /></span><span style="color: #0000BB">IntOp</span><span style="color: #007700">$</span><span style="color: #0000BB">0</span><span style="color: #007700">$</span><span style="color: #0000BB">7</span><span style="color: #007700">-$</span><span style="color: #0000BB">2<br />IntOp</span><span style="color: #007700">$</span><span style="color: #0000BB">1</span><span style="color: #007700">$</span><span style="color: #0000BB">8</span><span style="color: #007700">-$</span><span style="color: #0000BB">3<br /><br /></span><span style="color: #FF8000">/*Dosomethingwiththatcursorpositioninformationhere,perhaps*/<br />/*MessageBoxMB_OK"Cursorpositionrelativetocontrol:$0x$1"*/<br /><br /></span><span style="color: #0000BB">nsDialogs</span><span style="color: #007700">::</span><span style="color: #0000BB">GetUserData$hwnd_bitmap</span><span style="color: #DD0000">"a.bmp"<br /></span><span style="color: #0000BB">Pop</span><span style="color: #007700">$</span><span style="color: #0000BB">0<br /><br /></span><span style="color: #007700">${</span><span style="color: #0000BB">Select</span><span style="color: #007700">}$</span><span style="color: #0000BB">0<br /></span><span style="color: #007700">${Case}</span><span style="color: #DD0000">"a.bmp"<br /></span><span style="color: #0000BB">StrCpy</span><span style="color: #007700">$</span><span style="color: #0000BB">1</span><span style="color: #DD0000">"b.bmp"<br /></span><span style="color: #007700">${Default}<br /></span><span style="color: #0000BB">StrCpy</span><span style="color: #007700">$</span><span style="color: #0000BB">1</span><span style="color: #DD0000">"a.bmp"<br /></span><span style="color: #007700">${</span><span style="color: #0000BB">EndSelect</span><span style="color: #007700">}<br /><br />${</span><span style="color: #0000BB">NSD_FreeImage</span><span style="color: #007700">}</span><span style="color: #0000BB">$res_bmp<br /></span><span style="color: #007700">${</span><span style="color: #0000BB">NSD_SetImage</span><span style="color: #007700">}</span><span style="color: #0000BB">$hwnd_bitmap</span><span style="color: #DD0000">"$PluginsDir\$1"</span><span style="color: #0000BB">$res_bmp<br />nsDialogs</span><span style="color: #007700">::</span><span style="color: #0000BB">SetUserData$hwnd_bitmap</span><span style="color: #DD0000">"$1"<br /></span><span style="color: #0000BB">FunctionEnd<br /><br /></span><span style="color: #007700">!</span><span style="color: #0000BB">insertmacroMUI_LANGUAGE</span><span style="color: #DD0000">"English"
</span>
</pre>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">jpderuiter</span><br />
      <span class="post-time small text-muted">13th April 2010 13:37 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">You might want to have a look at the SkinCrafter plugin:<br />
      <a href="http://www.skincrafter.com/products/nsis-plugin" target="_blank">http://www.skincrafter.com/products/nsis-plugin</a><br />
      <br />
      Never used it, but it looks like it might do what you want. (You probably have to create your own skin)</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Alfaromeo</span><br />
      <span class="post-time small text-muted">14th April 2010 11:57 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Excellent piece of code by Animather to demonstrate owner drawn buttons in NSIS .<br />
      But for now I 'm going to stick with Skincrafter plugin as it reduces much coding work for me.Also I saw a 60 % increase in the size of the installer by including this plugin. Can anything be done about this ?</p>
    </div>
    <hr />

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]>
  </script>
</body>
</html>
