<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="AdvSplash + gif, jpeg and others" />

  <title>AdvSplash + gif, jpeg and others - NSIS Forums</title>
  <script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script>
  <!-- Bootstrap core CSS -->

  <link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css" />
  <link rel="stylesheet" href="../css/style.css" type="text/css" /><!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!--[if lt IE 9]>
                <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
                <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->
</head>

<body>
  <div class="container">
    <!-- Put navigation bar here -->

    <ol class="breadcrumb">
      <li><a href="../index.html" class="glyphicon glyphicon-home"></a></li>

      <li><a href="f-65.html">NSIS Discussion</a></li>

      <li class="active">AdvSplash + gif, jpeg and others</li>
    </ol>

    <p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=197479">AdvSplash + gif, jpeg and others</a></p><br />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Takhir</span><br />
      <span class="post-time small text-muted">26th October 2004 08:34 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>AdvSplash + gif, jpeg and others</strong><br />
      &nbsp; Jpeg compression is a wellknown quality/size decision, may be usefull for a big splash images.<br />
      I only replaced LoadImage() with OleLoadPicturePath() call (and renamed project files :) )<br />
      <br />
      Tested on Win2K<br />
      <br />
      This might be done already, but I not found "IPicture" word using forum search or in my "Contrib" folder.<br />
      <br />
      For any use, of course..</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Joel</span><br />
      <span class="post-time small text-muted">26th October 2004 15:04 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Going to test it :)</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">John P.</span><br />
      <span class="post-time small text-muted">27th October 2004 00:45 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Thanks, this is something I've been looking for lately. I thought it was weird that the NSIS installer wouldn't allow the use of a .jpg image as the splash image.<br />
      <br />
      I've tried your file on WinXP Pro SP2, and the .jpg showed up just fine, with no errors. I'm going to try a .gif with transparency tomorrow. :)</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Takhir</span><br />
      <span class="post-time small text-muted">27th October 2004 07:03 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Thanks, John.<br />
      Please note, that I used gif with white (0x000000) transparency color in Example.nsi<br />
      <br />
      "KeyColor - color used for transparency, could be any RGB value<br />
      (for ex. R=255 G=100 B=16 -&gt; KeyColor=0xFF6410),<br />
      use KeyColor=-1 if there is no transparent color at your image."</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">John P.</span><br />
      <span class="post-time small text-muted">27th October 2004 23:33 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">It works for .gif with and without transparency, and for .jpg. :)<br />
      <br />
      I've tried .png with transparency too though, but that doesn't seem to work. Any simple way I can make .png work using this plugin?</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Takhir</span><br />
      <span class="post-time small text-muted">28th October 2004 08:40 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">The same problem with tiff. OleLoadPicturePath returns NULL instead of interface pointer :(<br />
      IE also supports all image formats, and code samples are available in Inet, but this is another story..<br />
      New "play" plug-in entry (see included sample), now sound works and on my Win98 too. 2 images included to make test more easily.<br />
      Transparency extraction from GIF adds 2 kB to dll, so it is not included again.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">John P.</span><br />
      <span class="post-time small text-muted">28th October 2004 21:59 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Are you going to try to make it work for .tiff and .png images as well, or should I go for .gif instead?<br />
      <br />
      .gif is OK, but a 24bit .png with transparency looks much better than a transparent .gif with it's 256 colour cap. (.gif gets "pixellated")<br />
      <br />
      But either way, thanks for the work you put into it as it is. :)</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Takhir</span><br />
      <span class="post-time small text-muted">29th October 2004 13:01 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Right now my tasks list is too long for this, may be later :(<br />
      But if anybody wants to add png support - IImgCtx is a keyword. It is a part of IE, but Win95 Gold was last MS OS without IE embedded, so I guess this is safe way.<br />
      One link (russian, but code presents) <a href="http://www.rsdn*****article/qna/gdi/drawimg.xml" target="_blank">http://www.rsdn*****article/qna/gdi/drawimg.xml</a></p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Yathosho</span><br />
      <span class="post-time small text-muted">29th October 2004 13:38 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">png ok, but what's the point in tiff support?</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Takhir</span><br />
      <span class="post-time small text-muted">29th October 2004 17:49 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">PhotoShop asks me about tiff compression every time (none/lzw/zip), plain files looks really compressed. So why not?</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">deguix</span><br />
      <span class="post-time small text-muted">29th October 2004 22:58 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"></p>

      <blockquote>
        Transparency extraction from GIF adds 2 kB to dll, so it is not included again.
      </blockquote>Maybe adding an extra option for this would be excellent. I don't think you should care about size at first. You should expand the plugin to the most you can, then you can make optimizations. Except for that, I'm liking it! :)
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Takhir</span><br />
      <span class="post-time small text-muted">30th October 2004 17:17 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">OK, color extraction added, code based on the Andy Key GBM lib, +0.5 kB only :) I also made another minor changes.<br />
      I am not sure how RGB - BGR color goes from gif to bmp, but on my tests with black and white transparent colors it worked fine. PhotoEditor sets transparent color to white only :( Might be good to test with red transp. color. Tested on Win98 and XP. Some considerations about indexed colors in ipicsplash.txt file - see attachment.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">John P.</span><br />
      <span class="post-time small text-muted">31st October 2004 14:04 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Any coders out there willing to continue Takhir's work?<br />
      <br />
      I think a lot of people would appreciate .png support, since a 24bit .png with transparency looks so much better than a .gif with transparency.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Takhir</span><br />
      <span class="post-time small text-muted">31st October 2004 14:53 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">my first idea was to use jpeg - it can lose a bit of image quality, but at the same time gives (or must give :) ) image file size, which cannot be reached in image formats without quality loses (gif, bmp, png). If lzma compressor used in package creation, it might be good to compare compressed particular package sizes with 24 bit bmp and png - what compression is better. BTW when I write random data to tape with hardware compression enabled, it takes 11% (average) place more, then without compression. It's about (png compression + nsis lzma compression) - package size may increase.<br />
      But any case it would be fine to have all formats (and without taxes :)</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Takhir</span><br />
      <span class="post-time small text-muted">2nd December 2004 18:21 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">I added mp3 support to "play" function and renamed plug-in back to AdvSplash (because only 5% of code is mine :) )</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Takhir</span><br />
      <span class="post-time small text-muted">11th January 2005 08:04 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">On Win2K in some situations after splash window installer appeared in the background, fixed. 2 KichiK - this was caused by TOPMOST splash window style.<br />
      Current plug-in name is NewAdvSplash - use folder name under nsis/contrib/NewAdvSplash</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Takhir</span><br />
      <span class="post-time small text-muted">21st January 2005 07:31 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Improved screen redraw after image was destroyed for "no fading" modes - old (included to NSIS distribution AdvSplash) plug-in on Win98 lefts image scraps on the screen.<br />
      BTW, BMP RLE compression (PhotoEditor can do) with subsequent palette cutting (I have program for this) and NSIS package compression may give less file size then gif encoding (for plain images with limited colors number).</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Takhir</span><br />
      <span class="post-time small text-muted">11th March 2005 10:51 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">GlobalFree() bad pointer bug fixed (from original AdvSplash code).</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Takhir</span><br />
      <span class="post-time small text-muted">26th June 2005 11:32 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">New mode with /BANNER key - due to few lines of code from the <a href="http://forums.winamp.com/showthread.php?threadid=211870" target="_blank">nxs</a> plug-in it not stops installer execution while displaying image banner. This makes possible to perform some background initalization (like Banner plug-in does, but with image instead of text).<br />
      /BANNER key requires /NOUNLOAD in the command line and 'ShowWindow $HWNDPARENT 2' string in the .onGUIInit function (see incuded Example.nsi).<br />
      Finally:</p>
      <pre>
<code><br />newadvsplash::show [/NOUNLOAD] show in out color [/BANNER] [/NOCANCEL] filename<br /></code>
</pre><br />
      Two new dll entry points for this mode: wait and stop. First - waits for the end of 'show' and returns control to installer, stop - terminates it (see included Example.nsi).<br />
      <br />
      New /NOCANCEL key - disables 'exit on user click' default behaviour.<br />
      <pre>
<code><br />newadvsplash::play /NOUNLOAD "sndfile.mp3" ; plays sound <br />newadvsplash::play /NOUNLOAD "" ; stops sound.<br /></code>
</pre>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">John P.</span><br />
      <span class="post-time small text-muted">9th August 2005 16:14 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">I have a problem trying to use these files after I installed NSIS 2.08<br />
      <br />
      I have an "old" installer script that I haven't touched for a long time, but today I needed to compile it again, because I had changed something in the README that comes with the installer. I have NOT changed the script at all.<br />
      <br />
      Now, when I try to compile this old script, I get an "Invalid command: ipicsplash::show" error.<br />
      <br />
      I get the same error when trying to use the latest newadvsplash.dll posted above instead of the older ipicsplash.dll.<br />
      <br />
      ipicsplash.dll worked just fine on NSIS 2.05 or so (maybe it was an even earlier release).<br />
      <br />
      The "good old" vanilla AdvSplash.dll works, but I'd like to have .gif support. I have managed to create transparency using a .bmp and AdvSplash as well now, but I'd like to use .gif.<br />
      <br />
      Any fix for this, so I can use the transparent .gif again?<br />
      Or will I have to revert back to an earlier NSIS build to compile?</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Takhir</span><br />
      <span class="post-time small text-muted">9th August 2005 17:27 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">I retested June 26 version with NSIS 2.08 on XP Pro without any problems. So please make following:<br />
      1. Download latest version from previous post zip.<br />
      2. Put included newadvsplash.dll to your Program files\NSIS\plugins folder.<br />
      3. Replace file name in the following code and test it in your script:<br /></p>
      <pre>
<code><br />newadvsplash::show 2000 1000 500 -2 "$PLUGINSDIR\catch.gif"<br /></code>
</pre><br />
      "Invalid command "Invalid command: ipicsplash::show"" meand that new NSIS version has removed ipicsplash.dll from your plugins (and a lot of other usefull things you had under NSIS folder). Next time do not uninstall previous NSIS version when installing new one (NSIS installer' default) - NSIS uninstaller script was written by "left hand", they removed source code from installer and also deleted all usefull stuff we had under NSIS folder :(<br />
      I will be offline 10 days beginning Thursday - test code now :)
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">John P.</span><br />
      <span class="post-time small text-muted">9th August 2005 17:43 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Yes, I'm very sorry. I came back here now to say that it wasn't the latest NSIS build that was at fault, because I have now tried build 2.00 and had the same problem.<br />
      <br />
      It was, as you say, only a matter of the missing .dll file in the plugins folder.<br />
      <br />
      I haven't used that script for so long that I had forgotten about having to put the .dll into the plugins folder. So I feel a little stupid now.<br />
      <br />
      Thanks for your help. :)<br />
      <br />
      <br />
      PS: this forum is so slow to load now that it's hard to come back to post updates; it takes ages.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">grahama</span><br />
      <span class="post-time small text-muted">22nd August 2005 20:33 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">any chance of supporting animated gifs in newadvsplash ?<br />
      Wanted to have a splash gif with a text box that animates:<br />
      initializing<br />
      initializing.<br />
      initializing..<br />
      initializing...<br />
      ;<br />
      at the first go, it does not seem to work :(<br />
      g</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Takhir</span><br />
      <span class="post-time small text-muted">23rd August 2005 09:30 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Current version not supports animation, this is improved AdvSplash only (more image and sound formats, /BANNER mode). Windows animation control works with AVI (MSDN declares this), but not with GIF. For AVI it is possible to use existing control as splash window, but animated GIFs require some code I guess (for example <a href="http://www.codeguru.com/Cpp/G-M/bitmap/article.php/c4879/" target="_blank">http://www.codeguru.com/Cpp/G-M/bitm...cle.php/c4879/</a> )<br />
      This increases plug-in size and creates problems with transparency.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">grahama</span><br />
      <span class="post-time small text-muted">23rd August 2005 16:39 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">understood<br />
      BTW, having code execute while the splash showing is really really cool ! This is a great feature.<br />
      g</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Takhir</span><br />
      <span class="post-time small text-muted">30th August 2005 09:34 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">New plug-in entry point 'hwnd' - gets splash window handle, may be usefull for additional window drawing (in the /banner mode). <a href="http://nsis.sourceforge.net/wiki/AdvSplash_with_gif_and_jpeg" target="_blank">wiki page</a></p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">meganoob</span><br />
      <span class="post-time small text-muted">16th October 2005 13:25 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Sorry, but I am having color problems with NewAdvSplash... In jpeg and bmp images, -1 is setting white to be transparent :(</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Takhir</span><br />
      <span class="post-time small text-muted">16th October 2005 14:25 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Can you give detailed description of problem? I re-tested last version (from wiki) and it worked fine with jpeg and bmp both with -1 (no transparency) and some hex value as transp. color. Included to package Example.nsi shows bmp image with transparency "${NSISDIR}\Contrib\Graphics\Wizard\llama.bmp". White value is 0xffffff<br />
      Possible jpeg problem - transparent areas are not in 8-pixel jpeg grid, this case borders may have distortions. With other truecolor images please check hex color value you want to make transparent in graphic editor (like Photoshop).</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">meganoob</span><br />
      <span class="post-time small text-muted">16th October 2005 14:48 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Here is the screenshot with code highlighted in the back:<br />
      <br />
      <a href="http://imagehost.bizhat.com/img_page.php/4032/82448/newadvsplashscreenshot.jpg" target="_blank">http://imagehost.bizhat.com/img_page...screenshot.jpg</a><br />
      <br />
      The white color is transparent despite -1 command... changing -1 to 0x008000 (for example) makes it nontransparent.<br />
      <br />
      This is a bmp file edited with windows xp paint. I can't put it here to be downloaded, because my registration request with username zeeh3 has never recieved the activation code by mail :(</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
      <span class="post-time small text-muted">16th October 2005 14:51 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"></p>

      <blockquote>
        <i>Originally posted by meganoob</i><br />
        <b>... because my registration request with username zeeh3 has never recieved the activation code by mail :(</b>
      </blockquote>I've resent it. Let me know if it doesn't arrive in a couple of hours.
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Takhir</span><br />
      <span class="post-time small text-muted">16th October 2005 15:23 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Thanks you, <b>meganoob</b>, I could reproduce and fix the bug. New file uploaded to <a href="http://nsis.sourceforge.net/mediawiki/images/c/cf/NewAdvSplash.zip" target="_blank">wiki</a></p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">zeeh3</span><br />
      <span class="post-time small text-muted">17th October 2005 00:02 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">You are welcome, Takhir :) and thanks a lot kichik, from now on meganoob no more, the activation arrived at last!</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">NukeyDoo</span><br />
      <span class="post-time small text-muted">18th November 2005 02:11 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">I am havng a problem with the newadvsplash plugin. I grabbed the one from Takhir's wiki page, and when I run it, the sound and transparent gif show/play ok, but when it's unloading the installer crashes. I'm not sure what I'm doing wrong.<br />
      <br />
      Here is the code I used:<br />
      <br />
      Function .onInit<br />
      <br />
      InitPluginsDir<br />
      File /oname=$PLUGINSDIR\splash.gif "F:\Projects\Test\Install\Images\splash.gif"<br />
      #optional<br />
      File /oname=$PLUGINSDIR\splash.mp3 "F:\Projects\Test\Install\Extras\splash.mp3"<br />
      newadvsplash::play $PLUGINSDIR\splash.mp3<br />
      newadvsplash::show 7000 600 400 -2 $PLUGINSDIR\splash.gif<br />
      <br />
      Pop $0 ; $0 has '1' if the user closed the splash screen early,<br />
      ; '0' if everything closed normal, and '-1' if some error occured.<br />
      <br />
      Delete $PLUGINSDIR\splash.gif<br />
      Delete $PLUGINSDIR\splash.mp3<br />
      <br />
      FunctionEnd<br />
      <br />
      Any help is appreciated</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">dandaman32</span><br />
      <span class="post-time small text-muted">18th November 2005 03:59 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">You need the /NOUNLOAD flag after newadvsplash::show:<br />
      <br /></p>
      <pre>
<code>
newadvsplash::show /NOUNLOAD 7000 600 400 -2 $PLUGINSDIRsplash.gif 
<br />&gt;
</code>
</pre>-Dan
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Takhir</span><br />
      <span class="post-time small text-muted">18th November 2005 07:05 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Yes, /nounload required, but in the first call ('play' this case). For 'modal' banner</p>
      <pre>
<code><br />newadvsplash::play /nounload "$PLUGINSDIR\splash.mp3"<br />newadvsplash::show 7000 600 400 -2 "$PLUGINSDIR\splash.gif"<br /></code>
</pre>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">NukeyDoo</span><br />
      <span class="post-time small text-muted">18th November 2005 17:15 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Works beautifully now, Thanks!</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">NathanProbst</span><br />
      <span class="post-time small text-muted">29th December 2005 10:37 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>Small change to prevent grabbing focus...</strong><br />
      &nbsp; FWIW, I have slightly modified my copy of NewAdvSplash.dll (thanks for the sources!) to add the SWP_NOACTIVATE flag to the SetWindowPos call in the WndProc function. For my purposes, it was annoying that the splash grabbed focus when it displayed. This was on or about line 105 in advsplash.cpp.<br />
      <br />
      If others feel this is a useful improvement, perhaps this change could be integrated into the main source?<br />
      <br />
      Nathan Probst</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">NathanProbst</span><br />
      <span class="post-time small text-muted">29th December 2005 10:47 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">As a quick follow up, I also found it necessary to remove the call to SetForegroundWindow() in the function sf(). Without this change, there is an annoying momentary window activation as the display is ending.<br />
      <br />
      I'd appreciate it if someone (Takhir?) could sanity-check my changes...not sure if I've broken anything!</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Takhir</span><br />
      <span class="post-time small text-muted">29th December 2005 11:23 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Thanks, Nathan!<br />
      Default 'activate' behavior came with old AdvSplash code. I tested your variant and don't see big differences, but if we'll have more then one reqest I can add this as option. Please note 2 another places in the code: sf() function - attempts to set window foreground on splash creation and removing; TOPMOST splash window style - in some situations this also may be a bit annoying.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Takhir</span><br />
      <span class="post-time small text-muted">4th March 2006 12:15 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">New version <a href="http://nsis.sourceforge.net/NewAdvSplash_plug-in" target="_blank">available</a>:<br />
      1. /PASSIVE key - not forces splash window to foreground (last request);<br />
      2. /BANNER mode MUI sample fix.<br />
      3. Animated sample (thanks zeeh3), requires AnimGif plug-in.</p>
    </div>
    <hr />

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]>
  </script>
</body>
</html>