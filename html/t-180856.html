<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="New System documentation" />

  <title>New System documentation - NSIS Forums</title><!-- Bootstrap core CSS -->
  <link rel="stylesheet" type="text/css" href="//netdna.bootstrapcdn.com/bootswatch/3.0.1/readable/bootstrap.min.css" />
  <link rel="stylesheet" href="../css/style.css" type="text/css" /><!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!--[if lt IE 9]>
                <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
                <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->
</head>

<body>
  <div class="container">
    <!-- Put navigation bar here -->

    <ol class="breadcrumb">
      <li><a href="../index.html" class="glyphicon glyphicon-home"></a></li>

      <li><a href="f-65.html">NSIS Discussion</a></li>

      <li class="active">New System documentation</li>
    </ol>

    <p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=180856">New System documentation</a></p><br />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
      <span class="post-time small text-muted">22nd May 2004 16:22 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>New System documentation</strong><br />
      As I've promised Brainsucker I would do, too long ago, I have finally rewritten the System plug-in documentation. It is now in HTML with lots of examples. It is not yet complete, but it's ready for reading. You can find it at:<br />
      <br />
      <a href="http://nsis.sourceforge.net/System.html" target="_blank">http://nsis.sourceforge.net/System.html</a><br />
      <br />
      Comments are welcome.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">pompo500</span><br />
      <span class="post-time small text-muted">22nd May 2004 20:05 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Good job, kichik.<br />
      <br />
      I have one quick question though, can you get the primary ISO language code with NSIS?<br />
      <br />
      edit: nevermind (HKEY_CURRENT_USER\Control Panel\International\sLanguage)</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">deguix</span><br />
      <span class="post-time small text-muted">22nd May 2004 23:24 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">kichik, try to make as I did with some of my Archive pages. Because if I would read by the first impression the [/SIZE] parameter of System::Copy, I would think it's an optional, fixed parameter. Try to put as this structure below:<br />
      <br />
      <i>String</i> - Required fixed parameter, can't be changed.<br />
      <i>"String"</i> - Required changeable parameter, generally you put as said by its name.<br />
      <i>(String|String2)</i> - Required, one choice fixed parameters.<br />
      <i>("String"|"String2")</i> - Required, one choice changeable parameters.<br />
      <i>[String]</i> - Optional, fixed parameter.<br />
      <i>["String"]</i> - Optional, changeable parameter.<br />
      <i>[String|String2]</i> - Optinal, one choice fixed parameters.<br />
      <i>["String"|"String2"]</i> - Optinal, one choice changeable parameters.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
      <span class="post-time small text-muted">25th May 2004 11:23 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">But it is, as the text just below it says, optional. As for fixed parameter, the examples and the text says it's not. I prefer having the meaning on the syntax line and not the type.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
      <span class="post-time small text-muted">4th June 2004 13:54 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">FAQ section added. Currently it only has a question about handling structures. What other questions would you like see?</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">brainsucker</span><br />
      <span class="post-time small text-muted">4th June 2004 15:56 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Finally :)<br />
      btw, FAQ section rocks. Now the callbacks section will rock too (your example works fine, Kichik :)<br />
      <br />
      bug-fix-release, 4.06.2004<br />
      1. System::Copy /SIZE fixed (Kichik).<br />
      2. System::Copy with destination auto-allocation now pushes destination<br />
      address on stack.<br />
      3. Callbacks fixed (Kichik's kick is awesome).</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
      <span class="post-time small text-muted">4th June 2004 16:23 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Thanks! :)<br />
      <br />
      Uploaded. New documentation will be uploaded once the callback information is updated.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
      <span class="post-time small text-muted">4th June 2004 17:27 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">OK, new documentation is up on CVS. A copy is still available at the above address.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">brainsucker</span><br />
      <span class="post-time small text-muted">4th June 2004 22:38 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">4. Bug with proc call parts redefinition, # for example (pointed by Kichik).<br />
      5. Bug with memory protection during callback processing (Kichik).</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">fredtheman</span><br />
      <span class="post-time small text-muted">8th June 2004 17:19 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">BTW, I haven't checked the latest and greatest, but it'd be very nice if someone added a section on how to call COM servers using the System plug-in.<br />
      <br />
      Fred.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
      <span class="post-time small text-muted">10th June 2004 19:01 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">What would you add on top of what's already there?</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">fredtheman</span><br />
      <span class="post-time small text-muted">11th June 2004 09:01 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">&gt;&gt;What would you add on top of what's already there?<br />
      <br />
      I just took a look, and all there is to read is a tiny example with no comment in the "Usage Examples" of the document. I guess I'm not the only one coming from the VB world, so I could use a bit more info on how to call COM servers from NSIS :-)<br />
      <br />
      Fred.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
      <span class="post-time small text-muted">11th June 2004 10:20 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Have you read the notes? Have you read the possible PROC values?</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">fredtheman</span><br />
      <span class="post-time small text-muted">14th June 2004 15:53 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">&gt;&gt;Have you read the notes? Have you read the possible PROC values?<br />
      <br />
      I'm sorry, you lost me. I looked for a bit of explanation on how to use the System plug-in to work with COM servers at the following locations, but found nothing usable for someone who is only use to COM through VB. Should I look elsewhere on the site?<br />
      <br />
      1. system_bugfix.zip<br />
      2. 10.zip<br />
      3. <a href="http://nsis.sourceforge.net/System.html" target="_blank">http://nsis.sourceforge.net/System.html</a><br />
      (scroll down to Calling Functions -&gt; Notes and Usage Examples)<br />
      <br />
      If that all there is, I guess I'll have to read on how to work with COM servers from a C++ point of view, since this is just too short an example when coming from the VB world. Nice work anyway :-)<br />
      <br />
      Thx<br />
      Fred.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
      <span class="post-time small text-muted">17th June 2004 17:51 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Notes contains:</p>

      <blockquote>
        To find out the index of a member in a COM interface, you need to search for the definition of this COM interface in the header files that come with Visual C/C++ or the Platform SDK. Remember the index is zero based.
      </blockquote>Possible PROC values and Meanings contains:

      <blockquote>
        IPTR-&gt;IDX -- Member indexed IDX from interface pointed by IPTR -- see below (example link)
      </blockquote>Do you think it deserves more than that, like callbacks?
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">fredtheman</span><br />
      <span class="post-time small text-muted">18th June 2004 21:21 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">I guess it makes perfect sense for people quite knowledgeable with COM and C++, but I doubt any VB user for instance can figure out how to call any COM server from NSIS without a bit more infos on how those things work at that level, eg. how to find the list of interfaces from a non-MS server, eg.<br />
      <br />
      Don't get me wrong, the System plug-in is very very useful, but it's just a bit cryptic for those not familiar with Win32 :-)<br />
      <br />
      Fred.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
      <span class="post-time small text-muted">18th June 2004 22:07 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">I assume you're refering to stuff like:</p>
      <pre>
<code>s = GetObject("Something.Something")<br />s.something()</code>
</pre>Took me a while to find it, but it's done with CLSIDFromProgID. It takes a string and returns a CLSID which can then be used with CoCreateInstance as in the example. Getting a bit complicated I guess... I better create a section for it, after I learn some more about it :)
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
      <span class="post-time small text-muted">18th June 2004 23:51 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Ouch...</p>
      <pre>
<code># defines<br />!define CLSCTX_ALL 23<br />!define IID_IUnknown {00000000-0000-0000-C000-000000000046}<br />!define IID_IDispatch {00020400-0000-0000-C000-000000000046}<br />!define IID_NULL {00000000-0000-0000-0000-000000000000}<br /><br />!define DISPATCH_METHOD         1<br />!define DISPATCH_PROPERTYGET    2<br />!define DISPATCH_PROPERTYPUT    4<br />!define DISPATCH_PROPERTYPUTREF 8<br /><br />!define DISPPARAMS (i,i,i,i)<br /><br /># get CLSID<br />System::Call "ole32::CLSIDFromProgID(w 'Shell.Application', \<br />        g .r0) i.r1"<br />DetailPrint "Shell.Application CLSID - $0"<br />DetailPrint "CLSIDFromProgID - $1"<br /><br /># create IActiveDesktop interface<br />System::Call "ole32::CoCreateInstance(g r0, i 0, \<br />        i ${CLSCTX_ALL}, g '${IID_IDispatch}', *i .r0) i.r1"<br />DetailPrint "IDispatch - $0"<br />DetailPrint "CoCreateInstance - $1"<br /><br /># call IUnknown-&gt;QueryInterface, get IDispatch<br />#System::Call "$0-&gt;0(g ${IID_IDispatch}, *i r2) i.r1"<br />#DetailPrint $2<br />#DetailPrint $1<br /><br /># call IDispatch-&gt;GetIDsOfNames<br />System::Call "$0-&gt;5(g ${IID_NULL}, *w 'MinimizeAll', \<br />        i 1, i 0, *i r2r2) i.r1"<br />DetailPrint "MinimizeAll - $2"<br />DetailPrint "GetIDsOfNames - $1"<br /><br /># create arguments<br />System::Call "*${DISPPARAMS}(0, 0, 0, 0)i.R0"<br />DetailPrint "Allocate DISPPARMS - $R0"<br /><br /># call IDispatch-&gt;Invoke<br />System::Call "$0-&gt;6(i r2, g ${IID_NULL}, i 0, \<br />        i ${DISPATCH_METHOD}, i R0, i 0, i 0, i 0) i.r1"<br />DetailPrint "Invoke - $1"<br /><br /># call IDispatch-&gt;Release<br />System::Call "$0-&gt;2() i.r1"<br />DetailPrint "Release - $1"</code>
</pre>And that's without any parameters passed to the method...<br />
      <br />
      Wasn't as simple as I thought it'd be :)
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">gfm688</span><br />
      <span class="post-time small text-muted">7th January 2011 09:26 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">!define CLSID_Shell {13709620-C279-11CE-A49E-444553540000}<br />
      !define IID_IShellDispatch {D8F015C0-C278-11CE-A49E-444553540000}<br />
      <br />
      Section<br />
      System::Call Ole32::CoCreateInstance(g'${CLSID_Shell}',i0,i1,g'${IID_IShellDispatch}',*i.r0)i.r1<br />
      StrCmp $1 0 0 end<br />
      # call IShellDispatch-&gt;MinimizeAll<br />
      System::Call "$0-&gt;14()"<br />
      # call IShellDispatch-&gt;Release<br />
      System::Call "$0-&gt;2()"<br />
      end:<br />
      SectionEnd</p>
    </div>
    <hr />

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]>
  </script>
</body>
</html>
