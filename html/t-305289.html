<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="How do I make a user level have admin rights during installation?" />

  <title>How do I make a user level have admin rights during installation? - NSIS Forums</title>
  <script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script>
  <!-- Bootstrap core CSS -->

  <link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css" />
  <link rel="stylesheet" href="../css/style.css" type="text/css" /><!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!--[if lt IE 9]>
                <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
                <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->
</head>

<body>
  <div class="container">
    <!-- Put navigation bar here -->

    <ol class="breadcrumb">
      <li><a href="../index.html" class="glyphicon glyphicon-home"></a></li>

      <li><a href="f-65.html">NSIS Discussion</a></li>

      <li class="active">How do I make a user level have admin rights during installation?</li>
    </ol>

    <p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=305289">How do I make a user level have admin rights during installation?</a></p><br />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">bedbuffer</span><br />
      <span class="post-time small text-muted">13th April 2009 08:05 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>How do I make a user level have admin rights during installation?</strong><br />
      I made an installer that works perfectly with XP. It works with Vista as well but only with administrators.<br />
      <br />
      What if the user wants to install this software but doesn't have the administrator's password (user level at VISTA)? I have tried using the UAC plug in, but this would definitely prompt the user for the admin password.<br />
      <br />
      Is there anyway that could make the installer run by the user as if he's the admin?<br />
      <br />
      Please help... thanks...</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Animaether</span><br />
      <span class="post-time small text-muted">13th April 2009 11:17 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">The entire point of access levels is that a common user can't just simply gain admin level without so much as a prompt for administrator credentials... so, no - you can't have your installer magically gain admin level if the person running the installer only has user level.<br />
      <br />
      If common users should be able to use your installer, you might have to check why your installer needs admin level and see if you can eliminate that need.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">bedbuffer</span><br />
      <span class="post-time small text-muted">15th April 2009 05:50 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">That's right. You have a point. But I was wondering why you can install GTalk even if you only have a user level. I think same goes with yahoo messenger.<br />
      <br />
      I would want to make it work that way if there's any way. I actually made a workaround, you can get to install it but only on the APPDATA folder. I figured you can't install in the PROGRAM files folder if you're only a user.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Anders</span><br />
      <span class="post-time small text-muted">15th April 2009 09:47 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Your installer is just as broken on XP, it's just that most people run as admin there (but not everyone)</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">bedbuffer</span><br />
      <span class="post-time small text-muted">15th April 2009 10:47 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Nope, it works perfectly on XP whatever folder you select... I'm only having problems on Vista.<br />
      <br />
      If you can install Gtalk and YM on Vista without having admin rights, that means, there's gotta be a way you could do that on your own installer.<br />
      <br />
      That's what I'm trying to figure out...</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Anders</span><br />
      <span class="post-time small text-muted">15th April 2009 11:57 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">If you try to write to $programfiles without checking for admin rights on XP, your installer is broken!<br />
      <br />
      To install something as non-admin, you must install the program in $localappdata or $appdata</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">bedbuffer</span><br />
      <span class="post-time small text-muted">15th April 2009 12:02 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">I understand, but that's not what i want to do... :) I want to be able to install to any folder... :D</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Comperio</span><br />
      <span class="post-time small text-muted">15th April 2009 23:31 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">UAC will also block access to the root of the system drive (C:\ for example) as well as the Windows and Program Files folders. (I'm not totally sure, but I believe the restriction to the root of the system drive might be the difference between XP and Vista.)<br />
      <br />
      MS recommends using the user's profile folder instead if trying to run without elevated permissions. More info here: <a href="http://technet.microsoft.com/en-us/windows/cc507861.aspx" target="_blank">http://technet.microsoft.com/en-us/w.../cc507861.aspx</a></p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">redxii</span><br />
      <span class="post-time small text-muted">16th April 2009 02:25 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">UAC facilitates switching between Administrator and Non-Administrator tokens, in order to temporarily elevate permissions for a program w/o using a separate account. Else, it has to do with file system permissions which should be the same or similar between XP and Vista.<br />
      <br />
      - Cannot write a FILE to root but can create a folder in the root; if another user created that folder then they can add their own files but not modify the other user's files.<br />
      - Can write to their profile directory, and the Shared Documents folder (they can add their own files but not modify other users' files).<br />
      - Write to HKEY_CURRENT_USER, few exceptions: HKCU\Software\Microsoft\Windows\CurrentVersion\Policies is not writeable by non-admin even though it's under their hive</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">bedbuffer</span><br />
      <span class="post-time small text-muted">16th April 2009 03:24 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">If you select "single user" for the install type, that means the application will be installed in the current user's account.<br />
      <br />
      My understanding is that, if you're an admin the application should be written in HKLM which makes it available to all users. And if you're just a user it should be written in HKCU.<br />
      <br />
      My question is, If I'm an admin and I select "single user" will the application installed be available to all users?</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">redxii</span><br />
      <span class="post-time small text-muted">16th April 2009 04:05 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"></p>

      <blockquote>
        My question is, If I'm an admin and I select "single user" will the application installed be available to all users? [/B]
      </blockquote>That depends on where you install it. If you install it within the admin's profile, non-admin users won't be able to access the program. Non-admins also cannot access other users' profiles, via file system permissions and not UAC, if using NTFS as the file system. If it is somewhere where the user can read it then they can open the program.
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Anders</span><br />
      <span class="post-time small text-muted">16th April 2009 09:54 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">single user is single user, does not matter if you are admin or not</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">nsfis</span><br />
      <span class="post-time small text-muted">17th April 2009 12:44 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">bedbuffer,<br />
      have you tried to set RequestExecutionLevel to "user"? By default, XML manifest is not included and OS decides itself what priviliges are required. It can recognize that EXE is an installer and then requires admin priviliges.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">bedbuffer</span><br />
      <span class="post-time small text-muted">20th April 2009 03:19 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">nsfis,<br />
      <br />
      Yes I did, it was the very first thing I considered actually. :D</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">bedbuffer</span><br />
      <span class="post-time small text-muted">20th April 2009 06:57 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Last Friday, I just finished creating the installer and it works perfectly with Vista and XP. It sets the installation folder depending on the level of priviledge the user has (admin, user, etc...) and it also bypasses the UAC prompt in Vista.<br />
      <br />
      Thanks...</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">bedbuffer</span><br />
      <span class="post-time small text-muted">20th April 2009 10:17 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Do you guys know how to create a software updater? one that silently installs...</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">bedbuffer</span><br />
      <span class="post-time small text-muted">22nd April 2009 09:44 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">I just figured how to... thanks... :D</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">ethanchen</span><br />
      <span class="post-time small text-muted">30th April 2009 10:26 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">hi bedbuffer, would you show how to do it?</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">bedbuffer</span><br />
      <span class="post-time small text-muted">6th May 2009 07:21 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">yes, just check the vpatch sample included in the nsis package. That's how I made the updater...</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">bedbuffer</span><br />
      <span class="post-time small text-muted">6th May 2009 07:58 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">also, add a line that would read the registry entry of your app (location of the app) so it would know where to install the updates....</p>
    </div>
    <hr />

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]>
  </script>
</body>
</html>
