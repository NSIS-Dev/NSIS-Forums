<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="description" content="Page calling command"><title>Page calling command - NSIS Forums</title><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script><link rel="preload" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css" as="style" onload="this.rel='stylesheet'"><link rel="preload" href="../css/style.css" as="style" onload="this.rel='stylesheet'"><noscript><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css"><link rel="stylesheet" href="../css/style.css"></noscript><script>!function(a){"use strict";var b=function(b,c,d){function e(a){return h.body?a():void setTimeout(function(){e(a)})}function f(){i.addEventListener&&i.removeEventListener("load",f),i.media=d||"all"}var g,h=a.document,i=h.createElement("link");if(c)g=c;else{var j=(h.body||h.getElementsByTagName("head")[0]).childNodes;g=j[j.length-1]}var k=h.styleSheets;i.rel="stylesheet",i.href=b,i.media="only x",e(function(){g.parentNode.insertBefore(i,c?g:g.nextSibling)});var l=function(a){for(var b=i.href,c=k.length;c--;)if(k[c].href===b)return a();setTimeout(function(){l(a)})};return i.addEventListener&&i.addEventListener("load",f),i.onloadcssdefined=l,l(f),i};"undefined"!=typeof exports?exports.loadCSS=b:a.loadCSS=b}("undefined"!=typeof global?global:this);!function(a){if(a.loadCSS){var b=loadCSS.relpreload={};if(b.support=function(){try{return a.document.createElement("link").relList.supports("preload")}catch(b){return!1}},b.poly=function(){for(var b=a.document.getElementsByTagName("link"),c=0;c<b.length;c++){var d=b[c];"preload"===d.rel&&"style"===d.getAttribute("as")&&(a.loadCSS(d.href,d,d.getAttribute("media")),d.rel=null)}},!b.support()){b.poly();var c=a.setInterval(b.poly,300);a.addEventListener&&a.addEventListener("load",function(){b.poly(),a.clearInterval(c)}),a.attachEvent&&a.attachEvent("onload",function(){a.clearInterval(c)})}}}(this);</script></head><body><div class="container"><ol class="breadcrumb"><li><a href="../index.html" class="glyphicon glyphicon-home"></a></li><li><a href="f-65.html">NSIS Discussion</a></li><li class="active">Page calling command</li></ol><p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=138025">Page calling command</a></p><br><div class="post"><p class="post-meta"><span class="post-author text-primary">khal_nayak</span><br><span class="post-time small text-muted">6th June 2003 01:15 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>Page calling command</strong><br>how to call or take the user back to a specific page of the installer by just specifing some command in the section?<br>I mean when u specify some command in a section and when the user selects the components and clicks next, the installation starts. What i want is that if the user selects a specific section then during installation, a msgbox should appear on clicking which the user be send to some previous page of the installer, eg:license, welcome, component. So then what command is there to make the user jump to diffrent pages?</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">iceman_k</span><br><span class="post-time small text-muted">6th June 2003 02:02 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">None really that I know of.<br>You may be able to go to the next or previous page by sending a WM_COMMAND message to the window with the ID of the next or previous button. Never tried it, so I don't know if it will work.<br>BTW, like your nick. :D</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">kichik</span><br><span class="post-time small text-muted">6th June 2003 10:37 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">You can add another page after the instfiles page and skip it if the user hasn't selected the right component.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">khal_nayak</span><br><span class="post-time small text-muted">6th June 2003 11:02 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">is it possible to disable the next button on the components page if the user doesnt select the appropriate install type from the drop down list?</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">kichik</span><br><span class="post-time small text-muted">6th June 2003 11:06 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">It's not possible to disable it, but it's possible to not allow the user to continue. Call Abort from the leave function of the page and the user won't be able to move on.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">khal_nayak</span><br><span class="post-time small text-muted">6th June 2003 17:08 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">im not so good at scripting the NSIS so can u plz type in that part of the script so i know what u exactly mean.<br>Secondly, in my installer there r some exe files which while installing update some older version of them on the computer but the problem is u cant update a dll or exe file if it is already running in the background or foreground so then is it possible to detect that such files r running and that the installer can close such running programs and then update the file and then make it run again using exec? Like what the msn messenger installer has, it closes the msn that is running in the system tray and then updates the exe file and then runs it again?</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">kichik</span><br><span class="post-time small text-muted">7th June 2003 10:25 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">As for the leave function:<br><br></p><pre>
<code>Page components "" "" compLeave<br>#...<br>!include Sections.nsh<br>Function compLeave<br>  # make sure ${mySec} is defined!<br>  SectionGetFlags ${mySec} $0<br>  IntOp $0 $0 &amp; ${SF_SELECTED}<br>  StrCmp $0 ${SF_SELECTED} ok<br>    # the user didn't select the required section,<br>    # don't let him leave the page<br>    Abort<br>  ok:<br>FunctionEnd</code>
</pre><br>
      <br>
      In case you're using the MUI see the MUI readme about defining a leave function for the components page.<br>
      <br>
      As for updating in use DLLs, use the <a href="http://nsis.sourceforge.net/Docs/AppendixB.html#B.11" target="_blank">UpgradeDLL macro</a>.<br>
      <br>
      I don't know how to close messenger yet. There is a recent thread about it. I really recommend you don't use the process termination method though, it's far from being the ideal way. There are also some other less recent threads about closing programs, some linked from that thread.
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">khal_nayak</span><br>
      <span class="post-time small text-muted">7th June 2003 16:52 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">thanx m8, i finally got the script working my way.<br>
      Plz keep me informed if u get any news bout some way to close running exe files and progs.</p>
    </div>
    <hr>

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script type="text/javascript" src="../js/highlight.pack.js" async>
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]></script></body></html>