<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="How to have the user select what type of install?" />

  <title>How to have the user select what type of install? - NSIS Forums</title><!-- Bootstrap core CSS -->
  <link rel="stylesheet" type="text/css" href="//netdna.bootstrapcdn.com/bootswatch/3.0.1/readable/bootstrap.min.css" />
  <link rel="stylesheet" href="../css/style.css" type="text/css" /><!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!--[if lt IE 9]>
                <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
                <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->
</head>

<body>
  <div class="container">
    <!-- Put navigation bar here -->

    <ol class="breadcrumb">
      <li><a href="../index.html" class="glyphicon glyphicon-home"></a></li>

      <li><a href="f-65.html">NSIS Discussion</a></li>

      <li class="active">How to have the user select what type of install?</li>
    </ol>

    <p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=335839">How to have the user select what type of install?</a></p><br />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">hobbes487</span><br />
      <span class="post-time small text-muted">11th October 2011 17:43 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>How to have the user select what type of install?</strong><br />
      I have an application that has client and server components to it. I want the user to be able to choose which one to install and depending on what they choose, different actions will be taken. i.e. Install different files, call other apps, etc. I have an nsis script working that will install the server components, but I need to add a choice and a way to only install certain things. Any help would be great or at least point me to an example that does something like this.<br />
      <br />
      Here is my current script:<br />
      <br /></p>
      <pre>
<code>;--------------------------------<br />;Includes<br /><br />  !include "MUI2.nsh"<br />  !include "InstallOptions.nsh"<br />  !include "fileassoc.nsh"<br />  !include "LogicLib.nsh"<br />  !include "x64.nsh"<br /><br />;--------------------------------<br />;General<br /><br />  ;Name and file<br />  Name "Open Source Automation"<br />  OutFile "OSA Setup v0.3.2.exe"<br /><br />  ;Default installation folder<br />  InstallDir "C:\OSA"<br />  <br />;--------------------------------<br />;Interface Settings<br /><br />  !define MUI_ABORTWARNING  <br /><br />  CRCCheck on<br />  XPStyle on <br />  <br />  ShowInstDetails show<br />  <br />  BrandingText "OSA Installer"<br />  <br />  <br /><br />;--------------------------------<br />;Pages<br /><br />  !insertmacro MUI_PAGE_LICENSE "License.txt"<br />  #!insertmacro MUI_PAGE_COMPONENTS<br />  <br />  !insertmacro MUI_PAGE_DIRECTORY<br />  <br />  !insertmacro MUI_PAGE_INSTFILES<br />  !insertmacro MUI_UNPAGE_CONFIRM<br />  !insertmacro MUI_UNPAGE_INSTFILES<br />  <br />;--------------------------------<br />;Languages<br /> <br />  !insertmacro MUI_LANGUAGE "English"<br /><br />;--------------------------------<br />;Installer Sections<br /> <br />; These are the programs that are needed by OSA.<br />Section -Prerequisites<br />  SetOutPath $INSTDIR<br />  IfFileExists "$WINDIR\Microsoft.NET\Framework\v4.0*" NETFrameworkInstalled 0<br />    File "dotNetFx40_Full_setup.exe"<br />    ExecWait "$INSTDIR\dotNetFx40_Full_setup.exe"<br />    Goto endNet<br />  NETFrameworkInstalled:<br />    DetailPrint "Microsoft .NET Framework is already installed!"<br />  endNet:<br />  ${If} ${RunningX64}<br />    ReadRegStr $0 HKLM "SOFTWARE\Microsoft\VisualStudio\10.0\VC\VCRedist\x64" 'Installed'<br />    ${If} $0 == 1<br />      DetailPrint "VC++ 2011 Redist. already installed"<br />    ${Else}<br />    DetailPrint $0<br />      File "vcredist_x64.exe"<br />      ExecWait "$INSTDIR\vcredist_x64.exe"<br />      Delete "$INSTDIR\vcredist_x64.exe"<br />      Goto endVC  <br />    ${EndIf}<br />  ${Else}<br />    ReadRegStr $0 HKLM "SOFTWARE\Microsoft\VisualStudio\10.0\VC\VCRedist\x86" 'Installed'<br />    ${If} $0 == 1<br />      DetailPrint "VC++ 2011 Redist. already installed"<br />    ${Else}<br />    DetailPrint $0<br />      File "vcredist_x86.exe"<br />      ExecWait "$INSTDIR\vcredist_x86.exe"<br />      Delete "$INSTDIR\vcredist_x86.exe"<br />      Goto endVC  <br />    ${EndIf}<br />  ${EndIf}<br />  endVC:<br />  IfFileExists "$PROGRAMFILES\MySQL" MySqlInstalled 0<br />    MessageBox MB_YESNO "Install MySql?" /SD IDYES IDNO endMysql<br />    File "mysql-essential-5.1.50-win32.msi"<br />    ;File "mysql-workbench-gpl-5.2.34.2-win32.msi"<br />    ExecWait 'msiexec /q /log $INSTDIR\MySQLINstall.log /i mysql-essential-5.1.50-win32.msi installdir="$PROGRAMFILES\MySql"'<br />    ExecWait 'msiexec /q /log $INSTDIR\MySQLWKINstall.log /i mysql-workbench-gpl-5.2.34.2-win32.msi'<br />    SetOutPath "$PROGRAMFILES\MySql"<br />    File "my.ini"<br />    ExecWait '"$PROGRAMFILES\MySql\bin\mysqld.exe" --install MySQL --defaults-file="$PROGRAMFILES\MySql\my.ini"'<br />    ExecWait '"$PROGRAMFILES\MySql\bin\MySQLInstanceConfig.exe" -i -q "-lc:mysql_install_log.txt" ServerType=DEVELOPMENT DatabaseType=MIXED ConnectionUsage=DSS Port=3306 RootPassword=password'<br />    ExecWait "net start MySql"<br />    ExecWait '"$PROGRAMFILES\MySql\bin\mysql" -uroot -ppassword --execute "CREATE USER `root`@`%` IDENTIFIED BY $\'password$\'";'<br />    ExecWait '"$PROGRAMFILES\MySql\bin\mysql" -uroot -ppassword --execute "GRANT ALL ON *.* TO `root`@`%`";'<br />    Goto endMysql<br />  MySqlInstalled:<br />    DetailPrint "MySql is already installed!"<br />  endMysql: <br />  Delete "$INSTDIR\dotNetFx40_Full_setup.exe"<br />  Delete "$INSTDIR\mysql-essential-5.1.50-win32.msi"<br />  ;Delete "$INSTDIR\mysql-workbench-gpl-5.2.34.2-win32.msi"<br />SectionEnd<br /><br />Section "Open Source Automation Engine" SecDummy<br />  ${If} ${RunningX64} <br />     SetRegView 64 <br />  ${EndIf}<br />  <br />  SetOutPath "$INSTDIR"<br />  <br />  File "..\DB\0.2.0-0.3.0.sql"<br />  File "..\DB\0.3.0-0.3.1.sql"<br /><br />  File "..\output\ICSharpCode.SharpZipLib.dll"<br />  File "MySql.Data.dll"<br />  File "..\output\OSAE Manager.exe"<br />  File "..\output\OSAE Manager.exe.config"<br />  File "..\output\lib\OSAE.api.dll"<br />  File "..\output\OSAE.GUI.exe"<br />  File "..\output\OSAEService.exe"<br />  File "..\output\OSAEService.exe.config"<br />  File "..\output\PluginDescriptionEditor.exe"<br />  File "..\output\PluginInstaller.exe"<br />  File "..\output\HostView.dll"<br />  File "..\DB\osae.sql"<br />  ;File "..\output\vr.exe"<br />  CreateDirectory "Sounds"<br />  CreateDirectory "Logs"<br />  CreateDirectory "Images"<br />  CreateDirectory "AddIns"<br />  CreateDirectory "wwwroot"<br />  CreateDirectory "AddInSideAdapters"<br />  CreateDirectory "AddInViews"<br />  CreateDirectory "contracts"<br />  CreateDirectory "HostSideAdapters"<br />  CreateDirectory "lib"<br />  <br />  SetOutPath "$INSTDIR\lib"<br />  File "..\output\lib\OSAE.api.dll"<br />  File "MySql.Data.dll"<br />  <br />  SetOutPath "$INSTDIR\AddInSideAdapters"<br />  File "..\output\AddInSideAdapters\Template.dll"<br />  <br />  SetOutPath "$INSTDIR\AddInViews"<br />  File "..\output\AddInViews\AddInView.dll"<br />  <br />  SetOutPath "$INSTDIR\contracts"<br />  File "..\output\contracts\OpenSourceAutomation.Contract.dll"<br />  <br />  SetOutPath "$INSTDIR\HostSideAdapters"<br />  File "..\output\HostSideAdapters\Template.dll"<br />  <br />  SetOutPath "$INSTDIR\wwwroot"<br />  File "..\output\wwwroot\*.*"<br />  CreateDirectory "includes"<br />  CreateDirectory "mobile"<br />  CreateDirectory "images"<br />  <br />  SetOutPath "$INSTDIR\wwwroot\includes"<br />  File "..\output\wwwroot\includes\*.*"<br />  SetOutPath "$INSTDIR\wwwroot\images"<br />  File "..\output\Images\*.jpg"<br />  File "..\output\Images\*.png"<br />  SetOutPath "$INSTDIR\wwwroot\mobile"<br />  File "..\output\wwwroot\mobile\*.*"<br />  <br />  CreateDirectory "includes"<br />  CreateDirectory "css"<br />  CreateDirectory "js"<br />  SetOutPath "$INSTDIR\wwwroot\mobile\includes"<br />  File "..\output\wwwroot\mobile\includes\*.*"<br />  SetOutPath "$INSTDIR\wwwroot\mobile\js"<br />  File "..\output\wwwroot\mobile\js\*.*"<br />  SetOutPath "$INSTDIR\wwwroot\mobile\css"<br />  File "..\output\wwwroot\mobile\css\*.*"<br />  <br />  CreateDirectory "images"<br />  SetOutPath "$INSTDIR\wwwroot\mobile\css\images"<br />  File "..\output\wwwroot\mobile\css\images\*.*"<br />  <br />  SetOutPath "$INSTDIR\Logs"<br />  <br />  SetOutPath "$INSTDIR\Images"<br />  File "..\output\Images\*.jpg"<br />  File "..\output\Images\*.png" <br />  <br />  SetOutPath "$INSTDIR\AddIns"<br />  CreateDirectory "Bluetooth"<br />  CreateDirectory "Email"<br />  CreateDirectory "Jabber"<br />  CreateDirectory "Network Monitor"<br />  CreateDirectory "Script Processor"<br />  CreateDirectory "Speech"<br />  CreateDirectory "Weather"<br />  CreateDirectory "Web Server"<br />  <br />  SetOutPath "$INSTDIR\AddIns\Bluetooth"<br />  File "..\output\AddIns\Bluetooth\Bluetooth.osapd"<br />  File "..\output\AddIns\Bluetooth\OSAE.Bluetooth.dll"<br />  File "..\output\AddIns\Bluetooth\InTheHand.Net.Personal.dll"<br />    <br />  SetOutPath "$INSTDIR\AddIns\Email"<br />  File "..\output\AddIns\Email\Email.osapd"<br />  File "..\output\AddIns\Email\OSAE.Email.dll"<br />  <br />  SetOutPath "$INSTDIR\AddIns\Jabber"<br />  File "..\output\AddIns\Jabber\Jabber.osapd"<br />  File "..\output\AddIns\Jabber\OSAE.Jabber.dll"<br />  File "..\output\AddIns\Jabber\agsXMPP.dll"<br />    <br />  SetOutPath "$INSTDIR\AddIns\Network Monitor"<br />  File "..\output\AddIns\Network Monitor\Network Monitor.osapd"<br />  File "..\output\AddIns\Network Monitor\OSAE.NetworkMonitor.dll"<br />  <br />  SetOutPath "$INSTDIR\AddIns\Script Processor"<br />  File "..\output\AddIns\Script Processor\Script Processor.osapd"<br />  File "..\output\AddIns\Script Processor\OSAE.ScriptProcessor.dll"<br />  <br />  SetOutPath "$INSTDIR\AddIns\Speech"<br />  File "..\output\AddIns\Speech\Speech.osapd"<br />  File "..\output\AddIns\Speech\OSAE.Speech.dll"<br />  <br />  SetOutPath "$INSTDIR\AddIns\Weather"<br />  File "..\output\AddIns\Weather\Weather.osapd"<br />  File "..\output\AddIns\Weather\OSAE.Weather.dll"  <br /><br />  SetOutPath "$INSTDIR\AddIns\Web Server"<br />  File "..\output\AddIns\Web Server\Web Server.osapd"<br />  File "..\output\AddIns\Web Server\OSAE.WebServer.dll"  <br />  File "..\output\AddIns\Web Server\HttpServer.dll"<br /><br />  SetOutPath "C:\"<br />  CreateDirectory "PHP"<br />  SetOutPath "C:\PHP"<br />  CreateDirectory "ext"<br />  File "php-cgi.exe"<br />  File "php5.dll"<br />  File "php.ini"<br />  SetOutPath "C:\PHP\ext"<br />  File "php_mysql.dll"<br /><br />  # Start Menu Shortcuts<br />  #SetShellVarContext all<br />  createShortCut "$SMPROGRAMS\OSA\Manager.lnk" "$INSTDIR\OSAE Manager.exe"<br />  createShortCut "$SMPROGRAMS\OSA\Uninstall.lnk" "$INSTDIR\uninstall.exe"<br />  createShortCut "$SMPROGRAMS\OSA\OSAE.GUI.lnk" "$INSTDIR\OSAE.GUI.exe"<br /><br />  #SetShellVarContext all<br />  #ShellLink::SetRunAsAdministrator "$SMPROGRAMS\OSA\Manager.lnk"<br />  #Pop $0<br />  <br />  SimpleSC::InstallService "OSAE" "OSAE Service" "16" "2" "$INSTDIR\OSAEService.exe" "" "" ""<br />  Pop $0 ; returns an errorcode (&lt;&gt;0) otherwise success (0)<br /><br />  WriteRegStr HKLM "SOFTWARE\OSAE\DBSETTINGS" "INSTALLDIR" "$INSTDIR"<br />  <br />  !insertmacro APP_ASSOCIATE "osapd" "OSA.osapd" "Plugin Description" "$INSTDIR\PluginDescriptionEditor.exe,0" "Open" "$INSTDIR\PluginDescriptionEditor.exe $\"%1$\""  <br />  !insertmacro APP_ASSOCIATE "osapp" "OSA.osapp" "Plugin Package" "$INSTDIR\PluginInstaller.exe,0" "Open" "$INSTDIR\PluginInstaller.exe $\"%1$\"" <br />  !insertmacro UPDATEFILEASSOC    <br />  <br />  AccessControl::GrantOnFile \<br />    "$INSTDIR" "(BU)" "GenericRead + GenericWrite"<br />    <br />   writeUninstaller $INSTDIR\uninstall.exe<br />SectionEnd<br /><br />Section GAC<br />  SetOutPath $INSTDIR<br />  File "DBInstall\GAC\bin\Debug\GAC.exe"<br />  ExecWait "$INSTDIR\GAC.exe"<br />  Goto endGAC<br />  endGAC:<br />  Delete "$INSTDIR\GAC.exe"<br />SectionEnd<br /><br />Section DBInstall<br />  SetOutPath $INSTDIR<br />  File "DBInstall\DBInstall\bin\Debug\DBInstall.exe"<br />  ExecWait "$INSTDIR\DBInstall.exe $INSTDIR"<br />  Goto endDBInstall<br />  endDBInstall:   <br />  Delete "$INSTDIR\DBInstall.exe"<br />SectionEnd<br /><br />;--------------------------------<br />;Uninstaller Section<br /><br />Section "Uninstall"<br /><br />  Delete "$INSTDIR\Uninstall.exe"<br />  Delete "$SMPROGRAMS\OSA\Manager.lnk"<br />  Delete "$SMPROGRAMS\OSA\Uninstall.lnk"<br />  Delete "$SMPROGRAMS\OSA\OSAE.GUI.lnk"<br />  Delete "$SMPROGRAMS\OSA\DevTools.lnk"<br />  RMDir /r "$SMPROGRAMS\OSA"<br />  !insertmacro APP_UNASSOCIATE "osapd" "OSA.osapd"<br />  !insertmacro APP_UNASSOCIATE "osapp" "OSA.osapp"<br />  Delete $INSTDIR\*.*<br />  RMDir /r $INSTDIR<br />  SimpleSC::RemoveService "OSAE"<br />  Pop $0<br /><br />SectionEnd<br /><br /></code>
</pre>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">LoRd_MuldeR</span><br />
      <span class="post-time small text-muted">11th October 2011 17:54 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Use <b>InstType</b> with /NOCUSTOM flag.<br />
      <br />
      Make two InstTypes, e.g. "Server" and "Client", and then use <b>SectionIn</b> to assign your sections accordingly.<br />
      <br />
      For details look at the scripting reference manual :)</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">MSG</span><br />
      <span class="post-time small text-muted">12th October 2011 07:07 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">(In the future, please don't paste huge amounts of code like that. Use an attachment or pastebin.)</p>
    </div>
    <hr />

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]>
  </script>
</body>
</html>
