<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="inetload not passing info to MUI ?" />

  <title>inetload not passing info to MUI ? - NSIS Forums</title>
  <script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script>
  <!-- Bootstrap core CSS -->

  <link rel="stylesheet" type="text/css" href="//netdna.bootstrapcdn.com/bootswatch/3.0.1/readable/bootstrap.min.css" />
  <link rel="stylesheet" href="../css/style.css" type="text/css" /><!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!--[if lt IE 9]>
                <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
                <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->
</head>

<body>
  <div class="container">
    <!-- Put navigation bar here -->

    <ol class="breadcrumb">
      <li><a href="../index.html" class="glyphicon glyphicon-home"></a></li>

      <li><a href="f-65.html">NSIS Discussion</a></li>

      <li class="active">inetload not passing info to MUI ?</li>
    </ol>

    <p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=219181">inetload not passing info to MUI ?</a></p><br />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">grahama</span><br />
      <span class="post-time small text-muted">18th June 2005 20:54 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>inetload not passing info to MUI ?</strong><br />
      Is there a way to force InetLoad to pass its stuff to the MUI? something like: /MUI or /NSIS<br />
      <br />
      For some odd reason,since I converted to logiclib, inetload is not passing downloads to the MUI. Instead, InetLoad is treating the below as a /BANNER. I ran the code in a clean test project and it works fine, so there must be a variable conflicting with InetLoad with my current project?<br />
      <br />
      InetLoad::load "$source" "$destination" /END<br />
      Pop $0<br />
      ${IF} $0 != "OK"<br />
      MessageBox MB_OK|MB_ICONEXCLAMATION|MB_TOPMOST \<br />
      "Download Error: $0 for file: $theFile, \<br />
      Click OK to abort installation" IDOK<br />
      Abort<br />
      ${ENDIF</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">grahama</span><br />
      <span class="post-time small text-muted">18th June 2005 22:14 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">On that note:<br />
      be great if setting the Mode would overide all the variables passed to inetLoad ...like $title and $bannerText<br />
      Then you could build a very handy generic download function<br />
      <br />
      this below code works....but only if the mode = "/Banner"<br />
      <br />
      Be great to input variables for inetLoad to process<br />
      So if $mode = "", only the $source and $dest variables are passed while $title and $bannerText is ignored<br />
      <br />
      the code:<br />
      strcpy $theFile "version.xml"<br />
      strcpy $source "http://www.server.cc/$theFile"<br />
      strcpy $dest "$PLUGINSDIR\$theFile"<br />
      strcpy $bannerText "Checking for Updates...Please Wait"<br />
      strcpy $mode "/BANNER"<br />
      strcpy $title "My Title"<br />
      ;<br />
      InetLoad::load "$mode" \<br />
      "$title" "$bannerText" \<br />
      "$source" "$dest" /END<br />
      Pop $0<br />
      ${IF} $0 != "OK"<br />
      MessageBox MB_OK|MB_ICONEXCLAMATION|MB_TOPMOST \<br />
      "Download Error: $0 for file: $theFile, \<br />
      Click OK to abort installation" IDOK<br />
      Abort<br />
      ${ENDIF}</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Takhir</span><br />
      <span class="post-time small text-muted">19th June 2005 10:08 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">InetLoad worked fine with Modern UI in my tests. The only szBanner string definition comes to plug-in with /banner option, and not empty szBanner string is the only case when Banner dialog is active. Your problem really looks like a messed variables in your code (and may be LogicLib macros).<br />
      /mode - I don't see what improvement this may give. And BTW /popup mode requires one string parameter (prefix), but /banner - 2 strings (caption and text), this case I'll need to add second empty parameter for /popup.. I am not sure right now if this is a real step forward :)</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">grahama</span><br />
      <span class="post-time small text-muted">19th June 2005 15:46 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">is there a specific variable I need to clear out in NSIS before I call inetLoad ... kind of like the /END variable does? Is this the $szBanner variable?<br />
      strcpy $szBanner "", then call inetLoad<br />
      <br />
      I thought about the above and then put the above into a CASE statement with $mode....Case "/POPUP", Case "/BANNER"<br />
      this works pretty well as I sometimes use inetload in the .oInit and sometimes in sections :)<br />
      <br />
      be back in a week, as I am now off to the Grand Canyone for a white water vacation :) Full week of being totally unplugged...</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Takhir</span><br />
      <span class="post-time small text-muted">19th June 2005 16:44 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">No, szBanner is internal C variable in the InetLoad.c file. The only parameter plug-in takes from installer is extra-&gt;exec_flags-&gt;silent mode.<br />
      Off: ;) I already had 2 weeks of the 'spring bike vacations' - 900 km of mountain roads, Caucasus and Crimea <a href="http://ineum.narod*****g05s.htm" target="_blank">http://ineum.narod*****g05s.htm</a></p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">grahama</span><br />
      <span class="post-time small text-muted">27th June 2005 23:52 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Hi Takhir<br />
      I'm back from a week of class 5 rapids,flash floods, hail, and 11 mile uphill hikes :) From looking at your pictures, Caucasus and Crimea look quite beautiful.<br />
      <br />
      I still can't seem to keep inetload from using /BANNER mode :( I tried using /POPUP too...but still get /BANNER. As an alternative, nsisdl:download works fine, but I am quite wary of using it as I have had many problems with this plugin.<br />
      <br />
      is there no way to totally reset inetload or force it to pass info to the MUI<br />
      <br />
      Or, for those who use LogicLib, is there some way to clear its variables so they do not conflict with inetLoad ?<br />
      My problems began the moment I began using LogicLib<br />
      In a simple example, LogicLib and inetLoad work fine. So, I am not sure where the error is....<br />
      <br />
      guess I'll also see if there is a new version of LogicLib. Would really like to continue using it as it really simplifes the code<br />
      g</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">grahama</span><br />
      <span class="post-time small text-muted">28th June 2005 01:27 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">within my project I killed all the variables like "$sourceURL/$theFile" in inetLoad and used a simple inetload::load "sourceUrl" "destination" /END<br />
      <br />
      I'm still getting the /BANNER ?<br />
      this debug is getting a bit baffling<br />
      would hate to rebuild the entire project if clearing a couple of variables would do the trick</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Takhir</span><br />
      <span class="post-time small text-muted">28th June 2005 06:49 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Can you give me a script with this problem? Please minimize it's size if possible.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">ElvenProgrammer</span><br />
      <span class="post-time small text-muted">28th June 2005 06:58 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">I had this problem when I wrong typed the name of a temp copy of the setup to be run. This way the temp copy wasn't updated but run, not receiving my modifications to the code. Maybe it could be the case, if not post further code ;)</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">grahama</span><br />
      <span class="post-time small text-muted">28th June 2005 18:50 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">I finally got it....<br />
      Thinking this would take hours, I disabled the first function run in the .onInit....<br />
      What do you know, everything returned to normal. :)<br />
      Being on a deadline for this project, I have moved on to finish . Will probably get back to the WHY in two days as I would like to put this function back in the onInit.<br />
      Anyone know what would conflict here ?<br />
      <br />
      the conflicting funtion:<br />
      Function preventLaunchingTwice<br />
      System::Call 'kernel32::CreateMutexA(i 0, i 0, t "myMutex") i .r1 ?e'<br />
      Pop $R0<br />
      StrCmp $R0 0 +3<br />
      MessageBox MB_OK|MB_TOPMOST "The installer is already running."<br />
      Abort<br />
      FunctionEnd<br />
      ;--------------------<br />
      <br />
      here is a script I am using for inetload...it is pretty simple, but has come in handy for me as I use inetload for all sorts of things :)<br />
      <br />
      Function GenericDownload<br />
      <br />
      /*<br />
      Example Variables<br />
      strcpy $theFile "version.xml"<br />
      strcpy $source "$xmlDirectory/$theFile"<br />
      strcpy $dest "$PLUGINSDIR\$theFile"<br />
      strcpy $title "${FILETITLE}"<br />
      strcpy $bannerText "Downloading ${FILETITLE}...Please Wait"<br />
      strcpy $mode "/POPUP" | "" | "/BANNER" | "nsisdl"<br />
      */<br />
      <br />
      ${Select} $mode<br />
      ${Case} ""<br />
      InetLoad::load "$source" "$dest" /END<br />
      ${Case} "nsisdl"<br />
      NSISdl::download /TIMEOUT=30000 $source $dest<br />
      POP $R0<br />
      strcpy $0 $R0<br />
      ${Case} "/BANNER"<br />
      InetLoad::load "$mode" "$title" "$bannerText" \ $source" "$dest" /END<br />
      ${Case} "/POPUP"<br />
      InetLoad::load "$mode" "${FILETITLE}" \<br />
      "$source" "$dest" /END<br />
      ${EndSelect}<br />
      ;<br />
      Pop $0<br />
      ${IF} $0 != "OK"<br />
      MessageBox MB_OK|MB_ICONEXCLAMATION|MB_TOPMOST "Download Error: $0 for file: $theFile, \<br />
      Click OK to abort installation" IDOK<br />
      Abort<br />
      ${ENDIF}<br />
      FunctionEND<br />
      <br />
      I'm sure its not flawless but it has helped me reduced my code bloat a bit.<br />
      <br />
      what would be cool...maybe a future nsis thing for functions:<br />
      Call GenericDownload($mode,$title,$bannerText,$source,$dest)</p>
    </div>
    <hr />

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]>
  </script>
</body>
</html>
