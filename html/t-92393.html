<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="description" content="Couple of newbie questions"><title>Couple of newbie questions - NSIS Forums</title><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script><link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css"><link rel="stylesheet" href="../css/style.css" type="text/css"></head><body><div class="container"><ol class="breadcrumb"><li><a href="../index.html" class="glyphicon glyphicon-home"></a></li><li><a href="f-65.html">NSIS Discussion</a></li><li class="active">Couple of newbie questions</li></ol><p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=92393">Couple of newbie questions</a></p><br><div class="post"><p class="post-meta"><span class="post-author text-primary">Daab</span><br><span class="post-time small text-muted">26th June 2002 10:01 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>Couple of newbie questions</strong><br>Hi all, I have a couple of questions:<br><br>1. When I use Exec and ExecWait - what is their default directory if I don't specify an absolute path (as far as I could see it isn't $OUTDIR)<br><br>2. Is there an existing way in NSIS 1.98 to detect the computer's IP address, or can anyone think of an easy way to parse "ipconfig"'s output into a variable?<br><br>Thanks!</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Smile2Me</span><br><span class="post-time small text-muted">26th June 2002 17:27 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">1) the currentdir, so $EXEDIR. The current dir becomes $OUTDIR if SetOutPath has been called.<br><br>2) not available in NSIS 1.98. But you can log the output of ipconfig to file using "ipconfig &gt; ip.txt" and then analyse the file. Remember that the structure of this file depends on the setup of the network/internet connection and on the language of the system. So it's difficult to get the ipaddress (for internetconnection, not network connection) from this.<br>I will write a NSISdll for it. Wait a sec...<br><br>-Hendri.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Smile2Me</span><br><span class="post-time small text-muted">26th June 2002 19:12 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Here's a dll to retrieve the IP-addresses of a computer. I just copied code from some website (and modified it to suit our needs). This code also retrieves IP-addresses of a computer on a network. I wouldn't know how to distinguish these from internet IP-addresses. But it works already. See the attachment.<br><br>Good luck,<br>-Hendri.<br><br>[edit]<br>Searching also resulted in this thread:<br><a href="http://forums.winamp.com/showthread.php?s=&amp;threadid=74526&amp;highlight=ip" target="_blank">http://forums.winamp.com/showthread....6&amp;highlight=ip</a> also states what I discussed above. Best solution there: use ipconfig or a dll :). Good luck with the dll.<br>-Hn3.<br>[/edit]</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Daab</span><br><span class="post-time small text-muted">27th June 2002 09:01 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">This is great, thanks!</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Smile2Me</span><br><span class="post-time small text-muted">27th June 2002 09:14 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">You're welcome :D.<br><br>Greetz,<br>-Hendri.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Smile2Me</span><br><span class="post-time small text-muted">27th June 2002 17:21 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">I rescripted the function a bit to allow for a better integration of the IP.dll in new scripts. Check the source.<br><br>[edit]<br>A tiny test on a stand-alone (not connected to this world) showed that the dll returned IP-address 127.0.0.1. Maybe this could be the hint from which we can conclude that there is no connection. Sincerely, I do not know that much about (assigning) IP-addresses. I know how to set up a small local network but beyond that, I cannot help. Good luck!<br>-Hn3.<br>[/edit]<br><br>Have fun, good luck,<br>-Hendri.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Joost Verburg</span><br><span class="post-time small text-muted">27th June 2002 22:58 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"></p><blockquote><i>Originally posted by Smile2Me</i><br>This code also retrieves IP-addresses of a computer on a network. I wouldn't know how to distinguish these from internet IP-addresses. But it works already. See the attachment.</blockquote>These ranges are for local networks:<br><br>10.x.x.x / 255.0.0.0<br>172.16.x.x / 255.255.0.0 to 172.31.x.x / 255.255.0.0<br>192.168.x.x / 255.255.255.0<br>169.254.x.x / 255.255.0.0</div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Smile2Me</span><br><span class="post-time small text-muted">28th June 2002 08:07 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Thanks a lot Joost,<br><br>see the function I scripted using your information. Now the script provides two functions:<br>GetNextIp<br>CheckIP<br><br><b>[Important edit]</b><br>I added the rangecheck 127.x.x.x. I found additional information on <a href="http://home.t-online.de/home/TschiTschi/ip_adressierung.htm" target="_blank">this</a> (German) site about "LoopBack" addresses. <i>Important: the range 169.254.x.x is not mentioned there as being a LAN range.</i> Could you please verify that it indeed is, Joost? Thanks in advance.<br>Untill further information, I include it in the range check, since I think I remember seeing 169.254.x.x on a network a long time ago, but I'm not sure of that.<br>-Hn3.<br><b>[/edit]</b><br><br>See the example for more information.<br><br>Have fun, good luck,<br>-Hendri.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Joost Verburg</span><br><span class="post-time small text-muted">28th June 2002 20:38 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"></p><blockquote><i>Originally posted by Smile2Me</i><br><b>Thanks a lot Joost,<br><br>see the function I scripted using your information. Now the script provides two functions:<br>GetNextIp<br>CheckIP<br><br></b>[Important edit]<br>I added the rangecheck 127.x.x.x. I found additional information on <a href="http://home.t-online.de/home/TschiTschi/ip_adressierung.htm" target="_blank">this</a> (German) site about "LoopBack" addresses. <i>Important: the range 169.254.x.x is not mentioned there as being a LAN range.</i> Could you please verify that it indeed is, Joost? Thanks in advance.<br>Untill further information, I include it in the range check, since I think I remember seeing 169.254.x.x on a network a long time ago, but I'm not sure of that.<br>-Hn3.<br><b>[/edit]</b><br><br>See the example for more information.<br><br>Have fun, good luck,<br>-Hendri.</blockquote>127.0.0.1 is just the localhost, so it is not really a network address. 169.254.x.x is an Automatic Private IP Address, which you get when there is no DHCP server available, for example, Windows gives these addresses when you check "Obtain an IP address automatically" and you have no DHCP server.</div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Smile2Me</span><br><span class="post-time small text-muted">29th June 2002 08:54 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Thanks again Joost.<br><br>This is the (I think) final version of the script. The function CheckIP checks for the following types of IP-addresses:<br>1 - LoopBack IP (localhost, indicates no connection to a LAN or to the internet). 2 - Automatic Private IP Address (no DHCP server on LAN).<br>3 - Network IP.<br>4 - Internet IP.<br><br>Have fun again with this, greetz,<br>-Hendri.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Yurik</span><br><span class="post-time small text-muted">19th July 2006 11:18 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>Additional check needed</strong><br>Can you please add a check that parameter is not an IP address? Unfortunately, the current script issues that string 'NOT AN IP ADDRESS' is an internet-type IP.<br><br>Thanks.</p></div><hr><div class="footer"><p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p></div></div><script src="../js/highlight.pack.js" type="text/javascript"></script><script type="text/javascript">//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]></script></body></html>