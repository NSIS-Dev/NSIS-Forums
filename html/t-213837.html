<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="A bug? Naaaa, just a n00b problem: IfFileExists fails." />

  <title>A bug? Naaaa, just a n00b problem: IfFileExists fails. - NSIS Forums</title>
  <script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script>
  <!-- Bootstrap core CSS -->

  <link rel="stylesheet" type="text/css" href="//netdna.bootstrapcdn.com/bootswatch/3.0.1/readable/bootstrap.min.css" />
  <link rel="stylesheet" href="../css/style.css" type="text/css" /><!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!--[if lt IE 9]>
                <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
                <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->
</head>

<body>
  <div class="container">
    <!-- Put navigation bar here -->

    <ol class="breadcrumb">
      <li><a href="../index.html" class="glyphicon glyphicon-home"></a></li>

      <li><a href="f-65.html">NSIS Discussion</a></li>

      <li class="active">A bug? Naaaa, just a n00b problem: IfFileExists fails.</li>
    </ol>

    <p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=213837">A bug? Naaaa, just a n00b problem: IfFileExists fails.</a></p><br />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Lymc</span><br />
      <span class="post-time small text-muted">22nd April 2005 05:02 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>A bug? Naaaa, just a n00b problem: IfFileExists fails.</strong><br />
      I'm checking on the existance of a common Windows dll before installing it if it's not there:<br />
      <br />
      IfFileExists "$SYSDIR\msvcr70.dll" +1<br />
      File "e:\src\archive\msvcr70.dll"<br />
      <br />
      I get an error while trying to open the (existing) file for writing, indicating that the if failed (or rather, succeeded when it should have failed). Does anyone know why?</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Jnuw</span><br />
      <span class="post-time small text-muted">22nd April 2005 05:35 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">It sounds like if the file exists, you want to skip the File command, if so, you need:<br />
      <br />
      IfFileExists "$SYSDIR\msvcr70.dll" <b>+2</b><br />
      File "e:\src\archive\msvcr70.dll"<br />
      <br />
      From the documentation:<br />
      <br />
      4.4 Relative Jumps<br />
      Unlike labels, relative jumps are, as the name suggests, relative to the place they are called from. You can use relative jumps wherever you can use labels. Relative jumps are marked by numbers. +1 jumps to the next instruction (the default advancement), +2 will skip one instruction and go to the second instruction from the current instruction, -2 will jump two instructions backward, and +10 will skip 9 instructions, jumping to the tenth instruction from the current instruction.<br />
      <br />
      An instruction is every command that is executed at run-time, when the installer is running. MessageBox, Goto, GetDLLVersion, FileRead, SetShellVarContext are all instructions. AddSize, Section, SectionGroup, SectionEnd, SetOverwrite (and everything under Compiler Flags), Name, SetFont, LangString, are not instructions because they are executed at compile time.<br />
      <br />
      Examples:<br />
      <br />
      Goto +2<br />
      MessageBox MB_OK "You will never ever see this message box"<br />
      MessageBox MB_OK "The last message was skipped, this one should be shown"</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Lymc</span><br />
      <span class="post-time small text-muted">22nd April 2005 07:38 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Nevermind....</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Lymc</span><br />
      <span class="post-time small text-muted">22nd April 2005 07:41 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Ah, nuts, you're right. I opened your response and didn't see the top line, where you are explaining that I got the number wrong, counting skipped lines instead of just lines. I wrote a long explanation of how those lines seemed to be right to me, and they were, only they weren't mine, they were yours. I thought you were quoting me in the lines, and I made perfect sense to myself, which I often do. Thanks for your help, I appreciate it.<br />
      <br />
      And it won't happen again. :hang:</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Jnuw</span><br />
      <span class="post-time small text-muted">22nd April 2005 14:49 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">No problem, glad i could help.</p>
    </div>
    <hr />

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]>
  </script>
</body>
</html>
