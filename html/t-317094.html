<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="description" content="Order of Start Menu Shortcuts"><title>Order of Start Menu Shortcuts - NSIS Forums</title><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script><link rel="preload" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css" as="style" onload="this.rel='stylesheet'"><link rel="preload" href="../css/style.css" as="style" onload="this.rel='stylesheet'"><noscript><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css"><link rel="stylesheet" href="../css/style.css"></noscript><script>!function(a){"use strict";var b=function(b,c,d){function e(a){return h.body?a():void setTimeout(function(){e(a)})}function f(){i.addEventListener&&i.removeEventListener("load",f),i.media=d||"all"}var g,h=a.document,i=h.createElement("link");if(c)g=c;else{var j=(h.body||h.getElementsByTagName("head")[0]).childNodes;g=j[j.length-1]}var k=h.styleSheets;i.rel="stylesheet",i.href=b,i.media="only x",e(function(){g.parentNode.insertBefore(i,c?g:g.nextSibling)});var l=function(a){for(var b=i.href,c=k.length;c--;)if(k[c].href===b)return a();setTimeout(function(){l(a)})};return i.addEventListener&&i.addEventListener("load",f),i.onloadcssdefined=l,l(f),i};"undefined"!=typeof exports?exports.loadCSS=b:a.loadCSS=b}("undefined"!=typeof global?global:this);!function(a){if(a.loadCSS){var b=loadCSS.relpreload={};if(b.support=function(){try{return a.document.createElement("link").relList.supports("preload")}catch(b){return!1}},b.poly=function(){for(var b=a.document.getElementsByTagName("link"),c=0;c<b.length;c++){var d=b[c];"preload"===d.rel&&"style"===d.getAttribute("as")&&(a.loadCSS(d.href,d,d.getAttribute("media")),d.rel=null)}},!b.support()){b.poly();var c=a.setInterval(b.poly,300);a.addEventListener&&a.addEventListener("load",function(){b.poly(),a.clearInterval(c)}),a.attachEvent&&a.attachEvent("onload",function(){a.clearInterval(c)})}}}(this);</script></head><body><div class="container"><ol class="breadcrumb"><li><a href="../index.html" class="glyphicon glyphicon-home"></a></li><li><a href="f-65.html">NSIS Discussion</a></li><li class="active">Order of Start Menu Shortcuts</li></ol><p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=317094">Order of Start Menu Shortcuts</a></p><br><div class="post"><p class="post-meta"><span class="post-author text-primary">ignacioalex</span><br><span class="post-time small text-muted">17th February 2010 22:09 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>Order of Start Menu Shortcuts</strong><br>Hi all,<br><br>I'd like to configure the order of the shortcuts created in my application's group in the start menu, since Windows is placing them in alphabetical order instead of following the order defined in my script.<br><br>I followed the instructions in this post:<br><br><a href="http://forums.shoutcast.com/showthread.php?postid=2239145" target="_blank">http://forums.shoutcast.com/showthre...postid=2239145</a><br><br>which instructs to write a binary value to the registry:<br>WriteRegBin HKCU "Software\Microsoft\Windows\CurrentVersion\Explorer\MenuOrder\Start Menu\Programs\XYZ" "Order" 00890888003.....<br><br>However this does not fully solve my problem, as I would like to configure the menu order for all users of the machine. Simply writing to the HKLM instead of HKCU does not work as expected, so it seems that Windows does not check this key. Is there any other key I could write to that would affect all users of the machine?<br><br>I also had to make a slight modification to make it work: in my case the correct key is ...\Start Menu2\... instead of ...\Start Menu\... . How confident should I be that this will work accross all Windows versions? :igor:</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">MSG</span><br><span class="post-time small text-muted">17th February 2010 22:17 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">You need enumusersreg.nsh.<br><br>As for Start Menu2... No idea there. Tried google?</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Anders</span><br><span class="post-time small text-muted">18th February 2010 00:03 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">I'm guessing "Start Menu" is the 2000 style start menu (hidden items) and "Start Menu2" is the XP style</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">ignacioalex</span><br><span class="post-time small text-muted">18th February 2010 18:09 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">I've successfully used EnumRegUsers.nsh to implement the start menu ordering for all users of the machine. It's still not yet a complete solution, as user accounts created after the application installation won't be affected. Anyway that's a big improvement over the previous solution, as now only such user accounts will have their start menu items messed up. Perhaps we can't completely fix this issue if Windows doesn't check for any key in HKLM.<br><br>I had to make a few minor changes to EnumRegUsers.nsh in order to allow using it from uninstaller sections. Maybe these should be useful to others, so I commited them to the wiki page.<br><br>You are right about the ...\Start Menu2\... key: ...\Start Menu\... configures the order of start menu items in classic menus, whereas ...\Start Menu2\... configures the order in modern menus.<br><br>Thank you very much for your comments.</p></div><hr><div class="footer"><p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p></div></div><script type="text/javascript" src="../js/highlight.pack.js" async></script><script type="text/javascript">//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]></script></body></html>