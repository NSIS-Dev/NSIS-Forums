<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="description" content="I need custom install script to start from"><title>I need custom install script to start from - NSIS Forums</title><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script><link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css"><link rel="stylesheet" href="../css/style.css" type="text/css"><!--[if lt IE 9]><script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script><script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script><![endif]--></head><body><div class="container"><ol class="breadcrumb"><li><a href="../index.html" class="glyphicon glyphicon-home"></a></li><li><a href="f-65.html">NSIS Discussion</a></li><li class="active">I need custom install script to start from</li></ol><p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=291191">I need custom install script to start from</a></p><br><div class="post"><p class="post-meta"><span class="post-author text-primary">sgregerson</span><br><span class="post-time small text-muted">2nd May 2008 17:38 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>I need custom install script to start from</strong><br>Hi All,<br><br>I'm looking for someone that can provide the starting base of an installer script for NSIS that a novice like me can find and change parameters easily.<br><br>Don't have a big budget, but I'd be willing to paypal $100 or more to any pro who can spare the time to build what I need. I may request extra features down the road for additional pay. I've worked around programmers for years and know that someone with NSIS knowledge could knock out this request fast, but all my locals are busy so I'm trying the outsource method.<br><br>The examples below are from a custom installer written in Visual C, that cannot be updated with the features I need. I believe NSIS could do everthing I need. I can make the changes once I have the base script in place, I just have a<br>hard time getting my head wrapped around the development flow process. So if you up to the challenge I need the following:<br><br>1) Need an NSIS scripted installer that that is simple enough for a novice to find the code to be changed for each unique install situation, i.e. they can easily search and replace text strings for file locations, file names and marketing images etc. within the installer that need to be swapped out for each new installer they build from the base installer you design.<br><br>2) Need the script to allow for a silent or selectable launch of a proprietary 3rd party installer (e.g. Open, File "task.exe")<br><br>3) Need script to search for files on the hard drives (possibly narrowing the search parameter by first peforming a GetPath in the HKEY registry for a software brand e.g. "GETPATH,HKEY_LOCAL_MACHINE,SOFTWARE\Company Name\Company Software\Version,Path" that would allow for a<br>faster search (don't want the end-user to experience a long search process). The files will look like this "EditorCache.5B9EC029", i.e. the file extension is a random set of characters after the "editorcache." name. So search parameter must be flexible to find files like these and delete them.<br><br>4) Need a SETPATCH to copy files to a specific loacation and create a new folder that I or they can choose.<br><br>5) Need it so allow for international language strings, again where I can then swap out translations strings from english to whatever.<br><br>Please let me know if there is anything needing clarification. Thanks for listening.<br><br>______________________<br><br>Steven Gregerson<br><a href="mailto:steve@gekko.us">steve@gekko.us</a><br>______________________<br><br><br>----------<br><br>The following are examples from the script of custom installer I was using. These features I would want in the NSIS installer plus the new features described above. It is not functional (i.e. nothing is sorted correctly as I'm just providing the examples) so you will need to derive the jist of what I need from the script functions as shown.<br><br>SECTION,MENU,main,"Welcome To Installer"<br>Needs to have splash screen with graphics that I can change. Also if there are multiple pages to the installer process, if I can put a splash graphic on each of those pages. At the end I would like to have an option to launch a read me or software.<br>1,OPEN,File.*,"opens an executable file with a proprietary installer"<br><br>2,INSTALL,install-2,"Install product" this is a copy process (see install-2 below)<br><br>3,Delete,delete-1,"Click to delete ORG file"<br>4,Delete,delete-2,"Click to delete EDITOR file"<br>(In numbers 3 and 4 only if it cannot be automated and silent, however, there may be multiple locations needed to search for the files that need to be deleted as the master program installs in different languages, and may allow for diffent install locations)<br><br>5,OPEN,<a href="http://www.blahblah.com/," target="_blank">http://www.blahblah.com/,</a>"Subscribe for FREE STUFF"<br>6,OPEN,!FREESTUFF!.pdf,"View Brochure"<br>7,OPEN,ReadMeLicense-All.txt,"License Agreement" (in 7 they need to accept the license agreement (displayed in a scrollable window for them to read before install begins).<br>8,EXIT,0,Exit<br><br>SECTION,INSTALL,install-3,"Click to Refresh Program"<br>STARTMSG,"This will refresh the effects and\n\nalbum org files\n\nClick Ok to begin."<br><br><br>1,GETPATH,HKEY_LOCAL_MACHINE,SOFTWARE\Company Name\Company Software\Version,Path<br>2,COPYFILES,License\*.*,Effects,"Copying License Agreement"<br><br>3,DELETEFILE,Album\AlbumOrg.org<br>4,DELETEFILE,Orgs\effects.org<br><br>ENDMSG,"Files are now installed on your system."<br><br>Install #2 example<br><br>SECTION,INSTALL,install-2,"Click to Refresh Master Program"<br>STARTMSG,"This will refresh the effects and\n\nalbum org files\n\nClick Ok to begin."<br><br>1,GETPATH,HKEY_LOCAL_MACHINE,SOFTWARE\Company Name\SOftware\Version,Path<br>2,COPYFILES,Objects\Imported Objects\*.*,Objects\Imported Objects,"Copying Objects"<br>3,COPYFILES,Objects\Kid Stuff\*.*,Objects\Imported Objects,"Copying Objects"<br>4,COPYFILES,Objects\Wedding\*.*,Objects\Imported Objects,"Copying Objects"<br>5,COPYFILES,Objects\Text3D\*.*,Objects\Text3D,"Copying Objects"<br>6,COPYFILES,Images\*.*,Images,"Copying Images"<br>7,COPYFILES,Additional Wedding Titles\*.*,Objects\Additional Wedding Titles,"Copying Bonus Objects"<br>8,COPYFILES,Effects\MFX Wedding Titles\*.*,Effects\MFX Wedding Titles,"Copying Effects"<br><br>1,SEARCH FIle,C:\Documents and Settings\All Users\Application Data\Compnay\Software (possibly pulled from HKEY?)<br><br>2,DELETEFILE,Effects\EditorCache.5B9EC029<br><br><br>ENDMSG,"Files are now installed on your system."<br><br>SECTION,STRINGS,strings,strings<br>WINDOWTITLE,"My Software"<br>LANGUAGETITLE,"Please select your preferred language"<br>ERR_TITLE,"RPStart Error"<br>ERR_DATAFILE,"Error Reading rpstart data file"<br>ERR_NOMAIN,"Main menu not defined in rpstart data file"<br>ERR_NOITEM,"Invalid item selected"<br>ERR_RUN,"Unable to run program"<br>ERR_OPEN,"Unable to open file/URL"<br>ERR_EXPLORE,"Unable to explore folder"<br>ERR_NOINSTALL,"Installer not found"<br>ERR_NOTHING,"Could not find anything to install"<br><br>SECTION,LANGUAGES,languages,languages<br>0,en,"English"<br>1,de,"German"<br>2,fr,"French"<br>3,nl,"Dutch"<br>4,es,"Spanish"<br>5,it,"Italian"<br>6,jp,"Japanese"<br>7,ch,"Chinese Mandarin"<br>8,pg,"Portuguese"<br>9,ru,"Russian"<br><br><br><br>Now only if NSIS was for MAC as well....anyone know of something similar on MAC?<br><br>PS&gt; Keep Moving Forward....Never Give Up, Never Surrender....Failure is Not an Option....Live Long and Prosper!</p></div><hr><div class="footer"><p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p></div></div><script src="../js/highlight.pack.js" type="text/javascript"></script><script type="text/javascript">//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]></script></body></html>