<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="description" content="Installer for Firefox Toolbar"><title>Installer for Firefox Toolbar - NSIS Forums</title><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script><link rel="preload" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css" as="style" onload="this.rel='stylesheet'"><link rel="preload" href="../css/style.css" as="style" onload="this.rel='stylesheet'"><noscript><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css"><link rel="stylesheet" href="../css/style.css"></noscript><script>!function(a){"use strict";var b=function(b,c,d){function e(a){return h.body?a():void setTimeout(function(){e(a)})}function f(){i.addEventListener&&i.removeEventListener("load",f),i.media=d||"all"}var g,h=a.document,i=h.createElement("link");if(c)g=c;else{var j=(h.body||h.getElementsByTagName("head")[0]).childNodes;g=j[j.length-1]}var k=h.styleSheets;i.rel="stylesheet",i.href=b,i.media="only x",e(function(){g.parentNode.insertBefore(i,c?g:g.nextSibling)});var l=function(a){for(var b=i.href,c=k.length;c--;)if(k[c].href===b)return a();setTimeout(function(){l(a)})};return i.addEventListener&&i.addEventListener("load",f),i.onloadcssdefined=l,l(f),i};"undefined"!=typeof exports?exports.loadCSS=b:a.loadCSS=b}("undefined"!=typeof global?global:this);!function(a){if(a.loadCSS){var b=loadCSS.relpreload={};if(b.support=function(){try{return a.document.createElement("link").relList.supports("preload")}catch(b){return!1}},b.poly=function(){for(var b=a.document.getElementsByTagName("link"),c=0;c<b.length;c++){var d=b[c];"preload"===d.rel&&"style"===d.getAttribute("as")&&(a.loadCSS(d.href,d,d.getAttribute("media")),d.rel=null)}},!b.support()){b.poly();var c=a.setInterval(b.poly,300);a.addEventListener&&a.addEventListener("load",function(){b.poly(),a.clearInterval(c)}),a.attachEvent&&a.attachEvent("onload",function(){a.clearInterval(c)})}}}(this);</script></head><body><div class="container"><ol class="breadcrumb"><li><a href="../index.html" class="glyphicon glyphicon-home"></a></li><li><a href="f-65.html">NSIS Discussion</a></li><li class="active">Installer for Firefox Toolbar</li></ol><p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=246764">Installer for Firefox Toolbar</a></p><br><div class="post"><p class="post-meta"><span class="post-author text-primary">varun</span><br><span class="post-time small text-muted">22nd May 2006 19:27 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>Installer for Firefox Toolbar</strong><br>Hi Friends!<br>I have made an toolbar extension for firefox, and i want to make a installer for it, now my back end is in MySQL and toolbar is coded in JS and XUL now as you might know firefox extensions are installed by opening firefox and then opening the .xpi file with firefox to install it, now how do i make firefox launch from NSIS intaller and let it open .xpi file which would install the toolbar for me. also how would i include the MySQL database files in the installer.<br><br>Thanks.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Red Wine</span><br><span class="post-time small text-muted">22nd May 2006 19:54 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">You may want to take a look <a href="http://forums.winamp.com/showthread.php?threadid=246301" target="_blank">here</a></p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">varun</span><br><span class="post-time small text-muted">22nd May 2006 20:42 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Thnks Red wine, but still i am in a dilemma of how to install my MySQL database on the users machine so that the toolbar is able to call the database.<br>Thanks.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Red Wine</span><br><span class="post-time small text-muted">22nd May 2006 20:53 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"></p><blockquote>how to install my MySQL database...</blockquote>I'd suggest forum and wiki search :-)</div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">varun</span><br><span class="post-time small text-muted">23rd May 2006 02:26 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Hey thanks... :)))<br>but do i need to install MySQL on target machines or just my MySQL file.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">RobGrant</span><br><span class="post-time small text-muted">23rd May 2006 08:32 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">I'd be surprised if you needed to include the database with the installer; why not let users set it up themselves? They may even already have a copy installed.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">varun</span><br><span class="post-time small text-muted">23rd May 2006 14:35 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Hi Rob!<br>so it means that if they dont have MySQL on their machines, i should give them a message to install MySQL first on their machines and then put up my database files in the installer? or i should make a execwait from the installer to install MySQL on their machines, but that brings up the issues of passwords etc for MySQL.<br><br>Thanks.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">RobGrant</span><br><span class="post-time small text-muted">23rd May 2006 15:01 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Well I don't know the details of your situation, but I'd be tempted to just say, "This needs MySQL, install it before you run this installer." Just offload it to the user :)<br><br>But your application's raison d'etre may be having MySQL included. It's a management decision :)</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">varun</span><br><span class="post-time small text-muted">23rd May 2006 18:01 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Thanksss Rob!</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">varun</span><br><span class="post-time small text-muted">23rd May 2006 20:53 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Hi!<br>here is my script but is not launching Firefox and hence the .xpi is not installed, pls help me correct it.<br>Thanks.<br>!define APPNAME "NetTrust"<br>!define APPNAMEANDVERSION "NetTrust 1.0."<br><br>Name "${APPNAMEANDVERSION}"<br>OutFile "NetTrustSetup.exe"<br>BrandingText "NetTrust"<br><br>;Flags<br>XPStyle on<br>!include "MUI.nsh"<br><br>!define MUI_ABORTWARNING<br><br>!insertmacro MUI_PAGE_WELCOME<br>!insertmacro MUI_PAGE_LICENSE "license.txt"<br>!insertmacro MUI_PAGE_COMPONENTS<br>!insertmacro MUI_PAGE_INSTFILES<br>;page custom Dotnet,DirectX<br>!insertmacro MUI_PAGE_FINISH<br><br><br>!insertmacro MUI_UNPAGE_WELCOME<br>!insertmacro MUI_UNPAGE_CONFIRM<br>!insertmacro MUI_UNPAGE_INSTFILES<br>!insertmacro MUI_UNPAGE_FINISH<br>!insertmacro MUI_LANGUAGE "English"<br>!insertmacro MUI_RESERVEFILE_LANGDLL<br><br><br>;Set the default Installation Directory<br>InstallDir "$PROGRAMFILES\Nettrust"<br><br>Function .onInit<br>MessageBox MB_YESNO "This will install NetTrust on your System. Do you wish to continue?" IDYES true<br>Abort<br><br>true:<br><br>ReadRegStr $1 HKLM "SOFTWARE\Microsoft\Windows\CurrentVersion\App Paths\firefox.exe" ""<br>StrCmp $1 "" NoFireFox ok<br><br>NoFireFox:<br>MessageBox MB_OK|MB_ICONSTOP "FireFox wasn't found on your system, Please install the latest version of Firefox from <a href="http://www.mozilla.com/firefox." target="_blank">http://www.mozilla.com/firefox.</a> Setup will now Exit."<br>Abort<br><br>ok:<br><br>!insertmacro MUI_LANGDLL_DISPLAY<br><br>InitPluginsDir<br><br>functionend<br><br>Section "NetTrust" Section1;<br><br>; Set output path to the installation directory. Also sets the working<br>; directory for shortcuts<br>SetOutPath $INSTDIR\<br><br>nsExec::Exec '"C:\Program Files\Mozilla Firefox\firefox.exe" -install-global-extension "nt.xpi"'<br><br><br>File nt.exe<br>File readme.txt<br><br><br>WriteUninstaller $INSTDIR\UninstallNetTrust.exe<br><br>; // CREATE SHORT CUTS<br><br>CreateShortCut "$DESKTOP\NetTrust.lnk" "$INSTDIR\nt.exe"<br>CreateDirectory "$SMPROGRAMS\NetTrust"<br>CreateShortCut "$SMPROGRAMS\NetTrust\Run NetTrust.lnk" "$INSTDIR\nt.exe"<br>CreateShortCut "$SMPROGRAMS\NetTrust\Uninstall NetTrust.lnk" "$INSTDIR\UninstallNetTrust.exe"<br><br>; // END CREATING SHORTCUTS<br><br>; //CREATE REGISTRY KEYS FOR ADD/REMOVE PROGRAMS IN CONTROL PANEL<br><br>WriteRegStr HKLM "Software\Microsoft\Windows\CurrentVersion\Uninstall\NetTrust" "NetTrust"\<br>"NetTrust (remove only)"<br><br>WriteRegStr HKLM "Software\Microsoft\Windows\CurrentVersion\Uninstall\NetTrust" "UninstallString" \<br>"$INSTDIR\UninstallNetTrust.exe"<br><br>; // END CREATING REGISTRY KEYS<br><br>MessageBox MB_OK "NetTrust was successfully installed on your Computer."<br><br>SectionEnd<br><br><br><br>Section "Uninstall"<br>; remove all the files and folders<br>Delete $INSTDIR\UninstallNetTrust.exe ; delete self<br>Delete $INSTDIR\nt.xpi<br>Delete $INSTDIR\nt.exe<br>Delete $INSTDIR\readme.txt<br><br><br>RMDir $INSTDIR<br><br>; now remove all the startmenu links<br>Delete "$SMPROGRAMS\NetTrust\Run NetTrust.lnk"<br>Delete "$SMPROGRAMS\NetTrust\Uninstall NetTrust.lnk"<br>RMDIR "$SMPROGRAMS\NetTrust"<br><br>; Now delete registry keys<br>DeleteRegKey HKEY_LOCAL_MACHINE "SOFTWARE\NetTrust"<br>DeleteRegKey HKEY_LOCAL_MACHINE "SOFTWARE\Microsoft\Windows\CurrentVersion\Uninstall\NetTrust"<br><br>SectionEnd</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">JasonFriday13</span><br><span class="post-time small text-muted">24th May 2006 00:22 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">This line:<br><br>nsExec::Exec '"C:\Program Files\Mozilla Firefox\firefox.exe" -install-global-extension "nt.xpi"'<br><br>should actually have the value you pulled from the registry, not referring to an absolute path.<br><br>nsExec::Exec '"$0" -install-global-extension "nt.xpi"'<br>or<br>nsExec::Exec '"$0\firefox.exe" -install-global-extension "nt.xpi"'</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">varun</span><br><span class="post-time small text-muted">24th May 2006 03:32 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">&lt;&lt;nsExec::Exec '"$0" -install-global-extension "nt.xpi"' &gt;&gt;<br>shall it not be $1 as i am getting registry value in $1 and not in $0?</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">JasonFriday13</span><br><span class="post-time small text-muted">24th May 2006 04:14 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">True. Sorry, it's just that I always use $0 as my first variable. It should be $1 in your case.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Red Wine</span><br><span class="post-time small text-muted">24th May 2006 05:54 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Does this "nt.xpi" exist on target, or you're going to extract it?<br>I think a path to the file is missing.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">varun</span><br><span class="post-time small text-muted">24th May 2006 16:45 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">hi !!<br>nt.xpi is on my machine, and also i am going to put one nt.xpi on the target machine by simply<br>file nt.xpi before the exec statement, would it work?<br>as regards the path it is in the same folder as the .nsi file so i think it should work.<br>Thanks.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Red Wine</span><br><span class="post-time small text-muted">24th May 2006 17:15 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Yes,<br>SetOutPath $INSTDIR<br>File .....<br>File .....<br>File nt.xpi<br>nsExec::Exec '"$1" -install-global-extension "$INSTDIR\nt.xpi"'</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">varun</span><br><span class="post-time small text-muted">24th May 2006 18:25 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">It works guyssssssssssss!!<br><br>THANK YOU ALL!!:D</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">varun</span><br><span class="post-time small text-muted">24th May 2006 19:27 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">please helpppppp<br>sorry to bug you again guys.. but the application installed correctly on one machine but one another one, it just throws up the firefox browser without installing the toolbar, please take a look at my final script and please help me...<br><br>!define APPNAME "NetTrust"<br>!define APPNAMEANDVERSION "NetTrust 1.1."<br><br>Name "${APPNAMEANDVERSION}"<br>OutFile "NetTrust.exe"<br>BrandingText "NetTrust"<br><br>!include "MUI.nsh"<br><br>!define MUI_ABORTWARNING<br><br>!insertmacro MUI_PAGE_WELCOME<br>!insertmacro MUI_PAGE_LICENSE "license.txt"<br>!insertmacro MUI_PAGE_INSTFILES<br>!insertmacro MUI_PAGE_FINISH<br><br>!insertmacro MUI_LANGUAGE "English"<br><br>!insertmacro MUI_RESERVEFILE_LANGDLL<br><br><br><br>Function .onInit<br>;MessageBox MB_YESNO "This will install NetTrust on your System. Do you wish to continue?" IDYES gogogo<br>;Abort<br><br>;gogogo:<br><br>ReadRegStr $1 HKLM "SOFTWARE\Microsoft\Windows\CurrentVersion\App Paths\firefox.exe" ""<br>StrCmp $1 "" NoFireFox ok<br><br>NoFireFox:<br>MessageBox MB_OK|MB_ICONSTOP "FireFox wasn't found on your system, Please install the latest version of Firefox from <a href="http://www.mozilla.com/firefox." target="_blank">http://www.mozilla.com/firefox.</a> Setup will now Exit"<br>Abort<br><br>ok:<br><br>!insertmacro MUI_LANGDLL_DISPLAY<br><br>InitPluginsDir<br><br><br>functionend<br><br>Section "" ; A "useful" name is not needed as we are not installing separate components<br><br>; Set output path to the installation directory. Also sets the working<br>; directory for shortcuts<br>SetOutPath $INSTDIR\<br><br>File nt.xpi<br>File nt.exe<br>File readme.txt<br>nsExec::Exec '"$1"' -install-global-extension "$INSTDIR\nt.xpi"<br><br><br>WriteUninstaller $INSTDIR\UninstallNetTrust.exe<br><br>; ///////////////// CREATE SHORT CUTS //////////////////////////////////////<br><br>CreateDirectory "$SMPROGRAMS\NetTrust"<br><br><br>CreateShortCut "$SMPROGRAMS\NetTrust\Run NetTrust.lnk" "$INSTDIR\nt.exe"<br><br><br>CreateShortCut "$SMPROGRAMS\NetTrust\Uninstall NetTrust.lnk" "$INSTDIR\UninstallNetTrust.exe"<br><br>; ///////////////// END CREATING SHORTCUTS //////////////////////////////////<br><br>; //////// CREATE REGISTRY KEYS FOR ADD/REMOVE PROGRAMS IN CONTROL PANEL /////////<br><br>WriteRegStr HKLM "Software\Microsoft\Windows\CurrentVersion\Uninstall\NetTrust" "NetTrust"\<br>"NSIS Example Application 1 (remove only)"<br><br>WriteRegStr HKLM "Software\Microsoft\Windows\CurrentVersion\Uninstall\NetTrust" "UninstallString" \<br>"$INSTDIR\UninstallNetTrust.exe"<br><br>; //////////////////////// END CREATING REGISTRY KEYS ////////////////////////////<br><br>MessageBox MB_OK "Installation was successful."<br><br>SectionEnd<br><br><br><br>Section "Uninstall"<br>; remove all the files and folders<br>Delete $INSTDIR\UninstallNetTrust.exe ; delete self<br>Delete $INSTDIR\nt.xpi<br>Delete $INSTDIR\nt.exe<br>Delete $INSTDIR\readme.txt<br><br><br>RMDir $INSTDIR<br><br>; now remove all the startmenu links<br>Delete "$SMPROGRAMS\NetTrust\Run NetTrust.lnk"<br>Delete "$SMPROGRAMS\NetTrust\Uninstall NetTrust.lnk"<br>RMDIR "$SMPROGRAMS\NetTrust"<br><br>; Now delete registry keys<br>DeleteRegKey HKEY_LOCAL_MACHINE "SOFTWARE\NetTrust"<br>DeleteRegKey HKEY_LOCAL_MACHINE "SOFTWARE\Microsoft\Windows\CurrentVersion\Uninstall\NetTrust"<br><br>SectionEnd</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br><span class="post-time small text-muted">24th May 2006 19:30 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">The path part of the plugin call must be surrounded by quotes. This includes the parameters.<br>I'm not sure how it worked at all to be honest, unless the readme isn't telling me something.<br><br>nsExec::Exec '"$1" -install-global-extension "$INSTDIR\nt.xpi"'<br><br>-Stu</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">varun</span><br><span class="post-time small text-muted">24th May 2006 19:50 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">It does n't even launch firefox if quotes are put this way.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Red Wine</span><br><span class="post-time small text-muted">24th May 2006 20:04 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">perhaps this?<br>nsExec::Exec '"$1 -install-global-extension" "$INSTDIR\nt.xpi"'</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">varun</span><br><span class="post-time small text-muted">24th May 2006 20:10 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">:o Nope that doesnt help too... i guesss we just need to launch firefox and present it with a .xpi file so that the toolbar file, nt.xpi installs itself to firefox. Dont know wat happened...:weird:</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Red Wine</span><br><span class="post-time small text-muted">24th May 2006 20:19 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Unless the command params are wrong, should be a quotes issue.<br>Anyway from my point of view best method is to make a nice htm file where you're telling users about your extension and provide a button to install the extension.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br><span class="post-time small text-muted">24th May 2006 20:38 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">If you're executing firefox.exe, then why are you using nsExec::Exec?<br>nsExec is used to execute command line executables to hide their command window. It should still work, but you should just use the Exec instruction:<br><br>Exec '"$1" -install-global-extension "$INSTDIR\nt.xpi"'<br><br>Another thing. Where does the $INSTDIR come into this? You aren't even setting its value to anything. If $INSTDIR is empty, your files will be extracted anywhere and the firefox execution will more than likely fail.<br>You should set it to a value with StrCpy, e.g.<br>StrCpy $INSTDIR $EXEDIR<br><br>-Stu</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">varun</span><br><span class="post-time small text-muted">24th May 2006 21:03 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">@red wine: the solution of leading a user to a webpage by launching firefox and then installing the .xpi from there requires all the users must have internet at install, and it would not be possible for a user who is offline to install my file then.<br><br>@Afrow:is it not that i am extracting nt.xpi in INSTDIR through file nt.xpi and then providing firefox the file nt.xpi from there?</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Red Wine</span><br><span class="post-time small text-muted">24th May 2006 21:06 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">No leading users to net. Compile a htm file and extract it e.g. to $TEMP, then launch it with firefox :-)</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">varun</span><br><span class="post-time small text-muted">24th May 2006 21:29 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">ohhhhhhhh.. i never knew i could do that.. ill try that fix and get back !!<br>Thnxxxx for ur support guys!</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Red Wine</span><br><span class="post-time small text-muted">24th May 2006 21:32 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Well, see this thread, the guy said it's working. :-)<br><a href="http://forums.winamp.com/showthread.php?threadid=246301" target="_blank">http://forums.winamp.com/showthread.php?threadid=246301</a></p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">varun</span><br><span class="post-time small text-muted">25th May 2006 05:56 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Another problem bros..<br>Well even if the file nt.xpi is extracted to the INSTDIR why is firefox giving me error and is picking up nt.xpi from my hard disk location instead of INSTDIR<br><br>it picks up nt.xpi from file:///C:/Documents%20and%20Settings..<br><br>and when i just run the setup firefox gives me error<br>Firefox can't find the file at /C:/Documents and Settings/varun vasudev/Desktop/fundoo/nt.xpi.<br><br>y the hell firefox is picking up nt.xpi frm the hard disk it should be packaged in the installer.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">varun</span><br><span class="post-time small text-muted">25th May 2006 06:01 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">guys. pls help ..<br>the problems are<br>1.firefox is picking nt.xpi from my hard disk and when i run the set up it gives me error Firefox can't find the file at /C:/Documents and Settings/varun vasudev/Desktop/fundoo/nt.xpi<br><br>2. Add remove programs dont function.<br><br>my final script is<br><br>!define APPNAME "NetTrust"<br>!define APPNAMEANDVERSION "NetTrust 1.1."<br><br>Name "${APPNAMEANDVERSION}"<br>OutFile "NetTrust.exe"<br>BrandingText "NetTrust"<br><br>!include "MUI.nsh"<br><br>!define MUI_ABORTWARNING<br><br>!insertmacro MUI_PAGE_WELCOME<br>!insertmacro MUI_PAGE_LICENSE "license.txt"<br>!insertmacro MUI_PAGE_INSTFILES<br>!insertmacro MUI_PAGE_FINISH<br><br>!insertmacro MUI_LANGUAGE "English"<br><br>!insertmacro MUI_RESERVEFILE_LANGDLL<br><br><br><br>Function .onInit<br>;MessageBox MB_YESNO "This will install NetTrust on your System. Do you wish to continue?" IDYES gogogo<br>;Abort<br><br>;gogogo:<br><br>ReadRegStr $1 HKLM "SOFTWARE\Microsoft\Windows\CurrentVersion\App Paths\firefox.exe" ""<br>StrCmp $1 "" NoFireFox ok<br><br>NoFireFox:<br>MessageBox MB_OK|MB_ICONSTOP "FireFox wasn't found on your system, Please install the latest version of Firefox from <a href="http://www.mozilla.com/firefox." target="_blank">http://www.mozilla.com/firefox.</a> Setup will now Exit"<br>Abort<br><br>ok:<br><br>!insertmacro MUI_LANGDLL_DISPLAY<br><br>InitPluginsDir<br><br><br>functionend<br><br>Section "" ; A "useful" name is not needed as we are not installing separate components<br><br>; Set output path to the installation directory. Also sets the working<br>; directory for shortcuts<br>SetOutPath $INSTDIR\<br><br>File nt.xpi<br><br>File readme.txt<br>StrCpy $INSTDIR $EXEDIR<br><br>nsExec::Exec '"$1" "$INSTDIR\nt.xpi"'<br><br><br>WriteUninstaller $INSTDIR\UninstallNetTrust.exe<br><br>; ///////////////// CREATE SHORT CUTS //////////////////////////////////////<br><br>CreateDirectory "$SMPROGRAMS\NetTrust"<br><br><br>CreateShortCut "$SMPROGRAMS\NetTrust\Run NetTrust.lnk" "$INSTDIR\nt.exe"<br><br><br>CreateShortCut "$SMPROGRAMS\NetTrust\Uninstall NetTrust.lnk" "$INSTDIR\UninstallNetTrust.exe"<br><br>; ///////////////// END CREATING SHORTCUTS //////////////////////////////////<br><br>; //////// CREATE REGISTRY KEYS FOR ADD/REMOVE PROGRAMS IN CONTROL PANEL /////////<br><br>WriteRegStr HKLM "Software\Microsoft\Windows\CurrentVersion\Uninstall\NetTrust" "NetTrust"\<br>"NSIS Example Application 1 (remove only)"<br><br>WriteRegStr HKLM "Software\Microsoft\Windows\CurrentVersion\Uninstall\NetTrust" "UninstallString" \<br>"$INSTDIR\UninstallNetTrust.exe"<br><br>; //////////////////////// END CREATING REGISTRY KEYS ////////////////////////////<br><br>MessageBox MB_OK "Installation was successful."<br><br>SectionEnd<br><br><br><br>Section "Uninstall"<br>; remove all the files and folders<br>Delete $INSTDIR\UninstallNetTrust.exe ; delete self<br>Delete $INSTDIR\nt.xpi<br>Delete $INSTDIR\nt.exe<br>Delete $INSTDIR\readme.txt<br><br><br>RMDir $INSTDIR<br><br>; now remove all the startmenu links<br>Delete "$SMPROGRAMS\NetTrust\Run NetTrust.lnk"<br>Delete "$SMPROGRAMS\NetTrust\Uninstall NetTrust.lnk"<br>RMDIR "$SMPROGRAMS\NetTrust"<br><br>; Now delete registry keys<br>DeleteRegKey HKEY_LOCAL_MACHINE "SOFTWARE\NetTrust"<br>DeleteRegKey HKEY_LOCAL_MACHINE "SOFTWARE\Microsoft\Windows\CurrentVersion\Uninstall\NetTrust"<br><br>SectionEnd</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Red Wine</span><br><span class="post-time small text-muted">25th May 2006 06:08 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Check the link on your htm file.<br>If you extract both the htm and the xpi to the same location, do not include any path when linking.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br><span class="post-time small text-muted">25th May 2006 09:31 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Move<br>StrCpy $INSTDIR $EXEDIR<br>above<br>SetOutPath $INSTDIR<br><br>-Stu</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">varun</span><br><span class="post-time small text-muted">25th May 2006 14:34 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">hi There!<br><br>moving<br>StrCpy $INSTDIR $EXEDIR<br>above<br>SetOutPath $INSTDIR<br><br>seems to fix the problem but now the installation folder of nettrust is not being made in the program files folder.. even though i am using<br><br>InstallDir $PROGRAMFILES\NetTrust\<br><br><br>!define APPNAME "NetTrust"<br>!define APPNAMEANDVERSION "NetTrust 1.1."<br><br>Name "${APPNAMEANDVERSION}"<br>OutFile "NetTrust.exe"<br>BrandingText "NetTrust"<br><br>InstallDir $PROGRAMFILES\NetTrust\<br><br>!include "MUI.nsh"<br><br>!define MUI_ABORTWARNING<br><br>!insertmacro MUI_PAGE_WELCOME<br>!insertmacro MUI_PAGE_LICENSE "license.txt"<br>!insertmacro MUI_PAGE_INSTFILES<br>!insertmacro MUI_PAGE_FINISH<br><br>!insertmacro MUI_LANGUAGE "English"<br><br>what could be the problem guys??</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br><span class="post-time small text-muted">25th May 2006 15:20 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">You weren't using InstallDir before, or you didn't have it in the script. That's why you needed the StrCpy. Either use InstallDir or the StrCpy code I posted, but not both. The StrCpy sets the $INSTDIR variable to $EXEDIR. InstallDir also sets the $INSTDIR variable to what you want, but before any NSIS code is executed. Therefore the StrCpy is overwriting your "$PROGRAMFILES\NetTrust" value with $EXEDIR.<br><br>Remove the StrCpy instruction.<br><br>-Stu</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">varun</span><br><span class="post-time small text-muted">25th May 2006 16:14 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Thanks Afrow!<br>it finally worked fine... just had one curiosity, now if i removed the strcpy code how is it still not picking up nt.xpi from my hard disk, coz you had suggested the strcpy code to specifically fix that bug?<br>:cool:</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br><span class="post-time small text-muted">25th May 2006 16:45 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">What do you mean?<br>In what way is it not 'picking it up'? Does the File instruction fail?<br><br>-Stu</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">varun</span><br><span class="post-time small text-muted">25th May 2006 18:11 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">no i mean u suggested strcpy as a fix for<br>Firefox can't find the file at /C:/Documents and Settings/varun vasudev/Desktop/fundoo/nt.xpi<br><br>now even without strcpy this seems to work, i was just curious how.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br><span class="post-time small text-muted">25th May 2006 19:27 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Because you didn't have InstallDir in your script and now you do.<br><br>-Stu</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">varun</span><br><span class="post-time small text-muted">26th May 2006 13:21 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Thanks Stu.</p></div><hr><div class="footer"><p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p></div></div><script type="text/javascript" src="../js/highlight.pack.js" async></script><script type="text/javascript">//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]></script></body></html>