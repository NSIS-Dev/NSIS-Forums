<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="description" content="GetWindowsVersion updated for WinSE stopped working..."><title>GetWindowsVersion updated for WinSE stopped working... - NSIS Forums</title><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script><link rel="preload" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css" as="style" onload="this.rel='stylesheet'"><link rel="preload" href="../css/style.css" as="style" onload="this.rel='stylesheet'"><noscript><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css"><link rel="stylesheet" href="../css/style.css"></noscript><script>!function(a){"use strict";var b=function(b,c,d){function e(a){return h.body?a():void setTimeout(function(){e(a)})}function f(){i.addEventListener&&i.removeEventListener("load",f),i.media=d||"all"}var g,h=a.document,i=h.createElement("link");if(c)g=c;else{var j=(h.body||h.getElementsByTagName("head")[0]).childNodes;g=j[j.length-1]}var k=h.styleSheets;i.rel="stylesheet",i.href=b,i.media="only x",e(function(){g.parentNode.insertBefore(i,c?g:g.nextSibling)});var l=function(a){for(var b=i.href,c=k.length;c--;)if(k[c].href===b)return a();setTimeout(function(){l(a)})};return i.addEventListener&&i.addEventListener("load",f),i.onloadcssdefined=l,l(f),i};"undefined"!=typeof exports?exports.loadCSS=b:a.loadCSS=b}("undefined"!=typeof global?global:this);!function(a){if(a.loadCSS){var b=loadCSS.relpreload={};if(b.support=function(){try{return a.document.createElement("link").relList.supports("preload")}catch(b){return!1}},b.poly=function(){for(var b=a.document.getElementsByTagName("link"),c=0;c<b.length;c++){var d=b[c];"preload"===d.rel&&"style"===d.getAttribute("as")&&(a.loadCSS(d.href,d,d.getAttribute("media")),d.rel=null)}},!b.support()){b.poly();var c=a.setInterval(b.poly,300);a.addEventListener&&a.addEventListener("load",function(){b.poly(),a.clearInterval(c)}),a.attachEvent&&a.attachEvent("onload",function(){a.clearInterval(c)})}}}(this);</script></head><body><div class="container"><ol class="breadcrumb"><li><a href="../index.html" class="glyphicon glyphicon-home"></a></li><li><a href="f-65.html">NSIS Discussion</a></li><li class="active">GetWindowsVersion updated for WinSE stopped working...</li></ol><p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=140332">GetWindowsVersion updated for WinSE stopped working...</a></p><br><div class="post"><p class="post-meta"><span class="post-author text-primary">Lilla</span><br><span class="post-time small text-muted">27th June 2003 20:25 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>GetWindowsVersion updated for WinSE stopped working...</strong><br>GetWindowsVersion updated for WinSE stopped working...<br><br>In the archive there is function<br>GetWindowsVersion updated for Windows SE<br><br>I am running Win98SE and am using this function. This function stopped working when I updated via CVS yesterday. Before that it worked just fine. Now it returns an empty string instead of '98 SE' as it should do.<br><br>GetWindowsVersion from Appendix B works just fine, so the problem is only with the modified version that is in the archive.<br><br>Does the modified version of GetWindowsVersion need to be updated to be compatible with the latest CVS?<br><br>If so, that is fine, I can change my code to use the standard version of GetWindowsVersion, which I may do in any event.<br><br>Or, is this a development problem that needs to be corrected so the modified version of GetWindowsVersion in the Archive will work again?<br><br>Thank you,<br>Lilla</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">kichik</span><br><span class="post-time small text-muted">27th June 2003 20:45 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Try now with the ClearErrors I have added to the function.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Lilla</span><br><span class="post-time small text-muted">27th June 2003 20:51 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Thanks, will do!<br><br>Lilla</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Lilla</span><br><span class="post-time small text-muted">27th June 2003 21:07 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Kichik. Sorry, with ClearErrors I see no change. Still reports empty string instead of '98 SE'<br><br>Lilla</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">kichik</span><br><span class="post-time small text-muted">27th June 2003 21:56 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">I am sorry, but I don't have the time right now to test this. Try adding a few message boxes along the way and check this out, especially around the lbl_win32_98 part. If you don't get it by tomorrow I'll try again.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Lilla</span><br><span class="post-time small text-muted">27th June 2003 22:26 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Ok, I'll give it a try, I'll post back with my results.<br><br>Lilla</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Lilla</span><br><span class="post-time small text-muted">27th June 2003 23:44 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">OK, here's what I figured out.<br><br>Regarding GetWindowsVersion in Appendix B.<br><br>ClearErrors<br>This line should be added to the function.<br>I *just* updated via CVS and this line is not there.<br><br>Observations:<br>this function uses HKLM (not HKCU)<br>this function works.<br><br>---------------------------------------------<br><br>Regarding GetWindowsVersion updated for Windows 98 SE in the Archive<br><br>ClearErrors - Kichik added this line today.<br><br>observations:<br>this function uses HKCU (vs HKLM used by function in Appendix B)<br>this function does NOT work<br><br>I changed HKCU to HKLM and now this function works!<br>So, it appears then that this change needs to be made to the Archive, or at least a comment that if you are using NSIS v2 beta 4 you need to change HKCU to HKLM.<br><br>-------------<br><br>Hope this helps,<br>Lilla</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">kichik</span><br><span class="post-time small text-muted">28th June 2003 11:52 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Good catch.<br><br>There shouldn't be any difference between HKLM and HCKU through the different versions of NSIS, and there isn't. Everything else that relates to this still works for me. The code on the Archive though does say HKLM. It's possible that someone else has already updated though, it's owned by anonymous...</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Lilla</span><br><span class="post-time small text-muted">28th June 2003 18:06 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Thanks much. I thought that I had confirmed that the archived version used HKCU instead of HKLM, but retracing my steps it looks now that it was HKLM all along (not HKCU as I said it was). It was HKCU in my code, but that was evidently a problem that I introduced.<br><br>In any event, it was good that we discoving the missing ClearErrors.<br><br>Lilla</p></div><hr><div class="footer"><p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p></div></div><script src="../js/highlight.pack.js" type="text/javascript"></script><script type="text/javascript">//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]></script></body></html>