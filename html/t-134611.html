<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="Problems with nsExec::ExecToLog" />

  <title>Problems with nsExec::ExecToLog - NSIS Forums</title>
  <script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script>
  <!-- Bootstrap core CSS -->

  <link rel="stylesheet" type="text/css" href="//netdna.bootstrapcdn.com/bootswatch/3.0.1/readable/bootstrap.min.css" />
  <link rel="stylesheet" href="../css/style.css" type="text/css" /><!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!--[if lt IE 9]>
                <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
                <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->
</head>

<body>
  <div class="container">
    <!-- Put navigation bar here -->

    <ol class="breadcrumb">
      <li><a href="../index.html" class="glyphicon glyphicon-home"></a></li>

      <li><a href="f-65.html">NSIS Discussion</a></li>

      <li class="active">Problems with nsExec::ExecToLog</li>
    </ol>

    <p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=134611">Problems with nsExec::ExecToLog</a></p><br />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">dabossuk</span><br />
      <span class="post-time small text-muted">7th May 2003 10:49 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>Problems with nsExec::ExecToLog</strong><br />
      Hi<br />
      <br />
      I am using the following line of code below (in NSIS B3) ... installutil.exe is a commandline tool supplied by Microsoft to install .NET Services. My problem is sometimes it works and sometimes it does not.<br />
      <br />
      ie ... if I run the setup.exe ... it calls this line and works perfect. I can call the setup.exe another time and it "looks" seems to totally ignores this line. I know this as it does not create any .installlog (created by installutil.exe) files in the installdir. I have tried to debug this using exectolog param - but the log window during the installer does not have a scrollable window - so once all the files etc have shot past I cannot see any errors above (think this needs to be changed anyway in NSIS ?) Any ideas ? Anyone done this ? Thanks ...<br />
      <br />
      Banner::show /NOUNLOAD "Installing Whoosh SMS Service ..."<br />
      nsExec::ExecToLog '"$PLUGINSDIR\installutil.exe" /showcallstack "$INSTDIR\whooshservice.exe"'<br />
      Sleep 5000<br />
      Banner::destroy</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
      <span class="post-time small text-muted">7th May 2003 16:04 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">The log window should have a scroll bar if there is more text than the window can contain. Can you please attach an example compiled installer that shows this behavior?<br />
      <br />
      As for ExecToLog, make sure the working directory is always what you think it is. installutil.exe might be writing the log to the working directory. Use SetOutPath to set the working direcotry.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">DOCa Cola</span><br />
      <span class="post-time small text-muted">7th May 2003 20:03 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">i know exactly what he means<br />
      i am using an extraction program in my installer, sometimes it extracts the files to the pluginsdir and sometimes to the path i have defined with setoutpath<br />
      the most time it works is the first time i execute a new compiled setup, the next time i start it the lines are just ignored because he tries to start the extraction program from the pluginsdir where it is not present<br />
      <br />
      DOCa Cola</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
      <span class="post-time small text-muted">7th May 2003 20:17 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Well, I'll have to see the script to understand exactly what you're talking about but basically you always have to either have SetOutPath tell the installer exactly where to extract the file or use /oname=. Also make sure you're using b1 and above so SetOutPath will really sets the working directory.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">DOCa Cola</span><br />
      <span class="post-time small text-muted">7th May 2003 20:23 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">i am using the cvs<br />
      i tried it several times with different variantions between $instdir, $instdir\ and so on, that didn't help<br />
      The problem does not persist for me because i give "$instdir\program.exe" as command instead of "program.exe", but another problem is that i have to use something like "$instdir\program.exe outdir\" and then it extracts to the pluginsdir (or to where i specified the last setoutpath to) (i am not sure, maybe it sometimes takes the setoutpath before the setoutpath i definied for the extraction, but the strange thing is that it only happens sometimes)<br />
      In my extraction program i have given the full path as extraction point and that works<br />
      <br />
      DOCa Cola</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">dabossuk</span><br />
      <span class="post-time small text-muted">7th May 2003 20:25 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Orginally I tried the following :<br />
      <br />
      &gt;&gt;&gt;CODE&gt;&gt;&gt;<br />
      Section "Trinet Service" Section1<br />
      ;The files<br />
      SetOutPath "$INSTDIR"<br />
      File "..\source\trinetservice.exe"<br />
      File "..\source\installutil.exe"<br />
      Banner::show /NOUNLOAD "Installing Trinet Service ..."<br />
      nsExec::ExecToLog '"installutil.exe" /showcallstack "trinetservice.exe"'<br />
      &gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;<br />
      <br />
      Sometimes this work about 50/50 and others it did not ... I thought maybe it was timing - the file had not copied before it was called - so then I tried.<br />
      <br />
      <br />
      &gt;&gt;&gt;&gt;&gt;CODE&gt;&gt;&gt;&gt;&gt;<br />
      Function .onInit<br />
      <br />
      InitPluginsDir<br />
      File /oname=$PLUGINSDIR\splash.bmp "splash.bmp"<br />
      File /oname=$PLUGINSDIR\installutil.exe "..\source\installutil.exe"<br />
      <br />
      Section "Trinet Service" Section1<br />
      <br />
      ;The files<br />
      <br />
      SetOutPath "$INSTDIR"<br />
      File "..\source\trinetservice.exe"<br />
      Banner::show /NOUNLOAD "Installing Trinet Service ..."<br />
      nsExec::ExecToLog '"$PLUGINSDIR\installutil.exe" /showcallstack "trinetservice.exe<br />
      &gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;<br />
      <br />
      The above worked better - but not 100% of the time. Its just totally random. I would be run the setup, uninstall and then run again and it would not work. When you call installutil.exe it creates a file if it fails or passes called .installlog - I was not seeing this file anywhere on my machine. I run the install and then it was created.<br />
      <br />
      I have used other EXE's like regasm32.exe and its been fine ... I wonder if its something to do with the exe file itself ? with execlog - if it fails does it say that in the log ? Ie cannot find file or something like that ?<br />
      <br />
      Paul</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">DOCa Cola</span><br />
      <span class="post-time small text-muted">7th May 2003 20:27 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">nope, its a problem with nsexec, it sometimes tries to run your program from another location and cannot find the tool, so there it ignores the command</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
      <span class="post-time small text-muted">7th May 2003 20:36 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">nsExec returns a string on the top of the stack. What does it return for you when it fails?<br />
      <br />
      For example:<br />
      <br /></p>
      <pre>
<code>nsExec::ExecToLog 'a-program.exe'<br />Pop $0<br />MessageBox MB_OK $0</code>
</pre>
    </div>
    <hr />

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]>
  </script>
</body>
</html>
