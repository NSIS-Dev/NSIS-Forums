<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="determine highest value in a specified section" />

  <title>determine highest value in a specified section - NSIS Forums</title><!-- Bootstrap core CSS -->
  <link rel="stylesheet" type="text/css" href="//netdna.bootstrapcdn.com/bootswatch/3.0.1/readable/bootstrap.min.css" />
  <link rel="stylesheet" href="../css/style.css" type="text/css" /><!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!--[if lt IE 9]>
                <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
                <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->
</head>

<body>
  <div class="container">
    <!-- Put navigation bar here -->

    <ol class="breadcrumb">
      <li><a href="../index.html" class="glyphicon glyphicon-home"></a></li>

      <li><a href="f-65.html">NSIS Discussion</a></li>

      <li class="active">determine highest value in a specified section</li>
    </ol>

    <p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=117191">determine highest value in a specified section</a></p><br />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Yathosho</span><br />
      <span class="post-time small text-muted">9th December 2002 01:16 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>determine highest value in a specified section</strong><br />
      long time ago, smile2me helped me on a script i used on an add-on for <a href="http://www.mirc.co.uk" target="_blank">mIRC</a>:<br />
      <br /></p>
      <pre>
<span style="color: #007700">Function</span><span style="color: #0000BB">FindNumber
<br />Exch</span><span style="color: #007700">$</span><span style="color: #0000BB">0
<br />Push</span><span style="color: #007700">$</span><span style="color: #0000BB">1
<br />Push</span><span style="color: #007700">$</span><span style="color: #0000BB">2
<br />StrCpy</span><span style="color: #007700">$</span><span style="color: #0000BB">1</span><span style="color: #DD0000">"0"
<br /><br /></span><span style="color: #0000BB">loop</span><span style="color: #007700">:
<br /></span><span style="color: #0000BB">IntOp</span><span style="color: #007700">$</span><span style="color: #0000BB">1</span><span style="color: #007700">$</span><span style="color: #0000BB">1</span><span style="color: #007700">+</span><span style="color: #0000BB">1
<br />StrCpy</span><span style="color: #007700">$</span><span style="color: #0000BB">2</span><span style="color: #007700">$</span><span style="color: #0000BB">01</span><span style="color: #007700">$</span><span style="color: #0000BB">1
<br />StrCmp</span><span style="color: #007700">$</span><span style="color: #0000BB">2</span><span style="color: #DD0000">"="</span><span style="color: #0000BB">0loop
<br />StrCpy</span><span style="color: #007700">$</span><span style="color: #0000BB">0</span><span style="color: #007700">$</span><span style="color: #0000BB">0</span><span style="color: #007700">$</span><span style="color: #0000BB">1
<br />Pop</span><span style="color: #007700">$</span><span style="color: #0000BB">2
<br />Pop</span><span style="color: #007700">$</span><span style="color: #0000BB">1
<br />Exch</span><span style="color: #007700">$</span><span style="color: #0000BB">0
<br />FunctionEnd
<br /><br />Section</span><span style="color: #007700">-</span><span style="color: #0000BB">config
<br />StrCpy$R9</span><span style="color: #DD0000">"0"
<br /></span><span style="color: #0000BB">fileopen</span><span style="color: #007700">$</span><span style="color: #0000BB">0</span><span style="color: #DD0000">"servers.ini""r"
<br /><br /></span><span style="color: #0000BB">Loop</span><span style="color: #007700">:
<br /></span><span style="color: #0000BB">fileread</span><span style="color: #007700">$</span><span style="color: #0000BB">0</span><span style="color: #007700">$</span><span style="color: #0000BB">1
<br />StrCmp</span><span style="color: #007700">$</span><span style="color: #0000BB">1</span><span style="color: #DD0000">""</span><span style="color: #0000BB">ExitLoop
<br />StrCpy</span><span style="color: #007700">$</span><span style="color: #0000BB">2</span><span style="color: #007700">$</span><span style="color: #0000BB">11
<br />StrCmp</span><span style="color: #007700">$</span><span style="color: #0000BB">2</span><span style="color: #DD0000">"n"</span><span style="color: #0000BB">0Loop
<br />StrCpy</span><span style="color: #007700">$</span><span style="color: #0000BB">2</span><span style="color: #007700">$</span><span style="color: #0000BB">1</span><span style="color: #DD0000">""</span><span style="color: #0000BB">1
<br />Push</span><span style="color: #007700">$</span><span style="color: #0000BB">2
<br />CallFindNumber
<br />Pop</span><span style="color: #007700">$</span><span style="color: #0000BB">2
<br />IntCmp</span><span style="color: #007700">$</span><span style="color: #0000BB">2$R9LoopLoop
<br />StrCpy$R9</span><span style="color: #007700">$</span><span style="color: #0000BB">2
<br />GotoLoop
<br /><br />ExitLoop</span><span style="color: #007700">:
<br /></span><span style="color: #0000BB">FileClose</span><span style="color: #007700">$</span><span style="color: #0000BB">0
<br />MessageBoxMB_OK</span><span style="color: #DD0000">"Thehighestentryis$R8"
</span>
</pre>i'd love to use this script on the mirc.ini, which in difference to the servers.ini has various sections. the layout of mirc.ini looks like this:<br />
      <br />
      <b>[section]<br />
      n0=entry 0<br />
      n1=entry 1<br />
      n2=entry 2<br />
      <br />
      [another section]<br />
      n0=entry 0<br />
      n1=entry 1<br />
      n2=entry 2</b><br />
      etc.<br />
      <br />
      i could need a helping hand on how to modify the script above to do the following.<br />
      <br />
      i need to script to do the same in a specified section, let's say determine the highest value (nX) in a section [example].
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Yathosho</span><br />
      <span class="post-time small text-muted">9th December 2002 01:26 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>same script, different question</strong><br />
      i got the working script above by adding this:<br />
      <br /></p>
      <pre>
<code>ExitLoop</code><span style="color: #007700">:
<br /></span><span style="color: #0000BB">FileClose</span><span style="color: #007700">$</span><span style="color: #0000BB">0
<br />IntOp$R8$R9</span><span style="color: #007700">+</span><span style="color: #0000BB">1
<br />WriteINIStrservers</span><span style="color: #007700">.</span><span style="color: #0000BB">iniserversn$R8</span><span style="color: #DD0000">"someentry"
</span>
</pre>now i want to use the last line multiple times, which of course requires a different value for $R8.<br />
      <br />
      <pre>
<code>IntOp$R8$R9</code><span style="color: #007700">+</span><span style="color: #0000BB">1
<br />WriteINIStrservers</span><span style="color: #007700">.</span><span style="color: #0000BB">iniserversn$R8</span><span style="color: #DD0000">"someentry"
<br /></span><span style="color: #0000BB">IntOp$R8$R8</span><span style="color: #007700">+</span><span style="color: #0000BB">1
<br />WriteINIStrservers</span><span style="color: #007700">.</span><span style="color: #0000BB">iniserversn$R8</span><span style="color: #DD0000">"someentry"
<br /></span><span style="color: #0000BB">IntOp$R8$R8
<br /></span>
</pre>did not work (which is natural i guess). but i dont know how to solve this issue. of course i could rename the string $R8 to something different, but then i'm still limited to $R0 - $R9. is there a more elegant way to solve this (a loop maybe?).<br />
      <br />
      help is highly appreciated.
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
      <span class="post-time small text-muted">9th December 2002 17:01 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">First of all, please attach large scripts next time and don't open a new thread for a question that continues the one from another thread of yours.<br />
      <br />
      Now, to get the highest number in a specified section I would take a different approach since the one presented here gets the highest number in the first section found that has an entry starting with "n".<br />
      <br /></p>
      <pre>
<code>StrCpy</code><span style="color: #007700">$</span><span style="color: #0000BB">00
<br />Loop</span><span style="color: #007700">:
<br /></span><span style="color: #0000BB">ReadINIStr</span><span style="color: #007700">$</span><span style="color: #0000BB">1</span><span style="color: #DD0000">"mirc.ini""insertdesiredinisectionnamehere"</span><span style="color: #0000BB">n</span><span style="color: #007700">$</span><span style="color: #0000BB">0
<br />IfErrorsDone
<br />IntOp</span><span style="color: #007700">$</span><span style="color: #0000BB">0</span><span style="color: #007700">$</span><span style="color: #0000BB">0</span><span style="color: #007700">+</span><span style="color: #0000BB">1
<br />GotoLoop
<br /><br />Done</span><span style="color: #007700">:;$</span><span style="color: #0000BB">0isnowthefirstunusednumberintheINIfilesection
<br /></span>
</pre>To add entries then, all you need to do is call WriteIniStr and after each time you call it use IntOp $0 $0 + 1 to make sure the number you get is unique.
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Yathosho</span><br />
      <span class="post-time small text-muted">9th December 2002 23:28 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">does not work, always reports "0" (i used messagebox to check this)</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
      <span class="post-time small text-muted">10th December 2002 14:23 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">It works perfectly fine for me... Are you sure you have specified the right path to mirc.ini and the right section name?</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Yathosho</span><br />
      <span class="post-time small text-muted">10th December 2002 14:59 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">i tried <b>[section]</b> and <b>section</b> , both resulted the same. if you have the time, i can send you the script via icq, you got my uin ;)</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Yathosho</span><br />
      <span class="post-time small text-muted">11th December 2002 13:21 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">is it possible to additionally use a duplicate-filter?<br />
      <br />
      n0=Leningrad<br />
      n1=Paris<br />
      n2=Madrid<br />
      <br />
      at this point it wouldnt be necessary to add n3=Leningrad, since it exists already. any chance to avoid duplicates in that script?</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
      <span class="post-time small text-muted">11th December 2002 15:22 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">You can compare the value you want to add with each n# and if it's already there just not add it.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Yathosho</span><br />
      <span class="post-time small text-muted">11th December 2002 21:24 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">hm, but what about the prefix "nX=" ?</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
      <span class="post-time small text-muted">12th December 2002 15:24 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">ReadINIStr reads the value. The value doesn't include the nX=.</p>
    </div>
    <hr />

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]>
  </script>
</body>
</html>
