<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="Unicode" />

  <title>Unicode - NSIS Forums</title>
  <script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script>
  <!-- Bootstrap core CSS -->

  <link rel="stylesheet" type="text/css" href="//netdna.bootstrapcdn.com/bootswatch/3.0.1/readable/bootstrap.min.css" />
  <link rel="stylesheet" href="../css/style.css" type="text/css" /><!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!--[if lt IE 9]>
                <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
                <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content=" Unicode" />

  <title>Unicode - NSIS Forums</title>
  <link rel="stylesheet" type="text/css" href="//netdna.bootstrapcdn.com/bootswatch/3.0.1/readable/bootstrap.min.css" />
  <link rel="stylesheet" href="../css/style.css" type="text/css" />
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content=" Unicode" />

  <title>Unicode - NSIS Forums</title>
  <link rel="stylesheet" type="text/css" href="//netdna.bootstrapcdn.com/bootswatch/3.0.1/readable/bootstrap.min.css" />
  <link rel="stylesheet" href="../css/style.css" type="text/css" />
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content=" Unicode" />

  <title>Unicode - NSIS Forums</title>
  <link rel="stylesheet" type="text/css" href="//netdna.bootstrapcdn.com/bootswatch/3.0.1/readable/bootstrap.min.css" />
  <link rel="stylesheet" href="../css/style.css" type="text/css" />
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content=" Unicode" />

  <title>Unicode - NSIS Forums</title>
  <link rel="stylesheet" type="text/css" href="//netdna.bootstrapcdn.com/bootswatch/3.0.1/readable/bootstrap.min.css" />
  <link rel="stylesheet" href="../css/style.css" type="text/css" />
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content=" Unicode" />

  <title>Unicode - NSIS Forums</title>
  <link rel="stylesheet" type="text/css" href="//netdna.bootstrapcdn.com/bootswatch/3.0.1/readable/bootstrap.min.css" />
  <link rel="stylesheet" href="../css/style.css" type="text/css" />
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content=" Unicode" />

  <title>Unicode - NSIS Forums</title>
  <link rel="stylesheet" type="text/css" href="//netdna.bootstrapcdn.com/bootswatch/3.0.1/readable/bootstrap.min.css" />
  <link rel="stylesheet" href="../css/style.css" type="text/css" />
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content=" Unicode" />

  <title>Unicode - NSIS Forums</title>
  <link rel="stylesheet" type="text/css" href="//netdna.bootstrapcdn.com/bootswatch/3.0.1/readable/bootstrap.min.css" />
  <link rel="stylesheet" href="../css/style.css" type="text/css" />
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content=" Unicode" />

  <title>Unicode - NSIS Forums</title>
  <link rel="stylesheet" type="text/css" href="//netdna.bootstrapcdn.com/bootswatch/3.0.1/readable/bootstrap.min.css" />
  <link rel="stylesheet" href="../css/style.css" type="text/css" />
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content=" Unicode" />

  <title>Unicode - NSIS Forums</title>
  <link rel="stylesheet" type="text/css" href="//netdna.bootstrapcdn.com/bootswatch/3.0.1/readable/bootstrap.min.css" />
  <link rel="stylesheet" href="../css/style.css" type="text/css" />
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content=" Unicode" />

  <title>Unicode - NSIS Forums</title>
  <link rel="stylesheet" type="text/css" href="//netdna.bootstrapcdn.com/bootswatch/3.0.1/readable/bootstrap.min.css" />
  <link rel="stylesheet" href="../css/style.css" type="text/css" />
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content=" Unicode" />

  <title>Unicode - NSIS Forums</title>
  <link rel="stylesheet" type="text/css" href="//netdna.bootstrapcdn.com/bootswatch/3.0.1/readable/bootstrap.min.css" />
  <link rel="stylesheet" href="../css/style.css" type="text/css" />
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content=" Unicode" />

  <title>Unicode - NSIS Forums</title>
  <link rel="stylesheet" type="text/css" href="//netdna.bootstrapcdn.com/bootswatch/3.0.1/readable/bootstrap.min.css" />
  <link rel="stylesheet" href="../css/style.css" type="text/css" />
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content=" Unicode" />

  <title>Unicode - NSIS Forums</title>
  <link rel="stylesheet" type="text/css" href="//netdna.bootstrapcdn.com/bootswatch/3.0.1/readable/bootstrap.min.css" />
  <link rel="stylesheet" href="../css/style.css" type="text/css" />
</head>

<body>
  <div class="container">
    <!-- Put navigation bar here -->

    <ol class="breadcrumb">
      <li><a href="../index.html" class="glyphicon glyphicon-home"></a></li>

      <li><a href="f-65.html">NSIS Discussion</a></li>

      <li class="active">Unicode</li>
    </ol>

    <p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=277381">Unicode</a></p><br />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
      <span class="post-time small text-muted">15th September 2007 11:41 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>Unicode</strong><br />
      Jim Park has issued a patch to add Unicode support to NSIS. Currently it's a completely different build that can create nothing but Unicode installers (no Windows 9x support).<br />
      <br />
      Please help me test it for speedier integration.<br />
      <br />
      <a href="https://sourceforge.net/tracker/?func=detail&amp;atid=373087&amp;aid=1795257&amp;group_id=22049" target="_blank">https://sourceforge.net/tracker/?fun...group_id=22049</a><br />
      <br />
      You can download a pre-built version from:<br />
      <br />
      <a href="http://www.scratchpaper.com/nsis-05-Sep-2007.cvs-unicode-setup.exe" target="_blank">http://www.scratchpaper.com/nsis-05-...code-setup.exe</a></p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">jimpark</span><br />
      <span class="post-time small text-muted">15th September 2007 14:23 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Thanks for posting that kichik.<br />
      <br />
      A few things to note. The Unicode NSIS installer is COMPLETELY Unicode. This means that your NSI script must also be Unicode (UTF-16LE). This can easily be done by using Notepad. Just change the encoding to "Unicode" and that will do it.<br />
      <br />
      Note that the plugins you may be relying on will not work unless they are also built with Unicode in mind. This means that the access to the global stack that is used to transmit information back and forth from plugin to NSIS must contain Unicode (wchar_t) strings.<br />
      <br />
      *** Developers ***<br />
      If you are a plugin author, it shouldn't be too difficult to make the changes. You can take a look at what I did for the standard plugins that ship with NSIS. The source is here:<br />
      <br />
      <a href="http://www.scratchpaper.com/source.zip" target="_blank">http://www.scratchpaper.com/source.zip</a><br />
      <br />
      If you look at ExDLL, you will notice new functions that will help you with the translation of the stack as well. For instance, if you DLL only cares about ASCII codesets, then you may not need to do much modifications at all. It just needs to call the new functions that automatically translate the stack's strings from Unicode to ANSI and ANSI to Unicode. But most likely, if you are dealing with user entered strings, you will need to make your DLL completely Unicode aware as well.<br />
      <br />
      The source uses TCHARs so you can target building both ANSI and Unicode versions of NSIS. It is based on NSIS 2.29 with some bug fixes and minor tweaks. If you are interested, the ANSI version of the binary built with the same source code is also here:<br />
      <br />
      <a href="http://www.scratchpaper.com/nsis-05-Sep-2007.cvs-setup.exe" target="_blank">http://www.scratchpaper.com/nsis-05-....cvs-setup.exe</a><br />
      <br />
      Please look at the tracker submission for more information about building the source yourself. I developed on VS2005 and I would be surprised if it builds on the other platforms. Even if they do, I did not change the SCONS config files for the other platforms to define _UNICODE and UNICODE which is what's needed for the source to be built as Unicode.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
      <span class="post-time small text-muted">17th September 2007 21:45 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Source code link:<br />
      <br />
      <a href="http://www.scratchpaper.com/source.zip" target="_blank">http://www.scratchpaper.com/source.zip</a><br />
      <br />
      ANSI version link:<br />
      <br />
      <a href="http://www.scratchpaper.com/nsis-05-Sep-2007.cvs-setup.exe" target="_blank">http://www.scratchpaper.com/nsis-05-....cvs-setup.exe</a></p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Joel</span><br />
      <span class="post-time small text-muted">18th September 2007 04:42 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Is this will affect future versions? I mean I'm not a UNICODE fan, but if is it going to be...</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">jimpark</span><br />
      <span class="post-time small text-muted">18th September 2007 11:31 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Well, the niceness of this approach is that those who want the ANSI version for Win95/98/ME compatibility can use the ANSI version. For those who need support of languages that only Unicode can provide can use the Unicode version. It gives you a choice. And we can give you that choice with one code base.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">HaydenDevlin</span><br />
      <span class="post-time small text-muted">19th September 2007 14:09 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">I have just adapted my installer to use this unicode version for a russian language installer, and everything seems fine in russian except for some reason the welcome page has loads of question marks instead of the correct characters of the introduction text. It's weird because all the other panels are fine. Does anyone know what is going on here?<br />
      <br />
      Cheers,<br />
      <br />
      Hayden Devlin</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">jimpark</span><br />
      <span class="post-time small text-muted">20th September 2007 13:26 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">The introduction text should ALSO be Unicode. So open it up in Notepad and then save as Unicode encoding. That should work. So remember EVERYTHING must be Unicode. If you have an ASCII file, you need to make sure it's now UNICODE. Hope this helps.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">dienjd</span><br />
      <span class="post-time small text-muted">20th September 2007 16:41 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Sounds great. One quick question: what happens when one of these builds gets run on 9x? Is it possible to detect in .onInit and show a MessageBox to the user, or would it just crash immediately? If the latter, then I guess the build could be wrapped by a non-Unicode build that does this detection and messaging.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">dienjd</span><br />
      <span class="post-time small text-muted">20th September 2007 17:48 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"></p>

      <blockquote>
        <i>Originally posted by dienjd</i><br />
        <b>Sounds great. One quick question: what happens when one of these builds gets run on 9x? Is it possible to detect in .onInit and show a MessageBox to the user, or would it just crash immediately? If the latter, then I guess the build could be wrapped by a non-Unicode build that does this detection and messaging.</b>
      </blockquote>I decided to not be so lazy and just try for myself. I compiled Examples\bigtest.nsi and tried it on Windows 98. It crashed immediately, which is expected. However, there are ways to gracefully handle this, as I mentioned in my last post.
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Comm@nder21</span><br />
      <span class="post-time small text-muted">21st September 2007 00:43 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">how about Microsoft Layer for Unicode on Win95/98/ME (MSLU)?<br />
      <br />
      <a href="http://www.microsoft.com.nsatc.net/globaldev/handson/dev/mslu_announce.mspx" target="_blank">http://www.microsoft.com.nsatc.net/g..._announce.mspx</a><br />
      <br />
      sounds easy to integrate.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Anders</span><br />
      <span class="post-time small text-muted">21st September 2007 00:57 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">yeah, but you have to ship the MSLU dll along with the installer</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Comm@nder21</span><br />
      <span class="post-time small text-muted">21st September 2007 01:06 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">well, at least nsis may get compiled against mslu, so it still works normal on win2k/xp/vista, but also MAY work on win95/98/me IF the user has mslu installed.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">dienjd</span><br />
      <span class="post-time small text-muted">21st September 2007 15:56 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">When converting ANSI files to Unicode, I've noticed that the conversion works fine with Notepad, but converting using Textpad or the iconv program on FreeBSD results in the Unicode file not working with Unicode NSIS.<br />
      <br />
      While testing this patched version of NSIS, I want to be able to automatically convert files as part of a build process instead of maintaining separate copies of the same files but just in different encodings. Notepad doesn't seem to have a command line interface other than 'notepad.exe filename.txt'. I guess I could make something that launches Notepad and hooks the window to do a Save As :)<br />
      <br />
      This isn't a big deal, but it would be nice to have. Anyone have ideas on how to do this other than the ugly window hooking method?</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
      <span class="post-time small text-muted">21st September 2007 16:03 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">There are a few possible reasons. The first is conversion to a wrong charset. Even Unicode has multiple charsets available. Make sure you convert to UTF-16LE.<br />
      <br />
      Another reason could be a missing BOM. Try perpending the file content with FF FE (the actual bytes, not text).</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">jimpark</span><br />
      <span class="post-time small text-muted">21st September 2007 18:03 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">My thoughts are exactly the same as kichik's. Here's a little utility I wrote called a2u.exe that converts an ANSI codepage text file to Unicode. You provide what codepage to use. So it can be run regardless of your OS codepage setting. So this will fit your bill in making this whole process automated. (I didn't convert all the include files, example, etc., by hand, you know?) It should also be helpful in converting your current NSIS scripts to Unicode as well.<br />
      <br />
      I included the source as well so you can modify it to work anyway you want.<br />
      <br />
      Look in http://www.scratchpaper.com/a2u.zip or I'm attaching the file here as well.<br />
      <br />
      Enjoy.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">dienjd</span><br />
      <span class="post-time small text-muted">21st September 2007 18:11 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Thanks for the utility and patch. The Unicode support will hopefully save me from having to use InstallShield!</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Benski</span><br />
      <span class="post-time small text-muted">23rd September 2007 03:22 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Jim -<br />
      <br />
      We'll give this thing a good workout soon.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Clammerz</span><br />
      <span class="post-time small text-muted">29th September 2007 20:02 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Anymore news about this?<br />
      <br />
      Will it be integrated into the main NSIS branch someday? Any extreme rough timeframes if so? (something like 3 months, 6months a year, etc?)<br />
      <br />
      I suggest making this sticky since it's pretty important news.<br />
      <br />
      Thanks heaps for the patch work Jim. Your efforts are greatly appreciated.<br />
      <br />
      Sidenote question: If you are using the System plugin for API calls, will you have to use the Unicode calls, or can you use the normal ANSI calls too?</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
      <span class="post-time small text-muted">29th September 2007 20:58 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Should be integrated, no timeframes and System can already handle both ANSI and Unicode so nothing should change.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">jimpark</span><br />
      <span class="post-time small text-muted">1st October 2007 08:48 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">The only change made to System is that all the calls default to Unicode strings rather than ANSI strings. So for example, if you specified MessageBox(...), then it will actualyl call MessageBoxW(...). As long as you provide the right function signature, then the System will work as you expect. I just had to rework some of the interfacing back and forth through the NSIS global stack but using it should be the same.<br />
      <br />
      You WANT to use the Unicode functions by default because while it will automatically convert Unicode strings to ANSI codepage and back when you call ANSI functions, you may actually lose vital information or get bad behavior if the user's computer's code page setting is different from what you'd expect. And definitely things will not work if you are trying to provide an installer for a Unicode only language.<br />
      <br />
      If you are converting your script from the ANSI NSIS to Unicode, and you are using the System plugin, look for functions that are ANSI only. Most of these end in "A". Change them to use Unicode. Or just specify their "TCHAR" versions -- i.e. MessageBox instead of MessageBoxW or MessageBoxA. Then the correct one will be picked up by your NSIS installer.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">jimpark</span><br />
      <span class="post-time small text-muted">4th October 2007 20:18 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Kichik, I was wondering, also, of what it would take for it to be incorporated into the NSIS trunk. Since the source for Unicode NSIS can generate both Unicode and ANSI versions of NSIS, bug fixes in this version of the source will benefit both the Unicode and the ANSI version. I would hate to see the Unicode NSIS code get orphaned. If we wait much longer the code base for the NSIS and Unicode NSIS will diverge too much and someone's going to have to redo the 1.5 months of fulltime work to make it work again.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
      <span class="post-time small text-muted">5th October 2007 15:07 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">As I see it, the first step is a completely separate build for Unicode (like 8192 string and logging builds) which will minimally affect the main build. Later, the compiler can start moving towards being able to create either type of installers. Finally, the stubs could be made common so ANSI will be automatically used on 9x and Unicode on any capable system.<br />
      <br />
      I, too, would hate to see the code gets orphaned, requiring more and more work with each passing version. To get to first step done and integrate it as a separate build, I'd want to make it as hassle free as possible. Currently it seems there are more than a few changes that'd require extra maintenance and will serve useful only for the Unicode build. All of the SConscript changes are good example. There is no need for duplication of examples and such - makensis.exe should be able to read ANSI scripts and differentiate Unicode scripts according to BOM.<br />
      <br />
      Another minor example is wininit.ini handling. Since that's only supported on 9x, the code could be completely removed for Unicode builds and there's no need for the conversions and Unicode specific code paths.<br />
      <br />
      Lines 716-726 in Source\exehead\util.c could be reduced to a cast to char*.<br />
      <br />
      NSIS Menu doesn't have to be Unicode. But I guess it'd be useful for translated packages of NSIS itself. In that case, it'd be easier to have wxUSE_UNICODE defined externally or according to _UNICODE instead of having two setup.h.<br />
      <br />
      In short, every #ifdef _UNICODE or separate Unicode file is more work down the line. I can't ask you to make all the changes, but that's what I'll do when I integrate it. I will probably do it gradually, but I'll definitly start with automatically generating the duplicate files or getting rid of the need for them.<br />
      <br />
      If you do, however, wish to help with this, I can create a branch for this in the soon-to-live SVN repository where you can check-in the changes. I will also do my best to sync it with trunk for every released version (which hopefully won't be too many).</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
      <span class="post-time small text-muted">5th October 2007 15:13 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Just had a look at Benski's Unicode branch and saw he used a nice trick to get around the CHAR4_TO_DWORD optimization - QTCHAR.<br />
      <br />
      <a href="http://nsis.cvs.sourceforge.net/nsis/NSIS/Source/exehead/Main.c?r1=1.71.2.1&amp;r2=1.71.2.2&amp;pathrev=UNICODE" target="_blank">http://nsis.cvs.sourceforge.net/nsis...athrev=UNICODE</a></p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">jimpark</span><br />
      <span class="post-time small text-muted">11th October 2007 04:29 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Actually, I disagree that the examples and NSIS include files should be generated from a single source for both. Eventually, the number of languages supported for Unicode will continue to grow while the number ANSI languages have already stopped growing. The common subset (e.g. Latin I) may be able to share a common source but even then there are things like System calls that will be subtly different for ANSI and Unicode. Much like the C++ source itself, we may have to add #ifdef UNICODE or some equivalent into the NSIS scripts if we pursue having one source script for both. But again, I imagine that the Unicode languages will continue to grow which will never have an ANSI counterpart. And Win9x/ME OSes will continue to dwindle in significance.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
      <span class="post-time small text-muted">16th October 2007 00:09 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">But currently there are none and so it generates an unjustified work overhead. Updating an example requires updating two files. That's always a cause for nice little "oops" bugs.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">jimpark</span><br />
      <span class="post-time small text-muted">16th October 2007 14:37 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">That is true. So for now, I do have that a2u.exe that I've uploaded here. We can use it as part of the build process to take the ANSI scripts and convert them to Unicode ones for those which are easily derivable. For those that do need hand tweaks (there may be a few), we can keep those separate. For scripts that use the System plugin, for example, we need only use the API without the "W" or "A" as the suffix i.e. don't use MessageBoxA or MessageBoxW just MessageBox and the correct version will be picked up by the System plugin. So I think it's quite possible to achieve a unified single source for most scripts.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">jimpark</span><br />
      <span class="post-time small text-muted">7th November 2007 16:11 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">I may have misunderstood your post. If you mean that there are no languages that are Unicode-only, then here are some:<br />
      1. Amharic<br />
      2. Armenian<br />
      3. Assamese (India)<br />
      4. Bengali (India)<br />
      5. Divehi (Maldives)<br />
      6. Georgian<br />
      7. Gujarati<br />
      8. Hindi<br />
      9. Inukitut (Canada, Syllabics) -- not the Latin-based one<br />
      10. Kannada<br />
      11. Khmer (Cambodia)<br />
      12. Konkani<br />
      13. Marathi<br />
      14. Nepali<br />
      15. Punjabi<br />
      16. Sanskrit<br />
      17. Sinhala (Sri Lanka)<br />
      18. Telugu (India)<br />
      <br />
      The list is growing. Also, many people including myself run apps localized to a different language than the codepage of the OS that they're running. So the desire for Unicode support for an installer is there and the need is getting stronger.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
      <span class="post-time small text-muted">7th November 2007 19:21 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">There are none in NSIS. And even if language files are added for those, it still doesn't justify having every example in Unicode as most examples don't demonstrate multiple languages and those that do, usually do this with a small collection of languages.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">AxelMock</span><br />
      <span class="post-time small text-muted">8th November 2007 08:24 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"></p>

      <blockquote>
        <i>Originally posted by kichik</i><br />
        <b>There are none in NSIS. And even if language files are added for those, it still doesn't justify having every example in Unicode as most examples don't demonstrate multiple languages and those that do, usually do this with a small collection of languages.</b>
      </blockquote>Hi,<br />
      <br />
      I find the idea of a unicode capable NSIS compiler great.<br />
      I've built an (standard NSIS)installer for network drivers which currently supports 25 languages, including 2 RTL languages.<br />
      <br />
      If we had to add some extra dialogs or messages all translation services would deliver unicode files.<br />
      I haven't yet understood or found a detailed explanation of how to safely convert unicode texts into NSIS codepage-based strings.<br />
      Being able to directly use unicode strings would significantly ease localization.<br />
      <br />
      In my work I normally use PERL and the automated generation of Windows driver .inf files (UTF-16) is done by PERL scripts.<br />
      But NONE of the sources/templates, except for the NLS dependent parts (strings and readme files), are in UTF-16. As PERL uses UTF-8 internally and ASCII is a real subset of UTF-8 there is no need to have program sources in UTF-16.<br />
      When including a NLS file, which is in UTF-16, this is detected at read time.<br />
      <br />
      I don't know if the Microsoft C++ API only supports UTF-16, but I think it should not be a great problem to have a smart "read file" function which does detection and conversion, even if internally all is handled in UTF-16.
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
      <span class="post-time small text-muted">8th November 2007 17:04 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"></p>

      <blockquote>
        I don't know if the Microsoft C++ API only supports UTF-16, but I think it should not be a great problem to have a smart "read file" function which does detection and conversion, even if internally all is handled in UTF-16.
      </blockquote>They support both ANSI and UTF-16. There is even a function for determining if a buffer is Unicode or not. The standard even defines special markers for files that specify if they're ANSI, UTF-8, UTF-16LE or UTF-16BE. They are called BOMs.<br />
      <br />
      It shouldn't be too hard to make the compiler support both ANSI and UTF-16. But I'm just saying it won't serve too much of a purpose to have the examples in SVN in both ANSI and UTF-16. There are currently no examples whatsoever that need Unicode. If there will ever be, they can be specific to the Unicode build.
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">jimpark</span><br />
      <span class="post-time small text-muted">8th November 2007 20:45 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">As I mentioned before, for the languages that have codepage support, I simply ran a a2u.exe to convert the ANSI script to the Unicode script. I did not hand edit all of those. I don't know 25 languages, after all. :) So you could have one source file for each language and then GENERATE ANSI and Unicode versions of the example files. So in essence, you never have "oops" mistakes because there is only one source.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">KrisAster</span><br />
      <span class="post-time small text-muted">8th November 2007 21:10 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">From your reply, Kichik, it seems as though there IS going to be a Unicode build of some form. Is this correct? Does that mean that this Unicode build is going to be integrated into the main release sometime soon?<br />
      <br />
      If so, that will be great. I for one have need for an installer in one of the languages mentioned below (Georgian), and next year I may have need of one of the others. PLUS, the benefits of not having to switch code-pages in order to have the install show up with intelligible text is also very nice.<br />
      <br />
      Additionally, how many people have tried this version of the installer? I'd like some idea of how stable it is and how it is supported on different OSes. My experience so far has been very good. I was able to build my install with the version made available here without any changes to my script (other than saving the file in Unicode), and it is a pretty large script (1K lines). I'm now in the process of localizing the Georgian version, and I'll make sure to post back with how successful the results were.<br />
      <br />
      Unicode seems to be the wave of the future, and I'll be really happy to see NSIS make the path available for those of us who want it. After all, the product I'm shipping does not support any of the ANSI versions of Windows, and Microsoft doesn't support them anymore either.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
      <span class="post-time small text-muted">8th November 2007 23:02 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">KrisAster, there's no time frame and my bet won't be on soon.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">jimpark</span><br />
      <span class="post-time small text-muted">19th November 2007 21:59 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">For those using the Unicode version of NSIS, I took the latest 2.33 source and merged the changes onto the Unicode version. The new binaries and source are posted to http://www.scratchpaper.com. Let me know if you find any problems with this release. Also let me know if you find the Unicode version useful.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">jimpark</span><br />
      <span class="post-time small text-muted">21st November 2007 16:39 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">I modified the Unicode language files in the installer to contain vernacular names for the various languages. So you can do something like this:<br />
      <a href="http://www.scratchpaper.com/Unicode-NSIS-Propaganda.gif" target="_blank">http://www.scratchpaper.com/Unicode-NSIS-Propaganda.gif</a></p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">havas</span><br />
      <span class="post-time small text-muted">24th November 2007 12:52 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Thanks for this work. the unicode build works well.<br />
      I'm chinese, and using japanese windows edition to study japanese. And really many chinese language only nsis setup bother me which can't display correctly on my system.<br />
      Really great, hope this Unicode support feature will be merged into the official NSIS.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">CodeSquid</span><br />
      <span class="post-time small text-muted">27th November 2007 13:54 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Thanks for your patch, it seems to be working great.<br />
      <br />
      I'd love to see this included in the official source.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">jimpark</span><br />
      <span class="post-time small text-muted">12th December 2007 20:48 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Unicode NSIS has been updated to support Georgian (a Unicode only language). Updated Unicode Simplified Chinese language files. Also fixed some bugs in<br />
      Unicode Turkish language file and Unicode zip2exe. Please give it a whirl and let me know if you see any more problems. As always, the site is http://www.scratchpaper.com</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">prz</span><br />
      <span class="post-time small text-muted">14th December 2007 15:54 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">I'm trying to use your Unicode version. It works well until the use of some plugins.<br />
      I tryed to convert the GetVersion plugin of AfroUK.<br />
      I put your exDLL and recompiled with no success: the compiler give me some errors. I think that the problem is the definition of _UNICODE but I don't know where to put it (I don't know C++ and its compiling process).<br />
      If someone tells me how to do it, I think I'm able to translate the others plugin I need for my installer.<br />
      <br />
      Thank you</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">jimpark</span><br />
      <span class="post-time small text-muted">15th December 2007 18:09 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Well, it will be a bit difficult not knowing C++ if you want to convert other plugins. But you could try downloading the source from the NSIS branch, then download the source from my site. And you could compare the source files for a smaller plugin like LangDLL and see what the differences are.<br />
      <br />
      BTW, other than the GetVersion plugin, what other plugins do you use?</p>
    </div>
    <hr />
    <!-- Bootstrap core CSS -->
    <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
                <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
                <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->

    <div class="container">
      <!-- Put navigation bar here -->

      <ol class="breadcrumb">
        <li><a href="../index.html" class="glyphicon glyphicon-home"></a></li>

        <li><a href="f-65.html">NSIS Discussion</a></li>

        <li class="active">Unicode</li>
      </ol>

      <p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=277381">Unicode</a></p><br />

      <div class="post">
        <p class="post-meta"><span class="post-author text-primary">prz</span><br />
        <span class="post-time small text-muted">17th December 2007 07:15 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

        <p class="post-content">Yes, C++ isn't the perfect language to make small change for a person doesn't know it.<br />
        Anyway I'll try to do it (is this the right time to study even the C++ :D ?).<br />
        <br />
        These are the plugins that I use in my installer:<br />
        - GetVersion (to kown the Windows and IE versions and the OS architecture)<br />
        - GetSize (to know the size of the data folder)<br />
        - HwInfo (to know the processor name)<br />
        - nsProcess (to kill a process before uninstalling)<br />
        <br />
        Bye</p>
      </div>
      <hr />

      <div class="post">
        <p class="post-meta"><span class="post-author text-primary">CodeSquid</span><br />
        <span class="post-time small text-muted">17th December 2007 07:42 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

        <p class="post-content"></p>

        <blockquote>
          Yes, C++ isn't the perfect language to make small change for a person doesn't know it.
        </blockquote>No language is.
      </div>
      <hr />

      <div class="post">
        <p class="post-meta"><span class="post-author text-primary">prz</span><br />
        <span class="post-time small text-muted">17th December 2007 09:27 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

        <p class="post-content"></p>

        <blockquote>
          <i>Originally posted by CodeSquid</i><br />
          <b>No language is.</b>
        </blockquote>You're right, but C++ isn't the easier one.
      </div>
      <hr />

      <div class="post">
        <p class="post-meta"><span class="post-author text-primary">prz</span><br />
        <span class="post-time small text-muted">17th December 2007 09:37 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

        <p class="post-content"></p>

        <blockquote>
          <i>Originally posted by jimpark</i><br />
          <b>Well, it will be a bit difficult not knowing C++ if you want to convert other plugins. But you could try downloading the source from the NSIS branch, then download the source from my site. And you could compare the source files for a smaller plugin like LangDLL and see what the differences are.<br />
          <br />
          BTW, other than the GetVersion plugin, what other plugins do you use?</b>
        </blockquote>I converted GetVersion and works well only under ANSI version (like the original one). Can be the problem in the definition of _UNICODE (I don't find it)?<br />
        <br />
        Thanks
      </div>
      <hr />

      <div class="post">
        <p class="post-meta"><span class="post-author text-primary">prz</span><br />
        <span class="post-time small text-muted">17th December 2007 12:42 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

        <p class="post-content"></p>

        <blockquote>
          <i>Originally posted by prz</i><br />
          <b>I converted GetVersion and works well only under ANSI version (like the original one). Can be the problem in the definition of _UNICODE (I don't find it)?<br />
          <br />
          Thanks</b>
        </blockquote>I added the _UNICODE string to the pre-processor strings, but the output of the plugin is the same of the ANSI version.<br />
        something else to make a unicode version of the plugin?<br />
        <br />
        Bye
      </div>
      <hr />

      <div class="post">
        <p class="post-meta"><span class="post-author text-primary">sfidanza</span><br />
        <span class="post-time small text-muted">30th December 2007 03:12 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

        <p class="post-content">Thanks for the great work on Unicode NSIS, and for hosting it. I just used it for an english/french/czech installer (and I should be adding more languages soon). It still needs to be more thoroughly tested but it seems to have worked fine. :)<br />
        <br />
        A note though: I didn't convert the install script itself to UTF16-LE (I did at first but NIS Edit wouldn't display it correctly). It worked anyway. It was completely ANSI, but ANSI is not a subset of UTF16 so I'm (happily) surprised.<br />
        <br />
        I consider Unicode as the way to go: displaying multiple or Unicode-only languages is more and more needed, and I'm really glad that NSIS is moving to complete Unicode support. :up:</p>
      </div>
      <hr />

      <div class="post">
        <p class="post-meta"><span class="post-author text-primary">jimpark</span><br />
        <span class="post-time small text-muted">30th December 2007 12:17 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

        <p class="post-content">Thank you for the kind words of encouragement. I've never used NIS Edit but I take your word for it that it doesn't understand UTF16. If you didn't convert the script to Unicode, perhaps the ANSI one was run and it created an ANSI installer? One thing you could do is check that the ANSI one works first, then convert it to Unicode using notepad or a2u.exe and then create the installer again using the Unicode version. If it worked for the ANSI it will most likely just work for the converted Unicode version (barring the use of 3rd party plugins that have not been converted to support Unicode.)</p>
      </div>
      <hr />

      <div class="post">
        <p class="post-meta"><span class="post-author text-primary">sfidanza</span><br />
        <span class="post-time small text-muted">30th December 2007 13:42 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

        <p class="post-content">Actually, the ANSI script was compiled with classic NSIS until now. It works correctly. But I wondered if making a unicode installer was possible, and found out about Unicode NSIS.<br />
        I don't use any 3rd party plugin, only language files, which I converted to UTF16-LE. And I updated the link to the compiler in NIS Edit to Unicode NSIS. The only issue was that NIS Edit displays only the BOM of a unicode script.<br />
        <br />
        Classic NSIS wouldn't compile even the ANSI script (using unicode language files), but Unicode NSIS produces a working installer.<br />
        <br />
        However, I just compiled the Unicode script on Unicode NSIS, and did a byte-to-byte comparison of the 2 "unicode" .exe installer: they are indeed not exactly the same.<br />
        I couldn't spot any difference by running them though, even with czech texts (usually requiring CP1250 while I use CP1252 myself). I'll have to test with russian or chinese.<br />
        <br />
        Anyway, I'll use the unicode script from now on to be on the safe side.<br />
        I described everything here in case it is of some help to you. I'll be happy to make some more tests or give some more details if you wish.</p>
      </div>
      <hr />

      <div class="post">
        <p class="post-meta"><span class="post-author text-primary">Joost Verburg</span><br />
        <span class="post-time small text-muted">30th December 2007 17:36 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

        <p class="post-content">What about making a Unicode version that supports both Windows 95/98/Me as well as Windows 2000/XP/Vista? I think it should be possible to have scripts and internal NSIS strings in Unicode but convert the user interface strings to ANSI for 95/98/Me.<br />
        <br />
        Because there is no simple one-to-one conversion of ANSI NSIS scripts to Unicode (multiple codepages can be used in a single file for e.g. LangStrings), we can just call it NSIS 3.0 and require scripts to be in Unicode.</p>
      </div>
      <hr />

      <div class="post">
        <p class="post-meta"><span class="post-author text-primary">jimpark</span><br />
        <span class="post-time small text-muted">30th December 2007 23:00 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

        <p class="post-content">Actually the problem is during the loading the exe and dynamic link time. By using Unicode-based Win32 calls, the program fails to even run. Not sure how to solve that except by distributing unicows.dll with the installer on Win9x. But seriously, I think we should just drop Win9x support soon. Looking at browser OS stats at http://www.w3schools.com/browsers/browsers_os.asp, only 1% of the web users use Win98. And the demographic for users of products that ship with NSIS installers are probably netizens. Every year that passes by, the need to support Win98 and therefore both ANSI and Unicode will dwindle. We will eventually only need Unicode. :D</p>
      </div>
      <hr />

      <div class="post">
        <p class="post-meta"><span class="post-author text-primary">jimpark</span><br />
        <span class="post-time small text-muted">31st December 2007 15:35 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

        <p class="post-content">Merged in 2.34 changes into the Unicode version of NSIS. Go to the usual place: http://www.scratchpaper.com for the binaries and source.<br />
        <br />
        Added Pashtu support. Thank you Zabeeh khan.</p>
      </div>
      <hr />

      <div class="post">
        <p class="post-meta"><span class="post-author text-primary">CodeSquid</span><br />
        <span class="post-time small text-muted">1st January 2008 12:09 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

        <p class="post-content">I've tried to compile your patch on Linux but it utterly failed.<br />
        <br />
        Can you please update your patch so that it compiles on Linux?<br />
        If you don't have Linux, you can download it from <a href="http://www.ubuntu.com/" target="_blank">http://www.ubuntu.com/</a></p>
      </div>
      <hr />

      <div class="post">
        <p class="post-meta"><span class="post-author text-primary">Joost Verburg</span><br />
        <span class="post-time small text-muted">1st January 2008 13:10 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

        <p class="post-content"></p>

        <blockquote>
          <i>Originally posted by jimpark</i><br />
          <b>Actually the problem is during the loading the exe and dynamic link time. By using Unicode-based Win32 calls, the program fails to even run.</b>
        </blockquote>It's possible to call these APIs on run-time depending on the Windows version. A framework for this method is already included in the NSIS source and is used for various functions that are not available in all Windows versions.
      </div>
      <hr />

      <div class="post">
        <p class="post-meta"><span class="post-author text-primary">jimpark</span><br />
        <span class="post-time small text-muted">1st January 2008 14:18 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

        <p class="post-content">CodeSquid, it's not that I don't have Linux. I did this project because of a need for a Unicode installer on Windows for the project I'm working on. I'm giving the source back to the community as-is. I'm only updating the code so that my code base doesn't go out of sync with the latest changes. And I'm offering it to the public and especially the NSIS developer community so they can potentially use it to create an <b>official</b> Unicode version of NSIS. And while there isn't such, the developers who need a Unicode solution for their installer will have something that works right now. I could just update it internally and never let anyone else use it or see it but that would not be following the spirit of open source. I don't have the time or resources to make sure the source builds on Linux, Mac and whatever else NSIS usually can build on. So if it's important to someone that the Unicode source builds on Linux or on the Mac, I hope that someone steps up to the plate and makes it work for those OSes.</p>
      </div>
      <hr />

      <div class="post">
        <p class="post-meta"><span class="post-author text-primary">CodeSquid</span><br />
        <span class="post-time small text-muted">1st January 2008 15:02 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

        <p class="post-content">I'd <b>very much</b> like this in the official NSIS code. Unfortunately I don't have the time to work on this either. :(</p>
      </div>
      <hr />

      <div class="post">
        <p class="post-meta"><span class="post-author text-primary">Joost Verburg</span><br />
        <span class="post-time small text-muted">1st January 2008 18:04 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

        <p class="post-content">I think it will require quite some effort to have combine a non-Unicode/Unicode version in the same source. This would also cause a lot of trouble with plug-ins. Having a major new release (NSIS 3.0) with only Unicode support and Unicode script files would probably be a better solution.<br />
        <br />
        If only Windows 2000 and later need to be supported, the current Unicode version is mostly complete (expect for some issues like Linux compilation). Windows 95/98/Me cannot be supported forever. Microsoft has dropped support for all these versions some time ago, so there are also no more security fixes. The C++ runtime of Visual Studio 2008 doesn't even support them anymore.<br />
        <br />
        So maybe this would be the time to remove legacy stuff and introduce some breaking changes.</p>
      </div>
      <hr />

      <div class="post">
        <p class="post-meta"><span class="post-author text-primary">Pidgeot</span><br />
        <span class="post-time small text-muted">14th January 2008 02:23 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

        <p class="post-content">I'd like to suggest support for UTF-8 scripts, with <b>and</b> without BOM. I exclusively do UTF-8 without a BOM, as I feel it hurts more than it helps: it only serves as identification (even though in almost all cases, you'd do just fine by assuming UTF-8, and using ANSI as a fallback), and excluding it allows for a neater handling by non-Unicode programs.<br />
        <br />
        If the file is BOM-less and contains invalid UTF-8, I think it should be read as ANSI and internally converted to Unicode for the actual installer. Such behavior would help reduce the effort needed to migrate installers to Unicode, as it should allow most existing scripts to continue compiling with no changes (as long as they don't use any plugins not supplied with NSIS).<br />
        <br />
        I do realize there's a potential problem when a file in a different codepage is included from the script. This could be solved in various ways, such as using a stack to keep track of codepage information. Whenever inclusion starts, the current info is pushed onto the stack. When inclusion stops, pop it back.<br />
        <br />
        Although there is a risk of incorrectly interpreting an ANSI script as UTF-8, it is extremely slim, due to the fact that it requires some very specific byte patterns as the only non-ASCII text in the entire script.</p>
      </div>
      <hr />

      <div class="post">
        <p class="post-meta"><span class="post-author text-primary">jimpark</span><br />
        <span class="post-time small text-muted">15th January 2008 13:08 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

        <p class="post-content">The real crux of the problem is the conversion from ANSI to Unicode. What codepage should you use? Hopefully, the script has that information. But even if it does, it may mean you have to parse a significant portion of the scripts to figure out which code page the text is in which means writing a lot of code that is not there currently. Or I guess you could default to using the system codepage but that may not be the intent of the developer. If someone develops a Chinese installer and gives it to someone who uses an English codepage on their machine, the same installer would produce junk characters on its messages.</p>
      </div>
      <hr />

      <div class="post">
        <p class="post-meta"><span class="post-author text-primary">Pidgeot</span><br />
        <span class="post-time small text-muted">15th January 2008 14:05 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

        <p class="post-content"></p>

        <blockquote>
          <i>Originally posted by jimpark</i><br />
          <b>Or I guess you could default to using the system codepage but that may not be the intent of the developer.</b>
        </blockquote>I'm not sure you understood me correctly, but my idea is to use the system codepage to convert it at <b>compile-time</b>; allowing us to minimize issues. It would likely be best to issue a warning about ANSI scripts being deprecated when it has to do this, so the developer knows to use UTF-8 or UTF-16 instead of relying on the system codepage.<br />
        <br />

        <blockquote>
          <b>If someone develops a Chinese installer and gives it to someone who uses an English codepage on their machine, the same installer would produce junk characters on its messages.</b>
        </blockquote>As long as they only get the compiled installer, no problem, as it would have been handled by then. If they distribute the actual ANSI script, without realizing this change had happened, then yes, they'd have a problem, but this should not happen very frequently - even less if we issue that warning - and the fix is simple; that particular script just needs to be converted into a Unicode format.<br />
        <br />
        For installers creating a dynamic script, nothing prevents us from using UTF-8 as a default output codepage for file writing to minimize issues; as long as they are able to change it from the script (for when they need a specific codepage). Yes, that one would require a change, but you'd be affecting fewer scripts, thus easing migration.
      </div>
      <hr />

      <div class="post">
        <p class="post-meta"><span class="post-author text-primary">jimpark</span><br />
        <span class="post-time small text-muted">15th January 2008 18:34 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

        <p class="post-content">Yes, I do understand you. I am talking about the developers sharing scripts with different codepages set on their machines. The problem you are trying to fix... which is converting their ANSI scripts to Unicode is trivial. Open it up in notepad.exe and save as Unicode. Or use the a2u.exe program I provided. All the proposed changes you are talking about only saves the little tiny headache of converting your script once to Unicode. The real problem is that people write scripts that are shared like libraries, like the language files. They all still need to be converted to Unicode, whether UTF-8 or UTF-16 before they are shareable with others. There's no way around that. We can do some intelligent guessing as the NSIS program parses the ANSI scripts but it may not always be correct.</p>
      </div>
      <hr />

      <div class="post">
        <p class="post-meta"><span class="post-author text-primary">Joost Verburg</span><br />
        <span class="post-time small text-muted">15th January 2008 20:28 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

        <p class="post-content">I don't think there is any possibility to convert existing scripts automatically.<br />
        <br />
        There is no way identify the codepage of a script file, the bytes just have a different character representation depending on the users codepage. Script files can even contain multiple codepages (for example, if language strings are combined in a single file).<br />
        <br />
        On run-time, texts that are sent to the dialogs can come from any source on the system, complete outside the installer itself. Again, no automatic conversion is possible. Things become even more complicated when external DLLs (including NSIS plug-ins) are called that return ANSI strings.<br />
        <br />
        Taking this all into account, I think the only realistic thing is to release a new major version that will be Unicode-only.</p>
      </div>
      <hr />

      <div class="post">
        <p class="post-meta"><span class="post-author text-primary">Pidgeot</span><br />
        <span class="post-time small text-muted">15th January 2008 20:50 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

        <p class="post-content">Of course not, and you're right - those scripts would need to be converted. But we're not going to get around such an issue no matter what we do; and I don't see it as a good idea to cause extra hassle for everyone writing non-English single-language installers, compared to causing a little more work for those that would actually benefit greatly from converting it to Unicode - at least not for the first official Unicode release.<br />
        <br />
        Also, are the amount of "non-native-codepage"-dependent scripts really that big? I'm under the impression that many people stick to the bundled stuff, which would already be Unicode, or have already switched to the Unicode build.<br />
        <br />
        EDIT: Good point, Joost - I hadn't considered external calls. Alright, never mind the ANSI then.</p>
      </div>
      <hr />

      <div class="post">
        <p class="post-meta"><span class="post-author text-primary">onad</span><br />
        <span class="post-time small text-muted">17th January 2008 11:05 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

        <p class="post-content">IMHO two article developers or NSIS script creators should read (I mean really READ...)<br />
        <br />
        <a href="http://www.microsoft.com/globaldev/handson/dev/mslu_announce.mspx" target="_blank">http://www.microsoft.com/globaldev/h..._announce.mspx</a><br />
        <br />
        <a href="http://www.joelonsoftware.com/articles/Unicode.html" target="_blank">http://www.joelonsoftware.com/articles/Unicode.html</a><br />
        <br />
        Note that this message is NOT to insult, it's purpose is to help getting Unicode support in a decent smooth upgrade path to NSIS. Lots of people have lots of good ideas but somehow we have to create it...that will mean some fierce pro/cons discussions. But take for example Jim Park's initiative, it is *great*, he got things rolling for Unicode for him because he has a need and just created his own build!<br />
        <br />
        It is also not that I personally still would support for Win9x/ME, but a lot of third pary software uses NSIS e.g. the Firefox installer on Win32, they are affected if there is an "Only" unicode build" with no backwards compatibility layer.<br />
        <br />
        For those who do not know: "kichik" knows possibly the best what path to choose, and if he doesn't he still does ;) after all he does a major amount of the NSIS development.<br />
        <br />
        But I also see the points by Joost, Unicode only major release to avoid confusing people which NSIS to use, and after all still 2.x can be used for non Unicode releases.<br />
        <br />
        And for the plugins, most of them come with source, should we already ask the plugin creaters nicely to make them Unicode compatible if needed and not done so already?<br />
        <br />
        ...so now <b><font color="crimson">MY</font></b> first step will be, make the plugins I've created unicode compatible, even if not used yet...</p>
      </div>
      <hr />

      <div class="post">
        <p class="post-meta"><span class="post-author text-primary">Joost Verburg</span><br />
        <span class="post-time small text-muted">17th January 2008 17:13 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

        <p class="post-content">Windows 95/98/Me support would require NSIS itself and all plug-ins to provide both an ANSI and a Unicode user interface. If external APIs are used to modify the interface, scripts would also have to check whether ANSI or Unicode is used and do the required conversions.<br />
        <br />
        All scripts need to updated anyway if NSIS uses Unicode internally, even if the user interface is still ANSI. The fact that an ANSI interface is still available would only improve backwards compatibility a little.<br />
        <br />
        Because this is all very complicated, I'm afraid we don't have the manpower to implement it within a reasonable time.<br />
        <br />
        Almost all new applications that are developed (e.g. Firefox 3) don't support 95/98/Me anymore. If legacy Windows versions still need to be supported for an installer, NSIS 2 can be used.</p>
      </div>
      <hr />

      <div class="post">
        <p class="post-meta"><span class="post-author text-primary">sfidanza</span><br />
        <span class="post-time small text-muted">17th January 2008 17:30 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

        <p class="post-content">As an interested outsider here, I can say I would largely prefer having an officially maintained Unicode NSIS (NSIS3), with an unofficial ANSI legacy version (for example if new features would be backported to NSIS2). That is to say, of course, if a choice has to be made, since limited resources always push to make choices.</p>
      </div>
      <hr />

      <div class="post">
        <p class="post-meta"><span class="post-author text-primary">Joost Verburg</span><br />
        <span class="post-time small text-muted">17th January 2008 17:33 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

        <p class="post-content">I think both NSIS 2 (ANSI) and NSIS 3 (Unicode) can remain official versions. However, we won't really have enough resources to backport features.</p>
      </div>
      <hr />

      <div class="post">
        <p class="post-meta"><span class="post-author text-primary">jimpark</span><br />
        <span class="post-time small text-muted">17th January 2008 21:47 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

        <p class="post-content">If we use TCHAR style macros in the C/C++ source, we can use one set of source files to generate both the ANSI and Unicode binaries. I know some people don't like the use of TCHARs but that's the choice I made because of the convenience of having one common set of source files for both binaries. So I know I can make changes to the source that will be reflected in both the ANSI and the Unicode versions. This should help in keeping NSIS ANSI and NSIS Unicode features in sync.<br />
        <br />
        The other problem is the script files -- it's painful keeping two sets of script files as kichik pointed out. But I think most of the behavior enhancing script files are plain ASCII files which can easily be converted to Unicode and back to ANSI.<br />
        <br />
        The language files, however, I think we need to keep separate because the two sets will have to be different. For one, the number of Unicode language files will be bigger than the ANSI. In fact, it already is in my build. And two, the Unicode script files can have the language name itself in its vernacular because the Unicode binaries can show them all at the same time.<br />
        <br />
        Consider the multi-language installer demo picture on my website. It's a very powerful argument for being able to generate Unicode installers. I know of one case where a software targeted to the Chinese audience had two installers -- one in Traditional Chinese and the other Simplified Chinese. And they were able to use the NSIS Unicode multi-language installer to show the instructions / license agreement in both Traditional and Simplified at the same time. That's over a billion people that can benefit from that sort of flexibility. India also has a huge set of scripts for its languages. With China and India together, you've got almost half of the world's population! :)</p>
      </div>
      <hr />

      <div class="post">
        <p class="post-meta"><span class="post-author text-primary">Joost Verburg</span><br />
        <span class="post-time small text-muted">17th January 2008 22:54 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

        <p class="post-content">A mixed ANSI/Unicode (ANSI on 95/98/Me and Unicode on NT/2000/XP/2003/Vista) stub is almost impossible as I pointed out, so building ANSI-only and Unicode-only stubs from the same source may indeed be a good option!<br />
        <br />
        If the compiler would automatically convert Unicode scripts to ANSI (using multiple codepages in a script if necessary, just like the situation is right now), language files and example scripts not using special features would be compatible with both versions (solving the issue kichik pointed out). A simple define (!ifdef UNICODE ...) can allow more advanced scripts (such as the Modern UI) to support both stubs. A script command (independent of the script encoding) can then be used to select what stubs should be used.<br />
        <br />
        We would need two folders for the plug-ins, because the ANSI stubs can only use ANSI plug-ins and the Unicode stubs can only use Unicode plug-ins. All standard NSIS plug-ins can of course support both (using the TCHAR thing).<br />
        <br />
        You'll have to ask kichik about his opinion. Maybe you can work on implementing Unicode in a different branch of the official NSIS SVN repository.</p>
      </div>
      <hr />

      <div class="post">
        <p class="post-meta"><span class="post-author text-primary">high1</span><br />
        <span class="post-time small text-muted">12th February 2008 08:50 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

        <p class="post-content">What about FileOpen function in Unicode version? If a file does not exist, does it create an ANSI or Unicode file? There should be a way of creating an Unicode file, and maybe there is, but I didn't find it. Sorry if my question is out of place here, but I did try general forum and got no replies.</p>
      </div>
      <hr />

      <div class="post">
        <p class="post-meta"><span class="post-author text-primary">jimpark</span><br />
        <span class="post-time small text-muted">12th February 2008 11:29 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

        <p class="post-content">Use FileOpen and use FileWriteUTF16LE. If you want to write a BOM at the beginning of the file, you should be able to using FileWriteWord file_handle "65279" which is U+FEFF</p>
      </div>
      <hr />

      <div class="post">
        <p class="post-meta"><span class="post-author text-primary">high1</span><br />
        <span class="post-time small text-muted">13th February 2008 13:23 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

        <p class="post-content">Did that and it works perfect, thanks. However, if I try same approach with header I'm tinkering with to make it work with Unicode version of NSIS, I get garbage in file. I'm no expert in NSIS, but I have tried to find the cause of it, and I think that usage of FileJoin from TextFunc.nsh is causing the garbage in final file, since header uses that function to join two files. Files are utf16le, and here is a part of the function :<br />
        <br />
        <br />
        define ${_TEXTFUNC_UN}FileJoin `!insertmacro ${_TEXTFUNC_UN}FileJoinCall`<br />
        ...<br />
        <b>FileOpen $3 $4 a<br />
        IfErrors error<br />
        FileSeek $3 -1 END<br />
        FileRead $3 $5<br />
        StrCmp $5 '$\r' +3<br />
        StrCmp $5 '$\n' +2<br />
        FileWrite $3 '$\r$\n'<br />
        FileOpen $0 $1 r<br />
        IfErrors error<br />
        FileRead $0 $5<br />
        IfErrors +3<br />
        FileWrite $3 $5<br />
        goto -3<br />
        FileClose $0<br />
        FileClose $3</b><br />
        ...<br />
        <br />
        Maybe the bold part is causing problems? Should there be FileWriteUTF16LE and FileReadUTF16LE calls? Or maybe not, beacuse of the define? I tried to place UTF functions, but this function produces no file then. Any thoughts, Jim?</p>
      </div>
      <hr />

      <div class="post">
        <p class="post-meta"><span class="post-author text-primary">jimpark</span><br />
        <span class="post-time small text-muted">13th February 2008 14:07 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

        <p class="post-content">If you want this function to work for Unicode files, I think you'll have to create a Unicode version. Copy the macro and as you suspected, you need to convert the FileRead and FileWrite calls to the UTF16LE versions. You might have to open the files as binary as well.</p>
      </div>
      <hr />

      <div class="post">
        <p class="post-meta"><span class="post-author text-primary">high1</span><br />
        <span class="post-time small text-muted">13th February 2008 23:31 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

        <p class="post-content">Got it working. Thanks for all the help and sorry for bugging you. The function does not work with Unicode files - had to change calls, that was obviuos. But this script with UTF produces errors, and I am not sure why - so I had to do this:<br />
        (changes are bolded).<br />
        <br />
        FileOpen $3 $4 a<br />
        <b>;IfErrors error</b><br />
        FileSeek $3 -1 END<br />
        FileRead $3 $5<br />
        StrCmp $5 '$\r' +3<br />
        StrCmp $5 '$\n' +2<br />
        FileWrite $3 '$\r$\n'<br />
        FileOpen $0 $1 r<br />
        <b>;IfErrors error</b><br />
        <b>ClearErrors</b><br />
        FileReadUTF16LE $0 $5<br />
        IfErrors +3<br />
        FileWriteUTF16LE $3 $5<br />
        goto -3<br />
        FileClose $0<br />
        FileClose $3<br />
        <br />
        The header in question is Advanced Uninstall Log, and I'm going to send changes to RedWine. I also had to change Serbian.nlf as UTF16LE is a pile of rubbish.<br />
        This<br />
        ÄŽÄ‘ÄÅ‘Ã¢Å•ÅˆÅ•Ä› Ã³Å„Ã«Ã®Ã¢Äº Ã¤Ã®ÄƒÃ®Ã¢Ã®Ä‘Å• Ã® ÄÄ‘Å•Ã¢Ã³ Ä™Ã®Ä‘ÄÅ™Å¾ÄºÅ›Å•<br />
        should be, in fact, this<br />
        ÐŸÑ€Ð¸Ñ…Ð²Ð°Ñ‚Ð°Ð¼ ÑƒÑÐ»Ð¾Ð²Ðµ Ð´Ð¾Ð³Ð¾Ð²Ð¾Ñ€Ð° Ð¾ Ð¿Ñ€Ð°Ð²Ñƒ ÐºÐ¾Ñ€Ð¸ÑˆÑ›ÐµÑšÐ°<br />
        but I guess it's all Greek to you. :D<br />
        Anyway, thanks, Jim - it sure is great to have a Unicode installer which produces Unicode log, and I can install in Unicode named folder, and uninstall files automatically.<br />
        Going to send you correct Serbian.nlf.</p>
      </div>
      <hr />

      <div class="post">
        <p class="post-meta"><span class="post-author text-primary">jimpark</span><br />
        <span class="post-time small text-muted">14th February 2008 00:12 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

        <p class="post-content">I appreciate that. Looking forward to getting those files. It's good to know that the Unicode version of NSIS is actively being used.</p>
      </div>
      <hr />

      <div class="post">
        <p class="post-meta"><span class="post-author text-primary">jimpark</span><br />
        <span class="post-time small text-muted">18th February 2008 21:59 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

        <p class="post-content">NSIS Unicode has been updated to 2.35. Please go to the usual spot to download the binaries and the modified source: http://www.scratchpaper.com.</p>
      </div>
      <hr />

      <div class="post">
        <p class="post-meta"><span class="post-author text-primary">high1</span><br />
        <span class="post-time small text-muted">19th February 2008 14:09 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

        <p class="post-content">Is there any particular reason why there are no registry entries at HKLM -&gt; Software -&gt; NSIS for VersionMajor and VersionMinor? ANSI release writes current release values there. Is there another way to get version of NSIS with which the script was compiled?<br />
        Regards.</p>
      </div>
      <hr />

      <div class="post">
        <p class="post-meta"><span class="post-author text-primary">jimpark</span><br />
        <span class="post-time small text-muted">19th February 2008 15:29 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

        <p class="post-content">It's because I've been building without specifying revision number and build number. I'm surprised you're the only one who brought this up. Thank you. The files have been updated on my site. Now NSIS Unicode will put the version info under Software/NSIS/Unicode.</p>
      </div>
      <hr />

      <div class="post">
        <p class="post-meta"><span class="post-author text-primary">high1</span><br />
        <span class="post-time small text-muted">19th February 2008 18:49 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

        <p class="post-content">Thanks. I was using this to read the version of NSIS I've used for buliding the installer so noticed it was missing...</p>
      </div>
      <hr />

      <div class="post">
        <p class="post-meta"><span class="post-author text-primary">Anders</span><br />
        <span class="post-time small text-muted">3rd March 2008 00:39 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

        <p class="post-content">Is there a way to detect if the compiler is unicode, meaning, is there a defined symbol like __NSIS_UNICODE__ in the unicode build? If not, you should add it so that 3rd party header files for stuff can support both ansi and unicode in one file</p>
      </div>
      <hr />

      <div class="post">
        <p class="post-meta"><span class="post-author text-primary">jimpark</span><br />
        <span class="post-time small text-muted">3rd March 2008 14:17 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

        <p class="post-content">That's not a bad idea. I will add it to the next version.</p>
      </div>
      <hr />
      <!-- Bootstrap core CSS -->
      <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
      <!--[if lt IE 9]>
                <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
                <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->

      <div class="container">
        <!-- Put navigation bar here -->

        <ol class="breadcrumb">
          <li><a href="../index.html" class="glyphicon glyphicon-home"></a></li>

          <li><a href="f-65.html">NSIS Discussion</a></li>

          <li class="active">Unicode</li>
        </ol>

        <p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=277381">Unicode</a></p><br />

        <div class="post">
          <p class="post-meta"><span class="post-author text-primary">jimpark</span><br />
          <span class="post-time small text-muted">3rd March 2008 15:09 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

          <p class="post-content">I just made the tweak and modified the binary on my website to include the NSIS_UNICODE predefine for the Unicode build. Enjoy.</p>
        </div>
        <hr />

        <div class="post">
          <p class="post-meta"><span class="post-author text-primary">Benski</span><br />
          <span class="post-time small text-muted">16th March 2008 19:12 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

          <p class="post-content">7zip will not open the installer archive properly. I get rubbish filenames. Not sure if it's something that 7zip would need to fix, though.</p>
        </div>
        <hr />

        <div class="post">
          <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
          <span class="post-time small text-muted">16th March 2008 21:01 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

          <p class="post-content">7-zip expects a very specific format from the installer. One of its assumptions is that the string table is saved as ANSI. It's not such a faulty assumption when you add in the no-real-nsis-binary-specification factor.</p>
        </div>
        <hr />

        <div class="post">
          <p class="post-meta"><span class="post-author text-primary">jimpark</span><br />
          <span class="post-time small text-muted">17th March 2008 13:47 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

          <p class="post-content">So does the installer still work? Is it just that a 3rd party app can't open the Unicode-NSIS generated file? If so, then I don't think we can do much about that. If the installer doesn't work with 7zip compression algorithm, that's something I can look into. But the notion I had was that NSIS used those compression algorithms for its own nefarious purposes, not that it had to adhere to some binary format.</p>
        </div>
        <hr />

        <div class="post">
          <p class="post-meta"><span class="post-author text-primary">Benski</span><br />
          <span class="post-time small text-muted">17th March 2008 17:52 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

          <p class="post-content">The installer works great. It's just that I often use 7zip's ability to open the installer in order to extract the binaries for crash dump debugging. Not a big deal, but I miss the feature :) Maybe there's a way for the 7zip author to add special handling for Unicode NSIS.</p>
        </div>
        <hr />

        <div class="post">
          <p class="post-meta"><span class="post-author text-primary">Benski</span><br />
          <span class="post-time small text-muted">20th March 2008 16:52 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

          <p class="post-content">A helpful hint to anyone converting their NSIS scripts to Unicode. Be sure to change your System::Call stuff to use w. instead of t. for string types!</p>
        </div>
        <hr />

        <div class="post">
          <p class="post-meta"><span class="post-author text-primary">Anders</span><br />
          <span class="post-time small text-muted">20th March 2008 17:04 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

          <p class="post-content">but is that the way it should work? The system plugin should probably be changed so that "t"="w" in the unicode build and you can use "a" for forcing ansi strings. Should help keep things portable, but some stuff might break</p>
        </div>
        <hr />

        <div class="post">
          <p class="post-meta"><span class="post-author text-primary">Benski</span><br />
          <span class="post-time small text-muted">20th March 2008 18:10 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

          <p class="post-content">Yeah, I agree with that idea. Although 'a' is already taken to be a shortcut for the chosen language</p>
        </div>
        <hr />

        <div class="post">
          <p class="post-meta"><span class="post-author text-primary">Anders</span><br />
          <span class="post-time small text-muted">20th March 2008 19:12 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

          <p class="post-content">"a" is not taken as a param type, only source/destination, but I'm not sure if the parser could handle using "a" for two different things. using @ might be a little weird, maybe "z" for zero terminated or whatever unless someone has a better idea<br />
          <br />
          OT: also, adding support for "p" for pointers might ease a future move to 64 bit</p>
        </div>
        <hr />

        <div class="post">
          <p class="post-meta"><span class="post-author text-primary">sridhare</span><br />
          <span class="post-time small text-muted">2nd April 2008 12:17 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

          <p class="post-content">Hello jimpark,<br />
          <br />
          Your unicode nsis has been of immense help to me. There seems to be a slight problem with the language selection dialog - the languages that aren't supported by the system also show up and I'm NOT using MUI_LANGDLL_ALLLANGUAGES .<br />
          <br />
          For example , I'm running the installer on Windows XP with English as the OS language (and I haven't installed the files required for displaying CJK languages). On running the installer , Japanese (actually garbled boxes) also appears in the drop down menu .<br />
          <br />
          It works as expected on my system where i have installed the files for Japanese i.e., both English and Japanese are displayed.<br />
          <br />
          It will be great if you can help.</p>
        </div>
        <hr />

        <div class="post">
          <p class="post-meta"><span class="post-author text-primary">jimpark</span><br />
          <span class="post-time small text-muted">2nd April 2008 14:03 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

          <p class="post-content">I don't know of a way to enumerate all the supported language scripts on a given user's computer. I can do it per locale or language but that's not sufficient since the user's computer is usually set to one language/locale but may be able to support scripts of other languages. If someone knows how to list all the scripts supported by a given system, I think it's just a matter of calling GetStringScripts() and VerifyScripts().<br />
          <br />
          Anyway, this shouldn't be an issue--everyone should have the East Asian Language support turned on! :)</p>
        </div>
        <hr />

        <div class="post">
          <p class="post-meta"><span class="post-author text-primary">Pidgeot</span><br />
          <span class="post-time small text-muted">2nd April 2008 14:45 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

          <p class="post-content">Unfortunately, those two methods don't exist on versions prior to Vista (and there, East Asian Language support is always turned on) - you can get support on XP SP2 and 2003 SP1, but that requires a separate download (and doesn't help with Win2000).<br />
          <br />
          You can use <a href="http://msdn2.microsoft.com/en-us/library/ms776334(VS.85).aspx" target="_blank">EnumSystemLocales</a> with LCID_INSTALLED to check which locales are "ready for use" (if you know specifically which one to check for, you can just use IsValidLocale), or you could check the possible languages groups with <a href="http://msdn2.microsoft.com/en-us/library/ms776240(VS.85).aspx" target="_blank">IsValidLanguageGroup</a> and LGRPID_INSTALLED.<br />
          <br />
          However, all of this requires that you have a mapping between the languages and the locales (or language group) - I can't remember if that information is currently available to NSIS.</p>
        </div>
        <hr />

        <div class="post">
          <p class="post-meta"><span class="post-author text-primary">jimpark</span><br />
          <span class="post-time small text-muted">2nd April 2008 16:51 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

          <p class="post-content">I don't think it is available hence my initial thought to use GetStringScripts(). Which makes me think that may be the use of the native language to display the language name may not be a good idea. Or maybe I should combine them together so that there's a legible English version of the name in the drop down menu along with it in the native script.</p>
        </div>
        <hr />

        <div class="post">
          <p class="post-meta"><span class="post-author text-primary">sfidanza</span><br />
          <span class="post-time small text-muted">2nd April 2008 20:28 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

          <p class="post-content">Couldn't it be a missing font issue, rather than an unsupported language?</p>
        </div>
        <hr />

        <div class="post">
          <p class="post-meta"><span class="post-author text-primary">Pidgeot</span><br />
          <span class="post-time small text-muted">2nd April 2008 21:08 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

          <p class="post-content">Technically, on NT-based OSes, it's ONLY a matter of a missing font (and to some degree, the version of Unicode they support), but that's why LCID_/LGRPID_INSTALLED should be used (instead of _SUPPORTED). Using that flag makes the operating system report if it has everything it needs to display a string based on a given locale.<br />
          <br />
          The problem is, checking against a specific font name is less than optimal, since their names may be localized (the japanese fonts MS Gothic and MS Mincho do that, to give examples), and Windows might know of a font you don't. That's why you need to check on the locale or language group, if you're going to filter on it - but to the best of my knowledge, no WinAPI function exists to detect locale, language group, or script for a given string (except those Jim already mentioned, which are only built into Vista and require a separate download for XP and 2003, therefore not really being usable here).</p>
        </div>
        <hr />

        <div class="post">
          <p class="post-meta"><span class="post-author text-primary">Benski</span><br />
          <span class="post-time small text-muted">10th April 2008 23:35 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

          <p class="post-content">Latest 7-zip alpha build supports opening Unicode NSIS installers :up:<br />
          <br />
          <a href="http://sourceforge.net/forum/forum.php?thread_id=2000352&amp;forum_id=45797" target="_blank">http://sourceforge.net/forum/forum.p...forum_id=45797</a></p>
        </div>
        <hr />

        <div class="post">
          <p class="post-meta"><span class="post-author text-primary">sridhare</span><br />
          <span class="post-time small text-muted">23rd April 2008 10:29 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

          <p class="post-content">Our unicode-nsis installer calls a java program using nsExec and all the output from the java program gets directed into the scrolling text box. If we choose English for the installation language, everything in the text box looks fine , but when an exception stack trace is printed, a part of the stack trace gets cut off. If we choose Japanese for the installation language, weird characters are displayed in place of forward slashes. What could be the reason?<br />
          <br />
          I've hacked the RealProgress plugin source to get it working with the unicode-nsis. Could it be the reason for this behaviour? (seems unlikely though). I'm attaching a snapshot.<br />
          Look at the second line in the image. It is actually supposed to be C:/PROGRA~1/Java/.. so on. But all "/" are replaced with some weird character. Similarly, both the stack traces are only partially displayed.<br />
          Any help will be greatly appreciated. Thanks in advance.</p>
        </div>
        <hr />

        <div class="post">
          <p class="post-meta"><span class="post-author text-primary">Pidgeot</span><br />
          <span class="post-time small text-muted">23rd April 2008 11:02 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

          <p class="post-content">I can't say why it cuts off part of it, but the reason \ is replaced by the Â¥ sign is for historical reasons: Japan (and Korea) put their currency symbol in their code page back in the pre-Unicode days. When Unicode was introduced, it was believed that people were too used to seeing the currency symbol as the path separator, so they kept it that way. (There's no real "right" answer to that problem, so you can't really blame them, even if it does seem a bit foolish these days)<br />
          <br />
          As a result, all Japanese fonts (MS Gothic, etc.) show a Yen sign where the backslash is supposed to be, just like Korean fonts (GulimChe, etc.) show a Won sign (â‚©).</p>
        </div>
        <hr />

        <div class="post">
          <p class="post-meta"><span class="post-author text-primary">jimpark</span><br />
          <span class="post-time small text-muted">26th April 2008 13:38 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

          <p class="post-content">sridhare, when an exception is thrown and the stack trace is printed by your Java app, there are potential problems with buffered IO that is probably causing the cutoff of the text output. I don't know how much control over the IO you have with the Java program but you might want it to be unbuffered when outputting or at least flush the IO when it exits. The other issue is that I think NSIS will also buffer the input as well so it will display everything if it thinks the IO has been closed or is flushed.<br />
          <br />
          BTW, I have not been able to work on the updates to the Unicode NSIS for a while. I will be very busy until probably sometime in June. My apologies.</p>
        </div>
        <hr />

        <div class="post">
          <p class="post-meta"><span class="post-author text-primary">sridhare</span><br />
          <span class="post-time small text-muted">29th April 2008 09:58 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

          <p class="post-content">Thanks for all the response. This java exception stack trace cut off never happened when we were using (non-Unicode) NSIS. Are you saying that the buffering issue could arise in the Unicode NSIS ?</p>
        </div>
        <hr />

        <div class="post">
          <p class="post-meta"><span class="post-author text-primary">jimpark</span><br />
          <span class="post-time small text-muted">29th April 2008 14:48 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

          <p class="post-content">No, there isn't anything different about how NSIS handles the IO buffers with Unicode. When an exception happens, does the output look like junk? I don't know how it is in Java but in C++, the exception strings need to be ASCII and I wonder if something similar is happening in Java.</p>
        </div>
        <hr />

        <div class="post">
          <p class="post-meta"><span class="post-author text-primary">sridhare</span><br />
          <span class="post-time small text-muted">26th May 2008 08:53 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

          <p class="post-content"></p>

          <blockquote>
            <i>Originally posted by jimpark</i><br />
            <b>No, there isn't anything different about how NSIS handles the IO buffers with Unicode. When an exception happens, does the output look like junk? I don't know how it is in Java but in C++, the exception strings need to be ASCII and I wonder if something similar is happening in Java.</b>
          </blockquote>No, the output doesn't look like junk, but it gets displayed incompletely - This is the actual exception message that used to get displayed fine in the log window when I was using the official NSIS :<br />
          <br />
          <pre>
<code><br />INFO: Not started: <a href="http://localhost:80/identity" target="_blank">http://localhost:80/identity</a><br />java.net.ConnectException: Connection refused: connect<br />        at java.net.PlainSocketImpl.socketConnect(Native Method)<br />        at java.net.PlainSocketImpl.doConnect(PlainSocketImpl.java:333)<br />        at java.net.PlainSocketImpl.connectToAddress(PlainSocketImpl.java:195)<br />        at java.net.PlainSocketImpl.connect(PlainSocketImpl.java:182)<br />        at java.net.Socket.connect(Socket.java:516)<br />        at sun.net.NetworkClient.doConnect(NetworkClient.java:152)<br />        at sun.net.<a href="http://www.http.HttpClient.openServer" target="_blank">www.http.HttpClient.openServer</a>(HttpClient.java:365)<br />        at sun.net.<a href="http://www.http.HttpClient.openServer" target="_blank">www.http.HttpClient.openServer</a>(HttpClient.java:477)<br />        at sun.net.<a href="http://www.http.HttpClient." target="_blank">www.http.HttpClient.</a>&lt;init&gt;(HttpClient.java:214)<br />        at sun.net.<a href="http://www.http.HttpClient.New" target="_blank">www.http.HttpClient.New</a>(HttpClient.java:287)<br />        at sun.net.<a href="http://www.http.HttpClient.New" target="_blank">www.http.HttpClient.New</a>(HttpClient.java:299)<br />        at sun.net.<a href="http://www.protocol.http.HttpURLConnection.getNewHttpClient" target="_blank">http://www.protocol.http.HttpURLConn...tNewHttpClient</a>(HttpURLConnection.java:795)<br />        at sun.net.<a href="http://www.protocol.http.HttpURLConnection.plainConnect" target="_blank">www.protocol.http.HttpURLConnection.plainConnect</a>(HttpURLConnection.java:747)<br />        at sun.net.<a href="http://www.protocol.http.HttpURLConnection.connect" target="_blank">www.protocol.http.HttpURLConnection.connect</a>(HttpURLConnection.java:672)<br />        at com.pramati.bfly.install.InstallOperations.getStatus(InstallOperations.java:335)<br />        at com.pramati.bfly.install.InstallOperations.dasStatus(InstallOperations.java:190)<br />        at com.pramati.bfly.install.BaseInitializer.start(BaseInitializer.java:301)<br />        at com.pramati.bfly.install.offline.StandaloneInstaller.start(StandaloneInstaller.java:488)<br />        at com.pramati.bfly.install.offline.StandaloneInstaller.start(StandaloneInstaller.java:475)<br />        at com.pramati.izpack.DekohProcessPanel.invokeInstaller(DekohProcessPanel.java:479)<br />        at com.pramati.izpack.DekohProcessPanel.installDekoh(DekohProcessPanel.java:346)<br />        at com.pramati.izpack.DekohProcessPanel.access$300(DekohProcessPanel.java:43)<br />        at com.pramati.izpack.DekohProcessPanel$2.run(DekohProcessPanel.java:262)<br /></code>
</pre><br />
          <br />
          Now, after switching to the Unicode NSIS, the same exception stack trace started appearing as follows!<br />
          <br />
          <pre>
<code><br />INFO: Not started: <a href="http://localhost:80/identity" target="_blank">http://localhost:80/identity</a><br />java.net.ConnectException: Connection refused: connect<br />        nnection.java:747)<br /></code>
</pre><br />
          <br />
          Also, when this cut-off happens, it also swallows some other messages printed to the window after this stack trace. Having the full exception stack traces is very critical for debugging, it'd be great if you can be of help.
        </div>
        <hr />

        <div class="post">
          <p class="post-meta"><span class="post-author text-primary">jimpark</span><br />
          <span class="post-time small text-muted">9th June 2008 16:22 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

          <p class="post-content">Just released Unicode NSIS 2.37 which merges in the changes from the trunk into the Unicode build. You can find it at the usual place: www.scratchpaper.com.</p>
        </div>
        <hr />

        <div class="post">
          <p class="post-meta"><span class="post-author text-primary">jimpark</span><br />
          <span class="post-time small text-muted">9th June 2008 18:18 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

          <p class="post-content">sridhare, try the new version to see if it fixes your issue. If not, I do have another idea that might fix it. So let me know.</p>
        </div>
        <hr />

        <div class="post">
          <p class="post-meta"><span class="post-author text-primary">jimpark</span><br />
          <span class="post-time small text-muted">10th June 2008 19:18 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

          <p class="post-content">sridhare, I found the bug and I've finally fixed it. Sorry it took so long. I didn't have any time to work on the Unicode NSIS until recently. I just released new binaries and fixed source at the usual place. <a href="http://www.scratchpaper.com" target="_blank">http://www.scratchpaper.com</a> The version is 2.37.1. Everyone should get this new one instead.</p>
        </div>
        <hr />

        <div class="post">
          <p class="post-meta"><span class="post-author text-primary">jimpark</span><br />
          <span class="post-time small text-muted">23rd June 2008 15:27 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

          <p class="post-content">Just released 2.37.2 which has an initial Vietnamese support thanks to Clytie Siddall of the OpenOffice translation team.</p>
        </div>
        <hr />

        <div class="post">
          <p class="post-meta"><span class="post-author text-primary">pabs</span><br />
          <span class="post-time small text-muted">4th July 2008 17:49 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

          <p class="post-content">Whats the status of this Unicode branch? Ready to be merged into trunk?<br />
          <br />
          I ask because Debian would like to use it for our win32-loader program used to boot the Debian installer on Windows machines:<br />
          <br />
          <a href="http://bugs.debian.org/489218" target="_blank">http://bugs.debian.org/489218</a></p>
        </div>
        <hr />

        <div class="post">
          <p class="post-meta"><span class="post-author text-primary">Joost Verburg</span><br />
          <span class="post-time small text-muted">4th July 2008 18:47 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

          <p class="post-content">Because a Unicode build will break backwards compatibility with existing scripts, it will probably be a NSIS 3.0 release.<br />
          <br />
          However, Win9x support is still not avaialble. It is possible to add support for these platforms (even with the internal installer data being in Unicode) by converting the data back to ANSI for the user interface.<br />
          <br />
          The other option would be to completely drop support for Win9x in NSIS 3.x.</p>
        </div>
        <hr />

        <div class="post">
          <p class="post-meta"><span class="post-author text-primary">jimpark</span><br />
          <span class="post-time small text-muted">4th July 2008 19:56 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

          <p class="post-content">I would love to see the code get merged into the trunk as well, as I've mentioned many times already.<br />
          <br />
          As for Win9x support, it is not on my list of priorities. I personally don't have a need for it since all the software we are shipping require Win2k+ anyway. I think most developers have similar requirements nowadays.<br />
          <br />
          The "unofficial" status of the Unicode NSIS branch hasn't stopped high profile projects like Winamp, OpenOffice, Flickr, Filezilla, etc. from using it. And in the near future Mozilla's products like Firefox and Thunderbird will use it as well (Unicode NSIS is already incorporated into their build environment since MozillaBuild 1.2). It just goes to show that there is definitely a need for an Open Source Unicode Installer.</p>
        </div>
        <hr />

        <div class="post">
          <p class="post-meta"><span class="post-author text-primary">jimpark</span><br />
          <span class="post-time small text-muted">4th July 2008 19:59 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

          <p class="post-content">And I'll mention this point again as well. My codebase generates both the Unicode version and the ANSI version that DOES run on Win9x. So I really don't see what you can lose from adopting the codebase as-is and then working forward from there to make the Unicode version Win9x compliant via unicows.dll or some other method as mentioned by Joost.</p>
        </div>
        <hr />

        <div class="post">
          <p class="post-meta"><span class="post-author text-primary">Joost Verburg</span><br />
          <span class="post-time small text-muted">4th July 2008 23:42 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

          <p class="post-content">I don't think it's a good idea to have an ANSI and a Unicode version at the same time. Many scripts will not be compatible with both versions, so this will cause a lot of confusion. And there is also the issue of plug-in compatibility.<br />
          <br />
          Regarding Win9x, we cannot use Unicows or something like that because this file does not exist on all systems. The only option for real Win9x support would be to create ANSI dialogs and convert the intenal Unicode data to ANSI based on the current code page. In this case, scripts, examples, plug-ins etc. will all use Unicode internally and there will be no compatibility issues.<br />
          <br />
          Personally I think it's OK to drop Win9x support in NSIS 3.0 (with NSIS 2.x still being available for Win9x users) and move to Unicode scripts. But I don't know whether other developers agree with this.<br />
          <br />
          I'd definately like to have Unicode support in the official version.</p>
        </div>
        <hr />

        <div class="post">
          <p class="post-meta"><span class="post-author text-primary">jimpark</span><br />
          <span class="post-time small text-muted">5th July 2008 00:50 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

          <p class="post-content">I see three potential options other than the one I have which is two versions of NSIS, meaning two sets of plugins (but one codebase) and two sets of scripts, which I concede can be unwieldy.<br />
          <br />
          1. One makensis.exe that can generate both an ANSI or a Unicode installer. This means that there will still need to be two sets of plugins and exeheads, but potentially just one set of scripts. If we go this route, I'd suggest that all scripts are Unicode. If we start with ANSI codepage scripts, mixed scripts in a single file becomes very difficult if not impossible to support. (Imagine a single string with mixed scripts.) And we would alienate Unicode-only languages.<br />
          <br />
          2. We generate one exehead but with the ability to on-the-fly convert the internally stored Unicode strings to the ANSI codepage strings to call the ANSI Windows APIs on Win9x machines. This requires that we have a small but portable implementation of wide string to multi-byte string conversion function. Maybe we can leverage some code in the Wine project to do this. But it does mean making the exehead and therefore the final installer to be bigger. The plugins would also need to do this conversion as well since they would likely get the Unicode strings on the stack. So this method requires more complexity in the exehead and the plugins.<br />
          <br />
          3. Drop ANSI support in NSIS 3.0 entirely. We have one version of everything going forward, but we lose the Win9x support. But as Joost mentioned, NSIS 2.0 can cover that small and rapidly shrinking market. (The Win9x crowd is ~0.2% of the web surfing public according to w3school: <a href="http://www.w3schools.com/browsers/browsers_os.asp" target="_blank">http://www.w3schools.com/browsers/browsers_os.asp</a>)<br />
          <br />
          I think the logical choice is 3. But it isn't my decision.</p>
        </div>
        <hr />

        <div class="post">
          <p class="post-meta"><span class="post-author text-primary">Anders</span><br />
          <span class="post-time small text-muted">5th July 2008 01:58 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

          <p class="post-content"></p>

          <blockquote>
            <i>Originally posted by jimpark</i><br />
            <b><br />
            2. ...This requires that we have a small but portable implementation of wide string to multi-byte string conversion function. Maybe we can leverage some code in the Wine project to do this<br /></b>
          </blockquote>Win9x has support for a limited set of Wide API's out of the box, including WideCharToMultiByte IIRC<br />
          <br />
          <br />

          <blockquote>
            <i>Originally posted by jimpark</i><br />
            <b><br />
            3. ...according to w3school</b>
          </blockquote>That is a dev specific site, yes, the % of people using 9x is small, but not THAT small<br />
          <br />
          <br />
          I prefer option 1 myself, old scripts would stay in whatever ansi codepage they have always been in, unicode scripts would need a way to specify that they are unicode, with either a BOM or a nsis instruction at the top
        </div>
        <hr />

        <div class="post">
          <p class="post-meta"><span class="post-author text-primary">jimpark</span><br />
          <span class="post-time small text-muted">5th July 2008 17:46 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

          <p class="post-content">You might be right about the percentage of people using 9x being too small but I would still argue that around 1% is right. Is there a different number you are aware of?<br />
          <br />
          I wouldn't mind getting option 1, either. We might be able to do it by inserting both the Unicode and ANSI exehead into every installer (option controlled, of course). It also means two copies of every plugin as well. So your installer overhead would be 2x what is now if you wanted a "Universal installer."<br />
          <br />
          Unfortunately, this change is not something I can do. Time constraints are a problem for one. But more importantly, it would fork the code too much and I wouldn't be able to maintain the code to be in sync with the main build. It could easily end up being an abandoned fork.<br />
          <br />
          But we are all eager to see the main NSIS developers start work on an official Unicode version. Is there any work going underway for this support currently? If not, is there any tentative plans for Unicode support in the near future?</p>
        </div>
        <hr />

        <div class="post">
          <p class="post-meta"><span class="post-author text-primary">Benski</span><br />
          <span class="post-time small text-muted">5th July 2008 23:27 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

          <p class="post-content">Personally, I see no reason to continue win9x development. I know that kichik and other NSIS developers disagree, but the userbase has dropped off dramatically. Based on winamp.com web stats, Winamp's win98/ME userbase went from 3% in 2006 to less than 1% by January 2007 which triggered us to drop support for the platform entirely.</p>
        </div>
        <hr />

        <div class="post">
          <p class="post-meta"><span class="post-author text-primary">sealite</span><br />
          <span class="post-time small text-muted">6th July 2008 14:12 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

          <p class="post-content">I agree that developers should drop 9x support. It's like the idea of having 16bit/32bit software build few years before ;)<br />
          <br />
          Keeping the compatibility would require too much effort, effort that could be used other things.<br />
          <br />
          And if you don't trust you can make a survey, just don't forget to put the questions right ;)</p>
        </div>
        <hr />

        <div class="post">
          <p class="post-meta"><span class="post-author text-primary">Joost Verburg</span><br />
          <span class="post-time small text-muted">10th July 2008 01:01 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

          <p class="post-content">If we want to continue Win9x support, the best option would be to have all scripts and plug-ins in Unicode but add support to the exehead to create ANSI dialogs on Win9x.<br />
          <br />
          If this is not possible, the scripts should move to Unicode anyway but there will be two sets of plug-ins and exeheads.<br />
          <br />
          However, it may indeed be better to drop Win9x support for NSIS 3.0.</p>
        </div>
        <hr />

        <div class="post">
          <p class="post-meta"><span class="post-author text-primary">Anders</span><br />
          <span class="post-time small text-muted">10th July 2008 01:10 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

          <p class="post-content">the script should stay like they are, BOM for unicode files and no BOM means ansi, otherwise tricks played with !system that you include again will have to be unicode aswell, and the console is not unicode by default</p>
        </div>
        <hr />

        <div class="post">
          <p class="post-meta"><span class="post-author text-primary">Joost Verburg</span><br />
          <span class="post-time small text-muted">10th July 2008 01:21 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

          <p class="post-content">But then you also need two sets of langauge files etc., which will all be way to complicated.</p>
        </div>
        <hr />

        <div class="post">
          <p class="post-meta"><span class="post-author text-primary">Anders</span><br />
          <span class="post-time small text-muted">10th July 2008 03:13 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

          <p class="post-content"></p>

          <blockquote>
            <i>Originally posted by Joost Verburg</i><br />
            <b>But then you also need two sets of langauge files etc., which will all be way to complicated.</b>
          </blockquote>You can't convert the lang file on the fly from ansi to unicode when you know the codepage ?
        </div>
        <hr />
        <!-- Bootstrap core CSS -->
        <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
        <!--[if lt IE 9]>
                <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
                <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->

        <div class="container">
          <!-- Put navigation bar here -->

          <ol class="breadcrumb">
            <li><a href="../index.html" class="glyphicon glyphicon-home"></a></li>

            <li><a href="f-65.html">NSIS Discussion</a></li>

            <li class="active">Unicode</li>
          </ol>

          <p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=277381">Unicode</a></p><br />

          <div class="post">
            <p class="post-meta"><span class="post-author text-primary">jimpark</span><br />
            <span class="post-time small text-muted">10th July 2008 03:41 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

            <p class="post-content">You can, when you know the codepage. You can't tell programmatically right now. Some languages use two scripts and have two different language files. The NLF files can be read and the codepage gotten but not the NSH files. It would require that we add something in the NSH files to store the codepage. Maybe a special comment?<br />
            <br />
            Also, no the console is not Unicode by default but outputs to the console through the stdlib will convert them to ANSI before displaying them on the console. Hence, you really want to use the makensisw.exe to see the Unicode characters.<br />
            <br />
            All new scripts for the Unicode only NSIS should be UTF-16LE but we can make makensis.exe read ANSI scripts and 1. convert them to Unicode using the system codepage or 2. provide a parameter that provides the codepage to use to convert to Unicode.</p>
          </div>
          <hr />

          <div class="post">
            <p class="post-meta"><span class="post-author text-primary">Joost Verburg</span><br />
            <span class="post-time small text-muted">11th July 2008 01:25 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

            <p class="post-content">But there are also scripts that contain strings with different code pages. This is impossible to convert to Unicode.</p>
          </div>
          <hr />

          <div class="post">
            <p class="post-meta"><span class="post-author text-primary">jimpark</span><br />
            <span class="post-time small text-muted">11th July 2008 01:46 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

            <p class="post-content">Yes. I was looking at some just today. They cannot be automatically converted.</p>
          </div>
          <hr />

          <div class="post">
            <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
            <span class="post-time small text-muted">11th July 2008 13:42 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

            <p class="post-content">There is nothing that can't be done. It's complicated, I'll give you that. But at the very minimum, we could have two string tables - ANSI and Unicode. Those strings that can't be translated could be saved in the ANSI table.</p>
          </div>
          <hr />

          <div class="post">
            <p class="post-meta"><span class="post-author text-primary">jimpark</span><br />
            <span class="post-time small text-muted">11th July 2008 16:54 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

            <p class="post-content">Okay, we are talking about the automation of the conversion of a script into Unicode. There isn't a language that ANSI supports that Unicode cannot which I know you know but someone can misread your statement and think that.<br />
            <br />
            The complication comes in when a script has multiple ANSI codepage strings. The strings themselves do not tell you what codepage they are encoded in. But it may be possible if the script always explicitly uses the $LANGUAGE variable that we can deduce the codepage for conversion in makensis itself. If someone just encodes a string in their native codepage and never says in the script what language it is in, then you really can't do anything except assume things like that it's the system default codepage which can be wrong.<br />
            <br />
            Where as the Unicode to ANSI conversion can be done if the ANSI codepage that supports the language exists, because the script is inherently implied in the Unicode codepoint. So it's much safer to store the scripts as Unicode and then convert them to ANSI if desired and possible.<br />
            <br />
            So just to be clear:<br />
            <br />
            Unicode can encode a superset of the scripts that are supported by ANSI codepages. Each codepoint implies a script. Therefore, for any shared subset of scripts, a Unicode string can be converted to the ANSI codepage encoding.<br />
            <br />
            An ANSI codepage string does not imply any codepage / script. So unless hints are given, we cannot automatically convert to Unicode.</p>
          </div>
          <hr />

          <div class="post">
            <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
            <span class="post-time small text-muted">11th July 2008 18:58 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

            <p class="post-content">Of course. And so the very minimum we can do is have two tables and have the ANSI table act as it does now. This way, you could still build these old scripts.<br />
            <br />
            Most language files already provide codepage identifiers and some string paths can give you a good enough hint on the codepage for the ANSI string. But as a first very basic solution, two tables is enough.</p>
          </div>
          <hr />

          <div class="post">
            <p class="post-meta"><span class="post-author text-primary">jimpark</span><br />
            <span class="post-time small text-muted">11th July 2008 20:54 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

            <p class="post-content">Can you clarify what you mean by two tables? Do you mean that the installer executable will have two tables? Then yes, I think that was the proposal -- two exeheads that accesses two different string tables.<br />
            <br />
            So we have this path:<br />
            <br />
            ANSI script generates:<br />
            1. best guess at Unicode string tables.<br />
            2. ANSI string tables.<br />
            <br />
            Unicode script generates:<br />
            1. Unicode string tables (of course).<br />
            2. ANSI string tables. (Multiple languages in the Unicode script will not work if they are meant to be shown together. Not a big surprise because ANSI NSIS can't do this either.)</p>
          </div>
          <hr />

          <div class="post">
            <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
            <span class="post-time small text-muted">11th July 2008 22:55 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

            <p class="post-content">I do mean two string tables in the installer executable. But there's no need for two different exeheads/stubs for the job. The ANSI table could simply be empty for installers generated from Unicode scripts.</p>
          </div>
          <hr />

          <div class="post">
            <p class="post-meta"><span class="post-author text-primary">Joost Verburg</span><br />
            <span class="post-time small text-muted">13th July 2008 22:37 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

            <p class="post-content">And all variables will also be in ANSI when an ANSI script is compiled? Otherwise it won't be backwards compatible anyway.</p>
          </div>
          <hr />

          <div class="post">
            <p class="post-meta"><span class="post-author text-primary">vcoder</span><br />
            <span class="post-time small text-muted">15th July 2008 03:10 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

            <p class="post-content"><strong>NSIS 2.38</strong><br />
            NSIS 2.38 released.<br />
            What about Unicode version of NSIS 2.38? ;)</p>
          </div>
          <hr />

          <div class="post">
            <p class="post-meta"><span class="post-author text-primary">jimpark</span><br />
            <span class="post-time small text-muted">15th July 2008 19:47 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

            <p class="post-content">vcoder, I'm on vacation right now. So I won't be on it for a few weeks. :) But I'm sure you can survive in the interim.</p>
          </div>
          <hr />

          <div class="post">
            <p class="post-meta"><span class="post-author text-primary">vcoder</span><br />
            <span class="post-time small text-muted">16th July 2008 00:44 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

            <p class="post-content"></p>

            <blockquote>
              <i>Originally posted by jimpark</i><br />
              <b>vcoder, I'm on vacation right now. So I won't be on it for a few weeks. :) But I'm sure you can survive in the interim.</b>
            </blockquote>Thank you for your response.<br />
            <br />
            Have a good vacation! :up:
          </div>
          <hr />

          <div class="post">
            <p class="post-meta"><span class="post-author text-primary">vcoder</span><br />
            <span class="post-time small text-muted">16th July 2008 07:03 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

            <p class="post-content"><strong>Bug in FileWrite?</strong><br />
            This script work well on ANSI version of NSIS and failed on Unicode version:<br />
            <br />
            PHP Code:</p>
            <hr />
            <code style="white-space:nowrap"><!-- php buffer start --></code><span style="color: #000000"><span style="color: #0000BB">OutFile</span><span style="color: #DD0000">"GetVersion.exe"<br />
            <br /></span> <span style="color: #007700">!</span><span style="color: #0000BB">defineFile</span><span style="color: #DD0000">"Resources.dll"<br />
            <br /></span> <span style="color: #0000BB">RequestExecutionLeveluser<br />
            <br /></span> <span style="color: #007700">Function.</span><span style="color: #0000BB">onInit<br />
            GetDllVersion</span><span style="color: #DD0000">"${File}"</span><span style="color: #0000BB">$R0$R1<br />
            IntOp$R2$R0</span><span style="color: #007700">/</span><span style="color: #0000BB">0x00010000<br />
            IntOp$R3$R0</span><span style="color: #007700">&amp;</span><span style="color: #0000BB">0x0000FFFF<br />
            IntOp$R4$R1</span><span style="color: #007700">/</span><span style="color: #0000BB">0x00010000<br />
            IntOp$R5$R1</span><span style="color: #007700">&amp;</span><span style="color: #0000BB">0x0000FFFF<br />
            StrCpy$R1</span><span style="color: #DD0000">"$R2.$R3.$R4.$R5"<br />
            <br /></span> <span style="color: #0000BB">FileOpen</span><span style="color: #007700">$</span><span style="color: #0000BB">0</span><span style="color: #DD0000">"$EXEDIR\Version.txt"</span><span style="color: #0000BB">w<br />
            FileWrite</span><span style="color: #007700">$</span><span style="color: #0000BB">0</span><span style="color: #DD0000">'!defineVersion"$R1"$\n'<br /></span> <span style="color: #0000BB">FileClose</span><span style="color: #007700">$</span><span style="color: #0000BB">0<br /></span> <span style="color: #007700">;</span><span style="color: #0000BB">MessageBoxMB_OK</span><span style="color: #DD0000">"$R1"<br /></span> <span style="color: #0000BB">Abort<br />
            FunctionEnd<br />
            <br />
            Section<br />
            SectionEnd<br /></span></span> <!-- php buffer end -->
            <hr />
            Result file:<br />
            ANSI: !define Version "3.4.0.96"<br />
            Unicode: !def
          </div>
          <hr />

          <div class="post">
            <p class="post-meta"><span class="post-author text-primary">jimpark</span><br />
            <span class="post-time small text-muted">16th July 2008 18:53 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

            <p class="post-content">I'll look into it when I get back from vacation.</p>
          </div>
          <hr />

          <div class="post">
            <p class="post-meta"><span class="post-author text-primary">jimpark</span><br />
            <span class="post-time small text-muted">21st July 2008 22:12 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

            <p class="post-content">I am back from vacation today.<br />
            <br />
            Just released Unicode NSIS 2.38. Fixed vcoder's FileWrite bug as well. And modified the Unicode Mongolian translation to use some characters that do not exist in the ANSI Cyrillic codepage as per request by the OpenOffice project.</p>
          </div>
          <hr />

          <div class="post">
            <p class="post-meta"><span class="post-author text-primary">jimpark</span><br />
            <span class="post-time small text-muted">22nd July 2008 16:50 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

            <p class="post-content">Just modified the System plugin so that the 't' type specifier acts like a TCHAR*, that is, it will be an ANSI string in the ANSI version of NSIS, but will act as a wide-char string (Unicode string) in the Unicode NSIS.<br />
            <br />
            I introduced an 'm' type specifier to specify an ANSI string. Why 'm'? Well, I can't do 'a' or 's'. So 'm' stands for multi-byte string which ANSI strings can be (although, usually not). Also 'm' looks like an upside down 'w' which stands for wide-char string. :)<br />
            <br />
            This means that the conversion from your ANSI NSI script to the Unicode one will be mostly straightforward file conversion unless you were naughty and used the ANSI Windows API specifically, such as MessageBoxA. Some Windows API like GetProcAddress only take ANSI strings, so you should still look at your System calls carefully.<br />
            <br />
            The new version is dubbed 2.38.1. You know where to get it.<br />
            <br />
            I've also added an FAQ page (<a href="http://www.scratchpaper.com/unicodensisfaq" target="_blank">http://www.scratchpaper.com/unicodensisfaq</a>). If there are any missing topics you'd like to see or there's some erroneous info, please e-mail me.</p>
          </div>
          <hr />

          <div class="post">
            <p class="post-meta"><span class="post-author text-primary">Anders</span><br />
            <span class="post-time small text-muted">22nd July 2008 20:00 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

            <p class="post-content">there was already a feature request for this (<a href="http://sourceforge.net/tracker/index.php?func=detail&amp;aid=1961307&amp;group_id=22049&amp;atid=373088" target="_blank">http://sourceforge.net/tracker/index...49&amp;atid=373088</a>) would be great if you could submit a patch so the system plugin stays in sync</p>
          </div>
          <hr />

          <div class="post">
            <p class="post-meta"><span class="post-author text-primary">jimpark</span><br />
            <span class="post-time small text-muted">22nd July 2008 20:32 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

            <p class="post-content">I didn't know there was already a feature request. The feature request mentions 'z' as the potential type specifier. I did consider that but favored 'm'. Can we settle with 'm'?</p>
          </div>
          <hr />

          <div class="post">
            <p class="post-meta"><span class="post-author text-primary">jimpark</span><br />
            <span class="post-time small text-muted">22nd July 2008 20:52 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

            <p class="post-content">BTW, I can't add the modified source to the feature request. I can only submit comments. (Permissions issue?) Or do I have to submit a new patch request?</p>
          </div>
          <hr />

          <div class="post">
            <p class="post-meta"><span class="post-author text-primary">Anders</span><br />
            <span class="post-time small text-muted">23rd July 2008 06:27 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

            <p class="post-content">yeah, go with 'm', and you would have to submit it as a patch, not sure why its not possible to attach files</p>
          </div>
          <hr />

          <div class="post">
            <p class="post-meta"><span class="post-author text-primary">vcoder</span><br />
            <span class="post-time small text-muted">18th August 2008 23:50 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

            <p class="post-content"><strong>2.39</strong><br />
            We a waiting for Unicode version of NSIS 2.39... ;)</p>
          </div>
          <hr />

          <div class="post">
            <p class="post-meta"><span class="post-author text-primary">jimpark</span><br />
            <span class="post-time small text-muted">19th August 2008 01:04 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

            <p class="post-content">I'll probably work on it this weekend.</p>
          </div>
          <hr />

          <div class="post">
            <p class="post-meta"><span class="post-author text-primary">Ta2i4</span><br />
            <span class="post-time small text-muted">21st August 2008 15:04 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

            <p class="post-content">This code work well on ANSI version of NSIS 2.38 and failed on Unicode 2.38.1 version:<br />
            <br />
            !define HAVE_UPX<br />
            !ifdef HAVE_UPX<br />
            !packhdr tmpexe.tmp "UPX --best -f -q -v --ultra-brute --all-methods --all-filters --compress-icons=0 tmpexe.tmp"<br />
            !endif</p>
          </div>
          <hr />

          <div class="post">
            <p class="post-meta"><span class="post-author text-primary">jimpark</span><br />
            <span class="post-time small text-muted">22nd August 2008 11:45 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

            <p class="post-content">Have you tried packhdr just on its own to see whether it works on Unicode NSIS generated installers?</p>
          </div>
          <hr />

          <div class="post">
            <p class="post-meta"><span class="post-author text-primary">xbarns</span><br />
            <span class="post-time small text-muted">27th August 2008 14:38 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

            <p class="post-content">I tried using a2u.exe on a Windows 2003 Server (SP1, Standard English) it gives me an error: "This application has failed to start because the application configuration is incorrect. Reinstalling the application may fix this problem."<br />
            <br />
            It works fine on XP Pro. (SP2, German).</p>
          </div>
          <hr />

          <div class="post">
            <p class="post-meta"><span class="post-author text-primary">Pidgeot</span><br />
            <span class="post-time small text-muted">27th August 2008 15:42 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

            <p class="post-content">You most likely need a newer verison of the C++ redistributables installed: <a href="http://www.microsoft.com/downloads/details.aspx?FamilyID=200b2fd9-ae1a-4a14-984d-389c36f85647&amp;DisplayLang=en" target="_blank">http://www.microsoft.com/downloads/d...DisplayLang=en</a><br />
            <br />
            (If that doesn't work, try the 2008 one)</p>
          </div>
          <hr />

          <div class="post">
            <p class="post-meta"><span class="post-author text-primary">jimpark</span><br />
            <span class="post-time small text-muted">27th August 2008 22:31 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

            <p class="post-content">Well, if it is because of the redistributable, then it's a silly mistake on my part. I tried rebuilding the project. Can you try downloading a2u.zip and trying the executable inside it again?<br />
            <br />
            As for the Unicode NSIS update, I don't think it's happening this week. I've got way too much other work to do. Hopefully, next week some time.</p>
          </div>
          <hr />

          <div class="post">
            <p class="post-meta"><span class="post-author text-primary">xbarns</span><br />
            <span class="post-time small text-muted">28th August 2008 07:56 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

            <p class="post-content">It works now,thanks a lot!</p>
          </div>
          <hr />

          <div class="post">
            <p class="post-meta"><span class="post-author text-primary">Ta2i4</span><br />
            <span class="post-time small text-muted">29th August 2008 14:18 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

            <p class="post-content"></p>

            <blockquote>
              Have you tried packhdr just on its own to see whether it works on Unicode NSIS generated installers?
            </blockquote>This code I found in ansi-NSIS help file. I converted my ansi script file to unicode by a2u.exe and tried to compile it by unicode-NSIS. Result is error when part of code with UPX is processing.
          </div>
          <hr />

          <div class="post">
            <p class="post-meta"><span class="post-author text-primary">jimpark</span><br />
            <span class="post-time small text-muted">29th August 2008 14:48 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

            <p class="post-content">Okay, so can you try calling UPX itself to see if it works on Unicode NSIS installers? What does the errors say? I just don't have a lot of time to work on Unicode NSIS these days, so you're going to have to help me find the problem a bit.<br />
            <br />
            - Jim</p>
          </div>
          <hr />

          <div class="post">
            <p class="post-meta"><span class="post-author text-primary">Ta2i4</span><br />
            <span class="post-time small text-muted">30th August 2008 02:35 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

            <p class="post-content">I found this error on WinXP SP3. But in Vista SP1 the same error.<br />
            <br />
            This is report:<br />
            Error name: APPCRASH<br />
            Application name: makensis.exe<br />
            Version: 0.0.0.0<br />
            Time stamp of application: 4885ef1f<br />
            File with error: makensis.exe<br />
            Version: 0.0.0.0<br />
            Time stamp of file: 4885ef1f<br />
            Code of exception: c0000005<br />
            Stack of exception: 00006c6b<br />
            OS version: 6.0.6001.2.1.0.768.2<br />
            Language: 1049<br />
            Advanced info1: 8a1e<br />
            Advanced info2: 9e3d13911997afb9af7c20e45db763b3<br />
            Advanced info3: 3aba<br />
            Advanced info4: 1beeb7f8f0c5e3f3f9c6c0f5ff97433e</p>
          </div>
          <hr />

          <div class="post">
            <p class="post-meta"><span class="post-author text-primary">Ta2i4</span><br />
            <span class="post-time small text-muted">30th August 2008 02:41 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

            <p class="post-content"><b>1.</b> In script: CRCCheck off<br />
            <b>2.</b> Generating installer with name 'example.exe' without code with UPX.<br />
            <b>3.</b> Command line: upx -9 example.exe<br />
            <b>4.</b> Installer is working! Files is copying to folders. But the error when uninstall.exe creating.</p>
          </div>
          <hr />

          <div class="post">
            <p class="post-meta"><span class="post-author text-primary">jimpark</span><br />
            <span class="post-time small text-muted">30th August 2008 06:06 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

            <p class="post-content">Is there a plugin you are using to get this UPX capability? Or are you calling the UPX tool straight as part of your script? I only support the default plugins that come with NSIS. If you are using a third-party plugin, you will need to contact them for help or convert the third-party plugin to interface with the Unicode NSIS using Unicode strings. It seems like either a plugin that has not been converted for Unicode support or an UPX issue. Either way, I don't think I can help you in this case. I apologize.</p>
          </div>
          <hr />

          <div class="post">
            <p class="post-meta"><span class="post-author text-primary">Ta2i4</span><br />
            <span class="post-time small text-muted">30th August 2008 17:51 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

            <p class="post-content">I calling the UPX tool straight as part of script.<br />
            <br />
            See in file NSIS.chm:<br />
            "NSIS Users Manual" -&gt; "Chapter 5: Compile Time Commands" -&gt; "5.1 Compiler Utility Commands" -&gt; "5.1.10 !packhdr"<br />
            <br />
            Sorry, there is new code now. I will try the new code and will write the result here.</p>
          </div>
          <hr />

          <div class="post">
            <p class="post-meta"><span class="post-author text-primary">Ta2i4</span><br />
            <span class="post-time small text-muted">31st August 2008 15:26 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

            <p class="post-content">Same result.<br />
            <br />
            Script file contents:<br /></p>
            <pre>
<code><br />;...&lt;code before&gt;...<br />page licensepage<br />;...&lt;pages&gt;...<br /><br /><b>!packhdr ....</b><br /><br />Section First<br /> ;Some data<br />SectionEnd<br />;...&lt;code after&gt;...<br /></code>
</pre><br />
            <br />
            Output in makensis:<br />
            <pre>
<code>;...&lt;code before&gt;...<br /><br />!packhdr<br /><br />Section First</code>
</pre><br />
            Its all! Why?<br />
            Application error at this place.
          </div>
          <hr />

          <div class="post">
            <p class="post-meta"><span class="post-author text-primary">jamescookmd</span><br />
            <span class="post-time small text-muted">4th September 2008 23:54 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

            <p class="post-content">I'm an engineer on Second Life (<a href="http://www.secondlife.com" target="_blank">www.secondlife.com</a>). We've been using NSIS for years and love it.<br />
            <br />
            Recently we've noticed that installers built with NSIS 2.39 (and earlier) fail to launch on east Asian systems when the path to the installer has a non-roman character in it. For example, if a Korean user has a Windows username with Korean characters in it (í•œêµ_ì–´), and the installer is on the desktop, it fails to launch with the error:<br />
            <br />
            NSIS Error: Error launching installer<br />
            <br />
            I've noticed that I don't get this error if I build the installer using NSIS Unicode.<br />
            <br />
            Is this a known issue with the mainline NSIS? Do I have to switch to NSIS Unicode if I want my Asian users to be able to run the installer off their desktops?<br />
            <br />
            Thanks,<br />
            <br />
            James Cook<br />
            <a href="mailto:james@lindenlab.com">james@lindenlab.com</a></p>
          </div>
          <hr />

          <div class="post">
            <p class="post-meta"><span class="post-author text-primary">jimpark</span><br />
            <span class="post-time small text-muted">5th September 2008 04:43 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

            <p class="post-content">If the user had used MBCS (ANSI codepage) for their path names, it might have worked. But usually when Windows creates the User's documents and settings directory using the user name, that user name is going to be Unicode, not ANSI codepage, even if the operating system codepage is Korean in this case. So that's why ANSI NSIS has trouble with it. However, Unicode NSIS has no problems at all.</p>
          </div>
          <hr />

          <div class="post">
            <p class="post-meta"><span class="post-author text-primary">Pidgeot</span><br />
            <span class="post-time small text-muted">5th September 2008 08:38 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

            <p class="post-content">Not entirely true, Jim. In NTFS, all path names are Unicode (actually, this also applies to LFNs in FAT), so Windows will convert to ANSI when applications call the relevant *A-APIs.<br />
            <br />
            However, the ANSI codepage used is dependant on the setting selected for non-Unicode applications in Regional and Language settings in the Control Panel. If you've selected a codepage that doesn't contain the required characters, it'll fail to make a proper conversion because the unmapped characters are converted to a ?, which in turn means the path won't be found.<br />
            <br />
            Now, although I kind of doubt James posted the actual text in question, it would appear to contain 2 characters that aren't Korean (at least they appear as good old "I don't know what this character looks like" to me). That might indicate characters outside of CP949, the Korean codepage.<br />
            <br />
            (There's also an underscore, but that's in the 0-127 area, where they've only changed \ to â‚© - just like CP932, Japanese, has Â¥ at that position.)</p>
          </div>
          <hr />

          <div class="post">
            <p class="post-meta"><span class="post-author text-primary">jimpark</span><br />
            <span class="post-time small text-muted">5th September 2008 11:42 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

            <p class="post-content">Ah, thanks for the clarification Pidgeot. So the user name issue then must be that people like to have their user names in their native language which naturally causes Unicode characters to be included into the desktop path which is something like c:\documents and settings\&lt;user name&gt;\desktop or on Vista c:\Users\&lt;user name&gt;\desktop.<br />
            <br />
            Now what if the system codepage is not Korean but the person still wanted to have a Korean user name? How does the system convert that to codepage for NSIS to manipulate and back to Unicode? I think that's also a legitimate issue.<br />
            <br />
            So perhaps recently, there was a change in NSIS which required that it needed to know where itself was not just where the user wanted to install the program.</p>
          </div>
          <hr />

          <div class="post">
            <p class="post-meta"><span class="post-author text-primary">Pidgeot</span><br />
            <span class="post-time small text-muted">5th September 2008 12:19 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

            <p class="post-content">Just to elaborate how it all works with an example:<br />
            <br />
            If the system codepage is not Korean, and you use ANSI functions to fetch a path containing Korean characters, you'll get a question mark in place of each non-convertable character.<br />
            <br />
            Having your username in your native language is usually not an issue, because you'll usually have the same language set for non-Unicode applications, and when you aren't using that language in path names, it's usually English anyway, which can be expressed in all code pages.<br />
            <br />
            To give an example, the issue can pop up if I (being a Danish user) wanted to run a Japanese non-Unicode program. Running it with the non-Unicode language set to Danish would result in mojibake for text, so I'll need to set it to Japanese to run that program.<br />
            <br />
            (There's a tool by Microsoft, called AppLocale, which can set this for a single application - and because changing the global setting requires a reboot, that's a good thing - but that's a different story.)<br />
            <br />
            If my username then included a Danish letter, such as Ã…, any non-Unicode application attempting to get the username would read that character as a question mark, because Ã… does not exist in the Japanese codepage. The folder "Ã…l" (Eel) would thus become "?l" - but because the folder is called "Ã…l" and not "?l", it can't access the folder.<br />
            <br />
            You might argue that it could try to guess - after all, ? is a wildcard - however, there are issues with that:<br />
            <br />
            1) If there are multiple matches (let's say we also have a folder named "Ã˜l", meaning beer), you don't know which one you're supposed to get. Acting differently in the case of "only one match" is not consistent behavior, so that's not that good of an idea.<br />
            2) Strictly speaking, NTFS does allow a file to be called "?l" - the only character not really allowed is NUL, much like in Linux. Win32 adds several characters to the "disallowed" set due to backwards compatibility</p>
          </div>
          <hr />
          <!-- Bootstrap core CSS -->
          <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
          <!--[if lt IE 9]>
                <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
                <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->

          <div class="container">
            <!-- Put navigation bar here -->

            <ol class="breadcrumb">
              <li><a href="../index.html" class="glyphicon glyphicon-home"></a></li>

              <li><a href="f-65.html">NSIS Discussion</a></li>

              <li class="active">Unicode</li>
            </ol>

            <p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=277381">Unicode</a></p><br />

            <div class="post">
              <p class="post-meta"><span class="post-author text-primary">jamescookmd</span><br />
              <span class="post-time small text-muted">6th September 2008 00:27 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

              <p class="post-content">Thanks for the details, guys. I agree the issue is people with paths to the installer like C:\Documents and Settings\&lt;username-with-extended-chars&gt;\Desktop. I presume this means I'm not doing anything wrong with my plain-old-NSIS installer?<br />
              <br />
              I wish there was a workaround for plain-NSIS because we've got it installed on a plethora of developer and build machines.<br />
              <br />
              Could it be because we're using CRC check?<br />
              <br />
              Can you guys think of a workaround other than switching to NSIS Unicode?<br />
              <br />
              James<br />
              <br />
              (I attached our installer script below in case you're curious.)</p>
            </div>
            <hr />

            <div class="post">
              <p class="post-meta"><span class="post-author text-primary">Pidgeot</span><br />
              <span class="post-time small text-muted">6th September 2008 12:47 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

              <p class="post-content">I made a very small installer to test, and I get the same result with CRCCheck On and CRCCheck Off - so that's not it.<br />
              <br />
              Now, this is just my opinion, but I would probably go Unicode now. It's not something you can really avoid, since the Unicode branch will eventually be moved into the main build, so not doing it now would only postpone the migration.<br />
              <br />
              The alternative would probably be an addition to a readme or FAQ or whatever, with a guide on how to change to the appropriate codepage, or suggesting the workaround to place it in a path only containing ASCII.<br />
              <br />
              I'd like to stress again: The problem is not with paths that contain characters &lt;= U+007F, since those are unchanged in all Windows codepages (except the issue with \, but that one is handled gracefully). The problem is with characters that are &gt;= U+0080, and are not representable in the user's codepage.</p>
            </div>
            <hr />

            <div class="post">
              <p class="post-meta"><span class="post-author text-primary">jamescookmd</span><br />
              <span class="post-time small text-muted">6th September 2008 15:22 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

              <p class="post-content">Thanks guys. I really appreciate the help. I think we'll switch the NSIS Unicode for the time being.<br />
              <br />
              Enjoy the coffee, Jim! :-)<br />
              <br />
              James</p>
            </div>
            <hr />

            <div class="post">
              <p class="post-meta"><span class="post-author text-primary">jamescookmd</span><br />
              <span class="post-time small text-muted">9th September 2008 22:38 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

              <p class="post-content">I'm having another problem...<br />
              <br />
              An installer built with NSIS Unicode 2.38.1 does not show the "unpacking data: ##%" dialog during load. The same installer built with NSIS 2.39 does show the dialog.<br />
              <br />
              My installer is 21 MB compressed with LZMA, so the unpack takes a noticeable amount of time. Is there a way to get that dialog back, or put up some other sort of progress display?<br />
              <br />
              Thanks,<br />
              <br />
              James</p>
            </div>
            <hr />

            <div class="post">
              <p class="post-meta"><span class="post-author text-primary">jimpark</span><br />
              <span class="post-time small text-muted">10th September 2008 00:35 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

              <p class="post-content">Does that happen with any compression setting? I'm imagining that it does. And also, does it print anything at all like "unpacking data:?" or is there no analogous printed line at all?</p>
            </div>
            <hr />

            <div class="post">
              <p class="post-meta"><span class="post-author text-primary">jamescookmd</span><br />
              <span class="post-time small text-muted">10th September 2008 01:01 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

              <p class="post-content">Jim,<br />
              <br />
              Should I run the installer from the command line to look for output? I get no window open of any kind during unpack. The first window I get is language select (from our .onInit() function).<br />
              <br />
              I've only tried it with SetCompressor /solid lzma<br />
              <br />
              Tomorrow in the office I'll try it with other compression settings. Any particular ones to try?<br />
              <br />
              James<br />
              <br />
              (I attached the shell of our installer -- all the %%FOO%% sections are automatically populated with our lists of files.)</p>
            </div>
            <hr />

            <div class="post">
              <p class="post-meta"><span class="post-author text-primary">jamescookmd</span><br />
              <span class="post-time small text-muted">10th September 2008 01:40 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

              <p class="post-content">It doesn't look like installers print anything to the console -- running from the command line shows nothing.<br />
              <br />
              Also, I have the same problem (no "unpacking" dialog) with:<br />
              SetCompressor zlib<br />
              SetCompressor /solid zlib<br />
              SetCompressor /solid bzip2<br />
              <br />
              Hope that helps.<br />
              <br />
              James</p>
            </div>
            <hr />

            <div class="post">
              <p class="post-meta"><span class="post-author text-primary">Joost Verburg</span><br />
              <span class="post-time small text-muted">10th September 2008 12:53 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

              <p class="post-content">A workaround could be to add all files in the right order in the solid archive (using ReserveFile). Then there will be no need to extract a lot of data at startup.</p>
            </div>
            <hr />

            <div class="post">
              <p class="post-meta"><span class="post-author text-primary">jamescookmd</span><br />
              <span class="post-time small text-muted">17th September 2008 22:13 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

              <p class="post-content">Thanks for the suggestion, Joost. I ended up reordering my .nsi script so all the functions are at the start of the file, followed by all the files. We used to have the .onInit function at the end of the .nsi file, which I think was the cause of the slow unpack. This seems to eliminate the startup delay that caused the "unpacking data" dialog to appear and solves my problem.<br />
              <br />
              I didn't see this documented anywhere -- does NSIS interleave the packed file data and the function definitions? If so, it seems important to put all your user-written functions before the first big list of files. Should that go in the docs somewhere?<br />
              <br />
              Jim, just so you know, NSIS Unicode definitely doesn't show the "unpacking data" dialog, though, even on slow unpacks.<br />
              <br />
              Thanks again, guys. James</p>
            </div>
            <hr />

            <div class="post">
              <p class="post-meta"><span class="post-author text-primary">vcoder</span><br />
              <span class="post-time small text-muted">15th October 2008 02:12 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

              <p class="post-content"><strong>2.40?</strong><br />
              Are you going to update NSIS' Unicode version up to 2.40?<br />
              There are some important (for me) improvements and bug fixes.<br />
              <br />
              Thank you.</p>
            </div>
            <hr />

            <div class="post">
              <p class="post-meta"><span class="post-author text-primary">jimpark</span><br />
              <span class="post-time small text-muted">15th October 2008 03:09 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

              <p class="post-content">I'm currently at the busiest time of the year for development. We have what we need right now as far as an installer is concerned so I'm not going to be able to update this any time soon. I'm hoping if the NSIS guys are really going to support Unicode, they pick it up soon.</p>
            </div>
            <hr />

            <div class="post">
              <p class="post-meta"><span class="post-author text-primary">pabs</span><br />
              <span class="post-time small text-muted">28th October 2008 01:21 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

              <p class="post-content">kichik, whats the status of this Unicode support? Needs reviewing? Needs something fixed? Debian folks are wanting this too.</p>
            </div>
            <hr />

            <div class="post">
              <p class="post-meta"><span class="post-author text-primary">pabs</span><br />
              <span class="post-time small text-muted">7th November 2008 06:09 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

              <p class="post-content">I've been looking at the code changes just now.<br />
              <br />
              First thing that got me was all the ANSI/Unicode dirs all over the place with the files in UTF-16. I didn't think that is a good idea, so I converted all the Unicode directories into UTF-8 and looked at the differences between them.<br />
              <br />
              Based on that, here are some suggestions:<br />
              <br />
              Don't duplicate stuff that doesn't have non-ANSI characters in it.<br />
              <br />
              Where the only change between Unicode and ANSI is to re-encode the Â© (Copyright) symbol, just replace it with the word "Copyright", since that is as legally valid as "Â©".<br />
              <br />
              Where differing parameters to System::Call are needed, add an !ifdef UNICODE or something.<br />
              <br />
              Some more comments:<br />
              <br />
              Don't add/remove whitespace where it isn't needed.<br />
              <br />
              Menu/images/Unicode/create_header.py isn't needed, Scripts/release.py does that stuff.<br />
              <br />
              Please don't include proprietary formats like Paint.NET in nsis, standardised PNG, BMP or ICO are best.<br />
              <br />
              For the languages, store everything in UTF-8 in the source code and convert to ANSI at makensis time if the user sets a specific code page (and error out if all the characters are not available in that CP). On Linux the iconv function can help and for people running makensis on Win9x the unicows library could be useful:<br />
              <br />
              <a href="http://libunicows.sourceforge.net/" target="_blank">http://libunicows.sourceforge.net/</a><br />
              <br />
              Switching to gettext style translations and the PO file format for translations might be useful too, dunno how well Windows supports it though.<br />
              <br />
              Use ISO 639-1 codes for language type instead of English words for the languages.<br />
              <br />
              For the Contrib/UIs, add ifdefs, compile them twice and install them into Unicode and ANSI directories. Alternatively makensis could detect a "RichEdit20" class and replace it with "RichEdit20A" or "RichEdit20W" as appropriate.<br />
              <br />
              Examples/Unicode/bigtest.nsi doesn't need to use the Â¢ character.<br />
              <br />
              Examples/Unicode/makensis.nsi doesn't need ANSI/Unicode in the registry/etc does it? Just make one version of makensis that does both ANSI and Unicode depending on a command-line switch or a script command. Same for a lot of other stuff.<br />
              <br />
              Will make some of these changes myself, look at the rest of the changes and add more comments.</p>
            </div>
            <hr />

            <div class="post">
              <p class="post-meta"><span class="post-author text-primary">jamescookmd</span><br />
              <span class="post-time small text-muted">7th November 2008 06:19 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

              <p class="post-content">I just filed issue 2230926 related to NSIS 2.40 (and earlier) installers throwing an error on startup if the path to the installer contains wide characters.<br />
              <br />
              <a href="https://sourceforge.net/tracker/index.php?func=detail&amp;aid=2230926&amp;group_id=22049&amp;atid=373085" target="_blank">https://sourceforge.net/tracker/inde...49&amp;atid=373085</a><br />
              <br />
              NSIS Unicode doesn't seem to have this problem. I wonder if the parts of the Unicode patch that fix this issue could be ported over separately, or as an initial step.<br />
              <br />
              James<br />
              <a href="mailto:james@lindenlab.com">james@lindenlab.com</a></p>
            </div>
            <hr />

            <div class="post">
              <p class="post-meta"><span class="post-author text-primary">GoHa</span><br />
              <span class="post-time small text-muted">4th December 2008 02:27 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

              <p class="post-content">Hello, I was using ANSI version of NSIS until I faced the issue with unicode user name. Then I found unicode nsis and it solve the issue.<br />
              <br />
              I just read though this entire thread, and now a bit confused. Looks like I was supposed to convert scripts to unicode?<br />
              <br />
              I did not converted my scripts to unicode, they are still ANSI. But installer now works fine with UNICODE user names, so, definitely, I compiled unicode version.<br />
              <br />
              Why I was able to compile ANSI scripts? Isnt it should be mandatory converted to UNICODE?<br />
              <br />
              I did nothing else but reinstalled NSIS and recompiled it under unicode NSIS. Looks like everything is fine.<br />
              What I am missing?</p>
            </div>
            <hr />

            <div class="post">
              <p class="post-meta"><span class="post-author text-primary">jimpark</span><br />
              <span class="post-time small text-muted">4th December 2008 14:38 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

              <p class="post-content">What it does is try to convert the ANSI script to Unicode using the system's codepage. That's probably okay if you are the only developer and you never change your system codepage to something else but technically this is incorrect. In order to make your NSIS script portable, you should convert your script to UTF-16 (using notepad.exe, for instance). If you don't, you might find that later down the line, users report that your installer produces junk text and you might not remember why. It's simple to do, so just load it up with notepad and save as Unicode and save yourself future grief.</p>
            </div>
            <hr />

            <div class="post">
              <p class="post-meta"><span class="post-author text-primary">GoHa</span><br />
              <span class="post-time small text-muted">4th December 2008 20:01 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

              <p class="post-content">Thanks. One more question, if you please.<br />
              We are planning to do some localization.<br />
              Question regarding existing language files: I've noticed, that with unicoed nsis you ship non-unicode language files. Correct?<br />
              <br />
              How non-unicode language files survive with unicode installer? What shell I do about it? We server like 9 languages, like Gernam, French, Spanish, Simplified Chinesse, Traditional Chiness, Korean, Dutch, Italian, Japanese, Portuguese.</p>
            </div>
            <hr />

            <div class="post">
              <p class="post-meta"><span class="post-author text-primary">Pidgeot</span><br />
              <span class="post-time small text-muted">4th December 2008 20:18 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

              <p class="post-content">No, the language files that come with Unicode NSIS are indeed Unicode. I'm not sure why you think that wasn't the case, unless you've been looking at the "regular" NSIS files.</p>
            </div>
            <hr />

            <div class="post">
              <p class="post-meta"><span class="post-author text-primary">GoHa</span><br />
              <span class="post-time small text-muted">4th December 2008 20:55 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

              <p class="post-content">In unicode NSIS installation files in ".\nsis\Contrib\Language files" are not unicode. See attahcment.<br />
              <br />
              /edit: attachment deleted. I was looking into the wrong NSIS installation folder.</p>
            </div>
            <hr />

            <div class="post">
              <p class="post-meta"><span class="post-author text-primary">Pidgeot</span><br />
              <span class="post-time small text-muted">4th December 2008 21:21 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

              <p class="post-content">Those aren't the Unicode NSIS files. I've looked at the exact same files here (2.38.1-Unicode), and they are Unicode here.<br />
              <br />
              Note that, by default, Unicode NSIS installs itself into Program Files\NSIS\Unicode - it does not overwrite the ANSI NSIS files (but the context menu is changed to point to the Unicode NSIS instead). The path you give suggest you're looking at the ANSI NSIS files.</p>
            </div>
            <hr />

            <div class="post">
              <p class="post-meta"><span class="post-author text-primary">GoHa</span><br />
              <span class="post-time small text-muted">4th December 2008 21:33 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

              <p class="post-content">Oops. Please disregard my last question, you were absolutely right, files are unicode. I was looking into the wrong NSIS installation folder. Sorry for the confusion.</p>
            </div>
            <hr />

            <div class="post">
              <p class="post-meta"><span class="post-author text-primary">GoHa</span><br />
              <span class="post-time small text-muted">5th December 2008 02:00 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

              <p class="post-content">Is that possible to declare and use (as a plugin feed) ANSI string within UNICODE version of plugin?</p>
            </div>
            <hr />

            <div class="post">
              <p class="post-meta"><span class="post-author text-primary">jimpark</span><br />
              <span class="post-time small text-muted">5th December 2008 02:10 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

              <p class="post-content">Not really.</p>
            </div>
            <hr />

            <div class="post">
              <p class="post-meta"><span class="post-author text-primary">GoHa</span><br />
              <span class="post-time small text-muted">5th December 2008 02:13 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

              <p class="post-content">Lazy to rewrite plugins...<br />
              Do you know any encryption plugin that will work with unicode?<br />
              Like sha1 or md5?<br />
              stuck in this.. During the installation i have to verify downloaded package. Was easy under ANSI version.</p>
            </div>
            <hr />

            <div class="post">
              <p class="post-meta"><span class="post-author text-primary">jimpark</span><br />
              <span class="post-time small text-muted">5th December 2008 02:21 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

              <p class="post-content">NSIS installers already do CRC checks on themselves as I understand it. If that's not good enough, you will have to port some plugin over to work with Unicode. It's not too hard. Look at how the standard plugins were ported.</p>
            </div>
            <hr />

            <div class="post">
              <p class="post-meta"><span class="post-author text-primary">jamescookmd</span><br />
              <span class="post-time small text-muted">5th December 2008 07:14 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

              <p class="post-content">Jim,<br />
              <br />
              How hard do you think it would be for me to write a Unicode-path-to-installer patch for ANSI NSIS? If I wrote it, do you think the mainline NSIS would accept it?<br />
              <br />
              The inability of ANSI NSIS installers to run from the Desktop and Download folders of Windows users with Unicode account names is a major blocker for us. We use your Unicode version from <a href="http://www.scratchpaper.com," target="_blank">www.scratchpaper.com,</a> but it would be nice to stay up to date with the recent ANSI NSIS versions.<br />
              <br />
              I'm way too new to the NSIS code to attempt to update the Unicode NSIS version to the latest ANSI codebase. But I might be able to hard-code all the file open commands to use the FunctionW() versions and convert the path to the installer to WCHAR.<br />
              <br />
              What do you think?<br />
              <br />
              James<br />
              <a href="mailto:james@lindenlab.com">james@lindenlab.com</a></p>
            </div>
            <hr />

            <div class="post">
              <p class="post-meta"><span class="post-author text-primary">jimpark</span><br />
              <span class="post-time small text-muted">5th December 2008 11:25 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

              <p class="post-content">James,<br />
              <br />
              I was no expert when I started. I never heard of NSIS nor cared about installers until out of necessity I had to. I just downloaded the source and dove right in.<br />
              <br />
              The problem of trying to make NSIS partially Unicode might be even harder than making NSIS completely Unicode. For example, you'll need to be able to specify Unicode strings in the ANSI script files. From a UI standpoint, there are a million ways to get the path strings from the user and all those paths need to be covered as well. So supporting two methods of data entry support might be a very daunting task.<br />
              <br />
              And even if you were able to shoehorn it -- I don't know how easy it would be to keep it up-to-date. And it probably won't be accepted by the mainline NSIS.<br />
              <br />
              There are two bright sides, though. One, I'm starting to get freed up from my current project so I might be able to spare some time in the coming weeks to update the Unicode NSIS. And two, the main NSIS project needs to adopt some strategy of supporting Unicode soon or it will really lose relevancy -- the only thing saving NSIS is that there is no other open source option. But that can change. Some big project out of necessity can create one that supports Unicode and that would be the end of NSIS. If that happens, I'm not going to keep up Unicode NSIS. I'll just adopt the new open source installer.<br />
              <br />
              - Jim</p>
            </div>
            <hr />

            <div class="post">
              <p class="post-meta"><span class="post-author text-primary">Anders</span><br />
              <span class="post-time small text-muted">5th December 2008 16:34 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

              <p class="post-content">There are other open source installers, Inno Setup etc.<br />
              <br />
              It would also be possible to create a plugin that can call ansi nsis plugins from the unicode build</p>
            </div>
            <hr />

            <div class="post">
              <p class="post-meta"><span class="post-author text-primary">jimpark</span><br />
              <span class="post-time small text-muted">5th December 2008 22:06 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

              <p class="post-content">Inno Setup I believe is free but not open source. They may have changed that recently.<br />
              <br />
              Also, I don't think they support Unicode either.<br />
              <br />
              I guess a plugin that calls ansi plugins might be doable, but it would not work in the general case. How do you convert to ANSI? Do you assume that the system default codepage is the right one? That would be wrong on many machines. And it won't help you if you went to the Unicode NSIS because you need Unicode in the first place.<br />
              <br />
              Really, if you need Unicode and you need a particular plugin, you really should create a Unicode version of the plugin. It's not that hard.</p>
            </div>
            <hr />

            <div class="post">
              <p class="post-meta"><span class="post-author text-primary">Anders</span><br />
              <span class="post-time small text-muted">5th December 2008 23:06 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

              <p class="post-content"><a href="http://cvs.jrsoftware.org/view/issrc/" target="_blank">http://cvs.jrsoftware.org/view/issrc/</a></p>
            </div>
            <hr />

            <div class="post">
              <p class="post-meta"><span class="post-author text-primary">jimpark</span><br />
              <span class="post-time small text-muted">6th December 2008 01:04 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

              <p class="post-content">So they did open it up. But Pascal? They should have kept it closed. :) Just kidding. Still, no support for Unicode. :/</p>
            </div>
            <hr />

            <div class="post">
              <p class="post-meta"><span class="post-author text-primary">Anders</span><br />
              <span class="post-time small text-muted">6th December 2008 02:35 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

              <p class="post-content">Open it up? It has been open source for years</p>
            </div>
            <hr />

            <div class="post">
              <p class="post-meta"><span class="post-author text-primary">jimpark</span><br />
              <span class="post-time small text-muted">6th December 2008 03:16 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

              <p class="post-content">Yes, it seems like you are correct, Anders. They have been open source for years. I misremembered reading somewhere that Inno Setup is free but not open source. Maybe I was just remembering that there was no easy way to build the source. You needed to purchase Delphi development tools from Borland. Is there any free development tools that can build Inno Setup, currently? Not that I care to learn Delphi or Object Pascal at the moment...</p>
            </div>
            <hr />

            <div class="post">
              <p class="post-meta"><span class="post-author text-primary">ehsanakhgari</span><br />
              <span class="post-time small text-muted">7th December 2008 20:57 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

              <p class="post-content"><strong>Using Unicode NSIS in Firefox</strong><br />
              Hi all,<br />
              <br />
              I'm trying to convert Firefox's installer from NSIS to Unicode NSIS. I'm facing a problem which I don't know how to solve.<br />
              <br />
              When I build Firefox installer using Unicode NSIS, it appears that some of the images/strings/formattings don't make it into the final installer. For example, the header and watermark which the Firefox installer uses do not appear on the screen; the welcome page strings don't show up, and formattings such as bold header for MUI pages are lost.<br />
              <br />
              I'm not really sure what causes the problems. The same source files can be successfully built using NSIS 2.22 (which Mozilla uses by default). I'm trying the Unicode NSIS version 2.33, but I have tried this with the latest version as well, without any luck.<br />
              <br />
              Any help is very much appreciated!<br />
              <br />
              Thanks!<br />
              Ehsan</p>
            </div>
            <hr />

            <div class="post">
              <p class="post-meta"><span class="post-author text-primary">jimpark</span><br />
              <span class="post-time small text-muted">8th December 2008 11:24 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

              <p class="post-content">Are all the files you are using now UTF-16LE? The NSI files as well as all the readme text files you are using should be UTF-16LE. Make sure that's the case. (You can use a2u.exe or notepad.exe to make the conversion.)</p>
            </div>
            <hr />

            <div class="post">
              <p class="post-meta"><span class="post-author text-primary">ehsanakhgari</span><br />
              <span class="post-time small text-muted">8th December 2008 11:51 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

              <p class="post-content">Yes, the text files are all encoded in UTF-16LE. Do you have any ideas on what else could be wrong?</p>
            </div>
            <hr />

            <div class="post">
              <p class="post-meta"><span class="post-author text-primary">jimpark</span><br />
              <span class="post-time small text-muted">8th December 2008 23:11 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

              <p class="post-content">Are you generating these text files using a script of some kind? I remembering looking at some of the Mozilla build stuff and it seems heavily scripted. Any possibility that some of these files are generated files? I've noticed that while Python and to some extent Perl does internally support Unicode strings, printing them out to a file needs to be done correctly or they get converted to ANSI inadvertently.</p>
            </div>
            <hr />

            <div class="post">
              <p class="post-meta"><span class="post-author text-primary">ehsanakhgari</span><br />
              <span class="post-time small text-muted">9th December 2008 15:00 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

              <p class="post-content">Some of these text files are generated by a script, and some others are simply copied using cp. All those files are in UTF-8 encoding. For ANIS NSIS, we would use iconv to convert them to the correct code page, but with Unicode NSIS, I have used iconv to convert them to UTF-16LE. I prepend the UTF-16LE BOM bytes to the files manually using a very simple Perl script:<br />
              <br />
              my $line;<br />
              print "\xFF\xFE"; # UTF-16LE BOM mark<br />
              while( $line = &lt;STDIN&gt; ) {<br />
              print "$line";<br />
              }<br />
              <br />
              I have opened all these files in Notepad++ and they all shown properly with the correct encoding.<br />
              <br />
              I assume I don't have to run the BMP files through iconv, right?<br />
              <br />
              Would you say that iconv's output might be different to that of your a2u program? Does a2u support UTF-8 as the input format?</p>
            </div>
            <hr />

            <div class="post">
              <p class="post-meta"><span class="post-author text-primary">ehsanakhgari</span><br />
              <span class="post-time small text-muted">9th December 2008 21:22 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

              <p class="post-content">Nevermind, I found out the problem. In our nsi files, we were !defining MUI_INSERT, which, in newer versions of NSIS, caused the MUI_INSERT macro not to expand to anything useful. Removing that !define did the trick!<br />
              <br />
              By the way, did I mention that Unicode NSIS is *awesome*? Keep up the good work, Jim!</p>
            </div>
            <hr />

            <div class="post">
              <p class="post-meta"><span class="post-author text-primary">jimpark</span><br />
              <span class="post-time small text-muted">10th December 2008 03:58 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

              <p class="post-content">I'm glad things worked out. Thank you for the encouragement.</p>
            </div>
            <hr />
            <!-- Bootstrap core CSS -->
            <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
            <!--[if lt IE 9]>
                <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
                <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->

            <div class="container">
              <!-- Put navigation bar here -->

              <ol class="breadcrumb">
                <li><a href="../index.html" class="glyphicon glyphicon-home"></a></li>

                <li><a href="f-65.html">NSIS Discussion</a></li>

                <li class="active">Unicode</li>
              </ol>

              <p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=277381">Unicode</a></p><br />

              <div class="post">
                <p class="post-meta"><span class="post-author text-primary">CritterNYC</span><br />
                <span class="post-time small text-muted">22nd December 2008 06:55 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                <p class="post-content"></p>

                <blockquote>
                  <i>Originally posted by jimpark</i><br />
                  <b>Yes, it seems like you are correct, Anders. They have been open source for years. I misremembered reading somewhere that Inno Setup is free but not open source.</b>
                </blockquote>This is partially right. Inno Setup is free (as in money) and the source is available, but they are using a license that is not approved by OSI (opensource.org). Inno Setup uses its own unique license:<br />
                <a href="http://www.innosetup.com/files/is/license.txt" target="_blank">http://www.innosetup.com/files/is/license.txt</a><br />
                <br />
                The sticking point is point 3: "All redistributions in binary form must retain all occurrences of the above copyright notice and web site addresses that are currently in place (for example, in the About boxes)."<br />
                <br />
                This requirement doesn't appear to be compatible with the GPL and doesn't appear to exist in other OSI-approved open source licenses.
              </div>
              <hr />

              <div class="post">
                <p class="post-meta"><span class="post-author text-primary">Anders</span><br />
                <span class="post-time small text-muted">22nd December 2008 09:13 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                <p class="post-content">I'm not sure if the actual installer itself has a about box, but the version info has a innosetup link in one of the extra items, no big deal IMHO (how far off topic are we now? :) )</p>
              </div>
              <hr />

              <div class="post">
                <p class="post-meta"><span class="post-author text-primary">jimpark</span><br />
                <span class="post-time small text-muted">3rd January 2009 18:11 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                <p class="post-content">I just wanted to inform everyone that I'm actively working on the Unicode port of 2.42. I've got most of it done and working but I'm having a bit of trouble with the System plugin samples. More code got turned into assembly code since 2.38 and I had brush up on my assembly code skills. So expect a release sometime next week.<br />
                <br />
                Also, if anyone wants to help debug my System plugin woes, please drop me an e-mail and I can provide you with the latest code and binaries.</p>
              </div>
              <hr />

              <div class="post">
                <p class="post-meta"><span class="post-author text-primary">ehsanakhgari</span><br />
                <span class="post-time small text-muted">3rd January 2009 22:23 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                <p class="post-content">We'll be using Unicode NSIS 2.33 in Mozilla-based software installers. What would we gain if we update Unicode NSIS to a newer version?</p>
              </div>
              <hr />

              <div class="post">
                <p class="post-meta"><span class="post-author text-primary">jimpark</span><br />
                <span class="post-time small text-muted">4th January 2009 13:12 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                <p class="post-content">From what I can see (and others may feel free to chime in), they've made the writing of the install script easier. For example, when you include an NSH file, you no longer need to declare all the macros you will you use. When using a plugin, you no longer have to remember to put /NOUNLOAD. When writing the uninstall section and using macros, you don't have to remember to put "un" in front of everything. While this probably won't help you if you already have a working NSI script, for someone creating a new one, I can see how it can be a real benefit.</p>
              </div>
              <hr />

              <div class="post">
                <p class="post-meta"><span class="post-author text-primary">KrisAster</span><br />
                <span class="post-time small text-muted">5th January 2009 15:29 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                <p class="post-content">Pardon me for sounding like a broken record here, but um... Is there any plan for this Unicode branch to be incorporated into the trunk?<br />
                <br />
                Due to the sheer popularity of this thread (#1 in replies and views), it seems that I'm not the only one who is a user of this branch. And, it also seems as though I'm not the only one a bit frustrated by the delay in the Unicode branch receiving the latest features added to NSIS.<br />
                <br />
                Some of the reasons first proffered for this not being added to the trunk when first released were due to the question of its stability, but inasmuch as nearly every major open source project is ALREADY using it (Winamp (the host of this site), Mozilla, Firezilla, Open Office), I think the question of its stability has been answered.<br />
                <br />
                NSIS Unicode works, and it works well. I'd like to voice my request again to have regular builds of this from the NSIS site.</p>
              </div>
              <hr />

              <div class="post">
                <p class="post-meta"><span class="post-author text-primary">jimpark</span><br />
                <span class="post-time small text-muted">6th January 2009 16:03 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                <p class="post-content">Hello folks. Unicode NSIS 2.42 is now out. Get your copy at <a href="http://www.scratchpaper.com." target="_blank">http://www.scratchpaper.com.</a> If you find bugs, please let me know.</p>
              </div>
              <hr />

              <div class="post">
                <p class="post-meta"><span class="post-author text-primary">jimpark</span><br />
                <span class="post-time small text-muted">8th January 2009 14:24 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                <p class="post-content">Well, it's been two days and now Unicode NSIS 2.42.1 is out. My sincere thanks to everyone who reported bugs and worked with me to get the fixes done! Go get the latest from <a href="http://www.scratchpaper.com." target="_blank">http://www.scratchpaper.com.</a></p>
              </div>
              <hr />

              <div class="post">
                <p class="post-meta"><span class="post-author text-primary">jimpark</span><br />
                <span class="post-time small text-muted">8th January 2009 14:41 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                <p class="post-content"><u>Differences in 2.42.1</u><br />
                <br />
                I took the libery to add a few more features to this albeit short release.<br />
                <br />
                Added the ${NSIS_CHAR_SIZE} macro which will be 1 in ANSI and 2 in Unicode. (This only exist in my versions of NSIS, but it would be nice to get into the trunk as well.) This allows the installer developer to write code that uses IntOp to manipulate string pointers to do it the same way for both Unicode and ANSI scripts.<br />
                <br />
                I've also added System::StrAlloc which allocates strings of N characters not bytes. This means that System::StrAlloc 1024 in ANSI will be 1024 bytes but in Unicode it will be 2048 bytes.<br />
                <br />
                Related to the above, I've made changes to the System plugin such that for &amp;tN and &amp;wN, it refers to N <i>characters</i> not bytes. And I've made documentation changes in System.html to that affect.<br />
                <br />
                I've also changed the names of the shell commands to reflect which version of NSIS you will be compiling against. So instead of getting the generic "Compile NSIS Script" in the context menu when you right click on an NSI file, now you get "Compile Unicode NSIS Script" or "Compile ANSI NSIS Script" or both if you have both installed. You may have noticed that Unicode makensisw.exe is smart enough to try to convert an ANSI NSI file to Unicode and compile it anyway. So if you are sure that your ANSI script needs no modifications, but just a file conversion to Unicode, then this is a nice feature. But it can also be a source of confusion so by making the shell commands more descriptive, you'll know what you are getting.<br />
                <br />
                Enjoy.</p>
              </div>
              <hr />

              <div class="post">
                <p class="post-meta"><span class="post-author text-primary">Anders</span><br />
                <span class="post-time small text-muted">8th January 2009 16:40 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                <p class="post-content">I would suggest putting a SystemStrAlloc macro somewhere so that the ansi version can continue to call Alloc and save a couple of bytes in size</p>
              </div>
              <hr />

              <div class="post">
                <p class="post-meta"><span class="post-author text-primary">jimpark</span><br />
                <span class="post-time small text-muted">8th January 2009 18:20 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                <p class="post-content">Well, you might be surprised to find that adding the function did not grow System.dll by a single byte. The code section grows in some increments and it just fits nicely into the space available. And if you really want to fuss over bytes, if you compare my version of the ANSI System.dll, it's actually 512 bytes smaller. And the Unicode version is the same size as the official one.</p>
              </div>
              <hr />

              <div class="post">
                <p class="post-meta"><span class="post-author text-primary">jimpark</span><br />
                <span class="post-time small text-muted">9th January 2009 14:24 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                <p class="post-content">Auto conversion of text encodings:<br />
                <br />
                Here's basically what the Unicode NSIS does as far as auto-encoding/decoding of text types.<br /></p>

                <ul>
                  <li>If the file has no BOM in the beginning, it assumes it's an ANSI text file. (It will probably use the system codepage to convert it internally to UTF-16LE -- but I'm not sure about this. It may just strip out anything beyond ASCII and replace them with '?').<br /></li>

                  <li>If the file starts with a 16 bit encoding of the BOM (the usual kind 0xFEFF), it will treat the file as a UTF-16 file and correct it for endianness, internally storing everything as UTF-16LE.<br /></li>

                  <li>If the file starts with an 8 bit encoding of the BOM (0xEF 0xBB 0xBF), then it treats the file as a UTF-8 file and not an ANSI file. So those who desire to store their scripts in UTF-8, it's fine as long as it starts with a UTF-8 BOM. I understand that it's not usual for UTF-8 files to have a BOM, but since in the Windows world ANSI/ASCII files are more prevalent than UTF-8, this is what I chose. If people want UTF-8 to be the default, I'm open to that. Just let me know what you opinion is. Incidentally, notepad.exe, when saving files as UTF-8 will add a BOM to the start of the file for you.</li>
                </ul>
              </div>
              <hr />

              <div class="post">
                <p class="post-meta"><span class="post-author text-primary">Pidgeot</span><br />
                <span class="post-time small text-muted">9th January 2009 15:42 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                <p class="post-content">The way I would prefer codepage detection to work is like this:<br />
                <br />
                BOM Present: Use the corresponding encoding/codepage.<br />
                No BOM present: Check to see if the file can be fully parsed as UTF-8 (that is, no invalid byte sequences exist). If this succeeds, then it is very safe to assume that the file is indeed UTF-8. If it fails, fall back to ANSI/system codepage. Although we could, at least in theory, try to figure out UTF-16/UTF-32 without a BOM, due to the nature of the files, I suggest not doing so (since they are exceedingly rare, unlike BOM-less UTF-8).<br />
                <br />
                To use this information efficiently, MakeNSISW should be able to perform this check (not only the actual MakeNSIS command-line compiler), and the command-line compiler should have a parameter to tell it the codepage in advance (or, at the very least, a parameter that tells it to skip the "valid UTF-8" check if no BOM is present). The parameter would probably be a good idea anyway, as it would more easily allow for a "Always assume UTF-8 if encoding unknown" option in MakeNSISW.</p>
              </div>
              <hr />

              <div class="post">
                <p class="post-meta"><span class="post-author text-primary">jimpark</span><br />
                <span class="post-time small text-muted">9th January 2009 15:50 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                <p class="post-content">Well, there is no BOM for ANSI. There never has been and never will be. Basically, what we can do is make Unicode NSIS never work with ANSI with the exception of ASCII only scripts. If there is no BOM, assume UTF-8. If there is a BOM, assume UTF-16. This is the only other option in my mind.</p>
              </div>
              <hr />

              <div class="post">
                <p class="post-meta"><span class="post-author text-primary">Anders</span><br />
                <span class="post-time small text-muted">9th January 2009 19:25 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                <p class="post-content">Older unix tools might not support BOM for UTF-8, but that's not our problem ;)<br />
                <br />
                If you really want UTF-8 without BOM, maybe makensis could check the first line for a comment like #NSIS: encoding=UTF-8</p>
              </div>
              <hr />

              <div class="post">
                <p class="post-meta"><span class="post-author text-primary">jimpark</span><br />
                <span class="post-time small text-muted">9th January 2009 19:31 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                <p class="post-content">Well, my guess is, if they don't like putting 3 bytes in front of their file, they will like having to put "#NSIS: encoding=UTF-8" even less.</p>
              </div>
              <hr />

              <div class="post">
                <p class="post-meta"><span class="post-author text-primary">Anders</span><br />
                <span class="post-time small text-muted">9th January 2009 19:35 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                <p class="post-content">but the header is just ascii text that any editor can write, you don't need any special support</p>
              </div>
              <hr />

              <div class="post">
                <p class="post-meta"><span class="post-author text-primary">jimpark</span><br />
                <span class="post-time small text-muted">9th January 2009 20:18 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                <p class="post-content">I think a lot of these guys are scripting their NSI files and so it's not a big deal to emit three bytes at the front. If they are writing their scripts via a text editor, they may be able to simply save as UTF-8 and it may embed the BOM for them (e.g. notepad.exe does). Or they may have a way to type hex codes: EF BB BF (decimal: 239 187 191). For example in vim, I just do this command:<br />
                <br /></p>
                <pre>
<code><br />:dig b: 239 o: 187 m: 191<br /></code>
</pre><br />
                <br />
                And then I hit 'i' to insert text and type their ctrl-k b: ctrl-k o: ctrl-k m:. And there I have it.<br />
                <br />
                Or paste this guy: Ã¯Â»Â¿
              </div>
              <hr />

              <div class="post">
                <p class="post-meta"><span class="post-author text-primary">Pidgeot</span><br />
                <span class="post-time small text-muted">9th January 2009 20:28 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                <p class="post-content">Long post ahead...<br />
                <br /></p>

                <blockquote>
                  <i>Originally posted by jimpark</i><br />
                  <b>Well, there is no BOM for ANSI. There never has been and never will be.</b>
                </blockquote>Well, no, but there doesn't need to be. I've yet to encounter an ANSI file (with characters &gt; 128) that could be mistaken for a BOM-less UTF-8 file, because the odds of an ANSI file not containing any invalid UTF-8 character sequences are astronomically low, due to the way UTF-8 works on a byte level: not only do all bytes &gt; 128 have to be placed together, but all bytes in the range 128-192 must be after a valid lead byte (194-244), and there has to be a very specific amount of high bytes following - it can be expressed as a very simple state machine that checks each byte (worst case executions-wise is that the file is UTF-8, so we end up running through the entire file, but even so, that process shouldn't take more than a second).<br />
                <br />
                That's why I prefer not having to choose between "allow ANSI, but require UTF-8 BOM" or "disallow ANSI, always assume UTF-8", instead getting the best of both worlds by checking for UTF-8 validity if there is room for doubt: it generates the highest possible amount of backward compatibility, while still allowing people to save their UTF-8 the same way they've always been doing (That doesn't mean we can't issues a warning or something if they use an ANSI file, but that's still a hell of a lot better than temporarily breaking all existing scripts by forcing a conversion). Yes, it requires a bit of extra work to read the file into memory and checking it before starting the compilation, but I think the value in that feature would be pretty great compared to the time it takes to develop it. (Of course, that's easy for me to say, since I'm not likely to be the one programming it. :p )<br />
                <br />

                <blockquote>
                  <b>Basically, what we can do is make Unicode NSIS never work with ANSI with the exception of ASCII only scripts.</b>
                </blockquote>I'd certainly prefer this to not supporting BOM-less UTF-8 (partially because I no longer use Notepad for editing scripts, but gVim, and having to remember to add the BOM will be a pain - particularly since not getting these useless BOMs is one of the reasons I switched), but see above.<br />
                <br />

                <blockquote>
                  <b>If there is no BOM, assume UTF-8. If there is a BOM, assume UTF-16.</b>
                </blockquote>I assume you mean "If there is a UTF-16 BOM". ;)<br />
                <br />

                <blockquote>
                  <b>This is the only other option in my mind.</b>
                </blockquote>

                <blockquote>
                  <i>Originally posted by Anders</i><br />
                  <b>Older unix tools might not support BOM for UTF-8, but that's not our problem ;)</b>
                </blockquote>Except NSIS can do cross-compilation on *NIX systems and, to the best of my knowledge, most *NIX editors don't place a BOM unless explicitly told to (the only advantage is for identification, and most Unicode-aware tools try UTF-8 anyway, so no real benefit is observed).<br />
                <br />
                Forcing people to do this also means forcing them to change their usual editing routines beyond just having to select a different encoding - they need to know "does my editor add a BOM" (and how they can add it if it doesn't), and I think that could potentially put some people off from going with Unicode NSIS.<br />
                <br />

                <blockquote>
                  <b>If you really want UTF-8 without BOM, maybe makensis could check the first line for a comment like #NSIS: encoding=UTF-8</b>
                </blockquote>It's not really logical to have to force a Unicode-aware application to use Unicode like this. You don't have to use files with signatures for Notepad to recognize UTF-8, to give an example.<br />
                <br />
                This sort of thing could be more useful if extended to allow specifying non-Unicode code pages, such as sjis or big5, in which case Unicode NSIS would convert from that particular codepage, since that would allow Unicode NSIS compilation of an ANSI script on a random system - but I'm not convinced this is a relevant feature for very many people.<br />
                <br />

                <blockquote>
                  <i>Originally posted by jimpark</i><br />
                  <b>For example in vim, I just do this command: &lt;snip&gt;</b>
                </blockquote>Just a comment on this: check out :h bomb.<br />
                <br />

                <blockquote>
                  <b>Or paste this guy: Ã¯Â»Â¿</b>
                </blockquote>If you use the same codepage as Jim, that is. ;)
              </div>
              <hr />

              <div class="post">
                <p class="post-meta"><span class="post-author text-primary">jimpark</span><br />
                <span class="post-time small text-muted">9th January 2009 20:52 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                <p class="post-content"></p>

                <blockquote>
                  Just a comment on this: check out :h bomb.
                </blockquote>Wow. I did not know that. Very cool. Vim rocks. Now, is there a universal font that is available in Vim that can work on a lot of different scripts? For example, I'd love to see Arial Unicode work for me but I can't seem to choose that font for my guifontwide setting. Is there a font like that out there that I can download and have it work for Vim or somehow get Arial Unicode to work?<br />
                <br />

                <blockquote>
                  If you use the same codepage as Jim, that is. ;)
                </blockquote>True but everyone should have Latin-1 as their codepage! What else could we possibly need? :p
              </div>
              <hr />

              <div class="post">
                <p class="post-meta"><span class="post-author text-primary">Pidgeot</span><br />
                <span class="post-time small text-muted">9th January 2009 21:29 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                <p class="post-content"></p>

                <blockquote>
                  <i>Originally posted by jimpark</i><br />
                  <b>Wow. I did not know that. Very cool. Vim rocks. Now, is there a universal font that is available in Vim that can work on a lot of different scripts? For example, I'd love to see Arial Unicode work for me but I can't seem to choose that font for my guifontwide setting. Is there a font like that out there that I can download and have it work for Vim or somehow get Arial Unicode to work?</b>
                </blockquote>The help file states that all GUI versions of Vim, with the sole exception of the GTK2 version (you might be able to compile a GTK2 version for yourself and use that, but even there), only allows monospaced fonts. Personally, since my editing is pretty much restricted to Danish, English and Japanese, I use MS Gothic: it contains all the characters I need (although not all of the non-CJK characters are particularly pretty). A Chinese font like SimHei would probably give better Kanji/Hanzi support, though, since the Chinese use a much larger set of characters (I haven't tested this, though...)<br />
                <br />
                We're getting pretty off-topic, though, so let's try to get back to NSIS... :blah:
              </div>
              <hr />

              <div class="post">
                <p class="post-meta"><span class="post-author text-primary">ehsanakhgari</span><br />
                <span class="post-time small text-muted">9th January 2009 23:29 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                <p class="post-content"><strong>Problem with non-Unicode InstallerOptions INI files</strong><br />
                Another problem which we are facing in order to use Unicode NSIS in Mozilla is about InstallOptions INI files. We use WriteINIStr, which seems to write the INI file as ANSI and convert to a Windows codepage on the fly.<br />
                <br />
                Is there any way to write Unicode INI files from within the Unicode NSIS, or any other similar effects? Without this, our custom installer pages will not benefit from being Unicode...<br />
                <br />
                Thanks!<br />
                Ehsan</p>
              </div>
              <hr />

              <div class="post">
                <p class="post-meta"><span class="post-author text-primary">Anders</span><br />
                <span class="post-time small text-muted">10th January 2009 00:32 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                <p class="post-content">Your best bet is to move to nsDialogs<br />
                <br />
                IIRC, NT will write unicode ini files if the .ini already has a UTF-16LE BOM</p>
              </div>
              <hr />

              <div class="post">
                <p class="post-meta"><span class="post-author text-primary">Anders</span><br />
                <span class="post-time small text-muted">10th January 2009 00:38 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                <p class="post-content"><a href="http://blogs.msdn.com/michkap/archive/2006/09/15/754992.aspx" target="_blank">http://blogs.msdn.com/michkap/archiv...15/754992.aspx</a><br />
                <br />
                ..so I guess you can use the nsis FileOpen/FileWriteByte commands to write the unicode BOM before you use the ini functions</p>
              </div>
              <hr />

              <div class="post">
                <p class="post-meta"><span class="post-author text-primary">jimpark</span><br />
                <span class="post-time small text-muted">10th January 2009 02:21 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                <p class="post-content">Well, it actually wouldn't be too hard to support WriteINIStrUTF16LE. And after thinking about Pidgeot's idea, and taking a moment to write the ValidateUTF8 function myself, I think it's probably best to not require a UTF-8 BOM. I'm starting to see a potential for 2.42.2 already.</p>
              </div>
              <hr />

              <div class="post">
                <p class="post-meta"><span class="post-author text-primary">jimpark</span><br />
                <span class="post-time small text-muted">10th January 2009 02:43 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                <p class="post-content">I wonder if I shouldn't just make the INI files it generates as UTF-16LE instead of creating a new function. I think Windows supports INI files as UTF-16LE with no problems.</p>
              </div>
              <hr />

              <div class="post">
                <p class="post-meta"><span class="post-author text-primary">jimpark</span><br />
                <span class="post-time small text-muted">10th January 2009 03:32 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                <p class="post-content">I dug a little deeper about WriteINIStr and this is what I found.<br />
                <br />
                WriteINIStr uses WritePrivateProfileString() in kernel32.lib. If you look at the documentation for this function it states: "If the file was created using Unicode characters, the function writes Unicode characters to the file. Otherwise, the function writes ANSI characters."</p>
              </div>
              <hr />

              <div class="post">
                <p class="post-meta"><span class="post-author text-primary">Anders</span><br />
                <span class="post-time small text-muted">10th January 2009 04:56 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                <p class="post-content">did I not already say this?</p>
              </div>
              <hr />

              <div class="post">
                <p class="post-meta"><span class="post-author text-primary">jimpark</span><br />
                <span class="post-time small text-muted">10th January 2009 10:54 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                <p class="post-content">You may have. This thread is long and my memory is short. Ah, I see your post now. I just missed it.</p>
              </div>
              <hr />

              <div class="post">
                <p class="post-meta"><span class="post-author text-primary">jimpark</span><br />
                <span class="post-time small text-muted">13th January 2009 04:34 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                <p class="post-content">I've semi-secretly released a prototype to 2.42.2 which can read UTF-8 NSI files. It does not require a UTF-8 BOM. If it finds a BOM in the beginning of the file, it uses the BOM as a cue to how to read the file. If it does not find a BOM, it checks the file to see if it looks like a valid UTF-8 file. If it's valid UTF-8, the file is read as UTF-8 and internally converted to UTF-16LE so that it can call the Win32 API. If it does not have a BOM and it does not validate as UTF-8, then it is opened as ANSI. But if this latter thing happens, anything that is &gt; 0x7f probably gets converted to question marks.<br />
                <br />
                <a href="http://www.scratchpaper.com/nsis-2.42.2-Unicode-setup.exe" target="_blank">http://www.scratchpaper.com/nsis-2.4...code-setup.exe</a><br />
                <br />
                So basically this version of NSIS officially supports:<br />
                UTF-8<br />
                UTF-16LE<br />
                <br />
                It may work with UTF-16BE with the BOM (I'm relying on Microsoft on this one). But it does not work with UTF-32 of any endian flavor. Not sure there's a big demand for it anyway.<br />
                <br />
                Let me know if you run into any problems. If it looks solid, I will release it to the general public some time next week or so.</p>
              </div>
              <hr />

              <div class="post">
                <p class="post-meta"><span class="post-author text-primary">pabs</span><br />
                <span class="post-time small text-muted">14th January 2009 02:25 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                <p class="post-content">Now that it can use UTF-8, wouldn't it be best to use that everywhere instead of having ANSI and Unicode versions of almost every file? If so, please be sure to strip the BOM character from the beginning of each UTF-8 file.<br />
                <br />
                ${NSIS_CHAR_SIZE} sounds like a bad idea, nsis shouldn't assume any specific size for characters - each character in UTF-8 can be multiple bytes long and same for UTF-16, that can have characters that are more than two bytes long. Only UCS-2 and UTF-32 have constant-sized characters.</p>
              </div>
              <hr />

              <div class="post">
                <p class="post-meta"><span class="post-author text-primary">Anders</span><br />
                <span class="post-time small text-muted">14th January 2009 03:47 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                <p class="post-content">you are missing the point with NSIS_CHAR_SIZE, some windows api structures have hardcoded buffer sizes (GetVersionEx etc.)</p>
              </div>
              <hr />

              <div class="post">
                <p class="post-meta"><span class="post-author text-primary">jimpark</span><br />
                <span class="post-time small text-muted">14th January 2009 03:50 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                <p class="post-content">Pabs, NSIS_CHAR_SIZE is the internal char size representation. You absolutely need it. Unicode NSIS does NOT internally store things as UTF-8. It can read UTF-8 files but internally it works with strings as UTF-16LE which is the native Windows encoding of Unicode.<br />
                <br />
                Also UTF-8 is not a superset of ANSI. UTF-8 is a superset of ASCII but as soon as you hit codepages, UTF-8 and ANSI are foreign to each other. So anything with localizations cannot be shared. But a lot of the NSH files and samples CAN be reduced. You still have to read the code <i>very carefully</i> to see if they are strictly the same. If it uses the System plugin, for example, the strings you allocate needs to be adjusted for Unicode vs. ANSI. Unicode should be double the width. They must call the appropriate API -- the wide versions vs. ANSI. They must use the right messages -- sometimes there are two messages with the same #macro but different values for ANSI and Unicode because one message ID returns ANSI string values while the other returns UTF-16LE values. Using things like System::StrAlloc, ${NSIS_CHAR_SIZE}, and ${NSIS_UNICODE} can help you write code that will port easily between the ANSI and Unicode NSIS but it will require quite a bit of care to make sure it is done right.<br />
                <br />
                Here's an example where it's not so simple to share the same code for both Unicode and ANSI NSIS.<br />
                <br />
                <a href="http://forums.winamp.com/showthread.php?s=&amp;threadid=300271" target="_blank">http://forums.winamp.com/showthread....hreadid=300271</a><br />
                <br />
                Albeit, if you do the basic stuff only in your installer, you probably won't see these kinds of problems and keeping your installer just UTF-8 may be quite doable. (If you don't have any localized strings in the NSI script and rely solely on the Language Files distributed by NSIS, then even non-Latin installer may be able to go this route.)<br />
                <br />
                If you really want to give it a try, please feel free. One thing I've noted is that the further you stray from the trunk, the harder it is to merge the changes for each release.<br />
                <br />
                BTW, I definitely appreciate any help I can get. So I do value your input (and enthusiasm).</p>
              </div>
              <hr />

              <div class="post">
                <p class="post-meta"><span class="post-author text-primary">pabs</span><br />
                <span class="post-time small text-muted">15th January 2009 04:22 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                <p class="post-content">OK, fair enough on the size thing.<br />
                <br />
                Are there any changes that can be merged now? Perhaps the conversion of the plugins/makensisw/etc to TCHAR instead of char?<br />
                <br />
                Is there a need to duplicate the .nsh, .nlf etc files? This creates a maintenance headache IMO.<br />
                <br />
                For example, the Unicode/ANSI versions of COPYING and nsisconf.nsh are identical after conversion to UTF-8. Same for the following directories containing Unicode &amp; ANSI versions: Contrib/zip2exe/ Contrib/InstallOptions/ Contrib/Splash/ Contrib/Banner/ Contrib/AdvSplash/ Contrib/BgImage/ Contrib/VPatch/ Contrib/Modern UI/ Contrib/MultiUser/ Contrib/UserInfo/ Contrib/StartMenu/ Contrib/nsDialogs/ Contrib/Modern UI 2/.<br />
                <br />
                I think it would be best to have one version of them (encoded in UTF-8 for compatibility with legacy text editors and Unix tools).<br />
                <br />
                The differences due to System::Call or structure/string sizes can be wrapped in !if ${NSIS_UNICODE} or similar.<br />
                <br />
                makensis can be made to convert .nlf &amp; .nsh strings to ANSI/UTF-16LE at runtime.<br />
                <br />
                Not sure how to deal with the Contrib/UIs/ differences, presumably you could set the class to RichEdit20, use a define of some sort or makensis could set the class at installer creation time.<br />
                <br />
                I think the differences in due to registry key names and stuff are gratuitous and not necessary.</p>
              </div>
              <hr />

              <div class="post">
                <p class="post-meta"><span class="post-author text-primary">jimpark</span><br />
                <span class="post-time small text-muted">15th January 2009 04:35 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                <p class="post-content">I agree with you Pabs. I'd like to see that done as well. When they are the same, we should keep them the same. Only fork them if they need to be different like the Language Files.<br />
                <br />
                One thing about the !if ${NSIS_UNICODE} checks are that I'm afraid it might unnecessarily make the scripts harder to read. I know I hate it when I see a lot of #ifdef's in the C/C++ code. Also, the !if ${NSIS_UNICODE} checks may bloat the resulting installer with extra code as well. I'm not sure I like that.<br />
                <br />
                As for the NSIS source code, I'd still like to be able to generate both the Unicode and ANSI builds of NSIS until everyone decides that ANSI is dead. Then we can do what the guys at PortableApps are thinking [1] -- eventually, wrap up a final build of ANSI NSIS for those writing installers for legacy systems and continue on with Unicode only. :)<br />
                <br />
                [1] <a href="http://portableapps.com/node/17291" target="_blank">http://portableapps.com/node/17291</a></p>
              </div>
              <hr />

              <div class="post">
                <p class="post-meta"><span class="post-author text-primary">pabs</span><br />
                <span class="post-time small text-muted">19th January 2009 12:36 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                <p class="post-content">I was under the impression that !if was an installer-build-time statement like #ifdef in C, if it isn't, I mean whatever is available for installer-build-time statement conditionals.</p>
              </div>
              <hr />

              <div class="post">
                <p class="post-meta"><span class="post-author text-primary">pabs</span><br />
                <span class="post-time small text-muted">21st January 2009 23:52 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                <p class="post-content">Looking at the documentation, !if and !ifdef are exactly what is needed; they are conditional compilation, the ignored bits don't end up in the executable.<br />
                <br />
                There aren't that many differences between the Unicode and ANSI examples and include files in the Unicode NSIS for you to be worried about making them harder to read.</p>
              </div>
              <hr />

              <div class="post">
                <p class="post-meta"><span class="post-author text-primary">30er</span><br />
                <span class="post-time small text-muted">22nd January 2009 14:22 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                <p class="post-content"><strong>UAC + Unicodebuilt</strong><br />
                Hi<br />
                <br />
                its my first post here ;)<br />
                <br />
                Anders + jimpark<br />
                <br />
                you did both a great job ;)<br />
                <br />
                BUUUUUUUUUUUUUT<br />
                <br />
                i use Anders UAC plugin together with your unicode nsis<br />
                <br />
                with the ANSI build everything works<br />
                <br />
                but in unicode mode...<br />
                <b>during install for all users:</b><br />
                ${UAC.RunElevatedAndProcessMessages}<br />
                only opens an adminpassworddialog at first run of the setup :(<br />
                <br />
                if u start the setup again for all users u wont see that dialog anymore :(<br />
                <br />
                <br />
                <br />
                <b>next problem is:</b><br />
                if i call the uninstaller from the unicodebuild this line makes troubles:<br />
                ${UAC.U.Elevate.AdminOnly} "${UNINSTALLER_NAME}"<br />
                <br />
                error pops up:<br />
                <b>unable to elevate, error 05536</b><br />
                <br />
                <br />
                hope u can help me :(<br />
                <br />
                ty<br />
                <br />
                <br />
                <b>Software:</b><br />
                OS: XP Pro<br />
                NSIS: 2.42.1 ANSI + UNICODE (jimpark)<br />
                UAC: v0.0.10a - 20081004 (Anders)</p>
              </div>
              <hr />

              <div class="post">
                <p class="post-meta"><span class="post-author text-primary">Anders</span><br />
                <span class="post-time small text-muted">22nd January 2009 21:34 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                <p class="post-content">"if u start the setup again for all users u wont see that dialog anymore" does not make any sense, the UAC plugin does not save any state, so it should work the same every time. Can you explain what you mean by "for all users"?<br />
                <br />
                Could you post a minimal example script with these problems?</p>
              </div>
              <hr />

              <div class="post">
                <p class="post-meta"><span class="post-author text-primary">30er</span><br />
                <span class="post-time small text-muted">23rd January 2009 08:54 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                <p class="post-content">Quote:</p>
                <hr />
                I took your UAC RealWorld example script<br />
                there u show a dialog where u can choose between single user and ALL USER installation<br />
                <br />
                All user means -&gt; NEED ADMIN RIGHTS<br />
                <br />
                if a normal user choose that<br />
                the admin PWD dialog pops up<br />
                <br />
                if i try this with ANSI build everything works<br />
                I can start the setup as often as i want and i get allways this ADMINPWD dialog<br />
                <br />
                if i try the same script build with the UNICODE NSIS<br />
                the dialog will only be showen at first start :(<br />
                <br />
                UAC::IsAdmin returns $0 &gt;=1<br />
                if i run it as normal user!<br />
                <br />
                thats the strange thing for the installation<br />
                <br />
                maybe you can contact me in skype<br />
                <b>ing30er</b><br />
                <br />
                than i can show u my script

                <table cellpadding="6" cellspacing="0" border="0" width="100%">
                  <tr>
                    <td class="alt2">
                      <hr />
                      <i>Originally posted by Anders</i><br />
                      <b>"if u start the setup again for all users u wont see that dialog anymore" does not make any sense, the UAC plugin does not save any state, so it should work the same every time. Can you explain what you mean by "for all users"?<br />
                      <br />
                      Could you post a minimal example script with these problems?</b>
                      <hr />
                    </td>
                  </tr>
                </table><br />
                <!-- Bootstrap core CSS -->
                 <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
                 <!--[if lt IE 9]>
                <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
                <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->

                <div class="container">
                  <!-- Put navigation bar here -->

                  <ol class="breadcrumb">
                    <li><a href="../index.html" class="glyphicon glyphicon-home"></a></li>

                    <li><a href="f-65.html">NSIS Discussion</a></li>

                    <li class="active">Unicode</li>
                  </ol>

                  <p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=277381">Unicode</a></p><br />

                  <div class="post">
                    <p class="post-meta"><span class="post-author text-primary">jimpark</span><br />
                    <span class="post-time small text-muted">23rd January 2009 15:09 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                    <p class="post-content">I only see one version of the UAC.dll in the UAC plugin package. UAC will need to be built linking to the Unicode NSIS library using the Unicode string NSIS stack.</p>
                  </div>
                  <hr />

                  <div class="post">
                    <p class="post-meta"><span class="post-author text-primary">Anders</span><br />
                    <span class="post-time small text-muted">23rd January 2009 23:58 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                    <p class="post-content">v0.0.10a is not the latest version (and like Jim said, you need to recompile for use with nsis unicode)<br />
                    <br />
                    I just tested the UAC RealWorld example and it worked fine (XP SP2 (non admin), NSISU 2.42.1)</p>
                  </div>
                  <hr />

                  <div class="post">
                    <p class="post-meta"><span class="post-author text-primary">30er</span><br />
                    <span class="post-time small text-muted">26th January 2009 08:25 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                    <p class="post-content">....nsis.sourceforge.net/UAC_plug-in....<br />
                    <br />
                    i see u updated that page anders ;)<br />
                    <br />
                    last week it showed v0.0.10a ;)<br />
                    <br />
                    can u tell me how i can convert your UAC.dll to unicode build?<br />
                    <br />
                    sorry im noob in building dlls :(<br />
                    <br />
                    would be nice if u can put both dlls in your UAC.zip <b>Anders</b><br />
                    <br />
                    or offer a unicode version<br />
                    <br />
                    that would be veeeeeeeeeeeeeeeery nice :)</p>
                  </div>
                  <hr />

                  <div class="post">
                    <p class="post-meta"><span class="post-author text-primary">Anders</span><br />
                    <span class="post-time small text-muted">26th January 2009 08:36 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                    <p class="post-content">yeah I updated the page, but v0.0.11 has been on stashbox for months. To build the unicode version, just make sure UNICODE is defined (remove the comment in uac.h, or set the define in the project options)<br />
                    <br />
                    I am planning to include the unicode version in the "official" package, I just need to automate the build</p>
                  </div>
                  <hr />

                  <div class="post">
                    <p class="post-meta"><span class="post-author text-primary">30er</span><br />
                    <span class="post-time small text-muted">27th January 2009 08:50 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                    <p class="post-content">ok thx for your help<br />
                    <br />
                    pls tell us than if u have done your new release with the unicode build included ;)</p>
                  </div>
                  <hr />

                  <div class="post">
                    <p class="post-meta"><span class="post-author text-primary">jimpark</span><br />
                    <span class="post-time small text-muted">29th January 2009 22:53 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                    <p class="post-content">I just released 2.42.3 which has support for UTF-8 with and without a BOM for all the NSI, NSH, and license files. Enjoy.</p>
                  </div>
                  <hr />

                  <div class="post">
                    <p class="post-meta"><span class="post-author text-primary">pabs</span><br />
                    <span class="post-time small text-muted">1st February 2009 01:47 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                    <p class="post-content">What variable should be used in the .nsi/.nsh files? !ifdef NSIS_UNICODE? I'd like to commit the needed changes to the .nsh files that need to be different between Unicode and ANSI builds.<br />
                    <br />
                    PS: could you please post future versions as a patch against latest SVN rather than against the latest release?</p>
                  </div>
                  <hr />

                  <div class="post">
                    <p class="post-meta"><span class="post-author text-primary">pabs</span><br />
                    <span class="post-time small text-muted">1st February 2009 08:53 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                    <p class="post-content">I also think that the changes to the plugins and makensisw code could be committed now since we don't yet compile with _UNICODE defined. Would that be OK kichik?<br />
                    <br />
                    I note you use nsis_tchar.h instead of the Win32 tchar.h, why is that?<br />
                    <br />
                    No need to add your name to every file, just credits.but is enough.<br />
                    <br />
                    I notice you add some function documentation, please split stuff unrelated to the Unicode changes into other patches, so we can commit them earlier.<br />
                    <br />
                    In some cases you comment out string definitions or code and add new ones afterwards, please just replace the old ones with new ones.<br />
                    <br />
                    Please remove the ANSI/Unicode dirs and convert the files in the Unicode ones to UTF-8 without a BOM and have them replace the current ANSI files. Please also remove the related changes to the SConsripts.<br />
                    <br />
                    I'm unsure about the changes to the cross-platform tools, on Linux at least, we just use UTF-8 everywhere.<br />
                    <br />
                    Please don't refactor functions or add comments in the Unicode patch, but instead create a separate patch so we can commit that earlier.<br />
                    <br />
                    Best to not remove existing comments or change whitespace either, thats another change that is unrelated to the Unicode stuff.<br />
                    <br />
                    TypeLib.cpp seems to use PopStringW, doesn't it need to work in ANSI mode too?<br />
                    <br />
                    Don't need to add comments like // reviewed for unicode support.<br />
                    <br />
                    Don't need to add .aps files, ascii2utf16.py, Visual Studio 2008 directory, create_header.py, header-unicode.pdn, *.bat, zipsource.pl, modify_copyright.pl etc<br />
                    <br />
                    Docs don't need to link to the unicode-nsis website.<br />
                    <br />
                    s/th ANSI/the ANSI/ in intro.but<br />
                    <br />
                    history.but doesn't need to be changed.<br />
                    <br />
                    Scons directory should be named SCons.<br />
                    <br />
                    Why the MSVS_VERSION change in mstoolkit.py?<br />
                    <br />
                    2.42.3 fails to build under Debian, some of the errors:<br />
                    <br /></p>
                    <pre>
<code><br />Using GNU tools configuration<br />In file included from Contrib/Library/LibraryLocal/LibraryLocal.cpp:11:<br />Contrib/Library/LibraryLocal/../../../Source/tstring.h:24:21: error: windows.h: No such file or directory<br />In file included from Contrib/Library/LibraryLocal/LibraryLocal.cpp:10:<br />Contrib/Library/LibraryLocal/../../../Source/Platform.h:692: error: 'TCHAR' does not name a type<br />scons: *** [build/debug/Library/LibraryLocal/LibraryLocal.o] Error 1<br /></code>
</pre><br />
                    <br />
                    <pre>
<code><br />In file included from Source/manifest.h:22,<br />                 from Source/build.h:30,<br />                 from Source/build.cpp:26:<br />Source/tstring.h:24:21: error: windows.h: No such file or directory<br />In file included from Source/build.h:22,<br />                 from Source/build.cpp:26:<br />Source/strlist.h: In member function 'int SortedStringListND&lt;T&gt;::find(const TCHAR*, int, int, int, int*)':<br />Source/strlist.h:377: error: there are no arguments to '_stricmp' that depend on a template parameter, so a declaration of '_stricmp' must be available<br />Source/strlist.h:377: error: (if you use '-fpermissive', G++ will accept your code, but allowing the use of an undeclared name is deprecated)<br />Source/strlist.h:385: error: there are no arguments to '_strnicmp' that depend on a template parameter, so a declaration of '_strnicmp' must be available<br />In file included from Source/build.cpp:26:<br />Source/build.h: At global scope:<br />Source/build.h:99: error: 'TEXT' was not declared in this scope<br />Source/build.cpp: In member function 'int CEXEBuild::add_string(const TCHAR*, int, WORD)':<br />Source/build.cpp:461: error: '_strdup' was not declared in this scope<br />Source/build.cpp: In member function 'int CEXEBuild::preprocess_string(TCHAR*, const TCHAR*, WORD)':<br />Source/build.cpp:606: error: '_strdup' was not declared in this scope<br />Source/build.cpp:615: warning: suggest parentheses around + or - in operand of &amp;<br />Source/build.cpp:615: warning: suggest parentheses around + or - in operand of &amp;<br />Source/build.cpp:647: error: '_strdup' was not declared in this scope<br />Source/build.cpp: In member function 'int CEXEBuild::add_label(const TCHAR*)':<br />Source/build.cpp:963: error: '_strdup' was not declared in this scope<br />Source/build.cpp: In member function 'int CEXEBuild::add_function(const TCHAR*)':<br />Source/build.cpp:1025: error: '_strnicmp' was not declared in this scope<br />Source/build.cpp: In member function 'int CEXEBuild::add_section(const TCHAR*, const TCHAR*, int)':<br />Source/build.cpp:1181: error: '_strnicmp' was not declared in this scope<br />Source/build.cpp:1187: error: '_stricmp' was not declared in this scope<br />Source/build.cpp: In member function 'void CEXEBuild::warning(const TCHAR*, ...)':<br />Source/build.cpp:3253: error: '_vsnprintf' was not declared in this scope<br />Source/build.cpp: In member function 'void CEXEBuild::warning_fl(const TCHAR*, ...)':<br />Source/build.cpp:3274: error: '_vsnprintf' was not declared in this scope<br />Source/build.cpp: In member function 'void CEXEBuild::ERROR_MSG(const TCHAR*, ...) const':<br />Source/build.cpp:3298: error: '_vsnprintf' was not declared in this scope<br />Source/strlist.h: In member function 'int SortedStringListND&lt;T&gt;::find(const TCHAR*, int, int, int, int*) [with T = uservarstring]':<br />Source/uservars.h:76:   instantiated from here<br />Source/strlist.h:377: error: '_stricmp' was not declared in this scope<br />Source/strlist.h:385: error: '_strnicmp' was not declared in this scope<br />scons: *** [build/debug/makensis/build.o] Error 1<br /></code>
</pre>
                  </div>
                  <hr />

                  <div class="post">
                    <p class="post-meta"><span class="post-author text-primary">jimpark</span><br />
                    <span class="post-time small text-muted">2nd February 2009 11:26 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                    <p class="post-content">Pabs, I can see how without knowing the motivations for the changes I made, you might think I'm an ego maniac. For example:<br />
                    <br /></p>

                    <blockquote>
                      No need to add your name to every file, just credits.but is enough.
                    </blockquote>

                    <blockquote>
                      Don't need to add comments like // reviewed for unicode support.
                    </blockquote>I used a Perl script to keep status on what files I've modified and which ones still need to be reviewed. That string with my name in it is what the script looks for -- it was my own sign off that the file was finished. It was natural to use my name in such a comment. Those comments are still useful for me. I'm not removing the comments. But when they get into the official release, feel free to purge the comments.<br />
                    <br />

                    <blockquote>
                      Don't need to add .aps files, ascii2utf16.py, Visual Studio 2008 directory, create_header.py, header-unicode.pdn, *.bat, zipsource.pl, modify_copyright.pl etc
                    </blockquote>They are useful for me. Most of these scripts are helper scripts. If they are not useful for you, don't include them in your build.<br />
                    <br />

                    <blockquote>
                      Docs don't need to link to the unicode-nsis website.
                    </blockquote>If my stuff doesn't link to the unicode-nsis website, what will? My site is the only place to get the Unicode source and build at the moment.<br />
                    <br />

                    <blockquote>
                      history.but doesn't need to be changed.
                    </blockquote>Ah, but it should have been changed even more. It should be kept up to date with all the changes I've made and features I've added on top of what's happened in the official build. I've just been too lazy to keep it up to date.<br />
                    <br />

                    <blockquote>
                      Best to not remove existing comments or change whitespace either, thats another change that is unrelated to the Unicode stuff.
                    </blockquote>I found that the files were inconsistent. Some were saved as DOS text files, others Unix style files. Same with white space. I just made them consistent because I use one text editor and me touching the file made the diffs too different. Again, it's a change I made to make updating the build with the changes of the official release easier.<br />
                    <br />

                    <blockquote>
                      Please don't refactor functions or add comments in the Unicode patch, but instead create a separate patch so we can commit that earlier.
                    </blockquote>You are just teasing me with future promises. :) I refactor when my engineering sensibilities says I should. (It's probably what happens when you work on something by yourself for 2 years.) Personally, I think more refactoring and restructuring would do the source code good. But again, I do this so it would help me to continue to update the build.<br />
                    <br />

                    <blockquote>
                      Why the MSVS_VERSION change in mstoolkit.py?
                    </blockquote>I made the change to be able to build on MSVS 2005 and later MSVS 2008.<br />
                    <br />

                    <blockquote>
                      2.42.3 fails to build under Debian, some of the errors:
                    </blockquote>Sorry, I don't cross build on Debian. It's difficult enough to get this working on MSVS and update the code every release all by myself. So if you'd like to figure it out and let me know what needs to be changed, I'd appreciate it.
                  </div>
                  <hr />

                  <div class="post">
                    <p class="post-meta"><span class="post-author text-primary">DrO</span><br />
                    <span class="post-time small text-muted">2nd February 2009 13:10 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                    <p class="post-content">having been reading through this thread for some time, have to say that how jim is running the unicode package pretty much works fine as far as end-users are concerned and that really is the main thing overall. yes it'd be nice as pabs says to have patches, etc but considering the work done and other things that need to be changed there's not much point until it is decided for definite how things are going to go as an official unicode nsis package.<br />
                    <br />
                    with the thing about refactoring, i know kichik has done loads of that over the process of the nsis project so there's no real issue with it being done in a branched version of the code (as this ultimately is) and is no more different than the noobjs branch or the one justin did a few months back - is good to try things out especially in a side-project before/if it is rolled out into the main distro.<br />
                    <br />
                    -daz</p>
                  </div>
                  <hr />

                  <div class="post">
                    <p class="post-meta"><span class="post-author text-primary">pabs</span><br />
                    <span class="post-time small text-muted">2nd February 2009 15:25 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                    <p class="post-content">The list was merely a bunch of things I thought that should be changed before including the Unicode stuff in trunk and releasing it as part of NSIS officially. I do understand you made those changes because they were useful as part of a separate branch though. I certainly didn't take you for an ego maniac Jim :)<br />
                    <br />
                    I'd like to start the merge of the patch with the changes to the plugins, then some of the changes to the include scripts and examples. These changes should have zero impact on the current ANSI version of NSIS (because _UNICODE isn't defined anywhere yet) and will make the diff afterwards much smaller and easier to review. I'd like to hear some devs opinions on that first though, kichik, anders etc?<br />
                    <br />
                    After that, I'm not sure what was decided what the Unicode support should look like.<br />
                    <br />
                    The Debian build failure looks like some of the cross-platform code is trying to include windows.h through tchar.h/tstring.h, which obviously fails on non-Windows platforms. Not sure where to start on fixing that though.</p>
                  </div>
                  <hr />

                  <div class="post">
                    <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
                    <span class="post-time small text-muted">2nd February 2009 23:42 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                    <p class="post-content">My offer of developing this as a branch on the main SVN still stands. This will allow for better logging so there will not be any need for comments on changed code. It will also be much easier to back port refactored code to trunk.<br />
                    <br />
                    As for modifying code in the plug-ins that won't affect the ANSI build, I wanted to keep that for later because I feel we're going to need some kind of nchar_t, at the very least in makensis, so it'd all go smoothly on all four flavors of win32/posix and ansi/unicode mix. Paul's problems with tchar.h are part of what I want to avoid.</p>
                  </div>
                  <hr />

                  <div class="post">
                    <p class="post-meta"><span class="post-author text-primary">jimpark</span><br />
                    <span class="post-time small text-muted">3rd February 2009 03:06 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                    <p class="post-content">I'm thankful for the <i>offer</i> but I think you have the roles reversed. I'm offering you my modifications to enable Unicode support in NSIS. I've been offering it to you for a year and a half. So I would be more thankful if you said that you will <i>take</i> the code and create a branch that you and others in the development team will henceforth maintain as being an official build of NSIS. Then I can be out of the picture knowing that NSIS will officially support Unicode and in good hands. And you can do whatever you'd like with it.<br />
                    <br />
                    So as Pabs mentioned, I think I've done quite a bit to make it as easy as possible for you to take it and run with it. With UTF-8 support, most of the scripts don't even need to be converted to anything. Just a dab of !ifdefs in there to make sure things are calling the right API. But as long as this does <b>not</b> become part of the official NSIS releases maintained by the official team, as long as I have a personal need for it, I will have to maintain my fork as long as I can. To that end, I will do whatever is necessary to make that task easier for me even if it means offending some sensibilities of the official developers.<br />
                    <br />
                    So to be absolutely brunt: Take the code, do what you like with it. If you don't plan on working on it, then you forfeit the right to complain about things that don't affect you.<br />
                    <br />
                    But I sincerely hope you take it.</p>
                  </div>
                  <hr />

                  <div class="post">
                    <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
                    <span class="post-time small text-muted">3rd February 2009 11:52 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                    <p class="post-content">I'm not offended. I'm very grateful you keep maintaining this branch. I'm simply suggesting a method that would make it easier for the both of us. It'll be easier for me to track changes, back port non-Unicode related changes and insert my own changes to the Unicode branch that can later help with the merge. It will be easier for you to to keep a log of changes, affect the trunk where needed and make new version merges easier. Overall, I think it'll save time for the both of us and benefit the community.</p>
                  </div>
                  <hr />

                  <div class="post">
                    <p class="post-meta"><span class="post-author text-primary">jimpark</span><br />
                    <span class="post-time small text-muted">3rd February 2009 20:40 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                    <p class="post-content">Okay, I think that would be meeting in the middle. So how do we proceed? Does this mean taking the most updated source I've got and committing it to the official repository as a fork? And then we all work with that? Or does it mean, I have to do another month of work so that it's in the form of patches to the current official source code? If it's the latter, I don't think I've got the time and resources to do that.</p>
                  </div>
                  <hr />

                  <div class="post">
                    <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
                    <span class="post-time small text-muted">3rd February 2009 22:15 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                    <p class="post-content">I give you access to SVN, you open a branch and commit your changes in any way you like.</p>
                  </div>
                  <hr />

                  <div class="post">
                    <p class="post-meta"><span class="post-author text-primary">jimpark</span><br />
                    <span class="post-time small text-muted">4th February 2009 15:33 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                    <p class="post-content">Sure. Let's do it.</p>
                  </div>
                  <hr />

                  <div class="post">
                    <p class="post-meta"><span class="post-author text-primary">pabs</span><br />
                    <span class="post-time small text-muted">23rd February 2009 10:47 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                    <p class="post-content">SVN already contains a UNICODE branch from SVN that hasn't been updated in 2 years, perhaps that should be deleted and a new one created?</p>
                  </div>
                  <hr />

                  <div class="post">
                    <p class="post-meta"><span class="post-author text-primary">jimpark</span><br />
                    <span class="post-time small text-muted">23rd February 2009 14:02 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                    <p class="post-content">I don't know about deleting it but the plan is to add a new one. I've been busy again so I haven't looked at the newest release. My plan is to check the Unicode source in once the code is updated to the current release of NSIS.</p>
                  </div>
                  <hr />

                  <div class="post">
                    <p class="post-meta"><span class="post-author text-primary">pabs</span><br />
                    <span class="post-time small text-muted">24th February 2009 08:29 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                    <p class="post-content">Sounds good.</p>
                  </div>
                  <hr />

                  <div class="post">
                    <p class="post-meta"><span class="post-author text-primary">akopts</span><br />
                    <span class="post-time small text-muted">27th February 2009 08:37 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                    <p class="post-content"><strong>variables</strong><br />
                    How can I make variables in Unicode NSIS also store Unicode stuff? Is there any special declaration required for this?<br />
                    Here is the example code:<br />
                    <br /></p>
                    <pre>
<code><br />var StorageDir<br />!define MUI_DIRECTORYPAGE_VARIABLE $StorageDir<br />!insertmacro MUI_PAGE_DIRECTORY<br /><br />section<br />    fileOpen $0 "$INSTDIR\bin\StorageDir.bat" w<br />    fileWrite $0 $StorageDir<br />    fileClose $0<br />sectionEnd<br /></code>
</pre><br />
                    <br />
                    When StorageDir with a non-ASCII name is selected by the user, its value is replaced by question marks later in the script, and question marks are placed to the output file. Is there a way to make it work? I tried recode the script to UTF8 and UTF16LE, does not help.<br />
                    <br />
                    Thanks,<br />
                    Alex
                  </div>
                  <hr />

                  <div class="post">
                    <p class="post-meta"><span class="post-author text-primary">jimpark</span><br />
                    <span class="post-time small text-muted">27th February 2009 14:11 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                    <p class="post-content">Use FileWriteUTF16LE to write Unicode text to the file.</p>
                  </div>
                  <hr />

                  <div class="post">
                    <p class="post-meta"><span class="post-author text-primary">akopts</span><br />
                    <span class="post-time small text-muted">27th February 2009 15:23 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                    <p class="post-content">Awesome! What about matching strings? I need to replace a string in a file, and I am using a solution from<br />
                    <a href="http://%3Cbr%20/%3Ehttp://nsis.sourceforge.net/Replacing_Lines_in_a_Text_File%3Cbr%20/%3E" target="_blank">http://&lt;br /&gt; http://nsis.sourcefor...ext_File&lt;br /&gt;</a>:<br />
                    <br /></p>
                    <pre>
<code><br />        StrCmp $2 "sometring$\r$\n" 0 +2<br />            StrCpy $2 "$storageDir$\r$\n"<br /></code>
</pre><br />
                    <br />
                    How do I match end of line there?<br />
                    <br />
                    I think at least a short list of these new commands deserves a place in the FAQ...
                  </div>
                  <hr />

                  <div class="post">
                    <p class="post-meta"><span class="post-author text-primary">akopts</span><br />
                    <span class="post-time small text-muted">27th February 2009 16:19 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                    <p class="post-content">I figured it out by splitting file to chunks.<br />
                    <br />
                    But it turns out UTF-16LE would not work for me, I need output file in UTF-8. There is an NSIS plugin which converts between ASCII and various Unicodes, but not between UTF-16 and UTF-8. Is there a way to make it work without using an external converter?</p>
                  </div>
                  <hr />

                  <div class="post">
                    <p class="post-meta"><span class="post-author text-primary">jimpark</span><br />
                    <span class="post-time small text-muted">27th February 2009 18:13 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                    <p class="post-content">Currently, there is no way to do it without a plugin or additional functionality written to the NSIS exehead. We currently only support the default Unicode encoding of Windows which is UTF16LE.</p>
                  </div>
                  <hr />

                  <div class="post">
                    <p class="post-meta"><span class="post-author text-primary">Anders</span><br />
                    <span class="post-time small text-muted">27th February 2009 18:17 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                    <p class="post-content">you can call WideCharToMultiByte with the system plugin, CP_UTF8 is supported on XP and later IIRC</p>
                  </div>
                  <hr />

                  <div class="post">
                    <p class="post-meta"><span class="post-author text-primary">jimpark</span><br />
                    <span class="post-time small text-muted">27th February 2009 21:08 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                    <p class="post-content">Anders is right but unfortunately, all the strings are actually stored as UTF16LE internally. And when FileWrite is called, I do an internally UTF16 to ANSI conversion to write it out. So after the conversion, you can't just use FileOpen and FileWrite to write out this new text. You would have to use the System plugin to open your own file and then write out the new UTF8 buffer you just created using the Windows API yourself.</p>
                  </div>
                  <hr />

                  <div class="post">
                    <p class="post-meta"><span class="post-author text-primary">Anders</span><br />
                    <span class="post-time small text-muted">27th February 2009 21:51 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                    <p class="post-content">there should really be a FileWrite /ascii ... flag or something like that</p>
                  </div>
                  <hr />

                  <div class="post">
                    <p class="post-meta"><span class="post-author text-primary">AxelMock</span><br />
                    <span class="post-time small text-muted">2nd March 2009 09:09 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                    <p class="post-content"><strong>Error compiling example</strong><br /></p>

                    <blockquote>
                      <i>Originally posted by jimpark</i><br />
                      <b>I just released 2.42.3 which has support for UTF-8 with and without a BOM for all the NSI, NSH, and license files. Enjoy.</b>
                    </blockquote>Hi Jim,<br />
                    <br />
                    I'm playing around with your Unicode build. Nice work.<br />
                    While trying to compile all the examples, compilation of gfx.nsi leads to an exception upon the first !insertmacro BIMAGE....<br />
                    <br />
                    Compilation using ANSI-NSIS V2.41 works, although the images are weirdly stretched.
                  </div>
                  <hr />

                  <div class="post">
                    <p class="post-meta"><span class="post-author text-primary">AxelMock</span><br />
                    <span class="post-time small text-muted">2nd March 2009 15:34 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                    <p class="post-content"><strong>New Unicode.dll</strong><br /></p>

                    <blockquote>
                      <i>Originally posted by akopts</i><br />
                      <b>I need output file in UTF-8. There is an NSIS plugin which converts between ASCII and various Unicodes, but not between UTF-16 and UTF-8.</b>
                    </blockquote>Since I had to cope with the Unicode.dll last week, I added the missing routine FileUnicode2UTF8 to Unicode.dll.<br />
                    <br />
                    <br />
                    int WideCharToMultiByte(<br />
                    __in UINT CodePage,<br />
                    __in DWORD dwFlags,<br />
                    __in LPCWSTR lpWideCharStr,<br />
                    __in int cchWideChar,<br />
                    __out LPSTR lpMultiByteStr,<br />
                    __in int cbMultiByte,<br />
                    __in LPCSTR lpDefaultChar,<br />
                    __out LPBOOL lpUsedDefaultChar<br />
                    );<br />
                    <br />
                    According to Microsoft's documentation WideChar2MultiByte should return the BufferSize needed if parameter cbMultiByte is 0, i always got 0.<br />
                    <br />
                    So to convert a file to UTF-8 I make the buffer as large as the inputfile (Unicode-16) and if the function returns "ERROR_INSUFFICIENT_BUFFER" I reallocate the buffer with double the size and repeat.<br />
                    <br />
                    I hope It will be of use.<br />
                    Axel
                  </div>
                  <hr />

                  <div class="post">
                    <p class="post-meta"><span class="post-author text-primary">jimpark</span><br />
                    <span class="post-time small text-muted">2nd March 2009 16:30 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                    <p class="post-content">Thanks for reporting the bug, AxelMock. I've found the problem and with a few other fixes, I've bundled it up as 2.42.4 which is now available on my site. I have yet to work on the 2.43 version though.</p>
                  </div>
                  <hr />

                  <div class="post">
                    <p class="post-meta"><span class="post-author text-primary">akopts</span><br />
                    <span class="post-time small text-muted">2nd March 2009 16:34 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                    <p class="post-content">Thanks for the advices! What I ended up doing though was writing a small Java program to do the conversion and substitution. Since I am installing Java software, Java is always available on the system...</p>
                  </div>
                  <hr />

                  <div class="post">
                    <p class="post-meta"><span class="post-author text-primary">tolan</span><br />
                    <span class="post-time small text-muted">17th March 2009 12:36 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                    <p class="post-content">How can I disable this output from makensis.exe?<br />
                    ----<br />
                    File 'C:\Program Files\NSIS\Unicode\nsisconf.nsh' has a BOM marked as UTF-16LE.<br />
                    Opening 'C:\Program Files\NSIS\Unicode\nsisconf.nsh' as UTF-16LE.<br />
                    Opening 'C:\Users\tolan.ALAWAR\AppData\Roaming\nsisconf.nsh' as UTF-16LE.<br />
                    File 'bigtest.nsi' has a BOM marked as UTF-16LE.<br />
                    Opening 'bigtest.nsi' as UTF-16LE.<br />
                    ----</p>
                  </div>
                  <hr />

                  <div class="post">
                    <p class="post-meta"><span class="post-author text-primary">Anders</span><br />
                    <span class="post-time small text-muted">17th March 2009 12:48 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                    <p class="post-content">Why is that output a problem?</p>
                  </div>
                  <hr />

                  <div class="post">
                    <p class="post-meta"><span class="post-author text-primary">tolan</span><br />
                    <span class="post-time small text-muted">18th March 2009 10:16 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                    <p class="post-content">I'm employing home brewed make_installer script to make installer. One thing it does it checks NSIS output for errors with /V1 option. If there is something - script grabs it and displays it to user in a nice MessageBox with big red buttons.<br />
                    <br />
                    Sure, I can check for errors other ways.<br />
                    <br />
                    However it seems weird to me to see even /V0 option ignored.</p>
                  </div>
                  <hr />

                  <div class="post">
                    <p class="post-meta"><span class="post-author text-primary">jimpark</span><br />
                    <span class="post-time small text-muted">18th March 2009 14:00 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                    <p class="post-content">Well, I considered it necessary to know what you were getting. makensis.exe will now pretty much read anything so without that message, you won't know what sort of encoding was used. If everybody feels that /V0 and /V1 should remove these messages, it can be done.<br />
                    <br />
                    As for your script, you can probably grep for "Error:" or "error" and get your error messages.</p>
                  </div>
                  <hr />

                  <div class="post">
                    <p class="post-meta"><span class="post-author text-primary">tolan</span><br />
                    <span class="post-time small text-muted">18th March 2009 14:03 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                    <p class="post-content">I think those messages are OK for /V3 or /V2. No need to completely remove them.</p>
                  </div>
                  <hr />

                  <div class="post">
                    <p class="post-meta"><span class="post-author text-primary">demiller9</span><br />
                    <span class="post-time small text-muted">18th March 2009 16:06 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                    <p class="post-content">MakeNSIS.exe returns an exit code that can be used to determine if there were errors. You can check it with batch or vbscript commands (whichever way you run makensis).<br />
                    <br />
                    I do my builds with /V3 and check the exit code for 0.<br />
                    <br />
                    Don</p>
                  </div>
                  <hr />

                  <div class="post">
                    <p class="post-meta"><span class="post-author text-primary">jimpark</span><br />
                    <span class="post-time small text-muted">18th March 2009 17:01 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                    <p class="post-content">I believe some messages are already printed regardless of your verbose level. So how do you deal with those tolan?</p>
                  </div>
                  <hr />

                  <div class="post">
                    <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
                    <span class="post-time small text-muted">19th March 2009 00:03 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                    <p class="post-content">jimpark, such cases should be reported as bugs. Everything makensis prints should be controlled by the verbosity level. As for those specific messages, I believe SCRIPT_MSG would be best.</p>
                  </div>
                  <hr />
                  <!-- Bootstrap core CSS -->
                  <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
                  <!--[if lt IE 9]>
                <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
                <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->

                  <div class="container">
                    <!-- Put navigation bar here -->

                    <ol class="breadcrumb">
                      <li><a href="../index.html" class="glyphicon glyphicon-home"></a></li>

                      <li><a href="f-65.html">NSIS Discussion</a></li>

                      <li class="active">Unicode</li>
                    </ol>

                    <p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=277381">Unicode</a></p><br />

                    <div class="post">
                      <p class="post-meta"><span class="post-author text-primary">jimpark</span><br />
                      <span class="post-time small text-muted">19th March 2009 02:08 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                      <p class="post-content">Yes, that's what I was thinking but it's not worth making another release. It should be fixed in the next release when I get around to it.</p>
                    </div>
                    <hr />

                    <div class="post">
                      <p class="post-meta"><span class="post-author text-primary">Red Wine</span><br />
                      <span class="post-time small text-muted">2nd April 2009 00:39 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                      <p class="post-content">Hi Jimmy,<br />
                      <br />
                      Unicode NSIS is awesome, I have just compiled Quick AVI Creator with Unicode NSIS and everything seems fine. The only problem which seems that I have is unrelated to Unicode NSIS. It is with the Unicode plugin which I used for converting ansi text subtitles but I guess I will find some workaround.<br />
                      <br />
                      Unicode NSIS definitely worths to merged with the main NSIS project.<br />
                      <br />
                      Congrats Jimmy.</p>
                    </div>
                    <hr />

                    <div class="post">
                      <p class="post-meta"><span class="post-author text-primary">scully13</span><br />
                      <span class="post-time small text-muted">10th April 2009 15:01 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                      <p class="post-content">It appears that somebody did add Unicode support to the AccessControl plug-in but the download is missing from the plug-in page. <a href="http://nsis.sourceforge.net/AccessControl_plug-in" target="_blank">http://nsis.sourceforge.net/AccessControl_plug-in</a><br />
                      Does anybody have a copy of this somewhere or know of something else I can use from the Unicode install to change file user permissions?</p>
                    </div>
                    <hr />

                    <div class="post">
                      <p class="post-meta"><span class="post-author text-primary">arantius</span><br />
                      <span class="post-time small text-muted">17th April 2009 15:26 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                      <p class="post-content"><strong>Unicode + WriteIniStr?</strong><br />
                      I've got a legacy installer that uses InstallOptions, and WriteIniStr to choose exactly what that dialog will display at runtime. Doing i.e.<br />
                      <br /></p>
                      <pre>
<code>StrCpy $R1 "${ALREADY_TEXT}"<br />MessageBox MB_OK $R1<br />WriteIniStr "$PLUGINSDIR\already.ini" "Field 2" "Text" $R1<br /></code>
</pre><br />
                      <br />
                      I see the right text in the message box, but I see munged text in the installer. The .ini file contains the munged text full of question marks.<br />
                      <br />
                      Does WriteIniStr not handle Unicode? Is there an alternative that does, or a workaround?
                    </div>
                    <hr />

                    <div class="post">
                      <p class="post-meta"><span class="post-author text-primary">jimpark</span><br />
                      <span class="post-time small text-muted">17th April 2009 18:03 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                      <p class="post-content">Unfortunately, the Windows API that deals with INI files saves everything as ANSI even when the wide-char versions of the API are called.</p>
                    </div>
                    <hr />

                    <div class="post">
                      <p class="post-meta"><span class="post-author text-primary">Anders</span><br />
                      <span class="post-time small text-muted">17th April 2009 18:35 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                      <p class="post-content">did we not cover this already? the .ini file needs a UTF16LE BOM before you start writing to it with ini functions IIRC</p>
                    </div>
                    <hr />

                    <div class="post">
                      <p class="post-meta"><span class="post-author text-primary">jimpark</span><br />
                      <span class="post-time small text-muted">17th April 2009 19:37 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                      <p class="post-content">Oh yeah, we did cover this. Sorry Anders. My memory is damaged or something. Yeah, so as Anders says, if you create the file yourself and add the BOM, then you can use the WriteINIStr afterwards and things work. Somewhere in this thread or elsewhere in this forum, we have the same conversation where Anders corrects me.</p>
                    </div>
                    <hr />

                    <div class="post">
                      <p class="post-meta"><span class="post-author text-primary">arantius</span><br />
                      <span class="post-time small text-muted">17th April 2009 21:02 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                      <p class="post-content">That was exactly it, thanks. I tried to search, and tried to wade through all the pages here, but missed it. Everything's working wonderfully now.</p>
                    </div>
                    <hr />

                    <div class="post">
                      <p class="post-meta"><span class="post-author text-primary">shnur</span><br />
                      <span class="post-time small text-muted">10th June 2009 11:54 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                      <p class="post-content">Anybody knows, what about unzip plugin for unicode nsis?<br />
                      NsisUnz and ZipDll does not work ;(</p>
                    </div>
                    <hr />

                    <div class="post">
                      <p class="post-meta"><span class="post-author text-primary">shnur</span><br />
                      <span class="post-time small text-muted">17th June 2009 09:48 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                      <p class="post-content">Guys, please anybody help me!<br />
                      I try to migrate my nsi script to Nsis unicode, but I can't unzip file with data. I download from from web site, but I can't extract it. Please, help me! :(</p>
                    </div>
                    <hr />

                    <div class="post">
                      <p class="post-meta"><span class="post-author text-primary">jimpark</span><br />
                      <span class="post-time small text-muted">17th June 2009 12:03 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                      <p class="post-content">Each plugin must be modified and recompiled to work with Unicode NSIS. If those plugins are a must for you, you should contact their authors or modify the plugins yourself. What is it that you are actually needing to do? Perhaps, there's another way to do it without using the plugins.</p>
                    </div>
                    <hr />

                    <div class="post">
                      <p class="post-meta"><span class="post-author text-primary">shnur</span><br />
                      <span class="post-time small text-muted">18th June 2009 02:18 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                      <p class="post-content">I try to rebuild nsisunz and ZipDll plugins, but all of my attemps was failed :( I don't sure that authors supports their plugins.<br />
                      <br />
                      In depends of file name, I like to download in realtime from server different archive file, and extract it in user's computer.<br />
                      Archive created manually - so I can be use any archiver.<br />
                      Do you see other way to fix this problem?<br />
                      <br />
                      Thanks.<br />
                      PS: Sorry for my english.</p>
                    </div>
                    <hr />

                    <div class="post">
                      <p class="post-meta"><span class="post-author text-primary">Instructor</span><br />
                      <span class="post-time small text-muted">22nd June 2009 11:21 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                      <p class="post-content">How plugin can detect that it has been called from Unicode NSIS or from Ansi NSIS? Maybe add some new parameter in "extra_parameters" structure.</p>
                    </div>
                    <hr />

                    <div class="post">
                      <p class="post-meta"><span class="post-author text-primary">Anders</span><br />
                      <span class="post-time small text-muted">22nd June 2009 14:41 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                      <p class="post-content">@Instructor, funny you should ask that, I was thinking about it the other day. When hwndNSIS is non NULL you can check that, but if you also support .onInit or silent installers, the only thing I could come up with was checking $pluginsdir:<br />
                      if the 2nd BYTE is 0, you can be (pretty) sure its UNICODE<br />
                      <br />
                      It will be true for any default $pluginsdir:<br />
                      C:\foo<br />
                      .\foo<br />
                      \foo<br />
                      <br />
                      now if someone changed $pluginsdir to a relative path like "unicodefoldername\foo" it could break, but I don't see a valid reason to do that<br />
                      <br />
                      $pluginsdir is INST_LANG+2 and not documented, but thats another issue (the same goes for $temp)<br />
                      <br />
                      The final option is to check the import table of the .exe at runtime, but that is a bit more work</p>
                    </div>
                    <hr />

                    <div class="post">
                      <p class="post-meta"><span class="post-author text-primary">AxelMock</span><br />
                      <span class="post-time small text-muted">27th August 2009 15:09 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                      <p class="post-content"><strong>V2.45 as Unicode build??</strong><br />
                      Hi,<br />
                      <br />
                      I might get into the situation having to support a bunch of message box texts, and customized texts in 25 languages.<br />
                      <br />
                      Translation will be done by a translation service which will surely deliver all results as Unicode.<br />
                      <br />
                      So the Unicode built of NSIS will become a MUST.<br />
                      <br />
                      The only problem is, that we must support Windows7 and as I understand only NSIS 2.45 has the necessary changes to support Win7.<br />
                      <br />
                      Therefore: Is a 2.45 build of Unicode NSIS in sight or will Unicode build be merged to the standard build of NSIS?<br />
                      <br />
                      Sorry, I couldn't follow all the discussions for the last 2 or 3 months.<br />
                      <br />
                      Regards,<br />
                      Axel</p>
                    </div>
                    <hr />

                    <div class="post">
                      <p class="post-meta"><span class="post-author text-primary">CrushBug</span><br />
                      <span class="post-time small text-muted">27th August 2009 18:12 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                      <p class="post-content">I, too, hope that NSIS will go Unicode officially at some point in the near future.</p>
                    </div>
                    <hr />

                    <div class="post">
                      <p class="post-meta"><span class="post-author text-primary">vbguy</span><br />
                      <span class="post-time small text-muted">28th August 2009 12:09 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                      <p class="post-content">I agree. Jimpark's work is great. Why is NSIS still using non-unicode branch as the default? I know, I know - Win9x doesn't support unicode. But, who the hell uses Win9x anymore? It's older than 10 years old, and frankly the only people using it are using it to support old technology (not to download &amp; install the latest program from the internet).<br />
                      <br />
                      And if NSIS is going to continue support old technology that no one uses anymore, why doesn't it support Windows 3.1. Or, heck Windows 1.0. I'm sure <i>someone</i> uses those.<br />
                      <br />
                      The first mainstream Windows to support unicode was Windows 2000 - nearly 10 years old itself. So this is hardly newfangled technology.<br />
                      <br />
                      Kichik, what would it take to make jimpark's code the default branch? And what's stopping this changeover?</p>
                    </div>
                    <hr />

                    <div class="post">
                      <p class="post-meta"><span class="post-author text-primary">AxelMock</span><br />
                      <span class="post-time small text-muted">28th August 2009 16:04 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                      <p class="post-content"></p>

                      <blockquote>
                        <i>Originally posted by vbguy</i><br />
                        <b>I agree. Jimpark's work is great.</b>
                      </blockquote>Fully agree!<br />
                      And I agree with you that Win9x support nowadays is a bit difficult to understand.<br />
                      Even W2K drivers can only be certified by MS as an addendum to XP drivers.<br />
                      <br />
                      Is there any good reason, why NSIS support for Win9X could not stop with some version (e.g. 2.45) and all newer versions only support Unicode capable OSes?<br />
                      <br />
                      Perhaps we should start a poll in the NSIS forum WHO is still developing for Win9x and why, and if these developers could live with a frozen ANSI NSIS.<br />
                      <br />
                      To start with myself:<br />
                      W2K is the minimum required OS.
                    </div>
                    <hr />

                    <div class="post">
                      <p class="post-meta"><span class="post-author text-primary">DrO</span><br />
                      <span class="post-time small text-muted">28th August 2009 17:03 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                      <p class="post-content"></p>

                      <blockquote>
                        <i>Originally posted by vbguy</i><br />
                        <b>And what's stopping this changeover?</b>
                      </blockquote>time and resources i'd go with.<br />
                      <br />
                      -daz
                    </div>
                    <hr />

                    <div class="post">
                      <p class="post-meta"><span class="post-author text-primary">vbguy</span><br />
                      <span class="post-time small text-muted">29th August 2009 02:06 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                      <p class="post-content"></p>

                      <blockquote>
                        <i>Originally posted by DrO</i><br />
                        <b>time and resources i'd go with.<br />
                        <br />
                        -daz</b>
                      </blockquote>Right, but that's why I was asking. Tell us <i>what</i> needs to be changed or fixed so the community can chip in and get the Unicode branch officially supported.<br />
                      <br />
                      In other words, Jimpark already did most of the work. What can the rest of us do to get this thing finalized?<br />
                      <br />
                      <b>I'm not saying "fix it for me".</b> I'm offering my help. But I don't want to waste my time if there are no plans to officially support Unicode.<br />
                      <br />
                      Also, I know it was mentioned elsewhere, but I don't think we should wait for an arbitrary version (e.g. version 3.0) to switch to Unicode. I think it should be done in the next 1 or 2 point releases.<br />
                      <br />
                      Kichik: Can we get a comment from you?
                    </div>
                    <hr />

                    <div class="post">
                      <p class="post-meta"><span class="post-author text-primary">jimpark</span><br />
                      <span class="post-time small text-muted">9th September 2009 20:06 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                      <p class="post-content"><strong>2.45 is out!</strong><br />
                      I've just released the Unicode version of NSIS built around NSIS 2.45 along with the source code and an ANSI version built from the same source. You can find it at <a href="http://www.scratchpaper.com" target="_blank">http://www.scratchpaper.com</a> as usual.</p>
                    </div>
                    <hr />

                    <div class="post">
                      <p class="post-meta"><span class="post-author text-primary">Anders</span><br />
                      <span class="post-time small text-muted">9th September 2009 21:24 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                      <p class="post-content">And I recently created a plugin that can call a ansi plugin in a unicode installer. It is very much in the testing stage, so get it @ <a href="http://nsis.sourceforge.net/CallAnsiPlugin_plug-in" target="_blank">http://nsis.sourceforge.net/CallAnsiPlugin_plug-in</a> and let me know of any problems</p>
                    </div>
                    <hr />

                    <div class="post">
                      <p class="post-meta"><span class="post-author text-primary">cristianadam</span><br />
                      <span class="post-time small text-muted">26th September 2009 23:49 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                      <p class="post-content"><strong>Re: 2.45 is out!</strong><br /></p>

                      <blockquote>
                        <i>Originally posted by jimpark</i><br />
                        <b>I've just released the Unicode version of NSIS built around NSIS 2.45 along with the source code and an ANSI version built from the same source. You can find it at <a href="http://www.scratchpaper.com" target="_blank">http://www.scratchpaper.com</a> as usual.</b>
                      </blockquote>Congratulations for the new release. I don't understand why this is not merged into mainline.<br />
                      <br />
                      The code is using the generic-text mappings found in tchar.h (<a href="http://msdn.microsoft.com/en-us/library/c426s321%28VS.71%29.aspx" target="_blank">http://msdn.microsoft.com/en-us/libr...8VS.71%29.aspx</a>). This is the documented way of having the same code compiled for ansi and unicode on Windows platforms.<br />
                      <br />
                      Cheers,<br />
                      Cristian.
                    </div>
                    <hr />

                    <div class="post">
                      <p class="post-meta"><span class="post-author text-primary">sealite</span><br />
                      <span class="post-time small text-muted">27th September 2009 09:09 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                      <p class="post-content">I have a small problem with NSISu: it does always print messages about including files.<br />
                      <br />
                      The makensis log is full on inclusions like the one below and I discovered that using /V does not help. Is there any way to hide this and still be able to log any warnings or errors?<br />
                      <br />
                      Opening 'C:\dev\pj\src\contrib\nsis\Contrib\Language files\English.nsh' as UTF-16LE.<br />
                      File 'C:\dev\pj\src\contrib\nsis\Contrib\Language files\English.nsh' has a BOM marked as UTF-16LE.</p>
                    </div>
                    <hr />

                    <div class="post">
                      <p class="post-meta"><span class="post-author text-primary">ngroman</span><br />
                      <span class="post-time small text-muted">8th October 2009 03:28 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                      <p class="post-content"><strong>Fonts</strong><br />
                      I'm writing a multilingual install script that needs to support English, Chinese, Japanese, and Turkish among others. I've been able to convert my nsi files to utf-16.<br />
                      <br />
                      However it seems that the font that the installer is displayed in doesn't have the Japanese characters that I need, instead I just see boxes where the characters should be (the Turkish seems to render fine). I know the computer must have some font that displays these Japanese characters because when I open the .nsi file in wordpad.exe I can view the characters.<br />
                      <br />
                      Any suggestions? Is it possible to make the installer force display in a certain font? Thanks.</p>
                    </div>
                    <hr />

                    <div class="post">
                      <p class="post-meta"><span class="post-author text-primary">MSG</span><br />
                      <span class="post-time small text-muted">8th October 2009 07:53 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                      <p class="post-content">Either create a unicode installer, or set your windows's default codepage for non-unicode applications to Japanese. (Or run the installer through applocale, which is equivalent.)</p>
                    </div>
                    <hr />

                    <div class="post">
                      <p class="post-meta"><span class="post-author text-primary">jimpark</span><br />
                      <span class="post-time small text-muted">8th October 2009 15:37 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                      <p class="post-content">ngroman, are you posting your problem here because this is a problem you are seeing in the Unicode NSIS? Or are you trying to use the standard NSIS to achieve this? With the standard NSIS, you aren't going to be able to create one installer that can display all those languages together. You'll need Unicode NSIS for that, as MSG stated.</p>
                    </div>
                    <hr />

                    <div class="post">
                      <p class="post-meta"><span class="post-author text-primary">ngroman</span><br />
                      <span class="post-time small text-muted">8th October 2009 19:08 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                      <p class="post-content">jimpark:<br />
                      I'm using nsis-2.45-Unicode to compile my .nsi file. My nsi script file is encoded in utf-16LE (I saved it as unicode in wordpad). I verified with chardet in python that it is in fact saved as utf-16LE. Also the output from makensis showed that my file was being opened in utf-16 mode.<br />
                      <br />
                      The computer I'm running this has XP with the MUI packs installed for French, German, and Spanish (I do not have the MUI for any Asian languages). However the fact that I can see the Japanese characters in wordpad means there is something on my computer that can display these characters.</p>
                    </div>
                    <hr />

                    <div class="post">
                      <p class="post-meta"><span class="post-author text-primary">jimpark</span><br />
                      <span class="post-time small text-muted">8th October 2009 20:44 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                      <p class="post-content">Have you tried installing the Asian language support? If not, why not?</p>
                    </div>
                    <hr />

                    <div class="post">
                      <p class="post-meta"><span class="post-author text-primary">ngroman</span><br />
                      <span class="post-time small text-muted">8th October 2009 21:13 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                      <p class="post-content">I realize that I could do that, and it would probably solve my issue...for me; however, most of my users will have standard XP installs that don't have Asian language support either. If I'm going to show a drop-down menu of languages it wouldn't look very good to have some of the languages show up as a bunch of blank boxes to some users.</p>
                    </div>
                    <hr />

                    <div class="post">
                      <p class="post-meta"><span class="post-author text-primary">jimpark</span><br />
                      <span class="post-time small text-muted">9th October 2009 18:33 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                      <p class="post-content">The NLF files in "Contrib\Language files" specifies which font to use. These have been chosen by the translators so that they look right. But if you want to change the font for a language, you do have the option of using SetFont /LANG=lang_id.</p>
                    </div>
                    <hr />

                    <div class="post">
                      <p class="post-meta"><span class="post-author text-primary">grzech</span><br />
                      <span class="post-time small text-muted">11th October 2009 03:36 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                      <p class="post-content"></p>

                      <blockquote>
                        <i>Originally posted by ngroman</i><br />
                        <b>I realize that I could do that, and it would probably solve my issue...for me; however, most of my users will have standard XP installs that don't have Asian language support either. If I'm going to show a drop-down menu of languages it wouldn't look very good to have some of the languages show up as a bunch of blank boxes to some users.</b>
                      </blockquote>Don't show the drop down list. Just detect locale or Windows UI language and auto set installer language to be consistent with locale/UI language.
                    </div>
                    <hr />

                    <div class="post">
                      <p class="post-meta"><span class="post-author text-primary">MSG</span><br />
                      <span class="post-time small text-muted">11th October 2009 15:51 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                      <p class="post-content"></p>

                      <blockquote>
                        <i>Originally posted by grzech</i><br />
                        <b>Don't show the drop down list. Just detect locale or Windows UI language and auto set installer language to be consistent with locale/UI language.</b>
                      </blockquote>Autosetting the language to the Windows locale is very bad practice. I for one am running in Japanese locale, while I can't read Japanese without a dictionary (and copy-paste, at that). I keep Windows in Japanese locale because of our translation projects, but it is also very common practice in general in communities of Asian pop-culture fans.<br />
                      <br />
                      Installers such as nVidia's drivers are extremely annoying in doing everything in Japanese automatically, so the user ends up having to guess which buttons to push.
                    </div>
                    <hr />

                    <div class="post">
                      <p class="post-meta"><span class="post-author text-primary">grzech</span><br />
                      <span class="post-time small text-muted">12th October 2009 10:51 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                      <p class="post-content">Yeah, autosetting to Windows UI language is safer. Guys who can't read Japanese rather won't be running Japanese Windows. :D</p>
                    </div>
                    <hr />

                    <div class="post">
                      <p class="post-meta"><span class="post-author text-primary">jimpark</span><br />
                      <span class="post-time small text-muted">13th October 2009 01:21 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                      <p class="post-content">I agree with MSG on that one. I hate it when the installer thinks it knows in which language I'd prefer to read my installation instructions. I may have the locale set to some other language that I can read and write but not comfortable enough to speak "geek" in. I'd much rather be given a choice: at the very least, the locale or English? (Okay, maybe I'm being English-centric here.) Or maybe at the download site, I should be given a choice as to which language installer I want.</p>
                    </div>
                    <hr />

                    <div class="post">
                      <p class="post-meta"><span class="post-author text-primary">dariann</span><br />
                      <span class="post-time small text-muted">29th October 2009 11:44 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                      <p class="post-content"></p>

                      <blockquote>
                        <i>Originally posted by sealite</i><br />
                        <b>I have a small problem with NSISu: it does always print messages about including files.<br />
                        <br />
                        The makensis log is full on inclusions like the one below and I discovered that using /V does not help. Is there any way to hide this and still be able to log any warnings or errors?<br />
                        <br />
                        Opening 'C:\dev\pj\src\contrib\nsis\Contrib\Language files\English.nsh' as UTF-16LE.<br />
                        File 'C:\dev\pj\src\contrib\nsis\Contrib\Language files\English.nsh' has a BOM marked as UTF-16LE.</b>
                      </blockquote>I have this problem too... It's very annoying... I want to turn off this messages, because they spamming my command window. How can I do it?
                    </div>
                    <hr />

                    <div class="post">
                      <p class="post-meta"><span class="post-author text-primary">Koopa</span><br />
                      <span class="post-time small text-muted">31st October 2009 01:32 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                      <p class="post-content">jimpark:<br />
                      <br />
                      All of your downloads have a wrong file extension. .exec instead of .exe.<br />
                      <br />
                      You did a great job, except for some old plugins, like delay.dll, which won't work, it's just great. I've converted all my scripts to Unicode, including the Essentials Pack.<br />
                      <br />
                      The abilities with the Unicode version are just awesome.<br />
                      <br />
                      Keep on your good work, I hope you'll provide updates in future too.<br />
                      <br />
                      -Chris</p>
                    </div>
                    <hr />

                    <div class="post">
                      <p class="post-meta"><span class="post-author text-primary">jimpark</span><br />
                      <span class="post-time small text-muted">31st October 2009 02:31 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                      <p class="post-content">In the next release I will try to address both of the issues you've listed above. The "exec" extension is just because of google sites which keeps me from uploading anything with the .exe extension as I've explained on the site. I may have to find another server, though, because it is highly annoying.</p>
                    </div>
                    <hr />

                    <div class="post">
                      <p class="post-meta"><span class="post-author text-primary">Wizou</span><br />
                      <span class="post-time small text-muted">5th November 2009 16:56 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                      <p class="post-content"></p>

                      <blockquote>
                        <i>Originally posted by scully13</i><br />
                        <b>It appears that somebody did add Unicode support to the AccessControl plug-in but the download is missing from the plug-in page. <a href="http://nsis.sourceforge.net/AccessControl_plug-in" target="_blank">http://nsis.sourceforge.net/AccessControl_plug-in</a><br />
                        Does anybody have a copy of this somewhere or know of something else I can use from the Unicode install to change file user permissions?</b>
                      </blockquote>I just a made a NSIS-Unicode port of it, and uploaded it on<br />
                      <a href="http://nsis.sourceforge.net/AccessControl_plug-in" target="_blank">http://nsis.sourceforge.net/AccessControl_plug-in</a>
                    </div>
                    <hr />

                    <div class="post">
                      <p class="post-meta"><span class="post-author text-primary">Wizou</span><br />
                      <span class="post-time small text-muted">6th November 2009 09:09 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                      <p class="post-content"></p>

                      <blockquote>
                        <i>Originally posted by Anders</i><br />
                        <b>When hwndNSIS is non NULL you can check that, but if you also support .onInit or silent installers, the only thing I could come up with was checking $pluginsdir:<br />
                        if the 2nd BYTE is 0, you can be (pretty) sure its UNICODE</b>
                      </blockquote>Hi Anders, I don't see how this could work :<br />
                      To reach variable INST_LANG+2, you need to compute g_variables[(INST_LANG+2)*g_stringsize]<br />
                      but you don't know if you're dealing with CHAR or TCHAR g_variables (which would need to multiply the index by 2)
                    </div>
                    <hr />
                    <!-- Bootstrap core CSS -->
                    <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
                    <!--[if lt IE 9]>
                <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
                <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->

                    <div class="container">
                      <!-- Put navigation bar here -->

                      <ol class="breadcrumb">
                        <li><a href="../index.html" class="glyphicon glyphicon-home"></a></li>

                        <li><a href="f-65.html">NSIS Discussion</a></li>

                        <li class="active">Unicode</li>
                      </ol>

                      <p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=277381">Unicode</a></p><br />

                      <div class="post">
                        <p class="post-meta"><span class="post-author text-primary">Anders</span><br />
                        <span class="post-time small text-muted">6th November 2009 13:02 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                        <p class="post-content">@Wizou: If you check my BgWorker plugin, you can see that I'm checking for kernel32::lstrcatW in the import table.<br />
                        <br />
                        I also have some sample code in there that checks $pluginsdir, but like you said, you don't know the offset, so it has to use IsBadReadPtr() and there could be false positives.<br />
                        <br />
                        Unfortunately, it turns out that writing hybrid plugins is a huge pain in the ass, and I can't recommend doing it on anything except very simple plugins</p>
                      </div>
                      <hr />

                      <div class="post">
                        <p class="post-meta"><span class="post-author text-primary">jimpark</span><br />
                        <span class="post-time small text-muted">6th November 2009 14:50 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                        <p class="post-content">For the next release, I plan on adding to pluginapi.h:<br />
                        <br />
                        // True if NSIS is built with Unicode support.<br />
                        bool NSISCALL IsUnicodeNSIS();<br />
                        <br />
                        Also, Olivier noted that you could use IsWindowUnicode(hwnd). But this may not work on silent installers.<br />
                        <br />
                        However, I would still encourage that the plugin writers use TCHARs or a strategy similar to it and compile and link with the right Unicode declarations and definitions. I know there is a temptation to try to generate a single binary that could work on both the ANSI and the Unicode NSIS variants but that seems a bit dangerous to me.</p>
                      </div>
                      <hr />

                      <div class="post">
                        <p class="post-meta"><span class="post-author text-primary">Wizou</span><br />
                        <span class="post-time small text-muted">6th November 2009 14:57 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                        <p class="post-content">@Anders: IsBadReadPtr won't help you here as it will be valid memory range (.bss variables area), just you're not checking a valid Unicode 2nd byte.<br />
                        Checking 'lstrcatW' import from main module is however a good idea :)<br />
                        <br />
                        @jim park: I still wonder how you would create such a IsUnicodeNSIS, unless you pass special exec_flags_t value from NSIS to the DLL<br />
                        <br />
                        <br />
                        If we have such a way for the DLL to detect the version of NSIS, I'm thinking about creating a new pluginapi.h/pluginapi.lib that could transparently convert variables and stack from ANSI or Unicode to the plugins choice depending on whether it is called from Unicode-NSIS or not<br />
                        This would make plugins creator's life easier.</p>
                      </div>
                      <hr />

                      <div class="post">
                        <p class="post-meta"><span class="post-author text-primary">dariann</span><br />
                        <span class="post-time small text-muted">6th November 2009 14:58 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                        <p class="post-content">@jimpark: What about turning on/off "messages about including files" ? NSIS Unicode is great tool and I ask You to add this option, please.</p>
                      </div>
                      <hr />

                      <div class="post">
                        <p class="post-meta"><span class="post-author text-primary">Anders</span><br />
                        <span class="post-time small text-muted">6th November 2009 16:01 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                        <p class="post-content">Noooooooooo, we don't need a IsUnicodeNSIS() function or any kind of pluginapi helpers to do both.<br />
                        <br />
                        It has already been done with the unicode layer for win9x, just use that.<br />
                        <br />
                        I'm with Jim on this, plugin devs should use TCHAR and compile two versions. There is also my CallAnsiPlugin plugin for older stuff with no source.<br />
                        <br />
                        @Wizou: well, I'm sure it can be done without checking the import table. The IsBadReadPtr usage was just a big hack and I never finished that type of detection.</p>
                      </div>
                      <hr />

                      <div class="post">
                        <p class="post-meta"><span class="post-author text-primary">jimpark</span><br />
                        <span class="post-time small text-muted">6th November 2009 21:25 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                        <p class="post-content">@Wizou: That's a good point. It's very difficult to write an IsUnicodeNSIS(). The only thing I could do is try validating the string (if anything) to see if it's good UTF16LE. Look in validateunicode.cpp which is in Source. You'll see a class there that can validate UTF16LE/BE as well as UTF8.<br />
                        <br />
                        @Anders: I agree with you in that this API, even if accurate, is a bad idea. I'm pulling IsUnicodeNSIS() from pluginapi.h. It will NOT be in the next release.</p>
                      </div>
                      <hr />

                      <div class="post">
                        <p class="post-meta"><span class="post-author text-primary">ChocJunkie</span><br />
                        <span class="post-time small text-muted">10th November 2009 14:50 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                        <p class="post-content">Does someone know why I'm always getting empty unicode files when I'm using:</p>
                        <pre>
<code>unicode::FileUnicode2Ansi "${_HDDS_countFile}" "${_HDDS_countFile}_tmp" AUTO<br />Pop $R0<br />${If} "$R0" != 0<br />  # error handling<br />${EndIf}</code>
</pre><br />
                        The source files type is "UTF-16LE|UCS-2LE".<br />
                        <br />
                        -- Problem solved ---<br />
                        <br />
                        I was using Unicode plugin v1.1.<br />
                        I've tried version 1.0 and everything is fine now.
                      </div>
                      <hr />

                      <div class="post">
                        <p class="post-meta"><span class="post-author text-primary">Anders</span><br />
                        <span class="post-time small text-muted">15th November 2009 23:39 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                        <p class="post-content">If we are going to have any chance of a merge, the examples and header files need to be 100% the same, meaning that both the current A and U builds need some changes:<br />
                        <br />
                        *The ansi version needs to change its handling of &amp;wXX so that XX is a count of characters and not bytes (and update the docs) (The unicode version already has this fixed)<br />
                        <br />
                        *The unicode system plugin needs to default to the W version of functions when autodetecting (foo &gt;&gt; fooW and not fooA)<br />
                        <br />
                        <br />
                        To reduce the NSIS_MAX_STRLEN confusion, we should probably make it really clear in the docs that NSIS_MAX_STRLEN is a count of TCHAR's (Or maybe even rename it). We should also add a predefine for the count of bytes, I suggest we name it NSIS_MAX_STRCB<br />
                        <br />
                        Both versions currently fail <a href="http://nsis.pastebin.com/f571047be" target="_blank">this</a> little test script</p>
                      </div>
                      <hr />

                      <div class="post">
                        <p class="post-meta"><span class="post-author text-primary">jimpark</span><br />
                        <span class="post-time small text-muted">16th November 2009 14:54 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                        <p class="post-content"></p>

                        <blockquote>
                          <i>Originally posted by Anders</i><br />
                          *The unicode system plugin needs to default to the W version of functions when autodetecting (foo &gt;&gt; fooW and not fooA)
                        </blockquote>We actually do default to the "W" version. Let me explain a little with how the "T" versions of the functions work for those who don't know.<br />
                        <br />
                        We write in our code:<br />
                        <br />
                        <pre>
<code><br />::CreateFile(...);<br /></code>
</pre><br />
                        <br />
                        When you look at the definition of CreateFile, you see that there really is no function called "CreateFile" but two functions called "CreateFileW" and "CreateFileA." This is true for MOST of the functions that have both the A and the W versions.<br />
                        <br />
                        <pre>
<code><br />#ifdef UNICODE<br />#define CreateFile  CreateFileW<br />#else<br />#define CreateFile  CreateFileA<br />#endif // !UNICODE<br /></code>
</pre><br />
                        <br />
                        There are functions which only have one name, with no W or A prefixes.<br />
                        <br />
                        So the logic that is in the system plugin currently is to try to load the function with the name as is, then failing that, try to add "W" for the Unicode build (or "A" for the ANSI build) and try again.<br />
                        <br />
                        Unfortunately, for older string functions like lstrlen, the lib you are trying to load DOES have a lstrlen which is ANSI only. It's probably there for backward compatibility since it mimics standard library string functions. So for lstrlen, you need to specify kernel::lstrlenW. But as far as I've seen, it's only these string functions that look and behave like the standard library ones that have this problem.<br />
                        <br />
                        A possible change could be that we always suffix with a "W" or "A" and see if that loads something and try that function first before we try the name of the function unmodified, but I'm uncomfortable with that since I'd rather give the programmer the benefit of the doubt and let him/her decide what s/he really wants to load.<br />
                        <br />
                        I don't mind the plugin second guessing after failures but I don't want it to think it's smarter than the programmer.<br />
                        <br />

                        <blockquote>
                          To reduce the NSIS_MAX_STRLEN confusion, we should probably make it really clear in the docs that NSIS_MAX_STRLEN is a count of TCHAR's (Or maybe even rename it). We should also add a predefine for the count of bytes, I suggest we name it NSIS_MAX_STRCB<br />
                          <br />
                          Both versions currently fail <a href="http://nsis.pastebin.com/f571047be" target="_blank">this</a> little test script [/B]
                        </blockquote>I agree that we should note that NSIS_MAX_STRLEN is in TCHARS. But going through the documentation, they all state that NSIS_MAX_STRLEN means a number of <i>characters</i>, not bytes. So I'm actually okay with the documentation as-is.<br />
                        <br />
                        As for adding NSIS_MAX_STRCB, I think that's a great idea, although, it can easily be calculated by NSIS_MAX_STRLEN * NSIS_CHAR_SIZE. I like NSIS_MAX_STR_BYTES better as a name, though.<br />
                        <br />
                        Unless the NSIS trunk has NSIS_MAX_STR_BYTES, it would be useless for me to add it just to the Unicode version as it's meant for portability across the two versions.<br />
                        <br />
                        So perhaps we can request NSIS_MAX_STR_BYTES to be added to the NSIS trunk?
                      </div>
                      <hr />

                      <div class="post">
                        <p class="post-meta"><span class="post-author text-primary">Wizou</span><br />
                        <span class="post-time small text-muted">16th November 2009 15:24 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                        <p class="post-content">For your information, I'm starting to merge Unicode port of NSIS version into NSIS repository.<br />
                        <br />
                        I will try to take the most of what has been discussed here into account.<br />
                        However my plan is first to make it the most transparent possible for the user and the plug-ins developer.</p>
                      </div>
                      <hr />

                      <div class="post">
                        <p class="post-meta"><span class="post-author text-primary">jimpark</span><br />
                        <span class="post-time small text-muted">16th November 2009 15:34 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                        <p class="post-content">That's excellent news! Is there an ETA on when this will be complete?</p>
                      </div>
                      <hr />

                      <div class="post">
                        <p class="post-meta"><span class="post-author text-primary">Wizou</span><br />
                        <span class="post-time small text-muted">16th November 2009 15:42 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                        <p class="post-content">No ETA yet.. I just started the SVN branch I will work on..<br />
                        I guess the first merge/port will be easy especially as your work will greatly simplify the effort.<br />
                        But then there will be a phase of discussion/arbitration/tweaking/testing as to what should be the user &amp; developer experience regarding this new version.<br />
                        I will keep you updated on my progress.</p>
                      </div>
                      <hr />

                      <div class="post">
                        <p class="post-meta"><span class="post-author text-primary">Anders</span><br />
                        <span class="post-time small text-muted">16th November 2009 19:38 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                        <p class="post-content">well, if we don't look for "functionW" before "function", we are going to need some kind of define that is "A" or "W" and maybe a list of API's where it is required. IMHO that is the wrong approach, and the reverse is needed, they need to look for the char type specific version first unless a (new) option is provided in the system call</p>
                      </div>
                      <hr />

                      <div class="post">
                        <p class="post-meta"><span class="post-author text-primary">Wizou</span><br />
                        <span class="post-time small text-muted">17th November 2009 08:31 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                        <p class="post-content">my opinion is to check whether the parameter type contains a "t", then we know we are facing an API which has two variant..<br />
                        and only in this case, we start checking for 'functionW' or 'functionA' variant first.. if entrypoint is not found, then we check for 'function'</p>
                      </div>
                      <hr />

                      <div class="post">
                        <p class="post-meta"><span class="post-author text-primary">jimpark</span><br />
                        <span class="post-time small text-muted">17th November 2009 13:41 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                        <p class="post-content">@Wizou: the problem with that check is that if the user calls CreateFile() with 'w' in the Unicode version of NSIS, that's not wrong either. CreateFile should still resolve to CreateFileW.<br />
                        <br />
                        Like I said, the only problems I've seen are the string functions that mimic standard library calls. There aren't that many and they are all lowercased like C standard library functions. If the person has programmed C at all, functions like strlen should jump out as taking char* and not wchar_t*. So it should raise a warning flag and the user should realize he should put a W at the end.</p>
                      </div>
                      <hr />

                      <div class="post">
                        <p class="post-meta"><span class="post-author text-primary">Anders</span><br />
                        <span class="post-time small text-muted">17th November 2009 14:10 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                        <p class="post-content">Windows programmers don't think about that, I'm so used to just calling lstr*, I don't think about the char type. Whats wrong by defaulting to the W versions and only falling back if W does not exists or a option to disable it was set?<br />
                        <br />
                        Do you have a single example of a function that needs to be called without W when running as unicode (meaning foo should be called with WCHAR* even if fooW exists)?</p>
                      </div>
                      <hr />

                      <div class="post">
                        <p class="post-meta"><span class="post-author text-primary">Wizou</span><br />
                        <span class="post-time small text-muted">17th November 2009 14:22 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                        <p class="post-content"></p>

                        <blockquote>
                          <i>Originally posted by jimpark</i><br />
                          <b>@Wizou: the problem with that check is that if the user calls CreateFile() with 'w' in the Unicode version of NSIS, that's not wrong either. CreateFile should still resolve to CreateFileW.</b>
                        </blockquote>I don't agree with you. This is wrong.<br />
                        If the user explicitely wants to call the Unicode version using 'w' as parameter type, he has to specify CreateFileW as the function name.<br />
                        <br />
                        Summary:<br />
                        * the user wants to call explicitely CreateFileA =&gt; he uses function name CreateFileA and parameter type 'm'<br />
                        * the user wants to call explicitely CreateFileW =&gt; he uses function name CreateFileW and parameter type 'w'<br />
                        * the user wants to call CreateFile whatever suits best according to NSIS variant =&gt; he uses function name CreateFile and parameter type 't'<br />
                        * outside the presence of parameter type t, we can't suppose the existence of a A/W suffix, and it seems to me it would be wrong to try to add one (it would risk to reach another API which is unrelated)
                      </div>
                      <hr />

                      <div class="post">
                        <p class="post-meta"><span class="post-author text-primary">Anders</span><br />
                        <span class="post-time small text-muted">17th November 2009 15:10 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                        <p class="post-content">Yeah, I agree with Wizou</p>
                      </div>
                      <hr />

                      <div class="post">
                        <p class="post-meta"><span class="post-author text-primary">jimpark</span><br />
                        <span class="post-time small text-muted">17th November 2009 18:43 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                        <p class="post-content">That would be nice if everyone did that. But remember, when people read the Windows documentation, what do they read? The documentation says to use CreateFile(). It does not say to use CreateFileW() for Unicode. We're just lucky that Microsoft has been largely consistent with these W and A suffixes.<br />
                        <br />
                        If you write C/C++, you will also be calling CreateFile() with wchar_t*. Because that's what the documentation tells you to do. You just have to make sure you define some macro like _UNICODE or UNICODE. If you read the fine print you get the "is implemented as CreateFileW() and CreateFileA()" but no example tells you to use these directly.<br />
                        <br />
                        And remember, there's really no bearing on type-safety here. I can use any old function signature and as long as the name of the function matches, the System plugin will push your arguments, whatever types they may be, onto the stack and happily call the function. The arguments can be totally wrong types and have bogus values. So it's not even useful in that respects either.</p>
                      </div>
                      <hr />

                      <div class="post">
                        <p class="post-meta"><span class="post-author text-primary">Pidgeot</span><br />
                        <span class="post-time small text-muted">17th November 2009 18:58 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                        <p class="post-content">To the best of my knowledge, there IS no CreateFile-function, only CreateFileA and CreateFileW. CreateFile is #defined to CreateFileA or CreateFileW in WinBase.h, depending on whether or not UNICODE is defined.<br />
                        <br />
                        As such, if the Sytem plug-in allows you to just write CreateFile, then it must either already be checking for *A, or it has some predefined mappings.</p>
                      </div>
                      <hr />

                      <div class="post">
                        <p class="post-meta"><span class="post-author text-primary">jimpark</span><br />
                        <span class="post-time small text-muted">17th November 2009 19:02 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                        <p class="post-content"></p>

                        <blockquote>
                          <i>Originally posted by Anders</i><br />
                          <b>Windows programmers don't think about that, I'm so used to just calling lstr*, I don't think about the char type. Whats wrong by defaulting to the W versions and only falling back if W does not exists or a option to disable it was set?<br />
                          <br />
                          Do you have a single example of a function that needs to be called without W when running as unicode (meaning foo should be called with WCHAR* even if fooW exists)?</b>
                        </blockquote>I believe there are calls in the Windows API where there is no ANSI counterparts so the "W" suffix version would fail. But I don't know of a case where the "W" suffix version would also be a different function. That doesn't mean that they don't exist or will never exist.<br />
                        <br />
                        However, remember, this plugin architecture can call other libraries than those provided by Microsoft. And who knows what other people do.<br />
                        <br />
                        Basically, as I mentioned before, it is wrong to second guess the user from the onset. Don't you hate it when your word processor "corrects" your typing when you type some acronym thinking it's SMARTER than you? I don't believe programs should behave that way. And I certainly don't want a programming tool to behave that way.<br />
                        <br />
                        User: "I want to call Foo()."<br />
                        <br />
                        Computer: "No, you don't. You want Bar(). Bar is nicer."<br />
                        <br />
                        User: "No, I want Foo()!"<br />
                        <br />
                        Computer: "Hey, I found Bar()! Look at that. It's a function that exists. Let's just call Bar()."<br />
                        <br />
                        User: "I said, call Foo()!!!"<br />
                        <br />
                        Computer: "Silly user. I called Bar() for you which is much nicer and that caused a booboo. You better go fix it."<br />
                        <br />
                        What a nightmare!
                      </div>
                      <hr />

                      <div class="post">
                        <p class="post-meta"><span class="post-author text-primary">jimpark</span><br />
                        <span class="post-time small text-muted">17th November 2009 19:04 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                        <p class="post-content">@Pidgeot: Yes, you are right. There is no CreateFile() function in the library you link to. There's a macro. But the documentation tells you to call CreateFile().</p>
                      </div>
                      <hr />

                      <div class="post">
                        <p class="post-meta"><span class="post-author text-primary">Anders</span><br />
                        <span class="post-time small text-muted">17th November 2009 20:06 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                        <p class="post-content"></p>

                        <blockquote>
                          <i>Originally posted by jimpark</i><br />
                          <b>That would be nice if everyone did that. But remember, when people read the Windows documentation, what do they read? The documentation says to use CreateFile(). It does not say to use CreateFileW() for Unicode. We're just lucky that Microsoft has been largely consistent with these W and A suffixes.<br />
                          <br />
                          If you write C/C++, you will also be calling CreateFile() with wchar_t*. Because that's what the documentation tells you to do. You just have to make sure you define some macro like _UNICODE or UNICODE. If you read the fine print you get the "is implemented as CreateFileW() and CreateFileA()" but no example tells you to use these directly.</b>
                        </blockquote>You will not be using wchar_t*, you will be using LPTSTR. t is the system plugins version of LPTSTR. The minute you start using w / wchar*, you already know you are working with unicode only. In 99.99% of cases, if there is a t, you need to look for the W/A versions first. This is the most compatible approach (And the only way to achieve A/U compatibility with existing code)
                      </div>
                      <hr />

                      <div class="post">
                        <p class="post-meta"><span class="post-author text-primary">jimpark</span><br />
                        <span class="post-time small text-muted">17th November 2009 21:05 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                        <p class="post-content">@Anders: What you say is true. But if you are coding a Unicode only app, you will notice that people use wchar_t with CreateFile() and not CreateFileW().<br />
                        <br />
                        Either way, I don't like the system to think it's smarter than the programmer.</p>
                      </div>
                      <hr />

                      <div class="post">
                        <p class="post-meta"><span class="post-author text-primary">Anders</span><br />
                        <span class="post-time small text-muted">17th November 2009 21:45 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                        <p class="post-content">but we sort of have to be, in windows/C world, this stuff happens at compile time, for us it happens at runtime, and so, t is our clue that the user trusts us and expects us to the right thing<br />
                        <br />
                        (OT: Why don't you two hang out in IRC, this discussion would go a lot faster that way)</p>
                      </div>
                      <hr />

                      <div class="post">
                        <p class="post-meta"><span class="post-author text-primary">jimpark</span><br />
                        <span class="post-time small text-muted">17th November 2009 21:50 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                        <p class="post-content">Unfortunately, my access to the internet is very limited. So I can't IRC. This is also what keeps me from being able to work on the NSIS repository directly (and hence that's why I haven't created a branch in the repository for my stuff here). So once the group actually takes my code into the repository, I can't work on it anymore. Anyway, that's my situation and will be for the foreseeable future.</p>
                      </div>
                      <hr />

                      <div class="post">
                        <p class="post-meta"><span class="post-author text-primary">Anders</span><br />
                        <span class="post-time small text-muted">17th November 2009 22:04 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                        <p class="post-content">Well, there are HTTP IRC "clients" that work just fine, try mibbit</p>
                      </div>
                      <hr />

                      <div class="post">
                        <p class="post-meta"><span class="post-author text-primary">Wizou</span><br />
                        <span class="post-time small text-muted">18th November 2009 08:54 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                        <p class="post-content">You are both right...<br />
                        The user doesn't want to care or know about CreateFileA or W, he will just use CreateFile... and parameter type 't', and there will be no problem.<br />
                        <br />
                        I think the few users that care to write their own System::Call (rather than copy/pasting them from somewhere) should know about TCHAR/LPTSTR and A/W variant.</p>
                      </div>
                      <hr />

                      <div class="post">
                        <p class="post-meta"><span class="post-author text-primary">gringoloco023</span><br />
                        <span class="post-time small text-muted">21st January 2010 21:54 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                        <p class="post-content"><strong>About recompiling plug-ins ?</strong><br />
                        Hi jimpark,<br />
                        <br />
                        Lately, I've been studying some C, and got the hang of recompiling plug-ins. I've done 2 so far, and almost/basically got the registry plug-in done.<br />
                        Using an NSIS .nsh script instead of the plug-ins just ended up being to slow<br />
                        <br />
                        My question is about including &lt;nsis/pluginapi.h&gt;, if I just use this, the script is missing the pop- &amp; push string/integer functions.<br />
                        <br />
                        As I read topics about this issue in this forum, one stated I should include pluginapi.c, another stated I should use the pluginapi.lib.<br />
                        <br />
                        Myself, I only got the scripts recompiled including &lt;nsis/pluginapi.c&gt;. Which includes pluginapi.h, anyway. And as I understand including Exdll.h, isn't necessary anymore?<br />
                        <br />
                        Is this the way you advise me to compile Unicode NSIS plug-ins ???<br />
                        <br />
                        Or should I implement pluginapi.lib some how ?<br />
                        I only found this file in the installed version of Unicode NSIS, in the Examples\Plugins<br />
                        <br />
                        I am using Microsoft Visual Studio 2008 express edition.<br />
                        <br />
                        See my forum topic at : portableapps.com/node/21879<br />
                        EnumINI.7z, is using the pluginapi.c<br />
                        NewTextReplace, still uses it's own pop &amp; push functions, but maybe I should change that one time.</p>
                      </div>
                      <hr />

                      <div class="post">
                        <p class="post-meta"><span class="post-author text-primary">jimpark</span><br />
                        <span class="post-time small text-muted">22nd January 2010 13:51 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                        <p class="post-content">It's very admirable of you to take the initiative. I'd advise that you download the source code for the Unicode NSIS and look at the Contrib folder. All of these are plugins. For example, a simple one to imitate is the Banner plugin and see what I did there to support Unicode.</p>
                      </div>
                      <hr />

                      <div class="post">
                        <p class="post-meta"><span class="post-author text-primary">gringoloco023</span><br />
                        <span class="post-time small text-muted">22nd January 2010 15:01 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                        <p class="post-content">Done all of that a while ago. I needed the examples.<br />
                        <br />
                        As well I got pluginapi.lib linked by VC++ now. So it's all fine ! But including pluginapi.c worked as well.<br />
                        <br />
                        Finally I got an reply of the developer of the MD5dll plug-in, he will do this plugin soon !</p>
                      </div>
                      <hr />

                      <div class="post">
                        <p class="post-meta"><span class="post-author text-primary">Pawel</span><br />
                        <span class="post-time small text-muted">23rd January 2010 22:51 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                        <p class="post-content">@Jim Park<br />
                        Are you gonna compile NSIS 2.46 based Unicode build?<br />
                        <br />
                        @All<br />
                        Could someone with skills compile this ANSI NSIS plugins to UNICODE version?<br />
                        1. CrcCheck.dll<br />
                        <a href="http://nsis.sourceforge.net/CRCCheck_plug-in" target="_blank">http://nsis.sourceforge.net/CRCCheck_plug-in</a><br />
                        2. Linker.dll<br />
                        <a href="http://nsis.sourceforge.net/Linker_plug-in" target="_blank">http://nsis.sourceforge.net/Linker_plug-in</a><br />
                        <br />
                        -Pawel</p>
                      </div>
                      <hr />

                      <div class="post">
                        <p class="post-meta"><span class="post-author text-primary">tolan</span><br />
                        <span class="post-time small text-muted">27th January 2010 08:14 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                        <p class="post-content">GJ with new version jimpark!<br />
                        <br />
                        However I still get messages about BOMs with /V0 and /V1 switches.<br />
                        <br />
                        Details here: <a href="http://forums.winamp.com/showthread.php?postid=2497708#post2497708" target="_blank">http://forums.winamp.com/showthread....08#post2497708</a><br />
                        Mr. kichik opinion: <a href="http://forums.winamp.com/showthread.php?postid=2498455#post2498455" target="_blank">http://forums.winamp.com/showthread....55#post2498455</a><br />
                        <br />
                        Hope it will be included some day :)</p>
                      </div>
                      <hr />

                      <div class="post">
                        <p class="post-meta"><span class="post-author text-primary">shnur</span><br />
                        <span class="post-time small text-muted">27th January 2010 08:24 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                        <p class="post-content"><strong>nsisunz+CallAnsiPlugin</strong><br />
                        @Anders:<br />
                        I use your plugin for unzip file to folder, but it consumes 2 gb memory, without result.<br />
                        Can you show me how to unzip file?</p>
                      </div>
                      <hr />

                      <div class="post">
                        <p class="post-meta"><span class="post-author text-primary">roy204</span><br />
                        <span class="post-time small text-muted">29th January 2010 13:05 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                        <p class="post-content"><strong>NSIS Unicode with "m" and "t" System types</strong><br />
                        Hi Jim, Anders and others,<br />
                        <br />
                        I have a question about NSIS Unicode (I'm using v2.45.1):<br />
                        <br />
                        I have a DLL that I need to call with System::Call and some of the function prototypes in that DLL have parameters that are explicitly "char*" because the DLL expects some strings in UTF-8 format and also sometime return strings in UTF-8 format.<br />
                        <br />
                        From what I understand I have to use the "m" type in these System:Call prototypes to explicitly specify char* but what happens when I actually call them and pass a NSIS variable or register?<br />
                        <br />
                        From my testing it just works (incidentally this is probably because the strings I pass in contain only english characters) but consider if I did the following:<br />
                        <br />
                        StrCpy $0 "some chinese characters"<br />
                        System::Call 'SomeDLL:SomeFunction(m)i(.r0).r1? c'<br />
                        <br />
                        Does the Unicode string contained in $0 get converted in any way before the DLL function is called or is it just called with a typecast to (char *) with whatever data is in $0?<br />
                        <br />
                        Since my calls are working, I suspect it's being converted to multibyte, but how and when ?<br />
                        <br />
                        I'm asking because I'm having trouble with this when doing it the other way around: i.e. the DLL returns some UTF-8 to me that I need to display in NSIS.<br />
                        <br />
                        For example if there is a function in that DLL defined as:<br />
                        <br />
                        int SomeDLLGetMessage(char *buffer);<br />
                        <br />
                        Which expects you to pass a pre-allocated char* buffer of at least 1024 bytes in order to place a utf8 string in it...<br />
                        <br />
                        ...and if I call this function this way:<br />
                        <br />
                        System::Call 'SomeDLL::SomeDLLGetMessage(m)i(.r0).r1? c'<br />
                        <br />
                        I find that it completes and that $0 contains something that I am able to display with a simple MessageBox MB_OK "$0".<br />
                        <br />
                        Since the DLL call returns UTF-8 I would have expected $0 to contain single-byte data and therefore to be mangled when I attempt to display it. However it displays (the utf8 chars are displayed "as is" but it displays nonetheless).<br />
                        <br />
                        Is there some kind of conversion happening for me inside NSIS ? What is the proper way of doing this?<br />
                        <br />
                        I'd be more than happy to convert the UTF-8 data i get back to Unicode myself by calling MultiByteToWideChar but it doesn't seem to work. When I do this, I am able to convert $0 to Unicode but when I try to display it, NSIS only displays the first character (as if it was treated like a single byte string and stopped at the first 0 byte)...<br />
                        <br />
                        I guess I am confused at how this needs to be handled. Is there a way to call a DLL, retrieve a UTF8 string and convert it to Unicode to display it ? or do I need to have the DLL modified to return Unicode data instead ?<br />
                        <br />
                        Sorry for the long post :-(<br />
                        <br />
                        Cheers,<br />
                        Damien.</p>
                      </div>
                      <hr />

                      <div class="post">
                        <p class="post-meta"><span class="post-author text-primary">Anders</span><br />
                        <span class="post-time small text-muted">29th January 2010 13:35 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                        <p class="post-content">yes, m will convert the buffer. In your case, you should allocate 1024 bytes with System::Alloc and pass it to SomeDLLGetMessage as i, not m. When the call returns, you can pass it to MultiByteToWideChar yourself (Utf8 is only supported on XP+ in MultiByteToWideChar)</p>
                      </div>
                      <hr />

                      <div class="post">
                        <p class="post-meta"><span class="post-author text-primary">jimpark</span><br />
                        <span class="post-time small text-muted">29th January 2010 13:46 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                        <p class="post-content">There is an implicit conversion happening with 'm'. In fact, it uses the system default codepage for the conversion. If the return value is also 'm', (ANSI codepage) it will convert it back to utf16.<br />
                        <br />
                        Are you sure the API sets the buffer with a UTF8 string? Often times people mix up UTF8 and ANSI. UTF8 is a byte-based encoding of Unicode. UTF8, UTF16-LE, UTF16-BE, UTF32 are all Unicode but different encodings of it. ANSI is a different beast altogether requiring the codepage information to really figure out which 'character'* each of the codes represent. This means that 'm' does not do UTF8 to UTF16 conversion at all. This would ONLY work for English since the ASCII set is shared by all ANSI codepages and UTF8. So make sure that the API really does set the string with UTF8 encoding. (This may be unlikely since it requires work to actually get a UTF8 string in Windows.) But if it really is UTF8, what Anders suggests might be the way to do it. Otherwise, if it's ANSI, then 'm' is fine as long as you are okay with the assumption that the string returned is going to be in the system default codepage -- if it's not then it won't display correctly on the system anyway, so it's really not a big concern.<br />
                        <br />
                        * not necessarily character but really 'code' since diacritics and other character modifying codes exist</p>
                      </div>
                      <hr />

                      <div class="post">
                        <p class="post-meta"><span class="post-author text-primary">roy204</span><br />
                        <span class="post-time small text-muted">29th January 2010 20:42 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                        <p class="post-content">Yes the DLL really does return UTF-8 but thanks to you guys I got it working !<br />
                        <br />
                        I was breaking down the process in two functions, one to call the DLL and one to convert to Unicode and in the process the results were transiting into NSIS variables and therefore being converted all around. Now that I do both the DLL call and MultiByteToWideChar in the same block of code using allocated buffers and the 'i' type, everything is pretty :-)<br />
                        <br />
                        Thank you guys you saved my friday ;-)<br />
                        <br />
                        Cheers,<br />
                        Damien.</p>
                      </div>
                      <hr />

                      <div class="post">
                        <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
                        <span class="post-time small text-muted">31st March 2010 14:11 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                        <p class="post-content">Hi Jim, there seems to be an issue with the myatoi and myatou in the pluginapi library (and possibly the myatoi_or) too. If the plugin is built as Unicode then they all work fine but they fail to parse a valid integer for multi-byte builds. Sometimes they return 0 or they return some hideously large number (like an unsigned has been negatived). Same goes for popint().<br />
                        <br />
                        I will probably look into fixing it myself but I'd rather you had a look. If you want me to test, let me know.<br />
                        <br />
                        Stu</p>
                      </div>
                      <hr />

                      <div class="post">
                        <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
                        <span class="post-time small text-muted">31st March 2010 14:11 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                        <p class="post-content">Hi Jim, there seems to be an issue with the myatoi and myatou in the pluginapi library (and possibly the myatoi_or) too. If the plugin is built as Unicode then they all work fine but they fail to parse a valid integer for multi-byte builds. Sometimes they return 0 or they return some hideously large number (like an unsigned has been negatived). Same goes for popint().<br />
                        <br />
                        I will probably look into fixing it myself but I'd rather you had a look. If you want me to test, let me know.<br />
                        <br />
                        Stu</p>
                      </div>
                      <hr />
                      <!-- Bootstrap core CSS -->
                      <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
                      <!--[if lt IE 9]>
                <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
                <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->

                      <div class="container">
                        <!-- Put navigation bar here -->

                        <ol class="breadcrumb">
                          <li><a href="../index.html" class="glyphicon glyphicon-home"></a></li>

                          <li><a href="f-65.html">NSIS Discussion</a></li>

                          <li class="active">Unicode</li>
                        </ol>

                        <p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=277381">Unicode</a></p><br />

                        <div class="post">
                          <p class="post-meta"><span class="post-author text-primary">Anders</span><br />
                          <span class="post-time small text-muted">31st March 2010 15:03 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                          <p class="post-content">@Afrow: the unicode merge has started, so whatever changes you make, add them to the official branch as well</p>
                        </div>
                        <hr />

                        <div class="post">
                          <p class="post-meta"><span class="post-author text-primary">jimpark</span><br />
                          <span class="post-time small text-muted">1st April 2010 15:02 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                          <p class="post-content">Stu, I'm looking at the code right now and I don't see anything that could cause the behavior you are seeing. But the behavior is in line with a Unicode string being fed into an ANSI version of myatoi. Is there a simple NSI file that would test the problem?</p>
                        </div>
                        <hr />

                        <div class="post">
                          <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
                          <span class="post-time small text-muted">2nd April 2010 15:42 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                          <p class="post-content">I'll see if I can knock something up.<br />
                          <br />
                          Stu</p>
                        </div>
                        <hr />

                        <div class="post">
                          <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
                          <span class="post-time small text-muted">2nd April 2010 16:58 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                          <p class="post-content">Ok here is the problem being reproduced:<br /></p>

                          <blockquote>
                            test_myatoi: Pushed: 999, Result: 0<br />
                            test_myatou: Pushed: 999, Result: 0<br />
                            test_popint : Pushed: 999, Result: 0<br />
                            test_my_atoi: Pushed: 999, Result: 999<br />
                            Completed
                          </blockquote>This only occurs when using the ANSI plugin build (Compile NSIS Script). Note that my_atoi is a different implementation.<br />
                          <br />
                          I've attached the plugins and NSIS script.<br />
                          <br />
                          Stu
                        </div>
                        <hr />

                        <div class="post">
                          <p class="post-meta"><span class="post-author text-primary">sealite</span><br />
                          <span class="post-time small text-muted">11th April 2010 09:16 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                          <p class="post-content"><strong>Cleanup command line output by removing/disabling file encoding messages.</strong><br /></p>

                          <blockquote>
                            <small>Originally posted by dariann</small><br />
                            I have this problem too... It's very annoying... I want to turn off this messages, because they spamming my command window. How can I do it?
                          </blockquote>I observed that over time lots of users complained about the file encoding messages.<br />
                          <br />
                          Please drop the command line spamming regarding file encoding or move them to /V3 this is my only desire in order to consider NSIS Unicode perfect.<br />
                          <br />
                          I'm using NSIS Unicode for more than two years and my only complain is regarding this, so called feature. A good command line utility should not spam you with few pages of useless text.<br />
                          <br />
                          This "feature" can make you miss potential warnings or even errors when compiling. Redirecting STDOUT is not an option.<br />
                          <br />
                          Also, I hope that NSIS will switch to NSISu as default instead of keeping the ancient ANSI version.
                        </div>
                        <hr />

                        <div class="post">
                          <p class="post-meta"><span class="post-author text-primary">Wizou</span><br />
                          <span class="post-time small text-muted">11th April 2010 21:10 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                          <p class="post-content">In my merging of NSIS Unicode in NSIS sources trunk, I removed most of these "File has a BOM"-type messages, keeping them only when it's a useful warning (no BOM).<br />
                          So this will be solved in the future NSIS release that include my Unicode merge.<br />
                          <br />
                          As for switching to Unicode installers as default, I'm thinking more about adding a command-line option (that can be set as default, like the compressor in MakeNSISw) and an equivalent attribute command (like SetCompressor), for choosing ANSI or Unicode target.</p>
                        </div>
                        <hr />

                        <div class="post">
                          <p class="post-meta"><span class="post-author text-primary">Anders</span><br />
                          <span class="post-time small text-muted">11th April 2010 22:59 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                          <p class="post-content">@Wizou: I posted a unofficial nsis installer ( <a href="http://forums.winamp.com/showthread.php?t=316842" target="_blank">http://forums.winamp.com/showthread.php?t=316842</a> ) that includes both ansi and unicode + a loader that tries to guess based on BOM or forced with command line param (Required hacked makensis.exe to allow different stub dirs) Once the unicode branch is fully merged, we could of course implement that functionality in a less hacky way (We need StubA/StubW and PluginsA/PluginsW folders and maybe for languages unless we are able to transform the ansi versions on the fly. Include dir should be shared (Some unicode fixes need to be added to make that come true IIRC))</p>
                        </div>
                        <hr />

                        <div class="post">
                          <p class="post-meta"><span class="post-author text-primary">jimpark</span><br />
                          <span class="post-time small text-muted">12th April 2010 20:41 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                          <p class="post-content"><strong>2.46 RC1 Is Out!</strong><br />
                          2.46 RC1 Is Out!<br />
                          <br />
                          The Unicode port of NSIS 2.46 is out as a release candidate. Apart from the straight port, I've made some improvements.<br />
                          <br />
                          New African languages are supported:<br />
                          •Cibemba (ANSI and Unicode)<br />
                          •Efik (Unicode only)<br />
                          •Igbo (Unicode only)<br />
                          •Malagasy (ANSI and Unicode)<br />
                          •Yoruba (Unicode only)<br />
                          <br />
                          As you can see, some of these languages are supported in my new ANSI build also. Please note that the translations aren't complete but "sufficient" as told to me by the translators so further enhancements may be forthcoming in a later release.<br />
                          <br />
                          Also, the System calls to lstr* family of functions in the kernel32.dll has been modified so that there is no longer the need to always suffix with "W" the lstr* functions for the Unicode build. The problem stemmed from the fact that in the kernel32.dll, the lstr* functions such as lstrlen, had three callable versions: lstrlenW, lstrlenA and lstrlen. (This is different from other win32 functions which only have two callable versions: the A and the W suffixed calls.) However, in kernel32, lstrlen is the same as lstrlenA. The reason for this strangeness in kernel32.dll was presumably for backward compatibility. So an NSI script that used System::Call kernel32::lstrlen would get lstrlenA in both the Unicode and the ANSI build of NSIS! Please note, this only happens with kernel32::lstr* functions. But this has been remedied by special code in the System plugin that looks for calls to kernel32::lstr* functions and adjusts the calls according to the build of NSIS so that there is no longer any confusion. The TCHAR-like names for the functions should now work for all of the win32 calls which should make porting of the standard NSIS scripts to the Unicode version much easier.<br />
                          <br />
                          I've also removed the "chatty" info messages regarding the Unicode encoding of the compiled NSI and NSH files. This was bothering some.<br />
                          <br />
                          In my personal testing, everything looked decent. Please take some time to check if your project works well with it and let me know if you find any problems.</p>
                        </div>
                        <hr />

                        <div class="post">
                          <p class="post-meta"><span class="post-author text-primary">jimpark</span><br />
                          <span class="post-time small text-muted">12th April 2010 20:58 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                          <p class="post-content">Stu,<br />
                          <br />
                          I've tried looking at your TestMyatoi zip file and found only one version of pluginapi.lib there. Since you are saying this fails for the ANSI, you must be using the Unicode version of the lib. If you are building for ANSI, you need the ANSI version of the lib. You can't link to the same lib for both ANSI and Unicode version of your plugin.<br />
                          <br />
                          If this is something that is desired, I can create a unified lib with both ANSI and Unicode versions of the function existing in the lib with the pluginapi.h having #defines that map the different function calls to the right functions. This would basically mimic what win32 does.</p>
                        </div>
                        <hr />

                        <div class="post">
                          <p class="post-meta"><span class="post-author text-primary">Anders</span><br />
                          <span class="post-time small text-muted">12th April 2010 21:09 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                          <p class="post-content">Are you saying you have a hardcoded check for "kernel32::lstr"? How do you know those are the only functions that are like that? I still say that if "t" type is used, unicode versions needs to go FooW() &gt; Foo() &gt; Fail</p>
                        </div>
                        <hr />

                        <div class="post">
                          <p class="post-meta"><span class="post-author text-primary">jimpark</span><br />
                          <span class="post-time small text-muted">12th April 2010 21:30 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                          <p class="post-content">I'm pretty sure those are the only functions like that. Do the strings command on the various dlls and look for yourself. As for using 't' as the hint, would that work if the return type is what's different? It also won't work if the string type is actually a member of a struct and the pointer to the struct is what's being passed in. It's an interesting idea but I'm right now not sure if that is enough of a check.</p>
                        </div>
                        <hr />

                        <div class="post">
                          <p class="post-meta"><span class="post-author text-primary">Anders</span><br />
                          <span class="post-time small text-muted">12th April 2010 22:53 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                          <p class="post-content">@Jim: Yes, it would fail for structs. Not sure about return, I don't think you can have ...(...)t.s etc<br />
                          <br />
                          Maybe we have to settle for some sort of flag. With the check for lstr, we can probably get by with your code until a problem actually shows up.</p>
                        </div>
                        <hr />

                        <div class="post">
                          <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
                          <span class="post-time small text-muted">12th April 2010 23:00 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                          <p class="post-content">Jim,<br />
                          <br />
                          bother didn't think about that. If you could make a define that would be handy.<br />
                          <br />
                          Stu</p>
                        </div>
                        <hr />

                        <div class="post">
                          <p class="post-meta"><span class="post-author text-primary">jimpark</span><br />
                          <span class="post-time small text-muted">12th April 2010 23:10 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                          <p class="post-content">Stu,<br />
                          <br />
                          It is possible to do but probably not this release. It does require quite a bit of reworking for the pluginapi.h and I don't want to delay the 2.46 release any longer. But I'm sure 2.47 is around the corner and I will incorporate it then.</p>
                        </div>
                        <hr />

                        <div class="post">
                          <p class="post-meta"><span class="post-author text-primary">Animaether</span><br />
                          <span class="post-time small text-muted">17th April 2010 22:29 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                          <p class="post-content">Semi-on-topic...<br />
                          <br />
                          First.. As I understand it, plugins written for the ANSI version of NSIS won't work in the Unicode version, and vice-versa.<br />
                          Am I correct in that understanding - or is this limited to plugins that perform specific tasks?<br />
                          <br />
                          Second.. As I understand it, the two compiles would typically result in two plugin files (Anders' BgWorker notwithstanding).<br />
                          Am I correct in that understanding - or would this again be limited to plugins that perform specific tasks?<br />
                          <br />
                          Just to use a particular example.. the GetVersion plugin by Stu (Afrow UK) has as part of its version notes "Better Unicode build support". However, the download only contains a single DLL.<br />
                          Is there anything specific one might look out for in a plugin's source - if available - that would tell a person that the plugin it would build would be ANSI, Unicode, or Hybrid (a la BgWorker)?<br />
                          <br />
                          The main reason I'm asking is because I'm working on compiling a list of plugins with some basic information - including whether it supports ANSI, Unicode or both - and GetVersion is the first one that made me realize that it might not be as trivial as simply checking if there's two DLLs (BgWorker makes its Hybrid method clear in both the wiki page and in the source).</p>
                        </div>
                        <hr />

                        <div class="post">
                          <p class="post-meta"><span class="post-author text-primary">Anders</span><br />
                          <span class="post-time small text-muted">17th April 2010 22:39 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                          <p class="post-content">You can pretty much assume that no other plugin is a hybrid, it is a big ass pain to do.<br />
                          <br />
                          If you look at the GetVersion source, you see that it uses the TCHAR type and _T/TEXT macros for strings. This is a indicator that it supports both unicode and ansi output. If UNICODE &amp; _UNICODE is defined when building, you end up with a unicode dll. (@Stu: GetProcAddress does not take a unicode string!)<br />
                          <br />
                          If all you have is a compiled dll, open it in <a href="http://dependencywalker.com" target="_blank">dependencywalker.com</a> If a lot of the used functions in kernel32/user32 ends with A its ansi, or W for unicode.</p>
                        </div>
                        <hr />

                        <div class="post">
                          <p class="post-meta"><span class="post-author text-primary">Animaether</span><br />
                          <span class="post-time small text-muted">17th April 2010 23:06 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                          <p class="post-content">Cool - thanks Anders. I've used dependency walker before - just not that part of it.<br />
                          <br />
                          Sounds like basically although the GetVersion plugin is Unicode-ready in terms of the source code, no compiled version is available in the official download at this time.<br />
                          <br />
                          'll see about finishing that list later (fair bit later) and doing something with it in the wiki.</p>
                        </div>
                        <hr />

                        <div class="post">
                          <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
                          <span class="post-time small text-muted">22nd April 2010 14:48 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                          <p class="post-content">Yeh I did make sure the source was ready for Unicode (except GetProcAddress, thanks Anders) but never built (I don't think we had Unicode NSIS when I wrote that plug-in). I will build a Unicode version when I have time - in fact quite a few of my plug-ins needs updating but I'm stuck for time at the moment.<br />
                          <br />
                          Stu</p>
                        </div>
                        <hr />

                        <div class="post">
                          <p class="post-meta"><span class="post-author text-primary">webtubbies</span><br />
                          <span class="post-time small text-muted">22nd April 2010 17:19 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                          <p class="post-content"><strong>CallAnsiPlugin and nsisXML</strong><br />
                          Hi All<br />
                          <br />
                          For my installer I use Anders' plugin "CallAnsiPlugin" with NSIS Unicode and everything's OK except with nsisXML by Wizou.<br />
                          <br /></p>

                          <blockquote>
                            OutFile "test_xml_UNICODE.exe"<br />
                            <br />
                            !define TempDir "C:\TEMP"<br />
                            !define nsisXML "${TempDir}\nsisXML.dll"<br />
                            <br />
                            Function .onInit<br />
                            SetOutPath $INSTDIR<br />
                            ;Get All ANSI dll to the local machine<br />
                            File /ONAME=${nsisXML} "${NSISDIR}\Plugins\nsisXML.dll"<br />
                            FunctionEnd<br />
                            <br />
                            Function test_xml<br />
                            CallAnsiPlugin::Call ${nsisXML} create 0<br />
                            CallAnsiPlugin::Call ${nsisXML} load 1 "sample.xml"<br />
                            CallAnsiPlugin::Call ${nsisXML} select 1 '/main/child[@attrib="value2"]'<br />
                            IntCmp $2 0 notFound<br />
                            CallAnsiPlugin::Call ${nsisXML} getAttribute 1 "active"<br />
                            DetailPrint "Attribute 'active' is $3"<br />
                            CallAnsiPlugin::Call ${nsisXML} getText<br />
                            DetailPrint "Tag &lt;child&gt; contains $3"<br />
                            CallAnsiPlugin::Call ${nsisXML} parentNode<br />
                            CallAnsiPlugin::Call ${nsisXML} removeChild<br />
                            CallAnsiPlugin::Call ${nsisXML} save 1 "SampleU.xml"<br />
                            <br />
                            notFound:<br />
                            FunctionEnd<br />
                            <br />
                            Section myFoo<br />
                            Call test_xml<br />
                            SectionEnd
                          </blockquote>Is there anybody to tell me what's wrong in my code please?
                        </div>
                        <hr />

                        <div class="post">
                          <p class="post-meta"><span class="post-author text-primary">Anders</span><br />
                          <span class="post-time small text-muted">22nd April 2010 18:35 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                          <p class="post-content"></p>

                          <blockquote>
                            <small>Originally posted by webtubbies</small><br />
                            Is there anybody to tell me what's wrong in my code please?
                          </blockquote>You are not checking that the nsisXML calls don't fail, if you did that you could maybe narrow down to the line that fails. What happens exactly, does it crash for example?<br />
                          <br />
                          (There is also a chance that CallAnsiPlugin has a bug, it was never tested with this plugin)
                        </div>
                        <hr />

                        <div class="post">
                          <p class="post-meta"><span class="post-author text-primary">webtubbies</span><br />
                          <span class="post-time small text-muted">22nd April 2010 19:37 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                          <p class="post-content"></p>

                          <blockquote>
                            <small>Originally posted by Anders</small><br />
                            You are not checking that the nsisXML calls don't fail, if you did that you could maybe narrow down to the line that fails. What happens exactly, does it crash for example?<br />
                            <br />
                            (There is also a chance that CallAnsiPlugin has a bug, it was never tested with this plugin)
                          </blockquote>Hi Anders,<br />
                          <br />
                          Actually, the first call (create) seems to be OK and then there is a crash of the exe.
                        </div>
                        <hr />

                        <div class="post">
                          <p class="post-meta"><span class="post-author text-primary">Anders</span><br />
                          <span class="post-time small text-muted">22nd April 2010 19:43 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                          <p class="post-content">nsisXML has a unicode version in the zip file, why can't you use that?</p>
                        </div>
                        <hr />

                        <div class="post">
                          <p class="post-meta"><span class="post-author text-primary">webtubbies</span><br />
                          <span class="post-time small text-muted">22nd April 2010 20:13 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                          <p class="post-content">@Anders:<br />
                          Yeah you're right, I was using an older version. I'll try tomorrow the Unicode version.<br />
                          Thank You for your time and sorry for the incovenience</p>
                        </div>
                        <hr />

                        <div class="post">
                          <p class="post-meta"><span class="post-author text-primary">Anders</span><br />
                          <span class="post-time small text-muted">22nd April 2010 20:32 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                          <p class="post-content">I also found a varsync bug in CallAnsiPlugin, so I will update the wiki later today with the fixed version</p>
                        </div>
                        <hr />

                        <div class="post">
                          <p class="post-meta"><span class="post-author text-primary">webtubbies</span><br />
                          <span class="post-time small text-muted">23rd April 2010 13:33 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                          <p class="post-content">Ok, the unicode nsisXML plugin works like a charm! thank You</p>
                        </div>
                        <hr />

                        <div class="post">
                          <p class="post-meta"><span class="post-author text-primary">Wizou</span><br />
                          <span class="post-time small text-muted">25th April 2010 19:31 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                          <p class="post-content"></p>

                          <blockquote>
                            <small>Originally posted by webtubbies</small><br />
                            Ok, the unicode nsisXML plugin works like a charm! thank You
                          </blockquote>you're welcome ;-)
                        </div>
                        <hr />

                        <div class="post">
                          <p class="post-meta"><span class="post-author text-primary">jimpark</span><br />
                          <span class="post-time small text-muted">29th April 2010 16:42 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                          <p class="post-content">Unicode NSIS 2.46 is finally released!</p>
                        </div>
                        <hr />

                        <div class="post">
                          <p class="post-meta"><span class="post-author text-primary">Pawel</span><br />
                          <span class="post-time small text-muted">29th April 2010 16:51 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                          <p class="post-content">Jim, thanks!<br />
                          -Pawel</p>
                        </div>
                        <hr />

                        <div class="post">
                          <p class="post-meta"><span class="post-author text-primary">gringoloco023</span><br />
                          <span class="post-time small text-muted">3rd June 2010 17:55 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                          <p class="post-content"><strong>Hi JimPark, first of all I want to thank you for the updates lately !</strong><br />
                          as well I should let you know about TextFunc.nsh<br />
                          it misses support for UTF-16LE files.<br />
                          <br />
                          I done a re-write of ${ConfigRead/Write} my self for now(see the attachment). I added the utf-16LE support within the same instruction by having it look for a BOM and handling the file accordingly. Hopefully all the other instructions can be done in a similar way.<br />
                          <br />
                          [edit: I just realized my re-write was a little buggy, as I forgot to reset the variable what indicates if there is a BOM or not. I re-uploaded, but just see it as an example !]</p>
                        </div>
                        <hr />

                        <div class="post">
                          <p class="post-meta"><span class="post-author text-primary">Wizou</span><br />
                          <span class="post-time small text-muted">4th June 2010 10:31 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                          <p class="post-content">I'm done porting NSIS sources to Unicode. It is now possible to compile NSIS sources (from Sourceforge repository) either as ANSI or UNICODE.<br />
                          I'm now working on making the Unicode version able to generate both ANSI &amp; Unicode installer, so we can make a switch and have everybody use a single (Unicode) version of makensis.exe</p>
                        </div>
                        <hr />

                        <div class="post">
                          <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
                          <span class="post-time small text-muted">4th June 2010 13:06 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                          <p class="post-content">Very nice. On the plug-in side of things, will ANSI plug-ins be defunct now?<br />
                          <br />
                          Stu</p>
                        </div>
                        <hr />

                        <div class="post">
                          <p class="post-meta"><span class="post-author text-primary">Wizou</span><br />
                          <span class="post-time small text-muted">4th June 2010 13:47 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                          <p class="post-content">No, because people wanting to target Windows 9x &amp; such still need ANSI installer &amp; ANSI plugins.<br />
                          However I have created a new version of the plugin API, mostly compatible with the current version, that allows plugins to work with both ANSI &amp; Unicode installer (even if the plugin itself is compiled as ANSI or Unicode), making the conversions transparently.<br />
                          I will commit that soon to SVN.</p>
                        </div>
                        <hr />

                        <div class="post">
                          <p class="post-meta"><span class="post-author text-primary">CrushBug</span><br />
                          <span class="post-time small text-muted">4th June 2010 22:50 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                          <p class="post-content">Hold it. Are you saying that there could be an official release from the main NSIS page with both ANSI and Unicode versions in the same package?<br />
                          <br />
                          If this is true, this is HUGE for us, as we are only allowed by our legal department to use the versions of NSIS that come from the main page/official site. We are not allowed to use other versions (Unicode NSIS from scratchpaper, etc.)</p>
                        </div>
                        <hr />

                        <div class="post">
                          <p class="post-meta"><span class="post-author text-primary">Anders</span><br />
                          <span class="post-time small text-muted">5th June 2010 07:41 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                          <p class="post-content">@CrushBug: Official SVN has working unicode build (It is pretty much the same code as the fork, at some point the merge will be complete hopefully)</p>
                        </div>
                        <hr />

                        <div class="post">
                          <p class="post-meta"><span class="post-author text-primary">Pawel</span><br />
                          <span class="post-time small text-muted">8th June 2010 10:01 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                          <p class="post-content"></p>

                          <blockquote>
                            <small>Originally posted by Wizou</small><br />
                            No, because people wanting to target Windows 9x &amp; such still need ANSI installer &amp; ANSI plugins.<br />
                            However I have created a new version of the plugin API, mostly compatible with the current version, that allows plugins to work with both ANSI &amp; Unicode installer (even if the plugin itself is compiled as ANSI or Unicode), making the conversions transparently.<br />
                            I will commit that soon to SVN.
                          </blockquote>Wizou,<br />
                          Is it possible to write src\Docs\src\*.but files with utf8 encoding (and Halibut could parse it and create output html files with default utf8 encoding, that HTML Help Help Workshop could compile to chm)?<br />
                          Would be much simple for me, if it use this codepage, not default windows.<br />
                          Could someone with skills look into it? Or, this is to much work, and it is not worth...<br />
                          -Pawel
                        </div>
                        <hr />

                        <div class="post">
                          <p class="post-meta"><span class="post-author text-primary">Wizou</span><br />
                          <span class="post-time small text-muted">8th June 2010 10:09 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                          <p class="post-content">I'm not much aware about Halibut, and your demand is quite independent from porting NSIS code to Unicode.. I guess I won't be doing that soon..<br />
                          Maybe someone else will look into it..</p>
                        </div>
                        <hr />

                        <div class="post">
                          <p class="post-meta"><span class="post-author text-primary">akatik</span><br />
                          <span class="post-time small text-muted">8th June 2010 13:15 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                          <p class="post-content">In Unicode NSIS this plug-in works incorrectly.<br />
                          <a href="http://nsis.sourceforge.net/IP_plug-in" target="_blank">http://nsis.sourceforge.net/IP_plug-in</a><br />
                          Is there any other plug-in to get IPs of the computer or may be anybody could help with the solution for this plug-in?</p>
                        </div>
                        <hr />

                        <div class="post">
                          <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
                          <span class="post-time small text-muted">8th June 2010 14:31 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                          <p class="post-content">If the plug-in is not Unicode then you will need to rebuild it.<br />
                          <br />
                          How about this? <a href="http://www.codeproject.com/KB/vbscript/ipaddress.aspx" target="_blank">http://www.codeproject.com/KB/vbscript/ipaddress.aspx</a><br />
                          <br />
                          Stu</p>
                        </div>
                        <hr />

                        <div class="post">
                          <p class="post-meta"><span class="post-author text-primary">akatik</span><br />
                          <span class="post-time small text-muted">9th June 2010 07:07 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                          <p class="post-content"></p>

                          <blockquote>
                            <small>Originally posted by Afrow UK</small><br />
                            If the plug-in is not Unicode then you will need to rebuild it.
                          </blockquote>Does rebuild mean anything more than compiling nsi-script via Make NSISW (Unicode) program? This plug-in is dll - how can I rebuild it?<br />
                          And also I failed to understand how and what for to use a2u.exe program.<br />
                          <br />

                          <blockquote>
                            <small>Originally posted by Afrow UK</small><br />
                            How about this? <a href="http://www.codeproject.com/KB/vbscript/ipaddress.aspx" target="_blank">http://www.codeproject.com/KB/vbscript/ipaddress.aspx</a>
                          </blockquote>Actually dll on C++ with code for determining IP-interfaces of the computer I'll create by myself. I was interested why former plug-in don't work.
                        </div>
                        <hr />

                        <div class="post">
                          <p class="post-meta"><span class="post-author text-primary">jpderuiter</span><br />
                          <span class="post-time small text-muted">9th June 2010 08:16 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                          <p class="post-content">To get the IP address, have a look at the IpConfig plugin:<br />
                          <a href="http://nsis.sourceforge.net/IpConfig_plugin" target="_blank">http://nsis.sourceforge.net/IpConfig_plugin</a></p>
                        </div>
                        <hr />
                        <!-- Bootstrap core CSS -->
                        <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
                        <!--[if lt IE 9]>
                <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
                <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->

                        <div class="container">
                          <!-- Put navigation bar here -->

                          <ol class="breadcrumb">
                            <li><a href="../index.html" class="glyphicon glyphicon-home"></a></li>

                            <li><a href="f-65.html">NSIS Discussion</a></li>

                            <li class="active">Unicode</li>
                          </ol>

                          <p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=277381">Unicode</a></p><br />

                          <div class="post">
                            <p class="post-meta"><span class="post-author text-primary">HrantOhanyan</span><br />
                            <span class="post-time small text-muted">30th July 2010 13:02 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                            <p class="post-content"><font face="Verdana"><font color="blue"><font size="4">Here the NSIS Armenian translation!</font></font></font></p>
                          </div>
                          <hr />

                          <div class="post">
                            <p class="post-meta"><span class="post-author text-primary">timufea</span><br />
                            <span class="post-time small text-muted">8th September 2010 12:36 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                            <p class="post-content"><strong>Building under Linux</strong><br />
                            I have downloaded nsis-2.46-Unicode-src.zip and am attempting to build the makensis utility under Linux. The command I am using is:<br />
                            <br /></p>

                            <blockquote>
                              scons UNICODE=yes SKIPSTUBS=all SKIPPLUGINS=all SKIPUTILS=all SKIPMISC=all NSIS_CONFIG_CONST_DATA_PATH=no PREFIX=/xp-e/Program\ Files/NSIS PREFIX_DEST=/tmp/nsis install-compiler
                            </blockquote>One minor problem was that I had to rename the 'Scons' directory to 'SCons'.<br />
                            <br />
                            A more serious problem are these errors:<br />
                            <br />

                            <blockquote>
                              In file included from Source/build.cpp:24:<br />
                              build/urelease/config/nsis-version.h:3:19: error: tchar.h: No such file or directory<br />
                              In file included from Source/manifest.h:22,<br />
                              from Source/build.h:30,<br />
                              from Source/build.cpp:26:<br />
                              Source/tstring.h:24:21: error: windows.h: No such file or directory<br />
                              In file included from Source/build.h:22,<br />
                              from Source/build.cpp:26:
                            </blockquote>tchar.h and windows.h are presumably MS Windows files, which wouldn't make a lot of sense for building a Linux executable.<br />
                            <br />
                            I can build a Linux version of makensis using the official (non-Unicode) version of nsis 2.46 without any problems.
                          </div>
                          <hr />

                          <div class="post">
                            <p class="post-meta"><span class="post-author text-primary">Anders</span><br />
                            <span class="post-time small text-muted">8th September 2010 14:32 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                            <p class="post-content">You could try the official SVN, it (should) compile as unicode now</p>
                          </div>
                          <hr />

                          <div class="post">
                            <p class="post-meta"><span class="post-author text-primary">timufea</span><br />
                            <span class="post-time small text-muted">8th September 2010 14:55 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                            <p class="post-content">Thanks Anders. I've just tried that, but a Linux build fails with the error "No version of Visual Studio compiler found".<br />
                            <br />
                            There's a note in the TODO.txt file: "Make Unicode version compile on other compilers / platforms.", so I guess that it currently only builds on Windows.</p>
                          </div>
                          <hr />

                          <div class="post">
                            <p class="post-meta"><span class="post-author text-primary">Anders</span><br />
                            <span class="post-time small text-muted">9th September 2010 11:01 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                            <p class="post-content">I don't really see how a VS compiler error message is related to unicode. Are you able to compile the ansi version? (TODO.txt has not been touched in years AFAIK)</p>
                          </div>
                          <hr />

                          <div class="post">
                            <p class="post-meta"><span class="post-author text-primary">timufea</span><br />
                            <span class="post-time small text-muted">9th September 2010 11:12 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                            <p class="post-content">I get the same error if I try to compile the SVN ANSI version (i.e. without the 'UNICODE=yes' option).<br />
                            <br />
                            The note in TODO.txt was added by 'wizou' on 2010-03-26.</p>
                          </div>
                          <hr />

                          <div class="post">
                            <p class="post-meta"><span class="post-author text-primary">Anders</span><br />
                            <span class="post-time small text-muted">10th September 2010 13:44 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                            <p class="post-content">The problem might be with scons and not nsis (scons did some major changes recently, try both 1.2 and 1.3 and whatever the latest version is) It might also help if you post the full scons command you used (I can't build the unicode version myself, so I can't really help there)</p>
                          </div>
                          <hr />

                          <div class="post">
                            <p class="post-meta"><span class="post-author text-primary">timufea</span><br />
                            <span class="post-time small text-muted">10th September 2010 14:04 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                            <p class="post-content">I was using scons 1.3.0, but I've just downloaded and tried the latest version (2.0.1) - unfortunately with the same symptoms. I don't have a copy of 1.2 to try. Version 1.3.0 works fine with nsis 2.46 - which makes it seem likely that something has changed in nsis.<br />
                            <br />
                            The full scons command that I am using is in my original post.</p>
                          </div>
                          <hr />

                          <div class="post">
                            <p class="post-meta"><span class="post-author text-primary">Anders</span><br />
                            <span class="post-time small text-muted">10th September 2010 14:34 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                            <p class="post-content"></p>

                            <blockquote>
                              <small>Originally posted by timufea</small><br />
                              The full scons command that I am using is in my original post.
                            </blockquote>Doh!<br />
                            <br />
                            I know I had to revert to scons 1.2 to build, but that is on windows. Why it tries to use the VS toolchain on POSIX, I have no idea. IIRC there is some scons switch you can use to force the toolchain, TOOLSET= maybe... (There are several older forum threads about building on POSIX, have you checked those for hints?)
                          </div>
                          <hr />

                          <div class="post">
                            <p class="post-meta"><span class="post-author text-primary">f0rt</span><br />
                            <span class="post-time small text-muted">12th September 2010 18:45 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                            <p class="post-content">It looks to me that the "No version of Visual Studio compiler found" issue was introduced by the "added MSVS_VERSION option to scons command-line to specify which compiler to use" change committed into the subversion repository as revision 6110.<br />
                            <br />
                            nsis.svn.sourceforge.net/viewvc/nsis/NSIS/trunk/SConstruct?r1=6102&amp;r2=6110<br />
                            <br />
                            A Microsoft Visual C++ build environment is explicitly defined In line 180 of the SConstruct file.<br />
                            In my humble opinion the build environment should be automatically detected by scons<br />
                            and an explicit definition of the build environment is counterproductive.<br />
                            <br />
                            I assume the same problem also occurs if you try to natively build on a Windows platform with mingw32 (www.mingw.org).</p>
                          </div>
                          <hr />

                          <div class="post">
                            <p class="post-meta"><span class="post-author text-primary">Anders</span><br />
                            <span class="post-time small text-muted">12th September 2010 19:29 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                            <p class="post-content">Yeah, I don't think wizou has done any testing on anything other than recent versions of VS</p>
                          </div>
                          <hr />

                          <div class="post">
                            <p class="post-meta"><span class="post-author text-primary">Wizou</span><br />
                            <span class="post-time small text-muted">12th September 2010 20:24 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                            <p class="post-content">I tried with VS 6.0, VS 7.1 Toolkit, VS 8.0 Express.<br />
                            Scons seemed to work with them.<br />
                            <br />
                            However, note that only VS 8.0 can be used to compile Unicode version of NSIS as only VS 8.0 contains a C++ Standard Runtime Library that contains the necessary Unicode classes.</p>
                          </div>
                          <hr />

                          <div class="post">
                            <p class="post-meta"><span class="post-author text-primary">nsnb</span><br />
                            <span class="post-time small text-muted">23rd September 2010 17:49 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                            <p class="post-content"><strong>Plans to Merge Unicode NSIS with Mainstream NSIS?</strong><br />
                            Quick question: Are there any plans to merge Unicode NSIS with mainstream NSIS?</p>
                          </div>
                          <hr />

                          <div class="post">
                            <p class="post-meta"><span class="post-author text-primary">Anders</span><br />
                            <span class="post-time small text-muted">23rd September 2010 20:27 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                            <p class="post-content"></p>

                            <blockquote>
                              <small>Originally posted by nsnb</small><br />
                              Quick question: Are there any plans to merge Unicode NSIS with mainstream NSIS?
                            </blockquote>The merging is almost complete, with the right setup, you can compile unicode nsis from the official SVN today
                          </div>
                          <hr />

                          <div class="post">
                            <p class="post-meta"><span class="post-author text-primary">MaGoth</span><br />
                            <span class="post-time small text-muted">28th September 2010 11:30 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                            <p class="post-content">Greetings :)<br />
                            Tell me please how to solve this problem:<br />
                            <br />
                            In the script calls<br />
                            <b>Code:</b><br />
                            System::Call 'msvfw32.dll::MCIWndCreate(i 0, i 0,i 0x0070, t "C:\1.mp3") i .r0'<br />
                            <br />
                            Depending on your line when you compile the setup file, the function either does not find the file 1.mp3, or can not identify the driver device via MCI, or compile the setup file does not complete and displays a message that the file test. Exe can not be created. :(<br />
                            <br />
                            In version Nsis ANSI this function works correctly. :rolleyes:<br />
                            Using version Nsis-Unicode (2.46)<br />
                            <br />
                            <br />
                            MfG MaGoth, WoG.ru-Community.</p>
                          </div>
                          <hr />

                          <div class="post">
                            <p class="post-meta"><span class="post-author text-primary">Anders</span><br />
                            <span class="post-time small text-muted">28th September 2010 16:42 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                            <p class="post-content">MCIWndCreateW maybe?</p>
                          </div>
                          <hr />

                          <div class="post">
                            <p class="post-meta"><span class="post-author text-primary">MaGoth</span><br />
                            <span class="post-time small text-muted">28th September 2010 17:38 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                            <p class="post-content"></p>

                            <blockquote>
                              <small>Originally posted by Anders</small><br />
                              MCIWndCreateW maybe?
                            </blockquote>Tnx.<br />
                            No, it does not WIN API, a generic driver for sound without using external players, only the operating system.<br />
                            This option will not work. He was tested the day before the first, like many others.<br />
                            <br />
                            The function works correctly, it was tested in parallel and in Nsis ANSI 2.46, the result of the compilation of which was fully working file test.exe. In this version the sound is!<br />
                            <br />
                            When compiling the same file in version Nsis UNICOD 2.46, errors occur.<br />
                            Hence the conclusion, this script unicode itself is not correctly passes parameters to this function. :(<br />
                            <br />
                            <br />
                            MfG MaGoth, WoG.ru-Community.
                          </div>
                          <hr />

                          <div class="post">
                            <p class="post-meta"><span class="post-author text-primary">Anders</span><br />
                            <span class="post-time small text-muted">28th September 2010 17:58 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                            <p class="post-content">does not work in 2.46 ansi either for me, so what do I know</p>
                          </div>
                          <hr />

                          <div class="post">
                            <p class="post-meta"><span class="post-author text-primary">Animaether</span><br />
                            <span class="post-time small text-muted">28th September 2010 18:27 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                            <p class="post-content"></p>
                            <pre>
<code>OutFile</code><span style="color: #DD0000">"$%temp%\temp.exe"<br /><br /></span><span style="color: #0000BB">Section<br />System</span><span style="color: #007700">::</span><span style="color: #0000BB">Call</span><span style="color: #DD0000">'msvfw32.dll::MCIWndCreate(i0,i0,i0x0070,t"c:\1.mp3")i.r0'<br /></span><span style="color: #0000BB">SendMessage</span><span style="color: #007700">$</span><span style="color: #0000BB">00x049000</span><span style="color: #007700">$</span><span style="color: #0000BB">1<br /><br />IntCmp</span><span style="color: #007700">$</span><span style="color: #0000BB">10nosup<br />SendMessage</span><span style="color: #007700">$</span><span style="color: #0000BB">00x04650</span><span style="color: #DD0000">"STR:play"<br /></span><span style="color: #0000BB">Sleep1000</span><span style="color: #FF8000">/*matchtosoundlengthotherwisethesoundimmediatelystopsplaying?*/<br /></span><span style="color: #0000BB">nosup</span><span style="color: #007700">:<br /></span><span style="color: #0000BB">SectionEnd
<br /></span>

<!-- php buffer end -->
                
                
                
</pre>
                            <hr />
                            <pre>
        
Edit: the 'sleep' only applies to Sections, presumably.. stick it in .onInit or .onGUIinit and it'll work fine (but that little window will be somewhere back in z-order)
                
</pre>
                          </div>
                          <hr />

                          <div class="post">
                            <p class="post-meta"><span class="post-author text-primary">MaGoth</span><br />
                            <span class="post-time small text-muted">28th September 2010 18:42 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                            <p class="post-content"></p>

                            <blockquote>
                              <small>Originally posted by Anders</small><br />
                              does not work in 2.46 ansi either for me, so what do I know
                            </blockquote><b>Test example:</b><br />
                            <br />
                            PHP Code:
                            <hr />
                            <code style="white-space:nowrap"><!-- php buffer start --></code><span style="color: #000000"><span style="color: #0000BB">OutFile</span><span style="color: #DD0000">"test.exe"<br /></span> <span style="color: #0000BB">SetCompressor</span><span style="color: #007700">/</span><span style="color: #0000BB">solidlzma<br /></span> <span style="color: #007700">!include</span><span style="color: #DD0000">"MUI2.nsh"<br /></span> <span style="color: #007700">!</span><span style="color: #0000BB">insertmacroMUI_PAGE_INSTFILES<br /></span> <span style="color: #007700">!</span><span style="color: #0000BB">insertmacroMUI_UNPAGE_INSTFILES<br /></span> <span style="color: #007700">!</span><span style="color: #0000BB">insertmacroMUI_LANGUAGE</span><span style="color: #DD0000">"English"<br />
                            <br /></span> <span style="color: #0000BB">Name</span><span style="color: #DD0000">"Test"<br /></span> <span style="color: #0000BB">ShowInstDetailsnevershow<br />
                            ShowUnInstDetailsnevershow<br /></span> <span style="color: #007700">Var</span><span style="color: #0000BB">hmci<br />
                            <br /></span> <span style="color: #007700">!</span><span style="color: #0000BB">defineAPP_NAME</span><span style="color: #DD0000">"mci.sound"<br /></span> <span style="color: #007700">!</span><span style="color: #0000BB">defineSND_NAME</span><span style="color: #DD0000">"1.mp3"<br />
                            <br /></span> <span style="color: #007700">Function.</span><span style="color: #0000BB">onInit<br />
                            SetOutPath$PLUGINSDIR<br />
                            File</span><span style="color: #DD0000">"${SND_NAME}"<br /></span> <span style="color: #0000BB">System</span><span style="color: #007700">::</span><span style="color: #0000BB">Call</span><span style="color: #DD0000">'msvfw32.dll::MCIWndCreate(i0,i0,i0,t"$TEMP\${SND_NAME}")i.r0'<br /></span> <span style="color: #0000BB">StrCpy$hmci</span><span style="color: #007700">$</span><span style="color: #0000BB">0<br />
                            SendMessage$hmci0x049000</span><span style="color: #007700">$</span><span style="color: #0000BB">0<br />
                            IntCmp</span><span style="color: #007700">$</span><span style="color: #0000BB">00nosup<br />
                            ShowWindow$hmciSW_HIDE<br />
                            SendMessage$hmci0x04650</span><span style="color: #DD0000">"STR:play"<br /></span> <span style="color: #0000BB">nosup</span><span style="color: #007700">:<br /></span> <span style="color: #0000BB">FunctionEnd<br />
                            <br />
                            Section</span><span style="color: #DD0000">"DummySection"</span><span style="color: #0000BB">SecDummy<br />
                            Sleep1000<br />
                            Sleep1000<br />
                            Sleep1000<br />
                            Sleep1000<br />
                            Sleep1000<br />
                            Sleep1000<br />
                            Sleep1000<br />
                            Sleep1000<br />
                            Sleep1000<br />
                            Sleep1000<br />
                            Sleep1000<br />
                            Sleep1000<br />
                            Sleep1000<br />
                            Sleep1000<br />
                            Sleep1000<br />
                            Sleep1000<br />
                            Sleep1000<br />
                            Sleep1000<br />
                            Sleep1000<br />
                            Sleep1000<br />
                            Sleep1000<br />
                            SendMessage$hmci</span><span style="color: #007700">${</span><span style="color: #0000BB">WM_CLOSE</span><span style="color: #007700">}</span><span style="color: #0000BB">00<br />
                            SectionEnd<br /></span></span> <!-- php buffer end -->
                            <hr />
                            For tests:<br />
                            1. Locate the file - 1.mp3 in the same folder as the script *.nsi.<br />
                            <br />
                            <br />
                            <b>PS.</b> Everything works fine in ANSI, but it does not work in UNICODE. :cry:<br />
                            <br />
                            <br />
                            MfG MaGoth, WoG.ru-Community.
                          </div>
                          <hr />

                          <div class="post">
                            <p class="post-meta"><span class="post-author text-primary">Animaether</span><br />
                            <span class="post-time small text-muted">28th September 2010 20:52 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                            <p class="post-content">Well, Anders' 'MCIWndCreate' suggestion is at least correct - and it should load the file just fine.<br />
                            A problem pops up getting it to actually play.. I have no idea what (combination of) flags 0x0465 is supposed to be.. but it's possible that it is an ANSI-specific (combination of) flags, with Unicode equivalents somewhere.<br />
                            <br />
                            But eyeing the MCI docs at MSDN tells me that it's probably better to just send MCI_PLAY for a simple single play anyway.<br />
                            <br />
                            But just to take things from the top...<br />
                            <br />
                            1. Your Script is setting the output path to $PLUGINSDIR, but you don't have InitPluginsDir anywhere before that. Add that first, just to be safe.<br />
                            <br />
                            2. Your system call then tries to load your sound file from $TEMP... replace that with $PLUGINSDIR.<br />
                            <br />
                            So now on to the actual commands... If you compile this as is, it will still say it can't find the file. That's because of using MCIWndCreate instead of MCIWndCreateW.<br />
                            <br />
                            3. Replace MCIWndCreate with MCIWndCreateW<br />
                            <br />
                            If you try now, you'll see that the file does get loaded okay, but it can't understand the "play" command ("The driver cannot recognize the specified command."). I don't know why not. But, as mentioned above, we can use MCI_PLAY instead.<br />
                            <br />
                            4. Replace...<br />
                            PHP Code:</p>
                            <hr />
                            <code style="white-space:nowrap"><!-- php buffer start --></code><span style="color: #000000"><span style="color: #0000BB">SendMessage$hmci0x04650</span><span style="color: #DD0000">"STR:play"</span> with<br /></span>
                            <pre>
<span style="color: #007700">!</span><span style="color: #0000BB">defineMCI_PLAY0x806<br />SendMessage$hmci</span><span style="color: #007700">${</span><span style="color: #0000BB">MCI_PLAY</span><span style="color: #007700">}</span><span style="color: #0000BB">00
<br /></span>

<!-- php buffer end -->
                
                
                
</pre>
                            <hr />
                            <pre>
        
The sound file should then play.
                
</pre>
                          </div>
                          <hr />

                          <div class="post">
                            <p class="post-meta"><span class="post-author text-primary">MaGoth</span><br />
                            <span class="post-time small text-muted">29th September 2010 18:11 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                            <p class="post-content"></p>

                            <blockquote>
                              <small>Originally posted by Animaether</small><br />
                              Well, Anders' 'MCIWndCreate' suggestion is at least correct - and it should load the file just fine.<br />
                              A problem pops up getting it to actually play.. I have no idea what (combination of) flags 0x0465 is supposed to be.. but it's possible that it is an ANSI-specific (combination of) flags, with Unicode equivalents somewhere.<br />
                              <br />
                              But eyeing the MCI docs at MSDN tells me that it's probably better to just send MCI_PLAY for a simple single play anyway.<br />
                              <br />
                              But just to take things from the top...<br />
                              <br />
                              <br />
                              1. Your Script is setting the output path to $PLUGINSDIR, but you don't have InitPluginsDir anywhere before that. Add that first, just to be safe.<br />
                              <br />
                              2. Your system call then tries to load your sound file from $TEMP... replace that with $PLUGINSDIR.<br />
                              <br />
                              So now on to the actual commands... If you compile this as is, it will still say it can't find the file. That's because of using MCIWndCreate instead of MCIWndCreateW.<br />
                              <br />
                              3. Replace MCIWndCreate with MCIWndCreateW<br />
                              <br />
                              If you try now, you'll see that the file does get loaded okay, but it can't understand the "play" command ("The driver cannot recognize the specified command."). I don't know why not. But, as mentioned above, we can use MCI_PLAY instead.
                            </blockquote>Yes, oddly enough, but the function you need to write it with a "W".<br />
                            MCI_PLAY - for me turned out to be useless, because I want to play multiple files at once. :rolleyes:<br />
                            <br />
                            1,2. It was just an example, but even using his program itself finds the necessary files. ;)<br />
                            <br />

                            <blockquote>
                              4. Replace...<br />
                              PHP Code:
                              <hr />
                              <code style="white-space:nowrap"><!-- php buffer start --></code><span style="color: #000000"><span style="color: #0000BB">SendMessage$hmci0x04650</span><span style="color: #DD0000">"STR:play"</span> with<br />
                              PHP Code:</span>
                              <hr />
                              <code style="white-space:nowrap"><!-- php buffer start --></code><span style="color: #000000"><span style="color: #007700">!</span><span style="color: #0000BB">defineMCI_PLAY0x806<br />
                              SendMessage$hmci</span><span style="color: #007700">${</span><span style="color: #0000BB">MCI_PLAY</span><span style="color: #007700">}</span><span style="color: #0000BB">00<br /></span></span> <!-- php buffer end -->
                              <hr />
                              The sound file should then play.
                            </blockquote>This code is not useful for me.<br />
                            But for the code change sound driver, thank you very much. I have changed a bit your code, using only the 0x806, and now I have everything works fine. :p<br />
                            <br />
                            <br />
                            @Animaether, Anders:<br />
                            Thank you guys. :up:<br />
                            <br />
                            <br />
                            MfG MaGoth, WoG.ru-Community.
                          </div>
                          <hr />

                          <div class="post">
                            <p class="post-meta"><span class="post-author text-primary">MaGoth</span><br />
                            <span class="post-time small text-muted">2nd October 2010 01:43 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                            <p class="post-content">Greetings, :)<br />
                            I have a small problem appeared again. Use this one plug-in for creating additional buttons with the conclusion of the message box:<br />
                            <a href="http://nsis.sourceforge.net/ButtonEvent_plug-in" target="_blank">http://nsis.sourceforge.net/ButtonEvent_plug-in</a><br />
                            <br />
                            Also, changed the file "modern.exe", adding to the 105-th section of the last row of the following:<br />
                            PHP Code:</p>
                            <hr />
                            <code style="white-space:nowrap"><!-- php buffer start --></code><span style="color: #000000"><span style="color: #0000BB">CONTROL</span><span style="color: #DD0000">""</span><span style="color: #007700">,</span><span style="color: #0000BB">1190</span><span style="color: #007700">,</span><span style="color: #0000BB">BUTTON</span><span style="color: #007700">,</span><span style="color: #0000BB">BS_PUSHBUTTON</span><span style="color: #007700">|</span><span style="color: #0000BB">WS_CHILD</span><span style="color: #007700">|</span><span style="color: #0000BB">WS_VISIBLE</span><span style="color: #007700">|</span><span style="color: #0000BB">WS_TABSTOP</span><span style="color: #007700">,</span><span style="color: #0000BB">7</span><span style="color: #007700">,</span><span style="color: #0000BB">201</span><span style="color: #007700">,</span><span style="color: #0000BB">50</span><span style="color: #007700">,</span><span style="color: #0000BB">14<br /></span></span> <!-- php buffer end -->
                            <hr />
                            Example script:<br />
                            PHP Code:
                            <hr />
                            <code style="white-space:nowrap"><!-- php buffer start --></code><span style="color: #000000"><span style="color: #007700">!include</span><span style="color: #DD0000">"MUI.nsh"<br /></span> <span style="color: #007700">!include</span><span style="color: #DD0000">"LogicLib.nsh"<br /></span> <span style="color: #007700">!</span><span style="color: #0000BB">defineIDC_BUTTON_TRYME1190<br />
                            <br />
                            Name</span><span style="color: #DD0000">"ButtonEventExample"<br /></span> <span style="color: #0000BB">OutFile</span><span style="color: #DD0000">"ButtonEventMUI.exe"<br />
                            <br /></span> <span style="color: #007700">!</span><span style="color: #0000BB">defineMUI_PAGE_CUSTOMFUNCTION_SHOWInstFilesShow<br /></span> <span style="color: #007700">!</span><span style="color: #0000BB">insertmacroMUI_PAGE_INSTFILES<br /></span> <span style="color: #007700">!</span><span style="color: #0000BB">insertmacroMUI_LANGUAGE</span><span style="color: #DD0000">"English"<br />
                            <br /></span> <span style="color: #007700">Function</span><span style="color: #0000BB">TryMe<br />
                            MessageBoxMB_OK</span><span style="color: #DD0000">"Bla-Bla-blaaaa"<br /></span> <span style="color: #0000BB">Abort<br />
                            FunctionEnd<br />
                            <br /></span> <span style="color: #007700">Function</span><span style="color: #0000BB">InstFilesShow<br />
                            GetFunctionAddress$R0TryMe<br />
                            ButtonEvent</span><span style="color: #007700">::</span><span style="color: #0000BB">AddEventHandler</span><span style="color: #007700">/</span><span style="color: #0000BB">NOUNLOAD</span><span style="color: #007700">${</span><span style="color: #0000BB">IDC_BUTTON_TRYME</span><span style="color: #007700">}</span><span style="color: #0000BB">$R0<br />
                            GetDlgItem$R0$HWNDPARENT</span><span style="color: #007700">${</span><span style="color: #0000BB">IDC_BUTTON_TRYME</span><span style="color: #007700">}<br /></span> <span style="color: #0000BB">SendMessage$R0</span><span style="color: #007700">${</span><span style="color: #0000BB">WM_SETTEXT</span><span style="color: #007700">}</span><span style="color: #0000BB">0</span><span style="color: #DD0000">"STR:Info"<br /></span> <span style="color: #0000BB">EnableWindow$R01<br />
                            FunctionEnd<br />
                            <br /></span> <span style="color: #007700">Function.</span><span style="color: #0000BB">onGUIEnd<br />
                            ButtonEvent</span><span style="color: #007700">::</span><span style="color: #0000BB">Unload<br />
                            FunctionEnd<br />
                            <br />
                            Section</span><span style="color: #DD0000">"Dummy"</span><span style="color: #0000BB">SecDummy<br />
                            Sleep1000<br />
                            SectionEnd<br /></span></span> <!-- php buffer end -->
                            <hr />
                            When you compile a version Nsis ANSI message when you click on the button displayed.<br />
                            When you compile a version Nsis UNICOD, no message, although compilation is successful.<br />
                            <br />
                            Can somebody adapt this plugin version ANSI to UNICODE?! :rolleyes:<br />
                            <br />
                            <b>Ps.</b> Sorry for my dablpost.<br />
                            <br />
                            <br />
                            MfG MaGoth, WoG.ru-Community.
                          </div>
                          <hr />

                          <div class="post">
                            <p class="post-meta"><span class="post-author text-primary">noisebar</span><br />
                            <span class="post-time small text-muted">6th October 2010 05:28 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                            <p class="post-content"><strong>String returned from install location text box</strong><br />
                            I think the string returned from the install location text box used to be UTF16. But now it seems to be UTF8. Is this assumption correct?</p>
                          </div>
                          <hr />

                          <div class="post">
                            <p class="post-meta"><span class="post-author text-primary">greenh</span><br />
                            <span class="post-time small text-muted">4th November 2010 20:47 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                            <p class="post-content"><strong>compilation problem</strong><br />
                            uname -a<br />
                            FreeBSD nw3 7.3-STABLE FreeBSD 7.3-STABLE #0: Fri Oct 15 18:26:08 MSD 2010 root@nw3:/usr/src/sys/i386/compile/GREENH i386<br />
                            nsis unicode nsis-2.45.1 and 2.46<br /></p>

                            <blockquote>
                              # scons<br />
                              scons: Reading SConscript files ...<br />
                              <br />
                              scons: warning: Ignoring missing SConscript 'SCons/utils.py'<br />
                              File "/root/nsis3/SConstruct", line 79, in &lt;module&gt;<br />
                              <br />
                              scons: warning: Ignoring missing SConscript 'SCons/config.py'<br />
                              File "/root/nsis3/SConstruct", line 98, in &lt;module&gt;<br />
                              KeyError: 'NSIS_CPPDEFINES':<br />
                              File "/root/nsis3/SConstruct", line 122:<br />
                              if 'NSIS_CONFIG_CONST_DATA_PATH' in defenv['NSIS_CPPDEFINES']:<br />
                              File "/usr/local/lib/scons-1.3.0/SCons/Environment.py", line 411:<br />
                              return self._dict[key]
                            </blockquote>files SCons/utils.py and SCons/config.py - exist<br />
                            help me pls. What can it be?
                          </div>
                          <hr />

                          <div class="post">
                            <p class="post-meta"><span class="post-author text-primary">taralex</span><br />
                            <span class="post-time small text-muted">9th November 2010 20:19 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                            <p class="post-content">My HwInfo plugin returns junk now that I switched to unicode. is there a unicode build of HwInfo available?</p>
                          </div>
                          <hr />

                          <div class="post">
                            <p class="post-meta"><span class="post-author text-primary">MSG</span><br />
                            <span class="post-time small text-muted">10th November 2010 07:23 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                            <p class="post-content">I don't know if there's a unicode version, but have you tried using the CallAnsiPlugin plug-in?</p>
                          </div>
                          <hr />

                          <div class="post">
                            <p class="post-meta"><span class="post-author text-primary">taralex</span><br />
                            <span class="post-time small text-muted">10th November 2010 21:34 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                            <p class="post-content">no, but I solved that by writing my own .net dll, where getting this info is pretty easy.<br />
                            Had to modify <a href="http://nsis.sourceforge.net/Call_.NET_DLL_methods_plug-in" target="_blank">this plug-in</a> to make it work with Unicode though. Added a link to the modified version to the Viki page.</p>
                          </div>
                          <hr />

                          <div class="post">
                            <p class="post-meta"><span class="post-author text-primary">MSG</span><br />
                            <span class="post-time small text-muted">11th November 2010 06:28 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                            <p class="post-content">Mind you that using .NET requires .NET to be installed. Your installer would never work on any of my PC's.</p>
                          </div>
                          <hr />

                          <div class="post">
                            <p class="post-meta"><span class="post-author text-primary">taralex</span><br />
                            <span class="post-time small text-muted">11th November 2010 13:55 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                            <p class="post-content">the product I'm installing requires .net 2.0, so I check for that first thing in the install and install it if it's not there.</p>
                          </div>
                          <hr />

                          <div class="post">
                            <p class="post-meta"><span class="post-author text-primary">taralex</span><br />
                            <span class="post-time small text-muted">15th November 2010 17:15 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                            <p class="post-content">is logging enabled in the Unicode nsis build?</p>
                          </div>
                          <hr />

                          <div class="post">
                            <p class="post-meta"><span class="post-author text-primary">mrphantuan</span><br />
                            <span class="post-time small text-muted">16th November 2010 03:43 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                            <p class="post-content">7-zip expects a very specific format from the installer. One of its assumptions is that the string table is saved as ANSI. It's not such a faulty assumption when you add in the no-real-nsis-binary-specification factor.<br />
                            <br />
                            <br />
                            ___________________<br />
                            my name: mrTuan|My site:<a href="http://duhochoaky.edu.vn" target="_blank">du hoc my</a></p>
                          </div>
                          <hr />

                          <div class="post">
                            <p class="post-meta"><span class="post-author text-primary">noisebar</span><br />
                            <span class="post-time small text-muted">8th December 2010 05:08 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                            <p class="post-content">Hey guys,<br />
                            <br />
                            Does anyone of you might know where I can find the source code for unicode build version 2.35? It's the version we are currently using. Unfortunately, it has the PCA problem. We don't really want to spend the time upgrading to newer version because it's working fine for us except for this one problem. So we'd like to just apply the manifest change and rebuild NSIS. But it seems that all the history got lost when the source code repository was moved to Google Code. You can only get version 2.46 from there. So I'd really appreciate if somebody still has the source code for 2.35.</p>
                          </div>
                          <hr />

                          <div class="post">
                            <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
                            <span class="post-time small text-muted">8th December 2010 11:36 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                            <p class="post-content">I see no reason to keep using that version. Upgrading takes a couple of seconds and you are guaranteed backwards compatibility unless you have modified NSIS's own files yourself.<br />
                            <br />
                            Stu</p>
                          </div>
                          <hr />

                          <div class="post">
                            <p class="post-meta"><span class="post-author text-primary">Anders</span><br />
                            <span class="post-time small text-muted">8th December 2010 13:45 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                            <p class="post-content"></p>

                            <blockquote>
                              <small>Originally posted by Afrow UK</small><br />
                              I see no reason to keep using that version. Upgrading takes a couple of seconds and you are guaranteed backwards compatibility unless you have modified NSIS's own files yourself.<br />
                              <br />
                              Stu
                            </blockquote>The old versions will compile with vc6, the new versions do not
                          </div>
                          <hr />

                          <div class="post">
                            <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
                            <span class="post-time small text-muted">8th December 2010 15:27 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                            <p class="post-content">How about VS 2010 Express?<br />
                            <br />
                            Stu</p>
                          </div>
                          <hr />

                          <div class="post">
                            <p class="post-meta"><span class="post-author text-primary">mzd</span><br />
                            <span class="post-time small text-muted">29th December 2010 19:36 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                            <p class="post-content"><strong>Logging support for Unicode version</strong><br />
                            Hello,<br />
                            <br />
                            Thank you for this port. I am interested in enableing logging using LogSet and then logging using LogText. It seems that the Unicode distributions don't turn on logging. The non-unicode distributions have a "special build" for makenisis which has logging enabled. Is there a similar "special build" with logging enabled for the unicode port?<br />
                            <br />
                            Thanks,<br />
                            <br />
                            mzd</p>
                          </div>
                          <hr />

                          <div class="post">
                            <p class="post-meta"><span class="post-author text-primary">mrphantuan</span><br />
                            <span class="post-time small text-muted">2nd January 2011 18:13 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                            <p class="post-content">@Wizou: If you check my BgWorker plugin, you can see that I'm checking for kernel32::lstrcatW in the import table.<br />
                            <br />
                            I also have some sample code in there that checks $pluginsdir, but like you said, you don't know the offset, so it has to use IsBadReadPtr() and there could be false positives.<br />
                            <br />
                            Unfortunately, it turns out that writing hybrid plugins is a huge pain in the ass, and I can't recommend doing it on anything except very simple plugins<br />
                            <br />
                            <br />
                            <br />
                            <br />
                            <br />
                            _______________<br />
                            <br />
                            [ADMIN EDIT]<br />
                            Warning: Spam(?) links removed!</p>
                          </div>
                          <hr />

                          <div class="post">
                            <p class="post-meta"><span class="post-author text-primary">Wizou</span><br />
                            <span class="post-time small text-muted">3rd January 2011 11:13 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                            <p class="post-content">@mrphantuan: I don't know which post you are referring to exactly..<br />
                            However, regarding hybrid ANSI/Unicode plugins, I have changed my mind and consider it now also a bad idea to try to create such plugins.<br />
                            And so I don't plan anymore on committing a plugin API that would work transparently with ANSI &amp; Unicode.<br />
                            It is just simpler for plugin author to build 2 separate DLL variant, one for ANSI, one for Unicode.<br />
                            <br />
                            And my recommendation for compatibility with Unicode NSIS automatic plugin variant detection, is to name the ANSI version "MyPlugin.dll" and the Unicode version "MyPluginW.dll" and offer them in the same folder.</p>
                          </div>
                          <hr />

                          <div class="post">
                            <p class="post-meta"><span class="post-author text-primary">Anders</span><br />
                            <span class="post-time small text-muted">3rd January 2011 11:36 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                            <p class="post-content"></p>

                            <blockquote>
                              <small>Originally posted by Wizou</small><br />
                              @mrphantuan: I don't know which post you are referring to exactly..
                            </blockquote>I believe that is something I posted, why he posted it now, I have no idea.<br />
                            <br />
                            And yes, a single dll for both versions is possible, but just to much work in practice, just use TCHAR and compile two versions...
                          </div>
                          <hr />
                          <!-- Bootstrap core CSS -->
                          <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
                          <!--[if lt IE 9]>
                <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
                <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->

                          <div class="container">
                            <!-- Put navigation bar here -->

                            <ol class="breadcrumb">
                              <li><a href="../index.html" class="glyphicon glyphicon-home"></a></li>

                              <li><a href="f-65.html">NSIS Discussion</a></li>

                              <li class="active">Unicode</li>
                            </ol>

                            <p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=277381">Unicode</a></p><br />

                            <div class="post">
                              <p class="post-meta"><span class="post-author text-primary">mzd</span><br />
                              <span class="post-time small text-muted">19th January 2011 20:03 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                              <p class="post-content"><strong>Logging support for unicode version</strong><br />
                              Hello All,<br />
                              <br />
                              I appears to me that all queries regarding logging support in the unicode port are being ignored. So, here goes again: is there any support for logging using LogSet in the unicode port. I have not yet understood the motivation behind turning off such a basic feature in any scripting language and especially in an install tool.<br />
                              <br />
                              Thanks,<br />
                              <br />
                              -mzd</p>
                            </div>
                            <hr />

                            <div class="post">
                              <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
                              <span class="post-time small text-muted">19th January 2011 20:21 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                              <p class="post-content">It is turned off because it adds extra overhead to the installer. You'll have wait for kichik or someone with greater knowledge of the internals of NSIS to explain why such a feature cannot be toggled dynamically at installer compile time though. Perhaps when logging was implemented the developers didn't think of allowing dynamic enabling, or that the amount of work required was unnecessary. Sometimes using C compile time directives (#if ... #endif) with separate builds of a product is much simpler. Now that the code base is so large it'd probably be a lot of work to change now.<br />
                              <br />
                              Edit: When the next version of NSIS is released which is Unicode, you will have a logging build then (<a href="http://nsis.sf.net/Special_Builds" target="_blank">http://nsis.sf.net/Special_Builds</a>). For now you will just have to rebuild. You just need to install a few things to build; nothing that will cost you anything.<br />
                              <br />
                              Stu</p>
                            </div>
                            <hr />

                            <div class="post">
                              <p class="post-meta"><span class="post-author text-primary">mzd</span><br />
                              <span class="post-time small text-muted">19th January 2011 20:47 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                              <p class="post-content">@afrowuk.<br />
                              <br />
                              Appreciate the response. Rebuild is an option, but not for me, since I don't own the build tools. The NSIS distribution is shared with other products and I am not at liberty to replace it with a custom build. It needs to be a published release ( a published special build distribution is ok ).<br />
                              <br />
                              You mentioned that the next version of NSIS will be unicode enabled. Is that 2.47+?<br />
                              Any insights in to the timeframe? Anyway, these are queries for the general NSIS Discussion forum.<br />
                              <br />
                              Thanks,<br />
                              <br />
                              -mzd</p>
                            </div>
                            <hr />

                            <div class="post">
                              <p class="post-meta"><span class="post-author text-primary">CrushBug</span><br />
                              <span class="post-time small text-muted">19th January 2011 21:49 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                              <p class="post-content">Go, go, NSIS Unicode version!</p>
                            </div>
                            <hr />

                            <div class="post">
                              <p class="post-meta"><span class="post-author text-primary">DrO</span><br />
                              <span class="post-time small text-muted">20th January 2011 10:36 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                              <p class="post-content"></p>

                              <blockquote>
                                <small>Originally posted by mzd</small><br />
                                It needs to be a published release ( a published special build distribution is ok ).
                              </blockquote>as this unicode build isn't really an official version then it's not too surprising no logging version was offered and would assume that any 'official' unicode versions would have a logging version providing along with the large string version (unless plans, etc have changed in that respect).<br />
                              <br />

                              <blockquote>
                                <small>Originally posted by mzd</small><br />
                                You mentioned that the next version of NSIS will be unicode enabled. Is that 2.47+? Any insights in to the timeframe?
                              </blockquote>it looks like it'd be 2.50 based on what's in cvs / help docs though i guess that might change and i think the timeframe is when it's done and ready. as work keeps starting / stopping on it, things seem to be taking longer than i guess it was hoped to have been.<br />
                              <br />
                              -daz
                            </div>
                            <hr />

                            <div class="post">
                              <p class="post-meta"><span class="post-author text-primary">Anders</span><br />
                              <span class="post-time small text-muted">21st January 2011 17:11 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                              <p class="post-content"></p>

                              <blockquote>
                                <small>Originally posted by DrO</small><br />
                                it looks like it'd be 2.50 based on what's in cvs / help docs...
                              </blockquote>I think that number was just a placeholder used by the fork
                            </div>
                            <hr />

                            <div class="post">
                              <p class="post-meta"><span class="post-author text-primary">pabs</span><br />
                              <span class="post-time small text-muted">18th May 2011 03:48 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                              <p class="post-content"><strong>status?</strong><br />
                              Whats the status of the Unicode support in SVN?<br />
                              <br />
                              Actually, what is the status of SVN itself, right now I can't even seem to build makensis from SVN on Linux, it complains about tchar.h being missing.</p>
                            </div>
                            <hr />

                            <div class="post">
                              <p class="post-meta"><span class="post-author text-primary">jimpark</span><br />
                              <span class="post-time small text-muted">18th May 2011 16:13 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                              <p class="post-content">mzd, sorry about not replying to this forum earlier. For some reason, my auto notification to a new message got lost. I just uploaded a logging version for you. You should see it in the download section of <a href="http://www.scratchpaper.com" target="_blank">www.scratchpaper.com</a>.</p>
                            </div>
                            <hr />

                            <div class="post">
                              <p class="post-meta"><span class="post-author text-primary">Anders</span><br />
                              <span class="post-time small text-muted">18th May 2011 21:22 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                              <p class="post-content"></p>

                              <blockquote>
                                <small>Originally posted by pabs</small><br />
                                Whats the status of the Unicode support in SVN?<br />
                                <br />
                                Actually, what is the status of SVN itself, right now I can't even seem to build makensis from SVN on Linux, it complains about tchar.h being missing.
                              </blockquote>Nobody has touched the unicode stuff in a while, don't get your hopes up about this ever getting fixed. (You might be able to compile with VS2005+, otherwise you are out of luck)
                            </div>
                            <hr />

                            <div class="post">
                              <p class="post-meta"><span class="post-author text-primary">MSG</span><br />
                              <span class="post-time small text-muted">19th May 2011 05:09 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                              <p class="post-content">So, I guess it's unlikely that there will ever be a new version of NSIS, then?</p>
                            </div>
                            <hr />

                            <div class="post">
                              <p class="post-meta"><span class="post-author text-primary">Anders</span><br />
                              <span class="post-time small text-muted">19th May 2011 17:18 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                              <p class="post-content"></p>

                              <blockquote>
                                <small>Originally posted by MSG</small><br />
                                So, I guess it's unlikely that there will ever be a new version of NSIS, then?
                              </blockquote>We can still do ansi builds...
                            </div>
                            <hr />

                            <div class="post">
                              <p class="post-meta"><span class="post-author text-primary">MSG</span><br />
                              <span class="post-time small text-muted">20th May 2011 06:01 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                              <p class="post-content">I'm all for that, I'm sure, but I'm thinking that would require some amount of decisive effort on the devs' part, what with the year and a half hiatus?</p>
                            </div>
                            <hr />

                            <div class="post">
                              <p class="post-meta"><span class="post-author text-primary">Anders</span><br />
                              <span class="post-time small text-muted">20th May 2011 18:13 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                              <p class="post-content"></p>

                              <blockquote>
                                <small>Originally posted by MSG</small><br />
                                I'm all for that, I'm sure, but I'm thinking that would require some amount of decisive effort on the devs' part, what with the year and a half hiatus?
                              </blockquote>All the unicode changes are inside #ifdef UNICODE blocks...
                            </div>
                            <hr />

                            <div class="post">
                              <p class="post-meta"><span class="post-author text-primary">pabs</span><br />
                              <span class="post-time small text-muted">15th June 2011 03:54 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                              <p class="post-content"></p>

                              <blockquote>
                                <small>Originally posted by Anders</small><br />
                                We can still do ansi builds...
                              </blockquote>Except for on Linux (needs tchar.h)... hmm, mingw-w64 has tchar.h, I guess the cross-compile checks are in need of an update for the new toolchains.
                            </div>
                            <hr />

                            <div class="post">
                              <p class="post-meta"><span class="post-author text-primary">Anders</span><br />
                              <span class="post-time small text-muted">15th June 2011 15:20 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                              <p class="post-content"></p>

                              <blockquote>
                                <small>Originally posted by pabs</small><br />
                                Except for on Linux (needs tchar.h)... hmm, mingw-w64 has tchar.h, I guess the cross-compile checks are in need of an update for the new toolchains.
                              </blockquote>I'm going to try to fix all the ansi problems, but I'm not sure if we should move to mingw-w64 or stick with the original. Anyways, we probably need our own tchar.h or hacks in platform.h since not all compilers/CRT agree on how swprintf works.
                            </div>
                            <hr />

                            <div class="post">
                              <p class="post-meta"><span class="post-author text-primary">noeld</span><br />
                              <span class="post-time small text-muted">16th June 2011 18:58 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                              <p class="post-content"><strong>NSIS Unicode High-DPI Awareness?</strong><br />
                              Hello all,<br />
                              <br />
                              Is there any way to enable High-DPI awareness in an NSIS Unicode installer? Currently it seems to rely on display scaling in Windows 7 which does not look really good on high-DPI screens.<br />
                              <br />
                              High-DPI awareness requires a manifest as describe in the article at:<br />
                              <a href="http://msdn.microsoft.com/en-us/library/dd464660(v=vs.85).aspx" target="_blank">http://msdn.microsoft.com/en-us/libr...(v=vs.85).aspx</a> (Declaring DPI Awareness)<br />
                              <br />
                              I tried to use mt.exe to apply the DeclareDPIAware.manifest but after that I get a message that the installer integrity check failed.<br />
                              <br />
                              If this is not currently supported, could this be considered for an upcoming version? Thank you.</p>
                            </div>
                            <hr />

                            <div class="post">
                              <p class="post-meta"><span class="post-author text-primary">Anders</span><br />
                              <span class="post-time small text-muted">16th June 2011 20:24 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                              <p class="post-content"></p>

                              <blockquote>
                                <small>Originally posted by noeld</small><br />
                                Hello all,<br />
                                <br />
                                Is there any way to enable High-DPI awareness in an NSIS Unicode installer? Currently it seems to rely on display scaling in Windows 7 which does not look really good on high-DPI screens.
                              </blockquote>You could try system::call 'user32::SetProcessDPIAware()' in .onInit, if that does not work you two other options:<br />
                              <br />
                              A) Use !packhdr and resource hacker to change the manifest (Or maybe mt.exe, who knows)<br />
                              <br />
                              B) Recompile from source
                            </div>
                            <hr />

                            <div class="post">
                              <p class="post-meta"><span class="post-author text-primary">Anders</span><br />
                              <span class="post-time small text-muted">16th June 2011 20:29 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                              <p class="post-content"></p>

                              <blockquote>
                                <small>Originally posted by pabs</small><br />
                                Except for on Linux (needs tchar.h)... hmm, mingw-w64 has tchar.h, I guess the cross-compile checks are in need of an update for the new toolchains.
                              </blockquote>I'm now able to compile (ansi) with MinGW, get latest source from SVN and add these changes:<br />
                              <br />
                              Quote:
                              <hr />
                              And you need to rename Call.S to Call.sx if you want to compile system.dll<br />
                              <br />
                              I did not add the substart change to SVN since it is a bit of a hack, it would be better if we actually fixed the SCons stuff.<br />
                              <br />
                              Not sure what to do about the Call.S issue, it might be SCons/MinGW version specific.

                              <table cellpadding="6" cellspacing="0" border="0" width="100%">
                                <tr>
                                  <td class="alt2">
                                    <hr />
                                    --- SConscript-HEAD<br />
                                    +++ /trunk/Contrib/SubStart/SConscript Thu Jun 16 19:42:13 2011<br />
                                    @@ -9,8 +9,7 @@<br />
                                    libs = Split("""<br />
                                    """)<br />
                                    <br />
                                    -Import('BuildUtil')<br />
                                    -<br />
                                    -substart = BuildUtil(target, files, libs)<br />
                                    -<br />
                                    -env.DistributeBin(substart, names=['makensis.exe'], alias='install-compiler') # install as makensis<br />
                                    +if env['PLATFORM'] == 'win32': #Using cross_platform = True just to force console app in PE header...<br />
                                    + Import('BuildUtil')<br />
                                    + substart = BuildUtil(target, files, libs, cross_platform = True)<br />
                                    + env.DistributeBin(substart, names=['makensis.exe'], alias='install-compiler') # install as makensis
                                    <hr />
                                  </td>
                                </tr>
                              </table><br />

                              <div class="post">
                                <p class="post-meta"><span class="post-author text-primary">noeld</span><br />
                                <span class="post-time small text-muted">16th June 2011 22:14 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                                <p class="post-content">Thanks Anders,<br />
                                <br />
                                system::call 'user32::SetProcessDPIAware()' in .onInit and un.onInit seems to work just fine. Some text looks a bit small but this should be ok for now.</p>
                              </div>
                              <hr />

                              <div class="post">
                                <p class="post-meta"><span class="post-author text-primary">noeld</span><br />
                                <span class="post-time small text-muted">8th July 2011 15:23 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                                <p class="post-content"><strong>Changing default font size</strong><br />
                                Now that I am able to build a High-DPI aware NSIS, I'd like to be able to make the default fonts larger (and consequently the size of the dialog boxes) so that the text (all statics, buttons, etc.) is easier to read on large screen with high DPI.<br />
                                <br />
                                Is it possible to change the default font size when the installer starts so that the size of the default font is adjusted based on the current custom DPI setting in Windows Control Panel? If yes, how can I do that?<br />
                                <br />
                                Thank you.</p>
                              </div>
                              <hr />

                              <div class="post">
                                <p class="post-meta"><span class="post-author text-primary">Anders</span><br />
                                <span class="post-time small text-muted">9th July 2011 01:05 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                                <p class="post-content">For Win95 to 2003, the correct font to use is MS Shell Dlg @ 8pt and that is what we are using. MS messed things up with Vista (Segoe needs to be 9pt)</p>
                              </div>
                              <hr />

                              <div class="post">
                                <p class="post-meta"><span class="post-author text-primary">noeld</span><br />
                                <span class="post-time small text-muted">9th July 2011 10:15 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                                <p class="post-content">Could you recommend a way to handle this? Is this enough to correctly handle both low and high DPI displays? Thank you.</p>
                              </div>
                              <hr />

                              <div class="post">
                                <p class="post-meta"><span class="post-author text-primary">Instructor</span><br />
                                <span class="post-time small text-muted">30th July 2011 13:37 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                                <p class="post-content"></p>

                                <blockquote>
                                  <small>Originally posted by Instructor</small><br />
                                  How plugin can detect that it has been called from Unicode NSIS or from Ansi NSIS? Maybe add some new parameter in "extra_parameters" structure.
                                </blockquote>Found the workaround, maybe for someone it will be useful:<br />
                                <pre>
<code>stack_t **g_stacktop;<br />char *g_variables;<br />unsigned int g_stringsize;<br />extra_parameters *g_pluginParms;<br />BOOL g_unicode;<br /><br />#define EXDLL_INIT()         \<br />{                            \<br />  g_stacktop=stacktop;       \<br />  g_variables=variables;     \<br />  g_stringsize=string_size;  \<br />  g_pluginParms=extra;       \<br />  {                                                     \<br />    wchar_t wszPath[]=L"C:\\";                          \<br />    g_pluginParms-&gt;validate_filename((char *)wszPath);  \<br />    g_unicode=(wszPath[2] == L'\\')?FALSE:TRUE;         \<br />  }                                                     \<br />}<br /></code>
</pre>
                              </div>
                              <hr />

                              <div class="post">
                                <p class="post-meta"><span class="post-author text-primary">Instructor</span><br />
                                <span class="post-time small text-muted">30th July 2011 20:51 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                                <p class="post-content">Or more optimized:<br /></p>
                                <pre>
<code>stack_t **g_stacktop;<br />char *g_variables;<br />unsigned int g_stringsize;<br />extra_parameters *g_pluginParms;<br />BOOL g_unicode=-1;<br /><br />#define EXDLL_INIT()         \<br />{                            \<br />  g_stacktop=stacktop;       \<br />  g_variables=variables;     \<br />  g_stringsize=string_size;  \<br />  g_pluginParms=extra;       \<br />  if (g_unicode == -1)                                  \<br />  {                                                     \<br />    wchar_t wszPath[]=L"C:\\";                          \<br />    g_pluginParms-&gt;validate_filename((char *)wszPath);  \<br />    g_unicode=(wszPath[2] == L'\\')?FALSE:TRUE;         \<br />  }                                                     \<br />}<br /></code>
</pre>
                              </div>
                              <hr />

                              <div class="post">
                                <p class="post-meta"><span class="post-author text-primary">nwightman</span><br />
                                <span class="post-time small text-muted">30th August 2011 16:02 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                                <p class="post-content">Hello.<br />
                                <br />
                                The unicode installer works great for me, but in some locations strings are not displayed correctly.<br />
                                <br />
                                All the calls which are displayed wrong seem to be coming from<br />
                                !insertmacro INSTALLOPTIONS_WRITE "DatabaseServer.ini" "Field 1" "text" "$(MSG118)"<br />
                                type calls.<br />
                                <br />
                                Does the InstallOptions.nsh script not work for Unicode?<br />
                                <br />
                                Thanks</p>
                              </div>
                              <hr />

                              <div class="post">
                                <p class="post-meta"><span class="post-author text-primary">Anders</span><br />
                                <span class="post-time small text-muted">30th August 2011 21:45 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                                <p class="post-content">Does this .ini start with a UTF16 BOM ?</p>
                              </div>
                              <hr />

                              <div class="post">
                                <p class="post-meta"><span class="post-author text-primary">nwightman</span><br />
                                <span class="post-time small text-muted">31st August 2011 08:40 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                                <p class="post-content">The ini files were UTF-8 encoded, I converted them to ut6-16-le and it works. Thanks.</p>
                              </div>
                              <hr />

                              <div class="post">
                                <p class="post-meta"><span class="post-author text-primary">jimpark</span><br />
                                <span class="post-time small text-muted">5th September 2011 17:05 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                                <p class="post-content"><strong>2.46.2 Released</strong><br />
                                2.46.2 is actually a fairly major release. Although based on the official NSIS 2.46 release, there has been some extensive improvements.<br /></p>

                                <ul>
                                  <li>For example, we've added two new commands: GetFontVersion and GetFontVersionLocal. These commands can be used to get the version information from a TTF font file. This command is valuable for those who are distributing and updating fonts with their products.</li>

                                  <li>Changed linear look-up of keyword tokens to a hash table which greatly increased NSI compilation speed. Although NSI script compilation is generally not a bottleneck in the build process, you will notice a marked improvement in NSI compilation speed.</li>

                                  <li>The log generated by the logging build now outputs a BOM at the beginning of a new log file so that many text editors can recognize the file as UTF-16LE.</li>
                                </ul><br />
                                Apart from these major changes, there has been some general bug fixes and improvements to translations. The source code also now builds on Microsoft Visual Studio 2010's version of C++, as well as previous versions of VC++.<br />
                                <br />
                                You can get it from the usual place: <a href="http://www.scratchpaper.com" target="_blank">www.scratchpaper.com</a>.
                              </div>
                              <hr />

                              <div class="post">
                                <p class="post-meta"><span class="post-author text-primary">Pawel</span><br />
                                <span class="post-time small text-muted">5th September 2011 17:23 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                                <p class="post-content">Thanks Jim.<br />
                                Already installed :D<br />
                                -Pawel</p>
                              </div>
                              <hr />

                              <div class="post">
                                <p class="post-meta"><span class="post-author text-primary">Yathosho</span><br />
                                <span class="post-time small text-muted">12th September 2011 13:55 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                                <p class="post-content">while i'm personally interested in unicode versions of these, please take this as documentation of plugins that aren't yet available ;)<br />
                                <br />
                                -<a href="http://nsis.sourceforge.net/FontName_plug-in" target="_blank">FontName</a><br />
                                -<a href="http://nsis.sourceforge.net/Locate_plugin" target="_blank">Locate</a><br />
                                -<a href="http://nsis.sourceforge.net/TextReplace_plugin" target="_blank">TextReplace</a><br />
                                -<a href="http://nsis.sourceforge.net/ToolTips_plug-in" target="_blank">ToolTips</a> (<a href="http://nsis.sourceforge.net/Joel_plugin_src" target="_blank">source</a>)<br />
                                <br />
                                the sources come with each plugin unless mentioned otherwise</p>
                              </div>
                              <hr />

                              <div class="post">
                                <p class="post-meta"><span class="post-author text-primary">Yathosho</span><br />
                                <span class="post-time small text-muted">13th September 2011 16:29 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                                <p class="post-content">just find out about <a href="http://nsis.sourceforge.net/CallAnsiPlugin_plug-in" target="_blank">CallAnsiPlugin</a>, but i can't get it to work with the locate plugin.<br />
                                <br />
                                ansi plugin call:<br />
                                locate::_Open /NOUNLOAD `${_PATH}` `${_OPTIONS}`<br />
                                <br />
                                callansi call<br />
                                CallAnsiPlugin::Call "$PLUGINSDIR\Locate" _Open /NOUNLOAD `${_PATH}` `${_OPTIONS}`<br />
                                CallAnsiPlugin::Call "$PLUGINSDIR\Locate" Open /NOUNLOAD `${_PATH}` `${_OPTIONS}`<br />
                                <br />
                                both don't work (Invalid command: locate::_Open), what am i doing wrong?</p>
                              </div>
                              <hr />

                              <div class="post">
                                <p class="post-meta"><span class="post-author text-primary">Anders</span><br />
                                <span class="post-time small text-muted">13th September 2011 16:57 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                                <p class="post-content">@Yathosho: You need to look at the CallAnsiPlugin documentation on the wiki, you can't just copy and paste a working ansi plugin command!<br />
                                <br />
                                (Hint: /NOUNLOAD is not valid, read about using the * prefix, also, you need to specify the parameter count)<br />
                                <br />
                                Even if you get all that stuff correct it might not work since CallAnsiPlugin will not work with every plugin.</p>
                              </div>
                              <hr />

                              <div class="post">
                                <p class="post-meta"><span class="post-author text-primary">vicokoby</span><br />
                                <span class="post-time small text-muted">16th September 2011 17:46 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                                <p class="post-content">Problem with the parameter /CMDHELP (Missing Commands).<br />
                                <br />
                                When run this: makensis.exe /CMDHELP, only show this:<br />
                                MakeNSIS v2.46.2-Unicode - Copyright 1995-2009 Contributors<br />
                                See the file COPYING for license details.<br />
                                Credits can be found in the Users Manual.<br />
                                <br />
                                Abort [message]</p>
                              </div>
                              <hr />

                              <div class="post">
                                <p class="post-meta"><span class="post-author text-primary">LoRd_MuldeR</span><br />
                                <span class="post-time small text-muted">17th September 2011 21:42 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                                <p class="post-content">Hello. First of all: Thanks for the new release!<br />
                                <br />
                                But unfortunately I just noticed that there is major bug in the 2.46.2 release:<br />
                                The installer won't run under Windows 2000 anymore, while previous version (2.46.1) worked perfectly fine :cry:<br />
                                Error message is "Not a valid Win32 application" and installer won't even start up.<br />
                                <br />
                                I was able to track down the problem with the help of CFF Explorer:<br />
                                The <i>OperatingSystemVersion</i> field in the PE header is now set to 5.1 rather than 5.0 :(<br />
                                <br />
                                Has support for Windows 2000 been dropped intentionally (I don't hope so!) or has this happened by mistake?<br />
                                <br />
                                (And yes, I still have users on Windows 2000. And I just figured out how to make VS2010 binaries work on Win2k)<br />
                                <br />
                                <b><font color="DarkRed">Important info</font></b><br />
                                In order to make VS2010 compiled binaries work on Windows 2000 (and WinXP RTM!), two simple steps are required:<br />
                                (1) You need to set "Minimum Required Options" (in the Linker/System options) to <i>5.0</i><br />
                                (2) You need to link your binary against <a href="http://code.google.com/p/mulder/source/browse/trunk/Utils/EncodePointerLib/Release" target="_blank"><b>EncoderPointer.lib</b></a> in order to remove a dependency on a certain export from Kernel32.DLL which did not exist in systems prior to Windows XP with Service Pack 2 (which includes Windows 2000, of course)<br />
                                <br />
                                Regards,<br />
                                MuldeR.</p>
                              </div>
                              <hr />

                              <div class="post">
                                <p class="post-meta"><span class="post-author text-primary">jimpark</span><br />
                                <span class="post-time small text-muted">20th September 2011 01:09 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                                <p class="post-content">Thank you, Lord Mulder. Perhaps, the best thing would be for me to build with Visual Studio 2008 for now. I personally don't need to release any software to Win2K users but I see how this is a problem. I will rebuild and re-release 2.46.2 soon. Thanks for letting me know.</p>
                              </div>
                              <hr />

                              <div class="post">
                                <p class="post-meta"><span class="post-author text-primary">LoRd_MuldeR</span><br />
                                <span class="post-time small text-muted">20th September 2011 01:15 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                                <p class="post-content"></p>

                                <blockquote>
                                  <small>Originally posted by jimpark</small><br />
                                  Thank you, Lord Mulder. Perhaps, the best thing would be for me to build with Visual Studio 2008 for now. I personally don't need to release any software to Win2K users but I see how this is a problem. I will rebuild and re-release 2.46.2 soon. Thanks for letting me know.
                                </blockquote>Thank you :up:<br />
                                <br />
                                (BTW: You know that VS2010 can use the VS2008 toolset? The toolset can be selected in project properties)
                              </div>
                              <hr />

                              <div class="post">
                                <p class="post-meta"><span class="post-author text-primary">jimpark</span><br />
                                <span class="post-time small text-muted">20th September 2011 21:03 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                                <p class="post-content">I just released a beta version of 2.46.3. I've still compiled it using MSVC 2010 and I did not need the EncoderPointer.lib since I do not link to the standard library in exehead. So NSIS itself still requires Windows XP+ to build installers but the installer it generates should be able to run under Windows 2000. Lord Mulder, can you check this when you have the time? I've also added GetFontName and GetFontNameLocal to round out the font commands.</p>
                              </div>
                              <hr />

                              <div class="post">
                                <p class="post-meta"><span class="post-author text-primary">LoRd_MuldeR</span><br />
                                <span class="post-time small text-muted">20th September 2011 22:24 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                                <p class="post-content"></p>

                                <blockquote>
                                  <small>Originally posted by jimpark</small><br />
                                  I just released a beta version of 2.46.3.
                                </blockquote>Thanks!<br />
                                <br />

                                <blockquote>
                                  <small>Originally posted by jimpark</small><br />
                                  I've still compiled it using MSVC 2010 and I did not need the EncoderPointer.lib since I do not link to the standard library in exehead.
                                </blockquote>I see.<br />
                                <br />

                                <blockquote>
                                  <small>Originally posted by jimpark</small><br />
                                  So NSIS itself still requires Windows XP+ to build installers but the installer it generates should be able to run under Windows 2000.
                                </blockquote>Actually it needs Windows XP with Service Pack 2. The RTM version or Service Pack 1 won't work either.<br />
                                <br />
                                (That's why you still may consider linking EncoderPointer.lib into makensis.exe)<br />
                                <br />

                                <blockquote>
                                  <small>Originally posted by jimpark</small><br />
                                  Lord Mulder, can you check this when you have the time? I've also added GetFontName and GetFontNameLocal to round out the font commands.
                                </blockquote>I just compiled an installer with NSIS v2.46.3 and it ran through on Windows 2000 just fine :)
                              </div>
                              <hr />

                              <div class="post">
                                <p class="post-meta"><span class="post-author text-primary">jimpark</span><br />
                                <span class="post-time small text-muted">21st September 2011 00:49 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                                <p class="post-content">Thanks for checking so quickly. If after a week of testing, I don't see any problems, I will release it. I don't think it's a problem to request WinXP SP2 for the developer boxes do you? I would like to keep moving forward with compiler updates as I move my other projects to the new tools.<br />
                                <br />
                                On a side note, I'm considering dropping the third digit versioning and just moving forward to 2.47 and onwards. If and when the new NSIS comes out it is likely to be version 3, anyway. Besides, my code has forked enough that I don't think I can easily port over any changes from the trunk anyway. And there has been quite a lot of improvements to my code base since 2.46 came out two years ago. Kichik and I have very different philosophies on how NSIS should move forward. I personally think ANSI is dead. I don't believe in creating multiple versions of the build: big string version, logging version, logging with big string etc. I don't care about saving a few kilobytes on a setup that is a couple of megabytes big. So starting the next release, the builds will have the logging ability built in.</p>
                              </div>
                              <hr />

                              <div class="post">
                                <p class="post-meta"><span class="post-author text-primary">MSG</span><br />
                                <span class="post-time small text-muted">21st September 2011 09:49 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                                <p class="post-content">If the "new NSIS" you're hoping for is NSIS Unicode, I don't think it'll ever come unless the current unicode branch (your branch) gets merged into the trunk. Right now NSIS development is stalled because of this branching. If you want to continue development, please work on merging, instead of increasing the distance from trunk. You can't shoulder the entire development of NSIS on your own...</p>
                              </div>
                              <hr />
                              <!-- Bootstrap core CSS -->
                              <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
                              <!--[if lt IE 9]>
                <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
                <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->

                              <div class="container">
                                <!-- Put navigation bar here -->

                                <ol class="breadcrumb">
                                  <li><a href="../index.html" class="glyphicon glyphicon-home"></a></li>

                                  <li><a href="f-65.html">NSIS Discussion</a></li>

                                  <li class="active">Unicode</li>
                                </ol>

                                <p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=277381">Unicode</a></p><br />

                                <div class="post">
                                  <p class="post-meta"><span class="post-author text-primary">jimpark</span><br />
                                  <span class="post-time small text-muted">21st September 2011 11:33 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                                  <p class="post-content">Let's be fair MSG. If the merging of my code into the trunk is really what's holding the new NSIS up, then it's done. It was done four years ago when I presented my work. The reality is they are reinventing the wheel. They are redoing my work, their way.<br />
                                  <br />
                                  And frankly, in the last four years, there hasn't been much work being done on NSIS at all. The biggest being the Unicode port I did four years ago. Just check the code changes here. Apart from the copyright year updates, I never had to struggle very much to update my codebase to reflect the trunk's. Usually, the changes per release was just a few lines here and there.<br />
                                  <br />
                                  And really what does it matter now anyway? I personally don't know a major project that uses the ANSI version. Do you? All the products I use, if they use NSIS, use my Unicode version. The only motivation I can think of to use the ANSI version is if I needed to support Windows 98/ME customers. But what are these people connecting to the internet with abandoned OSes anyway? They don't even get security updates from Microsoft!<br />
                                  <br />
                                  But you might be right about me being able to do it alone. Perhaps I should ask for help from the people who have been offering. But so far, it hasn't been that much of a workload. That may of course change with the coming Windows 8 support.</p>
                                </div>
                                <hr />

                                <div class="post">
                                  <p class="post-meta"><span class="post-author text-primary">MSG</span><br />
                                  <span class="post-time small text-muted">21st September 2011 12:01 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                                  <p class="post-content">I'm not a programmer, so I can't comment on why work in your branch is or isn't or should or shouldn't be compatible with work in the trunk. The fact remains that the progress in trunk is stalled because of unicode. It's not guaranteed that progress will continue if the stalling factor is removed, but it's pretty certain that progress will not continue as long as it's stalled...<br />
                                  <br />
                                  As for the trunk unicodification, if they're redoing your work their way, then wouldn't it be beneficial to all of us if you would help in redoing it? You have the experience, after all. The alternative is either to wait till trunk unicode is finished (unlikely) or to drop trunk development completely.<br />
                                  <br />
                                  The latter would be, in my opinion, a bad move. Your work, while cool and very very usable (kudos), is almost source-closing NSIS because it doesn't use the existing NSIS development infrastructure. Fragmentation destroys human &amp; technical resources.</p>
                                </div>
                                <hr />

                                <div class="post">
                                  <p class="post-meta"><span class="post-author text-primary">jimpark</span><br />
                                  <span class="post-time small text-muted">21st September 2011 13:55 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                                  <p class="post-content">Well, open source also has a way of moving forward when the product gets neglected, stalled, etc. It gets forked and the original dies. I don't know if this is what's happening but with the dearth of activity (releases), it's a possibility.<br />
                                  <br />
                                  If you are asking me to redo my work, then no. It could be that my approach of how it should be done is different from what they want to do. And in that case, they have to take the time to actually implement it. If you are asking me to help them do their approach when I believe the approach I took is better, again, no. There is no incompatibility with my approach since I've done it and it works. And I think the fact that it's taking more than two years to do what I've done four years ago should speak for itself.</p>
                                </div>
                                <hr />

                                <div class="post">
                                  <p class="post-meta"><span class="post-author text-primary">Anders</span><br />
                                  <span class="post-time small text-muted">21st September 2011 20:41 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                                  <p class="post-content">The official NSIS needs to support other compilers (and POSIX support), not just VS2005+. We cannot rely on the CRT to provide stdio ANSI/UTF8/UTF16 conversion like the fork does...</p>
                                </div>
                                <hr />

                                <div class="post">
                                  <p class="post-meta"><span class="post-author text-primary">jimpark</span><br />
                                  <span class="post-time small text-muted">21st September 2011 20:54 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                                  <p class="post-content">The CRT does not provide UTF-8, UTF-16, UTF-32, and ANSI conversions. Hence, the NSIS Unicode does not rely on them. What you may be facing is the fact that wchar_t is defined as different widths for the different platforms. The CRT in Linux is going to be 32-bits. The CRT on Windows is going to be 16-bits. If you are trying to do cross-platform building of win32 programs, then you will need to make sure that the CRT that you link to will also be for UTF-16LE. Otherwise, all your wide char string functions will not work right because they want wchar_t to be 32-bits. Or you will have to link in ICU which is a huge library and then convert everything to the "native" wchar_t.<br />
                                  <br />
                                  I say forget building NSIS on other platforms. Why bother? NSIS is only a Windows installer solution. Build it on Windows. As for other compilers on Windows, I'm sure with a little work people can get my NSIS Unicode to build on gcc, et al. Is this what you guys are stuck with? I don't have any expertise in cross-platform building and I don't have much interest (no need yet) so I won't be much of a help there.</p>
                                </div>
                                <hr />

                                <div class="post">
                                  <p class="post-meta"><span class="post-author text-primary">Anders</span><br />
                                  <span class="post-time small text-muted">21st September 2011 23:00 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                                  <p class="post-content"></p>

                                  <blockquote>
                                    <small>Originally posted by jimpark</small><br />
                                    The CRT does not provide UTF-8, UTF-16, UTF-32, and ANSI conversions. Hence, the NSIS Unicode does not rely on them.
                                  </blockquote>Then why are you passing "ccs=&lt;encoding&gt;" to fopen?
                                </div>
                                <hr />

                                <div class="post">
                                  <p class="post-meta"><span class="post-author text-primary">jimpark</span><br />
                                  <span class="post-time small text-muted">22nd September 2011 01:03 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                                  <p class="post-content">You are right, Anders. I do remember using that MS extension to fopen. It was very convenient at the time. Are you guys adamant about not linking to MS CRT? But you aren't adamant about calling Win32 API, right?<br />
                                  <br />
                                  Otherwise, you might have to wrap a new class for Unicode text file and simply pass that object around instead of using CRT IO API on the FILE*. That is a more extensive change. But is that all you are stuck on or are there other issues?</p>
                                </div>
                                <hr />

                                <div class="post">
                                  <p class="post-meta"><span class="post-author text-primary">LoRd_MuldeR</span><br />
                                  <span class="post-time small text-muted">22nd September 2011 01:21 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                                  <p class="post-content"></p>

                                  <blockquote>
                                    <small>Originally posted by jimpark</small><br />
                                    The CRT does not provide UTF-8, UTF-16, UTF-32, and ANSI conversions. Hence, the NSIS Unicode does not rely on them. What you may be facing is the fact that wchar_t is defined as different widths for the different platforms. The CRT in Linux is going to be 32-bits. The CRT on Windows is going to be 16-bits. If you are trying to do cross-platform building of win32 programs, then you will need to make sure that the CRT that you link to will also be for UTF-16LE. Otherwise, all your wide char string functions will not work right because they want wchar_t to be 32-bits. Or you will have to link in ICU which is a huge library and then convert everything to the "native" wchar_t.
                                  </blockquote>Actually on Linux you would not use <i>wchar_t</i> at all, because on Linux all the API functions support Unicode via UTF-8 encoding, so you can use <i>char</i> all the way. On Windows this doesn't work. The ANSI functions in the Win32 API function, that are defined with the <i>char</i> type, do <b>not</b> support UTF-8 (and thus do not handle Unicode strings). And the Unicode-enabled functions in the Win32 API are defined with the <i>wchar_t</i> type and require an UTF-16 encoding. Everything could have been so easy, if M$ had decided to use UTF-8 in their API!<br />
                                  <br />
                                  The general solution for cross-platform applications that build on Windows as well as on Linux is using macros. Instead of <i>char</i> or <i>wchar_t</i>, you use a TCHAR macro. This macro will expand to <i>wchar_t</i> on Windows and to <i>char</i> on Linux. Needless to say that all string manipulation functions need to be replaced with macros too, when going this route. It needs a lot of code change.<br />
                                  <br />
                                  The other solution is: Use <i>char</i> with UTF-8 all the way - even on Windows. With that solution you can use the normal char-based string functions and don't need any macro "magic". However, on the Windows platform, you will need to convert from UTF-8 to UTF-16 before certain API functions. For example, on Windows, you can't pass the UTF-8 string to fopen(), but have to write your own fopen_utf8() that internally converts to UTF-16 and then calls wfopen(). That is what I did with a lot of code that had been ported from Linux to Windows, but did not support Unicode yet. The Win32 API provides the needed functions to convert between UTF-8 and UTF-16.<br />
                                  <br />
                                  <br />
                                  This is the code I use to enable Unicode support on Windows in applications that use <i>char</i> all the way*:<br />
                                  <a href="http://pastie.org/private/hftbnzujnzfresihpnpa" target="_blank">http://pastie.org/private/hftbnzujnzfresihpnpa</a><br />
                                  (* as is the case with most code ported from Linux or written by people who don't care/know about Unicode support)<br />
                                  <br />
                                  All fopen()'s must be replaced by fopen_utf8(). Also the "main" function has to be wrapped like this:<br />
                                  <a href="http://pastie.org/private/8fdvykqceqekz002bs9xza" target="_blank">http://pastie.org/private/8fdvykqceqekz002bs9xza</a><br />
                                  <br />
                                  Actually I saw that idea in the LAME code first :)
                                </div>
                                <hr />

                                <div class="post">
                                  <p class="post-meta"><span class="post-author text-primary">jimpark</span><br />
                                  <span class="post-time small text-muted">22nd September 2011 13:36 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                                  <p class="post-content">When I was referring to wchar_t width differences, I was referring to string functions found in &lt;wchar.h&gt;. <a href="http://pubs.opengroup.org/onlinepubs/007908799/xsh/wchar.h.html" target="_blank">http://pubs.opengroup.org/onlinepubs...h/wchar.h.html</a><br />
                                  <br />
                                  I do think that _wfopen() not existing in Linux is an oversight, but one that can be easily reimplemented. Just convert your wide strings to UTF-8. Converting from UTF-8 to UTF-16 and vice versa is not hard. You can link to ICU, iconv or (if you have access to Windows API) use WideCharToMultiByte / MultiByteToWideChar using CP_UTF8 as your target. Or you could write your own from the Unicode specs which is also not hard -- I've done it before.<br />
                                  <br />
                                  But since we are targeting Windows as the working platform, keep all the strings as UTF-16LE. We aren't really porting a Unix program into Windows, it's really the other way around. Also, if we restrict building of NSIS to Windows, then I don't think you have many problems. I think MinGW needs to link to MS CRT (from what I've heard), so you have all of Microsoft's extensions anyway.<br />
                                  <br />
                                  I still don't really understand the motivation of trying to build NSIS on Linux. It's an exercise in cross-platform building and it might be interesting to some. But since NSIS itself needs to run on Windows, I don't really see how anyone would benefit from the exercise.</p>
                                </div>
                                <hr />

                                <div class="post">
                                  <p class="post-meta"><span class="post-author text-primary">LoRd_MuldeR</span><br />
                                  <span class="post-time small text-muted">22nd September 2011 13:50 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                                  <p class="post-content"></p>

                                  <blockquote>
                                    <small>Originally posted by jimpark</small><br />
                                    I still don't really understand the motivation of trying to build NSIS on Linux. It's an exercise in cross-platform building and it might be interesting to some. But since NSIS itself needs to run on Windows, I don't really see how anyone would benefit from the exercise.
                                  </blockquote>There are quite a few OpenSource projects that originate from the Linux world and the main developers don't care much about Windows. These people often support Windows ports, as long as it doesn't make too much trouble and as long as it can be done from their usual Linux build environment. So cross-compiling Win32 binaries from Linux is okay, having to set-up and use a Windows machine is not. That's why it may be convenient to have a "native" Linux port of MakeNSIS, even though the final installer will never run under Linux (outside of Wine).<br />
                                  <br />
                                  Still I think when compiling the EXE headers on Linux one would have to use a cross-compiler anyway (because you need them to be compiled as Win32 binaries). And that cross-compiler would use 16-Bit wchar_t's, just like any C/C++ compiler on Windows...
                                </div>
                                <hr />

                                <div class="post">
                                  <p class="post-meta"><span class="post-author text-primary">jimpark</span><br />
                                  <span class="post-time small text-muted">22nd September 2011 14:49 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                                  <p class="post-content">Excellent points, Lord Mulder. But is that what we are aiming to provide, an MakeNSIS that runs natively on Linux? I've yet to see it. And if that's what we are aiming to do, I think that's admirable. But if we are just trying to build NSIS (including MakeNSIS) that only runs on Windows but built from Linux, who are we doing this work for? Ourselves, the builders of NSIS? But why? I have a Windows box. I need to actually run NSIS to build my setup and test my Windows products.</p>
                                </div>
                                <hr />

                                <div class="post">
                                  <p class="post-meta"><span class="post-author text-primary">LoRd_MuldeR</span><br />
                                  <span class="post-time small text-muted">22nd September 2011 15:04 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                                  <p class="post-content">I agree that being able to cross-compile Win32 binaries of <i>MakeNSIS</i> from Linux isn't very useful. It certainly would be a nice addition, but IMHO it should be "low priority" feature. But then again you would be using the <i>cross-compiler</i> (not the native Linux compiler) to compile MakeNSIS for Win32 from Linux anyway. And again this eliminates most portability issues, I think. So I guess most problems you will be facing will be "MinGW/GCC -vs- MSVC" quirks rather than "Win32 -vs- Linux" issues...<br />
                                  <br />
                                  (If something compiles with the MinGW/MSYS compiler on Win32, it probably compiles with the cross-compiler on Linux too)</p>
                                </div>
                                <hr />

                                <div class="post">
                                  <p class="post-meta"><span class="post-author text-primary">DrO</span><br />
                                  <span class="post-time small text-muted">22nd September 2011 15:31 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                                  <p class="post-content">i think the main point is that makensis is already provided with the ability to cross-compile, so dropping that probably isn't going to be liked by those who do rely on it. yes it doesn't quite make sense but it could be from part of an automated build system pulling things from a repository and building from there on a linux machine for example. obviously there was a reason why it was added as support so there must have been the demand.<br />
                                  <br />
                                  as for the whole this build vs 'official' talk, i was under the impression when wizou was porting things back that it was generally a like for like thing. though that all seems to have stopped / lost any focus which probably isn't helping things. but i can see why people want to maintain some sort of legacy support as tbh, a unicode build doesn't offer that much advantage when you're only providing something for people where ansi will fit - i don't disagree that unicode is useful but there are reasons why some of us do still prefer to use the 'official' builds compared to the unicode ones.<br />
                                  <br />
                                  -daz</p>
                                </div>
                                <hr />

                                <div class="post">
                                  <p class="post-meta"><span class="post-author text-primary">LoRd_MuldeR</span><br />
                                  <span class="post-time small text-muted">22nd September 2011 16:09 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                                  <p class="post-content">First of all, if written properly, the very same code can be compiled as ANSI or as Unicode. So if you still want to support an ANSI version while offering a Unicode support, this is doable. It's not hard to do for new code, though it makes some work to "upgrade" existing code. But if you have to rewrite you code for Unicode support anyway, making it support Unicode and ANSI at the same time is minimal extra work.<br />
                                  <br />
                                  But why would you want an ANSI version of NSIS nowadays? Every Windows system that is used nowadays does support Unicode. Even good old Windows 2000 (which is not provided with important security updates anymore for more than a year now!) did support Unicode just fine. I know that there are still a few people using Windows 2000, although nobody can seriously recommend this, but even older Windows versions, like 9x and NT 4.0, definitely are a lost case. Not worth bothering. Really! At the same time the lack of Unicode support causes serious problems on non-archaic systems: Can't install to directories that contain Unicode characters (and these may exist on every system!), can't access or create files whose name contains Unicode characters, can't display text that contains characters not available in the user's current ANSI Codepage (a huge limitation for NSIS' otherwise great translation system). And so on...<br />
                                  <br />
                                  Why not make the cut:<br />
                                  Go for NSIS 3.xx to be fully Unicode and keep the 2.xx branch for backward-compatibility (for those who really care). It's not unusual at all in the software world to drop support for outdated OS in never versions and maintain the old version for backward-compatibility for a while.<br />
                                  <br />
                                  <br />
                                  (BTW: If current NSIS already supports cross-compiling, how will adding Unicode support destroy this?)<br />
                                  <br />
                                  <a href="http://img18.imageshack.us/img18/8852/linuxcrossunicode.jpg" target="_blank"></a><a href="http://img18.imageshack.us/img18/8852/linuxcrossunicode.th.jpg" target="_blank">http://img18.imageshack.us/img18/885...unicode.th.jpg</a></p>
                                </div>
                                <hr />

                                <div class="post">
                                  <p class="post-meta"><span class="post-author text-primary">Anders</span><br />
                                  <span class="post-time small text-muted">22nd September 2011 17:25 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                                  <p class="post-content"></p>

                                  <blockquote>
                                    <small>Originally posted by jimpark</small><br />
                                    You are right, Anders. I do remember using that MS extension to fopen. It was very convenient at the time. Are you guys adamant about not linking to MS CRT? But you aren't adamant about calling Win32 API, right?
                                  </blockquote>Well, to maintain POSIX support we try not to use too much Win32 stuff in makensis.exe since it has to be in a #ifdef _WIN32 block with a #else for the POSIX analog.<br />
                                  <br />
                                  Using the basic CRT stuff is not a problem (fopen etc), but using compiler extensions can be a problem.<br />
                                  <br />
                                  So the only solution I see is some sort of wrapper around FILE* that reads ANSI/UTF8/UTF16 and spits out UTF16 on the other side. (I was hoping to add UTF8 support to the ansi version but I'm not sure if that is going to happen (I already have the code for .nlf loading, the normal source files is the problem))
                                </div>
                                <hr />

                                <div class="post">
                                  <p class="post-meta"><span class="post-author text-primary">LoRd_MuldeR</span><br />
                                  <span class="post-time small text-muted">22nd September 2011 18:06 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                                  <p class="post-content">Now I am confused :confused:<br />
                                  <br />
                                  Are we still talking about <i>cross-compiling</i> MakeNSIS.exe from a Linux system or are you talking about a <i>native</i> Linux port of MakeNSIS?</p>
                                </div>
                                <hr />

                                <div class="post">
                                  <p class="post-meta"><span class="post-author text-primary">Anders</span><br />
                                  <span class="post-time small text-muted">22nd September 2011 20:44 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                                  <p class="post-content"></p>

                                  <blockquote>
                                    <small>Originally posted by LoRd_MuldeR</small><br />
                                    Are we still talking about <i>cross-compiling</i> MakeNSIS.exe from a Linux system or are you talking about a <i>native</i> Linux port of MakeNSIS?
                                  </blockquote>What would be the point of cross-compiling makensis and then having to use wine or whatever to run it? Even if you don't have a cross-compiler you can compile makensis on POSIX but you need to grab the stubs and plugins from somewhere else... (See "G.3 Building on POSIX" in the helpfile)
                                </div>
                                <hr />

                                <div class="post">
                                  <p class="post-meta"><span class="post-author text-primary">LoRd_MuldeR</span><br />
                                  <span class="post-time small text-muted">22nd September 2011 21:21 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                                  <p class="post-content"></p>

                                  <blockquote>
                                    <small>Originally posted by Anders</small><br />
                                    What would be the point of cross-compiling makensis and then having to use wine or whatever to run it?
                                  </blockquote>Exactly my point :)<br />
                                  <br />
                                  And that's why I was a bit confused about jimpark's statement "MakeNSIS that runs <i>natively</i> on Linux? I've yet to see it".<br />
                                  <br />
                                  Still it is perfectly possible to write code that supports Unicode <i>and</i> compiles on POSIX (Linux, MacOS X) as well as on Windows.<br />
                                  <br />
                                  Two common approaches have been mention here:<br />
                                  <a href="http://forums.winamp.com/showpost.php?p=2804194&amp;postcount=488" target="_blank">http://forums.winamp.com/showpost.ph...&amp;postcount=488</a><br />
                                  <br />
                                  (So while retaining cross-platform compatibility makes things a bit more complicated, it shouldn't be a showstopper for Unicode NSIS)
                                </div>
                                <hr />

                                <div class="post">
                                  <p class="post-meta"><span class="post-author text-primary">jimpark</span><br />
                                  <span class="post-time small text-muted">22nd September 2011 21:57 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                                  <p class="post-content">Sorry, I did not mean to confuse but to really show the lack of utility in having MakeNSIS build on Linux. I think the only use is if someone really wanted to build their own toolchain, including NSIS, on Linux as some sort of a build process as DrO mentioned. I still don't know why anyone would do that. And if someone does do that, does he also cross-build GCC or some other compiler for Windows on Linux and then decide to use that on their Windows builds? The fact is, in order to create a Windows installer, they need to run MakeNSIS on Windows.<br />
                                  <br />
                                  Why can't we just forget catering to these hypothetical people. It's not worth stalling the project over. They are getting a Windows setup making toolchain that needs to be built on Windows. They will still need to have a Windows box as part of their resources to actually run MakeNSIS and make their installer. And if a few of these hypothetical people exist, do they matter so much to stall the whole development?<br />
                                  <br />
                                  Again, I would not be making this argument if MakeNSIS <i>did run natively</i> on Linux, making NSIS a cross-platform setup builder. But that is not the case.</p>
                                </div>
                                <hr />

                                <div class="post">
                                  <p class="post-meta"><span class="post-author text-primary">LoRd_MuldeR</span><br />
                                  <span class="post-time small text-muted">22nd September 2011 22:14 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                                  <p class="post-content"></p>

                                  <blockquote>
                                    <small>Originally posted by jimpark</small><br />
                                    Again, I would not be making this argument if MakeNSIS <i>did run natively</i> on Linux, making NSIS a cross-platform setup builder. But that is not the case.
                                  </blockquote>If I understand Anders correctly, then MakeNSIS already <i>can</i> be build as a native Linux application (only the EXE headers can't, for obvious reason) and so it <i>does</i> run natively on Linux. And that, indeed, makes it possible to build Windows applications on Linux (using the cross-compiler) and then package them in an NSIS installer with MakeNSIS for distribution. No Windows machine required.<br />
                                  <br />
                                  But once again: That is not the reason that prevents MakeNSIS from supporting Unicode. It is possible to write code that builds natively on Windows, builds natively on Linux <i>and</i> supports Unicode on both platforms. See the link in my previous post, for example.
                                </div>
                                <hr />

                                <div class="post">
                                  <p class="post-meta"><span class="post-author text-primary">Anders</span><br />
                                  <span class="post-time small text-muted">22nd September 2011 22:18 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                                  <p class="post-content"></p>

                                  <blockquote>
                                    <small>Originally posted by jimpark</small><br />
                                    And if a few of these hypothetical people exist, do they matter so much to stall the whole development?
                                  </blockquote>It is in the Debian repository IIRC.<br />
                                  <br />
                                  Also, we got a patch from the Fedora/RedHat downstream <b>this month</b> so they are not hypothetical.<br />
                                  <br />
                                  Even if we dropped POSIX support, VC6, VS2003 and MinGW would still need fixing... (I know <b>you</b> don't care about VC6/VS2k3 but fixing MinGW would probably also fix the older VC's)<br />
                                  <br />
                                  Borland C++ and Open Watcom C/C++ don't not have official support and I don't know how long it has been since anyone tried those but they might also have similar issues...<br />
                                  <br />
                                  The point is, POSIX is not stalling anything, the usage of MS extensions is the problem.
                                </div>
                                <hr />

                                <div class="post">
                                  <p class="post-meta"><span class="post-author text-primary">jimpark</span><br />
                                  <span class="post-time small text-muted">22nd September 2011 22:37 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                                  <p class="post-content">To help me understand, they can't build exehead on Linux or do they using a cross-platform compiler and somehow with stubbed libs? If they need to build their setups on Linux, can they do it under Wine?</p>
                                </div>
                                <hr />

                                <div class="post">
                                  <p class="post-meta"><span class="post-author text-primary">jimpark</span><br />
                                  <span class="post-time small text-muted">22nd September 2011 23:04 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                                  <p class="post-content">Anders, also not just MS extensions but also Win32 API calls, as well. Has anyone looked into using iconv or ICU for Unicode support? The standard runtime does not provide enough support to do what we want.</p>
                                </div>
                                <hr />

                                <div class="post">
                                  <p class="post-meta"><span class="post-author text-primary">LoRd_MuldeR</span><br />
                                  <span class="post-time small text-muted">22nd September 2011 23:07 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                                  <p class="post-content"></p>

                                  <blockquote>
                                    <small>Originally posted by jimpark</small><br />
                                    If they need to build their setups on Linux, can they do it under Wine?
                                  </blockquote>They could. But that's probably not what they want :D :rolleyes:<br />
                                  <br />
                                  (Also Wine is limited to x86 systems by the way it works. Linux also runs on many other architectures)<br />
                                  <br />
                                  <a href="http://img6.imageshack.us/img6/6006/nsiswine.jpg" target="_blank"></a><a href="http://img6.imageshack.us/img6/6006/nsiswine.th.jpg" target="_blank">http://img6.imageshack.us/img6/6006/nsiswine.th.jpg</a><br />
                                  <br />

                                  <blockquote>
                                    <small>Originally posted by jimpark</small><br />
                                    Anders, also not just MS extensions but also Win32 API calls, as well. Has anyone looked into using iconv or ICU for Unicode support? The standard runtime does not provide enough support to do what we want.
                                  </blockquote>What exactly is missing?
                                </div>
                                <hr />

                                <div class="post">
                                  <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
                                  <span class="post-time small text-muted">23rd September 2011 00:15 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                                  <p class="post-content">makensis has been fully portable to POSIX since version 2.01. The stubs are either cross compiled with MinGW or copied from the Windows build. Since I've added this feature, I've seen it ported to numerous platforms, adopted by some Linux distributions, ported to Darwin and pop-up on one of the *BSD trees. I received help requests to get it working on AIX and other non-mainstream platforms. The Debian and Redhat ports in particular saw caring maintenance with patches, fixes and even upstream patches.<br />
                                  <br />
                                  I never stopped to ask why. People just wanted it. I don't have statistics, so I can't give out exact numbers. But they exist. I think the strongest selling point is for projects mainly aimed at Linux. By giving them the option to build everything on Linux, we make the Windows porters job easier. They don't have to maintain their own systems to build the application and can streamline the Windows port into the main project build cycle.<br />
                                  <br />
                                  In the past, MinGW was also the only decent free solution for building on Windows. Visual Studio Express didn't exist or wasn't good enough.<br />
                                  <br />
                                  As for Win32 API being used in makensis, any of them that still exist in the code are implemented for non-Win32 platforms. I think the LZMA compression module still has some threading functions implemented using pthreads.<br />
                                  <br />
                                  --<br />
                                  <br />
                                  All this is just technical details. Regarding the future, I do agree Unicode is required.</p>
                                </div>
                                <hr />

                                <div class="post">
                                  <p class="post-meta"><span class="post-author text-primary">jimpark</span><br />
                                  <span class="post-time small text-muted">23rd September 2011 03:10 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                                  <p class="post-content">Thanks Kichik for the info. As to Lord Mulder's question, the standard library does not have a way to convert from one form of Unicode encoding to another, not to mention the normalization of Unicode. For example, Windows wants UTF-16 little endian and likes precomposed characters. Linux's wide chars are UTF-32 little endian if running Intel but possibly big endian on other processors. Mac OS X uses UTF-8 fully decomposed characters. So now you see the extent of the problem with supporting Unicode and multiple platforms. If we want to use the wchar library in the C runtime, we have to encode the Unicode strings to what they want to see in that platform. If the strings are going to be stored in a binary format that will be used on Windows, such as the strings in the setup, they need to be encoded to UTF-16LE.<br />
                                  <br />
                                  The new C++11 standard provides more Unicode support, including expressing Unicode string literals as 8 bit, 16 bit or 32 bit, but we will still need to write some code for byte ordering. But using the new C++ standars also seems to be out of the question if we need to support legacy compilers.<br />
                                  <br />
                                  No wonder the project is stalled. It's very difficult to move forward with so many restrictions. If this is what needs to be done, then keep the strings in the preferred encoding on the platform so that all the wchar string functions available since C++03 standard can be used during the NSI script processing. Then when saving the string, save them as UTF-16LE so that the exehead doesn't have to convert the strings. So string saved to disk is in the native encoding of Windows, but the string in memory is what's expected by the wchar functions.<br />
                                  <br />
                                  The other option is to stick to a single encoding even in memory but that would mean not being able to use the wchar functions in the C runtime and hence having to reimplement them on platforms if the chosen Unicode encoding isn't what the platform CRT likes.</p>
                                </div>
                                <hr />

                                <div class="post">
                                  <p class="post-meta"><span class="post-author text-primary">MSG</span><br />
                                  <span class="post-time small text-muted">23rd September 2011 05:58 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                                  <p class="post-content">(Call me an uninformed smartypants, but I see Jim say that the problem is very complicated, Mulder says that it's already been solved, and Anders states that the real problem lies elsewhere entirley (namely at ANSI .nsi reading). So while POSIX makensis has been cleared up, I'm wondering if there's still some confusion on what exactly needs to be figured out / agreed upon?)</p>
                                </div>
                                <hr />

                                <div class="post">
                                  <p class="post-meta"><span class="post-author text-primary">LoRd_MuldeR</span><br />
                                  <span class="post-time small text-muted">23rd September 2011 10:53 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                                  <p class="post-content"></p>

                                  <blockquote>
                                    <small>Originally posted by jimpark</small><br />
                                    Thanks Kichik for the info. As to Lord Mulder's question, the standard library does not have a way to convert from one form of Unicode encoding to another, not to mention the normalization of Unicode. For example, Windows wants UTF-16 little endian and likes precomposed characters. Linux's wide chars are UTF-32 little endian if running Intel but possibly big endian on other processors. Mac OS X uses UTF-8 fully decomposed characters. So now you see the extent of the problem with supporting Unicode and multiple platforms. If we want to use the wchar library in the C runtime, we have to encode the Unicode strings to what they want to see in that platform. If the strings are going to be stored in a binary format that will be used on Windows, such as the strings in the setup, they need to be encoded to UTF-16LE.
                                  </blockquote>I see that converting between different Unicode encodings might be a problem. On Windows there is a Win32 API function to convert UTF-16 to UTF-8 or some ANSI Codepage (and vice versa). I'm not sure if there is an equivalent on POSIX/Unix systems.<br />
                                  <br />
                                  But: I still don't understand why these conversions are needed at all :confused:<br />
                                  <br />
                                  On Linux (and other POSIX systems too?) all the API/CRT functions use UTF-8. The NSIS source code files (.nsi) should be encoded in UTF-8 too - Unicode text files almost always are UTF-8 encoded. So on these systems we should be able to use the 'char' type with UFT-8 encoding all the way. And, as UTF-8 is a sequence of individual bytes, there should be no "endianess" problems either. No need to use the 'wchar_t' type with UTF-16 or UTF-32. And no conversions needed anywhere.<br />
                                  <br />
                                  Now, on Windows, we can either stick with the 'char' type and use UTF-8 or we can use 'wchar_t' with UFT-16. In the former case we need minimal code change compared to the 'POSIX version', but before each Win32 API we need to convert the argument from UTF-8 to UTF-16 (not really a problem, because the Win32 API also has the required function to convert); it basically needs a simple UTF-8 wrapper function around each Win32 API function (at least around those that deal with strings). In the latter case we would have to replace any 'char' or 'wchar_t' with a TCHAR macro, that expands to 'char' on Linux/POSIX and to 'wchar_t' on Windows, in the code. Some string manipulation functions would have to be replaced by macros too. But generally you can simply put the required macros in a single header file (with a big "#ifdef _WIN32 .... #else .... #endif" around to switch between the different OS) once and include it everywhere...
                                </div>
                                <hr />

                                <div class="post">
                                  <p class="post-meta"><span class="post-author text-primary">jimpark</span><br />
                                  <span class="post-time small text-muted">23rd September 2011 11:12 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                                  <p class="post-content">Now remember that makensis also runs on Windows. In fact, most of the time it does. :) And because all Unicode text must go through UTF-16LE conversion to display correctly, we have this problem. Well, maybe this isn't that bad if we say that makensis is UTF-8 and the Windows GUI shell simply converts UTF-8 to UTF-16LE. The only thing about UTF-8 is that it is so variable in length. MS tries to keep one character per 16 bits which is why it prefers completely precomposed characters, i.e. one code point that has both base and diacritic characters. But UTF-8 is very variable. Each character could be one, two, three, or four bytes longs, or longer in the case with diacritics. And then exehead would have to do the same conversion from UTF-8 to UTF-16. I don't like that the exehead would have to do extra work to deal with all the strings. But this is an option that might then push all the conversion stuff out of the POSIX code and into the Windows code. Anders, this is what you were thinking, right? What did you find?</p>
                                </div>
                                <hr />

                                <div class="post">
                                  <p class="post-meta"><span class="post-author text-primary">LoRd_MuldeR</span><br />
                                  <span class="post-time small text-muted">23rd September 2011 11:41 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                                  <p class="post-content"></p>

                                  <blockquote>
                                    <small>Originally posted by jimpark</small><br />
                                    Now remember that makensis also runs on Windows. In fact, most of the time it does. :) And because all Unicode text must go through UTF-16LE conversion to display correctly, we have this problem.
                                  </blockquote>What problem?<br />
                                  <br />
                                  On Windows a simple MultiByteToWideChar(CP_UTF8, 0, input, -1, Buffer, BuffSize) will do the conversion.<br />
                                  <br />

                                  <blockquote>
                                    <small>Originally posted by jimpark</small><br />
                                    Well, maybe this isn't that bad if we say that makensis is UTF-8 and the Windows GUI shell simply converts UTF-8 to UTF-16LE.
                                  </blockquote>I think you would do the UTF-8 -&gt; UTF-16 conversion yourself before each Win32 API call. The Shell API doesn't handle UTF-8.<br />
                                  <br />

                                  <blockquote>
                                    <small>Originally posted by jimpark</small><br />
                                    The only thing about UTF-8 is that it is so variable in length. MS tries to keep one character per 16 bits which is why it prefers completely precomposed characters, i.e. one code point that has both base and diacritic characters. But UTF-8 is very variable. Each character could be one, two, three, or four bytes longs, or longer in the case with diacritics.
                                  </blockquote>Yes, in UTF-8 characters have variable length (in bytes). But that's not a problem. Each byte still "looks" like a normal ANSI character and at the end there always is a NULL terminator. So any function that was designed to handle ASCII characters will handle UTF-8 too. All ASCII characters are even identical between ASCII and UTF-8. Only problem I see with UTF-8 is that we need to allocate some "extra" space (if you want to ensure that <b>n</b> characters fit in the buffer, <b>4*n</b> bytes are required). But on the other hand: If you allocate <b>n</b> bytes buffer, with UTF-16 you can store a maximum of <i>n/2</i> characters. With UTF-8 you can store up to <i>n</i> characters, <i>maybe</i> fewer...<br />
                                  <br />
                                  BTW: UTF-16 also may use <i>pairs</i> of consecutive 16-Bit words ("surrogate pair"), because 2^16 is not enough for all Unicode characters!<br />
                                  <br />

                                  <blockquote>
                                    <small>Originally posted by jimpark</small><br />
                                    And then exehead would have to do the same conversion from UTF-8 to UTF-16. I don't like that the exehead would have to do extra work to deal with all the strings. But this is an option that might then push all the conversion stuff out of the POSIX code and into the Windows code. Anders, this is what you were thinking, right? What did you find?
                                  </blockquote>Now, if we talk about the EXE header again: Here we do not need to care about POSIX at all. It will never run anywhere else but on Windows (Wine). It will be compiled either on Windows or by a cross-compiler. Thus in the EXE header it is safe to write Windows-specific code, i.e. use 'wchar_t' with UTF-16 all the way and call Win32 API functions directly. The only conversions that will be needed is: Strings that have been generated by MakeNSIS and are stored in the installer EXE's "data" section need to be converted from UTF-8 to UTF-16 once. But I doubt that this causes too much performance overhead. And again MultiByteToWideChar() will do the job...
                                </div>
                                <hr />

                                <div class="post">
                                  <p class="post-meta"><span class="post-author text-primary">jimpark</span><br />
                                  <span class="post-time small text-muted">23rd September 2011 14:36 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                                  <p class="post-content">Maybe "problem" was a strong word.<br />
                                  <br />
                                  Correct me if I'm wrong but here's what I've gathered so far:</p>

                                  <ol style="list-style-type: decimal">
                                    <li>makensis should only call standard library (no win32 calls if possible).</li>

                                    <li>if win32/posix is needed, then we will need to do #ifdef for win32 and posix.</li>

                                    <li>makensis should be able to read various Unicode encoded files. NSI, NLF, NSH etc. These files may be UTF-8, UTF-16LE/BE, UTF-32LE/BE and we should ideally support them all.</li>

                                    <li>makensisw (Windows GUI) should be able to read outputs from makensis and display the output text to the user.</li>

                                    <li>exehead will only use win32 and will not link to any external libraries including C runtime to reduce size.</li>

                                    <li>plugins will need to handle Unicode strings.</li>
                                  </ol><br />
                                  I think point 3 is why I think we should consider linking to iconv or ICU. Point 4, I think we can deal with by using MultiByteToWideChar since we should only ever see UTF-8 coming out of makensis. And once we have iconv or ICU, I think we should convert the strings to UTF-16LE when storing them in the data section so that exehead will see UTF-16LE and not have to convert. This also means that for point 6, the plugin writers will only have to deal with the native Windows Unicode encoding.<br />
                                  <br />
                                  Also, as a side note, I think we should throw out the possibility of building ANSI while doing this work. There really isn't a good argument for keeping ANSI support and it's a simplification that can help everyone conceptually get their heads around the problems.
                                </div>
                                <hr />

                                <div class="post">
                                  <p class="post-meta"><span class="post-author text-primary">LoRd_MuldeR</span><br />
                                  <span class="post-time small text-muted">23rd September 2011 14:55 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                                  <p class="post-content"><b>To #2</b><br />
                                  If not done already, it may be wise to refactor OS-specific stuff into some "OS Support" class/file (i.e. have a "os_support.h" with the function declarations and have several "os_support_win32.cpp", "os_support_linux.cpp", etc. files with their OS-specific implementations), rather than have a lot of #ifdef's all over the place...<br />
                                  <br />
                                  <b>To #3</b><br />
                                  Why is that? Why not say that all text files (NSI, NLF, NSH) have to be UTF-8 and that's it? If required, any encoding can be converted to UTF-8 easily with a command-line utility, like <i>iconv</i>. Anyway, I can't remember to see any "plain text" Unicode files with a different encoding than UTF-8 in the wild. Is this really used? And do we really need to support it ???<br />
                                  <br />
                                  <b>To #4</b><br />
                                  Does makensis<b>w</b> need to compile natively under POSIX too? I don't think so. People that use Linux &amp; Co generally know how to use a console! Especially because NSIS is targeted at developers! Anyway, the one and only way, that I am aware of, to <u>properly</u> output Unicode characters to the Windows console is outputting UTF-8 to the STDOUT. However you must also call SetConsoleOutputCP() and enable UTF-8. output. There is <b>no</b> UTF-16 mode for SetConsoleOutputCP()! Last but not least, you must <i>not</i> use printf() and friends, because they screw up UTF-8 strings with their "translation" functions. Use WriteFile() instead and write to the handle you got via GetStandardHandle(). This of course means that the GUI applications, that redirects the console application's output, has to treat the text as UTF-8 too.<br />
                                  <br />
                                  (BTW: You may think that you can write UTF-16 strings to the Windows console by using <b>w</b>printf(), but that's not the case. It internally converts to the ANSI Codepage and replaces all characters by '?' that are not available in the current ANSI Codepage *d'oh*)</p>
                                </div>
                                <hr />

                                <div class="post">
                                  <p class="post-meta"><span class="post-author text-primary">jimpark</span><br />
                                  <span class="post-time small text-muted">23rd September 2011 15:02 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                                  <p class="post-content">Yes, we need #3 because UTF-16LE is the default encoding for anything Unicode on Windows. When you opened up a resource file in Developer Studio, you will find that it is encoded in UTF-16LE by default. If you save your text file as Unicode in Windows notepad, it is UTF-16LE by default.<br />
                                  <br />
                                  Also, we may need to access data from other Unicode resources like OpenType fonts. By default, for the Windows platform, the encoding of strings in the names section is UTF-16BE. (In fact, everything in an OpenType font file is big endian.) So if we need to get some data from other sources, likely, we will need to convert.</p>
                                </div>
                                <hr />

                                <div class="post">
                                  <p class="post-meta"><span class="post-author text-primary">LoRd_MuldeR</span><br />
                                  <span class="post-time small text-muted">23rd September 2011 15:09 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                                  <p class="post-content"></p>

                                  <blockquote>
                                    <small>Originally posted by jimpark</small><br />
                                    Yes, we need #3 because UTF-16LE is the default encoding for anything Unicode on Windows. When you opened up a resource file in Developer Studio, you will find that it is encoded in UTF-16LE by default. If you save your text file as Unicode in Windows notepad, it is UTF-16LE by default.
                                  </blockquote>We should think about this. Any halfway decent Text/Code editor can save as UTF-8. Even the Windows Notepad can ;)<br />
                                  <br />
                                  And, as said before, it is easy to convert between the different encodings <i>before</i> handing the file to MakeNSIS.<br />
                                  <br />
                                  Also, if you don't restrict NSI/NLF/NSH files to a specific encoding, how do you detect a file's actual encoding at runtime ???<br />
                                  <br />
                                  (I know that you may be able to guess the encoding via BOM character, but the BOM may be missing)<br />
                                  <br />
                                  <br />

                                  <blockquote>
                                    <small>Originally posted by jimpark</small><br />
                                    Also, we may need to access data from other Unicode resources like OpenType fonts. By default, for the Windows platform, the encoding of strings in the names section is UTF-16BE. (In fact, everything in an OpenType font file is big endian.) So if we need to get some data from other sources, likely, we will need to convert.
                                  </blockquote>That could be an issue :(<br />
                                  <br />
                                  BTW: Why does MakeNSIS have to deal with OpenType font files?<br />
                                  <br />
                                  [EDIT]<br />
                                  <br />
                                  After a quick Google search I found this:<br />
                                  <a href="http://utfcpp.svn.sourceforge.net/viewvc/utfcpp/v2_0/doc/utf8cpp.html?revision=HEAD" target="_blank">http://utfcpp.svn.sourceforge.net/vi...?revision=HEAD</a>
                                </div>
                                <hr />

                                <div class="post">
                                  <p class="post-meta"><span class="post-author text-primary">jimpark</span><br />
                                  <span class="post-time small text-muted">23rd September 2011 16:19 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                                  <p class="post-content">Frankly, NSIS doesn't really need to handle OpenType files. But it would be nice to. I've gotten requests to get version information and font name information so that a font can be updated for install. It's a perfectly valid thing to install fonts. And so I've provided those capabilities in the last release of Unicode NSIS.<br />
                                  <br />
                                  And all the existing users of Unicode NSIS probably have their NSI files as UTF-16LE.<br />
                                  <br />
                                  Anyway, I have no qualms about linking to new libraries. I don't want to write Unicode conversion code myself, especially if I have to support Unicode normalization. If makensis runs on Mac OS X, for example, it decomposes all the Unicode strings so even if you convert the strings to UTF-16LE, the decomposed character may not render correctly on Windows and will probably fail string comparisons with those entered by the user since Windows prefers composed characters. So normalization is also an issue. This is a consequence of Unicode support plus multi-platform support.</p>
                                </div>
                                <hr />

                                <div class="post">
                                  <p class="post-meta"><span class="post-author text-primary">LoRd_MuldeR</span><br />
                                  <span class="post-time small text-muted">24th September 2011 00:00 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                                  <p class="post-content">Back to another topic for a moment:<br />
                                  <br /></p>

                                  <blockquote>
                                    <small>Originally posted by jimpark</small><br />
                                    I just released a beta version of 2.46.3. I've still compiled it using MSVC 2010 and I did not need the EncoderPointer.lib since I do not link to the standard library in exehead. So NSIS itself still requires Windows XP+ to build installers but the installer it generates should be able to run under Windows 2000. Lord Mulder, can you check this when you have the time? I've also added GetFontName and GetFontNameLocal to round out the font commands.
                                  </blockquote>Can you please also re-compile the plug-ins? I noticed the nsExec plug-in fails on Win2k.<br />
                                  <br />
                                  By looking at the file dates, it seems the plug-ins included in v2.46.3 are the same as in v2.46.2.<br />
                                  <br />
                                  I reverted to the 'nsExec.dll' from your v2.46.1 release and the problem is gone...<br />
                                  <br />
                                  [EDIT]<br />
                                  <br />
                                  Okay, it seems that 'nsExec.dll' creates a temporary executable that does the actual job.<br />
                                  <br />
                                  While I don't understand why that is done, it explains the problem:<br />
                                  <br />
                                  The temporary EXE won't run on Windows 2000 because its <i>OperatingSystemVersion</i> field is <i>5.1</i>.<br />
                                  <br />
                                  (...because it has been compiled by the VisualStudio 2010 compiler)
                                </div>
                                <hr />

                                <div class="post">
                                  <p class="post-meta"><span class="post-author text-primary">jimpark</span><br />
                                  <span class="post-time small text-muted">24th September 2011 11:43 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                                  <p class="post-content">Thanks for the report, Lord Mulder. I thought I build everything with the correct SUBSYSTEM setting. I will check on that again. And I will clean out the objs. But you will have to wait until Monday for the new build.</p>
                                </div>
                                <hr />

                                <div class="post">
                                  <p class="post-meta"><span class="post-author text-primary">jimpark</span><br />
                                  <span class="post-time small text-muted">28th September 2011 13:44 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                                  <p class="post-content">I've updated the build and uploaded 2.46.3 Beta 2. Please let me know if you experience any problems.</p>
                                </div>
                                <hr />

                                <div class="post">
                                  <p class="post-meta"><span class="post-author text-primary">Anders</span><br />
                                  <span class="post-time small text-muted">28th September 2011 23:40 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                                  <p class="post-content">The next version of VS will drop XP support as well: <a href="http://connect.microsoft.com/VisualStudio/feedback/details/690617" target="_blank">http://connect.microsoft.com/VisualS...details/690617</a></p>
                                </div>
                                <hr />

                                <div class="post">
                                  <p class="post-meta"><span class="post-author text-primary">LoRd_MuldeR</span><br />
                                  <span class="post-time small text-muted">29th September 2011 10:59 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                                  <p class="post-content"></p>

                                  <blockquote>
                                    <small>Originally posted by jimpark</small><br />
                                    I've updated the build and uploaded 2.46.3 Beta 2. Please let me know if you experience any problems.
                                  </blockquote>Thanks! I will give it a try, as soon as I have some spare time...<br />
                                  <br />
                                  <b>[EDIT]</b> Just quick note: The 'uninst' stub still has a file date from 2002 <b>[/EDIT]</b><br />
                                  <br />

                                  <blockquote>
                                    <small>Originally posted by Anders</small><br />
                                    The next version of VS will drop XP support as well: <a href="http://connect.microsoft.com/VisualStudio/feedback/details/690617" target="_blank">http://connect.microsoft.com/VisualS...details/690617</a>
                                  </blockquote>:igor:<br />
                                  <br />
                                  Too bad. This would make the next VS useless for most developers for a long time. While the market share of Win7 is growing, XP still has around 40% (and Vista never got any noteworthy market share). Unless, of course, there will be a workaround to fix XP-compatibility.
                                </div>
                                <hr />
                                <!-- Bootstrap core CSS -->
                                <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
                                <!--[if lt IE 9]>
                <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
                <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->

                                <div class="container">
                                  <!-- Put navigation bar here -->

                                  <ol class="breadcrumb">
                                    <li><a href="../index.html" class="glyphicon glyphicon-home"></a></li>

                                    <li><a href="f-65.html">NSIS Discussion</a></li>

                                    <li class="active">Unicode</li>
                                  </ol>

                                  <p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=277381">Unicode</a></p><br />

                                  <div class="post">
                                    <p class="post-meta"><span class="post-author text-primary">jimpark</span><br />
                                    <span class="post-time small text-muted">29th September 2011 15:19 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                                    <p class="post-content">That's too bad. Visual Studio 2011 is supposed to support std::atomics and a lot of the std threading library. I was looking forward to that. No XP support would effectively kill it for us also. We need to support WinXP. Time to write to Microsoft.</p>
                                  </div>
                                  <hr />

                                  <div class="post">
                                    <p class="post-meta"><span class="post-author text-primary">mrjohn</span><br />
                                    <span class="post-time small text-muted">4th October 2011 09:21 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                                    <p class="post-content"></p>

                                    <blockquote>
                                      <small>Originally posted by LoRd_MuldeR</small><br />
                                      There has been a new Unicode NSIS release shortly:<br />
                                      <a href="http://code.google.com/p/unsis/downloads/list" target="_blank">http://code.google.com/p/unsis/downloads/list</a>
                                    </blockquote>Unicode Setup from this location is detected as Adware : :(<br />
                                    <br />
                                    <a href="http://www.virustotal.com/file-scan/report.html?id=82b3056fbbcf76cc6e177a22f48d0f48aa46e769039495ca2651ac29aa5e8c0b-1317715970" target="_blank">http://www.virustotal.com/file-scan/report.html?id=82b3056fbbcf76cc6e177a22f48d0f48aa46e769039495ca2651ac29aa5e8c0b-1317715970<br /></a>
                                  </div>
                                  <hr />

                                  <div class="post">
                                    <p class="post-meta"><span class="post-author text-primary">mrjohn</span><br />
                                    <span class="post-time small text-muted">4th October 2011 13:39 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                                    <p class="post-content">This is Avira response :<br />
                                    <br />
                                    Dear Sir or Madam,thank you for your email to Avira's virus lab.<br />
                                    Tracking number: INC00846451.<br />
                                    <br />
                                    We received the following archive files:<br />
                                    File ID Filename Size (Byte) Result<br />
                                    26326890 suspect_FALSE.zip 1.69 MB OK<br />
                                    <br />
                                    A listing of files contained inside archives alongside their results can be found below:<br />
                                    File ID Filename Size (Byte) Result<br />
                                    26326891 nsis-2.46.3-Unico...up.exe 1.71 MB <b>MALWARE</b><br />
                                    <br />
                                    <br />
                                    Please find a detailed report concerning each individual sample below:<br />
                                    Filename Result<br />
                                    nsis-2.46.3-Unico...up.exe MALWARE<br />
                                    <br />
                                    The file 'nsis-2.46.3-Unicode-setup.exe' has been determined to be 'MALWARE'.Our analysts named the threat ADWARE/Adware.Gen.This file is detected by a special detection routine from the engine module.<br />
                                    Please note that Avira's proactive heuristic detection module AHeAD detected this threat up front without the latest VDF update as: ADWARE/Adware.Gen.</p>
                                  </div>
                                  <hr />

                                  <div class="post">
                                    <p class="post-meta"><span class="post-author text-primary">jimpark</span><br />
                                    <span class="post-time small text-muted">5th October 2011 19:23 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                                    <p class="post-content"></p>

                                    <blockquote>
                                      <small>Originally posted by mrjohn</small><br />
                                      Unicode Setup from this location is detected as Adware : :(<br />
                                      <br />
                                      <a href="http://www.virustotal.com/file-scan/report.html?id=82b3056fbbcf76cc6e177a22f48d0f48aa46e769039495ca2651ac29aa5e8c0b-1317715970" target="_blank">http://www.virustotal.com/file-scan/report.html?id=82b3056fbbcf76cc6e177a22f48d0f48aa46e769039495ca2651ac29aa5e8c0b-1317715970<br /></a>
                                    </blockquote>I've checked the link and saw that they had listed nsis-2.46.3-Unicode-setup.zip which is not a name of any file I've uploaded. The MD5 digest it has listed do not match any file I've uploaded either. So I can only conclude that whatever file they've tested is not mine.
                                  </div>
                                  <hr />

                                  <div class="post">
                                    <p class="post-meta"><span class="post-author text-primary">LoRd_MuldeR</span><br />
                                    <span class="post-time small text-muted">5th October 2011 20:27 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                                    <p class="post-content">I'd write a mail to <a href="mailto:virus_malware@avira.com">virus_malware@avira.com</a> in order to clearify that.<br />
                                    <br />
                                    In my experience they are quite responsive...</p>
                                  </div>
                                  <hr />

                                  <div class="post">
                                    <p class="post-meta"><span class="post-author text-primary">jimpark</span><br />
                                    <span class="post-time small text-muted">11th October 2011 12:47 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                                    <p class="post-content">I wrote to avira and they verified that the Unicode NSIS files are showing as being clean.</p>
                                  </div>
                                  <hr />

                                  <div class="post">
                                    <p class="post-meta"><span class="post-author text-primary">Zinthose</span><br />
                                    <span class="post-time small text-muted">12th October 2011 16:25 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                                    <p class="post-content">Can we get a direct link? I can't find the download link on the site.<br />
                                    Можем ли мы получить прямую ссылку? Я не могу найти ссылку на скачивание на сайте.</p>
                                  </div>
                                  <hr />

                                  <div class="post">
                                    <p class="post-meta"><span class="post-author text-primary">Yathosho</span><br />
                                    <span class="post-time small text-muted">12th October 2011 16:28 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                                    <p class="post-content"></p>

                                    <blockquote>
                                      <small>Originally posted by Zinthose</small><br />
                                      Can we get a direct link? I can't find the download link on the site.<br />
                                      Можем ли мы получить прямую ссылку? Я не могу найти ссылку на скачивание на сайте.
                                    </blockquote><a href="http://code.google.com/p/unsis/downloads/list" target="_blank">http://code.google.com/p/unsis/downloads/list</a>
                                  </div>
                                  <hr />

                                  <div class="post">
                                    <p class="post-meta"><span class="post-author text-primary">Zinthose</span><br />
                                    <span class="post-time small text-muted">12th October 2011 16:41 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                                    <p class="post-content"></p>

                                    <blockquote>
                                      <small>Originally posted by Yathosho</small><br />
                                      <a href="http://code.google.com/p/unsis/downloads/list" target="_blank">http://code.google.com/p/unsis/downloads/list</a>
                                    </blockquote>.... OPPS.... :stare:<br />
                                    <br />
                                    I meant to post this in another topic... CURSE you multi-tabbed browsing!!
                                  </div>
                                  <hr />

                                  <div class="post">
                                    <p class="post-meta"><span class="post-author text-primary">Yathosho</span><br />
                                    <span class="post-time small text-muted">12th October 2011 17:56 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                                    <p class="post-content">it seems obvious, but is that ANSI build fully compatible with the official nsis? just asking, cause i'd prefer to install it over my current installation and not in a seperate folder.</p>
                                  </div>
                                  <hr />

                                  <div class="post">
                                    <p class="post-meta"><span class="post-author text-primary">jimpark</span><br />
                                    <span class="post-time small text-muted">12th October 2011 18:17 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                                    <p class="post-content">Yes, the ANSI build should be a superset of the official NSIS build.</p>
                                  </div>
                                  <hr />

                                  <div class="post">
                                    <p class="post-meta"><span class="post-author text-primary">fhkd</span><br />
                                    <span class="post-time small text-muted">18th October 2011 11:43 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                                    <p class="post-content"><strong>GetVersion.exe is not a valid Win32 application.</strong><br />
                                    Hello,<br />
                                    <br />
                                    I compiled following Code with Unicode NSIS 2.46.3:<br />
                                    <br /></p>
                                    <pre>
<code><br />!define File "program.exe"<br />OutFile "GetVersion.exe"<br /><br />Function .onInit<br /> ## Get file version<br /> GetDllVersion "${File}" $R0 $R1<br />  IntOp $R2 $R0 / 0x00010000<br />  IntOp $R3 $R0 &amp; 0x0000FFFF<br />  IntOp $R4 $R1 / 0x00010000<br />  IntOp $R5 $R1 &amp; 0x0000FFFF<br /> StrCpy $R1 "$R2.$R3.$R4.$R5"<br /><br /> ## Write it to a !define for use in main script<br /> FileOpen $R0 "DefineValues.txt" w<br /> FileWrite $R0 '!define PRODUCT_VERSION "$R1" $\n'<br /> FileClose $R0<br /><br /> Abort<br />FunctionEnd<br /><br />Section<br />SectionEnd<br /></code>
</pre><br />
                                    <br />
                                    I get a GetVersion.exe, but if I try to start it from the Windows Explorer, I get the message<br />
                                    <br />

                                    <blockquote>
                                      GetVersion.exe is not a valid Win32 application.
                                    </blockquote>If I use NSIS 2.46, it works fine and I get DefinesValues.txt with the entry !define PRODUCT_VERSION ....<br />
                                    <br />
                                    I know the post

                                    <blockquote>
                                      <small>Originally posted by vcoder</small><br />
                                      This script work well on ANSI version of NSIS and failed on Unicode version: ...
                                    </blockquote>I use Windows 7 64 bit, and other more complex Setup-Skript get compiled well with Unicode NSIS.
                                  </div>
                                  <hr />

                                  <div class="post">
                                    <p class="post-meta"><span class="post-author text-primary">LoRd_MuldeR</span><br />
                                    <span class="post-time small text-muted">18th October 2011 12:08 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                                    <p class="post-content">I saw this once. Try to include at least one FILE in your installer. Can be any non-empty dummy file.<br />
                                    <br />
                                    @jimpark: Any ideas?</p>
                                  </div>
                                  <hr />

                                  <div class="post">
                                    <p class="post-meta"><span class="post-author text-primary">fhkd</span><br />
                                    <span class="post-time small text-muted">18th October 2011 14:34 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                                    <p class="post-content"></p>

                                    <blockquote>
                                      <small>Originally posted by LoRd_MuldeR</small><br />
                                      I saw this once. Try to include at least one FILE in your installer. Can be any non-empty dummy file.<br />
                                      <br />
                                      @jimpark: Any ideas?
                                    </blockquote>Thanks for the answer.<br />
                                    <br />
                                    I tried first following solution:<br />
                                    <br />
                                    <pre>
<code><br />Section<br />!tempfile DUMMYFILE<br />!appendfile "${DUMMYFILE}" "${DUMMYFILE}"<br />File "${DUMMYFILE}"<br />!delfile "${DUMMYFILE}"<br />!undef DUMMYFILE<br />SectionEnd<br /></code>
</pre><br />
                                    <br />
                                    It doesn't help, also the dummyfile was packed.<br />
                                    <br />
                                    But after I tried<br />
                                    <br />
                                    <pre>
<code><br />Section<br />File "program.exe"<br />SectionEnd<br /></code>
</pre><br />
                                    <br />
                                    it works, also it is not nice.<br />
                                    <br />
                                    Thanks for the help!
                                  </div>
                                  <hr />

                                  <div class="post">
                                    <p class="post-meta"><span class="post-author text-primary">jimpark</span><br />
                                    <span class="post-time small text-muted">18th October 2011 15:36 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                                    <p class="post-content">Interesting. I will look into it.</p>
                                  </div>
                                  <hr />

                                  <div class="post">
                                    <p class="post-meta"><span class="post-author text-primary">fhkd</span><br />
                                    <span class="post-time small text-muted">19th October 2011 15:15 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                                    <p class="post-content">Hello again!<br />
                                    <br />
                                    While I tried to implement the solution with File "program.exe", I noticed the command !define /product_version in the NSIS User Manual.<br />
                                    <br />
                                    Solutions like<br /></p>

                                    <blockquote>
                                      <small>Originally posted by vcoder</small><br />
                                      OutFile "GetVersion.exe"
                                    </blockquote>with GetDLLVersion or GetDLLVersionLocal are for getting the version from a file on the building machine as a compiler constant during compile time, I think.<br />
                                    <br />
                                    With the command !define /product_version it's quite easier.<br />
                                    <br />
                                    So I write a little NSIS header <a href="http://forums.winamp.com/attachment.php?attachmentid=49224" target="_blank" title="Name: Views: Size: ">Attachment 49224</a> with the macros GetFileVersionLocal and GetProductVersionLocal.<br />
                                    Now I can get a constant with the version number without makeing a dummy setup.<br />
                                    <br />
                                    <pre>
<code><br />!insertmacro GetProductVersionLocal "$%windir%\system32\kernel32.dll" version<br />!echo "${version_0}.${version_1}.${version_2}.${version_3}"<br />!echo "${version}"<br /></code>
</pre><br />
                                    <br />
                                    For a description see the header file.
                                  </div>
                                  <hr />

                                  <div class="post">
                                    <p class="post-meta"><span class="post-author text-primary">Yathosho</span><br />
                                    <span class="post-time small text-muted">3rd November 2011 00:19 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                                    <p class="post-content">when trying to compile a script on windows 2003 server, i get this error:<br />
                                    <br />
                                    "The procedure entry point EncodePointer could not be located in the dynamic link library KERNEL32.dll"<br />
                                    <br />
                                    some seconds later a second message pops up:<br />
                                    <br />
                                    "Unable to initialize MakeNSIS. Please verify that makensis.exe is in the same directory as makensisw.exe"<br />
                                    <br />
                                    (it is in the same directory)</p>
                                  </div>
                                  <hr />

                                  <div class="post">
                                    <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
                                    <span class="post-time small text-muted">3rd November 2011 00:21 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                                    <p class="post-content">SP1 installed?</p>

                                    <blockquote>
                                      Minimum supported server<br />
                                      Windows Server 2008, Windows Server 2003 with SP1
                                    </blockquote>Stu
                                  </div>
                                  <hr />

                                  <div class="post">
                                    <p class="post-meta"><span class="post-author text-primary">LoRd_MuldeR</span><br />
                                    <span class="post-time small text-muted">3rd November 2011 00:54 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                                    <p class="post-content"></p>

                                    <blockquote>
                                      <small>Originally posted by Yathosho</small><br />
                                      when trying to compile a script on windows 2003 server, i get this error:<br />
                                      <br />
                                      "The procedure entry point EncodePointer could not be located in the dynamic link library KERNEL32.dll"<br />
                                      <br />
                                      some seconds later a second message pops up:<br />
                                      <br />
                                      "Unable to initialize MakeNSIS. Please verify that makensis.exe is in the same directory as makensisw.exe"<br />
                                      <br />
                                      (it is in the same directory)
                                    </blockquote>Please see my post here:<br />
                                    <a href="http://forums.winamp.com/showpost.php?p=2802963&amp;postcount=474" target="_blank">http://forums.winamp.com/showpost.ph...&amp;postcount=474</a><br />
                                    <br />
                                    In short: Binaries compiled with VS2010 don't run on systems prior to WinXP with SP-2, unless countermeasures are taken.<br />
                                    (Probably not a big deal for MakeNSIS, which runs on developer machine only, but important for the EXE stubs)
                                  </div>
                                  <hr />

                                  <div class="post">
                                    <p class="post-meta"><span class="post-author text-primary">Yathosho</span><br />
                                    <span class="post-time small text-muted">3rd November 2011 12:29 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                                    <p class="post-content"></p>

                                    <blockquote>
                                      <small>Originally posted by Afrow UK</small><br />
                                      Minimum supported server<br />
                                      Windows Server 2008, Windows Server 2003 with SP1
                                    </blockquote>i wonder where you even found that, such things should be mentioned on the website. anyway, i'm only using win 2003 because i have no legit copy of windows xp. so there should be no troubles when using xp (sp3)?
                                  </div>
                                  <hr />

                                  <div class="post">
                                    <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
                                    <span class="post-time small text-muted">3rd November 2011 12:37 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                                    <p class="post-content"></p>

                                    <blockquote>
                                      <small>Originally posted by Yathosho</small><br />
                                      i wonder where you even found that, such things should be mentioned on the website. anyway, i'm only using win 2003 because i have no legit copy of windows xp. so there should be no troubles when using xp (sp3)?
                                    </blockquote><a href="http://msdn.microsoft.com/en-us/library/bb432254%28v=vs.85%29.aspx" target="_blank">EncodePointer function's MSDN page</a>.<br />
                                    <br />
                                    Stu
                                  </div>
                                  <hr />

                                  <div class="post">
                                    <p class="post-meta"><span class="post-author text-primary">LoRd_MuldeR</span><br />
                                    <span class="post-time small text-muted">3rd November 2011 12:50 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                                    <p class="post-content"></p>

                                    <blockquote>
                                      <small>Originally posted by Yathosho</small><br />
                                      i wonder where you even found that, such things should be mentioned on the website. anyway, i'm only using win 2003 because i have no legit copy of windows xp. so there should be no troubles when using xp (sp3)?
                                    </blockquote>This is not a limitation of NSIS or Unicode NSIS in general. It's just a limitation of the Visual C++ 2010 CRT libraries. And, as <i>jimpark</i> switeched to VS2010 for his latest builds, these builds will now require Windows XP with SP-2 or later. To make it clear again: This only applies to MakeNSIS, not to the rersulting installer EXE. The created installer EXE even runs on Windows 2000...<br />
                                    <br />
                                    (Just be sure you really use the latest Unicode NSIS. There was a version that is broken with Win2k!)
                                  </div>
                                  <hr />

                                  <div class="post">
                                    <p class="post-meta"><span class="post-author text-primary">Anders</span><br />
                                    <span class="post-time small text-muted">17th November 2011 22:48 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                                    <p class="post-content">Stdin handling is broken:<br />
                                    <br /></p>
                                    <pre>
<code>makensis - &lt; Examples\example1.nsi</code>
</pre>
                                  </div>
                                  <hr />

                                  <div class="post">
                                    <p class="post-meta"><span class="post-author text-primary">Larsen</span><br />
                                    <span class="post-time small text-muted">19th January 2012 09:12 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                                    <p class="post-content">@Jim: Thanks a lot for the unicode version! It made my supporting other languages in my installer a lot easier.<br />
                                    <br />
                                    I didn´t read through all of the previous 13 pages: Is there already a date when unicode will be available in the vanilla NSIS version? I read something about MakeNSIS v2.50...</p>
                                  </div>
                                  <hr />

                                  <div class="post">
                                    <p class="post-meta"><span class="post-author text-primary">MSG</span><br />
                                    <span class="post-time small text-muted">19th January 2012 10:44 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                                    <p class="post-content">There is no date, nor is there any progress to speak of concerning the unicodification of NSIS trunk. If it will ever happen, it won't be any time soon.</p>
                                  </div>
                                  <hr />

                                  <div class="post">
                                    <p class="post-meta"><span class="post-author text-primary">Larsen</span><br />
                                    <span class="post-time small text-muted">19th January 2012 11:41 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                                    <p class="post-content">That´s a pity =(</p>
                                  </div>
                                  <hr />

                                  <div class="post">
                                    <p class="post-meta"><span class="post-author text-primary">DrO</span><br />
                                    <span class="post-time small text-muted">19th January 2012 11:45 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                                    <p class="post-content">as there's no proper focus on getting things done, different people want it to be done in different ways (i.e. some just want to go all unicode and leave at that, others want to sort out what is basically a final ansi version, etc etc) and there's no consensus on how it should be done which makes what MSG said pretty reasonable for there being no eta.<br />
                                    <br />
                                    -daz</p>
                                  </div>
                                  <hr />

                                  <div class="post">
                                    <p class="post-meta"><span class="post-author text-primary">Larsen</span><br />
                                    <span class="post-time small text-muted">19th January 2012 11:59 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                                    <p class="post-content">What about branching? NSIS 3 would be unicode and NSIS 2 could still get bug fixes.</p>
                                  </div>
                                  <hr />

                                  <div class="post">
                                    <p class="post-meta"><span class="post-author text-primary">DrO</span><br />
                                    <span class="post-time small text-muted">19th January 2012 12:17 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                                    <p class="post-content"></p>

                                    <blockquote>
                                      <small>Originally posted by DrO</small><br />
                                      as there's no proper focus on getting things done
                                    </blockquote>that is the biggest issue. and branching won't help - in fact i think that it's gotten us into this mess to begin with as people are using the unofficial unicode version yet expect support for it, etc. doing another branch with all of the issues i mentioned is just going to be even more of a pain for everyone concerned, ignoring the fact of who is going to do it?<br />
                                    <br />
                                    -daz
                                  </div>
                                  <hr />

                                  <div class="post">
                                    <p class="post-meta"><span class="post-author text-primary">Yathosho</span><br />
                                    <span class="post-time small text-muted">19th January 2012 12:53 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                                    <p class="post-content"></p>

                                    <blockquote>
                                      <small>Originally posted by DrO</small><br />
                                      as there's no proper focus on getting things done, different people want it to be done in different ways [...] there's no consensus on how it should be done
                                    </blockquote>even open-source projects need decisions and people who make them. so why not let the community decide which direction nsis will go or who will be the decision-makers? that only leaves the question who should be able to vote.
                                  </div>
                                  <hr />

                                  <div class="post">
                                    <p class="post-meta"><span class="post-author text-primary">DrO</span><br />
                                    <span class="post-time small text-muted">19th January 2012 13:02 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                                    <p class="post-content">i'm not disagreeing with that point and things can or should be decided on, it still requires people to do things and that seems to be the biggest issue with getting things actually put into place and moving.<br />
                                    <br />
                                    hell i'd love to help out (like i did many years back) but this pesky thing known as work gets in the way.<br />
                                    <br />
                                    no one is disagreeing that a proper unicode version needs to be done. but how that is to be done (which is more about the implementation than what the end user actually sees) is the biggest stopping point it seems. and with your point, no one is gong to be able to do that if there's no proper structure on who is in proper control of things.<br />
                                    <br />
                                    <br />
                                    between jim's version, the stuff wizou started to do, what anders has been doing, we've got 3 instances of things being all over the shop without any true focus, not quite doing things the same and just overall causing more confusion - look at the number of posts from people who cannot get plug-ins to work as they think this unicode one is official and don't know what is / isn't correct.<br />
                                    <br />
                                    <br />
                                    it's really just a big cockup when you look at it all overall which is more detrimental to the community in the long run it seems (going on what i've seen from people's posts over the last few years).<br />
                                    <br />
                                    -daz</p>
                                  </div>
                                  <hr />

                                  <div class="post">
                                    <p class="post-meta"><span class="post-author text-primary">Anders</span><br />
                                    <span class="post-time small text-muted">19th January 2012 21:16 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                                    <p class="post-content">The major problem is that the unicode fork uses MS 2005+ CRT specific stuff and the official NSIS supports compiling (and building) on VC6, MinGW and POSIX. (The unicode fork is broken in certain places (scroll up to my previous post) since it just relies on the MS code to do all conversion for it) The current code also mixes WCHAR and wchar_t which is a major no-no on POSIX, on Windows they are both UTF16LE but wchar_t can be any type on other platforms...<br />
                                    <br />
                                    Except for the UTF8 langfile support in the ANSI build, all the other stuff I have been doing is generic and should benefit both.</p>
                                  </div>
                                  <hr />

                                  <div class="post">
                                    <p class="post-meta"><span class="post-author text-primary">LoRd_MuldeR</span><br />
                                    <span class="post-time small text-muted">10th March 2012 12:23 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                                    <p class="post-content"><b>@jimpark:</b><br />
                                    <br />
                                    I am running into a little problem with latest Unicode NSIS (v2.46.4) release:<br />
                                    <br />
                                    My code looks like this:</p>
                                    <pre>
<code>!searchreplace PRODUCT_VERSION_DATE "${LAMEXP_DATE}" "-" "."</code>
</pre><br />
                                    <br />
                                    LAMEXP_DATE contains something like "2012-03-10"<br />
                                    <br />
                                    The expected output in PRODUCT_VERSION_DATE is "2012.03.10" (right?), but I only get "2012." :confused:<br />
                                    <br />
                                    Went back to Maknsis.exe from Unicode NSIS v2.46.3 release and the issue is gone.<br />
                                    <br />
                                    Can you look into this? Thanks! :)
                                  </div>
                                  <hr />

                                  <div class="post">
                                    <p class="post-meta"><span class="post-author text-primary">georgik</span><br />
                                    <span class="post-time small text-muted">12th May 2013 06:17 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                                    <p class="post-content"><strong>Unicode Python plugin for Unicode NSIS</strong><br />
                                    Hi!<br />
                                    <br />
                                    I patched Python plugin for NSIS. Now it also supports Unicode NSIS.<br />
                                    Here is more information about that: <a href="http://georgik.sinusgear.com/2013/05/12/unicode-python-plugin-for-unicode-nsis/" target="_blank">http://georgik.sinusgear.com/2013/05...-unicode-nsis/</a><br />
                                    <br />
                                    You can find projet at github - <a href="https://github.com/georgik/nsPythonUnicode" target="_blank">nsPythonUnicode</a><br />
                                    <br />
                                    It was tested on Windows XP, Vista, 7, 8, 2003, 2008, 2012.<br />
                                    <br />
                                    Happy Python coding with Unicode NSIS. ;-)</p>
                                  </div>
                                  <hr />

                                  <div class="post">
                                    <p class="post-meta"><span class="post-author text-primary">MaGoth</span><br />
                                    <span class="post-time small text-muted">25th July 2013 15:54 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                                    <p class="post-content">Hi all, :)<br />
                                    On the official website there is a new version <a href="http://nsis.sourceforge.net/Download" target="_blank">NSIS 3.0a1</a> (<i>Released July 14, 2013</i>).<br />
                                    Do you plan to update to version Unicode NSIS? :rolleyes:</p>
                                  </div>
                                  <hr />

                                  <div class="post">
                                    <p class="post-meta"><span class="post-author text-primary">redxii</span><br />
                                    <span class="post-time small text-muted">26th July 2013 05:30 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                                    <p class="post-content">3.0 has unicode support already.</p>
                                  </div>
                                  <hr />

                                  <div class="post">
                                    <p class="post-meta"><span class="post-author text-primary">roytam1</span><br />
                                    <span class="post-time small text-muted">29th October 2013 04:14 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                                    <p class="post-content">Unicode NSIS 2.46.5 fails with packhdr again?<br /></p>
                                    <pre>
<code>I:\&gt;upx --best --force "C:\DOCUME~1\User\LOCALS~1\Temp\exehead.tmp" <br />                       Ultimate Packer for eXecutables<br />                          Copyright (C) 1996 - 2013<br />UPX 3.09w       Markus Oberhumer, Laszlo Molnar &amp; John Reiser   Feb 18th 2013<br /><br />        File size         Ratio      Format      Name<br />   --------------------   ------   -----------   -----------<br />upx: C:\DOCUME~1\User\LOCALS~1\Temp\exehead.tmp: CantPackException: superfluous data between sections<br /><br />Packed 1 file: 0 ok, 1 error.<br /></code>
</pre>
                                  </div>
                                  <hr />

                                  <div class="footer">
                                    <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
                                  </div>
                                </div><script src="../js/highlight.pack.js" type="text/javascript">
</script> <script type="text/javascript">
//<![CDATA[
                                hljs.initHighlightingOnLoad();
                                //]]>
                                </script>
                              </div>
                            </div>
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</body>
</html>
