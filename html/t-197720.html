<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="description" content="Upgrade Code Explanation"><title>Upgrade Code Explanation - NSIS Forums</title><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script><link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css"><link rel="stylesheet" href="../css/style.css" type="text/css"><!--[if lt IE 9]><script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script><script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script><![endif]--></head><body><div class="container"><ol class="breadcrumb"><li><a href="../index.html" class="glyphicon glyphicon-home"></a></li><li><a href="f-65.html">NSIS Discussion</a></li><li class="active">Upgrade Code Explanation</li></ol><p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=197720">Upgrade Code Explanation</a></p><br><div class="post"><p class="post-meta"><span class="post-author text-primary">SmilingBandit</span><br><span class="post-time small text-muted">28th October 2004 21:06 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>Upgrade Code Explanation</strong><br>Ok, so my installer can detect if it is already installed, and can launch the uninstaller from the previous version before the new files are installed. The uninstall process launches in an Upgrade section.<br><br>Now here's the crazy thing, it wasnt working using</p><pre>
<code>nsExec::Exec '"$INSTDIR\uninstall.exe" /S'</code>
</pre><br>But I found this code in the archive <a href="http://nsis.sourceforge.net/archive/viewpage.php?pageid=326" target="_blank">here</a> to do this very thing, and the code shows the upgrade process like this:<br><pre>
<code>ExecWait '$R0 _?=$INSTDIR'</code>
</pre><br>So I changed my code accordingly, and now the upgrade magically works. So what on earth does this <b>_?=$INSTDIR</b> option do??</div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">pengyou</span><br><span class="post-time small text-muted">28th October 2004 23:57 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">See the FAQ:<br><br><a href="http://nsis.sourceforge.net/index.php?id=19&amp;backPID=15&amp;tx_faq_faq=14" target="_blank">http://nsis.sourceforge.net/index.ph...&amp;tx_faq_faq=14</a></p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">SmilingBandit</span><br><span class="post-time small text-muted">29th October 2004 13:22 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Thanks, I looked everywhere else but the FAQ for that answer, searched the forums, searched the archive, searched through the NSIS source code even.<br><br>Maybe it should be pointed out in the NSIS help file so other idiots like me dont waste time with this :D</p></div><hr><div class="footer"><p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p></div></div><script src="../js/highlight.pack.js" type="text/javascript"></script><script type="text/javascript">//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]></script></body></html>