<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="nsExec and SC.exe syntax problem" />

  <title>nsExec and SC.exe syntax problem - NSIS Forums</title>
  <script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script>
  <!-- Bootstrap core CSS -->

  <link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css" />
  <link rel="stylesheet" href="../css/style.css" type="text/css" /><!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!--[if lt IE 9]>
                <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
                <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->
</head>

<body>
  <div class="container">
    <!-- Put navigation bar here -->

    <ol class="breadcrumb">
      <li><a href="../index.html" class="glyphicon glyphicon-home"></a></li>

      <li><a href="f-65.html">NSIS Discussion</a></li>

      <li class="active">nsExec and SC.exe syntax problem</li>
    </ol>

    <p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=231096">nsExec and SC.exe syntax problem</a></p><br />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">thelliez</span><br />
      <span class="post-time small text-muted">15th November 2005 20:35 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>nsExec and SC.exe syntax problem</strong><br />
      I am trying to start the service "Apache Tomcat 4.1" under Windows 2003.<br />
      <br />
      The following worked for services with no spaces in their name, but it fails for Tomcat.<br />
      <br />
      Worked:<br />
      nsExec::Exec '"$COMSPEC" /C ("sc" config myService obj= .\$U password= $P)'<br />
      <br />
      Failed:<br />
      nsExec::Exec '"$COMSPEC" /C ("sc" config "Apache Tomcat 4.1" obj= .\$U password= $P)'<br />
      <br />
      Any suggestions about this spaces problem?<br />
      Thanks,<br />
      Thierry</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
      <span class="post-time small text-muted">16th November 2005 18:14 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">What are the parenthesis for? Why use $COMSPEC? sc.exe is an executable, not an internal command. If it doesn't work without those two, how about trying one of the <a href="http://nsis.sourceforge.net/How_do_I_start/stop/create/remove/check_a_service" target="_blank">other solutions</a>?</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">thelliez</span><br />
      <span class="post-time small text-muted">16th November 2005 19:05 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">The COMSPEC might not be needed, but it was an attempt to understand some strange differences between two W2K3 boxes. On one of them $SYSDIR\sc.exe was not found by nsExec, although sc was present in this directory. (I had the same problem with cscript. Sometimes the full path worked, sometimes calling only "sc" or "cscript" worked. I looked at the PATH without finding issues there).<br />
      <br />
      The parenthesis are there to help with too many levels of quotes. Otherwise I would have written something like:<br /></p>

      <blockquote>
        '"$COMSPEC" /C ""sc" config "Apache Tomcat 4.1" obj= .\$U password= $P"'
      </blockquote>Right now the above works (the parenthesis version) if it is encapsualted in a .bat file and nsExec calls this .bat<br />
      <br />
      It does not work when I directly call it from nsExec.<br />
      <br />
      Other libraries could be used, but sc looked so simple.<br />
      <br />
      Encapsulating in a .bat is a workable solution.<br />
      <br />
      Thierry
    </div>
    <hr />

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]>
  </script>
</body>
</html>
