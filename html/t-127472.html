<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="Logging, Error handling, Stop Services?" />

  <title>Logging, Error handling, Stop Services? - NSIS Forums</title>
  <script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script>
  <!-- Bootstrap core CSS -->

  <link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css" />
  <link rel="stylesheet" href="../css/style.css" type="text/css" /><!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!--[if lt IE 9]>
                <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
                <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->
</head>

<body>
  <div class="container">
    <!-- Put navigation bar here -->

    <ol class="breadcrumb">
      <li><a href="../index.html" class="glyphicon glyphicon-home"></a></li>

      <li><a href="f-65.html">NSIS Discussion</a></li>

      <li class="active">Logging, Error handling, Stop Services?</li>
    </ol>

    <p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=127472">Logging, Error handling, Stop Services?</a></p><br />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">aschenbachen</span><br />
      <span class="post-time small text-muted">6th March 2003 14:55 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>Logging, Error handling, Stop Services?</strong><br />
      Hello,<br />
      <br />
      i would like to add more features to the install script. three questions:<br />
      <br />
      1.) How to record a log to a file from doing so much copy files, install applications?<br />
      i found a function called 'page', but first 'logset' needs to be 'on'. 'logtext' needs to be use.<br />
      <br />
      <br />
      <br />
      2.) how to i tell the script to stop mysql service temporary, to delete a mysql log file?<br />
      <br />
      <br />
      3.) How do i use the errorhanding functions, there appeares to only be a few of them from NSIS.<br />
      <br />
      Asch</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Sunjammer</span><br />
      <span class="post-time small text-muted">6th March 2003 15:26 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">1) To get nsis to log it's activity you need to recompile with logging enabled, many people are not capable of recompiling NSIS because they do not have VC++6 or VC.NET. Of course you could just write to a file using NSIS file writing commands yourself.<br />
      <br />
      2) Either use my services plugin from the Archive downloads page or issue the command "net stop servicename".<br />
      <br />
      3) Error handling consists of checking IfErrors, nothing more (that I am aware of). More complex handling can be achieved by setting more specific flags (variables) yourself and checking them at a convenient place in the script.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">aschenbachen</span><br />
      <span class="post-time small text-muted">6th March 2003 15:50 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>Re: Logging, Error handling, Stop services!</strong><br />
      Hello,<br />
      I have been reading other threads about logging, there seems to be difficulties in logging with NSIS. There are solutions for other users' problems. For better logging, one must recompile NSIS, which is fine.<br />
      In Win XP pro, from the Dos prompt type:<br />
      <br />
      cl<br />
      <br />
      i usually type:<br />
      <br />
      cl /G4 or /G5 name.cpp<br />
      <br />
      this is the Window build in c/c++ compiler/linker. If on one knows about this, Now you know. its a nice feature.<br />
      <br />
      this might work for others if they have Win XP pro.<br />
      <br />
      Also, Borland has a Free GUN version of C++, with GUEE interface just like the MS-VS-C++<br />
      <br />
      Back to my problem:<br />
      1.)I needed basic logging, so once i set 'Logset on',i should be able to use 'logtext'.<br />
      May i have an example from logtext with all the perammeters.<br />
      <br />
      2.) how do i stop service Mysql service using 'WriteRegStr HKLM' one of these build in NSIS variables?<br />
      <br />
      example please.<br />
      <br />
      3.) i guess i have do little error handling after all, since there are no more than that function code.<br />
      <br />
      I will put the codes online if anyone needed. After Help is given to me.<br />
      <br />
      Sincerely,<br />
      <br />
      Asch</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Sunjammer</span><br />
      <span class="post-time small text-muted">6th March 2003 16:08 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">1) I don't think compilers other than VC++6 and possibly VC.NET are supported by us (NSIS developers), good luck if you can get it working on another compiler and please pass on any info about how you got it to work pretty please :)<br />
      <br />
      As the documentation indicates LogText only has one parameter. You say LogText text. Anything in the text parameter is logged to the log file. It's that simple.<br />
      <br />
      Full information can be found in <a href="file:///C:/src/cvs_nsis/NSIS/Docs/Chapter3.html#3.8.12" target="_blank">Section 3.8.12</a> of the NSIS docs.<br />
      <br />
      2) Exec "net stop mysql"<br />
      <br />
      3) You might want to use IfErrors to ensure that all of your files copied correctly etc.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">aschenbachen</span><br />
      <span class="post-time small text-muted">6th March 2003 16:44 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>Logging, error handling, stop services!</strong><br />
      Hello sunjammer,<br />
      <br />
      sure i will try compiling NSIS App using my win build in compiler in XP pro today.<br />
      Tell me where is the head and tails of this NSIS software, Where is the "main()" function and exactly where it is?<br />
      <br />
      <br />
      i don't have Borland's C++ GNU compiler.<br />
      its only 11 MB to download.<br />
      <br />
      Another question, how do i stop a CMF software from the open source community call Zope from zope.org. this thing is weird, everything is written in python, no EXE files anywhere in this running application.<br />
      <br />
      Can i stop zope withone of these HKLM variables? if i could find the register zope key. to tell it to stop service.<br />
      <br />
      Asch</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Sunjammer</span><br />
      <span class="post-time small text-muted">6th March 2003 16:51 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">I know absolutely nothing about Zope, sorry. You can stop the Zope server <b>if</b> it is an installed service (appears in Control Panel-&gt;Administrative Tools-&gt;Services) using the "net stop servicename" syntax I mentioned above.<br />
      <br />
      I think you will have trouble compiling NSIS with another compiler like Borland, good luck. What is this "win build in" compiler you refer to? There isn't a built-in compiler in XP or XP pro AFAIK!<br />
      <br />
      Why do you want to know where main() is? To compile the code you don't need to understand it. The main function for makensis.exe is in source\makenssi.cpp. The mai) function for the header attached to the installer created by makensis.exe is in source\exehead\Main.c (called WinMain, not main).</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">aschenbachen</span><br />
      <span class="post-time small text-muted">6th March 2003 18:38 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">hello,<br />
      <br />
      is it possbible for someone to compile a new version of NSIS 2.0b1 with the LOGGING enable and post it here or somewhere.<br />
      After reading more of the other users' experience, i realized that LOGGING-&gt; LOGTEXT is not build in to this version.<br />
      i fear to compile the source of 2.0b1 with XP build in compiler/linker will have problems.<br />
      <br />
      <br />
      Sincerely,<br />
      <br />
      Asch</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">RDaneel</span><br />
      <span class="post-time small text-muted">6th March 2003 22:49 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Sunjammer (and anyone else who is scratching their heads over this "builtin MS C/C++ compiler issue),<br />
      <br />
      The deal here is that [possibly starting in 2003] the ".NET Framework SDK" free download from MS *includes* the command-line version of the VC7 compiler - but NO GUI. Really. :)</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Sunjammer</span><br />
      <span class="post-time small text-muted">6th March 2003 23:17 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">#@!£ing hell !! I'm suprised they did that !</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">RDaneel</span><br />
      <span class="post-time small text-muted">6th March 2003 23:25 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">While I am sure it's all part of some nefarious MS plot, you might check out:<br />
      <br />
      <a href="http://www.icsharpcode.net/OpenSource/SD/Default.aspx" target="_blank">http://www.icsharpcode.net/OpenSource/SD/Default.aspx</a><br />
      <br />
      for some related info - note that they are also users of NSIS, which is how they came to my attention.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">aschenbachen</span><br />
      <span class="post-time small text-muted">7th March 2003 16:38 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>re: Logging and c/c++ compiler from MS</strong><br />
      Hello,<br />
      <br />
      i made a mistake, there is no C/C++ compiler that comes with WIN XP pro. I was mistaken about due to that i install MS-VS-6.0 to this laptop and in the DOS batch "autoexec.bat" durinng installation of this software, VS6.0-C++ made a extension to my pathing statement %PATH% which added the actual compiler/linker if you use the dos interface.<br />
      <br />
      So i now can access the graphical compiler VS6.0-C++ in a DOS prompt.<br />
      <br />
      Sorry about that.<br />
      <br />
      Still, anyone compiled a copy with Logging enable, i can't seem to compile the source, there were lots of *.obj Errors during compilation process.<br />
      <br />
      <br />
      Asch</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
      <span class="post-time small text-muted">7th March 2003 16:43 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Compile using Release instead of Debug. If you have the latest Platform SDK there shouldn't be any problems.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">aschenbachen</span><br />
      <span class="post-time small text-muted">7th March 2003 18:45 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">hello,<br />
      <br />
      i have recompiled this application with the logging avability enable.<br />
      <br />
      I don't know if i should put it on this forum, if anyone want to use this recompile software with source codes.<br />
      <br />
      it is about 2.8 Meg of stuff!!!<br />
      If any of the forum Moderator would like to have a copy. Email me too. i will sent it to you.<br />
      <br />
      Email me @ <a href="mailto:aschenbach0@lycos.com">aschenbach0@lycos.com</a><br />
      <br />
      Asch</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Sunjammer</span><br />
      <span class="post-time small text-muted">7th March 2003 18:46 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">only the exe is needed, that's nowhere near 2.8mb of course</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">aschenbachen</span><br />
      <span class="post-time small text-muted">7th March 2003 21:08 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>Still having problem with Logging.</strong><br />
      Hello sunjammer,<br />
      <br />
      after zipped up the makensis.exe file, its small enough to ship it anywhere.<br />
      <br />
      i am still having problem as to how to log stuff in the codes.<br />
      <br />
      here is a sample.<br />
      <br />
      ;works in run time<br />
      function "creatdir"<br />
      ; need to log all copyig and creating dirs<br />
      LogSet on<br />
      strcpy $INSTDIR "C:\"<br />
      copyfiles "c:\temp\*.*" "c:\"<br />
      createdirectory "C:\temp\copy"<br />
      LogText "Dirs created"<br />
      setoutpath "$INSTDIR\temp"<br />
      file "C:\temp\erraten.log"<br />
      functionend<br />
      <br />
      Alright, i want to suck in a file name erraten.log. i assume the syntax for Logtext is just like on the above.<br />
      <br />
      i needed to output to that file "dir created" and all the files that got transfer from c:\temp to c:\ in that log file.<br />
      <br />
      Is that right (syntax wise)?<br />
      it won't log?<br />
      <br />
      Asch</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
      <span class="post-time small text-muted">7th March 2003 21:13 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">You'll need to update to the latest CVS version for LogSet on to work.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">aschenbachen</span><br />
      <span class="post-time small text-muted">7th March 2003 21:21 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Hello,<br />
      <br />
      well, just might forget about logging completely. Can you point me to get the proper files put it where in directories.<br />
      i guess i have to recompile the source all over again.<br />
      <br />
      :-(<br />
      <br />
      Asch</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
      <span class="post-time small text-muted">7th March 2003 21:23 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">You can use NSIS Update to get the latest files. I am sorry I forgot to mention this earlier.</p>
    </div>
    <hr />

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]>
  </script>
</body>
</html>
