<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="Using CABARC.EXE for large installer in background and show progressbar." />

  <title>Using CABARC.EXE for large installer in background and show progressbar. - NSIS Forums</title><!-- Bootstrap core CSS -->
  <link rel="stylesheet" type="text/css" href="//netdna.bootstrapcdn.com/bootswatch/3.0.1/readable/bootstrap.min.css" />
  <link rel="stylesheet" href="../css/style.css" type="text/css" /><!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!--[if lt IE 9]>
                <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
                <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->
</head>

<body>
  <div class="container">
    <!-- Put navigation bar here -->

    <ol class="breadcrumb">
      <li><a href="../index.html" class="glyphicon glyphicon-home"></a></li>

      <li><a href="f-65.html">NSIS Discussion</a></li>

      <li class="active">Using CABARC.EXE for large installer in background and show progressbar.</li>
    </ol>

    <p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=301003">Using CABARC.EXE for large installer in background and show progressbar.</a></p><br />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">n_baua</span><br />
      <span class="post-time small text-muted">13th December 2008 08:00 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>Using CABARC.EXE (in background ) for large installer and show progressbar.</strong><br />
      Hello,<br />
      <br />
      I want to create a large(rather huge) installer.<br />
      I have gone through the "CabSetup.dll" post and found a suitable hint, however this time I have the following requirements.<br />
      <br />
      1. I am planning to use a DVD(4.5-5GB) and my files will be distributed using a single DVD.<br />
      2. I have created .cab files for all dependent files and want to extract these files using "cabarc.exe" from microsoft.<br />
      2a. While extracting this i want the user to see a nice progressbar (see attachment).<br />
      2b. Want to delete the cab files post extraction<br />
      2c. see the error(if any) of "cabarc.exe" stright on the screen.<br />
      <br />
      Can you please suggest, solution for these?<br />
      I use ModernUI.<br />
      <br />
      NBaua</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Animaether</span><br />
      <span class="post-time small text-muted">13th December 2008 11:14 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Create a custom page using NSDialogs, place two progressbars on it - you can control these further with nsdialogs.<br />
      <br />
      Delete the CAB files? They're on the DVD, no? If you are copying them to the HDD first, then Delete &lt;file&gt; should be fine. Use ExecWait so that your NSIS script code only continues after cabarc.exe is done.<br />
      <br />
      ExecWait also takes a user variable ($0, etc.) to get the output from the application launched. The output is typically an error code, so you may have to check what error codes cabarc.exe uses for various error messages and display them in a more user-friendly manner. That information may be in the CAB SDK, but I wouldn't know :)<br />
      Alternatively, use one of the plugins that can log the information you'd otherwise see in STDOUT (what you see in a DOS/Console window) to a file, and read from that. E.g. nsExec, ExecDos</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">n_baua</span><br />
      <span class="post-time small text-muted">13th December 2008 14:30 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Hi Animaether,<br />
      <br />
      Thanks for your reply,<br />
      <br />
      Mean while you posted here, I updated my code to nsExec.<br />
      It did wait for the CABARC.exe and i get a nice log too.<br />
      <br />
      However I do not have expertise with the NSDialogs yet.<br />
      Can you show me some sample script, which I can easily incorporate in my code?<br />
      <br />
      Thanks pal.<br />
      <br />
      -NBaua<br />
      <br />
      PS - --<br />
      Yes, I managed to run the cab files from DVD itself.<br />
      I was under impression of copying them first, thanks again for bringing it to my notice once again.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Animaether</span><br />
      <span class="post-time small text-muted">13th December 2008 16:36 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">hmm.. I'd give you example code, except it looks like nsdialogs crashes on this machine.<br />
      <br />
      Edit: Ah, whoops. The online docs forgot '/NOUNLOAD', so my template copy/paste crashed.<br />
      <br />
      In addition, the progress bar is not officially in yet - looks like kichik is working on that.<br />
      <br />
      Think you'd have to use InstallOptionsEx and crazy code. hrm. I swear there was a better way to do this.. or using LoadingBar/Nxs/etc.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
      <span class="post-time small text-muted">13th December 2008 17:23 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">The online docs are for the next version. I was actually <a href="https://sourceforge.net/tracker2/?func=detail&amp;aid=2405615&amp;group_id=22049&amp;atid=373085" target="_blank">planning</a> on having all the versions there and having Docs point to the latest version, rather than the future version. I also want to add some kind of watermarking on everything there so people know it's for a specific version. I already have all the documentation compiled as HTML, along with all the examples for all the versions since 2.07. I just need to get to implementing the rest and uploading it. If someone wants to help with that, it'd be great.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">renue</span><br />
      <span class="post-time small text-muted">1st December 2009 07:04 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>Add folder to Cab</strong><br />
      HI All,<br />
      <br />
      I am creating a cab component for My ActiveX Control. In that cab component I am adding few installer that needs to run on the client browser at the time of requesting for ActiveX control. For One installer I need Complete folder in the Cab. Could some one help me out in adding a complete folder to Cab. I tried using Cabarc tool. But i could Not find any solution.<br />
      <br />
      thanks in advance,<br />
      Renu</p>
    </div>
    <hr />

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]>
  </script>
</body>
</html>
