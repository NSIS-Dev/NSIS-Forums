<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="New user: Simple problem?" />

  <title>New user: Simple problem? - NSIS Forums</title><!-- Bootstrap core CSS -->
  <link rel="stylesheet" type="text/css" href="//netdna.bootstrapcdn.com/bootswatch/3.0.1/readable/bootstrap.min.css" />
  <link rel="stylesheet" href="../css/style.css" type="text/css" /><!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!--[if lt IE 9]>
                <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
                <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->
</head>

<body>
  <div class="container">
    <!-- Put navigation bar here -->

    <ol class="breadcrumb">
      <li><a href="../index.html" class="glyphicon glyphicon-home"></a></li>

      <li><a href="f-65.html">NSIS Discussion</a></li>

      <li class="active">New user: Simple problem?</li>
    </ol>

    <p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=318445">New user: Simple problem?</a></p><br />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kwhite9266</span><br />
      <span class="post-time small text-muted">15th April 2010 22:16 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>New user: Simple problem?</strong><br />
      Hi, I'd like to just start off by saying I am NOT a programmer of any kind. I actually inherited a project from a coworker who is quitting and I need to create a fairly basic installer.<br />
      <br />
      I work for a textbook publisher. The goal of the installer is to extract a folder filled with educational data files for use with a 3rd party software. I have a copy of the folder ready to go (the way it should look on a student's computer).<br />
      <br />
      Using the very basic ZIP to EXE function, I've been able to make a bare-bones installer that replicates my data folder in the correct location. However I need a license page and an accept page to go along with it.<br />
      <br />
      I've DONE those (the license works, although I'm not quite sure how to add an image to my license page, i.e. the book cover) and the installation page both work fine. Unfortunately all I can figure out how to do is get the ZIP to copy to my destination folder; I can't get the contents of the zip to actually extract into the output folder.<br />
      <br />
      I know I'm missing something fairly simple, but I've been looking over the manual and haven't seen anything that looks like a "run" or "extract" File command.<br />
      <br />
      Here's what my very, very basic script looks like:<br />
      <br />
      <font face="Courier New">!include "MUI2.nsh"<br />
      <br />
      Name "PROGRAM NAME"<br />
      OutFile "PROGRAM.exe"<br />
      <br />
      InstallDir "C:\" &lt;---the data needs to be installed in the root to work<br />
      <br />
      !define MUI_ABORTWARNING<br />
      <br />
      ;--------------------------------<br />
      ;Pages<br />
      <br />
      !insertmacro MUI_PAGE_LICENSE "LA.txt"<br />
      !insertmacro MUI_PAGE_COMPONENTS<br />
      !insertmacro MUI_PAGE_INSTFILES<br />
      <br />
      ;--------------------------------<br />
      ;Languages<br />
      <br />
      !insertmacro MUI_LANGUAGE "English"<br />
      <br />
      ;--------------------------------<br />
      ;Installer Sections<br />
      <br />
      Section "NAME"<br />
      SetOutPath "C:\"<br />
      File "MYFILE.ZIP"<br />
      SectionEnd</font><br />
      <br />
      What do I need to add to the section to get it to extract the zip contents instead of just copying it? (Also, I've tried using the exe made from my zip to see if it would actually run, but that file just gets copied too.)<br />
      <br />
      A noob greatly appreciates your help. THANKS!</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">isawen</span><br />
      <span class="post-time small text-muted">15th April 2010 22:27 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">You could use Exec "$INSTDIR\MYFILE.EXE" command to run your exe file after the<br />
      "File MYFILE.EXE" line.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">redxii</span><br />
      <span class="post-time small text-muted">16th April 2010 00:53 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">You need an extra plug-in, here is one of many: <a href="http://nsis.sourceforge.net/Nsisunz_plug-in" target="_blank">http://nsis.sourceforge.net/Nsisunz_plug-in</a><br />
      <br />
      Add MYFILE.ZIP to a temp directory. $PLUGINSDIR is the temp directory used by the installer and automatically cleans itself up after the install is finished.<br />
      Goes something like this:<br /></p>
      <pre>
<code>Section</code><span style="color: #DD0000">"NAME"
<br /><br /></span><span style="color: #0000BB">SetOutPath</span><span style="color: #DD0000">"$PLUGINSDIR"
<br /></span><span style="color: #0000BB">File</span><span style="color: #DD0000">"MYFILE.ZIP"
<br /><br /></span><span style="color: #0000BB">nsisunz</span><span style="color: #007700">::</span><span style="color: #0000BB">UnzipToStack</span><span style="color: #DD0000">"$PLUGINSDIR\MYFILE.ZIP""$INSTDIR"
<br /></span><span style="color: #0000BB">Pop$R0
<br />StrCmp$R0</span><span style="color: #DD0000">"success"</span><span style="color: #007700">+</span><span style="color: #0000BB">2
<br />DetailPrint</span><span style="color: #DD0000">"$R0"</span><span style="color: #007700">;print</span><span style="color: #0000BB">errormessagetolog
<br /><br />SectionEnd
<br /></span>

<!-- php buffer end -->
                
                
                
</pre>
      <hr />
      <pre>
        
Add this line at the top so you can put the plug-in file in the same folder as your script:<br />
        PHP Code:
        
                
</pre>
      <hr />
      <pre>
                <code style="white-space:nowrap">
                
                        <!-- php buffer start --></code><span style="color: #000000">
<span style="color: #007700">!</span><span style="color: #0000BB">addplugindir</span><span style="color: #007700">.
</span></span>
</pre>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">MSG</span><br />
      <span class="post-time small text-muted">16th April 2010 08:51 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Here's a better idea: Don't distribute a zip, but the actual files themselves.<br />
      <br />
      SetOutPath $INSTDIR<br />
      File /r "C:\YourProjectFolder\ProjectFiles\*.*"<br />
      <br />
      <br />
      You can find this information in the manual. Please read it:<br />
      <a href="http://nsis.sourceforge.net/Docs/Chapter4.html#4.9.1" target="_blank">http://nsis.sourceforge.net/Docs/Chapter4.html#4.9.1</a></p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Animaether</span><br />
      <span class="post-time small text-muted">16th April 2010 12:29 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">As for your book image - if you want this separate from the license text but in the main dialog, you'll have to create your own custom license page. Otherwise, perhaps you could use it as a header image while using the ModernUI?<br />
      <br />
      Edit: Or the ExperienceUI which looks like it has a nice big space on the left you might be able to stick a bitmap in.. <a href="http://nsis.sourceforge.net/ExperienceUI" target="_blank">http://nsis.sourceforge.net/ExperienceUI</a> ..the example image just happens to be of the License page.<br />
      <br />
      ( apparently images included in a license RTF (Rich Text File) don't get displayed, or that might have been an option as well )</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kwhite9266</span><br />
      <span class="post-time small text-muted">16th April 2010 15:37 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"></p>

      <blockquote>
        <small>Originally posted by MSG</small><br />
        Here's a better idea: Don't distribute a zip, but the actual files themselves.<br />
        <br />
        SetOutPath $INSTDIR<br />
        File /r "C:\YourProjectFolder\ProjectFiles\*.*"<br />
        <br />
        <br />
        You can find this information in the manual. Please read it:<br />
        <a href="http://nsis.sourceforge.net/Docs/Chapter4.html#4.9.1" target="_blank">http://nsis.sourceforge.net/Docs/Chapter4.html#4.9.1</a>
      </blockquote>Thank you, this actually is the most straightforward solution for what I need to do. (I actually stared at that particular page all afternoon yesterday-- I knew the answer was in there but I just wasn't making sense of it.)<br />
      <br />
      This program is a lifesaver (as are the forums-- thanks to everybody for your extremely fast suggestions!)<br />
      <br />
      Now I'll spend the rest of my time making the UI of the installer presentable. I've been reading a bit on custom pages but hopefully I can take it from here.<br />
      <br />
      Cheers!
    </div>
    <hr />

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]>
  </script>
</body>
</html>
