<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="description" content="ExecWait not working (Vista?)"><title>ExecWait not working (Vista?) - NSIS Forums</title><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script><link rel="preload" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css" as="style" onload="this.rel='stylesheet'"><link rel="preload" href="../css/style.css" as="style" onload="this.rel='stylesheet'"><noscript><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css"><link rel="stylesheet" href="../css/style.css"></noscript><script>!function(a){"use strict";var b=function(b,c,d){function e(a){return h.body?a():void setTimeout(function(){e(a)})}function f(){i.addEventListener&&i.removeEventListener("load",f),i.media=d||"all"}var g,h=a.document,i=h.createElement("link");if(c)g=c;else{var j=(h.body||h.getElementsByTagName("head")[0]).childNodes;g=j[j.length-1]}var k=h.styleSheets;i.rel="stylesheet",i.href=b,i.media="only x",e(function(){g.parentNode.insertBefore(i,c?g:g.nextSibling)});var l=function(a){for(var b=i.href,c=k.length;c--;)if(k[c].href===b)return a();setTimeout(function(){l(a)})};return i.addEventListener&&i.addEventListener("load",f),i.onloadcssdefined=l,l(f),i};"undefined"!=typeof exports?exports.loadCSS=b:a.loadCSS=b}("undefined"!=typeof global?global:this);!function(a){if(a.loadCSS){var b=loadCSS.relpreload={};if(b.support=function(){try{return a.document.createElement("link").relList.supports("preload")}catch(b){return!1}},b.poly=function(){for(var b=a.document.getElementsByTagName("link"),c=0;c<b.length;c++){var d=b[c];"preload"===d.rel&&"style"===d.getAttribute("as")&&(a.loadCSS(d.href,d,d.getAttribute("media")),d.rel=null)}},!b.support()){b.poly();var c=a.setInterval(b.poly,300);a.addEventListener&&a.addEventListener("load",function(){b.poly(),a.clearInterval(c)}),a.attachEvent&&a.attachEvent("onload",function(){a.clearInterval(c)})}}}(this);</script></head><body><div class="container"><ol class="breadcrumb"><li><a href="../index.html" class="glyphicon glyphicon-home"></a></li><li><a href="f-65.html">NSIS Discussion</a></li><li class="active">ExecWait not working (Vista?)</li></ol><p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=260419">ExecWait not working (Vista?)</a></p><br><div class="post"><p class="post-meta"><span class="post-author text-primary">jaredsullivan</span><br><span class="post-time small text-muted">26th November 2006 04:13 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>ExecWait not working (Vista?)</strong><br>Hi,<br><br>I am trying to silently install a component from MySQL.com but it is not currently working or possibly even executing.<br><br>NSIS code..<br><br>SetOutPath "$TEMP"<br>File "F:\soft.deploy\mysql-connector-odbc-3.51.12-win32.msi"<br>ExecWait "$TEMP\mysql-connector-odbc-3.51.12-win32.msi /q"<br><br>I actually have a few things that are note being executed. Only thing I can think of, is NSIS is not compatibly with Vista.<br><br>Thanks In Advance.<br>Jared<br><br>ATTACHED: broken script</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">jaredsullivan</span><br><span class="post-time small text-muted">26th November 2006 04:18 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>ATTACH: The full script</strong><br>!define PRODUCT_NAME "Test Script"<br>!define PRODUCT_VERSION "1.2.9"<br>!define PRODUCT_PUBLISHER "xxxxx"<br>!define PRODUCT_WEB_SITE "http://www.xxxxxxxxxx.net.au"<br>!define PRODUCT_DIR_REGKEY "Software\Microsoft\Windows\CurrentVersion\App Paths\xxxxx.exe"<br>!define PRODUCT_UNINST_KEY "Software\Microsoft\Windows\CurrentVersion\Uninstall\${PRODUCT_NAME}"<br>!define PRODUCT_UNINST_ROOT_KEY "HKLM"<br><br>!include "MUI.nsh"<br><br>!define MUI_ABORTWARNING<br>!define MUI_ICON "${NSISDIR}\Contrib\Graphics\Icons\modern-install.ico"<br>!define MUI_UNICON "${NSISDIR}\Contrib\Graphics\Icons\modern-uninstall.ico"<br><br>!insertmacro MUI_PAGE_WELCOME<br>!insertmacro MUI_PAGE_COMPONENTS<br>!insertmacro MUI_PAGE_INSTFILES<br>!insertmacro MUI_PAGE_FINISH<br>!insertmacro MUI_UNPAGE_INSTFILES<br>!insertmacro MUI_LANGUAGE "English"<br><br>; MUI end ------<br><br>Name "${PRODUCT_NAME} ${PRODUCT_VERSION}"<br>OutFile "Setup.exe"<br>InstallDir "$PROGRAMFILES\Test Script"<br>InstallDirRegKey HKLM "${PRODUCT_DIR_REGKEY}" ""<br>ShowInstDetails show<br>ShowUnInstDetails show<br><br><br>;SetCompress off<br>;CRCCheck on<br><br><br>Section "MySQL ODBC Connector" SEC01<br><br>SetOutPath "$TEMP"<br>File "F:\soft.deploy\mysql-connector-odbc-3.51.12-win32.msi"<br>ExecWait "$TEMP\mysql-connector-odbc-3.51.12-win32.msi /q"<br>;Delete "$TEMP\mysql-connector-odbc-3.51.12-win32.msi"<br><br>SectionEnd<br><br>Section -AdditionalIcons<br>CreateShortCut "$SMPROGRAMS\Resort\Uninstall.lnk" "$INSTDIR\uninst.exe"<br>SectionEnd<br><br>Section -Post<br>WriteUninstaller "$INSTDIR\uninst.exe"<br>WriteRegStr HKLM "${PRODUCT_DIR_REGKEY}" "" "$INSTDIR\xxxxx.exe"<br>WriteRegStr ${PRODUCT_UNINST_ROOT_KEY} "${PRODUCT_UNINST_KEY}" "DisplayName" "$(^Name)"<br>WriteRegStr ${PRODUCT_UNINST_ROOT_KEY} "${PRODUCT_UNINST_KEY}" "UninstallString" "$INSTDIR\uninst.exe"<br>WriteRegStr ${PRODUCT_UNINST_ROOT_KEY} "${PRODUCT_UNINST_KEY}" "DisplayIcon" "$INSTDIR\xxxxx.exe"<br>WriteRegStr ${PRODUCT_UNINST_ROOT_KEY} "${PRODUCT_UNINST_KEY}" "DisplayVersion" "${PRODUCT_VERSION}"<br>WriteRegStr ${PRODUCT_UNINST_ROOT_KEY} "${PRODUCT_UNINST_KEY}" "URLInfoAbout" "${PRODUCT_WEB_SITE}"<br>WriteRegStr ${PRODUCT_UNINST_ROOT_KEY} "${PRODUCT_UNINST_KEY}" "Publisher" "${PRODUCT_PUBLISHER}"<br>SectionEnd<br><br><br>Function un.onUninstSuccess<br>HideWindow<br>MessageBox MB_ICONINFORMATION|MB_OK "$(^Name) was successfully removed from your computer."<br>FunctionEnd<br><br>Function un.onInit<br>MessageBox MB_ICONQUESTION|MB_YESNO|MB_DEFBUTTON2 "Are you sure you want to completely remove $(^Name) and all of its components?" IDYES +2<br>Abort<br>FunctionEnd<br><br>Section Uninstall<br><br>DeleteRegKey ${PRODUCT_UNINST_ROOT_KEY} "${PRODUCT_UNINST_KEY}"<br>DeleteRegKey HKLM "${PRODUCT_DIR_REGKEY}"<br>SetAutoClose true<br>SectionEnd</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">kichik</span><br><span class="post-time small text-muted">26th November 2006 06:15 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">MSI files are not executables. You must use ExecShell or execute an executable that'd open the MSI file, like msiexec.exe.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">onad</span><br><span class="post-time small text-muted">29th November 2006 11:35 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Below some helpfull MSI info. I still have this in my script to add the same parameters to my NSIS installer as MSI supports.<br><br>Note that in 99% it is not NSIS that is the problem but the user written installer script. NSIS is used intensive by more people you can ever imagine. And sure they are interested in 100% Windows Vista compatibility of NSIS.<br><br>------------------------------<br>; TODO for MSI to NSIS compatibility:<br><br>;Parameter Description<br>;/i &lt;package&gt; or &lt;product code&gt; Use this format to install the product Othello:<br><br>;msiexec /i "C:\&lt;WindowsFolder&gt;\Profiles\&lt;UserName&gt;\Personal\MySetups\Othello\Trial Version\Release\DiskImages\Disk1\Othello Beta.msi"<br><br>;Product Code refers to the GUID that is automatically generated in the Product Code property of your product's project view.<br>;/f [p|o|e|d|c|a|u|m|s|v] &lt;package&gt; or &lt;product code&gt; Installing with the /f option will repair or reinstall missing or corrupted files.<br><br>;For example, to force a reinstall of all files, use the following syntax:<br><br>;msiexec /fa "C:\&lt;WindowsFolder&gt;\Profiles\&lt;UserName&gt;\Personal\MySetups\Othello\Trial Version\Release\DiskImages\Disk1\Othello Beta.msi"<br><br>;in conjunction with the following flags:<br>;p reinstalls a file if it is missing<br>;o reinstalls a file if it is missing or if an older version of the file is present on the user's system<br>;e reinstalls a file if it is missing or if an equivalent or older version of the file is present on the user's system<br>;c reinstalls a file if it is missing or if the stored checksum of the installed file does not match the new file's value<br>;a forces a reinstall of all files<br>;u or m rewrite all required user registry entries<br>;s overwrites any existing shortcuts<br>;v runs your application from the source and re-caches the local installation package<br><br>;/a &lt;package&gt; The /a option allows users with administrator privileges to install a product onto the network.<br>;/x &lt;package&gt; or &lt;product code&gt; The /x option uninstalls a product.<br>;/j [u|m] &lt;package&gt;<br>;/j [u|m] &lt;package&gt; /t &lt;transform list&gt;<br>;/j [u|m] &lt;package&gt; /g<br>;/j &lt;language ID&gt; Building with the /j &lt;package&gt; option advertises the components of your application on the end user's computer<br>;u advertises components only to the current user<br>;m advertises components to all users of the computer<br>;g specifies language ID<br>;t applies a transform to your advertised product<br>;Transforms allow the synchronization of applications across different languages. For example, if you upgrade the English version of your product, you could apply a transform to automatically upgrade the French version of your product.<br>;/L [i|w|e|a|r|u|c|m|p|v|+] &lt;log file&gt; Building with the /L option specifies the path to the log fileâ€”these flags indicate which information to record in the log file:<br>;i logs status messages<br>;w logs non-fatal warning messages<br>;e logs any error messages<br>;a logs the commencement of action sequences<br>;r logs action-specific records<br>;u logs user requests<br>;c logs initial user interface parameters<br>;m logs out-of-memory messages<br>;p logs terminal settings<br>;v logs the verbose output setting<br>;+ appends to an existing file<br>;* is a wildcard character that allows you to log all information (excluding the verbose output setting)<br><br>;/p &lt;patch package&gt; Building with the /p option applies a patch to an installed setup package. To patch an installed administrative image, combine this option with /a as shown:<br><br>;/p &lt;patch package&gt; /a &lt;package&gt;<br>;/q [n|b|r|f] The /q option is used to set the user interface level in conjunction with the following flags:<br>;q or qn creates no user interface<br>;qb creates a basic user interface<br>;The user interface settings below display a modal dialog box at the end of installation:<br>;qr displays a reduced user interface<br>;qf displays a full user interface<br>;qn+ displays no user interface<br>;qb+ displays a basic user interface<br><br>;/? or /h Either command displays Windows Installer copyright information<br>;/y &lt;filename&gt; This command calls the DllRegisterServer entry-point function of the DLL or OCX file specified in &lt;filename&gt;.<br>;/z &lt;filename&gt; This command calls the DllUnregisterServer entry-point function of the DLL or OCX file specified in &lt;filename&gt;.<br>;TRANSFORMS Use the TRANSFORMS command line parameter to specify any transforms that you would like applied to your base package. Your transform command line call might look something like this:<br><br>;msiexec /i "C:\&lt;WindowsFolder&gt;\Profiles\&lt;UserName&gt;\Personal\MySetups\Your Project Name\Trial Version\My Release-1\DiskImages\Disk1\ProductName.msi" TRANSFORMS="New Transform 1.mst"<br><br>;You can separate multiple transforms with a semicolon. Because of this, it is recommended that you do not use semicolons in the name of your transform, as the Windows Installer service will interpret those incorrectly.<br>;Properties All public properties can be set or modified from the command line. Public properties are distinguished from private properties by the fact that they are in all capital letters. For example, COMPANYNAME is a public property.<br><br>;To set a property from the command line, use the following syntax: PROPERTY=VALUE. If you wanted to change the value of COMPANYNAME, you would enter:<br><br>;msiexec /i "C:\&lt;WindowsFolder&gt;\Profiles\&lt;UserName&gt;\Personal\MySetups\Your Project Name\Trial Version\My Release-1\DiskImages\Disk1\ProductName.msi" COMPANYNAME="SuperNSIS"<br><br>;********************************************************************************************************************************************</p></div><hr><div class="footer"><p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p></div></div><script type="text/javascript" src="../js/highlight.pack.js" async></script><script type="text/javascript">//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]></script></body></html>