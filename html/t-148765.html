<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="RMDir not RM'ing as anticipated" />

  <title>RMDir not RM'ing as anticipated - NSIS Forums</title>
  <script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script>
  <!-- Bootstrap core CSS -->

  <link rel="stylesheet" type="text/css" href="//netdna.bootstrapcdn.com/bootswatch/3.0.1/readable/bootstrap.min.css" />
  <link rel="stylesheet" href="../css/style.css" type="text/css" /><!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!--[if lt IE 9]>
                <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
                <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->
</head>

<body>
  <div class="container">
    <!-- Put navigation bar here -->

    <ol class="breadcrumb">
      <li><a href="../index.html" class="glyphicon glyphicon-home"></a></li>

      <li><a href="f-65.html">NSIS Discussion</a></li>

      <li class="active">RMDir not RM'ing as anticipated</li>
    </ol>

    <p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=148765">RMDir not RM'ing as anticipated</a></p><br />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">tardo0807</span><br />
      <span class="post-time small text-muted">10th September 2003 17:32 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>RMDir not RM'ing as anticipated</strong><br />
      Hello folks,<br />
      <br />
      I've included a code snippet from my uninstall section in the hopes that one of you might quickly see what I am doing wrong.<br />
      <br />
      Basically, my install directory should be gone after Uninstall. However, two .gif files and one .exe remain after using the uninstall.<br />
      <br />
      This situation persists even when I attempt to delete each item one by one, with these(*) three files remaining, but the other two do get deleted.<br />
      <br />
      Am I missing anything?<br />
      <br />
      Section Uninstall<br />
      ...code...<br />
      ...<br />
      ...code...<br />
      ...<br />
      <br />
      ;tried it this way too...no luck<br />
      ;Delete "$INSTDIR\############40.exe"<br />
      * ;Delete "$INSTDIR\######.exe"<br />
      ;Delete "$INSTDIR\Uninst.exe"<br />
      * ;Delete "$INSTDIR\logoAnim.gif"<br />
      * ;Delete "$INSTDIR\logoStill.gif "<br />
      <br />
      RMDir /r "$INSTDIR"<br />
      <br />
      SectionEnd<br />
      <br />
      Thanks<br />
      JP</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">tardo0807</span><br />
      <span class="post-time small text-muted">10th September 2003 18:01 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">oh yes, I also tried:<br />
      <br />
      Delete "$INSTDIR"<br />
      <br />
      with no luck, and the correct syntax for RmDir again with the same problem of remaining files.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Joost Verburg</span><br />
      <span class="post-time small text-muted">10th September 2003 18:16 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Are you sure the files are not in use? Can you delete them manually?</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">tardo0807</span><br />
      <span class="post-time small text-muted">10th September 2003 18:28 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">This problem occurs even if I have just installed the application ( meaning it hasn't been run yet ) so I am very confident that the files are not being used by any programs. I was able to delete them manually. I'm still looking through old posts to try and find the reason, but I appreciate any help I can get.<br />
      Thanks<br />
      JP</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Joost Verburg</span><br />
      <span class="post-time small text-muted">10th September 2003 18:45 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">And you are not opening them for something else in the uninstaller? The only thing I can think of is files being in use or invalid rights.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">tardo0807</span><br />
      <span class="post-time small text-muted">10th September 2003 18:53 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">here is the entire uninstall code:<br />
      (sorry about the stupid hash marks...my boss would be worried if i sent out product names...so I'm using them to avoid any issues)<br />
      <br />
      Push "TEMP"<br />
      Call un.DeleteEnvStr<br />
      <br />
      DeleteRegKey HKEY_LOCAL_MACHINE "SOFTWARE\#######"<br />
      DeleteRegKey HKEY_LOCAL_MACHINE "SOFTWARE\Microsoft\Windows\CurrentVersion\Uninstall\######"<br />
      DeleteRegKey HKLM "Software\########"<br />
      DeleteRegKey HKLM "Software\LeCor\###"<br />
      <br />
      WriteRegStr HKLM "Software\########" "name" "removed"<br />
      WriteRegStr HKLM "Software\Cor######" "value" "removed"<br />
      WriteRegStr HKLM "Software\######Corp" "version" "uit"<br />
      WriteRegStr HKLM "Software\LeCor\####" "version" "1.0"<br />
      <br />
      <br />
      Delete "$INSTDIR\#########40.exe"<br />
      Delete "$INSTDIR\######.exe"<br />
      Delete "$INSTDIR\Uninst.exe"<br />
      Delete "$INSTDIR\logoAnim.gif"<br />
      Delete "$INSTDIR\logoStill.gif "<br />
      <br />
      Delete "$INSTDIR"</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Joost Verburg</span><br />
      <span class="post-time small text-muted">10th September 2003 20:39 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Can you really remove the files manually while the uninstaller is running? RMDir just calls a normal Windows API, like explorer does.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">tardo0807</span><br />
      <span class="post-time small text-muted">12th September 2003 16:46 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Sorry for the delay in getting back to you, I was at school all day yesterday. I just ran the installer again. When I uninstalled, I was able to delete the files in question while the uninstall splash screen was still active, so I'm assuming that it indeed allowed me to delete while in the midst of uninstalling.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
      <span class="post-time small text-muted">12th September 2003 18:54 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Just to make sure, can you download <a href="http://www.sysinternals.com/ntw2k/freeware/handle.shtml" target="_blank">Handle</a>, add a message box before the first Delete instruction, run Handle when the message box shows up and make sure non of the files are listed?</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">lzandman</span><br />
      <span class="post-time small text-muted">13th September 2003 09:16 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Wild guess... Maybe the files are virus-infected and your anti-virus software is blocking access to them? I've had this once, although that situation didn't involve NSIS.</p>
    </div>
    <hr />

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]>
  </script>
</body>
</html>
