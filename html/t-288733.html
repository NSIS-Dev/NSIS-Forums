<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="description" content="Add/Remove not initialising uninstaller?"><title>Add/Remove not initialising uninstaller? - NSIS Forums</title><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script><link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css"><link rel="stylesheet" href="../css/style.css" type="text/css"></head><body><div class="container"><ol class="breadcrumb"><li><a href="../index.html" class="glyphicon glyphicon-home"></a></li><li><a href="f-65.html">NSIS Discussion</a></li><li class="active">Add/Remove not initialising uninstaller?</li></ol><p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=288733">Add/Remove not initialising uninstaller?</a></p><br><div class="post"><p class="post-meta"><span class="post-author text-primary">hungryOrb</span><br><span class="post-time small text-muted">19th March 2008 18:52 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>Add/Remove not initialising uninstaller?</strong><br>Ehm.. I thought that using add/remove would initialise the uninstaller, but it didnt, instead it simply removed the program entry there. Is there a link I can perhaps read, or might someone know why this happens?<br><br>Thanks if any help ;]</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br><span class="post-time small text-muted">19th March 2008 19:10 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Sounds like your uninstaller path is set wrong in the registry.<br><br>Stu</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">hungryOrb</span><br><span class="post-time small text-muted">20th March 2008 11:15 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Thanks for reply :]<br><br>This is what I have:<br><br></p><pre>
<code>!define PRODUCT_DIR_REGKEY "Software\Microsoft\Windows\CurrentVersion\App Paths\DracoSSC.exe"<br>!define PRODUCT_UNINST_KEY "Software\Microsoft\Windows\CurrentVersion\Uninstall\${PRODUCT_NAME}"<br>!define PRODUCT_UNINST_ROOT_KEY "HKLM"<br>!define PRODUCT_STARTMENU_REGVAL "NSIS:StartMenuDir"</code>
</pre><br>
      <br>
      and:<br>
      <br>
      <pre>
<code>Section -Post<br>  WriteUninstaller "$INSTDIR\uninst.exe"<br>  WriteRegStr HKLM "${PRODUCT_DIR_REGKEY}" "" "$INSTDIR\DracoSSC.exe"<br>  WriteRegStr ${PRODUCT_UNINST_ROOT_KEY} "${PRODUCT_UNINST_KEY}" "DisplayName" "$(^Name)"<br>  WriteRegStr ${PRODUCT_UNINST_ROOT_KEY} "${PRODUCT_UNINST_KEY}" "UninstallString" "$INSTDIR\uninst.exe"<br>  WriteRegStr ${PRODUCT_UNINST_ROOT_KEY} "${PRODUCT_UNINST_KEY}" "DisplayIcon" "$INSTDIR\DracoSSC.exe"<br>  WriteRegStr ${PRODUCT_UNINST_ROOT_KEY} "${PRODUCT_UNINST_KEY}" "DisplayVersion" "${PRODUCT_VERSION}"<br>  WriteRegStr ${PRODUCT_UNINST_ROOT_KEY} "${PRODUCT_UNINST_KEY}" "URLInfoAbout" "${PRODUCT_WEB_SITE}"<br>  WriteRegStr ${PRODUCT_UNINST_ROOT_KEY} "${PRODUCT_UNINST_KEY}" "Publisher" "${PRODUCT_PUBLISHER}"<br>SectionEnd</code>
</pre><br>
      <br>
      Please could you perhaps offer how this could be wrong?
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Red Wine</span><br>
      <span class="post-time small text-muted">20th March 2008 11:27 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">What about the uninstall section?</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">hungryOrb</span><br>
      <span class="post-time small text-muted">20th March 2008 11:39 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">After that last section, only this remains:<br>
      <br></p>
      <pre>
<code>Function un.onUninstSuccess<br>  HideWindow<br>  MessageBox MB_ICONINFORMATION|MB_OK "$(^Name) was successfully removed from your computer."<br>FunctionEnd<br><br>Function un.onInit<br>  MessageBox MB_ICONQUESTION|MB_YESNO|MB_DEFBUTTON2 "Are you sure you want to completely remove $(^Name) and all of its components?" IDYES +2<br>  Abort<br>FunctionEnd<br><br>Section Uninstall<br>  !insertmacro MUI_STARTMENU_GETFOLDER "Application" $ICONS_GROUP<br>  Delete "$INSTDIR\${PRODUCT_NAME}.url"<br>  Delete "$INSTDIR\uninst.exe"<br>  Delete "$WINDIR\System\TestFolder1\stdole2.tlb"<br>  Delete "$WINDIR\System\TestFolder1\olepro32.dll"<br>  Delete "$WINDIR\System\TestFolder1\oleaut32.dll"<br>  Delete "$WINDIR\System\TestFolder1\msvbvm60.dll"<br>  Delete "$WINDIR\System\TestFolder1\COMCAT.DLL"<br>  Delete "$WINDIR\System\TestFolder1\asycfilt.dll"<br>  Delete "$WINDIR\System\TestFolder1\scrrun.dll"<br>  Delete "$WINDIR\System\TestFolder1\richtx32.ocx"<br>  Delete "$WINDIR\System\TestFolder1\msvcr71.dll"<br>  Delete "$WINDIR\System\TestFolder1\MSMASK32.OCX"<br>  Delete "$WINDIR\System\TestFolder1\MSMAPI32.OCX"<br>  Delete "$WINDIR\System\TestFolder1\MSINET.OCX"<br>  Delete "$WINDIR\System\TestFolder1\MSHFLXGD.OCX"<br>  Delete "$WINDIR\System\TestFolder1\MSFLXGRD.OCX"<br>  Delete "$WINDIR\System\TestFolder1\MSCOMCTL.OCX"<br>  Delete "$WINDIR\System\TestFolder1\MSCOMCT2.OCX"<br>  Delete "$WINDIR\System\TestFolder1\msado25.tlb"<br>  Delete "$WINDIR\System\TestFolder1\hhctrl.ocx"<br>  Delete "$WINDIR\System\TestFolder1\FM20.DLL"<br>  Delete "$WINDIR\System\TestFolder1\COMDLG32.OCX"<br>  Delete "$WINDIR\System\TestFolder1\COMCT332.OCX"<br>  Delete "$WINDIR\System\TestFolder1\myodbc3S.lib"<br>  Delete "$WINDIR\System\TestFolder1\myodbc3S.dll"<br>  Delete "$WINDIR\System\TestFolder1\myodbc3m.exe"<br>  Delete "$WINDIR\System\TestFolder1\myodbc3i.exe"<br>  Delete "$WINDIR\System\TestFolder1\myodbc3c.exe"<br>  Delete "$WINDIR\System\TestFolder1\myodbc3.lib"<br>  Delete "$WINDIR\System\TestFolder1\myodbc3.hlp"<br>  Delete "$WINDIR\System\TestFolder1\myodbc3.gid"<br>  Delete "$WINDIR\System\TestFolder1\myodbc3.fts"<br>  Delete "$WINDIR\System\TestFolder1\myodbc3.dll"<br>  Delete "$INSTDIR\zip32.dll"<br>  Delete "$INSTDIR\WinSubHook.tlb"<br>  Delete "$INSTDIR\User Modules\_dmd syntax.txt"<br>  Delete "$INSTDIR\Updates.txt"<br>  Delete "$INSTDIR\UpdateInProgress.exe"<br>  Delete "$INSTDIR\unzip32.dll"<br>  Delete "$INSTDIR\SSubTmr6.dll"<br>  Delete "$INSTDIR\MSDERUN.DLL"<br>  Delete "$INSTDIR\Modules\Verifier\verifier.cmd"<br>  Delete "$INSTDIR\Modules\TestJet.dmd"<br>  Delete "$INSTDIR\Modules\TestJet\TestJet.exe"<br>  Delete "$INSTDIR\Modules\DracoSSC.DDF"<br>  Delete "$INSTDIR\Modules\CommandPrompt.dmd"<br>  Delete "$INSTDIR\Modules\CommandPrompt\CommandPrompt.exe"<br>  Delete "$INSTDIR\LanguageSelector.exe"<br>  Delete "$INSTDIR\LanguageEditor.exe"<br>  Delete "$INSTDIR\langs.dat"<br>  Delete "$INSTDIR\KDateBox.ocx"<br>  Delete "$INSTDIR\Images\WelcomeBitMap.bmp"<br>  Delete "$INSTDIR\Images\update.avi"<br>  Delete "$INSTDIR\Images\Thumbs.db"<br>  Delete "$INSTDIR\Images\splash.jpg"<br>  Delete "$INSTDIR\Images\pocn.jpg"<br>  Delete "$INSTDIR\Images\po.jpg"<br>  Delete "$INSTDIR\Images\logonbg.jpg"<br>  Delete "$INSTDIR\Images\lockbg.jpg"<br>  Delete "$INSTDIR\Images\Floorplan.jpg"<br>  Delete "$INSTDIR\Images\dragon.jpg"<br>  Delete "$INSTDIR\Images\confail.jpg"<br>  Delete "$INSTDIR\Icons\Thumbs.db"<br>  Delete "$INSTDIR\Icons\SupplierX.ico"<br>  Delete "$INSTDIR\Icons\SupplierO.ico"<br>  Delete "$INSTDIR\Icons\Supplier.ico"<br>  Delete "$INSTDIR\Icons\StockX.ico"<br>  Delete "$INSTDIR\Icons\StockO.ico"<br>  Delete "$INSTDIR\Icons\Stock.ico"<br>  Delete "$INSTDIR\Icons\QuoteX.ico"<br>  Delete "$INSTDIR\Icons\QuoteO.ico"<br>  Delete "$INSTDIR\Icons\Quote.ico"<br>  Delete "$INSTDIR\Icons\OrderX.ico"<br>  Delete "$INSTDIR\Icons\OrderO.ico"<br>  Delete "$INSTDIR\Icons\Order.ico"<br>  Delete "$INSTDIR\Icons\JobX.ico"<br>  Delete "$INSTDIR\Icons\JobO.ico"<br>  Delete "$INSTDIR\Icons\Job.ico"<br>  Delete "$INSTDIR\Icons\Dragon.ico"<br>  Delete "$INSTDIR\Icons\CustomerX.ico"<br>  Delete "$INSTDIR\Icons\CustomerO.ico"<br>  Delete "$INSTDIR\Icons\Customer.ico"<br>  Delete "$INSTDIR\ezVidC60.ocx"<br>  Delete "$INSTDIR\DracoUpdate.exe"<br>  Delete "$INSTDIR\DracoSSC.exe"<br>  Delete "$INSTDIR\dracok.dll"<br>  Delete "$INSTDIR\Dracohelp.chm"<br>  Delete "$INSTDIR\DAO350.DLL"<br><br>  Delete "$SMPROGRAMS\$ICONS_GROUP\Website.lnk"<br>  Delete "$SMPROGRAMS\$ICONS_GROUP\Help.lnk"<br>  Delete "$DESKTOP\Draco SSC.lnk"<br>  Delete "$SMPROGRAMS\$ICONS_GROUP\Draco SSC.lnk"<br><br>  RMDir "$WINDIR\System\TestFolder1"<br>  RMDir "$SMPROGRAMS\$ICONS_GROUP"<br>  RMDir "$INSTDIR\User Modules"<br>  RMDir "$INSTDIR\Modules\Verifier"<br>  RMDir "$INSTDIR\Modules\TestJet"<br>  RMDir "$INSTDIR\Modules\CommandPrompt"<br>  RMDir "$INSTDIR\Modules"<br>  RMDir "$INSTDIR\Images"<br>  RMDir "$INSTDIR\Icons"<br>  RMDir "$INSTDIR"<br><br>  DeleteRegKey ${PRODUCT_UNINST_ROOT_KEY} "${PRODUCT_UNINST_KEY}"<br>  DeleteRegKey HKLM "${PRODUCT_DIR_REGKEY}"<br>  <br>  ;Delete the user details in registry<br>  DeleteRegValue HKCU "Software\VB and VBA Program Settings\${PRODUCT_NAME}\Main" "MySQLUser"<br>  DeleteRegValue HKCU "Software\VB and VBA Program Settings\${PRODUCT_NAME}\Main" "MySQLPass"<br>  DeleteRegValue HKCU "Software\VB and VBA Program Settings\${PRODUCT_NAME}\Main" "MySQLADDR"<br>  DeleteRegValue HKCU "Software\VB and VBA Program Settings\${PRODUCT_NAME}\Main" "AutoUpdatePath"<br>  DeleteRegValue HKCU "Software\VB and VBA Program Settings\${PRODUCT_NAME}\Main" "AutoUpdateEnable"<br><br>  SetAutoClose true<br>SectionEnd</code>
</pre><br>
      <br>
      Thanks for reply :)
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Red Wine</span><br>
      <span class="post-time small text-muted">20th March 2008 12:00 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">It seems you've made your installer with HM editor so normally there should be not something wrong.<br>
      According to that code, you should see/react in those 2 messages boxes and what's installed should being uninstalled.<br>
      Have you tried to run the uninstaller from StartMenu shortcut or directly from $INSTDIR ?<br>
      Is it possible to exists an invalid character in $INSTDIR ?</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">hungryOrb</span><br>
      <span class="post-time small text-muted">20th March 2008 12:38 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Yes, is what I was thinking about the HM editor.<br>
      <br>
      Running the actual uninst file is fine, and seems to work perfectly. I guess the registry just doesn't know where to look for the right file?</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Red Wine</span><br>
      <span class="post-time small text-muted">20th March 2008 12:45 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Open regedit and check out your records. I tend to assume that there's an invalid character.</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">hungryOrb</span><br>
      <span class="post-time small text-muted">20th March 2008 13:11 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Thanks for replies again,.<br>
      There doesn't seem to be any path's to be found in the registry, in the main folder that is. None that point to an uninstaller anyways. At which point does NSIS usually inform the registry about a path to an uninst.exe file?<br>
      It's not in the script directly right?<br>
      <br>
      Just wondering also, is there a way to use exec with a registry file? can I just somehow use a statement like this:<br>
      <br>
      'Execwait "draco.reg" $0'<br>
      ?<br>
      <br>
      Thanks for any helps ;D</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Red Wine</span><br>
      <span class="post-time small text-muted">20th March 2008 13:36 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Regarding to your script, you should find your records by opening regedit under HKLM Software\Microsoft\Windows\CurrentVersion\Uninstall\${PRODUCT_NAME}<br>
      <br>
      Yes you can execute a reg file see here,<br>
      <br>
      <a href="http://forums.winamp.com/showthread.php?s=&amp;threadid=249764" target="_blank">http://forums.winamp.com/showthread....hreadid=249764</a><br>
      <br>
      <a href="http://forums.winamp.com/showthread.php?s=&amp;threadid=281839" target="_blank">http://forums.winamp.com/showthread....hreadid=281839</a></p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">hungryOrb</span><br>
      <span class="post-time small text-muted">20th March 2008 15:03 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Thankyou! :D The uninstall string is reading the correct path! So I'll just do some tests.</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">hungryOrb</span><br>
      <span class="post-time small text-muted">20th March 2008 15:42 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Hmm.. yeah it seems to work perfectly now ._.<br>
      <br>
      Ehm, would you guys happen to know the auto-updating is continually checked? The app should check registry value, and the registry value is always '1'.<br>
      <br></p>
      <pre>
<code>Function CustomPage<br><br>   !insertmacro MUI_HEADER_TEXT "$(CUSTOM_TITLE)" "$(CUSTOM_SUBTITLE)"<br>   # Display the page.<br>   !insertmacro MUI_INSTALLOPTIONS_DISPLAY "Custom"<br><br>   # Get the user entered values.<br>   !insertmacro MUI_INSTALLOPTIONS_READ $Username "Custom" "Field 1" "State"<br>   !insertmacro MUI_INSTALLOPTIONS_READ $Password "Custom" "Field 2" "State"<br>   !insertmacro MUI_INSTALLOPTIONS_READ $Server "Custom" "Field 3" "State"<br>   !insertmacro MUI_INSTALLOPTIONS_READ $Autoupdate "Custom" "Field 4" "State"<br>   !insertmacro MUI_INSTALLOPTIONS_READ $AUpdatePath "Custom" "Field 5" "State"<br>   <br><br>WriteRegStr HKCU "Software\VB and VBA Program Settings\${PRODUCT_NAME}\Main" "MySQLUser" $Username ;As per install instruction file.<br>WriteRegStr HKCU "Software\VB and VBA Program Settings\${PRODUCT_NAME}\Main" "MySQLPass" $Password<br>WriteRegStr HKCU "Software\VB and VBA Program Settings\${PRODUCT_NAME}\Main" "MySQLADDR" $Server<br>WriteRegStr HKCU "Software\VB and VBA Program Settings\${PRODUCT_NAME}\Main" "AutoUpdatePath" $AUpdatePath<br><br>   ${If} $Autoupdate = 1 ;control is selected<br>   WriteRegStr HKCU "HKEY_CURRENT_USER\Software\VB and VBA Program Settings\${PRODUCT_NAME}\Main" "AutoUpdateEnable"="1"<br>   ${EndIf}<br>   ${If} $Autoupdate = 0<br>   WriteRegStr HKCU "HKEY_CURRENT_USER\Software\VB and VBA Program Settings\${PRODUCT_NAME}\Main" "AutoUpdateEnable"="0"<br>   ${EndIf}<br><br>FunctionEnd</code>
</pre><br>
      <br>
      I thought the last set of statements would work properly.. At least the reg key is actually made.. :] I can't see someone wanting to use the installer without selecting auto-update anyways..
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Red Wine</span><br>
      <span class="post-time small text-muted">20th March 2008 18:03 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">You must get the user entered values within custom page leave function. When you read it within create function, you're just getting the values that you've set as default.</p>
    </div>
    <hr>

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]></script></body></html>