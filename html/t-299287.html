<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="Avoiding a bad way of starting an application on login / startup" />

  <title>Avoiding a bad way of starting an application on login / startup - NSIS Forums</title>
  <script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script>
  <!-- Bootstrap core CSS -->

  <link rel="stylesheet" type="text/css" href="//netdna.bootstrapcdn.com/bootswatch/3.0.1/readable/bootstrap.min.css" />
  <link rel="stylesheet" href="../css/style.css" type="text/css" /><!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!--[if lt IE 9]>
                <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
                <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->
</head>

<body>
  <div class="container">
    <!-- Put navigation bar here -->

    <ol class="breadcrumb">
      <li><a href="../index.html" class="glyphicon glyphicon-home"></a></li>

      <li><a href="f-65.html">NSIS Discussion</a></li>

      <li class="active">Avoiding a bad way of starting an application on login / startup</li>
    </ol>

    <p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=299287">Avoiding a bad way of starting an application on login / startup</a></p><br />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">JonathansCorner</span><br />
      <span class="post-time small text-muted">28th October 2008 20:27 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>Avoiding a bad way of starting an application on login / startup</strong><br />
      I have a Tcl script that I want to provide a notification window when someone connects to a port it's listening to and provides specific information, and I'd like to have the script started when the user logs in, or possibly when the computer is started up.<br />
      <br />
      I'd imagine that if I poked around other resources I could find a bad way to get it to work on my system... and wanted to ask people on this system, who probably know the right way, what's the "best engineering" approach in this case?<br />
      <br />
      <a href="http://JonathansCorner.com/" target="_blank">Jonathan</a></p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">AaronLS</span><br />
      <span class="post-time small text-muted">29th October 2008 01:39 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">I'm unfamiliar with what a TCL script is, but if it is, or can be package in, an executable, then you can use the registry in windows to set it to run at startup. You can either do this for a particular user by adding a registry entry to HKCU, or do it for all users by adding it to HKLM<br />
      <br />
      HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Run<br />
      <br />
      The other option is to place a shortcut into the "startup" folder of the start menu. Once again, you can do this under an individual user's start menu or the All Users startmenu.<br />
      <br />
      If you want to make it easy for the user to enable/disable this feature, you should do it through the start menu.<br />
      <br />
      The registry is probably the easier method though, and what I would go with. If I wanted to allow the user to disable the "Run at startup", then I'd provide a GUI that allows them to do that, and the application would remove the registry entry for them.<br />
      <br />
      IMO it is a really awful practice to set a program to run at startup and not provide an obvious/intuitive way to let the user disable that feature. Additionally I'd say that the installer should even have a "Run at startup" checkbox so the user can disable the feature.<br />
      <br />
      Oh, the other option is to install a Windows Service. One big difference will be that the above methods will not run the program until a user logs in. A windows Service can startup before anyone has even logged in, which is great if you need the application to run on a server, where users are not normally logged in.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">JonathansCorner</span><br />
      <span class="post-time small text-muted">29th October 2008 15:11 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">TCL is a scripting language, something of a lesser-known cousin to Perl and Python--it is indeed an executable, although interpreted rather than being a standalone .exe.<br />
      <br />
      So the installer, to work for the current user, should be something like:<br />
      <br />
      WriteRegStr HKCU "Software\MicroSoft\Windows\CurrentVersion\Run" "${_APP_NAME}" "${_APP_NAME}"<br />
      <br />
      Or is part of that a bit off?<br />
      <br />
      Thanks for your help,<br />
      Jonathan</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">AaronLS</span><br />
      <span class="post-time small text-muted">30th October 2008 07:34 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">I think that's right, except the value parameter should be the full path to the executable, something like this I think:<br />
      <br />
      WriteRegStr HKCU "Software\Microsoft\Windows\CurrentVersion\Run" "${_APP_NAME}" "C:\blah\TLC.exe"<br />
      <br />
      Edit: I'm not sure if registry keys are case sensitive, but I noticed you have MicroSoft instead of Microsoft. Thought I'd point that out if you have a problem.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">JonathansCorner</span><br />
      <span class="post-time small text-muted">30th October 2008 14:10 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Thanks you, in particular for the capitalization note.<br />
      <br /></p>

      <blockquote>
        <i>Originally posted by AaronLS</i><br />
        <b>I think that's right, except the value parameter should be the full path to the executable, something like this I think:<br />
        <br />
        WriteRegStr HKCU "Software\Microsoft\Windows\CurrentVersion\Run" "${_APP_NAME}" "C:\blah\TLC.exe"<br />
        <br />
        Edit: I'm not sure if registry keys are case sensitive, but I noticed you have MicroSoft instead of Microsoft. Thought I'd point that out if you have a problem.</b>
      </blockquote>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">JonathansCorner</span><br />
      <span class="post-time small text-muted">10th December 2008 22:22 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"></p>

      <blockquote>
        WriteRegStr HKCU "Software\Microsoft\Windows\CurrentVersion\Run" "${_APP_NAME}" "C:\blah\TLC.exe"
      </blockquote>Followup question: How, in the uninstaller, do I delete the registry key or part of key created as quoted above?<br />
      <br />
      Thanks,<br />
      Jonathan
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">AaronLS</span><br />
      <span class="post-time small text-muted">10th December 2008 23:24 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"></p>

      <blockquote>
        <i>Originally posted by JonathansCorner</i><br />
        <b>Followup question: How, in the uninstaller, do I delete the registry key or part of key created as quoted above?<br />
        <br />
        Thanks,<br />
        Jonathan</b>
      </blockquote>According to the NSIS user manual section 4.9.2.4 it should be something like this:<br />
      DeleteRegValue HKLM "Software\Microsoft\Windows\CurrentVersion\Run" "${_APP_NAME}"
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">JonathansCorner</span><br />
      <span class="post-time small text-muted">11th December 2008 14:26 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"></p>

      <blockquote>
        <i>Originally posted by AaronLS</i><br />
        <b>According to the NSIS user manual section 4.9.2.4 it should be something like this:<br />
        DeleteRegValue HKLM "Software\Microsoft\Windows\CurrentVersion\Run" "${_APP_NAME}"</b>
      </blockquote>Thank you!<br />
      <br />
      Much appreciated,
    </div>
    <hr />

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]>
  </script>
</body>
</html>
