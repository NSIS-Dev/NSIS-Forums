<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="description" content="nsExec::execToStack w/ spaces"><title>nsExec::execToStack w/ spaces - NSIS Forums</title><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script><link rel="preload" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css" as="style" onload="this.rel='stylesheet'"><link rel="preload" href="../css/style.css" as="style" onload="this.rel='stylesheet'"><noscript><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css"><link rel="stylesheet" href="../css/style.css"></noscript><script>!function(a){"use strict";var b=function(b,c,d){function e(a){return h.body?a():void setTimeout(function(){e(a)})}function f(){i.addEventListener&&i.removeEventListener("load",f),i.media=d||"all"}var g,h=a.document,i=h.createElement("link");if(c)g=c;else{var j=(h.body||h.getElementsByTagName("head")[0]).childNodes;g=j[j.length-1]}var k=h.styleSheets;i.rel="stylesheet",i.href=b,i.media="only x",e(function(){g.parentNode.insertBefore(i,c?g:g.nextSibling)});var l=function(a){for(var b=i.href,c=k.length;c--;)if(k[c].href===b)return a();setTimeout(function(){l(a)})};return i.addEventListener&&i.addEventListener("load",f),i.onloadcssdefined=l,l(f),i};"undefined"!=typeof exports?exports.loadCSS=b:a.loadCSS=b}("undefined"!=typeof global?global:this);!function(a){if(a.loadCSS){var b=loadCSS.relpreload={};if(b.support=function(){try{return a.document.createElement("link").relList.supports("preload")}catch(b){return!1}},b.poly=function(){for(var b=a.document.getElementsByTagName("link"),c=0;c<b.length;c++){var d=b[c];"preload"===d.rel&&"style"===d.getAttribute("as")&&(a.loadCSS(d.href,d,d.getAttribute("media")),d.rel=null)}},!b.support()){b.poly();var c=a.setInterval(b.poly,300);a.addEventListener&&a.addEventListener("load",function(){b.poly(),a.clearInterval(c)}),a.attachEvent&&a.attachEvent("onload",function(){a.clearInterval(c)})}}}(this);</script></head><body><div class="container"><ol class="breadcrumb"><li><a href="../index.html" class="glyphicon glyphicon-home"></a></li><li><a href="f-65.html">NSIS Discussion</a></li><li class="active">nsExec::execToStack w/ spaces</li></ol><p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=258747">nsExec::execToStack w/ spaces</a></p><br><div class="post"><p class="post-meta"><span class="post-author text-primary">neil.benn</span><br><span class="post-time small text-muted">1st November 2006 23:22 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>nsExec::execToStack w/ spaces</strong><br>Hello,<br><br>I am using nsExec::execToStack to call a program I have written,I am passing it:<br><br>48#"\windows\CrEme\bin\CrEme.exe" -Of -vkb -wd '|PROGRAM_FILES|\DropPaq' -jar 'bin\DropPaq.jar' etc\RippleConfig.xml fire default<br><br>as a parameter. the program then returns:<br><br>48#"\windows\CrEme\bin\CrEme.exe" -Of -vkb -wd 'Programme\DropPaq' -jar 'bin\DropPaq.jar' etc\RippleConfig.xml fire default<br><br>basically, it interrrogates a PDA to find out the names of the special directories and returns the result from the string to stdout. When I'm popping the result off the stack I only get the text up to the space :<br><br>48#"\windows\CrEme\bin\CrEme.exe"<br><br>I'mnot sure if it is the quotes or the space that is giving me the problem, I've tried popping the data off twice to see if I get the next bit but nothing is happening. Has anyone ever seen this effect? If so do you know what is going on and do you know how to circumvent it?<br><br>Thanks for your help.<br><br>Cheers,<br><br>Neil</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">kichik</span><br><span class="post-time small text-muted">2nd November 2006 08:40 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Works fine for me with invalid input. It just pushes "error" on the stack. What's the exact code you're using?</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">neil.benn</span><br><span class="post-time small text-muted">2nd November 2006 20:08 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Hello,<br><br>Thanks for the response, the program gives the base response works as seen above when run from the command prompt. The NSIS code that calls this is as follows:<br><br>---<br>DetailPrint "Accessing PDA"<br>nsExec::Exec '$INSTDIR\CEFileOp.exe /c dev:"|PROGRAMS|\DropPaq Fire.lnk" desk:"DropPaq Fire.lnk"'<br>call CheckCESuccess<br>IfErrors FailedMod<br>DetailPrint "Checking system"<br>FileOpen $3 "DropPaq Fire.lnk" r<br>FileRead $3 $4<br>FileClose $3<br>MessageBox MB_OK '"$INSTDIR\CEFileOp.exe" /r $4'<br>nsExec::ExecToStack '"$INSTDIR\CEFileOp.exe" /r $4'<br>call CheckCESuccess<br>Pop $0<br>MessageBox MB_OK $0<br>Pop $1<br>MessageBox MB_OK $1<br>IfErrors FailedMod SuccessMod<br><br>FailedMod:<br>SetErrors<br>Return<br>SuccessMod:<br>DetailPrint "Successful Access"<br><br>---<br><br>Basically this connects to the handheld, retrieves the file 'Droppaq Fire.lnk', reads th contents out nto a string and then calls the replace on that string. I have checked that the file is being read correctly as the correct data shows up on the messagebox, this calls the exe with the details as used on the command line. However the return via nsExec::ExecToStack only shows the following bit, however this is missing the quotes I actually get returned -<br><br>48#\windows\CrEme\bin\CrEme.exe<br><br>Note, this is without the quotes, so I assume that the quotes in the return string are causing me a problem. In addition,when I pop off the stack twice, the second time gives me an error so there is no more to retrieve from stdout.<br><br>I'm going to try making a batch file which returns a string with quotes in to see what that does when called with nsExec:ExecToStack.<br><br>However,if anyone has seen this before - tips would be great :).<br><br>Cheers,<br><br>Neil</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">kichik</span><br><span class="post-time small text-muted">2nd November 2006 20:27 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">What about the code for CheckCESuccess? Does it not touch the stack at all?<br><br>Make sure you're not passing new line characters along with $4 after you FileRead it. Use TrimNewLines to remove them.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">neil.benn</span><br><span class="post-time small text-muted">8th November 2006 13:08 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Hello,<br><br>Apologies, the error was with my code - I had rogue speechmarks in the execution string that I was not escaping - I escaped them and it now works fine.<br><br>Cheers,<br><br>Neil</p></div><hr><div class="footer"><p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p></div></div><script src="../js/highlight.pack.js" type="text/javascript"></script><script type="text/javascript">//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]></script></body></html>