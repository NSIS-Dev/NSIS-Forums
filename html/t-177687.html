<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="Uninstaller in different folder" />

  <title>Uninstaller in different folder - NSIS Forums</title><!-- Bootstrap core CSS -->
  <link rel="stylesheet" type="text/css" href="//netdna.bootstrapcdn.com/bootswatch/3.0.1/readable/bootstrap.min.css" />
  <link rel="stylesheet" href="../css/style.css" type="text/css" /><!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!--[if lt IE 9]>
                <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
                <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->
</head>

<body>
  <div class="container">
    <!-- Put navigation bar here -->

    <ol class="breadcrumb">
      <li><a href="../index.html" class="glyphicon glyphicon-home"></a></li>

      <li><a href="f-65.html">NSIS Discussion</a></li>

      <li class="active">Uninstaller in different folder</li>
    </ol>

    <p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=177687">Uninstaller in different folder</a></p><br />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">nbroers</span><br />
      <span class="post-time small text-muted">23rd April 2004 09:27 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>Uninstaller in different folder</strong><br />
      Hi,<br />
      <br />
      I need to put the uninst.exe file in a subdirectory of the INSTDIR. But when running the uninstaller, it fails to delete the files from INSTDIR.<br />
      <br />
      Is INSTDIR set to the folder where uninst.exe is stored for the uninstaller? Why does this happen?</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">evilO</span><br />
      <span class="post-time small text-muted">23rd April 2004 13:13 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Hi :)<br />
      <br />
      Yes, INSTDIR is set to the folder where the uninstaller is stored when running the uninstaller. What you can do is to redefine it in the 'pre' function of the uninstaller's confirm page:<br />
      <br />
      ; If you need to save the uninstaller's location<br />
      Var UNINSTDIR<br />
      <br />
      !define MUI_PAGE_CUSTOMFUNCTION_PRE un.onPreConfirmPage<br />
      !insertmacro MUI_UNPAGE_CONFIRM<br />
      <br />
      <br />
      <br />
      Function un.onPreConfirmPage<br />
      StrCpy $UNINSTDIR $INSTDIR<br />
      <br />
      ; Put some code here to retrieve the real INSTDIR<br />
      ; (from the registry or from an 'ini' file for instance)<br />
      <br />
      FunctionEnd<br />
      <br />
      <br />
      Let me know if it doesn't work..<br />
      <br />
      evilO/Olive</p>
    </div>
    <hr />

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]>
  </script>
</body>
</html>
