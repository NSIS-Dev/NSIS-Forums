<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="How to remove shortcuts from start menu in NSIS?" />

  <title>How to remove shortcuts from start menu in NSIS? - NSIS Forums</title>
  <script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script>
  <!-- Bootstrap core CSS -->

  <link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css" />
  <link rel="stylesheet" href="../css/style.css" type="text/css" /><!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!--[if lt IE 9]>
                <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
                <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->
</head>

<body>
  <div class="container">
    <!-- Put navigation bar here -->

    <ol class="breadcrumb">
      <li><a href="../index.html" class="glyphicon glyphicon-home"></a></li>

      <li><a href="f-65.html">NSIS Discussion</a></li>

      <li class="active">How to remove shortcuts from start menu in NSIS?</li>
    </ol>

    <p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=355765">How to remove shortcuts from start menu in NSIS?</a></p><br />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">ilaiyaraja</span><br />
      <span class="post-time small text-muted">12th February 2013 10:16 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>How to remove shortcuts from start menu in NSIS?</strong><br />
      I have created short cut menu using following code.<br />
      <br />
      <b>CreateDirectory "$SMPROGRAMS\myFolder"<br />
      CreateShortCut "$SMPROGRAMS\myFolder\app.lnk" "$INSTDIR\app.exe" "" "$INSTDIR\app.exe" 0<br />
      CreateShortCut "$SMPROGRAMS\myFolder\Uninstall.lnk" "$INSTDIR\Uninstall.exe" "" "$INSTDIR\Uninstall.exe" 0</b><br />
      <br />
      <br />
      The short cut folder created successfully.Also short cut menu created any of start menu folder.like games,accessories and etc,<br />
      I have included repair and remove option in this EXE.<br />
      <b>PROBLEM</b>:if the user install first time,he select short cut folder under accessories.same user run second time,he selects short cut folder under Games.Now run the uninstall.exe it was remove short cut folder only under the Games.The short cut menu still exists in accessories.How to remove all short cut folder in start menu?</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">MSG</span><br />
      <span class="post-time small text-muted">12th February 2013 11:42 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">If you want to remove stuff from all previous installations, you need to save the locations during each install. I suggest creating a regkey, where you add a new string of the path for each install. Then in uninstall simply enumerate that regkey and delete stuff.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">ilaiyaraja</span><br />
      <span class="post-time small text-muted">13th February 2013 03:35 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Thank you.I hope its working.I dont know how to create regkey using nsis.can you tell me how to create regkey?</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">MSG</span><br />
      <span class="post-time small text-muted">13th February 2013 05:53 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">It's all in the manual, under Registry, INI, File Instructions:<br />
      <a href="http://nsis.sourceforge.net/Docs/Chapter4.html#4.9.2.16" target="_blank">http://nsis.sourceforge.net/Docs/Chapter4.html#4.9.2.16</a></p>
    </div>
    <hr />

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]>
  </script>
</body>
</html>
