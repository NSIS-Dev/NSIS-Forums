<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="description" content="Processes plugin used on Win server 2008 x64"><title>Processes plugin used on Win server 2008 x64 - NSIS Forums</title><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script><link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css"><link rel="stylesheet" href="../css/style.css" type="text/css"></head><body><div class="container"><ol class="breadcrumb"><li><a href="../index.html" class="glyphicon glyphicon-home"></a></li><li><a href="f-65.html">NSIS Discussion</a></li><li class="active">Processes plugin used on Win server 2008 x64</li></ol><p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=322408">Processes plugin used on Win server 2008 x64</a></p><br><div class="post"><p class="post-meta"><span class="post-author text-primary">jammusi</span><br><span class="post-time small text-muted">14th September 2010 23:25 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>Processes plugin used on Win server 2008 x64</strong><br>Hi,<br><br>I am using the Processes pluin in order to find when does the explorer process finished its loading after system reboot.<br>It works perfect for Windows 7 (x86) and xp<br><br>When running on Windows server x2008 x64 machine it does not discover the explorer process.<br><br>I saw this plugin has another version for <a href="http://nsis.sourceforge.net/Processes_plug-in" target="_blank">vista OS x64 platform</a><br><br>1. Does this support any x64 platform (for instance Windows server 2008) ?<br>2. Does it also support a x86 machines?<br>That is: Can I use this version of the plugin to compile the setup script on x86 machine as well as to be executed there?<br><br>Tx<br><br>Oren</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br><span class="post-time small text-muted">15th September 2010 00:32 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">You cannot query a 64-bit process name (GetModuleBaseName) from a 32-bit process. You have to use something like WMI instead (there is a plug-in for this).<br><br>Stu</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">jammusi</span><br><span class="post-time small text-muted">15th September 2010 09:55 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Hi,<br><br>I am not sure I understand what you mean. Are you talking about NSIS or is it a general limitation?<br><br>I wrote a simple c# application compiled for x86 machine on a x86 machine.<br><br>The application list all processes on the machine it runs on.<br><br>I have executed this on the x64 machine and it showed everything (including the explorer process)<br><br>tx<br><br>Oren</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">DrO</span><br><span class="post-time small text-muted">15th September 2010 10:15 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">C# works differently as most C# assemblies contain what's needed to allow them to run as x86 or x64 as needed. with the NSIS processes plug-in, as it's a x86 only plug-in (and with NSIS being a x86 only program) it's not able to access certain x64 specific features (is just how it works).<br><br>-daz</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br><span class="post-time small text-muted">15th September 2010 10:35 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Also the .NET System.Diagnostics.Process class uses WMI to get its processes (which is why I said to use WMI) so it doesn't matter whether it's running as x86 or x64.<br><br>Stu</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">DrO</span><br><span class="post-time small text-muted">15th September 2010 10:47 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">ah didn't know that's what it uses, thanks for that stu (shows i'm still a right noob when it comes to C# though i've only done a month of using it actively so far, heh).<br><br>-daz</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">jammusi</span><br><span class="post-time small text-muted">15th September 2010 11:15 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Cool tx<br><br>Is there any way to write NSIS plugins with c# or only C/ C++?</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br><span class="post-time small text-muted">15th September 2010 11:34 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">There is the CLR plug-in (search for it) but of course the destination machine must have .NET installed.<br><br>Stu</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">jammusi</span><br><span class="post-time small text-muted">15th September 2010 12:12 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">tx<br><br>I'll look it later</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br><span class="post-time small text-muted">15th September 2010 15:56 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">You are better off using the WMI plug-in as I have already suggested. WMI is not part of .NET.<br><br>Stu</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">jammusi</span><br><span class="post-time small text-muted">15th September 2010 21:02 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Hi Stu,<br><br>1. The Installer I am handling already have a .NET class performing many other tasks.<br>This interface between the NSIS installer and the class is already "live a kicking" for a long time ans adding the FindProcess functionality was smooth.<br>The .NET limitation is not an issue as the installed product nneds .NET runtime and it is pre-requisite for the setup any how.<br><br><br>2. Before using this type of implementation - I briefly looked at the WMI plugin and didn't find processes related functionality. Adding the fact you said before:<br></p><blockquote>You have to use <b>something like</b> WMI instead (there is a plug-in for this).</blockquote>I assumed that this plugin does not support that.<br><br>Am I wrong?<br><br>Tx<br><br>Oren</div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br><span class="post-time small text-muted">15th September 2010 21:31 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">WMI (Windows Management Instrumentation) allows you to programmatically query the OS using WQL (a lot like SQL). The System.Management namespace in .NET provides WMI methods. For querying processes with WMI you'd use the <a href="http://msdn.microsoft.com/en-us/library/aa394372%28VS.85%29.aspx" target="_blank">Win32_Process WMI class</a>. Just had a look at the WmiInspector plug-in and it does look very limited. The only option the plug-in gives is limited (WmiInspector::Request which may not be enough for what you are after). If .NET is a prerequisite then you might as well use that (and use the Process class).<br><br>Stu</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">jammusi</span><br><span class="post-time small text-muted">15th September 2010 21:37 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">yes - this is exactly what i am doing<br><br><br>:up:<br><br>tx</p></div><hr><div class="footer"><p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p></div></div><script src="../js/highlight.pack.js" type="text/javascript"></script><script type="text/javascript">//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]></script></body></html>