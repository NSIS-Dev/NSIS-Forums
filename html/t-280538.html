<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="RequestExecutionLevel &amp; Vista" />

  <title>RequestExecutionLevel &amp; Vista - NSIS Forums</title>
  <script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script>
  <!-- Bootstrap core CSS -->

  <link rel="stylesheet" type="text/css" href="//netdna.bootstrapcdn.com/bootswatch/3.0.1/readable/bootstrap.min.css" />
  <link rel="stylesheet" href="../css/style.css" type="text/css" /><!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!--[if lt IE 9]>
                <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
                <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->
</head>

<body>
  <div class="container">
    <!-- Put navigation bar here -->

    <ol class="breadcrumb">
      <li><a href="../index.html" class="glyphicon glyphicon-home"></a></li>

      <li><a href="f-65.html">NSIS Discussion</a></li>

      <li class="active">RequestExecutionLevel &amp; Vista</li>
    </ol>

    <p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=280538">RequestExecutionLevel &amp; Vista</a></p><br />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Boneyhead</span><br />
      <span class="post-time small text-muted">2nd November 2007 01:44 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>RequestExecutionLevel &amp; Vista</strong><br />
      Reading through the help for NSIS it states that Vista already detect NSIS installers and decides that admin privileges are needed. Does this mean we can forgo adding RequestExecutionLevel to the script?</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Anders</span><br />
      <span class="post-time small text-muted">2nd November 2007 02:16 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Sort of, your installer will be treated as a legacy installer (whatever that means)<br />
      <br />
      no harm in adding RequestExecutionLevel admin</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">abcdgoldfish</span><br />
      <span class="post-time small text-muted">10th June 2009 02:09 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Okay, I've been Vista'd and could use some help. I am trying to copy some font files into C:\Windows\Fonts and have had no success. I placed the following code in my .nsi file, using UAC_AdminOnly.nsi as a guide. I got that particular code by following the link to a zip file in nsis.sourceforge.net/UAC_plug-in.<br />
      <br />
      First line in my .nsi file:<br />
      RequestExecutionLevel user<br />
      ...<br />
      !include UAC.nsh<br />
      ...<br />
      !define fontsDir "C:\Windows\Fonts"<br />
      Section "MainSection" SEC0<br />
      Rename $INSTDIR\qcsans.ttf ${fontsDir}\myFont.ttf<br />
      Rename $INSTDIR\my_bold.ttf ${fontsDir}\my_bold.ttf<br />
      SectionEnd<br />
      <br />
      Function .onInit<br />
      ${UAC.I.Elevate.AdminOnly}<br />
      FunctionEnd<br />
      <br />
      Function .OnInstFailed<br />
      ${UAC.Unload}<br />
      FunctionEnd<br />
      <br />
      Function .OnInstSuccess<br />
      ${UAC.Unload}<br />
      <br />
      FunctionEnd<br />
      <br />
      Not only are the font files not copied into the folder but, when I try to uninstall, I now get the error message Could not write update &lt;MYENV&gt; to HKLM. Could someone please shed some light on how to solve this?</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Anders</span><br />
      <span class="post-time small text-muted">10th June 2009 09:46 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">why are you using the UAC plugin?<br />
      <br />
      Search for fonts on the wiki for sample code</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">abcdgoldfish</span><br />
      <span class="post-time small text-muted">12th June 2009 20:05 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Forgive my ignorance but I searched <a href="http://nsis.sourceforge.net/Category:Code_Examples" target="_blank">http://nsis.sourceforge.net/Category:Code_Examples</a> which led me to <a href="http://nsis.sourceforge.net/Category:Plugins" target="_blank">http://nsis.sourceforge.net/Category:Plugins</a> in which the only reference to fonts was the FontName plugin. This does not appear to do what I need, which is to install the fonts. Am I missing something obvious?</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">abcdgoldfish</span><br />
      <span class="post-time small text-muted">12th June 2009 20:07 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">For clarification, since the URLs were cleaned up in my previous post:<br />
      nsis.sourceforge.net/Category:Code_Examples led me to nsis.sourceforge.net/Category:Plugins</p>
    </div>
    <hr />

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]>
  </script>
</body>
</html>
