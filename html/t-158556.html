<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="Problem calling DLL function using System plugin" />

  <title>Problem calling DLL function using System plugin - NSIS Forums</title><!-- Bootstrap core CSS -->
  <link rel="stylesheet" type="text/css" href="//netdna.bootstrapcdn.com/bootswatch/3.0.1/readable/bootstrap.min.css" />
  <link rel="stylesheet" href="../css/style.css" type="text/css" /><!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!--[if lt IE 9]>
                <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
                <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->
</head>

<body>
  <div class="container">
    <!-- Put navigation bar here -->

    <ol class="breadcrumb">
      <li><a href="../index.html" class="glyphicon glyphicon-home"></a></li>

      <li><a href="f-65.html">NSIS Discussion</a></li>

      <li class="active">Problem calling DLL function using System plugin</li>
    </ol>

    <p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=158556">Problem calling DLL function using System plugin</a></p><br />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">rsegal</span><br />
      <span class="post-time small text-muted">4th December 2003 20:43 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>Problem calling DLL function using System plugin</strong><br />
      So I have a function in the following format,<br />
      <br />
      int MyFunc(LPCTSTR param1, LPCTSTR param2)<br />
      <br />
      That I want to call using the System plugin. Seems simple enough right? This is how I'm calling the function<br /></p>
      <pre>
<code>System</code><span style="color: #007700">::</span><span style="color: #0000BB">Call</span><span style="color: #DD0000">'MyDLL::MyFunc(t"Hello",t"Goodbye")ir2'
</span>
</pre>However when I print out the contents of $2 all I get is a blank string when it should be an integer equal or greater than 0. Is there any way I can check whether the DLL is acutally getting called by the script? I think I've got the syntax right but I've never used the System DLL before so I'm not sure.
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
      <span class="post-time small text-muted">4th December 2003 21:17 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">You forgot a dot before r2. It should be:<br />
      <br />
      System::Call 'MyDLL::MyFunc (t "Hello", t "Goodbye") i .r2'<br />
      <br />
      The dot means the return value doesn't need an input. Each parameter specification, including the return value consists of type, input and output. If you want to skip input or output you put a dot. If it's the output, you can also not put anything there.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">rsegal</span><br />
      <span class="post-time small text-muted">4th December 2003 21:58 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Ok so I added in the dot, now my function returns "error" as it's return value. Is this something the System plugin will return or is that returned by the function I'm calling.<br />
      <br />
      Also does the DLL I'm calling need to be in a specific folder for it to be called. Say the Windows system directory?</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">rsegal</span><br />
      <span class="post-time small text-muted">4th December 2003 22:12 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Problem averted. Everything worked once I switched the call to<br />
      <br />
      System::Call '$SYSDIR\MyDLL::MyFunc (t "Hello", t "Goodbye") i .r2'<br />
      <br />
      As the DLL I want to call is in the windows system directory.</p>
    </div>
    <hr />

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]>
  </script>
</body>
</html>
