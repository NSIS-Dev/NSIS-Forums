<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="description" content="ReadINIStr and WriteINIStr"><title>ReadINIStr and WriteINIStr - NSIS Forums</title><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script><link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css"><link rel="stylesheet" href="../css/style.css" type="text/css"></head><body><div class="container"><ol class="breadcrumb"><li><a href="../index.html" class="glyphicon glyphicon-home"></a></li><li><a href="f-65.html">NSIS Discussion</a></li><li class="active">ReadINIStr and WriteINIStr</li></ol><p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=249901">ReadINIStr and WriteINIStr</a></p><br><div class="post"><p class="post-meta"><span class="post-author text-primary">Shorin</span><br><span class="post-time small text-muted">28th June 2006 18:51 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>ReadINIStr and WriteINIStr</strong><br>It seems that I cannot get ReadIniStr or WriteIniStr to work inside of a function call. These calls should work fine, because MUI_INSTALLOPTIONS_x...x uses it, and calling it from a function works fine.<br>So... is the case that the string and section need to exist in order for me to write to them?<br>If I cancel the installer before it completes, will the values not get written to the INI file?</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Joost Verburg</span><br><span class="post-time small text-muted">28th June 2006 18:53 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">It doesn't matter whether the command is inside a section or a function, there must be a bug in your script. What is the purpose of the function you are writing?</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Shorin</span><br><span class="post-time small text-muted">28th June 2006 19:03 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">For example:<br><br>ReadIniStr $R1 ".\slavenetpaths.ini" "ManualPaths" "NumEntries"<br>WriteINIStr "$EXEDIR/slavenetpaths.ini" "ManualPaths" "NumEntries" "$R2"<br>All do not work.<br><br>However<br>WriteIniStr "$EXEDIR/slavenetpaths.ini" "ManualPaths" "Slave $2" "$3"<br>Does claims no errors even though it didn't work.<br><br>slavenetpaths.ini is in the exedir.<br>I notice that alot of people ReserveFile their ini, and then extract it later. Also I notice that the installoptions ini files are not updated with default values whenever I quit the installer early. Neither does it update them when I actually complete the installer...<br>(annoying)</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Shorin</span><br><span class="post-time small text-muted">28th June 2006 19:41 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">I don't know why... but it just started working... (grr). I just put...<br>ReadIniStr $R1 ".\slavenetpaths.ini" "ManualPaths" "NumEntries"<br>removed some broken code around it (that had NOTHING to do with it), and I also added entries in my INI file. "NumEntries" was added. However it seems to have no problem adding and deleting the entries now. ... weird.<br>I'm now having a problem with:<br><br>SendMessage $1 ${CB_GETLBTEXT} $0 "STR:$3" $4<br><br>$4, of course returns the size of the string returned. BUT $3 doesn't contain anything.<br>StrCpy $3 " "<br>SendMessage $1 ${CB_GETLBTEXT} $0 "STR:$3" $4<br>Also doesn't work. It doesn't "fill up" $3.<br><br>SendMessage $1 ${CB_GETLBTEXT} $0 "$3" $4<br>Makes $4 contain -1, which is error.<br><br>This message is really expecting a POINTER to a string buffer for $3. Is there something I can do to make this work? (short of writing an external C++ program?)</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Shorin</span><br><span class="post-time small text-muted">28th June 2006 19:44 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">I'm posting a new thread about this.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br><span class="post-time small text-muted">29th June 2006 13:53 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Probably the fact that you use forward strokes (/) instead of back strokes.<br><br>Edit: And you should really stop using relative paths.<br><br>e.g.<br>SetOutPath "C:\"<br>ReadINIStr $R0 ".\file.ini" ...<br>will only work if file.ini is in C:\<br><br>Lets say you just happened to SetOutPath $INSTDIR first, then file.ini would then have to be in $INSTDIR to work.<br><br>-Stu</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Mr Inches</span><br><span class="post-time small text-muted">29th June 2006 15:01 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Regarding your second problem, it may be that the "STR:" form of parameter for SendMessage is for passing strings in only e.g for WM_SETTEXT or similar.<br><br>You could try using the System plug-in to make the call to SendMessage, it will allow you to pass the LPSTR parameter expected by CB_GETLBTEXT.<br><br>Duncan</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Shorin</span><br><span class="post-time small text-muted">29th June 2006 15:05 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">is there some documentation for the system plugin? How do I make calls to it regularly? (is there some sort of loading call I need to make?)</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">kichik</span><br><span class="post-time small text-muted">30th June 2006 11:29 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">System's documentation is located at Docs\System.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">shouman</span><br><span class="post-time small text-muted">2nd July 2006 12:46 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Visit the wiki page of NSIS.</p></div><hr><div class="footer"><p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p></div></div><script src="../js/highlight.pack.js" type="text/javascript"></script><script type="text/javascript">//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]></script></body></html>