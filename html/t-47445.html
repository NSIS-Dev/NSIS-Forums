<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="description" content="CreateShortcut problem"><title>CreateShortcut problem - NSIS Forums</title><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script><link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css"><link rel="stylesheet" href="../css/style.css" type="text/css"><!--[if lt IE 9]><script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script><script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script><![endif]--></head><body><div class="container"><ol class="breadcrumb"><li><a href="../index.html" class="glyphicon glyphicon-home"></a></li><li><a href="f-65.html">NSIS Discussion</a></li><li class="active">CreateShortcut problem</li></ol><p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=47445">CreateShortcut problem</a></p><br><div class="post"><p class="post-meta"><span class="post-author text-primary">PabUK</span><br><span class="post-time small text-muted">18th April 2001 12:25 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">I have the following code in an NSIS script:<br><br>SetOutPath "$STARTMENU\Programs\PAWSoft\PAWClock"<br>CreateShortCut "$STARTMENU\Programs\PAWSoft\PAWClock\PAWClock.lnk" "$INSTDIR\PAWClock.exe" "" "" 0<br>CreateShortCut "$STARTMENU\Programs\PAWSoft\PAWClock\Read Me.lnk" "$INSTDIR\ReadMe.txt" "" "" 0<br>CreateShortCut "$STARTMENU\Programs\PAWSoft\PAWClock\Whats New.lnk" "$INSTDIR\WhatsNew.txt" "" "" 0<br>CreateShortCut "$STARTMENU\Programs\PAWSoft\PAWClock\Uninstall PAWClock.lnk" "$INSTDIR\Uninstall.exe" "" "" 0<br><br>This code works fine for me whatever I do, such as installing to a non-default location and installing on another partition.<br><br>Th problem is that I have a beta tester and the createshortcuts failed for him. He sent me this screenshot:<br><br><a href="http://www.pawsoft.btinternet.co.uk/temp/NSISProb.gif" target="_blank">http://www.pawsoft.btinternet.co.uk/temp/NSISProb.gif</a><br><br>He later told me that he installed it to E:\win_util\pawclock<br><br>As I said I tested it myself on other partitions so I can't see how it could be that. Has anyone got any ideas why it might be failing or a way of getting more info?</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">PabUK</span><br><span class="post-time small text-muted">18th April 2001 12:28 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Also, I have just noticed that NSIS has $SMPROGRAMS, is it better to use than $STARTMENU\Programs or is it just for convenience?</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">PabUK</span><br><span class="post-time small text-muted">18th April 2001 14:08 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Just got another response from the tester with this problem:<br><br>Just in case it matters, I am using Windows ME and yes, other programs install okay. I checked the c:\program file directory because it is still there. I notice the error is referring to c:\windows\start menu\program and this directory is present. I tried three times and used the defaults and it still shows the error.<br><br>Please, has anyone seen this sort of error with CreateShortcut before? I hope it is only local to his system, but it is a worry either way.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">tale</span><br><span class="post-time small text-muted">8th May 2001 00:21 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>Create Shortcut bug...</strong><br>I've noticed that if the folder doesn't exist on my start menu under programs that the shortcuts don't get created there. Maybe that was the problem. I have to copy a file to the place I want to create the shortcuts and then delete the file. Then I can create my shortcuts successfully. I don't have any problems creating shortcuts anywhere else.<br><br>--tale</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">THEMike</span><br><span class="post-time small text-muted">9th May 2001 09:12 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Ok SMPROGRAMS (if that is correct) is much better to use.<br><br>Why? Well because it's not always start menu/programs.<br><br>I had some Dannish user complaining to me that it had created programs on his machine instead of putting it in his programma folder.<br><br>So I posted on the beta list, and the nice person on the list(craigf I think it was) provided me (/me no like c) with a fix, and next release something similar turned up. Cool.<br><br>Anyway I digress.<br><br>CreateShortcut requires the folders to already exist, you have to create the folder in the SMPROGRAMS then create shortcut in there, which I see you are doing.<br><br>Next it's the icon issue. I see you are using icon 0 in a non-extant file. Oh dear. If you want to specify an icon you have to specify the file too! If you don't specify either it works, if you specify one you have to specify the other.<br><br>e.g.<br></p><blockquote>SetOutPath "$STARTMENU\Programs\PAWSoft\PAWClock"<br>CreateShortCut "$STARTMENU\Programs\PAWSoft\PAWClock\PAWClock.lnk" "$INSTDIR\PAWClock.exe" "" $INSTDIR\PAWClock.exe 0</blockquote>If you want to default:<br><blockquote>SetOutPath "$STARTMENU\Programs\PAWSoft\PAWClock"<br>CreateShortCut "$STARTMENU\Programs\PAWSoft\PAWClock\PAWClock.lnk" "$INSTDIR\PAWClock.exe"</blockquote>Will do fine.</div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">PabUK</span><br><span class="post-time small text-muted">9th May 2001 13:30 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">My script has been completely rewritten in the 3 weeks since I posted that first message. It is now much better and has not failed in any situation so far. Part of the problem was with an NSIS bug in 1.3 but that has all been fixed now in the latest versions.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">THEMike</span><br><span class="post-time small text-muted">9th May 2001 16:19 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">DOH!<br><br>/me notices dates of PsyPab's posts<br><br>Well that will teach me to read the forums in such a rush.<br><br>Ah dagnamit. Better late than never ;-)</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">PabUK</span><br><span class="post-time small text-muted">9th May 2001 19:55 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Doesn't matter, I would probably have appreciated it at the time.<br><br>I hardly ever check the post date, so I can see how easy it could have happened. Especially in a forum as slow moving as this one (NSIS).</p></div><hr><div class="footer"><p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p></div></div><script src="../js/highlight.pack.js" type="text/javascript"></script><script type="text/javascript">//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]></script></body></html>