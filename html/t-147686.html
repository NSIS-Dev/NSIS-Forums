<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="description" content="how to add scheduled task, or is it possible?"><title>how to add scheduled task, or is it possible? - NSIS Forums</title><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script><link rel="preload" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css" as="style" onload="this.rel='stylesheet'"><link rel="preload" href="../css/style.css" as="style" onload="this.rel='stylesheet'"><noscript><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css"><link rel="stylesheet" href="../css/style.css"></noscript><script>!function(a){"use strict";var b=function(b,c,d){function e(a){return h.body?a():void setTimeout(function(){e(a)})}function f(){i.addEventListener&&i.removeEventListener("load",f),i.media=d||"all"}var g,h=a.document,i=h.createElement("link");if(c)g=c;else{var j=(h.body||h.getElementsByTagName("head")[0]).childNodes;g=j[j.length-1]}var k=h.styleSheets;i.rel="stylesheet",i.href=b,i.media="only x",e(function(){g.parentNode.insertBefore(i,c?g:g.nextSibling)});var l=function(a){for(var b=i.href,c=k.length;c--;)if(k[c].href===b)return a();setTimeout(function(){l(a)})};return i.addEventListener&&i.addEventListener("load",f),i.onloadcssdefined=l,l(f),i};"undefined"!=typeof exports?exports.loadCSS=b:a.loadCSS=b}("undefined"!=typeof global?global:this);!function(a){if(a.loadCSS){var b=loadCSS.relpreload={};if(b.support=function(){try{return a.document.createElement("link").relList.supports("preload")}catch(b){return!1}},b.poly=function(){for(var b=a.document.getElementsByTagName("link"),c=0;c<b.length;c++){var d=b[c];"preload"===d.rel&&"style"===d.getAttribute("as")&&(a.loadCSS(d.href,d,d.getAttribute("media")),d.rel=null)}},!b.support()){b.poly();var c=a.setInterval(b.poly,300);a.addEventListener&&a.addEventListener("load",function(){b.poly(),a.clearInterval(c)}),a.attachEvent&&a.attachEvent("onload",function(){a.clearInterval(c)})}}}(this);</script></head><body><div class="container"><ol class="breadcrumb"><li><a href="../index.html" class="glyphicon glyphicon-home"></a></li><li><a href="f-65.html">NSIS Discussion</a></li><li class="active">how to add scheduled task, or is it possible?</li></ol><p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=147686">how to add scheduled task, or is it possible?</a></p><br><div class="post"><p class="post-meta"><span class="post-author text-primary">atsuk</span><br><span class="post-time small text-muted">31st August 2003 07:46 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>how to add scheduled task, or is it possible?</strong><br>what if i wanted myapp.exe to be launched every monday at 09:00 ?</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">kichik</span><br><span class="post-time small text-muted">31st August 2003 11:12 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">A little forum search came up with:<br><br><a href="http://forums.winamp.com/showthread.php?s=&amp;threadid=111976&amp;highlight=schedule" target="_blank">http://forums.winamp.com/showthread....light=schedule</a></p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br><span class="post-time small text-muted">31st August 2003 13:24 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">That would be a good plugin for NSIS.<br>Do you think it will be made?<br><br>-Stu</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">kichik</span><br><span class="post-time small text-muted">31st August 2003 13:26 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Not by me on the near couple of weeks.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">brainsucker</span><br><span class="post-time small text-muted">2nd September 2003 12:14 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">At NT/W2k/Xp system there is command AT.EXE.<br>at.exe 9:00 /every:monday "c:\test.exe"</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">brainsucker</span><br><span class="post-time small text-muted">3rd September 2003 13:06 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Job could be done using updated system plugin (as soon as exehead will be updated too, for plugin look at "Exehead &amp; Ole" thread). I've included source file with function and use example (since it will be hard to extract information from this page :)<br><br>Usage:<br><br>push "My Task"<br>push "My Task Comment"<br>push "c:\Working Dir\My Task Program.exe"<br>push "c:\Working Dir"<br>push "My Program Args"<br>; what that's structure means? look thru attached nsi file, that's information tooks to many place<br>push "*(&amp;l2, &amp;i2 0, &amp;i2 2003, &amp;i2 9, &amp;i2 3, &amp;i2 0, &amp;i2 0, &amp;i2 0, &amp;i2 9, &amp;i2 0, i 0, i 0, i 0, i 2, &amp;i2 1, &amp;i2 0x2, &amp;i2 0, i 0, &amp;i2 0) i.s"<br>Call CreateTask<br>Pop $0<br>MessageBox MB_OK "CreateTask result: $0"<br><br>Realization and TIME_TRIGGER structure description are at attached nsi file.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">atsuk</span><br><span class="post-time small text-muted">4th September 2003 16:01 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">well, i got first example working fine, but i didn't manage to do it with the other one :(<br>tnx anyway</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">brainsucker</span><br><span class="post-time small text-muted">4th September 2003 18:22 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">first example???? I've posted only one...<br><br>Oh. you mean at.exe. :)<br><br>To utilize second one (it will work at win95-winxp) you'll need the latest CVS (as soon as Kichik will update it for compatibility with system plugin ;).<br><br>So... All together: KICHIK! KICHIK!! KICHIK!!!</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">atsuk</span><br><span class="post-time small text-muted">8th September 2003 12:44 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">well i still didn't understand second example, but i have a question with the first one. By default this command line<br>'at.exe 9:00 /every:monday "c:\test.exe"'<br>gives a name for the scheduled task "at1". is it possible to give job different name?</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">kichik</span><br><span class="post-time small text-muted">8th September 2003 12:49 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">For the second one you need the latest CVS version. As for the name of the task with the first one, if to believe to at.exe /?, you can't.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">brainsucker</span><br><span class="post-time small text-muted">8th September 2003 13:28 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Somebody checked it beside me? Kichik could you please? ;)</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">kichik</span><br><span class="post-time small text-muted">8th September 2003 13:57 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Yes, it works.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">atsuk</span><br><span class="post-time small text-muted">8th September 2003 17:39 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">ok got it:)</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">brainsucker</span><br><span class="post-time small text-muted">11th September 2003 15:42 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Just a system update.<br><br>release 5, 11 september 2003.<br>1. u flag - unload dll after procedure call.<br>2. some changes to asm to turn on Whole Program Optimization.<br>3. Dll shrinked for 1 kb.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">kichik</span><br><span class="post-time small text-muted">11th September 2003 21:21 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Uploaded, thanks.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">nsnb</span><br><span class="post-time small text-muted">23rd September 2010 19:16 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Before delving deeper into this plug-in, does it use the <a href="http://technet.microsoft.com/en-us/library/ee176704.aspx" target="_blank">Task Scheduler API</a>?<br><br>If so, does it have the same limitation as XP's command line <a href="http://www.microsoft.com/resources/documentation/windows/xp/all/proddocs/en-us/schtasks.mspx?mfr=true" target="_blank">schtasks</a>?<br><br>By limitation I mean the inability to schedule a task with an <b>empty password</b> (in addition to the fact that it's not available in XP Home).</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">nsnb</span><br><span class="post-time small text-muted">23rd September 2010 23:39 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Answering myself:<br></p><blockquote><small>Originally posted by nsnb</small><br>does it use the <a href="http://technet.microsoft.com/en-us/library/ee176704.aspx" target="_blank">Task Scheduler API</a>?</blockquote>Yes! It creates the familiar job files in %WINDIR%\Tasks.<br><br><blockquote><small>Originally posted by nsnb</small><br>If so, does it have the same limitation as XP's command line <a href="http://www.microsoft.com/resources/documentation/windows/xp/all/proddocs/en-us/schtasks.mspx?mfr=true" target="_blank">schtasks</a>?</blockquote>Yes. If the password for the account is empty, then the task would not start and logs the following error:<br><blockquote>The attempt to retrieve account information for the specified task failed; therefore, the task did not run. Either an error occurred, or no account information existed for the task.<br>The specific error is:<br>0x8004130f: No account information could be found in the Task Scheduler security database for the task indicated.</blockquote>The behavior of the existing "NSIS Scheduled Tasks" in my test system (XP SP2) is frustratingly unexplainable: The above error would occur if the scheduled job is produced by the script, but if the same exact task is opened via GUI and interactively uncheck-then-check the box "<b>Run only if logged on</b>", then the task would start.<br><br>Any explanation for that? How do I even begin to troubleshoot a problem like this (aside from looking at the log file and reading what I quoted above)?<br><br>Thanks.</div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">nsnb</span><br><span class="post-time small text-muted">24th September 2010 04:40 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"></p><blockquote><small>Originally posted by nsnb</small><br>Any explanation for that? How do I even begin to troubleshoot a problem like this (aside from looking at the log file and reading what I quoted above)?</blockquote>This problem is driving me crazy. I've combed the web and found many many posts describing a situation similar to what I described. For example:<br><br><a href="http://forums.winamp.com/showthread.php?t=225449" target="_blank">http://forums.winamp.com/showthread.php?t=225449</a><br><br><a href="http://msdn.microsoft.com/en-us/library/aa381276%28VS.85%29.aspx" target="_blank">http://msdn.microsoft.com/en-us/libr...8VS.85%29.aspx</a><br><br><a href="http://social.msdn.microsoft.com/Forums/en-US/vclanguage/thread/291d9722-ccbc-41ff-b33d-5f1af694ae72" target="_blank">http://social.msdn.microsoft.com/For...d-5f1af694ae72</a><br><br>But none of them would provide a clue as to why both NSIS flavors (the original NOT providing username/password &amp; the latest one providing them) will not work on my test system.<br><br>As I was about to give up, I discovered that if I create a password for the Administrator account (under which I am trying to set the scheduled task), and provide both the correct username and password, then the test NSIS script would finally succeed.<br><br>Nice, but isn't the existence of TASK_FLAG_RUN_ONLY_IF_LOGGED_ON (0x2000) supposed to answer exactly a case in which we DON'T want to provide a password in the script?<br><br>Something is not right here, and I don't know whether it's a bug in Windows, a bug in the MSDN documentation, or a bug in the "Scheduled Tasks" script for NSIS.<br><br>Or a bug in my brain. :stare:<br><br>Could you please help?</div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">ronca</span><br><span class="post-time small text-muted">24th September 2010 16:08 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">This is a secretly undocumented feature by Microsoft. You can't schedule tasks on a Windows account with administrator privileges that has no password.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">nsnb</span><br><span class="post-time small text-muted">24th September 2010 19:44 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"></p><blockquote><small>Originally posted by ronca</small><br>This is a secretly undocumented feature by Microsoft. You can't schedule tasks on a Windows account with administrator privileges that has no password.</blockquote>What??? This doesn't make sense. If Microsoft wanted to prohibit an Admin account with an empty password, it would have been disabled across the board, not only for the Task Scheduler.<br><br>Besides, Google's Chrome installed quite a few such (working!) scheduled tasks on my test machine having an Admin account with an empty password. Apple's iTunes did the same thing.<br><br>Also, created a scheduled task from the GUI (using the "<b>Run only if logged on</b>" checkbox) also works.<br><br>The problem must by lying elsewhere. I am becoming convinced that there is a bug in both NSIS "Scheduled Tasks" available scripts.<br><br>Has anyone (beside me) tested these scripts on an Admin account with an empty password?</div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">ronca</span><br><span class="post-time small text-muted">26th September 2010 19:59 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"></p><blockquote><small>Originally posted by nsnb</small><br>What??? This doesn't make sense.</blockquote>Of course it doesn't make sense but that's Microsoft. You don't have to believe me. I don't know if you discovered this already but in task scheduler you can't enter a path with spaces in it. For example if you have something in "C:\Program Files" you must use C:\Progra~1 instead. Makes sense? Of course not but that's Microsoft.</div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">nsnb</span><br><span class="post-time small text-muted">27th September 2010 19:51 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"></p><blockquote><small>Originally posted by ronca</small><br>I don't know if you discovered this already but in task scheduler you can't enter a path with spaces in it. For example if you have something in "C:\Program Files" you must use C:\Progra~1 instead. Makes sense? Of course not but that's Microsoft</blockquote>It turns out you were correct.<br><br>I was hoping that by using the <a href="http://nsis.sourceforge.net/Scheduled_Tasks" target="_blank">NSIS "Scheduled Tasks"</a> script I could avoid prompting the user for entering his password but since it needs the user password, too, I ended up using <b><font color="navy">nsExec::Exec schtasks /create</font></b> instead, which is documented at least and slightly more predictable.</div><hr><div class="footer"><p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p></div></div><script type="text/javascript" src="../js/highlight.pack.js" async></script><script type="text/javascript">//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]></script></body></html>