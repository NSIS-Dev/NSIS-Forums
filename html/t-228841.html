<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="description" content="Dynamically update label text in an InstalOptions Page"><title>Dynamically update label text in an InstalOptions Page - NSIS Forums</title><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script><link rel="preload" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css" as="style" onload="this.rel='stylesheet'"><link rel="preload" href="../css/style.css" as="style" onload="this.rel='stylesheet'"><noscript><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css"><link rel="stylesheet" href="../css/style.css"></noscript><script>!function(a){"use strict";var b=function(b,c,d){function e(a){return h.body?a():void setTimeout(function(){e(a)})}function f(){i.addEventListener&&i.removeEventListener("load",f),i.media=d||"all"}var g,h=a.document,i=h.createElement("link");if(c)g=c;else{var j=(h.body||h.getElementsByTagName("head")[0]).childNodes;g=j[j.length-1]}var k=h.styleSheets;i.rel="stylesheet",i.href=b,i.media="only x",e(function(){g.parentNode.insertBefore(i,c?g:g.nextSibling)});var l=function(a){for(var b=i.href,c=k.length;c--;)if(k[c].href===b)return a();setTimeout(function(){l(a)})};return i.addEventListener&&i.addEventListener("load",f),i.onloadcssdefined=l,l(f),i};"undefined"!=typeof exports?exports.loadCSS=b:a.loadCSS=b}("undefined"!=typeof global?global:this);!function(a){if(a.loadCSS){var b=loadCSS.relpreload={};if(b.support=function(){try{return a.document.createElement("link").relList.supports("preload")}catch(b){return!1}},b.poly=function(){for(var b=a.document.getElementsByTagName("link"),c=0;c<b.length;c++){var d=b[c];"preload"===d.rel&&"style"===d.getAttribute("as")&&(a.loadCSS(d.href,d,d.getAttribute("media")),d.rel=null)}},!b.support()){b.poly();var c=a.setInterval(b.poly,300);a.addEventListener&&a.addEventListener("load",function(){b.poly(),a.clearInterval(c)}),a.attachEvent&&a.attachEvent("onload",function(){a.clearInterval(c)})}}}(this);</script></head><body><div class="container"><ol class="breadcrumb"><li><a href="../index.html" class="glyphicon glyphicon-home"></a></li><li><a href="f-65.html">NSIS Discussion</a></li><li class="active">Dynamically update label text in an InstalOptions Page</li></ol><p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=228841">Dynamically update label text in an InstalOptions Page</a></p><br><div class="post"><p class="post-meta"><span class="post-author text-primary">neil.benn</span><br><span class="post-time small text-muted">19th October 2005 21:51 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>Dynamically update label text in an InstalOptions Page</strong><br>Hello,<br><br>I'm trying to dynamically update a label in an installoptions page so I can have something similar to the DetailPrint in an install dialog. I can#t force the dialog to redraw by calling abort because that would be a pain. I'm aware of SendMessage but I'm not quite sure how to getthe hwnd of a control using InstallOPtion and a the ModernUI.<br><br>Is ther an example of how to do this anywhere?<br><br>Cheers,<br><br>Neil</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">iceman_k</span><br><span class="post-time small text-muted">20th October 2005 01:29 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">You can't change the label while the dialog is visible.<br>You can only do it before it has been displayed either by modifying the INI file or by getting the HWND between the InstallOptions::initDialog and InstallOptions::show functions and then calling SendMessage to change the label.<br>A similar problem was discussed in detail some time ago.<br><br>Can you explain exactly what you want to do? Maybe there is another solution.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">neil.benn</span><br><span class="post-time small text-muted">20th October 2005 11:16 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>InstallOptions</strong><br>Hello,<br><br>Thanks for the reply. I have a licence page using InsallOptions, it goes through the following steps in the leavefunction of the Page:<br><br>* Prompts the user for the licence key and checks to see if it is well formed (ie matches the licence key pattern we have chosen)<br>* Chcek to see if the handheld is connected to the PC<br>* Downloads an application to an iPaq<br>* Excutes the applicaiton on the iPaq<br>* Retrieves the output of that which contains the processor ID of the handheld<br>* Reads the local PC file and gets this information into a variable in NSIS<br>* Deletes those files from the handheld<br>* Checks for internet connection<br>* Gets the licence key and procssorID and sends this off to a JSP servlet running somewhere<br>* Receives a file which is the licence file to be installed on the handheld in the instlal page<br><br>If any of these fails, it shows a message bos to the user and calls abort, thereby leaving me on this page until they either fix the problem or click abort. This is working nice but the problem is that the above steps take ~1 minute to process and I have no feedback to the user that something is happening and they may start giving the thing three fingered salutes (this is shipping to scientists who are notorioulsy impatient!!).<br><br>So that's it really give them feedback when this is happening to let them know that it hasn;t simply hung.<br><br>All help greatly appreciated.<br><br>Cheers,<br><br>Neil</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Takhir</span><br><span class="post-time small text-muted">20th October 2005 12:58 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Attached code works on the INSTFILES page, so this may work on InstallOptions as well, finally you can add RedrawWindow call to update label. I saw a lot of samples for text/color manipulations in wiki. But <a href="http://nsis.sourceforge.net/wiki/Marquee_text_scroll" target="_blank">Marquee</a> may be even better ;)</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">iceman_k</span><br><span class="post-time small text-muted">20th October 2005 16:21 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">neil.benn:<br>Actually, what you want to do should be possible using SendMessage and RedrawWindow calls.<br>IMHO, it would be easier to just use the Banner plugin.<br>You can update the text in the plugin between operations so that the user knows what is happening.<br>If something fails, close the plugin, show your MessageBox and Abort and you will still be on the IO page.</p></div><hr><div class="footer"><p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p></div></div><script type="text/javascript" src="../js/highlight.pack.js" async></script><script type="text/javascript">//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]></script></body></html>