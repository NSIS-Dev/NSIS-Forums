<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="description" content="install sequence just before MUI_PAGE_FINISH"><title>install sequence just before MUI_PAGE_FINISH - NSIS Forums</title><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script><link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css"><link rel="stylesheet" href="../css/style.css" type="text/css"><!--[if lt IE 9]><script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script><script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script><![endif]--></head><body><div class="container"><ol class="breadcrumb"><li><a href="../index.html" class="glyphicon glyphicon-home"></a></li><li><a href="f-65.html">NSIS Discussion</a></li><li class="active">install sequence just before MUI_PAGE_FINISH</li></ol><p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=295347">install sequence just before MUI_PAGE_FINISH</a></p><br><div class="post"><p class="post-meta"><span class="post-author text-primary">zanz</span><br><span class="post-time small text-muted">31st July 2008 23:17 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>install sequence just before MUI_PAGE_FINISH</strong><br>Is there a function or way to access files from the install dir just before the finish page MUI_PAGE_FINISH is displayed?<br><br>.onInstSuccess function (i think) executes when the finish page is already displayed.<br><br>A situation where installer has just finished copying files to the installdir, but the finish page isn't displayed. Do we have any function in between?<br><br>What I'm trying to do is to silently install a msi package from the install dir. When i silently launch the installation of the msi package from the installdir on .onInstSuccess fucntion, it seems like the installer has frozen on the finish page (until the MSI package is installed). It's a bad user experience. I'm just trying to create a better user experience. Please help.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">LoRd_MuldeR</span><br><span class="post-time small text-muted">1st August 2008 00:31 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Create a custom pre/show function for the finish page:<br><br></p><pre>
<code>!define MUI_PAGE_CUSTOMFUNCTION_PRE MyFinishPre<br>!define MUI_PAGE_CUSTOMFUNCTION_SHOW MyFinishShow<br>!insertmacro MUI_PAGE_FINISH<br><br>[...]<br><br>Function MyFinishPre<br>  ...<br>FunctionEnd<br><br>Function MyFinishShow<br>  Banner::show /NOUNLOAD "Installing important stuff, please wait..."<br>  File /oname=$PLUGINSDIR\Setup.exe "redist\Setup.exe"<br>  ExecWait '"$PLUGINSDIR\Setup.exe" /S'<br>  Banner::destroy"<br>FunctionEnd</code>
</pre><br>
      <br>
      <br>
      Alternatively you could simply install the MSI package in the <i>last</i> install section.<br>
      <br>
      If you do it in the show function, I'd use the Banner plugin, see code above...
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">zanz</span><br>
      <span class="post-time small text-muted">1st August 2008 18:57 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Thanks a bunch, exactly what i was looking for!</p>
    </div>
    <hr>

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]></script></body></html>