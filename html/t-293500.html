<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="VersionCompare result is 1" />

  <title>VersionCompare result is 1 - NSIS Forums</title>
  <script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script>
  <!-- Bootstrap core CSS -->

  <link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css" />
  <link rel="stylesheet" href="../css/style.css" type="text/css" /><!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!--[if lt IE 9]>
                <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
                <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->
</head>

<body>
  <div class="container">
    <!-- Put navigation bar here -->

    <ol class="breadcrumb">
      <li><a href="../index.html" class="glyphicon glyphicon-home"></a></li>

      <li><a href="f-65.html">NSIS Discussion</a></li>

      <li class="active">VersionCompare result is 1</li>
    </ol>

    <p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=293500">VersionCompare result is 1</a></p><br />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">healy76</span><br />
      <span class="post-time small text-muted">23rd June 2008 13:54 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>VersionCompare result is 1</strong><br />
      Hi<br />
      <br />
      In the VersionCompare help (<a href="http://nsis.sourceforge.net/VersionCompare" target="_blank">http://nsis.sourceforge.net/VersionCompare</a>) is the following sample:<br /></p>
      <pre>
<code><br /><font size="3">${VersionCompare} "1.1.1.9" "1.1.1.01" $R0     ; $R0="1"<br /></font><br /></code>
</pre><br />
      This is correct. But the following code results 1 too:<br />
      <pre>
<code><br /><font size="3">${VersionCompare} "1.1.1.1" "1.1.1.01" $R0     ; $R0="1"<br /></font><br /></code>
</pre><br />
      This is not correct. VersionCompare must ignore zero values at the front of a version part. I think the following result was desirable:<br />
      <pre>
<code><br /><font size="3">${VersionCompare} "1.1.1.1" "1.1.1.01" $R0     ; $R0="0"<br /></font><br /></code>
</pre>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
      <span class="post-time small text-muted">23rd June 2008 17:55 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">01 and 1 are the same number. Why should the comparison result be any different?</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
      <span class="post-time small text-muted">23rd June 2008 18:00 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">If they were the same then VersionCompare should return 0 not 1 as healy76 says? I personally don't think they are the same, but I'm not completely sure. I seem to remember when writing the function that this was based on, Instructor said that 01 is not the same as 1.<br />
      <br />
      Stu</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">healy76</span><br />
      <span class="post-time small text-muted">24th June 2008 07:51 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">It is 'not' correct. 1 is the same as 01 but 1 is not the same as 01. *very_strange* :-)<br />
      <br />
      @Afrow: For a C compiler is 010 an octal value and not a Integer. I think that is meaning by the Instructor. But here we have a Version number and not an single value. The devinition of a version is: integer dot integer [dot integer dot integer]. [] is not mandatory.<br />
      <br />
      Other example: Whe you try to use a Microsoft .NET class to convert a string value to a version you can use a class named Version(). For this class the value "1.1.1" is the same as "1.01.01". This class ignore the leading zero's.<br />
      <br /></p>
      <pre>
<code><font size="3">C#:<br />     Version v1 = new Version("1.1.1");<br />     MessageBox.Show( v1.ToString() );     // -&gt; 1.1.1<br /><br />     Version v2 = new Version("1.01.01");<br />     MessageBox.Show(v2.ToString());       // -&gt; 1.1.1<br /></font></code>
</pre><br />
      Currently i replace the value ".0" with "." in my NSIS Script before i use the VersionCompare. It works fine but in future it was more user-friendly when the VersionCompare do this for me.
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
      <span class="post-time small text-muted">24th June 2008 10:09 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Ok thanks for the info. I'd contact Instructor by PM! So basically it depends which way around your arguments are for the call?<br />
      <br />
      Stu</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">healy76</span><br />
      <span class="post-time small text-muted">24th June 2008 10:57 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">@Afrow: Sorry but i down't understand your last sentense/question.<br />
      <br /></p>

      <blockquote>
        So basically it depends which way around your arguments are for the call?
      </blockquote>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
      <span class="post-time small text-muted">24th June 2008 13:11 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Do you get the same result for<br />
      ${VersionCompare} "1.1.1.1" "1.1.1.01" $R0<br />
      and<br />
      ${VersionCompare} "1.1.1.01" "1.1.1.1" $R0<br />
      <br />
      Just so we know it is a bug and not by design.<br />
      <br />
      Stu</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">healy76</span><br />
      <span class="post-time small text-muted">24th June 2008 13:33 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Ah ok. I have test this in a little example. Here is the result:<br />
      <br /></p>
      <pre>
<code><br />  ${VersionCompare} "1.1.1.1" "1.1.1.01" $R0<br />  Detailprint $R0     ;-&gt;   $R0="1"<br />  <br />  ${VersionCompare} "1.1.1.01" "1.1.1.1" $R0<br />  Detailprint $R0     ;-&gt;   $R0="1"<br /></code>
</pre>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Instructor</span><br />
      <span class="post-time small text-muted">24th June 2008 19:26 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"></p>
      <pre>
<code>${VersionCompare} "1.1.1.1" "1.1.1.01" $R0<br />Detailprint $R0     ;-&gt;   $R0="1"<br />  <br />${VersionCompare} "1.1.1.01" "1.1.1.1" $R0<br />Detailprint $R0     ;-&gt;   $R0="<font color="red">2</font>"</code>
</pre>It is by design.
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">healy76</span><br />
      <span class="post-time small text-muted">25th June 2008 07:15 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Oh sorry. That's right. I have the value $R0="2" too. Likely a copy &amp; past error of me. Sorry.<br />
      <br />
      Of course you can say: "blue is equal to green". :-) But in the real world isn't it the same.<br />
      <br />
      <b>What is the reason behind this design?</b> I subscribe to a view whith Microsoft. "01" or "001" is only a formating rule of version number and so not the same as "1".</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Animaether</span><br />
      <span class="post-time small text-muted">7th October 2008 21:29 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">I'm going to have to second the question of why this is by design; as far as I know, throughout school, in any programming language where you use decimals (which version numbers' individual parts are), and so forth on... leading zeroes can and should be ignored.<br />
      <br />
      1.000000 is not the exact same as 1 if you're in a scientific field, but even there, 00000001 is the exact same as 1.<br />
      <br />
      I understand that *some* programmers decide to go with a version number such as "4.2" and then release a minor update and not wanting to go to "4.3", they make it "4.25" instead; those programmers need to be hit over the head with a clue-by-four.<br />
      <br />
      Right now it has potential for breaking version comparisons where it shouldn't.<br />
      For example, to check on the version of .NET Framework 3.0, I need to do the following (assume the second value is read from registry):<br />
      ${VersionCompare} "3.0.04506.26" "3.0.04506.26" $1<br />
      This returns 0 as both are equal.<br />
      <br />
      Personally I have a newer version installed:<br />
      ${VersionCompare} "3.0.04506.26" "3.0.04506.30" $1<br />
      This returns 2, as the second is newer. All good.<br />
      <br />
      But then along comes a pre-release:<br />
      ${VersionCompare} "3.0.04506.26" "3.0.4506.21" $1<br />
      This returns 2; even though the second version - imho - is the lesser, not the greater, of the two.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">stb</span><br />
      <span class="post-time small text-muted">13th October 2008 18:22 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"></p>
      <pre>
<code><br />; example:<br />;   Push "1.2.3.4"  ; versionnumber 1<br />;   Push "1.2.4"    ; versionnumber 2<br />;   !insertmacro VersionCheck<br />;   Pop $0<br />; Result is: "0" if equal, "1" if 1 is higher, "2" if 2 is higher<br />!macro CompareVersionnumbers<br />  !define Index 'VersionCheck_Line${__LINE__}'<br />  Exch $R0 ;second versionnumber<br />  Exch<br />  Exch $R1 ;first versionnumber<br />  Push $R3 ;temp char<br />  Push $R4 ;temp string for $R0<br />  Push $R5 ;temp string for $R1<br />  Push $R6 ;counter for $R0<br />  Push $R7 ;counter for $R1<br />  StrCpy $R6 "-1"<br />  StrCpy $R7 "-1"<br />${Index}-Start:<br />  StrCpy $R4 ""<br />${Index}-DotLoop0:<br />  IntOp $R6 $R6 + 1<br />  StrCpy $R3 "$R0" 1 $R6<br />  StrCmp $R3 "" ${Index}-DotFound0<br />  StrCmp $R3 "." ${Index}-DotFound0<br />  StrCpy $R4 "$R4$R3"<br />  Goto ${Index}-DotLoop0<br />${Index}-DotFound0:<br />  StrCpy $R5 ""<br />${Index}-DotLoop1:<br />  IntOp $R7 $R7 + 1<br />  StrCpy $R3 "$R1" 1 $R7<br />  StrCmp $R3 "" ${Index}-DotFound1<br />  StrCmp $R3 "." ${Index}-DotFound1<br />  StrCpy $R5 "$R5$R3"<br />  Goto ${Index}-DotLoop1<br />${Index}-DotFound1:<br />  StrCmp $R4 "" 0 ${Index}-4NotEmpty<br />  StrCmp $R5 "" ${Index}-Equal<br />  StrCpy $R4 "0"<br />${Index}-4NotEmpty:<br />  StrCmp $R5 "" 0 ${Index}-CompareNumbers<br />  StrCpy $R5 "0"<br />${Index}-CompareNumbers:<br />  IntCmp $R4 $R5 ${Index}-Start ${Index}-Ver1More ${Index}-Ver2More<br />${Index}-Equal:<br />  StrCpy $R0 "0"<br />  Goto ${Index}-Finish<br />${Index}-Ver1More:<br />  StrCpy $R0 "1"<br />  Goto ${Index}-Finish<br />${Index}-Ver2More:<br />  StrCpy $R0 "2"<br />${Index}-Finish:<br />  Pop $R7<br />  Pop $R6<br />  Pop $R5<br />  Pop $R4<br />  Pop $R3<br />  Pop $R1<br />  Exch $R0<br />  !undef Index<br />!macroend<br /></code>
</pre>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Animaether</span><br />
      <span class="post-time small text-muted">13th October 2008 18:48 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Cool - might have to Function-ize it.. still beats what I had been doing, though (Strip Leading Zeroes - wiki, WordReplace'ing ".0" with "." (taking care to replace ".0." with a safeguard), then finally calling the existing versioncompare.</p>
    </div>
    <hr />

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]>
  </script>
</body>
</html>
