<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="InstallDLL Problems" />

  <title>InstallDLL Problems - NSIS Forums</title><!-- Bootstrap core CSS -->
  <link rel="stylesheet" type="text/css" href="//netdna.bootstrapcdn.com/bootswatch/3.0.1/readable/bootstrap.min.css" />
  <link rel="stylesheet" href="../css/style.css" type="text/css" /><!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!--[if lt IE 9]>
                <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
                <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->
</head>

<body>
  <div class="container">
    <!-- Put navigation bar here -->

    <ol class="breadcrumb">
      <li><a href="../index.html" class="glyphicon glyphicon-home"></a></li>

      <li><a href="f-65.html">NSIS Discussion</a></li>

      <li class="active">InstallDLL Problems</li>
    </ol>

    <p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=259955">InstallDLL Problems</a></p><br />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">sayo9394</span><br />
      <span class="post-time small text-muted">20th November 2006 01:33 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>InstallDLL Problems</strong><br />
      Hi guys,<br />
      <br />
      i'm totally new to NSIS, and i'm still experimenting with the examples and tutorials found in the NSIS installation directory.<br />
      <br />
      i was surprised to see that the Library.nsi example doesn't work. returns with a "Error opening file for writing: c:\...bla bla\Library Test\test.dll "<br />
      <br />
      again the code is in C:\program files\nsis\Examples\ and the file called Library.nsi<br />
      <br />
      !define TestDLL '"${NSISDIR}\Plugins\LangDLL.dll"'<br />
      <br />
      !insertmacro InstallLib DLL NOTSHARED REBOOT_PROTECTED ${TestDLL} $INSTDIR\test.dll $INSTDIR<br />
      <br />
      thanx guys for you help.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Red Wine</span><br />
      <span class="post-time small text-muted">20th November 2006 11:04 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Obviously the renamed LangDll.dll has not reg. entry points :-)</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">sayo9394</span><br />
      <span class="post-time small text-muted">20th November 2006 11:53 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"></p>

      <blockquote>
        <i>Originally posted by Red Wine</i><br />
        <b>Obviously the renamed LangDll.dll has not reg. entry points :-)</b>
      </blockquote>Hi Red Wine,<br />
      Thanx for the reply, but i didn't quite get wat ur trying to say???? this code came with the nsis installation in the example directory and shouldn't be buggy... ???<br />
      again the code in questions is in C:\program files\nsis\Examples\Library.nsi<br />
      my problem is that i wish to install dll files from a certain application and the only example i have to help me, doesn't work...<br />
      <br />
      cheers,<br />
      Simon
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Red Wine</span><br />
      <span class="post-time small text-muted">20th November 2006 12:11 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">The specific script example has some comments on the top:<br />
      # This example tests the compile time aspect of the Library macros<br />
      # more than the runtime aspect. It is more of a syntax example,<br />
      # rather than a usage example.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">sayo9394</span><br />
      <span class="post-time small text-muted">21st November 2006 00:21 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"></p>

      <blockquote>
        <i>Originally posted by Red Wine</i><br />
        <b>The specific script example has some comments on the top:<br />
        # This example tests the compile time aspect of the Library macros<br />
        # more than the runtime aspect. It is more of a syntax example,<br />
        # rather than a usage example.</b>
      </blockquote>excellent ... i'm following you so far...<br />
      it was concentrating more on the syntax part of it... so now, i have a bunch of dll files that need to be installed on a system. previously, without an installer, i simply used to just copy the dlls into the $INSTDIR... but now that i know about NSIS (tryin to get to know about it atleast) how would i go on installing them? i can see that there are many types (dll, regdll, tlb, and regdlltlb) also if shared and install method ( reboot_protected... bla bla)<br />
      <br />
      the question is how do i know which to use with my dlls??<br />
      <br />
      Thank you guys for your patience... i really have spent 2 days googling about it.. and the NSIS User Manual says nearly nothin about it...
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Red Wine</span><br />
      <span class="post-time small text-muted">21st November 2006 15:51 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">For a dll or a bunch of them who they're not shared nor OCX, TLB etc all you need to do to install/update them, is to use the file or copyfile instruction according to your prefs.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">sayo9394</span><br />
      <span class="post-time small text-muted">22nd November 2006 00:46 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Thanx Red Wine,<br />
      <br />
      i came to that conclusion yesterday, logically since previously i was copying and pasting the files with new installations, it makes perfect sense to use the File instruction. what a waste of 2 days!!!...<br />
      The manual was really vague about it, and i thought might as well do it the proper way...<br />
      <br />
      Thank you again for your help... i will be using the file instruction :)</p>
    </div>
    <hr />

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]>
  </script>
</body>
</html>
