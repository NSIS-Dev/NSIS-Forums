<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="description" content="DLL version numbering"><title>DLL version numbering - NSIS Forums</title><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script><link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css"><link rel="stylesheet" href="../css/style.css" type="text/css"></head><body><div class="container"><ol class="breadcrumb"><li><a href="../index.html" class="glyphicon glyphicon-home"></a></li><li><a href="f-65.html">NSIS Discussion</a></li><li class="active">DLL version numbering</li></ol><p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=95793">DLL version numbering</a></p><br><div class="post"><p class="post-meta"><span class="post-author text-primary">Kypec</span><br><span class="post-time small text-muted">26th July 2002 13:02 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>DLL version numbering</strong><br>While I've been trying GetDLLVersion functionality I discovered the following: the numbers which I obtain when calling this function (NSIS 1.99) and the numbers which I can see when viewing the properties of the file (File version tab) are not always the same. Here is a short list obtained from my Win98SE system -<br><i>filename</i> <i>file version tab</i> <i>GetDLLVersion returned value</i><br>OLEAUT32.DLL 2.40.4515 00020028 11A30000 - seems OK<br>MFC42.DLL 6.00.8665.0 00060000 21D90000 - seems OK<br>MSVCRT.DLL 6.10.8924.0 00060001 22DC0000 - .10.&lt;&gt;0001 !!!<br>FM20.DLL 2.01 00020001 17E00001 - what's that 17E00001?<br>COMDLG32.OCX 6.00.8418 00060000 00540012 - .8418 together?<br>IO.OCX 1.11 00010001 00010000 - .11 together?<br><br>Can anybody explain these irregularities to me? :igor:</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Sunjammer</span><br><span class="post-time small text-muted">26th July 2002 14:42 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">There is at least three ways to obtain the version information about a file using Windows (at a programming level) so it can get confusing. I don't have time to investigate fully but as a quick alternative you might try <a href="http://www.clantpa.co.uk/nsis/x18sysinfoV0.0.zip" target="_blank">http://www.clantpa.co.uk/nsis/x18sysinfoV0.0.zip</a> which I wrote a while back. It allows you to get the following information (using msvcrt.dll as an example) :-<br><br>Method One:<br>GetDllVersion is not supported by msvcrt.dll but for files that do support it it returns Version, Build and Platform.<br><br>Method Two:<br>via the dll method GetFileVersion().<br>6.1.9359.0<br><br>Method Three:<br>via the dll method GetFileVersionValue().<br><br>Company Name: Microsoft Corporation<br>File Description: Microsoft (R) C Runtime Library<br>File Version: 6.10.9359.0<br>Internal Name: MSVCRT.DLL<br>LegalCopyright: Copyright (C) Microsoft Corp. 1981-1999<br>Original Filename: MSVCRT.DLL<br>Product Name: Microsoft (R) Visual C++<br>Product Version: 6.10.9359.0<br><br>Now I haven't looked at this for a while but what interests me is that methods two and three return slightly different numbers as you noticed. Maybe you can use the third method in my dll to always obtain the correct number.<br><br>[edit]<br>Just tried it on comdlg32.ocx and I get back :-<br>Method One: Not supported<br>Method Two: 6.0.84.18<br>Method Three: 6.00.8418<br>[/edit]</p></div><hr><div class="footer"><p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p></div></div><script src="../js/highlight.pack.js" type="text/javascript"></script><script type="text/javascript">//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]></script></body></html>