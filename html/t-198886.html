<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="Using MSDOS-Commandline commands in NSIS" />

  <title>Using MSDOS-Commandline commands in NSIS - NSIS Forums</title><!-- Bootstrap core CSS -->
  <link rel="stylesheet" type="text/css" href="//netdna.bootstrapcdn.com/bootswatch/3.0.1/readable/bootstrap.min.css" />
  <link rel="stylesheet" href="../css/style.css" type="text/css" /><!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!--[if lt IE 9]>
                <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
                <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->
</head>

<body>
  <div class="container">
    <!-- Put navigation bar here -->

    <ol class="breadcrumb">
      <li><a href="../index.html" class="glyphicon glyphicon-home"></a></li>

      <li><a href="f-65.html">NSIS Discussion</a></li>

      <li class="active">Using MSDOS-Commandline commands in NSIS</li>
    </ol>

    <p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=198886">Using MSDOS-Commandline commands in NSIS</a></p><br />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">bgosalci</span><br />
      <span class="post-time small text-muted">10th November 2004 15:31 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>Using MSDOS-Commandline commands in NSIS</strong><br />
      I would like to know how could I execute MSDOS commands in .nsi script. Is it possible to do this or not, if no what can I use instead to achieve the same results.<br />
      <br />
      Thanks in advance.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">rsegal</span><br />
      <span class="post-time small text-muted">10th November 2004 16:11 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Take a look in the documentation for Exec, ExecShell and ExecWait. I would gather one of those functions should be able to do what you want.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">bgosalci</span><br />
      <span class="post-time small text-muted">10th November 2004 16:23 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Exec or ExecWait: Executes the specified program and continue immediately. Note that the file specified must exist on the target system, not the compiling system. $OUTDIR is used for the working directory.<br />
      <br />
      Eg.<br />
      <br />
      ExecWait 'MSDE 2000A\setup.exe SAPWD=pas INSTANCENAME=MyInstance TARGETDIR="$INSTDIR\MSDE 2000A\" /qn'<br />
      <br />
      Exec command executes programs .exe or any other extension.<br />
      What i would like to know is how could I execute this command in NSIS script:<br />
      <br />
      ,%CATALINA_HOME%\bin\tomcat.exe -install My-Tomcat %JAVA_HOME%\jre\bin\server\jvm.dll -Djava.class.path=%CATALINA_HOME%\bin\bootstrap.jar;%JAVA_HOME%\lib\tools.jar -Djava.endorsed.dirs=%CATALINA_HOME%\common\endorsed -Dcatalina.home=%CATALINA_HOME% -server -Xms128m -Xmx512m -Xrs -start org.apache.catalina.startup.BootstrapService -params start -stop org.apache.catalina.startup.BootstrapService -params stop -out %CATALINA_HOME%\logs\stdout.log -err %CATALINA_HOME%\logs\stderr.log,</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
      <span class="post-time small text-muted">10th November 2004 17:49 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Why not make a batch file and execute that?<br />
      <br />
      -Stu</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Takhir</span><br />
      <span class="post-time small text-muted">10th November 2004 17:54 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">nsExec plug-in also can hide DOS window and redirects output to log file or stack. Please read NSIS/Contrib/nsExec/nsExec.txt for command line format. You will need to replace %% parameters with NSIS script variables.<br />
      I see very long command lines (line) in your post and this may even increase with real paths instead of %%, please note - Windows defines MAX_PATH = 260 characters.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">bgosalci</span><br />
      <span class="post-time small text-muted">10th November 2004 18:21 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">How would I execute the following commandline command using nsExec::Exec:<br />
      <br />
      'osql -E -SserverName\LA \<br />
      RESTORE DATABASE MyDatabase \<br />
      FROM DISK = 'C:\LA\MSDE 2000A\Backup\MyDatabase ' \<br />
      WITH RECOVERY, \<br />
      MOVE "MyDatabase_Data" TO "C:\LA\MSDE 2000A\MSSQL$LA\Data\MyDatabase.mdf", \<br />
      MOVE "MyDatabase_Log" TO "C:\LA\MSDE 2000A\MSSQL$LA\Data\MyDatabase.ldf" \<br />
      GO'<br />
      <br />
      Is it simply executed as follows:<br />
      <br />
      nsExec::Exec 'osql -E -SserverName\LA \<br />
      RESTORE DATABASE MyDatabase \<br />
      FROM DISK = 'C:\LA\MSDE 2000A\Backup\MyDatabase ' \<br />
      WITH RECOVERY, \<br />
      MOVE "MyDatabase_Data" TO "C:\LA\MSDE 2000A\MSSQL$LA\Data\MyDatabase.mdf", \<br />
      MOVE "MyDatabase_Log" TO "C:\LA\MSDE 2000A\MSSQL$LA\Data\MyDatabase.ldf" \<br />
      GO'</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
      <span class="post-time small text-muted">10th November 2004 19:39 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Yes, but will it always be C:\LA\... on the user's system?<br />
      If it isn't then you should substitute it for a variable which will contain the path either entered by the user or for example read from the registry.<br />
      <br />
      -Stu</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">bgosalci</span><br />
      <span class="post-time small text-muted">10th November 2004 22:49 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">OK, so the correct way of using nsExec::Exec command will be, as follows:<br />
      <br />
      nsExec::Exec 'osql -E -S$ServerName\LA \<br />
      RESTORE DATABASE MyDatabase \<br />
      FROM DISK = $InstDir\MSDE 2000A\Backup\MyDatabase ' \<br />
      WITH RECOVERY, \<br />
      MOVE "MyDatabase_Data" TO "$InstDir\MSDE 2000A\MSSQL$LA\Data\MyDatabase.mdf", \<br />
      MOVE "MyDatabase_Log" TO "$InstDir\MSDE 2000A\MSSQL$LA\Data\MyDatabase.ldf" \<br />
      GO'<br />
      <br />
      Yer or No<br />
      <br />
      And by the way thank you very match to all, for all the help.</p>
    </div>
    <hr />

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]>
  </script>
</body>
</html>
