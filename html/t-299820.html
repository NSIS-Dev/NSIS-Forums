<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="NSIS CopyFiles" />

  <title>NSIS CopyFiles - NSIS Forums</title>
  <script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script>
  <!-- Bootstrap core CSS -->

  <link rel="stylesheet" type="text/css" href="//netdna.bootstrapcdn.com/bootswatch/3.0.1/readable/bootstrap.min.css" />
  <link rel="stylesheet" href="../css/style.css" type="text/css" /><!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!--[if lt IE 9]>
                <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
                <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->
</head>

<body>
  <div class="container">
    <!-- Put navigation bar here -->

    <ol class="breadcrumb">
      <li><a href="../index.html" class="glyphicon glyphicon-home"></a></li>

      <li><a href="f-65.html">NSIS Discussion</a></li>

      <li class="active">NSIS CopyFiles</li>
    </ol>

    <p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=299820">NSIS CopyFiles</a></p><br />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Russell81</span><br />
      <span class="post-time small text-muted">12th November 2008 11:14 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>NSIS CopyFiles</strong><br />
      Hi,<br />
      I am doing one istaller with NSIS and i need to copy a file from previously installed program. I managed to do that and the file destination is desktop. But the question is that, is it possible that installer will ask where to paste that copyed file? Please help me if possible.<br />
      <br />
      Russell</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Red Wine</span><br />
      <span class="post-time small text-muted">12th November 2008 12:20 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Yea it's possible, you'd need to build and add a custom dialog (page), before the InstFiles page.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Russell81</span><br />
      <span class="post-time small text-muted">12th November 2008 13:10 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Hello there,<br />
      Anybody has time to say more details!! Thanks for the reply.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Russell81</span><br />
      <span class="post-time small text-muted">12th November 2008 13:35 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Or it possible to send the copied file to usb memory stick?<br />
      CopyFiles "$Source" "$Destination"<br />
      So i did like this:<br />
      CopyFiles "$C:\...." "$DESKTOP"<br />
      But I want that it will promt that where to save the file. or go to usb memory stick.<br />
      Please help.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">LoRd_MuldeR</span><br />
      <span class="post-time small text-muted">13th November 2008 17:10 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">You must get the desired location into $Destination somehow <i>before</i> calling CopyFiles. I guess you'd better do this before proceeding to the "instfiles" page. You should use a "custom" page as suggested by Red Wine. First of all have a look at section "2.3.2 Pages" and "4.5.4 Page" in the NSIS manual! Then you must learn how to actually create a custom page, either via InstallOptions(Ex) or via nsDialogs. Have a look at "NSIS\Docs\InstallOptions\Readme.html", "NSIS\Docs\InstallOptionsEx\Readme.html" or "NSIS\Docs\nsDialogs\Readme.html". On your custom page you simply put a "DirRequest" control, which allows the user to choose the desired folder...<br />
      <br />
      There are also examples in the "NSIS\Examples" folder ;)</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Russell81</span><br />
      <span class="post-time small text-muted">17th November 2008 12:12 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Thanks for reply. But seems to be so difficult to do.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">LoRd_MuldeR</span><br />
      <span class="post-time small text-muted">17th November 2008 15:10 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"></p>

      <blockquote>
        <i>Originally posted by Russell81</i><br />
        <b>Thanks for reply. But seems to be so difficult to do.</b>
      </blockquote>In fact it's not that hard ;)<br />
      <br />
      Look at the docs or simply adapt one of the example files...
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">nsnb</span><br />
      <span class="post-time small text-muted">17th November 2008 15:53 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"></p>

      <blockquote>
        <i>Originally posted by LoRd_MuldeR</i><br />
        <b>On your custom page you simply put a "DirRequest" control, which allows the user to choose the desired folder...<br />
        <br />
        There are also examples in the "NSIS\Examples" folder ;)</b>
      </blockquote>LoRd_MuldeR, I am also facing a similar challenge (ask the end user select a directory). I found the examples you were referring to for InstallOptions, but I prefer using the nsDialog approach.<br />
      <br />
      Which means that, instead of a "DirRequest" control inside a custom dialog, I am using NSIS's pre-made nsDialogs::SelectFolderDialog.<br />
      <br />
      However, I am having some weird problems, as described in <a href="http://forums.winamp.com/showthread.php?s=&amp;threadid=300008" target="_blank">this post</a>. Apparently it's not that simple - or it is simple but I am missing something really fundamental.<br />
      <br />
      Any suggestion as to how to proceed from here? Perhaps I should have taken the DirRequest approach?
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">LoRd_MuldeR</span><br />
      <span class="post-time small text-muted">17th November 2008 16:29 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">What is the "nsDialogs::Show" at the end of your "PageDirSelect" function supposed to do?<br />
      <br />
      Is it needed with nsDialogs::SelectFolderDialog ??? :confused:<br />
      <br />
      (I'm not at home right now, so I cannot test it from here - no NSIS)</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">nsnb</span><br />
      <span class="post-time small text-muted">17th November 2008 18:32 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"></p>

      <blockquote>
        <i>Originally posted by LoRd_MuldeR</i><br />
        <b>What is the "nsDialogs::Show" at the end of your "PageDirSelect" function supposed to do?<br />
        <br />
        Is it needed with nsDialogs::SelectFolderDialog ??? :confused:<br />
        <br />
        (I'm not at home right now, so I cannot test it from here - no NSIS)</b>
      </blockquote>Wow! You were right on the money :up: - I just commented out that nsDialogs::Show line and all works now perfectly. :)<br />
      <br />
      Thank you so much, LoRd_MuldeR! I will now post the solution in the other thread as well, so that it may help others in the future.
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">LoRd_MuldeR</span><br />
      <span class="post-time small text-muted">18th November 2008 02:16 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"></p>

      <blockquote>
        <i>Originally posted by nsnb</i><br />
        <b>I just commented out that nsDialogs::Show line and all works now perfectly. :)</b>
      </blockquote>"One of my most productive days was throwing away 1000 lines of code."<br />
      - Ken Thompson
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Russell81</span><br />
      <span class="post-time small text-muted">18th November 2008 06:29 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">I have a code that is making an installer with some normal pages such as:WELCOME,COMPONETNS,DIRECTORY,INSTFILES AND FINISH. So what i am trying to do is that after WELCOME page i need to copy a file from previous installed SW and save it somewhere. And wishing that installer will copy it and ask the user where to save. After saving that file in desired place the COMPONENTS page will appear and go forward. So do i need to do i need to make a totally separate page and call it somehow for saving file or i can make a custom page between WELCOME and COMPONENTS page? I am so out of my knowledge. Help......</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">LoRd_MuldeR</span><br />
      <span class="post-time small text-muted">18th November 2008 16:16 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Since you mention "Welcome" and "Finish" pages, I have to assume you user MUI or MUI2. So simply put an addtional "custom" page between the MUI_WELCOME_PAGE and MUI_COMPONENTS_PAGE macros, just like:<br />
      <br /></p>
      <pre>
<code>  !insertmacro MUI_PAGE_WELCOME<br />  Page custom MyCustomPageFun<br />  !insertmacro MUI_PAGE_COMPONENTS<br />  !insertmacro MUI_PAGE_DIRECTORY<br />  !insertmacro MUI_PAGE_INSTFILES<br />  !insertmacro MUI_PAGE_FINISH</code>
</pre><br />
      <br />
      Then let your custom page show the dialog box:<br />
      <br />
      <pre>
<code>Var varSelectedFolder<br /><br />Function MyCustomPageFun<br />  !insertmacro MUI_HEADER_TEXT $(PAGE_TITLE) $(PAGE_SUBTITLE)<br /><br />  FolderForceSelection:<br />  nsDialogs::SelectFolderDialog /NOUNLOAD "Select Folder" "$DOCUMENTS"<br />  Pop $varSelectedFolder    ;where selected folder string is returned<br /><br />  ; Check A Folder Has Been Selected<br />  StrCmp $varSelectedFolder "error" 0 FolderWasSelected<br />  MessageBox MB_OK|MB_ICONWARNING "You must select a folder a folder!"<br />  Goto FolderForceSelection<br /><br />  FolderWasSelected:<br />FunctionEnd</code>
</pre>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Russell81</span><br />
      <span class="post-time small text-muted">19th November 2008 09:55 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Thanks for the details and helpful reply. I am glad you loan me some knowledge from you.<br />
      So I make this custom page and need to use this custom page for saving a file which is copied by command "CopyFiles". So the idea is that i wish to use this custom page for saving that copied file to my desired destination.<br />
      CopyFiles "$Source" "$Destination". Do you suggest me that i can use this custom page as a destination somehow.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">LoRd_MuldeR</span><br />
      <span class="post-time small text-muted">19th November 2008 20:49 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">In fact you only use the "custom" page to display the SelectFolder dialog and let the user choose the desired destination folder. That folder will be stored in $varSelectedFolder and can be used at a later time. For example you can call CopyFiles in one of your install sections and use the target folder obtained before (it's still stored in $varSelectedFolder, unless you overwrote it ^^).</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Russell81</span><br />
      <span class="post-time small text-muted">20th November 2008 11:44 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Do u think, it is possible to choose "USB Memory stick" as a destination folder? For example if i choose the memory stick from the custom window and use that as a destination when i call CopyFiles.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">LoRd_MuldeR</span><br />
      <span class="post-time small text-muted">20th November 2008 13:29 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"></p>

      <blockquote>
        <i>Originally posted by Russell81</i><br />
        <b>Do u think, it is possible to choose "USB Memory stick" as a destination folder? For example if i choose the memory stick from the custom window and use that as a destination when i call CopyFiles.</b>
      </blockquote>Why not? :confused:
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Russell81</span><br />
      <span class="post-time small text-muted">20th November 2008 20:23 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">So what i will right on the desttination?<br />
      CopyFiles "$Source" "$?????" if i like to choose memory stick?<br />
      Sorry for bothering you.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">LoRd_MuldeR</span><br />
      <span class="post-time small text-muted">20th November 2008 20:30 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">If you use the code above, the folder selected by the user (via "Browse for Folder" dialog on the "custom" page) will be stored in $varSelectedFolder. That folder may or may not be located on an USB Memory Stick, depending on the user's choice. Anyways you can copy the files to the selected folder like this:<br />
      <br /></p>
      <pre>
<code>Section "Some Section"<br />  CopyFiles "$Source" "$varSelectedFolder"<br />SectionEnd</code>
</pre><br />
      <br />
      (Given that the correct source folder is stored in $Source already)
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Russell81</span><br />
      <span class="post-time small text-muted">21st November 2008 06:30 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Thanks for the guide. I am so glad. I am quite new in this field that's why i am always bothering you.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Russell81</span><br />
      <span class="post-time small text-muted">5th December 2008 09:55 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Is there any way to check how many processor in pc by NSIS script?</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Anders</span><br />
      <span class="post-time small text-muted">5th December 2008 16:35 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"></p>

      <blockquote>
        <i>Originally posted by Russell81</i><br />
        <b>Is there any way to check how many processor in pc by NSIS script?</b>
      </blockquote>How is this related to copyfiles? Take a look on the wiki, maybe you'll find something
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Russell81</span><br />
      <span class="post-time small text-muted">8th December 2008 12:08 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Really?</p>
    </div>
    <hr />

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]>
  </script>
</body>
</html>
