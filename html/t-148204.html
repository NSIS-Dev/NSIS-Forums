<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="Upgrade dll problem" />

  <title>Upgrade dll problem - NSIS Forums</title>
  <script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script>
  <!-- Bootstrap core CSS -->

  <link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css" />
  <link rel="stylesheet" href="../css/style.css" type="text/css" /><!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!--[if lt IE 9]>
                <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
                <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->
</head>

<body>
  <div class="container">
    <!-- Put navigation bar here -->

    <ol class="breadcrumb">
      <li><a href="../index.html" class="glyphicon glyphicon-home"></a></li>

      <li><a href="f-65.html">NSIS Discussion</a></li>

      <li class="active">Upgrade dll problem</li>
    </ol>

    <p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=148204">Upgrade dll problem</a></p><br />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">yehiaeg</span><br />
      <span class="post-time small text-muted">5th September 2003 10:18 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>Upgrade dll problem</strong><br />
      hello,<br />
      i am trying to use the UpgradeDll macro, i copy and paste it in an "UpgradeDll.nsi"<br />
      <br />
      but there is always this error:<br />
      <br />
      GetTempFileName expects 1 parameters, got 2.<br />
      Usage: GetTempFileName $(user_var: name output)<br />
      Error in macro UpgradeDLL on macroline 43<br />
      Error in script "C:\Yehia\Developement\VB\mycss\Setup\Setup.nsi" on line 42 -- aborting creation process<br />
      <br />
      but i think i am writing the roght parameter:<br />
      bla...<br />
      !include "UpgradeDll.nsi"<br />
      bla...<br />
      !insertmacro UpgradeDLL "C:\yehia\Developement\VB\mycss\Setup\RichTx32.ocx" "$SYSDIR\RichTx32.ocx" "$SYSDIR"<br />
      <br />
      so what's the problem?<br />
      i attached the setup if this would help.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
      <span class="post-time small text-muted">5th September 2003 11:22 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">You're using a new function with an old NSIS. The UpgradeDLL from the online manual is built for the latest CVS version of NSIS, it won't work with b3. For more information about getting the latest CVS version see <a href="http://nsis.sf.net/" target="_blank">http://nsis.sf.net/</a></p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">yehiaeg</span><br />
      <span class="post-time small text-muted">5th September 2003 12:16 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">ok, i updated the english language file and makensis.exe and makensisw.exe and the modernui system file,<br />
      <br />
      but the compiler found another error:<br />
      !insertmacro: MUI_SECTIONS_FINISHHEADER<br />
      !insertmacro: macro named "MUI_SECTIONS_FINISHHEADER" not found!<br />
      Error in script "C:\Yehia\Developement\VB\mycss\Setup\Setup.nsi" on line 91 -- aborting creation process<br />
      <br />
      is this mui_sections_finishheader was removed in the new version?</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
      <span class="post-time small text-muted">5th September 2003 12:19 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">When updating from CVS you should update everything, not just some of the files. If you don't, you'd get weird errors such as the one you got from UpgradeDLL.<br />
      <br />
      Yes, MUI_SECTIONS_FINISHHEADER is no longer needed. There are many more changes, it would be best to just re-read the MUI readme. Also read <a href="http://forums.winamp.com/showthread.php?s=&amp;threadid=148146" target="_blank">this</a>.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">yehiaeg</span><br />
      <span class="post-time small text-muted">5th September 2003 13:02 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">another stupid question, in the upgrade dll there a coment saying<br />
      ;If you want to support Win9x, you can only use short filenames<br />
      ; (8.3).<br />
      <br />
      this means that this wouldn't work<br />
      !insertmacro UpgradeDLL "C:\yehia\Developement\VB\mycss\Setup\eSellerateEngine.dll" "$WINDIR\eSellerateEngine.dll" "$SYSDIR ???</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
      <span class="post-time small text-muted">5th September 2003 13:09 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Indeed. This won't work as you expect on Windows 9x. If eSellerateEngine.dll is in use while the installer is running then it will be deleted on reboot and the new file will be named something like eSelle~1.dll. This is a limitation of Windows 9x.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">yehiaeg</span><br />
      <span class="post-time small text-muted">5th September 2003 13:22 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">another question:<br />
      what happened to !define MUI_BRANDINGTEXT " " , it isn't working anymore</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
      <span class="post-time small text-muted">5th September 2003 13:26 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">MUI no longer sets the branding text. You can use BrandingText as with normal scripts now.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">yehiaeg</span><br />
      <span class="post-time small text-muted">5th September 2003 13:30 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">thanks, anywhere to find a list of what modification were made to the script language?<br />
      <br />
      <br />
      thanks again for the help</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
      <span class="post-time small text-muted">5th September 2003 13:35 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Yep:<br />
      <br />
      <a href="http://forums.winamp.com/showthread.php?s=&amp;threadid=148146" target="_blank">http://forums.winamp.com/showthread....hreadid=148146</a></p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">yehiaeg</span><br />
      <span class="post-time small text-muted">5th September 2003 13:38 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">thanks again and again<br />
      u' re a very helpful guy</p>
    </div>
    <hr />

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]>
  </script>
</body>
</html>
