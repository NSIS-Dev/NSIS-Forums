<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="Logging Install Type" />

  <title>Logging Install Type - NSIS Forums</title><!-- Bootstrap core CSS -->
  <link rel="stylesheet" type="text/css" href="//netdna.bootstrapcdn.com/bootswatch/3.0.1/readable/bootstrap.min.css" />
  <link rel="stylesheet" href="../css/style.css" type="text/css" /><!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!--[if lt IE 9]>
                <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
                <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->
</head>

<body>
  <div class="container">
    <!-- Put navigation bar here -->

    <ol class="breadcrumb">
      <li><a href="../index.html" class="glyphicon glyphicon-home"></a></li>

      <li><a href="f-65.html">NSIS Discussion</a></li>

      <li class="active">Logging Install Type</li>
    </ol>

    <p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=103134">Logging Install Type</a></p><br />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">ViperInc</span><br />
      <span class="post-time small text-muted">2nd September 2002 08:43 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>Logging Install Type</strong><br />
      hi.<br />
      <br />
      quick question.<br />
      i want to make a regkey or something, which will let the installer resume after a restart, and continue to install the software, depending on what seting the user specified befour<br />
      eg. InstType 1, or InstType 2, etc.<br />
      <br />
      is there any easy way to do this???<br />
      <br />
      ive had an attempt, but doesnt work to well...<br />
      well, not at all<br />
      hehe...<br />
      <br />
      thanx</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
      <span class="post-time small text-muted">2nd September 2002 10:11 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">You can always log each section's state using SectionGetFlags, but if you want to log the install type (make sure there is no custom option), make a hidden section for each install type and make it write to the registry the install type.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">ViperInc</span><br />
      <span class="post-time small text-muted">2nd September 2002 10:37 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">that was the plan.<br />
      <br />
      is there a number assocated with the instType or something???<br />
      <br />
      the program is getting the value, 1, 2 or 3.<br />
      how do i get it?<br />
      what variable is assigned the value?</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
      <span class="post-time small text-muted">2nd September 2002 10:41 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Each type is numbered, starting at 1.<br />
      Currently there is no easy way to get it, you will have to remember it :)</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">ViperInc</span><br />
      <span class="post-time small text-muted">3rd September 2002 07:13 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">so basically, nsis doesnt hav a variable which stores this info.<br />
      i hav to get each section to make a line in the registry, or something like that???</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
      <span class="post-time small text-muted">3rd September 2002 11:27 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Yes, SectionGetFlags for each section you want to save.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">ViperInc</span><br />
      <span class="post-time small text-muted">4th September 2002 07:26 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">ah, of corse...<br />
      <br />
      thanks for that.<br />
      <br />
      so with this i can store what InstTpye the user sets.<br />
      <br />
      eg.<br />
      <br />
      InstType "Type 1"<br />
      InstType "Type 2"<br />
      InstType "Type 3"<br />
      <br />
      Section "Standard (Required)"<br />
      SectionEnd<br />
      <br />
      Section "Section2"<br />
      SectionIn 2<br />
      SectionIn 3<br />
      SectionEnd<br />
      <br />
      Section "Section3"<br />
      SectionIn 1<br />
      SectionIn 2<br />
      SectionEnd<br />
      <br />
      how would i log if the user selcts InstType 1, 2 or InstType 3?</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
      <span class="post-time small text-muted">4th September 2002 08:09 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"></p>

      <blockquote>
        If you want to log the install type (make sure there is no custom option), make a hidden section for each install type and make it write to the registry the install type.
      </blockquote>;)<br />
      <br />
      For example:<br />
      Section ""<br />
      SectionIn 1<br />
      WriteRegStr HKLM "whereever\you\want\to\save" "insttype1" "selected"<br />
      SectionEnd<br />
      <br />
      The problem is that if a user uses a custom selection you won't get the wanted results.<br />
      <br />
      You might want to unselect every hidden section as the above one when you the user selects a custom set of sections. To do this you will have to use a lot of GetSectionFlags to make sure no set install type was selected.<br />
      <br />
      The best way IMHO, is to just save the sections that the user really have installed and not to look on the install types. That is of cousrse, unless you don't allow custom.
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">ViperInc</span><br />
      <span class="post-time small text-muted">4th September 2002 08:16 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">i hav added the /nocustom , so the usre cant allow do a custom selection.<br />
      <br />
      the problem arrise though, is that after each section is called up, on then is a regestry key created.<br />
      so if for example, in section 1, a restart occers, only the section 1 entry wil be saved.<br />
      this means thatupon reboot, when the program resumes, it cant detect which instType was selected.<br />
      i guess i should hav mensioned this befour... sorry<br />
      <br />
      so, basically , i need to create a key just after the user selects the instaype and selects install. but, it seems that its not possible. or am i wrong again???</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
      <span class="post-time small text-muted">4th September 2002 08:35 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">It is possible, but not that simple. You will have to use the .onNextPage callback after the components are selected, and use a lot of SectionGetFlags in it to find out which InstType was selected.<br />
      <br />
      A small trick that could help you would be creating those hidden sections after all and make sure every hidden section is only in one InstType. Then just use SectionGetFlags on every one of those hidden sections to find out which InstType was selected. This way you have only one "if" for every InstType.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">ViperInc</span><br />
      <span class="post-time small text-muted">4th September 2002 08:42 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">yeah, that was my next step...<br />
      well, thanks for your help...<br />
      <br />
      <br />
      much appreciated!</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">ViperInc</span><br />
      <span class="post-time small text-muted">4th September 2002 08:56 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">ok, ive just started to add in the hidden stuff... but<br />
      <br />
      it seems that any hidden section is automatically caleld upon, where its specifed or not, or so it seems from the nsis docu's<br />
      <br />
      or is that only for un-named sections????<br />
      eg, if i do what i hav below, will it run all of then, or aonly the ones that i call???<br />
      <br />
      Section "-hidden1"<br />
      sectionin 1<br />
      do stuff<br />
      make reg string<br />
      SectionEnd<br />
      <br />
      Section "-hidden2"<br />
      sectionin 2<br />
      do stuff<br />
      make reg string<br />
      SectionEnd<br />
      <br />
      Section "-hidden3"<br />
      sectionin 3<br />
      do stuff<br />
      make reg string<br />
      SectionEnd</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
      <span class="post-time small text-muted">4th September 2002 09:04 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Hmm... I can quite test it now because I am not at home, and I can't install NSIS here. I will answer you later unless someone answers before me ;)</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">ViperInc</span><br />
      <span class="post-time small text-muted">4th September 2002 09:09 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">ok, never mind, i hav found a solution..<br />
      <br />
      agian thanks!</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
      <span class="post-time small text-muted">4th September 2002 09:30 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Care to share?</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">ViperInc</span><br />
      <span class="post-time small text-muted">5th September 2002 07:13 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">um,<br />
      <br />
      i just made each section hav its own installation stuff, so i dont hav to move threw sections..<br />
      then on restarts, i just chek the reg, befour the program luchnes, then the setup continues, and bypasses all the NSIS prgram front and so forth...<br />
      <br />
      quite happy with myself now...</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Dizzy007</span><br />
      <span class="post-time small text-muted">31st October 2002 15:28 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">I have had the same problem ..<br />
      <br />
      This is a "workaround" :<br />
      -----<br />
      Section "Choice 1"<br />
      SectionIn 1<br />
      WriteIniStr "$TEMP\iniC.ini" "Section" "Choice" 1<br />
      SectionEnd<br />
      Section "Choice 2"<br />
      SectionIn 2<br />
      WriteIniStr "$TEMP\iniC.ini" "Section" "Choice" 2<br />
      SectionEnd<br />
      Section "Choice 3"<br />
      SectionIn 3<br />
      WriteIniStr "$TEMP\iniC.ini" "Section" "Choice" 3<br />
      SectionEnd<br />
      Section "Choice 4"<br />
      SectionIn 4<br />
      WriteIniStr "$TEMP\iniC.ini" "Section" "Choice" 4<br />
      SectionEnd<br />
      Section "Choice other"<br />
      SectionIn 5<br />
      WriteIniStr "$TEMP\iniC.ini" "Section" "Choice" 5<br />
      SectionEnd<br />
      ----<br />
      So, i wrote the InstType section to my ini - available at every time ..<br />
      <br />
      :D<br />
      <br />
      Greets<br />
      Dizzy</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
      <span class="post-time small text-muted">31st October 2002 15:33 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">In the latest CVS version invisibile sections can also use SectionIn, so you can use that too.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">virtlink</span><br />
      <span class="post-time small text-muted">1st November 2002 13:42 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"></p>

      <blockquote>
        let the installer resume after a restart, and continue to install the software
      </blockquote>I don't know if you know this already:o, but if you write to this registry key:<br />
      HKEY_LOCAL_MACHINE/Software/Microsoft/Windows/CurrentVersion/RunOnce<br />
      ...and you make a new key or string (I can check right now) with the name of your program and the setup-path as the value, It should be started on Windows startup, but only once.
    </div>
    <hr />

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]>
  </script>
</body>
</html>
