<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="description" content="Refreshing Enviroment Variables"><title>Refreshing Enviroment Variables - NSIS Forums</title><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script><link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css"><link rel="stylesheet" href="../css/style.css" type="text/css"><!--[if lt IE 9]><script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script><script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script><![endif]--></head><body><div class="container"><ol class="breadcrumb"><li><a href="../index.html" class="glyphicon glyphicon-home"></a></li><li><a href="f-65.html">NSIS Discussion</a></li><li class="active">Refreshing Enviroment Variables</li></ol><p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=345839">Refreshing Enviroment Variables</a></p><br><div class="post"><p class="post-meta"><span class="post-author text-primary">mista-birdy</span><br><span class="post-time small text-muted">27th June 2012 15:42 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>Refreshing Enviroment Variables</strong><br>Hi all,<br>I'm started to work with NSIS. It's a great installer.<br>But I need a little help.<br><br>After installing SQL Server, the command <b>sqlcmd</b> should be available for calling from commandprompt. Because SQL Server add the Commandtool Path to Enviroment Vars.<br><br>But it i can't just call sqlcmd. I have to call the full path.<br>I think it's because NSIS have the old enviroments vars in cache.<br><br>How can I refresh this cache so that i can just call<br></p><pre>
<code>ExecWait 'SQLCMD ...' </code>
</pre>?</div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Brummelchen</span><br><span class="post-time small text-muted">27th June 2012 17:44 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">nsis works "life" and dont cache anything - its on your system.<br><br>either you use the PATH-Variable for those commands (dos command) or AppPath in registry.<br><a href="http://msdn.microsoft.com/en-us/library/windows/desktop/ee872121%28v=vs.85%29.aspx" target="_blank">http://msdn.microsoft.com/en-us/libr...=vs.85%29.aspx</a><br><br>HTH</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">msroboto</span><br><span class="post-time small text-muted">27th June 2012 21:29 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Right but let's say you change the PATH even manually no current running program, Command Prompt or NSIS installer will pick that up automatically without being restarted.<br><br>You can test that by opening a command prompt then changing your PATH.<br>The PATH is not reflected in that command prompt but if you open a new command prompt the new PATH or other environment variable will be available.<br><br>So the short answer is short of restarting the installer or starting a new installer you won't have access to the new PATH or other ENV variables.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br><span class="post-time small text-muted">28th June 2012 00:12 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Indeed environment variables are copied for each process on launch and therefore is up to that process to update its own environment variables if required. To do this you can use SetEnvironmentVariable in Kernel32.dll:<br><a href="http://nsis.sourceforge.net/Setting_Environment_Variables_to_Active_Installer_Process" target="_blank">http://nsis.sourceforge.net/Setting_...taller_Process</a><br><br>(Note that page uses SetEnvironmentVariableA - it should just be SetEnvironmentVariable - System plug-in calls SetEnvironmentVariableA or SetEnvironmentVariableW accordingly).<br><br>Stu</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Anders</span><br><span class="post-time small text-muted">28th June 2012 00:13 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"></p><blockquote><small>Originally posted by msroboto</small><br>no current running program, Command Prompt or NSIS installer will pick that up automatically without being restarted.</blockquote>Explorer picks up the new path...</div><hr><div class="footer"><p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p></div></div><script src="../js/highlight.pack.js" type="text/javascript"></script><script type="text/javascript">//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]></script></body></html>