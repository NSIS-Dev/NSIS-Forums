<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="Internet Component Download problem" />

  <title>Internet Component Download problem - NSIS Forums</title>
  <script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script>
  <!-- Bootstrap core CSS -->

  <link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css" />
  <link rel="stylesheet" href="../css/style.css" type="text/css" /><!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!--[if lt IE 9]>
                <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
                <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->
</head>

<body>
  <div class="container">
    <!-- Put navigation bar here -->

    <ol class="breadcrumb">
      <li><a href="../index.html" class="glyphicon glyphicon-home"></a></li>

      <li><a href="f-65.html">NSIS Discussion</a></li>

      <li class="active">Internet Component Download problem</li>
    </ol>

    <p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=155841">Internet Component Download problem</a></p><br />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">zany</span><br />
      <span class="post-time small text-muted">11th November 2003 09:04 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>Internet Component Download problem</strong><br />
      I have a little problem and maybe someone here can help me out.<br />
      <br />
      What I'm trying to accomplish is an installer which would be automatically invoked from the internet.<br />
      <br />
      So far I've created an installer with NSIS, packaged it inside a signed cab along with an INF file which uses a hook to launch the installer executable. Part of the problem might be that my application is not an ActiveX component, but a plain Windows executable.<br />
      <br />
      I'm writing the install information to HKCU branch to make it easier to remove the app if/when a particular user is deleted.<br />
      <br />
      Everything else works fine except that I can't uninstall the application properly using the uninstaller. To be more specific, Windows places a copy of my inf file to WINDOWS/Downloaded Program Files as well as writes registry entries under HKLM/Software/Microsoft/Code Store Database.<br />
      <br />
      I tried to delete the inf file, which results in Windows thinking the installation is broken. However, it does not attempt to install it again when I hit the page with the object tag pointing to my cab.<br />
      <br />
      If I go on and delete the registry key under the HKLM key mentioned above my installer will be invoked again, but do I violate the "current user only" policy by deleting this key?<br />
      <br />
      I've thought about making my application to support a few com interfaces and registering the component, but am I missing a point here?<br />
      <br />
      All I want to do is to be able to distribute the installer via internet (launch it using the object tag) and deploy the application for the current user to avoid problems with people not having admin/power user privileges.<br />
      <br />
      All ideas more than welcome.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
      <span class="post-time small text-muted">11th November 2003 10:43 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Isn't there a special way to uninstall just like there is a special way to install? What happens if you go to Windows\Downloaded Program Files and manually delete the "file"? Doesn't it call your uninstaller?<br />
      <br />
      MSDN should probably answer this best if no one has a definite answer.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">zany</span><br />
      <span class="post-time small text-muted">11th November 2003 10:57 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Well, the inf documentation is quite wide-spread along MSDN and MSI archives seem to be the preferred way to do it. Finding a definitve answer hasn't caught my eyes as of writing.<br />
      <br />
      My installation is not that special, if you have a look at Sun's JRE installer, it's very much the same, although my executable is NSIS installer.<br />
      <br />
      Downloaded Program Files is a special folder and as such, it displays the 'files' differently. Righ-clickin on an item would bring a choice of Update/Remove and remove deletes the inf file in this directory as well as deletes the associated registry entries.<br />
      <br />
      One way might be to use ShellExecute with Remove as the command.<br />
      <br />
      Deleting the inf file from the Downloaded Program Files only changes the status of my installation to broken and does not uninstall anything.<br />
      <br />
      I've written installations before, but I'm new to this internet thingy, so I might be looking for the ansfer from all the wrong places.<br />
      <br />
      Hopefully someone who has done this before can point me to right track.</p>
    </div>
    <hr />

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]>
  </script>
</body>
</html>
