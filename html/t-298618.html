<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="description" content="[NSIS 2.40] filling the installation window with a picture"><title>[NSIS 2.40] filling the installation window with a picture - NSIS Forums</title><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script><link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css"><link rel="stylesheet" href="../css/style.css" type="text/css"><!--[if lt IE 9]><script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script><script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script><![endif]--></head><body><div class="container"><ol class="breadcrumb"><li><a href="../index.html" class="glyphicon glyphicon-home"></a></li><li><a href="f-65.html">NSIS Discussion</a></li><li class="active">[NSIS 2.40] filling the installation window with a picture</li></ol><p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=298618">[NSIS 2.40] filling the installation window with a picture</a></p><br><div class="post"><p class="post-meta"><span class="post-author text-primary">stopasking</span><br><span class="post-time small text-muted">13th October 2008 00:23 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>[NSIS 2.40] filling the installation window with a picture</strong><br>hi,<br><br>im using NSIS 2.40 and i want to add a bigger size picture on the installation screen. currently, im only able to put that size:<br><br><a href="http://home.arcor.de/davied/Bilder/IM_INSTALLER.png" target="_blank">http://home.arcor.de/davied/Bilder/IM_INSTALLER.png</a><br><br>but i want the pic to fill the whole page, except the buttons...(that means i dont want any text)<br><br>this, i do with<br><br>!define MUI_WELCOMEFINISHPAGE_BITMAP "Location/of/the/*.bmp"<br><br>can u help me? Thanks . :)</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">ZmAn3</span><br><span class="post-time small text-muted">13th October 2008 00:59 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">one way to do it is in the directory nsis is installed in goto<br>Contrib\Modern UI 2\Pages make a backup of Welcome.nsh<br><br>open the orginal in notepad look for<br>this line<br>;Image control<br>; ${NSD_CreateBitmap} 0u 0u 109u 193u ""<br><br>edit the last 2 numbers 190u is the width and 193u is the height so like the following will make the attached image<br>${NSD_CreateBitmap} 0u 0u 332u 193u ""<br><br><br><br><a href="http://www.emeraldcpu.com/zman3/installer.jpg" target="_blank">http://www.emeraldcpu.com/zman3/installer.jpg</a></p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">stopasking</span><br><span class="post-time small text-muted">13th October 2008 21:46 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">hey,<br><br>thanks for your reply! i want my first page of installation to look exactly like that. i changed the welcome.nsh as u told, but as i compiled my .nsi script after that (which is in an other directory), there was no difference to the pic...<br><br>this is what i used in my script to put the picture...<br><br>!define MUI_WELCOMEFINISHPAGE_BITMAP "C:\Documents and Settings\a\My Documents\NSIS_Menu.bmp"<br><br>but still the same pic as in my first post :(<br>what did i do wrong?</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">ZmAn3</span><br><span class="post-time small text-muted">13th October 2008 21:49 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">is the picture the right size (big enough to fill the window) can u post it</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">stopasking</span><br><span class="post-time small text-muted">13th October 2008 22:02 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"></p><blockquote><i>Originally posted by ZmAn3</i><br><b>is the picture the right size (big enough to fill the window) can u post it</b></blockquote>it is 497x362<br><br>[IMG]<a href="http://img387.imageshack.us/my.php?image=nsismenupp7.png" target="_blank"></a><a href="http://img387.imageshack.us/img387/7894/nsismenupp7.th.png" target="_blank">http://img387.imageshack.us/img387/7...menupp7.th.png</a><a href="http://g.imageshack.us/thpix.php" target="_blank"></a><a href="http://img387.imageshack.us/images/thpix.gif" target="_blank">http://img387.imageshack.us/images/thpix.gif</a>[/IMG]<br><br>here u go...is it enoguh to fill the window?</div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">ZmAn3</span><br><span class="post-time small text-muted">13th October 2008 22:12 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">ya<br><a href="http://www.emeraldcpu.com/zman3/installer.jpg" target="_blank">http://www.emeraldcpu.com/zman3/installer.jpg</a><br><br>so in welcome.nsh under the image control section<br>you should have<br>;Image control<br>; ${NSD_CreateBitmap} 0u 0u 109u 193u ""<br>${NSD_CreateBitmap} 0u 0u 332u 193u ""<br>Pop $mui.WelcomePage.Image<br><br>the one with the ; is the old one</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">stopasking</span><br><span class="post-time small text-muted">13th October 2008 22:51 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">i have done that, but dunno why it isnt doing it like this...<br>maybe it isnt checking the welcome.nsh before compiling? (because the .nsi file, which i compile, is in some other directory)...where did u put the path to the pic in?<br><br>thats my script...<br>;===============================================================================<br>;<br>; G2MDK - DemoMod Setup-Script<br>;<br>; System: NSIS 2.0 <a href="http://nsis.sf.net/" target="_blank">http://nsis.sf.net/</a><br>; Editor: HMNE 2.0 <a href="http://hmne.sf.net/" target="_blank">http://hmne.sf.net/</a><br>;<br>;===============================================================================<br><br><br><br>; Kompressionseinstellungen<br><br>CRCCheck force<br>;SetCompressor lzma<br>;SetCompressorDictSize 128 ; LZMA-Speicherverbrauch, siehe Tabelle<br>; DictSize Compress Decomp<br>; 8 MB 141 MB 10 MB (default)<br>; 12 MB 179 MB 14 MB<br>; 16 MB 217 MB 18 MB<br>; 24 MB 293 MB 26 MB<br>; 32 MB 369 MB 35 MB<br>; 48 MB 521 MB 50 MB<br>; 64 MB 673 MB 66 MB<br>; 96 MB 977 MB 98 MB<br>; 128 MB 1281 MB 130 MB<br>; 192 MB 1889 MB 194 MB<br>;!packhdr "packhdr.tmp" "upx.exe --best packhdr.tmp" ; <a href="http://upx.sf.net/" target="_blank">http://upx.sf.net/</a><br><br><br>; Definitionen<br><br>; TODO: Version der Modifikation<br>!define VER_MAJOR 1 ; Major Version<br>!define VER_MINOR 0 ; Minor Version<br>!define VER_PATCH 0 ; Patch-Version (1=a, ...)<br>!define VER_FLAGS 0 ; Sprachversion<br>!define VER_FILE "${VER_MAJOR}.${VER_MINOR}"<br>!define VER_TEXT "${VER_MAJOR}.${VER_MINOR}"<br><br>; TODO: Eigenschaften der Modifikation<br>!define MOD_FILE "Orkherrschaft" ; Mod-Dateiname (KEINE Leer- oder Sonderzeichen!)<br>!define MOD_NAME "Orkherrschaft" ; Mod-Titel<br>!define MOD_COPY "Copyright Â© 2004, Pluto 13 GmbH" ; Mod-Copyright<br>!define MOD_COMP "SunStars" ; Mod-Herausgeber<br>!define MOD_LINK "http://sunstars.worldofgothic.com" ; Herausgeber-Link<br>!define MOD_HELP "http://www.worldofgothic.de" ; Support-Link<br><br><br>;===============================================================================<br>;<br>; MUI<br>;<br><br><br>!include "MUI.nsh"<br><br><br>Name "${MOD_NAME} ${VER_TEXT}"<br>OutFile "${MOD_FILE}-${VER_FILE}.exe"<br>InstallDir "$PROGRAMFILES\JoWooD\Gothic II\"<br>!define MOD_RKEY "SOFTWARE\Microsoft\Windows\CurrentVersion\Uninstall\${MOD_NAME}"<br>InstallDirRegKey HKLM "${MOD_RKEY}" "InstallLocation"<br>AllowRootDirInstall true<br><br><br>; Konfiguration (Installer)<br><br>!define MUI_WELCOMEPAGE_TITLE_3LINES<br>!define MUI_WELCOMEPAGE_TEXT "Dieser Assistent wird Sie durch die Installation von $(^Name) begleiten.\r\n\r\nEs wird empfohlen vor der Installation alle anderen Programme zu schlieÃŸen.\r\n\r\n$_CLICK"<br><br><br><br>!define MUI_COMPONENTSPAGE_NODESC<br>!define MUI_FINISHPAGE_NOREBOOTSUPPORT<br>!define MUI_FINISHPAGE_TITLE_3LINES<br><br><br><br><br><br><font color="red">!define MUI_WELCOMEFINISHPAGE_BITMAP "C:\Documents and Settings\a\My Documents\NSIS_Menu.bmp"</font><br><br>; Setup-Seiten (Installer)<br><br>!insertmacro MUI_PAGE_WELCOME<br>!insertmacro MUI_PAGE_LICENSE ".\setup\licence.rtf"<br>Page custom PageReinstall PageLeaveReinstall<br>!insertmacro MUI_PAGE_DIRECTORY<br>!insertmacro MUI_PAGE_INSTFILES<br>!insertmacro MUI_PAGE_FINISH<br><br>; Konfiguration (Uninstaller)<br><br>!define MUI_WELCOMEPAGE_TITLE_3LINES<br>!define MUI_WELCOMEPAGE_TEXT "Dieser Assistent wird Sie durch die Deinstallation von $(^Name) begleiten.\r\n\r\nBitte beenden Sie Gothic II und zugehÃ¶rige Tools,\r\nbevor Sie mit der Deinstallation fortfahren.\r\n\r\n$_CLICK"<br>!define MUI_FINISHPAGE_NOREBOOTSUPPORT<br>!define MUI_FINISHPAGE_TITLE_3LINES<br><br>; Setup-Seiten (Uninstaller)<br><br>!insertmacro MUI_UNPAGE_WELCOME<br>!insertmacro MUI_UNPAGE_CONFIRM<br>!insertmacro MUI_UNPAGE_COMPONENTS<br>!insertmacro MUI_UNPAGE_INSTFILES<br>!insertmacro MUI_UNPAGE_FINISH<br><br><br>; Setup-Sprache<br><br>!insertmacro MUI_LANGUAGE "German"<br><br><br>; Reservierte Dateien<br><br>ReserveFile "setup.ini"<br>!insertmacro MUI_RESERVEFILE_INSTALLOPTIONS<br><br><br>;===============================================================================<br>;<br>; Installer<br>;<br><br><br>; Setup.exe Versionsinformationen (Sprache = MUI_LANGUAGE)<br>VIProductVersion "${VER_MAJOR}.${VER_MINOR}.${VER_PATCH}.${VER_FLAGS}"<br>VIAddVersionKey "CompanyName" "${MOD_COMP}"<br>VIAddVersionKey "FileVersion" "${VER_TEXT}"<br>VIAddVersionKey "LegalCopyright" "${MOD_COPY}"<br>VIAddVersionKey "FileDescription" "${MOD_NAME}"<br>VIAddVersionKey "OriginalFilename" "${MOD_FILE}-${VER_FILE}.exe"<br><br><br>LangString NameInstFull ${LANG_GERMAN} "VollstÃ¤ndig"<br>InstType $(NameInstFull)<br><br><br>!include ".\setup\g2mod.nsh"<br><br><br>;-------------------------------------------------------------------------------<br>;<br>; Init (nicht angezeigt)<br>;<br><br><br>; Installer<br><br>Section -pre<br>Push $R0<br><br>SetDetailsPrint none<br>StrCpy $R0 "${MOD_RKEY}"<br><br>; Setup-Parameter in die Registrierung schreiben<br>ClearErrors<br>WriteRegExpandStr HKLM $R0 "InstallLocation" $INSTDIR<br>IfErrors "" write<br>MessageBox MB_OK|MB_ICONSTOP "Beim Schreiben der Werte fÃ¼r die spÃ¤tere Deinstallation trat ein Fehler auf.$\r$\nStellen Sie sicher, dass Ihr Benutzerkonto Ã¼ber die notwendigen Rechte verfÃ¼gt.$\r$\n$\r$\n(HKLM\$R0)"<br>Pop $R0<br>Abort<br>write:<br>WriteRegDWORD HKLM $R0 "VersionMajor" ${VER_MAJOR}<br>WriteRegDWORD HKLM $R0 "VersionMinor" ${VER_MINOR}<br>WriteRegDWORD HKLM $R0 "VersionPatch" ${VER_PATCH}<br>WriteRegDWORD HKLM $R0 "VersionFlags" ${VER_FLAGS}<br>WriteRegStr HKLM $R0 "DisplayIcon" "$INSTDIR\System\Gothic2.exe,0"<br>WriteRegStr HKLM $R0 "DisplayName" "${MOD_NAME}"<br>WriteRegStr HKLM $R0 "DisplayVersion" "${VER_TEXT}"<br>WriteRegDWORD HKLM $R0 "NoModify" 1<br>WriteRegDWORD HKLM $R0 "NoRepair" 1<br>WriteRegExpandStr HKLM $R0 "UninstallString" "$INSTDIR\${MOD_FILE}-uninst.exe"<br>WriteRegStr HKLM $R0 "Publisher" "${MOD_COMP}"<br>WriteRegStr HKLM $R0 "URLInfoAbout" "${MOD_LINK}"<br>WriteRegStr HKLM $R0 "HelpLink" "${MOD_HELP}"<br><br>Pop $R0<br>SectionEnd<br><br><br>;-------------------------------------------------------------------------------<br>;<br>; Modifikation<br>;<br><br><br>; Installer<br><br>LangString NameSecModFiles ${LANG_GERMAN} "${MOD_NAME}"<br>LangString TextSecModFiles ${LANG_GERMAN} "Installiere ${MOD_NAME}..."<br><br>Section !$(NameSecModFiles) SecModFiles<br><br>SectionIn RO ; nicht abwÃ¤hlbar<br><br>SetDetailsPrint textonly<br>DetailPrint $(TextSecModFiles)<br>SetDetailsPrint listonly<br><br>SetOverwrite on<br><br>; Installiere Mod-Konfiguration<br>SetOutPath "$INSTDIR\System"<br>File ".\install\System\${MOD_FILE}.ini"<br>; Installiere Mod-Volume<br>SetOutPath "$INSTDIR\Data\modvdf"<br>File ".\install\Data\modvdf\${MOD_FILE}.mod"<br>; Eventuelles Mod-Volume in /Data entfernen<br>!insertmacro g2mod_DeleteFile "$INSTDIR\Data\${MOD_FILE}.mod"<br><br>; EintrÃ¤ge im StartmenÃ¼<br>SetShellVarContext current<br>!insertmacro g2mod_CreateDirectory "$SMPROGRAMS\JoWooD\Gothic II\Modifikationen"<br>CreateShortCut "$SMPROGRAMS\JoWooD\Gothic II\Modifikationen\${MOD_NAME}.lnk" \<br>"$INSTDIR\System\GothicStarter.exe" "-game:${MOD_FILE}.ini"<br>CreateShortCut "$SMPROGRAMS\JoWooD\Gothic II\Modifikationen\${MOD_NAME} entfernen.lnk" \<br>"$INSTDIR\${MOD_FILE}-uninst.exe"<br><br>SectionEnd<br><br><br>; Uninstaller<br><br>Section !un.$(NameSecModFiles) unSecModFiles<br><br>SectionIn RO ; nicht abwÃ¤hlbar<br><br>; Mod-Volume und Mod-Volume-Map entfernen<br>!insertmacro g2mod_DeleteFile "$INSTDIR\vdfs_${MOD_FILE}.dmp"<br>!insertmacro g2mod_DeleteFile "$INSTDIR\Data\${MOD_FILE}.mod"<br>!insertmacro g2mod_DeleteFile "$INSTDIR\Data\modvdf\${MOD_FILE}.mod"<br>; /Data/modvdf wird nur entfernt, wenn es leer ist<br>!insertmacro g2mod_RemoveDirectory "$INSTDIR\Data\modvdf"<br>; Mod-Konfiguration entfernen<br>!insertmacro g2mod_DeleteFile "$INSTDIR\System\${MOD_FILE}.ini"<br><br>; EintrÃ¤ge im StartmenÃ¼ entfernen<br>SetShellVarContext current<br>!insertmacro g2mod_DeleteFile "$SMPROGRAMS\JoWooD\Gothic II\Modifikationen\${MOD_NAME}.lnk"<br>!insertmacro g2mod_DeleteFile "$SMPROGRAMS\JoWooD\Gothic II\Modifikationen\${MOD_NAME} entfernen.lnk"<br>; Werden nur entfernt, falls die Verzeihcnisse leer sind...<br>!insertmacro g2mod_RemoveDirectory "$SMPROGRAMS\JoWooD\Gothic II\Modifikationen"<br>!insertmacro g2mod_RemoveDirectory "$SMPROGRAMS\JoWooD\Gothic II"<br>!insertmacro g2mod_RemoveDirectory "$SMPROGRAMS\JoWooD"<br><br>SectionEnd<br><br><br>;-------------------------------------------------------------------------------<br>;<br>; SpielstÃ¤nde<br>;<br><br><br>LangString NameSecModSaves ${LANG_GERMAN} "SpielstÃ¤nde von ${MOD_NAME}"<br><br><br>; Installer (nicht angezeigt)<br><br>Section -$(NameSecModSaves) SecModSaves<br><br>; Mod-Savegame Verzeichnis anlegen<br>!insertmacro g2mod_CreateDirectory "$INSTDIR\saves_${MOD_FILE}\current"<br><br>SectionEnd<br><br><br>; Uninstaller<br><br>Section un.$(NameSecModSaves) unSecModSaves<br><br>; Mod-Savegames entfernen<br>RMDir /r "$INSTDIR\saves_${MOD_FILE}"<br><br>SectionEnd<br><br>;-------------------------------------------------------------------------------<br>;<br>; Cleanup (nicht angezeigt)<br>;<br><br><br>; Installer<br><br>Section -post<br><br>SetDetailsPrint none<br><br>; Uninstaller schreiben<br>Delete "$INSTDIR\${MOD_FILE}-uninst.exe"<br>WriteUninstaller "$INSTDIR\${MOD_FILE}-uninst.exe"<br><br>SectionEnd<br><br><br>; Uninstaller<br><br>Section -un.post<br><br>SetDetailsPrint none<br><br>; Registrierungsdaten entfernen<br>DeleteRegKey HKLM "${MOD_RKEY}"<br><br>; Uninstaller entfernen<br>Delete "$INSTDIR\${MOD_FILE}-uninst.exe"<br><br>SectionEnd<br><br><br>;===============================================================================<br>;<br>; Player-Kit<br>;<br><br><br>Section -g2mpk<br>SetOverwrite on<br>SetDetailsPrint none<br>SetShellVarContext current<br>!insertmacro g2mod_InstallPlayerKit<br>SectionEnd<br><br><br>;===============================================================================<br>;<br>; Callback-Funktionen<br>;<br><br><br>; Installer (Init)<br><br>Function .onInit<br>Push $R0<br><br>SetCurInstType 0<br><br>!insertmacro MUI_INSTALLOPTIONS_EXTRACT "setup.ini"<br><br>; Kein 'unsichtbares' Setup<br>SetSilent normal<br><br>; $INSTDIR bereits gÃ¼ltig?<br>IfFileExists "$INSTDIR\System\Gothic2.exe" done<br><br>; Sonst Add-ON Installation suchen (Registrierung)<br>Call g2mod_GetInstallLocation<br>Pop $R0<br>StrCmp $R0 "" done<br>; Ãœbernehmen<br>StrCpy $INSTDIR $R0<br><br>done:<br>Pop $R0<br>FunctionEnd<br><br><br>; Uninstaller (Init)<br><br>Function un.onInit<br>Push $R0<br><br>; $INSTDIR gÃ¼ltig?<br>IfFileExists "$INSTDIR\System\Gothic2.exe" done<br><br>; Mod-Installation suchen (Registrierung)<br>ReadRegStr $R0 HKLM "${MOD_RKEY}" "InstallLocation"<br>StrCmp $R0 "" wrong<br>StrCpy $INSTDIR $R0<br>IfFileExists "$INSTDIR\System\Gothic2.exe" done<br>; Nicht gefunden...<br>wrong:<br>MessageBox MB_YESNO|MB_ICONQUESTION "Das Installationsverzeichnis scheint ungÃ¼ltig zu sein.$\r$\nSoll die Deinstallation trotzdem fortgesetzt werden?" IDYES done<br>Pop $R0<br>Abort<br><br>done:<br>Pop $R0<br>FunctionEnd<br><br><br>; Reinstall<br><br>LangString TextReinstTitle ${LANG_GERMAN} "Vorherige Installation"<br>LangString TextReinstHead1 ${LANG_GERMAN} "WÃ¤hlen Sie aus, wie $(^Name) installiert werden soll."<br>LangString TextReinstOpt1A ${LANG_GERMAN} "Vorher deinstallieren"<br>LangString TextReinstOpt1B ${LANG_GERMAN} "Nicht deinstallieren"<br>LangString TextReinstHead2 ${LANG_GERMAN} "WÃ¤hlen Sie die auszufÃ¼hrende Wartungsoption aus."<br>LangString TextReinstOpt2A ${LANG_GERMAN} "Erneut installieren"<br>LangString TextReinstOpt2B ${LANG_GERMAN} "$(^Name) deinstallieren"<br>LangString TextReinstWrong ${LANG_GERMAN} "Eine inkompatible Version ist bereits installiert!\r\nWenn Sie diese Version wirklich installieren wollen,\r\nsollten Sie die aktuelle Version vorher deinstallieren."<br>LangString TextReinstOlder ${LANG_GERMAN} "Eine Ã¤ltere Version ist auf Ihrem System installiert.\r\nEs wird empfohlen die aktuelle Version vorher zu deinstallieren."<br>LangString TextReinstNewer ${LANG_GERMAN} "Eine neuere Version ist bereits auf Ihrem System installiert!\r\nEs wird empfohlen die Ã¤ltere Version nicht zu installieren. Wenn Sie diese Ã¤ltere Version wirklich installieren wollen, sollten Sie die aktuelle Version vorher deinstallieren."<br>LangString TextReinstEqual ${LANG_GERMAN} "$(^Name) ist bereits installiert."<br><br>Function PageReinstall<br><br>; Installationsverzeichnis lesen<br>ReadRegStr $R0 HKLM "${MOD_RKEY}" "InstallLocation"<br>StrCmp $R0 "" 0 +2<br>Abort<br><br>; Version Ã¼berprÃ¼fen<br>ReadRegDWORD $R0 HKLM "${MOD_RKEY}" "VersionFlags"<br>IntCmp $R0 ${VER_FLAGS} major wrong wrong<br>major:<br>ReadRegDWORD $R0 HKLM "${MOD_RKEY}" "VersionMajor"<br>IntCmp $R0 ${VER_MAJOR} minor older newer<br>minor:<br>ReadRegDWORD $R0 HKLM "${MOD_RKEY}" "VersionMinor"<br>IntCmp $R0 ${VER_MINOR} patch older newer<br>patch:<br>ReadRegDWORD $R0 HKLM "${MOD_RKEY}" "VersionPatch"<br>IntCmp $R0 ${VER_PATCH} equal older newer<br>wrong:<br>!insertmacro MUI_INSTALLOPTIONS_WRITE "setup.ini" "Field 1" "Text" "$(TextReinstWrong)"<br>!insertmacro MUI_INSTALLOPTIONS_WRITE "setup.ini" "Field 2" "Text" "$(TextReinstOpt1A)"<br>!insertmacro MUI_INSTALLOPTIONS_WRITE "setup.ini" "Field 3" "Text" "$(TextReinstOpt1B)"<br>!insertmacro MUI_HEADER_TEXT "$(TextReinstTitle)" "$(TextReinstHead1)"<br>StrCpy $R0 "1"<br>Goto start<br>older:<br>!insertmacro MUI_INSTALLOPTIONS_WRITE "setup.ini" "Field 1" "Text" "$(TextReinstOlder)"<br>!insertmacro MUI_INSTALLOPTIONS_WRITE "setup.ini" "Field 2" "Text" "$(TextReinstOpt1A)"<br>!insertmacro MUI_INSTALLOPTIONS_WRITE "setup.ini" "Field 3" "Text" "$(TextReinstOpt1B)"<br>!insertmacro MUI_HEADER_TEXT "$(TextReinstTitle)" "$(TextReinstHead1)"<br>StrCpy $R0 "1"<br>Goto start<br>newer:<br>!insertmacro MUI_INSTALLOPTIONS_WRITE "setup.ini" "Field 1" "Text" "$(TextReinstNewer)"<br>!insertmacro MUI_INSTALLOPTIONS_WRITE "setup.ini" "Field 2" "Text" "$(TextReinstOpt1A)"<br>!insertmacro MUI_INSTALLOPTIONS_WRITE "setup.ini" "Field 3" "Text" "$(TextReinstOpt1B)"<br>!insertmacro MUI_HEADER_TEXT "$(TextReinstTitle)" "$(TextReinstHead1)"<br>StrCpy $R0 "1"<br>Goto start<br>equal:<br>!insertmacro MUI_INSTALLOPTIONS_WRITE "setup.ini" "Field 1" "Text" "$(TextReinstEqual)"<br>!insertmacro MUI_INSTALLOPTIONS_WRITE "setup.ini" "Field 2" "Text" "$(TextReinstOpt2A)"<br>!insertmacro MUI_INSTALLOPTIONS_WRITE "setup.ini" "Field 3" "Text" "$(TextReinstOpt2B)"<br>!insertmacro MUI_HEADER_TEXT "$(TextReinstTitle)" "$(TextReinstHead2)"<br>StrCpy $R0 "2"<br>start:<br>!insertmacro MUI_INSTALLOPTIONS_DISPLAY "setup.ini"<br><br>FunctionEnd<br><br>Function PageLeaveReinstall<br><br>!insertmacro MUI_INSTALLOPTIONS_READ $R1 "setup.ini" "Field 2" "State"<br>StrCmp $R0 "1" 0 +2<br>StrCmp $R1 "1" inst done<br>StrCmp $R0 "2" 0 +3<br>StrCmp $R1 "1" done inst<br>inst:<br>HideWindow<br>ReadRegStr $R1 HKLM "${MOD_RKEY}" "UninstallString"<br>ClearErrors<br>ExecWait '$R1 _?=$INSTDIR'<br>IfErrors nope<br>IfFileExists $R1 "" nope<br>Delete $R1<br>nope:<br>StrCmp $R0 "2" 0 +2<br>Quit<br>BringToFront<br><br>done:<br>FunctionEnd<br><br><br>; Installer (VerzeichnisprÃ¼fung)<br><br>Var VerifyMessageOnce<br><br>Function .onVerifyInstDir<br><br>; Version 2.6 deutsch installiert ?<br>!insertmacro g2mod_IfInstallVersion $INSTDIR "2.6.0.0" done<br>; Basisversion 2.6 ?<br>!insertmacro g2mod_IfInstallVersionBase $INSTDIR "2.6" code<br>Goto nope<br>code:<br>; Deutsche Version ?<br>!insertmacro g2mod_IfInstallVersionCode $INSTDIR 0 done<br><br>; Keine 2.6-er (deutsch)...<br>nope:<br>; Meldung nur einmalig anzeigen<br>StrCmp $VerifyMessageOnce "done" +3<br>MessageBox MB_OK|MB_ICONINFORMATION "WÃ¤hlen Sie das Verzeichnis aus, in welchem sich 'Gothic II - Die Nacht des Raben' 2.6 (deutsch) befindet."<br>StrCpy $VerifyMessageOnce "done"<br>Abort<br><br>done:<br>FunctionEnd</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">ZmAn3</span><br><span class="post-time small text-muted">13th October 2008 22:56 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">hmm in your nsi file do u use !include "MUI2.nsh" or just mui?</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">stopasking</span><br><span class="post-time small text-muted">14th October 2008 00:14 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">i used !include "MUI.nsh"...i changed it into !include "MUI2.nsh" after u asked, but then an error message comes:<br><br>Error in macro MUI_RESERVEFILE_INSTALLOPTIONS on macroline 3<br>(line120)</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">ZmAn3</span><br><span class="post-time small text-muted">14th October 2008 01:40 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">not sure why that happens mabey someone else knows that will read this but mui2 is the include that all the current examples use you might want to use nsdialogs instead of install options its faster if i have time tommarow ill rewite your script but mabey someone can answer your install oprtions question before that this is a line from the mui depreceated.nsh file !error "MUI_RESERVEFILE_INSTALLOPTIONS is no longer supported as InstallOptions is no longer used by MUI2. Instead, use ReserveFile '${MUI_DOLLAR}{NSISDIR}\Plugins\InstallOptions.dll'. It is also recommended to upgrade to nsDialogs." so you can try that ReserveFile and see if that helps</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">stopasking</span><br><span class="post-time small text-muted">14th October 2008 15:13 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">well im really a beginner in NSIS, i dont know how to try it with the reservefile (I think it will help, but i dont know how to put that reservefile into the script)...it would be great if u could rewrite the script :)</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">ZmAn3</span><br><span class="post-time small text-muted">14th October 2008 20:08 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">ok this seems to work in your script where you have<br>!insertmacro MUI_RESERVEFILE_INSTALLOPTIONS replace it with<br>ReserveFile ${NSISDIR}\Plugins\InstallOptions.dll</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Comperio</span><br><span class="post-time small text-muted">14th October 2008 20:18 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"></p><blockquote><b><i>From ZmAn3</i></b><br>I'm not sure why that happens mabey someone else knows...</blockquote>MUI2 uses nsDialogs, not InstallOptions (INI files) for displaying pages. I think the reason for the error is that all the InstallOptions code handling has been removed from MUI2 and put in the InstallOptions.nsh header.</div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">ZmAn3</span><br><span class="post-time small text-muted">14th October 2008 20:19 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">you can still use installoptions with mui2 thou i just did it</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">stopasking</span><br><span class="post-time small text-muted">14th October 2008 20:29 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"></p><blockquote><i>Originally posted by ZmAn3</i><br><b>ok this seems to work in your script where you have<br>!insertmacro MUI_RESERVEFILE_INSTALLOPTIONS replace it with<br>ReserveFile ${NSISDIR}\Plugins\InstallOptions.dll</b></blockquote>thanks,<br><br>i tried<br><br>ReserveFile "setup.ini"<br>!insertmacro ReserveFile ${NSISDIR}\Plugins\InstallOptions.dll<br><br>and<br><br>ReserveFile "setup.ini"<br>ReserveFile ${NSISDIR}\Plugins\InstallOptions.dll<br><br>and<br><br>ReserveFile "setup.ini"<br>${NSISDIR}\Plugins\InstallOptions.dll<br><br>all three dont work :(<br><br>(still error in that line...)</div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">ZmAn3</span><br><span class="post-time small text-muted">14th October 2008 21:37 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">the second one ReserveFile ${NSISDIR}\Plugins\InstallOptions.dll<br><br>what error does that give you</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">stopasking</span><br><span class="post-time small text-muted">14th October 2008 22:27 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">ReserveFile: "C:\Program" -&gt; no files found.<br>Usage: ReserveFile [/nonfatal] [/r] [/x filespec [...]] file [file...]<br>Error in script "C:\Program Files\JoWooD\Gothic II\_work\demo\setup.nsi" on line 121 -- aborting creation process<br><br>_____________<br><br>maybe because i dont have that reservefile on my pc?</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">ZmAn3</span><br><span class="post-time small text-muted">14th October 2008 23:00 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">its not finding the file then thats why it says that look for the installoptions dll in your nsis directory and just copy it to the same directory as your script then change that line to ReserveFile InstallOptions.dll</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">kukomamasan</span><br><span class="post-time small text-muted">15th October 2008 01:49 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">NSIS still using old dos 8.3 formats i think, and need "filename" if its over 8.3 or spaces in the path, like program files (thats what i get from that error ( ReserveFile: "C:\Program" -&gt; no files found.)<br><br>maybe ReserveFile "${NSISDIR}\Plugins\InstallOptions.dll" will help ?</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">stopasking</span><br><span class="post-time small text-muted">15th October 2008 11:58 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">OK guys, thanks a lot, now the errors have gone :D (there were some more errors after that one, but i could fix them :))<br><br>is it also possible to put the bmp in the uninstaller?<br><br>here's my new script again...<br><br>;===============================================================================<br><br>;<br>; G2MDK - DemoMod Setup-Script<br>;<br>; System: NSIS 2.0 <a href="http://nsis.sf.net/" target="_blank">http://nsis.sf.net/</a><br>; Editor: HMNE 2.0 <a href="http://hmne.sf.net/" target="_blank">http://hmne.sf.net/</a><br>;<br>;===============================================================================<br><br><br><br><br>; Kompressionseinstellungen<br><br>CRCCheck force<br>;SetCompressor lzma<br>;SetCompressorDictSize 128 ; LZMA-Speicherverbrauch, siehe Tabelle<br>; DictSize Compress Decomp<br>; 8 MB 141 MB 10 MB (default)<br>; 12 MB 179 MB 14 MB<br>; 16 MB 217 MB 18 MB<br>; 24 MB 293 MB 26 MB<br>; 32 MB 369 MB 35 MB<br>; 48 MB 521 MB 50 MB<br>; 64 MB 673 MB 66 MB<br>; 96 MB 977 MB 98 MB<br>; 128 MB 1281 MB 130 MB<br>; 192 MB 1889 MB 194 MB<br>;!packhdr "packhdr.tmp" "upx.exe --best packhdr.tmp" ; <a href="http://upx.sf.net/" target="_blank">http://upx.sf.net/</a><br><br><br>; Definitionen<br><br>; TODO: Version der Modifikation<br>!define VER_MAJOR 1 ; Major Version<br>!define VER_MINOR 0 ; Minor Version<br>!define VER_PATCH 0 ; Patch-Version (1=a, ...)<br>!define VER_FLAGS 0 ; Sprachversion<br>!define VER_FILE "${VER_MAJOR}.${VER_MINOR}"<br>!define VER_TEXT "${VER_MAJOR}.${VER_MINOR}"<br><br>; TODO: Eigenschaften der Modifikation<br>!define MOD_FILE "Orkherrschaft" ; Mod-Dateiname (KEINE Leer- oder Sonderzeichen!)<br>!define MOD_NAME "Orkherrschaft" ; Mod-Titel<br>!define MOD_COPY "Copyright Â© 2004, Pluto 13 GmbH" ; Mod-Copyright<br>!define MOD_COMP "SunStars" ; Mod-Herausgeber<br>!define MOD_LINK "http://sunstars.worldofgothic.com" ; Herausgeber-Link<br>!define MOD_HELP "http://www.worldofgothic.de" ; Support-Link<br><br><br>;===============================================================================<br><br>;<br>; MUI<br>;<br><br><br>!include "MUI2.nsh"<br><br><br>Name "${MOD_NAME} ${VER_TEXT}"<br>OutFile "${MOD_FILE}-${VER_FILE}.exe"<br>InstallDir "$PROGRAMFILES\JoWooD\Gothic II\"<br>!define MOD_RKEY "SOFTWARE\Microsoft\Windows\CurrentVersion\Uninstall\${MOD_NAME}"<br>InstallDirRegKey HKLM "${MOD_RKEY}" "InstallLocation"<br>AllowRootDirInstall true<br><br><br>; Konfiguration (Installer)<br><br>!define MUI_WELCOMEPAGE_TITLE_3LINES<br>!define MUI_WELCOMEPAGE_TEXT "Dieser Assistent wird Sie durch die Installation von $(^Name) begleiten.\r\n\r\nEs wird empfohlen vor der Installation alle anderen Programme zu schlieÃŸen.\r\n\r\n$_CLICK"<br><br><br><br>!define MUI_COMPONENTSPAGE_NODESC<br>!define MUI_FINISHPAGE_NOREBOOTSUPPORT<br>!define MUI_FINISHPAGE_TITLE_3LINES<br><br><br><br><br><br>!define MUI_WELCOMEFINISHPAGE_BITMAP "C:\Documents and Settings\a\My Documents\NSIS_Menu.bmp"<br><br>; Setup-Seiten (Installer)<br><br>!insertmacro MUI_PAGE_WELCOME<br>!insertmacro MUI_PAGE_LICENSE ".\setup\licence.rtf"<br>Page custom PageReinstall PageLeaveReinstall<br>!insertmacro MUI_PAGE_DIRECTORY<br>!insertmacro MUI_PAGE_INSTFILES<br>!insertmacro MUI_PAGE_FINISH<br><br>; Konfiguration (Uninstaller)<br><br>!define MUI_WELCOMEPAGE_TITLE_3LINES<br>!define MUI_WELCOMEPAGE_TEXT "Dieser Assistent wird Sie durch die Deinstallation von $(^Name) begleiten.\r\n\r\nBitte beenden Sie Gothic II und zugehÃ¶rige Tools,\r\nbevor Sie mit der Deinstallation fortfahren.\r\n\r\n$_CLICK"<br>!define MUI_FINISHPAGE_NOREBOOTSUPPORT<br>!define MUI_FINISHPAGE_TITLE_3LINES<br><br>; Setup-Seiten (Uninstaller)<br><br>!insertmacro MUI_UNPAGE_WELCOME<br>!insertmacro MUI_UNPAGE_CONFIRM<br>!insertmacro MUI_UNPAGE_COMPONENTS<br>!insertmacro MUI_UNPAGE_INSTFILES<br>!insertmacro MUI_UNPAGE_FINISH<br><br><br>; Setup-Sprache<br><br>!insertmacro MUI_LANGUAGE "German"<br><br><br>; Reservierte Dateien<br><br>ReserveFile "setup.ini"<br><br>ReserveFile "C:\Program Files\NSIS\Plugins\InstallOptions.dll"<br><br><br>;===============================================================================<br><br>;<br>; Installer<br>;<br><br><br>; Setup.exe Versionsinformationen (Sprache = MUI_LANGUAGE)<br>VIProductVersion "${VER_MAJOR}.${VER_MINOR}.${VER_PATCH}.${VER_FLAGS}"<br>VIAddVersionKey "CompanyName" "${MOD_COMP}"<br>VIAddVersionKey "FileVersion" "${VER_TEXT}"<br>VIAddVersionKey "LegalCopyright" "${MOD_COPY}"<br>VIAddVersionKey "FileDescription" "${MOD_NAME}"<br>VIAddVersionKey "OriginalFilename" "${MOD_FILE}-${VER_FILE}.exe"<br><br><br>LangString NameInstFull ${LANG_GERMAN} "VollstÃ¤ndig"<br>InstType $(NameInstFull)<br><br><br>!include ".\setup\g2mod.nsh"<br><br><br>;-------------------------------------------------------------------------------<br>;<br>; Init (nicht angezeigt)<br>;<br><br><br>; Installer<br><br>Section -pre<br>Push $R0<br><br>SetDetailsPrint none<br>StrCpy $R0 "${MOD_RKEY}"<br><br>; Setup-Parameter in die Registrierung schreiben<br>ClearErrors<br>WriteRegExpandStr HKLM $R0 "InstallLocation" $INSTDIR<br>IfErrors "" write<br>MessageBox MB_OK|MB_ICONSTOP "Beim Schreiben der Werte fÃ¼r die spÃ¤tere Deinstallation trat ein Fehler auf.$\r$\nStellen Sie sicher, dass Ihr Benutzerkonto Ã¼ber die notwendigen Rechte verfÃ¼gt.$\r$\n$\r$\n(HKLM\$R0)"<br>Pop $R0<br>Abort<br>write:<br>WriteRegDWORD HKLM $R0 "VersionMajor" ${VER_MAJOR}<br>WriteRegDWORD HKLM $R0 "VersionMinor" ${VER_MINOR}<br>WriteRegDWORD HKLM $R0 "VersionPatch" ${VER_PATCH}<br>WriteRegDWORD HKLM $R0 "VersionFlags" ${VER_FLAGS}<br>WriteRegStr HKLM $R0 "DisplayIcon" "$INSTDIR\System\Gothic2.exe,0"<br>WriteRegStr HKLM $R0 "DisplayName" "${MOD_NAME}"<br>WriteRegStr HKLM $R0 "DisplayVersion" "${VER_TEXT}"<br>WriteRegDWORD HKLM $R0 "NoModify" 1<br>WriteRegDWORD HKLM $R0 "NoRepair" 1<br>WriteRegExpandStr HKLM $R0 "UninstallString" "$INSTDIR\${MOD_FILE}-uninst.exe"<br>WriteRegStr HKLM $R0 "Publisher" "${MOD_COMP}"<br>WriteRegStr HKLM $R0 "URLInfoAbout" "${MOD_LINK}"<br>WriteRegStr HKLM $R0 "HelpLink" "${MOD_HELP}"<br><br>Pop $R0<br>SectionEnd<br><br><br>;-------------------------------------------------------------------------------<br>;<br>; Modifikation<br>;<br><br><br>; Installer<br><br>LangString NameSecModFiles ${LANG_GERMAN} "${MOD_NAME}"<br>LangString TextSecModFiles ${LANG_GERMAN} "Installiere ${MOD_NAME}..."<br><br>Section !$(NameSecModFiles) SecModFiles<br><br>SectionIn RO ; nicht abwÃ¤hlbar<br><br>SetDetailsPrint textonly<br>DetailPrint $(TextSecModFiles)<br>SetDetailsPrint listonly<br><br>SetOverwrite on<br><br>; Installiere Mod-Konfiguration<br>SetOutPath "$INSTDIR\System"<br>File ".\install\System\${MOD_FILE}.ini"<br>; Installiere Mod-Volume<br>SetOutPath "$INSTDIR\Data\modvdf"<br>File ".\install\Data\modvdf\${MOD_FILE}.mod"<br>; Eventuelles Mod-Volume in /Data entfernen<br>!insertmacro g2mod_DeleteFile "$INSTDIR\Data\${MOD_FILE}.mod"<br><br>; EintrÃ¤ge im StartmenÃ¼<br>SetShellVarContext current<br>!insertmacro g2mod_CreateDirectory "$SMPROGRAMS\JoWooD\Gothic II\Modifikationen"<br>CreateShortCut "$SMPROGRAMS\JoWooD\Gothic II\Modifikationen\${MOD_NAME}.lnk" \<br>"$INSTDIR\System\GothicStarter.exe" "-game:${MOD_FILE}.ini"<br>CreateShortCut "$SMPROGRAMS\JoWooD\Gothic II\Modifikationen\${MOD_NAME} entfernen.lnk" \<br>"$INSTDIR\${MOD_FILE}-uninst.exe"<br><br>SectionEnd<br><br><br>; Uninstaller<br><br>Section !un.$(NameSecModFiles) unSecModFiles<br><br>SectionIn RO ; nicht abwÃ¤hlbar<br><br>; Mod-Volume und Mod-Volume-Map entfernen<br>!insertmacro g2mod_DeleteFile "$INSTDIR\vdfs_${MOD_FILE}.dmp"<br>!insertmacro g2mod_DeleteFile "$INSTDIR\Data\${MOD_FILE}.mod"<br>!insertmacro g2mod_DeleteFile "$INSTDIR\Data\modvdf\${MOD_FILE}.mod"<br>; /Data/modvdf wird nur entfernt, wenn es leer ist<br>!insertmacro g2mod_RemoveDirectory "$INSTDIR\Data\modvdf"<br>; Mod-Konfiguration entfernen<br>!insertmacro g2mod_DeleteFile "$INSTDIR\System\${MOD_FILE}.ini"<br><br>; EintrÃ¤ge im StartmenÃ¼ entfernen<br>SetShellVarContext current<br>!insertmacro g2mod_DeleteFile "$SMPROGRAMS\JoWooD\Gothic II\Modifikationen\${MOD_NAME}.lnk"<br>!insertmacro g2mod_DeleteFile "$SMPROGRAMS\JoWooD\Gothic II\Modifikationen\${MOD_NAME} entfernen.lnk"<br>; Werden nur entfernt, falls die Verzeihcnisse leer sind...<br>!insertmacro g2mod_RemoveDirectory "$SMPROGRAMS\JoWooD\Gothic II\Modifikationen"<br>!insertmacro g2mod_RemoveDirectory "$SMPROGRAMS\JoWooD\Gothic II"<br>!insertmacro g2mod_RemoveDirectory "$SMPROGRAMS\JoWooD"<br><br>SectionEnd<br><br><br>;-------------------------------------------------------------------------------<br>;<br>; SpielstÃ¤nde<br>;<br><br><br>LangString NameSecModSaves ${LANG_GERMAN} "SpielstÃ¤nde von ${MOD_NAME}"<br><br><br>; Installer (nicht angezeigt)<br><br>Section -$(NameSecModSaves) SecModSaves<br><br>; Mod-Savegame Verzeichnis anlegen<br>!insertmacro g2mod_CreateDirectory "$INSTDIR\saves_${MOD_FILE}\current"<br><br>SectionEnd<br><br><br>; Uninstaller<br><br>Section un.$(NameSecModSaves) unSecModSaves<br><br>; Mod-Savegames entfernen<br>RMDir /r "$INSTDIR\saves_${MOD_FILE}"<br><br>SectionEnd<br><br>;-------------------------------------------------------------------------------<br>;<br>; Cleanup (nicht angezeigt)<br>;<br><br><br>; Installer<br><br>Section -post<br><br>SetDetailsPrint none<br><br>; Uninstaller schreiben<br>Delete "$INSTDIR\${MOD_FILE}-uninst.exe"<br>WriteUninstaller "$INSTDIR\${MOD_FILE}-uninst.exe"<br><br>SectionEnd<br><br><br>; Uninstaller<br><br>Section -un.post<br><br>SetDetailsPrint none<br><br>; Registrierungsdaten entfernen<br>DeleteRegKey HKLM "${MOD_RKEY}"<br><br>; Uninstaller entfernen<br>Delete "$INSTDIR\${MOD_FILE}-uninst.exe"<br><br>SectionEnd<br><br><br>;===============================================================================<br><br>;<br>; Player-Kit<br>;<br><br><br>Section -g2mpk<br>SetOverwrite on<br>SetDetailsPrint none<br>SetShellVarContext current<br>!insertmacro g2mod_InstallPlayerKit<br>SectionEnd<br><br><br>;===============================================================================<br><br>;<br>; Callback-Funktionen<br>;<br><br><br>; Installer (Init)<br><br>Function .onInit<br>Push $R0<br><br>SetCurInstType 0<br><br>!include "Installoptions.nsh"<br><br>!insertmacro INSTALLOPTIONS_EXTRACT "setup.ini"<br><br>; Kein 'unsichtbares' Setup<br>SetSilent normal<br><br>; $INSTDIR bereits gÃ¼ltig?<br>IfFileExists "$INSTDIR\System\Gothic2.exe" done<br><br>; Sonst Add-ON Installation suchen (Registrierung)<br>Call g2mod_GetInstallLocation<br>Pop $R0<br>StrCmp $R0 "" done<br>; Ãœbernehmen<br>StrCpy $INSTDIR $R0<br><br>done:<br>Pop $R0<br>FunctionEnd<br><br><br>; Uninstaller (Init)<br><br>Function un.onInit<br>Push $R0<br><br>; $INSTDIR gÃ¼ltig?<br>IfFileExists "$INSTDIR\System\Gothic2.exe" done<br><br>; Mod-Installation suchen (Registrierung)<br>ReadRegStr $R0 HKLM "${MOD_RKEY}" "InstallLocation"<br>StrCmp $R0 "" wrong<br>StrCpy $INSTDIR $R0<br>IfFileExists "$INSTDIR\System\Gothic2.exe" done<br>; Nicht gefunden...<br>wrong:<br>MessageBox MB_YESNO|MB_ICONQUESTION "Das Installationsverzeichnis scheint ungÃ¼ltig zu sein.$\r$\nSoll die Deinstallation trotzdem fortgesetzt werden?" IDYES done<br>Pop $R0<br>Abort<br><br>done:<br>Pop $R0<br>FunctionEnd<br><br><br>; Reinstall<br><br>LangString TextReinstTitle ${LANG_GERMAN} "Vorherige Installation"<br>LangString TextReinstHead1 ${LANG_GERMAN} "WÃ¤hlen Sie aus, wie $(^Name) installiert werden soll."<br>LangString TextReinstOpt1A ${LANG_GERMAN} "Vorher deinstallieren"<br>LangString TextReinstOpt1B ${LANG_GERMAN} "Nicht deinstallieren"<br>LangString TextReinstHead2 ${LANG_GERMAN} "WÃ¤hlen Sie die auszufÃ¼hrende Wartungsoption aus."<br>LangString TextReinstOpt2A ${LANG_GERMAN} "Erneut installieren"<br>LangString TextReinstOpt2B ${LANG_GERMAN} "$(^Name) deinstallieren"<br>LangString TextReinstWrong ${LANG_GERMAN} "Eine inkompatible Version ist bereits installiert!\r\nWenn Sie diese Version wirklich installieren wollen,\r\nsollten Sie die aktuelle Version vorher deinstallieren."<br>LangString TextReinstOlder ${LANG_GERMAN} "Eine Ã¤ltere Version ist auf Ihrem System installiert.\r\nEs wird empfohlen die aktuelle Version vorher zu deinstallieren."<br>LangString TextReinstNewer ${LANG_GERMAN} "Eine neuere Version ist bereits auf Ihrem System installiert!\r\nEs wird empfohlen die Ã¤ltere Version nicht zu installieren. Wenn Sie diese Ã¤ltere Version wirklich installieren wollen, sollten Sie die aktuelle Version vorher deinstallieren."<br>LangString TextReinstEqual ${LANG_GERMAN} "$(^Name) ist bereits installiert."<br><br>Function PageReinstall<br><br>; Installationsverzeichnis lesen<br>ReadRegStr $R0 HKLM "${MOD_RKEY}" "InstallLocation"<br>StrCmp $R0 "" 0 +2<br>Abort<br><br>; Version Ã¼berprÃ¼fen<br>ReadRegDWORD $R0 HKLM "${MOD_RKEY}" "VersionFlags"<br>IntCmp $R0 ${VER_FLAGS} major wrong wrong<br>major:<br>ReadRegDWORD $R0 HKLM "${MOD_RKEY}" "VersionMajor"<br>IntCmp $R0 ${VER_MAJOR} minor older newer<br>minor:<br>ReadRegDWORD $R0 HKLM "${MOD_RKEY}" "VersionMinor"<br>IntCmp $R0 ${VER_MINOR} patch older newer<br>patch:<br>ReadRegDWORD $R0 HKLM "${MOD_RKEY}" "VersionPatch"<br>IntCmp $R0 ${VER_PATCH} equal older newer<br>wrong:<br><br>!include "Installoptions.nsh"<br>/*<br>!insertmacro MUI_INSTALLOPTIONS_WRITE "setup.ini" "Field 1" "Text" "$(TextReinstWrong)"<br>!insertmacro MUI_INSTALLOPTIONS_WRITE "setup.ini" "Field 2" "Text" "$(TextReinstOpt1A)"<br>!insertmacro MUI_INSTALLOPTIONS_WRITE "setup.ini" "Field 3" "Text" "$(TextReinstOpt1B)"<br>!insertmacro MUI_HEADER_TEXT "$(TextReinstTitle)" "$(TextReinstHead1)"<br>StrCpy $R0 "1"<br>Goto start<br>older:<br>!insertmacro MUI_INSTALLOPTIONS_WRITE "setup.ini" "Field 1" "Text" "$(TextReinstOlder)"<br>!insertmacro MUI_INSTALLOPTIONS_WRITE "setup.ini" "Field 2" "Text" "$(TextReinstOpt1A)"<br>!insertmacro MUI_INSTALLOPTIONS_WRITE "setup.ini" "Field 3" "Text" "$(TextReinstOpt1B)"<br>!insertmacro MUI_HEADER_TEXT "$(TextReinstTitle)" "$(TextReinstHead1)"<br>StrCpy $R0 "1"<br>Goto start<br>newer:<br>!insertmacro MUI_INSTALLOPTIONS_WRITE "setup.ini" "Field 1" "Text" "$(TextReinstNewer)"<br>!insertmacro MUI_INSTALLOPTIONS_WRITE "setup.ini" "Field 2" "Text" "$(TextReinstOpt1A)"<br>!insertmacro MUI_INSTALLOPTIONS_WRITE "setup.ini" "Field 3" "Text" "$(TextReinstOpt1B)"<br>!insertmacro MUI_HEADER_TEXT "$(TextReinstTitle)" "$(TextReinstHead1)"<br>StrCpy $R0 "1"<br>Goto start<br>equal:<br>!insertmacro MUI_INSTALLOPTIONS_WRITE "setup.ini" "Field 1" "Text" "$(TextReinstEqual)"<br>!insertmacro MUI_INSTALLOPTIONS_WRITE "setup.ini" "Field 2" "Text" "$(TextReinstOpt2A)"<br>!insertmacro MUI_INSTALLOPTIONS_WRITE "setup.ini" "Field 3" "Text" "$(TextReinstOpt2B)"<br>!insertmacro MUI_HEADER_TEXT "$(TextReinstTitle)" "$(TextReinstHead2)"<br>StrCpy $R0 "2"<br>start:<br>!insertmacro MUI_INSTALLOPTIONS_DISPLAY "setup.ini"<br>*/<br><br><br><br>!insertmacro INSTALLOPTIONS_WRITE "setup.ini" "Field 1" "Text" "$(TextReinstWrong)"<br>!insertmacro INSTALLOPTIONS_WRITE "setup.ini" "Field 2" "Text" "$(TextReinstOpt1A)"<br>!insertmacro INSTALLOPTIONS_WRITE "setup.ini" "Field 3" "Text" "$(TextReinstOpt1B)"<br>!insertmacro MUI_HEADER_TEXT "$(TextReinstTitle)" "$(TextReinstHead1)"<br>StrCpy $R0 "1"<br>Goto start<br>older:<br>!insertmacro INSTALLOPTIONS_WRITE "setup.ini" "Field 1" "Text" "$(TextReinstOlder)"<br>!insertmacro INSTALLOPTIONS_WRITE "setup.ini" "Field 2" "Text" "$(TextReinstOpt1A)"<br>!insertmacro INSTALLOPTIONS_WRITE "setup.ini" "Field 3" "Text" "$(TextReinstOpt1B)"<br>!insertmacro MUI_HEADER_TEXT "$(TextReinstTitle)" "$(TextReinstHead1)"<br>StrCpy $R0 "1"<br>Goto start<br>newer:<br>!insertmacro INSTALLOPTIONS_WRITE "setup.ini" "Field 1" "Text" "$(TextReinstNewer)"<br>!insertmacro INSTALLOPTIONS_WRITE "setup.ini" "Field 2" "Text" "$(TextReinstOpt1A)"<br>!insertmacro INSTALLOPTIONS_WRITE "setup.ini" "Field 3" "Text" "$(TextReinstOpt1B)"<br>!insertmacro MUI_HEADER_TEXT "$(TextReinstTitle)" "$(TextReinstHead1)"<br>StrCpy $R0 "1"<br>Goto start<br>equal:<br>!insertmacro INSTALLOPTIONS_WRITE "setup.ini" "Field 1" "Text" "$(TextReinstEqual)"<br>!insertmacro INSTALLOPTIONS_WRITE "setup.ini" "Field 2" "Text" "$(TextReinstOpt2A)"<br>!insertmacro INSTALLOPTIONS_WRITE "setup.ini" "Field 3" "Text" "$(TextReinstOpt2B)"<br>!insertmacro MUI_HEADER_TEXT "$(TextReinstTitle)" "$(TextReinstHead2)"<br>StrCpy $R0 "2"<br>start:<br>!insertmacro INSTALLOPTIONS_DISPLAY "setup.ini"<br><br><br><br><br>FunctionEnd<br><br>Function PageLeaveReinstall<br>!include "Installoptions.nsh"<br><br>!insertmacro INSTALLOPTIONS_READ $R1 "setup.ini" "Field 2" "State"<br>StrCmp $R0 "1" 0 +2<br>StrCmp $R1 "1" inst done<br>StrCmp $R0 "2" 0 +3<br>StrCmp $R1 "1" done inst<br>inst:<br>HideWindow<br>ReadRegStr $R1 HKLM "${MOD_RKEY}" "UninstallString"<br>ClearErrors<br>ExecWait '$R1 _?=$INSTDIR'<br>IfErrors nope<br>IfFileExists $R1 "" nope<br>Delete $R1<br>nope:<br>StrCmp $R0 "2" 0 +2<br>Quit<br>BringToFront<br><br>done:<br>FunctionEnd<br><br><br>; Installer (VerzeichnisprÃ¼fung)<br><br>Var VerifyMessageOnce<br><br>Function .onVerifyInstDir<br><br>; Version 2.6 deutsch installiert ?<br>!insertmacro g2mod_IfInstallVersion $INSTDIR "2.6.0.0" done<br>; Basisversion 2.6 ?<br>!insertmacro g2mod_IfInstallVersionBase $INSTDIR "2.6" code<br>Goto nope<br>code:<br>; Deutsche Version ?<br>!insertmacro g2mod_IfInstallVersionCode $INSTDIR 0 done<br><br>; Keine 2.6-er (deutsch)...<br>nope:<br>; Meldung nur einmalig anzeigen<br>StrCmp $VerifyMessageOnce "done" +3<br>MessageBox MB_OK|MB_ICONINFORMATION "WÃ¤hlen Sie das Verzeichnis aus, in welchem sich 'Gothic II - Die Nacht des Raben' 2.6 (deutsch) befindet."<br>StrCpy $VerifyMessageOnce "done"<br>Abort<br><br>done:<br>FunctionEnd<br><br><br><br>_________<br><br>if u could tell me where to put that line in, then everything would be fine with the installer^^<br><br>ah yes and one more thing, maybe u guys can help:<br><br>i want to put a logo too on the desktop of the users. what do i have to write in the script and where?</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">stopasking</span><br><span class="post-time small text-muted">15th October 2008 18:36 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">ah sorry, ok lets leave my questions of the last post out for a moment, coz i want to make something else first:<br><br>1.) Is there a possibility to write something else on the top of the window (where Orkherrschaft 1.0 Installation is written?) and also something else on the buttons...?<br><br>2.) I wanna play a sound on the start of the installation. how to do it?<br><br>thanks :)</p></div><hr><div class="footer"><p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p></div></div><script src="../js/highlight.pack.js" type="text/javascript"></script><script type="text/javascript">//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]></script></body></html>