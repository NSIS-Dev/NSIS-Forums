<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="Help -&gt; nsDiaglogs issue: some label is overlap in second page" />

  <title>Help -&gt; nsDiaglogs issue: some label is overlap in second page - NSIS Forums</title><!-- Bootstrap core CSS -->
  <link rel="stylesheet" type="text/css" href="//netdna.bootstrapcdn.com/bootswatch/3.0.2/readable/bootstrap.min.css" /><!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!--[if lt IE 9]>
                <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
                <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->
</head>

<body>
  <div class="container">
    <!-- Put navigation bar here -->

    <ol class="breadcrumb">
      <li><a href="../index.html" class="glyphicon glyphicon-home"></a></li>

      <li><a href="f-65.html">NSIS Discussion</a></li>

      <li class="active">Help -&gt; nsDiaglogs issue: some label is overlap in second page</li>
    </ol>

    <p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=313137">Help -&gt; nsDiaglogs issue: some label is overlap in second page</a></p><br />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">yudyzhao</span><br />
      <span class="post-time small text-muted">29th September 2009 10:32 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>Help -&gt; nsDiaglogs issue: some label is overlap in second page</strong><br />
      &nbsp; I use created 2 custom pages by nsDialogs.nsh. The first show the label, button and link very well. But after go to next page, the label looks like be overlapped by some other controls.<br />
      I post the code and the sreenshort here, someone please take a look and give me some idea how to solve it.<br />
      Thanks!<br />
      <br />
      The first page show the Window Installer 3.1 installation:<br />
      ==========================================================<br />
      nsDialogs::Create /NOUNLOAD 1018<br />
      Pop $WindowsInstallerDialogHandle<br />
      <br />
      ${If} error == $WindowsInstallerDialogHandle<br />
      Abort<br />
      ${EndIf}<br />
      <br />
      ${NSD_CreateIcon} 5u 8u -40u 31u<br />
      <br />
      ${NSD_CreateLabel} 40u 8u -40u 31u "$(WindowsInstallerIniField2Text)"<br />
      Pop $WindowsInstallerInfoLabelHandle<br />
      <br />
      ${NSD_CreateLabel} 40u 28u -40u 31u "$(WindowsInstallerIniField3Text)"<br />
      Pop $SecondInstallerInfoLabelHandle<br />
      <br />
      Call IsWindows3Dot1RedistibutablePresent<br />
      Pop $0<br />
      ${If} 1 == $0<br />
      ; show button<br />
      ${NSD_CreateButton} 60u 93u 144u 14u "$(WindowsInstallerIniField5Text)"<br />
      Pop $WinInstallerFromDiskButtonHandle<br />
      ${NSD_OnClick} $WinInstallerFromDiskButtonHandle InstallWindows3Dot1 ; button clicked event<br />
      ${EndIf}<br />
      <br />
      ${NSD_CreateLink} 60u 72u -40u 10u "$(WindowsInstallerIniField4Text)"<br />
      Pop $WinInstallerLinkHandle<br />
      ${NSD_OnClick} $WinInstallerLinkHandle OnWindowsInstallerLinkClicked<br />
      <br />
      ; Show the dialog<br />
      nsDialogs::Show<br />
      Return<br />
      ============================================================<br />
      <br />
      The second page show the .NET 3.5 installation:<br />
      ============================================================<br />
      nsDialogs::Create /NOUNLOAD 1018<br />
      Pop $DotNetDialogHandle<br />
      <br />
      ${If} error == $DotNetDialogHandle<br />
      Abort<br />
      ${EndIf}<br />
      <br />
      ${NSD_CreateIcon} 5u 9u -40u 31u<br />
      <br />
      ${NSD_CreateLabel} 40u 9u -40u 31u "$(DotNet3IniField2Text)"<br />
      Pop $DotNetInfoLabelHandle<br />
      <br />
      ${NSD_CreateLabel} 40u 30u -40u 31u "$(DotNet3IniField3Text)"<br />
      Pop $SecondDotNetInfoLabelHandle<br />
      <br />
      Call IsDotNet3RedistibutablePresent<br />
      Pop $0<br />
      ${If} 1 == $0<br />
      ; show button<br />
      ${NSD_CreateButton} 60u 91u 144u 14u "$(DotNet3IniField5Text)"<br />
      Pop $NetFromDiskButtonHandle<br />
      ${NSD_OnClick} $NetFromDiskButtonHandle InstallDotNet3 ; button clicked event<br />
      ${EndIf}<br />
      <br />
      ${NSD_CreateLink} 60u 70u -40u 10u "$(DotNet3IniField4Text)"<br />
      Pop $NetFromLinkHandle<br />
      ${NSD_OnClick} $NetFromLinkHandle OnDotNetOnLinkClicked<br />
      <br />
      ; Show the dialog<br />
      nsDialogs::Show<br />
      Return<br />
      ============================================================</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">CrushBug</span><br />
      <span class="post-time small text-muted">29th September 2009 16:23 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">As best as I can tell, you are seeing the exact same bug that I am seeing.<br />
      <br />
      This really seems to be a NSIS/nsDialogs redraw issue. I don't think that there is anything that we can do about it unless it is fixed in the code.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">CrushBug</span><br />
      <span class="post-time small text-muted">2nd October 2009 21:02 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">In the last 2 days, I have actively fighting with this issue. The common point seems to be that for the first Label control on the first nsDialogs custom page, that label will eventually turn invisible. It feels like a redraw issue as you can drag another window over the misbehaving installer window and you will see your label text come back.<br />
      <br />
      Today, at the suggestion of one of our programmers, his idea has actually solved the problem, but I doubt it is a good permanent fix and that the true bug is still hidden. For now, this solution works for us and I wanted to post about it here to get some feedback.<br />
      <br />
      Our programmer remembered a problem a year ago or so with a Windows app that was having a similar label redraw issue and the solution ended up being to remove the EX Transparent style from the control. nsDialogs sets this extended style for label controls. What we did was go into the nsDialogs.nsh file and comment out line 189:<br />
      <br /></p>
      <pre>
!define __NSD_Label_EXSTYLE ${WS_EX_TRANSPARENT} 
</pre>We now have two different installers who's first-nsDialogs-label-disappearing bug no longer occurs.<br />
      <br />
      So, how do we go about getting this fixed properly?
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">CrushBug</span><br />
      <span class="post-time small text-muted">5th October 2009 16:55 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Sorry, the commenting out of the line was a dumb move, as it just caused warnings. We have since changed the line to<br /></p>
      <pre>
<code>
define __NSD_Label_EXSTYLE 0 
<br />&gt;
</code>
</pre>So, any ideas on how to address this issue properly? Anyone?
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">MSG</span><br />
      <span class="post-time small text-muted">6th October 2009 07:53 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">You might want to submit this as a bug report in the bug tracker?<br />
      <br />
      <a href="http://nsis.sourceforge.net/Bug_Reports" target="_blank">http://nsis.sourceforge.net/Bug_Reports</a></p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">CrushBug</span><br />
      <span class="post-time small text-muted">6th October 2009 08:46 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Wow, I feel dumb now. I was looking for the bug link, but I think I kept searching for "tracker". /selfsmack<br />
      <br />
      I will get this filed tomorrow. Thanks MSG!</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">CrushBug</span><br />
      <span class="post-time small text-muted">6th October 2009 18:41 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">OK, bugs filed. Thanks for the help MSG.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Animaether</span><br />
      <span class="post-time small text-muted">10th September 2010 12:50 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Don't mean to resurrect this super-old thread - but I was going to log a bug and noticed this one in the queue there.<br />
      One way to make this 'bug' show up is by moving the window off-screen, them moving it back on-screen.. forcing a repaint of the dialog, and making the portions disappear.<br />
      <br />
      I say 'bug' because you mention...<br /></p>

      <blockquote>
        <small>Originally posted by yudyzhao</small><br />
        I use created 2 custom pages by nsDialogs.nsh. The first show the label, button and link very well. But after go to next page, the label looks like be overlapped by some other controls.
      </blockquote>What makes you think that the controls are, in fact, not overlapped?<br />
      If you replace CreateLabel with CreateButton, you can check the bounds of the control you're creating.. and you'll see that they do overlap.<br />
      <br />
      That said.. I don't see the first label disappearing - it's the second one that goes away for me - so it might be unrelated.
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">demiller9</span><br />
      <span class="post-time small text-muted">10th September 2010 13:50 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Could you be using mouse driver ipoint.exe v6.1? That caused redraw issues for me until I updated it to v7 (see this <a href="http://forums.winamp.com/showthread.php?t=319883&amp;highlight=intellipoint" target="_blank">thread</a>)<br />
      <br />
      Don</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">jiake</span><br />
      <span class="post-time small text-muted">10th September 2010 17:39 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Yes, one control covers another:<br />
      <br />
      ${NSD_CreateLabel} 40u 8u -40u 31u "$(WindowsInstallerIniField2Text)"<br />
      Pop $WindowsInstallerInfoLabelHandle<br />
      <br />
      8+31=39, but the following top is only 28:<br />
      <br />
      ${NSD_CreateLabel} 40u 28u -40u 31u "$(WindowsInstallerIniField3Text)"<br />
      Pop $SecondInstallerInfoLabelHandle<br />
      <br />
      and the second one also:<br />
      <br />
      ${NSD_CreateLabel} 40u 9u -40u 31u "$(DotNet3IniField2Text)"<br />
      Pop $DotNetInfoLabelHandle<br />
      <br />
      31+9=40, but top position of next control is 30:<br />
      <br />
      ${NSD_CreateLabel} 40u 30u -40u 31u "$(DotNet3IniField3Text)"<br />
      Pop $SecondDotNetInfoLabelHandle</p>
    </div>
    <hr />

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]>
  </script>
</body>
</html>
