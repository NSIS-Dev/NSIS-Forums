<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="description" content="Hidden ExecShell Program"><title>Hidden ExecShell Program - NSIS Forums</title><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script><link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css"><link rel="stylesheet" href="../css/style.css" type="text/css"><!--[if lt IE 9]><script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script><script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script><![endif]--></head><body><div class="container"><ol class="breadcrumb"><li><a href="../index.html" class="glyphicon glyphicon-home"></a></li><li><a href="f-65.html">NSIS Discussion</a></li><li class="active">Hidden ExecShell Program</li></ol><p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=103409">Hidden ExecShell Program</a></p><br><div class="post"><p class="post-meta"><span class="post-author text-primary">malone</span><br><span class="post-time small text-muted">3rd September 2002 19:26 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>Hidden ExecShell Program</strong><br>Ive got an old skool DOS command line program that I need to execute during the install. Im currently using ExecShell but windows brings up a big ugly DOS window while it runs. The program takes a while to run and many of my users who have never seen a DOS prompt before actually close the window with unfortunate results.<br><br>I found out about SW_SHOWMINIMIZED but prefrably Id like a way to hide it entirely (maybe a SW_HIDDEN option). We used to use an installer that did this but NSIS is superior in ever other way. Anyone know of a solution?</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">prodangle</span><br><span class="post-time small text-muted">3rd September 2002 20:20 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Another problem I came across when doing something similar was in Win95/98 the DOS window didn't automatically close after the program had completed. I solved this by extracting a .pif file next to the program which was configured to make the window close automatically after running, if anyone knows of a neater way of doing this I too would appreciate it :)</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Sunjammer</span><br><span class="post-time small text-muted">3rd September 2002 20:34 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">These might be helpful (or not)<br><br>START /Dworkingdir /MIN /WAIT commandstring<br>CMD /C commandstring</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">kichik</span><br><span class="post-time small text-muted">4th September 2002 08:30 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">The best solution would be writing a small DLL that does the same as MakeNSISw only without the log. If you wish it to log into your NSIS log window you will have to process the output for line breaks and insert it item by item to the NSIS log.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">malone</span><br><span class="post-time small text-muted">4th September 2002 10:16 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Thanks for the replies. I had a look at the "start" command, but in its current state it only seems to be able to minimise the window. A quick search on google groups show people with the same problem as me. Apparently start.exe is quite capable of hidding windows (it just has to send a different parameter to one function) but theres no switch for it.<br><br><a href="http://groups.google.com/groups?hl=en&amp;lr=&amp;ie=UTF-8&amp;threadm=8os7k3%24pec%241%40nnrp1.deja.com&amp;rnum=10&amp;prev=/groups%3Fhl%3Den%26lr%3D%26ie%3DISO-8859-1%26q%3Dpatch%2Bstart.exe%26btnG%3DGoogle%2BSearch" target="_blank">Google groups thread</a><br><br>They even patched the exe to do it. But I dont really want to patch other peoples exes or have to include a version in my installer.<br><br>I also found a program called <a href="http://www.scripthorizon.com/library/utilities/runh.zip" target="_blank">runh</a> that hides windows. Im gonna use that for now but it'd be much neater to have it part of nsis.<br><br>Im not much of a windows coder but looking at the makensisw source it looks like you can do it pretty much with the following lines of code<br></p><pre>
<code><br>GetStartupInfo(&amp;si);<br>si.dwFlags = STARTF_USESTDHANDLES|STARTF_USESHOWWINDOW;<br>si.wShowWindow = SW_HIDE;<br>CreateProcess(NULL,g_script,NULL,NULL,TRUE,CREATE_NEW_CONSOLE,NULL,NULL,&amp;si,&amp;pi);<br></code>
</pre><br>
      (where g_script has the path to the exe in it)<br>
      <br>
      Would it be possible to include something like that into nsis?
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Daab</span><br>
      <span class="post-time small text-muted">4th September 2002 10:35 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Ooh yeah, I can't believe I forgot about that.<br>
      <br>
      I had the same problem, and I wrote 2 separate tiny apps:<br>
      RunHidden - executes a given command line and hides the window<br>
      Hide - looks for a specified window and hides it<br>
      <br>
      The second one is useful for programs that spawn shells on their own (would you believe Microsoft does that too?!). I Exec the program, and then hide that program's specific shell windows.<br>
      <br>
      But this gets nasty if I want to use ExecWait - then I still have to use Exec, and run a loop within the script that does the hiding every 10 milliseconds or so while the program is running (so then I need to detect when the program finished as well...).<br>
      <br>
      Anyway, I too will really like to see an optional /HIDE switch for Exec and ExecWait that uses SW_HIDE.</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Sunjammer</span><br>
      <span class="post-time small text-muted">4th September 2002 11:07 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Add a feature request to the tracker at the SF site. I look at that list when deciding what to work on next.</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">rainwater</span><br>
      <span class="post-time small text-muted">5th September 2002 17:33 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">nsExec.dll is now in cvs. It allows you to execute command-line based programs and it captures the output (with-out a dos box). This plugin should be available in the next release or you can download in from cvs at sourceforge.</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">bdfy</span><br>
      <span class="post-time small text-muted">7th February 2005 22:16 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Sorry to bump old topic but IMHO it's still relevant question.<br>
      Now SW_HIDE parameter is availble for ExecShell , but I have to use ExecWait and can't use this... What shall I do ? I looked throgh help file , but found nothing ...:(<br>
      BTW,in Inno it looks as<br></p>

      <blockquote>
        [Run]<br>
        ;Filename: "{app}\cyrfonts.bat"; StatusMsg: "bla-bla"; Flags: runhidden
      </blockquote>What's the analogue ?
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Takhir</span><br>
      <span class="post-time small text-muted">8th February 2005 08:30 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">For DOS application use program files\nsis\contrib\nsExec or <a href="http://forums.winamp.com/showthread.php?s=&amp;threadid=181442" target="_blank">http://forums.winamp.com/showthread....hreadid=181442</a> plug-in.<br>
      For Win apps it is possible to get process handle from ShellExecuteEx and use WaitForSingelObject to wait for process exit, but this require System plug-in usage experience. You can search in the archive <a href="http://nsis.sourceforge.net/archive/browse.php" target="_blank">http://nsis.sourceforge.net/archive/browse.php</a> for script samples.</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">bdfy</span><br>
      <span class="post-time small text-muted">8th February 2005 11:18 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">2Takhir<br>
      OK, I replied in your topic. It's a pitty , but your plugin doesn't help:(</p>
    </div>
    <hr>

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]></script></body></html>