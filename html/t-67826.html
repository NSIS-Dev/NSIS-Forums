<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="makensis-bz and makensis-zzip compare" />

  <title>makensis-bz and makensis-zzip compare - NSIS Forums</title><!-- Bootstrap core CSS -->
  <link rel="stylesheet" type="text/css" href="//netdna.bootstrapcdn.com/bootswatch/3.0.1/readable/bootstrap.min.css" />
  <link rel="stylesheet" href="../css/style.css" type="text/css" /><!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!--[if lt IE 9]>
                <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
                <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->
</head>

<body>
  <div class="container">
    <!-- Put navigation bar here -->

    <ol class="breadcrumb">
      <li><a href="../index.html" class="glyphicon glyphicon-home"></a></li>

      <li><a href="f-65.html">NSIS Discussion</a></li>

      <li class="active">makensis-bz and makensis-zzip compare</li>
    </ol>

    <p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=67826">makensis-bz and makensis-zzip compare</a></p><br />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">hotice</span><br />
      <span class="post-time small text-muted">6th December 2001 08:16 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>makensis-bz and makensis-zzip compare</strong><br />
      the first test data block to select the best one<br />
      the later seems to have the best ratio of all<br />
      could you add those feature to makensis<br />
      <a href="http://mentasm.com/~zed/nsis/makensis_bz.exe" target="_blank">http://mentasm.com/~zed/nsis/makensis_bz.exe</a><br />
      <a href="http://mentasm.com/~zed/nsis/makensis_zzip.exe" target="_blank">http://mentasm.com/~zed/nsis/makensis_zzip.exe</a><br />
      MakeNSIS v1.44 - Copyright 1999-2001 Nullsoft, Inc.<br />
      <br />
      Portions Copyright (C) 1995-1998 Jean-loup Gailly and Mark Adler.<br />
      Contributors: <a href="mailto:nnop@newmail.ru">nnop@newmail.ru</a>, Ryan Geiss, Andras Varga, Drew Davidson, et al.<br />
      <br />
      Use the /LICENSE switch to view license information.<br />
      <br />
      -=-=-=-=-=-=-=-=-=-=- Processing config -=-=-=-=-=-=-=-=-=-=-<br />
      -=-=-=-=-=-=-=-=-=-=- Processing script -=-=-=-=-=-=-=-=-=-=-<br />
      Script file: "example1.nsi"<br />
      !packhdr: filename="tmp.dat", command="C:\winnt\upx -9 -q tmp.dat"<br />
      Name: "Example1"<br />
      OutFile: "example1.exe"<br />
      InstallDir: "$PROGRAMFILES\Example1"<br />
      DirText: "This will install the very simple example1 on your computer. Choose a directory"<br />
      Section: "ThisNameIsIgnoredSoWhyBother?"<br />
      SetOutPath: "$INSTDIR"<br />
      File: "winhlp32.exe" [compress]<br />
      @@@ [100kb block] 141357 bytes<br />
      @@@ [200kb block] 138972 bytes<br />
      @@@ [300kb block] 139635 bytes<br />
      @@@ [400kb block] 139635 bytes<br />
      @@@ [500kb block] 139635 bytes<br />
      @@@ [600kb block] 139635 bytes<br />
      @@@ [700kb block] 139635 bytes<br />
      @@@ [800kb block] 139635 bytes<br />
      @@@ [900kb block] 139635 bytes<br />
      @@@ [200kb block] 138972 bytes *** BEST!<br />
      138972/269584 bytes<br />
      File: "winhelp.exe" [compress]<br />
      @@@ [100kb block] 133528 bytes<br />
      @@@ [200kb block] 131662 bytes<br />
      @@@ [300kb block] 128850 bytes<br />
      @@@ [400kb block] 128850 bytes<br />
      @@@ [500kb block] 128850 bytes<br />
      @@@ [600kb block] 128850 bytes<br />
      @@@ [700kb block] 128850 bytes<br />
      @@@ [800kb block] 128850 bytes<br />
      @@@ [900kb block] 128850 bytes<br />
      @@@ [300kb block] 128850 bytes *** BEST!<br />
      Ultimate Packer for eXecutables<br />
      Copyright (C) 1996, 1997, 1998, 1999, 2000, 2001<br />
      UPX 1.20w Markus F.X.J. Oberhumer &amp; Laszlo Molnar May 23rd 2001<br />
      <br />
      File size Ratio Format Name<br />
      -------------------- ------ ----------- -----------<br />
      39424 -&gt; 22016 55.84% win32/pe tmp.dat<br />
      <br />
      Packed 1 file.<br />
      128850/261616 bytes<br />
      SectionEnd<br />
      Locating install icon after compress: found at offset 20590<br />
      <br />
      -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-<br />
      Output: "example1.exe"<br />
      <br />
      @@@ [100kb block] 315 bytes *** BEST!<br />
      Install: 1 section (1 required).<br />
      Install: 4 instructions, 191 byte string table.<br />
      <br />
      EXE header size: 22016 / 39424 bytes<br />
      Install code+strings: 351 / 491 bytes<br />
      Install data: 267830 / 531208 bytes<br />
      CRC (0x4E0B8DB7): 4 / 4 bytes<br />
      -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-<br />
      Total size: 290201 / 571127 bytes (50.8%)<br />
      <br />
      MakeNSIS v1.44 - Copyright 1999-2001 Nullsoft, Inc.<br />
      <br />
      Portions Copyright (C) 1995-1998 Jean-loup Gailly and Mark Adler.<br />
      Contributors: <a href="mailto:nnop@newmail.ru">nnop@newmail.ru</a>, Ryan Geiss, Andras Varga, Drew Davidson, et al.<br />
      <br />
      Use the /LICENSE switch to view license information.<br />
      <br />
      -=-=-=-=-=-=-=-=-=-=- Processing config -=-=-=-=-=-=-=-=-=-=-<br />
      -=-=-=-=-=-=-=-=-=-=- Processing script -=-=-=-=-=-=-=-=-=-=-<br />
      Script file: "example1.nsi"<br />
      !packhdr: filename="tmp.dat", command="C:\winnt\upx -9 -q tmp.dat"<br />
      Name: "Example1"<br />
      OutFile: "example1.exe"<br />
      InstallDir: "$PROGRAMFILES\Example1"<br />
      DirText: "This will install the very simple example1 on your computer. Choose a directory"<br />
      Section: "ThisNameIsIgnoredSoWhyBother?"<br />
      SetOutPath: "$INSTDIR"<br />
      File: "winhlp32.exe" [compress] 132987/269584 bytes<br />
      File: "winhelp.exe" [compress] Ultimate Packer for eXecutables<br />
      Copyright (C) 1996, 1997, 1998, 1999, 2000, 2001<br />
      UPX 1.20w Markus F.X.J. Oberhumer &amp; Laszlo Molnar May 23rd 2001<br />
      <br />
      File size Ratio Format Name<br />
      -------------------- ------ ----------- -----------<br />
      35840 -&gt; 20992 58.57% win32/pe tmp.dat<br />
      <br />
      Packed 1 file.<br />
      126191/261616 bytes<br />
      SectionEnd<br />
      Locating install icon after compress: found at offset 19566<br />
      <br />
      -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-<br />
      Output: "example1.exe"<br />
      Install: 1 section (1 required).<br />
      Install: 4 instructions, 191 byte string table.<br />
      <br />
      EXE header size: 20992 / 35840 bytes<br />
      Install code+strings: 281 / 503 bytes<br />
      Install data: 259186 / 531208 bytes<br />
      CRC (0x5F4686A0): 4 / 4 bytes<br />
      -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-<br />
      Total size: 280463 / 567555 bytes (49.4%)<br />
      <br />
      MakeNSIS v1.70 - Copyright 1999-2001 Nullsoft, Inc.<br />
      <br />
      Portions Copyright (C) 1995-1998 Jean-loup Gailly and Mark Adler.<br />
      Contributors: <a href="mailto:nnop@newmail.ru">nnop@newmail.ru</a>, Ryan Geiss, Andras Varga, Drew Davidson, Peter Windridge, Dave Laundon, et al.<br />
      <br />
      -=-=-=-=-=-=-=-=-=-=- Processing config -=-=-=-=-=-=-=-=-=-=-<br />
      -=-=-=-=-=-=-=-=-=-=- Processing script -=-=-=-=-=-=-=-=-=-=-<br />
      Script file: "example1.nsi"<br />
      !packhdr: filename="tmp.dat", command="C:\winnt\upx -9 -q tmp.dat"<br />
      Name: "Example1"<br />
      OutFile: "example1.exe"<br />
      InstallDir: "$PROGRAMFILES\Example1"<br />
      DirText: "This will install the very simple example1 on your computer. Choose a directory" "" ""<br />
      Section: "ThisNameIsIgnoredSoWhyBother?"<br />
      SetOutPath: "$INSTDIR"<br />
      File: "winhlp32.exe" [compress] 143781/269584 bytes<br />
      File: "winhelp.exe" [compress] Ultimate Packer for eXecutables<br />
      Copyright (C) 1996, 1997, 1998, 1999, 2000, 2001<br />
      UPX 1.20w Markus F.X.J. Oberhumer &amp; Laszlo Molnar May 23rd 2001<br />
      <br />
      File size Ratio Format Name<br />
      -------------------- ------ ----------- -----------<br />
      34816 -&gt; 20992 60.29% win32/pe tmp.dat<br />
      <br />
      Packed 1 file.<br />
      137236/261616 bytes<br />
      SectionEnd<br />
      Locating install icon after compress: found at offset 19566<br />
      <br />
      -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-<br />
      Output: "example1.exe"<br />
      Install: 1 section (1 required).<br />
      Install: 4 instructions (96 bytes), 532 byte string table.<br />
      <br />
      EXE header size: 20992 / 34816 bytes<br />
      Install code+strings: 516 / 928 bytes<br />
      Install data: 281025 / 531208 bytes<br />
      CRC (0xB3473048): 4 / 4 bytes<br />
      -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-<br />
      Total size: 302537 / 566956 bytes (53.4%)</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">justin</span><br />
      <span class="post-time small text-muted">11th December 2001 21:47 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">The compression modes I am adding in 1.9 perform better than either of these versions, and you will be able to choose which method to use.<br />
      <br />
      -Justin</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">hotice</span><br />
      <span class="post-time small text-muted">12th December 2001 00:44 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>To Justin</strong><br />
      I am confused<br />
      I wrote SetCompress auto<br />
      SetDatablockOptimize on<br />
      in my .nsi<br />
      It seems that v1.9a execute compress Install data at last step<br />
      but neither Uninstall code+data+strings norInstall code+strings is compressed.<br />
      I noticed you add following lines to config.h, do you compiled v1.9a with those defination?<br />
      could you tell me what shall I do?<br />
      config.h<br />
      //...<br />
      // NSIS_CONFIG_COMPRESSION_SUPPORT enables support for making installers<br />
      // that use compression (recommended).<br />
      <br />
      #define NSIS_CONFIG_COMPRESSION_SUPPORT<br />
      // compression specific options<br />
      <br />
      // NSIS_COMPRESS_USE_ZLIB uses deflate compression, which is very good.<br />
      // this mode uses the least amount of overhead on the runtime side, in<br />
      // terms of memory usage, disk footprint, and speed.<br />
      //#define NSIS_COMPRESS_USE_ZLIB<br />
      <br />
      // NSIS_COMPRESS_USE_BZIP2 uses bzip2 compression, which can be better<br />
      // than deflate, especially when using NSIS_COMPRESS_WHOLE. bzip2 is much<br />
      // slower to decompress, and uses a LOT more memory at runtime. The disk<br />
      // footprint using bzip2 is also approximately 6kb more than zlib.<br />
      #define NSIS_COMPRESS_USE_BZIP2<br />
      // if NSIS_COMPRESS_BZIP2_SMALLMODE is defined, bzip2's decompressor uses<br />
      // bzip2's alternative decompression method that uses a lot less memory, at<br />
      // the expense of speed. not recommended.<br />
      //#define NSIS_COMPRESS_BZIP2_SMALLMODE<br />
      <br />
      // NSIS_COMPRESS_WHOLE makes all install data compressed together. Runtime<br />
      // requirements are increased, but potential for compression is as well.<br />
      // Adds approximately 1kb of disk footprint, and requires that the installer<br />
      // create a (potentially large) temporary file in the temp directory.<br />
      #define NSIS_COMPRESS_WHOLE<br />
      //...<br />
      v1.9a<br />
      Output: "sarpins1.exe"<br />
      Install: 4 sections (2 required, 1 divider).<br />
      Install: 40 instructions (960 bytes), 3051 byte string table.<br />
      Uninstall: 17 instructions (408 bytes), 520 byte string table.<br />
      <br />
      EXE header size: 22528 / 39936 bytes<br />
      Install code+strings: 4351 / 4351 bytes<br />
      Install data: 1346648 / 1346648 bytes<br />
      [compress]<br />
      Uninstall code+data+strings: 1818 / 1818 bytes<br />
      <br />
      Total size post compress: 1113727 / 1392753 bytes (80.0%)<br />
      v1.8<br />
      Output: "sarpins1.exe"<br />
      Install: 4 sections (2 required, 1 divider).<br />
      Install: 40 instructions (960 bytes), 3051 byte string table.<br />
      Uninstall: 17 instructions (408 bytes), 520 byte string table.<br />
      <br />
      EXE header size: 20992 / 34816 bytes<br />
      Install code+strings: 2371 / 4351 bytes<br />
      Install data: 1047429 / 1346658 bytes<br />
      Uninstall code+data+strings: 846 / 1323 bytes<br />
      <br />
      Total size: 1071638 / 1387148 bytes (77.3%)</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">justin</span><br />
      <span class="post-time small text-muted">12th December 2001 01:15 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">When using the whole compression mode of 1.9a, the compression happens last, and groups all the data together (hence you can't split out how big the compressed size of various elements are)..<br />
      <br />
      -Justin</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">hotice</span><br />
      <span class="post-time small text-muted">12th December 2001 04:49 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Thanks<br />
      I still regreted that the ratio is lower than that of v1.8</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">justin</span><br />
      <span class="post-time small text-muted">12th December 2001 05:07 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Well, that's an issue with bzip2 and that data then I suppose. You can of course switch it back to zlib, or file-based as opposed to whole compression. As for zzip, we can't use it since its license (LGPL) is incompatible with ours (BSDish).<br />
      <br />
      -Justin</p>
    </div>
    <hr />

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]>
  </script>
</body>
</html>
