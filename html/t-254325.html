<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="NSIS messages load behind other windows" />

  <title>NSIS messages load behind other windows - NSIS Forums</title>
  <script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script>
  <!-- Bootstrap core CSS -->

  <link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css" />
  <link rel="stylesheet" href="../css/style.css" type="text/css" /><!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!--[if lt IE 9]>
                <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
                <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->
</head>

<body>
  <div class="container">
    <!-- Put navigation bar here -->

    <ol class="breadcrumb">
      <li><a href="../index.html" class="glyphicon glyphicon-home"></a></li>

      <li><a href="f-65.html">NSIS Discussion</a></li>

      <li class="active">NSIS messages load behind other windows</li>
    </ol>

    <p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=254325">NSIS messages load behind other windows</a></p><br />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">dmr@dv</span><br />
      <span class="post-time small text-muted">28th August 2006 15:33 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>NSIS messages load behind other windows</strong><br />
      Whenever I run the installer I've created with my NSIS script, the initial window that come up always loads behind my current open window.<br />
      <br />
      I've found reference to the problem here: <a href="http://forums.winamp.com/showthread.php?s=&amp;threadid=198596&amp;perpage=40&amp;highlight=&amp;pagenumber=1" target="_blank">http://forums.winamp.com/showthread....=&amp;pagenumber=1</a> near the bottom of the page from <b>Takhir</b> in the iNetLoad plugin thread. I AM in fact using iNetLoad in silent mode, so I assume that is what is causing it. Apparently it was introduced in NSIS version 2.03 and we're now on version 2.19 :(<br />
      <br />
      Has anyone found a workaround for this, or has it not been addressed at all?</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Takhir</span><br />
      <span class="post-time small text-muted">28th August 2006 16:05 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">InetLoad itself not manages NSIS dialogs appearance. If you want move dialog to foreground when download finishes, good way is to use SetForegroundWindow (use forum search for samples). But InetLoad had this option long ago, and code still presents (as commnet) :) So attached build with 'setforeground' enabled may help as well.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">dmr@dv</span><br />
      <span class="post-time small text-muted">28th August 2006 17:09 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">How do I use this different version? It seems to be putting extra things on the stack or someting and messing up other checks I'm doing.<br />
      <br />
      I've also tried creating this function and using it for .onGUInit<br />
      <br />
      Function guiInit<br />
      FindWindow $0 "" "myApp Setup"<br />
      System::Call "user32::SetForegroundWindow(i 0) i.."<br />
      FunctionEnd<br />
      <br />
      But it seems to have no effect. I can't find any documentation on how to actually use SetForegroundWindow neither here nor in the wiki.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Takhir</span><br />
      <span class="post-time small text-muted">29th August 2006 07:10 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"></p>
      <pre>
<code>Section "Dummy Section" SecDummy<br />DetailPrint "Waiting 3 sec - set another window foreground"<br />Sleep 3000<br />StrCpy $0 $HWNDPARENT<br />System::Call 'user32::SetForegroundWindow(i r0)'<br />DetailPrint "Waiting 2 sec - is Installer FG?"<br />Sleep 2000<br />DetailPrint Finished<br />SectionEnd</code>
</pre>this worked in my test.<br />
      ShowWindow $HWNDPARENT ${SW_RESTORE}<br />
      Also helps sometimes in guiInit
    </div>
    <hr />

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]>
  </script>
</body>
</html>
