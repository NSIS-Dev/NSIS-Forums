<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="Custom Pages, Modern Interface, and User Input" />

  <title>Custom Pages, Modern Interface, and User Input - NSIS Forums</title>
  <script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script>
  <!-- Bootstrap core CSS -->

  <link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css" />
  <link rel="stylesheet" href="../css/style.css" type="text/css" /><!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!--[if lt IE 9]>
                <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
                <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->
</head>

<body>
  <div class="container">
    <!-- Put navigation bar here -->

    <ol class="breadcrumb">
      <li><a href="../index.html" class="glyphicon glyphicon-home"></a></li>

      <li><a href="f-65.html">NSIS Discussion</a></li>

      <li class="active">Custom Pages, Modern Interface, and User Input</li>
    </ol>

    <p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=127162">Custom Pages, Modern Interface, and User Input</a></p><br />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">viper0179</span><br />
      <span class="post-time small text-muted">4th March 2003 01:36 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>Custom Pages, Modern Interface, and User Input</strong><br />
      &nbsp; I created an ini file holding 2 textbox fields for a custom page while I'm using the modern2.exe as the MUI interface. I can't seem to figure out how to get what information the user has entered into the installer. Basically, I'm having the user input their registration information for the program on the install page, and then writing the settings to the registry for later use. If anyone could shed some light on this I'd greatly appreciate it. I've looked everwhere and still haven't found any documentation on it. Also, if anyone knows anything about making one of these fields required to continue that would also be great.<br />
      <br />
      Thanks :)</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Sunjammer</span><br />
      <span class="post-time small text-muted">4th March 2003 08:55 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"></p>

      <blockquote>
        I can't seem to figure out how to get what information the user has entered into the installer
      </blockquote>The Contrib\InstallOptions.nsi example quite clearly shows how to work out in your script what state the controls were in when the page was closed.
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">virtlink</span><br />
      <span class="post-time small text-muted">4th March 2003 11:06 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">If I recall it correctly:<br />
      TextBox controls (along with some others), write their return value back into the .ini file. Then you have to use ReadINIStr to read the values from the .ini file.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Joost Verburg</span><br />
      <span class="post-time small text-muted">4th March 2003 15:21 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Use the MUI_INSTALLOPTIONS_READ macro (have a look at the Modern UI\InstallOptions.nsi example).<br />
      <br /></p>
      <pre>
<code>!insertmacro MUI_INSTALLOPTIONS_READ ${TEMP} "inifile.ini" "Field #" "Text"</code>
</pre>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">viper0179</span><br />
      <span class="post-time small text-muted">4th March 2003 19:53 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">I looked at the file already I think, I currently have this in the nsi file:<br />
      <br />
      !insertmacro MUI_INSTALLOPTIONS_READ ${TEMP1} "ioA.ini" "Field 2" "Text"<br />
      !insertmacro MUI_INSTALLOPTIONS_READ ${TEMP2} "ioA.ini" "Field 4" "Text"<br />
      <br />
      My problem is getting the user data into the registry. What would that be?<br />
      <br />
      WriteRegStr HKLM "Software\My Software" "Name" ${TEMP1} ??<br />
      <br />
      I'm not sure exactly what to do from this point. Thanks again for the help everyone.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
      <span class="post-time small text-muted">4th March 2003 19:56 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Exactly. The value will get into ${TEMP1} and ${TEMP2}.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Joost Verburg</span><br />
      <span class="post-time small text-muted">4th March 2003 21:23 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Make sure that you defined TEMP1 and TEMP2, for example:<br />
      <br />
      !define TEMP1 $R0 ;Will be stored in variable $R0</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">viper0179</span><br />
      <span class="post-time small text-muted">5th March 2003 03:42 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Yup, I have it defined earlier in the script.<br />
      <br />
      !define TEMP1 $R0<br />
      !define TEMP2 $R1<br />
      <br />
      Section ""<br />
      <br />
      !insertmacro MUI_INSTALLOPTIONS_READ ${TEMP1} "ioA.ini" "Field 2" "Text"<br />
      !insertmacro MUI_INSTALLOPTIONS_READ ${TEMP2} "ioA.ini" "Field 4" "Text"<br />
      <br />
      WriteRegStr HKLM "Software\MyProgram" "Name" $R0<br />
      WriteRegStr HKLM "Software\MyProgram" "Company" $R1<br />
      <br />
      SectionEnd<br />
      <br />
      This is what I currently have in my script. By the way, I just stuck the sections in there so you would know that I do have them in a section. Is there something that I'm missing? It just doesn't seem to want to work at all. I've tried using .... "Name" ${R0}, "Name" "${R0}", "Name" $R0, "Name" "$R0" and nothing just seems to work. I know its something small, things like this always are.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">deguix</span><br />
      <span class="post-time small text-muted">5th March 2003 07:36 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">!insertmacro MUI_INSTALLOPTIONS_READ ${TEMP1} "ioA.ini" "Field 2" "<font color="red"><b>Text</b></font>"<br />
      !insertmacro MUI_INSTALLOPTIONS_READ ${TEMP2} "ioA.ini" "Field 4" "<font color="red"><b>Text</b></font>"<br />
      <br />
      The name "Text" should be "State" (Text is the text that are show to user in labels, check boxes, radio buttons..., State is the state of the control after the user left the page).</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">viper0179</span><br />
      <span class="post-time small text-muted">5th March 2003 13:34 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>YAY!</strong><br />
      &nbsp; Thanks for all the help everyone. Deguix got the problem fixed for me. I knew it'd be something small hehe. I'm just used to using most ActiveX control textboxes that hold the data in the Text property. Never occurred it could be held somewhere else.<br />
      <br />
      Thanks again!<br />
      <br />
      Here's what the finished script looked like:<br /></p>
      <pre>
<code>
define TEMP1 $R0
<br />&gt;!define TEMP2 $R1
<br /><br />Section"Core Files" SecCore
<br /><br />   !insertmacro MUI_INSTALLOPTIONS_READ ${TEMP1} "ioA.ini" "Field 2" "State"
<br />   !insertmacro MUI_INSTALLOPTIONS_READ ${TEMP2} "ioA.ini" "Field 4" "State"
<br /><br />   WriteRegStr HKLM "Software\\MySoftware" "Name" $R0
<br />    WriteRegStr HKLM"Software\\MySoftware" "Company" $R1
<br /><br />SectionEnd 
<br />&gt;
</code>
</pre>
    </div>
    <hr />

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]>
  </script>
</body>
</html>