<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="description" content="Stack plugin"><title>Stack plugin - NSIS Forums</title><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script><link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css"><link rel="stylesheet" href="../css/style.css" type="text/css"><!--[if lt IE 9]><script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script><script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script><![endif]--></head><body><div class="container"><ol class="breadcrumb"><li><a href="../index.html" class="glyphicon glyphicon-home"></a></li><li><a href="f-65.html">NSIS Discussion</a></li><li class="active">Stack plugin</li></ol><p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=222762">Stack plugin</a></p><br><div class="post"><p class="post-meta"><span class="post-author text-primary">Instructor</span><br><span class="post-time small text-muted">28th July 2005 23:44 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>Stack plugin</strong><br>Last few days I'm wrote header on "C" with linear (one direction) and bilinear (two directions) stack functions. I has thought if make NSIS plugin that probably will be useful for somebody.<br><br><b>Functions for working with NSIS stack (linear):</b><br>ns_push_front (same as Push)<br>ns_pop_front (same as Pop)<br>ns_push_back<br>ns_stack_read<br>ns_stack_write<br>ns_stack_size<br>ns_stack_free<br><br><b>Functions for working with private stack (bilinear):</b><br>dll_push_front<br>dll_pop_front<br>dll_push_back<br>dll_pop_back<br>dll_stack_read<br>dll_stack_write<br>dll_stack_insert<br>dll_stack_delete<br>dll_stack_size<br>dll_stack_free</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Joel</span><br><span class="post-time small text-muted">29th July 2005 04:24 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Cool :up:<br>I can share with you my NOT crt function of <b>lstrcmp</b> since once I also use it :tinfoil:<br></p><pre>
<code>int_stdcall_strcmp</code><span style="color: #007700">(</span><span style="color: #0000BB">char</span><span style="color: #007700">*</span><span style="color: #0000BB">s1</span><span style="color: #007700">,</span><span style="color: #0000BB">char</span><span style="color: #007700">*</span><span style="color: #0000BB">s2</span><span style="color: #007700">)
<br>{
<br>for(;*</span><span style="color: #0000BB">s1</span><span style="color: #007700">&amp;&amp;*</span><span style="color: #0000BB">s2</span><span style="color: #007700">;++</span><span style="color: #0000BB">s1</span><span style="color: #007700">,++</span><span style="color: #0000BB">s2</span><span style="color: #007700">)
<br>{
<br>if(*</span><span style="color: #0000BB">s1</span><span style="color: #007700">!=*</span><span style="color: #0000BB">s2</span><span style="color: #007700">)
<br>{
<br>break;
<br>}
<br>}
<br>return*</span><span style="color: #0000BB">s1</span><span style="color: #007700">-*</span><span style="color: #0000BB">s2</span><span style="color: #007700">;
<br>}
</span>
</pre>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Instructor</span><br>
      <span class="post-time small text-muted">29th July 2005 09:56 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">If you talk about lstrcmp, probably the correct variant will be:<br>
      <br></p>
      <pre>
<code>int__stdcall_strcmp</code><span style="color: #007700">(</span><span style="color: #0000BB">char</span><span style="color: #007700">*</span><span style="color: #0000BB">s1</span><span style="color: #007700">,</span><span style="color: #0000BB">char</span><span style="color: #007700">*</span><span style="color: #0000BB">s2</span><span style="color: #007700">)
<br>{
<br>for(;(*</span><span style="color: #0000BB">s1</span><span style="color: #007700">)&amp;&amp;(*</span><span style="color: #0000BB">s2</span><span style="color: #007700">);++</span><span style="color: #0000BB">s1</span><span style="color: #007700">,++</span><span style="color: #0000BB">s2</span><span style="color: #007700">)
<br>if(*</span><span style="color: #0000BB">s1</span><span style="color: #007700">&lt;*</span><span style="color: #0000BB">s2</span><span style="color: #007700">)
<br>return-</span><span style="color: #0000BB">1</span><span style="color: #007700">;
<br>elseif(*</span><span style="color: #0000BB">s1</span><span style="color: #007700">&gt;*</span><span style="color: #0000BB">s2</span><span style="color: #007700">)
<br>return</span><span style="color: #0000BB">1</span><span style="color: #007700">;
<br><br>if((!*</span><span style="color: #0000BB">s1</span><span style="color: #007700">)&amp;&amp;(!*</span><span style="color: #0000BB">s2</span><span style="color: #007700">))
<br>return</span><span style="color: #0000BB">0</span><span style="color: #007700">;
<br>elseif(!*</span><span style="color: #0000BB">s1</span><span style="color: #007700">)
<br>return-</span><span style="color: #0000BB">1</span><span style="color: #007700">;
<br>else
<br>return</span><span style="color: #0000BB">1</span><span style="color: #007700">;
<br>}
</span>
</pre>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br>
      <span class="post-time small text-muted">29th July 2005 11:51 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">lstrcmp is not part of CRT. You're confusing it with strcmp. lstrcmp is a Windows API, defined in kernel32.dll. There's no need to write a replacement for it.</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Instructor</span><br>
      <span class="post-time small text-muted">10th August 2005 08:49 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><b>Changes:</b><br>
      <br>
      - New: Supports multi-stack (StackFunc.h).<br>
      - Fixed: <b><i>xitoa</i></b> string missing terminating null character when number is "0" (ConvFunc.h).<br>
      <br>
      <b>Functions for working with NSIS stack (linear):</b><br>
      - <i>ns_stack_free</i>-&gt;<b><i>ns_stack_clear</i></b> (function now not uses <i>pop_frontL</i>)<br>
      <br>
      <b>Functions for working with private stack (bilinear):</b><br>
      - Changed: <b><i>stack_insert</i></b> now can insert element to the top and first places<br>
      - <i>dll_stack_free</i>-&gt;<b><i>dll_stack_clear</i></b> (function now not uses <i>pop_front</i>)<br>
      - New: <b><i>stack_exchange</i></b><br>
      - New: <b><i>stack_delete_range</i></b><br>
      - New: <b><i>stack_move</i></b><br>
      - New: <b><i>stack_move_range</i></b><br>
      - New: <b><i>stack_sort</i></b><br>
      - New: <b><i>stack_reverse_range</i></b></p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Instructor</span><br>
      <span class="post-time small text-muted">1st September 2005 12:55 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><b>Changes</b>:<br>
      <br>
      - New: <b>stack::dll_push_sort</b> (Pushs element to the stack and sorts alphabetically in ascending or descending)<br>
      <br>
      - Added example how to sort lines in a text file<br>
      <br>
      - Supports custom structures (StackFunc.h)<br>
      <br>
      <br>
      "<b>Stack</b>" plugin v1.2</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Instructor</span><br>
      <span class="post-time small text-muted">2nd March 2006 19:39 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">1. <b>New:</b><br>
      dll_push_sort_int<br>
      dll_sort_all_int<br>
      Debug<br>
      <br>
      2. <b>Renamed:</b><br>
      ns_stack_read-&gt;ns_read<br>
      ns_stack_write-&gt;ns_write<br>
      ns_stack_size-&gt;ns_size<br>
      ns_stack_clear-&gt;ns_clear<br>
      dll_stack_read-&gt;dll_read<br>
      dll_stack_write-&gt;dll_write<br>
      dll_stack_insert-&gt;dll_insert<br>
      dll_stack_exchange-&gt;dll_exchange<br>
      dll_stack_reverse_range-&gt;dll_reverse_range<br>
      dll_stack_delete-&gt;dll_delete<br>
      dll_stack_delete_range-&gt;dll_delete_range<br>
      dll_stack_move-&gt;dll_move<br>
      dll_stack_move_range-&gt;dll_move_range<br>
      dll_stack_sort-&gt;dll_sort_all<br>
      dll_stack_size-&gt;dll_size<br>
      dll_stack_clear-&gt;dll_clear<br>
      <br>
      <b>Update from previous versions:</b><br>
      &amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;- Insert line in script:<br>
      &amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;!include "Stack.nsh"<br>
      &amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;- Replace:<br>
      &amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;stack::ns_push_front -&gt; ${stack::ns_push_front} ...<br>
      &amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;- Replace:<br>
      &amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;.r0 -&gt; $0, .r1 -&gt; $1 ... .R0 -&gt; $R0, .R1 -&gt; $R1 ...<br>
      <br>
      <br>
      "<b>Stack</b>" plugin v1.4</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Comm@nder21</span><br>
      <span class="post-time small text-muted">3rd March 2006 15:17 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">nice one.</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Instructor</span><br>
      <span class="post-time small text-muted">16th May 2006 08:53 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><b>Updated</b>: "StackFunc.h" to v1.7<br>
      <b>Added</b>: now possible dynamically create private stacks, all private stack functions<br>
      &amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;now require stack handle in first parameter<br>
      <b>Removed</b>: dll_push_front, dll_pop_front, dll_push_back, dll_pop_back, because<br>
      &amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;dll_insert and dll_delete can be used<br>
      <br>
      "<b>Stack</b>" plugin v1.5</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Instructor</span><br>
      <span class="post-time small text-muted">17th May 2006 00:49 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><b>Updated</b>: "StackFunc.h" to v1.8<br>
      <br>
      "<b>Stack</b>" plugin v1.6</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Instructor</span><br>
      <span class="post-time small text-muted">27th November 2009 17:23 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><b>Updated</b>: "StackFunc.h" to v3.0<br>
      <br>
      "<b>Stack</b>" plugin v1.7</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Marshall7a</span><br>
      <span class="post-time small text-muted">4th January 2011 14:13 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">The documentation doesn't mention that you have to clear a private stack before you destroy it, otherwise memory is leaked for the elements on the stack!</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Marshallx7</span><br>
      <span class="post-time small text-muted">20th June 2013 10:10 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">There appears to be a memory leak in the private stacks. I just created a test script that inserts 10,000 elements, then deletes them.<br>
      Memory usage before create: 1,380KB<br>
      Memory usage after create: 1,392KB<br>
      Memory usage after 10,000 inserts: 12,432KB<br>
      Memory usage after 10,000 deletes: 2,712KB<br>
      Destroyed but not unloaded: 2,588 KB<br>
      <br>
      I tried the same thing with inserting and deleting 1,000,000 elements (this took a long time to run) and the memory usage at the end was over 190 MB !</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Instructor</span><br>
      <span class="post-time small text-muted">16th September 2013 16:59 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><b>Added</b>: full unicode support on NSIS Unicode.<br>
      <b>Fixed</b>: ${stack::dll_destroy} didn't erase the stack before destroying.<br>
      <br>
      <a href="http://nsis.sourceforge.net/Stack_plug-in" target="_blank"><b>Stack</b> plugin v1.8</a></p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">aerDNA</span><br>
      <span class="post-time small text-muted">17th September 2013 19:02 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">I've found Stack precious in several scripts, thank you. Nice to see it up to date.</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Instructor</span><br>
      <span class="post-time small text-muted">18th September 2013 19:39 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><b>Added</b>: ${stack::ns_pop_back} - removes the element from the end of the NSIS stack and puts it in the variable.<br>
      <b>Added</b>: ${stack::ns_insert} - inserts new element at specified index of the NSIS stack.<br>
      <b>Added</b>: ${stack::ns_delete} - finds the NSIS element by index, puts it in the variable and removes it.<br>
      <br>
      <a href="http://nsis.sourceforge.net/Stack_plug-in" target="_blank"><b>Stack</b> plugin v2.0</a></p>
    </div>
    <hr>

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]></script></body></html>