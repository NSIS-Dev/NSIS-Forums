<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="Problem with ExecWait and osql.exe" />

  <title>Problem with ExecWait and osql.exe - NSIS Forums</title>
  <script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script>
  <!-- Bootstrap core CSS -->

  <link rel="stylesheet" type="text/css" href="//netdna.bootstrapcdn.com/bootswatch/3.0.1/readable/bootstrap.min.css" />
  <link rel="stylesheet" href="../css/style.css" type="text/css" /><!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!--[if lt IE 9]>
                <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
                <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->
</head>

<body>
  <div class="container">
    <!-- Put navigation bar here -->

    <ol class="breadcrumb">
      <li><a href="../index.html" class="glyphicon glyphicon-home"></a></li>

      <li><a href="f-65.html">NSIS Discussion</a></li>

      <li class="active">Problem with ExecWait and osql.exe</li>
    </ol>

    <p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=246741">Problem with ExecWait and osql.exe</a></p><br />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">blue_harvester</span><br />
      <span class="post-time small text-muted">22nd May 2006 12:55 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>Problem with ExecWait and osql.exe</strong><br />
      I'm trying to execute the following:<br />
      <br /></p>
      <pre>
<code><br />ExecWait '"osql.exe" -S SERVER -U USER <br /> -P PASSWORD -n -i validate_osql.sql &gt; validateOSQL.dat -b' $OUT<br /></code>
</pre><br />
      <br />
      But this is not working. The $OUT variable is set to 1 after execution.<br />
      <br />
      I have copied the exact command to a cmd window and it works fine. Also executing sqlplus commands works perfectly too.<br />
      <br />
      Any ideas?
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">RobGrant</span><br />
      <span class="post-time small text-muted">22nd May 2006 13:00 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">What doesn't work?</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">blue_harvester</span><br />
      <span class="post-time small text-muted">22nd May 2006 13:11 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"></p>

      <blockquote>
        <i>Originally posted by RobGrant</i><br />
        <b>What doesn't work?</b>
      </blockquote>Sorry, I should've been more specific. The actual execution of the osql.exe command doesn't work, ExecWait works fine. When I do the following it works fine:<br />
      <br />
      <pre>
<code><br />ExecWait '"sqlplus.exe" USER/PASSWORD@DATABASE @validate_sqlplus.sql'<br /></code>
</pre><br />
      <br />
      Thanks.
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">RobGrant</span><br />
      <span class="post-time small text-muted">22nd May 2006 13:18 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Are you using the split line in the actual code? If so, you want to put a \ at the end of the first line so it carries over properly.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">blue_harvester</span><br />
      <span class="post-time small text-muted">22nd May 2006 13:21 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"></p>

      <blockquote>
        <i>Originally posted by RobGrant</i><br />
        <b>Are you using the split line in the actual code? If so, you want to put a \ at the end of the first line so it carries over properly.</b>
      </blockquote>No, the code is all on one line.
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">RobGrant</span><br />
      <span class="post-time small text-muted">22nd May 2006 13:23 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">So what happens? Does the ExecWait DOS box appear? Does the call itself fail, or the osql program within it? Are you checking the exact commandline call, so that you can make sure it's not just a syntax error?</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">blue_harvester</span><br />
      <span class="post-time small text-muted">22nd May 2006 13:55 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"></p>

      <blockquote>
        <i>Originally posted by RobGrant</i><br />
        <b>So what happens? Does the ExecWait DOS box appear? Does the call itself fail, or the osql program within it? Are you checking the exact commandline call, so that you can make sure it's not just a syntax error?</b>
      </blockquote>The ExecWait DOS box appears for a split second (too short to see what the output is). Also to check the syntax, I have copied the command within the quotes and pasted it into a command window and this works perfectly! I'm really stumped as to what's going wrong.
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">RobGrant</span><br />
      <span class="post-time small text-muted">22nd May 2006 15:01 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Hm, I bet it's the output redirection that's the problem. Try without the "&gt; validateOSQL.dat -b", see what happens.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">blue_harvester</span><br />
      <span class="post-time small text-muted">22nd May 2006 15:39 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"></p>

      <blockquote>
        <i>Originally posted by RobGrant</i><br />
        <b>Hm, I bet it's the output redirection that's the problem. Try without the "&gt; validateOSQL.dat -b", see what happens.</b>
      </blockquote>You're right Rob, got it to work. Using the -o option now with osql. Suppose I should've used that from the start!<br />
      <br />
      Thanks again.
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">RobGrant</span><br />
      <span class="post-time small text-muted">22nd May 2006 15:46 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Hehe that's ok :) There is a way to get it to work with the &gt; though, you just need to mess around with quotation marks to get it to work.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">gustavo-serra</span><br />
      <span class="post-time small text-muted">1st November 2007 14:58 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">I am having the same problem, but I do not use output redirection. As RobGrant, I paste the command in a DOS shell and it works as it should. What can I do?<br />
      <br />
      The command is: 'FOR /F $\"tokens=1,*$\" %i IN ($\'at$\') DO IF %~nxj EQU limpabd.sh.bat at %i /DELETE'<br />
      <br />
      It is a loop to remove specific agended tasks.<br />
      Thanks any help.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Anders</span><br />
      <span class="post-time small text-muted">1st November 2007 15:04 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">try to prefix that command with: cmd.exe /c<br />
      you really should use nsExec or one of the other "Dos" exec plugins</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">gustavo-serra</span><br />
      <span class="post-time small text-muted">1st November 2007 16:46 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Ok, I will download and use it at once. I will give a try to your tip, thanks very much! :-D</p>
    </div>
    <hr />

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]>
  </script>
</body>
</html>
