<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="description" content="Any way to detect IIS6 physical web root directory?"><title>Any way to detect IIS6 physical web root directory? - NSIS Forums</title><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script><link rel="preload" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css" as="style" onload="this.rel='stylesheet'"><link rel="preload" href="../css/style.css" as="style" onload="this.rel='stylesheet'"><noscript><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css"><link rel="stylesheet" href="../css/style.css"></noscript><script>!function(a){"use strict";var b=function(b,c,d){function e(a){return h.body?a():void setTimeout(function(){e(a)})}function f(){i.addEventListener&&i.removeEventListener("load",f),i.media=d||"all"}var g,h=a.document,i=h.createElement("link");if(c)g=c;else{var j=(h.body||h.getElementsByTagName("head")[0]).childNodes;g=j[j.length-1]}var k=h.styleSheets;i.rel="stylesheet",i.href=b,i.media="only x",e(function(){g.parentNode.insertBefore(i,c?g:g.nextSibling)});var l=function(a){for(var b=i.href,c=k.length;c--;)if(k[c].href===b)return a();setTimeout(function(){l(a)})};return i.addEventListener&&i.addEventListener("load",f),i.onloadcssdefined=l,l(f),i};"undefined"!=typeof exports?exports.loadCSS=b:a.loadCSS=b}("undefined"!=typeof global?global:this);!function(a){if(a.loadCSS){var b=loadCSS.relpreload={};if(b.support=function(){try{return a.document.createElement("link").relList.supports("preload")}catch(b){return!1}},b.poly=function(){for(var b=a.document.getElementsByTagName("link"),c=0;c<b.length;c++){var d=b[c];"preload"===d.rel&&"style"===d.getAttribute("as")&&(a.loadCSS(d.href,d,d.getAttribute("media")),d.rel=null)}},!b.support()){b.poly();var c=a.setInterval(b.poly,300);a.addEventListener&&a.addEventListener("load",function(){b.poly(),a.clearInterval(c)}),a.attachEvent&&a.attachEvent("onload",function(){a.clearInterval(c)})}}}(this);</script></head><body><div class="container"><ol class="breadcrumb"><li><a href="../index.html" class="glyphicon glyphicon-home"></a></li><li><a href="f-65.html">NSIS Discussion</a></li><li class="active">Any way to detect IIS6 physical web root directory?</li></ol><p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=246502">Any way to detect IIS6 physical web root directory?</a></p><br><div class="post"><p class="post-meta"><span class="post-author text-primary">shaunb</span><br><span class="post-time small text-muted">19th May 2006 10:28 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>Any way to detect IIS6 physical web root directory?</strong><br>I need to be able to detect and suggest a suitable webroot to install a content management system into. I was previously using "c:\inetpub\wwwroot\" but I was told by my superiors that it should be detected, (even if it would still default to c:\inetpub\webroot), sounds a bit silly in my opinion.<br><br>anyway, the web root could be on D: or E: or it could be a multiple webserver configuration running on all 3, I have no idea how to get the 'right' one, and would probably just default to 'c:\inetpub\wwwroot' anyway, hence the pointlessness.<br><br>but I have managed to detect if ColdFusion is installed from the registry entries, and quit or continue on that, but due to IIS6 using the 'metabase' and not the registry as such, its a bit harder to access the properties. I have tried a couple of VBS cscripts to try and retrieve the information from the metabase, but it returns different info for each server (obviously), I still think that defaulting to c:\inetpub\wwwroot is more sensible, without any detection code behind, but I've been told its better to try detect the actual working webroot as I might end up causing the user to install the CMS in the wrong directory etc.<br><br>thanks for anyone who tried to decipher this and help. hehe!</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Mr Inches</span><br><span class="post-time small text-muted">19th May 2006 11:55 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Try these links I found for scripts that list all folders for all virtual folders.<br><br><a href="http://www.iisfaq.com/Default.aspx?tabid=3039" target="_blank">http://www.iisfaq.com/Default.aspx?tabid=3039</a><br><a href="http://www.iisfaq.com/Default.aspx?tabid=2745" target="_blank">http://www.iisfaq.com/Default.aspx?tabid=2745</a><br><br>If you are only interested in the default web site (first one), then just get the path for W3SVC1.<br><br>Alternatively, you could be brave and parse the Metabase directly.<br>Under IIS 6 it is in XML and stored in "%SYSTEMROOT%\System32\inetsrv\Metabase.xml" and you are looking for something like:<br><br>&lt;IIsWebVirtualDir Location ="/LM/W3SVC/1/ROOT"<br>AccessFlags="AccessRead | AccessScript"<br>AppFriendlyName="Default Application"<br>AppIsolated="2"<br>AppPoolId="DefaultAppPool"<br>AppRoot="/LM/W3SVC/1/ROOT"<br>Path="c:\inetpub\wwwroot"<br>&gt;<br>&lt;/IIsWebVirtualDir&gt;<br><br>Duncan (Mr Inches)</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">shaunb</span><br><span class="post-time small text-muted">19th May 2006 12:20 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Thanks for your reply, I am currently reading how about the XML metabase, but I need to detect IIS5 and IIS6 webroot I believe, as as with IIS5 the metabase is a binary file, I think I'll have to go some other route or just 'dumb provide' the default string "c:\inetpub\wwwroot"<br><br>I could just get the default webroot I guess, but its likely to be the wrong one, it would make good for a suggestion as a default though, but thats what I'm using already, it would be the same default even if I put code behind it to detect it!<br><br>man, I love trying to explain this to people who dont code.<br><br>anyway thanks again, I've got more reading to do at least<br><br>:)</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">shaunb</span><br><span class="post-time small text-muted">19th May 2006 12:28 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">hmm it seems one of the example links you gave, I have already been playing with, and the other one is more compact and nearly does what I want, but it borks with a null error if there is no IIS running on that system at all.<br><br>I'd love to be able to just default to the inetpub on c: but I know some people might say otherwise, I'd love to see them attempt it though.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">shaunb</span><br><span class="post-time small text-muted">19th May 2006 16:16 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">thanks for the help, I've convinced my superiors that manual selection of the IIS webroot is the best method though.<br><br>:)</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">TypoBound</span><br><span class="post-time small text-muted">20th May 2006 19:05 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">I had a similar need for a project I'm working on. I decided to use my program's installation path as an install point for the web pages and then create virtual directories on the default web site using adsutil.vbs provided with the IIS install.<br><br>In anyu case, the vbs routines provide a lot of ways to work with and query the web services so you will most likely find useful script in them.</p></div><hr><div class="footer"><p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p></div></div><script src="../js/highlight.pack.js" type="text/javascript"></script><script type="text/javascript">//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]></script></body></html>