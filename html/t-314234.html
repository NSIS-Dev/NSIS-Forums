<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="description" content="Vista/Win7, and UAC control"><title>Vista/Win7, and UAC control - NSIS Forums</title><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script><link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css"><link rel="stylesheet" href="../css/style.css" type="text/css"><!--[if lt IE 9]><script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script><script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script><![endif]--></head><body><div class="container"><ol class="breadcrumb"><li><a href="../index.html" class="glyphicon glyphicon-home"></a></li><li><a href="f-65.html">NSIS Discussion</a></li><li class="active">Vista/Win7, and UAC control</li></ol><p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=314234">Vista/Win7, and UAC control</a></p><br><div class="post"><p class="post-meta"><span class="post-author text-primary">Bill2</span><br><span class="post-time small text-muted">29th October 2009 09:32 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>Vista/Win7, and UAC control</strong><br>Hi from a french guy, (Hope you can understand what I want ...)<br><br>I have a question, and I don't find anwser anywhere.<br><br>I user RequestExecutionLevel=user, so the UAC is not launched when the installer starts.<br><br>But with user lever, the soft can't be installed in "program files"<br><br>If I use "admin" level, UAC prompt for password, and then NSIS can install my soft in Prg files<br><br>But with this level, at the end of install, if the user choose to launch the soft, it is launched with admin rights, and not user right.<br><br>And my soft save datas in user profile, so at the firt start after install, datas are saved in the admin profile, and the user don't find them when he wants to user the soft another day.<br><br>Is there a way to install soft with UAC in program files, and then launch soft at the end of install with user rights ?<br><br>Thanks for your help.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Anders</span><br><span class="post-time small text-muted">29th October 2009 09:47 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">the easy way: disable the run checkbox<br><br>the hard way: use the UAC plugin</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Bill2</span><br><span class="post-time small text-muted">29th October 2009 09:51 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">:)<br><br>Well, I have a look at UAC plugin, but I don't like the fact that it is the install that prompt for the admin password ... It may be not appears as very safe for the user.<br><br>So, I will use the first method.<br><br>An other question: if I use a ExecShell function, does it run with admin rights, or user rights "from the shell" ?<br>In the second cas, it could be a great things, no ?</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">MSG</span><br><span class="post-time small text-muted">29th October 2009 11:22 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">The program you execute with ExecShell will be run at the same level as the installer that executed it. Just like with Exec, ExecWait, nsExec or any other method of executing programs.<br><br>(Expect for the CallAsUser function in the UAC plugin, but like Anders hinted that's a world of pain.)</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Bill2</span><br><span class="post-time small text-muted">29th October 2009 11:44 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Right. I disable the finispage_run, and that' all!<br><br>(And may be this issue can be fixed in a future version of NSIS, I saw in other post that I'm not the only one to have this problem ...)<br><br>Thanks for you help :)</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">pengyou</span><br><span class="post-time small text-muted">29th October 2009 13:31 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">I have found that the UAC plugin works very well. It lets my installer do some things as an administrator and some as a standard user. I had to spend some time experimenting with the UAC plugin but soon found it suits my needs very well.<br><br>As far as I am concerned the "world of pain" mentioned elsewhere in connection with the UAC plugin is an exaggeration.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">MSG</span><br><span class="post-time small text-muted">29th October 2009 13:49 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Of course it is an exaggeration, but for NSIS newbies it most definitely is pain. Also I'll add that most people using the UAC plugin are NOT using it the way they should. It's a more complex problem than most people think or realize.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">pengyou</span><br><span class="post-time small text-muted">29th October 2009 14:10 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"></p><blockquote>It's a more complex problem than most people think or realize.</blockquote>I completely agree. After reading the documentation I thought I knew what I was doing but soon found that I was wrong - my installer was not doing what I expected it to do.<br><br>Once I took the time to write a few simple test programs and looked at what happened when I ran them I was able to see where I had gone wrong.</div><hr><div class="footer"><p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p></div></div><script src="../js/highlight.pack.js" type="text/javascript"></script><script type="text/javascript">//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]></script></body></html>