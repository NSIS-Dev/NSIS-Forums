<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="description" content="Uninstall: a folder not found error message."><title>Uninstall: a folder not found error message. - NSIS Forums</title><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script><link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css"><link rel="stylesheet" href="../css/style.css" type="text/css"></head><body><div class="container"><ol class="breadcrumb"><li><a href="../index.html" class="glyphicon glyphicon-home"></a></li><li><a href="f-65.html">NSIS Discussion</a></li><li class="active">Uninstall: a folder not found error message.</li></ol><p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=292711">Uninstall: a folder not found error message.</a></p><br><div class="post"><p class="post-meta"><span class="post-author text-primary">NEHOG</span><br><span class="post-time small text-muted">4th June 2008 14:01 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>Uninstall: a folder not found error message.</strong><br>When my uninstaller runs, sometimes (not always) we see the message:<br><br></p><blockquote>---------------------------<br>Settings<br>---------------------------<br>C:\Documents and Settings\All Users\Application Data\Product Name\Settings refers to a location that is unavailable. It could be on a hard drive on this computer, or on a network. Check to make sure that the disk is properly inserted, or that you are connected to the Internet or your network, and then try again. If it still cannot be located, the information might have been moved to a different location.<br>---------------------------<br>OK<br>---------------------------</blockquote>The uninstaller code that generates this error is:<br><br>rmdir /r /REBOOTOK "$9\Application Data\${PRODUCT_NAME}"<br><br>where $9 contains the data: "C:\Documents and Settings\All Users\Application Data\", and of course ${PRODUCT_NAME} contains the string "Product Name" (really it contains the name of the product, but for posting purposes...)<br><br>And, yes, this is the only line deleting the folder in question.<br><br>Anyone have thoughts or suggestions?</div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">{_trueparuex^}</span><br><span class="post-time small text-muted">4th June 2008 17:45 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">That message is not coming from NSIS, it's coming from the operating system (from Windows Vista apparently).<br><br>I have no idea what's causing it, but google gives tons of results if you <a href="http://www.google.com/search?q=%22It+could+be+on+a+hard+drive+on+this+computer%2C+or+on+a+network.%22" target="_blank">search the message</a>.<br><br>PaR</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">NEHOG</span><br><span class="post-time small text-muted">4th June 2008 20:46 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"></p><blockquote><i>Originally posted by {_trueparuex^}</i><br><b>That message is not coming from NSIS, it's coming from the operating system (from Windows Vista apparently).<br><br>I have no idea what's causing it, but google gives tons of results if you <a href="http://www.google.com/search?q=%22It+could+be+on+a+hard+drive+on+this+computer%2C+or+on+a+network.%22" target="_blank">search the message</a>.<br><br>PaR</b></blockquote>Yes, it is a Windows message, I wonder if there is some way to tell NSIS to do things silently (ignore the error). BTW, we are getting this on XP (probably would get it on Vista too, but our first discovery of the message was XP based.</div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Red Wine</span><br><span class="post-time small text-muted">4th June 2008 21:28 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">I wonder why you do not use $APPDATA instead.<br></p><blockquote>$APPDATA<br><br>The application data directory. Detection of the current user path requires Internet Explorer 4 and above. Detection of the all users path requires Internet Explorer 5 and above. The context of this constant (All Users or Current user) depends on the SetShellVarContext setting. The default is the current user.</blockquote></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">NEHOG</span><br><span class="post-time small text-muted">5th June 2008 20:23 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"></p><blockquote><i>Originally posted by Red Wine</i><br><b>I wonder why you do not use $APPDATA instead.</b></blockquote>I'm not sure I see the method to find or set the location as being significant. When in the 'All Users' context, $APPDATA would return the string that I described in the original post.<br><br>Perhaps I'm missing something? (Yes, we are installing for 'All Users'...)</div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Red Wine</span><br><span class="post-time small text-muted">5th June 2008 20:32 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"></p><blockquote>rmdir /r /REBOOTOK "$9\Application Data\${PRODUCT_NAME}"<br><br>where $9 contains the data: "C:\Documents and Settings\All Users\Application Data\", and of course ${PRODUCT_NAME} contains the string "Product Name" (really it contains the name of the product, but for posting purposes...)</blockquote>Expanding the code as it is described here the result is:<br><pre>
<code>rmdir /r /REBOOTOK "C:\Documents and Settings\All Users\Application Data\Application Data\${PRODUCT_NAME}"</code>
</pre>which seems wrong to me.<br><pre>
<code>Section Uninstall<br>SetShellVarContext All<br>rmdir /r /REBOOTOK "$APPDATA\${PRODUCT_NAME}"</code>
</pre>
    </div>
    <hr>

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]></script></body></html>