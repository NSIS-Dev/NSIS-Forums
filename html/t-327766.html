<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="Uninstall window running under Welcome screen.." />

  <title>Uninstall window running under Welcome screen.. - NSIS Forums</title>
  <script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script>
  <!-- Bootstrap core CSS -->

  <link rel="stylesheet" type="text/css" href="//netdna.bootstrapcdn.com/bootswatch/3.0.1/readable/bootstrap.min.css" />
  <link rel="stylesheet" href="../css/style.css" type="text/css" /><!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!--[if lt IE 9]>
                <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
                <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->
</head>

<body>
  <div class="container">
    <!-- Put navigation bar here -->

    <ol class="breadcrumb">
      <li><a href="../index.html" class="glyphicon glyphicon-home"></a></li>

      <li><a href="f-65.html">NSIS Discussion</a></li>

      <li class="active">Uninstall window running under Welcome screen..</li>
    </ol>

    <p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=327766">Uninstall window running under Welcome screen..</a></p><br />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">joe131</span><br />
      <span class="post-time small text-muted">23rd February 2011 21:40 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>Uninstall window running under Welcome screen..</strong><br />
      Hi All,<br />
      <br />
      Here's the problem. As soon as my Installer runs it looks to see if there<br />
      is an existing version, and if it finds it, it runs the Uninstaller to remove the<br />
      previous version first.<br />
      <br />
      The problem is that after the Uninstall window runs for a second,<br />
      the Welcome screen opens directly above it, and the user doesn't see the Uninstall<br />
      window running, so they can easily hit "Next", on the Welcome screen,<br />
      and the Uninstall will be hosed.<br />
      <br />
      I'm currently using the Ultra Modern UI, but I've seen it happen with the MUI2.nsh<br />
      also.<br />
      <br />
      What I'm currently doing is pretty kludgey. I let the Uninstall run for a second<br />
      and a half, then do a "BringToFront", and that brings it back to the top,<br />
      but it doesn't always work.<br />
      <br />
      Ideally I'd set a flag variable, in the Uninstall, saying that it's running<br />
      and before the Welcome screen opens, it would check the flag, and if it was<br />
      set, it would "wait" till the Uninstaller was finished before it opens.<br />
      <br />
      But it looks like you can't do any pre-opening stuff with the Welcome screen.<br />
      <br />
      Maybe, if I could create a Custom screen that looks exactly like the Welcome screen,<br />
      then I could control it better.<br />
      <br />
      If anyone has any suggestions on how I can keep the Uninstall window from<br />
      being covered over by the Welcome screen, I'd appreciate it!<br />
      <br />
      Oh, my Installer only runs on Windows, I'm not using it for any other platform.<br />
      <br />
      Thanks!</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Anders</span><br />
      <span class="post-time small text-muted">23rd February 2011 22:04 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">You are probably executing the uninstaller incorrectly, are you using the _?= parameter and ExecWait?</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">joe131</span><br />
      <span class="post-time small text-muted">24th February 2011 01:02 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Thanks for your reply.<br />
      <br />
      I was using:<br />
      <br />
      ExecWait "${INSTALL_DIRECTORY}\Webserver\bin\${UNINSTALLER}"<br />
      <br />
      And tried changing it to:<br />
      <br />
      ClearErrors<br />
      ExecWait "${INSTALL_DIRECTORY}\Webserver\bin\${UNINSTALLER}" $0<br />
      <br />
      And not doing anything with the return code '$0'<br />
      <br />
      I ran the Installer several times, and it seems to work, but the Welcome<br />
      screen is under the Uninstall window every time. It won't take much<br />
      for it to "decide" to come to the front.<br />
      <br />
      I looked around and only found _?= used once in Examples\makensis.nsi<br />
      and couldn't find any docs on how it's used.<br />
      <br />
      I did find out that I CAN add a MUI_PAGE_CUSTOMFUNCTION_PRE<br />
      before my !insertmacro MUI_PAGE_WELCOME<br />
      <br />
      And I wrote this Function:<br />
      <br />
      <br />
      Function WelcomePre<br />
      <br />
      Loop_Start:<br />
      <br />
      StrCmp $UninstallRunning "TRUE" Loop_Start Loop_End<br />
      <br />
      Loop_End:<br />
      <br />
      FunctionEnd<br />
      <br />
      <br />
      And it looks like it works pretty well.<br />
      <br />
      How do I use _?= ?<br />
      <br />
      <br />
      Thanks!</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">demiller9</span><br />
      <span class="post-time small text-muted">24th February 2011 02:16 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">You could <a href="http://nsis.sourceforge.net/Docs/Chapter3.html#3.2.2" target="_blank">RTFM</a>.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">joe131</span><br />
      <span class="post-time small text-muted">24th February 2011 14:47 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">There isn't ONE WORD in the FM about "_?="!</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">jpderuiter</span><br />
      <span class="post-time small text-muted">24th February 2011 14:49 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"></p>

      <blockquote>
        3.2.2 Uninstaller Specific Options<br />
        <br />
        _?= sets $INSTDIR. It also stops the uninstaller from copying itself to the temporary directory and running from there. It can be used along with ExecWait to wait for the uninstaller to finish. It must be the last parameter used in the command line and must not contain any quotes, even if the path contains spaces.
      </blockquote>...
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">joe131</span><br />
      <span class="post-time small text-muted">24th February 2011 15:09 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Sorry, I found it in the Uninstaller section. It wasn't in anything doing with<br />
      ExecWait<br />
      <br />
      Thanks</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
      <span class="post-time small text-muted">24th February 2011 15:59 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">That is because it has nothing to do (directly) with ExecWait. _?= is a specific option for the NSIS uninstall executable.<br />
      <br />
      <a href="http://nsis.sourceforge.net/When_I_use_ExecWait_uninstaller.exe_it_doesn%27t_wait_for_the_uninstaller" target="_blank">http://nsis.sourceforge.net/When_I_u...he_uninstaller</a><br />
      <br />
      Stu</p>
    </div>
    <hr />

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]>
  </script>
</body>
</html>
