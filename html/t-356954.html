<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="description" content="Registry assistance needed"><title>Registry assistance needed - NSIS Forums</title><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script><link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css"><link rel="stylesheet" href="../css/style.css" type="text/css"><!--[if lt IE 9]><script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script><script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script><![endif]--></head><body><div class="container"><ol class="breadcrumb"><li><a href="../index.html" class="glyphicon glyphicon-home"></a></li><li><a href="f-65.html">NSIS Discussion</a></li><li class="active">Registry assistance needed</li></ol><p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=356954">Registry assistance needed</a></p><br><div class="post"><p class="post-meta"><span class="post-author text-primary">mordack</span><br><span class="post-time small text-muted">7th March 2013 16:57 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>Registry assistance needed</strong><br>greetings,<br><br>I'm fairly new at using NSIS. I've had a bit of success so far with a different installer, but now I'm stuck on a new project. I've been looking through many googled pages for the answer to this question without success. How do I use the registry plug-in for NSIS to search a series of keys for one word so I can determine it's MSI uninstall string?<br><br>I don't know what the current MSI uninstall string is because there are multiple versions of the product. in this case the product is Symantec Endpoint Protection. How would I write the code to basically look through the HKLM\Software\Microsoft\Windows\CurrentVersion\Uninstall keys for a DisplayName value of Symantec Endpoint Protection? I've looked at the registry plugin wiki page, but I don't believe that I am understanding the documentation.<br><br>Any help would be appreciated.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">jpderuiter</span><br><span class="post-time small text-muted">7th March 2013 18:25 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">You should read the documentation included with the plugin, as the wiki page is far from complete.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">mordack</span><br><span class="post-time small text-muted">7th March 2013 19:22 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">I've read the documentation included, and I still have the same question. How do I find the GUID of the installed program in the registry? I can search for the DisplayName Value, but how can i translate that to a GUID to uninstall?</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">jpderuiter</span><br><span class="post-time small text-muted">7th March 2013 19:43 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">When using the example (${registry::Find} "$0" $1 $2 $3 $4), $1 will hold the registry path of your program.<br>This path contains your GUID.<br>You should be able to extract the GUID using <a href="http://nsis.sourceforge.net/Docs/AppendixE.html#E.3.2" target="_blank">WordFind</a>.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Anders</span><br><span class="post-time small text-muted">8th March 2013 00:55 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">You can enumerate keys and values with the NSIS EnumReg* instructions, no need to use a plugin</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">mordack</span><br><span class="post-time small text-muted">8th March 2013 19:46 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">OK. The thing is, I only know the DisplayName value. I need the GUID from the uninstall key so I can use it in an uninstall string. I'm not sure what's the most efficient way of getting that GUID.<br><br>Am I making any sense? I may also be going about this the wrong way.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">demiller9</span><br><span class="post-time small text-muted">8th March 2013 20:16 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">You'll need to enumerate through the registry keys looking at the DisplayName. When you see the correct one, the uninstall string entry in the same key will have the path (GUID) you're looking for.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">mithunsanghavi</span><br><span class="post-time small text-muted">11th March 2013 15:52 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Hello,<br>Check these Articles:<br><br>How to uninstall the Symantec Endpoint Protection Client using the Microsoft Installer (MSI) command line interface.<br><br><a href="http://www.symantec.com/docs/TECH102470" target="_blank">http://www.symantec.com/docs/TECH102470</a><br><br>SEPprep competitive product uninstall tool<br><br><a href="http://www.symantec.com/docs/TECH148513" target="_blank">http://www.symantec.com/docs/TECH148513</a><br><br>Also take a glance at these 3 links and let me know if this answers your question.<br><br><a href="http://www.symantec.com/connect/forums/uninstalling-sep-remotely" target="_blank">http://www.symantec.com/connect/foru...g-sep-remotely</a><br><br><a href="http://www.symantec.com/connect/forums/remote-uninstallation" target="_blank">http://www.symantec.com/connect/foru...uninstallation</a><br><br><a href="https://www-secure.symantec.com/connect/forums/uninstall-client-remotely" target="_blank">https://www-secure.symantec.com/conn...lient-remotely</a><br><br>Hope that helps!!</p></div><hr><div class="footer"><p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p></div></div><script src="../js/highlight.pack.js" type="text/javascript"></script><script type="text/javascript">//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]></script></body></html>