<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="description" content="labels on the finish page"><title>labels on the finish page - NSIS Forums</title><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script><link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css"><link rel="stylesheet" href="../css/style.css" type="text/css"><!--[if lt IE 9]><script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script><script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script><![endif]--></head><body><div class="container"><ol class="breadcrumb"><li><a href="../index.html" class="glyphicon glyphicon-home"></a></li><li><a href="f-65.html">NSIS Discussion</a></li><li class="active">labels on the finish page</li></ol><p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=287548">labels on the finish page</a></p><br><div class="post"><p class="post-meta"><span class="post-author text-primary">bubu</span><br><span class="post-time small text-muted">25th February 2008 11:58 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>labels on the finish page</strong><br>i am trying to put labels on my finish page depending on what is installed during my process. so far i could make message boxes to show what was installed. but those appear only at the end after i press the finish button. they were veeery useful but it was for testing only.<br>this is my code for one program..the rest are almost the same:<br><br>Function OnLeaveFinish<br>;jre part<br><br>;Call InstallJRE<br>StrCpy $CorrectJRE $0<br>StrCmp $InstallJRE "no" 0<br><br>${If} $InstallJRE == "no"<br>MessageBox MB_OK "JRE e instalat"<br>${Else}<br>MessageBox MB_OK "JRE s-a instalat ACUM"<br>${EndIf}<br>;other programs<br><br>FunctionEnd<br><br>this is what i have put in my function.<br><br>so...my big problem now is that i cannot do the same but with labels. on the finish page.<br><br>this is how i called the function at the begining:<br>;------------------------------<br>; Finish Page<br>;------------------------------<br><br>!define MUI_FINISHPAGE_RUN<br>!define MUI_FINISHPAGE_RUN_FUNCTION "OnLeaveFinish"<br>!define MUI_FINISHPAGE_TEXT "The following programs were installed on your computer:"<br><br>do you have any idea how to do this? how to put labels on the directly on the finish page...it has to look the same..but instead of message boxes ,,there has to be labels.<br>thank you!</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br><span class="post-time small text-muted">25th February 2008 13:25 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Why not use a ListBox control? You need to modify ioSpecial.ini at run time before the finish page is displayed. Search the forum for ioSpecial.ini<br><br>Stu</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">bubu</span><br><span class="post-time small text-muted">26th February 2008 06:45 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>why?</strong><br>why do i have to use a listbox? i was thinking that if i could do the if-else thing with message boxes it should be pretty much the same with labels...but it does not work yet..:(</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br><span class="post-time small text-muted">26th February 2008 13:10 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Yeh fine you can use a label control, but you have limited space and an item per line may not fit. Either way it doesn't really matter what control you use; the principle is the same. Concatenate your text to a global variable using StrCpy:<br><br>StrCpy $MyVar `new text$\r$\n$MyVar`<br><br>Then you can display this text on the finish page by writing it to ioSpecial.ini before showing the finish page (PRE function). Like I said, search for ioSpecial.ini and you will find plenty of examples for adding your own controls to the finish page (assuming you can find room to fit it in).<br><br>Stu</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">bubu</span><br><span class="post-time small text-muted">26th February 2008 18:20 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>yep</strong><br>i have solved the problem...i used iospecial.ini. i made a function to create those labels. thx:)</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">bubu</span><br><span class="post-time small text-muted">26th February 2008 18:58 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">now it's true that xp has a problem with setting the background ? i found loads of topics with text and backgrounds etc... but nothing can change my grey background... it's silly<br><br>this is what i have written in my function to set the colors:<br><br>ReadINIStr $0 "$PLUGINSDIR\iospecial.ini" "Field 6" "HWND"<br>SetCtlColors $0 0x000000 transparent<br><br>ReadINIStr $0 "$PLUGINSDIR\iospecial.ini" "Field 7" "HWND"<br>SetCtlColors $0 0x000000 transparent<br><br>ReadINIStr $0 "$PLUGINSDIR\iospecial.ini" "Field 8" "HWND"<br>SetCtlColors $0 0x000000 transparent<br><br>ReadINIStr $0 "$PLUGINSDIR\iospecial.ini" "Field 8" "HWND"<br>SetCtlColors $0 0x000000 transparent<br>InstallOptions::show</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">bubu</span><br><span class="post-time small text-muted">27th February 2008 00:26 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>almost there</strong><br>this is what i declared first:<br>!define MUI_PAGE_CUSTOMFUNCTION_PRE CreateControls<br>!define MUI_PAGE_CUSTOMFUNCTION_SHOW SetControlColours<br>!define MUI_INSTALLCOLORS "0xFFFFFF 0x000000"<br><br>then..the functions:<br><br>Function CreateControls<br>;pcvisit label<br>WriteINIStr "$PLUGINSDIR\iospecial.ini" "Settings" "NumFields" "8"<br>WriteINIStr "$PLUGINSDIR\iospecial.ini" "Field 8" "Type" "Label"<br>IfFileExists "$PROGRAMFILES\PCVisit\PC_Visit.exe" 0<br>WriteINIStr "$PLUGINSDIR\iospecial.ini" "Field 8" "Text" "$(DESC_Section5)"<br>WriteINIStr "$PLUGINSDIR\iospecial.ini" "Field 8" "Left" "120"<br>WriteINIStr "$PLUGINSDIR\iospecial.ini" "Field 8" "Right" "270"<br>WriteINIStr "$PLUGINSDIR\iospecial.ini" "Field 8" "Top" "142"<br>WriteINIStr "$PLUGINSDIR\iospecial.ini" "Field 8" "Bottom" "154"<br>WriteINIStr "$PLUGINSDIR\iospecial.ini" "Field 8" "State" "3"<br>FunctionEnd<br><br>Function SetControlColours<br><br>InstallOptions::InitDialog /NOUNLOAD "iospecial.ini"<br>ReadINIStr $0 "$PLUGINSDIR\iospecial.ini" "Field 8" "HWND"<br>SetCtlColors $0 0x000000 transparent<br>; Reload window<br>GetDlgItem $0 $HWNDPARENT 1<br>ShowWindow $0 ${SW_HIDE}<br>ShowWindow $0 ${SW_SHOW}<br>; Now show the dialog and wait for it to finish<br>InstallOptions::show<br>FunctionEnd<br><br><br>but i STILL have the gray background where the labels are... like in the attached photo above. :-&lt;</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">demiller9</span><br><span class="post-time small text-muted">27th February 2008 01:33 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">You are getting the handle of the Next (Finish) button with "GetDlgItem 1". Try using the id of the static control where the text is written: 1202.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">bubu</span><br><span class="post-time small text-muted">27th February 2008 07:28 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>i could only wish</strong><br>well..didn't worked.:( and by the way with that "field 8" i have field6, field 7, field 9.<br>...and i am so sure this is a very simple thing...annoying<br>my code:<br><br>Function SetControlColours<br><br>ReadINIStr "$0" "$PLUGINSDIR\ioSpecial.ini" "Field 6" "HWND"<br>GetDlgItem $0 $HWNDPARENT 1205<br>;SetCtlColors "$0" "000000" Transparent<br><br>ReadINIStr "$0" "$PLUGINSDIR\ioSpecial.ini" "Field 7" "HWND"<br>GetDlgItem $0 $HWNDPARENT 1206<br>;SetCtlColors "$0" "000000" Transparent<br><br>ReadINIStr "$0" "$PLUGINSDIR\ioSpecial.ini" "Field 8" "HWND"<br>GetDlgItem $0 $HWNDPARENT 1207<br>;SetCtlColors "$0" "000000" Transparent<br><br>ReadINIStr "$0" "$PLUGINSDIR\ioSpecial.ini" "Field 9" "HWND"<br>GetDlgItem $0 $HWNDPARENT 1208<br>;SetCtlColors "$0" "000000" Transparent<br><br>; Reload window<br>!insertmacro MUI_INSTALLOPTIONS_INITDIALOG "ioSpecial.ini"<br>Pop $0 ;HWND<br>GetDlgItem $0 $HWNDPARENT 1<br>SetCtlColors $0 "FFFFFF" Transparent<br><br>ShowWindow $0 ${SW_HIDE}<br>ShowWindow $0 ${SW_SHOW}<br>FunctionEnd</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">bubu</span><br><span class="post-time small text-muted">27th February 2008 08:29 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">here is a print screen of what i was talking above.<br>and now instead of:<br>GetDlgItem $0 $HWNDPARENT 1 i put 1202 and it appears an install button, instead of a close one. geesh<br>how can i make it to be the finish button, not the install one?</p></div><hr><div class="footer"><p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p></div></div><script src="../js/highlight.pack.js" type="text/javascript"></script><script type="text/javascript">//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]></script></body></html>