<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="[Listbox] Change color of listitem &amp; sort items alphabetically" />

  <title>[Listbox] Change color of listitem &amp; sort items alphabetically - NSIS Forums</title><!-- Bootstrap core CSS -->
  <link rel="stylesheet" type="text/css" href="//netdna.bootstrapcdn.com/bootswatch/3.0.1/readable/bootstrap.min.css" />
  <link rel="stylesheet" href="../css/style.css" type="text/css" /><!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!--[if lt IE 9]>
                <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
                <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->
</head>

<body>
  <div class="container">
    <!-- Put navigation bar here -->

    <ol class="breadcrumb">
      <li><a href="../index.html" class="glyphicon glyphicon-home"></a></li>

      <li><a href="f-65.html">NSIS Discussion</a></li>

      <li class="active">[Listbox] Change color of listitem &amp; sort items alphabetically</li>
    </ol>

    <p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=259450">[Listbox] Change color of listitem &amp; sort items alphabetically</a></p><br />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Chieftec</span><br />
      <span class="post-time small text-muted">13th November 2006 18:04 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>[Listbox] Change color of listitem &amp; sort items alphabetically</strong><br />
      Hi,<br />
      <br />
      I am using a list box in my custom page. If a checkbox is selected the selected item in the listbox should change its color. How I able to do this?<br />
      <br />
      Still another question:<br />
      Is it possible to sort the items in the listbox alphabetically?<br />
      <br />
      Thank you in anticipation</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Chieftec</span><br />
      <span class="post-time small text-muted">14th November 2006 21:29 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Really nobody who can help?</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
      <span class="post-time small text-muted">14th November 2006 22:00 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Unless you want to write a plugin there is no way to change the colours for an individual list box item.<br />
      To sort the items it'd be easiest to use the NSIS Array plugin. You can add the items to an array with WriteListC, use Sort to sort the array and finally write back to the INI file with Concat. <a href="http://nsis.sf.net/File:NSISArray.zip" target="_blank">http://nsis.sf.net/File:NSISArray.zip</a><br />
      <br />
      -Stu</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
      <span class="post-time small text-muted">14th November 2006 23:44 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">You could also set the LBS_SORT style for the list by calling SetWindowLong using the System plug-in. If that doesn't work, you'd have to change the style on advance when creating it. For that you'd have to change the source code of InstallOptions.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">davidnewcomb</span><br />
      <span class="post-time small text-muted">3rd August 2007 17:00 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Any chance you could give us the magic line to use "LBS_SORT" to sort list boxes. I can't find an example of that.<br />
      Thanks,</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
      <span class="post-time small text-muted">3rd August 2007 17:29 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"></p>
      <pre>
<code>!define GWL_STYLE -16<br />!define LBS_SORT 0x0002L<br />System::Call `user32::GetWindowLong(i R0, i ${GWL_STYLE}) i.R1`<br />IntOp $R1 $R1 | ${LBS_SORT}<br />System::Call `user32::SetWindowLong(i R0, i ${GWL_STYLE}, i R1)`</code>
</pre><br />
      Assuming $R0 contains the handle to your list box before you call it. Read it from the INI file HWND key or by using GetDlgItem.<br />
      <br />
      Stu
    </div>
    <hr />

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]>
  </script>
</body>
</html>
