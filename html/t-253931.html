<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="silent - uninstall" />

  <title>silent - uninstall - NSIS Forums</title>
  <script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script>
  <!-- Bootstrap core CSS -->

  <link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css" />
  <link rel="stylesheet" href="../css/style.css" type="text/css" /><!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!--[if lt IE 9]>
                <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
                <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->
</head>

<body>
  <div class="container">
    <!-- Put navigation bar here -->

    <ol class="breadcrumb">
      <li><a href="../index.html" class="glyphicon glyphicon-home"></a></li>

      <li><a href="f-65.html">NSIS Discussion</a></li>

      <li class="active">silent - uninstall</li>
    </ol>

    <p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=253931">silent - uninstall</a></p><br />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">coco_vc</span><br />
      <span class="post-time small text-muted">23rd August 2006 17:23 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>silent - uninstall</strong><br />
      Hi all,<br />
      <br />
      In the registry at the key "Software\Microsoft\Windows\CurrentVersion\Uninstall\${PRODUCT_NAME}" is the entry UninstallString which in my case is: "$INSTDIR\uninst.exe". So when uninstalled from add/remove programs, the uninst.exe will be run with no params and not in silent mode so it will ask for user interaction.<br />
      <br />
      I am not familiar with "network install", but afaik in big companies the administrators are using this type of installation, so that it installs the same software on several user's machines without the user interaction. I assume the same is done with uninstalling.<br />
      So, in such a scenario, how could the admin uninstall silently the product? (as said I'm not familiar with this procedure). Is there a way for him to find out the $INSTDIR, so that then to call the $INSTDIR\uninst.exe -S?<br />
      <br />
      Thx,<br />
      Viv</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Comperio</span><br />
      <span class="post-time small text-muted">23rd August 2006 17:34 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">I would probably allow for your own command line parameters and then process them on .onInit (for the install) or un.onInit (for the uninstall).<br />
      <br />
      The advantage here is that it will allow you to add support for other parameters (such as folder paths, etc.) rather than just being silent or not.<br />
      <br />
      And for what it's worth:<br />
      Most big companies (espeically those that are publicly traded) that I've worked with have to carefully audit any type of software activity. (are you familiar with the Sarbanes-Oxley act? If not, you might Google it to find out more.)<br />
      <br />
      But, as a result of this, most will usually use MSI-based installations with Active Directory since that gives more control to the administrator of what can get installed and helps them manage permissions granted during an install.<br />
      <br />
      <br />
      Plus, most also require that any installation or other program is digitally signed to ensure the install is "safe".<br />
      <br />
      All these things are still do-able with NSIS, albeit perhaps a little more difficult.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">coco_vc</span><br />
      <span class="post-time small text-muted">24th August 2006 14:15 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"></p>

      <blockquote>
        I would probably allow for your own command line parameters and then process them on .onInit (for the install) or un.onInit (for the uninstall).
      </blockquote>Yes, of course, I will process cmd line params for everything that the user could normally chose in the uninstaller. But my question was a little different: in a company where the admin wants to silently uninstall the product from several machines, how can he start the uninstaller? how can he find out the path to the uninstaller?<br />
      <br />

      <blockquote>
        And for what it's worth:...
      </blockquote>In my case, the "big company" will actually build the installer itself, so it will have the script, so can see right away what is done during installing.<br />
      <br />
      The MSI didn't fit at all our requirements, so we drop that.<br />
      <br />
      Also, as my installer installs an LSP (layered service provider), it will need admin rights during installing.<br />
      <br />
      As far as I understood also "normal" exes can be run similar to Active Directory with MSI.<br />
      <br />
      Thx,<br />
      Viv
    </div>
    <hr />

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]>
  </script>
</body>
</html>
