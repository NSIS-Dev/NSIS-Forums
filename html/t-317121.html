<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="description" content="Windows7 - Desktop and QuickLaunch shortcut"><title>Windows7 - Desktop and QuickLaunch shortcut - NSIS Forums</title><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script><link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css"><link rel="stylesheet" href="../css/style.css" type="text/css"></head><body><div class="container"><ol class="breadcrumb"><li><a href="../index.html" class="glyphicon glyphicon-home"></a></li><li><a href="f-65.html">NSIS Discussion</a></li><li class="active">Windows7 - Desktop and QuickLaunch shortcut</li></ol><p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=317121">Windows7 - Desktop and QuickLaunch shortcut</a></p><br><div class="post"><p class="post-meta"><span class="post-author text-primary">Cyrille</span><br><span class="post-time small text-muted">18th February 2010 18:08 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>Windows7 - Desktop and QuickLaunch shortcut</strong><br>Dear all,<br><br>I am currently experiencing problem with my installation package created with NSIS Compiler V2.3. The problem has been identified only by a user with Windows 7. If the desktop and QuickLaunch shortcuts are well created, he has also noticed that the shortcut to the application is also created in:<br><br>c:\users\Administrator.WIN-XXX\Desktop\<br>and :<br>c:\users\Administrator.WIN-XXX\AppData\Roaming\Microsoft\Internet Explorer\Quick Launch\<br><br>where XXX is the real name of his Windows account.<br><br>To create the short cut, I have used the following code:<br><br></p><pre>
<code>CreateShortCut "$DESKTOP\my_app.lnk" "$INSTDIR\my_app.exe"<br>CreateShortCut "$QUICKLAUNCH\my_app.lnk" "$INSTDIR\my_app.exe"</code>
</pre><br>
      <br>
      Is it a bug with my code or something normal with Windows 7?<br>
      <br>
      Thank you very much for your kind support<br>
      Best regards,<br>
      Cyrille
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Anders</span><br>
      <span class="post-time small text-muted">18th February 2010 18:25 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Those paths looks correct to me, what is the actual problem? (Also, 2.3 is kind of old, you might want to upgrade so you can use RequestExecutionLevel)</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Yathosho</span><br>
      <span class="post-time small text-muted">18th February 2010 21:17 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">afaik there is no more quicklaunch in win7</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">pengyou</span><br>
      <span class="post-time small text-muted">18th February 2010 21:53 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Windows 7 still supports QuickLaunch - all you have to do is enable it. The first hit in a Google search gave me step-by-step instructions for enabling it.</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Yathosho</span><br>
      <span class="post-time small text-muted">18th February 2010 22:39 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">support yes, but with taskbar pinning nobody has a reason to go back to quicklaunch. there already is a discussion that suggests not to pin programs <a href="http://forums.winamp.com/showthread.php?s=&amp;threadid=315186&amp;highlight=pin+windows+taskbar" target="_blank">here</a>.</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">pengyou</span><br>
      <span class="post-time small text-muted">19th February 2010 00:21 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"></p>

      <blockquote>
        <i>Originally posted by Yathosho</i><br>
        <b>with taskbar pinning nobody has a reason to go back to quicklaunch.</b>
      </blockquote>Sorry, I disagree. I find QuickLaunch <b><u>very</u></b> useful in Windows 7.
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Cyrille</span><br>
      <span class="post-time small text-muted">19th February 2010 13:47 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"></p>

      <blockquote>
        <i>Originally posted by Anders</i><br>
        <b>Those paths looks correct to me, what is the actual problem? (Also, 2.3 is kind of old, you might want to upgrade so you can use RequestExecutionLevel)</b>
      </blockquote>In fact, the correct path should be \XXX\ (i.e. without the administrator.WIN). However, the person informed me that these shorcuts were created from a previous installer. The last one do not create these shortcuts. Everything is fine thus. Thank you very much and sorry.<br>
      <br>
      I am going to check the forum about the use of RequestExecutionLevel. Thanks again :)<br>
      <br>
      Cyrille
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Anders</span><br>
      <span class="post-time small text-muted">19th February 2010 15:53 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">I'm guessing the Administrator.WIN prefix could have been added by windows itself during a reinstall or account name change, either way, NSIS just uses what windows tells it to use as the shell path</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Cyrille</span><br>
      <span class="post-time small text-muted">19th February 2010 17:43 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">I would bet on the account kept from an updated from a previous version of Windows :)</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Cyrille</span><br>
      <span class="post-time small text-muted">19th February 2010 17:53 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"></p>

      <blockquote>
        <i>Originally posted by Anders</i><br>
        <b>Those paths looks correct to me, what is the actual problem? (Also, 2.3 is kind of old, you might want to upgrade so you can use RequestExecutionLevel)</b>
      </blockquote>Probably a stupid question: I would like to know if RequestExecutionLevel defines the requested execution level of the install package (and thus the choice depends on the NSIS script) or of the .exe file of the installed application?<br>
      <br>
      Thank you very much<br>
      Cyrille
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Anders</span><br>
      <span class="post-time small text-muted">19th February 2010 18:46 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"></p>

      <blockquote>
        <i>Originally posted by Cyrille</i><br>
        <b>Probably a stupid question: I would like to know if RequestExecutionLevel defines the requested execution level of the install package (and thus the choice depends on the NSIS script) or of the .exe file of the installed application?<br>
        <br>
        <br>
        Cyrille</b>
      </blockquote>Installer and Uninstaller
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Cyrille</span><br>
      <span class="post-time small text-muted">20th February 2010 19:19 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Ok, so I suppose the admin rights are only necessary when the installer writes in the registry. Is it correct?</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Anders</span><br>
      <span class="post-time small text-muted">20th February 2010 20:04 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Its necessary if you want to do admin things (DOH) like writing to HKLM or $programfiles/$windir etc</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Cyrille</span><br>
      <span class="post-time small text-muted">21st February 2010 13:02 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Ok, thank you very much Anders. It is very clear now :)</p>
    </div>
    <hr>

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]></script></body></html>