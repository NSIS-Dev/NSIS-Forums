<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="CreateShortCut issue" />

  <title>CreateShortCut issue - NSIS Forums</title>
  <script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script>
  <!-- Bootstrap core CSS -->

  <link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css" />
  <link rel="stylesheet" href="../css/style.css" type="text/css" /><!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!--[if lt IE 9]>
                <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
                <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->
</head>

<body>
  <div class="container">
    <!-- Put navigation bar here -->

    <ol class="breadcrumb">
      <li><a href="../index.html" class="glyphicon glyphicon-home"></a></li>

      <li><a href="f-65.html">NSIS Discussion</a></li>

      <li class="active">CreateShortCut issue</li>
    </ol>

    <p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=203892">CreateShortCut issue</a></p><br />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Artmageddon</span><br />
      <span class="post-time small text-muted">4th January 2005 20:08 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>CreateShortCut issue</strong><br />
      Hey, I'm having a bit of a hard time using CreateShortcut with an app of mine. Basically, I'm installing a set of programs, each with their own folder, and each of those folders will be in a main folder(which will, in turn, be in the program files folder). Basically, an example of this would be:<br />
      <br />
      C:\Program Files\AllGames\GameSet1\GameA<br />
      C:\Program Files\AllGames\GameSet1\GameB<br />
      C:\Program Files\AllGames\GameSet2\...<br />
      and so on.<br />
      <br />
      What I'm doing here is that I'm giving the user the default path of installing to:<br />
      C:\Program Files\AllGames\GameSet1<br />
      (since other sets will be handled by other installers),<br />
      and here, two separate subfolders will be placed in GameSet1, aptly named GameA and GameB. $INSTDIR has been set to this path.<br />
      <br />
      The problem I'm having is with the Start In not matching up with the folder in the target. One of the games I'm installing is very particular about the way the shortcut defines where the .exe is and where it's supposed to look(otherwise it doesn't work). We have a 3rd-party system that wrapped our software with some special stuff, so it makes things a little hairy(though I know it's not the cause of the problem). Basically, what's happening is that the 3rd-party's page loads, so it's finding the .exe through some special windows trick or another, but the actual game won't load since the .exe isn't found in the start in folder.<br />
      <br />
      The .exe is in<br />
      C:\Program Files\MyGames\GameSet1\GameA\, and the start in folder is:<br />
      <br />
      C:\Program Files\MyGames\<br />
      <br />
      How do I make these two match? I'm already using:<br />
      CreateShortCut "$R5\$R1.lnk" "$INSTDIR\GameA\RocketBowl.exe" "" "$INSTDIR\GameA\RocketBowl.exe", where $R5 is the desktop path, $R1 is the text caption for the icon.<br />
      <br />
      This issue applies to the start menu shortcuts, too.<br />
      <br />
      Please help, so confused :(</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
      <span class="post-time small text-muted">4th January 2005 20:11 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">SetOutPath sets the working directory of the shortcut.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Artmageddon</span><br />
      <span class="post-time small text-muted">4th January 2005 20:14 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">So I just do something like:<br />
      SetOutPath "C:\Program...&lt;exe target&gt;", and then do the CreateShortCut?</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
      <span class="post-time small text-muted">4th January 2005 20:16 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Yes, you use SetOutPath with the desired working directory and then CreateShortcut.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Artmageddon</span><br />
      <span class="post-time small text-muted">4th January 2005 20:17 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">oh Thank God, I finally got it.<br />
      <br />
      And thank you of course...I've been stuck on this for an embarrassing amount of time :)</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
      <span class="post-time small text-muted">4th January 2005 21:43 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Does it mention in the manual that SetOutPath sets current 'start in' path for CreateShortcut's?<br />
      <br />
      -Stu</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">flizebogen</span><br />
      <span class="post-time small text-muted">5th January 2005 12:00 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Yes.<br />
      <br />
      From the Docs:<br /></p>

      <blockquote>
        $OUTDIR is used for the working directory. You can change it by using SetOutPath before creating the Shortcut.
      </blockquote>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">deguix</span><br />
      <span class="post-time small text-muted">5th January 2005 12:34 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Whoops, wrong topic!</p>
    </div>
    <hr />

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]>
  </script>
</body>
</html>
