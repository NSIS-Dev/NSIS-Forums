<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="description" content="BgImage and taskbar: how to hide?"><title>BgImage and taskbar: how to hide? - NSIS Forums</title><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script><link rel="preload" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css" as="style" onload="this.rel='stylesheet'"><link rel="preload" href="../css/style.css" as="style" onload="this.rel='stylesheet'"><noscript><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css"><link rel="stylesheet" href="../css/style.css"></noscript><script>!function(a){"use strict";var b=function(b,c,d){function e(a){return h.body?a():void setTimeout(function(){e(a)})}function f(){i.addEventListener&&i.removeEventListener("load",f),i.media=d||"all"}var g,h=a.document,i=h.createElement("link");if(c)g=c;else{var j=(h.body||h.getElementsByTagName("head")[0]).childNodes;g=j[j.length-1]}var k=h.styleSheets;i.rel="stylesheet",i.href=b,i.media="only x",e(function(){g.parentNode.insertBefore(i,c?g:g.nextSibling)});var l=function(a){for(var b=i.href,c=k.length;c--;)if(k[c].href===b)return a();setTimeout(function(){l(a)})};return i.addEventListener&&i.addEventListener("load",f),i.onloadcssdefined=l,l(f),i};"undefined"!=typeof exports?exports.loadCSS=b:a.loadCSS=b}("undefined"!=typeof global?global:this);!function(a){if(a.loadCSS){var b=loadCSS.relpreload={};if(b.support=function(){try{return a.document.createElement("link").relList.supports("preload")}catch(b){return!1}},b.poly=function(){for(var b=a.document.getElementsByTagName("link"),c=0;c<b.length;c++){var d=b[c];"preload"===d.rel&&"style"===d.getAttribute("as")&&(a.loadCSS(d.href,d,d.getAttribute("media")),d.rel=null)}},!b.support()){b.poly();var c=a.setInterval(b.poly,300);a.addEventListener&&a.addEventListener("load",function(){b.poly(),a.clearInterval(c)}),a.attachEvent&&a.attachEvent("onload",function(){a.clearInterval(c)})}}}(this);</script></head><body><div class="container"><ol class="breadcrumb"><li><a href="../index.html" class="glyphicon glyphicon-home"></a></li><li><a href="f-65.html">NSIS Discussion</a></li><li class="active">BgImage and taskbar: how to hide?</li></ol><p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=205927">BgImage and taskbar: how to hide?</a></p><br><div class="post"><p class="post-meta"><span class="post-author text-primary">laker</span><br><span class="post-time small text-muted">25th January 2005 20:16 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>BgImage and taskbar: how to hide?</strong><br>Hello,<br><br>I'm trying to use BgImage plugin to change the background of my installer. Unfortunately it seems that my BgImage plugins can't write over my taskbar and so the final result is very bad.<br><br>I've read some old thread and say that it's possible to hide or write over the taskbar ... unfortuantely is not happening on my PC.<br>What is wrong?<br>Is my PC drunk? or it's a known problem?<br><br>I'm just trying standard BgImage example on the latest NSIS 2.04 release and my PC has Win2k (taskbar is normal and without auto-hide).<br><br>Many thanks,</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">laker</span><br><span class="post-time small text-muted">26th January 2005 16:06 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Auto answer :)<br><br>I've checked on another computer with Windows XP and sometimes the taskbar get hidden (sometimes not).<br><br>So, I've slightly modified the source code of BgImage.cpp to hide the taskbar in any case.<br><br>Here attached the source code modified.<br>Somebody to check this? suggestions?<br><br>Taskbar hidden when calling SetBg, restored when calling Destroy.<br><br>Many Thanks,</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Takhir</span><br><span class="post-time small text-muted">26th January 2005 20:05 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">This works till installer works correct, on any error user can suddenly find his desktop without (hidden) task bar. SHAppBarMessage with ABM_SETAUTOHIDEBAR or ABM_SETSTATE is also a possible way, and on installer crash user can restore alwaysontop task bar mode from autohide (but VS 7 headers says, this may also fails). google finds few ABM_SETAUTOHIDEBAR code samples. SystemParametersInfo SPI_GETWORKAREA can give screen rect for any case.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">laker</span><br><span class="post-time small text-muted">30th January 2005 08:53 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Many thanks for your answer ;)<br><br>I've found that:<br><a href="http://www.experts-exchange.com/Programming/Programming_Languages/Delphi/Q_20140981.html" target="_blank">http://www.experts-exchange.com/Prog..._20140981.html</a><br><br>Unfortunately is not possibile to turn Auto Hide on and off. That's because windows task bar is a system process and it's locked to this.<br><br>So, there is no way ... I've tried and it's not working.<br><br>The only solution is to work in my direction (hiding the taskbar window).<br><br>Question:<br>There is a way to get a callback when the installer crashes or quits without calling .onGUIEnd?<br>:-)<br><br><br>I think not ... but ... who knows ...</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Takhir</span><br><span class="post-time small text-muted">30th January 2005 09:45 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Yes, I tested ABM_SETAUTOHIDEBAR too - not wokrs with system task bar :(<br>To work with SW_HIDE/SHOW you should also track focus lost and window minimize events.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">laker</span><br><span class="post-time small text-muted">31st January 2005 15:43 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Many thanks,<br><br>Now I've hooked minimize, maximize and focus lost messages. You can switch application with ALT+TAB without problem even if some popup appears. It seems to be the best solution.<br><br>The only problem is when the installer for some reason crashes, the user will not have anymore a taskbar :) but after a reboot everything will be back in the original state ;)</p></div><hr><div class="footer"><p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p></div></div><script src="../js/highlight.pack.js" type="text/javascript"></script><script type="text/javascript">//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]></script></body></html>