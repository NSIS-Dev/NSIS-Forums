<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="Make installer topmost window." />

  <title>Make installer topmost window. - NSIS Forums</title>
  <script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script>
  <!-- Bootstrap core CSS -->

  <link rel="stylesheet" type="text/css" href="//netdna.bootstrapcdn.com/bootswatch/3.0.1/readable/bootstrap.min.css" />
  <link rel="stylesheet" href="../css/style.css" type="text/css" /><!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!--[if lt IE 9]>
                <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
                <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->
</head>

<body>
  <div class="container">
    <!-- Put navigation bar here -->

    <ol class="breadcrumb">
      <li><a href="../index.html" class="glyphicon glyphicon-home"></a></li>

      <li><a href="f-65.html">NSIS Discussion</a></li>

      <li class="active">Make installer topmost window.</li>
    </ol>

    <p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=287202">Make installer topmost window.</a></p><br />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">NEHOG</span><br />
      <span class="post-time small text-muted">19th February 2008 17:19 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>Make installer topmost window.</strong><br />
      The 'powers at be' asked that we make the installer a topmost window (in windows one would use the API) :<br />
      <br />
      SetWindowPos Me.hwnd, HWND_TOPMOST, 0, 0, 0, 0, SWP_NOSIZE Or SWP_NOMOVE<br />
      <br />
      This keeps the application (the installer in this case) always on top of other windows (like TaskManager...) so it won't get lost. (I think marketing feels that users are loosing the installer for some reason...)<br />
      <br />
      Search didn't really get me anything, so if anyone has suggestions...<br />
      ;)</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
      <span class="post-time small text-muted">19th February 2008 17:32 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Use System plug-in.<br />
      <br />
      Stu</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">NEHOG</span><br />
      <span class="post-time small text-muted">20th February 2008 20:42 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"></p>

      <blockquote>
        <i>Originally posted by Afrow UK</i><br />
        <b>Use System plug-in.<br />
        <br />
        Stu</b>
      </blockquote>Thanks Stu. For others later looking at this thread, here is the final result:<br />
      <pre>
<code><br /><br />!include "${NSISDIR}\Examples\System\System.nsh"<br /># --- Define and make accessible the system plugin.<br /># before 2.07 !include "${NSISDIR}\Contrib\System\System.nsh"<br /><br /># --- The function to force a window to be topmost. <br /><br />Function WindowToTop<br />        ;Save existing register values to the stack<br />        Push $0<br />        Push $1<br />        Push $2<br />        Push $3<br />        Push $4<br />        Push $5<br />        Push $6<br />        Push $7<br /><br />;       HWND_TOPMOST not defined in the system plugin, so we define it here instead.  <br />        !define HWND_TOPMOST   -1<br />  <br />;       SetWindowPos(Me.hwnd, HWND_TOPMOST, 0, 0, 0, 0, SWP_NOSIZE Or SWP_NOMOVE) 'These two lines bring the window<br /><br />        System::Call "User32::SetWindowPos(i, i, i, i, i, i, i) b ($HWNDPARENT, ${HWND_TOPMOST}, 0, 0, 0, 0, ${SWP_NOMOVE}|${SWP_NOSIZE})"<br /> <br />        ;Restore register values from the stack<br />        Pop $7<br />        Pop $6<br />        Pop $5<br />        Pop $4<br />        Pop $3<br />        Pop $2<br />        Pop $1<br />        Pop $0<br />FunctionEnd<br /><br /></code>
</pre><br />
      <br />
      The WindowToTop function then can be called from within the NSIS script as needed.
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Anders</span><br />
      <span class="post-time small text-muted">20th February 2008 21:56 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">you don't have to save the registers if you are not using any of them ;)</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">NEHOG</span><br />
      <span class="post-time small text-muted">21st February 2008 01:47 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Good point... (Teach me to cut-n-paste!)</p>
    </div>
    <hr />

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]>
  </script>
</body>
</html>
