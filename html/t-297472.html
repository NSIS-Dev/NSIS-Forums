<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="description" content="Progressbar for extraction"><title>Progressbar for extraction - NSIS Forums</title><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script><link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css"><link rel="stylesheet" href="../css/style.css" type="text/css"></head><body><div class="container"><ol class="breadcrumb"><li><a href="../index.html" class="glyphicon glyphicon-home"></a></li><li><a href="f-65.html">NSIS Discussion</a></li><li class="active">Progressbar for extraction</li></ol><p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=297472">Progressbar for extraction</a></p><br><div class="post"><p class="post-meta"><span class="post-author text-primary">JockeL</span><br><span class="post-time small text-muted">16th September 2008 16:09 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>Progressbar for extraction</strong><br>Hi all!<br><br>We only use the NSIS compiler as to package our own installation in an easy way for our customers. We have used this solution for quite some time but I myself am completely new to working with NSIS.<br><br>So far NSIS has been run in silentmode and just executed our setup.exe installer which runs in normal mode (not silent). However now we have packages that are up to 200-400 mb and in silent mode it looks to the customer as though nothing is happening when we extract the files in silent mode.<br><br>I have been trying to just include the MUI_PAGE_INSTFILES which shows the progressbar fine but when our executable is called this dialog doesn't close but is still shown behind.<br><br>All help appreciated<br>/Joakim</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">kichik</span><br><span class="post-time small text-muted">16th September 2008 17:58 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Doesn't close after the installation is done? Use SetAutoClose or AutoCloseWindow.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">JockeL</span><br><span class="post-time small text-muted">17th September 2008 12:24 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Thank you for your response.<br><br>I would like the dialog to close as soon as extraction is done, I do not want it to wait for our executable to be closed as our installer has its own dialogs and this might be confusing for the end user.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Comperio</span><br><span class="post-time small text-muted">17th September 2008 20:25 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">hmm... are you maybe using ExecWait to launch the 2nd installation? If so, try using just Exec.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">JockeL</span><br><span class="post-time small text-muted">18th September 2008 10:36 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Thank you for your response again!<br><br>Maybe i wasn't being clear and for that I apologize but I am very new to using NSIS.<br><br>We are currently using ExecWait and if we use Exec instead this solves our problem. However we also would like the extraction folder to be deleted upon completion of the installer and currently delete the output folder when installation is done.<br><br>This is only possible by using ExecWait as far as I know. So the scenario we would like to achieve is a scenario where the extraction dialog closes upon completion of the extraction but the excraction folder containing our installer files will not be removed until the installer is finished.<br><br>I will attach my project and appreciate all help I can get.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">demiller9</span><br><span class="post-time small text-muted">18th September 2008 15:10 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">I think you should continue to use ExecWait so that you can delete the extraction folder after the installer completes. While the installer is running you can hide the wrapper program that extracted it.</p><pre>
<code>!include WinMessages.nsh<br>GetDlgItem $0 $HWNDPARENT 1<br>ShowWindow $0 ${SW_HIDE}</code>
</pre>
    </div>
    <hr>

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]></script></body></html>