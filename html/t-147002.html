<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="description" content="Driver Installation Plugin"><title>Driver Installation Plugin - NSIS Forums</title><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script><link rel="preload" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css" as="style" onload="this.rel='stylesheet'"><link rel="preload" href="../css/style.css" as="style" onload="this.rel='stylesheet'"><noscript><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css"><link rel="stylesheet" href="../css/style.css"></noscript><script>!function(a){"use strict";var b=function(b,c,d){function e(a){return h.body?a():void setTimeout(function(){e(a)})}function f(){i.addEventListener&&i.removeEventListener("load",f),i.media=d||"all"}var g,h=a.document,i=h.createElement("link");if(c)g=c;else{var j=(h.body||h.getElementsByTagName("head")[0]).childNodes;g=j[j.length-1]}var k=h.styleSheets;i.rel="stylesheet",i.href=b,i.media="only x",e(function(){g.parentNode.insertBefore(i,c?g:g.nextSibling)});var l=function(a){for(var b=i.href,c=k.length;c--;)if(k[c].href===b)return a();setTimeout(function(){l(a)})};return i.addEventListener&&i.addEventListener("load",f),i.onloadcssdefined=l,l(f),i};"undefined"!=typeof exports?exports.loadCSS=b:a.loadCSS=b}("undefined"!=typeof global?global:this);!function(a){if(a.loadCSS){var b=loadCSS.relpreload={};if(b.support=function(){try{return a.document.createElement("link").relList.supports("preload")}catch(b){return!1}},b.poly=function(){for(var b=a.document.getElementsByTagName("link"),c=0;c<b.length;c++){var d=b[c];"preload"===d.rel&&"style"===d.getAttribute("as")&&(a.loadCSS(d.href,d,d.getAttribute("media")),d.rel=null)}},!b.support()){b.poly();var c=a.setInterval(b.poly,300);a.addEventListener&&a.addEventListener("load",function(){b.poly(),a.clearInterval(c)}),a.attachEvent&&a.attachEvent("onload",function(){a.clearInterval(c)})}}}(this);</script></head><body><div class="container"><ol class="breadcrumb"><li><a href="../index.html" class="glyphicon glyphicon-home"></a></li><li><a href="f-65.html">NSIS Discussion</a></li><li class="active">Driver Installation Plugin</li></ol><p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=147002">Driver Installation Plugin</a></p><br><div class="post"><p class="post-meta"><span class="post-author text-primary">kiszka</span><br><span class="post-time small text-muted">25th August 2003 18:12 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>Driver Installation Plugin</strong><br>Hi,<br><br>I've written a (hopefully) generic plugin for installing and removing device drivers, and I would like to contribute to NSIS.<br><br>There are just some tiny beautifications to do, and I have to revise the example and doc files. But I already want to ask if I should simply post a zip file to this forum and which license terms are prefered here. I usually publish under GPL/LGPL, but I have not problems to select a more relaxed variant in this case.<br><br>If someone is interested: This plugin is going to be used with IrCOMM2k 2.0.0-beta1 (<a href="http://www.ircomm2k.de/english" target="_blank">http://www.ircomm2k.de/english</a>) - it's all Open Source :D<br><br>Jan</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Sunjammer</span><br><span class="post-time small text-muted">26th August 2003 10:12 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">If you'd like I can add your plugin to the <a href="http://nsis.sourceforge.net/archive/download.php" target="_blank">downloads page</a> on the <a href="http://nsis.sf.net" target="_blank">NSIS Archive</a>.<br><br>If what you mean is that you'd like it to be part of the NSIS installation then that's a question for KiCHiK to answer. I must admit I've never understood what determines which plugins are part of the installation and which aren't. It could just be as simple as whether or not one of the developers uploads the code and binaries and modifies makensis.nsi (hehe I guess if that's the case then I'm guilty of not doing this).<br><br>KiCHiK or Joost are more likely to have an opinion about licensing so I'll leave them to address that point.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">kiszka</span><br><span class="post-time small text-muted">28th August 2003 01:17 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Here it is. If could have a look at it and put it on the Download page, this would already be great. Please let me know if there is something which first needs to be fixed or improved.<br><br>I decided to pick the same license as NSIS itself. So a future integration should be no problem, at least from this point of view.<br><br>Jan</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">kichik</span><br><span class="post-time small text-muted">28th August 2003 11:09 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Contributions that are likely to be used by a majority of NSIS users are included in the package itself. If the contribution is not to be included in the package then the license doesn't really matter. If the contribution is to be included in the package, then the license must premit it of course. We don't care what license it is, but we do prefer it open-source.<br><br>Does this plug-in work on all OSes? According to MSDN, some of the functions you've used there are Windows 98, ME, 2000 and XP only.<br><br>For now, I've uploaded it to the Archive. If you want you can createa a page there that will link to its download, describing it a bit.<br><br>Thank you for your contribution.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">kiszka</span><br><span class="post-time small text-muted">28th August 2003 22:44 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">You are right, some of the function calls requires 2000/XP to run. I haven't checked this in details as I don't see that urgent need for the other platforms anymore (at least for driver projects). If someone do need driver setup support there, he/she may rewrite InstDrv appropriately.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">kichik</span><br><span class="post-time small text-muted">29th August 2003 10:52 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Well, that's worth mentioning in the readme. If you have nothing else to update I can add the note myself. Let me know.<br><br>Would be cool though if you update it to support any Windows version. Maybe /DELAYLOAD can help there.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Joost Verburg</span><br><span class="post-time small text-muted">29th August 2003 16:02 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">If you can make it support all Win32 operating system (including Windows 95/NT4), we will add it to the NSIS distribution.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">kiszka</span><br><span class="post-time small text-muted">11th September 2003 00:09 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">I can understand that you are looking for widely usable plugins, but unfortunately I currently don't have the time to back-port InstDrv to older platforms. However, during the development of IrCOMM2k, I fixed a bug and added two functions. Here is the latest version, could someone upload it? Thanks<br><br>PS: The readme now includes a note about the supported Windows version.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Sunjammer</span><br><span class="post-time small text-muted">11th September 2003 00:24 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Done.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Brummelchen</span><br><span class="post-time small text-muted">11th September 2003 01:30 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">where? 8)</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Sunjammer</span><br><span class="post-time small text-muted">11th September 2003 10:41 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Same place as the previous version, <a href="http://nsis.sf.net/archive/download.php" target="_blank">http://nsis.sf.net/archive/download.php</a> at the bottom.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Brummelchen</span><br><span class="post-time small text-muted">11th September 2003 12:57 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">thx</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">andyjin</span><br><span class="post-time small text-muted">8th January 2004 14:19 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">I try to use this plugin to install a device driver for a PCI card in Win2K, but can't get it work. Below is the problem :<br><br>- First at all, I try the example.nsi which comes with the plugin, it works fine and installs the ircomm2k.sys driver on my test box.<br><br>- I modify the example.nsi, change the GUID, HWID, INF filename and SYS filename, to what I want to install.<br><br>- For the devClass, ClassGUID={4d36e971-e325-11ce-bfc1-08002be10318}, which is "Multifunction card"<br><br>- For the devHWID, it's "PCI\VEN_10E3&amp;DEV_0862&amp;SUBSYS_120210E3", which is a PCI card HWID<br><br>- The script compiles fine, but the installation fails without install the driver, below is the detail print :<br><br>InitDriverSetup:<br>DeleteOemInfFiles: 00000103<br>CreateDevice: E0000205<br>Output folder: C:\Docume~1\test\LOCALS~1\Temp<br>Extract: test.inf... 100%<br>Extract: dummy.sys... 100%<br>InstallDriver: E000020B<br>CountDevices:0<br>Completed<br><br>- You can see "CreateDevice" output error code "E0000205". I can't find this error code in any Windows error, is it a custom error code ?<br><br>- Interestingly, if I change the HWID from "PCI\VEN_10E3&amp;DEV_0862&amp;SUBSYS_120210E3" to something simpler, e.g. "testdriver", the installation works fine. Of cause the driver does not talk to the PCI card because the HWID is fake.<br><br>Anyone knows what's going on here? Is the HWID problem, if it's, what should I use for the HWID?<br><br>I attach a zip file which includes the "InstDrv-Test-driver.nsi", "test.inf" and "dummy.sys"in this post. I am using NSIS 2.0 Beta 4.<br><br>Please help, thanks.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">andyjin</span><br><span class="post-time small text-muted">9th January 2004 04:40 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Could anybody help ?</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Joost Verburg</span><br><span class="post-time small text-muted">9th January 2004 12:31 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Try to contact the author of this plug-in.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">PanicMan</span><br><span class="post-time small text-muted">18th November 2004 15:31 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"></p><blockquote><i>Originally posted by andyjin</i><br><b><br>...<br>- The script compiles fine, but the installation fails without install the driver, below is the detail print :<br><br>InitDriverSetup:<br>DeleteOemInfFiles: 00000103<br>CreateDevice: E0000205<br>Output folder: C:\Docume~1\test\LOCALS~1\Temp<br>Extract: test.inf... 100%<br>Extract: dummy.sys... 100%<br>InstallDriver: E000020B<br>CountDevices:0<br>Completed<br>...<br></b></blockquote>I have the same problem. Somehow is it intersting. Sometimes it works, and sometimes not, but with an other driver. And the driver i using now bring allways the message above. I find out that the GUID and the DeviceID have to match the settings in the INF-File. But it still does not work.<br><br>Did the Author find out where is the problem?</div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">mac_ou</span><br><span class="post-time small text-muted">21st February 2005 19:20 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Hi everybody!<br><br>I'm new at this forum. Just to say I was looking for a solution for my problem with InstDrv plug-in and I found in this thread that some people has exactly the same problem as me.<br><br>I'm trying to develop a creator thar includes the drivers for some PCI cards. If I try InstDrv with the usual "PCI\..." HW ID I get the same errors some of you pointed before. If I edit my .inf file and I use any string as the HW ID value, then the problems when the device is created and the driver installed disappear, but then the yellow exclamation appears in the Device Manager list.<br><br>I've written a mail to the author. I hope we can find a solution because I find this plug-in very interesting and useful.<br><br><br>Thank you for your attention and time.<br><br><br>Marcos<br>Ourense, Galicia, Spain.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">anir</span><br><span class="post-time small text-muted">21st February 2005 23:30 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Hello!<br><br>I don't know if it may help, but I was able to solve my driver installation problem without such a plugin.<br><br>I hope it may help:<br><br>DrvInst : <a href="http://home.arcor.de/_aero/drvinst.zip" target="_blank">http://home.arcor.de/_aero/drvinst.zip</a><br>DrvInst "Source": <a href="http://home.arcor.de/_aero/tcmagazine/drvinst-project.7z" target="_blank">http://home.arcor.de/_aero/tcmagazin...nst-project.7z</a></p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">mac_ou</span><br><span class="post-time small text-muted">22nd February 2005 17:36 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Hello anir! and thank you for your reply.<br><br>I am trying your TC Driver Installer but I can't get it working. I've changed the drvinst.cfg file properly and added the hw id code of my pci card in the first line of the drvinst.lst file. It is not a Pnp device.<br><br>I don't know if the problem has to be with the NumbrSrch of the drvinst.lst file, because I've tried with several values with no result.<br><br>If I first install the driver manually, then the TC Driver Installer works, but it asks for the path where the .sys file is, and I would like to do the installation automatically. Is there any way to get this with your method?<br><br><br>Thanks again and I hope you read this post and you would be so gentle to help me.<br><br>Marcos.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">mac_ou</span><br><span class="post-time small text-muted">22nd February 2005 18:10 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"></p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">anir</span><br><span class="post-time small text-muted">24th February 2005 14:25 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">mac_ou,<br><br>I think you cannot install non-PNP device drivers with the existing methods.<br>Both the plugin and <a href="http://nsis.sourceforge.net/archive/viewpage.php?pageid=525" target="_blank">"Driver installation and update"</a> use the same API call: <a href="http://msdn.microsoft.com/library/default.asp?url=/library/en-us/install/hh/install/di-rtns_a9a559d4-7b81-4bd7-b6a7-f493787a3657.xml.asp" target="_blank">UpdateDriverForPlugAndPlayDevices</a><br>As the name already suggests, it only works with PNP device drivers, so you cannot use that call for your purpose.<br>But maybe the script's label "lbl_noupgrade" or "Pre-install the driver" will help you.</p></div><hr><div class="footer"><p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p></div></div><script src="../js/highlight.pack.js" type="text/javascript"></script><script type="text/javascript">//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]></script></body></html>