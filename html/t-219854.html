<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="Issue with SetCtlColors" />

  <title>Issue with SetCtlColors - NSIS Forums</title>
  <script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script>
  <!-- Bootstrap core CSS -->

  <link rel="stylesheet" type="text/css" href="//netdna.bootstrapcdn.com/bootswatch/3.0.1/readable/bootstrap.min.css" />
  <link rel="stylesheet" href="../css/style.css" type="text/css" /><!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!--[if lt IE 9]>
                <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
                <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->
</head>

<body>
  <div class="container">
    <!-- Put navigation bar here -->

    <ol class="breadcrumb">
      <li><a href="../index.html" class="glyphicon glyphicon-home"></a></li>

      <li><a href="f-65.html">NSIS Discussion</a></li>

      <li class="active">Issue with SetCtlColors</li>
    </ol>

    <p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=219854">Issue with SetCtlColors</a></p><br />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
      <span class="post-time small text-muted">25th June 2005 22:59 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>Issue with SetCtlColors</strong><br />
      This is probably just me, but SetCtlColors doesn't seem to work properly anymore (unless this has always been a problem).<br />
      I'm trying to set the colour of a control on an InstallOptions page in the page's Leave function. Everything else works (like EnableWindow and SendMessage) but if I try using SetCtlColors on it, nothing happens. This may also explain why someone in another recent topic couldn't get SetCtlColors to work on one of the 111 dialog labels (Banner).<br />
      <br />
      This is the script (it's an example script I'm making for someone... I'm sure you can guess who ;) )<br />
      <br />
      -Stu</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
      <span class="post-time small text-muted">25th June 2005 23:14 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">SetCtlColors doesn't update the control, you have to do that manually using UpdateWindow, RedrawWindow or some other Windows API.<br />
      <br />
      SetCtlColors doesn't work on 111, because 111 doesn't support it.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">jsbach</span><br />
      <span class="post-time small text-muted">25th June 2005 23:24 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>msjournal</strong><br />
      not sure this MS journal article may help (it's quite old).<br />
      <br />
      <a href="http://www.microsoft.com/msj/archive/S1DCC.aspx" target="_blank">http://www.microsoft.com/msj/archive/S1DCC.aspx</a><br />
      and this (better):<br />
      <a href="http://www.developeriq.com/articles/view_article.php?id=186&amp;cid=1" target="_blank">http://www.developeriq.com/articles/...p?id=186&amp;cid=1</a><br />
      <br />
      Found searching "WM_CTLCOLOR problem".<br />
      <br />
      Abstract:<br />
      ..."In Windows, there are no simple properties for setting the foreground and background colors of an edit control (or any other dialog control). In Visual Basic, you can simply write,<br />
      <br />
      Edit1.BackColor = Yellow<br />
      Edit1.ForeColor = Red<br />
      but behind the scenes, Visual Basic goes through a lot of rigamarole to make this work. The mechanics for setting the color of a Windows control require handling the special message WM_CTLCOLOR, which Windows sends when it's about to paint a control. I won't go into a detailed explanation here, as this topic is covered in the Win32" documentation for WM_CTLCOLOR and numerous articles in MSDN (including some of my own, probably). I'll just give you the quick recap for edit controls. To set the color of an edit control, you must first handle WM_CTLCOLOR and check for the code CTLCOLOR_EDIT, in which case you must return the brush you want to use for the background. Second, you must call SetBkColor and SetTextColor on the HDC that Windows passes as part of the WM_CTLCOLOR message. If you think all this is strange, you're in good company...."</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
      <span class="post-time small text-muted">25th June 2005 23:33 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Right thanks guys. I remember you already mentioned that kichik when I had the same problem a while ago (just had forgotten!)<br />
      Can anyone show me how to call UpdateWindow in the right way?<br />
      I've found that hiding the label and showing it again seems to update it too, but it seems a bit cheap (but then again, you don't need to use the System plugin).<br />
      <br />
      -Stu</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
      <span class="post-time small text-muted">27th June 2005 09:44 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">I've found a small bug which I felt could go in here rather than create a new topic.<br />
      <br />
      If you do:<br />
      FindFirst $R0 $R1 "$EXEDIR\*.tx"<br />
      and say you've got files with .txt entension, those files are found! Is this a bug?<br />
      <br />
      -Stu</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">onad</span><br />
      <span class="post-time small text-muted">27th June 2005 12:23 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Hi Afro UK, the subject above really should go somewere else ;) I almost missed the trick of hiding and unhiding to redraw the labels. I have(had?) problems if I make the labels transparent and move to the previous screen, the lables do not refresh correcly, this tip just might solve my problem, will try and report back with a full example.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
      <span class="post-time small text-muted">28th June 2005 08:34 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Righto, I'll put an archive page up.<br />
      I'll check that bug again and submit a bug report.<br />
      <br />
      -Stu</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Brummelchen</span><br />
      <span class="post-time small text-muted">21st May 2012 22:23 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"></p>

      <blockquote>
        Can anyone show me how to call UpdateWindow in the right way?
      </blockquote>any news on this?<br />
      <br />
      i have similar issue here in a leave function - unless i define a background color,<br />
      but this will probably only here with standard colors - "transparent" leaves<br />
      always a shadow and i cannot turn off for 100% text with empty text.
    </div>
    <hr />

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]>
  </script>
</body>
</html>
