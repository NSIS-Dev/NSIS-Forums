<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="description" content="Force user to select only drive letter"><title>Force user to select only drive letter - NSIS Forums</title><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script><link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css"><link rel="stylesheet" href="../css/style.css" type="text/css"><!--[if lt IE 9]><script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script><script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script><![endif]--></head><body><div class="container"><ol class="breadcrumb"><li><a href="../index.html" class="glyphicon glyphicon-home"></a></li><li><a href="f-65.html">NSIS Discussion</a></li><li class="active">Force user to select only drive letter</li></ol><p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=262924">Force user to select only drive letter</a></p><br><div class="post"><p class="post-meta"><span class="post-author text-primary">ionut_y</span><br><span class="post-time small text-muted">3rd January 2007 07:35 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>Force user to select only drive letter</strong><br>I have an application that works on a drive folder like<br>c:\myapp, d:\myapp, e:\myapp ..... how can I replace MUI_PAGE_DIRECTORY with a combobox for selecting only drives letter available.I'm new with nsis and please I want a small script file to see that.For 2 days I'm looking for a solution.<br>Many thanks !!</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Red Wine</span><br><span class="post-time small text-muted">3rd January 2007 07:45 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Already discussed here:<br><a href="http://forums.winamp.com/showthread.php?s=&amp;threadid=262165" target="_blank">http://forums.winamp.com/showthread....hreadid=262165</a></p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">ionut_y</span><br><span class="post-time small text-muted">3rd January 2007 07:59 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"></p><blockquote><i>Originally posted by Red Wine</i><br><b>Already discussed here:<br><a href="http://forums.winamp.com/showthread.php?s=&amp;threadid=262165" target="_blank">http://forums.winamp.com/showthread....hreadid=262165</a></b></blockquote>Thanks for answer.... but this is not what i'm looking for, user can also chose a subdir ...and i want to force it to choose only drive letter from a combo.</div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Red Wine</span><br><span class="post-time small text-muted">3rd January 2007 08:07 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Nope, this is exactly what you're looking, though, feel free to build a custom page with a combo, find all available HDD with GetDrives, and add them to ListItems.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">ionut_y</span><br><span class="post-time small text-muted">3rd January 2007 08:18 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"></p><blockquote><i>Originally posted by Red Wine</i><br><b>Nope, this is exactly what you're looking, though, feel free to build a custom page with a combo, find all available HDD with GetDrives, and add them to ListItems.</b></blockquote>Thanks again ...this is my problem...i don't know how i can do it.I use nsis for 3 days,I wand i script for exemple.Thanks !</div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Backland</span><br><span class="post-time small text-muted">3rd January 2007 11:45 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">I dont think there is one available, but the concept is very simple:<br><br>Enumerate the drives with the plugin, and add them to your custom page's combo with the WriteINIStr. You should probably start by looking through the InstallOptions examples provided with NSIS. It looks a bit daunting at first, but its quite simple.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Red Wine</span><br><span class="post-time small text-muted">3rd January 2007 12:37 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Take this as a starting point :-)<br></p><pre>
<code><font color="blue">!define APPNAME "My Application"<br>Name '${APPNAME}'<br>OutFile 'test.exe'<br>LicenseData '${NSISDIR}\License.txt'<br>LicenseBkColor 0xFFFFFF<br>ShowInstDetails show<br>AllowRootDirInstall true<br><br>!include FileFunc.nsh<br>!insertmacro GetDrives<br><br>Page License<br>Page Custom CustomCreate CustomLeave<br>Page InstFiles<br><br>Section "boo"<br>        SetOutPath '$INSTDIR'<br>SectionEnd<br><br>Function CustomCreate<br>         WriteIniStr '$PLUGINSDIR\custom.ini' 'Settings' 'NumFields' '2'<br><br>         WriteIniStr '$PLUGINSDIR\custom.ini' 'Field 1' 'Type' 'Label'<br>         WriteIniStr '$PLUGINSDIR\custom.ini' 'Field 1' 'Left' '5'<br>         WriteIniStr '$PLUGINSDIR\custom.ini' 'Field 1' 'Top' '5'<br>         WriteIniStr '$PLUGINSDIR\custom.ini' 'Field 1' 'Right' '-6'<br>         WriteIniStr '$PLUGINSDIR\custom.ini' 'Field 1' 'Bottom' '17'<br>         WriteIniStr '$PLUGINSDIR\custom.ini' 'Field 1' 'Text' \<br>         'Select Installation drive:'<br><br>         StrCpy $R2 0<br>         StrCpy $R0 ''<br>         ${GetDrives} "HDD" GetDrivesCallBack<br><br>         WriteIniStr '$PLUGINSDIR\custom.ini' 'Field 2' 'Type' 'DropList'<br>         WriteIniStr '$PLUGINSDIR\custom.ini' 'Field 2' 'Left' '30'<br>         WriteIniStr '$PLUGINSDIR\custom.ini' 'Field 2' 'Top' '25'<br>         WriteIniStr '$PLUGINSDIR\custom.ini' 'Field 2' 'Right' '-31'<br>         WriteIniStr '$PLUGINSDIR\custom.ini' 'Field 2' 'Bottom' '105'<br>         WriteIniStr '$PLUGINSDIR\custom.ini' 'Field 2' 'State' '$R1'<br>         WriteIniStr '$PLUGINSDIR\custom.ini' 'Field 2' 'ListItems' '$R0'<br><br>         push $0<br>         InstallOptions::Dialog '$PLUGINSDIR\custom.ini'<br>         pop $0<br>         pop $0<br>FunctionEnd<br><br>Function CustomLeave<br>        ReadIniStr $0 '$PLUGINSDIR\custom.ini' 'Field 2' 'State'<br>        StrCpy '$INSTDIR' '$0'<br>FunctionEnd<br><br>Function GetDrivesCallBack<br>         IntCmp $R2 '0' def next next<br>      def:<br>         StrCpy $R1 '$9${APPNAME}'<br>      next:<br>         IntOp $R2 $R2 + 1<br>         StrCpy $R0 '$R0$9${APPNAME}|'<br>         Push $0<br>FunctionEnd<br><br>Function .onInit<br>         InitPluginsDir<br>         GetTempFileName $0<br>         Rename $0 '$PLUGINSDIR\custom.ini'<br>FunctionEnd<br></font></code>
</pre>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">ionut_y</span><br>
      <span class="post-time small text-muted">3rd January 2007 13:32 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"></p>

      <blockquote>
        <i>Originally posted by Red Wine</i><br>
        <b>Take this as a starting point :-)<br></b>
        <pre>
<b><code><font color="blue">!define APPNAME "My Application"<br>Name '${APPNAME}'<br>OutFile 'test.exe'<br>......................<br></font></code></b>
</pre>
      </blockquote>Thanks very much ... is seems ok. I'll start learnig nsis deeply.
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Red Wine</span><br>
      <span class="post-time small text-muted">3rd January 2007 17:41 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">You're welcome!<br>
      Just added a <a href="http://nsis.sourceforge.net/Adding_DropList_with_available_drives_instead_of_directory_page" target="_blank">wiki page</a> with the complete example that calculates the free space of every drive and adds only those drives that they have enough space for the uncompressed installation.</p>
    </div>
    <hr>

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]></script></body></html>