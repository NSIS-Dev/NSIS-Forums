<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="description" content="Verifying Directories"><title>Verifying Directories - NSIS Forums</title><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script><link rel="preload" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css" as="style" onload="this.rel='stylesheet'"><link rel="preload" href="../css/style.css" as="style" onload="this.rel='stylesheet'"><noscript><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css"><link rel="stylesheet" href="../css/style.css"></noscript><script>!function(a){"use strict";var b=function(b,c,d){function e(a){return h.body?a():void setTimeout(function(){e(a)})}function f(){i.addEventListener&&i.removeEventListener("load",f),i.media=d||"all"}var g,h=a.document,i=h.createElement("link");if(c)g=c;else{var j=(h.body||h.getElementsByTagName("head")[0]).childNodes;g=j[j.length-1]}var k=h.styleSheets;i.rel="stylesheet",i.href=b,i.media="only x",e(function(){g.parentNode.insertBefore(i,c?g:g.nextSibling)});var l=function(a){for(var b=i.href,c=k.length;c--;)if(k[c].href===b)return a();setTimeout(function(){l(a)})};return i.addEventListener&&i.addEventListener("load",f),i.onloadcssdefined=l,l(f),i};"undefined"!=typeof exports?exports.loadCSS=b:a.loadCSS=b}("undefined"!=typeof global?global:this);!function(a){if(a.loadCSS){var b=loadCSS.relpreload={};if(b.support=function(){try{return a.document.createElement("link").relList.supports("preload")}catch(b){return!1}},b.poly=function(){for(var b=a.document.getElementsByTagName("link"),c=0;c<b.length;c++){var d=b[c];"preload"===d.rel&&"style"===d.getAttribute("as")&&(a.loadCSS(d.href,d,d.getAttribute("media")),d.rel=null)}},!b.support()){b.poly();var c=a.setInterval(b.poly,300);a.addEventListener&&a.addEventListener("load",function(){b.poly(),a.clearInterval(c)}),a.attachEvent&&a.attachEvent("onload",function(){a.clearInterval(c)})}}}(this);</script></head><body><div class="container"><ol class="breadcrumb"><li><a href="../index.html" class="glyphicon glyphicon-home"></a></li><li><a href="f-65.html">NSIS Discussion</a></li><li class="active">Verifying Directories</li></ol><p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=209626">Verifying Directories</a></p><br><div class="post"><p class="post-meta"><span class="post-author text-primary">howser123</span><br><span class="post-time small text-muted">6th March 2005 01:12 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>Verifying Directories</strong><br>Hi<br>Im trying to verify a file exsists within a directory that the user selects. Basically the program Im installing needs to know where msacess.exe is, so I have used PageEX directory to create a selection page that stores the directory in variable $acessdir. However, I cant for the life of me figure out how to verify that msacess.exe exists within the directory the user has chosen, and thus allow them to progress to the next page (ie. next&gt; button is enabled).<br><br>Im a bot of a novice, so Im sure its an easy question....<br><br>Thanks</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">howser123</span><br><span class="post-time small text-muted">6th March 2005 10:43 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">While I was waiting for a perly I decided to search the archives, and found a few handy scripts to find access versions etc. I also thought that perhaps I could search for access in the registry, and make its path the default when the 'Choose location of msaccess.exe' page comes up. However, can I do this using PageEX, or will I have to use a custom page?</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br><span class="post-time small text-muted">6th March 2005 11:14 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">You need to create a custom page using InstallOptions.<br><br>-Stu</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">howser123</span><br><span class="post-time small text-muted">6th March 2005 22:26 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Thnaks Stu, Will give it a try....</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Fred4711</span><br><span class="post-time small text-muted">17th March 2005 08:56 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">@Afrow UK<br>i dont know how to create a custom page for this Problem.<br>Can you give us an example ?? Thanks</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br><span class="post-time small text-muted">17th March 2005 09:17 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Oh sorry, you can still use your PageEx if you want a simple solution.<br>Inside your PageEX block, use:<br>PageCallbacks "" "" msaLeave<br><br>Then outside create a...<br></p><pre>
<code>Function msaLeave<br> IfFileExists "$accessdir\msacess.exe" +3<br>  MessageBox MB_OK|MB_ICONEXCLAMATION "msaccess.exe is not located in that folder!"<br>  Abort<br>FunctionEnd</code>
</pre><br>
      <br>
      -Stu
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Fred4711</span><br>
      <span class="post-time small text-muted">17th March 2005 10:38 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Thanx a lot, works fine<br>
      now only a little Question when i use the Browse Button to select the Directory, the Installer change the Directory when i select c:\temp to c:\temp\installdir.</p>
    </div>
    <hr>

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script type="text/javascript" src="../js/highlight.pack.js" async>
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]></script></body></html>