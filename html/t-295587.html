<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="LUA plugin and XP" />

  <title>LUA plugin and XP - NSIS Forums</title><!-- Bootstrap core CSS -->
  <link rel="stylesheet" type="text/css" href="//netdna.bootstrapcdn.com/bootswatch/3.0.1/readable/bootstrap.min.css" />
  <link rel="stylesheet" href="../css/style.css" type="text/css" /><!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!--[if lt IE 9]>
                <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
                <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->
</head>

<body>
  <div class="container">
    <!-- Put navigation bar here -->

    <ol class="breadcrumb">
      <li><a href="../index.html" class="glyphicon glyphicon-home"></a></li>

      <li><a href="f-65.html">NSIS Discussion</a></li>

      <li class="active">LUA plugin and XP</li>
    </ol>

    <p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=295587">LUA plugin and XP</a></p><br />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">berglind</span><br />
      <span class="post-time small text-muted">6th August 2008 15:19 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>LUA plugin and XP</strong><br />
      I have an installer that uses the LUA plugin to request admin privileges (because when I'm done I need to launch the application in the context of the original user). Now I've encountered somewhat unexpected behavior when running the installer on XP. If I leave the default settings in the Run As dialog as they are, i.e. Current User selected and Protect my computer... ticked, I get an error message that simply says "Error launching installer". If I untick the Protect my computer... box, I get "This installer requires admin access, try again", as it should be. I'm guessing the protection is preventing the installer from extracting stuff that it needs or something similar, has anyone encountered this? Is there any way to things more user friendly in this case.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Anders</span><br />
      <span class="post-time small text-muted">6th August 2008 15:31 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">do you mean the UAC plugin? LUA = limited user acces (not admin)<br />
      <br />
      Anyway, that checkbox turns on more proctection and (you can't write to the users profile, thats why the installer will not start)<br />
      <br />
      see <a href="http://blogs.msdn.com/aaron_margosis/archive/2004/09/10/227727.aspx" target="_blank">http://blogs.msdn.com/aaron_margosis...10/227727.aspx</a><br />
      <br />
      I am not providing that checkbox, it comes from the shell, to hide the checkbox would require some dirty hooking, not sure if I want to go down that path</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">berglind</span><br />
      <span class="post-time small text-muted">6th August 2008 15:50 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Yes sorry, I meant UAC of course :) I was hoping maybe there was a way to catch this or tell Windows to disable this protection option. But if not I'll just write this off as a known issue. Thanks for responding so quickly :)</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Anders</span><br />
      <span class="post-time small text-muted">11th August 2008 08:22 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">in the next version, you can compile with the define FEAT_MSRUNASDLGMODHACK set and it will default to the other user radio button and disable that checkbox (not sure if FEAT_MSRUNASDLGMODHACK will be set in my release builds or when I will get around to testing and uploading a new version)</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">berglind</span><br />
      <span class="post-time small text-muted">11th August 2008 13:11 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">That sounds really good, I'll be looking forward to your next version then. Thanks for the update.</p>
    </div>
    <hr />

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]>
  </script>
</body>
</html>
