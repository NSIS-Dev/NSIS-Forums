<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="description" content="How to use this windows."><title>How to use this windows. - NSIS Forums</title><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script><link rel="preload" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css" as="style" onload="this.rel='stylesheet'"><link rel="preload" href="../css/style.css" as="style" onload="this.rel='stylesheet'"><noscript><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css"><link rel="stylesheet" href="../css/style.css"></noscript><script>!function(a){"use strict";var b=function(b,c,d){function e(a){return h.body?a():void setTimeout(function(){e(a)})}function f(){i.addEventListener&&i.removeEventListener("load",f),i.media=d||"all"}var g,h=a.document,i=h.createElement("link");if(c)g=c;else{var j=(h.body||h.getElementsByTagName("head")[0]).childNodes;g=j[j.length-1]}var k=h.styleSheets;i.rel="stylesheet",i.href=b,i.media="only x",e(function(){g.parentNode.insertBefore(i,c?g:g.nextSibling)});var l=function(a){for(var b=i.href,c=k.length;c--;)if(k[c].href===b)return a();setTimeout(function(){l(a)})};return i.addEventListener&&i.addEventListener("load",f),i.onloadcssdefined=l,l(f),i};"undefined"!=typeof exports?exports.loadCSS=b:a.loadCSS=b}("undefined"!=typeof global?global:this);!function(a){if(a.loadCSS){var b=loadCSS.relpreload={};if(b.support=function(){try{return a.document.createElement("link").relList.supports("preload")}catch(b){return!1}},b.poly=function(){for(var b=a.document.getElementsByTagName("link"),c=0;c<b.length;c++){var d=b[c];"preload"===d.rel&&"style"===d.getAttribute("as")&&(a.loadCSS(d.href,d,d.getAttribute("media")),d.rel=null)}},!b.support()){b.poly();var c=a.setInterval(b.poly,300);a.addEventListener&&a.addEventListener("load",function(){b.poly(),a.clearInterval(c)}),a.attachEvent&&a.attachEvent("onload",function(){a.clearInterval(c)})}}}(this);</script></head><body><div class="container"><ol class="breadcrumb"><li><a href="../index.html" class="glyphicon glyphicon-home"></a></li><li><a href="f-65.html">NSIS Discussion</a></li><li class="active">How to use this windows.</li></ol><p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=102320">How to use this windows.</a></p><br><div class="post"><p class="post-meta"><span class="post-author text-primary">cxji3275</span><br><span class="post-time small text-muted">28th August 2002 03:56 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>How to use this windows.</strong><br>How can I make this window using nsis's Instruction.<br>If modify 'MessageBox' then is it possible?<br><br>This Windows<br><a href="http://edps.cc/pds/me/nsis-windows.jpg" target="_blank">http://edps.cc/pds/me/nsis-windows.jpg</a><br><br>I'm sorry my broken English. :)<br></p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Sunjammer</span><br><span class="post-time small text-muted">28th August 2002 08:59 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">The feature you want doesn't exist in NSIS.<br><br>You could write a plugin DLL to do it. It wouldn't need much code, a function to display a modeless window, the icon and the text, and another function to dismiss the window (you need two so you can continue to let NSIS run in the background and do your registry stuff).</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">kichik</span><br><span class="post-time small text-muted">28th August 2002 09:50 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">A DLL won't do the trick here. NSIS automatically unloads the DLL after it exectutes the required function. Make an EXE and use Exec without wait. Do your stuff, and then call your destroy function.<br><br>[edit]unloads not uploads :)[/edit]</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Sunjammer</span><br><span class="post-time small text-muted">28th August 2002 14:28 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Okay I see that your suggestion would work KiCHiK but I can't see what's wrong with a DLL in this case. A DLL provides extended functionality on the installation machine, so instead of saying MessageBox you'd say MyCustomMessageBox, and the benefit of it being in the DLL is that it's in the same process and so can be an owned window of the NSIS window. Where am I going wrong?</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">kichik</span><br><span class="post-time small text-muted">28th August 2002 14:40 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">When the DLL gets unloaded the window will be destroyed.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Sunjammer</span><br><span class="post-time small text-muted">28th August 2002 14:45 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">So are you saying that the DLL is loaded/executed/unloaded for every instruction that uses it. I *thought* it used to persist until the end of the installer and was cleaned up then, that allowed it to have persistent state.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">kichik</span><br><span class="post-time small text-muted">28th August 2002 14:49 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Nope, that's not the way it works :)</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">rainwater</span><br><span class="post-time small text-muted">28th August 2002 22:56 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">If you write a dll to do it for instance, it would have to be responsible for creating the registry entries as well as you can't execwait a dll.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">CodeSquid</span><br><span class="post-time small text-muted">29th August 2002 08:39 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">I think a new instruction would solve this, something like<br>KeepPluginLoaded MyMessageBox.dll<br><br>When this instruction is used, the specified dlls will not be unloaded until the installer quits and not directly after the function call.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Sunjammer</span><br><span class="post-time small text-muted">29th August 2002 08:53 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"></p><blockquote><i>Originally posted by rainwater</i><br><b>If you write a dll to do it for instance, it would have to be responsible for creating the registry entries as well as you can't execwait a dll.</b></blockquote>Not necessary, the dll would have two functions (or one with a switch parameter, or that is context sensitive) so that you make one call to show the dialog, then in NSIS do yer registry stuff, then another call to dismiss the dialog.</div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">kichik</span><br><span class="post-time small text-muted">29th August 2002 11:01 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Coming in alpha 7... :D</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Sunjammer</span><br><span class="post-time small text-muted">29th August 2002 11:06 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>Nice one</strong><br>If for some reason it doesn't make it I'll be happy to have a go at adding it. By about the end of next week I should have my free time back at last, yay! :P</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">CodeSquid</span><br><span class="post-time small text-muted">29th August 2002 11:42 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Ah, the /NOUNLOAD parameter to CallInstDLL is already in the CVS repository. Great work. But does it work with the alternative way to call plugins? Does /NOUNLOAD work there as well?</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">kichik</span><br><span class="post-time small text-muted">29th August 2002 11:50 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Not yet :(<br>I need to think of a way to make this happen... Any ideas?</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Sunjammer</span><br><span class="post-time small text-muted">29th August 2002 12:02 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Weeeelllll you could use a cryptic approach, something like if the command is followed by ! (immediately with no whitespace) then don't unload it, or you could have /NOUNLOAD and if u see that as the first plugin argument obey it and don't send it to the plugin, start the arguments after if u see what I mean, or .... hundreds of other ideas :)</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">CodeSquid</span><br><span class="post-time small text-muted">29th August 2002 12:18 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">if one of the parameters (or the first, just as you like it) is /NOUNLOAD, then don't unload the dll. If the string /NOUNLOAD should be passed to the DLL for some reason, it has to be quoted.<br><br>myfunction /NOUNLOAD<br>this does not unload the DLL<br><br>myfunction "/NOUNLOAD"<br>this passes /NOUNLOAD as parameter</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">kichik</span><br><span class="post-time small text-muted">29th August 2002 12:24 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Quotes gets killed by the pre-processor. If you want to use /NOUNLOAD as a parameter, just push it. Soon to be in the CVS.<br><br>[edit]Done.[/edit]</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Sunjammer</span><br><span class="post-time small text-muted">29th August 2002 12:32 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Don't forget to mention use of /NOUNLOAD with the automagical plugin calling somewhere in the docs. I'd add it myself but I have no CVS access at the mo.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">kichik</span><br><span class="post-time small text-muted">29th August 2002 12:37 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Right, almost forgot :D</p></div><hr><div class="footer"><p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p></div></div><script type="text/javascript" src="../js/highlight.pack.js" async></script><script type="text/javascript">//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]></script></body></html>