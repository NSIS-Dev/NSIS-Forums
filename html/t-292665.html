<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="file not completly written" />

  <title>file not completly written - NSIS Forums</title><!-- Bootstrap core CSS -->
  <link rel="stylesheet" type="text/css" href="//netdna.bootstrapcdn.com/bootswatch/3.0.1/readable/bootstrap.min.css" />
  <link rel="stylesheet" href="../css/style.css" type="text/css" /><!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!--[if lt IE 9]>
                <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
                <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->
</head>

<body>
  <div class="container">
    <!-- Put navigation bar here -->

    <ol class="breadcrumb">
      <li><a href="../index.html" class="glyphicon glyphicon-home"></a></li>

      <li><a href="f-65.html">NSIS Discussion</a></li>

      <li class="active">file not completly written</li>
    </ol>

    <p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=292665">file not completly written</a></p><br />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">ssam</span><br />
      <span class="post-time small text-muted">3rd June 2008 10:28 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>file not completly written</strong><br />
      ac.jnlp is my configfile with 53 lines, i read a tamplat of them, replace some placeholder and writ them to a specific directory.<br />
      <br /></p>
      <pre>
<code><br />   Var /global ac.jnlp_template<br />    Var /global fp_ac.jnlp<br />    ClearErrors<br />    FileOpen $fp_ac.jnlp '${copiedfiles_Path}\Templates\html\diag\\jnlp\ac\ac.jnlp' r<br />    IfErrors ac.jnlp_done<br />    FileRead $fp_ac.jnlp $2<br />    Detailprint $2<br />    IfErrors ac.jnlp_eof<br />    StrCpy $ac.jnlp_template '$ac.jnlp_template$2'<br />    Goto -4<br />    ac.jnlp_eof:<br />    FileClose $fp_ac.jnlp<br />    Var /global fp_ac.jnlp_patched<br />    Var /global ac.jnlp_patched<br />    ${StrRep} $ac.jnlp_patched "$ac.jnlp_template" "$Server" "$Servername" #Ersetzen des Platzhalters $Server mit dem Inhalt der Variablen $Server<br />    SetOutPath '$INSTDIR\html\diag\jnlp\AC'<br />    ClearErrors<br />    FileOpen $fp_ac.jnlp_patched 'ac.jnlp' w<br />    IfErrors ac.jnlp_patched_done<br />    FileWrite $fp_ac.jnlp_patched $ac.jnlp_patched<br />    Messagebox MB_OK "$ac.jnlp_patched"<br />    FileClose $fp_ac.jnlp_patched<br />    Goto +4<br />    ac.jnlp_patched_done:<br />    DetailPrint 'Konnte ac.cfg nicht Ã¶ffnen.(schreiben)'<br />    Goto +2<br />    ac.jnlp_done:<br />    DetailPrint 'Konnte ac.cfg nicht Ã¶ffnen.(lesen)'<br /></code>
</pre><br />
      <br />
      ok the detailprint show me, that my file is completely read.<br />
      <br />
      but if i write the string to the file, he only writes 29 lines. This is a Problem.
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">ssam</span><br />
      <span class="post-time small text-muted">3rd June 2008 10:53 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">in a second test he writes only 31 lines with fewer text per line. in my opinion is the space of a Variable to small.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">ssam</span><br />
      <span class="post-time small text-muted">3rd June 2008 11:00 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">or the length of the string is too small</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">{_trueparuex^}</span><br />
      <span class="post-time small text-muted">3rd June 2008 11:03 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">NSIS variables are limited to 1024 characters. You can download NSIS special build with 8192 max string length, but that isn't really a solution.<br />
      <br />
      What you should do is to read and write the file in 1024 blocks. It needs a little planning, but it can be done.<br />
      <br />
      PaR</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">ssam</span><br />
      <span class="post-time small text-muted">3rd June 2008 11:12 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">oh thats a good info, thanks.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">ssam</span><br />
      <span class="post-time small text-muted">3rd June 2008 11:59 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">ok i chaned it but now i have an "ungÃ¼ltiger Befehlscode"-Error<br />
      <br /></p>
      <pre>
<code><br />  Var /global fp_alarmconfigurator.cfg<br />    Var /global fp_alarmconfigurator.cfg_patched<br />    Var /global alarmconfigurator.cfg_template<br />    Var /global alarmconfigurator.cfg_patched<br />    /* Datei einlesen und schreiben*/<br />    ClearErrors<br />    FileOpen $fp_alarmconfigurator.cfg '${copiedfiles_Path}\Templates\html\diag\jnlp\AlarmConfigurator\alarmconfigurator.cfg' r<br />    IfErrors alarmconfigurator.cfg_done<br />    Messagebox MB_OK "Ã¶ffnen lesen ging"<br />    ClearErrors<br />    SetOutPath '$INSTDIR\html\diag\jnlp\AlarmConfigurator'<br />    FileOpen $fp_alarmconfigurator.cfg_patched 'alarmconfigurator.cfg' w<br />    IfErrors alarmconfigurator.cfg_patched_done<br />    Messagebox MB_OK "Ã¶ffnen schreiben ging"<br />    ClearErrors<br />    Messagebox MB_OK "vor dem zeile lesen"<br />    FileRead $fp_alarmconfigurator.cfg $1<br />    Messagebox MB_OK "zeilen lesen ging \r\n Wert: $1"<br />    IfErrors alarmconfigurator.cfg_eof<br />    StrCpy $alarmconfigurator.cfg_template '$1'<br /><br />    ${StrRep} $alarmconfigurator.cfg_patched "$alarmconfigurator.cfg_template" "$ServerDB" "$ProduktivDB_Hostname"<br />    #${StrRep} $alarmconfigurator.cfg_patched "$alarmconfigurator.cfg_patched" "" "$ProduktivDB_TNSname"<br />    ${StrRep} $alarmconfigurator.cfg_patched "$alarmconfigurator.cfg_patched" "$DB" "$ProduktivDB_DBSID"<br />    #${StrRep} $alarmconfigurator.cfg_patched "$alarmconfigurator.cfg_patched" "" "$ProduktivDB_Listenerport"<br />    ${StrRep} $alarmconfigurator.cfg_patched "$alarmconfigurator.cfg_patched" "$User" "$ProduktivDB_Mainuser"<br />    #${StrRep} $alarmconfigurator.cfg_patched "$alarmconfigurator.cfg_patched" "" "$ProduktivDB_MainuserPasswort"<br />    ${StrRep} $alarmconfigurator.cfg_patched "$alarmconfigurator.cfg_patched" "$Server" "$Servername"<br />    <br />    FileWrite $fp_alarmconfigurator.cfg_patched $alarmconfigurator.cfg_patched<br />    iferrors 0 +2<br />    Messagebox MB_OK "Fehler beim schreiben"<br />    <br />    Messagebox MB_OK "zeile schreiben ging \r\n Wert: $alarmconfigurator.cfg_patched"<br />    Goto -13<br />    alarmconfigurator.cfg_eof:<br />    <br />    FileClose $fp_alarmconfigurator.cfg_patched<br />    FileClose $fp_alarmconfigurator.cfg<br />   <br />    Goto +4<br />    alarmconfigurator.cfg_patched_done:<br />    DetailPrint 'Konnte alarmconfigurator.cfg_template nicht Ã¶ffnen.(schreiben)'<br />    Goto +2<br />    alarmconfigurator.cfg_done:<br />    DetailPrint 'Konnte alarmconfigurator.cfg_template nicht Ã¶ffnen.(lesen)'<br /></code>
</pre><br />
      <br />
      the first line is writen into the File, but then where he must jump 13 Lines back, there comes the Error<br />
      <br />
      I dont know why
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">{_trueparuex^}</span><br />
      <span class="post-time small text-muted">3rd June 2008 12:05 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Use jump to label instead of relative jump. ${StrRep} is a macro so there is actually a lot more lines than 13.<br />
      <br />
      PaR</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">ssam</span><br />
      <span class="post-time small text-muted">3rd June 2008 12:10 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">oh ... ok</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">ssam</span><br />
      <span class="post-time small text-muted">3rd June 2008 12:44 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">thanks this helps</p>
    </div>
    <hr />

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]>
  </script>
</body>
</html>
