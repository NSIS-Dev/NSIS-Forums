<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="description" content="hide all sections except some in silent mode"><title>hide all sections except some in silent mode - NSIS Forums</title><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script><link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css"><link rel="stylesheet" href="../css/style.css" type="text/css"></head><body><div class="container"><ol class="breadcrumb"><li><a href="../index.html" class="glyphicon glyphicon-home"></a></li><li><a href="f-65.html">NSIS Discussion</a></li><li class="active">hide all sections except some in silent mode</li></ol><p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=218802">hide all sections except some in silent mode</a></p><br><div class="post"><p class="post-meta"><span class="post-author text-primary">jsbach</span><br><span class="post-time small text-muted">13th June 2005 14:24 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>hide all sections except some in silent mode</strong><br>i'm confused on how to hide all sections except one (i.e. instfiles) while in silent mode. i don't want to exclude pages or make everything silent: i basically wish a normal script to always show instfiles progress wheter or not /S par was passed on cmdline; if no /S is passed, then script should execute as normal (with all sections/pages).<br><br>I'm quite sure this possibly be already covered in the forum : my apologies not finding it. i appreciate just an hint to correctly look for the right anwser to my need...<br>thanks.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Mæster</span><br><span class="post-time small text-muted">13th June 2005 19:58 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Use the "IfSilent" statement to check by code if the installer runs in silent mode or not. If you know in which mode the installer currently runs you could react to do whatever you want including to show the installer.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">jsbach</span><br><span class="post-time small text-muted">14th June 2005 16:46 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>thanks, but not valid outside sections...</strong><br>thanks Mæster, however IfSilent is not valid outside sections. so i can't do:<br>IfSilent +4 ; ? visible only if not silent ?<br>!insertmacro MUI_PAGE_WELCOME<br>!insertmacro MUI_PAGE_COMPONENTS<br>!insertmacro MUI_PAGE_DIRECTORY<br><br>!insertmacro MUI_PAGE_INSTFILES ; ? always visible ?<br><br>IfSilent +2 ; ? visible only if not silent ?<br>!insertmacro MUI_PAGE_FINISH<br><br>; uninstall always visible...<br><br>!insertmacro MUI_UNPAGE_WELCOME<br>!insertmacro MUI_UNPAGE_CONFIRM<br>!insertmacro MUI_UNPAGE_INSTFILES<br>!insertmacro MUI_UNPAGE_FINISH<br><br>any other hint ?</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Mæster</span><br><span class="post-time small text-muted">14th June 2005 19:17 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>Re: thanks, but not valid outside sections...</strong><br>If it was me trying to only show the installfiles page if started in silent mode, i would probably use the following trick to do that:<br><br>1. I would save the silent mode in a variable and then set the installmode to normal<br><br>2. Depending on the variable I would skip/show all pages except the installfiles page which should always be shown.<br><br>Here is it written in code:<br><br></p><pre>
<code>Var HIDEPAGE       # set to "1" if started silent<br><br>!define MUI_WELCOMEFINISHPAGE_CUSTOMFUNCTION_INIT ShowSkipPage<br>!insertmacro MUI_PAGE_WELCOME       # skipped if started silent<br><br>!define MUI_PAGE_CUSTOMFUNCTION_PRE ShowSkipPage<br>!insertmacro MUI_PAGE_COMPONENTS    # skipped if started silent<br><br>!define MUI_PAGE_CUSTOMFUNCTION_PRE ShowSkipPage<br>!insertmacro MUI_PAGE_DIRECTORY     # skipped if started silent<br><br>!insertmacro MUI_PAGE_INSTFILES     # always show this one<br><br>!insertmacro MUI_PAGE_FINISH        # skipped if started silent<br><br># right after the installer started we check if runs in silent mode<br>Function .onInit<br>    # IfSilent we set HIDEPAGE = "1"<br>    IfSilent 0 +3<br>    Strcpy $HIDEPAGE "1"<br>    SetSilent normal<br>    # we always set the installer mode to normal to use the page<br>    # callback functions<br>FunctionEnd<br><br># function to skip the page if $HIDEPAGE = "1"<br>Function ShowSkipPage<br>    Strcmp $HIDEPAGE "1" 0 +2<br>    ABORT<br>FunctionEnd</code>
</pre>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">jsbach</span><br>
      <span class="post-time small text-muted">21st June 2005 23:39 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>thanks</strong><br>
      exactly what i need. thanks a lot.</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">mpenaili</span><br>
      <span class="post-time small text-muted">19th July 2005 18:01 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">this script is excelente!!!!! thanks..<br>
      Marcelo</p>
    </div>
    <hr>

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]></script></body></html>