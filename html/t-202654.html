<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="big install.exe - slow process" />

  <title>big install.exe - slow process - NSIS Forums</title>
  <script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script>
  <!-- Bootstrap core CSS -->

  <link rel="stylesheet" type="text/css" href="//netdna.bootstrapcdn.com/bootswatch/3.0.1/readable/bootstrap.min.css" />
  <link rel="stylesheet" href="../css/style.css" type="text/css" /><!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!--[if lt IE 9]>
                <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
                <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->
</head>

<body>
  <div class="container">
    <!-- Put navigation bar here -->

    <ol class="breadcrumb">
      <li><a href="../index.html" class="glyphicon glyphicon-home"></a></li>

      <li><a href="f-65.html">NSIS Discussion</a></li>

      <li class="active">big install.exe - slow process</li>
    </ol>

    <p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=202654">big install.exe - slow process</a></p><br />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">probee</span><br />
      <span class="post-time small text-muted">21st December 2004 08:29 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>big install.exe - slow process</strong><br />
      Hi all,<br />
      <br />
      I have a problem. My install.exe is 560MB. It's very slow, when I run it, about 1 min till the splash screen appear. Until that, there's no feedback to the user. It's very annoying. Is there any solution?<br />
      <br />
      TIA<br />
      <br />
      PS: sorry for m√≠ poor english...</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Takhir</span><br />
      <span class="post-time small text-muted">21st December 2004 09:49 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">NSIS Help, 4.9.1.7 ReserveFile<br />
      Use forum Search for ReserveFile free samples :) <a href="http://forums.winamp.com/search.php" target="_blank">http://forums.winamp.com/search.php</a></p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">probee</span><br />
      <span class="post-time small text-muted">21st December 2004 10:35 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"></p>

      <blockquote>
        <i>Originally posted by Takhir</i><br />
        <b>NSIS Help, 4.9.1.7 ReserveFile<br />
        Use forum Search for ReserveFile free samples :) <a href="http://forums.winamp.com/search.php" target="_blank">http://forums.winamp.com/search.php</a></b>
      </blockquote>Thannks, but there's lot of topic, and I have no time, sorry for this... What is the right metod?<br />
      <br />
      ReserveFile /r "install\*" ?<br />
      <br />
      And where? In the init, or...<br />
      <br />
      Sorry again for the lame question...
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Takhir</span><br />
      <span class="post-time small text-muted">21st December 2004 10:55 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Thread you need <a href="http://forums.winamp.com/showthread.php?s=&amp;threadid=197394&amp;highlight=ReserveFile+splash" target="_blank">http://forums.winamp.com/showthread....rveFile+splash</a><br />
      <br />
      Add ReserveFile instruction on the top of script (not in function or section). Reserve splash image, AdvSplash.dll and sound file (if any) - only files you want to extract first (not *).</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">bluenet</span><br />
      <span class="post-time small text-muted">21st December 2004 11:00 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">ReserveFile use for file or plugins use in .onInit Function, not all files.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">probee</span><br />
      <span class="post-time small text-muted">21st December 2004 11:22 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Thanks for the answers, but it doesn't work.<br />
      <br />
      I put this in the very beginning of the script:<br />
      <br />
      ReserveFile "${NSISDIR}\Plugins\advsplash.dll"<br />
      ReserveFile "install\pix\setup.bmp"<br />
      <br />
      If I start the install.exe, there's no splash screen, and after the one minute "silent" initialization (decompression?), there's no splash screen anymore... gone.<br />
      <br />
      Still, it's a _very_ slow process, if I make a banner (for example, "please wait..."), it will be good, I think, but...<br />
      <br />
      With the IS or MSI, it's a fast process. The install.exe is 1-2 Mb, the data is in cabinet files. With NSIS, it's only one file, the istall.exe, it's 560 MB (the uncompressed size is 1,1 GB). And it is a very, very slow process... :(</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">RobGrant</span><br />
      <span class="post-time small text-muted">21st December 2004 11:29 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Mate, try putting absolute pathnames for the ReserveFiles. You specify the path they are on your system, not the target install path, obviously.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Takhir</span><br />
      <span class="post-time small text-muted">21st December 2004 11:40 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">I guess something is wrong in your script if image not appears at all. This was tested and used many times.<br />
      <br />
      ReserveFile "${NSISDIR}\Plugins\advsplash.dll"<br />
      ReserveFile "nsis.bmp"</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
      <span class="post-time small text-muted">21st December 2004 11:50 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Try using SetOutPath $PLUGINSDIR before using ReserveFile.<br />
      Then with the splash dll call, $PLUGINSDIR\splash<br />
      <br />
      -Stu</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">probee</span><br />
      <span class="post-time small text-muted">21st December 2004 11:55 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">I've try this:<br />
      <br />
      ReserveFile "${NSISDIR}\Plugins\Banner.dll"<br />
      <br />
      Function .onInit<br />
      Banner::show /NOUNLOAD "Please wait..."<br />
      Banner::destroy<br />
      FunctionEnd<br />
      <br />
      Not working...</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Takhir</span><br />
      <span class="post-time small text-muted">21st December 2004 11:56 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Name "AdvSplash test"<br />
      OutFile "AdvSplash Test.exe"<br />
      <br />
      ReserveFile "${NSISDIR}\Plugins\advsplash.dll"<br />
      ReserveFile "nsis.bmp"<br />
      <br />
      Function .onInit<br />
      InitPluginsDir<br />
      SetOutPath $PLUGINSDIR<br />
      File "nsis.bmp"<br />
      advsplash::show 1000 600 400 -1 "$PLUGINSDIR\nsis"<br />
      Pop $0 ; $0 has '1' if the user closed the splash screen early,<br />
      Delete "$PLUGINSDIR\nsis.bmp"<br />
      FunctionEnd<br />
      <br />
      Section<br />
      SectionEnd</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">probee</span><br />
      <span class="post-time small text-muted">21st December 2004 12:04 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Thanks, but let's forget this splash... The advsplash is working, but just <b>after</b>the 1 minute process. Until that, the user don't know, what's goin' on, and will start again and again the install.exe. That's my problem. Click install.exe -&gt; wait one minute -&gt; advsplash, install start. I will try the banner.dll with the reservefile, maybe it's working anyhow. But still, the process is slow. This one minute silent something is annoying...</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
      <span class="post-time small text-muted">21st December 2004 12:11 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Are you using BGGradient by any chance?<br />
      <br />
      -Stu</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">probee</span><br />
      <span class="post-time small text-muted">21st December 2004 12:16 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"></p>

      <blockquote>
        <i>Originally posted by Afrow UK</i><br />
        <b>Are you using BGGradient by any chance?<br />
        <br />
        -Stu</b>
      </blockquote>No. I don't now, what's BGGradient, but yes, I read that post. I'm through all the post from the last 45 days in the forum now...
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
      <span class="post-time small text-muted">21st December 2004 12:20 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">You should change this:<br />
      Function .onInit<br />
      Banner::show /NOUNLOAD "Please wait..."<br />
      Banner::destroy<br />
      FunctionEnd<br />
      <br />
      Stick Banner::destroy in the Pre function for your Welcome page.<br />
      <br />
      -Stu</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">probee</span><br />
      <span class="post-time small text-muted">21st December 2004 12:57 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">thanks, but my core problem is still exist:<br />
      <br />
      start the install exe -&gt; one minute hourglass -&gt; starting the .onInit, with the banner, advsplash, bgimage and all the initialization stuff, with the welcome page. So, I want a banner or anything <b>right after</b> I (or the user) click on the install.exe... Not one minute after, because it doesn't make sense...</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Takhir</span><br />
      <span class="post-time small text-muted">21st December 2004 14:16 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">How this happens on my comp: installer first makes integrity check (banner with % progress), after this image banner appears, and I can hear file copy disk activity (I used File with 200 MB dir in .onInit, change or comment Sleep in the script), finally installer dialog replaces banner.<br />
      NSIS 2.03 and Win2K Server.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">probee</span><br />
      <span class="post-time small text-muted">21st December 2004 15:19 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Thank you, Takhir, I've tried it - doesn't work...<br />
      <br />
      start install.exe -&gt; one minute hourglass -&gt; your image appearing, then the welcome page. It's equivalent with the advsplash.dll.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Takhir</span><br />
      <span class="post-time small text-muted">21st December 2004 16:35 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">"Please wait while setup is loading. Verifying installer xx%" - banner should be visible when installer checks package integrity. This may take one minute or less for 1 GB package (image banner in my test appears even faster if compression was used, after 1-3 seconds of "Verifying" banner or even immediatelly after installer launch). And this is a problem - why "verifying" banner is not visible on your system? Are you using stable NSIS version? Did you tested it with 2.02?</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">probee</span><br />
      <span class="post-time small text-muted">21st December 2004 17:00 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"></p>

      <blockquote>
        <i>Originally posted by Takhir</i><br />
        <b>"Please wait while setup is loading. Verifying installer xx%" - banner should be visible when installer checks package integrity. This may take one minute or less for 1 GB package (image banner in my test appears even faster if compression was used, after 1-3 seconds of "Verifying" banner or even immediatelly after installer launch). And this is a problem - why "verifying" banner is not visible on your system? Are you using stable NSIS version? Did you tested it with 2.02?</b>
      </blockquote>Yes, this is the main problem. This verifying not the CRC check? Because I set it off (CRCCheck off). And there's something with the "solid compression" too, as I learnt in the posts of the forum, but I don't understand, what is it (it seems, bzip2 and lzma is the solid, but I'm using the zlib, 'cause the bzip2 and the lzma have very slow compression (bzip2 about 40min, lzma 1-2 hour), and the install.exe with the bzip2 compression <b>doesn't start</b>... (hourglass, 3 minutes winchester work, then nothing, must kill the process.<br />
      <br />
      I'm using the 2.03 version, the OS is XP SP2 (maybe the SP2 is the guilty...)
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">probee</span><br />
      <span class="post-time small text-muted">21st December 2004 17:28 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Okay, I've tested it: the "Please wait... verifying" IS the CRC check. It's another annoying process after the one minute hourglass... I'll give it up...</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">iostriz</span><br />
      <span class="post-time small text-muted">22nd December 2004 13:59 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">I've just created 550MB install file and everything works as expected, that is: "Verifying installer %xx".<br />
      Here is attached nsi script that does that with no probs.<br />
      <br />
      Another problem is that I cannot put REALLY big file into setup (e.g. 3.5 GB) because of:<br />
      "failed creating mmap of "c:\really big file.avi"</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Takhir</span><br />
      <span class="post-time small text-muted">23rd December 2004 07:21 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">int (2 GB) limitations in mmap.c/h looks not reasonable, CreateFileMapping (and other calls and structs) supports big files. NSIS developers can clean code and move size limit to DWORD (4 GB) easy. This may also require compression code check out, but this is not a problem too. I guess.</p>
    </div>
    <hr />

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]>
  </script>
</body>
</html>
