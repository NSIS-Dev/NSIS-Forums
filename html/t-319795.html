<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="description" content="question about installation folder on win7"><title>question about installation folder on win7 - NSIS Forums</title><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script><link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css"><link rel="stylesheet" href="../css/style.css" type="text/css"></head><body><div class="container"><ol class="breadcrumb"><li><a href="../index.html" class="glyphicon glyphicon-home"></a></li><li><a href="f-65.html">NSIS Discussion</a></li><li class="active">question about installation folder on win7</li></ol><p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=319795">question about installation folder on win7</a></p><br><div class="post"><p class="post-meta"><span class="post-author text-primary">kobolds</span><br><span class="post-time small text-muted">9th June 2010 10:20 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>question about installation folder on win7</strong><br>I having some confuse with installation folder on win7 client pc in network environment<br><br>if I want to install my program on C:\Program Files\myprog then I will need administrator password .<br>after I install when I try to run my program I get error cause my program can't create files in the installed folder . I need administrator to run my program without problem.<br><br>what should I do cause I don't want user to run my program as admin .<br><br>I found that if I change the installation path to c:\myprog , I can install it as user and run it as user without any problem .<br><br>is this the correct way ? I don't think install c: root is correct way<br><br>any advice?:confused:</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br><span class="post-time small text-muted">9th June 2010 10:41 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Per user applications shouldn't be installed in Program Files, they should go in $APPDATA or somewhere like that.<br><br>Stu</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">kobolds</span><br><span class="post-time small text-muted">9th June 2010 12:27 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"></p><blockquote><small>Originally posted by Afrow UK</small><br>Per user applications shouldn't be installed in Program Files, they should go in $APPDATA or somewhere like that.<br><br>Stu</blockquote>Nope , this is not per user application .<br><br>I don't have any problem on winxp client pc . not sure what is the best solution that can work on xp and win7.<br><br>I don't want endup with 2 different installation</div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">MSG</span><br><span class="post-time small text-muted">9th June 2010 12:47 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">There are two things you can do. First, you can test the selected installation directory for writing privileges, and if the user doesn't have them do not allow installation there. I've pasted some code that checks this here: <a href="http://forums.winamp.com/showthread.php?t=317018" target="_blank">http://forums.winamp.com/showthread.php?t=317018</a><br>Second, you can create your app's (config?) files during installation and use the accesscontrol plugin to give all users write access to those files.<br><br>(Note that it is a very bad idea to give all users write access to the whole installation directory! The admin would believe that, since the dir is in Program Files, it's a safe directory. He then might end up admin-running an .exe that was infected or otherwise compromised by a regular user.)<br><br><br>Edit: actually, both these methods are wrong. What you SHOULD do is to change your application to save files to MyDocs or AppData, instead of $instdir.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">DrO</span><br><span class="post-time small text-muted">9th June 2010 12:51 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">settings really shouldn't be written in the program folder under any case - that is what XP started (though poorly enforced) and Vista/Win7 have properly enforced this requirement with the need for admin access to write into the program files directory.<br><br>like stu says, using the appdata folder is the norm / suggested way for dealing with settings.<br><br>from a bit more looking (as i couldn't remember it after last looking into this early last year), CSIDL_COMMON_APPDATA (used with the SHGetSpecialFolderPath OS api function - can't remember if NSIS does this natively or only via the system plug-in) is the equivalent place for saving a programs settings but in a folder with the correct access (works on Win2k and higher and seems to be valid under Win9x as well).<br><br>for XP this typically maps to <b>C:\Documents and Settings\All Users\Application Data</b> and with Vista / Win7 it goes to <b>C:\ProgramData</b><br><br>-daz</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">MSG</span><br><span class="post-time small text-muted">9th June 2010 13:00 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">That would be either $LOCALAPPDATA or $APPDATA, using shellvarcontext all. Can't remember which one.<br><br>Edit: Although it's not guaranteed that that folder is world-writable. If an admin creates a directory there, he gets ownership and users are left hanging.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">DrO</span><br><span class="post-time small text-muted">9th June 2010 13:04 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">for NSIS and reading the docs i'd expect it to be $APPDATA with SetShellVarContext all.<br><br>though really the app needs to be changed to be more compliant than having the installer fiddling things as if the app isn't working correctly and not following things then it really doesn't matter what the installer does as it won't really have any effect.<br><br>-daz</p></div><hr><div class="footer"><p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p></div></div><script src="../js/highlight.pack.js" type="text/javascript"></script><script type="text/javascript">//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]></script></body></html>