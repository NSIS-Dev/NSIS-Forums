<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="description" content="Plugin Creation"><title>Plugin Creation - NSIS Forums</title><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script><link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css"><link rel="stylesheet" href="../css/style.css" type="text/css"><!--[if lt IE 9]><script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script><script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script><![endif]--></head><body><div class="container"><ol class="breadcrumb"><li><a href="../index.html" class="glyphicon glyphicon-home"></a></li><li><a href="f-65.html">NSIS Discussion</a></li><li class="active">Plugin Creation</li></ol><p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=180320">Plugin Creation</a></p><br><div class="post"><p class="post-meta"><span class="post-author text-primary">jherrera1976</span><br><span class="post-time small text-muted">17th May 2004 19:48 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>Plugin Creation</strong><br>Hello,<br><br>I'm trying to create a new nsis plugin to check a serial number and return a true or false value, I have made the DLL as a pluging, copied to the plugin dir, the function is being executed, but the parameters passed are not arriving to the dll.<br><br>I'm not using VC++ or even c++, so I guess that I need to access the stack in some other way, but I can't find any info about this.<br><br>Thanks</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Vytautas</span><br><span class="post-time small text-muted">18th May 2004 00:12 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">There is an example of how to create NSIS plugins including functions for accessing the stack in the NSIS distribution, see ExDLL folder.<br><br>If the language you are using is not found there you should still have a look at the functions there and try to convert them to your programming language.<br><br>Vytautas ;)</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Joel</span><br><span class="post-time small text-muted">18th May 2004 16:14 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">What language are you working on? Did you try using system plugin for this?</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">deguix</span><br><span class="post-time small text-muted">19th May 2004 03:44 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Lobo Lunar, System plugin can do much but we (people from forums) don't know every trick inside it. Its readme has information but not as clear as it should be to be totally understood. I think brainsucker HAS to make a new readme for it. This request has been made since System plugin has been created, however he didn't work on it until now.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">jherrera1976</span><br><span class="post-time small text-muted">20th May 2004 15:01 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">I'm using a language called Clarion, is a 4gl language. The main problem is how should I access the stack, somebody at the IRC told me to read about System::Store, that's what I should use? And if that is ok, once I have a result on my dll, where do I store that result? On which stack?<br><br>Another question is, I want to use that DLL to validate a Serial Number, If NSIS is using the assembler stack is pretty easy for any programmer to run a debugger on the installer and check for the return value (no matter how complicated is the algorithm for the serial number) and return the correct number, is there any one out there how has solved this in a very secure way?<br><br>Thank you all for your answers</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">kichik</span><br><span class="post-time small text-muted">20th May 2004 19:56 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">As specified in ExDLL.c and ExDLL.h, the fourth and last parameter for the plug-in function, on the stack, is a pointer to the NSIS stack head. The NSIS stack head is a pointer to stack_t structure which is defined in ExDLL.h. Translate that into your programming language and you'll be able to play with the NSIS stack.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">jherrera1976</span><br><span class="post-time small text-muted">21st May 2004 13:27 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Ok, just one question, I can't fully understand the following structure:<br><br>typedef struct _stack_t {<br>struct _stack_t *next;<br>char text[1]; // this should be the length of string_size<br>} stack_t;<br><br>the char part is ok, but I don't know what is the _stack_t, what is *next?<br><br>It is a pointer to something else? It is a pointer to another structure?<br><br>Thank you very much</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">kichik</span><br><span class="post-time small text-muted">21st May 2004 13:32 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">next is a pointer to another stack_t. _stack_t is the name of the structure. See the popstring and pushstring functions for examples of how to use this structure.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">jherrera1976</span><br><span class="post-time small text-muted">21st May 2004 13:33 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">I think I have it know, it is a pointer to the same structure to get the following value, right?<br><br>thx, I will post my code when I finish to everyone else in case is helpfull to others in the same situation.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">jherrera1976</span><br><span class="post-time small text-muted">21st May 2004 13:38 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">thx man, your help and the rest of the people here is tremendous, I thougth that our community (clarion news groups) was the only one with helping people ;)<br><br>again, thx</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">jherrera1976</span><br><span class="post-time small text-muted">24th May 2004 14:02 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Well, I have the plugin working now, do you want me to post the use of the stack an all the necessary stuff directly here? Or should I put the files on other places?<br><br>The generated plugin with all the runtimes linked in is, at least 270Kb, I know, it is big but there is no way to make it smaller<br><br>Just le me know what do you want me to do.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Joel</span><br><span class="post-time small text-muted">24th May 2004 14:44 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Well... is a DLL; you can try UPX :)</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">jherrera1976</span><br><span class="post-time small text-muted">24th May 2004 15:07 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">very good! it is 112kb now, not so small as the ones made with vc++ but... :)</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">deguix</span><br><span class="post-time small text-muted">24th May 2004 22:23 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">You can get rid of <i>Debug</i> stuff, and you can include <i>LIBCTINY.LIB</i> in your project (you can search for it on the net).</p></div><hr><div class="footer"><p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p></div></div><script src="../js/highlight.pack.js" type="text/javascript"></script><script type="text/javascript">//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]></script></body></html>