<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="description" content="Registry import by shell command &quot;reg import&quot;"><title>Registry import by shell command "reg import" - NSIS Forums</title><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script><link rel="preload" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css" as="style" onload="this.rel='stylesheet'"><link rel="preload" href="../css/style.css" as="style" onload="this.rel='stylesheet'"><noscript><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css"><link rel="stylesheet" href="../css/style.css"></noscript><script>!function(a){"use strict";var b=function(b,c,d){function e(a){return h.body?a():void setTimeout(function(){e(a)})}function f(){i.addEventListener&&i.removeEventListener("load",f),i.media=d||"all"}var g,h=a.document,i=h.createElement("link");if(c)g=c;else{var j=(h.body||h.getElementsByTagName("head")[0]).childNodes;g=j[j.length-1]}var k=h.styleSheets;i.rel="stylesheet",i.href=b,i.media="only x",e(function(){g.parentNode.insertBefore(i,c?g:g.nextSibling)});var l=function(a){for(var b=i.href,c=k.length;c--;)if(k[c].href===b)return a();setTimeout(function(){l(a)})};return i.addEventListener&&i.addEventListener("load",f),i.onloadcssdefined=l,l(f),i};"undefined"!=typeof exports?exports.loadCSS=b:a.loadCSS=b}("undefined"!=typeof global?global:this);!function(a){if(a.loadCSS){var b=loadCSS.relpreload={};if(b.support=function(){try{return a.document.createElement("link").relList.supports("preload")}catch(b){return!1}},b.poly=function(){for(var b=a.document.getElementsByTagName("link"),c=0;c<b.length;c++){var d=b[c];"preload"===d.rel&&"style"===d.getAttribute("as")&&(a.loadCSS(d.href,d,d.getAttribute("media")),d.rel=null)}},!b.support()){b.poly();var c=a.setInterval(b.poly,300);a.addEventListener&&a.addEventListener("load",function(){b.poly(),a.clearInterval(c)}),a.attachEvent&&a.attachEvent("onload",function(){a.clearInterval(c)})}}}(this);</script></head><body><div class="container"><ol class="breadcrumb"><li><a href="../index.html" class="glyphicon glyphicon-home"></a></li><li><a href="f-65.html">NSIS Discussion</a></li><li class="active">Registry import by shell command "reg import"</li></ol><p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=249764">Registry import by shell command "reg import"</a></p><br><div class="post"><p class="post-meta"><span class="post-author text-primary">Guv'nor</span><br><span class="post-time small text-muted">27th June 2006 10:11 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>Registry import by shell command "reg import"</strong><br>Hello!<br><br>I tried to add some registry keys using a reg file.<br>The syntax for the shell command looks e.g. like this:<br><br></p><blockquote>REG IMPORT d:\regfile\regfile.reg</blockquote>Now the problem is, if I use that in my NSIS script, it just won't work. But I copied that command out of the "detail view" and just pasted it into a console window, and it worked perfectly.<br><br>So the command in my script must be 100% correct, but it doesn't get executed correctly. I used the following syntax:<br><br><blockquote>ExecWait '"REG IMPORT d:\regfile\regfile.reg"'</blockquote>Does anybody know why this doesn't work? And if it's not my fault, is there any alternative to this command?<br><br>Nice greetings<br>Guv'nor</div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Guv'nor</span><br><span class="post-time small text-muted">27th June 2006 10:13 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">I'll have to add:<br><br>The file is extracted into the right place before the command is executed, so there shouldn't be a "file not found error" or something...</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Guv'nor</span><br><span class="post-time small text-muted">27th June 2006 12:05 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Now I tried exporting the status message into a textfile using<br><br></p><blockquote>REG IMPORT d:\regfile\regfile.reg &gt; c:\test.txt</blockquote>and it works perfectly in the command shell. But with the installer, test.txt is not even created... very strange, isn't it?</div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br><span class="post-time small text-muted">27th June 2006 12:40 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">REG is not an executable. ExecWait requires a full executable path.<br><br>Use ExecShell on "d:\regfile\regfile.reg", or use ExecWait on '"$WINDIR\regedit.exe" "d:\regfile\regfile.reg"'<br>However, you should <b>never</b> use a .reg file. Use NSIS's WriteRegStr, WriteRegDWORD etc<br><br>You can use this to generate the script:<br><a href="http://nsis.sourceforge.net/Reg2Nsis_-_convert_registry_info_into_NSIS_commands" target="_blank">http://nsis.sourceforge.net/Reg2Nsis..._NSIS_commands</a><br><br>-Stu</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Guv'nor</span><br><span class="post-time small text-muted">27th June 2006 12:48 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Okay it works now, thank you! I used ExecShell. But why shouldn't you use a regfile? I think it's more flexible somehow...</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br><span class="post-time small text-muted">27th June 2006 13:00 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">It's easier for the developer, but it's not professional. You should also have RegEdit displaying a message box asking you to confirm, which is something the user may cancel.<br><br>If your reg file is say version 5, it may not work on older versions of Windows. By using NSIS's registry instructions, you're benefited to know that it'll work on all Windows versions.<br><br>-Stu</p></div><hr><div class="footer"><p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p></div></div><script src="../js/highlight.pack.js" type="text/javascript"></script><script type="text/javascript">//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]></script></body></html>