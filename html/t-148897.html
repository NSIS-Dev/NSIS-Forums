<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="Create Font API Function" />

  <title>Create Font API Function - NSIS Forums</title>
  <script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script>
  <!-- Bootstrap core CSS -->

  <link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css" />
  <link rel="stylesheet" href="../css/style.css" type="text/css" /><!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!--[if lt IE 9]>
                <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
                <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->
</head>

<body>
  <div class="container">
    <!-- Put navigation bar here -->

    <ol class="breadcrumb">
      <li><a href="../index.html" class="glyphicon glyphicon-home"></a></li>

      <li><a href="f-65.html">NSIS Discussion</a></li>

      <li class="active">Create Font API Function</li>
    </ol>

    <p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=148897">Create Font API Function</a></p><br />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">deguix</span><br />
      <span class="post-time small text-muted">12th September 2003 01:31 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>Create Font API Function</strong><br />
      I published a function (called CreateFont API) that I made when I had a personal computer (beggining of July), now I made another change on the function, so please, someone test the function and report here, so I can know that I'm in the right way.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
      <span class="post-time small text-muted">12th September 2003 09:14 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">The signature link points to the wrong page.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">deguix</span><br />
      <span class="post-time small text-muted">12th September 2003 20:45 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Fixed. Appear me that no one tested and reported to at least say that is working... Maybe if no one is talking, it's working, isn't?</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
      <span class="post-time small text-muted">12th September 2003 20:52 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Well, personally, I don't see why you need it when you have CreateFont... Unless I've missed something it does exactly the same, only with System. The only addition is that it can set the font to a certain window which can be useful, but why use System for it? It also doesn't work with the normal points unit.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">deguix</span><br />
      <span class="post-time small text-muted">12th September 2003 21:01 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">What you mean with "doesn't work with the normal points unit"?<br />
      <br />
      [EDIT]I know, the simplest way to use it is using the CreateFont command, but you know that every function I do, is to do something only the program NSIS don't do or to enhance something already existant... See the function again, and say if is the SAME thing.[/EDIT]</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
      <span class="post-time small text-muted">12th September 2003 21:04 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">You need to make a special conversion using MulDiv of the height given in order for the user to be able to use the points unit. If I remember correctly, the fonts come out it in the wrong size and even worse when the DPI is different. I'm not sure of the exact outcome, but I do know you're supposed to make that conversion in order for it to work as the user expects. See MSDN's documentation about CreateFont's parameter nHeight for more information.<br />
      <br />
      [edit]As I've said, same but only with the window setting. I still don't see why you'd want to use System instead of CreateFont even for that.[/edit]</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">deguix</span><br />
      <span class="post-time small text-muted">12th September 2003 21:23 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"></p>

      <blockquote>
        nHeight = -MulDiv(PointSize, GetDeviceCaps(hDC, LOGPIXELSY), 72)
      </blockquote>And how to convert this function to use with NSIS? (or with System.dll)
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
      <span class="post-time small text-muted">12th September 2003 21:26 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">NSIS's CreateFont already uses it. If you want to use it with System just call it like any other function, it's in Kernel32.dll.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">deguix</span><br />
      <span class="post-time small text-muted">12th September 2003 21:34 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Hummm... To see this in a public computer isn't so good... but just to know, is only put that code as it is or have to do changes to work right?</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
      <span class="post-time small text-muted">12th September 2003 21:40 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Well, your function will work anyway, but without that extra MulDiv something goes wrong. I think the font size is always wrong and looks especially wrong when the DPI is different. Testing it would probably give you the best answer.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">deguix</span><br />
      <span class="post-time small text-muted">13th September 2003 20:52 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">I'm saying the MulDiv code, is only put it as it is or have to do changes to work right?</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
      <span class="post-time small text-muted">13th September 2003 21:00 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Put it as is. To get the DC use GetDC on $HWNDPARENT.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">deguix</span><br />
      <span class="post-time small text-muted">16th September 2003 01:09 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">I know that is easy after these explainations but I want this function (MulDiv) to be ready to use, give me the complete code...<br />
      <br />
      (Now I have a computer to work in, but don't have internet, and uses the Win95 (I got from the trash the hard disk), so Kichik, you have a tarball compressed development snapshoot? Because is too big to put in a diskette)<br />
      <br />
      [EDIT](And only the plugins UNCOMPRESSED of ZipDll and UnTGZ?)</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
      <span class="post-time small text-muted">16th September 2003 10:14 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">The complete code is:<br />
      <br />
      font_size = -MulDiv(font_size,GetDeviceCaps(GetDC($HWNDPARENT),LOGPIXELSY),72)<br />
      <br />
      There is no tarball version of the snapshot, just ZIP. But if you don't have enough space on the diskette you can remove a few plug-ins that you won't use, some graphics, docs and even the language files.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">deguix</span><br />
      <span class="post-time small text-muted">17th September 2003 01:13 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Thanks for the code...<br />
      <br /></p>

      <blockquote>
        But if you don't have enough space on the diskette you can remove a few plug-ins that you won't use, some graphics, docs and even the language files.
      </blockquote>How, if public computers doesn't have WinZip? (Have a way to donwload all the new files, without downloading files one-to-one on CVS and not using more space than the diskette supports?)
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
      <span class="post-time small text-muted">17th September 2003 09:09 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Well, if you can download a zip file, why can't you download WinZip in a zip file? Even a command line program will do.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">deguix</span><br />
      <span class="post-time small text-muted">17th September 2003 22:09 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"></p>

      <blockquote>
        Well, if you can download a zip file, why can't you download WinZip in a zip file? Even a command line program will do.
      </blockquote>I have a program to decompress .zip files in my machine, and I'm not permited to install anything in public library computers. The problem is, I have a computer without internet, and I want to pass files got from internet of library computers to it by diskettes. NSIS development Snapshot don't fit in a diskette, and I can't install WinZip in a library machine to split it. So, what can I do to I install NSIS development snapshot in my machine, fitting the installation program in my diskette?
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
      <span class="post-time small text-muted">20th September 2003 10:23 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><a href="http://helpdesk.uvic.ca/how-to/support/win32/infozip/unz541xN.exe" target="_blank">This one</a> for example, will allow to change ZIP files contests and it doesn't require an install. It just extracts the files in it to the current directory (extract them to temp or something like that). Using this unzip program you can change the zip file contents and delete things you don't need.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Joost Verburg</span><br />
      <span class="post-time small text-muted">20th September 2003 12:00 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">1) First copy the unzip application and use multiple disks to store the snapshot.<br />
      2) Split the installer file, put it on mulitple disks and put the stuff together using normal DOS commands.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">deguix</span><br />
      <span class="post-time small text-muted">20th September 2003 21:38 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Thanks, I downloaded but I will use it in a public computer Monday.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">deguix</span><br />
      <span class="post-time small text-muted">22nd September 2003 22:22 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Hummm... I took a look on this, and it don't split zip files. The one solution is, make a program with NSIS to unzip all the files on a temp directory, try to put 'em all into diskette, and when it fills, put it in another diskette... so will don't use much things of public libraries computers. But if the file inside the zip is bigger (uncompressed) than 1,44 mb, <i>adios</i>. But is a re-starting point, to get all I need...<br />
      <br />
      (these programs don't work itself because they close automatically after execution, and I cannot use the "Run" start menu command or run the "command.com" program)</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Joost Verburg</span><br />
      <span class="post-time small text-muted">23rd September 2003 15:57 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">You can also split a file without using zip or anything else and combine the parts using DOS commands.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">deguix</span><br />
      <span class="post-time small text-muted">24th September 2003 01:08 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Spliting by notepad or other program to edit files? Notepad and Wordpad are worst in editing files, other programs aren't allowed in public library computers.<br />
      <br />
      But a function that will save from the "diskette darkness", a really easy thing... maybe it can arrive in archive tomorrow (if someone got the idea, maybe can do it first than me). Thanks for all!</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">deguix</span><br />
      <span class="post-time small text-muted">26th September 2003 01:32 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Ops, no function, but I get a splitter program, and I'm using it now. Thanks Kichik and Joost. (NOW I'M UPDATED!)</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">deguix</span><br />
      <span class="post-time small text-muted">29th September 2003 21:40 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"></p>

      <blockquote>
        font_size = -MulDiv(font_size,GetDeviceCaps(GetDC($HWNDPARENT),LOGPIXELSY),72)
      </blockquote>Hmmmm... put the code to use with the System.dll... like System::Call "Something...".
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
      <span class="post-time small text-muted">29th September 2003 23:35 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Not tested:<br />
      <br />
      !define LOGPIXELSY 90<br />
      <br />
      StrCpy $0 8 # font size<br />
      <br />
      System::Call "user32::GetDC(i $HWNDPARENT) i .s"<br />
      System::Call "gdi32::GetDeviceCaps(i s, i ${LOGPIXELSY}) i .s"<br />
      System::Call "kernel32::MulDiv(i $0, i s, 72) i .r0"</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">deguix</span><br />
      <span class="post-time small text-muted">11th October 2003 21:10 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Too late... but I tested it yesterday and I made one fix, but it works good. Thanks Kichik! (I will update Create Font API soon!)</p>
    </div>
    <hr />

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]>
  </script>
</body>
</html>
