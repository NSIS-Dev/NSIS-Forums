<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="description" content="Problem under Windows NT SP3"><title>Problem under Windows NT SP3 - NSIS Forums</title><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script><link rel="preload" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css" as="style" onload="this.rel='stylesheet'"><link rel="preload" href="../css/style.css" as="style" onload="this.rel='stylesheet'"><noscript><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css"><link rel="stylesheet" href="../css/style.css"></noscript><script>!function(a){"use strict";var b=function(b,c,d){function e(a){return h.body?a():void setTimeout(function(){e(a)})}function f(){i.addEventListener&&i.removeEventListener("load",f),i.media=d||"all"}var g,h=a.document,i=h.createElement("link");if(c)g=c;else{var j=(h.body||h.getElementsByTagName("head")[0]).childNodes;g=j[j.length-1]}var k=h.styleSheets;i.rel="stylesheet",i.href=b,i.media="only x",e(function(){g.parentNode.insertBefore(i,c?g:g.nextSibling)});var l=function(a){for(var b=i.href,c=k.length;c--;)if(k[c].href===b)return a();setTimeout(function(){l(a)})};return i.addEventListener&&i.addEventListener("load",f),i.onloadcssdefined=l,l(f),i};"undefined"!=typeof exports?exports.loadCSS=b:a.loadCSS=b}("undefined"!=typeof global?global:this);!function(a){if(a.loadCSS){var b=loadCSS.relpreload={};if(b.support=function(){try{return a.document.createElement("link").relList.supports("preload")}catch(b){return!1}},b.poly=function(){for(var b=a.document.getElementsByTagName("link"),c=0;c<b.length;c++){var d=b[c];"preload"===d.rel&&"style"===d.getAttribute("as")&&(a.loadCSS(d.href,d,d.getAttribute("media")),d.rel=null)}},!b.support()){b.poly();var c=a.setInterval(b.poly,300);a.addEventListener&&a.addEventListener("load",function(){b.poly(),a.clearInterval(c)}),a.attachEvent&&a.attachEvent("onload",function(){a.clearInterval(c)})}}}(this);</script></head><body><div class="container"><ol class="breadcrumb"><li><a href="../index.html" class="glyphicon glyphicon-home"></a></li><li><a href="f-65.html">NSIS Discussion</a></li><li class="active">Problem under Windows NT SP3</li></ol><p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=136943">Problem under Windows NT SP3</a></p><br><div class="post"><p class="post-meta"><span class="post-author text-primary">Konrad</span><br><span class="post-time small text-muted">28th May 2003 22:09 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>Problem under Windows NT SP3</strong><br>While the setup created by NSIS runs without problems under Windows XP, there are problems with a fresh installation of Windows NT 4 SP3!<br>The setup always displays a messagebox if i wanted to start it, which says:</p><blockquote>Error! Can't initialize plug-ins directory. Please try again later.</blockquote>Has anyone else the same problem? How can it be fixed?<br>(The version before the latest CVS displayed another error message!)<br><br>Thanks in advance, Konrad</div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Joel</span><br><span class="post-time small text-muted">28th May 2003 22:51 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Did you use "<b>InitPluginsDir</b>"<br>before that call?</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Konrad</span><br><span class="post-time small text-muted">28th May 2003 23:04 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Even if i use InitPluginsDir in .onInit (I don't do it before), it displays the same error message. This message appears just after executing the setup.<br>Please help!<br>Konrad</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br><span class="post-time small text-muted">28th May 2003 23:09 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Have you had a look in the %TEMP% folder were the $PLUGINS dir is created?<br>Could there be something stopping anything being dumped in the %TEMP% dir (e.g. antivirus software or something)<br><br>-Stu</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Joel</span><br><span class="post-time small text-muted">28th May 2003 23:12 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">If you are using Install Options, put if on the top<br>of the page creator:<br></p><pre>
<code><br>Page custom Task "" ": Some tasks"<br><br>Function "Task"<br>InitPluginsDir<br>...<br>FunctionEnd<br><br></code>
</pre>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Konrad</span><br>
      <span class="post-time small text-muted">28th May 2003 23:17 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Juhu, just solved the problem. On a fresh NT Installation it might be possible that the Temp folder isn't yet created, although there is an environment variable for it!<br>
      To prevent this error from occuring, please check in the setup if the Temp directory is already created and if not -&gt; create it!!!<br>
      Please implement that in the NSIS code!<br>
      Thanks<br>
      Konrad</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br>
      <span class="post-time small text-muted">28th May 2003 23:46 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">IfFileExists "$TEMP\*.*" +2<br>
      CreateDirectory $TEMP<br>
      <br>
      I am wondering however, how does NSIS find the $TEMP dir if there is no temp dir on the PC?<br>
      Does it get it from %TEMP%, or does it work it out from the OS.<br>
      <br>
      -Stu</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Konrad</span><br>
      <span class="post-time small text-muted">29th May 2003 09:06 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">The TEMP folder is stored in an environment variable! Because NSIS uses the TEMP file before any code is executed, the creating of the TEMP folder must happen, before NSIS tries to write to it.<br>
      Please implement this, NSIS developers!</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br>
      <span class="post-time small text-muted">29th May 2003 10:15 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">This will be improved soon, thank you for the information.</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br>
      <span class="post-time small text-muted">29th May 2003 10:34 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Afrow, NSIS uses <a href="http://msdn.microsoft.com/library/en-us/fileio/base/gettemppath.asp" target="_blank">GetTempPath</a>. The linked page contains information about how GetTempPath gets the temporary path.</p>
    </div>
    <hr>

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script type="text/javascript" src="../js/highlight.pack.js" async>
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]></script></body></html>