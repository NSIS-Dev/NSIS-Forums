<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="Much to say..." />

  <title>Much to say... - NSIS Forums</title><!-- Bootstrap core CSS -->
  <link rel="stylesheet" type="text/css" href="//netdna.bootstrapcdn.com/bootswatch/3.0.1/readable/bootstrap.min.css" />
  <link rel="stylesheet" href="../css/style.css" type="text/css" /><!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!--[if lt IE 9]>
                <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
                <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->
</head>

<body>
  <div class="container">
    <!-- Put navigation bar here -->

    <ol class="breadcrumb">
      <li><a href="../index.html" class="glyphicon glyphicon-home"></a></li>

      <li><a href="f-65.html">NSIS Discussion</a></li>

      <li class="active">Much to say...</li>
    </ol>

    <p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=164006">Much to say...</a></p><br />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">deguix</span><br />
      <span class="post-time small text-muted">9th January 2004 12:18 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>Much to say...</strong><br />
      ...about:<br />
      <br />
      <b>Install Options Plugin:</b><br />
      <br />
      - <b>Bug:</b> When disabling a filerequest control (at run-time), just disables the textbox, not the button, and after you try to enable (at run-time), it disables the text and enables the button. I will post a snapshot tomorrow due to school.<br />
      <br />
      - <b>Bug:</b> Everytime I call to reserve a page with a control (or more) with "NOTIFY" flag, it calls the "Leave Function" two times, and return to the location you reserved, and rarely ever call the "Leave Function" naturally (Function (code ends) -&gt; Leave Function (code starts)).<br />
      <br />
      <b>NSIS Scripting:</b><br />
      <br />
      - <b>Bug:</b> When I use SetPluginUnload manual, and call a plugin to unload, it doesn't unload and continue in the $PLUGINSDIR folder, even after quiting the program.<br />
      <br />
      <b>Zip2Exe:</b><br />
      <br />
      - It could be done with NSIS, like the NSIS Updater?<br />
      <br />
      - <b>Bug:</b> If it converts "a ZIP file to a self extracting" file, should not be "Setup" and "Install" but "NSIS Self-Extractor" and "Extract", isn't it?<br />
      <br />
      - <b>Suggestion:</b> Add an option in the explorer context menu the command "Create Self-Extractor with NSIS (Zip2Exe)" of .zip files.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Joost Verburg</span><br />
      <span class="post-time small text-muted">9th January 2004 12:30 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Zip2Exe:<br />
      <br />
      Yes, it could be done using NSIS, but the current C++ version works fine.<br />
      <br />
      If you want a diffent name, you can always modify the header file. Setup doesn't sound wrong to me.<br />
      <br />
      That context menu is a good idea.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">eccles</span><br />
      <span class="post-time small text-muted">9th January 2004 14:06 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">InstallOptions:[list=1][*]See testnotify.nsi in the Contrib\InstallOptions folder for an example of how to do this. Briefly, FileRequest and DirRequest fields are made up of two Windows controls that you will have to deal with individually.[*]I don't understand. Can you give an example?[/list=1]</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">deguix</span><br />
      <span class="post-time small text-muted">10th January 2004 10:45 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">The example is <a href="http://www.geocities.com/civ_deguix/files/rc.zip" target="_blank">here</a>. Size: 518 kb.<br />
      <br />
      It is a very complicated example (an installer and a program, both made with NSIS), but is where I found the basic bugs of NSIS.<br />
      <br />
      <b>Some instructions:</b><br />
      <br />
      - To the installer works you need to create a file "cevo.exe" in any folder (the installer verifies every folder for it).<br />
      <br />
      - To the compilation works, you need to rename the original InstallOptions.dll to InstallOptionsOri.dll and the "Install Options Modification dll" to InstallOptions.dll.<br />
      <br />
      <b>After installing the program:</b><br />
      <br />
      - To see the FileRequest bug, compile the RCPatches.nsi in the subfolder "Source", or go to "C-Evo Patches Installation" inside the program.<br />
      <br />
      - To see the NOTIFY bug, compile the RCData.nsi, or go to "New Games Data Options" inside the program.<br />
      <br />
      - I remembered another bug, when I'm using the Banner Plugin and I use or click in another program at the same time, it doesn't load anything anymore, and you can only close the banner using "Ctrl + Alt + Del". If you want to verify that, compile the RCMainMenu.nsi, or just run "Registry Changer.exe".<br />
      <br />
      - Because you don't installed <a href="http://c-evo.org" target="_blank">Civ Evolution</a>, some parts aren't accessible, like the selection pages (I did a very good work here, principally the AI's (using the InstallOptions modification) and those "packs selection", they are about done).</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">eccles</span><br />
      <span class="post-time small text-muted">10th January 2004 11:25 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">The .zip file seems to be corrupted. I tried downloading more than once, and WinZip always gives these errors:<br />
      <br />
      warning [D:/Documents and Settings/.../rc[1].zip]: extra 1 bytes at beginning or within Zip file (attempting to process anyway)<br />
      Error in file #1: bad Zip file offset (Error local header signature not found): 0<br />
      (attempting to re-compensate)<br />
      Extracting RC Installer.exe<br />
      bad CRC 2c98ea26 (should be e2cc06dc)</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">deguix</span><br />
      <span class="post-time small text-muted">11th January 2004 10:46 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Solved the problem recompiling again the installator (ha?).</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">eccles</span><br />
      <span class="post-time small text-muted">11th January 2004 16:08 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">OK, it's working for me now, thanks.</p>

      <blockquote>
        To the compilation works, you need to rename the original InstallOptions.dll to InstallOptionsOri.dll and the "Install Options Modification dll" to InstallOptions.dll.
      </blockquote>"Install Options Modification"? I hacked your scripts so that they compile with the standard InstallOptions, in order to test the problems; but if there are any problems with this modified plugin you should contact its author.

      <blockquote>
        with "NOTIFY" flag, it calls the "Leave Function" two times
      </blockquote>I can reproduce this one (intermittently), thanks. I think I know the cause; it will be fixed soon.

      <blockquote>
        and rarely ever call the "Leave Function" naturally (Function (code ends) -&gt; Leave Function (code starts))
      </blockquote>I think I know what you mean here now. This is not a bug; the "leave" function (a.k.a. the "validate" function) is only called when the Next button is pressed. Any script you need to run regardless of which button is pressed should follow InstallOptions::dialog/show, and not be in the "leave" function.

      <blockquote>
        To see the FileRequest bug, compile the RCPatches.nsi in the subfolder "Source", or go to "C-Evo Patches Installation" inside the program.
      </blockquote>This is not a bug; I explained this in my previous post. You have to handle the textbox and button as two separate controls, and account for them as such when working out what value to give to GetDlgItem.
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">deguix</span><br />
      <span class="post-time small text-muted">12th January 2004 10:20 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"></p>

      <blockquote>
        it will be fixed soon.
      </blockquote>OK! Have some progress here.<br />
      <br />
      At that time, I said what I forgot to change, the "Leave Function" calling was right.<br />
      <br />

      <blockquote>
        This is not a bug; I explained this in my previous post. You have to handle the textbox and button as two separate controls, and account for them as such when working out what value to give to GetDlgItem.
      </blockquote>How? They use the same field (in Install Options). So what control number is(are) the button(s)?
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">eccles</span><br />
      <span class="post-time small text-muted">12th January 2004 15:10 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"></p>

      <blockquote>
        How? They use the same field (in Install Options). So what control number is(are) the button(s)?
      </blockquote>(The example script I mentioned in an earlier post has an example of this.) The control ID of the button part is the control ID of the text part + 1. The control IDs of all following fields are then also + 1. E.g. if fields 1 to 3 are Label, FileRequest and Text, the IDs are:
      <pre>
<code>Field 1 (Label):                 1200<br />Field 2 (FileRequest) text part: 1201<br />                    button part: 1202<br />Field 3 (Text):                  1203</code>
</pre>I'll see if I can make a note about this in the InstallOptions readme (after I sort that bug out...)!
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">deguix</span><br />
      <span class="post-time small text-muted">12th January 2004 21:13 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Now things are clear, thanks eccles.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">eccles</span><br />
      <span class="post-time small text-muted">12th January 2004 23:33 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"></p>

      <blockquote>
        with "NOTIFY" flag, it calls the "Leave Function" two times
      </blockquote>OK, this bug is now fixed. Thanks for the report.<br />
      <br />
      Anyone want to look at the Banner plugin problem? I'm not familiar with the Banner plugin code.<br />
      <br />
      --<br />
      Dave.
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">deguix</span><br />
      <span class="post-time small text-muted">11th April 2004 13:52 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Now I have a new problem with <b>Install Options</b> plugin:<br />
      <br />
      - <b>Question</b>: I have a button control in a page to quit the program and to open another using <i>NOTIFY</i> flag with its code in the <i>leave_function</i>. But how can I unload InstallOptions plugin on this situation, as it is showing the page?</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Joost Verburg</span><br />
      <span class="post-time small text-muted">11th April 2004 18:08 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">When closing your installer everything will be unloaded.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">deguix</span><br />
      <span class="post-time small text-muted">11th April 2004 21:46 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Yeah, but when you quit the program, its file <i>InstallOptions.dll</i> that is inside the $PLUGINSDIR is kept there. I can only delete the dll when it's unloaded, but if I can't unload before quiting, the file will stay in the user's computer...</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Joost Verburg</span><br />
      <span class="post-time small text-muted">11th April 2004 23:02 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">You can always let it continue and quit in the pre function of the next page.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">deguix</span><br />
      <span class="post-time small text-muted">12th April 2004 23:07 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Joost, I think something should be changed here, as you said here:<br />
      <br /></p>

      <blockquote>
        When closing your installer everything will be unloaded.
      </blockquote>And everytime a plugin is unloaded its file is deleted when the installer quits, as you said in another thread (considering here that I didn't unload it on the normal NSIS script):<br />
      <br />

      <blockquote>
        ...[Files inside $PLUGINSDIR] will automatically be deleted when the installer quits.
      </blockquote>So a plugin used should be deleted (as it is in $PLUGINSDIR) even when not unloaded using a normal NSIS script, because it will be unloaded when the installer quits and deleted after deleting the files.
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Joost Verburg</span><br />
      <span class="post-time small text-muted">13th April 2004 07:35 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">If the plug-in is in use it won't be deleted, because the installer is still running when deleting plug-ins.</p>
    </div>
    <hr />

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]>
  </script>
</body>
</html>
