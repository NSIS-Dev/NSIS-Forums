<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="How to tell if a Dll is Registered?" />

  <title>How to tell if a Dll is Registered? - NSIS Forums</title><!-- Bootstrap core CSS -->
  <link rel="stylesheet" type="text/css" href="//netdna.bootstrapcdn.com/bootswatch/3.0.1/readable/bootstrap.min.css" />
  <link rel="stylesheet" href="../css/style.css" type="text/css" /><!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!--[if lt IE 9]>
                <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
                <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->
</head>

<body>
  <div class="container">
    <!-- Put navigation bar here -->

    <ol class="breadcrumb">
      <li><a href="../index.html" class="glyphicon glyphicon-home"></a></li>

      <li><a href="f-65.html">NSIS Discussion</a></li>

      <li class="active">How to tell if a Dll is Registered?</li>
    </ol>

    <p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=356220">How to tell if a Dll is Registered?</a></p><br />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">RossW</span><br />
      <span class="post-time small text-muted">23rd February 2013 17:51 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>How to tell if a Dll is Registered?</strong><br />
      I searched the forum but everything I found related to knowing about an installable Dll, and of course the "!insertmacro InstallLib REGDLL" handles that for you. In my case, the Dll in question is not part of my installer but I want to alert the user running my installer if the MS Windows Image Acquisition Library (wiaaut.dll) isn't registered on their system (seems like it's there ootb for Windows 7 but not for XP. For Windows Server 2008, the dll can be found in a subfolder but it's not registered).<br />
      <br />
      Is there an easy way to tell if a Dll is registered on a box? I know the GUID for the Dll's TypeLib entry in the registry (HKEY_CLASSES_ROOT\TypeLib\{94A0E92D-43C0-494E-AC29-FD45948A5221}) but is checking for that sufficient? I'd also like to know the install path which really depends on the OS (for XP, it's c:\windows\system32\wiaaut.dll) which might be under different subkeys depending on the OS (again, on XP it's there under 1.0 &gt; 0 &gt; win32).</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">LoRd_MuldeR</span><br />
      <span class="post-time small text-muted">24th February 2013 02:39 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Well, if we talk about "registering" a DLL, we actually talk about COM DLL's. Registering a COM "in process" server (COM DLL) does nothing but calling the <i>DllRegisterServer</i> entry point of the DLL. It's up to the developer of the COM DLL to create and export that function. It may do pretty much anything! It usually creates the registry entries needed to make the COM class provided by the DLL available to other applications, but it may do arbitrary other things.<br />
      <br />
      I guess the best way to check whether a "COM DLL" is "registered" would be checking whether the <i>COM class</i> provided by that DLL - and after all that's what you want to use, right? - is available or not. Just try to create an instance of that class via CoCreateInstance(), using the right CLSID. If that function fails with REGDB_E_CLASSNOTREG it means the class is not registered. And thus the COM DLL that is supposed to provide that class obviously has not been registered yet...</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">RossW</span><br />
      <span class="post-time small text-muted">27th February 2013 16:26 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">That sounds ideal, LoRd_MuldeR. I have the TypeLib GUID for the dll - how do I find the CLSID?</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">LoRd_MuldeR</span><br />
      <span class="post-time small text-muted">27th February 2013 20:37 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">OleView?<br />
      <br />
      <a href="http://www.microsoft.com/en-us/download/details.aspx?id=17657" target="_blank">http://www.microsoft.com/en-us/downl....aspx?id=17657</a></p>
    </div>
    <hr />

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]>
  </script>
</body>
</html>
