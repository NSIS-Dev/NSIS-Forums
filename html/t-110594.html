<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content=".scr to .exe question" />

  <title>.scr to .exe question - NSIS Forums</title>
  <script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script>
  <!-- Bootstrap core CSS -->

  <link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css" />
  <link rel="stylesheet" href="../css/style.css" type="text/css" /><!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!--[if lt IE 9]>
                <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
                <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->
</head>

<body>
  <div class="container">
    <!-- Put navigation bar here -->

    <ol class="breadcrumb">
      <li><a href="../index.html" class="glyphicon glyphicon-home"></a></li>

      <li><a href="f-65.html">NSIS Discussion</a></li>

      <li class="active">.scr to .exe question</li>
    </ol>

    <p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=110594">.scr to .exe question</a></p><br />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">stepan</span><br />
      <span class="post-time small text-muted">20th October 2002 01:57 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>.scr to .exe question</strong><br />
      Hello,<br />
      <br />
      After doing a few unsuccesful searches I've finally run into this forum. I'm trying to make an installer file for my screensaver (.scr)<br />
      I got as far as having the file copied into 'windows' directory from the .exe - however, this is where I got stuck.<br />
      <br />
      Normally to install the screensaver, one would have to rightclick on the .scr file, select 'install', which would call up the 'display properties / screensavers' and set the screensaver as 'default screensaver' automatically.<br />
      <br />
      How can I get this working with NSIS installer?<br />
      <br />
      Any tips/suggestions would be much appreciated.<br />
      Thank you,<br />
      <br />
      Stepan</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Dick4</span><br />
      <span class="post-time small text-muted">20th October 2002 06:23 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">I believe you'll need to edit the registry...changing HKCU\Control Panel\Desktop and modifying the "SCRNSAVE.EXE" string value to be the full path to your .scr file.<br />
      <br />
      Similar article from MS here:<br />
      <br />
      <a href="http://support.microsoft.com/default.aspx?scid=kb;en-us;Q185348#Task1" target="_blank">http://support.microsoft.com/default...;Q185348#Task1</a></p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">stepan</span><br />
      <span class="post-time small text-muted">20th October 2002 15:51 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Thanks for the tip but this seems to be for W2000 only and considered I'll want this to work for 98up at least I think I'll have to find out what the 'display options/screensaver' do or the .scr / install.<br />
      :(<br />
      <br />
      anyone else?<br />
      <br />
      step</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
      <span class="post-time small text-muted">20th October 2002 18:06 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Taken from HKCR\scrfile\shell\install\command:<br />
      rundll32.exe desk.cpl,InstallScreenSaver %l<br />
      <br />
      Using ExecWait 'rundll32.exe desk.cpl,InstallScreenSaver "C:\whatever\myscreensaver.scr"' should produce the same results as right clicking on the .scr file and choosing install.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Dick4</span><br />
      <span class="post-time small text-muted">21st October 2002 01:32 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">heh, good thinking Kichik...</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">stepan</span><br />
      <span class="post-time small text-muted">12th November 2002 01:59 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Thanks a lot - that did the job... :) :) :)</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">nickjohnston</span><br />
      <span class="post-time small text-muted">12th October 2003 14:50 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>Still requires user input on Win98</strong><br /></p>

      <blockquote>
        <i>Originally posted by kichik</i><br />
        <b>Taken from HKCR\scrfile\shell\install\command:<br />
        rundll32.exe desk.cpl,InstallScreenSaver %l<br />
        <br />
        Using ExecWait 'rundll32.exe desk.cpl,InstallScreenSaver "C:\whatever\myscreensaver.scr"' should produce the same results as right clicking on the .scr file and choosing install.</b>
      </blockquote>I'm trying to do the same as the original poster, and just running<br />
      <br />
      rundll32 desk.cpl,InstallScreenSaver "c:\windows\blonde~1.scr"<br />
      <br />
      from a DOS box actually brings up the screensaver dialog with the desired screensaver selected, but the user still has to click OK.<br />
      <br />
      Is there any way of removing this behaviour?<br />
      <br />
      Thanks,<br />
      <br />
      Nick
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
      <span class="post-time small text-muted">12th October 2003 15:38 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Not that I know of.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">nickjohnston</span><br />
      <span class="post-time small text-muted">12th October 2003 18:38 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"></p>

      <blockquote>
        <i>Originally posted by kichik</i><br />
        <b>Not that I know of.</b>
      </blockquote>Well, I just had a bit of a thought about this, not sure if it's possbile from NSIS though - could I 'locate' that window by its title (will be different in different versions of the OS though possibly) and then use 'SendKeys' or similar to send keystrokes to the window e.g. ESC?<br />
      <br />
      Thanks,<br />
      <br />
      Nick
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Joost Verburg</span><br />
      <span class="post-time small text-muted">12th October 2003 19:21 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Should be possible using the System plug-in. However, window finding will be difficult with localized Windows versions.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
      <span class="post-time small text-muted">13th October 2003 12:31 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">It should be possible using FindWindow, GetDlgItem and SendMessage too, without System.dll. Though the best method would probably include a plug-in using hooks (something like <a href="http://forums.winamp.com/showthread.php?s=&amp;threadid=130323&amp;highlight=regdll" target="_blank">DisableMB</a>). You'd still have to find a unique way to identify the dialog but I think GetModuleFileName should be able to help there because the hook would be loaded into the process's memory.</p>
    </div>
    <hr />

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]>
  </script>
</body>
</html>
