<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="Using NSIS for Install based on reg keys" />

  <title>Using NSIS for Install based on reg keys - NSIS Forums</title><!-- Bootstrap core CSS -->
  <link rel="stylesheet" type="text/css" href="//netdna.bootstrapcdn.com/bootswatch/3.0.1/readable/bootstrap.min.css" />
  <link rel="stylesheet" href="../css/style.css" type="text/css" /><!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!--[if lt IE 9]>
                <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
                <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->
</head>

<body>
  <div class="container">
    <!-- Put navigation bar here -->

    <ol class="breadcrumb">
      <li><a href="../index.html" class="glyphicon glyphicon-home"></a></li>

      <li><a href="f-65.html">NSIS Discussion</a></li>

      <li class="active">Using NSIS for Install based on reg keys</li>
    </ol>

    <p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=165570">Using NSIS for Install based on reg keys</a></p><br />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">lardiop</span><br />
      <span class="post-time small text-muted">19th January 2004 04:32 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>Using NSIS for Install based on reg keys</strong><br />
      Hey everyone...<br />
      <br />
      I am a serious noob at NSIS, and this is probably very easy to do, I just cant figure it out. I have to write a program that will, based on reading a series of reg keys default to a certain install routine. here's what I mean:<br />
      <br />
      1) Start the install with a basic intro.<br />
      2) Read a series of registry keys, and based on those keys, display a list of what is and what isn't installed, then automatically check off what needs to be installed.<br />
      3) I need to install Microsoft Hotfixes that a computer is missing with the silent switch set. (IE: /q or /x etc) Basically, I am trying to use NSIS to envoke silent installs of programs, not actually copying files or creating uninstall routines.<br />
      <br />
      Could someone show me/give me a framework/template for something like this?<br />
      <br />
      Much Appreciated! :D</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">blayde</span><br />
      <span class="post-time small text-muted">19th January 2004 14:17 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">i'm a bit of a noob too, so i can't give you an exact answer, but i can't see any technical reason why you couldn't roughly do what you are asking.<br />
      <br />
      one option is to simply build a script that checks every hotfix you code in, and apply it as required. it wouldn't be as pretty as you painted in your example, but you could certainly use DetailPrint to let the user know what was going on.<br />
      <br />
      <br />
      for each hofix i would basically do :<br />
      <br />
      1) use ReadRegStr to read the registry value/ find out if it exists. (1)<br />
      2) use StrCmp to find out if it is something requiring updating (1)<br />
      3) update if so, else do next hotfix<br />
      <br />
      <br />
      notes :<br />
      <br />
      (1) for strings only, there are functions to for non-strings<br />
      <br />
      - some microsoft updates cannont be done automatically via NSIS, AFAIK. only those that use update.exe or come packaged in their own .exe.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">lardiop</span><br />
      <span class="post-time small text-muted">19th January 2004 17:47 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>Re: Installs</strong><br />
      Can I run the Qxxxxxx.exe or KBxxxxxxx.exe patches from MS using some sort of run command inside of NSIS based on wheather a reg key has a certain value?</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Joost Verburg</span><br />
      <span class="post-time small text-muted">19th January 2004 18:07 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Sure, use StrCmp to compare the value you have read from the key.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">blayde</span><br />
      <span class="post-time small text-muted">20th January 2004 05:42 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">a) in case i confused/worried you. what i was referring to above was that some updates only get installed via an .inf - i don't know how you would do that via NSIS<br />
      <br />
      b) you should be able to run the update files by Exec or ExecWait<br />
      <br />
      c) i would be interested in using your code once your finished :)</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Vytautas</span><br />
      <span class="post-time small text-muted">20th January 2004 11:39 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">To install from an .inf file use this command</p>
      <pre>
<code>ExecWait '$SYSDIR\rundll32.exe setupapi,InstallHinfSection DefaultInstall 132 "path to inf"'</code>
</pre><br />
      Vytautas :D
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Dick4</span><br />
      <span class="post-time small text-muted">21st January 2004 17:52 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"></p>

      <blockquote>
        <i>Originally posted by blayde</i><br />
        <b><br />
        c) i would be interested in using your code once your finished :)</b>
      </blockquote>
    </div>
    <hr />

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]>
  </script>
</body>
</html>
