<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="Jump to installer section after computer restart" />

  <title>Jump to installer section after computer restart - NSIS Forums</title>
  <script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script>
  <!-- Bootstrap core CSS -->

  <link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css" />
  <link rel="stylesheet" href="../css/style.css" type="text/css" /><!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!--[if lt IE 9]>
                <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
                <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->
</head>

<body>
  <div class="container">
    <!-- Put navigation bar here -->

    <ol class="breadcrumb">
      <li><a href="../index.html" class="glyphicon glyphicon-home"></a></li>

      <li><a href="f-65.html">NSIS Discussion</a></li>

      <li class="active">Jump to installer section after computer restart</li>
    </ol>

    <p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=307991">Jump to installer section after computer restart</a></p><br />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kporter20</span><br />
      <span class="post-time small text-muted">5th July 2009 08:56 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>Jump to installer section after computer restart</strong><br />
      Hi, as part of an installer I am creating I need to install Windows Installer 4.5 as a pre-requisite to SQL Express 2008.<br />
      <br />
      Windows Installer 4.5 requires a reboot for system changes to take effect and the SQL 2008 installer will fail to start if there is a reboot pending.<br />
      <br />
      I have been able to get my installer to restart after the computer restart but I need it to resume with the next selected section of the installer. Currently, it displays the Welcome page and I have to click through and select components again.<br />
      <br />
      I have stored the installer path in the RunOnce registry key as follows:<br />
      <br />
      ;--------------------------------<br />
      ;Installer Sections<br />
      Section "Windows Installer 4.5"<br />
      StrCpy $PRODUCTNAME "Internet Tracker"<br />
      SetOutPath $INSTDIR<br />
      SetShellVarContext all<br />
      <br />
      ; store where the installer should resume from<br />
      System::Call 'kernel32::GetModuleFileNameA(i 0, t .R0, i 1024) i r1'<br />
      <br />
      ; $R0 will contain the installer filename<br />
      WriteRegStr HKLM Software\Microsoft\Windows\CurrentVersion\Run "SetupContinue" '"$R0"'<br />
      <br />
      ; install Windows Installer 4.5 and force reboot<br />
      File "WindowsXP-KB942288-v3-x86.exe"<br />
      ExecWait "WindowsXP-KB942288-v3-x86.exe /passive /forcerestart"<br />
      Delete "WindowsXP-KB942288-v3-x86.exe"<br />
      SectionEnd<br />
      <br />
      I then have another section for .NET and this is where I need the installer to resume from.<br />
      <br />
      Any help and examples on how to do this would be greatly appreciated.<br />
      <br />
      Thanks<br />
      <br />
      Kevin</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
      <span class="post-time small text-muted">6th July 2009 14:17 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">You'll need to re-run your installer after the reboot with a command line switch. You can use GetParameters and GetOptions to detect it (see manual). You'll then need to call Abort in all page pre functions (or use RelGotoPage on Wiki) and ensure all sections prior to the one to run are unselected (use the UnselectSection macro in Sections.nsh) or jumped over (using an ${If}/${Unless}...${EndIf} or StrCmp and a label).<br />
      <br />
      Stu</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kporter20</span><br />
      <span class="post-time small text-muted">6th July 2009 14:41 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Thanks. :)<br />
      <br />
      I will give it a try later and post back if I have any problems.</p>
    </div>
    <hr />

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]>
  </script>
</body>
</html>
