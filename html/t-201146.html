<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="Plugin to extract 7-Zip 4.10 files" />

  <title>Plugin to extract 7-Zip 4.10 files - NSIS Forums</title><!-- Bootstrap core CSS -->
  <link rel="stylesheet" type="text/css" href="//netdna.bootstrapcdn.com/bootswatch/3.0.2/readable/bootstrap.min.css" /><!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!--[if lt IE 9]>
                <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
                <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->
</head>

<body>
  <div class="container">
    <!-- Put navigation bar here -->

    <ol class="breadcrumb">
      <li><a href="../index.html" class="glyphicon glyphicon-home"></a></li>

      <li><a href="f-65.html">NSIS Discussion</a></li>

      <li class="active">Plugin to extract 7-Zip 4.10 files</li>
    </ol>

    <p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=201146">Plugin to extract 7-Zip 4.10 files</a></p><br />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Mad Doggie</span><br />
      <span class="post-time small text-muted">4th December 2004 22:53 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>Plugin to extract 7-Zip 4.10 files</strong><br />
      &nbsp; Is there a plug-in that can decompress archives created by 7-zip v4.12? I would like to use 7Zip to decrease the size of my downloadable components.<br />
      <br />
      Cheers!</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
      <span class="post-time small text-muted">5th December 2004 12:01 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">You'll have to use 7-Zip's command-line 7z.exe program to decompress 7z files.<br />
      <br />
      You should compress it into your installer, and place it in a folder (e.g. $PLUGINSDIR) on run-time then execute it with nsExec::Exec.<br />
      <br />
      -Stu</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Mad Doggie</span><br />
      <span class="post-time small text-muted">8th December 2004 05:49 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"></p>

      <blockquote>
        <i>Originally posted by Afrow UK</i><br />
        <b>You'll have to use 7-Zip's command-line 7z.exe program to decompress 7z files. You should compress it into your installer, and place it in a folder (e.g. $PLUGINSDIR) on run-time then execute it with nsExec::Exec.</b>
      </blockquote>Bummer. Thanks for the info - I was hoping I could use a native NSIS plug-in and get the same feedback as ZipDLL does. Oh well, I guess nothing on the horizon on this front? ;)
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
      <span class="post-time small text-muted">8th December 2004 13:05 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">You can use nsExec::ExecToLog to stream the 7z output directly to the installation progress window.<br />
      <br />
      -Stu</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Brummelchen</span><br />
      <span class="post-time small text-muted">30th May 2005 21:40 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">7zip went final 7.20.<br />
      <br />
      I would appreciate a plugin using 7zip for archiving like<br />
      "nsexec::7zip '"c:\temp\*.txt" /switch'<br />
      or another built-in solution...<br />
      <br />
      WinRAR also uses a newer 7zxa.dll instead an bigger exe 7za.exe</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Joel</span><br />
      <span class="post-time small text-muted">17th June 2005 20:28 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Update:<br />
      <br />
      I'm a making a plugin for decompressing 7z files (~60KB DLL), but I need to know if theres one already...<br />
      <br />
      :)</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">saivert</span><br />
      <span class="post-time small text-muted">21st June 2005 23:15 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Joel! Just go ahead and make it.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">PerditionC</span><br />
      <span class="post-time small text-muted">3rd July 2005 17:24 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">If one doesn't really need the 7z format and just wants to use the LZMA compression method, then there is also the ExtractDLLEx or untgz plugins.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">brainsucker</span><br />
      <span class="post-time small text-muted">4th July 2005 21:50 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Some time ago I wrote a simple plugin for uncompressing 7z files with progress reporting. It was based on the console sfx with changed console interface to some kind of nsis wrapper. It was big enough (144 kb), but due to size (32 mb to 27 mb from nsis lzma to 7z file) and time (i've used archive as merge module, which never changes) economy, that really doesn't matter for me.<br />
      However I've lost one of my hdd's some weeks ago, so at present time I have no source code of that plugin, just compiled dll.<br />
      <br /></p>
      <pre>
<code>SetOutPath $INSTDIROCRFREBin
<br />&gt;; increase size
<br />AddSize 85000
<br />&gt;; use precompressed 7zip fre file
<br />SetCompress off
<br />DetailPrint "Extracting FineReader Engine..."
<br />&gt;File /a "Misc\frebin.7z"
<br />&gt;SetCompress auto
<br />DetailPrint "Installing FineReader Engine..."
<br />&gt;nsis7z::Extract "frebin.7z"
<br />&gt;Delete "$INSTDIR\OCR\FRE\Bin\frebin.7z" 
</code>
</pre>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">saivert</span><br />
      <span class="post-time small text-muted">5th July 2005 14:59 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Since the source code for the 7-zip project is open-source there shouldn't be hard to implement this. I might have a crack at it sometime as well. But I don't know about the time. I wrote my own version of unzip plug-in for NSIS one time (based on source code for NSIS' Zip2EXE) and if 7-zip has some easy to use interface it will be doable.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">oborstad</span><br />
      <span class="post-time small text-muted">7th February 2006 20:30 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Any Update on this plugin?</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Brummelchen</span><br />
      <span class="post-time small text-muted">7th February 2006 20:39 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">why should it ?</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">oborstad</span><br />
      <span class="post-time small text-muted">7th February 2006 22:19 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Ah, Sorry... I mean if there was an updated copy of this plugin with the updated 7-zip files. This plugin's 7zip files aren't up to date, and the source code's not provided (ala 7zip licence). So I just wanted to ask if there was any update on the status of the plugin.<br />
      <br />
      Owen.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Brummelchen</span><br />
      <span class="post-time small text-muted">13th February 2006 06:13 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">write to the author pls</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">brainsucker</span><br />
      <span class="post-time small text-muted">9th January 2009 15:58 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>Nsis7z plugin updated</strong><br />
      &nbsp; Hello everyone ;)<br />
      <br />
      I've spent some time to rewrite (due to lost source code) Nsis7z plugin using the latest 7z (4.64), this time the source code is available, so no one should have problems using/distributing it.<br />
      <br />
      This plugin allows our company to create merge-modules (as 7z archives) with prepacked files used in every release, saving some space (due to better compression ratio) and time (60mb 7z archive compiles to NSIS setup in several seconds, compare that with the time required to pack 250mb of original files).<br />
      <br />
      This post - complete distribution with source, next - stripped with plugin and example only.<br />
      <br />
      Best regards, Nik.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">brainsucker</span><br />
      <span class="post-time small text-muted">9th January 2009 15:59 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Nsis7z (based on 7z 4.64) binary distribution.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">redxii</span><br />
      <span class="post-time small text-muted">17th January 2009 02:34 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Can it extract to a different directory and without paths? To do the equivalent of this command: 7za.exe e "downloadedfileusingnsisdl.7z" -o"$INSTDIR\some\path" -y eliminating the middle-man.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Yathosho</span><br />
      <span class="post-time small text-muted">18th January 2009 11:13 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">first of all, thanks for this great plugin.. i was looking for this for ages!<br />
      <br />
      i was wondering, if it would be easy to add support to create 7z files (or make it a seperate plugin).<br />
      <br />
      about decompression, i'm looking for a way to create a similiar dialog like the inbuild "unpacking data" at the launch of (huge) installers. i guess i could use a banner plugin, but can i display the unpacking status in there? i guess the 7z would have to support this in a way?</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Yathosho</span><br />
      <span class="post-time small text-muted">28th January 2009 14:29 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">does this plugin handle passwords? does it report if an archive is protected by password?</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">dbach</span><br />
      <span class="post-time small text-muted">26th March 2009 14:05 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Hi,<br />
      <br />
      I've just found your plugin and its great.<br />
      Question: Does it respect the SetOverWrite value?</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">dbach</span><br />
      <span class="post-time small text-muted">27th March 2009 12:20 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"></p>

      <blockquote>
        <i>Originally posted by dbach</i> <b>Question: Does it respect the SetOverWrite value?</b>
      </blockquote>To answer myself (;)) no, it doesnt.<br />
      <br />
      Bug:<br />
      - Files not ending with .7z are not extracted (e.g. rename product.7z -&gt; product.001, try extraction)<br />
      <br />
      Featurewish:<br />
      - Nsis7z should respect SetOverwrite<br />
      <br />
      Thanks :)
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">qwertymodo</span><br />
      <span class="post-time small text-muted">8th April 2009 05:51 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">I actually wrote something along these lines myself awhile back, just a header that uses 7za.exe... It can extract and create archives of any type supported by 7-zip, as well as practically all of the command-line functionality of 7za.exe (except test archive). If anyone is interested I'd be happy to post the header.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">dbach</span><br />
      <span class="post-time small text-muted">8th April 2009 08:15 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"></p>

      <blockquote>
        <i>Originally posted by qwertymodo</i><br />
        <b>I actually wrote something along these lines myself awhile back, just a header that uses 7za.exe... It can extract and create archives of any type supported by 7-zip, as well as practically all of the command-line functionality of 7za.exe (except test archive). If anyone is interested I'd be happy to post the header.</b>
      </blockquote>Sure, go for it - the more the btter. Thanks a lot.
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">qwertymodo</span><br />
      <span class="post-time small text-muted">8th April 2009 21:52 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Ok I will. I just got into testing it more thoroughly than just what I needed when I first wrote it and there were a few weird bugs... I think I have them tracked down, so I'll post it soon.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">qwertymodo</span><br />
      <span class="post-time small text-muted">9th April 2009 02:33 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Here's my header. I am fairly certain that it works properly, but I wouldn't be surprised if some weirdness exists still. Sorry for the lack of documentation, the basic function calls are outlined in the comment at the top of the file. You'll need 7za.exe in the NSIS plugins directory to use it.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">dbach</span><br />
      <span class="post-time small text-muted">9th April 2009 08:24 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Thanks a lot for this. :)</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">qwertymodo</span><br />
      <span class="post-time small text-muted">9th April 2009 18:11 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Something that I should have mentioned was that "other parameters" can be ANY 7-zip flags (should be at least...), so read the 7-zip documentation for things that you can put into other parameters. Basically whatever you put there just gets appended to the end of the command-line call, so if it works in a command-line call it should work there.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">webtubbies</span><br />
      <span class="post-time small text-muted">28th October 2009 19:18 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Is there any documentation about nsis7z.dll returned error ?<br />
      I mean<br />
      - file to extract not found<br />
      - error during extraction<br />
      - etc...<br />
      <br />
      maybe someone here knows...</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Yathosho</span><br />
      <span class="post-time small text-muted">19th November 2009 14:49 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">i'm really glad this plugin exists, because i prefer this over using an external program. however, this would even be better if there was a way to use (some of the) switches 7zr.exe offers. personally i'm looking for a way to extract a specific file from an archive only, right now i have to use 7zr/7za to do the task.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">thanatos83</span><br />
      <span class="post-time small text-muted">3rd January 2010 16:48 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">hi guys, this plugin can extract rar files too???</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Joel</span><br />
      <span class="post-time small text-muted">4th January 2010 01:26 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"></p>

      <blockquote>
        <i>Originally posted by thanatos83</i><br />
        <b>hi guys, this plugin can extract rar files too???</b>
      </blockquote>Hi thanatos83, you need to read a little further ;)<br />
      Since the plugin reads files from 7zip, let's got its <a href="http://www.7-zip.org/" target="_blank">site</a>, quote from there:<br />

      <blockquote>
        Supported formats:<br />
        <br />
        * Packing / unpacking: 7z, ZIP, GZIP, BZIP2 and TAR<br />
        * Unpacking only: ARJ, CAB, CHM, CPIO, DEB, DMG, HFS, ISO, LZH, LZMA, MSI, NSIS, <b>RAR</b>, RPM, UDF, WIM, XAR and Z.<br />
      </blockquote>How about that :D
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">fedotawa</span><br />
      <span class="post-time small text-muted">11th May 2010 09:12 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Plugin breaks non ANSI file pathname encoding (for example it switches from cyrillic 1251 to 866, this causes shortcut creation into inproper places).<br />
      <br />
      Here's a fix.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">thanatos83</span><br />
      <span class="post-time small text-muted">1st September 2010 01:53 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Hi...<br />
      <br />
      I need a help please with this plugin... I read the wiki about the usage of this plugin, like this:<br />
      <br />
      <b>Unpack you merge module as 7z archive to somewere on users harddrive, set target dir for archive contents with SetOutPath, and call plugin.</b><br />
      <br />
      My question is:<br />
      <br />
      when this say merge module it is referred to standalone file 7za.exe???</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">MSG</span><br />
      <span class="post-time small text-muted">1st September 2010 06:53 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">I think that line is trying to say "unpack your 7z archive using the File command, then use SetOutPath to set the extraction output directory and call the plugin."</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">thanatos83</span><br />
      <span class="post-time small text-muted">1st September 2010 11:15 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">OK ,so i saw that example but before from command script <b>File</b> you can see <b>SetCompress off</b>. But i think about the file command, it compress that 7z into setup.exe (so SetCompress off is not working?)<br />
      <br />
      This plugin first copy 7z into harddrive and then extracts the contents???<br />
      <br />
      I was searching for a long time a plugin that allow me to extract contents froms some 7z files with an animated bar but only i need to extract it from fixed media like DVD. So I need to make a little setup.exe...<br />
      <br />
      thanks.<br />
      <br />
      P.D.<br />
      <br />
      <b>Sorry admin about duplicate post, please delete one...</b></p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">thanatos83</span><br />
      <span class="post-time small text-muted">1st September 2010 11:16 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">OK ,so i saw that example but before from command script <b>File</b> you can see <b>SetCompress off</b>. But i think about the file command, it compress that 7z into setup.exe (so SetCompress off is not working?)<br />
      <br />
      This plugin first copy 7z into harddrive and then extracts the contents???<br />
      <br />
      I was searching for a long time a plugin that allow me to extract contents froms some 7z files with an animated bar but only i need to extract it from fixed media like DVD. So I need to make a little setup.exe...<br />
      <br />
      thanks. :)</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">MSG</span><br />
      <span class="post-time small text-muted">1st September 2010 12:22 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"></p>

      <blockquote>
        <small>Originally posted by thanatos83</small><br />
        OK ,so i saw that example but before from command script <b>File</b> you can see <b>SetCompress off</b>. But i think about the file command, it compress that 7z into setup.exe (so SetCompress off is not working?)
      </blockquote>No, the command only makes NSIS turn off compression. Of course it still stores the file in the installer, otherwise it wouldn't be able to extract the file when the File command is called during installation. Turning off compression only helps by making the installer compilation go faster.<br />
      <br />

      <blockquote>
        <small>Originally posted by thanatos83</small><br />
        This plugin first copy 7z into harddrive and then extracts the contents???
      </blockquote>Please don't use ??? like that, it makes you sound like you're shouting.<br />
      <br />
      And no. You first have to copy the 7z to the harddrive using the File command (it's actually called extracting, not copying, because you need to extract it from the installer exe.) Or you can use a 7z file from a CD, or a downloaded one, of course.
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">thanatos83</span><br />
      <span class="post-time small text-muted">1st September 2010 14:17 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">thanks MSG and sorry for "???" :)<br />
      <br />
      I have some files in 7z format file, so my project takes about 8GB...so i need a plugin that allow me to extract these files from fixed media, like DVD...<br />
      <br />
      If i use de 7z standalone file for use command line, this work for me but progress bar not moving and not showing the information progress like "10% - file.xx".</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">MSG</span><br />
      <span class="post-time small text-muted">1st September 2010 14:58 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Indeed, the standalone 7z is not designed for NSIS, so it will not output information to the NSIS log by itself. You can try using nsExec::ExecToLog, but if I recall correctly it doesn't work here because 7z doesn't just print information, it updates it as well (like the percentage counter). And that doesn't work with ExecToLog, as far as I know.<br />
      <br />
      But have you tried the 7z plugin? It should be able to unpack a 7z archive just fine.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">thanatos83</span><br />
      <span class="post-time small text-muted">1st September 2010 20:19 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Hi ...<br />
      <br />
      Yes MSG, worked fine if i use 7za.exe...</p>
    </div>
    <hr />

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]>
  </script>
</body>
</html>
