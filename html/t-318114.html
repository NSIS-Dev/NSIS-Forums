<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="Gradual progress bar when install applications silently" />

  <title>Gradual progress bar when install applications silently - NSIS Forums</title><!-- Bootstrap core CSS -->
  <link rel="stylesheet" type="text/css" href="//netdna.bootstrapcdn.com/bootswatch/3.0.1/readable/bootstrap.min.css" />
  <link rel="stylesheet" href="../css/style.css" type="text/css" /><!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!--[if lt IE 9]>
                <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
                <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->
</head>

<body>
  <div class="container">
    <!-- Put navigation bar here -->

    <ol class="breadcrumb">
      <li><a href="../index.html" class="glyphicon glyphicon-home"></a></li>

      <li><a href="f-65.html">NSIS Discussion</a></li>

      <li class="active">Gradual progress bar when install applications silently</li>
    </ol>

    <p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=318114">Gradual progress bar when install applications silently</a></p><br />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">jdt2oo7</span><br />
      <span class="post-time small text-muted">2nd April 2010 00:12 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>Gradual progress bar when install applications silently</strong><br />
      Hello all,<br />
      <br />
      I've been looking through progress bar threads in this forum and haven't find what I need yet. I have an installer which installs a few applications base on user's selection.<br />
      <br />
      The problem I am having: if an application A is installing silently, the progress status doesn't increase until installation is completed, or just barely increase that user can't even notice. For example, at the beginning of application A installation, progress is positioned at 8%, then after installation, it would jumps to 15%. One application could take up to 2 minutes to install, and since there is no increase in progress bar, it gives user an impression that the installation hangs.<br />
      <br />
      Number of applications to be installed varies depend on user's selection so I can't pre-defined the percentage of progress bar to each app.<br />
      <br />
      Any help/pointer is greatly appreciate.<br />
      <br />
      Thanks!</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Animaether</span><br />
      <span class="post-time small text-muted">2nd April 2010 02:29 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">You could pop up a little dialog with a marquee style progressbar (the kind that runs from left to right indefinitely) using Nxs:<br />
      <a href="http://nsis.sourceforge.net/Nxs_plug-in" target="_blank">http://nsis.sourceforge.net/Nxs_plug-in</a><br />
      <br />
      Just pop it up before you install the app and close it when done.<br />
      <br />
      If you're installing a bunch of things in silent mode one after the other, you can use its update function to change the text displayed, or get the window handle and play with the controls from there.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">jdt2oo7</span><br />
      <span class="post-time small text-muted">2nd April 2010 23:17 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Thanks Animaether!<br />
      <br />
      1. Do you know if there is an option to disable the blue screen display in the background "^Name Setup" ?<br />
      <br />
      2. I want to have an option for user to hide the progress bar if they don't want to see it anymore.<br />
      <br />
      nxs::Show /NOUNLOAD "$(Installing)..." /top "$(Installing)..." /h 0 /can 1 /marquee 50 /end<br />
      <br />
      nxs::getWindow /NOUNLOAD<br />
      Pop $0 ; $0 now contains the handle to the dialog<br />
      GetDlgItem $1 $0 2 ; button=2; top=8; progress=10; sub=11; icon=12<br />
      SendMessage $1 ${WM_SETTEXT} 1 "STR:&amp;Hide" ; Change button label &amp;Cancel to &amp;Hide<br />
      StrCpy $1 -1<br />
      <br />
      ExecWait "Setup.exe /S" $ExitCode5<br />
      <br />
      sleep:<br />
      IntOp $1 $1 + 1<br />
      Sleep $1<br />
      <br />
      nxs::HasUserAborted /NOUNLOAD<br />
      Pop $0 ; $0 now contains "1" if user clicked Cancel or "0" otherwise.<br />
      StrCmp $0 1 destroy<br />
      StrCmp $1 100 0 sleep<br />
      <br />
      destroy:<br />
      nxs::Destroy<br />
      <br />
      ----------<br />
      The problem is I use "ExecWait", so it won't able to check if user click "Hide" button.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">jdt2oo7</span><br />
      <span class="post-time small text-muted">3rd April 2010 01:26 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">I able to disable the background (question 1 above).</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Animaether</span><br />
      <span class="post-time small text-muted">3rd April 2010 01:35 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">The big gradiented blue background is unrelated to NxS - it's just part of the example files. Here's a more minimal example.<br /></p>
      <pre>
<code>Name</code><span style="color: #DD0000">"Nxsexample"<br /><br /></span><span style="color: #007700">!</span><span style="color: #0000BB">addplugindir</span><span style="color: #DD0000">"."<br /></span><span style="color: #007700">!include</span><span style="color: #DD0000">"MUI2.nsh"<br /></span><span style="color: #007700">!include</span><span style="color: #DD0000">"WinMessages.nsh"<br /><br /></span><span style="color: #0000BB">XPStyleon</span><span style="color: #007700">;</span><span style="color: #0000BB">Required</span><span style="color: #007700">for</span><span style="color: #0000BB">Marquee</span><span style="color: #007700">-</span><span style="color: #0000BB">styleprogressbars</span><span style="color: #007700">!</span><span style="color: #0000BB">alreadydefinedinMUI</span><span style="color: #007700">,</span><span style="color: #0000BB">butjustin</span><span style="color: #007700">case...<br /></span><span style="color: #0000BB">ShowInstDetailsshow<br /><br />OutFile</span><span style="color: #DD0000">"test.exe"<br /><br /></span><span style="color: #0000BB">Pageinstfiles<br /><br /><br /></span><span style="color: #007700">!</span><span style="color: #0000BB">defineMUI_CUSTOMFUNCTION_GUIINITonGuiInit<br /><br /></span><span style="color: #007700">Function</span><span style="color: #0000BB">onGUIInit<br /></span><span style="color: #007700">;</span><span style="color: #0000BB">plug</span><span style="color: #007700">-</span><span style="color: #0000BB">inrequiresthistobecalledin</span><span style="color: #007700">.</span><span style="color: #0000BB">onGUIInit<br /></span><span style="color: #007700">;if</span><span style="color: #0000BB">you</span><span style="color: #007700">use</span><span style="color: #0000BB">itinthe</span><span style="color: #007700">.</span><span style="color: #0000BB">onInit</span><span style="color: #007700">function.<br />;If</span><span style="color: #0000BB">youleaveitouttheinstallerdialogwillbeminimized</span><span style="color: #007700">.<br /></span><span style="color: #0000BB">ShowWindow$HWNDPARENT2<br />FunctionEnd<br /><br />Section<br />StrCpy</span><span style="color: #007700">$</span><span style="color: #0000BB">0</span><span style="color: #DD0000">"WindowsInstaller"<br /></span><span style="color: #0000BB">DetailPrint</span><span style="color: #DD0000">"Installing$0"<br /></span><span style="color: #0000BB">nxs</span><span style="color: #007700">::</span><span style="color: #0000BB">Show</span><span style="color: #007700">/</span><span style="color: #0000BB">NOUNLOAD</span><span style="color: #007700">`</span><span style="color: #0000BB">$(^Name)Setup</span><span style="color: #007700">`/</span><span style="color: #0000BB">top</span><span style="color: #007700">`</span><span style="color: #0000BB">Installingthirdpartysoftware$\r$\nPleasewait...</span><span style="color: #007700">`/</span><span style="color: #0000BB">sub</span><span style="color: #007700">`</span><span style="color: #0000BB">$\r$\n$\r$\n$0</span><span style="color: #007700">`/</span><span style="color: #0000BB">h0</span><span style="color: #007700">/</span><span style="color: #0000BB">marquee30</span><span style="color: #007700">/</span><span style="color: #0000BB">end<br />Sleep3000</span><span style="color: #007700">;</span><span style="color: #0000BB">simulateinstallingsomething</span><span style="color: #007700">...<br /><br /></span><span style="color: #0000BB">StrCpy</span><span style="color: #007700">$</span><span style="color: #0000BB">0</span><span style="color: #DD0000">"Microsoft.NETFramework"<br /></span><span style="color: #0000BB">DetailPrint</span><span style="color: #DD0000">"Installing$0"<br /></span><span style="color: #0000BB">nxs</span><span style="color: #007700">::</span><span style="color: #0000BB">Update</span><span style="color: #007700">/</span><span style="color: #0000BB">NOUNLOAD</span><span style="color: #007700">/</span><span style="color: #0000BB">sub</span><span style="color: #007700">`</span><span style="color: #0000BB">$\r$\n$\r$\n$0</span><span style="color: #007700">`/</span><span style="color: #0000BB">h0</span><span style="color: #007700">/</span><span style="color: #0000BB">marquee30</span><span style="color: #007700">/</span><span style="color: #0000BB">end<br />Sleep3000</span><span style="color: #007700">;</span><span style="color: #0000BB">simulateinstallingsomething</span><span style="color: #007700">...<br /><br /></span><span style="color: #0000BB">StrCpy</span><span style="color: #007700">$</span><span style="color: #0000BB">0</span><span style="color: #DD0000">"SUNJavaRun-TimeEnvironment"<br /></span><span style="color: #0000BB">DetailPrint</span><span style="color: #DD0000">"Installing$0"<br /></span><span style="color: #0000BB">nxs</span><span style="color: #007700">::</span><span style="color: #0000BB">Update</span><span style="color: #007700">/</span><span style="color: #0000BB">NOUNLOAD</span><span style="color: #007700">/</span><span style="color: #0000BB">sub</span><span style="color: #007700">`</span><span style="color: #0000BB">$\r$\n$\r$\n$0</span><span style="color: #007700">`/</span><span style="color: #0000BB">h0</span><span style="color: #007700">/</span><span style="color: #0000BB">marquee30</span><span style="color: #007700">/</span><span style="color: #0000BB">end<br />Sleep3000</span><span style="color: #007700">;</span><span style="color: #0000BB">simulateinstallingsomething</span><span style="color: #007700">...<br /><br /></span><span style="color: #0000BB">nxs</span><span style="color: #007700">::</span><span style="color: #0000BB">Destroy<br />SectionEnd<br /><br /></span><span style="color: #007700">!</span><span style="color: #0000BB">insertmacroMUI_LANGUAGE</span><span style="color: #DD0000">"English"
</span>
</pre>If you want to hide the progressbar, then check whether the user has aborted, destroy the dialog, and set a little variable that you can check that so that you won't open/update/destroy it when it no longer exists.
    </div>
    <hr />

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]>
  </script>
</body>
</html>
