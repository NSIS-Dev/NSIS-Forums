<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="nsRichEdit plug-in" />

  <title>nsRichEdit plug-in - NSIS Forums</title>
  <script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script>
  <!-- Bootstrap core CSS -->

  <link rel="stylesheet" type="text/css" href="//netdna.bootstrapcdn.com/bootswatch/3.0.1/readable/bootstrap.min.css" />
  <link rel="stylesheet" href="../css/style.css" type="text/css" /><!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!--[if lt IE 9]>
                <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
                <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->
</head>

<body>
  <div class="container">
    <!-- Put navigation bar here -->

    <ol class="breadcrumb">
      <li><a href="../index.html" class="glyphicon glyphicon-home"></a></li>

      <li><a href="f-65.html">NSIS Discussion</a></li>

      <li class="active">nsRichEdit plug-in</li>
    </ol>

    <p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=333267">nsRichEdit plug-in</a></p><br />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
      <span class="post-time small text-muted">6th August 2011 18:29 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>nsRichEdit plug-in</strong><br />
      * Load a file into a rich edit control (using EM_STREAMIN).<br />
      * Provides formatted printing of a rich edit control.<br />
      * Allows oneself to add a print button to the NSIS license pages.<br />
      <br />
      <a href="http://nsis.sourceforge.net/File:NsRichEdit.zip" target="_blank">http://nsis.sourceforge.net/File:NsRichEdit.zip</a><br />
      <br />
      Note to JasonFriday13 for CustomLicense plug-in: There are a number of errors in your code (which is one reason why I added my own function to this plug-in).<br />
      <br />
      29: Should be TCHAR* FileName.<br />
      42: !FileHandle is not a valid test for an invalid handle (only use INVALID_HANDLE_VALUE).<br />
      46, 56, 60: You're not closing the file handle.<br />
      87, 88: The amount of memory to allocate should be sizeof(TCHAR) * string_size (because Unicode characters are 2 bytes).<br />
      105: You are casting the return value from GetLastError to (const TCHAR*) and pushing it onto the stack. This will (in most cases) cause a crash. To convert an integer to a string, use wsprintf. Besides, I'm not sure why you are using GetLastError because GlobalAlloc does not set it.<br />
      <br />
      I'd recommend using EM_STREAMIN too as right now you are reading the entire license file into memory before setting it.<br />
      <br />
      Stu</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">T.Slappy</span><br />
      <span class="post-time small text-muted">8th August 2011 05:45 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Nice, your control replaces original License rich edit or it is only on new page [nsDialogs]?</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
      <span class="post-time small text-muted">8th August 2011 10:18 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">It can be used for any existing rich edit control as all it needs is a control handle (it does not create the control itself). It can be one you've added to a nsDialogs page or the existing license page rich edit control (use AddPrintButton for this). The example scripts demonstrate all functions.<br />
      <br />
      Stu</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">JasonFriday13</span><br />
      <span class="post-time small text-muted">3rd April 2012 12:41 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Cool, well it's nice to know a better piece of software has come up. My code was written way back when I was first understanding coding in C (initially to fix one of my installer problems). Some of the errors are obvious while others aren't. In fact, it's probably not worth keeping it on the wiki anymore as your plugin is clearly superior.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
      <span class="post-time small text-muted">21st April 2012 18:55 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">I have made a note on the wiki page.<br />
      <br />
      Stu</p>
    </div>
    <hr />

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]>
  </script>
</body>
</html>
