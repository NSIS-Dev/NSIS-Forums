<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="Uninstall Files from different location" />

  <title>Uninstall Files from different location - NSIS Forums</title><!-- Bootstrap core CSS -->
  <link rel="stylesheet" type="text/css" href="//netdna.bootstrapcdn.com/bootswatch/3.0.1/readable/bootstrap.min.css" />
  <link rel="stylesheet" href="../css/style.css" type="text/css" /><!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!--[if lt IE 9]>
                <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
                <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->
</head>

<body>
  <div class="container">
    <!-- Put navigation bar here -->

    <ol class="breadcrumb">
      <li><a href="../index.html" class="glyphicon glyphicon-home"></a></li>

      <li><a href="f-65.html">NSIS Discussion</a></li>

      <li class="active">Uninstall Files from different location</li>
    </ol>

    <p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=332787">Uninstall Files from different location</a></p><br />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">anandharaja</span><br />
      <span class="post-time small text-muted">24th July 2011 07:11 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>Uninstall Files from different location</strong><br />
      hi,<br />
      i want to create installer for my program, but i install the files in different location for example $PROGRAMFILES\My program1 and some files in $PROGRAMFILES\My program2 and so on. but the installer fail to uninstall files from different location.<br />
      <br />
      if i write uninstaller in my Program1 folder means it uninstall all files in my program1, failes to uninstall files in other locations.<br />
      <br />
      How can i create installer to uninstall all files.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">MSG</span><br />
      <span class="post-time small text-muted">24th July 2011 07:52 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">In the uninstaller the value of $INSTDIR is actually $EXEDIR. So while themost straight-forward way may seem to be just making two uninstallers, you'll run into the same problem when you're trying to execute the second one. :P<br />
      <br />
      So what you need to do is save the exact path that you installed to, either in the uninstaller using FileWriteByte etc, or in the registry or an ini file.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">anandharaja</span><br />
      <span class="post-time small text-muted">24th July 2011 10:12 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Thanks for the reply,<br />
      iam not write these type of installer before, can you provide example script.<br />
      Thanks.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">MSG</span><br />
      <span class="post-time small text-muted">24th July 2011 14:00 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">The manual has all the information you'll need. Simply use the INI commands to write the paths to an ini file. Then in un.onInit, read the paths from the INI file and you'll know what paths to delete your files from.<br />
      <br />
      <a href="http://nsis.sourceforge.net/Docs/Chapter4.html#4.9.2" target="_blank">http://nsis.sourceforge.net/Docs/Chapter4.html#4.9.2</a></p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">LoRd_MuldeR</span><br />
      <span class="post-time small text-muted">24th July 2011 14:33 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">If, during install, you ignore $INSTDIR (the install path selected by user) and instead install to some "fixed" paths, such as "$PROGRAMFILES\My program1" and "$PROGRAMFILES\My program2", then I think the uninstaller should also un-install (remove) files from the "fixed" paths "$PROGRAMFILES\My program1" and "$PROGRAMFILES\My program2". This won't work if the install folders were moved/renamed in the meantime, but in that case storing the original paths in some INI file or in the Registry doesn't help either...</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">MSG</span><br />
      <span class="post-time small text-muted">24th July 2011 15:35 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Of course, you should always verify that the path is correct. If for example it has the wrong files, then it's probably not safe to go deleting stuff...</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">LoRd_MuldeR</span><br />
      <span class="post-time small text-muted">24th July 2011 16:27 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"></p>

      <blockquote>
        <small>Originally posted by MSG</small><br />
        Of course, you should always verify that the path is correct. If for example it has the wrong files, then it's probably not safe to go deleting stuff...
      </blockquote>Sure. But my point was: He ignored the user-selected $INSTDIR and installed to a <i>fixed</i> path, such as "$PROGRAMFILES\My program1" instead. Of course the path is not "fixed" in the sense that it will be identical on every computer (because of $PROGRAMFILES), but it <i>is</i> fixed for a specific computer. So at un-install time it is safe to uninstall from the same fixed path that we installed to at install time. There is no need to remember a fixed path in an INI file or the Regsitry, because... well... it is fixed.<br />
      <br />
      (Assuming that the suffix "My program1" is unique to his program, of course! Not something commonly used by another product. But if the suffix wasn't unique, then installing to fixed path "$PROGRAMFILES\&lt;suffix&gt;" wouldn't be safe, in the first place)
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">anandharaja</span><br />
      <span class="post-time small text-muted">30th August 2011 09:21 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Thanks to <b>MSG</b> and <b>LoRd_MuldeR</b> for your replies.<br />
      but i still in confusion, where to i use WriteINI Str in Section or i need to create Function.<br />
      please can you provide example script with two sections.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">MSG</span><br />
      <span class="post-time small text-muted">30th August 2011 11:51 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">I suggest you create a hidden final section in your installer: Section "-LastSection" LastSection<br />
      In that section you use the INI instructions to write the path of 'My program2' to an ini file in the 'my program1' directory. The uninstaller, also created in the 'my program1' directory, can read the ini file using ReadINIStr (you can do this in the Uninstall section, or in the un.onInit function).<br />
      <br />
      I'm not going to write example code here, because it's extremely simple to do and it's a worthwhile exercise for you to figure it out on your own. Look at the INI command examples in the link I provided earlier, they'll show you how to use the commands.</p>
    </div>
    <hr />

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]>
  </script>
</body>
</html>
