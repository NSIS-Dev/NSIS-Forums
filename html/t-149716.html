<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="how to list subdirectories in order" />

  <title>how to list subdirectories in order - NSIS Forums</title>
  <script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script>
  <!-- Bootstrap core CSS -->

  <link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css" />
  <link rel="stylesheet" href="../css/style.css" type="text/css" /><!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!--[if lt IE 9]>
                <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
                <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->
</head>

<body>
  <div class="container">
    <!-- Put navigation bar here -->

    <ol class="breadcrumb">
      <li><a href="../index.html" class="glyphicon glyphicon-home"></a></li>

      <li><a href="f-65.html">NSIS Discussion</a></li>

      <li class="active">how to list subdirectories in order</li>
    </ol>

    <p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=149716">how to list subdirectories in order</a></p><br />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">psyke</span><br />
      <span class="post-time small text-muted">19th September 2003 15:48 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>how to list subdirectories in order</strong><br />
      Hello. :)<br />
      <br />
      I need to generate a list of subdirectories in a CAD folder... oh well, no need for those silly details, let me simplify it.<br />
      <br />
      OK - I have a directory on the system somewhere called 'CAD' whose contents I do not know in advance. I need to list the subdirectories of 'CAD' in a .txt file, and they <i>must</i> be listed in order.<br />
      <br />
      Alphabetical order, or the order in which windows lists them (which isn't quite alphabetical). Either way will do fine, but it has to be ordered. :(<br />
      <br />
      I have seen <a href="http://forums.winamp.com/showthread.php?s=&amp;threadid=117486&amp;highlight=directory+order" target="_blank">this thread</a>, saying that NSIS just uses Windows API calls and that's why there's no order that NSIS can control but it's almost a year old and I was hoping perhaps there was some change here. I'm no Windows coder at all, but wouldn't there be some API call for getting the directory contents in order that NSIS could use?<br />
      <br />
      I have written a script that lists the subdirectories of a specified folder. The results can be viewed in the installer details page or in the output file created by the installer. It would be great if the attached script could be made to output the subdirs in order. It's only 65 lines long (the script). not complicated. ;)<br />
      <br />
      <br />
      If there is <b>absolutely no way</b> that NSIS can do this :( then would it be possible somehow to sort the output file itself, i.e. write the unordered file, then call a sort function that sorts the file and outputs to a new, sorted file?<br />
      <br />
      I thank you for any help you can provide. :)</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
      <span class="post-time small text-muted">19th September 2003 15:55 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">There is no such API function I know of. You can try using DOS sort command. If it's not on every version of Windows, you might be able to simply include it with your installer, and if not DOS sort, then Win32GNU sort.exe.<br />
      <br />
      Use something like:<br />
      <br />
      sort file &gt; newfile<br />
      del file<br />
      ren newfile file</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">psyke</span><br />
      <span class="post-time small text-muted">19th September 2003 16:08 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Wow - thanks for the quick reply kichik. :)<br />
      <br />
      Ok, I'll look around and see if i can find an external sort program that i can use.<br />
      <br />
      Man - I just tried the 'sort' command on xp and it worked beautifully, I wonder if it'll work on other win32 though: win95 and up.<br />
      <br />
      I was trying to think of how to do an insertion sort from within NSIS on my unordered output file, but wasn't gettng very far... ;) weird without arrays of strings. :P<br />
      <br />
      Do you think it would be possible to efficiently sort an unordered file from NSIS kichik (i.e. with fileread, strcmp etc.), or no?<br />
      <br />
      I like to do everything from NSIS as much as possible, plus I'll have to try and hide the DOS window with external 'sort' - I think I saw some threads about that.<br />
      <br />
      Anyway, thanks again for your help, I appreciate it. :)<br />
      <br />
      (Edit: win32GNU sort works great too, plus the syntax is more familiar to me ;))<br />
      (Edit: nsExec seems to be the trick to hiding dos windows - this forum is great. :))</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Joost Verburg</span><br />
      <span class="post-time small text-muted">19th September 2003 16:19 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Sorting a list in alphabetical order is possible with NSIS scripting. You can use the stack and a sort algorithm like bubble sort.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">psyke</span><br />
      <span class="post-time small text-muted">19th September 2003 16:23 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">thanks for the tip joost! :)<br />
      (and thanks for your work on MUI :D)<br />
      <br />
      unfortunately, bubble sort is inefficient :( (might be a problem with a big file), and if i recall correctly, one needs to know the number of objects (though i suppose this could be determined by couting lines in the file).</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Joost Verburg</span><br />
      <span class="post-time small text-muted">19th September 2003 16:26 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">I mentioned bubble sort because it's a simple one. You can also use a more advaned algorithm, but you will only notice a difference when you have to sort thousands of lines. Having to know the number of objects should not be a problem. If you are using the script to get the items, there is no need to write them to a file before sorting.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">psyke</span><br />
      <span class="post-time small text-muted">19th September 2003 16:45 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Hmmm, I'm sure there will never be thousands of lines to sort. ;)<br />
      <br />
      If efficiency is not a problem, then I want to do it from 'inside' NSIS. :D<br />
      <br />
      Could I trouble you to perhaps point me in the right direction or get me started? I must confess that I am having trouble envisioning how to do a bubble sort with NSIS. Your comment that I don't even need to write to a file before sorting surprises me (pleasntly). ;)<br />
      <br />
      I would greatly appreciate any insight you could provide to me in implementing bubblesort.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">brainsucker</span><br />
      <span class="post-time small text-muted">19th September 2003 19:40 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">if you don't mind adding 9kb to your installer that will do the thing (you'll need math plugin).</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">brainsucker</span><br />
      <span class="post-time small text-muted">19th September 2003 20:07 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Sorry: second math call need no /NOUNLOAD. Updated script attached.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">psyke</span><br />
      <span class="post-time small text-muted">19th September 2003 20:38 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><b>thank you brainsucker!</b><br />
      <br />
      amazing, simply amazing work...<br />
      <br />
      it's great to be able to do this from 'inside' nsis, with your math plugin of course. :D<br />
      <br />
      now i just need to sit down and carefully look at all the math examples and documentation to see how this gem actually does it's magic. :)</p>
    </div>
    <hr />

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]>
  </script>
</body>
</html>
