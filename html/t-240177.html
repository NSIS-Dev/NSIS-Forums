<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="description" content="Know which app was fired?"><title>Know which app was fired? - NSIS Forums</title><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script><link rel="preload" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css" as="style" onload="this.rel='stylesheet'"><link rel="preload" href="../css/style.css" as="style" onload="this.rel='stylesheet'"><noscript><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css"><link rel="stylesheet" href="../css/style.css"></noscript><script>!function(a){"use strict";var b=function(b,c,d){function e(a){return h.body?a():void setTimeout(function(){e(a)})}function f(){i.addEventListener&&i.removeEventListener("load",f),i.media=d||"all"}var g,h=a.document,i=h.createElement("link");if(c)g=c;else{var j=(h.body||h.getElementsByTagName("head")[0]).childNodes;g=j[j.length-1]}var k=h.styleSheets;i.rel="stylesheet",i.href=b,i.media="only x",e(function(){g.parentNode.insertBefore(i,c?g:g.nextSibling)});var l=function(a){for(var b=i.href,c=k.length;c--;)if(k[c].href===b)return a();setTimeout(function(){l(a)})};return i.addEventListener&&i.addEventListener("load",f),i.onloadcssdefined=l,l(f),i};"undefined"!=typeof exports?exports.loadCSS=b:a.loadCSS=b}("undefined"!=typeof global?global:this);!function(a){if(a.loadCSS){var b=loadCSS.relpreload={};if(b.support=function(){try{return a.document.createElement("link").relList.supports("preload")}catch(b){return!1}},b.poly=function(){for(var b=a.document.getElementsByTagName("link"),c=0;c<b.length;c++){var d=b[c];"preload"===d.rel&&"style"===d.getAttribute("as")&&(a.loadCSS(d.href,d,d.getAttribute("media")),d.rel=null)}},!b.support()){b.poly();var c=a.setInterval(b.poly,300);a.addEventListener&&a.addEventListener("load",function(){b.poly(),a.clearInterval(c)}),a.attachEvent&&a.attachEvent("onload",function(){a.clearInterval(c)})}}}(this);</script></head><body><div class="container"><ol class="breadcrumb"><li><a href="../index.html" class="glyphicon glyphicon-home"></a></li><li><a href="f-65.html">NSIS Discussion</a></li><li class="active">Know which app was fired?</li></ol><p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=240177">Know which app was fired?</a></p><br><div class="post"><p class="post-meta"><span class="post-author text-primary">ehrens</span><br><span class="post-time small text-muted">7th March 2006 14:48 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>Know which app was fired?</strong><br>I'm posting this because I received a good response to my previous post and really have no idea where to post this or how to phrase it. I have the installer working beautifully and it makes my file associations in the registry. So, here's my question...<br><br>if I have two files...say, like emails...and one is stuff.abc and the other is things.abc... I click on one. The association launches my ABCReader. Now, how do I know which file was clicked on so that my Reader can bring that file up in the viewer?<br><br>Thanks for any help either on the question or insight as to where I should ask this question.<br><br>Aaron</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">kichik</span><br><span class="post-time small text-muted">7th March 2006 14:51 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Usually, when you associate file types, you set the command line to be something like "C:\myprog\prog.exe %1". That %1 is replaced with the path to the opened file. The command line can be read in your program using <a href="http://msdn.microsoft.com/library/en-us/dllproc/base/getcommandline.asp?frame=true" target="_blank">GetCommandLine</a> or argc and argv in main if it's a command line program.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">ehrens</span><br><span class="post-time small text-muted">7th March 2006 15:49 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Thanks! Do you have to do anything to specify the path then of the file that is being opened or does the OS handle that for you and just put it in there for the %1?</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">kichik</span><br><span class="post-time small text-muted">7th March 2006 15:53 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">The shell automatically replaces %1 with the file. You just need to call GetCommandLine and parse the result.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">ehrens</span><br><span class="post-time small text-muted">7th March 2006 16:58 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">getCommandLine... Is this a Java call? If so, do you know what library I would need? I can't seem to find it in the basic jdk stuff.<br><br>Also, I have two ways that I need to support things... 1 is by launching an .exe with the file and 2 would be to launch a batch script. In the batch script, how would I snag the value of the %1 without using the getCommandLine (or have I gone off the deep end?)</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">kichik</span><br><span class="post-time small text-muted">7th March 2006 17:10 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">It's a Windows API. I've added a link to it in the first reply. In Java, the arguments passed on the command line are passed as parameters to your 'main' function.<br><br>In a batch file, use %1 to get the first command line parameter, %2 to get the second, etc.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">ehrens</span><br><span class="post-time small text-muted">8th March 2006 19:00 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Very cool.... I have it passing in the filename and now have 1 last question... It's running the exe local to the directory of the file that I doubleclicked (so, if on the desktop, app is launched from Docs and Settings but if in c:\app\export, then the app is launched relative to that dir). Is there a way to specify, regardless of where the app was launched, where it should be run relative to the directory structure that was installed (ie, always run relative to the app\bin directory that installed)?</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">kichik</span><br><span class="post-time small text-muted">8th March 2006 19:10 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">No that I know. You'll have to handle that in your application.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">ehrens</span><br><span class="post-time small text-muted">8th March 2006 19:15 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Thanks so much for the help and for the quick responses... Last question for a while.... if I click on 3 files, it opens 3 instances of my app. Is there a way to only open 1 instance and pass in all 3 filenames?</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">kichik</span><br><span class="post-time small text-muted">8th March 2006 19:18 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">There's probably some value you can write in the association registry key that'd do that. MSDN or an existing example could help there. If not, you can always have your application check if it's already running.</p></div><hr><div class="footer"><p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p></div></div><script src="../js/highlight.pack.js" type="text/javascript"></script><script type="text/javascript">//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]></script></body></html>