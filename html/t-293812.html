<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="description" content="Universal Extractor extract the nsi file"><title>Universal Extractor extract the nsi file - NSIS Forums</title><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script><link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css"><link rel="stylesheet" href="../css/style.css" type="text/css"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="description" content=" Universal Extractor extract the nsi file"><title>Universal Extractor extract the nsi file - NSIS Forums</title><link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css"><link rel="stylesheet" href="../css/style.css" type="text/css"></head><body><div class="container"><ol class="breadcrumb"><li><a href="../index.html" class="glyphicon glyphicon-home"></a></li><li><a href="f-65.html">NSIS Discussion</a></li><li class="active">Universal Extractor extract the nsi file</li></ol><p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=293812">Universal Extractor extract the nsi file</a></p><br><div class="post"><p class="post-meta"><span class="post-author text-primary">arfgh</span><br><span class="post-time small text-muted">30th June 2008 14:12 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>Universal Extractor extract the nsi file</strong><br>Recently i saw that the Universal Extractor is able to extract the files from the installer compiled by makensis.<br>The files and the nsi script source !!!<br><br>How can we prevent that and protect our works ?<br><br>thx</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Joel</span><br><span class="post-time small text-muted">30th June 2008 14:15 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">The only way, that I know, that can extract the scripts is if the developer include the script. About the files, well...I think you can use external apps like armadillo to protect it, but I don't know. NSIS is a self-extractor, maybe changing the compressor?</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Anders</span><br><span class="post-time small text-muted">30th June 2008 14:22 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><a href="http://forums.winamp.com/showthread.php?s=&amp;postid=2361124" target="_blank">http://forums.winamp.com/showthread....postid=2361124</a></p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">arfgh</span><br><span class="post-time small text-muted">30th June 2008 14:37 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">but the thing i cant understand is that exposes the nsi file source we created to make the installer. This is not good :(<br>The files into the installer are protected because i use other comrpessor.<br><br>But how can we protect the nsi source to not be extracted ?<br>Must exist some way.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Sheik</span><br><span class="post-time small text-muted">30th June 2008 15:44 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">I think you are mistaken about the nsi source.<br><br>Like Joel said, unless you are packaging the nsi source file into your Installer, there is no way they can see<br>your nsi source file.<br>That nsi source file is compiled into a whole different command structure, and unless the person built an decompiler for NSIS, they wouldn't be able to make heads or tails out of whats there.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Anders</span><br><span class="post-time small text-muted">30th June 2008 16:20 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">7z had a decompiler, its output is not pretty tho</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">MSG</span><br><span class="post-time small text-muted">30th June 2008 16:56 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">I just tried it, indeed UE decompiles the script using 7zip. My script came out with several "Invalid" lines, so it looks like it's not good enough to make it recompilable. As long as you don't do any secret stuff in plaintext nsis code, there isn't much of a risk in this.<br><br>Though I do agree that it would be really nice if NSIS installers could be made more solid. Would it be possible, say, to make the compression algorithms randomize their behaviour?</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Sheik</span><br><span class="post-time small text-muted">30th June 2008 17:13 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Ah, that makes sense, and definitely is interesting.<br><br>I suppose if you had any real "secret sauce" you wanted hidden, you could make a plugin to do it.<br>Obviously the "hacker" could get your plugin .dll, and attempt to decompile that as well, but at some point, if you are that worried about things, you probably should consider moving to an Installer that isn't free, and has encryption at its cornerstone.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">{_trueparuex^}</span><br><span class="post-time small text-muted">30th June 2008 17:35 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Universal Extractor is most likely using 7-zip v4.40 beta which can "extract" the script too.<br><br>PaR</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">arfgh</span><br><span class="post-time small text-muted">30th June 2008 20:24 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">maybe is not the same nsi that the one i created, but !!!<br><br>imagine you have lines on your nsi source where some passwords are used to extract or things like that. The passwords are revealed !!<br><br>But can someone explain me how the hell the nsi is recovered by teh extraction ? Someone told on this topic about we are packing the nsi source with the installer. I not made that, at least as far as i know.<br><br>please help !</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Red Wine</span><br><span class="post-time small text-muted">30th June 2008 20:34 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">If I'm not wrong, it's been already discussed, you may add a kind of security level on your installer by implementing a decryption/encryption method, e.g.<br><br><a href="http://nsis.sourceforge.net/DcryptDll_plug-in" target="_blank">http://nsis.sourceforge.net/DcryptDll_plug-in</a></p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Sheik</span><br><span class="post-time small text-muted">30th June 2008 20:51 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Or, if you don't want to go the DcryptDll route, create a plugin that contains your passwords.<br>Of course, you should use some sort of random thing in there, since anyone could run "strings" against said dll, and get the password strings.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">arfgh</span><br><span class="post-time small text-muted">30th June 2008 21:24 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">sorry but i see this problem as so serious.<br>In my dictionary the use of a free tool not mean i could want to show or allow to extract the whole of my work.<br><br>This is not serious. Now i suggest and request some countermeasure about this problem on future nsis releases. And i dont think i am the only onw who probably could request this, or yes ?</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Red Wine</span><br><span class="post-time small text-muted">30th June 2008 21:32 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Free or not free tool, there's nothing really uncrackable, if you believe so go ask M$, sony, etc etc etc.<br>Anyway, this is a long conversation which has been done in the near past, you may want to search the forum about.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">arfgh</span><br><span class="post-time small text-muted">30th June 2008 22:50 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">ths not change the fact this is not serious.<br><br>The passwords i use with my compressor are exposed extracting the files. Then what i an do related to that ? nothing :(<br><br>as i said, this is not serious :(</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Red Wine</span><br><span class="post-time small text-muted">30th June 2008 23:00 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">As I said earlier, you may cover your code with encryption which is especially offered within nsis. Moreover you may write your own plugin to suit your needs or even better modify the source code the way you like it. What else you expect from an open source free program? I'm wondering what is serious and what's not indeed.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">arfgh</span><br><span class="post-time small text-muted">30th June 2008 23:17 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">the encription make the files cant be compressed :P</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">LoRd_MuldeR</span><br><span class="post-time small text-muted">30th June 2008 23:29 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>Re: Universal Extractor extract the nsi file</strong><br></p><blockquote><i>Originally posted by arfgh</i><br><b>Recently i saw that the Universal Extractor is able to extract the files from the installer compiled by makensis.<br>The files and the nsi script source !!!<br><br>How can we prevent that and protect our works ?<br><br>thx</b></blockquote>NSIS is an OpenSource project. It lives from people contributing to the community, sharing their scripts. What in the world is so bad about people "extracting" your installer? If someone has got your installer, he/she will get the files anyway by running the installer. Also: One the one hand you want use NSIS for free, on the other hand you want to keep your script in private. I call that egoistic...<br><br>:down:</div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Red Wine</span><br><span class="post-time small text-muted">30th June 2008 23:34 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"></p><blockquote><i>Originally posted by arfgh</i><br><b>the encription make the files cant be compressed :P</b></blockquote>I bet you haven't even test it though.<br>Anyways, this conversation does not lead somewhere. Perhaps nsis does not cover your needs, thus probably you should go for a more sophisticated installer. Whenever you find it let me know please.</div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">LoRd_MuldeR</span><br><span class="post-time small text-muted">30th June 2008 23:49 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Encrypting the files *before* encoding will hurt the compression indeed. That is because compressing files always means <i>entropy coding</i>. After the files have been encrypted, they will "look" and behave like random data (unless you decrypt them with a proper key). I believe this will prevent efficient entropy coding (compression). So if you really want to encrypt the files, you should compress them first and then do the encryption. This of course will prevent <i>solid</i> compression, except you encrypt your files as one solid block of data...</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">thek</span><br><span class="post-time small text-muted">1st July 2008 12:12 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Hi<br><br>I to checked this tool and it generetes your NSIS script!<br><br>Its not a problem for my application<br>but I'm intressted on why it is able to genereate the sourcecode of the nsis script!<br>Is this tool able to do an "uncompile"?<br>or is the script somehow stored inside the installer?<br><br>Somebody knows details?</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Red Wine</span><br><span class="post-time small text-muted">1st July 2008 12:33 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">The endless circle...<br>Either you haven't read the whole thread, or...</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">LoRd_MuldeR</span><br><span class="post-time small text-muted">1st July 2008 12:48 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">I just gave this "Universal Extractor" a try. Indeed it uses 7-Zip to extract the NSIS installer. And indeed it gets some files out of the installer. However some folder names are incorrect, like "$[31]". Furthermore they obviously use a <i><font color="crimson"><b>disassembler</b></font></i> to create that "[NSIS].nsi" file. If you look at this file you will notice that this is <b>NOT</b> your original script. It's a very poor disassembly! Of course almost everything is lost, like function names, variable names and all the macros. So the resulting script is totally useless. And where have all the strings gone? The disassembly event won't compile! Instead of looking at this disassembly you could simply run the installer and look at a memory dump. The information you get are the same...<br><br>Original installer code:<br><a href="http://pastebin.org/47545" target="_blank">http://pastebin.org/47545</a><br><br>Disassembly created by 7-Zip:<br><a href="http://pastebin.org/47543" target="_blank">http://pastebin.org/47543</a><br><br>:igor:</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">pospec</span><br><span class="post-time small text-muted">1st July 2008 12:57 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">How did they get the NSIS code?</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Red Wine</span><br><span class="post-time small text-muted">1st July 2008 13:02 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">It's been discussed, what else should I say?<br>This thread contains nothing new, a simple forum search is enough instead.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">LoRd_MuldeR</span><br><span class="post-time small text-muted">1st July 2008 13:03 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"></p><blockquote><i>Originally posted by pospec</i><br><b>How did they get the NSIS code?</b></blockquote>Don't you read my post? :confused:</div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">pospec</span><br><span class="post-time small text-muted">1st July 2008 13:08 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">RedWine: I have searched the forum. Unfortunately, I can't find a right search phrase to get other discussion on this topic. As you know, English is not my native language.<br><br>LoRd_MuldeR: I have red your post two times and it reads about SOME disassembly, but HOW did they made it? (I don't understand this things well.)<br><br>Sorry for disturbing.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Red Wine</span><br><span class="post-time small text-muted">1st July 2008 13:12 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">English is not my native language either ;)<br><br><a href="http://forums.winamp.com/showthread.php?s=&amp;threadid=245098" target="_blank">http://forums.winamp.com/showthread....hreadid=245098</a><br><br><a href="http://forums.winamp.com/showthread.php?s=&amp;threadid=245397" target="_blank">http://forums.winamp.com/showthread....hreadid=245397</a></p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">pospec</span><br><span class="post-time small text-muted">1st July 2008 13:15 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">I know that it isn't. Thanks. I didn't searched for 7-zip :(</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">LoRd_MuldeR</span><br><span class="post-time small text-muted">1st July 2008 13:29 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"></p><blockquote><i>Originally posted by pospec</i><br><b>LoRd_MuldeR: I have red your post two times and it reads about SOME disassembly, but HOW did they made it? (I don't understand this things well.)</b></blockquote>How did they make it? I guess they implemented it! If you can <i>compile</i> a program, then you can <i>disassemble</i> it as well. Simply translate every binary instruction back to the corresponding textual representation. Since NSIS is OpenSource this shouldn't be too hard to implement. Of course some information cannot be restored, like variable/function names and macros. That's because those information simply are NOT present in the compiled binary. Also all comments and all the code formatting is lost for obvious reasons. That's why the disassembly is more or less useless. You end up with a load of code that looks like a mess. And in this case it even won't compile...</div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">pospec</span><br><span class="post-time small text-muted">1st July 2008 13:33 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Thanks. Only thing I was afraid was strings (which are in disassembly). I'll study threads that Red Wine posted.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">LoRd_MuldeR</span><br><span class="post-time small text-muted">1st July 2008 14:07 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"></p><blockquote><i>Originally posted by pospec</i><br><b>Thanks. Only thing I was afraid was strings (which are in disassembly). I'll study threads that Red Wine posted.</b></blockquote>You cannot protect strings! If your installer "knows" (uses) the string, then it <i>must</i> be stored somewhere in the EXE file. Of course you could try to encrypt the string and decrypt it at only at runtime. But even if you mange to keep your key a secret (the key must be stored somewhere in the EXE file too), still the string would be in memory at runtime. So somebody could do a memory dump and obtain your string. Guess why those new "unbreakable" Copy Protection systems like AACS (Blue Ray Disc) have been broken that fast! They didn't crack the protection itself, they simply grabbed the "secret" keys from memory while playing the disc in a legitimate player. This cannot be prevented without special hardware mechanisms (like a TPM), it can only be made more difficult by using techniques of "obfuscation" ...<br><br>BTW: Modifying the NSIS source codes and "randomizing" some of it's data structures would be one method of obfuscation. But that is NO real security! It's called "Security through Obscurity", which basically means there is no security at all!<br><br><a href="http://en.wikipedia.org/wiki/Security_through_obscurity" target="_blank">http://en.wikipedia.org/wiki/Security_through_obscurity</a></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">arfgh</span><br><span class="post-time small text-muted">1st July 2008 15:07 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">is all the same.<br><br>As i told previously, the nsis is not the same, but all the commands as the calls to my internal compressor with passwords, are exposed. And sorry but an opensource tool not mean we must share the scrips because yes and yes.<br><br>As i said this is not serious, because include a monkey is able to extract the passwords or all the needed from the extracted nsis script.<br><br>Really pathetic</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">LoRd_MuldeR</span><br><span class="post-time small text-muted">1st July 2008 15:14 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">And again: No software in the world will be able to protect your passwords! That's because the installer must be delivered to the user <i>and</i> the passwords must be stored in the installer somehow (otherwise the installer couldn't work). You could try to encrypt your passwords, but then you would have to store the decryption key in the installer as well (besides the problem that the passwords could be grabbed from a memory dumb anyway). So there simply is NO secure way to do that. Obfuscation can make it harder to "extract" your passwords and it might cause some disassemblers to fail. But it's no reliable protection. If somebody wants, he/she can circumvent your password protection easily...</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">arfgh</span><br><span class="post-time small text-muted">1st July 2008 15:29 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">one thing is the security and other so different is allow a script extraction. Sorry but all of you not has reasson on this.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">LoRd_MuldeR</span><br><span class="post-time small text-muted">1st July 2008 15:33 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"></p><blockquote><i>Originally posted by arfgh</i><br><b>one thing is the security and other so different is allow a script extraction. Sorry but all of you not has reasson on this.</b></blockquote>Nope, there is <i>no</i> difference between "script extraction" (disassembly) and "security". I have explained that enough now, so I won't explain again. Simply read previous posts in this thread any maybe the referenced threads...</div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">arfgh</span><br><span class="post-time small text-muted">1st July 2008 15:49 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">is clear for me.<br><br>Is nsis who allow this extraction. And YES is kinda different the security and this script extraction.<br><br>Maybe we must check if the winamp setup allow this extraction ?</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">LoRd_MuldeR</span><br><span class="post-time small text-muted">1st July 2008 15:57 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Last time now: If you want to make a "working" installer - an installer that the user can execute - this installer MUST contain valid program code! Otherwise it couldn't be executed and it would be useless to the user. And if your installer contains valid program code, it can be disassembled! Or in your words: The script can be extracted (although "extracting" is not the proper word). That's a fact you cannot change. Also it's not a NSIS problem. It's a general problem that applies to ALL programs/executables, including ALL installers. Unless you understand this fact, the entire discussion in this thread is useless...</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">arfgh</span><br><span class="post-time small text-muted">1st July 2008 16:12 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">you can argue a lot of times but the fact not go to change.<br><br>YES IT IS A PROBLEM CAUSED BY NSIS. Because we dont want to allow the script extraction !</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Sheik</span><br><span class="post-time small text-muted">1st July 2008 16:16 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Not to keep feeding the troll here, but I wonder if we could randomize the command values per script build...<br><br>As long as both the build side, and the exehead side agree on what the values for each command is, there is no real reason why we can't randomize each command value...<br>This would make the decompiler at least have to work a lot harder on figuring out what each command is.<br><br>Specifically, what if we were to allow "per script build" randomization of "exehead\fileform.h" of the enum of NSIS commands?<br><br>Obviously, for debugging of the resulting exe would be a nightmare, but then again, isn't that the point?</p></div><hr><div class="container"><ol class="breadcrumb"><li><a href="../index.html" class="glyphicon glyphicon-home"></a></li><li><a href="f-65.html">NSIS Discussion</a></li><li class="active">Universal Extractor extract the nsi file</li></ol><p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=293812">Universal Extractor extract the nsi file</a></p><br><div class="post"><p class="post-meta"><span class="post-author text-primary">LoRd_MuldeR</span><br><span class="post-time small text-muted">1st July 2008 16:27 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"></p><blockquote><i>Originally posted by arfgh</i><br><b>YES IT IS A PROBLEM CAUSED BY NSIS. Because we dont want to allow the script extraction !</b></blockquote>You can call it "extraction" over and over again. But it's still a <i>disassembly</i>. The script is NOT extracted, because it's NOT in the installer file! The disassembler "restores" the script from the binary program code. Look at the file, it's totally different from the original script. Of course it is! Disassembly is a whole different thing than "extraction" and it's NOT a problem of NSIS. Once and for all :rolleyes:<br><br><blockquote><i>Originally posted by Sheik</i><br><b>As long as both the build side, and the exehead side agree on what the values for each command is, there is no real reason why we can't randomize each command value...<br>This would make the decompiler at least have to work a lot harder on figuring out what each command is.</b></blockquote>Yes, this should be possible. But as said before: this would be "Security through Obscurity". And one of the first things you learn when you get in touch with Security in Software Development is that "Security through Obscurity" is a really bad idea. So you always have to assume that the Attacker has full knowledge about how your protection works. Nevertheless I agree that some obfuscation might help to prevent Scriptkiddies from "extracting" (see the Quotation marks) your installer too easy. But don't make the mistake and think this is a "safe" protection...<br><br><font color="crimson">Last but not least I think an OpenSource project like NSIS should stand for TRANSPARENCY instead of OBFUSCATION. There already are enough companies that bother the users and developers with their obfuscations attempts...</font></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">arfgh</span><br><span class="post-time small text-muted">1st July 2008 16:52 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">LoRd_MuldeR<br><br>if i use a command as for example...<br><br>unuharc.exe e -pblahblah -y+ -t"$INSTDIR\blah" blah.uha<br><br>this exact command will be present on the extractes nsi script. This mean secury is 0 ! Because in my dictionary the action it performed the unversal extractor was not a dissasemble !<br><br>Then, by this way is NSIS who allow this extraction.<br>I do now a vey hard request to the nsis team to put security to not allow that, and just to be at least a be serious.<br><br>thx</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">LoRd_MuldeR</span><br><span class="post-time small text-muted">1st July 2008 16:56 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">I wish you good luck with your request to fix a "problem", which you apparently do not understand and which is impossible to fix (because it's not a problem, but a fact)<br><br>:D</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Sheik</span><br><span class="post-time small text-muted">1st July 2008 16:56 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"></p><blockquote><i>Originally posted by arfgh</i><br><b>LoRd_MuldeR<br><br>if i use a command as for example...<br><br>unuharc.exe e -pblahblah -y+ -t"$INSTDIR\blah" blah.uha<br><br>this exact command will be present on the extractes nsi script. This mean secury is 0 ! Because in my dictionary the action it performed the unversal extractor was not a dissasemble !<br><br>Then, by this way is NSIS who allow this extraction.<br>I do now a vey hard request to the nsis team to put security to not allow that, and just to be at least a be serious.<br><br>thx</b></blockquote>We could see that with any installer. Just watch the Installer "exec" off any processes. The command line to your "unuharc.exe" you see will be the exact same as you would see in NSIS.</div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Red Wine</span><br><span class="post-time small text-muted">1st July 2008 17:28 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">For anyone who's interesting about the forum rules:<br><br></p><blockquote><b>Post Pumping</b><br>- If a post is suspected to serve no other purpose than to increase the post count of the poster, then the moderators may, at their discretion, issue a PM to the member in question enquiring about the nature of the post. Posts/Threads that are blatantly post pumping will be removed/locked without recourse to the poster.</blockquote></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">arfgh</span><br><span class="post-time small text-muted">1st July 2008 17:34 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Sheik<br><br>yes, we can see the strings using a dissasembler. But this is not the fact. The fact is the universal instalelr is not a dissasembler.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">LoRd_MuldeR</span><br><span class="post-time small text-muted">1st July 2008 18:29 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"></p><blockquote><i>Originally posted by arfgh</i><br><b>Sheik<br><br>yes, we can see the strings using a dissasembler. But this is not the fact. The fact is the universal instalelr is not a dissasembler.</b></blockquote>Yes, it is a DISASSEMBLER. In some way ;)<br><br>Of course the primary purpose of Universal Extractor is <i>extracting</i> files from archives. Yes. But it uses 7-Zip to extract the files from a NSIS installer. 7-Zip also is NOT a disassembler. Yes. Nevertheless it is obviously using DISASSEMBLER techniques to create that "[NSIS].nsi" file. That file cannot be "extracted" from the installer (like all the other files), because there is no such file in the installer! It's not there! However the script file can be "restored" from the installer code easily, because the installer code MUST be in the installer (otherwise the installer couldn't run). The process of restoring textual "Assembler Code" from binary "Machine Code" is called DISASSEMBLING. And that's exactly what's happening here. If you like to hear that or not. It's so obvious that there is no doubt. Just look at "[NSIS].nsi". It's NOT your original script, it's a DISASSEMBLY of your installer code.<br><br><br>@Red Wine: This post is not to pump my post count. I don't care about post count. I just want to explain that issue. thanks...</div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">arfgh</span><br><span class="post-time small text-muted">1st July 2008 18:46 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">i dont cares too about post count.<br><br>ok LoRd_MuldeR, then what is our solution to prevent that ?<br>Can we do somethig about ?<br><br>thx</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Red Wine</span><br><span class="post-time small text-muted">1st July 2008 18:57 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"></p><blockquote><i>Originally posted by LoRd_MuldeR</i><br><b>@Red Wine: This post is not to pump my post count. I don't care about post count. I just want to explain that issue. thanks...</b></blockquote>Sure, but all of you guys just repeating the same things over and over again. There's nothing new just an endless repeat. This is at least tedious, what else could I say? The subject has been already discussed as I said ages ago when this annoying thread started.</div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">arfgh</span><br><span class="post-time small text-muted">1st July 2008 19:13 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Red Wine<br><br>the things are not fully discussed.<br>Because the last i must to say is about an old version of nsis where the nsi script is not extracted by the universal extractor. I think it was the 2.03 version.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Red Wine</span><br><span class="post-time small text-muted">1st July 2008 19:25 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"></p><blockquote><i>Originally posted by arfgh</i><br><b>Red Wine<br><br>the things are not fully discussed.<br>Because the last i must to say is about an old version of nsis where the nsi script is not extracted by the universal extractor. I think it was the 2.03 version.</b></blockquote>Well, you think wrong or you haven't read at all the discussion. Could you tell one single news regarding to the subject which has been added through this endless annoying conversation?<br>Anyways, I wouldn't follow further the annoyance, as I said DOES NOT offer anything more than setting the focus on it.</div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">arfgh</span><br><span class="post-time small text-muted">1st July 2008 19:40 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">the discussion is to try to fix this bad fact on the ACTUAL nsis, as suggest or request. But you dont want we talk more about this ? Just tell it clear if is that.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">LoRd_MuldeR</span><br><span class="post-time small text-muted">1st July 2008 19:51 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"></p><blockquote><i>Originally posted by arfgh</i><br><b>the discussion is to try to fix this bad fact on the ACTUAL nsis, as suggest or request. But you dont want we talk more about this ? Just tell it clear if is that.</b></blockquote>You are wrong. This discussion will not lead to a "fix", as there is <i>nothing</i> to fix. I won't argue over this, because all has been said in this thread. So please re-read my previous posts as well as Sheik's posts and try to understand. Further discussion is useless until you understand the crux. Thank you!<br><br><font size="1">BTW: If 7-Zip doesn't disassemble NSIS v2.03 installers, this does <b>not</b> mean v2.03 is any safer! It just means the disassembler isn't compatible to v2.03 yet. Maybe the developer created the disassembler with up-to-date NSIS and didn't care about "outdated" versions. Nevertheless it will be easy to adjust the existing disassembler for older versions, if anybody wants that. So nope, using the older NSIS version won't give you more protection. No version ever will or ever did...</font></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">arfgh</span><br><span class="post-time small text-muted">1st July 2008 19:53 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">you tell not give more protection but the fact is the fact, On this version teh nsi script cant be extracted.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Red Wine</span><br><span class="post-time small text-muted">1st July 2008 19:58 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"></p><blockquote><i>Originally posted by arfgh</i><br><b>the discussion is to try to fix this bad fact on the ACTUAL nsis, as suggest or request. But you dont want we talk more about this ? Just tell it clear if is that.</b></blockquote>PLEASE! Don't be silly, after all the forum isn't a playground ;)<br>Simply, just as simple as it gets, after 50+ posts, show me ONE single thing that this discussion adds, fixes, or whatever it does.</div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">{_trueparuex^}</span><br><span class="post-time small text-muted">1st July 2008 23:12 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">I didn't understand the fuzz about this issue when 7-zip 4.40 was released and I don't understand it now.<br><br>Storing passwords as plain text in NSIS code has never been safe and never will be. Simply because you can get the strings from the memory at the run time (see the attachment). And no obfuscation can prevent this.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">LoRd_MuldeR</span><br><span class="post-time small text-muted">1st July 2008 23:15 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"></p><blockquote><i>Originally posted by {_trueparuex^}</i><br><b>I didn't understand the fuzz about this issue when 7-zip 4.40 was released and I don't understand it now.<br><br>Storing passwords as plain text in NSIS code has never been safe and never will be. Simply because you can get the strings from the memory at the run time (see the attachment). And no obfuscation can prevent this.</b></blockquote>That's what I try to explain since this discussion has started :D</div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">pospec</span><br><span class="post-time small text-muted">2nd July 2008 07:53 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"></p><blockquote><i>Originally posted by LoRd_MuldeR</i><br><b>You cannot protect strings!</b></blockquote>I am NOT stupid and I KNOW why are all strings in "disassembled" script. Thank you very much.</div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">thek</span><br><span class="post-time small text-muted">2nd July 2008 11:42 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">A solution for your problem would be to generate the password from a user entry, or get the passwords for your secret files via the internet.<br><br>So the passwords are not stored in the installer.<br>This would be quite secure (depending on security of the internet connection, trustworthy of the enduser and so on) because in the Installer is nowhere a direct string<br><br>or you store the passwords in a text file (ini format or similar) which is send along but encrpyted (again with a userentry to decrypt it)<br><br><br>But this would be only workarounds of the problem.<br>I'm not an NSIS-profi but it is a tool for installing software, not for cryptograhpic purposes :-)</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">arfgh</span><br><span class="post-time small text-muted">2nd July 2008 14:05 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">of course if we use the "DcryptDll" the key is also exposed, true ? I mean when extract the files with universal installer.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">thek</span><br><span class="post-time small text-muted">2nd July 2008 18:02 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">No because you have to supply the key via an userinput and not hardcoded in the script...<br><br>if you put the key in the script you have lost, there is no way to "secure" it there. (only obscuring is possible)</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">arfgh</span><br><span class="post-time small text-muted">2nd July 2008 20:14 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">and how can we work with that "obscuring" in nsis ?</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">LoRd_MuldeR</span><br><span class="post-time small text-muted">2nd July 2008 20:19 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"></p><blockquote><i>Originally posted by arfgh</i><br><b>and how can we work with that "obscuring" in nsis ?</b></blockquote>Be creative! Don't save you password as a simple plain string! Cut your password into several strings, add random characters to those strings and so on. Do everything that might confuse a person who is looking at the disassembly of your installer. At runtime you can calculate the correct password from the strings you have stored in your installer. And don't keep the result in memory any longer than you need it. But be aware that this will keep nobody away from reconstructing your password. It only makes things a tiny bit less trivial...<br><br><br><b>Very very simple example:</b><br><br><pre>
<code>StrCpy $0 "M"<br>StrCpy $1 "O"<br>StrCpy $2 "W"<br>StrCpy $3 "R"<br>StrCpy $4 "S"<br>StrCpy $5 "Y"<br>StrCpy $6 "S"<br>StrCpy $7 "A"<br>StrCpy $8 "D"<br>StrCpy $9 "P"<br><br>MessageBox MB_OK "Super secret password: $0$5$9$7$6$4$2$1$3$8"<br><br>StrCpy $0 " "<br>StrCpy $1 " "<br>StrCpy $2 " "<br>StrCpy $3 " "<br>StrCpy $4 " "<br>StrCpy $5 " "<br>StrCpy $6 " "<br>StrCpy $7 " "<br>StrCpy $8 " "<br>StrCpy $9 " "</code>
</pre><br>
        <br>
        "Extract" that with Universal Extractor. You won't see the Password in plain text, but it's not too hard to guess the password :D
      </div>
      <hr>

      <div class="post">
        <p class="post-meta"><span class="post-author text-primary">arfgh</span><br>
        <span class="post-time small text-muted">2nd July 2008 23:52 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

        <p class="post-content">final conclusion. All this fact ruins the so good that the nsis is. At least for me !</p>
      </div>
      <hr>

      <div class="post">
        <p class="post-meta"><span class="post-author text-primary">LoRd_MuldeR</span><br>
        <span class="post-time small text-muted">3rd July 2008 00:00 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

        <p class="post-content">Then why not leave NSIS behind, stop bothering the people they try to help you and use some Installer that provides better protection (in your imagination). And better hope the 7-Zip developers won't implement "support" for other Installers :p</p>
      </div>
      <hr>

      <div class="footer">
        <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
      </div>
    </div><script src="../js/highlight.pack.js" type="text/javascript">
</script> <script type="text/javascript">
//<![CDATA[
    hljs.initHighlightingOnLoad();
    //]]></script></div></body></html>