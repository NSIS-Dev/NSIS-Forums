<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="How to close a running task (aka process)" />

  <title>How to close a running task (aka process) - NSIS Forums</title><!-- Bootstrap core CSS -->
  <link rel="stylesheet" type="text/css" href="//netdna.bootstrapcdn.com/bootswatch/3.0.2/readable/bootstrap.min.css" /><!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!--[if lt IE 9]>
                <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
                <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->
</head>

<body>
  <div class="container">
    <!-- Put navigation bar here -->

    <ol class="breadcrumb">
      <li><a href="../index.html" class="glyphicon glyphicon-home"></a></li>

      <li><a href="f-65.html">NSIS Discussion</a></li>

      <li class="active">How to close a running task (aka process)</li>
    </ol>

    <p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=122973">How to close a running task (aka process)</a></p><br />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">robdal</span><br />
      <span class="post-time small text-muted">27th January 2003 15:54 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>How to close a running task (aka process)</strong><br />
      &nbsp; I'd like to be able to close a running process (i.e: this might be my own app that I'm about to update).<br />
      <br />
      Is that possible with NSIS?<br />
      <br />
      bEST REGARDS<br />
      Roberto Dalmonte</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
      <span class="post-time small text-muted">27th January 2003 16:33 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">That really depends on the application you are trying to close. Some will close when you send their main window WM_CLOSE such as Winamp 1 and 2 for example:<br />
      <br /></p>
      <pre>
<code>
loop:
<br /> FindWindow $0 "Winamp v1.x"
<br /> IntCmp $0 0 startCopy
<br />  SendMessage$0 ${WM_CLOSE} 0 0
<br />  Sleep 100
<br />  Goto loop 
<br />&gt;
</code>
</pre>Services need a special API call (ControlService). You can use the NET command line utility for services.<br />
      <br />
      Other applications might be waiting for a file to close, or for them to finish their task.<br />
      <br />
      The first method usually works, but you'll still have to be a bit more specific to get an absolute answer. If it's your application then you should know best what makes it close. If it's a VB application or any other wizard programming language then the first method should work.
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">robdal</span><br />
      <span class="post-time small text-muted">27th January 2003 17:26 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Thanks, this is what I was looking for.<br />
      <br />
      Roberto</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">robdal</span><br />
      <span class="post-time small text-muted">28th January 2003 17:30 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">This is, I guess, the most simple example of closing a running window. The following script will terminate notepad.<br />
      <br />
      SilentInstall silent<br />
      OutFile "CloseNotepad.exe"<br />
      Section "MySection"<br />
      FindWindow $0 "Notepad"<br />
      SendMessage $0 16 0 0<br />
      SectionEnd</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">javajunki</span><br />
      <span class="post-time small text-muted">28th January 2003 17:36 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Hello, I'd like to end a process but it doesn't necessarily have a frame and could be running in the background.... I want to kill any running internet explorer processes so that I can install a browser dependant program. seems IE is running in the background in some cases, and I need to end these processes before I can register my dll or I get an error when upgrading the dll.<br />
      <br />
      Is this possible?<br />
      <br />
      Hope someone can help.:(<br />
      <br />
      thanks in advance :D</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
      <span class="post-time small text-muted">28th January 2003 17:40 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Please see: <a href="http://forums.winamp.com/showthread.php?s=&amp;threadid=122305&amp;highlight=close+ie" target="_blank">http://forums.winamp.com/showthread....light=close+ie</a></p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">robdal</span><br />
      <span class="post-time small text-muted">29th January 2003 19:01 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Sorry, I don't know how to accomplish that. I tried different things without success.<br />
      If I happen to succeed sooner or later I'll let you know<br />
      <a href="mailto:robdal@tiscali.it">robdal@tiscali.it</a></p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">virtlink</span><br />
      <span class="post-time small text-muted">30th January 2003 11:07 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">KiCHiK posts his email adress in separate parts, and you should do that too to avoid Spambot's to pick up your email adress and send you a mailbox full of spam.<br />
      Like this:<br />
      robdal at tiscali dot it</p>
    </div>
    <hr />

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]>
  </script>
</body>
</html>
