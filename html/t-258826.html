<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="Clearing fields" />

  <title>Clearing fields - NSIS Forums</title>
  <script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script>
  <!-- Bootstrap core CSS -->

  <link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css" />
  <link rel="stylesheet" href="../css/style.css" type="text/css" /><!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!--[if lt IE 9]>
                <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
                <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->
</head>

<body>
  <div class="container">
    <!-- Put navigation bar here -->

    <ol class="breadcrumb">
      <li><a href="../index.html" class="glyphicon glyphicon-home"></a></li>

      <li><a href="f-65.html">NSIS Discussion</a></li>

      <li class="active">Clearing fields</li>
    </ol>

    <p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=258826">Clearing fields</a></p><br />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">davidnewcomb</span><br />
      <span class="post-time small text-muted">3rd November 2006 11:19 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>Clearing fields</strong><br />
      Just spent the last week writing an installer with bells and whistles, and hit a problem. Scenario: I have several custom pages which I use to collect info. Some of the info is repeated and so the custom pages have to be repeated with cleared fields. There are various fields which are dynamically greyed out depending on what on the page is selected.<br />
      <br />
      I did start of with a "Page custom startFn leaveFn" which handles the NOTIFY to grey out the buttons. But found that there was no way to clear a text field. I did use MUI_INSTALLOPTIONS_WRITE but found that you really need to call MUI_INSTALLOPTIONS_DISPLAY to redraw the screen with the new changes.<br />
      <br />
      Then I looked at the mathtest.nsi to figure out how to repeatedly show the same screen, and found that it uses MUI_INSTALLOPTIONS_DISPLAY_RETURN to stay in the startFn and loop until it's ok. MUI_INSTALLOPTIONS_DISPLAY_RETURN only returns Success or Failed, so there is no way to tell if one of my custom buttons is being called.<br />
      <br />
      I'm a bit confused about how I can submit a page (maybe from a custom button), have it do something and then clear all the fields.<br />
      <br />
      Any help would be appreciated.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
      <span class="post-time small text-muted">3rd November 2006 12:11 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">The INI file is not reloaded when after the leave function returns. It's only rewritten before the leave function is called.<br />
      <br />
      To change fields, you should use the same method you've used to disable them. Only instead of using EnableWindow, you use SendMessage ${WM_SETTEXT}.<br />
      <br />
      Take a look at the custom page leave function in <a href="http://nsis.sourceforge.net/Examples/InstallOptions/testnotify.nsi" target="_blank">Examples\InstallOptions\testnotify.nsi</a>. It shows you how to do it.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">davidnewcomb</span><br />
      <span class="post-time small text-muted">3rd November 2006 13:56 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Thanks for the fast response.<br />
      <br />
      'wparam' seems to be what you want to set it to, but what is 'lparam' for?<br />
      <br />
      Is there some documentation for SendMessage which describes which types of dialog box, need what message in order to do what action/job?<br />
      There seems to be a lot of "SendMessage $0 $1 0x0123 0" (or whatever) entries which don't describe where 0x0123 came from.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
      <span class="post-time small text-muted">3rd November 2006 14:01 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">lParam is not used in the case of WM_SETTEXT and should be set to zero. WM_SETTEXT is a standard window message and is best described in <a href="http://msdn.microsoft.com/library/en-us/winui/winui/windowsuserinterface/windowing/windows/windowreference/windowmessages/wm_settext.asp?frame=true" target="_blank">MSDN</a>. MSDN contains reference to all available messages.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">davidnewcomb</span><br />
      <span class="post-time small text-muted">3rd November 2006 14:22 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Ok, one final thing on the same lines. The box I am trying to fill in is a multi-line readonly text box. I read a file which contains:<br />
      <br />
      1|1|1<br />
      2|2|2<br />
      <br />
      into $0 and give it to MUI_INSTALLOPTIONS_WRITE but it only displays the 1st line. So I have to read the file in and replace the \r\n with actual "\r\n". Presumerably because there is an INI file behind and it only accepts single line entries.<br />
      <br />
      However when I call SendMessage and give it the converted read-from-file string containing actual "\r\n" it prints these in the boxes.<br />
      <br />
      Are there any built in functions that can help here, or do I have to handle each case with my own functions.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
      <span class="post-time small text-muted">3rd November 2006 14:25 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">The <a href="http://nsis.sourceforge.net/Docs/InstallOptions/Readme.html" target="_blank">InstallOptions</a> readme contains Io2Nsis and Nsis2Io which do exactly that. <a href="http://nsis.sourceforge.net/Docs/AppendixE.html#E.3.8" target="_blank">WordReplace</a> can also help here.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">davidnewcomb</span><br />
      <span class="post-time small text-muted">3rd November 2006 15:28 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Excellent thanks for you help. Things are progressing nicely. Why aren't Io2Nsis and Nsis2Io included in the standard distribution?</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
      <span class="post-time small text-muted">3rd November 2006 15:31 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">They are. That readme is located in the Docs folder in your installation.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">davidnewcomb</span><br />
      <span class="post-time small text-muted">3rd November 2006 16:13 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">I mean in a nsh file. With all the other useful functions.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
      <span class="post-time small text-muted">3rd November 2006 16:20 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Because that change could be easily implemented using WordReplace in WordFunc.nsh.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">davidnewcomb</span><br />
      <span class="post-time small text-muted">3rd November 2006 16:28 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Ok. Thanks for you help on this one. Shalom!</p>
    </div>
    <hr />

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]>
  </script>
</body>
</html>
