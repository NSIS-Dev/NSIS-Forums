<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="Problem with LineFind and attributs" />

  <title>Problem with LineFind and attributs - NSIS Forums</title>
  <script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script>
  <!-- Bootstrap core CSS -->

  <link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css" />
  <link rel="stylesheet" href="../css/style.css" type="text/css" /><!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!--[if lt IE 9]>
                <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
                <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->
</head>

<body>
  <div class="container">
    <!-- Put navigation bar here -->

    <ol class="breadcrumb">
      <li><a href="../index.html" class="glyphicon glyphicon-home"></a></li>

      <li><a href="f-65.html">NSIS Discussion</a></li>

      <li class="active">Problem with LineFind and attributs</li>
    </ol>

    <p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=234618">Problem with LineFind and attributs</a></p><br />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">xilay</span><br />
      <span class="post-time small text-muted">3rd January 2006 13:10 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>Problem with LineFind and attributs</strong><br />
      Hello,<br />
      <br />
      I hope you'll understand my problem with my poor english...<br />
      <br />
      Well, I use ${LineFind} to replace some lines of a file.<br />
      All is ok.<br />
      But I can't write or even read the file when I'm not on the server where I used my setup.<br />
      To use the file, I must go on the server and change the safety (I'm not sure it's the good word in english) of the file (all rights for everybody).<br />
      <br />
      Of course, before use LineFind, I can read the file when I'm not on the server.<br />
      <br />
      I hope my explanations are enough clear.<br />
      <br />
      If you have an idea, thanks for your help.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
      <span class="post-time small text-muted">3rd January 2006 18:23 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">I don't know why, but it opens the file for writing and writes something to it. It also has code that copies over a file, but I'm not sure the it's the same file. Instructor will know best, he wrote the function.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Instructor</span><br />
      <span class="post-time small text-muted">3rd January 2006 22:15 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">As I understand you are trying to modify/read the text file that is located on the server? If you have access rights "only read" and use call like:<br /></p>
      <pre>
<code>${LineFind} "\\server\data\a.log" "" "1:-1" "LineFindCallback"</code>
</pre>then will be error because function trying to modify "\\server\data\a.log". Just use local disk for the output file (if you have full access :) ).
      <pre>
<code>${LineFind} "\\server\data\a.log" "C:\a.log" "1:-1" "LineFindCallback"</code>
</pre>If you want only read LineFind have option "/NUL".
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">xilay</span><br />
      <span class="post-time small text-muted">4th January 2006 13:21 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Ok, my english is really poor. :(<br />
      <br />
      I can modify the file with the setup.<br />
      When the installation is finished, if I want to read the modified file when I'm not on the server, I can't, attributs of the file are diff√©rent before and after the setup.<br />
      <br />
      Before the setup write the file, I have full access to the file, after, I can't read it...</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Instructor</span><br />
      <span class="post-time small text-muted">4th January 2006 20:33 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">LineFind creates a file with normal attributes in any way. I now trying to find the solution.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">deguix</span><br />
      <span class="post-time small text-muted">4th January 2006 20:52 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"></p>

      <blockquote>
        If you have access rights "only read" and use call like [the code shown on Instructor's post] then will be error because function trying to modify "\\server\data\a.log".
      </blockquote>I think you should use ${LineRead} if you just want to read a line of the file.<br />
      <br />
      My opinion is that a function called "LineFind" should only find if a line exists, and not even read it (there is the "LineRead" function for that), nor to write the line of the selection chosen (maybe a new function for this?). But still, either the function name is wrong or are its features. I would suggest the function name to be "LineSelect" because it is actually selecting which lines should be written to another file.
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Instructor</span><br />
      <span class="post-time small text-muted">4th January 2006 21:11 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">:) I long time thought about what name give to function and was choosing between several not exhaustive names. I like your variant "LineSelect" unfotunately it doesn't come to me when I thought.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">deguix</span><br />
      <span class="post-time small text-muted">4th January 2006 22:25 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"></p>

      <blockquote>
        I think you should use ${LineRead} if you just want to read a line of the file.
      </blockquote>My mistake. You really wanted to replace lines in the file. Maybe you could use the ${GetFileAttributes} to get the file attributes then set it back again with the SetFileAttributes NSIS instruction. It even outputs the result compatible with the attribute input parameter of the instruction.<br />
      <br />
      Now about making ${LineSelect} to have this functionality as well: I actually think you should either mention to use ${GetFileAttributes} w/ SetFileAttributes to put them inside the function.<br />
      <br />
      Maybe it would be even better to create other types of functions just to, for example, specificly replace a file, then you could make sure of the attributes of the file being replaced and calling this function from other functions and simplifying even more code. A drawback would be including every single function by hand or by creating a header file, and the amount of calls. That's what I simplified on UseFunc, but nobody actually wanted something to be improved on it, so I just about abandoned it (still sometimes working on it). I know my contrib is not the best, but some comment for improvement would suffice.
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Instructor</span><br />
      <span class="post-time small text-muted">4th January 2006 23:19 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"></p>

      <blockquote>
        Maybe you could use the ${GetFileAttributes} to get the file attributes then set it back again with the SetFileAttributes NSIS instruction.
      </blockquote>attribute1|attribute2|... of SetFileAttributes sets on compile-time.<br />

      <blockquote>
        Maybe it would be even better to create other types of functions just to, for example, specificly replace a file, then you could make sure of the attributes of the file being replaced and calling this function from other functions and simplifying even more code.
      </blockquote>I think it is better to write an example for user how to do some concrete things using basic functions rather than increase size of the installer by calling another function internally.

      <blockquote>
        .. but some comment for improvement would suffice.
      </blockquote>Why in usefunc.zip so many empty directories? :)
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">xilay</span><br />
      <span class="post-time small text-muted">5th January 2006 09:31 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">I don't think it's the best way, but this is my solution.<br />
      I use CopyFiles, in fact, I edit a temporary file and copy it with the good name.<br />
      I can't read the temporary file but I can do it with the copy...<br />
      <br />
      Don't know why:weird:<br />
      <br />
      Thanks for your helps</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">deguix</span><br />
      <span class="post-time small text-muted">5th January 2006 10:33 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"></p>

      <blockquote>
        attribute1|attribute2|... of SetFileAttributes sets on compile-time.
      </blockquote>^^ Idea for run-time function right there.<br />
      <br />

      <blockquote>
        Why in usefunc.zip so many empty directories?
      </blockquote>The zip file is designed to be extracted to NSIS dir.... Greaaat comment, thx ;).<br />
      <br />
      EDIT:<br />

      <blockquote>
        I think it is better to write an example for user how to do some concrete things using basic functions rather than increase size of the installer by calling another function internally.
      </blockquote>Not always. Macro is still better than giving examples because they do not add anything than just putting code right on except by compilation time. I would still recommend both the automatic method (function macro w/ calls done to other functions) and the manual method (function macro w/ all the code optimized).
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Instructor</span><br />
      <span class="post-time small text-muted">5th January 2006 21:13 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">I will experiment with the attributes and LineFind, and you can try this:<br />
      <a href="http://forums.winamp.com/showthread.php?s=&amp;threadid=234814" target="_blank">http://forums.winamp.com/showthread....hreadid=234814</a></p>
    </div>
    <hr />

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]>
  </script>
</body>
</html>
