<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="description" content="SQL error handling"><title>SQL error handling - NSIS Forums</title><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script><link rel="preload" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css" as="style" onload="this.rel='stylesheet'"><link rel="preload" href="../css/style.css" as="style" onload="this.rel='stylesheet'"><noscript><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css"><link rel="stylesheet" href="../css/style.css"></noscript><script>!function(a){"use strict";var b=function(b,c,d){function e(a){return h.body?a():void setTimeout(function(){e(a)})}function f(){i.addEventListener&&i.removeEventListener("load",f),i.media=d||"all"}var g,h=a.document,i=h.createElement("link");if(c)g=c;else{var j=(h.body||h.getElementsByTagName("head")[0]).childNodes;g=j[j.length-1]}var k=h.styleSheets;i.rel="stylesheet",i.href=b,i.media="only x",e(function(){g.parentNode.insertBefore(i,c?g:g.nextSibling)});var l=function(a){for(var b=i.href,c=k.length;c--;)if(k[c].href===b)return a();setTimeout(function(){l(a)})};return i.addEventListener&&i.addEventListener("load",f),i.onloadcssdefined=l,l(f),i};"undefined"!=typeof exports?exports.loadCSS=b:a.loadCSS=b}("undefined"!=typeof global?global:this);!function(a){if(a.loadCSS){var b=loadCSS.relpreload={};if(b.support=function(){try{return a.document.createElement("link").relList.supports("preload")}catch(b){return!1}},b.poly=function(){for(var b=a.document.getElementsByTagName("link"),c=0;c<b.length;c++){var d=b[c];"preload"===d.rel&&"style"===d.getAttribute("as")&&(a.loadCSS(d.href,d,d.getAttribute("media")),d.rel=null)}},!b.support()){b.poly();var c=a.setInterval(b.poly,300);a.addEventListener&&a.addEventListener("load",function(){b.poly(),a.clearInterval(c)}),a.attachEvent&&a.attachEvent("onload",function(){a.clearInterval(c)})}}}(this);</script></head><body><div class="container"><ol class="breadcrumb"><li><a href="../index.html" class="glyphicon glyphicon-home"></a></li><li><a href="f-65.html">NSIS Discussion</a></li><li class="active">SQL error handling</li></ol><p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=291684">SQL error handling</a></p><br><div class="post"><p class="post-meta"><span class="post-author text-primary">MHK</span><br><span class="post-time small text-muted">12th May 2008 09:06 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>SQL error handling</strong><br>hey all<br><br>Excecutes a SQL query<br>&lt;query&gt; - SQL query to execute<br><br>Returns<br><br>* "0" Success, "1" Failure<br>* A message string<br><br>this is in MSSQL_OLEDB_plug-in page<br>****************************************<br>the problem is:<br>some time i get errors like this<br><br>Output folder: C:\DOCUME~1\basharh\LOCALS~1\Temp\1\sqls<br>Extract: 01.sql<br>Extract: 02.sql<br><br>C:\DOCUME~1\basharh\LOCALS~1\Temp\1\sqls\01.sql<br>128<br><br>C:\DOCUME~1\basharh\LOCALS~1\Temp\1\sqls\02.sql<br>128<br>******************************************<br><br>"C:\DOCUME~1\MHK\LOCALS~1\Temp\osql.exe" -Sserver -FD4C06 -ddb1 -Usa -Ppazz -i "Temp\CreateDB\Functions.sql" -n<br>-1073741515<br><br>**********************************************<br><br>the 1st error (128) was at SQLserver2005 (64-bit)<br><br>the 2nd error (-1073741515)was in SQLserver2000 sp1<br><br>how we can know each error means? and i guess there is many errors like this! where to find them all?</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">sgiusto</span><br><span class="post-time small text-muted">12th May 2008 21:26 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Hello,<br>don't sure what you are missing...<br>The SQL Plugin pushes on the stack a couple of return values each time.<br>One value is for success/fail<br>the other value is for descriptive message. If you get 128 as descriptive message, that is what the sql server returns (and this is strange). Both error codes does not seem to have any meaning on SQL technical documentation. Can you provide some sql script code that shows this behaviour?<br><br>Regards<br>Stefano</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">MHK</span><br><span class="post-time small text-muted">13th May 2008 08:20 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">thanks for reply,<br><br>my SQLs are normal, and it works well.<br>but i have this errors whn i use my paych @ sql2000sp1 or sql2005 64-bit<br><br>when we run sql.sql for ex:<br><br><br>nsExec::ExecToStack '"$Temp\osql.exe" -S${DB_HOST_NAME} -d ${DB_NAME} -U${DB_USERNAME} -P${DB_PASSWORD} -i "$TEMP\sqls\${sqlFile}" -n'<br>pop $0<br>DetailPrint $0 ;$0 = 128<br>pop $0<br>DetailPrint $0 ;$0 = '' empty</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">sgiusto</span><br><span class="post-time small text-muted">13th May 2008 13:14 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">With that usage, 128 is the return value from OSQL<br>The OSQL documentation states that the return values due to sql errors will be negative (from -1 to -102).<br>You can force other error codes using RAISERROR or EXIT() in your sql code.<br><br>If you use the sql_oledb plugin you get the same result?<br>if so check if you have something like a 'select 128' as last select in your code (128 could be the value of a variable or of an expression)</p></div><hr><div class="footer"><p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p></div></div><script src="../js/highlight.pack.js" type="text/javascript"></script><script type="text/javascript">//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]></script></body></html>