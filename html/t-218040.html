<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="description" content="Proofread, fix and streamline"><title>Proofread, fix and streamline - NSIS Forums</title><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script><link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css"><link rel="stylesheet" href="../css/style.css" type="text/css"><!--[if lt IE 9]><script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script><script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script><![endif]--></head><body><div class="container"><ol class="breadcrumb"><li><a href="../index.html" class="glyphicon glyphicon-home"></a></li><li><a href="f-65.html">NSIS Discussion</a></li><li class="active">Proofread, fix and streamline</li></ol><p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=218040">Proofread, fix and streamline</a></p><br><div class="post"><p class="post-meta"><span class="post-author text-primary">ipab</span><br><span class="post-time small text-muted">5th June 2005 08:05 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>Proofread, fix and streamline</strong><br>i need your help guys, i am trying to streal line, structure and otherwise clean up some of my script code and i need your help.<br><br>One thing that i realli need help with is that add/remove freezes after i uninstall using the add/remove panel since i use 'exec' to execute a file.<br>It becomes normal once i close the prog. o please that is something i realli need help with. The rest i would like fo ur guys to help me clean up. thanks ipab</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">ipab</span><br><span class="post-time small text-muted">8th June 2005 06:37 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">anyone :s, plz i realli need assistance</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">RobGrant</span><br><span class="post-time small text-muted">8th June 2005 09:14 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Use ExecWait if you want to run something in the background.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">ipab</span><br><span class="post-time small text-muted">10th June 2005 04:26 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">that only waits for and and thus it doesnt exit the installer, i want the installer to exit as soon as it finishes launching msn messenger</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br><span class="post-time small text-muted">10th June 2005 14:44 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">This code is logically wrong:<br>loop:<br>KillProcDLL::KillProc "msnmsgr.exe"<br>IntCmp $R0 603 exit<br>Goto loop<br>exit:<br><br>Here you're only exiting (jumping to exit) if msnmsgr.exe could <b>not</b> be terminated. Read the KillProcDLL readme. KillProcDLL returns 0 if the process was successfully terminated and 603 if it wasn't.<br><br>On another note, using KillProcDLL is a bad (and last resort) way to kill programs. You should either close them by sending WM_CLOSE with SendMessage, or prompt the user to close it manually:<br><br></p><pre>
<code><br>  FindWindow $R0 "" "MSN Messenger"<br>  IsWindow $R0 0 +3<br>  MessageBox MB_RETRYCANCEL|MB_ICONEXCLAMATION "Please close MSN Messenger before continuing!" IDRETRY -2<br>   Abort<br></code>
</pre><br>
      <br>
      -Stu
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">ipab</span><br>
      <span class="post-time small text-muted">10th June 2005 16:10 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">loop:<br>
      KillProcDLL::KillProc "msnmsgr.exe"<br>
      IntCmp $R0 603 exit<br>
      Goto loop<br>
      exit:<br>
      <br>
      i want it that way, since there are several processes named msnmsgr.exe and thus i want to kill all of them</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br>
      <span class="post-time small text-muted">10th June 2005 16:53 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Yes but take a look and follow the code through:<br>
      <br>
      Begin loop<br>
      Attempt to kill msnmsgr.exe<br>
      If failed exit<br>
      Else loop<br>
      <br>
      I think what you want is:<br>
      <br>
      Begin loop<br>
      Attempt to kill msnmsgr.exe<br>
      If failed loop<br>
      Else exit<br>
      <br>
      -Stu</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br>
      <span class="post-time small text-muted">10th June 2005 16:54 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Simplified:<br>
      <br>
      loop:<br>
      KillProcDLL::KillProc "msnmsgr.exe"<br>
      IntCmp $R0 0 loop<br>
      <br>
      -Stu</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">ipab</span><br>
      <span class="post-time small text-muted">12th June 2005 01:22 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>installer</strong><br>
      here is an installer made with your improved kill code.<br>
      <br>
      can u please take a look at the uninstaller part (install using the installer)and then uninstall using add/remove programs. I think that you will more clearly understand my dilemma.<br>
      <br>
      <a href="http://www.mad-skinning.net/skins/?page=mad" target="_blank">http://www.mad-skinning.net/skins/?page=mad</a></p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">ipab</span><br>
      <span class="post-time small text-muted">23rd June 2005 22:15 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">please delete this, it was by accident.</p>
    </div>
    <hr>

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]></script></body></html>