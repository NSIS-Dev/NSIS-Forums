<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="$AppDATA in Vista for standard user" />

  <title>$AppDATA in Vista for standard user - NSIS Forums</title>
  <script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script>
  <!-- Bootstrap core CSS -->

  <link rel="stylesheet" type="text/css" href="//netdna.bootstrapcdn.com/bootswatch/3.0.1/readable/bootstrap.min.css" />
  <link rel="stylesheet" href="../css/style.css" type="text/css" /><!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!--[if lt IE 9]>
                <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
                <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->
</head>

<body>
  <div class="container">
    <!-- Put navigation bar here -->

    <ol class="breadcrumb">
      <li><a href="../index.html" class="glyphicon glyphicon-home"></a></li>

      <li><a href="f-65.html">NSIS Discussion</a></li>

      <li class="active">$AppDATA in Vista for standard user</li>
    </ol>

    <p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=262651">$AppDATA in Vista for standard user</a></p><br />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">fatcat007</span><br />
      <span class="post-time small text-muted">29th December 2006 05:06 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>$AppDATA in Vista for standard user</strong><br />
      Hi, please help<br />
      <br />
      Im trying to retreive the $appdata for a standard user in Vista. Every time the installer returns the admin user appdata.<br />
      <br />
      The following works fine in WinXP but not in Vista if the user is standard user.<br />
      ------<br />
      MessageBox MB_OK "APPDATA=$APPDATA"<br />
      ReadRegStr $1 HKCU "Software\Microsoft\Windows\CurrentVersion\Explorer\Shell Folders" "AppData"<br />
      MessageBox MB_OK "HKCU\Software\Microsoft\Windows\CurrentVersion\Explorer\Shell Folders $\n $1"<br />
      ReadEnvStr $0 USERPROFILE<br />
      MessageBox MB_OK "ReadEnvStr USERPROFILE=$0"<br />
      System::Call "advapi32::GetUserName(t .r0, *i ${NSIS_MAX_STRLEN} r1) i.r2"<br />
      MessageBox MB_OK "user Name from System Call=$0"<br />
      ------<br />
      Is there a way in NSIS to retreive the APPDATA of standard user in Vista?<br />
      <br />
      Thank you for a quick reply</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
      <span class="post-time small text-muted">29th December 2006 10:42 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">That's probably because the installer got elevated into the administrator's level. You could use `RequestExecutionLevel user`, but then you won't have any administrator privileges.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">fatcat007</span><br />
      <span class="post-time small text-muted">29th December 2006 14:19 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">I have tried all the RequestExecutionLevel level one by one... still the same. Even if the installer needs admin rights why Vista keep sending another user profile instead of the current one.<br />
      Is there another way in NSIS to retreive the APPDATA of standard user in Vista?<br />
      <br />
      Thank you</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
      <span class="post-time small text-muted">30th December 2006 10:08 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Reading the registry value for HKCU should work. Doesn't it? Could you post the result of the script for each of the RequestExecutionLevel values?</p>
    </div>
    <hr />

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]>
  </script>
</body>
</html>
