<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="description" content="ExecWait and .bat vs .cmd"><title>ExecWait and .bat vs .cmd - NSIS Forums</title><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script><link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css"><link rel="stylesheet" href="../css/style.css" type="text/css"></head><body><div class="container"><ol class="breadcrumb"><li><a href="../index.html" class="glyphicon glyphicon-home"></a></li><li><a href="f-65.html">NSIS Discussion</a></li><li class="active">ExecWait and .bat vs .cmd</li></ol><p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=320950">ExecWait and .bat vs .cmd</a></p><br><div class="post"><p class="post-meta"><span class="post-author text-primary">nedloh</span><br><span class="post-time small text-muted">19th July 2010 19:15 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>ExecWait and .bat vs .cmd</strong><br>This is a question more than a problem, but I was working on my NSIS script and during the install process I had a batch file that I needed to run. I attempted to use ExecWait to execute it but it would not run the .bat file and for the life of me could not figure it out. I spent an entire day at work attempting to fix the problem.<br><br>The solution I found at the end of the day is to save the batch file with the .cmd extensions. After hours of fiddling it turned out that doing this and then calling the same way I did when I started my journey solved the problem.<br><br>Does anyone have an explanation on this?</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">jiake</span><br><span class="post-time small text-muted">20th July 2010 02:38 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">I tried ExecWait a bat file and it worked well.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br><span class="post-time small text-muted">20th July 2010 10:06 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">You should never run a batch file using ExecWait without cmd.exe. A batch file is not an executable; it is just another file type associated to run with cmd.exe. In addition, don't use ExecWait because you'll get an ugly console window popup. Use nsExec or ExecDos:<br><br>ReadEnvStr $R0 COMSPEC<br>ExecDos::Exec `"$R0" /C "some_batch_file.bat"`<br>Pop $R0<br><br>Stu</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">nedloh</span><br><span class="post-time small text-muted">20th July 2010 13:35 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Possibly the ExecDos would fix it however I did make sure to run it with cmd.exe as in your example with ExecWait and it did not work at all. As I said I did a simple<br><br>ExecWait '"Batch.cmd" "param1" "param2"'<br><br>and it worked just fine.</p></div><hr><div class="footer"><p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p></div></div><script src="../js/highlight.pack.js" type="text/javascript"></script><script type="text/javascript">//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]></script></body></html>