<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="Help on CustomPage(s) in general" />

  <title>Help on CustomPage(s) in general - NSIS Forums</title><!-- Bootstrap core CSS -->
  <link rel="stylesheet" type="text/css" href="//netdna.bootstrapcdn.com/bootswatch/3.0.1/readable/bootstrap.min.css" />
  <link rel="stylesheet" href="../css/style.css" type="text/css" /><!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!--[if lt IE 9]>
                <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
                <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->
</head>

<body>
  <div class="container">
    <!-- Put navigation bar here -->

    <ol class="breadcrumb">
      <li><a href="../index.html" class="glyphicon glyphicon-home"></a></li>

      <li><a href="f-65.html">NSIS Discussion</a></li>

      <li class="active">Help on CustomPage(s) in general</li>
    </ol>

    <p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=129252">Help on CustomPage(s) in general</a></p><br />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Mosestycoon</span><br />
      <span class="post-time small text-muted">21st March 2003 16:14 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>Help on CustomPage(s) in general</strong><br />
      Moin, moin<br />
      <br />
      I have a simple request:<br />
      <br />
      would it be possible to integrate somemore CustomPage examples within on of the next releases?<br />
      <br />
      I tried the one packed in examples-dir, but really I am a '@ยง%6$#*'-user and I can't get it together to fit my needs.<br />
      <br />
      What I want is a CustomPage which takes the input from a defined field. The input should than be taken to search and replace in a text file. Also to start the application as service or not (e.g. a listbox) is one of the features I need.<br />
      <br />
      Would be very, very "geil" if sombody could screw some more examples.<br />
      <br />
      Chris</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Joost Verburg</span><br />
      <span class="post-time small text-muted">21st March 2003 19:18 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Are you using the Modern UI?<br />
      <br />
      The Modern UI InstallOptions example (InstallOptions is the plugin for custom pages) shows how to get the input, it displays a messagebox when a checkbox has been checked.<br />
      <br />
      The test.nsi script in Contrib\InstallOptions is an example of InstallOptions and the Classic UI, it also gets input from the page.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Mosestycoon</span><br />
      <span class="post-time small text-muted">22nd March 2003 14:06 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Thx for reply Joost.<br />
      <br />
      I am using MUI. I already compiled the InstallOptions.nsi, but it's not really that big example. I thought it might be useful, if a more representative example would be integrated. (Really I could need it ;-) )<br />
      <br />
      Chris</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Joost Verburg</span><br />
      <span class="post-time small text-muted">23rd March 2003 11:17 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Can you please tell exactly what your problem is? The example reads a value from the file, you only have to change the field number and you can use the value.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Mosestycoon</span><br />
      <span class="post-time small text-muted">23rd March 2003 12:03 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Ok Joost,<br />
      <br />
      here we go. In the attached PNG you can see a custompage as it should be displayed . I integrated three radioButtons and everyting works fine (if one is checked, the other goes unchecked)<br />
      <br />
      <b>The (wanted) mechanism:</b><br />
      + <u>Possibility number 1:</u><br />
      By checking the RadioButton, a different file is installed and this file is dynamically modified with 'search and replace function' later on. So the user decides which service to be installed. This value needs to be passed to some FILE option.<br />
      (think I am bad in explaining :-))<br />
      e.g.:<br />
      mysqld-opt.exe is checked my.1.cfg is installed and modified later on<br />
      <br />
      mysqld-nt-max.exe is checked my.2.cfg is installed and modified later on.<br />
      <br />
      (blablabla)<br />
      <br />
      + <u>Possibility number 2:</u><br />
      There is only one my.cfg-file. There is a directive in it:<br /></p>
      <pre>
<code>Server</code><span style="color: #007700">=</span><span style="color: #0000BB">Path</span><span style="color: #007700">/</span><span style="color: #0000BB">to</span><span style="color: #007700">/</span><span style="color: #0000BB">MySQL4</span><span style="color: #007700">/</span><span style="color: #0000BB">bin</span><span style="color: #007700">/</span><span style="color: #0000BB">mysqld</span><span style="color: #007700">-***.</span><span style="color: #0000BB">exe
<br /></span>
</pre>This mysql-***.exe is replaced by the value checked with that RadioButton<br />
      <br />
      e.g.:<br />
      if 'mysqld-opt.exe' is checked, than mysqld-***.exe is replaced with the string mysqld-opt.exe<br />
      <br />
      if mysqld-nt-max.exe is checked, mysqld-***.exe is replaced with the string mysqld-nt-max.exe<br />
      <br />
      (blablabla)<br />
      <br />
      OK, and in this case I'm down and out. I am not a programmer as you can suppose :cry:<br />
      <br />
      Please be patient<br />
      Chris
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Joost Verburg</span><br />
      <span class="post-time small text-muted">23rd March 2003 13:35 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Use the MUI_INSTALLOPTIONS_READ macro to get the state of an option button.<br />
      <br />
      Example:</p>
      <pre>
<code>!insertmacro MUI_INSTALLOPTIONS_READ $R0 "io.ini" "Field #" "State"<br /><br />StrCmp $R0 1 "" noOption1 ;check whether the option is selected<br /><br />  ...copy the files for option 1...<br /><br />noOption1:</code>
</pre>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Mosestycoon</span><br />
      <span class="post-time small text-muted">23rd March 2003 14:51 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"></p>

      <blockquote>
        <i>Originally posted by Joost Verburg</i><br />
        Example:
        <pre>
<code>!insertmacro MUI_INSTALLOPTIONS_READ $R0 "io.ini" "Field #" "State"<br />StrCmp $R0 1 "" noOption1 ;check whether the option is selected<br /><br />  ...copy the files for option 1...<br /><br />noOption1:</code>
</pre>
      </blockquote>--------------&gt;<br />
      <br />
      So correct me, to get the different states of different RadioButtons, I need some more lines:<br />
      <pre>
<code>"StrCmp $R0 1 "" noOption2 ;check whether the option is selected<br />  ...copy the files for option 2...<br />noOption2:</code>
</pre><br />
      <br />
      What is the meaning of the 1 after $R0 and the empty quote?<br />
      <br />
      Again, please be patient<br />
      Thx<br />
      Chris
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Joel</span><br />
      <span class="post-time small text-muted">23rd March 2003 15:19 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">To disable the RadioButtons use the "Flag=Disable"<br />
      For example, like Joost Verburg wrote:<br /></p>
      <pre>
<code><br />Function "XXX"<br />;read the first RadioButton<br />!insertmacro MUI_INSTALLOPTIONS_READ $R0 "io.ini" "Field #" "State"<br />StrCmp $R0 "1" +1 NoCheck ;What's the state of the Radio 1=Check 0=NoCheck<br />;Put the code that you need to run with this<br />...<br />;Disable the others RadioButtons<br />!insertmacro MUI_INSTALLOPTIONS_WRITE "ioFile.ini" "Field #" "Flags" "DISABLED" <br />!insertmacro MUI_INSTALLOPTIONS_WRITE "ioFile.ini" "Field #" "Flags" "DISABLED"<br />Goto End<br /><br />NoCheck:<br />;We repeat the above the code for the others RadioButtons<br /><br />End:<br />FunctionEnd<br /></code>
</pre><br />
      <br />
      I didn't try the code ... :( But I think that use it with "Sections"<br />
      will get your task very well,<br />
      did you read the $NSISDIR\NSIS\Examples\one-section.nsi
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Mosestycoon</span><br />
      <span class="post-time small text-muted">23rd March 2003 15:29 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">No, I haven't tried the one-section.nsi example, but I have the following solution now, and it seems to work...<br />
      <br /></p>
      <pre>
<code>Section "mysql" SecMySQL<br /><br />  SetOutPath "$INSTDIR"<br />  File "Path\to\mysqld.exe"<br /><br />  ;; if mysqld-nt.exe is installed, than copy my.nt.ini to WINDIR<br />  ;; -----------------<br />  !insertmacro MUI_INSTALLOPTIONS_READ $R0 "ioA.ini" "Field 3" "State"<br />  StrCmp $R0 1 "" noOption1    ;check whether the option is selected<br />  SetOutPath "$WINDIR"<br />  File "Path\to\my.nt.ini"<br /><br />  ...function to search and replace...<br /><br />  noOption1:<br />  <br />  ;; if mysqld-opt.exe is installed, than install my.opt.ini<br />  ;; -----------------<br />  !insertmacro MUI_INSTALLOPTIONS_READ $R0 "ioA.ini" "Field 4" "State"<br />  StrCmp $R0 1 "" noOption2    ;check whether the option is selected<br />  SetOutPath "$WINDIR"<br />  File "Path\to\my.opt.ini"<br /><br />  ...function to search and replace...<br /><br />  <br />  noOption2:<br /><br />  ;; if mysqld-max-nt.exe is installed, than install my.max-nt.ini<br />  ;; -----------------<br />  !insertmacro MUI_INSTALLOPTIONS_READ $R0 "ioA.ini" "Field 5" "State"<br />  StrCmp $R0 1 "" noOption3    ;check whether the option is selected<br />  SetOutPath "$WINDIR"<br />  File "Path\to\my.max-nt.ini"<br /><br />  ...function to search and replace...<br /><br />  <br />  noOption3:<br /><br />SectionEnd</code>
</pre><br />
      <br />
      Could you please verify that?<br />
      Thx in advance UR GR8 !<br />
      Chris aka MosesTycoon<br />
      <br />
      <pre>
<code><br />if mosestycoon is '*ยง$%#&amp;'<br />    then ask @ FORUM<br />fi<br /></code>
</pre><br />
      ;)
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Joel</span><br />
      <span class="post-time small text-muted">23rd March 2003 15:39 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Seems to be :up:<br />
      If it worked than :)</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Mosestycoon</span><br />
      <span class="post-time small text-muted">23rd March 2003 15:43 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Dark Boy -<br />
      <br /></p>

      <blockquote>
        <pre>
<code><br />;Disable the others RadioButtons<br />!insertmacro MUI_INSTALLOPTIONS_WRITE "ioFile.ini" "Field #" "Flags" "DISABLED" <br />!insertmacro MUI_INSTALLOPTIONS_WRITE "ioFile.ini" "Field #" "Flags" "DISABLED"<br />Goto End<br /></code>
</pre>
      </blockquote>Why do I need that part?<br />
      <br />
      Chris
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Joel</span><br />
      <span class="post-time small text-muted">23rd March 2003 15:48 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Didn't you want to disable the other radio buttons if<br />
      one is check? :p<br />
      Well is for that, why? I doesn't work?</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
      <span class="post-time small text-muted">23rd March 2003 16:00 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">StrCmp $R0 1 "" noOption2<br />
      means compare $R0 to 1, if equal jump to "" (which is the same as 0 or +1, which just means next line), if not jump to the noOption2 label.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Mosestycoon</span><br />
      <span class="post-time small text-muted">23rd March 2003 16:17 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Welcome on discussion KichiK,<br />
      <br />
      as you joined, perhaps you can answer a corresponding question?<br />
      <br />
      As you already read the thread I have posted this "Section" which works double-:-)<br />
      <br />
      So as far as that is not enough, I work on a more complicated version of this, here a snippet:<br /></p>
      <pre>
<code> SetOutPath "$INSTDIR"<br />  File "\Path\to\bin\mysqld-nt.exe"<br /><br />  ;; if mysqld-nt.exe is installed, than...<br />  !insertmacro MUI_INSTALLOPTIONS_READ $R0 "ioA.ini" "Field 3" "State"<br /><br />  StrCmp $R0 1 "" noOption1    ;check whether the option is selected<br /><br />  SetOutPath "$WINDIR"<br />  File "\Path\to\my.nt.ini"<br />  <br />  ;;--------------------------------<br />  ;; here we try to edit some lines in that copied file with search and replace<br /><br />    ClearErrors<br />    FileOpen $0 "$WINDIR\my.nt.ini" "r"<br />    GetTempFileName $R0<br />    FileOpen $1 $R0 "w"<br />     loop:<br />       FileRead $0 $2<br />       IfErrors done<br />        StrCmp $2 "++basedir++$\r$\n" 0 +3<br />           FileWrite $1 "basedir=$INSTDIR$\r$\n"<br />           Goto loop<br />        StrCmp $2 "++datadir++$\r$\n" 0 +3<br />           FileWrite $1 "datadir=$INSTDIR\data$\r$\n"<br />           Goto loop<br />        StrCmp $2 "++language++$\r$\n" 0 +3<br />           FileWrite $1 "language=$INSTDIR/share/german$\r$\n"<br />           Goto loop<br />        StrCmp $2 "++Server++$\r$\n" 0 +3<br />           FileWrite $1 "Server=$INSTDIR/bin/mysqld-nt.exe$\r$\n"<br />           Goto loop<br />        FileWrite $1 $2<br />           Goto loop<br />    done:<br />        FileClose $0<br />        FileClose $1<br />        Delete "$WINDIR\my.nt.ini"<br />        Rename $R0 "$WINDIR\my.ini"<br />  <br />  <br />  ;Disable the others RadioButtons<br />  !insertmacro MUI_INSTALLOPTIONS_WRITE "ioA.ini" "Field 4" "Flags" "DISABLED" <br />  !insertmacro MUI_INSTALLOPTIONS_WRITE "ioA.ini" "Field 5" "Flags" "DISABLED"<br />  <br />  noOption1:<br /><br />...<br /><br />; code for Option2 (if RadioButton2 is checked)<br /><br />...<br /><br />; code for Option3 (if RadioButton3 is checked)</code>
</pre><br />
      <br />
      So this works fine, but when I use the same again (for the other two RadioButtons) the compiler quits with:<br />
      <br />
      <pre>
<code>Error: label "loop:" already declared in section/function<br />Error in script "C:\NSIS\INSTALL_OPTIONS\InstallOptions.nsi" on line 205 -- aborting creation process</code>
</pre><br />
      <br />
      I think I understand this, but what can I do against.<br />
      <br />
      The way it should work:<br />
      Section:<br />
      RadioButton 1 checked: copy FileA to $WINDIR and modify it...<br />
      RadioButton 2 checked: copy FileB to $WINDIR and modify it...<br />
      <br />
      FileA and FileB are almost the same, except in one line:<br />
      mysqld-opt.exe (e.g. FileA) and mysqld-nt.exe (FileB)<br />
      <br />
      (And there will be a third one...)<br />
      <br />
      Thx Chris
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Mosestycoon</span><br />
      <span class="post-time small text-muted">23rd March 2003 16:20 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"></p>

      <blockquote>
        <i>Originally posted by Dark Boy</i><br />
        <b>Didn't you want to disable the other radio buttons if<br />
        one is check? :p<br />
        Well is for that, why? I doesn't work?</b>
      </blockquote>I think this is done by default if the io.ini contains the several "State" values and FLAGS=Group ?<br />
      <br />
      Chris<br />
      <br />
      ---[Added]---<br />
      Ahhh, sorry! I haven't answered your question: it works :D
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
      <span class="post-time small text-muted">23rd March 2003 16:23 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Three things before we get to the real problem:<br />
      1) Please attach large scripts next time.<br />
      2) If you disable the radio buttons the user won't be able to change his selection when he returns to the page.<br />
      3) I suggest you move all of the extraction and file changing code into a section so the user will get a chance to change his selection.<br />
      <br />
      Now for the problem, you have two options:<br />
      1) Change loop to something else in each block.<br />
      2) Create a function out of this code that takes the file name to change off the top of the stack or just out a variable.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Mosestycoon</span><br />
      <span class="post-time small text-muted">23rd March 2003 16:27 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"></p>

      <blockquote>
        <i>Originally posted by kichik</i><br />
        <b>Three things before we get to the real problem:<br />
        1) Please attach large scripts next</b>
      </blockquote>I will, sorry<br />
      ;)
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Mosestycoon</span><br />
      <span class="post-time small text-muted">23rd March 2003 16:39 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">OK<br />
      I attached the snippet. I just renamed loop to loop1 or loop2 (the same for done)<br />
      <br />
      and it works<br />
      <br />
      Really cool support, guys<br />
      Again and again and again<br />
      <br />
      <font color="darkblue"><b>I love NSIS and all of you supporters (not for real :D)</b></font><br />
      <br />
      Chris<br />
      <br />
      P.S.:<br />
      By the way, when everything is finished with that CustomPage-bla, I try to write some comments on the snippet and post it at archive. I think this could help many non-programmers like me<br />
      <br />
      But be sure I need some more help, because this was the smaller part of the script...</p>
    </div>
    <hr />

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]>
  </script>
</body>
</html>
