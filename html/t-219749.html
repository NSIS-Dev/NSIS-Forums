<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="description" content="Setting MUI_FINISHPAGE_RUN dynamically?"><title>Setting MUI_FINISHPAGE_RUN dynamically? - NSIS Forums</title><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script><link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css"><link rel="stylesheet" href="../css/style.css" type="text/css"><!--[if lt IE 9]><script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script><script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script><![endif]--></head><body><div class="container"><ol class="breadcrumb"><li><a href="../index.html" class="glyphicon glyphicon-home"></a></li><li><a href="f-65.html">NSIS Discussion</a></li><li class="active">Setting MUI_FINISHPAGE_RUN dynamically?</li></ol><p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=219749">Setting MUI_FINISHPAGE_RUN dynamically?</a></p><br><div class="post"><p class="post-meta"><span class="post-author text-primary">cowwoc</span><br><span class="post-time small text-muted">24th June 2005 18:28 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>Setting MUI_FINISHPAGE_RUN dynamically?</strong><br>Hi,<br><br>I need to set MUI_FINISHPAGE_RUN dynamically during runtime (whereas by default it is a !define) because the cmdline needs to be defined as:<br><br>&lt;path_to_jre&gt;/bin/javaws.exe myApplicationURL.jnlp<br><br>I have the ability to determine &lt;path_to_jre&gt; during runtime, but how do I set MUI_FINISHPAGE_RUN accordingly? Is it even possible?<br><br>Thanks,<br>Gili</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">kichik</span><br><span class="post-time small text-muted">24th June 2005 18:30 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Use MUI_FINISHPAGE_RUN_FUNCTION or set MUI_FINISHPAGE_RUN with a variable and then change that variable before the finish page shows.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">cowwoc</span><br><span class="post-time small text-muted">24th June 2005 18:32 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Oh! That's great! Thank you! :)</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">cowwoc</span><br><span class="post-time small text-muted">24th June 2005 18:49 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">BTW: I noticed that if I use nsExec::Exec inside the function, then the installer will "hang" of sorts. That is, you get to the last panel where it says "Run &lt;application name&gt;?" which is checked, you click on FINISH and nothing happens... It doesn't close the panel and you can click FINISH for as long as you want but it won't close. You are forced to abort the installation.<br><br>Switching to ShellExec worked. I'm just curious why nsExec::Exec is dieing here...?</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">kichik</span><br><span class="post-time small text-muted">24th June 2005 18:53 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">It probably isn't dying but simply waiting for the process to finish.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">cowwoc</span><br><span class="post-time small text-muted">24th June 2005 18:58 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Except the process is never launched. The exact same process that works in ShellExec "hangs" under nsExec. Odd.<br><br>Do you think that maybe at this stage nsExec and other contrib modules are no longer available or something?</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">cowwoc</span><br><span class="post-time small text-muted">24th June 2005 19:02 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Nevermind, it doesn't really matter. I realized I don't really want to wait on the process anyway. Thanks for all your help!</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">kichik</span><br><span class="post-time small text-muted">24th June 2005 19:06 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">There's nothing that's stopping nsExec from running in there. I've created a test script that runs makensis.exe there and it worked fine. Can you attach an example, not using java?</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">BioDuo</span><br><span class="post-time small text-muted">25th June 2005 13:26 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Well, don't want to open a new Topic when there's already one on going already<br><br>I want to make also a MUI_FINISHPAGE_RUN but it should run the application were the path of the .exe is stored in the register<br><br>Example<br>HCKU "SOftware\BioDuo" "C:\BioDuo\BioDuo.exe"<br><br>But how do I do this?</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br><span class="post-time small text-muted">25th June 2005 13:42 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Use MUI_FINISHPAGE_RUN_FUNCTION...<br><br></p><pre>
<code>!define MUI_FINISHPAGE_RUN_FUNCTION finishFunc<br>!define MUI_FINISHPAGE_RUN_TEXT "Run BioDuo"<br><br>Function finishFunc<br> ReadRegStr $R0 HKCU "Software\BioDuo" "BioDuo"<br> Exec $R0<br>FunctionEnd</code>
</pre><br>
      <br>
      -Stu
    </div>
    <hr>

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]></script></body></html>