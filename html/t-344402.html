<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="description" content="Installing as non-local admin?"><title>Installing as non-local admin? - NSIS Forums</title><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script><link rel="preload" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css" as="style" onload="this.rel='stylesheet'"><link rel="preload" href="../css/style.css" as="style" onload="this.rel='stylesheet'"><noscript><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css"><link rel="stylesheet" href="../css/style.css"></noscript><script>!function(a){"use strict";var b=function(b,c,d){function e(a){return h.body?a():void setTimeout(function(){e(a)})}function f(){i.addEventListener&&i.removeEventListener("load",f),i.media=d||"all"}var g,h=a.document,i=h.createElement("link");if(c)g=c;else{var j=(h.body||h.getElementsByTagName("head")[0]).childNodes;g=j[j.length-1]}var k=h.styleSheets;i.rel="stylesheet",i.href=b,i.media="only x",e(function(){g.parentNode.insertBefore(i,c?g:g.nextSibling)});var l=function(a){for(var b=i.href,c=k.length;c--;)if(k[c].href===b)return a();setTimeout(function(){l(a)})};return i.addEventListener&&i.addEventListener("load",f),i.onloadcssdefined=l,l(f),i};"undefined"!=typeof exports?exports.loadCSS=b:a.loadCSS=b}("undefined"!=typeof global?global:this);!function(a){if(a.loadCSS){var b=loadCSS.relpreload={};if(b.support=function(){try{return a.document.createElement("link").relList.supports("preload")}catch(b){return!1}},b.poly=function(){for(var b=a.document.getElementsByTagName("link"),c=0;c<b.length;c++){var d=b[c];"preload"===d.rel&&"style"===d.getAttribute("as")&&(a.loadCSS(d.href,d,d.getAttribute("media")),d.rel=null)}},!b.support()){b.poly();var c=a.setInterval(b.poly,300);a.addEventListener&&a.addEventListener("load",function(){b.poly(),a.clearInterval(c)}),a.attachEvent&&a.attachEvent("onload",function(){a.clearInterval(c)})}}}(this);</script></head><body><div class="container"><ol class="breadcrumb"><li><a href="../index.html" class="glyphicon glyphicon-home"></a></li><li><a href="f-65.html">NSIS Discussion</a></li><li class="active">Installing as non-local admin?</li></ol><p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=344402">Installing as non-local admin?</a></p><br><div class="post"><p class="post-meta"><span class="post-author text-primary">Jouydree</span><br><span class="post-time small text-muted">24th April 2012 11:37 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>Installing as non-local admin?</strong><br>Hello All,<br><br>years ago, I had written an extensive nsis script (including my own plugin dll) to install several applications. The install process requires administrative privileges and so far using the 'run as" option of windows was ok for the clients.<br><br>Now I am confronted with the wish of an important client to "support Windows Domain Accounts" and to enable the clients administrators to "install as non-local admin". Unfortunately Windows is not the area of my greatest expertise.<br><br>What my researches have unearthed so far, is that it all is about "Active Directories" and "Group Policies" and that either nsis does not support this or nobody has a need of it: The only similiar cases I found was an admin daily changing the administrator passwords and supplying his users with it on request, and someone including that password in the script itself). Another <i>impression</i> I got in my research was that it would be best to wrap the nsis installer executable in a MSI installer...<br><br>Before I now start to learn MSI needlessly: Could somebody please point me in the right direction? Did I understand the client's wish correctly at all?<br><br>Jouydree</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br><span class="post-time small text-muted">24th April 2012 16:13 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">You should not have to change anything to your script to support domain account installations. As long as you have written your script correctly with <b>RequestExecutionLevel admin</b> and are checking the user is indeed an administrator (UserInfo plug-in) then that should be enough.<br><br>I'm not sure what you're getting at in your post. Is the client unable to install under a domain account? Why are you looking into active directory and group policy? Do you need to change active directory entries or apply group policies?<br>And what gave you the idea that you have to wrap into an MSI? You need to explain why. If you do not know why then your researchers aren't doing a very good job :)<br><br>Stu</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Jouydree</span><br><span class="post-time small text-muted">24th April 2012 17:01 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Hello Afrow,<br><br>firstly thank you for the quick reply! Secondly my researchers are all clones of myself, so I take all the blame. ;) I am sorry that the description of my problem is a little confused - that is probably part of the problem: <i>I <b>am</b> confused</i>.<br><br>I do use <b>RequestExecutionLevel admin</b> and I do check with <b>xtInfoPlugin::IsAdministrator</b> on Windows NT, 2000, XP, Vista, and 7. This has never been any problem: Either the installer is run as admin or a polite MsgBox informs the user "that unfortunatly we are compelled to request administrative privileges", asks to use "run as...", and exits.<br><br>Now the administrator or a client wrote us an email that he does "<i>not want to go from one employee's PC to the next employee's laptop and enter the administrators password</i>", but that we should "<i>modify our installer in a way that it will work with Windows Domain accounts</i>" and allow him to install as "<i>a non-local Admin</i>" ...<br><br>I was at a loss what was meant with "work with Windows Domain accounts" (and naturally shy to expose our utter ignorance in that area by asking him) and started researching. This is how I ended up with Active Directories and Group Policies. Hence my opening post. I've no idea in what direction to search or to act.<br><br>Jouydree</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br><span class="post-time small text-muted">24th April 2012 19:36 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">OK thanks for explaining. What you mean I think is remote installation. Installing using a domain user account is no problem but remote installations are. Remote installations require Microsoft Installer components which are part of the OS - NSIS does not use these components.<br><br>Try searching the forums for "remote installations" but you may have to go with an MSI as you have already said. There are free MSI generators around (such as WiX) but if you can afford a commercial product I would recommend Advanced Installer. I was able to create MSI wrappers for NSIS installers using Advanced Installer quite easily in the past (but I have the paid version - not the free version).<br><br>Stu</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Jouydree</span><br><span class="post-time small text-muted">24th April 2012 20:07 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Hi Stu,<br><br>thank you very much! At least I know now, in which direction to search and act! What a relief.<br><br>Have a nice evening!<br>Jouydree</p></div><hr><div class="footer"><p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p></div></div><script type="text/javascript" src="../js/highlight.pack.js" async></script><script type="text/javascript">//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]></script></body></html>