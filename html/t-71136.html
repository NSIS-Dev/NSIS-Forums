<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="Feature request: compare DLLs version" />

  <title>Feature request: compare DLLs version - NSIS Forums</title>
  <script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script>
  <!-- Bootstrap core CSS -->

  <link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css" />
  <link rel="stylesheet" href="../css/style.css" type="text/css" /><!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!--[if lt IE 9]>
                <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
                <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->
</head>

<body>
  <div class="container">
    <!-- Put navigation bar here -->

    <ol class="breadcrumb">
      <li><a href="../index.html" class="glyphicon glyphicon-home"></a></li>

      <li><a href="f-65.html">NSIS Discussion</a></li>

      <li class="active">Feature request: compare DLLs version</li>
    </ol>

    <p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=71136">Feature request: compare DLLs version</a></p><br />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">futuris</span><br />
      <span class="post-time small text-muted">7th January 2002 16:00 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>Feature request: compare DLLs version</strong><br />
      The only thing I miss in NSIS is DLL version checking. Currently I have to use following code:<br />
      <br />
      IfFileExists "$SYSDIR\futuris.bpl" CheckVersion CopyDLL<br />
      CheckVersion:<br />
      GetDLLVersion "$SYSDIR\futuris.bpl" $5 $6<br />
      GetDLLVersionLocal "..\runtime\futuris.bpl" $7 $8<br />
      IntCmp $5 $7 CheckBuild CopyDLL NoAbort<br />
      CheckBuild:<br />
      IntCmp $6 $8 NoAbort CopyDLL NoAbort<br />
      ; copying required DLL<br />
      CopyDLL:<br />
      <br />
      But it all can be changed to:<br />
      <br />
      CompareDLLver "$SYSDIR\futuris.bpl" "..\runtime\futuris.bpl" /<br />
      CopyDLL SkipCopying</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Schultz</span><br />
      <span class="post-time small text-muted">7th January 2002 16:32 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">I belive at one time this function was in nsis but i belive justin removed it cause he could get the same functionality out of small functions in the exehead and doing more work in the script. The same reason why the Netscape plugin and some otehr commands where removed cause they could be done by the script.. here is a nice macro that might make it easier for you to update files.. this is gotten out of the functions.htm file in your NSIS Program Dir.<br /></p>
      <pre>
<code><br />;------------------------------------------------------------------------------<br />; UpgradeDLL (macro)<br />;<br />; Updates a DLL (or executable) based on version resource information.<br />;<br />; Input: ${DLL_NAME} = input source file.<br />;        top of stack = full path on system to install file to.<br />;<br />; Output: none (removes full path from stack)<br />;<br />; Usage:<br />;<br />;  Push "$SYSDIR\atl.dll"<br />;  !define DLL_NAME atl.dll<br />;  !insertmacro UpgradeDLL<br />;<br /><br />!macro UpgradeDLL<br />  Exch $0<br />  Push $1<br />  Push $2<br />  Push $3<br />  Push $4<br />  ClearErrors<br />  GetDLLVersionLocal ${DLL_NAME} $1 $2<br />  GetDLLVersion $0 $3 $4<br />  IfErrors upgrade_${DLL_NAME}<br />    IntCmpU $1 $3 noupgrade_${DLL_NAME} noupgrade_${DLL_NAME} upgrade_${DLL_NAME}<br />    IntCmpU $2 $4 noupgrade_${DLL_NAME} noupgrade_${DLL_NAME}<br />  upgrade_${DLL_NAME}:<br />    UnRegDLL $0<br />    File /oname=$0 ${DLL_NAME}<br />    RegDLL $0<br />  noupgrade_${DLL_NAME}:<br />  Pop $4<br />  Pop $3<br />  Pop $2<br />  Pop $1<br />  Pop $0<br />  !undef DLL_NAME<br />!macroend<br /></code>
</pre>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Joost Verburg</span><br />
      <span class="post-time small text-muted">8th January 2002 20:25 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Is it really required to Unreg a DLL first before registering it again?</p>
    </div>
    <hr />

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]>
  </script>
</body>
</html>
