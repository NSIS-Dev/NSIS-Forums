<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="description" content="Quit NSIS if REG Entry Not Present"><title>Quit NSIS if REG Entry Not Present - NSIS Forums</title><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script><link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css"><link rel="stylesheet" href="../css/style.css" type="text/css"></head><body><div class="container"><ol class="breadcrumb"><li><a href="../index.html" class="glyphicon glyphicon-home"></a></li><li><a href="f-65.html">NSIS Discussion</a></li><li class="active">Quit NSIS if REG Entry Not Present</li></ol><p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=363744">Quit NSIS if REG Entry Not Present</a></p><br><div class="post"><p class="post-meta"><span class="post-author text-primary">gruntlord6</span><br><span class="post-time small text-muted">14th June 2013 11:29 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>Quit NSIS if REG Entry Not Present</strong><br>I am not new to NSIS, but I am not familiar with most of the advanced functions. Right now, my installer reads the reg entry and sets it as the default install path, and shows the standard Instfiles page. What I want to be able to do, is run a check when the installer runs (oninit right?) that will check for that reg entry and display a dialogue if it is not found, and when it displays that dialogue, it should exit afterword. What is the best way to go about doing this?</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">jpderuiter</span><br><span class="post-time small text-muted">14th June 2013 12:20 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><a href="http://nsis.sourceforge.net/Abort" target="_blank">http://nsis.sourceforge.net/Abort</a></p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">gruntlord6</span><br><span class="post-time small text-muted">14th June 2013 12:28 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"></p><blockquote><small>Originally posted by jpderuiter</small><br><a href="http://nsis.sourceforge.net/Abort" target="_blank">http://nsis.sourceforge.net/Abort</a></blockquote>Thanks for the help! That solves half my problem. Can you tell me how I would perform the check? I would imagine something like:<br><pre>
<code>Function onInit<br>If RegKey HKLM "Software\(My Application)" "" false:<br>MessageBox MB_OK "You need (My Application) installed to use this installer."<br>Abort<br>FunctionEnd</code>
</pre><br>
      <br>
      I hope I don't seem lazy, I would just like an example to work from.
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">jpderuiter</span><br>
      <span class="post-time small text-muted">14th June 2013 12:43 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Read the value from registry:<br>
      <a href="http://nsis.sourceforge.net/Docs/Chapter4.html#4.9.2.12" target="_blank">http://nsis.sourceforge.net/Docs/Chapter4.html#4.9.2.12</a><br>
      <br>
      Check for errors:<br>
      <a href="http://nsis.sourceforge.net/Docs/Chapter4.html#4.9.4.9" target="_blank">http://nsis.sourceforge.net/Docs/Chapter4.html#4.9.4.9</a><br>
      <br>
      Show Messagebox:<br>
      <a href="http://nsis.sourceforge.net/Docs/Chapter4.html#4.9.4.15" target="_blank">http://nsis.sourceforge.net/Docs/Chapter4.html#4.9.4.15</a></p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">gruntlord6</span><br>
      <span class="post-time small text-muted">14th June 2013 17:57 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"></p>

      <blockquote>
        <small>Originally posted by jpderuiter</small><br>
        Read the value from registry:<br>
        <a href="http://nsis.sourceforge.net/Docs/Chapter4.html#4.9.2.12" target="_blank">http://nsis.sourceforge.net/Docs/Chapter4.html#4.9.2.12</a><br>
        <br>
        Check for errors:<br>
        <a href="http://nsis.sourceforge.net/Docs/Chapter4.html#4.9.4.9" target="_blank">http://nsis.sourceforge.net/Docs/Chapter4.html#4.9.4.9</a><br>
        <br>
        Show Messagebox:<br>
        <a href="http://nsis.sourceforge.net/Docs/Chapter4.html#4.9.4.15" target="_blank">http://nsis.sourceforge.net/Docs/Chapter4.html#4.9.4.15</a>
      </blockquote>I am not to sure what exactly you are purposing. The Messagebox is indeed what I am looking for to do the text output, and that part is now taken care of. Not sure how I am supposed to utilize IfErrors with ReadRegStr to get my result. It would really help to give an example.
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">jpderuiter</span><br>
      <span class="post-time small text-muted">14th June 2013 18:11 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"></p>

      <blockquote>
        Originally Posted by <strong>4.9.2.12 ReadRegStr</strong> The error flag will be set and $x will be set to an empty string ("") if the string is not present.
      </blockquote>
      <pre>
<code>ReadRegStr $0 HKLM "Software\(My Application)" ""<br>IfErrors 0 +3<br>MessageBox MB_OK "You need (My Application) installed to use this installer."<br>Abort</code>
</pre>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br>
      <span class="post-time small text-muted">14th June 2013 23:32 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Call ClearErrors before ReadRegStr as well in case you later add code which sets the error flag resulting in an incorrect Abort.<br>
      <br>
      Stu</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">gruntlord6</span><br>
      <span class="post-time small text-muted">17th June 2013 12:35 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"></p>

      <blockquote>
        <small>Originally posted by Afrow UK</small><br>
        Call ClearErrors before ReadRegStr as well in case you later add code which sets the error flag resulting in an incorrect Abort.<br>
        <br>
        Stu
      </blockquote>Thank you both! The installer now works as expected.
    </div>
    <hr>

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]></script></body></html>