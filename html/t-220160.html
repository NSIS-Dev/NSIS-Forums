<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="description" content="Installer for Terminal Servers"><title>Installer for Terminal Servers - NSIS Forums</title><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script><link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css"><link rel="stylesheet" href="../css/style.css" type="text/css"></head><body><div class="container"><ol class="breadcrumb"><li><a href="../index.html" class="glyphicon glyphicon-home"></a></li><li><a href="f-65.html">NSIS Discussion</a></li><li class="active">Installer for Terminal Servers</li></ol><p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=220160">Installer for Terminal Servers</a></p><br><div class="post"><p class="post-meta"><span class="post-author text-primary">Joschrigon</span><br><span class="post-time small text-muted">28th June 2005 21:51 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>Installer for Terminal Servers</strong><br>Hi,<br><br>i'm in the process to find a way to create an installer for Terminal Servers. Problem seems to be, that %WINDIR and %FONTS Constants are not containing the System folders like<br><br>C:\WINDOWS and C:\WINDOWS\FONTS.<br><br>On a terminal Server i get the personal folders<br><br>C:\Documents and Settings\&lt;user&gt;\Windows ..<br><br>I also have tried a call of Kernel32::GetWindowsDirectory<br><br>only kernel32::GetSystemWindowsDirectoryA<br><br>gives me the correct C:\WINDOWS\System32..<br><br>I also found some articles on MSDN.. and a File Header problem that have to be set..<br><br>IMAGE_DLLCHARACTERISTICS_TERMINAL_SERVER_AWARE<br><br>I never heard about this before.. but it seems to be important in a Terminal Server environment?<br><br>Can someone help me? How can i get the Windows Folder on a Terminal Server correctly?</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">bholliger</span><br><span class="post-time small text-muted">29th June 2005 08:15 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Hi<br><br>This is the usual terminal-server behaviour.<br><br>Terminal-server is an approach to use windows as a multi-user system: If an application writes to an ini-file which is located in the windows-folder, windows writes it to the %userprofile%\windows folder. If it would not do this, there would soon be a giant mess because every user writes to the same ini-file.<br><br>When you start a setup-routine on a terminal server and this program is named setup.exe, windows says that you should install in "install-mode".<br><br>Maybe your install file is not named setup.exe, so you could execute the command "change user /install" before you start and "change user /execute" after installation.<br><br>You can get further information in the help files of windows.<br><br>Hope this helps.<br><br>Have a nice day.<br>-Bruno.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Joschrigon</span><br><span class="post-time small text-muted">29th June 2005 19:14 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Wow!<br>This works. I also have searched for this at MSDN now.. and found it. (Only with your information)<br><br>Thank you very much for this quick respond.<br><br>Now my installer works fine on a Terminal Server! :-))</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">saivert</span><br><span class="post-time small text-muted">30th June 2005 06:48 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Maybe a good feature request for NSIS would be to have a installer attribute named TerminalServerAware which could be set to "yes" in order to have the IMAGE_DLLCHARACTERISTICS_TERMINAL_SERVER_AWARE flag in the generated EXE header.</p></div><hr><div class="footer"><p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p></div></div><script src="../js/highlight.pack.js" type="text/javascript"></script><script type="text/javascript">//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]></script></body></html>