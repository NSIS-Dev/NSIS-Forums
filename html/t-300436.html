<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="description" content="Help with WinVer testing"><title>Help with WinVer testing - NSIS Forums</title><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script><link rel="preload" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css" as="style" onload="this.rel='stylesheet'"><link rel="preload" href="../css/style.css" as="style" onload="this.rel='stylesheet'"><noscript><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css"><link rel="stylesheet" href="../css/style.css"></noscript><script>!function(a){"use strict";var b=function(b,c,d){function e(a){return h.body?a():void setTimeout(function(){e(a)})}function f(){i.addEventListener&&i.removeEventListener("load",f),i.media=d||"all"}var g,h=a.document,i=h.createElement("link");if(c)g=c;else{var j=(h.body||h.getElementsByTagName("head")[0]).childNodes;g=j[j.length-1]}var k=h.styleSheets;i.rel="stylesheet",i.href=b,i.media="only x",e(function(){g.parentNode.insertBefore(i,c?g:g.nextSibling)});var l=function(a){for(var b=i.href,c=k.length;c--;)if(k[c].href===b)return a();setTimeout(function(){l(a)})};return i.addEventListener&&i.addEventListener("load",f),i.onloadcssdefined=l,l(f),i};"undefined"!=typeof exports?exports.loadCSS=b:a.loadCSS=b}("undefined"!=typeof global?global:this);!function(a){if(a.loadCSS){var b=loadCSS.relpreload={};if(b.support=function(){try{return a.document.createElement("link").relList.supports("preload")}catch(b){return!1}},b.poly=function(){for(var b=a.document.getElementsByTagName("link"),c=0;c<b.length;c++){var d=b[c];"preload"===d.rel&&"style"===d.getAttribute("as")&&(a.loadCSS(d.href,d,d.getAttribute("media")),d.rel=null)}},!b.support()){b.poly();var c=a.setInterval(b.poly,300);a.addEventListener&&a.addEventListener("load",function(){b.poly(),a.clearInterval(c)}),a.attachEvent&&a.attachEvent("onload",function(){a.clearInterval(c)})}}}(this);</script></head><body><div class="container"><ol class="breadcrumb"><li><a href="../index.html" class="glyphicon glyphicon-home"></a></li><li><a href="f-65.html">NSIS Discussion</a></li><li class="active">Help with WinVer testing</li></ol><p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=300436">Help with WinVer testing</a></p><br><div class="post"><p class="post-meta"><span class="post-author text-primary">kichik</span><br><span class="post-time small text-muted">29th November 2008 12:32 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>Help with WinVer testing</strong><br>A new and improved version of WinVer.nsh is coming in the next version of NSIS (2.42). It supports Windows Server 2008, fixes Windows XP x64 identification, resolves ambiguity of Windows 95 and NT4; and adds a couple more features. It's based on a patch by Andres.<br><br>I've also beefed up its tests so I don't have to waste my time testing on numerous virtual machines but quickly test it on my main machine. To do this, I've written a script that fakes each configuration I could get my hands on. If you're interested, you can read more about it in my <a href="http://kichik.net/2008/11/29/pragmatic-variant/" target="_blank">blog</a>.<br><br>My collection of Windows versions is extensive, but doesn't cover everything. And this is where you come in. If you have any configuration not listed in the <a href="http://nsis.svn.sourceforge.net/viewvc/nsis/NSIS/trunk/Source/Tests/winver.nsi?view=markup" target="_blank">test script</a>, please run the attached information collector and post the results here.<br><br>Distinctively missing are:</p><ol style="list-style-type: decimal"><li>Windows 2003</li><li>Windows Vista SP1</li><li>Windows Vista x64</li></ol>Others:<ol style="list-style-type: decimal"><li>Windows 98 SE</li><li>Windows NT4 SP0 - SP5</li><li>Windows 2000 SP1 - SP3</li><li>Windows XP SP0 - SP1</li><li>Windows 2003 SP1 - SP2</li></ol></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Yathosho</span><br><span class="post-time small text-muted">29th November 2008 13:36 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">attached log for Windows Server 2003 Standard Edition [5.2.3790]</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Pawel</span><br><span class="post-time small text-muted">29th November 2008 13:50 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>Re: Help with WinVer testing</strong><br></p><blockquote><i>Originally posted by kichik</i><br><b><br>Distinctively missing are:</b><ol style="list-style-type: decimal"><li><b>Windows 2003</b></li><li><b>Windows Vista SP1</b></li><li><b>Windows Vista x64</b></li></ol></blockquote>Hi Kichik,<br>Here is a Windows Vista SP1 test.<br>Regards,<br>-Pawel</div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Yathosho</span><br><span class="post-time small text-muted">29th November 2008 13:51 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">and Vista SP1 [6.0.6001]</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">kichik</span><br><span class="post-time small text-muted">29th November 2008 13:58 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Thanks! Both uploaded and tests still pass.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">{_trueparuex^}</span><br><span class="post-time small text-muted">1st December 2008 16:19 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Attached Windows 98 SE and Windows 2000 SP1 - SP3<br><br>PaR</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">xbarns</span><br><span class="post-time small text-muted">1st December 2008 16:25 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Vista x64 SP1</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">xbarns</span><br><span class="post-time small text-muted">1st December 2008 16:37 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Windows XP Pro SP1 English</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">xbarns</span><br><span class="post-time small text-muted">1st December 2008 16:40 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Windows 2003 Server Standard SP1</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">xbarns</span><br><span class="post-time small text-muted">1st December 2008 16:43 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Windows 2003 Server Standard SP2</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">kichik</span><br><span class="post-time small text-muted">1st December 2008 22:34 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Thanks, all added and solved a bug with SP detection on Windows 98 thanks to it.<br><br>xbarns, are you sure the Windows 2003 SP1 data is correct? It says it's Windows XP SP1, client edition.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">xbarns</span><br><span class="post-time small text-muted">2nd December 2008 08:37 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Oops seems you are right, how about this one?</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">xbarns</span><br><span class="post-time small text-muted">2nd December 2008 08:38 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Now with attachment</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">xbarns</span><br><span class="post-time small text-muted">2nd December 2008 14:39 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Don't know if you need it but here is a<br><br>Windows 2003 Server (R2) SP2 x64</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">kichik</span><br><span class="post-time small text-muted">2nd December 2008 22:42 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Thanks, it works now. R2 is good too. Every test helps to make sure WinVer will never fail.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Pawel</span><br><span class="post-time small text-muted">17th May 2009 01:19 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Here is a test on windows 7 x64<br>I used that <a href="http://nsis.svn.sourceforge.net/viewvc/nsis/NSIS/trunk/Include/WinVer.nsh" target="_blank">http://nsis.svn.sourceforge.net/view...ude/WinVer.nsh</a> sources and winver.exe from this thread. Results are strange. I hope it is what it should be.<br>Here is a screenshot. In attachement the txt file, with text copied from test installer.<br><a href="http://shup.com/Shup/159882/winver_win7_64bit.png" target="_blank">http://shup.com/Shup/159882/winver_win7_64bit.png</a></p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">kichik</span><br><span class="post-time small text-muted">17th May 2009 08:59 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Thanks, says exactly what it should - 6.1.7100.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">jweinraub</span><br><span class="post-time small text-muted">5th June 2009 16:48 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>Windows 7 - x86 - RC1</strong><br>I hope this helps, installed on a Dell Latitude D830, x86, Windows 7, RC1</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">kichik</span><br><span class="post-time small text-muted">5th June 2009 19:01 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Thanks, added and works.<br><br>Anyone has 2008 R2?</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Yathosho</span><br><span class="post-time small text-muted">10th June 2009 19:23 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>Windows Server 2008 R2 x64 (Standard Edition, Build 7100)</strong><br>here you go!</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Yathosho</span><br><span class="post-time small text-muted">10th June 2009 20:34 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>ReactOS 0.3.9</strong><br>unfortunately i didn't get this as text-version and a brief ocr attempt failed.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">kichik</span><br><span class="post-time small text-muted">10th June 2009 20:36 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Can't use that to verify it's ReactOS. The version information says it's Windows 2003.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">dunkmark</span><br><span class="post-time small text-muted">26th August 2009 09:47 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>Windows 7 Enterprise x64</strong><br>Output from the winver test script. On windows 7 Enterprise x64 RTM.<br><br>Thanks<br><br>Mark<br><br>+++<br><br># OSVERSIONINFOEX<br>StrCpy $OSVERSIONINFOEX_RES 1<br>StrCpy $OSVERSIONINFOEX_CSD ""<br>StrCpy $OSVERSIONINFOEX_INIT "i 156, i 6, i 1, i 7600, i 2, &amp;t128 s, &amp;i2 0, &amp;i2 0, &amp;i2 256, &amp;i1 1, &amp;i1 0"<br># 9c0000000600000001000000b01d000002000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000 00000000000000000000000000000000000000000000000000000000010100<br><br># OSVERSIONINFO<br>StrCpy $OSVERSIONINFO_RES 1<br>StrCpy $OSVERSIONINFO_CSD ""<br>StrCpy $OSVERSIONINFO_INIT "i 148, i 6, i 1, i 7600, i 2, &amp;t128 s, &amp;i2 0, &amp;i2 0, &amp;i2 19720, &amp;i1 113, &amp;i1 0"<br># 940000000600000001000000b01d000002000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000 0000000000000000000000000000000000000000000000<br>Completed</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">kichik</span><br><span class="post-time small text-muted">26th August 2009 17:37 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Thanks, added and still works with RTM.</p></div><hr><div class="footer"><p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p></div></div><script src="../js/highlight.pack.js" type="text/javascript"></script><script type="text/javascript">//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]></script></body></html>