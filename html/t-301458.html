<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="description" content="Adding a button during the install process"><title>Adding a button during the install process - NSIS Forums</title><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script><link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css"><link rel="stylesheet" href="../css/style.css" type="text/css"><!--[if lt IE 9]><script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script><script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script><![endif]--></head><body><div class="container"><ol class="breadcrumb"><li><a href="../index.html" class="glyphicon glyphicon-home"></a></li><li><a href="f-65.html">NSIS Discussion</a></li><li class="active">Adding a button during the install process</li></ol><p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=301458">Adding a button during the install process</a></p><br><div class="post"><p class="post-meta"><span class="post-author text-primary">omeara55</span><br><span class="post-time small text-muted">27th December 2008 17:03 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>Adding a button during the install process</strong><br>Hey guys... I've searched the forums and NSIS wiki here and haven't been able to come up with an answer on this one, so hopefully a NSIS stud can help me out!<br><br>I'd like to add a button (a bitmap button to be specific) on the installing components screen (the MUI_PAGE_INSTFILES page). The goal is to have a button with an image saying something to the effect of "click here to go to our site and learn more" while the user is waiting for the installation to complete.<br><br>So although a InstallOptions::dialog approach can work using a custom page, it really it's a poor solution since users will blow right past it to get on with the installation process. The INSTFILES page is the perfect place to communicate with users since they're waiting for the installer to do its thing.<br><br>So far, I've tried editing the resource in modern.exe (adding a bitmap button), but the problem is that I need a way for NSIS to callback when that button is pressed. Where is the code that dispatches a button press to the action? I wasn't able to find a InstallOptions::dialog style call in MUI, so it's not even clear how I can catch my custom button press.<br><br>I've burned a ton of time trying to crack this one, so an elegant solution would be REALLY appreciated! Thanks in advance!!</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br><span class="post-time small text-muted">27th December 2008 17:05 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">You can add a standard button and use the ButtonEvent plug-in on it to open your site with ExecShell.<br><br>Stu</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">omeara55</span><br><span class="post-time small text-muted">27th December 2008 18:13 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Excellent, Stu -- that seems to be perfect!<br><br>Hrm, the only remaining puzzle is that all my attempts to set the button image aren't working. I'm using BS_BITMAP and then using the code:<br><br>FindWindow $0 "#32770" "" $HWNDPARENT<br>GetDlgItem $0 $0 2000<br>System::Call '${sysLoadImage} (0, s, ${IMAGE_BITMAP}, 0, 0, ${LR_CREATEDIBSECTION}|${LR_LOADFROMFILE}) .r6' "$1"<br>SendMessage $0 ${STM_SETIMAGE} ${IMAGE_BITMAP} $6<br>System::Call "${sysDeleteObject} (r6)"<br><br>Think there's ay way to make this image trick work? Thanks in advance, stu!<br><br><br><br></p><blockquote><i>Originally posted by Afrow UK</i><br><b>You can add a standard button and use the ButtonEvent plug-in on it to open your site with ExecShell.<br><br>Stu</b></blockquote></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br><span class="post-time small text-muted">27th December 2008 18:20 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Just to ensure there are no errors in that code, you could use the NSD_SetImage and NSD_FreeImage macros as described in the nsDialogs documentation.<br><br>Setting an image like this will not properly skin the button IIRC.<br><br>Stu</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">omeara55</span><br><span class="post-time small text-muted">27th December 2008 19:10 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Interesting... The issue with nsDialogs is that it doesn't seem to work with the NSIS standard INSTFILES page (in that nsDialogs assumes you want to make the page from scratch). Is there are a way to have nsDialogs add to the existing/current dialog? Otherwise, I'm not seeing the way one can use nsDialogs with an existing dialog (and it seems like it'd be a lot of work to implement the existing INSTFILES page using nsDialogs since it's tied to innate NSIS functionality).<br><br>Meanwhile, using BM_SETIMAGE instead of STM_SETIMAGE in that above code seems to cause the image to update inconsistently (sometimes it doesn't appear--it seems to depend on if the image gets obscured and needs to get refreshed). I know you mentioned this wasn't the way to go, but without a way to use nsDialogs in combination with the existing MUI_PAGE_INSTFILES, I'm not sure how to proceed.<br><br>Thanks again for you help, Stu -- I'll owe ya one if we can get this!</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br><span class="post-time small text-muted">27th December 2008 19:42 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Try destroying your bitmap in .onGUIEnd instead.<br><br>Stu</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">omeara55</span><br><span class="post-time small text-muted">27th December 2008 23:42 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Hah, that was it -- that image needs to stick around.<br><br>Very much thanks for your help, Stu! Very kind of you, and have a great holidays!<br><br>Cheers,<br>Andy</p></div><hr><div class="footer"><p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p></div></div><script src="../js/highlight.pack.js" type="text/javascript"></script><script type="text/javascript">//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]></script></body></html>