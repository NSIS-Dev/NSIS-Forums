<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="parsing txt file problem" />

  <title>parsing txt file problem - NSIS Forums</title><!-- Bootstrap core CSS -->
  <link rel="stylesheet" type="text/css" href="//netdna.bootstrapcdn.com/bootswatch/3.0.1/readable/bootstrap.min.css" />
  <link rel="stylesheet" href="../css/style.css" type="text/css" /><!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!--[if lt IE 9]>
                <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
                <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->
</head>

<body>
  <div class="container">
    <!-- Put navigation bar here -->

    <ol class="breadcrumb">
      <li><a href="../index.html" class="glyphicon glyphicon-home"></a></li>

      <li><a href="f-65.html">NSIS Discussion</a></li>

      <li class="active">parsing txt file problem</li>
    </ol>

    <p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=339316">parsing txt file problem</a></p><br />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">NOCaut</span><br />
      <span class="post-time small text-muted">13th December 2011 13:09 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>parsing txt file problem</strong><br />
      Please help parsing this file. greedy function did not help me.<br />
      <br /></p>

      <blockquote>
        === Logging started: 13.12.2011 13:39:00 ===<br />
        Action 13:39:00: INSTALL.<br />
        Action start 13:39:00: INSTALL.<br />
        === Logging started: 13.12.2011 13:39:00 ===<br />
        Action start 13:39:00: INSTALL.<br />
        Action start 13:39:00: FindRelatedProducts.<br />
        Action ended 13:39:00: FindRelatedProducts. Return value 0.<br />
        Action start 13:39:00: CA_SystemFolder_x86.3643236F_FC70_11D3_A536_0090278A1BB8.<br />
        Action ended 13:39:00: CA_SystemFolder_x86.3643236F_FC70_11D3_A536_0090278A1BB8. Return value 1.<br />
        Action start 13:39:00: CA_WindowsFolder_x86.3643236F_FC70_11D3_A536_0090278A1BB8.<br />
        Action ended 13:39:00: CA_WindowsFolder_x86.3643236F_FC70_11D3_A536_0090278A1BB8. Return value 1.<br />
        Action start 13:39:00: LaunchConditions.<br />
        Action ended 13:39:00: LaunchConditions. Return value 0.<br />
        Action start 13:39:00: AppSearch.<br />
        Action ended 13:39:00: AppSearch. Return value 1.
      </blockquote>i want check AppSearch 1 or 0
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">NOCaut</span><br />
      <span class="post-time small text-muted">13th December 2011 17:11 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"></p>

      <blockquote>
        Function Example7<br />
        MessageBox MB_OK $R9<br />
        StrCpy $0 StopLineFind<br />
        <br />
        Push $0<br />
        FunctionEnd<br />
        <br />
        Function .onInit<br />
        <br />
        ${LineFind} "C:\2.txt" "/NUL" "15:-15" "Example7"
      </blockquote>not help (
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">MSG</span><br />
      <span class="post-time small text-muted">13th December 2011 17:21 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Of course it doesn't help. You're telling it to start looking at line 15, and stop looking at line -15 (this means: 15 lines before the end of the file). If there are only 15 lines in the file, that ends up not looking at any line at all.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">NOCaut</span><br />
      <span class="post-time small text-muted">14th December 2011 08:09 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">please write example i not understand function return one sumbul<br />
      <br /></p>

      <blockquote>
        "15"<br />
        "1:-1"<br />
        "-1:1"<br />
        "-1:15"<br />
        "15:-1"
      </blockquote>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">MSG</span><br />
      <span class="post-time small text-muted">14th December 2011 08:17 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">There are examples in the manual: <a href="http://nsis.sourceforge.net/Docs/AppendixE.html#E.2.2" target="_blank">http://nsis.sourceforge.net/Docs/AppendixE.html#E.2.2</a><br />
      <br />
      The line range works like this: First number is the starting line, second number is the ending line. The function will search the file between those two lines. Obviously, if the ending line is before the starting line, no lines will be searched at all.<br />
      <br />
      Negative numbers simply mean: So many lines before the end of the file. So -1 is the last line, -2 is the line before that.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">NOCaut</span><br />
      <span class="post-time small text-muted">14th December 2011 08:21 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">problem in the text file function not work with this text!!!!! helps</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">MSG</span><br />
      <span class="post-time small text-muted">14th December 2011 08:54 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">"not work" doesn't mean anything.<br />
      <br />
      1. What did you try? (Hint: a small code example would help.)<br />
      2. What did you expect to happen?<br />
      3. What actually happened?<br />
      <br />
      This is the last time I'm going to explain to you how to ask a question. Next time, if you just say "HELP" without giving any information, I'm just going to ignore you.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">NOCaut</span><br />
      <span class="post-time small text-muted">14th December 2011 09:07 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">what? it is all my code!!! I repit: "function return one simbul 'a' or 't'"<br />
      <br />
      if i take file<br />
      <br />
      1.txt:<br /></p>

      <blockquote>
        111<br />
        222<br />
        333
      </blockquote>2.txt<br />
      <br />

      <blockquote>
        === Logging started: 13.12.2011 13:39:00 ===<br />
        Action 13:39:00: INSTALL.<br />
        Action start 13:39:00: INSTALL.<br />
        === Logging started: 13.12.2011 13:39:00 ===
      </blockquote>${LineFind} "C:\1.txt" "/NUL" "1:-1" "Example7" -function return "1111" - it is means -work!!<br />
      ${LineFind} "C:\2.txt" "/NUL" "1:-1" "Example7" -function return "a" - it is means -not work!!
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">MSG</span><br />
      <span class="post-time small text-muted">14th December 2011 09:20 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Stop shouting please. You are the one being unclear, not I.<br />
      <br />
      The syntax in your last post seems ok. If it works on one file but not another, this suggests that there is a problem opening the file. I suggest you pause the installer just before the linefind command using a MessageBox. Then first manually check whether or not the file exists, and what it contains. Then allow linefind to try and read it.<br />
      <br />
      Also, check the error flag.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">NOCaut</span><br />
      <span class="post-time small text-muted">14th December 2011 09:45 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"></p>

      <blockquote>
        ${LineFind} "C:\2.txt" "/NUL" "1:-1" "Example7"<br />
        IfErrors 0 +2<br />
        MessageBox MB_OK "Error"
      </blockquote>nothing
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">MSG</span><br />
      <span class="post-time small text-muted">16th December 2011 18:18 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Quoted from your other thread:<br /></p>

      <blockquote>
        <small>Originally posted by NOCaut</small><br />

        <blockquote>
          FileOpen $R4 "e:\vc_log.txt" r<br />
          StrCpy $R8 0<br />
          Top:<br />
          FileRead $R4 $R7<br />
          IntOp $R8 $R8 + 1
        </blockquote>MEssagebox MB_OK R7 ; return= a or t or 3....<br />
        <br />
        vc_log.txt:<br />
        === Logging started: 16.12.2011 18:17:49 ===<br />
        Action 18:17:49: INSTALL.<br />
        Action start 18:17:49: INSTALL.<br />
        === Logging started: 16.12.2011 18:17:49 ==<br />
        (etc...)
      </blockquote>First of all, there is no MessageBox command in the code you posted. I am going to assume that this is what you meant:<br />

      <blockquote>
        FileOpen $R4 "e:\vc_log.txt" r<br />
        StrCpy $R8 0<br />
        Top:<br />
        FileRead $R4 $R7<br />
        IntOp $R8 $R8 + 1<br />
        MEssagebox MB_OK R7 ; return= a or t or 3....
      </blockquote>My reply to this is the same as before: The syntax in your last post seems ok. If it works on one file but not another, this suggests that there is a problem opening the file. I suggest you pause the installer just before the linefind command using a MessageBox. Then first manually check whether or not the file exists, and what it contains. Then allow linefind to try and read it.
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">demiller9</span><br />
      <span class="post-time small text-muted">16th December 2011 21:45 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">It sounds to me like the file is Unicode encoded, but processing thinks it will be Ansi. The high part of the first unicode char looks like a null terminator, and the single character is the entire line.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">T.Slappy</span><br />
      <span class="post-time small text-muted">19th December 2011 05:35 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Writing simple C plug-in would solve all your problems.<br />
      There may be some catch in your text files [like Unicode format] which can be handled easily in C.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">NOCaut</span><br />
      <span class="post-time small text-muted">19th December 2011 08:25 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">messagebox before opened file not helped. i think problem in unicode</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">NOCaut</span><br />
      <span class="post-time small text-muted">23rd December 2011 09:13 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">I find problem. *.msi file return log file in unicode encoding. i take unicode file read function end all work good</p>
    </div>
    <hr />

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]>
  </script>
</body>
</html>
