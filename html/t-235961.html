<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="Launch Menu" />

  <title>Launch Menu - NSIS Forums</title>
  <script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script>
  <!-- Bootstrap core CSS -->

  <link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css" />
  <link rel="stylesheet" href="../css/style.css" type="text/css" /><!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!--[if lt IE 9]>
                <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
                <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->
</head>

<body>
  <div class="container">
    <!-- Put navigation bar here -->

    <ol class="breadcrumb">
      <li><a href="../index.html" class="glyphicon glyphicon-home"></a></li>

      <li><a href="f-65.html">NSIS Discussion</a></li>

      <li class="active">Launch Menu</li>
    </ol>

    <p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=235961">Launch Menu</a></p><br />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">rmccue</span><br />
      <span class="post-time small text-muted">20th January 2006 05:18 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>Launch Menu</strong><br />
      I'm trying to make a menu that on launch displays a list with some programs. The user can then add and delete the programs from the list. Each of the programs must have a link to launch the program.<br />
      How would I go about doing this?</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
      <span class="post-time small text-muted">20th January 2006 12:25 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">You can do that with the NOTIFY flag of InstallOptions. See Examples\InstallOptions\testnotify.nsi for an example. It has buttons on the page and it reacts to them.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">rmccue</span><br />
      <span class="post-time small text-muted">21st January 2006 03:47 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Thanks kichik!<br />
      works perfectly</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">rmccue</span><br />
      <span class="post-time small text-muted">21st January 2006 04:16 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Now, how would I get this to work with my idea?</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
      <span class="post-time small text-muted">21st January 2006 09:21 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">What exactly do you mean? Which part of your idea? What doesn't work for you?</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">rmccue</span><br />
      <span class="post-time small text-muted">22nd January 2006 00:50 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Sorry for confusing you.<br />
      I'll explain in pictures:<br />
      I want it to look like this:<br />
      ---------------------------------<br />
      | [New] [Remove] |<br />
      |--------------------------------<br />
      |App 1 |[Launch] |<br />
      |App 2 |[Launch] |<br />
      ...<br />
      <br />
      And when someone clicks the New button a popup comes up like this:<br />
      ---------------------------<br />
      |Display Name: [_________]|<br />
      |Path:[__________________]|<br />
      ---------------------------<br />
      Which adds it to the list.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Comperio</span><br />
      <span class="post-time small text-muted">22nd January 2006 21:17 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">In order to get a customized dialog with Display Name/Path, you'd probably have to use some type of plugin. (Unfortunately, I've not seen any such plugin that allows for dual inputs. The closest would be an input box plugin located at <a href="http://nsis.sourceforge.net/Dialog****plug-in." target="_blank">http://nsis.sourceforge.net/Dialog****plug-in.</a> )<br />
      <br />
      As for your list of programs, here's an idea:<br />
      Using InstallOptions, create a page containing a list box with buttons off the side for 'Launch', 'Add New', and remove. When the user highlights the application and clicks the 'launch' button, the appliction would launch. (Have a look at WinMessages.nsh for a list of supported commands. Info for the commands themselves can be obtained from msdn.microsoft.com.)<br />
      <br />
      However, keep in mind that anything added dynamically to an InstallOptions page doesn't update the INI file at runtime. This means you'd have to read the selected value of the list box using another SendMessage command.<br />
      <br />
      I've attached a screenshot of what the finished page might look like. (created using Eclipe's 'preview' function.)<br />
      <br />
      Please keep in mind that I offer these as suggestions only. I'll leave it up to you to do the hard work! ;)</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">rmccue</span><br />
      <span class="post-time small text-muted">23rd January 2006 07:25 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">OK instead of having a dialog<br />
      I will use a FileRequest box and a text box under the Add button. Any plugins I might need/want?</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">rmccue</span><br />
      <span class="post-time small text-muted">23rd January 2006 07:31 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">and also:<br />
      Is it possible to save the dynamically added objects to a INI?<br />
      What is WinMessages.nsh for?<br />
      Can't I just launch with a variable and Exec?<br />
      Thanks for your help</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Comperio</span><br />
      <span class="post-time small text-muted">23rd January 2006 15:51 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">WinMessages.nsh is a header that uses !defines to assign a hex value to a more 'meaningful' description. It's probably easier to see than explain. Open WinMessages.nsh located in ${NSISDIR}\include for an example and brief description. It's uses thoughout the examples included with NSIS.<br />
      <br />
      Here's an example of how I use list boxes:<br />
      1. Whenever I add an item to the list, I use a ReadIniStr command to write the same value to the page's INI file (ListItems). Use something like this in the page's leave function:<br /></p>
      <pre>
<code><br />; read the original value<br />   ReadIniStr $0 '$PLUGINSDIR\io_file.ini' 'Field 8' 'ListItems' <br />;$0 now contains the original string<br />; Next step is to add this to the list:<br />   ${WordAdd} $0 '|' '+StingToAdd' $R0 <br />; finally, add the full string back to the INI<br />   WriteIniStr '$PLUGINSDIR\swap_names.ini' 'Field 8' 'ListItems' $R0 <br /></code>
</pre><br />
      <br />
      To find out what the selected value is, just read the STATE value from the INI file during the page's leave function.<br />
      <br />
      To remove an item, use something like this:<br />
      <pre>
<code><br />;Find out what's selected:<br />   ReadIniStr $R1 '$PLUGINSDIR\swap_names.ini' 'Field 8' 'State'<br />; if nothing is selected, then error:<br />   StrCmp $R1 '' Jump_if_error 0<br />; get it's index:<br />   SendMessage $R9 ${LB_FINDSTRINGEXACT} -1 "STR:$R1" $R0<br />; now delete <br />;(note: $0 is a result var that is not used in this line):<br />   SendMessage $R9 ${LB_DELETESTRING} $R0 0 $0<br />; and don't forget INI file:<br />   ReadIniStr $R2 '$PLUGINSDIR\swap_names.ini' 'Field 8' 'ListItems'<br />   ${WordAdd} $R2 '|' '-$R1' $0<br />   WriteIniStr '$PLUGINSDIR\swap_names.ini' 'Field 8' 'ListItems' $0<br /><br />   Jump_if_error:<br />   MessageBox MB_OK "You didn't select anything to delete."<br />   abort<br /></code>
</pre><br />
      <br />
      Please be aware that the examples I provided were code snippits from one of my actual scripts so it may require some finessing to make it work in your script.
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">rmccue</span><br />
      <span class="post-time small text-muted">24th January 2006 07:15 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Thank you</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">rmccue</span><br />
      <span class="post-time small text-muted">26th January 2006 01:42 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">I get an error:<br />
      Invalid command: ${WordAdd}<br />
      Do I need to define this somewhere or what?</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Comperio</span><br />
      <span class="post-time small text-muted">26th January 2006 04:49 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Yes you do.<br />
      Its usage is explained in the help files, Appendix E ('Useful Headers').<br />
      <br />
      At the beginnig of your script, you must have the following 2 lines:<br />
      !include "WordFunc.nsh"<br />
      !insertmacro WordAdd</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">rmccue</span><br />
      <span class="post-time small text-muted">26th January 2006 06:37 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Thank you</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">rmccue</span><br />
      <span class="post-time small text-muted">28th January 2006 01:36 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">:( it doesn't work :(<br />
      OK could someone explain how to adapt <a href="http://nsis.sourceforge.net/ListBox_example" target="_blank">http://nsis.sourceforge.net/ListBox_example</a><br />
      ???<br />
      Thanks for the help so far</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">rmccue</span><br />
      <span class="post-time small text-muted">2nd February 2006 07:11 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Oh I already changed the end part to:<br />
      Exec '$R1'</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">rmccue</span><br />
      <span class="post-time small text-muted">5th February 2006 03:34 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">BTW your add section doesn't work with the ListBox example</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">rmccue</span><br />
      <span class="post-time small text-muted">5th February 2006 04:07 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Also, your sections only change the parts after a recompile.<br />
      How would I get it to change after each run</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Comperio</span><br />
      <span class="post-time small text-muted">5th February 2006 17:10 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"></p>

      <blockquote>
        Also, your sections only change the parts after a recompile.<br />
        How would I get it to change after each run
      </blockquote>I'm not sure what you mean by this.<br />
      <br />

      <blockquote>
        BTW your add section doesn't work with the ListBox example
      </blockquote>Like I said in my original post, my examples were just snippits (cut and paste) of a working install script and that you'd probably have to modify them to fit your needs.<br />
      <br />
      To better illustrate, I've posted a working example for you to look at.
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">rmccue</span><br />
      <span class="post-time small text-muted">6th February 2006 06:55 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Thanks. What I meant was the ListBox items only changed after a recompile of the script.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">rmccue</span><br />
      <span class="post-time small text-muted">6th February 2006 07:00 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">When I click [close] it says I must have a entry, but I already have.<br />
      This is basically the same as the one I have, but yours doesn't save to the file</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Comperio</span><br />
      <span class="post-time small text-muted">6th February 2006 14:51 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">My bad... I forgot to include the '.ini' at the end of my file name in the leave function. The correction is posted here.<br />
      <br />
      And I still don't understand your original question. The listbox is supposed to be blank each time. The idea is that the user adds things dynamically at runtime. If this is not what you want, then you'll need to modify the script, the ini file, or both to fit your needs.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">rmccue</span><br />
      <span class="post-time small text-muted">6th February 2006 21:30 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">I want it to save the items so when the program is started up again, it loads the items</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Comperio</span><br />
      <span class="post-time small text-muted">7th February 2006 03:39 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">If you want to save the listbox settings, then you'll need to either save the listitems value of Field 6 (using ReadIniStr, or make a copy of the page's ini before you exit the script. (placing it in .onInstSucess would be a good place)<br />
      <br />
      Then, simply modify your main script's .onInit function to return the value (or entire INI file, however you choose to do it) so that the values are there when the page displays.<br />
      <br />
      If you're having trouble, have a look at the docs and examples included with NSIS.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">rmccue</span><br />
      <span class="post-time small text-muted">7th February 2006 10:01 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">I put in onInit:<br /></p>
      <pre>
<code><br />FileOpen $0 menu.txt r<br />FileRead $0 $1<br />WriteINIStr "menu.ini" 'Field 4' 'ListItems' $1<br />FileClose $0<br /></code>
</pre><br />
      And in onInstSuccess:<br />
      <pre>
<code><br />ReadINIStr $R0 'menu.ini' 'Field 4' 'ListItems'<br />FileOpen $0 menu.txt w<br />FileWrite $0 $R0<br />FileClose $0<br /></code>
</pre><br />
      What you were thinking of?
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Comperio</span><br />
      <span class="post-time small text-muted">7th February 2006 22:32 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Your idea should work fine. (My other idea involved copying the entire INI from the $PLUGINSDIR in .onInstSucdss and then restoring it later in .onInit. Either way should work fine.)<br />
      <br />
      Just a few points:<br />
      1. Remember to use $PLUGINSDIR\menu.ini in the ReadIniStr and WriteIniStr calls since that were it will be at runtime. (Or, you can use MUI_INSTALLOPTIONS_READ and MUI_INSTALLOPTIONS_WRITE, in which case, you'd omit $PLUGINSDIR since it's appended automatically with those 2 macros.)<br />
      <br />
      2. Remember to initialize $PLUGINSDIR in .onInit before you try to write anything. MUI_INSTALLOPTIONS_EXTRACT does this for you, so insert your INI file code (above) AFTER this call and you'll be fine.<br />
      <br />
      3. Remember to read/write the proper fields. I noticed your example was Field 4, but in my posting, it was field 6. Without seeing your INI file, I'm not sure if your was a typo or if you just configured your INI file slightly different than my example.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">rmccue</span><br />
      <span class="post-time small text-muted">8th February 2006 07:27 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Yeah, my script is different.<br />
      Thanks for your help<br />
      Really appreciate it :-)</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">rmccue</span><br />
      <span class="post-time small text-muted">9th February 2006 09:28 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Is there a way to display say Xname but still have it open x:\b\t.jmd<br />
      for example</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Comperio</span><br />
      <span class="post-time small text-muted">9th February 2006 20:06 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">hmmm... An easy way might be to edit your page's INI file to include a section named Launch. Then in that section, define the name/real-value pairs. Like this:<br /></p>
      <pre>
<code><br />[LAUNCH]<br />Xname=x:\b\t.jmd<br /></code>
</pre><br />
      <br />
      This would allow you to keep all your unique names in one place, making it easier to keep track of in case you ever needed to update. Plus, you'd have just one file to keep track of.
    </div>
    <hr />

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]>
  </script>
</body>
</html>
