<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="description" content=".nsi Key?????"><title>.nsi Key????? - NSIS Forums</title><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script><link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css"><link rel="stylesheet" href="../css/style.css" type="text/css"><!--[if lt IE 9]><script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script><script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script><![endif]--></head><body><div class="container"><ol class="breadcrumb"><li><a href="../index.html" class="glyphicon glyphicon-home"></a></li><li><a href="f-65.html">NSIS Discussion</a></li><li class="active">.nsi Key?????</li></ol><p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=169015">.nsi Key?????</a></p><br><div class="post"><p class="post-meta"><span class="post-author text-primary">VegetaSan</span><br><span class="post-time small text-muted">11th February 2004 20:55 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>.nsi Key?????</strong><br>.nsi files will open with NotePad where can I find that key in the register<br><br>In wich of these map and where<br><br>-HKEY_CLASSES_ROOT<br>-HKEY_CURRENT_USER<br>-HKEY_LOCAL_MACHINE<br>-HKEY_USER<br>-HKEY_CURRENT_CONFIG<br><br>??? I allready looked but I cant find it<br><br>But I did found HKEY_CLASSES_ROOT\.nsi<br><br>But there is nothing in there. I have opend it with NotePad and it was not usefull????</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Joost Verburg</span><br><span class="post-time small text-muted">11th February 2004 20:56 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">.nsi is linked to NSIS.Script</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">VegetaSan</span><br><span class="post-time small text-muted">11th February 2004 21:19 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">I found it :) ..... But still a question :(<br><br>I want to have change the key in this map<br><br><font size="1">HKEY_USERS\S-1-5-21-1614895754-839522115-682003330-1003\Software\Microsoft\Windows\CurrentVersion\Explorer \FileExts\.ogm\OpenWithList</font><br><br>The Key Old Key :<br><br><font size="1">Windows Registry Editor Version 5.00<br><br>[HKEY_USERS\S-1-5-21-1614895754-839522115-682003330-1003\Software\Microsoft\Windows\CurrentVersion\Explorer\FileExts\.ogm]<br>"Progid"="mplayerXP.OGMFile"<br><br>[HKEY_USERS\S-1-5-21-1614895754-839522115-682003330-1003\Software\Microsoft\Windows\CurrentVersion\Explorer\FileExts\.ogm\OpenWithList]<br>"a"="wmplayer.exe"<br>"MRUList"="acdeb"<br>"b"="iexplorer.exe"<br>"c"="wmplayer.exe"<br>"d"="VirtualDubMod.exe"<br>"e"="VirtualDubMod.exe"<br>"f"="wmplayer.exe"<br><br>[HKEY_USERS\S-1-5-21-1614895754-839522115-682003330-1003\Software\Microsoft\Windows\CurrentVersion\Explorer\FileExts\.ogm\OpenWithProgids]<br>"ogm_auto_file"=hex(0):<br>"Ogg File (*.ogg)"=hex(0):<br>"OptionsFile"=hex(0):<br>"mplayerXP.OGMFile"=hex(0):<br>"mplayercXP.OGMFile"=hex(0):</font><br><br><br>The Key I want :<br><br><font size="1">Windows Registry Editor Version 5.00<br><br>[HKEY_USERS\S-1-5-21-1614895754-839522115-682003330-1003\Software\Microsoft\Windows\CurrentVersion\Explorer\FileExts\.ogm]<br>"Progid"="mplayerXP.OGMFile"<br><br>[HKEY_USERS\S-1-5-21-1614895754-839522115-682003330-1003\Software\Microsoft\Windows\CurrentVersion\Explorer\FileExts\.ogm\OpenWithList]<br>"a"="mplayercXP.exe"<br>"MRUList"="cadeb"<br>"b"="mplayercXP.exe"<br>"c"="mplayercXP.exe"<br>"d"="mplayercXP.exe"<br>"e"="mplayercXP.exe"<br><br>[HKEY_USERS\S-1-5-21-1614895754-839522115-682003330-1003\Software\Microsoft\Windows\CurrentVersion\Explorer\FileExts\.ogm\OpenWithProgids]<br>"ogm_auto_file"=hex(0):<br>"Ogg File (*.ogg)"=hex(0):<br>"OptionsFile"=hex(0):<br>"mplayerXP.OGMFile"=hex(0):<br>"mplayercXP.OGMFile"=hex(0):</font><br><br>Could somebody tell me how to change the key<br>THANKS, VegetaSan</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">rainmanp7</span><br><span class="post-time small text-muted">11th February 2004 21:25 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">this is not where you want to change<br>what will open with explorer and such<br><br>This key<br>HKEY_USERS\S-1-5-21-1614895754-839522115-682003330-1003<br><br>Changes per every machine<br><br>You want a differn't registry key<br><br>That's not the key your looking to change<br><br>or rather should not be looking to change.<br><br>You want a differn't registry key :)<br>"You don't want a small Coke you want a Large Coke."<br><br>can you give us a mre detailed example of what your trying to accomplish ?<br>This would help us better to help you.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">VegetaSan</span><br><span class="post-time small text-muted">11th February 2004 21:38 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Oke, I want the key in this map<br><br><font size="1">HKEY_USER\<br>S-1-5-21-1614895754-839522115-682003330-1003\a-S mpcXP\ogm.reg<br><br>I want to name the key "ogm.reg"<br><br>and I want to set a key in that map that contains register information to the .ogm extension to open with "mplayercXP.exe"<br>insted of "wmplayer.exe"<br></font><br><br>How Do I do that<br><br>Thanks, :)VegetaSan:)</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">rainmanp7</span><br><span class="post-time small text-muted">11th February 2004 22:56 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">you don't do it that way<br>you do it in the .exe<br>extention filed located in Hkey Classes Root<br>That's where the extentions exsist for the mapping of a type<br>of extention<br><br>so if i had say<br>.aif Extention and i needed it to open with media player<br><br>.aif<br>--[OpenWithList]<br>----|wmplayer.exe<br>--[OpenWithProgIds]<br>---&gt;AIFFFile REG_NONE<br>--[PersistentHandler]<br>--&gt;{098f2470-bae0-11cd-b579-08002b30bfeb}<br><br>or like this in the same registry area<br>Windows Registry Editor Version 5.00<br><br>[HKEY_CLASSES_ROOT\.ai]<br>"Content Type"="application/postscript"<br>@="PaintShopPro8.Image"<br><br>this makes the extention .ai open with PaintShopPro8<br><br>So write the section to the HKEY_CLASSES_ROOT area<br>and not the current user area<br><br>this way one type of extention can be opend by your installed application :)<br><br>but to get the current users infro from the registry and jump to the correct key at hand like the first proposed thing you asked about - as far as I know there is no complete way of Auto detecting the current ZONE<br>the special number of the current logged on user based in NSIS and windows<br>like $wininstall routine for installing directly to windows<br><br>as for the area that you were first writing to that area can also be um lets say Restricted and especially if the user is not administrator. and somtimes even if he or she is not Administrator<br><br>so writing to the top key is the safest bet of getting that extention installed and mapped to the program :)<br><br>I know how to do it in other programming languages<br>such as vb6 and C++ and others but the functionality as far as I know is not built into nsis as of yet.<br><br>I hope this helps ?<br>Mabey someone else can shed more light on this...<br><br>P.s. as for<br>"Could somebody tell me how to change the key"<br>writing back over the key changes it :)<br><br>Does this help ?<br>:igor:</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">VegetaSan</span><br><span class="post-time small text-muted">12th February 2004 06:33 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">But how do you insert a key with the nsis installer?<br><br>to HKEY_CLASSES_ROOT\.ogm<br><br>??</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">zarged</span><br><span class="post-time small text-muted">12th February 2004 09:00 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"></p><pre>
<code>WriteRegStr HKCR ".irc\Shell\open\command" "" "mirc.exe"</code>
</pre><br>Sets default key to mirc.exe<br><pre>
<code>WriteRegStr HKCR ".irc\Shell\open\command" "BackupCommand" "Pirch.exe"</code>
</pre><br>Sets the "BackupCommand" key to "Pirch.exe"<br><br>There are detailed instructions in the documentation as well as plenty of examples in the Examples directory too :)<br>There is also a function written which does this work for you.</div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">VegetaSan</span><br><span class="post-time small text-muted">12th February 2004 16:52 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">I have checked the .ogm in HKEY_CLASSES_ROOT<br><br><font size="1">[HKEY_LOCAL_MACHINE\SOFTWARE\Classes\.ogm\ShellEx\open\command]<br>@="mplayercXP.exe"<br>"C:\\Program Files\\a-S Media Player ClassicXP\\mplayercXP.exe"="mplayercXP.exe"</font><br><br>What is wrong with this?? :( It should be right!<br><br>If you see any errors in this piece of the Key please tell meI have checked the .ogm in HKEY_CLASSES_ROOT<br><br><font size="1">[HKEY_LOCAL_MACHINE\SOFTWARE\Classes\.ogm\ShellEx\open\command]<br>@="mplayercXP.exe"<br>"C:\\Program Files\\a-S Media Player ClassicXP\\mplayercXP.exe"="mplayercXP.exe"</font><br><br>What is wrong with this?? :( It should be right!<br><br>If you see any errors in this piece of the Key please tell me</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">VegetaSan</span><br><span class="post-time small text-muted">12th February 2004 16:55 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">sorry I have pasted it two times !</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">rainmanp7</span><br><span class="post-time small text-muted">12th February 2004 17:11 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">ok I had to do some registry stuff with my installer<br>and I ran into a regitry portion of my install that I can show you as a Example and it works ;)<br><br>WriteRegStr HKLM "SOFTWARE\Apache Group" "" ""<br>WriteRegStr HKLM "SOFTWARE\Apache Group\Apache" "" ""<br>WriteRegStr HKLM "SOFTWARE\Apache Group\Apache\2.0.48" "" ""<br>WriteRegStr HKLM "SOFTWARE\Apache Group\Apache\2.0.48" "ServerRoot" "$INSTDIR\Apache Group\Apache2\"<br>WriteRegDWORD HKLM "SOFTWARE\Apache Group\Apache\2.0.48" "Shared" "1"<br><br>By writing the key it actually creates the key<br>I think this can be done Automagicly as well :weird:<br><br>that's nsis registry coding<br>not the .reg exported stuff:igor:<br><br>From the code your showing me is a Registry export file .reg<br>[HKEY_LOCAL_MACHINE\SOFTWARE\Classes\.ogm\ShellEx\open\command]<br>@="mplayercXP.exe"<br>"C:\\Program Files\\a-S Media Player ClassicXP\\mplayercXP.exe"="mplayercXP.exe"<br><br>show us the Nsis code<br><br>Let me know if this helps :)<br><br>Don't always take the answer as the final solution because there may be more then 1 solution :)<br>try looking at<br>AUFile in HKLM<br>Somtimes more things need to be done to solve the solution<br>so if we can't show you an example ,we try to lead you in the right direction hopefully.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">VegetaSan</span><br><span class="post-time small text-muted">12th February 2004 20:36 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Could you be more specified .......<br>A Kinda like this<br><br>WriteRegStr HKLM "SOFTWARE\YOUR GROEP NAME" "" ""<br><br>Thanks, VegetaSan</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">VegetaSan</span><br><span class="post-time small text-muted">12th February 2004 20:49 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Oke I got that part, but now I want to insert a key to this map that contains register information to set .ogm files to open with "mplayercXP.exe"<br><br>How do I do that??<br><br>THX, VegetaSan</p></div><hr><div class="footer"><p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p></div></div><script src="../js/highlight.pack.js" type="text/javascript"></script><script type="text/javascript">//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]></script></body></html>