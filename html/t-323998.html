<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="ebanner - weird problem on some machines" />

  <title>ebanner - weird problem on some machines - NSIS Forums</title>
  <script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script>
  <!-- Bootstrap core CSS -->

  <link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css" />
  <link rel="stylesheet" href="../css/style.css" type="text/css" /><!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!--[if lt IE 9]>
                <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
                <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->
</head>

<body>
  <div class="container">
    <!-- Put navigation bar here -->

    <ol class="breadcrumb">
      <li><a href="../index.html" class="glyphicon glyphicon-home"></a></li>

      <li><a href="f-65.html">NSIS Discussion</a></li>

      <li class="active">ebanner - weird problem on some machines</li>
    </ol>

    <p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=323998">ebanner - weird problem on some machines</a></p><br />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">zivha</span><br />
      <span class="post-time small text-muted">12th November 2010 18:24 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>ebanner - weird problem on some machines</strong><br />
      Hello,<br />
      <br />
      I am struggling to figure out what is wrong with a simple piece of code. The code seems to run on most machines and different OS. On one machine it does not.<br />
      <br />
      I am using modern UI2 using custom dialog boxes. I need to display a logo on the right top corner of the dialog, the logo can change dynamically so I am creating it with ebanner.<br />
      <br />
      Here is the relevant snippet of code creating the dialog and placing the logo<br />
      <br />
      nsDialogs::Create 1018<br />
      Pop $Dialog<br />
      <br />
      ${NSD_CreateBitmap} -120 9u 120 80 ""<br />
      Pop $R0<br />
      ebanner::show /NOUNLOAD /HWND=$R0 /HALIGN=MIDDLE /VALIGN=MIDDLE "$TMP\logo.png"<br />
      <br />
      nsDialogs::Show<br />
      <br />
      I have two machines, both run Windows 7 64 bit, one one machine this code displays an empty dialog with the logo on the right top corner. On the other machine it displays an empty dialog, the logo is just not displayed.<br />
      <br />
      Any ideas??? struggling to figure out what is wrong with this piece of code...<br />
      <br />
      Thanks!</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">zivha</span><br />
      <span class="post-time small text-muted">13th November 2010 15:26 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Ok - after more digging and searching I found the following. eBanner uses IImgCtx COM interface to decode the PNG file. The machine on which ebanner fails also has IE9 beta installed, it seems that IE9 made some changes to this interface...<br />
      <br />
      now to figure out how to get around it, wish there was a plugin that included a decoder.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Wizou</span><br />
      <span class="post-time small text-muted">13th November 2010 17:53 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">The problem has been signaled to Microsoft : <a href="https://connect.microsoft.com/IE/feedback/details/611317/iimgctx-fails-to-draw-after-installing-ie9-beta" target="_blank">https://connect.microsoft.com/IE/fee...lling-ie9-beta</a><br />
      <br />
      It is not sure they will fix the problem.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Takhir</span><br />
      <span class="post-time small text-muted">13th November 2010 18:16 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Thanks, zivha, I could reproduce this problem after installing IE9.<br />
      I found one link with the same situation<br />
      <a href="http://social.msdn.microsoft.com/Forums/ru-RU/ieextensiondevelopment/thread/7b9a7426-0a2d-4cbc-ad90-f7b8c9a715ec" target="_blank">http://social.msdn.microsoft.com/For...0-f7b8c9a715ec</a><br />
      Probably this guy sent request to connect.microsoft.com as well but I could not find this.<br />
      In Codeproject IImg_Ctx comments (end of <a href="http://www.codeproject.com/KB/graphics/JianImgCtxDecoder.aspx" target="_blank">http://www.codeproject.com/KB/graphi...txDecoder.aspx</a> page, latest comment) you can find the same link as Wizou just published, but for me this link is unavailable. Fortunatelly comment includes reply from MS: "Apparently IE9 beta brings this component down, so all coders out there forget this stuff as soon as you can. And sorry for those who already used it in their projects, you're in big trouble. Remember, microsoft will always outplay you! And yes, this is officially confirmed by microsoft, look here: They are "surprised that it does not crash", very funny guys indeed."<br />
      May be it's to to use GDI+ ?...<br />
      After some googling: Oups, GDI+ may not work even on Vista...<br />
      If situation will be confirmed, the only 'all Win versions compatible' way I see is to use OleLoadPicture with 24-bit BMP or JPEG for 'dynamic' images. 7z compression is very good, so file size is not a problem.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Wizou</span><br />
      <span class="post-time small text-muted">13th November 2010 22:17 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">To view the URL, you need to register on connect.microsoft.com and demand access to product "IE".<br />
      It's free, quick and immediate.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">zivha</span><br />
      <span class="post-time small text-muted">14th November 2010 01:53 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Yeah guys, thanks for all the feedback.<br />
      <br />
      So I guess this means ebanner plugin should be deprecated and removed? it seems to no longer (or maybe never really did) work well anymore as it uses this interface.<br />
      <br />
      As for another solution, I would appreciate any help or ideas you have, how can one go about putting a PNG on a dialog if transparency support is important? I want the PNG backgroudn to match the dialog background and using transparency seems like the right way to go. Embedding a decoder would be big and troublesome. What is one to do?</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Takhir</span><br />
      <span class="post-time small text-muted">14th November 2010 08:34 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Wizou - thanks!<br />
      zivha - "(or maybe never really did)" - we had not any problems with this plug-in before IE9. BTW if you don't need 24-bit color, you can use AnimGif with static gif, if my memory doesn't fail me it supports transparency.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Wizou</span><br />
      <span class="post-time small text-muted">14th November 2010 17:05 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">(GIFs are 8-bit and transparency is only on/off, no blending)</p>
    </div>
    <hr />

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]>
  </script>
</body>
</html>
