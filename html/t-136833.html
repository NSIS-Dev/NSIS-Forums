<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="unload dll from memory" />

  <title>unload dll from memory - NSIS Forums</title>
  <script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script>
  <!-- Bootstrap core CSS -->

  <link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css" />
  <link rel="stylesheet" href="../css/style.css" type="text/css" /><!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!--[if lt IE 9]>
                <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
                <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->
</head>

<body>
  <div class="container">
    <!-- Put navigation bar here -->

    <ol class="breadcrumb">
      <li><a href="../index.html" class="glyphicon glyphicon-home"></a></li>

      <li><a href="f-65.html">NSIS Discussion</a></li>

      <li class="active">unload dll from memory</li>
    </ol>

    <p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=136833">unload dll from memory</a></p><br />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Brummelchen</span><br />
      <span class="post-time small text-muted">27th May 2003 22:03 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>unload dll from memory</strong><br />
      Hi<br />
      <br />
      2nd problem<br />
      <br />
      i have a dll here which is not a registered dll - any attempts to do so failed<br />
      <br />
      this dll is somewhere - not any system folder.<br />
      i made effort to replace it with the UnloadDLL script - the reboot option is offered.<br />
      <br />
      but when i try to delete this dll inc the folder i made no effort<br />
      <br />
      rmdir /rebootok does not work till now (2b3) - tried several solutions from this forum.<br />
      <br />
      UnRegDLL &lt;dll&gt; does not work either<br />
      <br />
      i can delete it with the wininit.ini (OS=XP) but the folder is not deleted yet.<br />
      <br />
      any hints?<br />
      <br />
      THX</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Joost Verburg</span><br />
      <span class="post-time small text-muted">27th May 2003 22:08 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Does it work if you put RMDir /REBOOTOK after UpgradeDLL?</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Brummelchen</span><br />
      <span class="post-time small text-muted">27th May 2003 22:24 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Hi Joost<br />
      <br />
      rmdir /rebootok causes error - must be rmdir /r :(</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
      <span class="post-time small text-muted">28th May 2003 13:04 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">To delete a file after reboot you should use Delete /REBOOTOK not RMDir /REBOOTOK. Use Delete /REBOOTOK on the file first and then RMDir /REBOOTOK on the folder containing the file, it should execute in the order you specify it.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Brummelchen</span><br />
      <span class="post-time small text-muted">28th May 2003 15:46 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">you are talking about the cvs?<br />
      cvs causes errors during compilation on my script while 2b3 does not</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
      <span class="post-time small text-muted">28th May 2003 15:50 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">RMDir /REBOOTOK is the only thing that depends on the latest CVS version, other things apply to b3 too.<br />
      <br />
      What errors do you get when you get the latest CVS version? If it's MUI errors then you should probably read the MUI readme again, define names and other things have changed. If not, attach the output of makensis.exe here and I'll have a look.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Brummelchen</span><br />
      <span class="post-time small text-muted">28th May 2003 21:51 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">2b3<br />
      !insertmacro MUI_SECTIONS_FINISHHEADER<br />
      <br />
      cvs<br />
      !insertmacro: MUI_SECTIONS_FINISHHEADER<br />
      !insertmacro: macro named "MUI_SECTIONS_FINISHHEADER" not found!<br />
      Error in script "setup.nsi" on line 182 -- aborting creation process<br />
      <br />
      i did not found any documentation :( or i have the wrong docs</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
      <span class="post-time small text-muted">28th May 2003 21:53 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">The documentation is in ${NSISDIR}\Contrib\Modern UI<br />
      <br />
      -Stu</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Brummelchen</span><br />
      <span class="post-time small text-muted">28th May 2003 22:04 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">readme.htm<br />
      Old Section "7. Insert the MUI_SECTIONS_FINISHHEADER macro"<br />
      is missing<br />
      <br />
      :hang:</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
      <span class="post-time small text-muted">29th May 2003 09:50 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">That's because you don't need MUI_SECTIONS_FINISHHEADER any more :)</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Brummelchen</span><br />
      <span class="post-time small text-muted">29th May 2003 15:14 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">@kichik<br />
      <br />
      thank you very much - i deleted it and put the new strings from MUI into.<br />
      <br />
      it is always strange to use something and then someones tells me i dont need it any longer ;)<br />
      <br />
      BTW the history file told me about nsis 2b4 - is this the cvs (loaded on 27th of mai) ?<br />
      <br />
      from my other posting - it went wrong there.<br />
      <br />
      ~~~8&lt;~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~<br />
      <br />
      i have a solution to my problem<br /></p>
      <pre>
<code>; Usage:<br />;  push dirname\dllname<br />;  call exchange<br /><br />Function exchange<br />  Exch $R1<br />  Push $R2<br />  Push $R3<br />  Push $R4<br />  ; $R1=oldname<br />  ; $R2=newname<br />  ; $R3=counter<br />  StrCpy $R3 0<br />  <br />  ;check first if deletable<br />  Delete $R1<br />  IfFileExists $R1 0 copy<br /><br />  loop:<br />    StrCpy $R2 $R1.$R3.tmp<br />    IfFileExists $R2 0 done<br />    IntOp $R3 $R3 + 1<br />    Goto loop<br /><br />  done:<br />  Rename $R1 $R2<br />  <br />  copy:<br />  ;file was found and renamed<br />  File "yourdll.dll"<br />  ;delete old TMP-files on next boot<br />  Delete /REBOOTOK "$INSTDIR\*.tmp"<br /><br />  Pop $R3<br />  Pop $R2<br />  Pop $R1<br />FunctionEnd<br /></code>
</pre><br />
      <br />
      another installer gave me that hint to rename that file, copy new file and delete old one on reboot.<br />
      i dont need the other script (UpgradeDLL.nsh]any longer :)<br />
      <br />
      Now it is a fine peace of work i finshed a couple of minutes ago WITH your help<br />
      <br />
      PS the function isnt perfect at all but it takes someone only a minute to make it 100% variable<br />
      <br />
      PPS some explanation:<br />
      the file that has to be replaced will be renamed to &lt;oldname.ext.counter.tmp&gt;<br />
      counter goes up from "0" to anywhere but it is quite impossible that someone has done this a million times<br />
      before renaming it is controlled if that file is not there otherwise counter=counter+1 and loop<br />
      TMP-files are deleted on reboot<br />
      <br />
      ~~~8&lt;~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    </div>
    <hr />

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]>
  </script>
</body>
</html>
