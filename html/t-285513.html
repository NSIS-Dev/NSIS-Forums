<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="Double cancel on custom page" />

  <title>Double cancel on custom page - NSIS Forums</title>
  <script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script>
  <!-- Bootstrap core CSS -->

  <link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css" />
  <link rel="stylesheet" href="../css/style.css" type="text/css" /><!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!--[if lt IE 9]>
                <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
                <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->
</head>

<body>
  <div class="container">
    <!-- Put navigation bar here -->

    <ol class="breadcrumb">
      <li><a href="../index.html" class="glyphicon glyphicon-home"></a></li>

      <li><a href="f-65.html">NSIS Discussion</a></li>

      <li class="active">Double cancel on custom page</li>
    </ol>

    <p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=285513">Double cancel on custom page</a></p><br />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">pcrowley</span><br />
      <span class="post-time small text-muted">23rd January 2008 16:35 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>Double cancel on custom page</strong><br />
      I have a simple custom page with a cancel button on it. Clicking the cancel button prompts the user if they really want to abort, just like normal. Clicking Yes returns to the custom page. Clicking the Cancel button again again prompts and then finally cancels.<br />
      <br />
      It is not getting into the Leave function for the page, I checked that. Very little customization has been done from a HMEdit-wizard created script.<br />
      <br />
      There is a custom function for UserAbort which when removed drops all prompting - you still need to click cancel twice.<br />
      <br />
      I've done a bunch of searching but I can't find anything about this.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Red Wine</span><br />
      <span class="post-time small text-muted">23rd January 2008 17:21 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Seems MUI_ABORTWARNING is defined, also seems you're checking the return value of the dialog.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">pcrowley</span><br />
      <span class="post-time small text-muted">23rd January 2008 19:48 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>Yes, but ....</strong><br />
      I've gone through a couple of iterations of this.<br />
      <br />
      There is a wizard-added UserAbort function that was referenced by MUI_CUSTOMFUNCTION_ABORT. What I have now is the following:<br />
      <br />
      ; MUI Settings<br />
      !define MUI_ABORTWARNING<br />
      ;!define MUI_CUSTOMFUNCTION_ABORT "UserAbort"<br />
      <br />
      I'm not checking any result from the custom page:<br />
      <br />
      Function DisplayCustomerInformation<br />
      StrCpy $REGSERIAL ""<br />
      StrCpy $REGEMAIL ""<br />
      !insertmacro MUI_HEADER_TEXT "Customer Information" "Customer Information"<br />
      !insertmacro MUI_INSTALLOPTIONS_DISPLAY "CustomerRegistration.ini"<br />
      Push $9<br />
      InstallOptions::dialog "$PLUGINSDIR\CustomerRegistration.ini"<br />
      Pop $9 ; must pop this back off the stack, it contains the last button clicked<br />
      <br />
      Return<br />
      FunctionEnd<br />
      <br />
      I put in a MessageBox after the Pop at the end of this to just say "Hi there" and it comes out after the SECOND cancel.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">pcrowley</span><br />
      <span class="post-time small text-muted">23rd January 2008 20:19 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>Just a thought here</strong><br />
      There is validation on this page with fields that must have content in them.<br />
      <br />
      Could this be the problem?</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
      <span class="post-time small text-muted">24th January 2008 12:58 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Remove that Return call. Shouldn't make any difference but you don't need it nonetheless.<br />
      <br />
      Stu</p>
    </div>
    <hr />

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]>
  </script>
</body>
</html>
