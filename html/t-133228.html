<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="description" content="Get &quot;My Documents&quot; Path"><title>Get "My Documents" Path - NSIS Forums</title><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script><link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css"><link rel="stylesheet" href="../css/style.css" type="text/css"><!--[if lt IE 9]><script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script><script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script><![endif]--></head><body><div class="container"><ol class="breadcrumb"><li><a href="../index.html" class="glyphicon glyphicon-home"></a></li><li><a href="f-65.html">NSIS Discussion</a></li><li class="active">Get "My Documents" Path</li></ol><p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=133228">Get "My Documents" Path</a></p><br><div class="post"><p class="post-meta"><span class="post-author text-primary">Joel</span><br><span class="post-time small text-muted">26th April 2003 16:52 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>Get "My Documents" Path</strong><br>I make this <a href="http://nsis.sourceforge.net/archive/nsisweb.php?page=260&amp;instances=0,11,211" target="_blank">web archive</a> to display<br>"My Documents" folder path.<br>I wanna know if is right for all Windos OS.<br>I try it in my XP Pro and it's ok.<br>Thanks</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">deguix</span><br><span class="post-time small text-muted">26th April 2003 18:21 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Works for me too (using Windows 98 Second Edition), show "C:\Meus Documentos\"!</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Joel</span><br><span class="post-time small text-muted">26th April 2003 18:56 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">thanks :up:</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">pengyou</span><br><span class="post-time small text-muted">26th April 2003 19:00 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">On my Windows 98 SE system the script does not work - the message box has no message inside.<br><br>My system's registry does not have the data your script is looking for, probably because my "My Documents" folder is not "C:\My Documents".</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">deguix</span><br><span class="post-time small text-muted">26th April 2003 19:12 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Your computer have more than one user, pengyou?</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">deguix</span><br><span class="post-time small text-muted">26th April 2003 19:25 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Lobo Lunar, change HKLM to HKCU to support multi-user "My Documents". (So will work for all computers that have more than one user). This code worked for me because my computer don't have more than one user.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">pengyou</span><br><span class="post-time small text-muted">26th April 2003 19:34 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">You were too quick for me, deguix! My computer only has one user but a password is used to log on, so perhaps that makes Windows use HKCU instead of HKLM.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">deguix</span><br><span class="post-time small text-muted">26th April 2003 19:42 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Your computer have two users, one is the default (if you click cancel in the log on window), and the second that you use. The HKLM code based only work if you click cancel. So is reccomended use the HKCU. In a version of my program (Registry Changer 2), I changed HKLM to HKCU, because someone had problems with the registry (like you) and worked for everyone! And another thing, the "My Documents" folder is different for each user, if select the option to have particular My Documents. So the user .DEFAULT (the computer) have one, and the user pengyou (in example) have other.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Joel</span><br><span class="post-time small text-muted">26th April 2003 19:43 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">fixed. Try it, please :)</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">deguix</span><br><span class="post-time small text-muted">26th April 2003 19:49 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">It works!</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Joel</span><br><span class="post-time small text-muted">26th April 2003 20:00 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">OK. :up: , and you pengyou?</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">pengyou</span><br><span class="post-time small text-muted">26th April 2003 23:20 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Yes, the revised version of the script works perfectly.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">kichik</span><br><span class="post-time small text-muted">27th April 2003 17:12 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">It is recommended you use both. First you should try HCKU and then try HKLM. This is how NSIS does this for the built-in folders.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Joost Verburg</span><br><span class="post-time small text-muted">27th December 2003 23:21 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">NSIS 2 RC1 has a constant for My Documents: $DOCUMENTS.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Joel</span><br><span class="post-time small text-muted">28th December 2003 02:08 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Cool :) :up:</p></div><hr><div class="footer"><p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p></div></div><script src="../js/highlight.pack.js" type="text/javascript"></script><script type="text/javascript">//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]></script></body></html>