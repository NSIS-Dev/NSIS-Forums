<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="Killing a process by PID" />

  <title>Killing a process by PID - NSIS Forums</title><!-- Bootstrap core CSS -->
  <link rel="stylesheet" type="text/css" href="//netdna.bootstrapcdn.com/bootswatch/3.0.1/readable/bootstrap.min.css" />
  <link rel="stylesheet" href="../css/style.css" type="text/css" /><!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!--[if lt IE 9]>
                <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
                <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->
</head>

<body>
  <div class="container">
    <!-- Put navigation bar here -->

    <ol class="breadcrumb">
      <li><a href="../index.html" class="glyphicon glyphicon-home"></a></li>

      <li><a href="f-65.html">NSIS Discussion</a></li>

      <li class="active">Killing a process by PID</li>
    </ol>

    <p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=302352">Killing a process by PID</a></p><br />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Ivan Andreevich</span><br />
      <span class="post-time small text-muted">23rd January 2009 01:12 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>Killing a process by PID</strong><br />
      There seem to be 4 plugins for process destruction -<br />
      1) <a href="http://nsis.sourceforge.net/Processes_plug-in" target="_blank">http://nsis.sourceforge.net/Processes_plug-in</a><br />
      2) <a href="http://nsis.sourceforge.net/NsProcess_plugin" target="_blank">http://nsis.sourceforge.net/NsProcess_plugin</a><br />
      3) <a href="http://nsis.sourceforge.net/KillProc_plug-in" target="_blank">http://nsis.sourceforge.net/KillProc_plug-in</a><br />
      4) <a href="http://nsis.sourceforge.net/KillProcDLL_plug-in" target="_blank">http://nsis.sourceforge.net/KillProcDLL_plug-in</a><br />
      <br />
      Did I miss any?<br />
      <br />
      However, none of these have an option of killing a process by PID (process id). Is there a way to do this without modifying an existing plugin?<br />
      <br />
      Thanks,<br />
      Ivan</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
      <span class="post-time small text-muted">23rd January 2009 11:06 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">I don't know of any plug-in that would allow you to do that. I have to wonder though, why would you want to do that? In some point, you have to get that PID by its name. Why not use the name again?</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Anders</span><br />
      <span class="post-time small text-muted">23rd January 2009 12:04 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">thats not 100% true, some unix ported stuff put their pid in a textfile on startup. Or maybe you just had a HWND and wanted to kill its process</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Ivan Andreevich</span><br />
      <span class="post-time small text-muted">23rd January 2009 18:10 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"></p>

      <blockquote>
        <i>Originally posted by kichik</i><br />
        I don't know of any plug-in that would allow you to do that. I have to wonder though, why would you want to do that? In some point, you have to get that PID by its name. Why not use the name again?
      </blockquote>I install and uninstall a DLL. Sometimes that DLL is in use by mmc.exe. However, that can be many things, and I just want to kill the ones using it and leave the other ones.<br />
      <br />
      So far my best bet I found so far is <a href="http://www.tech-recipes.com/rx/446/xp_kill_windows_process_command_line_taskkill/" target="_blank">http://www.tech-recipes.com/rx/446/x...line_taskkill/</a> via nsExec
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
      <span class="post-time small text-muted">23rd January 2009 18:39 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">That could be so dangerous... You could find yourself killing an important system service. You should use the <a href="http://nsis.sourceforge.net/LockedList_plug-in" target="_blank">LockedList plug-in</a> instead and let the user exit those programs.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">LoRd_MuldeR</span><br />
      <span class="post-time small text-muted">23rd January 2009 18:46 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">If you just want to kill a process by PID, you can simply call the TerminateProcess function, which is part of the Win32 API, using the NSIS System Plugin:<br />
      * <a href="http://msdn.microsoft.com/en-us/library/ms686714(VS.85).aspx" target="_blank">http://msdn.microsoft.com/en-us/libr...14(VS.85).aspx</a><br />
      * <a href="http://nsis.sourceforge.net/Docs/System/System.html" target="_blank">http://nsis.sourceforge.net/Docs/System/System.html</a><br />
      <br />
      No need for a special plugin. But as mentioned already, this is dangerous, if you did not obtain the PID of the target process properly. Processes tend to have different PID's each run ;)</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Ivan Andreevich</span><br />
      <span class="post-time small text-muted">23rd January 2009 18:59 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"></p>

      <blockquote>
        <i>Originally posted by kichik</i><br />
        <b>That could be so dangerous... You could find yourself killing an important system service. You should use the <a href="http://nsis.sourceforge.net/LockedList_plug-in" target="_blank">LockedList plug-in</a> instead and let the user exit those programs.</b>
      </blockquote>That plugin is AWESOME, thanks for pointing it out for me! I will use it for a regular installation.<br />
      <br />
      However, the other part of my installation must happen unattended on a remote machine. So I still need to kill processes by PID.
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">LoRd_MuldeR</span><br />
      <span class="post-time small text-muted">23rd January 2009 19:38 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">If you need to terminate a service, use "net.exe stop &lt;service_name&gt;" instead of killing a process by PID. Even if you obtained the PID by process name, your service most likely is running in "svchost.exe", so you'd have to kill ALL instances of svchost.exe. Unfortunately this way you will kill many important system services, as several services can run in one process. And you even can't now which instance of "svchost.exe" does contain YOUR service...<br />
      <br />
      Also note that LockedList can work in a "silent" way !!!<br />
      <br /></p>
      <pre>
<code>  LockedList::AddCaption /NOUNLOAD "*Chrome"<br />  LockedList::AddCaption /NOUNLOAD "*Chromium"<br />  LockedList::AddModule /NOUNLOAD "$EXEDIR\chrome.exe"<br />  LockedList::AddModule /NOUNLOAD "$EXEDIR\chrome.dll"<br />  LockedList::AddModule /NOUNLOAD "$EXEDIR\icudt38.dll"<br />  LockedList::AddModule /NOUNLOAD "$EXEDIR\themes\default.dll"<br />  LockedList::AddModule /NOUNLOAD "$EXEDIR\plugins\gears\gears.dll"<br />  LockedList::SilentSearch</code>
</pre>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Ivan Andreevich</span><br />
      <span class="post-time small text-muted">23rd January 2009 20:18 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"></p>

      <blockquote>
        <i>Originally posted by LoRd_MuldeR</i><br />
        <b>If you need to terminate a service, use "net.exe stop &lt;service_name&gt;" instead of killing a process by PID. Even if you obtained the PID by process name, your service most likely is running in "svchost.exe", so you'd have to kill ALL instances of svchost.exe. Unfortunately this way you will kill many important system services, as several services can run in one process. And you even can't now which instance of "svchost.exe" does contain YOUR service...<br />
        <br />
        Also note that LockedList can work in a "silent" way !!!<br />
        <br /></b>
        <pre>
<b><code>  LockedList::AddCaption /NOUNLOAD "*Chrome"<br />  LockedList::AddCaption /NOUNLOAD "*Chromium"<br />  LockedList::AddModule /NOUNLOAD "$EXEDIR\chrome.exe"<br />  LockedList::AddModule /NOUNLOAD "$EXEDIR\chrome.dll"<br />  LockedList::AddModule /NOUNLOAD "$EXEDIR\icudt38.dll"<br />  LockedList::AddModule /NOUNLOAD "$EXEDIR\themes\default.dll"<br />  LockedList::AddModule /NOUNLOAD "$EXEDIR\plugins\gears\gears.dll"<br />  LockedList::SilentSearch</code></b>
</pre>
      </blockquote>Yeap, noticed the silent way. Not sure if it fulfills all my req's, but I'll give it a shot.<br />
      <br />
      I obtain the PIDs of the processes using my dll via <a href="http://www.tech-recipes.com/rx/679/xp_tasklist_get_list_processes_command_line/" target="_blank">http://www.tech-recipes.com/rx/679/x..._command_line/</a><br />
      <pre>
<code>tasklist /m name.dll</code>
</pre><br />
      <br />
      After that I can kill by PID selectively. It's not supposed to always work - i.e. if my DLL is used over network, it's svchost.exe and I cannot terminate it. However, I do want a best effort solution.
    </div>
    <hr />

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]>
  </script>
</body>
</html>
