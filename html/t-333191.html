<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="Windows 7 Uninstall Registry Entries" />

  <title>Windows 7 Uninstall Registry Entries - NSIS Forums</title>
  <script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script>
  <!-- Bootstrap core CSS -->

  <link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css" />
  <link rel="stylesheet" href="../css/style.css" type="text/css" /><!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!--[if lt IE 9]>
                <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
                <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->
</head>

<body>
  <div class="container">
    <!-- Put navigation bar here -->

    <ol class="breadcrumb">
      <li><a href="../index.html" class="glyphicon glyphicon-home"></a></li>

      <li><a href="f-65.html">NSIS Discussion</a></li>

      <li class="active">Windows 7 Uninstall Registry Entries</li>
    </ol>

    <p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=333191">Windows 7 Uninstall Registry Entries</a></p><br />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Ron.Stordahl</span><br />
      <span class="post-time small text-muted">4th August 2011 19:23 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>Windows 7 Uninstall Registry Entries</strong><br />
      I am updating an installer for XP to include Vista/Windows 7. Currently, in XP, I set in the registry:<br />
      <br />
      WriteRegStr HKLM "${PRODUCT_DIR_REGKEY}" "" "$INSTDIR\BPQ32.exe"<br />
      <br />
      WriteRegStr HKLM "${PRODUCT_UNINST_KEY}" "UninstallString" "$INSTDIR\uninst.exe". As well as similar entries for "DisplayIcon", "Publisher" etc.<br />
      <br />
      Should these be changed to HKCU for Vista/Windows 7 installs. I do need to use HKCU as opposed to HKLM for other non-install related registry entries in Windows 7, such as paths to application data, etc.<br />
      <br />
      The application is 32 bit if that matters.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">MSG</span><br />
      <span class="post-time small text-muted">4th August 2011 20:04 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">If you're elevating your install (that is, requiring admin access), you shouldn't be using HKCU at all, because they'll end up in the admin's reghive, not the user's. (It's true that on Vista/7 this might actually be the same user, but that's not guaranteed.)<br />
      If on the other hand you don't elevate, you cannot use HKLM at all because you need admin access to write there.<br />
      <br />
      So, long story short: In almost all cases you shouldn't be writing to both HKLM and HKCU. It's either one or the other: HKLM for admin-level installers, HKCU for user-level installers.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Ron.Stordahl</span><br />
      <span class="post-time small text-muted">5th August 2011 00:04 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">That is good info. The entries I quoted are as far as I understand needed so that the control panel uninstall program list will include my application. I doubt it is actually necessary as I have the uninstall link in the program list, however good practice is to do as I have suggested.<br />
      <br />
      So I will use HKCU for all and not mix the two.<br />
      <br />
      Thanks for the informative response...I am just learning about W7!</p>
    </div>
    <hr />

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]>
  </script>
</body>
</html>
