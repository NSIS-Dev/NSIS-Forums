<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="Windows XP ExecWait a program with admin rights" />

  <title>Windows XP ExecWait a program with admin rights - NSIS Forums</title>
  <script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script>
  <!-- Bootstrap core CSS -->

  <link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css" />
  <link rel="stylesheet" href="../css/style.css" type="text/css" /><!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!--[if lt IE 9]>
                <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
                <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->
</head>

<body>
  <div class="container">
    <!-- Put navigation bar here -->

    <ol class="breadcrumb">
      <li><a href="../index.html" class="glyphicon glyphicon-home"></a></li>

      <li><a href="f-65.html">NSIS Discussion</a></li>

      <li class="active">Windows XP ExecWait a program with admin rights</li>
    </ol>

    <p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=287227">Windows XP ExecWait a program with admin rights</a></p><br />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">jlanza</span><br />
      <span class="post-time small text-muted">19th February 2008 23:25 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>Windows XP ExecWait a program with admin rights</strong><br />
      In Windows XP as a limited user I want to be able to run a custom exe and wait for it to finish as admin. The exe I want to run is a custom legacy uninstaller I have coded up. I have accomplished this in Vista with the manifest via RequestExecutionLevel Admin. However in XP there is no elevation dialog that pops up and the custom uninstaller is unable to remove files from program files and the registry. Does anyone have any solution? Any help would be greatly appreciated! Thanks!</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Anders</span><br />
      <span class="post-time small text-muted">20th February 2008 00:12 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">you could call ShellExecuteEx with the runas verb and some flag to keep the process handle open(can't remember its exact name ATM, check MSDN), then just wait for that handle, you could use the system plugin for this or write your own</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">jlanza</span><br />
      <span class="post-time small text-muted">20th February 2008 15:51 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Thank you this method worked great.<br />
      <br />
      Is there a way to do the same thing in Windows Vista from a limited account where UAC is disabled? I want to run as admin dialog to come up and it wont because it is ignoring my manifest.</p>
    </div>
    <hr />

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]>
  </script>
</body>
</html>
