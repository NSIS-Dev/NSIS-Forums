<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="description" content="C-style comment problem"><title>C-style comment problem - NSIS Forums</title><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script><link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css"><link rel="stylesheet" href="../css/style.css" type="text/css"><!--[if lt IE 9]><script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script><script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script><![endif]--></head><body><div class="container"><ol class="breadcrumb"><li><a href="../index.html" class="glyphicon glyphicon-home"></a></li><li><a href="f-65.html">NSIS Discussion</a></li><li class="active">C-style comment problem</li></ol><p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=228202">C-style comment problem</a></p><br><div class="post"><p class="post-meta"><span class="post-author text-primary">iceman_k</span><br><span class="post-time small text-muted">12th October 2005 00:23 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>C-style comment problem</strong><br>Not sure if this has been reported before.<br>I found that putting a complete C-style comment in a line skips everything preceding the comment in the line.<br>This doesn't seem to be intuitively correct.<br>See the attached script for an example.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">kichik</span><br><span class="post-time small text-muted">12th October 2005 12:27 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Do you want to take a shot at it?</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">iceman_k</span><br><span class="post-time small text-muted">12th October 2005 12:44 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">I can try.<br>IMHO what should be done is that any tokens after the comment should be added to tokens before the comment.<br>e.g.,<br><br></p><pre>
<code><br>MessageBox MB_OK /* comment */ "Hello"<br></code>
</pre><br>
      <br>
      should effectively become<br>
      <br>
      <pre>
<code><br>MessageBox MB_OK "Hello"<br></code>
</pre><br>
      <br>
      Let me see if I can put together a patch.
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">iceman_k</span><br>
      <span class="post-time small text-muted">12th October 2005 15:34 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">I have submitted a <a href="http://sourceforge.net/tracker/index.php?func=detail&amp;aid=1324898&amp;group_id=22049&amp;atid=373087" target="_blank">patch</a> for this.<br>
      I have tested it on a few scripts and it seems to be working OK. Give it a whirl and see if it is acceptable.</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Joel</span><br>
      <span class="post-time small text-muted">12th October 2005 16:57 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">What about C++'s <b>//</b>? :)</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">iceman_k</span><br>
      <span class="post-time small text-muted">12th October 2005 17:02 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Not part of the NSIS spec, sorry. :D</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br>
      <span class="post-time small text-muted">15th October 2005 14:53 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Are you going to commit the first patch?</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">iceman_k</span><br>
      <span class="post-time small text-muted">15th October 2005 16:22 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Sure, if you want me to.<br>
      I thought you might want to test it before I commit it.</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br>
      <span class="post-time small text-muted">15th October 2005 16:29 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Take a look at the bug tracker, I've replied there.</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">iceman_k</span><br>
      <span class="post-time small text-muted">15th October 2005 17:14 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">I have a question for you in the bug tracker- please take a look.</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br>
      <span class="post-time small text-muted">15th October 2005 17:25 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">You should get an e-mail for each change to the item in the tracker. If you don't, hit the monitor button again and make sure the e-mail address you gave SourceForge is working.</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">iceman_k</span><br>
      <span class="post-time small text-muted">15th October 2005 18:36 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">I usually do get emails. Your first reply to the patch wasn't emailed to me. Since then all replies have been emailed to me.</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">JasonFriday13</span><br>
      <span class="post-time small text-muted">18th October 2005 00:49 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">I was also wondering if you could put in // to comment a line.<br>
      It gets a little annoying when you swap from a C\C++ IDE to nsis script and forget that nsis dosen't support //.</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">iceman_k</span><br>
      <span class="post-time small text-muted">18th October 2005 01:32 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">I suppose you could always create a feature request. But I don't think it will be a very high priority.</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Anders</span><br>
      <span class="post-time small text-muted">21st November 2005 20:30 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">I was just playing around and I think I found a bug (unless I did someting stupid)<br>
      <br>
      The compiler is executing the code inside my /**/ comment<br>
      It only seems to happen with include files</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br>
      <span class="post-time small text-muted">24th November 2005 20:14 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">This is not related to this patch. The preprocessor comes before the comment handling, so !ifdef will always be handled. That's why your code is invalid. !ifdef doesn't have enough parameters.</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Anders</span><br>
      <span class="post-time small text-muted">25th November 2005 10:36 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">yeah, i know its missing a parameter, but it seems wrong to me that a comment only comments out real commands, IMHO the comments must be parsed out first</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br>
      <span class="post-time small text-muted">25th November 2005 11:53 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Ignore my last comment. Multiple line comments should be treated inside ifdef'ed blocks, just like normal comments. I've fixed this and add a test case to make sure it doesn't come back.<br>
      <br>
      Here's a stripped down version of the script showing the problem:</p>
      <pre>
<code>!ifdef some_define_that_doesnt_exist<br>/*<br>!ifdef<br>*/<br>!endif</code>
</pre>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">iceman_k</span><br>
      <span class="post-time small text-muted">25th November 2005 12:53 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Yeah, I always wondered why !ifdef processing worked the way it did.<br>
      I did run into the same problem as Anders but I assumed that preprocessor commands trumped comments.</p>
    </div>
    <hr>

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]></script></body></html>