<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="description" content="Uninstall and Add/Remove Programs"><title>Uninstall and Add/Remove Programs - NSIS Forums</title><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script><link rel="preload" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css" as="style" onload="this.rel='stylesheet'"><link rel="preload" href="../css/style.css" as="style" onload="this.rel='stylesheet'"><noscript><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css"><link rel="stylesheet" href="../css/style.css"></noscript><script>!function(a){"use strict";var b=function(b,c,d){function e(a){return h.body?a():void setTimeout(function(){e(a)})}function f(){i.addEventListener&&i.removeEventListener("load",f),i.media=d||"all"}var g,h=a.document,i=h.createElement("link");if(c)g=c;else{var j=(h.body||h.getElementsByTagName("head")[0]).childNodes;g=j[j.length-1]}var k=h.styleSheets;i.rel="stylesheet",i.href=b,i.media="only x",e(function(){g.parentNode.insertBefore(i,c?g:g.nextSibling)});var l=function(a){for(var b=i.href,c=k.length;c--;)if(k[c].href===b)return a();setTimeout(function(){l(a)})};return i.addEventListener&&i.addEventListener("load",f),i.onloadcssdefined=l,l(f),i};"undefined"!=typeof exports?exports.loadCSS=b:a.loadCSS=b}("undefined"!=typeof global?global:this);!function(a){if(a.loadCSS){var b=loadCSS.relpreload={};if(b.support=function(){try{return a.document.createElement("link").relList.supports("preload")}catch(b){return!1}},b.poly=function(){for(var b=a.document.getElementsByTagName("link"),c=0;c<b.length;c++){var d=b[c];"preload"===d.rel&&"style"===d.getAttribute("as")&&(a.loadCSS(d.href,d,d.getAttribute("media")),d.rel=null)}},!b.support()){b.poly();var c=a.setInterval(b.poly,300);a.addEventListener&&a.addEventListener("load",function(){b.poly(),a.clearInterval(c)}),a.attachEvent&&a.attachEvent("onload",function(){a.clearInterval(c)})}}}(this);</script></head><body><div class="container"><ol class="breadcrumb"><li><a href="../index.html" class="glyphicon glyphicon-home"></a></li><li><a href="f-65.html">NSIS Discussion</a></li><li class="active">Uninstall and Add/Remove Programs</li></ol><p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=129899">Uninstall and Add/Remove Programs</a></p><br><div class="post"><p class="post-meta"><span class="post-author text-primary">vpoptom</span><br><span class="post-time small text-muted">27th March 2003 07:34 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>Uninstall and Add/Remove Programs</strong><br>My uninstaller is quite simple and works great if it is called directly. But if I access it via Add/Remove Programs, it still works but it freezes the Add/Remove Programs window. I am using ExecWait in the un.onUninstSuccess function to fire up Internet Explorer with a specific URL after the uninstaller completes. If I remove that portion, all works fine. And again, it works fine if called directly, even with the ExecWait call. But that bloody Add/Remove Programs window freezes up on me if I launch IE at the end.<br><br>UPDATE:<br>Here is the basic uninstall instruction:<br><br>Section "Uninstall"<br>call "un.CloseIE" ; Kill all running IE's<br>UNRegDLL "$INSTDIR\my.dll"<br>DeleteRegKey HKLM Software\Microsoft\Windows\CurrentVersion\Uninstall\MyProg"<br>DeleteRegKey HKLM SOFTWARE\MyProg"<br>SectionEnd<br><br>Function "un.onUninstSuccess"<br>ExecWait "$PROGRAMFILES\Internet Eplorer\iexplore.exe <a href="http://www.me.com" target="_blank">http://www.me.com</a>"<br>FunctionEnd<br><br><br>Uninstall occurring on WinXP and built using NSIS v1.9<br><br>Any suggestions?<br>Thanks,<br>-tom</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">kichik</span><br><span class="post-time small text-muted">27th March 2003 13:02 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">If you are using ExecWait the installer will wait until you close the Internet Explorer window and so will the add/remove control panel as it's waiting for the installer. You should use ExecWait "open" "http://www.me.com". This command will not make the installer freeze and will call the user's default browser which will be a bit nicer then forcing him to use IE. If you want to force IE use Exec instead of ExecWait, it should work too.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">vpoptom</span><br><span class="post-time small text-muted">27th March 2003 16:26 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">I couldn't get ExecWait "open" to work and simply using Exec was causing the same problem. But I did find a solution based on your answer:<br><br>ExecShell open "http://www.me.com"<br><br>It indeed opens the user's default browser but that is a better way to go.<br><br>Thank you very much!<br><br>-tom</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">kichik</span><br><span class="post-time small text-muted">27th March 2003 16:36 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Heh, meant ExecShell :)</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">jdt2oo7</span><br><span class="post-time small text-muted">13th January 2010 01:04 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">I ran into the same issue. I just created a sample script to verify the solution posted on this thread, but it doesn't allow me to do anything until I close the internet browser (this was on XP).<br><br>On Vista, I click on another application under Add/Remove window then select to uninstall. A message "Please wait until the current program is finished..." is displayed.<br><br>===<br><br>Function un.onUninstSuccess<br>HideWindow<br>ExecShell open "http://www.yahoo.com"<br>FunctionEnd</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Anders</span><br><span class="post-time small text-muted">13th January 2010 02:03 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">as usual, blame MS for this, they are using a job object to wait for all child processes started by the main uninstaller<br><br>To work around it, try <a href="http://nsis.sourceforge.net/Escape_ARP_Job_With_New_Process" target="_blank">http://nsis.sourceforge.net/Escape_A...th_New_Process</a> but I think the name of the job object has changed, so you might have to use Process Explorer to find the name and adapt the code</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">jdt2oo7</span><br><span class="post-time small text-muted">13th January 2010 20:09 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Hi Anders,<br><br>I have no idea "the name of the job object" that you mention. What should I look for using Process Explorer? Thank for your help!</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Anders</span><br><span class="post-time small text-muted">13th January 2010 22:34 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">The lower pane, it should be listed as a handle (there is also a job tab in the properties for the process, not sure if the name is listed there)</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">jdt2oo7</span><br><span class="post-time small text-muted">17th January 2010 08:22 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Don't see it with Process Explorer.<br>The name of the job object should be "ARP Job", I see that in the function. Another forum also says that:<br><br><a href="http://community.flexerasoftware.com/showthread.php?t=181670" target="_blank">http://community.flexerasoftware.com...d.php?t=181670</a><br><br>Anyone has any idea why it's not working?</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Anders</span><br><span class="post-time small text-muted">17th January 2010 10:08 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Well, either the job name is wrong, or the security for the object is locked down (To find the job object, you look for the handle in the lower pane for the add/remove process, not "your" process)<br><br>The other option is to use a out of process COM object, that way you don't have to deal with job objects at all (But you would have to register this COM object etc)</p></div><hr><div class="footer"><p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p></div></div><script type="text/javascript" src="../js/highlight.pack.js" async></script><script type="text/javascript">//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]></script></body></html>