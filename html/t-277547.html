<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="description" content="Removing Reg keys on uninstall with Vista"><title>Removing Reg keys on uninstall with Vista - NSIS Forums</title><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script><link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css"><link rel="stylesheet" href="../css/style.css" type="text/css"></head><body><div class="container"><ol class="breadcrumb"><li><a href="../index.html" class="glyphicon glyphicon-home"></a></li><li><a href="f-65.html">NSIS Discussion</a></li><li class="active">Removing Reg keys on uninstall with Vista</li></ol><p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=277547">Removing Reg keys on uninstall with Vista</a></p><br><div class="post"><p class="post-meta"><span class="post-author text-primary">SolemnSolitary</span><br><span class="post-time small text-muted">19th September 2007 09:44 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>Removing Reg keys on uninstall with Vista</strong><br>Hi<br>I'm hoping someone can help me here, I'm very new to Nsis and just trying to edit an installer so it will now support Vista as well as XP but have run into a problem. With my XP installer it seems to work fine when removing a reg key for a context menu ive added but with vista it wont remove the context menu item aka not removing the reg key. have anyone had this probelm before maybe?<br><br>Code:<br><br>Install<br>WriteRegStr HKLM "Software\CLASSES\*\shell" "" ""<br>WriteRegStr HKLM "Software\CLASSES\*\shell\AIToolkit" "" ""<br>WriteRegStr HKLM "Software\CLASSES\*\shell\AIToolkit\command" "" "$\"${INSTDIR}\AIToolkit.exe$\" $\"%L$\" $\"context$\""<br><br>Uninstall<br>DeleteRegValue HKLM "Software\CLASSES\*\shell\AIToolkit" "command"<br>DeleteRegValue HKLM "Software\CLASSES\*\shell" "AIToolkit"<br><br><br>Thanks!!!</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Anders</span><br><span class="post-time small text-muted">19th September 2007 10:36 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">try<br><br>DeleteRegKey HKLM "Software\CLASSES\*\shell\AIToolkit"</p></div><hr><div class="footer"><p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p></div></div><script src="../js/highlight.pack.js" type="text/javascript"></script><script type="text/javascript">//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]></script></body></html>