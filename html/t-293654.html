<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="nsis installer with dev/qa/prod config settings" />

  <title>nsis installer with dev/qa/prod config settings - NSIS Forums</title>
  <script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script>
  <!-- Bootstrap core CSS -->

  <link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css" />
  <link rel="stylesheet" href="../css/style.css" type="text/css" /><!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!--[if lt IE 9]>
                <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
                <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->
</head>

<body>
  <div class="container">
    <!-- Put navigation bar here -->

    <ol class="breadcrumb">
      <li><a href="../index.html" class="glyphicon glyphicon-home"></a></li>

      <li><a href="f-65.html">NSIS Discussion</a></li>

      <li class="active">nsis installer with dev/qa/prod config settings</li>
    </ol>

    <p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=293654">nsis installer with dev/qa/prod config settings</a></p><br />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">msureshkr</span><br />
      <span class="post-time small text-muted">26th June 2008 18:24 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>nsis installer with dev/qa/prod config settings</strong><br />
      Hi,<br />
      After successful install, I would like to launch an url but I don't want to hard code the production url inside the installer.<br />
      Is there a way we can have a external config file where nsis can read during the installation?<br />
      Thanks<br />
      Suresh M</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
      <span class="post-time small text-muted">26th June 2008 19:00 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Yes of course. Use ReadINIStr, ConfigRead or FileRead etc<br />
      <br />
      Stu</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">msureshkr</span><br />
      <span class="post-time small text-muted">26th June 2008 19:08 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Thanks for your reply. So, I have to deploy the config file as part of the installer and read the settings on successful installation, right?<br />
      I also launch an url on end of uninstall or install failed, in this case we may not have the config file. How to handle this?<br />
      thanks again<br />
      Suresh M</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Red Wine</span><br />
      <span class="post-time small text-muted">26th June 2008 19:28 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"></p>

      <blockquote>
        I also launch an url on end of uninstall or install failed, in this case we may not have the config file. How to handle this?
      </blockquote>Use functions un.onUninstSuccess and .onUserAbort/.onInstFailed respectively .
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">msureshkr</span><br />
      <span class="post-time small text-muted">26th June 2008 19:34 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Thanks Red Wine. That was not my question, I already do that. My question is if config file gets removed during uninstall or failed to install, how can I use ConfigRead?</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Red Wine</span><br />
      <span class="post-time small text-muted">26th June 2008 19:48 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">The url could be stored in a definition I guess, I can't see the point of reading the url from an external file.<br />
      Anyway, simply exclude the config.cfg or whatever is the name from the uninstall list.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">msureshkr</span><br />
      <span class="post-time small text-muted">26th June 2008 21:06 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">ok may be I didnt explain it well. Let me try again.<br />
      I create an installer with the url defined in the installer script, say <a href="http://qa.server.com." target="_blank">http://qa.server.com.</a><br />
      QA team tests the installer and wants to deploy to production. Instead of creating the installer again with the production url "http://prod.server.com", we want to release the installer tested in qa (thats what we should do, right)<br />
      Thats why I want to externalize the config settings out of the installer, so we can deploy in various stages (qa, staging, production) etc.,<br />
      I am not sure I understand config.cfg, if you could send me any documentation, I would appreciate it.<br />
      thanks a lot</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Red Wine</span><br />
      <span class="post-time small text-muted">26th June 2008 21:48 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Config.cfg is just a random name for the external configuration file.<br />
      So, you could also copy it into $PLUGINSDIR as first action of the installer/uninstaller and read the values from there.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">LoRd_MuldeR</span><br />
      <span class="post-time small text-muted">26th June 2008 21:52 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Well, you can either have the URL hardcoded in your installer or you can load it from an external file at runtime. In the latter case your installer will depend on the external file. So it will fail if the external file was deleted, moved, renamed or never installed. The only way to overcome this dependency (and of course the preferred way) is having the URL hardcoded in the installer itself. So the best way is having the URL implemented as a define in your installer script and passing it via commandline to the MakeNSIS compiler. After your QA team has verified your installer, you re-compile that installer with the 100% identical install script. So they won't have to re-validate it. You only change the URL passed to the compiler via commandline...<br />
      <br /></p>
      <pre>
<code>!ifndef MY_URL<br />  !error "URL not specified, aborting compilation!"<br />!endif<br /><br />...<br /><br />Section MySection<br />  ExecShell "open" "${MY_URL}"<br />SectionEnd</code>
</pre>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">msureshkr</span><br />
      <span class="post-time small text-muted">26th June 2008 21:59 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Thanks guys.<br />
      Lord_Mulder,<br />
      It makes sense to have url encoded in the installer. I do agree with you about the external file dependency. I will implement the recompiling command line options.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
      <span class="post-time small text-muted">26th June 2008 23:08 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Pass it via command-line like so:<br />
      <br />
      makensis /DMY_URL="http://..." script.nsi<br />
      <br />
      Stu</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">msureshkr</span><br />
      <span class="post-time small text-muted">27th June 2008 22:56 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Thanks Afrow.</p>
    </div>
    <hr />

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]>
  </script>
</body>
</html>
