<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="description" content="Problem with OS seeing PATH change"><title>Problem with OS seeing PATH change - NSIS Forums</title><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script><link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css"><link rel="stylesheet" href="../css/style.css" type="text/css"><!--[if lt IE 9]><script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script><script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script><![endif]--></head><body><div class="container"><ol class="breadcrumb"><li><a href="../index.html" class="glyphicon glyphicon-home"></a></li><li><a href="f-65.html">NSIS Discussion</a></li><li class="active">Problem with OS seeing PATH change</li></ol><p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=173800">Problem with OS seeing PATH change</a></p><br><div class="post"><p class="post-meta"><span class="post-author text-primary">justjer</span><br><span class="post-time small text-muted">18th March 2004 05:20 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>Problem with OS seeing PATH change</strong><br>I'm having a problem where Windows 2000 does not recognize a path change when I'm using the typical path manipulation scripts in the archive or when using pathman.exe. Both make the call to the OS to refresh its environment, but when my script executes something that should be in the path it fails.<br><br>I'm wondering if, when setting the path within a function, the section that calls the function does not see the new environment/path.<br><br>My code looks something like this<br></p><pre>
<code><br>SubSection Splat<br><br>  Section Woo<br>    Call InstPerl<br>    nsExec::ExecToLog 'Perl "$EXEDIR\Scripts\AutoInst.pl"'<br>  SectionEnd<br><br>  Section Hoo<br>    blah blah...<br>  SectionEnd<br><br>SubSectionEnd<br><br>Function InstPerl<br>  ExecWait 'msiexec.exe /i "$EXEDIR\ActivePerl.msi" /l*v C:\SUlogs\Perl.log /qb'<br>  Push "C:\Perl\Bin"<br>  Call AddToPath  ; Same as Path Manip scripts in NSIS Archive<br>  ;Alternatively, I've tried the following<br>  ;nsExec::ExecToLog '"$EXEDIR\UTILS\pathman" /as "C:\Perl\Bin"'<br>FunctionEnd<br></code>
</pre><br>
      <br>
      Thanks in advance to anyone who can shed some light on this. =)
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Joost Verburg</span><br>
      <span class="post-time small text-muted">18th March 2004 14:31 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Did you reboot your system?</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br>
      <span class="post-time small text-muted">18th March 2004 17:42 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Use this one instead:<br>
      <br>
      <a href="http://nsis.sourceforge.net/archive/viewpage.php?pageid=161" target="_blank">http://nsis.sourceforge.net/archive/...php?pageid=161</a><br>
      <br>
      Make sure you call it before you execute that application.</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">justjer</span><br>
      <span class="post-time small text-muted">19th March 2004 04:22 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">setenv.dll did not work<br>
      <br>
      I need this to work without rebooting the system. My issue is the the line "nsExec::ExecToLog 'Perl "$EXEDIR\Scripts\AutoInst.pl"'" will not execute unless C:\Perl\Bin is in the path. I know I can work around this in several ways, but I need the path to work while the installer is running.</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br>
      <span class="post-time small text-muted">19th March 2004 13:00 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">SetEnv.dll works fine for me. For example:</p>
      <pre>
<code>ReadEnvStr $R0 "PATH" <br>StrCpy $R0 "$R0;F:\Perl\Bin" <br>SetEnv::SetEnvVar "PATH" $R0<br>nsExec::ExecToLog `perl.exe -e "print 'hello world';"`<br>Pop $0 # return value/error/timeout<br>DetailPrint ""<br>DetailPrint "       Return value: $0"<br>DetailPrint ""</code>
</pre>Attach your complete script for testing.
    </div>
    <hr>

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]></script></body></html>