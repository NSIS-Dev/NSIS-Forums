<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="Extract Files from an NSIS EXE" />

  <title>Extract Files from an NSIS EXE - NSIS Forums</title>
  <script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script>
  <!-- Bootstrap core CSS -->

  <link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css" />
  <link rel="stylesheet" href="../css/style.css" type="text/css" /><!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!--[if lt IE 9]>
                <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
                <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->
</head>

<body>
  <div class="container">
    <!-- Put navigation bar here -->

    <ol class="breadcrumb">
      <li><a href="../index.html" class="glyphicon glyphicon-home"></a></li>

      <li><a href="f-65.html">NSIS Discussion</a></li>

      <li class="active">Extract Files from an NSIS EXE</li>
    </ol>

    <p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=189493">Extract Files from an NSIS EXE</a></p><br />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Taymiya</span><br />
      <span class="post-time small text-muted">10th August 2004 10:03 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>Extract Files from an NSIS EXE</strong><br />
      Hello there,<br />
      <br />
      I created an installer for my application using NSIS. Now, I am trying to write code which can exctract all the files which are inside the Installation exe file, without actually going through the installation. (You don't want to know why, trust me :) )<br />
      <br />
      Is this possible?<br />
      Has anyone done it before?<br />
      Can anyone provide me with any pointers or hints that could make my task easier?<br />
      <br />
      Thanks a great deal,</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">flizebogen</span><br />
      <span class="post-time small text-muted">10th August 2004 11:50 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Try this Code:<br />
      <br />
      You can extract every File using the word "developer" as a parameter<br />
      <br /></p>
      <pre>
<code><br /><br />Function GetParameters<br />  Push $0<br />  Push $1<br />  Push $2<br />  StrCpy $0 $CMDLINE 1<br />  StrCpy $1 '"'<br />  StrCpy $2 1<br />  StrCmp $0 '"' loop<br />    StrCpy $1 ' '<br />  loop:<br />    StrCpy $0 $CMDLINE 1 $2<br />    StrCmp $0 $1 loop2<br />    StrCmp $0 "" loop2<br />    IntOp $2 $2 + 1<br />    Goto loop<br />  loop2:<br />    IntOp $2 $2 + 1<br />    StrCpy $0 $CMDLINE 1 $2<br />    StrCmp $0 " " loop2<br />  StrCpy $0 $CMDLINE "" $2<br />  Pop $2<br />  Pop $1<br />  Exch $0<br />FunctionEnd<br /><br /><br />Function .onInit<br /> Call GetParameters<br />  Pop $1<br />  StrCmp $1 "/info"           MSGBOX_DOKU<br />  StrCmp $1 "info"            MSGBOX_DOKU<br />  StrCmp $1 "about"           MSGBOX_DOKU<br />  StrCmp $1 "/about"                  MSGBOX_DOKU<br />  StrCmp $1 "/?"              MSGBOX_DOKU<br />  StrCmp $1 "/help"           MSGBOX_DOKU<br />  StrCmp $1 "help"            MSGBOX_DOKU<br />  StrCmp $1 "developer"       DEVELOPER<br />  StrCmp $1 ""                                INIT_ENDE<br />  MessageBox MB_OK|MB_ICONINFORMATION "Parameter: '$1' is not valid. Program will terminate."<br />  Goto ENDE<br />MSGBOX_DOKU:<br />MessageBox MB_OK|MB_ICONINFORMATION \<br />"Installation of ${Name} with the following Features$\n $\r\<br /> - Created with  NSIS ${NSIS_VERSION}$\n $\r\<br /> - ... $\n $\r\"<br />ENDE:<br />Abort<br />DEVELOPER:<br />MessageBox MB_ICONINFORMATION|MB_YESNO "All Files in this Setup\<br />will be extracted to ${TEMP}. Do you Want to Proceed?" IDNO ENDE<br />CreateDirectory "$TEMP\${__FILE__}"<br />SetOutPath "$TEMP\${__FILE__}"<br />File /r "*.*"<br />Goto ENDE<br />INIT_ENDE:<br />FunctionEnd</code>
</pre>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Taymiya</span><br />
      <span class="post-time small text-muted">10th August 2004 16:49 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Thanks flizebogen :)</p>
    </div>
    <hr />

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]>
  </script>
</body>
</html>
