<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="ChDir missing? (Working directory / CurDir)" />

  <title>ChDir missing? (Working directory / CurDir) - NSIS Forums</title>
  <script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script>
  <!-- Bootstrap core CSS -->

  <link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css" />
  <link rel="stylesheet" href="../css/style.css" type="text/css" /><!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!--[if lt IE 9]>
                <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
                <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->
</head>

<body>
  <div class="container">
    <!-- Put navigation bar here -->

    <ol class="breadcrumb">
      <li><a href="../index.html" class="glyphicon glyphicon-home"></a></li>

      <li><a href="f-65.html">NSIS Discussion</a></li>

      <li class="active">ChDir missing? (Working directory / CurDir)</li>
    </ol>

    <p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=312276">ChDir missing? (Working directory / CurDir)</a></p><br />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">stb</span><br />
      <span class="post-time small text-muted">13th September 2009 20:39 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>ChDir missing? (Working directory / CurDir)</strong><br />
      Seems there is no built-in way of setting the current working directory (for installer process). Just copying a value to $OUTDIR does not work. I didn't try SetOutPath since this will create a directory (if missing) and maybe it just sets $OUTDIR, too.<br />
      <br />
      I want to set the current working directory to something specific so I can use commands like FileOpen with relative paths. If the directory is missing the original working directory is a valid fallback.<br />
      <br />
      Ideas?</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">jpderuiter</span><br />
      <span class="post-time small text-muted">13th September 2009 21:19 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">To set the working directory you have to use SetOutPath indeed.<br />
      If you want to prevent the folder to be created, you have to check if the folder exists, and if not, SetOutPath to the original working directory.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">stb</span><br />
      <span class="post-time small text-muted">13th September 2009 21:44 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Ok, seems that SetOutPath sets $OUTDIR, creates that directory if missing _and_ changes current working dir to that directory.<br />
      <br />
      BTW: $OUTDIR is initially empty. Might need an API call to get the working directory at script start (GetCurrentDirectory).</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">jpderuiter</span><br />
      <span class="post-time small text-muted">14th September 2009 00:09 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Yes, you will need GetCurrentDirectory:<br />
      <a href="http://forums.winamp.com/showthread.php?postid=1973815" target="_blank">http://forums.winamp.com/showthread.php?postid=1973815</a></p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">stb</span><br />
      <span class="post-time small text-muted">14th September 2009 06:31 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">I just found some note in documentation of "Rename":<br />
      <br />
      "If no absolute path is specified the current folder will be used. The current folder is the folder set using the last SetOutPath instruction. If you have not used SetOutPath the current folder is $EXEDIR."<br />
      <br />
      I think something like this would be useful at documentation for $OUTDIR and especially SetOutPath. And it might be wrong since the working directory and $EXEDIR are generally NOT the same before using SetOutPath. So if "current folder" means the working directory the documentation is wrong.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">stb</span><br />
      <span class="post-time small text-muted">14th September 2009 06:38 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Documentation for "FileOpen" has same comment, "RegDll" similar. Docs for "Exec", "ExecShell" and "CreateShortCut" should say what the working directory is if $OUTDIR is still empty.<br />
      <br />
      The notion "current directory" is used for "File", too. But I guess this means the current working directory of makensis/makensisw process. This is not the working directory when starting makensis/makensisw but is the directory of the nsi file getting compiled.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">pengyou</span><br />
      <span class="post-time small text-muted">14th September 2009 13:54 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">To get the current working directory I use</p>
      <pre>
<code> GetFullPathName $WORKING_DIR ".\"<br /></code>
</pre>
    </div>
    <hr />

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]>
  </script>
</body>
</html>
