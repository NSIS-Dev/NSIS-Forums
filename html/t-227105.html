<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="description" content="Process in ExecWait reboots"><title>Process in ExecWait reboots - NSIS Forums</title><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script><link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css"><link rel="stylesheet" href="../css/style.css" type="text/css"></head><body><div class="container"><ol class="breadcrumb"><li><a href="../index.html" class="glyphicon glyphicon-home"></a></li><li><a href="f-65.html">NSIS Discussion</a></li><li class="active">Process in ExecWait reboots</li></ol><p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=227105">Process in ExecWait reboots</a></p><br><div class="post"><p class="post-meta"><span class="post-author text-primary">madden</span><br><span class="post-time small text-muted">28th September 2005 00:48 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>Process in ExecWait reboots</strong><br>Hello<br><br>I'm a new user of NSIS.<br>I need to redistribute Windows Common Controls, SHFolder.dll, Microsft Data Access Components and a few others.<br><br>Problem is, to install these, I have to Exec some installers from Microsoft (madc_typ.exe, 50comupd.exe, SHFolder.exe) that in turn will install the components. This is the documented way to redistribute the .dlls and this is how I have to deploy them.<br><br>Now any of these can potentialy reboot the computer, and I have to install all of them.<br><br>I found somewhere on these pages that NSIS denies WM_QUERYENDSESSION requests from Windows while it is installing.<br><br>Is this in the help file, I mean is this behaviour documented so that I can count on it ? Is it enough and a safe method so that I can create my installer ?<br><br>If the installer is silent does the installer still do the job ?<br><br>Can I have makensis.exe output an installer that could interrupt an installation to allow for a reboot at ExecWait and then continue or something like this ?<br><br>How can I ExecWait a proces that reboots ?<br><br>Thank you<br>Adrian Constantin<br>Romania</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">kichik</span><br><span class="post-time small text-muted">30th September 2005 12:16 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Microsoft installers usually accept a switch that prevents a reboot. <a href="http://unattended.sourceforge.net/installers.php" target="_blank">Unattended</a> contains information about this switches.<br><br>As for NSIS, the <a href="http://nsis.sourceforge.net/Docs/AppendixF.html" target="_blank">change log</a> says WM_QUERYENDSESSION is denied since 2.02. As you've guessed, this isn't done in a silent installer because there's no window to receive messages.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">madden</span><br><span class="post-time small text-muted">30th September 2005 14:25 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">I wish there would be a better way.<br><br>Excelent list of Install Systems though.<br><br>Now that I think of it, I've seen setups that could reboot and continue. Do you know of any Install System that would let me do such an installer ?</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">kichik</span><br><span class="post-time small text-muted">30th September 2005 14:28 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Why would you want to stop the installer for every reboot? It's a much more pleasant user experience to have just one reboot.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">madden</span><br><span class="post-time small text-muted">30th September 2005 22:06 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Because I want to install 50comupd.exe (comctl32.dll 5.8 from Microsoft) and that one will reboot (with user's permision) on old win versions. Same for MDAC (mdac_typ.exe) and SHFolder.dll (SHFolder.exe)<br><br>Besides, if comctl32.dll v5.8 is waiting for a reboot to be installed than many of my dll's may not be registered if they are staticaly linked to it. LoadLibrary called from regsrv32.exe (or directly form the NSIS installer that registers my dll) will see the old comctl32 still in use on the user system and will fail (because my dll will not link to the old comctl).<br><br>And I also need to start my executable after install to register a new service in Control Panel and my executable may need any of the installed files currently waiting for a reboot if it staticaly links to them. Actualy for my executable to start in any way instalation must be complete and all .dlls updated and registered.<br><br>Fortunately IS appears to 'magicaly' redistribute MDAC and comctl32 without several reboots, but I am afraid it does nothing more than repackaging, and Microsoft doesn't actualy allow this for it's redists.<br><br>Can NSIS execute 'ExecWait' after a reboot, as it can execute 'File' and 'Delete' ?<br><br>Timothy Madden<br>Romania</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">kichik</span><br><span class="post-time small text-muted">30th September 2005 23:06 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">With the information on the link I've posted, you can make the installers silent and deny reboot.<br><br>In the latest version of NSIS, the Library macro will delay registration of DLLs until reboot, if the reboot flag is set. You can check the return value of the installers and set the reboot flag accordingly.</p></div><hr><div class="footer"><p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p></div></div><script src="../js/highlight.pack.js" type="text/javascript"></script><script type="text/javascript">//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]></script></body></html>