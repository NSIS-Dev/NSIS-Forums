<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="description" content="Detect .NET Compact Framework using NSIS Script"><title>Detect .NET Compact Framework using NSIS Script - NSIS Forums</title><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script><link rel="preload" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css" as="style" onload="this.rel='stylesheet'"><link rel="preload" href="../css/style.css" as="style" onload="this.rel='stylesheet'"><noscript><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css"><link rel="stylesheet" href="../css/style.css"></noscript><script>!function(a){"use strict";var b=function(b,c,d){function e(a){return h.body?a():void setTimeout(function(){e(a)})}function f(){i.addEventListener&&i.removeEventListener("load",f),i.media=d||"all"}var g,h=a.document,i=h.createElement("link");if(c)g=c;else{var j=(h.body||h.getElementsByTagName("head")[0]).childNodes;g=j[j.length-1]}var k=h.styleSheets;i.rel="stylesheet",i.href=b,i.media="only x",e(function(){g.parentNode.insertBefore(i,c?g:g.nextSibling)});var l=function(a){for(var b=i.href,c=k.length;c--;)if(k[c].href===b)return a();setTimeout(function(){l(a)})};return i.addEventListener&&i.addEventListener("load",f),i.onloadcssdefined=l,l(f),i};"undefined"!=typeof exports?exports.loadCSS=b:a.loadCSS=b}("undefined"!=typeof global?global:this);!function(a){if(a.loadCSS){var b=loadCSS.relpreload={};if(b.support=function(){try{return a.document.createElement("link").relList.supports("preload")}catch(b){return!1}},b.poly=function(){for(var b=a.document.getElementsByTagName("link"),c=0;c<b.length;c++){var d=b[c];"preload"===d.rel&&"style"===d.getAttribute("as")&&(a.loadCSS(d.href,d,d.getAttribute("media")),d.rel=null)}},!b.support()){b.poly();var c=a.setInterval(b.poly,300);a.addEventListener&&a.addEventListener("load",function(){b.poly(),a.clearInterval(c)}),a.attachEvent&&a.attachEvent("onload",function(){a.clearInterval(c)})}}}(this);</script></head><body><div class="container"><ol class="breadcrumb"><li><a href="../index.html" class="glyphicon glyphicon-home"></a></li><li><a href="f-65.html">NSIS Discussion</a></li><li class="active">Detect .NET Compact Framework using NSIS Script</li></ol><p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=220784">Detect .NET Compact Framework using NSIS Script</a></p><br><div class="post"><p class="post-meta"><span class="post-author text-primary">Salimgbelim</span><br><span class="post-time small text-muted">6th July 2005 09:32 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>Detect .NET Compact Framework using NSIS Script</strong><br>Hi guys,<br><br>Need some help regarding NSIS script to package my application.<br><br>Q-1.I want is to detect if .netcf(.NET Compact framework) is installed on device if not install<br>install the framework then install my application.<br><br>Q-2.I want to install appropriate Cab (ARM/ARM4/SH3 etc..)files depending on the device.setup should detect the Operating system of device and install cab's accordigly<br><br>Is it possible using NSIS? Have anyone done it before?<br><br>Regards<br>Salim</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br><span class="post-time small text-muted">6th July 2005 11:30 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">You should look on the <a href="http://nsis.sourceforge.net/wiki" target="_blank">NSIS Wiki</a><br><br>-Stu</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Salimgbelim</span><br><span class="post-time small text-muted">6th July 2005 13:12 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>No Examples on Wiki</strong><br>Wiki Haven't got any example for mobile! :( :hang:</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">jmycr</span><br><span class="post-time small text-muted">6th July 2005 14:57 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">EnumRegValue $1 HKLM SOFTWARE\Microsoft\.NETFramework 0<br><br>StrCmp $1 "" no_framework framework<br><br>no_framework:<br>InetLoad::load "http://dotnetfx.exe" "$INSTDIR\dotnetfx.exe"<br>Execwait '"$INSTDIR\dotnetfx.exe"'<br><br>framework:</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Salimgbelim</span><br><span class="post-time small text-muted">6th July 2005 16:41 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Thanks for the reply.<br><br>but,I think this code detects for .net compact framework on computer from where we are installing the system,but what i want is to check on device.<br><br>Is it possible to somehow run something on device prior to installing the application which can detect the framework and return true/false?<br><br>Regards<br><br>Salim</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br><span class="post-time small text-muted">6th July 2005 17:17 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">What kind of operating systems exist on the device? If it's just Windows, you can try the Detect Windows Version function which you'll find in the NSIS Manual under Useful Scripts.<br><br>-Stu</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Salimgbelim</span><br><span class="post-time small text-muted">6th July 2005 17:29 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">i got Orange M2000 which runs pocket pc 2003 OS.well for pocket pc 2003 it comes with .netCF but say e.g i want to install my application on some device which runs pocket pc 2002 OS (which doesn't come with compact framework) so i need a way during installing the application to detect on device.<br><br>Regards<br>Salim</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br><span class="post-time small text-muted">7th July 2005 15:43 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Can you access the registry regedit on there? There's probably some registry entries there that identify which OS it us. Otherwise there should be some API function which returns the OS name / version which you could call with the System plugin (but I can't help you with that!)<br><br>-Stu</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Salimgbelim</span><br><span class="post-time small text-muted">7th July 2005 17:51 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Yes I can access the registery settings in Pocket PC,but i don't know how to access the pocket pc registery from NSIS script? :(</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br><span class="post-time small text-muted">7th July 2005 18:14 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">ReadRegStr?<br>There are a lot of registry and INI file instructions in the NSIS manual.<br><br>-Stu</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">0ddJob</span><br><span class="post-time small text-muted">3rd August 2005 17:05 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Taken the below from MSDN, any dieas how to do in NSIS script? Or any other ideas?<br><br><br><br>Detecting the Microsoft .NET Compact Framework<br><br>You will need to create a .dll which can be invoked as a custom action from the MSI file.<br><br>Begin by connecting to the device using CeRapiInitEx.<br><br>Use CeFindAllFiles to search the device's Windows directory for GAC_mscorlib_*.dll. If that is present, some flavor of the .NET Compact Framework is installed on the device.<br><br>Query the device registry and enum the values in HKLM\SOFTWARE\Microsoft\.NETCompactFramework. You should find registry keys which represent the build of NETCF that is present. (e.g. 1.0.2268.00:REG_DWORD:0). This version is created by all .cab installs and is included on all future ROM installs. It was missing from the initial ROM install of the RTM .NET Compact Framework, so if you do not find it, assume the value is 1.0.2268.0.<br><br>At this point you should know whether the .NET Compact Framework is present, and whether you need to deploy your own version to the device. If you also need to deploy the SQL CE files, you can use a similar mechanism of searching the Windows directory for the GAC'd libraries. The SQL install does not post its version to the registry, so the only way to know the build version would be to read the Win32 resources of the .dll. In the sample I have opted to always install the SQL .cabs if they are required. This should be safe, because CE installer will prevent an inadvertent downgrade of the SQL packages on the device. A similar approach could be taken with the .NET Compact Framework as well.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">kichik</span><br><span class="post-time small text-muted">4th August 2005 18:24 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">To call CeFindAllFiles, use the System plug-in. To enumerate the registry, use EnumRegKey and EnumRegValue. There are some examples for enumeration in the Wiki.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">BULLETUK</span><br><span class="post-time small text-muted">2nd October 2006 07:36 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Has anybody got a solution for this? I've tried and tried to get CF.NET SP1 to be included in my NSIS script. But everytime it fails with the error:<br><br>"Application Manager cannot install this application on your mobile device due to an invalid setup file."<br><br>Please take a look at the attached script. Thanks for any assistance.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">kichik</span><br><span class="post-time small text-muted">6th October 2006 16:29 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Make sure the setup file fits the device you're trying to install it on. There is usually a different executable for each platform. The OS version might not fit as well...</p></div><hr><div class="footer"><p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p></div></div><script src="../js/highlight.pack.js" type="text/javascript"></script><script type="text/javascript">//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]></script></body></html>