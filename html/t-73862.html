<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="User Input Prompt" />

  <title>User Input Prompt - NSIS Forums</title><!-- Bootstrap core CSS -->
  <link rel="stylesheet" type="text/css" href="//netdna.bootstrapcdn.com/bootswatch/3.0.1/readable/bootstrap.min.css" />
  <link rel="stylesheet" href="../css/style.css" type="text/css" /><!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!--[if lt IE 9]>
                <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
                <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->
</head>

<body>
  <div class="container">
    <!-- Put navigation bar here -->

    <ol class="breadcrumb">
      <li><a href="../index.html" class="glyphicon glyphicon-home"></a></li>

      <li><a href="f-65.html">NSIS Discussion</a></li>

      <li class="active">User Input Prompt</li>
    </ol>

    <p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=73862">User Input Prompt</a></p><br />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">ssurfer26</span><br />
      <span class="post-time small text-muted">29th January 2002 22:48 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>User Input Prompt</strong><br />
      Ok I know I've asked this question before but I want to do this without an ini file if all possible. What I want is a prompt for some user input so it will pass that variable to the shortcut link NSIS creates.<br />
      <br />
      The variable below is $0, $1 and $2.<br />
      <br />
      Example:<br />
      CreateShortCut "$SMPROGRAMS\test\test\test.lnk" "$INSTDIR\test.exe" "-ip$0 -port$1 -pass$2" "$INSTDIR\test.exe" 0<br />
      <br />
      How can I prompt the user to enter in the info so it will pass to the shortcut?<br />
      <br />
      Thanks,<br />
      Derek :igor:</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Smile2Me</span><br />
      <span class="post-time small text-muted">30th January 2002 09:59 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Hi ssurfer26,<br />
      <br />
      NSIS does not have possibilities for this. But maybe you can write a small exe that will be called from the script and asks for the user input, saves it to the registry, so that the installer scripts can access the user input again.<br />
      <br />
      This is a possibility...<br />
      <br />
      Good luck, greetz,<br />
      Hendri.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Smile2Me</span><br />
      <span class="post-time small text-muted">30th January 2002 13:24 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Maybe also possible: use NSIS extension dll like programming to access the stack and user variables. So create a small exe that requests for user input and sets eg $R9 to the given value.<br />
      But again: i'm not sure this is possible (maybe someone else can verify this one)<br />
      <br />
      Good luck, Hendri.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
      <span class="post-time small text-muted">30th January 2002 15:11 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Or you can just use InstallOptions which is already included in the NSIS pacakage. :)</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">ssurfer26</span><br />
      <span class="post-time small text-muted">30th January 2002 20:14 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">ok I think the InstallOptions will work. Just have to figure out how to implement it into my script. So question... How do I package both the installer and the dll/ini files together? Do I need 2 install packages then? One to extract all the temp files and then excute the real installer?<br />
      <br />
      Thanks</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Smile2Me</span><br />
      <span class="post-time small text-muted">30th January 2002 21:04 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Derek,<br />
      <br />
      i understood you didn't want to use an ini...<br />
      Whatever, here's how you do it:<br />
      <br /></p>
      <pre>
<code><br />SetOutPath $TEMP<br />File InstOpts.dll<br />File myini.ini<br />Push $TEMP\myini.ini<br />CallInstDll $TEMP\InstOpts.dll dialog<br />; return can be 'cancel', 'back', or 'Ok'<br />; so check this and then use ReadIniStr<br />; to read the $TEMP\myini.ini.<br />; Do not forget to delete these files after<br />; completing setup.<br /></code>
</pre><br />
      <br />
      You can put this code whereever you like, eg in .onNextPage (then you can ask for a RegCode before getting to install files) or in some section.<br />
      <br />
      Good luck, greetz,<br />
      Hendri.
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">ssurfer26</span><br />
      <span class="post-time small text-muted">30th January 2002 23:16 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">ok well I kind of have it working... This is the code I have for a section. Only a few small problems. It doesn't popup until the very end after it's created the shortcuts already. How can I get that to run before it creates the shortcuts etc?<br />
      <br />
      Derek<br />
      <br />
      Example Code:<br />
      ; optional section<br />
      Section "Monitoring Server Shortcuts"<br />
      SetOutPath $TEMP<br />
      File test.ini<br />
      File InstallOptions.dll<br />
      Push $TEMP\test.ini<br />
      CallInstDLL $TEMP\InstallOptions.dll dialog<br />
      Pop $0<br />
      ; ($0 would be "success" "cancel" "back" or some other value on error.<br />
      <br />
      ReadINIStr $R0 $7 "Field 1" State<br />
      ReadINIStr $R1 $7 "Field 2" State<br />
      ReadINIStr $R2 $7 "Field 3" State<br />
      <br />
      Delete $TEMP\test.ini<br />
      Delete $TEMP\InstallOptions.dll<br />
      <br />
      <br />
      CreateShortCut "$SMPROGRAMS\test\test.lnk" "$INSTDIR\test.exe" "-1$R0 -2$R1 -3$R2" "$INSTDIR\test.exe" 0<br />
      SectionEnd</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Smile2Me</span><br />
      <span class="post-time small text-muted">31st January 2002 09:34 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">In the code you've posted, it's not possible (i think) that the shortcut is created before asking for input.<br />
      <br />
      If you want to get the information before getting to 'install', use .onNextPage to put your question between some pages of the installer. Take a look at RegCode (included) for an example on how to ask for a regcode before selecting a dir.<br />
      <br />
      Good luck, Hendri.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Dizzy007</span><br />
      <span class="post-time small text-muted">16th September 2002 13:04 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>Custom Pages ??</strong><br />
      Hi to all!<br />
      <br />
      i'm new in using NSIS and i've problems to understand the code of "regcodenew" :(<br />
      Can anyone explain the following line to me?<br />
      <br />
      !insertmacro CustomPages 01AB2345 $R9 $R8 onCustomPage onPageEntry onPageExit<br />
      <br />
      OK - custom pages .. but how does it work?<br />
      And which section is section 5 ??<br />
      <br />
      What about the sections at the end of the code (Section 1 to 3) ?? Are this the sections "1=Installation Options,2=Installation Directory,3=Installing Files" where i have to put my onw code???<br />
      <br />
      And ... Exch-Pop-Push ...<br />
      In the "Funktion onCustomPage" the first thing is<br />
      Exch $0<br />
      Why ?<br />
      <br />
      Thanks for help a newbie!!<br />
      Dizzy</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
      <span class="post-time small text-muted">16th September 2002 13:34 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"></p>

      <blockquote>
        !insertmacro CustomPages 01AB2345 $R9 $R8 onCustomPage onPageEntry onPageExit
      </blockquote>This line inserts a macro into the script. A macro is a defined set of lines that you can insert into your script in any positions. This line inserts the CustomPages macro which helps you create custom pages with ease (<a href="http://www.clantpa.co.uk/nsis/wiki/index.php/MultIni4" target="_blank">MultIni4</a> is its newer version). Open up CustomPages.nsh, there are a lot of explainations about this macro in there.<br />
      <br />

      <blockquote>
        And which section is section 5 ??<br />
        <br />
        What about the sections at the end of the code (Section 1 to 3) ?? Are this the sections "1=Installation Options,2=Installation Directory,3=Installing Files" where i have to put my onw code???
      </blockquote>You are confusing sections and pages. The numbers there represent pages, not sections.<br />
      <br />

      <blockquote>
        And ... Exch-Pop-Push ...<br />
        In the "Funktion onCustomPage" the first thing is<br />
        Exch $0<br />
        Why ?
      </blockquote>NSIS scripting langauge isn't a high language like C and friends. You have to use the stack manually in NSIS. To give a function an parameter you have to push it to the stack. For the function to get this parameter it has to pop it from the stack. Exch just replaces the top stack element with the given variable ($0 in this case). This was done so $0's old value won't get deleted by a simple pop instruction.
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Dizzy007</span><br />
      <span class="post-time small text-muted">16th September 2002 16:22 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>Custom pages</strong><br />
      Yes ... now i see a little bit clearer! :p<br />
      <br />
      Now i've to test a little bit with the stack.<br />
      <br />
      Thanks for your help! :up:<br />
      <br />
      Dizzy</p>
    </div>
    <hr />

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]>
  </script>
</body>
</html>
