<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="ExecWait without the Dos Window" />

  <title>ExecWait without the Dos Window - NSIS Forums</title>
  <script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script>
  <!-- Bootstrap core CSS -->

  <link rel="stylesheet" type="text/css" href="//netdna.bootstrapcdn.com/bootswatch/3.0.1/readable/bootstrap.min.css" />
  <link rel="stylesheet" href="../css/style.css" type="text/css" /><!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!--[if lt IE 9]>
                <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
                <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->
</head>

<body>
  <div class="container">
    <!-- Put navigation bar here -->

    <ol class="breadcrumb">
      <li><a href="../index.html" class="glyphicon glyphicon-home"></a></li>

      <li><a href="f-65.html">NSIS Discussion</a></li>

      <li class="active">ExecWait without the Dos Window</li>
    </ol>

    <p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=255025">ExecWait without the Dos Window</a></p><br />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">bambou51</span><br />
      <span class="post-time small text-muted">7th September 2006 07:54 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>ExecWait without the Dos Window</strong><br />
      I was using nsexec::ExecToStack to run command lines during my setup, then in the next step I was pushing variables into the stack and calling functions, and I was getting the output of the command line within the function I called:<br />
      For example in the following script, I get the output of the<br />
      "iisreset /stop" command in my messagebox.<br />
      I know that if I were using $2 for example to store my string I would have avoid this problem, but is there a way to force ExecToStack to wait until the execution is done ?<br />
      I know I can provide it with a timeout but sometimes it will take a few seconds somteimes 1 minute and I don't want to wait for the worth case scenario.<br />
      <br />
      <br />
      Function func1<br />
      Pop $0<br />
      MessageBox MB_OK "$0"<br />
      FunctionEnd<br />
      <br />
      nsExec::ExecToStack 'iisreset /stop'<br />
      StrCpy $0 "some text"<br />
      Call func1<br />
      <br />
      <br />
      Then if I replace nsExec::ExecToStack with ExecWait, it is doing exactely what I need, but a Dos window is displayed. Is it possible to hide it ?<br />
      Do you have any suggestions ?</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Jnuw</span><br />
      <span class="post-time small text-muted">7th September 2006 20:17 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">If ExecWait is working for you, try ExecDos::exec. I have used that command to run all sorts of command line things with no dos window pop up. You will need the plug in of course, you can get it here: <a href="http://nsis.sourceforge.net/ExecDos_plug-in" target="_blank">http://nsis.sourceforge.net/ExecDos_plug-in</a><br />
      <br />
      Hope this helps.<br />
      Jnuw</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Takhir</span><br />
      <span class="post-time small text-muted">8th September 2006 07:57 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">nsExec waits started (a) process to exit. The only confusing situation is third process (b) executed by process (a) started from nsExec :) ExecWait might wait console window to close. Try ExecCmd plug-in, or use comSpec <a href="http://forums.winamp.com/showthread.php?s=&amp;threadid=154414&amp;highlight=comspec" target="_blank">http://forums.winamp.com/showthread....hlight=comspec</a> in the command line.</p>
    </div>
    <hr />

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]>
  </script>
</body>
</html>
