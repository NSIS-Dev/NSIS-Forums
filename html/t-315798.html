<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="description" content="NSIS in context menu"><title>NSIS in context menu - NSIS Forums</title><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script><link rel="preload" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css" as="style" onload="this.rel='stylesheet'"><link rel="preload" href="../css/style.css" as="style" onload="this.rel='stylesheet'"><noscript><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css"><link rel="stylesheet" href="../css/style.css"></noscript><script>!function(a){"use strict";var b=function(b,c,d){function e(a){return h.body?a():void setTimeout(function(){e(a)})}function f(){i.addEventListener&&i.removeEventListener("load",f),i.media=d||"all"}var g,h=a.document,i=h.createElement("link");if(c)g=c;else{var j=(h.body||h.getElementsByTagName("head")[0]).childNodes;g=j[j.length-1]}var k=h.styleSheets;i.rel="stylesheet",i.href=b,i.media="only x",e(function(){g.parentNode.insertBefore(i,c?g:g.nextSibling)});var l=function(a){for(var b=i.href,c=k.length;c--;)if(k[c].href===b)return a();setTimeout(function(){l(a)})};return i.addEventListener&&i.addEventListener("load",f),i.onloadcssdefined=l,l(f),i};"undefined"!=typeof exports?exports.loadCSS=b:a.loadCSS=b}("undefined"!=typeof global?global:this);!function(a){if(a.loadCSS){var b=loadCSS.relpreload={};if(b.support=function(){try{return a.document.createElement("link").relList.supports("preload")}catch(b){return!1}},b.poly=function(){for(var b=a.document.getElementsByTagName("link"),c=0;c<b.length;c++){var d=b[c];"preload"===d.rel&&"style"===d.getAttribute("as")&&(a.loadCSS(d.href,d,d.getAttribute("media")),d.rel=null)}},!b.support()){b.poly();var c=a.setInterval(b.poly,300);a.addEventListener&&a.addEventListener("load",function(){b.poly(),a.clearInterval(c)}),a.attachEvent&&a.attachEvent("onload",function(){a.clearInterval(c)})}}}(this);</script></head><body><div class="container"><ol class="breadcrumb"><li><a href="../index.html" class="glyphicon glyphicon-home"></a></li><li><a href="f-65.html">NSIS Discussion</a></li><li class="active">NSIS in context menu</li></ol><p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=315798">NSIS in context menu</a></p><br><div class="post"><p class="post-meta"><span class="post-author text-primary">Yathosho</span><br><span class="post-time small text-muted">28th December 2009 21:45 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>NSIS in context menu</strong><br>any chance to get the context menu entries to compile scripts working on Windows 7 x64? it's all properly set in the registry, but they don't show up (tried with and without holding shift-key).<br><br>the registry on 64bit windows is properly confusing!</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">pengyou</span><br><span class="post-time small text-muted">29th December 2009 18:38 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">It works for me on Windows 7 RC 64-bit (see attached screenshot)<br><br>Where did you install NSIS?<br><br>I did <b><u>not</u></b> use "C:\Program Files (x86)\NSIS" because I wanted to avoid UAC problems when using a standard account to compile the NSIS examples.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Yathosho</span><br><span class="post-time small text-muted">29th December 2009 18:47 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">as it's a 32-bit application, i installed it to Program Files (x86). i was running the RC before, now i'm using the final - didn't work in any of them.<br><br>as a workaround i'm now using open with makensisw, that's good enough for now :)</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Geoff73</span><br><span class="post-time small text-muted">13th January 2010 09:48 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">I'm on Windows 7 and associated the .nsi extension to another program. Lost Context Menu ("Compile with...") and can't get it back (uninstall/reinstall NSIS makes no difference). Not a disaster because I have now associated it with 'makensisw.exe' so compile works with double-click, but annoying. Has anyone solved this problem?</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">anandharaja</span><br><span class="post-time small text-muted">22nd January 2010 14:16 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">hello<br><br>i found the solution u need to delete the registry entry.<br>"*HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Explorer\FileExts*" find the .nsi extention there and delete the entry. its work for me</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Yathosho</span><br><span class="post-time small text-muted">23rd January 2010 12:29 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">feeling lazy?</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">kichik</span><br><span class="post-time small text-muted">6th February 2010 16:14 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">What's in that key?</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Anders</span><br><span class="post-time small text-muted">6th February 2010 20:55 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Explorer adds things there on its own (When you use openwith etc)</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">kichik</span><br><span class="post-time small text-muted">6th February 2010 23:46 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Then deleting it affects the user's choice, doesn't it?</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Yathosho</span><br><span class="post-time small text-muted">12th September 2011 18:22 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">microsoft's <a href="http://msdn.microsoft.com/en-us/library/cc144171(v=vs.85).aspx" target="_blank">documentation</a> is anything but good, but i read myself a bit into the issue.<br><br>i've attached two registry files and a script that does the same as those files. there are two methods to create the context menu entries, but only one of them (hkcr) works properly in the script (maybe i'm just tired?)<br><br>for reason unknown, i could only add menu entries for all files (*) rather than just scripts (.nsi) - all working examples i found on the net were made for all files as well, but i can't imagine why microsoft would want people to that. again, if you can fix this, please do.<br><br>other than that, this works nicely!<br><br>for reference:<br><a href="http://msdn.microsoft.com/en-us/library/cc144171(v=vs.85).aspx" target="_blank">msdn</a><br><a href="http://social.msdn.microsoft.com/Forums/en/windowsuidevelopment/thread/3ee4702a-f75a-4790-9332-e50f241efd6f" target="_blank">msdn forums</a><br><a href="http://io-repo.blogspot.com/2011/05/cascading-context-menus-via-static.html" target="_blank">working example</a></p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Yathosho</span><br><span class="post-time small text-muted">12th September 2011 21:33 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">screenshot<br><br><a href="http://forums.winamp.com/attachment.php?attachmentid=49137&amp;stc=1&amp;d=1315859600" target="_blank">http://forums.winamp.com/attachment....1&amp;d=1315859600</a></p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br><span class="post-time small text-muted">13th September 2011 09:51 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Still no idea why it's not working for you. It works fine for me and I even added my own options for my nsL Assembler. Running 7 x64.<br><br>Stu</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Yathosho</span><br><span class="post-time small text-muted">13th September 2011 09:57 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">the script above works for me (and i prefer a cascaded menus), just what the nsis installer does isn't working.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br><span class="post-time small text-muted">13th September 2011 13:04 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">The NSIS installer has always worked for me and I have installed NSIS on 3 separate machines running fresh installs of Windows 7. Is yours a fresh install of SP1?<br><br>Stu</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Yathosho</span><br><span class="post-time small text-muted">13th September 2011 13:24 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"></p><blockquote><small>Originally posted by Afrow UK</small><br>The NSIS installer has always worked for me and I have installed NSIS on 3 separate machines running fresh installs of Windows 7. Is yours a fresh install of SP1?<br><br>Stu</blockquote>as mentioned above, i had this on a fresh windows 7 (pro x64), but i'm sure i installed it again since being on sp1 level. also happened previously when i ran a fresh install of windows 7 rc.<br><br>all registry keys are properly written by the nsis installers and i don't have problems with other products (7zip, dropbox, notepad++, runwithparameters etc.) that add themselves to the context menu. it even works for my own installers that add entries in the same fashion as nsis does!<br><br>ps: dropbox and 7zip are using cascaded menus (<a href="http://msdn.microsoft.com/en-us/library/bb776095(v=vs.85).aspx" target="_blank">IContextMenu</a> i presume) and might not count</div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Anders</span><br><span class="post-time small text-muted">13th September 2011 16:53 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">I don't know who made <a href="http://nsis.sourceforge.net/Windows_7_Cascading_Context_Menu" target="_blank">http://nsis.sourceforge.net/Windows_...g_Context_Menu</a> but please fix it so that it only binds to .nsi, not to * before posting to the wiki...</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Yathosho</span><br><span class="post-time small text-muted">13th September 2011 19:55 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"></p><blockquote><small>Originally posted by Anders</small><br>I don't know who made <a href="http://nsis.sourceforge.net/Windows_7_Cascading_Context_Menu" target="_blank">http://nsis.sourceforge.net/Windows_...g_Context_Menu</a> but please fix it so that it only binds to .nsi, not to * before posting to the wiki...</blockquote>the only working examples i found on the internet (and also the default entries in windows 7) work for *, Directory, DesktopBackground, DeviceDisplayObject and such, not for specific files<br><br>the only file-specific example i found did not work on my computer. now i wonder if that's related to my initial problem, so you might want to test the attached script. just make sure to adjust the paths first. also, only use this if you know how to revert the changes afterwards!<br><br>since i'm not the only one with this problem, i think it should be resolved. also, you might want to consider using cascaded menus on windows 7 in future versions - once working for a single file type.</div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Anders</span><br><span class="post-time small text-muted">13th September 2011 21:35 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><a href="http://forums.winamp.com/attachment.php?attachmentid=49139&amp;d=1315946012" target="_blank">http://forums.winamp.com/attachment....9&amp;d=1315946012</a><br><br><a href="http://forums.winamp.com/attachment.php?attachmentid=49139" target="_blank" title="Name: Views: Size: ">Attachment 49139</a><br><br>Just for .nsi and I did it in HKCU just for fun</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Yathosho</span><br><span class="post-time small text-muted">13th September 2011 22:58 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">can you post your script please or put it on that wikipage?</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Anders</span><br><span class="post-time small text-muted">13th September 2011 23:19 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"></p><blockquote><small>Originally posted by Yathosho</small><br>can you post your script please or put it on that wikipage?</blockquote>I don't have a script, I just edited the registry (I have already deleted the keys) I did not do anything special. As long as your .nsi default value is NSIS.Script I don't see why it should not work. Maybe you should try Process Monitor and look at what explorer is looking for to find your problem...</div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Yathosho</span><br><span class="post-time small text-muted">14th September 2011 12:14 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">i have no problems with windows 7 32-bit running in a vm, updated the wiki page</p></div><hr><div class="footer"><p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p></div></div><script src="../js/highlight.pack.js" type="text/javascript"></script><script type="text/javascript">//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]></script></body></html>