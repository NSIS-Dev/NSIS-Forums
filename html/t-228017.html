<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="description" content="Compile NSIS 2.10 problem"><title>Compile NSIS 2.10 problem - NSIS Forums</title><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script><link rel="preload" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css" as="style" onload="this.rel='stylesheet'"><link rel="preload" href="../css/style.css" as="style" onload="this.rel='stylesheet'"><noscript><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css"><link rel="stylesheet" href="../css/style.css"></noscript><script>!function(a){"use strict";var b=function(b,c,d){function e(a){return h.body?a():void setTimeout(function(){e(a)})}function f(){i.addEventListener&&i.removeEventListener("load",f),i.media=d||"all"}var g,h=a.document,i=h.createElement("link");if(c)g=c;else{var j=(h.body||h.getElementsByTagName("head")[0]).childNodes;g=j[j.length-1]}var k=h.styleSheets;i.rel="stylesheet",i.href=b,i.media="only x",e(function(){g.parentNode.insertBefore(i,c?g:g.nextSibling)});var l=function(a){for(var b=i.href,c=k.length;c--;)if(k[c].href===b)return a();setTimeout(function(){l(a)})};return i.addEventListener&&i.addEventListener("load",f),i.onloadcssdefined=l,l(f),i};"undefined"!=typeof exports?exports.loadCSS=b:a.loadCSS=b}("undefined"!=typeof global?global:this);!function(a){if(a.loadCSS){var b=loadCSS.relpreload={};if(b.support=function(){try{return a.document.createElement("link").relList.supports("preload")}catch(b){return!1}},b.poly=function(){for(var b=a.document.getElementsByTagName("link"),c=0;c<b.length;c++){var d=b[c];"preload"===d.rel&&"style"===d.getAttribute("as")&&(a.loadCSS(d.href,d,d.getAttribute("media")),d.rel=null)}},!b.support()){b.poly();var c=a.setInterval(b.poly,300);a.addEventListener&&a.addEventListener("load",function(){b.poly(),a.clearInterval(c)}),a.attachEvent&&a.attachEvent("onload",function(){a.clearInterval(c)})}}}(this);</script></head><body><div class="container"><ol class="breadcrumb"><li><a href="../index.html" class="glyphicon glyphicon-home"></a></li><li><a href="f-65.html">NSIS Discussion</a></li><li class="active">Compile NSIS 2.10 problem</li></ol><p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=228017">Compile NSIS 2.10 problem</a></p><br><div class="post"><p class="post-meta"><span class="post-author text-primary">Instructor</span><br><span class="post-time small text-muted">9th October 2005 11:45 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>Compile NSIS 2.10 problem</strong><br>I have installed:<br>python-2.4.1<br>scons-0.96.91<br>VCToolkit<br>Windows Server 2003 SP1 Platform SDK<br><br>Build.bat (in the NSIS source directory):<br></p><pre>
<code>@ECHO OFF<br>set MSSDK=D:\Program Files\Microsoft Platform SDK<br>set VCToolkitInstallDir=D:\Program Files\Microsoft Visual C++ Toolkit 2003<br>set Python=D:\Python24<br><br>set PATH=%Python%;%PATH%<br>set INCLUDE=%MSSDK%\include;%INCLUDE%<br>set LIB=%MSSDK%\lib;%LIB%<br><br>scons MSTOOLKIT=yes</code>
</pre><br>
      <br>
      But there are errors when I try to compile:<br>

      <blockquote>
        scons: Reading SConscript files ...<br>
        Delete("nsis-09-Oct-2005.cvs")<br>
        Delete(".instdist")<br>
        Delete(".test")<br>
        Using Microsoft tools configuration<br>
        Checking for main() in C library gdi32... (cached) no<br>
        Checking for main() in C library user32... (cached) no<br>
        Checking for main() in C library version... (cached) no<br>
        Checking for main() in C library pthread... (cached) no<br>
        Checking for main() in C library stdc++... (cached) no<br>
        Checking for main() in C library iconv... (cached) no<br>
        Checking for main() in C library dl... (cached) no<br>
        Checking for main() in C++ library cppunit... (cached) no<br>
        scons: done reading SConscript files.<br>
        scons: Building targets ...<br>
        cl /nologo /O1 /W3 /c Contrib\AdvSplash\advsplash.c /Fobuild\release\AdvSplash\a<br>
        dvsplash.obj<br>
        advsplash.c<br>
        Contrib\AdvSplash\advsplash.c(214) : error C2065: 'LWA_ALPHA' : undeclared ident<br>
        ifier<br>
        Contrib\AdvSplash\advsplash.c(214) : error C2065: 'LWA_COLORKEY' : undeclared id<br>
        entifier<br>
        Contrib\AdvSplash\advsplash.c(244) : error C2065: 'WS_EX_LAYERED' : undeclared i<br>
        dentifier<br>
        Contrib\AdvSplash\advsplash.c(270) : error C2065: 'DWORD_PTR' : undeclared ident<br>
        ifier<br>
        Contrib\AdvSplash\advsplash.c(270) : error C2146: syntax error : missing ')' bef<br>
        ore identifier 'myWnd'<br>
        Contrib\AdvSplash\advsplash.c(270) : error C2144: syntax error : '&lt;Unknown&gt;' sho<br>
        uld be preceded by '&lt;Unknown&gt;'<br>
        Contrib\AdvSplash\advsplash.c(270) : error C2144: syntax error : '&lt;Unknown&gt;' sho<br>
        uld be preceded by '&lt;Unknown&gt;'<br>
        Contrib\AdvSplash\advsplash.c(270) : error C2143: syntax error : missing ')' bef<br>
        ore 'identifier'<br>
        Contrib\AdvSplash\advsplash.c(270) : error C2198: 'timeSetEvent' : too few argum<br>
        ents for call through pointer-to-function<br>
        Contrib\AdvSplash\advsplash.c(270) : error C2059: syntax error : ')'<br>
        scons: *** [build\release\AdvSplash\advsplash.obj] Error 2<br>
        scons: building terminated because of errors.
      </blockquote>I read in forum about the same error, it was environment variable problem, but why scons don't find liberaries, all paths is ok.
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br>
      <span class="post-time small text-muted">9th October 2005 13:06 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Does %MSSDK%\Lib\Gdi32.Lib exist? If it doesn't, you might have installed the wrong Platform SDK. There's one that doesn't come with all the libraries and binaries for some weird reason. Maybe it was only for 64-bit. I don't remember right now...</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Instructor</span><br>
      <span class="post-time small text-muted">9th October 2005 15:24 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">I'm confused. "%MSSDK%\Lib\Gdi32.Lib" exists.</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br>
      <span class="post-time small text-muted">9th October 2005 15:37 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">If it exists, it's probably the correct Platform SDK version.<br>
      <br>
      What does config.log show?</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Instructor</span><br>
      <span class="post-time small text-muted">9th October 2005 16:07 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">This is very strange. After I have remove "nsis-2.10-src" and unpack source again (build.bat file the same):<br></p>
      <pre>
<code><br>scons: Reading SConscript files ...<br>Delete("nsis-09-Oct-2005.cvs")<br>Delete(".instdist")<br>Delete(".test")<br>Using Microsoft tools configuration<br>Checking for main() in C library gdi32... (cached) yes<br>Checking for main() in C library user32... (cached) yes<br>Checking for main() in C library version... (cached) yes<br>Checking for main() in C library pthread... (cached) no<br>Checking for main() in C library stdc++... (cached) no<br>Checking for main() in C library iconv... (cached) no<br>Checking for main() in C library dl... (cached) no<br>Checking for main() in C++ library cppunit... (cached) no<br>scons: done reading SConscript files.<br>scons: Building targets ...<br>cl /nologo /O1 /W3 /c Contrib\AdvSplash\advsplash.c /Fobuild\release\AdvSplash\a<br>dvsplash.obj<br>advsplash.c<br>Contrib\AdvSplash\advsplash.c(214) : error C2065: 'LWA_ALPHA' : undeclared ident<br>ifier<br>Contrib\AdvSplash\advsplash.c(214) : error C2065: 'LWA_COLORKEY' : undeclared id<br>entifier<br>Contrib\AdvSplash\advsplash.c(244) : error C2065: 'WS_EX_LAYERED' : undeclared i<br>dentifier<br>Contrib\AdvSplash\advsplash.c(270) : error C2065: 'DWORD_PTR' : undeclared ident<br>ifier<br>Contrib\AdvSplash\advsplash.c(270) : error C2146: syntax error : missing ')' bef<br>ore identifier 'myWnd'<br>Contrib\AdvSplash\advsplash.c(270) : error C2144: syntax error : '&lt;Unknown&gt;' sho<br>uld be preceded by '&lt;Unknown&gt;'<br>Contrib\AdvSplash\advsplash.c(270) : error C2144: syntax error : '&lt;Unknown&gt;' sho<br>uld be preceded by '&lt;Unknown&gt;'<br>Contrib\AdvSplash\advsplash.c(270) : error C2143: syntax error : missing ')' bef<br>ore 'identifier'<br>Contrib\AdvSplash\advsplash.c(270) : error C2198: 'timeSetEvent' : too few argum<br>ents for call through pointer-to-function<br>Contrib\AdvSplash\advsplash.c(270) : error C2059: syntax error : ')'<br>scons: *** [build\release\AdvSplash\advsplash.obj] Error 2<br>scons: building terminated because of errors.</code>
</pre>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br>
      <span class="post-time small text-muted">9th October 2005 16:32 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">I actually wanted the config.log for the non-working build. The working one doesn't show the errors. But if it finds the libraries now, it's not important. The libraries were probably not found because the result was still cached from the last time you built it without the correct environment variables.<br>
      <br>
      But the incorrect header file is a puzzle. It doesn't stop on HINSTANCE, but it does on newer definitions which require _WIN32_WINNT. But _WIN32_WINNT is defined on the same file. This means it takes the header files from another place. Do you have WinUser.h installed in another place than %MSSDK%\Include\WinUser.h?<br>
      <br>
      BTW, you don't need to change INCLUDE and LIB on yourself. SCons handles that on its own and ignores your settings.</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Instructor</span><br>
      <span class="post-time small text-muted">9th October 2005 16:51 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">You are right there was "%VCToolkitInstallDir%\Include\WinUser.h". After clean VCToolkit install, all compiles fine. Thanks!</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br>
      <span class="post-time small text-muted">9th October 2005 20:59 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Any idea how it got there? Was it there in the default installation of the VC Toolkit?</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Instructor</span><br>
      <span class="post-time small text-muted">10th October 2005 07:04 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">It is I place liberaries and headers from VC6 to VC Toolkit :)</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br>
      <span class="post-time small text-muted">10th October 2005 12:46 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Ah, that explains it. I've updated the tool definition to give priority to the header and library files in the Platfrom SDK. In case they exist in both, the PSDK's should always be newer anyway.</p>
    </div>
    <hr>

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]></script></body></html>