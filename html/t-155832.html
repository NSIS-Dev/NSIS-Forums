<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="description" content="Language selection dialog localization"><title>Language selection dialog localization - NSIS Forums</title><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script><link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css"><link rel="stylesheet" href="../css/style.css" type="text/css"></head><body><div class="container"><ol class="breadcrumb"><li><a href="../index.html" class="glyphicon glyphicon-home"></a></li><li><a href="f-65.html">NSIS Discussion</a></li><li class="active">Language selection dialog localization</li></ol><p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=155832">Language selection dialog localization</a></p><br><div class="post"><p class="post-meta"><span class="post-author text-primary">BARRIER</span><br><span class="post-time small text-muted">11th November 2003 06:47 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>Language selection dialog localization</strong><br>Hello,<br><br>What is the mechanism to have<br><br>MUI_LANGDLL_INFO<br>MUI_LANGDLL_DISPLAY<br><br>localized ?<br><br>I've tried to put localization strings in french and english nsh files, but got an error (already defined).<br><br>Currently, I use a tricky strcompare in onInit function to do it...<br><br>Thanks,<br><br>BB</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Joost Verburg</span><br><span class="post-time small text-muted">11th November 2003 16:37 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Use a LangString (see users manual).</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">BARRIER</span><br><span class="post-time small text-muted">11th November 2003 16:51 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Hello,<br><br>I realize I've not properly explained my question.<br><br>I wanted to know how i can add these entries in language files, to have automatic localization.<br><br>BB</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Joost Verburg</span><br><span class="post-time small text-muted">11th November 2003 17:35 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">You would have to modify System.nsh.<br><br>Why do you want to use localised text when the user has not even selected a language yet?</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">BARRIER</span><br><span class="post-time small text-muted">11th November 2003 18:08 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Hello,<br><br>I simply want the language selection dialog to use the machine language.<br><br>For instance, on a french machine, the language selection dialog will be displayed in french, and the user can then select English to install with the english language.<br><br>Curently, I use this code, which properly works. (only two languages, French and English):<br><br>Function .onInit<br>StrCmp $LANGUAGE ${LANG_FRENCH} french english<br>french:<br>StrCpy $R0 "Choisissez la langue du programme d'installation"<br>StrCpy $R1 "Langue d'installation"<br>Goto end<br>english:<br>StrCpy $R0 "Please select the language of the installer"<br>StrCpy $R1 "Install language"<br>end:<br>!Define MUI_LANGDLL_WINDOWTITLE $R1<br>!Define MUI_LANGDLL_INFO $R0<br>!insertmacro MUI_LANGDLL_DISPLAY<br>FunctionEnd<br><br>BB</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Joost Verburg</span><br><span class="post-time small text-muted">11th November 2003 18:36 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">This is way easier:</p><pre>
<code><br>LangString LangDialog_Title ${LANG_ENGLISH}" "Installer Language"<br>LangString LangDialog_Title ${LANG_FRENCH}" "Langue d'installation"<br><br>LangString LangDialog_Text ${LANG_ENGLISH}" "Please select the installer language."<br>LangString LangDialog_Text ${LANG_FRENCH}" "Choisissez la langue du programme d'installation."<br><br>!define MUI_LANGDLL_WINDOWTITLE "$(LangDialog_Title)"<br>!define MUI_LANGDLL_INFO "$(LangDialog_Text)"</code>
</pre>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">BARRIER</span><br>
      <span class="post-time small text-muted">11th November 2003 18:51 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Hello,<br>
      <br>
      Thank you.<br>
      <br>
      I had already tried this, but put it before the language declarations.<br>
      <br>
      It works now.<br>
      <br>
      BB</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">BARRIER</span><br>
      <span class="post-time small text-muted">12th November 2003 07:23 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Hello,<br>
      <br>
      After sucessfully localized the title and the text of the language selection dialog with your active and useful support, it remained to localize the "Cancel" button.<br>
      <br>
      It needed to make a minor change to LangDLL, but I wanted this change absolutely don't need any change in the parameter chain of LangDLL and, of course, in any other NSIS file (1).<br>
      <br>
      To do this (2) I added the cancel button text at the end of the MUI_LANGDLL_WINDOWTITLE like this :<br>
      "Installer Language|$(^CancelBtn)"<br>
      (which is not an innovation as Microsoft uses commonly this character as strings separator).<br>
      <br>
      In the langdialog procedure, I check the "|" character and, if present, load the remaining text in a g_BtnText variable.<br>
      <br>
      In the dialogproc procedure, if g_btnText length is not null, I send the text to the control SetDlgItemText(hwndDlg, IDCANCEL, g_btntext);<br>
      <br>
      BB<br>
      <br>
      (1) In fact, there is another change to do, help have to mention the availability of the Cancel button customization !<br>
      <br>
      (2) In Delphi port of LangDLL. Unfortunately, I dont program in C, but i can give the code to anyone want to report the change in the original c code for the NSIS "non english speaking" community.</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">conando</span><br>
      <span class="post-time small text-muted">12th November 2003 07:50 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">I would vote for having this in the "official" NSIS dist as well! I come from a background of using Wise Installation System on my "9-to-5 job" and it's capable of this as well! (and I used it in all our products)<br>
      <br>
      Cheers,<br>
      -SÃ¶ren<br>
      <br>
      OT: Btw. while Wise is/was already way better (imho) than InstallShield (because it's installers worked very similar to the NSIS ones) it's great to see that NSIS is even much better than Wise! :-)<br>
      And for free! I don't know why Wise &amp; InstallShield keep selling products at all *g* (besides some hm very "obscure"/very big installers in the corporate world where I'm not sure if NSIS could handle them properly - forgive me I'm a newbie ;o)</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">BARRIER</span><br>
      <span class="post-time small text-muted">12th November 2003 08:15 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Hey Conando,<br>
      <br>
      Just another remark to your message, regarding support, which is usually far better here !<br>
      <br>
      In the free software community, it is very current to have a developement team answer in less than one hour, a bug fix in less than one day, and a lot workaround from users if the fix is more tricky need more time to implement.<br>
      <br>
      BB</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Joost Verburg</span><br>
      <span class="post-time small text-muted">12th November 2003 11:39 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Thanks for your comments BARRIER.<br>
      <br>
      With this modifications it only supports a bit of localization. I think the version is the NSIS distribtion should be updated when there is full support.<br>
      <br>
      I think the best solution would be displaying texts and button texts in the langauge that is currently selected.<br>
      <br>
      If you can add an option to send texts for every langauge and let LangDLL change the texts when the selection changes, that would be great.</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">BARRIER</span><br>
      <span class="post-time small text-muted">12th November 2003 11:51 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Hello,<br>
      <br>
      Effectively, it should be great, but i only program in Delphi. So, if a C developer want translate the code in C to append to the genuine file...<br>
      <br>
      It also needs to integrate the translated strings in language files to avoid the users to explicitely declare the strings.<br>
      <br>
      BB</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Joost Verburg</span><br>
      <span class="post-time small text-muted">12th November 2003 11:53 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">If someone adds this feature, I'll let the Modern UI support it.</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">BARRIER</span><br>
      <span class="post-time small text-muted">12th November 2003 12:23 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Hello Joost,<br>
      <br>
      As the dialog procedure belongs to a DLL, we are in a totally independant process a<br>
      , we have only access to the data passed during the command line and NSIS only pass in the command line ONE language string for the title and ONE language string for the text.<br>
      <br>
      So, as paradox, it will be quite easy to modify the code in the DLL (process a CBN_SELENDOK WM_COMMAND message), buit we have no different strings to display.<br>
      <br>
      To do so, it will be needed to adopt the process used to pass the language names and codes to the DLL also for the text parameters, but it will not be longer compatible with existing scripts, which is probably not acceptable or rewrite a completely new DLL with a callback which is very tricky (and bug prone !) to do and also need a change in the NSIS GUI systeme code.<br>
      <br>
      It is a limitation due to DLLs and it is also present in otehre installers (IS, Wise, MS).<br>
      <br>
      BB</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Joost Verburg</span><br>
      <span class="post-time small text-muted">12th November 2003 12:57 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">You can modify LangDLL to accept these texts as parameters for every language.<br>
      <br>
      You don't have to break the current syntax. For example, you can check whether the first parameter (currently the window title) = LANGTEXT and then not get the standard texts but texts for every language.</p>
    </div>
    <hr>

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]></script></body></html>