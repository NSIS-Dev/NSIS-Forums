<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="description" content="nsi file for a VB app."><title>nsi file for a VB app. - NSIS Forums</title><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script><link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css"><link rel="stylesheet" href="../css/style.css" type="text/css"><!--[if lt IE 9]><script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script><script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script><![endif]--></head><body><div class="container"><ol class="breadcrumb"><li><a href="../index.html" class="glyphicon glyphicon-home"></a></li><li><a href="f-65.html">NSIS Discussion</a></li><li class="active">nsi file for a VB app.</li></ol><p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=44869">nsi file for a VB app.</a></p><br><div class="post"><p class="post-meta"><span class="post-author text-primary">emoreau</span><br><span class="post-time small text-muted">18th March 2001 17:44 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Does anybody built a facility to convert a setup.lst file into a a .nsi file for a vb applications?<br><br>Any difficulties in installing VB app with SuperPiMP?</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">buzzc4</span><br><span class="post-time small text-muted">18th March 2001 21:12 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">I'm using it for vb, just gotta include the runtimes and stuff. Works pretty damn good. Only 1 exe to distro, no more lst/ini/exe/cab.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">emoreau</span><br><span class="post-time small text-muted">18th March 2001 21:20 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Do you copy all of your LST into the nsi file?<br><br>Can you give a sample of a complete NSI file?</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">buzzc4</span><br><span class="post-time small text-muted">18th March 2001 22:11 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Not really. I recreated the nsi from scratch. Just use the File command for all your files and mkdir as you need to. Also its optional but you can regdll your .dll's and .ocx's, so your program wont have to do it on launch. Thats about it. You can check out the sample .nsi files the installer includes</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">rfb</span><br><span class="post-time small text-muted">23rd March 2001 16:53 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>new versions of ocx's</strong><br>I have to wonder about newer version of OCX's that I might install, should I just set it to Overwrite, then register?<br><br>-ryan</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">prodangle</span><br><span class="post-time small text-muted">8th October 2001 16:27 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>Re: new versions of ocx's</strong><br></p><blockquote><i>Originally posted by rfb</i><br><b>I have to wonder about newer version of OCX's that I might install, should I just set it to Overwrite, then register?<br><br>-ryan</b></blockquote>I think this might go down as the longest awaited reply ever...<br><br>take a look at <a href="http://forums.winamp.com/showthread.php?threadid=58619" target="_blank">http://forums.winamp.com/showthread.php?threadid=58619</a></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">liquidmotion</span><br><span class="post-time small text-muted">8th October 2001 20:05 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">i might be able to incorporate this into my nsis gui. sound like a good idea?</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Koen van de Sande</span><br><span class="post-time small text-muted">8th October 2001 20:13 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Mmm I'm still using the Microsoft distribution of the VB6 runtimes instead of a native NSIS install. Maybe I should make a VB6-Runtime install? With all the correct RegDLL/version checking/etc?</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Repzilon</span><br><span class="post-time small text-muted">8th October 2001 21:19 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">I did a native NSIS install for VB5 runtime libraries. I used SetOverwrite ifnewer instead and before I execute the script, I make sure that I have the latest versions. Here it is :<br><br>Section "Runtime Visual Basic 5.0 SP3"<br>SectionIn 23<br>SetOverwrite ifnewer<br>SetCompress Auto<br>SetDateSave On<br>SetOutPath "$SYSDIR"<br>File "C:\Windows\Bureau\mdinote-setup\Asycfilt.dll"<br>File "C:\Windows\Bureau\mdinote-setup\Comcat.dll"<br>File "C:\Windows\Bureau\mdinote-setup\Ctl3d32.dll"<br>File "C:\Windows\Bureau\mdinote-setup\Msvbvm50.dll"<br>File "C:\Windows\Bureau\mdinote-setup\Oleaut32.dll"<br>File "C:\Windows\Bureau\mdinote-setup\Olepro32.dll"<br>File "C:\Windows\Bureau\mdinote-setup\Vb5fr.dll"<br>RegDLL "$SYSDIR\Comcat.dll"<br>RegDLL "$SYSDIR\msvbvm50.dll"<br>RegDLL "$SYSDIR\oleaut32.dll"<br>RegDLL "$SYSDIR\olepro32.dll"<br>SectionEnd</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Koen van de Sande</span><br><span class="post-time small text-muted">9th October 2001 17:45 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">But does that work if the OLE files need to be updated?<br>I created the following yesterday (I have a few notes to make, scroll down):<br><br></p><pre>
<code><br>Section "Visual Basic 6 Runtimes"<br>  ;OLEAUT32.DLL is always in use! Most of the time, a reboot is needed.<br>  SetOverwrite on <br>  SetOutPath $SYSDIR <br>  CompareDLLVersions /STOREFROM OLEAUT32.NEW $SYSDIR\OLEAUT32.DLL oleaut32_1newer oleaut32_2newer <br>  goto oleaut32_2newer<br>  oleaut32_1newer: <br>  File OLEAUT32.NEW<br>  Rename OLEAUT32.NEW OLEAUT32.DLL<br>  IfErrors 0 oleaut32_noreboot<br>  Rename /REBOOTOK OLEAUT32.NEW OLEAUT32.DLL<br>  MessageBox MB_OK "Reboot needed"<br>  oleaut32_noreboot:<br>  RegDLL "$SYSDIR\OLEAUT32.DLL"<br>  oleaut32_2newer:<br><br>; do I need this?<br>  ;OLEPRO32.DLL is always in use! Most of the time, a reboot is needed.<br>  CompareDLLVersions /STOREFROM OLEPRO32.NEW $SYSDIR\OLEPRO32.DLL olepro32_1newer olepro32_2newer <br>  goto olepro32_2newer<br>  olepro32_1newer: <br>  File OLEPRO32.NEW<br>  Rename OLEPRO32.NEW OLEPRO32.DLL<br>  IfErrors 0 olepro32_noreboot<br>  Rename /REBOOTOK OLEPRO32.NEW OLEPRO32.DLL<br>  MessageBox MB_OK "Reboot needed"<br>  olepro32_noreboot:<br>  RegDLL "$SYSDIR\OLEPRO32.DLL"<br>  olepro32_2newer:<br><br>  ;ASYCFILT.DLL<br>  CompareDLLVersions /STOREFROM ASYCFILT.DLL $SYSDIR\ASYCFILT.DLL asycfilt_1newer asycfilt_2newer<br>  goto asycfilt_2newer<br>  asycfilt_1newer: <br>  File ASYCFILT.DLL<br>  asycfilt_2newer:<br><br>  ;STDOLE2.TLB<br>  CompareDLLVersions /STOREFROM STDOLE2.TLB $SYSDIR\STDOLE2.TLB stdole_1newer stdole_2newer<br>  goto stdole_2newer<br>  stdole_1newer: <br>  File STDOLE2.TLB<br>  stdole_2newer:<br><br>  ;MSVBVM60.DLL<br>  CompareDLLVersions /STOREFROM MSVBVM60.DLL $SYSDIR\MSVBVM60.DLL MSVBVM60_1newer MSVBVM60_2newer<br>  goto MSVBVM60_2newer<br>  MSVBVM60_1newer: <br>  File MSVBVM60.DLL<br>  MSVBVM60_2newer:<br><br>  ;COMCAT.DLL<br>  CompareDLLVersions /STOREFROM COMCAT.DLL $SYSDIR\COMCAT.DLL COMCAT_1newer COMCAT_2newer<br>  goto COMCAT_2newer<br>  COMCAT_1newer: <br>  File COMCAT.DLL<br>  COMCAT_2newer:<br><br>  ;an OCX registration example<br>  CompareDLLVersions /STOREFROM comdlg32.ocx $SYSDIR\comdlg32.ocx comdlg32_1newer comdlg32_2newer <br>  goto comdlg32_2newer<br>  comdlg32_1newer: <br>  File comdlg32.ocx <br>  RegDLL "$SYSDIR\comdlg32.ocx" <br>  comdlg32_2newer: <br>SectionEnd<br></code>
</pre><br>
      A few notes:<br>
      1) Do you actually need all those files? My application only needs MSVBVM60.DLL and OLEAUT32.DLL, but I'm afraid to leave out the rest.<br>
      2) This NSIS installer is bigger than the Microsoft distribution. If you use the Microsoft one with the /Q flag, you're saving 150 KB. So I'm probably sticking with that.<br>
      <br>
      If anyone can tell me if you can leave out some of these files, that'd help.
    </div>
    <hr>

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]></script></body></html>