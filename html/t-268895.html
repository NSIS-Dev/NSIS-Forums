<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="description" content="Refresh System Tray Icons"><title>Refresh System Tray Icons - NSIS Forums</title><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script><link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css"><link rel="stylesheet" href="../css/style.css" type="text/css"><!--[if lt IE 9]><script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script><script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script><![endif]--></head><body><div class="container"><ol class="breadcrumb"><li><a href="../index.html" class="glyphicon glyphicon-home"></a></li><li><a href="f-65.html">NSIS Discussion</a></li><li class="active">Refresh System Tray Icons</li></ol><p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=268895">Refresh System Tray Icons</a></p><br><div class="post"><p class="post-meta"><span class="post-author text-primary">ThorMX</span><br><span class="post-time small text-muted">4th April 2007 01:55 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>Refresh System Tray Icons</strong><br>I'm looking for a way to refresh the system tray in order to remove the icons of the applications I terminated....any great ideas?<br><br>The only solution I've seen to this is to programmatically move the mouse and then move it back so the icons will update. Is there not an easier way? How would you even do that with NSIS?<br><br>Thanks in advance.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">kichik</span><br><span class="post-time small text-muted">8th April 2007 16:55 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">The best solution is properly quitting applications and not terminating them. Usually, it's good enough to find their HWND and send WM_CLOSE. <a href="http://nsis.sourceforge.net/FCT_plug-in" target="_blank">FCT</a> first tries that and only then terminates the process.<br><br>To remove stray icons, you'll probably have to find the HWND of the tray and send it WM_MOUSEMOVE or the HWND of the terminated process and call Shell_NotifyIcon to remove the icon using the System plug-in.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">gaja</span><br><span class="post-time small text-muted">30th May 2007 14:42 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>Re:Refresh system tray icon</strong><br>Please provide me some stuff or code to refresh the system tray icon after terminating the application.<br><br>I am new user to NSIS. Please help me in this regard...<br><br>Regards,<br>Gaja...</p></div><hr><div class="footer"><p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p></div></div><script src="../js/highlight.pack.js" type="text/javascript"></script><script type="text/javascript">//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]></script></body></html>