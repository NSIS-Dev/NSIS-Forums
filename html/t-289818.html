<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="Prompting for directory install" />

  <title>Prompting for directory install - NSIS Forums</title>
  <script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script>
  <!-- Bootstrap core CSS -->

  <link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css" />
  <link rel="stylesheet" href="../css/style.css" type="text/css" /><!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!--[if lt IE 9]>
                <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
                <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->
</head>

<body>
  <div class="container">
    <!-- Put navigation bar here -->

    <ol class="breadcrumb">
      <li><a href="../index.html" class="glyphicon glyphicon-home"></a></li>

      <li><a href="f-65.html">NSIS Discussion</a></li>

      <li class="active">Prompting for directory install</li>
    </ol>

    <p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=289818">Prompting for directory install</a></p><br />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">gregf</span><br />
      <span class="post-time small text-muted">7th April 2008 19:41 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>Prompting for directory install</strong><br />
      Hello all,<br />
      <br />
      I got my first script working today. Cross compiling it from Linux!<br />
      <br />
      Pretty chuffed.<br />
      <br />
      I tested it using some of the scripts in the tutorials and examples section of the NSIS documentation.<br />
      <br />
      Having had a quick play I can get my installer to install three things in one go(!). One is an msi for which I use msiexec. The other two are straight forward files.<br />
      <br />
      I want to have the installer prompt for the directory to install the files, but it doesn't make sense to have it prompt for the install location of the msi.<br />
      <br />
      Question: how do I get it to prompt for a directory install, but only after the msi package has been installed.<br />
      <br />
      At the moment the screen that prompts me for an install directory appears very early on.<br />
      <br />
      Where do I put the: !insertmacro MUI_PAGE_DIRECTORY<br />
      <br />
      I've seen posts that will tell me how to specify different install directories for each section. And one post that shows me how to selectively prompt for install location based on whether the section is selected for install. I can't find anything that lets me delay prompting for directory until just before the section is installed.<br />
      <br />
      Any guidance on which bits of the documentation to focus on would be very much appreciated. Any tips at all would gratefully appreciated.<br />
      <br />
      <br />
      Many thanks in advance.<br />
      <br />
      Greg<br />
      <br />
      <br />
      The script is:<br />
      <br />
      !include "MUI.nsh"<br />
      !include "WinMessages.nsh"<br />
      <br />
      !define PRODUCT_NAME "My Product"<br />
      !define PRODUCT_VERSION "1.0"<br />
      !define PRODUCT_PUBLISHER "blah blah"<br />
      <br />
      SetCompressor lzma<br />
      <br />
      ; MUI Settings / Icons<br />
      !define MUI_ABORTWARNING<br />
      <br />
      ;... some icon and header graphics defs..<br />
      <br />
      !insertmacro MUI_PAGE_WELCOME<br />
      <br />
      !insertmacro MUI_PAGE_COMPONENTS<br />
      !insertmacro MUI_PAGE_DIRECTORY<br />
      <br />
      !insertmacro MUI_PAGE_INSTFILES<br />
      !insertmacro MUI_PAGE_FINISH<br />
      !insertmacro MUI_LANGUAGE "English"<br />
      !insertmacro MUI_RESERVEFILE_INSTALLOPTIONS<br />
      <br />
      ; MUI end ------<br />
      <br />
      Name "${PRODUCT_NAME} ${PRODUCT_VERSION}"<br />
      OutFile "MySetup.exe"<br />
      ShowInstDetails show<br />
      InstallDir "$PROGRAMFILES\ProductOne"<br />
      <br />
      Section -SETTINGS<br />
      SetOutPath "$INSTDIR"<br />
      SetOverwrite ifnewer<br />
      SectionEnd<br />
      <br />
      Section "PostgreSQL"<br />
      SetOutPath "$INSTDIR"<br />
      File "thirdpartypackage.msi"<br />
      ExecWait 'msiexec /i "$INSTDIR\thirdpartypackage.msi"<br />
      SectionEnd<br />
      <br />
      Section "MyDirTree"<br />
      SetOutPath "$INSTDIR"<br />
      File /r "./mydirectory"<br />
      SectionEnd<br />
      <br />
      Section "MyFileInstance"<br />
      SetOutPath "$INSTDIR"<br />
      File "./myfile"<br />
      SectionEnd</p>
    </div>
    <hr />

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]>
  </script>
</body>
</html>
