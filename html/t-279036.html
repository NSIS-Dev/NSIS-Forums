<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="description" content="VB and NSIS"><title>VB and NSIS - NSIS Forums</title><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script><link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css"><link rel="stylesheet" href="../css/style.css" type="text/css"><!--[if lt IE 9]><script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script><script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script><![endif]--></head><body><div class="container"><ol class="breadcrumb"><li><a href="../index.html" class="glyphicon glyphicon-home"></a></li><li><a href="f-65.html">NSIS Discussion</a></li><li class="active">VB and NSIS</li></ol><p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=279036">VB and NSIS</a></p><br><div class="post"><p class="post-meta"><span class="post-author text-primary">Kauko</span><br><span class="post-time small text-muted">15th October 2007 18:13 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>VB and NSIS</strong><br>When I call NSIS generated installer from VB program it doesn't show up on the screen foreground but only in taskbar?<br>How do I bring it to the screen foreground?</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br><span class="post-time small text-muted">15th October 2007 18:17 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Try ExecShell with SW_SHOWMAXIMIZED.<br><br>Stu</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">helix400</span><br><span class="post-time small text-muted">15th October 2007 19:33 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Here's some VB6 code we use to restore other windows:<br><br>'These next sections are helpful to find a window specifically by its handle (hWnd)<br>'----------------------------------------------------<br>Declare Function FindWindow Lib "user32" Alias "FindWindowA" (ByVal lpClassName As String, ByVal lpWindowName As String) As Long<br>Declare Function ShowWindow Lib "user32" (ByVal hWnd As Long, ByVal nCmdShow As Long) As Long<br>Declare Function SetFocus Lib "user32" (ByVal hWnd As Long) As Long<br>Declare Function SetActiveWindow Lib "user32" (ByVal hWnd As Long) As Long<br>Declare Function SetForegroundWindow Lib "user32" (ByVal hWnd As Long) As Long<br>Declare Function GetWindowPlacement Lib "user32" (ByVal hWnd As Long, lpwndpl As WINDOWPLACEMENT) As Long<br><br>Const SW_SHOW = 5<br>Const SW_RESTORE = 9<br>Const SW_SHOWMINIMIZED = 2<br>Const SW_SHOWMAXIMIZED = 3<br>Const SW_SHOWNORMAL = 1<br><br>Public Type Rect<br>Left As Long<br>Top As Long<br>Right As Long<br>Bottom As Long<br>End Type<br><br>Private Type POINTAPI<br>x As Long<br>y As Long<br>End Type<br><br>Private Type WINDOWPLACEMENT<br>Length As Long<br>Flags As Long<br>showCmd As Long<br>ptMinPosition As POINTAPI<br>ptMaxPosition As POINTAPI<br>rcNormalPosition As Rect<br>End Type<br><br>Private lpwndpl As WINDOWPLACEMENT<br><br><br>Public Function RestoreWindow(lngHandle As Long) As Boolean<br>'If you know a window's handle, this will restore the window to the front<br><br>On Local Error GoTo ErrorHandler<br><br>Dim lState As Long<br>Dim bRetVal As Boolean<br><br>bRetVal = False<br>lpwndpl.Length = 44<br><br>lState = GetWindowPlacement(lngHandle, lpwndpl)<br>HandleDebug "lState is: " &amp; lState<br>If lState &lt;&gt; 0 Then<br>Select Case lpwndpl.showCmd<br>Case SW_SHOWMINIMIZED<br>Call ShowWindow(lngHandle, SW_RESTORE)<br>Case SW_SHOWNORMAL, SW_SHOWMAXIMIZED<br>Call ShowWindow(lngHandle, SW_SHOW)<br>End Select<br>Call SetFocus(lngHandle)<br>Call SetActiveWindow(lngHandle)<br>Call SetForegroundWindow(lngHandle)<br>bRetVal = True<br>End If<br><br>RestoreWindow = bRetVal<br>Exit Function<br>ErrorHandler:<br>MsgBox "Error loading window"<br>RestoreWindow = bRetVal<br>End Function<br><br><br>If you need to get a window's handle, you can do so with this...<br><br>lngHandle = FindWindow(vbNullString, [window's caption name])<br><br>If you need a VB.NET version, just let me know.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Kauko</span><br><span class="post-time small text-muted">15th October 2007 20:07 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Looks like you guys are trying to make this too complicated?<br>Pls notice that this is NSIS generated install program run FROM VB menu program which starts by CD-ROM's Autorun.<br>I have dozen separate programs in the menu of VB program.<br>I want to select program to install by clicking VB program button.<br>All install programs created in VB properly execute in the foreground but all NSIS install programs execute to HIDING. Only taskbar shows that it is running.<br>There is no ExecShell anywhere here.<br>There is Shell in VB menu program running the install programs.<br>Thanks</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br><span class="post-time small text-muted">15th October 2007 21:23 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><a href="http://www.vbaccelerator.com/codelib/shell/shellex.htm" target="_blank">http://www.vbaccelerator.com/codelib/shell/shellex.htm</a><br><br>If you wrote the installer, try putting a BringToFront in the welcome page's show function (or onGUIInit).<br><br>Stu</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Kauko</span><br><span class="post-time small text-muted">16th October 2007 15:10 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Thanks, this worked:<br><br>!define MUI_CUSTOMFUNCTION_GUIINIT MyGUIInit<br><br>Function MyGUIInit<br>BringToFront<br>FunctionEnd</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">helix400</span><br><span class="post-time small text-muted">17th October 2007 22:32 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">BringToFront doesn't work on newer Windows versions (Microsoft I suppose disabled the underlying feature due to too many spyware popups). BringToFront instead will just cause the taskbar item to blink.<br><br>As both of us mentioned, the problem is not with NSIS, it's with how you launch the application from within VB.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Kauko</span><br><span class="post-time small text-muted">18th October 2007 12:05 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Do not know any better so I do:<br><br>Private Sub ButtonMyProgram_Click()<br>Shell "Programs\Setup_MyProgram.exe"<br>End Sub<br><br>which works with Win2000 &amp; WinXP and BringToFront in my NSIS script.<br>Can you please give details how I suppose do it right?</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">helix400</span><br><span class="post-time small text-muted">19th October 2007 07:43 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Again, just so you know, newer Windows versions do not allow applications to bring themselves to the front. Only applications in front have the rights to bring other apps in front.<br><br>In VB6, I think you can do this with:<br><br>Shell "Programs\Setup_MyProgram.exe", vbNormalFocus<br><br>If you ever wondered why Shell has 2 parameters in vb6, now you know why :)</p></div><hr><div class="footer"><p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p></div></div><script src="../js/highlight.pack.js" type="text/javascript"></script><script type="text/javascript">//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]></script></body></html>