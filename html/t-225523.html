<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="description" content="Problem with un.GUIEnd"><title>Problem with un.GUIEnd - NSIS Forums</title><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script><link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css"><link rel="stylesheet" href="../css/style.css" type="text/css"><!--[if lt IE 9]><script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script><script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script><![endif]--></head><body><div class="container"><ol class="breadcrumb"><li><a href="../index.html" class="glyphicon glyphicon-home"></a></li><li><a href="f-65.html">NSIS Discussion</a></li><li class="active">Problem with un.GUIEnd</li></ol><p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=225523">Problem with un.GUIEnd</a></p><br><div class="post"><p class="post-meta"><span class="post-author text-primary">NukeyDoo</span><br><span class="post-time small text-muted">9th September 2005 12:19 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>Problem with un.GUIEnd</strong><br>Hello,<br><br>I have one tiny last little problem happening with my script. As the very last thing of my uninstall, I want to send the user to my website which will have a page asking why they decided to uninstall, so that I can use the feedback for improvements.<br><br>When the Uninstall is complete, it should launch the page. It's working fine using this code:<br><br>Section un.onGUIEnd<br><br>ExecShell "open" "http://www.foobar.com/"<br><br>SectionEnd<br><br>The only issues are, it's launching the page while the last gui (success) page is on the screen, even without the user clicking the final OK button. From reading the help file I was under the impression that it wouldn't launch until the actual window was closed?<br><br>The other issue is when I remove my app using the add/remove programs applet (AR), the AR window is not refreshing to reflect the program was uninstalled from the AR list until the browser window is closed from the launching of my page, in fact you can't even set focus to the AR window with your mouse cursor until you close the browser window.<br><br>Any ideas around these issues?<br><br><br>TIA</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">kichik</span><br><span class="post-time small text-muted">9th September 2005 12:30 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">I can't reproduce the un.onGUIEnd problem. When I create a simple installer with just un.onGUIEnd, it's executed after the dialog closes. Are you sure there's no other code section that opens the website?<br><br>As for the Add/Remove control panel freezing, see the following:<br><br><a href="http://forums.winamp.com/showthread.php?s=&amp;threadid=224925&amp;highlight=uninstall" target="_blank">http://forums.winamp.com/showthread....ight=uninstall</a></p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">dubek1</span><br><span class="post-time small text-muted">30th January 2006 16:35 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">I also experience NukeyDoo's problem. I must mention my installer is a MUI one, maybe that causes the problem?<br><br>I tried putting the ExecShell command both in un.onGUIEnd and<br>MUI_PAGE_CUSTOMFUNCTION_LEAVE of the MUI_UNPAGE_INSTFILES page (which is the last page in my installer). Both yielded the same (unwanted) result of executing the ExecShell *before* the user clicked "Close".<br><br>Thanks,<br>Dov.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Takhir</span><br><span class="post-time small text-muted">30th January 2006 17:41 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">This also might happen if you used plug-in with /NOUNLOAD option and dll stays attached at the end of uninstall.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">kichik</span><br><span class="post-time small text-muted">31st January 2006 17:27 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">I still can't reproduce this. Please attach an example.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">dubek1</span><br><span class="post-time small text-muted">1st February 2006 07:40 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Here's my script (attached).<br><br>Maybe it's because the uninstaller has no finish page?<br><br>Thanks a lot!</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">dandaman32</span><br><span class="post-time small text-muted">1st February 2006 20:29 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Use:</p><pre>
<code>Function un.onInstSuccess<br>  HideWindow ; not sure if this is needed I'm a little rusty<br>  ExecShell open "http://feedback.example.com"<br>FunctionEnd</code>
</pre><br>
      <br>
      Emphasis on <b>function</b> :weird:<br>
      -dandaman32
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">dubek1</span><br>
      <span class="post-time small text-muted">2nd February 2006 07:19 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>This works!</strong><br>
      Thanks a lot for your help; now it works as intended. I guess the problem was that I wrote "Section" instead of "Function" (another classic RTFM case).<br>
      <br>
      So either un.onUninstSuccess or un.onGUIEnd works for me now (I'll use un.onUninstSuccess, to prevent the browser open if something went wrong).<br>
      <br>
      Again, thanks a lot!</p>
    </div>
    <hr>

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]></script></body></html>