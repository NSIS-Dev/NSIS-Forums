<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="description" content="Need help with GetParameters function"><title>Need help with GetParameters function - NSIS Forums</title><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script><link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css"><link rel="stylesheet" href="../css/style.css" type="text/css"></head><body><div class="container"><ol class="breadcrumb"><li><a href="../index.html" class="glyphicon glyphicon-home"></a></li><li><a href="f-65.html">NSIS Discussion</a></li><li class="active">Need help with GetParameters function</li></ol><p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=108983">Need help with GetParameters function</a></p><br><div class="post"><p class="post-meta"><span class="post-author text-primary">cchian</span><br><span class="post-time small text-muted">8th October 2002 23:06 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>Need help with GetParameters function</strong><br>I currently have code that will give me the name of the batch file calling the NSIS executable (I must use a batch file for this application). The program that calls the batch file is another software that passes some data to our app by means of the batch and NSIS file combination.<br>Here is my current batch file code:<br></p><pre>
<code>copy %1 mydata.dat<br>myapp.exe %0</code>
</pre><br>
      As I mentioned above, I can already get the name of the batch file with the %0 parameter. What I would also like to do is to pass it the data with the %1 parameter so my batch file should just be something like:<br>
      <pre>
<code>myapp.exe %0 %1</code>
</pre>The problem is I cannot figure out how to get %1 so I can copy it into a file/variable. How do I read the second parameter?
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Joost Verburg</span><br>
      <span class="post-time small text-muted">9th October 2002 07:36 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>Re: Need help with GetParameters function</strong><br>
      Put quotes around the parameters, so you will know when the second one starts.</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">cchian</span><br>
      <span class="post-time small text-muted">9th October 2002 21:04 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">I added quotes around the parameters so my batch file now looks like:<br>
      <br>
      myapp.exe "%0" "%1"<br>
      <br>
      I also added the following two things right before closing the GetParameters Function code:<br>
      * A message box to show me the values of $0, $1 and $2<br>
      ( This is the code: MessageBox MB_OK "0=$0$\n1=$1$\n2=$2" )<br>
      * StrCpy $1 c:\mydata.dat<br>
      <br>
      The values of $0, $1 and $2 come up blank and the data being transferred doesn't get copied into c:\mydata.dat</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">cchian</span><br>
      <span class="post-time small text-muted">9th October 2002 21:07 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">I forgot to mention that I am using 1.98</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Joost Verburg</span><br>
      <span class="post-time small text-muted">9th October 2002 21:31 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">You need to write some code to separate these parameters. The StrCpy instruction does not write stuff to a file, it just copies a variable.<br>
      <br>
      Can you post the other code?</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br>
      <span class="post-time small text-muted">9th October 2002 21:54 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">$0, $1 and $2 are not the equivalent of %0, %1 and %2... You have to call the GetParameters function, then Pop to get its result and parse it. If you used myapp.exe "%0" "%1" to call the installer the string popped will be "%0" "%1" (%0 and %1 of course replaced by their real values...). You will then have to seperate this string to two strings by searching for the quotes and using StrCpy starting position parameter and number of characters to copy parameter.</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">eccles</span><br>
      <span class="post-time small text-muted">9th October 2002 22:20 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Using the function <a href="http://www.clantpa.co.uk/nsis/wiki/index.php/GetNextCommandLineParameter" target="_blank">GetNextParm</a>, this should do the trick:</p>
      <pre>
<code>Push $CMDLINE<br>Call GetNextParm<br>Pop $0 ; name of installer<br>Call GetNextParm<br>Pop $1 ; first parameter<br>Call GetNextParm<br>Pop $2 ; second parameter<br>Pop $9 ; remaining parameters (not required - just keeping the stack tidy)</code>
</pre>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">cchian</span><br>
      <span class="post-time small text-muted">9th October 2002 22:24 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Attached is my NSIS script and batch file zipped up.<br>
      <br>
      I will try to figure out Kichik's suggestion of "You will then have to seperate this string to two strings by searching for the quotes and using StrCpy starting position parameter and number of characters to copy parameter."<br>
      <br>
      Thank you</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br>
      <span class="post-time small text-muted">10th October 2002 12:00 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Using <a href="http://www.clantpa.co.uk/nsis/wiki/index.php/GetNextCommandLineParameter" target="_blank">GetNextParm</a> will actually be easier :)</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">cchian</span><br>
      <span class="post-time small text-muted">10th October 2002 18:02 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Thanks for the help, but I am still having problems figuring out how to implement the "GetNextParm" function in my code. I added the "GetNextParm" function as posted by eccles and called it from the .OnInit function (after "Call GetParameters"), but now I am getting a stack fault error when the exe is executed. What am I doing wrong?</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br>
      <span class="post-time small text-muted">10th October 2002 20:56 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">You have an example of usage in the URL eccles gave you. You don't need to call GetParameters if you use GetNextParm...</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">tderouin</span><br>
      <span class="post-time small text-muted">21st February 2003 18:31 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">GetNextParam should be using $R0..$R9 and not $0..$9. Using $9 around the start menu functionality in Modern UI wipes out the Start Menu folder.</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br>
      <span class="post-time small text-muted">21st February 2003 18:35 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Where did you find GetNextParm? The links above are dead.</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">tderouin</span><br>
      <span class="post-time small text-muted">21st February 2003 18:41 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">That's a good question, I think I found it in included example piece of code posted somewhere on this board, but I can't remember where.</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Sunjammer</span><br>
      <span class="post-time small text-muted">21st February 2003 21:47 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">I still have the backups of that clantpa site. Does anyone want me to fish out the stuff that those dead links used to refer to?</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br>
      <span class="post-time small text-muted">21st February 2003 21:50 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">I'll be happy to polish it if I'll get a copy of it ;)</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Sunjammer</span><br>
      <span class="post-time small text-muted">21st February 2003 22:26 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>clantpa.co.uk backup files</strong><br>
      Here it is.<br>
      <br>
      Also for anyone interested (you're pretty mad if you try this) I've made the backups accessible by ftp (<a href="ftp://nsis:nsis@sunjammer.serveftp.net" target="_blank">ftp://nsis:nsis@sunjammer.serveftp.net</a>). The reason I've done this is that I have very little time to go through them and yet there is potentially still useful information in there.</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Sunjammer</span><br>
      <span class="post-time small text-muted">21st February 2003 22:28 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Hmm forgot the file :D</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br>
      <span class="post-time small text-muted">21st February 2003 23:09 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">It uses $9 in the example but in the function itself pushes and pops like needed. If you want to perform the check in the installer you can use this function, it's optimized for that task:<br>
      <a href="http://nsis.sourceforge.net/archive/viewpage.php?pageid=79" target="_blank">http://nsis.sourceforge.net/archive/....php?pageid=79</a></p>
    </div>
    <hr>

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]></script></body></html>