<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="description" content="Using icons from a DLL on a custom page"><title>Using icons from a DLL on a custom page - NSIS Forums</title><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script><link rel="preload" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css" as="style" onload="this.rel='stylesheet'"><link rel="preload" href="../css/style.css" as="style" onload="this.rel='stylesheet'"><noscript><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css"><link rel="stylesheet" href="../css/style.css"></noscript><script>!function(a){"use strict";var b=function(b,c,d){function e(a){return h.body?a():void setTimeout(function(){e(a)})}function f(){i.addEventListener&&i.removeEventListener("load",f),i.media=d||"all"}var g,h=a.document,i=h.createElement("link");if(c)g=c;else{var j=(h.body||h.getElementsByTagName("head")[0]).childNodes;g=j[j.length-1]}var k=h.styleSheets;i.rel="stylesheet",i.href=b,i.media="only x",e(function(){g.parentNode.insertBefore(i,c?g:g.nextSibling)});var l=function(a){for(var b=i.href,c=k.length;c--;)if(k[c].href===b)return a();setTimeout(function(){l(a)})};return i.addEventListener&&i.addEventListener("load",f),i.onloadcssdefined=l,l(f),i};"undefined"!=typeof exports?exports.loadCSS=b:a.loadCSS=b}("undefined"!=typeof global?global:this);!function(a){if(a.loadCSS){var b=loadCSS.relpreload={};if(b.support=function(){try{return a.document.createElement("link").relList.supports("preload")}catch(b){return!1}},b.poly=function(){for(var b=a.document.getElementsByTagName("link"),c=0;c<b.length;c++){var d=b[c];"preload"===d.rel&&"style"===d.getAttribute("as")&&(a.loadCSS(d.href,d,d.getAttribute("media")),d.rel=null)}},!b.support()){b.poly();var c=a.setInterval(b.poly,300);a.addEventListener&&a.addEventListener("load",function(){b.poly(),a.clearInterval(c)}),a.attachEvent&&a.attachEvent("onload",function(){a.clearInterval(c)})}}}(this);</script></head><body><div class="container"><ol class="breadcrumb"><li><a href="../index.html" class="glyphicon glyphicon-home"></a></li><li><a href="f-65.html">NSIS Discussion</a></li><li class="active">Using icons from a DLL on a custom page</li></ol><p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=128934">Using icons from a DLL on a custom page</a></p><br><div class="post"><p class="post-meta"><span class="post-author text-primary">pengyou</span><br><span class="post-time small text-muted">18th March 2003 20:50 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>Using icons from a DLL on a custom page</strong><br>I want to add some icons to a custom page.<br><br>Is there a way to use icons from a DLL when creating a custom page or do I have to extract all the icons I want to use and then store the full path of each icon file in the InstallOptions INI file?</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">kichik</span><br><span class="post-time small text-muted">18th March 2003 21:00 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">I don't think that's possible, but LoadImage might surprise us. The documentation isn't very clear on it, it says it will load the icon from a file. If it does then it'll probably take the first icon in the file. Can you please test this and let us know?</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">pengyou</span><br><span class="post-time small text-muted">19th March 2003 00:52 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Thanks for the suggestion. I've not used anything in System.nsh yet, so I tried to compile the Contrib\System\System.nsi example. There were no errors but when I try to run the EXE all I get is a very brief flash of the program then it disappears.<br><br>I'm was using Win98SE and NSIS 2.0b3. I uninstalled 2.0b3, and tried 2.0b2, 2.0b1 and 2.0b0 but had no better luck with this example.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">kichik</span><br><span class="post-time small text-muted">19th March 2003 17:06 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">I am sorry, I wasn't clear enough. InstallOptions uses LoadImage to load icons and bitmaps, you don't need System to do it. You can however use ExtractIcon with System and extract the icon to an .ico file at run-time but that will be kind of a waste IMO.<br><br>I'll ask brainsucker about the System example, it happens to me too. My own examples work though...</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">brainsucker</span><br><span class="post-time small text-muted">20th March 2003 00:50 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">1. Kichik: could you please update sysfunc.nsh from system dir: change GetFullPathName to SearchPath call.<br>2. Kichik: do you have problems only with splash, i.e. with last example? What are they looking like?<br>3. pengyou: could you please remove all code between lines<br>; ---- Sample 1<br>and<br>; ---- Sample 3<br><br>from system.nsi and try to run it again? May be it'll help us to find problem...</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">pengyou</span><br><span class="post-time small text-muted">20th March 2003 03:58 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">After removing the code for examples 1 and 2, as requested, I could get the system.nsi demo to run as far as the GetFileSysTime example. The time data shown is all zero (year 0, month 0, etc) and when I click the OK button to move on to sample 7, I get a GPF at once:<br></p><pre>
<code><br>SYSTEM caused a stack fault in module KERNEL32.DLL at 0187:bff724c1.<br>Registers:<br>EAX=002a0037 CS=0187 EIP=bff724c1 EFLGS=00000283<br>EBX=ff469000 SS=018f ESP=004519ea EBP=004519fe<br>ECX=0000f343 DS=018f ESI=00451a0e FS=4dcf<br>EDX=81dc75ac ES=018f EDI=81dc75ac GS=4d56<br>Bytes at CS:EIP:<br>6a ff e8 07 ad 01 00 eb e7 55 8b ec 56 57 53 8b <br>Stack dump:<br>ff469000 81dc75b4 00451a0e 00451a2a 00451aa8 00451a84 bff729fe 81dc75ac<br>00451a0e 1697002c 01bf0020 00451a1a 00000022 00000000 00530ea0 00000000 <br></code>
</pre><br>
      Hope this helps.<br>
      <br>
      [edit]I tried removing just the lines between ;----- Sample 1 and ;----- Sample 2 and found that sample 2 worked ok (the figures for disk space seemed to be accurate).[/edit]
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br>
      <span class="post-time small text-muted">20th March 2003 11:42 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Changed to SearchPath.<br>
      <br>
      It sometimes just exits the installer as it gets to the splash. I tried to put some message boxes in there to see exactly where but everytime I change the location it exits the installer on a different location, sometimes it even works. Even when I don't add anything it sometimes works and sometimes doesn't. I don't even recompile...</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">brainsucker</span><br>
      <span class="post-time small text-muted">20th March 2003 13:57 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">All the problems beside callbacks are solved... I'll rewrite stack working rountines and post a new version in a few hours...</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br>
      <span class="post-time small text-muted">20th March 2003 14:01 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Great. Thanks :)</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Snover</span><br>
      <span class="post-time small text-muted">6th September 2004 21:35 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Sorry for dragging up an old thread but I figured it would be better to do so than to start a new one.<br>
      I'm currently not able to have InstallOptions use an icon either by setting it to MB_ICONSTOP or by specifying the path to the icon (which would be $SYSDIR\user32.dll,103). It does load .ico files. Am I missing something? Is there a system call I should make? Is there an easier way of doing this?</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br>
      <span class="post-time small text-muted">7th September 2004 20:37 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">It wasn't said it is possible, just that it might work and should be tested. According to your test, it doesn't ;)<br>
      <br>
      You can probably make it work with System.dll and some GetDlgItem and SendMessage instructions.</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Snover</span><br>
      <span class="post-time small text-muted">7th September 2004 20:57 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Check and check. Thanks! (Maybe the functionality can be added in the future, nudge nudge? ;))</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br>
      <span class="post-time small text-muted">7th September 2004 21:04 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Maybe. It might already be in InstallOptionsEx.</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Snover</span><br>
      <span class="post-time small text-muted">7th September 2004 21:18 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Negative on that one, just tested with the same result with InstallOptionsEx. Too bad, guess I'll just need to add an additional 34kB to the installer, or dive into the Windows API references again...</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">deguix</span><br>
      <span class="post-time small text-muted">8th September 2004 01:58 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"></p>

      <blockquote>
        Maybe. It might already be in InstallOptionsEx.
      </blockquote>You're really thinking I've done all for that plugin. :) That's a great idea though to add. Please post any feature request on "InstallOptionsEx" thread that I'm going to examinate them futuraly.
    </div>
    <hr>

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script type="text/javascript" src="../js/highlight.pack.js" async>
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]></script></body></html>