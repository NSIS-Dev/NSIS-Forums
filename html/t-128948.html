<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="Help: Try this code, please" />

  <title>Help: Try this code, please - NSIS Forums</title><!-- Bootstrap core CSS -->
  <link rel="stylesheet" type="text/css" href="//netdna.bootstrapcdn.com/bootswatch/3.0.1/readable/bootstrap.min.css" />
  <link rel="stylesheet" href="../css/style.css" type="text/css" /><!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!--[if lt IE 9]>
                <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
                <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->
</head>

<body>
  <div class="container">
    <!-- Put navigation bar here -->

    <ol class="breadcrumb">
      <li><a href="../index.html" class="glyphicon glyphicon-home"></a></li>

      <li><a href="f-65.html">NSIS Discussion</a></li>

      <li class="active">Help: Try this code, please</li>
    </ol>

    <p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=128948">Help: Try this code, please</a></p><br />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Joel</span><br />
      <span class="post-time small text-muted">18th March 2003 22:12 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>Help: Try this code, please</strong><br />
      Hi please try this code in your PC, it's suppose to read<br />
      the version of your windows installed<br />
      <br /></p>
      <pre>
<code><br />Function "GetWIN"<br />ReadRegStr $R0 HKLM "SOFTWARE\Microsoft\Windows\CurrentVersion" ProductName<br />StrCmp $R0 " " +1 +2<br />ReadRegStr $R0 HKLM "SOFTWARE\Microsoft\Windows NT\CurrentVersion" ProductName<br />MessageBox MB_OK $R0<br />FunctionEnd<br /></code>
</pre><br />
      <br />
      thanks :D
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
      <span class="post-time small text-muted">18th March 2003 22:44 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Are you sure the third line should contain a space between the quotes? As it seems now it will only get the NT name if the non NT name is a space which is not the case on my NT.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Joel</span><br />
      <span class="post-time small text-muted">18th March 2003 22:57 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">So you recommend like this:<br />
      <br /></p>
      <pre>
<code><br />StrCmp $R0 "" +1 +2 <br /></code>
</pre>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Joost Verburg</span><br />
      <span class="post-time small text-muted">19th March 2003 13:44 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Why not use the GetWindowsVersion function? I'm sure the results will be more reliable.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Joel</span><br />
      <span class="post-time small text-muted">19th March 2003 19:24 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">mmm, yeah ... but to many line code... it's not that I'm lazzy :)<br />
      but if I can get two or three line code the same result, why not?<br />
      After all, the Windows version "x.x.x.x" is in the same folder in<br />
      the registry.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">viper0179</span><br />
      <span class="post-time small text-muted">20th March 2003 14:12 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">By the time you figure it out you could have typed the entire code to the GetWindowsVersion function :)</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Joel</span><br />
      <span class="post-time small text-muted">20th March 2003 20:11 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Now works fine :) to me<br />
      <br /></p>
      <pre>
<code><br />ReadRegStr $R0 HKLM "SOFTWARE\Microsoft\Windows\CurrentVersion" ProductName<br />StrCmp $R0 "" +1 +2<br />ReadRegStr $R0 HKLM "SOFTWARE\Microsoft\Windows NT\CurrentVersion" ProductName<br />MessageBox MB_OK|MB_ICONSTOP $R0<br /></code>
</pre>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Joost Verburg</span><br />
      <span class="post-time small text-muted">20th March 2003 21:21 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">But is the output the same for every Windows version, or different for Server/Workstation etc.?<br />
      <br />
      And what are the outputs for all versions?<br />
      <br />
      Without this info, you cannot detect the version.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Joel</span><br />
      <span class="post-time small text-muted">20th March 2003 21:35 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Well...I din't try with those versions of Windows. :(<br />
      But in Win95/98/Me/2000/XP, my target OS's, works fine.<br />
      I'm write this code for my custom Page with info, of the user-machine.<br />
      If any Nsis users have Windows Server, or another Windows version, please<br />
      try this code...</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">DOCa Cola</span><br />
      <span class="post-time small text-muted">21st March 2003 05:52 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">i tried it with win server 2003 enterprise edition and $R0 is Microsoft Windows Server 2003</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Joel</span><br />
      <span class="post-time small text-muted">21st March 2003 20:27 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Thanks DOCa Cola, seems to be working :up:</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">DOCa Cola</span><br />
      <span class="post-time small text-muted">21st March 2003 21:17 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">np :)</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Jacob Metro</span><br />
      <span class="post-time small text-muted">22nd March 2003 20:12 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>Info</strong><br />
      I don't remember who I stole this from but it is virtually identical and has been in operation in the field for almost 6 months now. It's worked on every Windows platform it's been tried on. I thought it was in the official examples but I couldn't find it when I went back to look for it.<br />
      <br />
      <b><br />
      FUNCTION GETWINDOWSVERSION<br />
      PUSH $0<br />
      PUSH $9<br />
      ReadRegStr $0 HKLM "SOFTWARE\Microsoft\Windows NT\CurrentVersion" CurrentVersion<br />
      StrCmp $0 "" 0 label2000<br />
      ReadRegStr $0 HKLM "SOFTWARE\Microsoft\Windows\CurrentVersion" VersionNumber<br />
      StrCpy $9 $0 1<br />
      StrCmp $9 '4' 0 LABELEND<br />
      Goto Label95<br />
      Label95:<br />
      call FUNCTION95<br />
      quit<br />
      LABELEND:<br />
      MESSAGEBOX MB_OK "This installation can not continue. Please contact BLAH......."<br />
      call .onuserabort<br />
      quit<br />
      label2000:<br />
      call FUNCTION2000<br />
      quit<br />
      FunctionEnd<br /></b><br />
      <br />
      And secondly,<br />
      I tried your code on a Windows 2000 Advanced Data Server and it worked perfectly. (If I wasn't sure my code would work perfectly, I would first check the registry to see if the key queried does indeed contain the data for which I'm seeking.)</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Joel</span><br />
      <span class="post-time small text-muted">22nd March 2003 20:49 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Jacob Metro:<br />
      If you think that I stole code, dude your wrong :).<br />
      I been here at least 3 months and I've never seen that code.<br />
      Well, at least didn't dig in the search :rolleyes:<br />
      I dive in the registry to see if is it possible to grab the<br />
      "string of the Windows name".<br />
      I'm only use it has part of my IO final Page. So I use this threat<br />
      to kindly ask the nsis users to try the code to see if it work.<br />
      If this code, have been writting before, I'd like to be informed by<br />
      the creators of Nsis so I retract the *authoring* of the code.<br />
      :)</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">deguix</span><br />
      <span class="post-time small text-muted">22nd March 2003 21:00 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">I prefer the Dark Boy code. Is much simpler and give the right result (Microsoft Windows 98). And this code that you posted Jacob Metro, require other functions.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Jacob Metro</span><br />
      <span class="post-time small text-muted">24th March 2003 15:49 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>Sorry</strong><br />
      Dark Boy,<br />
      I was not saying the you stole any code. I was saying that <b>I stole the bulk of the above code</b> from some source.<br />
      <br />
      deguix,<br />
      I guess I didn't read the thread as thoroughly as I should have because I thought we were just distinguishing between a Windows NT/XP/2000 operating system and a Windows 95/98/ME one. The previous process will distinguish between the two types based on the location of registry data in each key. (I.E. in Windows 98 a \Windows NT\ key will not exist, and vise-a-versa.)<br />
      <br />
      Sincerely,<br />
      Jacob Metro</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Joel</span><br />
      <span class="post-time small text-muted">24th March 2003 21:11 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">No problem dude, :D<br />
      though welcome to the discussion :p</p>
    </div>
    <hr />

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]>
  </script>
</body>
</html>
