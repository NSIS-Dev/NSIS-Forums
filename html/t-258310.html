<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="Many buttons on Custom page" />

  <title>Many buttons on Custom page - NSIS Forums</title>
  <script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script>
  <!-- Bootstrap core CSS -->

  <link rel="stylesheet" type="text/css" href="//netdna.bootstrapcdn.com/bootswatch/3.0.1/readable/bootstrap.min.css" />
  <link rel="stylesheet" href="../css/style.css" type="text/css" /><!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!--[if lt IE 9]>
                <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
                <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->
</head>

<body>
  <div class="container">
    <!-- Put navigation bar here -->

    <ol class="breadcrumb">
      <li><a href="../index.html" class="glyphicon glyphicon-home"></a></li>

      <li><a href="f-65.html">NSIS Discussion</a></li>

      <li class="active">Many buttons on Custom page</li>
    </ol>

    <p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=258310">Many buttons on Custom page</a></p><br />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">sunlight112</span><br />
      <span class="post-time small text-muted">26th October 2006 03:52 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>Many buttons on Custom page</strong><br />
      I am trying to study InstallOptions. I see some things which I can not do.<br />
      If somebody used to pass them,please help me!!!!<br />
      In my custom page, I have 4 button and two button (View Readme and exit)<br />
      ----------------<br />
      | Button 1 |<br />
      ----------------<br />
      | Button 2 |<br />
      ----------------<br />
      | Button 3 |<br />
      ----------------<br />
      | Button 4 |<br />
      ----------------<br />
      ------ ------<br />
      |View| |Exit|<br />
      ------ ------<br />
      <br />
      I want to disable button 2,3,4.When my application run only button 1, view, and exit enable.<br />
      I also set FLAGS =DISABLES for three button and in my script,I set it<br />
      <b><br />
      WriteINIStr $INI "Field 2" "Flags" "DISABLES"<br />
      WriteINIStr $INI "Field 3" "Flags" "DISABLES"<br />
      WriteINIStr $INI "Field 4" "Flags" "DISABLES"<br /></b><br />
      It does not work.<br />
      I used to think that<br />
      <b><br />
      GetDlgItem $1 $HWNDPARENT 1<br />
      EnableWindow $1 0<br /></b><br />
      To enable/disable button but I do not know id dialog item.<br />
      If the first button is pressed, application is executed.<br />
      After finishing, button 2 is enable and button 1 is diables.<br />
      One more question, I look for information on forum and I see software <font color="red">Resource Hacker</font>.But I do not know what it work and support???<br />
      If Someone know please help me!!!<br />
      <br />
      Thank alot,</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">n_baua</span><br />
      <span class="post-time small text-muted">26th October 2006 06:49 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Hi sunlight112,<br />
      <br />
      I guess the problem with the quotes in WriteINIStr statements. Apart from that, I would suggest you to have 4 different custom pages instead one in place having 4 buttons on it. I guess the user also should be ok with it unless it is a long process.<br />
      <br />
      Resource hacker available at: <a href="http://www.angusj.com/resourcehacker/" target="_blank">http://www.angusj.com/resourcehacker/</a><br />
      XN Resource Editor<br />
      <a href="http://www.wilsonc.demon.co.uk/d10resourceeditor.htm" target="_blank">http://www.wilsonc.demon.co.uk/d10resourceeditor.htm</a><br />
      <br />
      This are both very powerful resource editors to edit any PE file(.exe/.dll). This softwares normally used for changing string, editing icons or Bitmaps and even add/remove some of the Dialog items as well. You can manuplate many things with this softwares if such Exe is not compressed with the executable packer softwares like UPX (<a href="http://upx.sourceforge.net/" target="_blank">http://upx.sourceforge.net/</a>).<br />
      <br />
      I hope, this is helpful to you.<br />
      Best of luck.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">sunlight112</span><br />
      <span class="post-time small text-muted">26th October 2006 08:03 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Thank n_baua for your reply,<br />
      Because my application need to install many software to support for it. I want to create the first page give above. When the user click on Button 1,the first software will install and follow these steps. Finishing the first, the button 1 is disenable and button 2 is enable for user to set up the second software.The process continue to the end.<br />
      If I create 4 custom page,I am worry it is difficult for user to run my installer.<br />
      Once again thank you for your document about ResourceHacker and XN Resource Editor.<br />
      I read it careful but I do not know when we use this. I can change page my custom page yet???<br />
      XN Resource Editor is a screen for us to create my dialog???<br />
      Please tell me more clearly about XN Resource Editor or ResourceHacker(RH) because I do not know to use it in NSIS.<br />
      If I use RH to change dialog and save them with file *.rec.<br />
      After that, I do not know what I can do with it.<br />
      Please hellp me!!!</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">sunlight112</span><br />
      <span class="post-time small text-muted">26th October 2006 12:24 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">I am afraid about my word if someone read my messages not clearly.<br />
      Please do not hesistace to tell me about my words.<br />
      Once things, I want to express more clearly about my questions.I only want to know how to change state of button on file ini.<br />
      In my case, I have six button (include exit and view readme) to control. I want to change the status of these buttons.<br />
      I mean when my menu run, <b>Button 1 is enable, button 2,3,4 is disable</b> . Untill finishing the first install, <b>Button 1,3,4 is disable and button 2 is enable</b><br />
      One button which user click is one application.<br />
      How can I know state of buttons to run application which is suitable??<br />
      Please help me!!!<br />
      I read these files InstallOptions and on forum carefully but I can not find out it.<br />
      I am sorry for my bad words,<br />
      Thank in advance,<br />
      :)</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
      <span class="post-time small text-muted">26th October 2006 12:52 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">The flag name is DISABLED not DISABLES and the control id of the buttons is not 1. The first control is 1200, the second 1201 and so on. You can also get the HWND from the INI after the dialog shows. Every field has the HWND value after InstallOptions loads the INI. There's no need for GetDlgItem.<br />
      <br />
      Resource Hacker is not related to InstallOptions, it for something else.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">sunlight112</span><br />
      <span class="post-time small text-muted">27th October 2006 04:05 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Thank Kichik,<br />
      Now I can do it well. However, I have one more question.<br />
      In my case, user click on BUTTON 1 to run my application,the other buttons is disable.After finishing process, I want to disable button 1 and enable button 1 to install the second application.<br />
      My code here:<br /></p>
      <pre>
<code><br />;$INI is file menu.ini<br /><br />Function .onInit<br /><font color="blue"><br />        WriteINIStr $INI "Field 2" "Flags" "DISABLED"<br />        WriteINIStr $INI "Field 3" "Flags" "DISABLED"<br />        WriteINIStr $INI "Field 4" "Flags" "DISABLED"<br /></font><br />FunctionEnd<br />Function ShowCustom<br />  InstallOptions::initDialog /NOUNLOAD "$INI"<br />  Pop $0<br />  InstallOptions::show<br />  Pop $0<br />FunctionEnd<br />Function LeaveCustom1<br />        ReadINIStr $0 $INI "Settings" "State"<br />        StrCmp $0 1 Button1<br />        StrCmp $0 2 Button2<br />        StrCmp $0 3 Button3<br />        StrCmp $0 4 Button4<br />        StrCmp $0 0  ReadMe<br />        Abort<br />      Button1:<br />         SetOutPath $PLUGINSDIR<br />         File "c:\test\java.exe"<br />         Exec "$PLUGINSDIR\java.exe"<br /><font color="red"><br />         WriteINIStr $INI "Field 1" "Flags" "DISABLED"<br />         WriteINIStr $INI "Field 2" "Flags" <font color="blue">""</font><br /></font><br />        Button2:<br />         File "c:\test\mysql.exe"<br />         Exec "$PLUGINSDIR\mysql.exe"<br /><font color="green"><br />         WriteINIStr $INI "Field 2" "Flags" "DISABLED"<br />         WriteINIStr $INI "Field 3" "Flags" <font color="blue">""</font><br /></font><br />        <br />        Button3:<br />         File "c:\test\test_game.exe"<br />         Exec "$PLUGINSDIR\test_game.exe"<br /><font color="red"><br />         WriteINIStr $INI "Field 3" "Flags" "DISABLED"<br />         WriteINIStr $INI "Field 4" "Flags" <font color="blue">""</font><br /></font><br />        Button4:<br />         File "c:\test\myproduct.exe"<br />         Exec "$PLUGINSDIR\myproduct.exe"<br /><font color="green"><br />         WriteINIStr $INI "Field 4" "Flags" "DISABLED"<br /></font><br /><br />        ReadMe:<br />             SetOutPath $PLUGINSDIR<br />             File "e:\server\script\readme.txt"<br />             ExecWait "readme.txt"<br />             Abort<br />FunctionEnd<br /></code>
</pre><br />
      My question:<br />
      + I do not know how to change state button from disable to enable and otherwise when I has already shown custom page.<br />
      + In my code, ReadMe part also does not execute file readme.<br />
      Your help is very useful for me,<br />
      Thank a lot,
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Animaether</span><br />
      <span class="post-time small text-muted">29th October 2006 09:51 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">your script is fraught with issues, I'm afraid<br />
      <br /></p>
      <pre>
<code><br />Function .onInit<br />        WriteINIStr $INI "Field 2" "Flags" "DISABLED"<br />        WriteINIStr $INI "Field 3" "Flags" "DISABLED"<br />        WriteINIStr $INI "Field 4" "Flags" "DISABLED"<br />FunctionEnd<br /></code>
</pre><br />
      <br />
      Is $INI hardcoded to a specific location? Consider using the plugins folder instead:<br />
      <pre>
<code><br />        InitPluginsDir<br />        File /oname=$PLUGINSDIR\test.ini test.ini<br /></code>
</pre><br />
      <br />
      Next point.. you change the Flags for the buttons to "DISABLED" - by doing so, you clear the "NOTIFY" flag, so the user can't press them. You should set "DISABLED|NOTIFY" instead:<br />
      <pre>
<code><br />        InitPluginsDir<br />        File /oname=$PLUGINSDIR\test.ini test.ini<br />        WriteINIStr "$PLUGINSDIR\test.ini" "Field 2" "Flags" "DISABLED|NOTIFY"<br />        WriteINIStr "$PLUGINSDIR\test.ini" "Field 3" "Flags" "DISABLED|NOTIFY"<br />        WriteINIStr "$PLUGINSDIR\test.ini" "Field 4" "Flags" "DISABLED|NOTIFY"<br /></code>
</pre><br />
      <br />
      However, if the buttons should be disabled by default anyway - consider hard-coding that in the .ini, and do away with those WriteINIStr's altogether.<br />
      <br />
      Now to enable/disable buttons...<br />
      You'll want a variable to hold the InstallOptions dialog's handle:<br />
      <pre>
<code><br />var hwnd<br /></code>
</pre><br />
      <br />
      Then store that handle when you initialize the dialog (note that this also shows how to re-use that $PLUGINSDIR here):<br />
      <pre>
<code><br />Function ShowCustom<br />InstallOptions::initDialog /NOUNLOAD "$PLUGINSDIR\test.ini"<br />  Pop $hwnd<br />  InstallOptions::show<br />  Pop $0<br />FunctionEnd<br /></code>
</pre><br />
      <br />
      Now you can use GetDlgItem to get the button(s), and enable/disable them at will. I've condensed your code a bit for clarity here. Note how it makes use of $hwnd:<br />
      <pre>
<code><br />Function LeaveCustom<br />        ReadINIStr $0 "$PLUGINSDIR\test.ini" "Settings" "State"<br />        MessageBox MB_OK "Leave value: $0"<br />        StrCmp $0 1 Button1<br />        StrCmp $0 2 Button2<br />        StrCmp $0 3 Button3<br />        StrCmp $0 4 Button4<br />        StrCmp $0 0  ReadMe<br />        Abort<br />    Button1:<br />                MessageBox MB_OK "Button 1 pressed"<br />                GetDlgItem $1 $hwnd 1200<br />                EnableWindow $1 0<br />                GetDlgItem $1 $hwnd 1201<br />                EnableWindow $1 1<br />                Abort<br />        Button2:<br />                MessageBox MB_OK "Button 2 pressed"<br />                GetDlgItem $1 $hwnd 1201<br />                EnableWindow $1 0<br />                GetDlgItem $1 $hwnd 1202<br />                EnableWindow $1 1<br />                Abort<br />; etc. for the other buttons!<br /></code>
</pre><br />
      <br />
      Lastly, for your readme...<br />
      <pre>
<code><br />        ReadMe:<br />             SetOutPath $PLUGINSDIR<br />             File "e:\server\script\readme.txt"<br />             ExecWait "readme.txt"<br />             Abort<br /></code>
</pre><br />
      Two things...<br />
      1. you are extracting the file to $PLUGINSDIR, so you should also execute it from that location, not just as "readme.txt"<br />
      2. ExecWait does not take documents/etc. as a command, only applications (with optional parameters).<br />
      <br />
      So try..<br />
      <pre>
<code><br />    ReadMe:<br />                SetOutPath $PLUGINSDIR<br />                File "c:\temp\readme.txt"<br />                ExecWait "notepad.exe $PLUGINSDIR\readme.txt"<br />                Abort<br /></code>
</pre><br />
      <br />
      or, more cleanly as it does not assume "notepad.exe" to exist and will use the user's default application for handling .txt files:<br />
      <br />
      <pre>
<code><br />    ReadMe:<br />                SetOutPath $PLUGINSDIR<br />                File "c:\temp\readme.txt"<br />                ExecShell "open" "$PLUGINSDIR\readme.txt"<br />                Abort<br /></code>
</pre><br />
      <br />
      I hope this helps :)
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">sunlight112</span><br />
      <span class="post-time small text-muted">30th October 2006 02:36 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Thank Animaether very much,<br />
      Now I can run my application well.</p>
    </div>
    <hr />

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]>
  </script>
</body>
</html>
