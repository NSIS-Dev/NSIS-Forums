<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="description" content="New and improved skinnedbutton plugin"><title>New and improved skinnedbutton plugin - NSIS Forums</title><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script><link rel="preload" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css" as="style" onload="this.rel='stylesheet'"><link rel="preload" href="../css/style.css" as="style" onload="this.rel='stylesheet'"><noscript><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css"><link rel="stylesheet" href="../css/style.css"></noscript><script>!function(a){"use strict";var b=function(b,c,d){function e(a){return h.body?a():void setTimeout(function(){e(a)})}function f(){i.addEventListener&&i.removeEventListener("load",f),i.media=d||"all"}var g,h=a.document,i=h.createElement("link");if(c)g=c;else{var j=(h.body||h.getElementsByTagName("head")[0]).childNodes;g=j[j.length-1]}var k=h.styleSheets;i.rel="stylesheet",i.href=b,i.media="only x",e(function(){g.parentNode.insertBefore(i,c?g:g.nextSibling)});var l=function(a){for(var b=i.href,c=k.length;c--;)if(k[c].href===b)return a();setTimeout(function(){l(a)})};return i.addEventListener&&i.addEventListener("load",f),i.onloadcssdefined=l,l(f),i};"undefined"!=typeof exports?exports.loadCSS=b:a.loadCSS=b}("undefined"!=typeof global?global:this);!function(a){if(a.loadCSS){var b=loadCSS.relpreload={};if(b.support=function(){try{return a.document.createElement("link").relList.supports("preload")}catch(b){return!1}},b.poly=function(){for(var b=a.document.getElementsByTagName("link"),c=0;c<b.length;c++){var d=b[c];"preload"===d.rel&&"style"===d.getAttribute("as")&&(a.loadCSS(d.href,d,d.getAttribute("media")),d.rel=null)}},!b.support()){b.poly();var c=a.setInterval(b.poly,300);a.addEventListener&&a.addEventListener("load",function(){b.poly(),a.clearInterval(c)}),a.attachEvent&&a.attachEvent("onload",function(){a.clearInterval(c)})}}}(this);</script></head><body><div class="container"><ol class="breadcrumb"><li><a href="../index.html" class="glyphicon glyphicon-home"></a></li><li><a href="f-65.html">NSIS Discussion</a></li><li class="active">New and improved skinnedbutton plugin</li></ol><p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=240363">New and improved skinnedbutton plugin</a></p><br><div class="post"><p class="post-meta"><span class="post-author text-primary">OldGrumpy</span><br><span class="post-time small text-muted">9th March 2006 15:29 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>New and improved skinnedbutton plugin</strong><br>Hi folks,<br><br>after playing around with alternative UIs, I found that particularly the UltraModernUI looks pretty ugly (haha, nice pun) without properly skinned buttons. So I examined what I could find and the preliminary result is a new version of the skinnedbutton plugin. However, this is not the only component required for proper skinning at the moment. I included some basic instructions for everybody who is interested in properly skinned buttons with NSIS.<br><br>Most problems with skinned buttons are caused by two lines in the NSIS source file ui.c, namely lines 98 and 553 (line numbers taken from 2.15 release version source), where a button gets set to BS_PUSHBUTTON resp. BS_DEFPUSHBUTTON which voids the flag BS_OWNERDRAW that is mandatory for skinned buttons. The obvious solution to this would be checking the button status and leaving the button alone if it has BS_OWNERDRAW set. For my tests, I hardcoded BS_OWNERDRAW here, which works nicely, it just demands a skinning plugin then :)<br><br>The second change I did was editing the GUI exe, dialog 106, resource ID 1027 ("Show Details" button) where I replaced BS_PUSHBUTTON with BS_OWNERDRAW again.<br><br>With these modification, I now have a UMUI interface with properly skinned buttons. :D<br><br>And by the way, I also fixed the crash bug in the skinnedbutton.dll :)<br><br>Please test the plugin and my suggestions and let me know what you think of it!</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">OldGrumpy</span><br><span class="post-time small text-muted">9th March 2006 15:31 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">I shouldn't have clicked on the preview button :( Here is the attachment :)</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">zeeh3</span><br><span class="post-time small text-muted">9th March 2006 18:02 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Fine, but... where are the examples? I could not find them inside the .rar file.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">zeeh3</span><br><span class="post-time small text-muted">9th March 2006 18:35 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Ok, I have followed the txt file and it is working fine, except for the buttons created inside custom pages (.ini), the back buttons of custom pages and message alerts like MessageBox.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">OldGrumpy</span><br><span class="post-time small text-muted">9th March 2006 20:08 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Oops, forgot to package the examples :( However, they didn't change from the last version and I need to create a better version anyway :) Can you please attach a sample script so I can get an idea of what does not work? Thanks :)</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">zeeh3</span><br><span class="post-time small text-muted">10th March 2006 03:36 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Now I can see that it is working, I have something wrong with my code... sorry.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">OldGrumpy</span><br><span class="post-time small text-muted">10th March 2006 05:00 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">No problem, I know the plugin is not perfect yet, Windows is all nice and okay as long as you don't take a peek inside. ;) As soon as you want some extra eye-candy, hell breaks loose :)</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">zeeh3</span><br><span class="post-time small text-muted">10th March 2006 10:12 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Ok, I have found out the problem, if any messagebox appears before the custom page, the back button and all buttons created with .ini file become unskinned in the custom page. See your e-mail for the script and ini file.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">OldGrumpy</span><br><span class="post-time small text-muted">10th March 2006 10:45 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Thanks for testing, I'll have a look at that combination and see if I can fix it today. If not, you'll have to wait till monday :)</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">zeeh3</span><br><span class="post-time small text-muted">10th March 2006 15:48 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">This is happening with wansis too...</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">dandaman32</span><br><span class="post-time small text-muted">10th March 2006 18:29 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"></p><blockquote>This is happening with wansis too...</blockquote>SkinnedButton is based on wansis, therefore they tend to share bugs. ;)<br><br>@OldGrumpy: Feature request: buttons change image on mouse hover<br><br>Great work :)<br><br>-dandaman32</div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">SuperPat</span><br><span class="post-time small text-muted">10th March 2006 21:03 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Very good work!<br><br>I will include your modifications to my future 1.2 version that I currently develop.<br><br>If, moreover, you know how to make a color of the image of the button transparent (the pixel in top left will indicate the color has to make transparent) if the option /transparency is used.<br><br>Good idea which the image change on mouse over, i don't know how to do that.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">SuperPat45</span><br><span class="post-time small text-muted">10th March 2006 23:05 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Good evening,<br><br><br>I had made some modifications on the code of SkinnedButton for the next version (based on the very last version published of wansis).<br><br>OldGrumpy, if you want to correct the bugs, can you do it on this version?<br><br>You found a attach file with a development version of the future 1.2 version.<br>I saw that with the plugin 1.1b, when we did not apply the instructions to correct the problems of unskinned buttons, if we clicks on the button "show detail", the next an back buttons are unskinned, this work in the version being in the file.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">OldGrumpy</span><br><span class="post-time small text-muted">14th March 2006 08:41 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Okay, I'll continue work with the updated 1.2dev version. Button effect on mouse hover can be done, it's just a bit of math necessary without a framework ;) Unfortunately, the current approach seems to be a bit limited because I found out that not every button can be reached with the current method. I am currently looking into a "completely different" approach which should deliver more reliability, more flexibility and more features. Btw, for the mouse effect, I'd need a new bitmap, modifying the color values on mouse hover is not a good idea, painting a bitmap is much faster. Could anyone lay their hands on the sample bitmaps that come with the skinnedbutton plugin and create bitmaps with three or preferrably four states?<br>(disabled, normal, pushed, highlighted, pick your order as you like, just stay consistent :) )</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">OldGrumpy</span><br><span class="post-time small text-muted">14th March 2006 17:23 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">@SuperPat45:<br><br>What are these lines in FrameWndProc() for?<br><br>static HMENU pm;<br>static HWND tt; //Tooltip control<br><br>I don't see them referenced anywhere but in a DestroyWindow(tt) call shortly after.</p></div><hr><div class="footer"><p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p></div></div><script src="../js/highlight.pack.js" type="text/javascript"></script><script type="text/javascript">//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]></script></body></html>