<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="Couple questions: trialware and admin user" />

  <title>Couple questions: trialware and admin user - NSIS Forums</title>
  <script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script>
  <!-- Bootstrap core CSS -->

  <link rel="stylesheet" type="text/css" href="//netdna.bootstrapcdn.com/bootswatch/3.0.1/readable/bootstrap.min.css" />
  <link rel="stylesheet" href="../css/style.css" type="text/css" /><!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!--[if lt IE 9]>
                <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
                <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->
</head>

<body>
  <div class="container">
    <!-- Put navigation bar here -->

    <ol class="breadcrumb">
      <li><a href="../index.html" class="glyphicon glyphicon-home"></a></li>

      <li><a href="f-65.html">NSIS Discussion</a></li>

      <li class="active">Couple questions: trialware and admin user</li>
    </ol>

    <p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=243887">Couple questions: trialware and admin user</a></p><br />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Tom Redyns</span><br />
      <span class="post-time small text-muted">19th April 2006 01:32 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>Couple questions: trialware and admin user</strong><br />
      Hello,<br />
      <br />
      I've been reading the NSIS and haven't quite found an answer to the following questions pertaining to my desktop installer. The questions are:<br />
      <br />
      1. What type of NSIS strategy can I user to do a "15" day trialware installasion?<br />
      <br />
      2. Upon reinstalling on the 20th day, still disallow the user to use the application until they purchase a license?<br />
      <br />
      3. How do I mandate that the user installing my desktop application has administrator or administrator group acccess?<br />
      <br />
      4. How do I ensure my installation allows all users for the desktop to use the application?<br />
      <br />
      Thanks...Tom</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Red Wine</span><br />
      <span class="post-time small text-muted">19th April 2006 02:50 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"></p>

      <blockquote>
        3. How do I mandate that the user installing my desktop application has administrator or administrator group acccess?<br />
        <br />
        4. How do I ensure my installation allows all users for the desktop to use the application?
      </blockquote>For case 3 and case 4 <a href="http://nsis.sourceforge.net/Category:User_Accounts_Related_Functions" target="_blank">look here</a>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">sissy</span><br />
      <span class="post-time small text-muted">19th April 2006 03:03 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>Re: Couple questions: trialware and admin user</strong><br /></p>

      <blockquote>
        1. What type of NSIS strategy can I user to do a "15" day trialware installasion?<br />
        <br />
        2. Upon reinstalling on the 20th day, still disallow the user to use the application until they purchase a license?
      </blockquote>I personally would build this function into the application itself not the installer code.<br />
      <br />
      Your application is going to have to read an import the license details as once its installed it will be the only code executing.
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Tom Redyns</span><br />
      <span class="post-time small text-muted">19th April 2006 21:58 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>Re: Couple questions: trialware and admin user</strong><br /></p>

      <blockquote>
        <i>Originally posted by Red Wine</i><br />
        <b>For case 3 and case 4 <a href="http://nsis.sourceforge.net/Category:User_Accounts_Related_Functions" target="_blank">look here</a></b>
      </blockquote>Thank you very much. I'll look into this.<br />
      <br />
      Tom
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Tom Redyns</span><br />
      <span class="post-time small text-muted">19th April 2006 22:06 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>Re: Re: Couple questions: trialware and admin user</strong><br /></p>

      <blockquote>
        <i>Originally posted by sissy</i><br />
        <b>I personally would build this function into the application itself not the installer code.<br />
        <br />
        Your application is going to have to read an import the license details as once its installed it will be the only code executing.</b>
      </blockquote>Yes I agree with building this functionality into my application. I do plan on making a new trialware release nightly and automatically uploading that to my website's "download trialware" webpage.<br />
      <br />
      However, if the same user downloads my demo after "20" days and do a re-install they will have a new "15" demo. There was nothing saved to the desktop machine on the first installation.<br />
      <br />
      A little history about myself: I've done 8+ years of Java desktop application for companies not needing installation (this application is my first installable desktop application).<br />
      <br />
      I believe the answer lies within the Windows Registry and I've read alot of documentation about NSIS and it's registry function names. However I've read alot about if you screw-up your registry you can screw up your machine to where it won't boot. There exists alot of trialware software out there and would seem the strategy of actually implementing the trialware concept is common knowledge. However I'm having trouble researching the topic to get a better understanding of the concept. And thus the question posted to NSIS.<br />
      <br />
      Thanks...Tom
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">dandaman32</span><br />
      <span class="post-time small text-muted">20th April 2006 01:24 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">I've written a proprietary NSIS library that can store info in the registry and use activation keys with check digits and expiration after a certain amount of time - <a href="http://xpui.sourceforge.net/experienceui/contact" target="_blank">contact me</a> for licensing details. It's not free because I use the code for my installer dev services and I can't make it widely available for download.<br />
      <br />
      -dandaman32</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Neuron</span><br />
      <span class="post-time small text-muted">20th April 2006 05:14 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Messing up around with the registry is somewhat risky and makes user system slower in the end, a good idea but not the safer way I think.<br />
      <br />
      In my Trialware I prefer to do a "secret" 'CreateFile()' on system folder, into this file you might save a struct containing a simple 'Int' or many other variables you should need. Then, everytime the program loads it should read this struct from file, incrementing the secret 'Int' by 1 until you decide how many times you let the user to use the program, of course you could make the file with hidden attribute so it helps a little bit with our stealth technique xD. Use something like .raw, .iso, .img or the like in file extension, avoinding executable ones.<br />
      <br />
      Uninstaller should not delete this *secret* file in the system folder, so, everytime user installs your prog in same PC, the program will detect in structure the Trial end.<br />
      <br />
      I prefer to use 'Execution counting' than 'Trial days' counting, cause in the last case, you need to use system clock to keep a solid counting, or having your app to add hours while executing and saving them to a file(whatta mess!) cause you never know if user will use some app to cheat your program about time anyway, or even worst PC system clock might be failing(low battery).<br />
      <br />
      Many advanced software vendors use this file technique, cause otherwise the only thing that gets bloated up is the system or windows folder, not the sensitive, angrier and fragmentable Windows Registry. Furthermore, a good registry cleaner could delete this ghost Trial entry.<br />
      <br />
      For better results I strongly recommend to use Win32 API,<br />
      stable, quicker, the best multiplatform solution.<br />
      <br />
      Cheerz!<br />
      <br />
      Prex In Aeternum.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Tom Redyns</span><br />
      <span class="post-time small text-muted">25th April 2006 02:11 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"></p>

      <blockquote>
        <i>Originally posted by Red Wine</i><br />
        <b>For case 3 and case 4 <a href="http://nsis.sourceforge.net/Category:User_Accounts_Related_Functions" target="_blank">look here</a></b>
      </blockquote>Thanks for the answer to #3. I've incorporated it.<br />
      <br />
      However I'm at a loss for the script to have my install take affect for all users. I'd like to have my desktop icon placed on the desktop as well as the Start/Programs to list my program's entry.<br />
      <br />
      Thanks...Tom
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Tom Redyns</span><br />
      <span class="post-time small text-muted">25th April 2006 03:16 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"></p>

      <blockquote>
        <i>Originally posted by Tom Redyns</i><br />
        <b>Thanks for the answer to #3. I've incorporated it.<br />
        <br />
        However I'm at a loss for the script to have my install take affect for all users. I'd like to have my desktop icon placed on the desktop as well as the Start/Programs to list my program's entry.<br />
        <br />
        Thanks...Tom</b>
      </blockquote>The answer to my issue is to do the following right before I do my<br />
      <br />
      CreateDirectory "$SMPROGRAMS\..."<br />
      CreateShortCut "$SMPROGRAMS\..."<br />
      <br />
      with<br />
      <br />
      SetShellVarContext all<br />
      <br />
      Thanks...Tom
    </div>
    <hr />

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]>
  </script>
</body>
</html>
