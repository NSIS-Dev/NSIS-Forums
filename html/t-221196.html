<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="Trying to create an Updater program." />

  <title>Trying to create an Updater program. - NSIS Forums</title>
  <script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script>
  <!-- Bootstrap core CSS -->

  <link rel="stylesheet" type="text/css" href="//netdna.bootstrapcdn.com/bootswatch/3.0.1/readable/bootstrap.min.css" />
  <link rel="stylesheet" href="../css/style.css" type="text/css" /><!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!--[if lt IE 9]>
                <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
                <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->
</head>

<body>
  <div class="container">
    <!-- Put navigation bar here -->

    <ol class="breadcrumb">
      <li><a href="../index.html" class="glyphicon glyphicon-home"></a></li>

      <li><a href="f-65.html">NSIS Discussion</a></li>

      <li class="active">Trying to create an Updater program.</li>
    </ol>

    <p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=221196">Trying to create an Updater program.</a></p><br />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">dive2xs</span><br />
      <span class="post-time small text-muted">11th July 2005 15:30 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>Trying to create an Updater program.</strong><br />
      I have searched the forum but have not found what I am looking for.<br />
      <br />
      I have used NSIS to create an installer. It works fine, creating files and links.<br />
      <br />
      The installer does not create any registry keys. The program the installer installs, however does create a registry key for values.<br />
      <br />
      HKCU/Software/program name<br />
      There is 1 REG_SZ and 4 REG_Binary keys in the directory.<br />
      <br />
      I want to create an installer that will only work if the following exists:<br />
      <br />
      1. the program "exe" file exists<br />
      2. the program "dll" file exists<br />
      3. the programs regkey exists<br />
      <br />
      I have got 1 &amp; 2 figured out. How do I do #3.<br />
      <br />
      Should I be doing anything else? Should i be creating additional reg keys?<br />
      <br />
      My uninstaller will delete everything and is linked from the start menu.<br />
      <br />
      Thanks for your assistance,<br />
      <br />
      Brett<br />
      <br />
      P.s. I am not a heavy programmer, so simplicity is devine!</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">scully13</span><br />
      <span class="post-time small text-muted">11th July 2005 16:07 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">It sounds like you need something like this:<br />
      <br />
      ReadRegStr $R3 HKCU \<br />
      "SOFTWARE\Company Name\Software Title" \<br />
      "LastInstallPath"<br />
      StrCmp $R3 "" 0 installed<br />
      MessageBox MB_OK "Must not be installed."<br />
      Goto end<br />
      installed:<br />
      MessageBox MB_OK "Software Found."<br />
      end:</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
      <span class="post-time small text-muted">11th July 2005 18:44 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">You can also check for errors after attempting to read from the registry key. This ensures that it will fail even if the value is "".<br />
      <br />
      ClearErrors<br />
      ReadRegStr ...<br />
      IfErrors ...<br />
      <br />
      -Stu</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Luxor</span><br />
      <span class="post-time small text-muted">13th March 2007 21:33 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Hi! I'm new on this forum, I have a trouble with realization of updater. The process of updating must be executed on http, ftp protocols or on local network(from share folders). I have a next idea:<br />
      1.when update program started, user can choose the way of update. There are 5 ways: first - by http with preset paths;<br />
      second - by http, but user will assign the way manually;third and fourth ways are the same but protocol is ftp; fifth way is - user assign the path to local resourse(shared folder).<br />
      2.Thereby we choose the server where are located files which must be copied on user machine to update the software.<br />
      3.I think on server must be locate a text or ini file in which described the files to update(name, date of modification, size, version). Also the same file must be locate on the user machine, but there must be described files, which are installed on user's machine.<br />
      Then updater must compare the filelist from on the server with filelist from users machine(by date, size or version) and in the next window display in the listbox the files which user must update.<br />
      May be anybody have expirience in this i'll be glad to know anything about this. I dont, know how to compare the ini or text files. There are exists function "TextCompare" in NSIS, but it doesn't work, I don't know why.<br />
      May be my idea is bad and incorrect,i'll be pleased to hear any new information.<br />
      I've used the SwUpdata by AfrowUK it's good product and I think it wil be usefull to me, but i'm beginner in NSIS and some details is not clear for me yet. I'm sorry for my language, i'm from Russia.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Red Wine</span><br />
      <span class="post-time small text-muted">13th March 2007 22:09 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Comparing to mine, your english are perfect :)<br />
      Definitely INI is the way to go, see NSIS manual,<br />
      <br />
      <a href="http://nsis.sourceforge.net/Docs/Chapter4.html#4.9.2" target="_blank">http://nsis.sourceforge.net/Docs/Chapter4.html#4.9.2</a><br />
      <br />
      also, a good forum search, I'm sure will come up with many details.</p>
    </div>
    <hr />

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]>
  </script>
</body>
</html>
