<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="latest version of path extensions?" />

  <title>latest version of path extensions? - NSIS Forums</title><!-- Bootstrap core CSS -->
  <link rel="stylesheet" type="text/css" href="//netdna.bootstrapcdn.com/bootswatch/3.0.1/readable/bootstrap.min.css" />
  <link rel="stylesheet" href="../css/style.css" type="text/css" /><!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!--[if lt IE 9]>
                <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
                <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->
</head>

<body>
  <div class="container">
    <!-- Put navigation bar here -->

    <ol class="breadcrumb">
      <li><a href="../index.html" class="glyphicon glyphicon-home"></a></li>

      <li><a href="f-65.html">NSIS Discussion</a></li>

      <li class="active">latest version of path extensions?</li>
    </ol>

    <p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=89717">latest version of path extensions?</a></p><br />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">honold</span><br />
      <span class="post-time small text-muted">2nd June 2002 07:47 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>latest version of path extensions?</strong><br />
      i need to add a couple items to the path of 2k/xp systems with an app (no installations will be performed on anything else), and remove them when it's uninstalled<br />
      <br />
      i've seen multiple copies of the path.zip that somebody whipped up around, but i'd like to ensure i have the latest/greatest/best-documented/simplest version ;) thanks.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Smile2Me</span><br />
      <span class="post-time small text-muted">2nd June 2002 09:22 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">As far as I know, there's only one thread with path.zip attached, so download that. Check:<br />
      <a href="http://forums.winamp.com/showthread.php?s=&amp;threadid=67208" target="_blank">http://forums.winamp.com/showthread....threadid=67208</a><br />
      <br />
      -Hendri.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
      <span class="post-time small text-muted">2nd June 2002 10:00 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">This is the code I use in my installer.<br />
      I think it is the same as the latest I have posted in the thread Smile2Me gave you, but here it is just to make sure.<br />
      <br />
      [edit <b>by Smile2Me</b>]<br />
      For some strange reason, the old attachment doesn't get deleted when updated by a new one. I deleted it and posted a new message and the end of this thread.<br />
      <br />
      -Hendri.<br />
      [/edit]</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">honold</span><br />
      <span class="post-time small text-muted">2nd June 2002 19:48 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">tks ;)</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">honold</span><br />
      <span class="post-time small text-muted">2nd June 2002 20:00 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">the one you gave is 5786 bytes, and only has the .nsi file<br />
      <br />
      the one in the thread is 4245 bytes, and has the refreshenv exe (with source) as well<br />
      <br />
      which one do i use, and do i use it by including it all in my existing nsi?</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
      <span class="post-time small text-muted">2nd June 2002 21:49 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">The one I gave here has the latest functions. Just integrate them into your .nsi. The funcions use the refreshenv.exe so it also required. You can ignore the .nsi files in the prior threads. This is the latest.<br />
      <br />
      To make this thread a complete source of all that is needed for this functions I have attached the refreshenv with source.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">honold</span><br />
      <span class="post-time small text-muted">3rd June 2002 23:21 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Section: "Uninstall"<br />
      Function: "un.StrStr"<br />
      Push: $0<br />
      Exch(st(1),0)<br />
      Pop: $0<br />
      Push: $1<br />
      Exch(st(2),0)<br />
      Pop: $1<br />
      Exch(st(1),0)<br />
      Push: $2<br />
      Push: $3<br />
      Push: $4<br />
      Push: $5<br />
      StrCpy $2 "-1" () ()<br />
      StrLen $3 "$0"<br />
      StrLen $4 "$1"<br />
      IntOp: $4=$4-$3<br />
      IntOp: $2=$2+1<br />
      IntCmp $2:$4 equal=0, &lt; 0, &gt; StrStrReturn_notFound<br />
      StrCpy $5 "$1" ($3) ($2)<br />
      StrCmp "$5" "$0" equal=StrStr_done, nonequal=StrStr_loop<br />
      StrCpy $2 "-1" () ()<br />
      Pop: $5<br />
      Pop: $4<br />
      Pop: $3<br />
      Exch($2,0)<br />
      Exch(st(2),0)<br />
      Pop: $0<br />
      Pop: $1<br />
      FunctionEnd<br />
      Function: "un.IsNT"<br />
      Push: $0<br />
      ReadRegStr $0 HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\CurrentVersion<br />
      StrCmp "$0" "" equal=0, nonequal=IsNT_yes<br />
      Pop: $0<br />
      Push: 0<br />
      Return<br />
      Pop: $0<br />
      Push: 1<br />
      FunctionEnd<br />
      Function: "un.RemoveFromPath"<br />
      Exch($0,0)<br />
      Push: $1<br />
      Push: $2<br />
      Push: $3<br />
      Push: $4<br />
      Call must be used with function names starting with "un." in the uninstall section.<br />
      Usage: Call function_name | [:label_name]<br />
      Error in script "H:\install\pilot.nsi" on line 258 -- aborting creation process</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">honold</span><br />
      <span class="post-time small text-muted">3rd June 2002 23:32 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">tried it outside of the uninstall section as well - it would appear that it's angry about the function starting with "un." and the calling of a function that doesn't start with "un."</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Smile2Me</span><br />
      <span class="post-time small text-muted">4th June 2002 07:35 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Honold,<br />
      <br />
      functions called from the uninstall section should start with "un." See <a href="http://www.nullsoft.com/free/nsis/makensis.htm#CBFuncs" target="_blank">http://www.nullsoft.com/free/nsis/makensis.htm#CBFuncs</a><br />
      <br />
      Check your code carefully. If you want to re-use functions in installer and uninstaller sections, use macros.<br />
      <br />
      Good luck,<br />
      -Hendri.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
      <span class="post-time small text-muted">4th June 2002 11:52 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Whoopsy... :D<br />
      <br />
      Sorry about this. I use an installer as my uninstaller so I don't use un. prefixes. A fixed version will replace the old one hopefully by the end of the day.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">honold</span><br />
      <span class="post-time small text-muted">5th June 2002 21:09 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">can you just simply explain what i need to do? is it just a matter of renaming the un.functions?</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
      <span class="post-time small text-muted">5th June 2002 23:42 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Yes, where ever you see Call something in the uninstall section replace it with un.something. I am sorry about the delay in the uploading of the corrected version. It will be availble soon, I hope.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Smile2Me</span><br />
      <span class="post-time small text-muted">6th June 2002 12:15 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">At the request of KiCHiK, the new path.zip has been uploaded. It solves the problem described in the posts above.<br />
      <br />
      Have fun,<br />
      -Hendri.</p>
    </div>
    <hr />

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]>
  </script>
</body>
</html>
