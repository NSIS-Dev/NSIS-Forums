<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="Check for RegKey" />

  <title>Check for RegKey - NSIS Forums</title>
  <script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script>
  <!-- Bootstrap core CSS -->

  <link rel="stylesheet" type="text/css" href="//netdna.bootstrapcdn.com/bootswatch/3.0.1/readable/bootstrap.min.css" />
  <link rel="stylesheet" href="../css/style.css" type="text/css" /><!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!--[if lt IE 9]>
                <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
                <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->
</head>

<body>
  <div class="container">
    <!-- Put navigation bar here -->

    <ol class="breadcrumb">
      <li><a href="../index.html" class="glyphicon glyphicon-home"></a></li>

      <li><a href="f-65.html">NSIS Discussion</a></li>

      <li class="active">Check for RegKey</li>
    </ol>

    <p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=106792">Check for RegKey</a></p><br />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">rio</span><br />
      <span class="post-time small text-muted">24th September 2002 10:31 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>Check for RegKey</strong><br />
      Hi experts :)<br />
      <br />
      I want to check a registry key during installation<br />
      unfortunatly there is a subkey (and I don´t know the<br />
      name of the subkey). So I can´t use "ReadRegStr" to check a<br />
      string of the name.<br />
      So is there a possibility to do a "CheckRegKey" (like<br />
      "DeleteRegKey") without knowing the subkeys ?<br />
      <br />
      thank and br<br />
      <br />
      rio</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
      <span class="post-time small text-muted">24th September 2002 10:52 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">What do you mean by "checking"? Do you want to know the name of that subkey? Use EnumRegKey if that's the case. EnumRegKey will give you all of the subkeys of the desired regkey one by one.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">rio</span><br />
      <span class="post-time small text-muted">24th September 2002 11:00 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">@kichik: Thanks for your fast answer :)<br />
      <br />
      <br />
      With checking I mean: Exist this RegKey ?<br />
      <br />
      EnumRegKey is fine if there are subkeys, but not on<br />
      all Win-Versions there are subkeys in the Key I want to<br />
      know if it exist. :cry:<br />
      <br />
      Perhabs I have to do make a Win-version specific solution.<br />
      <br />
      thanks<br />
      rio</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
      <span class="post-time small text-muted">24th September 2002 11:28 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">EnumRegKey returns an empty string if there are no more keys, so you can just give it the first index (0 or 1) and if it returns an emtpy string, and the error flag is not set, the key is empty. If the error flag is set, there was an error.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">rio</span><br />
      <span class="post-time small text-muted">24th September 2002 11:41 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Hi kichik,<br />
      <br />
      Thanks.<br />
      One last question :D<br />
      If a key have one subkey, what is the index of this<br />
      subkey (0 or 1)?<br />
      <br />
      best regards<br />
      rio</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
      <span class="post-time small text-muted">24th September 2002 11:45 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">From MSDN:<br />
      <br /></p>

      <blockquote>
        <b>dwIndex</b><br />
        [in] Index of the subkey to retrieve. This parameter should be zero for the first call to the RegEnumKeyEx function and then incremented for subsequent calls.<br />
        Because subkeys are not ordered, any new subkey will have an arbitrary index. This means that the function may return subkeys in any order.
      </blockquote>So zero it is :D
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">rio</span><br />
      <span class="post-time small text-muted">24th September 2002 12:05 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Thank you :up:<br />
      <br />
      rio</p>
    </div>
    <hr />

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]>
  </script>
</body>
</html>
