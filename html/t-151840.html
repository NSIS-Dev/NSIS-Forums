<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="description" content="Newbie Problem"><title>Newbie Problem - NSIS Forums</title><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script><link rel="preload" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css" as="style" onload="this.rel='stylesheet'"><link rel="preload" href="../css/style.css" as="style" onload="this.rel='stylesheet'"><noscript><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css"><link rel="stylesheet" href="../css/style.css"></noscript><script>!function(a){"use strict";var b=function(b,c,d){function e(a){return h.body?a():void setTimeout(function(){e(a)})}function f(){i.addEventListener&&i.removeEventListener("load",f),i.media=d||"all"}var g,h=a.document,i=h.createElement("link");if(c)g=c;else{var j=(h.body||h.getElementsByTagName("head")[0]).childNodes;g=j[j.length-1]}var k=h.styleSheets;i.rel="stylesheet",i.href=b,i.media="only x",e(function(){g.parentNode.insertBefore(i,c?g:g.nextSibling)});var l=function(a){for(var b=i.href,c=k.length;c--;)if(k[c].href===b)return a();setTimeout(function(){l(a)})};return i.addEventListener&&i.addEventListener("load",f),i.onloadcssdefined=l,l(f),i};"undefined"!=typeof exports?exports.loadCSS=b:a.loadCSS=b}("undefined"!=typeof global?global:this);!function(a){if(a.loadCSS){var b=loadCSS.relpreload={};if(b.support=function(){try{return a.document.createElement("link").relList.supports("preload")}catch(b){return!1}},b.poly=function(){for(var b=a.document.getElementsByTagName("link"),c=0;c<b.length;c++){var d=b[c];"preload"===d.rel&&"style"===d.getAttribute("as")&&(a.loadCSS(d.href,d,d.getAttribute("media")),d.rel=null)}},!b.support()){b.poly();var c=a.setInterval(b.poly,300);a.addEventListener&&a.addEventListener("load",function(){b.poly(),a.clearInterval(c)}),a.attachEvent&&a.attachEvent("onload",function(){a.clearInterval(c)})}}}(this);</script></head><body><div class="container"><ol class="breadcrumb"><li><a href="../index.html" class="glyphicon glyphicon-home"></a></li><li><a href="f-65.html">NSIS Discussion</a></li><li class="active">Newbie Problem</li></ol><p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=151840">Newbie Problem</a></p><br><div class="post"><p class="post-meta"><span class="post-author text-primary">soulfinger</span><br><span class="post-time small text-muted">7th October 2003 16:09 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>Newbie Problem</strong><br>I am sooo new to this it's not even funny. Well...just a little bit. Anyway my problem is that I have a setup.exe file which will need to be installed on a pocket pc device. No problem, I created the setup.exe file in embedded visual basic. Now I need the setup.exe file to be installed in the desktop program folder first then into the pocket pc. Cool..this is where NSIS comes in. I read the Modern UI read me file to see if i can use one of the scripts to accomplish this. I found a script to help me run the setup.exe after it is installed on the desktop program folder. The problem is after the NSIS installer asks me if I want to run the program "setup.exe", I get an error that says " error reading setup ini ". Does anyone know what this means and what I have to do to have the setup.exe launch. I appreciate any help at this point.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Joost Verburg</span><br><span class="post-time small text-muted">7th October 2003 16:13 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Looks like an error of your other setup application.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br><span class="post-time small text-muted">7th October 2003 16:14 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">1. Extract the setup.exe program to $DESKTOP<br>2. Use SetOutPath to set the working directory<br>3. Use Exec to run it, or if it's a command-line dos program use nsExec::Exec to run it hidden.<br><br>-Stu</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">soulfinger</span><br><span class="post-time small text-muted">7th October 2003 16:32 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">The setup.exe program runs fine before I incoporate it into NSIS. It's afterwards when I get the error reading setup ini.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br><span class="post-time small text-muted">7th October 2003 16:42 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">So your setup program requires an ini file to run?<br><br>Do you have the setup.ini file?<br>Maybe you should try:<br><br>File "/oname=$DESKTOP\setup.exe" "setup.exe"<br>File "/oname=$DESKTOP\setup.ini" "setup.ini"<br>SetOutPath $DESKTOP<br>nsExec::Exec "$DESKTOP\setup.exe"<br><br>Or similar.<br><br>-Stu</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">kichik</span><br><span class="post-time small text-muted">7th October 2003 16:43 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">But NSIS doesn't have any message like the one you've quoted. Try to do what Afrow UK suggested. Setting the working directory is probably what's missing. If the working directory is not set correctly it might not be able to find the INI file it's looking for.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">soulfinger</span><br><span class="post-time small text-muted">8th October 2003 16:22 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">I figured out why I'm getting this problem. Duh!! The setup.exe isn't a real exe file. It's actually launching a cab file. So when i put the setup.exe into NSIS that's why it comes with the ini error because they all have to be together to launch from the desktop. So..I figured that out. I'm confused what to do now. Any suggestions?</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br><span class="post-time small text-muted">8th October 2003 16:25 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">So, you just need to place the setup and cab files in the same directory, and then execute the setup.exe<br><br>What is the problem with that?<br><br>-Stu</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">soulfinger</span><br><span class="post-time small text-muted">8th October 2003 17:15 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Sorry Stu. This is all new to me. I know some don't have the patience for people like me. It's a hugh learning curve. Thanks for your help.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br><span class="post-time small text-muted">8th October 2003 17:17 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Well, like I posted above with a slight modification;<br>File "/oname=$DESKTOP\setup.exe" "setup.exe"<br>File "/oname=$DESKTOP\setup.cab" "setup.cab"<br>SetOutPath $DESKTOP<br>nsExec::Exec "$DESKTOP\setup.exe"<br><br>-Stu</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">soulfinger</span><br><span class="post-time small text-muted">8th October 2003 17:19 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Cool. I'll work on it now.<br><br>thanks!</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br><span class="post-time small text-muted">8th October 2003 17:26 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Note the above code assumes the following:<br>* setup.exe is in your nsi file's dir<br>* The cab file is called setup.cab, and is also in your nsi file's dir<br>* You want the files to be extracted to the desktop<br><br>Heres a bit of info on what they do:<br>The first File parameter /oname sets the output path &amp; name.<br>The second File parameter sets the source of the file being compressed.<br>SetOutPath will set the working directory for setup.exe (so setup.exe will look for the cab file in the working directory set, which is $DESKTOP)<br>nsExec::Exec will run the setup program invisibly (nsExec is a plugin)<br><br>-Stu</p></div><hr><div class="footer"><p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p></div></div><script type="text/javascript" src="../js/highlight.pack.js" async></script><script type="text/javascript">//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]></script></body></html>