<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="Mistake in a script... I can not understand where..." />

  <title>Mistake in a script... I can not understand where... - NSIS Forums</title><!-- Bootstrap core CSS -->
  <link rel="stylesheet" type="text/css" href="//netdna.bootstrapcdn.com/bootswatch/3.0.1/readable/bootstrap.min.css" />
  <link rel="stylesheet" href="../css/style.css" type="text/css" />
  <link rel="stylesheet" type="text/css" href="//netdna.bootstrapcdn.com/bootswatch/3.0.1/readable/bootstrap.min.css" /><!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!--[if lt IE 9]>
               <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
               <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
       <![endif]-->
</head>

<body>
  <div class="container">
    <!-- Put navigation bar here -->

    <ol class="breadcrumb">
      <li><a href="../index.html" class="glyphicon glyphicon-home"></a></li>

      <li><a href="f-65.html">NSIS Discussion</a></li>

      <li class="active">Mistake in a script... I can not understand where...</li>
    </ol>

    <p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=295670">Mistake in a script... I can not understand where...</a></p><br />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">and84</span><br />
      <span class="post-time small text-muted">8th August 2008 07:58 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>Mistake in a script... I can not understand where...</strong><br />
      Hi all!<br />
      Has written a script with custom page...<br />
      Here a part of a script...<br />
      PHP Code:</p>
      <hr />
      <code style="white-space:nowrap"><!-- php buffer start --></code><span style="color: #000000"><span style="color: #007700">....<br /></span> <span style="color: #0000BB">Pagelicense<br />
      PagecustomCustomFun</span><span style="color: #DD0000">""""<br /></span> <span style="color: #007700">!</span><span style="color: #0000BB">insertmacroMUI_PAGE_INSTFILES<br />
      <br />
      ReserveFile</span><span style="color: #DD0000">"${NSISDIR}\Plugins\InstallOptions.dll"<br /></span> <span style="color: #0000BB">ReserveFile</span><span style="color: #DD0000">"page.ini"<br />
      <br /></span> <span style="color: #007700">!</span><span style="color: #0000BB">insertmacroMUI_LANGUAGE</span><span style="color: #DD0000">"Russian"<br />
      <br /></span> <span style="color: #0000BB">Section</span><span style="color: #DD0000">"-Install"<br /></span> <span style="color: #007700">...<br /></span> <span style="color: #0000BB">SectionEnd<br />
      <br /></span> <span style="color: #007700">Function.</span><span style="color: #0000BB">oninit<br />
      InitPluginsDir<br />
      File</span><span style="color: #007700">/</span><span style="color: #0000BB">oname</span><span style="color: #007700">=</span><span style="color: #0000BB">$PLUGINSDIRpage</span><span style="color: #007700">.</span><span style="color: #0000BB">ini</span><span style="color: #DD0000">"page.ini"<br /></span> <span style="color: #0000BB">Functionend<br />
      <br /></span> <span style="color: #007700">Function</span><span style="color: #0000BB">CustomFun<br /></span> <span style="color: #007700">!</span><span style="color: #0000BB">insertmacroMUI_HEADER_TEXT</span><span style="color: #DD0000">"TEXT1""TEXT2"<br /></span> <span style="color: #007700">!</span><span style="color: #0000BB">insertmacroINSTALLOPTIONS_INITDIALOG</span><span style="color: #DD0000">"page.ini"<br /></span> <span style="color: #007700">!</span><span style="color: #0000BB">insertmacroINSTALLOPTIONS_SHOW<br />
      FunctionEnd<br /></span></span> <!-- php buffer end -->
      <hr />
      The section of installation is carried out two times. I can not understand why.<br />
      Probably I was mistaken in macros.<br />
      <br />
      Help please.<br />
      Thanks!
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">pospec</span><br />
      <span class="post-time small text-muted">8th August 2008 12:56 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">You have to post a whole script if you want help.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">and84</span><br />
      <span class="post-time small text-muted">8th August 2008 17:11 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"></p>

      <blockquote>
        <i>Originally posted by pospec</i><br />
        <b>You have to post a whole script if you want help.</b>
      </blockquote>All script...<br />
      PHP Code:
      <hr />
      <code style="white-space:nowrap"><!-- php buffer start --></code><span style="color: #000000"><span style="color: #007700">!include</span><span style="color: #DD0000">"MUI.nsh"<br /></span> <span style="color: #007700">!include</span><span style="color: #DD0000">"Locate.nsh"<br />
      <br /></span> <span style="color: #0000BB">Name</span><span style="color: #DD0000">"Setup"<br /></span> <span style="color: #0000BB">OutFile</span><span style="color: #DD0000">"Setup.exe"<br /></span> <span style="color: #0000BB">Caption</span><span style="color: #DD0000">'Setup:ÐžÐ±Ð½Ð¾Ð²Ð»ÐµÐ½Ð¸Ðµ'<br /></span> <span style="color: #0000BB">SubCaption0</span><span style="color: #DD0000">""<br /></span> <span style="color: #0000BB">CRCCheckon<br />
      XPStyleon<br />
      MiscButtonText</span><span style="color: #DD0000">"ÐÐ°Ð·Ð°Ð´""Ð’Ð¿ÐµÑ€ÐµÐ´""ÐŸÑ€ÐµÑ€Ð²Ð°Ñ‚ÑŒ""Ð“Ð¾Ñ‚Ð¾Ð²Ð¾"<br /></span> <span style="color: #0000BB">InstallButtonText</span><span style="color: #DD0000">"ÐžÐ±Ð½Ð¾Ð²Ð¸Ñ‚ÑŒ"<br /></span> <span style="color: #0000BB">ShowInstDetailsshow<br />
      CompletedText</span><span style="color: #DD0000">"ÐžÐ±Ð½Ð¾Ð²Ð»ÐµÐ½Ð¸ÐµÐ·Ð°Ð²ÐµÑ€ÑˆÐµÐ½Ð¾!Ð”Ð»ÑÐ·Ð°Ð²ÐµÑ€ÑˆÐµÐ½Ð¸ÑÐ½Ð°Ð¶Ð¼Ð¸Ñ‚ÐµÐºÐ½Ð¾Ð¿ÐºÑƒ'Ð“Ð¾Ñ‚Ð¾Ð²Ð¾'"<br />
      <br /></span> <span style="color: #007700">Var</span><span style="color: #0000BB">url<br /></span> <span style="color: #007700">Var</span><span style="color: #0000BB">ip<br /></span> <span style="color: #007700">Var</span><span style="color: #0000BB">lnk<br /></span> <span style="color: #007700">Var</span><span style="color: #0000BB">ini_xz<br /></span> <span style="color: #007700">Var</span><span style="color: #0000BB">ip_add<br />
      <br /></span> <span style="color: #007700">Var</span><span style="color: #0000BB">HWND1<br /></span> <span style="color: #007700">Var</span><span style="color: #0000BB">DLGITEM<br /></span> <span style="color: #007700">Var</span><span style="color: #0000BB">FONT<br />
      <br />
      Pagelicense<br />
      PagecustomSetCustom</span><span style="color: #DD0000">""""<br /></span> <span style="color: #007700">!</span><span style="color: #0000BB">insertmacroMUI_PAGE_INSTFILES<br />
      Licensetext</span><span style="color: #DD0000">"""ÐŸÑ€Ð¾Ð´Ð¾Ð»Ð¶Ð¸Ñ‚ÑŒ"<br /></span> <span style="color: #0000BB">LicenseData</span><span style="color: #DD0000">"lic1.rtf"<br /></span> <span style="color: #0000BB">LicenseBkColor</span><span style="color: #007700">/</span><span style="color: #0000BB">windows<br />
      LicenseForceSelectioncheckbox</span><span style="color: #DD0000">"Ð¯Ð¿Ñ€Ð¾Ñ‡Ð¸Ñ‚Ð°Ð»ÑÐ¾Ð³Ð»Ð°ÑˆÐµÐ½Ð¸ÐµÐ¸ÑÐ¾Ð³Ð»Ð°ÑÐµÐ½ÑÐµÐ³Ð¾ÑƒÑÐ»Ð¾Ð²Ð¸ÑÐ¼Ð¸!"<br />
      <br /></span> <span style="color: #0000BB">ReserveFile</span><span style="color: #DD0000">"${NSISDIR}\\Plugins\\InstallOptions.dll"<br /></span> <span style="color: #0000BB">ReserveFile</span><span style="color: #DD0000">"page.ini"<br />
      <br /></span> <span style="color: #007700">!</span><span style="color: #0000BB">insertmacroMUI_LANGUAGE</span><span style="color: #DD0000">"Russian"<br />
      <br /></span> <span style="color: #0000BB">Section</span><span style="color: #DD0000">"-init"<br /></span> <span style="color: #0000BB">StrCpy$url</span><span style="color: #DD0000">"Error"<br /></span> <span style="color: #0000BB">StrCpy$ip</span><span style="color: #DD0000">"OFF"<br /></span> <span style="color: #0000BB">StrCpy$lnk</span><span style="color: #DD0000">"OFF"<br /></span> <span style="color: #0000BB">ReadINIStr$ini_xz</span><span style="color: #DD0000">"$PLUGINSDIR\\page.ini""Field2""State"<br /></span> <span style="color: #0000BB">StrCmp$ini_xz</span><span style="color: #DD0000">"1"</span><span style="color: #0000BB">0</span><span style="color: #007700">+</span><span style="color: #0000BB">3<br />
      StrCpy$url</span><span style="color: #DD0000">"http://22.10.10.120/load"<br /></span> <span style="color: #0000BB">StrCpy$ip_add</span><span style="color: #DD0000">"22.10.10.120"<br /></span> <span style="color: #0000BB">ReadINIStr$ini_xz</span><span style="color: #DD0000">"$PLUGINSDIR\\page.ini""Field3""State"<br /></span> <span style="color: #0000BB">StrCmp$ini_xz</span><span style="color: #DD0000">"1"</span><span style="color: #0000BB">0</span><span style="color: #007700">+</span><span style="color: #0000BB">3<br />
      StrCpy$url</span><span style="color: #DD0000">"http://10.1.1.177/load"<br /></span> <span style="color: #0000BB">StrCpy$ip_add</span><span style="color: #DD0000">"10.1.1.177"<br /></span> <span style="color: #0000BB">ReadINIStr$ini_xz</span><span style="color: #DD0000">"$PLUGINSDIR\\page.ini""Field4""State"<br /></span> <span style="color: #0000BB">StrCmp$ini_xz</span><span style="color: #DD0000">"1"</span><span style="color: #0000BB">0</span><span style="color: #007700">+</span><span style="color: #0000BB">3<br />
      StrCpy$ip</span><span style="color: #DD0000">"OK"<br /></span> <span style="color: #0000BB">ReadINIStr$ini_xz</span><span style="color: #DD0000">"$PLUGINSDIR\\page.ini""Field12""State"<br /></span> <span style="color: #0000BB">StrCmp$ini_xz</span><span style="color: #DD0000">"1"</span><span style="color: #0000BB">0</span><span style="color: #007700">+</span><span style="color: #0000BB">3<br />
      StrCpy$lnk</span><span style="color: #DD0000">"OK"<br /></span> <span style="color: #0000BB">SectionEnd<br />
      Section</span><span style="color: #DD0000">"-Install"<br /></span> <span style="color: #0000BB">StrCpy</span><span style="color: #007700">$</span><span style="color: #0000BB">2</span><span style="color: #DD0000">"0"<br /></span> <span style="color: #0000BB">StrCmp$url</span><span style="color: #DD0000">"Error"</span><span style="color: #0000BB">0urlOK<br />
      DetailPrint</span><span style="color: #DD0000">"ÐžÑˆÐ¸Ð±ÐºÐ°:ÐÐµÐ¾Ð¿Ñ€ÐµÐ´ÐµÐ»ÐµÐ½Ð¿Ð°Ñ€Ð°Ð¼ÐµÑ‚Ñ€URL=$url(58x59x60x77x78)!"<br /></span> <span style="color: #0000BB">gotoerror<br />
      urlOK</span><span style="color: #007700">:<br /></span> <span style="color: #0000BB">SetOutPath$EXEDIR<br />
      DetailPrint</span><span style="color: #DD0000">"Ð¡Ð¾ÐµÐ´Ð¸Ð½ÐµÐ½Ð¸ÐµÑÑÐµÑ€Ð²ÐµÑ€Ð¾Ð¼..."<br /></span> <span style="color: #0000BB">DetailPrint</span><span style="color: #DD0000">"Ð—Ð°Ð³Ñ€ÑƒÐ·ÐºÐ°Ñ„Ð°Ð¹Ð»data.iniÑÑÐµÑ€Ð²ÐµÑ€Ð°..."<br /></span> <span style="color: #0000BB">NSISdl</span><span style="color: #007700">::</span><span style="color: #0000BB">download</span><span style="color: #007700">/</span><span style="color: #0000BB">TRANSLATE</span><span style="color: #DD0000">"Ð—Ð°Ð³Ñ€ÑƒÐ·ÐºÐ°Ñ„Ð°Ð¹Ð»data.iniÑÑÐµÑ€Ð²ÐµÑ€Ð°...""Ð¡Ð¾ÐµÐ´Ð¸Ð½ÐµÐ½Ð¸ÐµÑÑÐµÑ€Ð²ÐµÑ€Ð¾Ð¼...""ÑÐµÐº.""Ð¼Ð¸Ð½.""Ñ‡.""c""%dÐšÐ±(%d%%)Ð¸Ð·%dÐšÐ±--%d.%01dÐšÐ±/Ñ""(%d%sÐ¾ÑÑ‚Ð°Ð»Ð¾ÑÑŒ)""$url/data.ini""$EXEDIR\data.ini"<br /></span> <span style="color: #0000BB">IfFileExists</span><span style="color: #DD0000">"$EXEDIR\\data.ini"</span><span style="color: #007700">+</span><span style="color: #0000BB">4<br />
      gotoerror<br />
      DetailPrint</span><span style="color: #DD0000">"Ð§Ñ‚ÐµÐ½Ð¸ÑÑ„Ð°Ð¹Ð»Ð°..."<br /></span> <span style="color: #0000BB">next</span><span style="color: #007700">:<br /></span> <span style="color: #0000BB">IntOp</span><span style="color: #007700">$</span><span style="color: #0000BB">2</span><span style="color: #007700">$</span><span style="color: #0000BB">2</span><span style="color: #007700">+</span><span style="color: #0000BB">1<br />
      ReadINIStr$R1</span><span style="color: #DD0000">'$EXEDIR\\data.ini''FILE$2''NAME'<br /></span> <span style="color: #0000BB">ReadINIStr$R2</span><span style="color: #DD0000">'$EXEDIR\\data.ini''FILE$2''PATH'<br /></span> <span style="color: #0000BB">ReadINIStr$R3</span><span style="color: #DD0000">'$EXEDIR\\data.ini''FILE$2''CRC'<br /></span> <span style="color: #0000BB">ReadINIStr$R4</span><span style="color: #DD0000">'$EXEDIR\\data.ini''FILE$2''END'<br /></span> <span style="color: #0000BB">StrCmp$R2</span><span style="color: #DD0000">"system"</span><span style="color: #007700">+</span><span style="color: #0000BB">30<br />
      StrCmp$R2</span><span style="color: #DD0000">"BASE"</span><span style="color: #007700">+</span><span style="color: #0000BB">20<br />
      gotoend<br />
      IfFileExists</span><span style="color: #DD0000">"$EXEDIR\$R2\$R1"</span><span style="color: #007700">+</span><span style="color: #0000BB">2<br />
      gotoload<br />
      CRCCheck</span><span style="color: #007700">::</span><span style="color: #0000BB">GenCRC</span><span style="color: #DD0000">"$EXEDIR\$R2\$R1"<br /></span> <span style="color: #0000BB">Pop$R0<br />
      StrCmp$R0$R3end0<br />
      load</span><span style="color: #007700">:<br /></span> <span style="color: #0000BB">NSISdl</span><span style="color: #007700">::</span><span style="color: #0000BB">download</span><span style="color: #007700">/</span><span style="color: #0000BB">TRANSLATE</span><span style="color: #DD0000">"Ð—Ð°Ð³Ñ€ÑƒÐ·ÐºÐ°Ñ„Ð°Ð¹Ð»Ð¾Ð²Ð¿Ñ€Ð¾Ð³Ñ€Ð°Ð¼Ð¼Ñ‹...""Ð¡Ð¾ÐµÐ´Ð¸Ð½ÐµÐ½Ð¸ÐµÑÑÐµÑ€Ð²ÐµÑ€Ð¾Ð¼...""ÑÐµÐº.""Ð¼Ð¸Ð½.""Ñ‡.""c""%dÐšÐ±(%d%%)Ð¸Ð·%dÐšÐ±--%d.%01dÐšÐ±/Ñ""(%d%sÐ¾ÑÑ‚Ð°Ð»Ð¾ÑÑŒ)""$url/$R2/$R1""$EXEDIR\$R2\$R1"<br /></span> <span style="color: #0000BB">end</span><span style="color: #007700">:<br /></span> <span style="color: #0000BB">StrCmp$R4</span><span style="color: #DD0000">"END"</span><span style="color: #0000BB">0</span><span style="color: #007700">+</span><span style="color: #0000BB">3<br />
      DetailPrint</span><span style="color: #DD0000">"ÐžÐ±Ð½Ð¾Ð²Ð»ÐµÐ½Ð¸ÐµÐ·Ð°Ð²ÐµÑ€ÑˆÐµÐ½Ð¾ÑƒÑÐ¿ÐµÑˆÐ½Ð¾!"<br /></span> <span style="color: #0000BB">gotoquit<br />
      gotonext<br />
      error</span><span style="color: #007700">:<br /></span> <span style="color: #0000BB">DetailPrint</span><span style="color: #DD0000">"ÐžÑˆÐ¸Ð±ÐºÐ°:ÐÐµÑ‚Ð´Ð¾ÑÑ‚ÑƒÐ¿Ð°ÐºÑ„Ð°Ð¹Ð»Ñƒ!"<br /></span> <span style="color: #0000BB">DetailPrint</span><span style="color: #DD0000">"ÐžÐ±Ñ€Ð°Ñ‚Ð¸Ñ‚ÐµÑÑŒÐ²Ñ‚ÐµÑ….Ð¿Ð¾Ð´Ð´ÐµÑ€Ð¶ÐºÑƒÐ½Ð°Ñ„Ð¾Ñ€ÑƒÐ¼Ðµ!"<br /></span> <span style="color: #0000BB">quit</span><span style="color: #007700">:<br /></span> <span style="color: #0000BB">SectionEnd<br />
      <br />
      Section</span><span style="color: #DD0000">"-host"<br /></span> <span style="color: #0000BB">StrCmp$ip</span><span style="color: #DD0000">"OFF"</span><span style="color: #0000BB">0</span><span style="color: #007700">+</span><span style="color: #0000BB">3<br />
      DetailPrint</span><span style="color: #DD0000">"Ð’ÐÐ–ÐÐž!ÐÐµÐ¾Ð±Ñ…Ð¾Ð´Ð¸Ð¼Ð¾Ð½Ð°Ñ‚ÑÑ€Ð¾Ð¸Ñ‚ÑŒÐ¥Ð¾ÑÑ‚Ñ„Ð°Ð¸Ð»..."<br /></span> <span style="color: #0000BB">Goto</span><span style="color: #007700">exit<br /></span> <span style="color: #0000BB">CopyFiles$SYSDIRdriversetchosts$SYSDIRdriversetchosts</span><span style="color: #007700">.</span><span style="color: #0000BB">bak<br />
      FileOpen</span><span style="color: #007700">$</span><span style="color: #0000BB">0$SYSDIRdriversetchostsw<br />
      DetailPrint</span><span style="color: #DD0000">"ÐÐ²Ñ‚Ð¾Ð¼Ð°Ñ‚Ð¸Ñ‡ÐµÑÐºÐ°ÑÐ½Ð°ÑÑ‚Ñ€Ð¾Ð¹ÐºÐ°Ñ…Ð¾ÑÑ‚Ñ„Ð°Ð¹Ð»Ð°..."<br /></span> <span style="color: #0000BB">FileWrite</span><span style="color: #007700">$</span><span style="color: #0000BB">0</span><span style="color: #DD0000">"127.0.0.1localhost$\n"<br /></span> <span style="color: #0000BB">FileWrite</span><span style="color: #007700">$</span><span style="color: #0000BB">0</span><span style="color: #DD0000">"$ip_addInfo.DT.net$\n"<br /></span> <span style="color: #0000BB">FileWrite</span><span style="color: #007700">$</span><span style="color: #0000BB">0</span><span style="color: #DD0000">"$ip_addhelp.DT.net$\n"<br /></span> <span style="color: #0000BB">FileClose</span><span style="color: #007700">$</span><span style="color: #0000BB">0<br /></span> <span style="color: #007700">exit:<br /></span> <span style="color: #0000BB">SectionEnd<br />
      <br />
      <br /></span> <span style="color: #007700">Function.</span><span style="color: #0000BB">oninit<br />
      System</span><span style="color: #007700">::</span><span style="color: #0000BB">Call</span><span style="color: #DD0000">'kernel32::CreateMutexA(i0,i0,t"myMutex")i.r1?e'<br /></span> <span style="color: #0000BB">Pop</span><span style="color: #007700">$</span><span style="color: #0000BB">0<br />
      StrCmp</span><span style="color: #007700">$</span><span style="color: #0000BB">00</span><span style="color: #007700">+</span><span style="color: #0000BB">3<br />
      MessageBoxMB_OK</span><span style="color: #007700">|</span><span style="color: #0000BB">MB_ICONEXCLAMATION</span><span style="color: #DD0000">"Setup.exeÑƒÐ¶ÐµÐ·Ð°Ð¿ÑƒÑ‰ÐµÐ½!"<br /></span> <span style="color: #0000BB">Abort<br />
      IfFileExists</span><span style="color: #DD0000">"$EXEDIR\system\RunDT.exe"</span><span style="color: #007700">+</span><span style="color: #0000BB">2<br />
      MessageBoxMB_ICONSTOP</span><span style="color: #007700">|</span><span style="color: #0000BB">MB_OK</span><span style="color: #DD0000">"Setup.exeÐ½ÐµÐ¾Ð±Ñ…Ð¾Ð´Ð¸Ð¼Ð¾Ð·Ð°Ð¿ÑƒÑÐºÐ°Ñ‚ÑŒÐ¸Ð·Ð¿Ð°Ð¿ÐºÐ¸Ð¿Ñ€Ð¾Ð³Ñ€Ð°Ð¼Ð¼Ñ‹DT!"</span><span style="color: #0000BB">IDOK</span><span style="color: #007700">+</span><span style="color: #0000BB">2<br />
      MessageBoxMB_USERICON</span><span style="color: #007700">|</span><span style="color: #0000BB">MB_YESNO</span><span style="color: #007700">|</span><span style="color: #0000BB">MB_DEFBUTTON1</span><span style="color: #DD0000">"ÐžÐ±Ð½Ð¾Ð²Ð¸Ñ‚ÑŒÐ’Ð°ÑˆÐºÐ»Ð¸ÐµÐ½Ñ‚?"</span><span style="color: #0000BB">IDYES</span><span style="color: #007700">+</span><span style="color: #0000BB">2<br />
      Abort<br />
      InitPluginsDir<br />
      File</span><span style="color: #007700">/</span><span style="color: #0000BB">oname</span><span style="color: #007700">=</span><span style="color: #0000BB">$PLUGINSDIRpage</span><span style="color: #007700">.</span><span style="color: #0000BB">ini</span><span style="color: #DD0000">"page.ini"<br /></span> <span style="color: #0000BB">Functionend<br />
      <br /></span> <span style="color: #007700">Function</span><span style="color: #0000BB">SetCustom<br /></span> <span style="color: #007700">!</span><span style="color: #0000BB">insertmacroMUI_HEADER_TEXT</span><span style="color: #DD0000">"TEXT1""TEXT2"<br /></span> <span style="color: #007700">!</span><span style="color: #0000BB">insertmacroINSTALLOPTIONS_INITDIALOG</span><span style="color: #DD0000">"page.ini"<br /></span> <span style="color: #007700">!</span><span style="color: #0000BB">insertmacroINSTALLOPTIONS_READ$DLGITEM</span><span style="color: #DD0000">"page.ini""Field1""HWND"</span><span style="color: #007700">;</span><span style="color: #0000BB">Ð’Ñ‹Ð±Ð¾Ñ€<br />
      CreateFont$FONT</span><span style="color: #DD0000">"Tahoma"</span><span style="color: #0000BB">8700<br />
      SendMessage$DLGITEM</span><span style="color: #007700">${</span><span style="color: #0000BB">WM_SETFONT</span><span style="color: #007700">}</span><span style="color: #0000BB">$FONT0<br /></span> <span style="color: #007700">!</span><span style="color: #0000BB">insertmacroINSTALLOPTIONS_READ$DLGITEM</span><span style="color: #DD0000">"page.ini""Field5""HWND"</span><span style="color: #007700">;</span><span style="color: #0000BB">Ð¥Ð¾ÑÑ‚<br />
      CreateFont$FONT</span><span style="color: #DD0000">"Tahoma"</span><span style="color: #0000BB">8700<br />
      SendMessage$DLGITEM</span><span style="color: #007700">${</span><span style="color: #0000BB">WM_SETFONT</span><span style="color: #007700">}</span><span style="color: #0000BB">$FONT0<br /></span> <span style="color: #007700">!</span><span style="color: #0000BB">insertmacroINSTALLOPTIONS_READ$DLGITEM</span><span style="color: #DD0000">"page.ini""Field7""HWND"</span><span style="color: #007700">;</span><span style="color: #0000BB">ÐŸÐÐµÑ‚<br />
      CreateFont$FONT</span><span style="color: #DD0000">"Tahoma"</span><span style="color: #0000BB">8300</span><span style="color: #007700">/</span><span style="color: #0000BB">UNDERLINE<br />
      SendMessage$DLGITEM</span><span style="color: #007700">${</span><span style="color: #0000BB">WM_SETFONT</span><span style="color: #007700">}</span><span style="color: #0000BB">$FONT0<br /></span> <span style="color: #007700">!</span><span style="color: #0000BB">insertmacroINSTALLOPTIONS_READ$DLGITEM</span><span style="color: #DD0000">"page.ini""Field9""HWND"</span><span style="color: #007700">;</span><span style="color: #0000BB">ÐŸÐ_ÐµÐ°Ð»<br />
      CreateFont$FONT</span><span style="color: #DD0000">"Tahoma"</span><span style="color: #0000BB">8300</span><span style="color: #007700">/</span><span style="color: #0000BB">UNDERLINE<br />
      SendMessage$DLGITEM</span><span style="color: #007700">${</span><span style="color: #0000BB">WM_SETFONT</span><span style="color: #007700">}</span><span style="color: #0000BB">$FONT0<br /></span> <span style="color: #007700">!</span><span style="color: #0000BB">insertmacroINSTALLOPTIONS_READ$DLGITEM</span><span style="color: #DD0000">"page.ini""Field6""HWND"<br /></span> <span style="color: #0000BB">CreateFont$FONT</span><span style="color: #DD0000">"Tahoma"</span><span style="color: #0000BB">8300</span><span style="color: #007700">/</span><span style="color: #0000BB">UNDERLINE<br />
      SendMessage$DLGITEM</span><span style="color: #007700">${</span><span style="color: #0000BB">WM_SETFONT</span><span style="color: #007700">}</span><span style="color: #0000BB">$FONT0<br /></span> <span style="color: #007700">!</span><span style="color: #0000BB">insertmacroINSTALLOPTIONS_READ$DLGITEM</span><span style="color: #DD0000">"test.ini""Field2""HWND"<br /></span> <span style="color: #0000BB">CreateFont$FONT</span><span style="color: #DD0000">"Tahoma"</span><span style="color: #0000BB">8400<br />
      SendMessage$DLGITEM</span><span style="color: #007700">${</span><span style="color: #0000BB">WM_SETFONT</span><span style="color: #007700">}</span><span style="color: #0000BB">$FONT0<br /></span> <span style="color: #007700">!</span><span style="color: #0000BB">insertmacroINSTALLOPTIONS_SHOW<br />
      FunctionEnd<br />
      <br /></span> <span style="color: #007700">Function.</span><span style="color: #0000BB">onInstSuccess<br />
      StrCmp$lnk</span><span style="color: #DD0000">"OK"</span><span style="color: #0000BB">0</span><span style="color: #007700">+</span><span style="color: #0000BB">2<br />
      DetailPrint</span><span style="color: #DD0000">"Ð¡Ð¾Ð·Ð´Ð°Ð½Ð¸ÐµÑÑ€Ð»Ñ‹ÐºÐ°Ð½Ð°Ñ€Ð°Ð±Ð¾Ñ‡ÐµÐ¼ÑÑ‚Ð¾Ð»Ðµ..."<br /></span> <span style="color: #0000BB">CreateShortCut</span><span style="color: #DD0000">"$DESKTOP\RunDT.lnk""$EXEDIR\system\RunDT.exe""""$EXEDIR\system\DT.ico"<br /></span> <span style="color: #0000BB">FunctionEnd<br /></span></span> <!-- php buffer end -->
      <hr />
      Structure page.ini<br />
      PHP Code:
      <hr />
      <code style="white-space:nowrap"><!-- php buffer start --></code><span style="color: #000000"><span style="color: #007700">***91;</span><span style="color: #0000BB">Settings</span><span style="color: #007700">***93;<br /></span> <span style="color: #0000BB">NumFields</span><span style="color: #007700">=</span><span style="color: #0000BB">12<br />
      <br /></span> <span style="color: #007700">***91;</span><span style="color: #0000BB">Field1</span><span style="color: #007700">***93;<br /></span> <span style="color: #0000BB">Type</span><span style="color: #007700">=</span><span style="color: #0000BB">GroupBox<br />
      Left</span><span style="color: #007700">=</span><span style="color: #0000BB">0<br />
      Right</span><span style="color: #007700">=-</span><span style="color: #0000BB">1<br />
      Top</span><span style="color: #007700">=</span><span style="color: #0000BB">1<br />
      Bottom</span><span style="color: #007700">=-</span><span style="color: #0000BB">65<br />
      Text</span><span style="color: #007700">=</span><span style="color: #DD0000">"ÐÐ°Ñ‚Ñ€Ð¾Ð¹ÐºÐ¸Ð¾Ð±Ð½Ð¾Ð²Ð»ÐµÐ½Ð¸Ñ..."<br />
      <br /></span> <span style="color: #007700">***91;</span><span style="color: #0000BB">Field2</span><span style="color: #007700">***93;<br /></span> <span style="color: #0000BB">Type</span><span style="color: #007700">=</span><span style="color: #0000BB">RadioButton<br />
      Text</span><span style="color: #007700">=</span><span style="color: #0000BB">Ð¯Ð¸Ð·Ð³Ñ€ÑƒÐ¿Ð¿Ñ‹Home<br />
      Left</span><span style="color: #007700">=</span><span style="color: #0000BB">10<br />
      Right</span><span style="color: #007700">=-</span><span style="color: #0000BB">10<br />
      Top</span><span style="color: #007700">=</span><span style="color: #0000BB">14<br />
      Bottom</span><span style="color: #007700">=</span><span style="color: #0000BB">22<br />
      State</span><span style="color: #007700">=</span><span style="color: #0000BB">1<br />
      Flags</span><span style="color: #007700">=/</span><span style="color: #0000BB">NOTIFY<br />
      <br /></span> <span style="color: #007700">***91;</span><span style="color: #0000BB">Field3</span><span style="color: #007700">***93;<br /></span> <span style="color: #0000BB">Type</span><span style="color: #007700">=</span><span style="color: #0000BB">RadioButton<br />
      Text</span><span style="color: #007700">=</span><span style="color: #0000BB">Ð¯Ð¸Ð·Ð»Ð¾ÐºÐ°Ð»ÑŒÐ½Ð¾Ð¹ÑÐµÑ‚Ð¸DT<br />
      Left</span><span style="color: #007700">=</span><span style="color: #0000BB">10<br />
      Right</span><span style="color: #007700">=-</span><span style="color: #0000BB">10<br />
      Top</span><span style="color: #007700">=</span><span style="color: #0000BB">47<br />
      Bottom</span><span style="color: #007700">=</span><span style="color: #0000BB">57<br />
      State</span><span style="color: #007700">=</span><span style="color: #0000BB">0<br />
      Flags</span><span style="color: #007700">=/</span><span style="color: #0000BB">NOTIFY<br />
      <br /></span> <span style="color: #007700">***91;</span><span style="color: #0000BB">Field4</span><span style="color: #007700">***93;<br /></span> <span style="color: #0000BB">Type</span><span style="color: #007700">=</span><span style="color: #0000BB">checkbox<br />
      Text</span><span style="color: #007700">=</span><span style="color: #0000BB">ÐÐ°ÑÑ‚Ñ€Ð¾Ð¸Ñ‚ÑŒÑ…Ð¾ÑÑ‚</span><span style="color: #007700">-</span><span style="color: #0000BB">Ñ„Ð°Ð¸Ð»<br />
      Left</span><span style="color: #007700">=</span><span style="color: #0000BB">10<br />
      Right</span><span style="color: #007700">=-</span><span style="color: #0000BB">10<br />
      Top</span><span style="color: #007700">=</span><span style="color: #0000BB">95<br />
      Bottom</span><span style="color: #007700">=</span><span style="color: #0000BB">105<br />
      State</span><span style="color: #007700">=</span><span style="color: #0000BB">1<br />
      Flags</span><span style="color: #007700">=</span><span style="color: #0000BB">NOTABSTOP<br />
      <br /></span> <span style="color: #007700">***91;</span><span style="color: #0000BB">Field5</span><span style="color: #007700">***93;<br /></span> <span style="color: #0000BB">Type</span><span style="color: #007700">=</span><span style="color: #0000BB">GroupBox<br />
      Left</span><span style="color: #007700">=</span><span style="color: #0000BB">0<br />
      Right</span><span style="color: #007700">=-</span><span style="color: #0000BB">1<br />
      Top</span><span style="color: #007700">=</span><span style="color: #0000BB">83<br />
      Bottom</span><span style="color: #007700">=-</span><span style="color: #0000BB">1<br />
      Text</span><span style="color: #007700">=</span><span style="color: #DD0000">"Ð”Ð¾Ð¿Ð¾Ð»Ð½Ð¸Ñ‚ÐµÐ»ÑŒÐ½Ð¾..."<br />
      <br /></span> <span style="color: #007700">***91;</span><span style="color: #0000BB">Field6</span><span style="color: #007700">***93;<br /></span> <span style="color: #0000BB">Type</span><span style="color: #007700">=</span><span style="color: #0000BB">Label<br />
      Left</span><span style="color: #007700">=</span><span style="color: #0000BB">25<br />
      Right</span><span style="color: #007700">=-</span><span style="color: #0000BB">230<br />
      Top</span><span style="color: #007700">=</span><span style="color: #0000BB">106<br />
      Bottom</span><span style="color: #007700">=</span><span style="color: #0000BB">116<br />
      Text</span><span style="color: #007700">=</span><span style="color: #0000BB">ÐŸÑ€Ð¸Ð¼ÐµÑ‡Ð°Ð½Ð¸Ðµ</span><span style="color: #007700">:<br />
      <br />
      ***91;</span><span style="color: #0000BB">Field11</span><span style="color: #007700">***93;<br /></span> <span style="color: #0000BB">Type</span><span style="color: #007700">=</span><span style="color: #0000BB">Label<br />
      Left</span><span style="color: #007700">=-</span><span style="color: #0000BB">227<br />
      Right</span><span style="color: #007700">=-</span><span style="color: #0000BB">5<br />
      Top</span><span style="color: #007700">=</span><span style="color: #0000BB">106<br />
      Bottom</span><span style="color: #007700">=</span><span style="color: #0000BB">116<br />
      Text</span><span style="color: #007700">=</span><span style="color: #0000BB">Ð_ÐµÐºÐ¾Ð¼ÐµÐ½Ð´ÑƒÐµÑ‚ÑÑÐ°Ð²Ñ‚Ð¾Ð¼Ð°Ñ‚Ð¸Ñ‡ÐµÑÐºÐ°ÑÐ½Ð°ÑÑ‚Ñ€Ð¾Ð¹ÐºÐ°</span><span style="color: #007700">.<br />
      <br />
      ***91;</span><span style="color: #0000BB">Field7</span><span style="color: #007700">***93;<br /></span> <span style="color: #0000BB">Type</span><span style="color: #007700">=</span><span style="color: #0000BB">Label<br />
      Left</span><span style="color: #007700">=</span><span style="color: #0000BB">28<br />
      Right</span><span style="color: #007700">=-</span><span style="color: #0000BB">230<br />
      Top</span><span style="color: #007700">=</span><span style="color: #0000BB">25<br />
      Bottom</span><span style="color: #007700">=</span><span style="color: #0000BB">35<br />
      Text</span><span style="color: #007700">=</span><span style="color: #0000BB">ÐŸÑ€Ð¸Ð¼ÐµÑ‡Ð°Ð½Ð¸Ðµ</span><span style="color: #007700">:<br />
      <br />
      ***91;</span><span style="color: #0000BB">Field8</span><span style="color: #007700">***93;<br /></span> <span style="color: #0000BB">Type</span><span style="color: #007700">=</span><span style="color: #0000BB">Label<br />
      Left</span><span style="color: #007700">=-</span><span style="color: #0000BB">227<br />
      Right</span><span style="color: #007700">=-</span><span style="color: #0000BB">5<br />
      Top</span><span style="color: #007700">=</span><span style="color: #0000BB">25<br />
      Bottom</span><span style="color: #007700">=</span><span style="color: #0000BB">45<br />
      Text</span><span style="color: #007700">=</span><span style="color: #0000BB">Ð”Ð»ÑÐ¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÐµÐ»ÑÐ¼Ð¸Ð³Ñ€ÑƒÐ¿Ð¿Ñ‹Home</span><span style="color: #007700">.<br />
      <br />
      ***91;</span><span style="color: #0000BB">Field9</span><span style="color: #007700">***93;<br /></span> <span style="color: #0000BB">Type</span><span style="color: #007700">=</span><span style="color: #0000BB">Label<br />
      Left</span><span style="color: #007700">=</span><span style="color: #0000BB">28<br />
      Right</span><span style="color: #007700">=-</span><span style="color: #0000BB">230<br />
      Top</span><span style="color: #007700">=</span><span style="color: #0000BB">58<br />
      Bottom</span><span style="color: #007700">=</span><span style="color: #0000BB">68<br />
      Text</span><span style="color: #007700">=</span><span style="color: #0000BB">ÐŸÑ€Ð¸Ð¼ÐµÑ‡Ð°Ð½Ð¸Ðµ</span><span style="color: #007700">:<br />
      <br />
      ***91;</span><span style="color: #0000BB">Field10</span><span style="color: #007700">***93;<br /></span> <span style="color: #0000BB">Type</span><span style="color: #007700">=</span><span style="color: #0000BB">Label<br />
      Left</span><span style="color: #007700">=-</span><span style="color: #0000BB">227<br />
      Right</span><span style="color: #007700">=-</span><span style="color: #0000BB">5<br />
      Top</span><span style="color: #007700">=</span><span style="color: #0000BB">58<br />
      Bottom</span><span style="color: #007700">=</span><span style="color: #0000BB">68<br />
      Text</span><span style="color: #007700">=</span><span style="color: #0000BB">Ð¢Ð¾Ð»ÑŒÐºÐ¾Ð´Ð»ÑÐ¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÐµÐ»ÐµÐ¹Ð»Ð¾ÐºÐ°Ð»ÑŒÐ½Ð¾Ð¹ÑÐµÑ‚Ð¸</span><span style="color: #007700">.<br />
      <br />
      ***91;</span><span style="color: #0000BB">Field12</span><span style="color: #007700">***93;<br /></span> <span style="color: #0000BB">Type</span><span style="color: #007700">=</span><span style="color: #0000BB">checkbox<br />
      Text</span><span style="color: #007700">=</span><span style="color: #0000BB">Ð¡Ð¾Ð·Ð´Ð°Ñ‚ÑŒÑÑ€Ð»Ñ‹ÐºÐ½Ð°Ñ€Ð°Ð±Ð¾Ñ‡ÐµÐ¼ÑÑ‚Ð¾Ð»Ðµ</span><span style="color: #007700">.<br /></span> <span style="color: #0000BB">Left</span><span style="color: #007700">=</span><span style="color: #0000BB">10<br />
      Right</span><span style="color: #007700">=-</span><span style="color: #0000BB">10<br />
      Top</span><span style="color: #007700">=</span><span style="color: #0000BB">121<br />
      Bottom</span><span style="color: #007700">=</span><span style="color: #0000BB">131<br />
      State</span><span style="color: #007700">=</span><span style="color: #0000BB">1<br />
      Flags</span><span style="color: #007700">=</span><span style="color: #0000BB">NOTABSTOP<br /></span></span> <!-- php buffer end -->
      <hr />
    </div>
    <hr />

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]>
  </script>
</body>
</html>
