<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="Process Functions Header" />

  <title>Process Functions Header - NSIS Forums</title>
  <script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script>
  <!-- Bootstrap core CSS -->

  <link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css" />
  <link rel="stylesheet" href="../css/style.css" type="text/css" /><!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!--[if lt IE 9]>
                <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
                <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->
</head>

<body>
  <div class="container">
    <!-- Put navigation bar here -->

    <ol class="breadcrumb">
      <li><a href="../index.html" class="glyphicon glyphicon-home"></a></li>

      <li><a href="f-65.html">NSIS Discussion</a></li>

      <li class="active">Process Functions Header</li>
    </ol>

    <p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=290325">Process Functions Header</a></p><br />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">wraithdu</span><br />
      <span class="post-time small text-muted">16th April 2008 05:28 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>Process Functions Header</strong><br />
      I've written a header file with several process related functions I wanted to see in NSIS. These were inspired by PortableApps.com where we use NSIS to script the portable launchers. My goal was to accomplish everything using only the System plugin, so there are no external dependencies. Only one alternate function requires a 3rd party plugin. I hope some other people can find this useful as well.<br />
      <br />
      <a href="http://nascent-project.org/wraithdu/files/NSIS/ProcFunc.nsh" target="_blank"><b>Download ProcFunc.nsh</b></a><br />
      <br />
      ${ProcessExists}<br />
      Determines if a given process exists by name or PID, and returns the Process ID (PID).<br />
      <br />
      ${GetProcPath}<br />
      Determines first if a process exists, and returns the full path by name or PID.<br />
      <br />
      ${GetProcName}<br />
      If the process exists, returns the name by PID.<br />
      <br />
      ${ProcessPathSearch}<br />
      Searches all running process paths for a given search term, then passes that path and the process's PID to a user defined function for processing (works like the GetDrives macro). Use .::RETURN_ALL::. as the searchterm to return all running process paths.<br />
      <br />
      ${ProcessWait}<br />
      Will pause script execution until the given process exists or until timeout, by name. Will poll for the process every 500ms. Returns the process's PID, or -1 if timed out.<br />
      WARNING: this function is CPU intensive on Windows Vista. I recommend using ${ProcessWait2} if the script will be in this state for an extended period of time.<br />
      <br />
      ${ProcessWait2}<br />
      Same as ${ProcessWait}, but requires the FindProcDLL plugin, polls every 250ms, and produces much lower CPU load on Windows Vista.<br />
      <br />
      ${ProcessWaitClose}<br />
      Will pause script execution until the given process no longer exists, by name or PID. Can specify a timeout value (how long to wait), or wait indefinitely. Returns the PID of the closing process if successful, -1 if timed out.<br />
      <br />
      ${CloseProcess}<br />
      Closes a process by name or PID by sending the WM_CLOSE message to all windows owned by the process. This is the MS recommended method for closing a process. It will give you the opportunity, for example, to save an unsaved txt file open in notepad. This command will return immediately after sending the messages, so it's advisable to check when the process actually closes, ie with ${ProcessWaitClose}. Returns the closed process's PID.<br />
      <br />
      ${TerminateProcess}<br />
      Forcibly closes a process by name or PID. Returns the terminated process's PID.<br />
      <br />
      ${Execute}<br />
      Runs a process, supports commandline arguments. Allows you to optionally specify a working directory and returns the process's PID if successful, 0 if it fails.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">wraithdu</span><br />
      <span class="post-time small text-muted">16th April 2008 15:24 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Oops, quick fix in my ${ProcessWait} timeout counter.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
      <span class="post-time small text-muted">16th April 2008 22:59 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">That looks very useful and should have its own Wiki page. See the following link on creating pages on the Wiki.<br />
      <br />
      <a href="http://nsis.sourceforge.net/Starting_a_new_page" target="_blank">http://nsis.sourceforge.net/Starting_a_new_page</a><br />
      <br />
      It'd be worth mentioning this would only work on Windows NT and above on the Wiki page.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">wraithdu</span><br />
      <span class="post-time small text-muted">20th January 2010 19:59 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">I've updated ProcFunc to include, among other internal changes,<br />
      <br />
      ${GetProcessParent}<br />
      If the process exists, returns the parent process's PID.<br />
      <br />
      <a href="http://zer0dev.com/dld/download.php?id=27" target="_blank"><b>Download ProcFunc.nsh</b></a><br />
      <br />
      <a href="http://portableapps.com/node/12561" target="_blank"><b>Project thread</b></a> on PortableApps. This page will be kept up to date more so than this one.</p>
    </div>
    <hr />

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]>
  </script>
</body>
</html>
