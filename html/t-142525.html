<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="description" content="RegDLL &amp; Win 98"><title>RegDLL &amp; Win 98 - NSIS Forums</title><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script><link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css"><link rel="stylesheet" href="../css/style.css" type="text/css"><!--[if lt IE 9]><script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script><script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script><![endif]--></head><body><div class="container"><ol class="breadcrumb"><li><a href="../index.html" class="glyphicon glyphicon-home"></a></li><li><a href="f-65.html">NSIS Discussion</a></li><li class="active">RegDLL &amp; Win 98</li></ol><p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=142525">RegDLL &amp; Win 98</a></p><br><div class="post"><p class="post-meta"><span class="post-author text-primary">sandrakim90</span><br><span class="post-time small text-muted">17th July 2003 14:52 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>RegDLL &amp; Win 98</strong><br>I've created an install package to registrer an OCX file. Works great on NT, 2000, XP but on Windows 98 (IE 5) when the function below is called, Windows pops-up the following message:<br><br>MYAPPLICATION caused an invalid page fault in<br>module MYAPPLICATION .OCX at 0177:00a5602d.<br>Registers:<br>EAX=00000000 CS=0177 EIP=00a5602d EFLGS=00010246<br>EBX=00000104 SS=017f ESP=0099e390 EBP=0099e9b8<br>ECX=00000000 DS=017f ESI=00aa32d8 FS=5acf<br>EDX=0099e5a4 ES=017f EDI=00445b78 GS=0000<br>Bytes at CS:EIP:<br>66 83 20 00 59 59 89 45 fc 8d 85 f4 fd ff ff 53<br>Stack dump:<br>0099e5a4 0000002e 00000000 009b0000 00000000 00000000 00000000 00000000<br>00000100 000004e4 00000000 0099e414 00a350ff 00000000 00000200 0099e87c<br><br><br>This is the function I use to register the OCX:<br><br>Function "InstallOCX"<br>start:<br>SetOverwrite try<br>ClearErrors<br><br>SetOutPath "$INSTDIR\Bin"<br>File "C:\MyApplication.ocx"<br>IfErrors inuse<br><br>RegDLL "$INSTDIR\Bin\MyApplication.ocx"<br>Return<br><br>inuse:<br>MessageBox MB_RETRYCANCEL|MB_ICONSTOP "Unable to copy MyApplication.ocx. This file might be in use. Please close all applications using MyApplication and try again." IDRETRY start<br><br>MessageBox MB_OK|MB_ICONEXCLAMATION "Sorry, there was a problem installing MyApplication. Please reboot your computer and try again."<br>Quit<br>FunctionEnd<br><br>I have not had the opportunity to test on ME, 95 or other OS. Has anyone had similar problems with RegDLL and non-NT based Windows. Is there a way for me to trap errors like this. Thanks, Sandy.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Joost Verburg</span><br><span class="post-time small text-muted">17th July 2003 14:55 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">What kind of message do you get when you register the file using regsvr32?</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">sandrakim90</span><br><span class="post-time small text-muted">23rd July 2003 20:11 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">I get the same error when using regsvr32. I tried it on several computer and the same thing happens.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">kichik</span><br><span class="post-time small text-muted">23rd July 2003 20:16 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Maybe it doesn't built to work on Windows 98 or without a certain version of Internet Explorer. Once you find out what makes it crash you can use scripts in the Archive to find out what version of Window and Internet Explorer are used and abort if they don't match.</p></div><hr><div class="footer"><p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p></div></div><script src="../js/highlight.pack.js" type="text/javascript"></script><script type="text/javascript">//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]></script></body></html>