<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="Start In? when createshortcut" />

  <title>Start In? when createshortcut - NSIS Forums</title>
  <script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script>
  <!-- Bootstrap core CSS -->

  <link rel="stylesheet" type="text/css" href="//netdna.bootstrapcdn.com/bootswatch/3.0.1/readable/bootstrap.min.css" />
  <link rel="stylesheet" href="../css/style.css" type="text/css" /><!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!--[if lt IE 9]>
                <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
                <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->
</head>

<body>
  <div class="container">
    <!-- Put navigation bar here -->

    <ol class="breadcrumb">
      <li><a href="../index.html" class="glyphicon glyphicon-home"></a></li>

      <li><a href="f-65.html">NSIS Discussion</a></li>

      <li class="active">Start In? when createshortcut</li>
    </ol>

    <p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=173240">Start In? when createshortcut</a></p><br />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">enlil</span><br />
      <span class="post-time small text-muted">14th March 2004 03:51 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>Start In? when createshortcut</strong><br />
      Hey all,<br />
      <br />
      I'm trying to create an installation that points to a custom browser. I can create the shortcut no problem, and I can get it to be placed on the desktop. The problem is that it doesn't have a "Start In" that is the same as the "Target". Normally I don't think this is a problem, but since my 'browser' is calling local files, it must be started in the directory which it rests and not the desktop or a blank 'Start In' which is the case if the short cut is not moved/created on the desktop. Any thoughts on this? Unfortunately I can't just hard code the links or shortcut. The installation is meant to move around quite a bit.<br />
      <br />
      Thanks in advance for any suggestions.<br />
      <br />
      Cheers,<br />
      Kelly</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">enlil</span><br />
      <span class="post-time small text-muted">14th March 2004 04:17 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Okay.....I got it figured out. It's probably not the correct or most elegant way to make this work, but it does work. Here are the details in case anyone else needs to have a shortcut where the 'Start In' property is extremely important. Basically, the SetOutPath is what will be written to the "Start In" field. So, I did a couple searchpaths -- one for the actual file and one for the directory just above the installation. The shortcut gets created in the directory of the installation, and then I simply 'copyfiles'ed it to the desktop. Again, messy but it works. Hope this helps someone else. I've pasted example script below:<br />
      <br />
      Section "Install Shortcut (mySC) for My Application (myApp)"<br />
      <br />
      ; Where am I?<br />
      SearchPath $whereami "myAPP.exe"<br />
      <br />
      ; Where am I?<br />
      SearchPath $whereami2 "../"<br />
      <br />
      ; Set output path to the installation directory.<br />
      SetOutPath "$whereami2\core"<br />
      <br />
      ; Create ShortCut<br />
      CreateShortCut mySC.lnk "$whereami"<br />
      <br />
      ; Rename<br />
      CopyFiles mySC.lnk $DESKTOP/mySC.lnk<br />
      <br />
      SectionEnd</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">flizebogen</span><br />
      <span class="post-time small text-muted">15th March 2004 15:14 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Use the Command SetOutPath before CreateShortcut</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">mdlazreg</span><br />
      <span class="post-time small text-muted">28th April 2004 02:45 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">You can do it better this way I think :<br />
      <br />
      SetOutPath "YOUR_NEW_DIRECTORY"<br />
      CreateShortCut mySC.lnk "$whereami"<br />
      SetOutPath "YOUR_OLD_DIRECTORY"</p>
    </div>
    <hr />

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]>
  </script>
</body>
</html>
