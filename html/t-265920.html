<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="description" content="Get path of pointing mouse file"><title>Get path of pointing mouse file - NSIS Forums</title><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script><link rel="preload" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css" as="style" onload="this.rel='stylesheet'"><link rel="preload" href="../css/style.css" as="style" onload="this.rel='stylesheet'"><noscript><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css"><link rel="stylesheet" href="../css/style.css"></noscript><script>!function(a){"use strict";var b=function(b,c,d){function e(a){return h.body?a():void setTimeout(function(){e(a)})}function f(){i.addEventListener&&i.removeEventListener("load",f),i.media=d||"all"}var g,h=a.document,i=h.createElement("link");if(c)g=c;else{var j=(h.body||h.getElementsByTagName("head")[0]).childNodes;g=j[j.length-1]}var k=h.styleSheets;i.rel="stylesheet",i.href=b,i.media="only x",e(function(){g.parentNode.insertBefore(i,c?g:g.nextSibling)});var l=function(a){for(var b=i.href,c=k.length;c--;)if(k[c].href===b)return a();setTimeout(function(){l(a)})};return i.addEventListener&&i.addEventListener("load",f),i.onloadcssdefined=l,l(f),i};"undefined"!=typeof exports?exports.loadCSS=b:a.loadCSS=b}("undefined"!=typeof global?global:this);!function(a){if(a.loadCSS){var b=loadCSS.relpreload={};if(b.support=function(){try{return a.document.createElement("link").relList.supports("preload")}catch(b){return!1}},b.poly=function(){for(var b=a.document.getElementsByTagName("link"),c=0;c<b.length;c++){var d=b[c];"preload"===d.rel&&"style"===d.getAttribute("as")&&(a.loadCSS(d.href,d,d.getAttribute("media")),d.rel=null)}},!b.support()){b.poly();var c=a.setInterval(b.poly,300);a.addEventListener&&a.addEventListener("load",function(){b.poly(),a.clearInterval(c)}),a.attachEvent&&a.attachEvent("onload",function(){a.clearInterval(c)})}}}(this);</script></head><body><div class="container"><ol class="breadcrumb"><li><a href="../index.html" class="glyphicon glyphicon-home"></a></li><li><a href="f-65.html">NSIS Discussion</a></li><li class="active">Get path of pointing mouse file</li></ol><p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=265920">Get path of pointing mouse file</a></p><br><div class="post"><p class="post-meta"><span class="post-author text-primary">Mark Nascimento</span><br><span class="post-time small text-muted">16th February 2007 10:36 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>Get path of pointing mouse file</strong><br>Could you teach us how to send to clipboard (or variable)<br>the full path of a file (in explorer) that the mouse is pointing to, like shell as send to nsis variable, or "send full path to clipboard" or "send full path to nsis $VarApp.exe".<br><br>Example:<br>(in explorer, the mouse points to a dll: )<br>(Shell &gt; "Unregister dll")<br>Then my nsis app.exe will get the $path and execute<br>Regsvr32 /u $path<br>;;;;;;<br>Using classic interface on Windows 98<br><br><br>The current Code:<br>VIProductVersion 0.0.4.0<br>VIAddVersionKey /LANG=1046 "LegalCopyright" "Mark Luis AmÃ³ra do Nascimento"<br>VIAddVersionKey /LANG=1046 "FileDescription" "INFARTE - Arte em InformÃ¡tica do Papai Mark"<br>VIAddVersionKey /LANG=1046 "Compilado em :" "${__TIMESTAMP__}"<br>VIAddVersionKey /LANG=1046 "Programa :" "Executor"<br>VIAddVersionKey /LANG=1046 "FileVersion" "1.0"<br>#_________________________________________________________________________________________<br>Name "Executor"<br>OutFile "..\Executor.exe"<br>xpstyle on<br>!verbose 4<br>ShowInstDetails show<br>!include "${NSISDIR}\Include\WinMessages.nsh"<br>LoadLanguageFile "d:\Roteiro\PortugueseBR.nlf"<br>Caption "Papai Mark e o Executor "<br>var hwnd<br>var mem<br>#_________________________________________________________________________________________<br><br>Function .onInit<br>/* WriteRegStr HKCR "exefile\shell\Executor" "" "Abrir o Executor"<br>WriteRegStr HKCR "exefile\shell\Executor\command" "" "$exedir\executor.exe"<br>WriteRegStr HKCR "dllfile\shell\Executor" "" "Abrir o Executor"<br>WriteRegStr HKCR "dllfile\shell\Executor\command" "" "$exedir\executor.exe"<br>*/<br>Push $0<br>System::Call 'user32::OpenClipboard(i 0)'<br>System::Call 'user32::GetClipboardData(i 1) t .r0'<br>System::Call 'user32::CloseClipboard()'<br>Exch $0<br>Pop $0<br>StrCpy $1 $0 2 1<br>Strcmp $1 ":\" 0 semclip<br>;MessageBox MB_YesNo|MB_topmost|MB_IconQuestion "Gravar :$\r$0 ?" IdNo semclip<br>WriteIniStr "$exedir\m.ini" "Field 2" State $0<br>semclip:<br>Flushini m.ini<br>FunctionEnd<br><br><br>#_________________________________________________________________________________________<br><br>Page custom ShowCustom LeaveCustom<br>Function ShowCustom<br>InstallOptions::initDialog /NOUNLOAD "$exedir\m.ini"<br>Pop $hwnd<br>InstallOptions::show<br>Pop $0<br>FunctionEnd<br>#_________________________________________________________________________________________<br>Function LeaveCustom<br>ReadINIStr $0 "$exedir\m.ini" "Settings" "State"<br>StrCmp $0 0 Done<br>StrCmp $0 5 lembrar<br>StrCmp $0 7 lembrar<br>StrCmp $0 10 lembrar<br>StrCmp $0 6 Ler<br>StrCmp $0 8 limpar<br>StrCmp $0 9 Sobre<br>StrCmp $0 12 lembrar<br>StrCmp $0 13 lembrar<br>StrCmp $0 14 lembrar<br><br>Ler:<br>ReadINIStr $0 "$exedir\m.ini" "Field 14" "State"<br>StrCmp $0 1 0 +2<br>advsplash::show 295 1 1 0xc0c0c0 $exedir\splash\bt<br>IfFileExists $exedir\Lista.ini +3 0<br>MessageBox MB_OK|MB_topmost|MB_Iconinformation " A lista estÃ¡ vazia."<br>Abort<br>ExecShell open $exedir\Lista.ini<br>abort<br><br>Limpar:<br>ReadINIStr $0 "$exedir\m.ini" "Field 14" "State"<br>StrCmp $0 1 0 +2<br>advsplash::show 295 1 1 0xc0c0c0 $exedir\splash\bt<br>IfFileExists $exedir\Lista.ini +3<br>MessageBox MB_OK|MB_topmost|MB_Iconinformation "A lista jÃ¡ havia sido apagada."<br>Abort<br>Delete $exedir\Lista.ini<br>MessageBox MB_OK|MB_topmost|MB_Iconinformation " A lista foi apagada."<br>Abort<br><br>lembrar:<br>ReadINIStr $0 "$exedir\m.ini" "Field 14" "State"<br>StrCmp $0 1 0 +2<br>advsplash::show 100 1 1 0xc0c0c0 $exedir\splash\cb<br>Abort<br><br>Sobre:<br>ReadINIStr $0 "$exedir\m.ini" "Field 14" "State"<br>StrCmp $0 1 0 +2<br>advsplash::show 295 1 1 0xc0c0c0 $exedir\splash\bt<br>ExecShell open $exedir\Sobre.txt<br>abort<br><br>Done:<br>ReadINIStr $0 "$exedir\m.ini" "Field 14" "State"<br>StrCmp $0 1 0 +2<br>advsplash::show 480 1 1 0xc0c0c0 $exedir\splash\mv<br>FunctionEnd<br>#_________________________________________________________________________________________<br>Page instfiles<br>#_________________________________________________________________________________________<br>Section<br>ReadIniStr $2 "$exedir\Lista.ini" "Lista de linhas de comando efetivadas" "Total absoluto de usos"<br>IntOp $2 $2 + 1<br>WriteIniStr "$exedir\Lista.ini" "Lista de linhas de comando efetivadas" "Total absoluto de usos" $2<br><br>ReadINIStr $3 "$exedir\m.ini" "Field 2" "State" ;o arquivo<br>ReadINIStr $1 "$exedir\m.ini" "Field 13" "State" ;o prefixo<br>StrCmp $1 "" sempref<br>StrCmp $1 " " sempref<br>StrCpy $3 "$1 $3"<br>GoTo semshell<br><br><br>sempref:<br>ReadINIStr $8 "$exedir\m.ini" "Field 10" "State" ;Abrir pelo &amp;Shell<br>StrCmp $8 1 0 semshell<br>ReadINIStr $7 "$exedir\m.ini" "Field 7" "State" ;Mostrar &amp;Detalhes no final.<br>StrCmp $7 1 +2<br>hidewindow<br>ClearErrors<br>ExecShell open '$3'<br>IfErrors exeerro certo<br><br>semshell:<br>ReadINIStr $7 "$exedir\m.ini" "Field 7" "State" ;Mostrar &amp;Detalhes no final.<br>StrCmp $7 1 +2<br>hidewindow<br>ClearErrors<br>Exec '$3'<br>IfErrors exeerro certo<br><br><br>exeerro:<br>ReadINIStr $7 "$exedir\m.ini" "Field 7" "State"<br>StrCmp $7 1 +2<br>hidewindow<br>ReadINIStr $mem "$exedir\m.ini" "Field 5" "State"<br>StrCmp $mem 0 +3 ; ou +4, tanto faz<br>StrCpy $9 x<br>DetailPrint "Erro gravado na lista."<br>StrCpy $mem 0<br>DetailPrint "ERRO - E R R O ! - E R R R R R R O !"<br>DetailPrint "ERRO - E R R O ! - E R R R R R R O !"<br>DetailPrint "ERRO - E R R O ! - E R R R R R R O !"<br>DetailPrint "ERRO - E R R O ! - E R R R R R R O !"<br>ReadINIStr $0 "$exedir\m.ini" "Field 14" "State"<br>StrCmp $0 1 0 fim<br>advsplash::show 1200 1 1 0x000000 $exedir\splash\er<br>Pop $0<br>GoTo fim<br>certo:<br><br>ReadINIStr $mem "$exedir\m.ini" "Field 5" "State"<br>StrCmp $mem 0 0 +3<br>DetailPrint "NÃ£o foi gravado na Lista.ini"<br>GoTo fim<br>DetailPrint "O comando foi gravado em $exedir\Lista.ini"<br>ReadIniStr $1 "$exedir\Lista.ini" "Lista de linhas de comando efetivadas" "Total absoluto de usos"<br>StrCmp $1 100 0 naoapaga<br>MessageBox MB_YESNO|MB_ICONQUESTION|MB_Topmost "O arquivo de memÃ³ria jÃ¡ atingiu 100 Ã_tens. Posso apagÃ¡-lo ?" idno naoapaga<br>Delete $exedir\Lista.ini<br>WriteIniStr "$exedir\Lista.ini" "Lista de linhas de comando efetivadas" "Total absoluto de usos" 1<br>naoapaga:<br><br>StrCpy $6 1<br><br>next:<br>ReadIniStr $4 "$exedir\Lista.ini" "Comandos Corretos" $6<br>StrCmp $4 "" 0 cont<br>ClearErrors<br>WriteIniStr "$exedir\Lista.ini" "Comandos Corretos" $6 $3<br>IfErrors 0 +2<br>MessageBox MB_OK|MB_ICONstop|MB_Topmost "Hove um erro inesperado ao escrever na lista."<br>GoTo fim<br><br>cont:<br>IntOp $6 $6 + 1<br>GoTo next<br><br>fim:<br>StrCmp $9 x 0 semlger<br>Strcpy $9 1<br>nexter:<br>ReadIniStr $5 "$exedir\Lista.ini" "Comandos Errados" $9<br>StrCmp $5 "" 0 conter<br>WriteIniStr "$exedir\Lista.ini" "Comandos Errados" $9 $3<br>GoTo semlger<br>conter:<br>IntOp $9 $9 + 1<br>GoTo nexter<br><br>IntOp $5 $5 + 1<br>WriteIniStr "$exedir\Lista.ini" "Ãšltimo Comando Errados" $5 $3<br><br>semlger:<br>ReadINIStr $7 "$exedir\m.ini" "Field 7" "State"<br>StrCmp $7 1 +2<br>SetAutoClose True<br>Sleep 500<br>ReadIniStr $7 "$exedir\m.ini" "Field 12" "State"<br>StrCmp $7 1 0 +2<br>exec $exedir\executor.exe<br>SetAutoClose True<br>SectionEnd<br><br><br><br>The Ini file<br><br>[Settings]<br>NumFields=14<br>title=EXECUTOR - Executar programa composto.<br>BackEnabled=1<br>BackButtonText=Pra TrÃ¡s<br>State=6<br><br>[Field 1]<br>Type=Groupbox<br>Left=1<br>Right=-1<br>Top=1<br>Bottom=46<br>Text=Cole, digite ou abra um arquivo e digite o complemento :<br>HWND=3044<br><br>[Field 2]<br>Type=FileRequest<br>Flags=GROUP|FILE_MUST_EXIST|FILE_EXPLORER|FILE_HIDEREADONLY<br>State="ping 200.149.10.50"<br>Filter=ExecutÃ¡veis|*.exe|Todos|*.*<br>Left=10<br>Right=-10<br>Top=12<br>Bottom=25<br>MinLen=8<br>ValidateText=Entre com um executÃ¡vel composto vÃ¡lido.<br>HWND=3048<br>HWND2=3052<br><br>[Field 3]<br>Type=Groupbox<br>Left=1<br>Right=-1<br>Top=50<br>Bottom=98<br>Text=Prefixo :<br>HWND=3056<br><br>[Field 4]<br>Type=Label<br>Left=120<br>Right=-5<br>Top=62<br>Bottom=72<br>Text=Esta Ã© a primeira parte da linha de comando.<br>HWND=3060<br><br>[Field 5]<br>Type=Checkbox<br>Text=&amp;Anotar na Lista<br>Flags=NOTIFY<br>State=1<br>Left=10<br>Right=76<br>Top=105<br>Bottom=115<br>HWND=3064<br><br>[FIELD 6]<br>Type=Button<br>Flags=NOTIFY<br>Text=&amp;Ver a Lista<br>Left=-66<br>Right=-10<br>Top=108<br>Bottom=123<br>HWND=3068<br><br>[Field 7]<br>Type=Checkbox<br>Text=Mostrar &amp;Detalhes no final.<br>Flags=NOTIFY<br>State=0<br>Left=10<br>Right=110<br>Top=116<br>Bottom=126<br>HWND=3072<br><br>[Field 8]<br>Type=Button<br>Flags=NOTIFY<br>Text=&amp;Limpar a Lista<br>Left=-127<br>Right=-71<br>Top=108<br>Bottom=123<br>HWND=3076<br><br>[Field 9]<br>Type=Button<br>Flags=NOTIFY<br>Text=&amp;InformaÃ§Ãµes<br>Left=-65<br>Right=-10<br>Top=28<br>Bottom=43<br>HWND=3080<br><br>[Field 10]<br>Type=Checkbox<br>Text=Abrir pelo &amp;Shell. O programa nÃ£o Ã© um executÃ¡vel.<br>Flags=NOTIFY<br>State=0<br>Left=10<br>Right=-80<br>Top=30<br>Bottom=40<br>HWND=3084<br><br>[Field 11]<br>Type=Groupbox<br>Left=1<br>Right=-1<br>Top=98<br>Bottom=130<br>Text=<br>HWND=3088<br><br>[Field 12]<br>Type=Checkbox<br>Text=&amp;Reabrir<br>Flags=NOTIFY<br>State=1<br>Left=82<br>Right=122<br>Top=105<br>Bottom=115<br>HWND=3092<br><br>[Field 13]<br>Type=Combobox<br>State=""<br>ListItems=| |Regsvr32 |Regsvr32 /s |Regedit |Regedit /s |Regsvr32 /u |notepad |command.com /c |<br>Left=10<br>Right=110<br>Top=60<br>Bottom=-1<br>Flags=Notify<br>HWND=3096<br><br>[Field 14]<br>Type=Checkbox<br>Text=S&amp;om<br>Flags=NOTIFY<br>State=0<br>Left=10<br>Right=40<br>Top=80<br>Bottom=90<br>HWND=3108</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Red Wine</span><br><span class="post-time small text-muted">16th February 2007 19:32 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Not sure if I got the point of what you're trying to achieve...<br>Do you want users to select a dll which installer should unregister?<br>If this is the matter you may do it simply and easily by adding a FileRequest on a custom page where users should browse for the dll which you're able to unregister within NSIS, no need to execute Regsvr32.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Mark Nascimento</span><br><span class="post-time small text-muted">17th February 2007 03:39 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">No.<br>First, why:<br>We test, reg and unreg, use parameters.<br>-------------------------------<br>Second, What I do NOW:<br>&gt;Point to notepad.exe<br>&gt;Right click over notepad.exe.<br>&gt;Shell opens (open, sendto, cut, copy, Copy this path, etc)<br>&gt;I click on "Copy this path" ( a camtech soft, <a href="http://camtech2000.net/" target="_blank">http://camtech2000.net/</a>) and the full path of notepad is sent to clipboard.<br>&gt;I right click over notepad.exe again and<br>&gt;Shell opens<br><br>&gt;Now, I click on "Open the Executor" (my app)<br>&gt;The Executor gets the clipboard data and puts into a listbox. On other listbox, I choose or write the first part of the command line and... Go!<br>The command (exec, execwait) can be so:<br>"c:\ExeScope.exe c:\Windows\notepad.exe"<br>And so, ExeScope will analyse the notepad.exe.<br>-------------------------------------------------------<br>Third, What I want to:<br>Nsis can get clipboard data but can't get the path of a selected file on explorer. I want to do only one right click:<br><br>&gt;Point to notepad.exe<br>&gt;Right click over notepad.exe.<br>&gt;Now, I click on "Open with the Executor" (my app)<br>&gt;The Executor gets the FULL PATH of notepad.exe and puts into a listbox or variable. On other listbox, I choose or write the first part of the command line and... Go!<br>The command (exec, execwait) can be so:<br>"c:\ExeScope.exe c:\Windows\notepad.exe"<br>And so, ExeScope will analyse the notepad.exe.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">demiller9</span><br><span class="post-time small text-muted">17th February 2007 10:37 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"></p><blockquote>&gt;Right click over notepad.exe.<br>&gt;Now, I click on "Open with the Executor" (my app)<br>&gt;The Executor gets the FULL PATH of notepad.exe</blockquote>This sounds like you have added "Open with the Executor to the shell command. If you did that, you could have the shell command add the filename that was clicked as a parameter to pass to Executor.<br><br>"%1" after the Executor command will pass the filename with path. Take a look in your registry at an example like NSIS.Script (HKCR\NSIS.Script\shell\compile\command).<br><br>Executor will need to be modified to look at its command line for the filename, instead of looking at the clipboard.<br><br>Don</div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Mark Nascimento</span><br><span class="post-time small text-muted">18th February 2007 05:40 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Getting closer.<br>WriteRegStr HKCR "exefile\shell\Executor\command" "" '$exedir\executor.exe "%1"'<br>YEs, but how the Executor will read %1 ?<br><br>I 've tried and read the help file but nothing. I only find command line to the COMPILER.<br><br>Example, how to get the %1:<br>_________________________<br>Outfile Eureka.exe<br>Name Darmok<br>Section "In the ocean"<br>MessageBox MB_OK|MB_topmost|MB_Iconexclamation "Tempa!<br>when the walls falled %1"<br>Exec "Command.com /c %1"<br>SectionEnd<br>GetOut<br>_________________________</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">demiller9</span><br><span class="post-time small text-muted">18th February 2007 09:25 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">In the manual, Section E.1.11 Get Parameters<br></p><pre>
<code>!include "FileFunc.nsh"<br>!insertmacro GetParameters<br>Section<br>        ${GetParameters} $R0<br>        ; $R0="[parameters]"<br>SectionEnd<br></code>
</pre>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Mark Nascimento</span><br>
      <span class="post-time small text-muted">20th February 2007 04:04 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">When the walls falls<br>
      Your eyes uncovered<br>
      <br>
      THANK YOU!</p>
    </div>
    <hr>

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script type="text/javascript" src="../js/highlight.pack.js" async>
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]></script></body></html>