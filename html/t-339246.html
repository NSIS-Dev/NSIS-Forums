<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="Portable and Install mode in one installer" />

  <title>Portable and Install mode in one installer - NSIS Forums</title><!-- Bootstrap core CSS -->
  <link rel="stylesheet" type="text/css" href="//netdna.bootstrapcdn.com/bootswatch/3.0.1/readable/bootstrap.min.css" />
  <link rel="stylesheet" href="../css/style.css" type="text/css" /><!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!--[if lt IE 9]>
                <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
                <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->
</head>

<body>
  <div class="container">
    <!-- Put navigation bar here -->

    <ol class="breadcrumb">
      <li><a href="../index.html" class="glyphicon glyphicon-home"></a></li>

      <li><a href="f-65.html">NSIS Discussion</a></li>

      <li class="active">Portable and Install mode in one installer</li>
    </ol>

    <p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=339246">Portable and Install mode in one installer</a></p><br />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">berkyr</span><br />
      <span class="post-time small text-muted">12th December 2011 13:22 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>Portable and Install mode in one installer</strong><br />
      how to create two install methods in one installer ?<br />
      like AIMP installer <a href="http://iceimg.com/i/ea/7c/2e7128d925.png" target="_blank">http://iceimg.com/i/ea/7c/2e7128d925.png</a><br />
      <br />
      i need when select Install mode - app install to "$INSTDIR"<br />
      and when select Portable mode - extract files to "$EXEDIR" or custom install path<br />
      <br />
      can anybody explain on my example whats need more to be complete ?<br /></p>

      <blockquote>
        ; Script generated by the HM NIS Edit Script Wizard.<br />
        <br />
        ; HM NIS Edit Wizard helper defines<br />
        !define PRODUCT_NAME "Registry Winner"<br />
        !define PRODUCT_VERSION "6.4.12.12"<br />
        !define PRODUCT_PUBLISHER "RegistryWinner.com"<br />
        !define PRODUCT_WEB_SITE "http://www.registrywinner.com"<br />
        !define PRODUCT_DIR_REGKEY "Software\Microsoft\Windows\CurrentVersion\App Paths\RegistryWinner.exe"<br />
        !define PRODUCT_UNINST_KEY "Software\Microsoft\Windows\CurrentVersion\Uninstall\${PRODUCT_NAME}"<br />
        !define PRODUCT_UNINST_ROOT_KEY "HKLM"<br />
        <br />
        Name "${PRODUCT_NAME} ${PRODUCT_VERSION}"<br />
        OutFile "RegistryWinner v6.4.exe"<br />
        LoadLanguageFile "${NSISDIR}\Contrib\Language files\English.nlf"<br />
        InstallDir "$PROGRAMFILES\Registry Winner"<br />
        Icon "${NSISDIR}\Contrib\Graphics\Icons\orange-install.ico"<br />
        UninstallIcon "${NSISDIR}\Contrib\Graphics\Icons\orange-uninstall.ico"<br />
        InstallDirRegKey HKLM "${PRODUCT_DIR_REGKEY}" ""<br />
        DirText "Setup will install $(^Name) in the following folder.$\r$\n$\r$\nTo install in a different folder, click Browse and select another folder."<br />
        LicenseText "If you accept all the terms of the agreement, choose I Agree to continue. You must accept the agreement to install $(^Name)."<br />
        LicenseData "lic.rtf"<br />
        LicenseForceSelection radiobuttons<br />
        <br />
        SetCompressor /SOLID lzma<br />
        SetCompressorDictSize 128<br />
        SetDatablockOptimize on<br />
        ShowInstDetails show<br />
        ShowUninstDetails show<br />
        <br />
        <br />
        Section "MainSection" SEC01<br />
        SetOutPath "$INSTDIR\Language"<br />
        SetOverwrite try<br />
        File "Registry_Winner\RegistryWinner_Setup\{app}\Language\English.ini"<br />
        File "Registry_Winner\RegistryWinner_Setup\{app}\Language\Italian.ini"<br />
        File "Registry_Winner\RegistryWinner_Setup\{app}\Language\Romanian.ini"<br />
        File "Registry_Winner\RegistryWinner_Setup\{app}\Language\Russian.ini"<br />
        SetOutPath "$INSTDIR"<br />
        File "Registry_Winner\RegistryWinner_Setup\{app}\License.txt"<br />
        ;File "Registry_Winner\RegistryWinner_Setup\{app}\manual.chm"<br />
        File "Registry_Winner\RegistryWinner_Setup\{app}\RegistryWinner.exe"<br />
        File "Registry_Winner\RegistryWinner_Setup\{app}\reg.ini"<br />
        CreateDirectory "$SMPROGRAMS\Registry Winner"<br />
        CreateShortCut "$SMPROGRAMS\Registry Winner\Registry Winner.lnk" "$INSTDIR\RegistryWinner.exe"<br />
        CreateShortCut "$DESKTOP\Registry Winner.lnk" "$INSTDIR\RegistryWinner.exe"<br />
        File "Registry_Winner\RegistryWinner_Setup\{app}\RWCleaner.dll"<br />
        File "Registry_Winner\RegistryWinner_Setup\{app}\RWJunk.dll"<br />
        File "Registry_Winner\RegistryWinner_Setup\{app}\RWOptimizer.dll"<br />
        File "Registry_Winner\RegistryWinner_Setup\{app}\Settings.ini"<br />
        ;SetOutPath "$INSTDIR\skins"<br />
        ;File "Registry_Winner\RegistryWinner_Setup\{app}\skins\localSetting.ini"<br />
        ;SetOutPath "$INSTDIR\skins\skin10"<br />
        ;File "Registry_Winner\RegistryWinner_Setup\{app}\skins\skin10\BTN_CHANGE_SKIN_HOVER.bmp"<br />
        ;File "Registry_Winner\RegistryWinner_Setup\{app}\skins\skin10\BTN_CHANGE_SKIN_NORMAL.bmp"<br />
        ;File "Registry_Winner\RegistryWinner_Setup\{app}\skins\skin10\btn_top_help_1.bmp"<br />
        ;File "Registry_Winner\RegistryWinner_Setup\{app}\skins\skin10\btn_top_help_2.bmp"<br />
        ;File "Registry_Winner\RegistryWinner_Setup\{app}\skins\skin10\btn_top_register_1.bmp"<br />
        ;File "Registry_Winner\RegistryWinner_Setup\{app}\skins\skin10\btn_top_register_2.bmp"<br />
        ;File "Registry_Winner\RegistryWinner_Setup\{app}\skins\skin10\btn_top_update_1.bmp"<br />
        ;File "Registry_Winner\RegistryWinner_Setup\{app}\skins\skin10\btn_top_update_2.bmp"<br />
        ;File "Registry_Winner\RegistryWinner_Setup\{app}\skins\skin10\CloseButton_Hover.bmp"<br />
        ;File "Registry_Winner\RegistryWinner_Setup\{app}\skins\skin10\CloseButton_Normal.bmp"<br />
        ;File "Registry_Winner\RegistryWinner_Setup\{app}\skins\skin10\desc_home_options.bmp"<br />
        ;File "Registry_Winner\RegistryWinner_Setup\{app}\skins\skin10\imglist_folder.bmp"<br />
        ;File "Registry_Winner\RegistryWinner_Setup\{app}\skins\skin10\mainFrame-bottom.bmp"<br />
        ;File "Registry_Winner\RegistryWinner_Setup\{app}\skins\skin10\mainFrame-centerLeft.bmp"<br />
        ;File "Registry_Winner\RegistryWinner_Setup\{app}\skins\skin10\mainFrame-centerMid.bmp"<br />
        ;File "Registry_Winner\RegistryWinner_Setup\{app}\skins\skin10\mainFrame-centerRight.bmp"<br />
        ;File "Registry_Winner\RegistryWinner_Setup\{app}\skins\skin10\mainFrame_top.bmp"<br />
        ;File "Registry_Winner\RegistryWinner_Setup\{app}\skins\skin10\min1.bmp"<br />
        ;File "Registry_Winner\RegistryWinner_Setup\{app}\skins\skin10\min2.bmp"<br />
        ;File "Registry_Winner\RegistryWinner_Setup\{app}\skins\skin10\scannow1.bmp"<br />
        ;File "Registry_Winner\RegistryWinner_Setup\{app}\skins\skin10\scannow2.bmp"<br />
        ;File "Registry_Winner\RegistryWinner_Setup\{app}\skins\skin10\splash.bmp"<br />
        ;File "Registry_Winner\RegistryWinner_Setup\{app}\skins\skin10\thumbnail.bmp"<br />
        SectionEnd<br />
        <br />
        Section -AdditionalIcons<br />
        SetOutPath $INSTDIR<br />
        WriteIniStr "$INSTDIR\${PRODUCT_NAME}.url" "InternetShortcut" "URL" "${PRODUCT_WEB_SITE}"<br />
        CreateShortCut "$SMPROGRAMS\Registry Winner\Website.lnk" "$INSTDIR\${PRODUCT_NAME}.url"<br />
        CreateShortCut "$SMPROGRAMS\Registry Winner\Uninstall.lnk" "$INSTDIR\uninst.exe"<br />
        SectionEnd<br />
        <br />
        Section -Post<br />
        WriteUninstaller "$INSTDIR\uninst.exe"<br />
        WriteRegStr HKLM "${PRODUCT_DIR_REGKEY}" "" "$INSTDIR\RegistryWinner.exe"<br />
        WriteRegStr ${PRODUCT_UNINST_ROOT_KEY} "${PRODUCT_UNINST_KEY}" "DisplayName" "$(^Name)"<br />
        WriteRegStr ${PRODUCT_UNINST_ROOT_KEY} "${PRODUCT_UNINST_KEY}" "UninstallString" "$INSTDIR\uninst.exe"<br />
        WriteRegStr ${PRODUCT_UNINST_ROOT_KEY} "${PRODUCT_UNINST_KEY}" "DisplayIcon" "$INSTDIR\RegistryWinner.exe"<br />
        WriteRegStr ${PRODUCT_UNINST_ROOT_KEY} "${PRODUCT_UNINST_KEY}" "DisplayVersion" "${PRODUCT_VERSION}"<br />
        WriteRegStr ${PRODUCT_UNINST_ROOT_KEY} "${PRODUCT_UNINST_KEY}" "URLInfoAbout" "${PRODUCT_WEB_SITE}"<br />
        WriteRegStr ${PRODUCT_UNINST_ROOT_KEY} "${PRODUCT_UNINST_KEY}" "Publisher" "${PRODUCT_PUBLISHER}"<br />
        SectionEnd<br />
        <br />
        <br />
        Function un.onUninstSuccess<br />
        HideWindow<br />
        MessageBox MB_ICONINFORMATION|MB_OK "$(^Name) was successfully removed from your computer."<br />
        FunctionEnd<br />
        <br />
        Function un.onInit<br />
        MessageBox MB_ICONQUESTION|MB_YESNO|MB_DEFBUTTON2 "Are you sure you want to completely remove $(^Name) and all of its components?" IDYES +2<br />
        Abort<br />
        FunctionEnd<br />
        <br />
        Section Uninstall<br />
        Delete "$INSTDIR\${PRODUCT_NAME}.url"<br />
        Delete "$INSTDIR\uninst.exe"<br />
        ;Delete "$INSTDIR\skins\skin10\thumbnail.bmp"<br />
        ;Delete "$INSTDIR\skins\skin10\splash.bmp"<br />
        ;Delete "$INSTDIR\skins\skin10\scannow2.bmp"<br />
        ;Delete "$INSTDIR\skins\skin10\scannow1.bmp"<br />
        ;Delete "$INSTDIR\skins\skin10\min2.bmp"<br />
        ;Delete "$INSTDIR\skins\skin10\min1.bmp"<br />
        ;Delete "$INSTDIR\skins\skin10\mainFrame_top.bmp"<br />
        ;Delete "$INSTDIR\skins\skin10\mainFrame-centerRight.bmp"<br />
        ;Delete "$INSTDIR\skins\skin10\mainFrame-centerMid.bmp"<br />
        ;Delete "$INSTDIR\skins\skin10\mainFrame-centerLeft.bmp"<br />
        ;Delete "$INSTDIR\skins\skin10\mainFrame-bottom.bmp"<br />
        ;Delete "$INSTDIR\skins\skin10\imglist_folder.bmp"<br />
        ;Delete "$INSTDIR\skins\skin10\desc_home_options.bmp"<br />
        ;Delete "$INSTDIR\skins\skin10\CloseButton_Normal.bmp"<br />
        ;Delete "$INSTDIR\skins\skin10\CloseButton_Hover.bmp"<br />
        ;Delete "$INSTDIR\skins\skin10\btn_top_update_2.bmp"<br />
        ;Delete "$INSTDIR\skins\skin10\btn_top_update_1.bmp"<br />
        ;Delete "$INSTDIR\skins\skin10\btn_top_register_2.bmp"<br />
        ;Delete "$INSTDIR\skins\skin10\btn_top_register_1.bmp"<br />
        ;Delete "$INSTDIR\skins\skin10\btn_top_help_2.bmp"<br />
        ;Delete "$INSTDIR\skins\skin10\btn_top_help_1.bmp"<br />
        ;Delete "$INSTDIR\skins\skin10\BTN_CHANGE_SKIN_NORMAL.bmp"<br />
        ;Delete "$INSTDIR\skins\skin10\BTN_CHANGE_SKIN_HOVER.bmp"<br />
        ;Delete "$INSTDIR\skins\localSetting.ini"<br />
        Delete "$INSTDIR\Settings.ini"<br />
        Delete "$INSTDIR\RWOptimizer.dll"<br />
        Delete "$INSTDIR\RWJunk.dll"<br />
        Delete "$INSTDIR\RWCleaner.dll"<br />
        Delete "$INSTDIR\RegistryWinner.exe"<br />
        ;Delete "$INSTDIR\manual.chm"<br />
        Delete "$INSTDIR\License.txt"<br />
        Delete "$INSTDIR\reg.ini"<br />
        Delete "$INSTDIR\Language\Russian.ini"<br />
        Delete "$INSTDIR\Language\Romanian.ini"<br />
        Delete "$INSTDIR\Language\Italian.ini"<br />
        Delete "$INSTDIR\Language\English.ini"<br />
        <br />
        Delete "$SMPROGRAMS\Registry Winner\Uninstall.lnk"<br />
        Delete "$SMPROGRAMS\Registry Winner\Website.lnk"<br />
        Delete "$DESKTOP\Registry Winner.lnk"<br />
        Delete "$SMPROGRAMS\Registry Winner\Registry Winner.lnk"<br />
        <br />
        RMDir "$SMPROGRAMS\Registry Winner"<br />
        ;RMDir "$INSTDIR\skins\skin10"<br />
        ;RMDir "$INSTDIR\skins"<br />
        RMDir "$INSTDIR\Language"<br />
        RMDir "$INSTDIR"<br />
        <br />
        DeleteRegKey ${PRODUCT_UNINST_ROOT_KEY} "${PRODUCT_UNINST_KEY}"<br />
        DeleteRegKey HKLM "${PRODUCT_DIR_REGKEY}"<br />
        SetAutoClose true<br />
        SectionEnd
      </blockquote>and yes, i see <a href="http://nsis.sourceforge.net/Common_Installation_with_Components_Choice" target="_blank">http://nsis.sourceforge.net/Common_I...ponents_Choice</a><br />
      but not understanding<br />
      <br />
      sorry for my english
    </div>
    <hr />

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]>
  </script>
</body>
</html>
