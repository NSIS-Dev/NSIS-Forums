<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="how to get system drive letter" />

  <title>how to get system drive letter - NSIS Forums</title><!-- Bootstrap core CSS -->
  <link rel="stylesheet" type="text/css" href="//netdna.bootstrapcdn.com/bootswatch/3.0.1/readable/bootstrap.min.css" />
  <link rel="stylesheet" href="../css/style.css" type="text/css" /><!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!--[if lt IE 9]>
                <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
                <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->
</head>

<body>
  <div class="container">
    <!-- Put navigation bar here -->

    <ol class="breadcrumb">
      <li><a href="../index.html" class="glyphicon glyphicon-home"></a></li>

      <li><a href="f-65.html">NSIS Discussion</a></li>

      <li class="active">how to get system drive letter</li>
    </ol>

    <p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=317086">how to get system drive letter</a></p><br />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">heinkoi459</span><br />
      <span class="post-time small text-muted">17th February 2010 20:58 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>how to get system drive letter</strong><br />
      Hi, how can I get the system drive letter to complete this InstallDir "_:\MyFolder\"<br />
      <br />
      I know that 'ReadEnvStr $0 SYSTEMDRIVE' can do it but only in 'Section or Function'. So the 'InstallDir' is in declaration.<br />
      <br />
      Thank you!<br />
      <br />
      Guillaume</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">rsvargas</span><br />
      <span class="post-time small text-muted">18th February 2010 17:07 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">you can put it on the .onInit Function.<br />
      <br />
      I've created a page so the user can choose the drive in which he wants to install. like this (showing only relevant parts):<br />
      <br />
      PHP Code:</p>
      <hr />
      <code style="white-space:nowrap"><!-- php buffer start --></code><span style="color: #000000"><span style="color: #007700">!include</span><span style="color: #DD0000">"FileFunc.nsh"<br /></span> <span style="color: #007700">!</span><span style="color: #0000BB">insertmacroGetDrives<br />
      <br /></span> <span style="color: #007700">Var</span><span style="color: #0000BB">drives<br />
      <br /></span> <span style="color: #007700">Function.</span><span style="color: #0000BB">onInit<br />
      StrCpy$drives</span><span style="color: #DD0000">""<br /></span> <span style="color: #007700">${</span><span style="color: #0000BB">GetDrives</span><span style="color: #007700">}</span><span style="color: #DD0000">"HDD""GenerateDrivesString"<br /></span> <span style="color: #0000BB">File</span><span style="color: #007700">/</span><span style="color: #0000BB">oname</span><span style="color: #007700">=</span><span style="color: #0000BB">$PLUGINSDIRDrive</span><span style="color: #007700">.</span><span style="color: #0000BB">ini</span><span style="color: #DD0000">"Drive.ini"<br /></span> <span style="color: #0000BB">WriteINIStr</span><span style="color: #DD0000">"$PLUGINSDIR\\Drive.ini""Field2""ListItems""$drives"<br /></span> <span style="color: #0000BB">FunctionEnd<br />
      <br /></span> <span style="color: #007700">Function</span><span style="color: #0000BB">GenerateDrivesString<br />
      StrCmp$drives</span><span style="color: #DD0000">""</span><span style="color: #0000BB">0</span><span style="color: #007700">+</span><span style="color: #0000BB">2<br />
      StrCpy$drivesState</span><span style="color: #DD0000">"$9"<br /></span> <span style="color: #0000BB">StrCmp$drives</span><span style="color: #DD0000">""</span><span style="color: #007700">+</span><span style="color: #0000BB">2<br />
      StrCpy$drives</span><span style="color: #DD0000">"$drives|"<br /></span> <span style="color: #0000BB">StrCpy$drives</span><span style="color: #DD0000">"$drives$9"<br /></span> <span style="color: #0000BB">Push</span><span style="color: #007700">$</span><span style="color: #0000BB">0<br />
      FunctionEnd<br />
      <br />
      <br /></span> <span style="color: #007700">Function</span><span style="color: #0000BB">ShowDrive<br />
      WriteINIStr</span><span style="color: #DD0000">"$PLUGINSDIR\\Drive.ini""Field1""Text""Selectdrive"<br /></span> <span style="color: #0000BB">InstallOptions</span><span style="color: #007700">::</span><span style="color: #0000BB">initDialog</span><span style="color: #007700">/</span><span style="color: #0000BB">NOUNLOAD</span><span style="color: #DD0000">"$PLUGINSDIR\\Drive.ini"<br /></span> <span style="color: #0000BB">Pop</span><span style="color: #007700">$</span><span style="color: #0000BB">0<br />
      InstallOptions</span><span style="color: #007700">::</span><span style="color: #0000BB">show<br />
      Pop</span><span style="color: #007700">$</span><span style="color: #0000BB">0<br />
      FunctionEnd<br />
      <br /></span> <span style="color: #007700">Function</span><span style="color: #0000BB">LeaveDrive<br />
      ReadINIStr</span><span style="color: #007700">$</span><span style="color: #0000BB">0</span><span style="color: #DD0000">"$PLUGINSDIR\\Drive.ini""Field2""State"<br /></span> <span style="color: #0000BB">StrCpy$INSTDIR</span><span style="color: #DD0000">"$0\\MyDirectory"<br /></span> <span style="color: #0000BB">FunctionEnd<br /></span></span> <!-- php buffer end -->
      <hr />
      and, of course, you need the Drive.ini file<br />
      <pre>
<code><br />[Settings]<br />NumFields=2<br /><br />[Field 1]<br />Type=Label<br />Text=Select which drive to install<br />Left=84<br />Right=256<br />Top=49<br />Bottom=57<br /><br />[Field 2]<br />Type=DropList<br />Text=DropList<br />State=C:<br />ListItems=A:|B:|C:|D:|E:|F:|G:|H:|I:|J:|K:|L:|M:|N:|O:|P:|Q:|R:|S:|T:|U:|V:|W:|X:|Y:|Z:<br />Left=84<br />Right=212<br />Top=62<br />Bottom=76<br /><br /></code>
</pre>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">heinkoi459</span><br />
      <span class="post-time small text-muted">19th February 2010 17:53 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Hi, when I compile there are an error on this line 'File /oname=$PLUGINSDIR\Drive.ini Drive.ini' (File: "Drive.ini" -&gt; no files found.) So I search on Web but there are nothing interesting to solve this problem.<br />
      <br />
      Thank you<br />
      <br />
      Guillaume</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">rsvargas</span><br />
      <span class="post-time small text-muted">19th February 2010 17:59 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">You need to create a file called Drive.ini with the following contents and put it in the same folder of your .nsi script.<br />
      <br /></p>

      <blockquote>
        <i>Originally posted by rsvargas</i><br />
        <b><br /></b>
        <pre>
<b><code><br />[Settings]<br />NumFields=2<br /><br />[Field 1]<br />Type=Label<br />Text=Select which drive to install<br />Left=84<br />Right=256<br />Top=49<br />Bottom=57<br /><br />[Field 2]<br />Type=DropList<br />Text=DropList<br />State=C:<br />ListItems=A:|B:|C:|D:|E:|F:|G:|H:|I:|J:|K:|L:|M:|N:|O:|P:|Q:|R:|S:|T:|U:|V:|W:|X:|Y:|Z:<br />Left=84<br />Right=212<br />Top=62<br />Bottom=76<br /><br /></code></b>
</pre>
      </blockquote>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">heinkoi459</span><br />
      <span class="post-time small text-muted">19th February 2010 18:29 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Greet but I have another stupid error in this line 'StrCpy $drivesState "$9" ' (Usage: StrCpy $(user_var: output) str [maxlen] [startoffset]). So what I have to do to solve this?!<br />
      <br />
      Thank you again<br />
      <br />
      Guillaume</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">rsvargas</span><br />
      <span class="post-time small text-muted">19th February 2010 18:37 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">You need to declare the variable, you can add<br />
      PHP Code:</p>
      <hr />
      <code style="white-space:nowrap"><!-- php buffer start --></code><span style="color: #000000"><span style="color: #007700">Var</span><span style="color: #0000BB">drivesState<br /></span></span> <!-- php buffer end -->
      <hr />
      just below the line with<br />
      PHP Code:
      <hr />
      <code style="white-space:nowrap"><!-- php buffer start --></code><span style="color: #000000"><span style="color: #007700">Var</span><span style="color: #0000BB">drives<br /></span></span> <!-- php buffer end -->
      <hr />
      Or you can just delete the line which refers to this variable...
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">heinkoi459</span><br />
      <span class="post-time small text-muted">19th February 2010 20:42 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Okay, but in 'InstallDir "_\imagem\PSadmin\"' (at declaration what I have to put in '_' to have the right drive letter?)</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
      <span class="post-time small text-muted">20th February 2010 00:39 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Just use a variable in InstallDir.<br />
      <br />
      Var SystemDrive<br />
      InstallDir `$SystemDrive\some\dir`<br />
      <br />
      You just have to use ReadEnvStr $SystemDrive SYSTEMDRIVE in .onInit.<br />
      <br />
      Stu</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">heinkoi459</span><br />
      <span class="post-time small text-muted">24th February 2010 19:50 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">It didn't work, there are no letter it appear like that: /my/folder</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">rsvargas</span><br />
      <span class="post-time small text-muted">24th February 2010 19:51 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Can you post the portion of your code that try to fetch the drive letter?</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">heinkoi459</span><br />
      <span class="post-time small text-muted">24th February 2010 20:15 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">PHP Code:</p>
      <hr />
      <code style="white-space:nowrap"><!-- php buffer start --></code><span style="color: #000000"><span style="color: #007700">!</span><span style="color: #0000BB">defineAPPNAME</span><span style="color: #DD0000">"NAME"<br /></span> <span style="color: #007700">!</span><span style="color: #0000BB">defineAPPNAMEANDVERSION</span><span style="color: #DD0000">"VERSION"<br />
      <br /></span> <span style="color: #007700">Var</span><span style="color: #0000BB">SystemDrive<br />
      <br /></span> <span style="color: #007700">;</span><span style="color: #0000BB">MainInstallsettings<br />
      Name</span><span style="color: #DD0000">"${APPNAMEANDVERSION}"<br /></span> <span style="color: #0000BB">InstallDir</span><span style="color: #DD0000">"$SystemDrive\\MY\\PATH\"<br />
      InstallDirRegKeyHKLM"</span><span style="color: #0000BB">Software</span><span style="color: #007700">${</span><span style="color: #0000BB">APPNAME</span><span style="color: #007700">}</span><span style="color: #DD0000">"""<br />
      OutFile"</span><span style="color: #0000BB">C</span><span style="color: #007700">:</span><span style="color: #0000BB">Install</span><span style="color: #007700">.</span><span style="color: #0000BB">exe</span><span style="color: #DD0000">"<br />
      !definePROGPATH"</span><span style="color: #0000BB">$SystemDriveMY</span><span style="color: #DD0000">"<br />
      <br />
      RequestExecutionLeveladmin<br />
      <br />
      ;Moderninterfacesettings<br />
      !include"</span><span style="color: #0000BB">MUI</span><span style="color: #007700">.</span><span style="color: #0000BB">nsh</span><span style="color: #DD0000">"<br />
      !include"</span><span style="color: #0000BB">WinMessages</span><span style="color: #007700">.</span><span style="color: #0000BB">nsh</span><span style="color: #DD0000">"<br />
      !include"</span><span style="color: #0000BB">FileFunc</span><span style="color: #007700">.</span><span style="color: #0000BB">nsh</span><span style="color: #DD0000">"<br />
      <br />
      ;MUIWelcomepageon3lines<br />
      !defineMUI_WELCOMEPAGE_TITLE_3LINES<br />
      <br />
      ;MUISettings/Icons<br />
      !defineMUI_ICON"</span><span style="color: #007700">${</span><span style="color: #0000BB">NSISDIR</span><span style="color: #007700">}</span><span style="color: #0000BB">ContribGraphicsEntIconsEnt</span><span style="color: #007700">.</span><span style="color: #0000BB">ico</span><span style="color: #DD0000">"<br />
      !defineMUI_UNICON"</span><span style="color: #007700">${</span><span style="color: #0000BB">NSISDIR</span><span style="color: #007700">}</span><span style="color: #0000BB">ContribGraphicsEntIconsEnt</span><span style="color: #007700">.</span><span style="color: #0000BB">ico</span><span style="color: #DD0000">"<br />
      <br />
      ;MUISettings/Header<br />
      !defineMUI_HEADERIMAGE<br />
      !defineMUI_HEADERIMAGE_RIGHT<br />
      !defineMUI_HEADERIMAGE_BITMAP"</span><span style="color: #007700">${</span><span style="color: #0000BB">NSISDIR</span><span style="color: #007700">}</span><span style="color: #0000BB">ContribGraphicsEntHeaderHeader</span><span style="color: #007700">.</span><span style="color: #0000BB">bmp</span><span style="color: #DD0000">"<br />
      !defineMUI_HEADERIMAGE_UNBITMAP"</span><span style="color: #007700">${</span><span style="color: #0000BB">NSISDIR</span><span style="color: #007700">}</span><span style="color: #0000BB">ContribGraphicsEntHeaderHeader</span><span style="color: #007700">.</span><span style="color: #0000BB">bmp</span><span style="color: #DD0000">"<br />
      <br />
      ;MUISettings/Wizard<br />
      !defineMUI_WELCOMEFINISHPAGE_BITMAP"</span><span style="color: #007700">${</span><span style="color: #0000BB">NSISDIR</span><span style="color: #007700">}</span><span style="color: #0000BB">ContribGraphicsEntWizardWizard</span><span style="color: #007700">.</span><span style="color: #0000BB">bmp</span><span style="color: #DD0000">"<br />
      !defineMUI_UNWELCOMEFINISHPAGE_BITMAP"</span><span style="color: #007700">${</span><span style="color: #0000BB">NSISDIR</span><span style="color: #007700">}</span><span style="color: #0000BB">ContribGraphicsEntWizardWizard</span><span style="color: #007700">.</span><span style="color: #0000BB">bmp</span><span style="color: #DD0000">"<br />
      <br />
      ;!defineMUI_WELCOMEPAGE_TITLE'${WELCOME_TITLE}'<br />
      !insertmacroMUI_PAGE_WELCOME<br />
      !insertmacroMUI_PAGE_DIRECTORY<br />
      !insertmacroMUI_PAGE_INSTFILES<br />
      !insertmacroMUI_PAGE_FINISH<br />
      <br />
      !insertmacroMUI_UNPAGE_CONFIRM<br />
      !insertmacroMUI_UNPAGE_INSTFILES<br />
      <br />
      ;Setlanguages(firstisdefaultlanguage)<br />
      ;!insertmacroMUI_LANGUAGE"</span><span style="color: #0000BB">English</span><span style="color: #DD0000">"<br />
      !insertmacroMUI_LANGUAGE"</span><span style="color: #0000BB">French</span><span style="color: #DD0000">"<br />
      !insertmacroMUI_RESERVEFILE_LANGDLL<br />
      <br />
      !insertmacroGetDrives<br />
      <br />
      ;******************************************************************************************************<br />
      ;*INSTALL<br />
      ;******************************************************************************************************<br />
      Section"</span><span style="color: #0000BB">NAME</span><span style="color: #DD0000">"Section1<br />
      <br />
      ;SetSectionproperties<br />
      SetOverwriteon<br />
      <br />
      ;SetSectionFilesandShortcuts<br />
      SetOutPath"</span><span style="color: #0000BB">$INSTDIR</span><span style="color: #DD0000">"<br />
      File"</span><span style="color: #007700">..</span><span style="color: #0000BB">Name</span><span style="color: #007700">.</span><span style="color: #0000BB">exe</span><span style="color: #DD0000">"<br />
      File"</span><span style="color: #007700">..</span><span style="color: #0000BB">LIB</span><span style="color: #007700">.</span><span style="color: #0000BB">jar</span><span style="color: #DD0000">"<br />
      <br />
      SetOutPath"</span><span style="color: #0000BB">$INSTDIRimages</span><span style="color: #DD0000">"<br />
      File"</span><span style="color: #007700">..</span><span style="color: #0000BB">images</span><span style="color: #007700">*.*</span><span style="color: #DD0000">";<br />
      <br />
      SetOutPath"</span><span style="color: #0000BB">$INSTDIRimages_icons</span><span style="color: #DD0000">"<br />
      File"</span><span style="color: #007700">..</span><span style="color: #0000BB">imagesicons</span><span style="color: #007700">*.*</span><span style="color: #DD0000">";<br />
      <br />
      SetOutPath"</span><span style="color: #0000BB">$INSTDIRimagesright</span><span style="color: #DD0000">"<br />
      File"</span><span style="color: #007700">..</span><span style="color: #0000BB">imagesright</span><span style="color: #007700">*.*</span><span style="color: #DD0000">";<br />
      <br />
      SetOutPath"</span><span style="color: #0000BB">$INSTDIRlang</span><span style="color: #DD0000">"<br />
      File"</span><span style="color: #007700">..</span><span style="color: #0000BB">langfr</span><span style="color: #007700">.</span><span style="color: #0000BB">xml</span><span style="color: #DD0000">"<br />
      <br />
      SetOutPath"</span><span style="color: #0000BB">$INSTDIRreports</span><span style="color: #DD0000">"<br />
      File"</span><span style="color: #007700">..</span><span style="color: #0000BB">reports</span><span style="color: #007700">*.</span><span style="color: #0000BB">rpt</span><span style="color: #DD0000">"<br />
      <br />
      SetOutPath"</span><span style="color: #0000BB">$INSTDIRtmp</span><span style="color: #DD0000">"<br />
      <br />
      ;menudÃ©marrer<br />
      CreateDirectory"</span><span style="color: #0000BB">$SMPROGRAMSMYPATH</span><span style="color: #DD0000">"<br />
      CreateShortCut"</span><span style="color: #0000BB">$SMPROGRAMSMYPATHNAME</span><span style="color: #007700">.</span><span style="color: #0000BB">lnk</span><span style="color: #DD0000">""</span><span style="color: #0000BB">$INSTDIRNAME</span><span style="color: #007700">.</span><span style="color: #0000BB">exe</span><span style="color: #DD0000">"<br />
      CreateShortCut"</span><span style="color: #0000BB">$SMPROGRAMSMYPATHUninstall</span><span style="color: #007700">.</span><span style="color: #0000BB">lnk</span><span style="color: #DD0000">""</span><span style="color: #0000BB">$INSTDIRuninstall</span><span style="color: #007700">.</span><span style="color: #0000BB">exe</span><span style="color: #DD0000">"<br />
      <br />
      SectionEnd<br />
      <br />
      ;******************************************************************************************************<br />
      ;*FINISHSECTION<br />
      ;******************************************************************************************************<br />
      Section-FinishSection<br />
      <br />
      WriteRegStrHKLM"</span><span style="color: #0000BB">Software</span><span style="color: #007700">${</span><span style="color: #0000BB">APPNAME</span><span style="color: #007700">}</span><span style="color: #DD0000">""""</span><span style="color: #0000BB">$INSTDIR</span><span style="color: #DD0000">"<br />
      WriteRegStrHKLM"</span><span style="color: #0000BB">SoftwareMicrosoftWindowsCurrentVersionUninstall</span><span style="color: #007700">${</span><span style="color: #0000BB">APPNAME</span><span style="color: #007700">}</span><span style="color: #DD0000">""</span><span style="color: #0000BB">DisplayName</span><span style="color: #DD0000">""</span><span style="color: #007700">${</span><span style="color: #0000BB">APPNAME</span><span style="color: #007700">}</span><span style="color: #DD0000">"<br />
      WriteRegStrHKLM"</span><span style="color: #0000BB">SoftwareMicrosoftWindowsCurrentVersionUninstall</span><span style="color: #007700">${</span><span style="color: #0000BB">APPNAME</span><span style="color: #007700">}</span><span style="color: #DD0000">""</span><span style="color: #0000BB">UninstallString</span><span style="color: #DD0000">""</span><span style="color: #0000BB">$INSTDIRuninstall</span><span style="color: #007700">.</span><span style="color: #0000BB">exe</span><span style="color: #DD0000">"<br />
      <br />
      WriteUninstaller"</span><span style="color: #0000BB">$INSTDIRuninstall</span><span style="color: #007700">.</span><span style="color: #0000BB">exe</span><span style="color: #DD0000">"<br />
      <br />
      SectionEnd<br />
      <br />
      ;Moderninstallcomponentdescriptions<br />
      !insertmacroMUI_FUNCTION_DESCRIPTION_BEGIN<br />
      !insertmacroMUI_DESCRIPTION_TEXT${Section1}"</span><span style="color: #0000BB">Jesuslovebacon</span><span style="color: #DD0000">"<br />
      !insertmacroMUI_FUNCTION_DESCRIPTION_END<br />
      <br />
      ;******************************************************************************************************<br />
      ;*UNINSTALL<br />
      ;******************************************************************************************************<br />
      SectionUninstall<br />
      <br />
      ;Removefromregistry...<br />
      DeleteRegKeyHKLM"</span><span style="color: #0000BB">SoftwareMicrosoftWindowsCurrentVersionUninstall</span><span style="color: #007700">${</span><span style="color: #0000BB">APPNAME</span><span style="color: #007700">}</span><span style="color: #DD0000">"<br />
      DeleteRegKeyHKLM"</span><span style="color: #0000BB">SOFTWARE</span><span style="color: #007700">${</span><span style="color: #0000BB">APPNAME</span><span style="color: #007700">}</span><span style="color: #DD0000">"<br />
      <br />
      ;RemovetheMainFolder<br />
      RMDir/r"</span><span style="color: #0000BB">$INSTDIR</span><span style="color: #DD0000">"<br />
      RMDir"</span><span style="color: #007700">${</span><span style="color: #0000BB">IMAGEMPATH</span><span style="color: #007700">}</span><span style="color: #DD0000">"<br />
      <br />
      ;DeleteShortcuts<br />
      Delete"</span><span style="color: #0000BB">$SMPROGRAMSMYPATHNAME</span><span style="color: #007700">.</span><span style="color: #0000BB">lnk</span><span style="color: #DD0000">"<br />
      Delete"</span><span style="color: #0000BB">$SMPROGRAMSMYPATHUninstall</span><span style="color: #007700">.</span><span style="color: #0000BB">lnk</span><span style="color: #DD0000">"<br />
      <br />
      RMDir"</span><span style="color: #0000BB">$SMPROGRAMSMYPATH</span><span style="color: #DD0000">"<br />
      RMDir"</span><span style="color: #0000BB">$SMPROGRAMSMY</span><span style="color: #DD0000">"<br />
      SectionEnd<br />
      <br />
      Function.onInit<br />
      ReadEnvStr$SystemDriveSYSTEMDRIVE<br />
      FunctionEnd<br /></span></span> <!-- php buffer end -->
      <hr />
      When I Install the program, in Installation folde it write: \MY\PATH, so I when the lettre _:\MY\PATH<br />
      <br />
      Thank yout guys<br />
      <br />
      PS: there are missing somes "\" just don't take care about it<br />
      <br />
      Guillaume
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">rsvargas</span><br />
      <span class="post-time small text-muted">24th February 2010 20:51 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Try moving the<br />
      <br />
      PHP Code:</p>
      <hr />
      <code style="white-space:nowrap"><!-- php buffer start --></code><span style="color: #000000"><span style="color: #0000BB">InstallDir</span><span style="color: #DD0000">"$SystemDrive\MY\PATH\"<br /></span></span> <!-- php buffer end -->
      <hr />
      statement to the .onInit function. The .onInit function should be like this:<br />
      <br />
      PHP Code:
      <hr />
      <code style="white-space:nowrap"><!-- php buffer start --></code><span style="color: #000000"><span style="color: #007700">Function.</span><span style="color: #0000BB">onInit<br />
      ReadEnvStr$SystemDriveSYSTEMDRIVE<br />
      InstallDir</span><span style="color: #DD0000">"$SystemDrive\\MY\\PATH\\"<br /></span> <span style="color: #0000BB">FunctionEnd<br /></span></span> <!-- php buffer end -->
      <hr />
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
      <span class="post-time small text-muted">24th February 2010 21:46 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">You're right. InstallDir is being evaluated while $SystemDrive is still empty.<br />
      <br />
      Instead just use this in .onInit:<br /></p>
      <pre>
<code>Function .onInit<br />  ReadEnvStr $R0 SYSTEMDRIVE<br />  StrCpy $INSTDIR `$R0\MY\PATH\`<br />FunctionEnd</code>
</pre><br />
      <br />
      @ rsvargas:<br />
      InstallDir is a compile time instruction. It is not valid within a Function or Section.<br />
      <br />
      Stu
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">rsvargas</span><br />
      <span class="post-time small text-muted">24th February 2010 21:58 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">@Afrow UK<br />
      My bad, I use the StrCpy $INSTDIR way to set the directory in my installers, and didn't remember that the InstallDir directive would not work in a function, thanks!</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">heinkoi459</span><br />
      <span class="post-time small text-muted">4th March 2010 14:36 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Thank you really much Afrow UK :D</p>
    </div>
    <hr />

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]>
  </script>
</body>
</html>
