<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="description" content="HKLM and &quot;limited user&quot; installations"><title>HKLM and "limited user" installations - NSIS Forums</title><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script><link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css"><link rel="stylesheet" href="../css/style.css" type="text/css"></head><body><div class="container"><ol class="breadcrumb"><li><a href="../index.html" class="glyphicon glyphicon-home"></a></li><li><a href="f-65.html">NSIS Discussion</a></li><li class="active">HKLM and "limited user" installations</li></ol><p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=237355">HKLM and "limited user" installations</a></p><br><div class="post"><p class="post-meta"><span class="post-author text-primary">l_d_allan</span><br><span class="post-time small text-muted">6th February 2006 21:34 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>HKLM and "limited user" installations</strong><br>I'm trying to convert an older InstallShield script that wrote information about the installation directory path to:<br>HKLM SOFTWARE\Microsoft\Windows\CurrentVersion\Apps Path<br><br>Is this a "no no" as far as writing to HKLM because it assumes the end-user has Administator privilege?<br><br>In the past, I've never worried about this, but perhaps I should have. I've pretty much assumed the end-user was on a system as Administrator.<br><br>My understanding is that a Win2000 / WinXp "limited user" without "power user" or "administator" privilege can read HKLM registry entries, but not write them.<br><br>I've looked at the Microsoft webpages regarding WinXp certification, but I'm not clear about what is recommended vs what is required. A link (or three) for additional information would be appreciated.<br><br>We want to be able to detect previous installations (to re-install) and to leave registry "bread crumbs" as to where the installation was done. Is something related to HKLM a poor choice?<br><br>Some of the webpages I've read seem to indicate that during installation, there may be some increase in privilege for a "limited user", but that this won't be available during normal running of the app ... but I may not have been clear about what I was reading.<br><br>The examples for classic and MUI use HKCU.<br><br>I'm trying to simplify the "detection sniffer" as to where previous installations have been done. I would prefer not to have to "sort out" that there is a really old installation indicated by HKLM entries, and a newer installation indicated by a HKCU entry.<br><br>I suppose if this stuff was simple, it wouldn't pay so well &lt;g ... written as a freeware developer&gt;</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Comperio</span><br><span class="post-time small text-muted">7th February 2006 04:10 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Generally, it's best to make sure any installations are performed using an administrator account.<br><br>Here's a few links I found you might find helpful regarding user accounts:<br><a href="http://www.microsoft.com/resources/documentation/windows/xp/all/proddocs/en-us/ua_c_account_types.mspx" target="_blank">http://www.microsoft.com/resources/d...unt_types.mspx</a><br><br><a href="http://www.microsoft.com/technet/prodtechnol/winxppro/maintain/luawinxp.mspx" target="_blank">http://www.microsoft.com/technet/pro.../luawinxp.mspx</a><br><br>As far as automatically elevating prevledges, I'm not sure if this is something that can be done with NSIS or not. (probably the best you could do is check permsission .onInit and if not sufficient, exit the installation.)<br><br>On a related note, I did find elevated installations seem to be possible with Windows Installer:<br><a href="http://msdn.microsoft.com/library/default.asp?url=/library/en-us/msi/setup/alwaysinstallelevated.asp" target="_blank">http://msdn.microsoft.com/library/de...llelevated.asp</a><br><br>Perhpas other might offer more feedback related to NSIS...</p></div><hr><div class="footer"><p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p></div></div><script src="../js/highlight.pack.js" type="text/javascript"></script><script type="text/javascript">//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]></script></body></html>