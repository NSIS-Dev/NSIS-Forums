<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="description" content="VB again and again"><title>VB again and again - NSIS Forums</title><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script><link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css"><link rel="stylesheet" href="../css/style.css" type="text/css"><!--[if lt IE 9]><script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script><script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script><![endif]--></head><body><div class="container"><ol class="breadcrumb"><li><a href="../index.html" class="glyphicon glyphicon-home"></a></li><li><a href="f-65.html">NSIS Discussion</a></li><li class="active">VB again and again</li></ol><p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=78378">VB again and again</a></p><br><div class="post"><p class="post-meta"><span class="post-author text-primary">KhaZt</span><br><span class="post-time small text-muted">5th March 2002 22:24 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>VB again and again</strong><br>Hello<br>Well i've been searching for all posts concerning how to instal vb dlls but none were understandable for me :/<br>I've made a visual basic application,and i know that if someone wants to run my app properly he must first have these files listed belove installed<br>-<br>system files needed:<br>asycfilt.dll<br>axdist.exe<br>comcat.dll<br>ctl3d32.dll<br>dx7vb.dll<br>mscmcfr.dll<br>mscomctl.ocx<br>msinet.ocx<br>msvbvm50.dll<br>mswinsck.ocx<br>oleaut32.dll<br>olepro32.dll<br>rchtxfr.dll<br>riched32.dll<br>richtx32.ocx<br>stdole2.tlb<br>swflash.ocx<br>sysinfo.ocx<br>vb5fr.dll<br>winskfr.dll<br>-<br>As im completely a newbie concerning dlls/ocx etc.. registration i don't know what to write in my .nsi file =/<br>I know there should be a few probs:<br>-how do i install "normal" dlls?<br>-how do i instal "shared" dlls (i dont even know what does that mean :/)<br>-how do i instal ocx ? and is there "shared" ocx too?<br>-how do instal stdole2.tlb?<br>-what do i have to do with the axdist.exe ?<br>-Do i have to use the WriteRegDWORD command? when?<br>I ve been searching for about 1 week and still got all these questions...if someone could be nice enough to help me it would be great...thxs a lot!</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">SmartyMan</span><br><span class="post-time small text-muted">5th March 2002 23:17 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>Re: VB again and again</strong><br></p><blockquote><i>Originally posted by KhaZt</i><br><b><br>As im completely a newbie concerning dlls/ocx etc.. registration i don't know what to write in my .nsi file =/<br></b></blockquote>Use the RegDLL command for all OCX and for self registering .dll files (use dependency walker to find out which of your .dll have a method named "DllRegisterServer").<br>Ive not prooved this, but I think this will work for all of the listed files.</div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">KhaZt</span><br><span class="post-time small text-muted">6th March 2002 19:34 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Do you mean there's 2 sort of dll,the selfregistering ones and the shared ones?<br>I think i can know which one are shared or selfregistered via the setup.lst generated by the vb setup tool;look:<br><br>File1=1,,VB5FR.dl_,VB5FR.dll,$(WinSysPath),,$(Shared),3/14/1998 15:47:24,96256,5.0.43.19,"","",""<br>File2=1,,MSVBVM50.dl_,MSVBVM50.dll,$(WinSysPathSysFile),$(DLLSelfRegister),,5/1/1998<br><br>but what surprise me is that for all .ocx,it says $(Shared) and $(DLLSelfRegister) both:<br>File1=1,,MSWINSCK.OC_,MSWINSCK.OCX,$(WinSysPath),$(DLLSelfRegister),$(Shared),2/4/2002 17:15:46,109248,6.0.88.4,"","",""<br><br>Anyone got an idea about these differences?<br>I find "WriteRegDWORD HKLM Software\Microsoft\CurrentVersion\SharedDLLs ..." in a post talking about dlls...do you know if i need that WriteRegDWORD for the shared dlls/ocx ?</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">SmartyMan</span><br><span class="post-time small text-muted">6th March 2002 23:59 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"></p><blockquote><i>Originally posted by KhaZt</i><br><b>Do you mean there's 2 sort of dll,the selfregistering ones and the shared ones?</b></blockquote>No, there are much more types :)<br><br><blockquote>I think i can know which one are shared or selfregistered via the setup.lst generated by the vb setup tool;look:</blockquote>Then you already know what to do :)<br><br><blockquote>but what surprise me is that for all .ocx,it says $(Shared) and $(DLLSelfRegister) both:</blockquote>What is your problem with this?<br>Just install these files to system/system32 and implement a call to RegDLL.<br><br><blockquote>I find "WriteRegDWORD HKLM Software\Microsoft\CurrentVersion\SharedDLLs ..." in a post talking about dlls...do you know if i need that WriteRegDWORD for the shared dlls/ocx ?</blockquote>If you want to install shared .dll as thought by MS, then you have to init a counter, but you can install them also in your apps dir and leave the registry alone.</div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">DuaneJeffers</span><br><span class="post-time small text-muted">7th March 2002 03:04 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">How about this, Make it a system requirement to have the latest vb runtimes. That way, you won't have to worry about making sure the person has the proper dlls and you can have a lighter app that your downloaders will enjoy.<br><br>-Duane</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">KhaZt</span><br><span class="post-time small text-muted">7th March 2002 22:47 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Thxs a lot SmartyMan gonna try this :)<br>DuaneJeffers the pb with vb runtimes is that it does not include any .ocx :/</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">ViperInc</span><br><span class="post-time small text-muted">8th March 2002 09:24 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>vb runtimes</strong><br>um..<br>silly quiestion,<br>but why not just incude teh 1meg vb runtimes with the program, and at the start just do a search to see if vb6.dll (or wateva) is under system, and if not run the .exe file.. thats what i do... but it does take up so much room....</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">KhaZt</span><br><span class="post-time small text-muted">8th March 2002 16:32 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Msvbm50.exe contains Msvbvm50.dll, Oleaut32.dll, Olepro32.dll, Stdole2.tlb, Asycfilt.dll and Comcat.dll that's all...and i need many other files.<br>Btw i'm not sure of how to run msvbm50.exe silently:exec "Msvbvm50.exe /q" doesn't work...anyone know?</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">ViperInc</span><br><span class="post-time small text-muted">8th March 2002 23:04 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">umm<br><br>just get all the vb 6 dlls work the same...<br>the file is called vbruntimes.exe and is about 1mb<br><br>then from the nsis just extract the file to a temp directory, run it there, then delete it.. simple..<br>i can show you how i did it if u need help<br><br>Viper</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">KhaZt</span><br><span class="post-time small text-muted">9th March 2002 13:02 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">In fact the /q switch works fine for vbrun60.exe:it installs the files silently.But it doesn't work with msvbm50.exe since its not a self-extractor file (like vbrun60.exe) :/ So if you know a version of vb 5 runtimes which support /q switch that would help me a lot as vbrun60 won't 100% work for my vb5 app :|</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">ViperInc</span><br><span class="post-time small text-muted">10th March 2002 06:46 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">really..<br><br>well ther eu go, bloody micrsoft making new versions incompadible...<br><br>ill take a look and see if i can find a self installin file....<br><br>but why not make the installation visible, and just instruct the uset that he need the vb5 dlls</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">KhaZt</span><br><span class="post-time small text-muted">10th March 2002 21:20 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>rah</strong><br>rah i couldnt find any self-extracting versions so i started trying a few other parameters and it appears that /s switch for msvbvm50.exe works! i still don't understand why it's /q for 6.0runtimes and /s for 5.0 ones..<br>Anyway thxs to all who helped me...i finally did it! :P</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">meaningoflights</span><br><span class="post-time small text-muted">12th January 2008 23:22 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">good link to finish off thread:<br>http://support.microsoft.com/kb/192461</p></div><hr><div class="footer"><p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p></div></div><script src="../js/highlight.pack.js" type="text/javascript"></script><script type="text/javascript">//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]></script></body></html>