<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="description" content="Another Compile Time Question"><title>Another Compile Time Question - NSIS Forums</title><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script><link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css"><link rel="stylesheet" href="../css/style.css" type="text/css"></head><body><div class="container"><ol class="breadcrumb"><li><a href="../index.html" class="glyphicon glyphicon-home"></a></li><li><a href="f-65.html">NSIS Discussion</a></li><li class="active">Another Compile Time Question</li></ol><p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=215620">Another Compile Time Question</a></p><br><div class="post"><p class="post-meta"><span class="post-author text-primary">stonkers</span><br><span class="post-time small text-muted">10th May 2005 17:47 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>Another Compile Time Question</strong><br>I have to go one step further with this. At compile time, I have to find filenames and use them at runtime. It would be horrible to try to hardcode this many files. Is this possible? Here's the code with a bit of pseudo thrown in:<br><br>;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;<br>Name "Test"<br><br>;Output File Name<br>OutFile "test.exe"<br><br>Section "Install"<br><br>;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;<br>;Find any dll's to deploy, deploy them, and register them ;<br>;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;<br><br>!system 'ECHO ;FileCheck&gt;"%TEMP%\Temp$$$.nsh"'<br>!system 'IF EXIST "D:\CheckFileTest\Folder1\*.dll" ECHO !define Folder1&gt;&gt;"%TEMP%\Temp$$$.nsh"'<br>!include "$%TEMP%\Temp$$$.nsh"<br>!system 'DEL "%TEMP%\Temp$$$.nsh"'<br><br>!ifdef Folder1<br>;;;COMPILE TIME CODE;;;<br>!system 'dir /B "D:\CheckFileTest\Folder1\*.dll" &gt; myFile.txt'<br>open myFile.txt<br>whileNotEndOfFile<br>$FileName = getLine myFile.txt<br><br>;;;RUNTIME CODE;;;<br>IfFileExists "$INSTDIR\$FileName" 0 new_installation<br>StrCpy $ALREADY_INSTALLED 1<br><br>new_installation:<br>!insertmacro InstallLib REGDLL $ALREADY_INSTALLED NOREBOOT_NOTPROTECTED $FileName $INSTDIR\$FileName %TEMP%<br>endWhile<br>!endif<br><br>SectionEnd<br><br>;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;<br><br>Thanks,<br>Eric</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br><span class="post-time small text-muted">10th May 2005 18:04 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">You'll have to write an NSIS program to do it:<br><a href="http://nsis.sourceforge.net/archive/nsisweb.php?page=920&amp;instances=0,44" target="_blank">http://nsis.sourceforge.net/archive/...instances=0,44</a><br><br>-Stu</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">stonkers</span><br><span class="post-time small text-muted">10th May 2005 19:00 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">I just couldn't come up with how this was going to pass back one filename at a time. I guess I'd have to call one NSIS program to the write the filenames, then call a different program to grab one line at a time and delete that line, until all was gone??? Seems like a lot of work.<br><br>But I think I've got an easier way. NSIS is obviously best at runtime stuff. I use NAnt in conjunction with NSIS in all of my builds. So, I'll use NAnt to do the compile time stuff and add code (via NAnt) to the NSIS script to put the "dll deployment" code into the NSIS script. I'll post an example here when I'm done if anyone is interested. Thanks for the help Stu!</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Instructor</span><br><span class="post-time small text-muted">11th May 2005 11:19 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">To have all features of NSIS run-time: "create single exe and hand needfull parameters by CMDLINE (Call this single exe with !execute)"</p></div><hr><div class="footer"><p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p></div></div><script src="../js/highlight.pack.js" type="text/javascript"></script><script type="text/javascript">//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]></script></body></html>