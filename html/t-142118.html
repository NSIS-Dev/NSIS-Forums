<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="description" content="Help!"><title>Help! - NSIS Forums</title><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script><link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css"><link rel="stylesheet" href="../css/style.css" type="text/css"></head><body><div class="container"><ol class="breadcrumb"><li><a href="../index.html" class="glyphicon glyphicon-home"></a></li><li><a href="f-65.html">NSIS Discussion</a></li><li class="active">Help!</li></ol><p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=142118">Help!</a></p><br><div class="post"><p class="post-meta"><span class="post-author text-primary">Zpeek</span><br><span class="post-time small text-muted">14th July 2003 05:36 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>Help!</strong><br>Ok, I need NSIS to help me.<br><br>I made some reg file that do different thing to tweak windows.<br>But now i need NSIS to active them easy-er.<br><br>The files i use are .reg files.<br><br>Windows<br>1. I need a Message window, you know saying<br>damage to computer etc.<br>2. Then it how active reg<br>3. Then the last window saying Complete.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">n0On3</span><br><span class="post-time small text-muted">14th July 2003 07:29 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">I didn't understand you very clearly... but here are some answers:<br><br>1) add:<br>MessageBox MB_OK "We are going to damage your computer, ok?"<br><br>2) use this to enter .reg to registry:<br>ExecWait "REGEDIT.EXE /S file.REG"<br><br>3) I don't understand at all. When the install is complete nsis always says "Complete". If you want another 'complete' in the window, do this:<br>DetailPrint "Complete"<br><br><br>(the last sentence in every answer is the command you have to add in the .nsi file)</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Vytautas</span><br><span class="post-time small text-muted">14th July 2003 13:18 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Would it not be better to convert the .reg files into an NSIS script. Since NSIS can work with the registry it should make the installer easier to manage and might even make it faster.<br><br>Vytautas</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">kichik</span><br><span class="post-time small text-muted">14th July 2003 14:58 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">This new utility converts .reg files or registry keys to NSIS commands:<br><br><a href="http://nsis.sourceforge.net/archive/viewpage.php?pageid=296" target="_blank">http://nsis.sourceforge.net/archive/...php?pageid=296</a></p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">n0On3</span><br><span class="post-time small text-muted">14th July 2003 23:33 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>sure?</strong><br></p><blockquote><i>Originally posted by Vytautas</i><br><b>and might even make it faster.</b></blockquote>Are you sure it can be faster? I am not a pragmatic programmer, but make nsis add one value to registry, and then another, and then another..., seems slower than adding a .reg file directly (which will add one value and then another...)</div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Vytautas</span><br><span class="post-time small text-muted">15th July 2003 12:47 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">'.reg' files also have to enter values one by one, this is done by the regedit program. So the value entry speed should be about the same. NSIS however does not need to extract a file and open an external program so it should make it quicker. Although on most fast machines you will probably not notice a lot of difference. Well, that' the theory anyway;)<br><br>Vytautas</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">kichik</span><br><span class="post-time small text-muted">15th July 2003 12:54 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Indeed you shouldn't notice any difference. But NSIS should be faster because it doesn't read and parse a text file but its own format which is designed to run fast, doens't need too much error checking and simply has to read less.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Zpeek</span><br><span class="post-time small text-muted">16th July 2003 03:38 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Question i try the file thats converts reg file into nsis command.<br><br>Ok, i did Reg2Nsis doc.reg then it type out some text.<br><br>Now what do i do?</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">n0On3</span><br><span class="post-time small text-muted">16th July 2003 04:44 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">I suppose that text that typed out is the text you have to write inside a section in the .nsi file.<br><br>Doesn't that program come with instrucionts?<br><br><br>kichik and Vytautas: ok, you explanantions sound reasonable, so nsis can be faster ;)</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Zpeek</span><br><span class="post-time small text-muted">16th July 2003 05:01 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Ok heres the script:<br><br>;Perform A Silent Install<br>SilentInstall silent<br>BrandingText " "<br><br>!include doc.reg<br><br>----------------------------------<br>Here's the error<br>----------------------------------<br>Processing script file: "C:\WINDOWS\Desktop\aa.nsi"<br>SilentInstall: silent<br>BrandingText: " "<br>!include: "doc.reg"<br>Invalid command: REGEDIT4<br>!include: error in script: "doc.reg" on line 1<br>Error in script "C:\WINDOWS\Desktop\aa.nsi" on line 5 -- aborting creation process<br><br>Can someone help me pls.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">kichik</span><br><span class="post-time small text-muted">16th July 2003 09:52 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">You're not supposed to include the .reg file, you're supposed to include the output of the program. And you're supposed to include it in a section as it contains insturctions.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Zpeek</span><br><span class="post-time small text-muted">17th July 2003 06:30 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Ok here is the file:<br><br>############################### reg2nsis begin #################################<br># This NSIS-script is generated by the reg2nsis utility #<br># Author : Artem Zankovich #<br># URL : <a href="http://aarrtteemm.nm.ru" target="_blank">http://aarrtteemm.nm.ru</a> #<br># You can freely inserts it into your setup script as inline text or via #<br># !include directive. Please don't remove this header. #<br>################################################################################<br><br>WriteRegBin HKEY_CURRENT_USER "Software\Microsoft\Windows\CurrentVersion\Policies\Explorer" "NoDriveTypeAutoRun" 95000000<br><br>############################### reg2nsis end #################################<br><br>---------------------------------------------------------------<br>When i enter it in MakeNSIS-Complie and got an error:<br>---------------------------------------------------------------<br>Processing script file: "C:\WINDOWS\Desktop\Reg2Nsis002\test.nsi"<br>WriteRegBin: HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Policies\Explorer\NoDriveTypeAutoRun=95000000<br>Error: Can't add entry, no section or function is open!<br>Error in script "C:\WINDOWS\Desktop\Reg2Nsis002\test.nsi" on line 9 -- aborting creation process<br><br>HELP PLS</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">kichik</span><br><span class="post-time small text-muted">17th July 2003 12:38 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">You're supposed to use !include "filename.nsh" inside the section/function you wish to write those registry entries. For example:<br><br>Section "Install stuff"<br>File bla.exe<br>File foo.txt<br>!include "RegEntries.nsh"<br>SectionEnd</p></div><hr><div class="footer"><p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p></div></div><script src="../js/highlight.pack.js" type="text/javascript"></script><script type="text/javascript">//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]></script></body></html>