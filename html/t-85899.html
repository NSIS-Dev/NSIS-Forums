<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="description" content="Uninstall does not work on 1.96 and 1.97"><title>Uninstall does not work on 1.96 and 1.97 - NSIS Forums</title><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script><link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css"><link rel="stylesheet" href="../css/style.css" type="text/css"><!--[if lt IE 9]><script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script><script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script><![endif]--></head><body><div class="container"><ol class="breadcrumb"><li><a href="../index.html" class="glyphicon glyphicon-home"></a></li><li><a href="f-65.html">NSIS Discussion</a></li><li class="active">Uninstall does not work on 1.96 and 1.97</li></ol><p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=85899">Uninstall does not work on 1.96 and 1.97</a></p><br><div class="post"><p class="post-meta"><span class="post-author text-primary">ghverdun</span><br><span class="post-time small text-muted">25th April 2002 17:35 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>Uninstall does not work on 1.96 and 1.97</strong><br>I have a simple installer with a few files in the install section and no license text.<br><br>The uninstaller fails to remove any files because it appears that the $EXEDIR points to the temp dir and the $INSTDIR and $OUTDIR point to the $EXEDIR instead of the installed dir.<br><br>Anyone else seeing this?</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Smile2Me</span><br><span class="post-time small text-muted">25th April 2002 17:37 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">No, but post your script and maybe we can find the mistake...<br><br>Greetz,<br>-Hendri.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">ghverdun</span><br><span class="post-time small text-muted">25th April 2002 17:54 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Ok, so with this script.. In the uninstaller the Messagebox shows that the $EXEDIR as set to the temp dir and the $INSTDIR is set to what $EXEDIR should have been set to.<br><br>Name "Test"<br>Caption "Test Installer"<br>OutFile "Install_Test.exe"<br>AutoCloseWindow false<br>ShowInstDetails show<br>ShowUninstDetails show<br>DirText "Please select a location to install Test (or use the default):"<br>BrandingText "Test"<br>SetOverwrite on<br>SetDateSave on<br>WindowIcon off<br><br>InstallDir $EXEDIR\test<br><br>;<br>; Test Components<br>;<br>Section Test<br>SetOutPath $INSTDIR<br>file "Test.exe"<br>SectionEnd<br><br>Section -post<br>SetOutPath $INSTDIR<br><br>Delete $EXEDIR\Uninstall_Test.exe<br>WriteUninstaller $EXEDIR\Uninstall_Test.exe<br>SectionEnd<br><br>Section Uninstall<br>MessageBox MB_OK "$EXEDIR $INSTDIR"<br>Delete "$EXEDIR\Uninstall_Test.exe"<br>Delete "$INSTDIR\Test.exe"<br>SectionEnd</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Smile2Me</span><br><span class="post-time small text-muted">25th April 2002 19:00 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">This is a working script:</p><pre>
<code>Name "Test" <br>OutFile "Test.exe" <br><br>InstallDir $EXEDIR\test <br><br>Section Test <br>  SetOutPath $INSTDIR <br>  file "Test.txt" <br>SectionEnd <br><br>Section -post <br>  SetOutPath $INSTDIR <br>  Delete $INSTDIR\Uninst.exe <br>  WriteUninstaller $INSTDIR\Uninst.exe <br>SectionEnd <br><br>Section Uninstall <br>  Delete "$INSTDIR\Uninst.exe" <br>  Delete "$INSTDIR\Test.txt"<br>  RMDir $INSTDIR <br>SectionEnd</code>
</pre>Mistake: be carefull not to mix up $EXEDIR and $INSTDIR. If you define $INSTDIR as $EXEDIR, then you could mix up (without problems) the two vars in the installer section. But in the uninstaller section NOT. The reason is that the uninstaller copies itself to the tempdir to be able to delete itself from the install dir. So $EXEDIR then becomes $TEMP (for the uninstaller, as you observed!) and cannot be used to delete files anymore. For this purpose, keep on using $INSTDIR!<br>
      <br>
      Good luck, greetz,<br>
      -Hendri.
    </div>
    <hr>

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]></script></body></html>