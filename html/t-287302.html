<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="2.35 nsExec Trojan.Win32.Agent.fqk Kaspersky false positive" />

  <title>2.35 nsExec Trojan.Win32.Agent.fqk Kaspersky false positive - NSIS Forums</title>
  <script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script>
  <!-- Bootstrap core CSS -->

  <link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css" />
  <link rel="stylesheet" href="../css/style.css" type="text/css" /><!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!--[if lt IE 9]>
                <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
                <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->
</head>

<body>
  <div class="container">
    <!-- Put navigation bar here -->

    <ol class="breadcrumb">
      <li><a href="../index.html" class="glyphicon glyphicon-home"></a></li>

      <li><a href="f-65.html">NSIS Discussion</a></li>

      <li class="active">2.35 nsExec Trojan.Win32.Agent.fqk Kaspersky false positive</li>
    </ol>

    <p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=287302">2.35 nsExec Trojan.Win32.Agent.fqk Kaspersky false positive</a></p><br />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Takhir</span><br />
      <span class="post-time small text-muted">21st February 2008 08:04 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>2.35 nsExec Trojan.Win32.Agent.fqk Kaspersky false positive</strong><br />
      Just to keep you informed - I've sent a report to Kaspersky labs, and they confirmed 'false positive' situation, promised to fix this soon. Can be reproduced on simple script</p>
      <pre>
<code>Name "nsExec Test"<br />OutFile "nsExec Test.exe"<br />ShowInstDetails show<br />Section "MakeNSIS commands help"<br />;  ExecDos::exec '"c:\qstar\bin\helper.exe" inssvc stop' "" "$EXEDIR\helper.log"<br />nsexec::exec '"c:\qstar\bin\helper.exe" inssvc stop'<br />Pop $0<br />DetailPrint " c:\qstar\bin\helper.exe      Return value: $0"<br />SectionEnd</code>
</pre>ExecDos not caused any problems (today :) ).<br />
      Antivirus alert was on tmp file during nsExec.dll extraction to the temporary dir.
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
      <span class="post-time small text-muted">22nd February 2008 09:25 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Will this automatic stuff ever stop? We should add all NSIS files into the default Windows installation or something...</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Takhir</span><br />
      <span class="post-time small text-muted">22nd February 2008 14:28 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">False positive fixed in today's update form Kaspersky.<br />
      If I correctly understood KichiK' note about 'c:\qstar\...' Now in script</p>
      <pre>
<code>#InstallDir "$PROGRAMFILES64\${SHORT_NAME}"<br />InstallDir "C:\${SHORT_NAME}"</code>
</pre>both root and $PROGRAMFILES tested, and I am realy don't like all these Pithon's, MinGW and other installing to disk root, but executive director says this is better and so it is. :)
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
      <span class="post-time small text-muted">22nd February 2008 14:36 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">I wasn't referring to your script. I was complaining about the automatic process anti-virus companies use that cause all of these false positives. Then I went on to "suggest" a solution of including all NSIS files in the default installation of Windows because surely they check for false positives on those.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kalverson</span><br />
      <span class="post-time small text-muted">16th April 2008 18:00 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Several of our testers are getting a hit on Trojan.Win32.Agent.jkv. Is there a way to identify/capture the tmp file to send in to Kaspersky? We need to get past this if it is a false positive.<br />
      <br />
      From AV Log<br />
      C:\DOCUME~1\lmeadows\LOCALS~1\Temp\nsb32.tmp\ns33.tmp;is a Trojan<br />
      Trojan.Win32.Agent.jzv;4/15/2008 9:34:31 AM<br />
      <br />
      This seems to be repeated for 10 temporary files during the install. An AV scan of the machines HD, once the install completes, does not seem to find any trace of this virus.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kalverson</span><br />
      <span class="post-time small text-muted">16th April 2008 19:18 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">A co-worker has identified that nsExec.dll is the problem. A quote from my co-worker:<br />
      We've secretly replaced our fine ground nsExec coffee with Folger's ExecWaits. Let's see if Kaspersky notices...<br />
      <br />
      Nio, Kaspersky isn't complaining at all. No ugly red windows popping up.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kalverson</span><br />
      <span class="post-time small text-muted">21st April 2008 13:19 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">In case anyone is interested, we resolved this problem by extracting the nsExec.dll from NSIS 2.36 and using that instead of the one from NSIS 2.29. There was a fix, so apparently it is no longer identified as a false positive in version 2.36 by Kaspersky.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kalverson</span><br />
      <span class="post-time small text-muted">21st May 2008 13:51 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">This worked for awhile. A new virus report has come in from the latest build today. Here is the information reported: I received anti-virus alert that trojan program "Trojan.win32.Agent.muq" was detected.<br />
      file ns88.tmp</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">nsfis</span><br />
      <span class="post-time small text-muted">29th July 2008 12:27 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Same happens here. Our users are reporting problem with Avast antivirus. Currently we are using NSIS 2.37, it is OK when we use nsexec.dll from NSIS 2.29. In fact, the problem is not with nsexec.dll but with its temporary copy (e.g. ns6A.tmp) which is different only in 4 bytes. Does anyone know why NSIS creates modified temporary copy of nsexec.dll?</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Anders</span><br />
      <span class="post-time small text-muted">29th July 2008 12:49 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">IIRC the nsexec copy is a exe and not a dll</p>
    </div>
    <hr />

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]>
  </script>
</body>
</html>
