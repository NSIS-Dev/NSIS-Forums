<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="description" content="Microsoft Certified"><title>Microsoft Certified - NSIS Forums</title><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script><link rel="preload" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css" as="style" onload="this.rel='stylesheet'"><link rel="preload" href="../css/style.css" as="style" onload="this.rel='stylesheet'"><noscript><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css"><link rel="stylesheet" href="../css/style.css"></noscript><script>!function(a){"use strict";var b=function(b,c,d){function e(a){return h.body?a():void setTimeout(function(){e(a)})}function f(){i.addEventListener&&i.removeEventListener("load",f),i.media=d||"all"}var g,h=a.document,i=h.createElement("link");if(c)g=c;else{var j=(h.body||h.getElementsByTagName("head")[0]).childNodes;g=j[j.length-1]}var k=h.styleSheets;i.rel="stylesheet",i.href=b,i.media="only x",e(function(){g.parentNode.insertBefore(i,c?g:g.nextSibling)});var l=function(a){for(var b=i.href,c=k.length;c--;)if(k[c].href===b)return a();setTimeout(function(){l(a)})};return i.addEventListener&&i.addEventListener("load",f),i.onloadcssdefined=l,l(f),i};"undefined"!=typeof exports?exports.loadCSS=b:a.loadCSS=b}("undefined"!=typeof global?global:this);!function(a){if(a.loadCSS){var b=loadCSS.relpreload={};if(b.support=function(){try{return a.document.createElement("link").relList.supports("preload")}catch(b){return!1}},b.poly=function(){for(var b=a.document.getElementsByTagName("link"),c=0;c<b.length;c++){var d=b[c];"preload"===d.rel&&"style"===d.getAttribute("as")&&(a.loadCSS(d.href,d,d.getAttribute("media")),d.rel=null)}},!b.support()){b.poly();var c=a.setInterval(b.poly,300);a.addEventListener&&a.addEventListener("load",function(){b.poly(),a.clearInterval(c)}),a.attachEvent&&a.attachEvent("onload",function(){a.clearInterval(c)})}}}(this);</script></head><body><div class="container"><ol class="breadcrumb"><li><a href="../index.html" class="glyphicon glyphicon-home"></a></li><li><a href="f-65.html">NSIS Discussion</a></li><li class="active">Microsoft Certified</li></ol><p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=344755">Microsoft Certified</a></p><br><div class="post"><p class="post-meta"><span class="post-author text-primary">kalverson</span><br><span class="post-time small text-muted">10th May 2012 17:18 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>Microsoft Certified</strong><br>I am curious if anyone has certified with Microsoft using a Nullsoft installer?<br><br>Has anyone done this?</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Anders</span><br><span class="post-time small text-muted">10th May 2012 17:49 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">It used to be MSI only but they have relaxed those requirements now so I don't see why not.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">kalverson</span><br><span class="post-time small text-muted">27th August 2012 13:11 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">You may be right. The test cases do allow for other "commercially" available installers to be used. I would think that Nullsoft would fall into this class. However, the file version does not work right for Nullsoft. I know there are some links for alternate scripting that "brings back the older version tab", but this may not be considered a "properly versioned file" which Microsoft requires of every file included in an install as well as the installer itself. Is there any chance that this could be fixed?</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Anders</span><br><span class="post-time small text-muted">27th August 2012 14:36 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">The version tab was removed in Vista...</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">kalverson</span><br><span class="post-time small text-muted">27th August 2012 16:04 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">From the NSIS manual:<br><br>4.8.3.2 VIProductVersion<br>[version_string_X.X.X.X]<br>Adds the Product Version on top of the Version Tab in the Properties of the file.<br><br>VIProductVersion "1.2.3.4"<br><br>My code:<br><br>!define PRODUCT_VERSION_MAJOR.MINOR "3.0"<br><br>VIProductVersion "${PRODUCT_VERSION_MAJOR.MINOR}.0.0"<br><br>The resulting installer exe has a blank for Product version.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">kalverson</span><br><span class="post-time small text-muted">27th August 2012 16:07 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">I guess this must be difference because it is on the "Details" tab now instead. My question is can the 4.8.3.2 VIProductVersion be fixed to populate the "Details tab instead.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br><span class="post-time small text-muted">27th August 2012 16:51 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">VIAddVersionKey ProductVersion 1.0.0.0<br>VIAddVersionKey FileVersion 1.0.0.0<br><br>Stu</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">kalverson</span><br><span class="post-time small text-muted">28th August 2012 15:27 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Thanks Stu,<br><br>That worked great :)</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">kalverson</span><br><span class="post-time small text-muted">14th November 2012 16:59 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">I am getting some error from the Microsoft readiness tool for 2012 servers. There are some complains about the NSIS setup exe failing these checks:<br>Image is not marked as NX compatible<br>Image is not marked as Dynamic Base compatible<br>No SAFESEH (LOAD_CONFIG absent)<br>Does anyone know if this can be corrected on an NSIS setup exe built by NSIS?</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Anders</span><br><span class="post-time small text-muted">14th November 2012 20:43 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">We might be able to set these flags in the future, in the mean time you can hex edit the 2.46 stubs. You can find the PE DllCharacteristics flags @ <a href="http://msdn.microsoft.com/en-us/library/windows/desktop/ms680339%28v=vs.85%29.aspx" target="_blank">http://msdn.microsoft.com/en-us/libr...=vs.85%29.aspx</a> You can find the offset with <a href="http://wjradburn.com/software/#PEView" target="_blank">http://wjradburn.com/software/#PEView</a> if you don't have Visual Studio and editbin.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">kalverson</span><br><span class="post-time small text-muted">15th November 2012 13:48 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Thanks Anders, that was exactly the information I needed. I did find that I could use CFF Explore VII to modify those flags. The Microsoft tool even has a dialog breaking out what all the bits mean and checkboxes to turn the flags on. The tool launches from the explore right-click menu on highlighted exe's so it is very convenient to use.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Anders</span><br><span class="post-time small text-muted">15th November 2012 18:18 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Note that IMAGE_DLLCHARACTERISTICS_DYNAMIC_BASE is probably not going to relocate the .exe in memory since we strip the relocations to reduce the size.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">kalverson</span><br><span class="post-time small text-muted">19th December 2012 15:55 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">This is just to let eveyone know it is possible to get MS certified using Nullsoft. We have ours now for "Works with Windows Server 2008 R2" and also "Certified on Windows Server 2012" as well. Here is a link to our catalog entry:<br><a href="http://www.windowsservercatalog.com/item.aspx?idItem=1ea459ee-5a8c-e2b1-1eee-b4b7ce1c355b&amp;bCatID=1282" target="_blank">http://www.windowsservercatalog.com/...5b&amp;bCatID=1282</a></p></div><hr><div class="footer"><p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p></div></div><script type="text/javascript" src="../js/highlight.pack.js" async></script><script type="text/javascript">//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]></script></body></html>