<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="You can only install if you have admin rights" />

  <title>You can only install if you have admin rights - NSIS Forums</title><!-- Bootstrap core CSS -->
  <link rel="stylesheet" type="text/css" href="//netdna.bootstrapcdn.com/bootswatch/3.0.2/readable/bootstrap.min.css" /><!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!--[if lt IE 9]>
                <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
                <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->
</head>

<body>
  <div class="container">
    <!-- Put navigation bar here -->

    <ol class="breadcrumb">
      <li><a href="../index.html" class="glyphicon glyphicon-home"></a></li>

      <li><a href="f-65.html">NSIS Discussion</a></li>

      <li class="active">You can only install if you have admin rights</li>
    </ol>

    <p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=295373">You can only install if you have admin rights</a></p><br />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">pgg1</span><br />
      <span class="post-time small text-muted">1st August 2008 12:08 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>You can only install if you have admin rights</strong><br />
      &nbsp; --------------<br />
      Windows Vista<br />
      --------------<br />
      <br />
      Hi<br />
      <br />
      What is the best approach to inform the user that they can only install our product providing they have admin rights.<br />
      <br />
      Is there a way to raise the administrator dialog in Vista.<br />
      <br />
      Regards<br />
      <br />
      Paul</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Anders</span><br />
      <span class="post-time small text-muted">1st August 2008 12:13 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>Re: You can only install if you have admin rights</strong><br />
      &nbsp;</p>

      <blockquote>
        <i>Originally posted by pgg1</i><br />
        <b>What is the best approach to inform the user that they can only install our product providing they have admin rights.<br /></b>
      </blockquote>UserInfo plugin (part of nsis) and MessageBox or Custom Page<br />
      <br />

      <blockquote>
        <i>Originally posted by pgg1</i><br />
        <b><br />
        Is there a way to raise the administrator dialog in Vista.<br /></b>
      </blockquote>for vista, use RequestExecutionLevel admin (this only works when UAC is on) If you need to support 2k/XP or Vista with UAC off, check if the user is admin with UserInfo and display a dialog and quit if they are not, or use the UAC plugin
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Yathosho</span><br />
      <span class="post-time small text-muted">1st August 2008 12:14 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">RequestUserLevel admin</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">pgg1</span><br />
      <span class="post-time small text-muted">1st August 2008 13:49 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Thanks guys.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">pgg1</span><br />
      <span class="post-time small text-muted">4th August 2008 11:25 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Hi<br />
      <br />
      I have a problem that occurs that I cannot reproduce.<br />
      <br />
      Current setup is:<br />
      Windows Vista<br />
      Amin rights<br />
      UAC is on<br />
      <br />
      When the installer is double clicked the installer dialog appears. Everything is fine until the installer starts copying files over to Program files. The installer errors on the very first file transfer and displays a message that is not helpful to the user and I can't remember what is said anyway :-/<br />
      <br />
      The reason is that the user does not have admin rights when in fact they do, this is due to UAC I think. So they simply run the installer with admin rights (right-clicking the installer and run as admin).<br />
      <br />
      My question is:<br />
      <br />
      Why does Windows allow the installer to get that far and then the moment we start to copy files over the installer errors.<br />
      <br />
      What can I do to get around this problem?<br />
      <br />
      Cheers<br />
      <br />
      Paul</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Anders</span><br />
      <span class="post-time small text-muted">4th August 2008 12:28 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">if you have "RequestExecutionLevel admin" in your script, the elevation dialog should pop up right away, if it does not, you should file a bug report</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">vc6</span><br />
      <span class="post-time small text-muted">4th August 2008 15:29 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">In Function .onInit, insert:<br /></p>
      <pre>
;Does user have Admin privileges?
<br />&gt;Push $R0
<br />Call IsUserAdmin
<br />Pop $R0
<br />&gt;${If} $R0 == "false"
<br />&gt;MessageBox MB_OK|MB_ICONEXCLAMATION "This installer must be run with Administrative Privileges"
<br />&gt;Abort
<br />&gt;${EndIf} 
</pre>HTH,<br />
      Victor
    </div>
    <hr />

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]>
  </script>
</body>
</html>
