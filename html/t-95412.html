<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="IsAdmin DLL" />

  <title>IsAdmin DLL - NSIS Forums</title><!-- Bootstrap core CSS -->
  <link rel="stylesheet" type="text/css" href="//netdna.bootstrapcdn.com/bootswatch/3.0.1/readable/bootstrap.min.css" />
  <link rel="stylesheet" href="../css/style.css" type="text/css" /><!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!--[if lt IE 9]>
                <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
                <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->
</head>

<body>
  <div class="container">
    <!-- Put navigation bar here -->

    <ol class="breadcrumb">
      <li><a href="../index.html" class="glyphicon glyphicon-home"></a></li>

      <li><a href="f-65.html">NSIS Discussion</a></li>

      <li class="active">IsAdmin DLL</li>
    </ol>

    <p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=95412">IsAdmin DLL</a></p><br />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">ralfoide</span><br />
      <span class="post-time small text-muted">23rd July 2002 00:44 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>IsAdmin DLL</strong><br />
      Hi!<br />
      <br />
      IsAdmin is a DLL for NSIS that determines if the current (impersonated) user has administrator priviledges. Returns 1 to NSIS if it does, 0 or a GetLastErorr number to the caller if not.<br />
      <br />
      Reference: Microsoft Knowledge Base Article - Q118626<br />
      <br />
      Hope this be helpful.<br />
      Source code and DSW project in the archive. If you need a compiled DLL, please ask. Free of use, blah blah. That's the kind of DLL I'd like to see in the Contribs of NISI :)<br />
      <br />
      Tested with 1.95... oops need to update now :-)<br />
      <br />
      R/</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Sunjammer</span><br />
      <span class="post-time small text-muted">23rd July 2002 08:56 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">I'll admit that my IsAdministrator function is buried inside the services control dll I wrote a while back but I just thought I'd post to say that this functionality does exist (yours is still needed though) so don't fret about stuff not being covered, you can usually find a solution somewhere :D<br />
      <br />
      (FYI <a href="http://www.clantpa.co.uk/nsis/x18servicesV0.0.zip" target="_blank">http://www.clantpa.co.uk/nsis/x18servicesV0.0.zip</a> was what I was referring to and is mentioned in this forum if you search back)<br />
      <br />
      [edit]I've hosted your file on my archive and added an entry on the <a href="http://www.clantpa.co.uk/nsis/wiki/index.php/Downloads" target="_blank">downloads page</a>, I'll add a proper page for it soon (it's on the <a href="http://www.clantpa.co.uk/nsis/wiki/index.php/PendingArchiveItems" target="_blank">pending list</a>)[/edit]</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">ralfoide</span><br />
      <span class="post-time small text-muted">23rd July 2002 09:28 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Interesting. I had a look at the winamp.com and your archives and I completly missed that x18services DLL :confused: -- I'm rather new to NSIS and there's a lot of material around. :)<br />
      <br />
      Anyway, I may need that functionnality later, so it's good to know where to find it. :D<br />
      <br />
      Thanks for the hosting.<br />
      <br />
      R/</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Sunjammer</span><br />
      <span class="post-time small text-muted">23rd July 2002 10:39 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Yeah sorry about that - the comments on the services DLL mostly focused on the services side, the IsAdministrator function was in there because to manipulate services you generally need to be an administrator so it seemed relevant.<br />
      <br />
      You won't find anything on my archive site if you search for administrator because I haven't had time to document my own DLLs that are hosted there, I've prioritised other people's stuff over my own so my services dll literally only gets a link on the download page at the moment.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Joost Verburg</span><br />
      <span class="post-time small text-muted">23rd July 2002 15:42 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Would it also be possible to check other privileges of the user?<br />
      <br />
      * Administrator<br />
      * Power User<br />
      * Restricted User</p>
    </div>
    <hr />

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]>
  </script>
</body>
</html>
