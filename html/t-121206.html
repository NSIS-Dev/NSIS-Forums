<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="Back to previous page during installation" />

  <title>Back to previous page during installation - NSIS Forums</title><!-- Bootstrap core CSS -->
  <link rel="stylesheet" type="text/css" href="//netdna.bootstrapcdn.com/bootswatch/3.0.1/readable/bootstrap.min.css" />
  <link rel="stylesheet" href="../css/style.css" type="text/css" /><!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!--[if lt IE 9]>
                <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
                <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->
</head>

<body>
  <div class="container">
    <!-- Put navigation bar here -->

    <ol class="breadcrumb">
      <li><a href="../index.html" class="glyphicon glyphicon-home"></a></li>

      <li><a href="f-65.html">NSIS Discussion</a></li>

      <li class="active">Back to previous page during installation</li>
    </ol>

    <p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=121206">Back to previous page during installation</a></p><br />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">treaz</span><br />
      <span class="post-time small text-muted">12th January 2003 22:22 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>Back to previous page during installation</strong><br />
      Hi,<br />
      I am not sure if this question has been posted before.<br />
      If it is linked to some other past questions, pls do lead me to them.<br />
      <br />
      Scenerio:<br />
      The user makes and input on one page and clicks NEXT.<br />
      The installer would then validate the user's input.<br />
      If the input is valid, then installer would proceed to the install page.<br />
      Otherwise, the installer would go back to the page where the user has to re-enter his input.<br />
      <br />
      I would greatly appreciate it if someone could help on this.<br />
      An example would be great.<br />
      <br />
      Thanks.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
      <span class="post-time small text-muted">12th January 2003 22:35 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Use the ValidateText field of IO. Read the IO readme for more information about it (ValidateText, MaxLen and MinLen).</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">treaz</span><br />
      <span class="post-time small text-muted">12th January 2003 23:01 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Please pardon my ignorance, I was reading through the example given in IO. But I do not understand much about it at all. Could someone pls explain with comments of what each statement with <font color="red">;??</font> does?<br />
      <br />
      I would also like to know how do I make use of the InstallOptions for my installer which already has some useful functions incoporated? (What statements do I need to include in my own script to use InstallOptions?)<br />
      <br />
      Thanks in advance.<br />
      <br />
      <b>Example in IO:</b><br />
      InstallOptions::initDialog /NOUNLOAD file.ini Pop $0<font color="red">;is file.ini my own ini file??</font><br />
      IntCmp $0 0 error<br />
      ; $0 is now the IO dialog HWND<br />
      ; use getdlgitem with it and sendmessage<br />
      GetDlgItem $1 $0 1200 ; 1200 + field number - 1 <font color="red">;what is field number and what does this statement do??</font><br />
      <br />
      ; $1 is now the HWND of the first field<br />
      CreateFont $2 "Tahoma" 10 700<br />
      SendMessage $1 ${WM_SETFONT} $2 0 <font color="red">;??</font><br />
      <br />
      InstallOptions::show<br />
      Pop $0<br />
      StrCmp $0 "success" done<br />
      StrCmp $0 "back" done<br />
      StrCmp $0 "cancel" done<br />
      error:<br />
      MessageBox MB_OK|MB_ICONSTOP "IO error: $0"<br />
      Quit<br />
      done:</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
      <span class="post-time small text-muted">12th January 2003 23:14 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">; just start a comment. A comment, is a comment, doesn't do anything.<br />
      <br />
      Take a look at the simpler example first, test.nsi and test.ini. ValidateText, MaxLen and MinLen should be in the INI.<br />
      <br />
      If you are using the Modern UI have a look at the MUI example InstallOtpions.nsi in Examples\Modern UI.<br />
      <br />
      I am sure this is not enough, but alas, my time is up. I will come back for more information tomorrow.<br />
      <br />
      Good night.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">treaz</span><br />
      <span class="post-time small text-muted">13th January 2003 15:50 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Hi,<br />
      I guess my question was not structured that well therefore there is a mis-interpretation.<br />
      <br />
      I was using those comments in red to ask my questions.<br />
      <br />
      Maybe I should use a totall different approach:<br />
      Could someone tell me what does the below statements do?<br />
      <br />
      1) GetDlgItem $1 $0 1200<br />
      2) SendMessage $1 ${WM_SETFONT} $2 0<br />
      <br />
      May I also know how does this work such that it allows the user to go back to the previous page to re-enter his inputs?<br />
      <br />
      Please note that my validation is not simple text validating. Therefore, using ValidateText does not work.<br />
      <br />
      I hope I am clear this time. Apologise for the bad language.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
      <span class="post-time small text-muted">13th January 2003 17:24 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">GetDlgItem gets the handle of a control in a dialog. In this case it gets the handle of the first field of the dialog created by IO (Field 1). You can use the HWND (window handle) to send the control messages such as WM_SETFONT, hide or show it, and set its background color using SetStaticBkColor (only if it's a label).<br />
      <br />
      The WM_SETFONT message sets the font of the control associated with the HWND inside $1.<br />
      <br />
      You don't need all of this for what you are trying to do. In fact, you don't even need initDialog and showDialog, only dialog.<br />
      <br />
      After you call InstallOptions::dialog and it returns "success" (pushes it on the stack and you get it using Pop) you should read the INI file, verify that everything is right and if not call InstallOptions::dialog again and possibly add an error label or pop up a message box stating what's wrong with the input.<br />
      <br />
      I have recently written an example for NsisMan of an IO page that gets the user name and info and then verifies it. The example is in this thread: <a href="http://forums.winamp.com/showthread.php?s=&amp;threadid=118942&amp;highlight=password" target="_blank">http://forums.winamp.com/showthread....light=password</a></p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">treaz</span><br />
      <span class="post-time small text-muted">13th January 2003 20:17 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Thanks!<br />
      Got the problem solved with your example.<br />
      :)</p>
    </div>
    <hr />

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]>
  </script>
</body>
</html>
