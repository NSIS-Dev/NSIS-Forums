<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="description" content="One-click installer: Remove &quot;Installation Complete&quot; close prompt?"><title>One-click installer: Remove "Installation Complete" close prompt? - NSIS Forums</title><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script><link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css"><link rel="stylesheet" href="../css/style.css" type="text/css"></head><body><div class="container"><ol class="breadcrumb"><li><a href="../index.html" class="glyphicon glyphicon-home"></a></li><li><a href="f-65.html">NSIS Discussion</a></li><li class="active">One-click installer: Remove "Installation Complete" close prompt?</li></ol><p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=300479">One-click installer: Remove "Installation Complete" close prompt?</a></p><br><div class="post"><p class="post-meta"><span class="post-author text-primary">pbenson</span><br><span class="post-time small text-muted">30th November 2008 20:25 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>One-click installer: Remove "Installation Complete" close prompt?</strong><br>Hi! I am not a developer, but I am a Systems Engineer who often has to come up with improvised solutions for others in the field.<br><br>Some of my users have a need for a one-click installation. WinZip's self-extractor has some issues with the package. I discovered NSIS and HM NSIS and was very impressed. So far I've been able to do a lot with NSIS in a very short period of time (a couple of days) despite being a first time user. Yet there is one hurdle I haven't been able to get past and that I have not found an answer to elsewhere (wiki, forum posts, manuals, etc.).<br><br>I can't eliminate the "Installation Complete" screen with a single "Close" button that appears after the package has unloaded all of the files and launched an installation script.<br><br>Here is the script that I am compiling (edited so as not to contain sensitive info):<br><br>; Script generated by the HM NIS Edit Script Wizard.<br><br>; HM NIS Edit Wizard helper defines<br>!define PRODUCT_NAME "Program"<br>!define PRODUCT_VERSION "11.30.2008"<br>!define PRODUCT_PUBLISHER "Company"<br>!define PRODUCT_WEB_SITE "http://www.website.com"<br>!define PRODUCT_DIR_REGKEY "Software\Microsoft\Windows\CurrentVersion\App Paths\setup.exe"<br><br>; MUI 1.67 compatible ------<br>!include "MUI.nsh"<br><br>; MUI Settings<br>!define MUI_ABORTWARNING<br>!define MUI_ICON "${NSISDIR}\Contrib\Graphics\Icons\modern-install.ico"<br><br>; Welcome page<br>; !insertmacro MUI_PAGE_WELCOME<br>; Instfiles page<br>!insertmacro MUI_PAGE_INSTFILES<br>; Finish page<br>; !define MUI_FINISHPAGE_RUN "$INSTDIR\Install.exe"<br>; !insertmacro MUI_PAGE_FINISH<br><br>; Language files<br>!insertmacro MUI_LANGUAGE "English"<br><br>; MUI end ------<br><br>Name "${PRODUCT_NAME} ${PRODUCT_VERSION}"<br>OutFile "output.exe"<br>InstallDir "$TEMP\program"<br>ShowInstDetails nevershow<br><br>Section "MainSection" SEC01<br>SetOutPath "$INSTDIR"<br>SetOverwrite try<br>File "C:\Install.exe"<br>Exec "$INSTDIR\Install.exe"<br>SectionEnd<br><br>As you can see the script is pretty simple. Install.exe is a compiled Auto IT script that does the work. I'm using NSIS to package the files with, and to unpackage the files into the temp directory and then to launch the Install.exe program with.<br><br>I think that my problem is with the MUI_PAGE_INSTFILES macro in the system.nsh file for the Modern UI.<br><br>!macro MUI_PAGE_INSTFILES<br><br>!verbose push<br>!verbose ${MUI_VERBOSE}<br><br>!insertmacro MUI_PAGE_INIT<br><br>!insertmacro MUI_SET MUI_${MUI_PAGE_UNINSTALLER_PREFIX}INSTFILESPAGE<br><br>PageEx ${MUI_PAGE_UNINSTALLER_FUNCPREFIX}instfiles<br><br>PageCallbacks ${MUI_PAGE_UNINSTALLER_FUNCPREFIX}mui.InstFilesPre_${MUI_UNIQUEID} ${MUI_PAGE_UNINSTALLER_FUNCPREFIX}mui.InstFilesShow_${MUI_UNIQUEID} ${MUI_PAGE_UNINSTALLER_FUNCPREFIX}mui.InstFilesLeave_${MUI_UNIQUEID}<br><br>Caption " "<br><br>PageExEnd<br><br>!insertmacro MUI_FUNCTION_INSTFILESPAGE ${MUI_PAGE_UNINSTALLER_FUNCPREFIX}mui.InstFilesPre_${MUI_UNIQUEID} ${MUI_PAGE_UNINSTALLER_FUNCPREFIX}mui.InstFilesShow_${MUI_UNIQUEID} ${MUI_PAGE_UNINSTALLER_FUNCPREFIX}mui.InstFilesLeave_${MUI_UNIQUEID}<br><br>!insertmacro MUI_UNSET MUI_INSTFILESPAGE_FINISHHEADER_TEXT<br>!insertmacro MUI_UNSET MUI_INSTFILESPAGE_FINISHHEADER_SUBTEXT<br>!insertmacro MUI_UNSET MUI_INSTFILESPAGE_ABORTWARNING_TEXT<br>!insertmacro MUI_UNSET MUI_INSTFILESPAGE_ABORTWARNING_SUBTEXT<br><br>!verbose pop<br><br>!macroend<br><br>I could be completely wrong here though and would really appreciate some help. Is there a way to remove this prompt for the installation complete?<br><br>Thanks in advance!</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">kichik</span><br><span class="post-time small text-muted">30th November 2008 22:22 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Use <i>SetAutoClose true</i> in your section.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">demiller9</span><br><span class="post-time small text-muted">30th November 2008 22:29 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><a href="http://nsis.sourceforge.net/Docs/Chapter4.html#4.8.1.3" target="_blank">4.8.1.3 AutoCloseWindow</a><br>true|<u>false</u><br>Sets whether or not the install window automatically closes when completed. This is overrideable from a section using SetAutoClose.<br><br><br>Try adding "AutoCloseWindow true" to your script, perhaps after the "!define PRODUCT..." lines.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br><span class="post-time small text-muted">1st December 2008 00:53 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">If you are just launching another installer, you might as well just do away with MUI and make a silent installer:<br></p><pre>
<code>SetCompressor /solid lzma<br>OutFile silent.exe<br>SilentInstall silent<br><br>Section<br>InitPluginsDir<br>SetOutPath $PLUGINSDIR<br>SetOverwrite try<br>File C:\Install.exe<br>Exec `"$PLUGINSDIR\Install.exe"`<br>SectionEnd</code>
</pre><br>
      <br>
      Stu
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">pbenson</span><br>
      <span class="post-time small text-muted">1st December 2008 04:14 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Thanks! The "SetAutoClose true" instruction did the trick. I'll be looking into the silent install as an improvement for the next version of this little project.<br>
      <br>
      Again, thanks a lot! I'm sure that I'll be using NSIS a lot more often in the future.</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br>
      <span class="post-time small text-muted">2nd December 2008 15:53 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Note that the above code I posted is a complete script.<br>
      <br>
      Stu</p>
    </div>
    <hr>

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]></script></body></html>