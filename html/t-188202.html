<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="Language select" />

  <title>Language select - NSIS Forums</title><!-- Bootstrap core CSS -->
  <link rel="stylesheet" type="text/css" href="//netdna.bootstrapcdn.com/bootswatch/3.0.1/readable/bootstrap.min.css" />
  <link rel="stylesheet" href="../css/style.css" type="text/css" /><!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!--[if lt IE 9]>
                <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
                <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->
</head>

<body>
  <div class="container">
    <!-- Put navigation bar here -->

    <ol class="breadcrumb">
      <li><a href="../index.html" class="glyphicon glyphicon-home"></a></li>

      <li><a href="f-65.html">NSIS Discussion</a></li>

      <li class="active">Language select</li>
    </ol>

    <p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=188202">Language select</a></p><br />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Freezerman350</span><br />
      <span class="post-time small text-muted">29th July 2004 16:07 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>Language select</strong><br />
      Hello,<br />
      it is possible to choose by default the "lang" of my windows...<br />
      <br />
      for exemple if my windows is a english windows english is select..<br />
      <br />
      french --&gt; french...<br />
      <br />
      Thx !</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Joost Verburg</span><br />
      <span class="post-time small text-muted">29th July 2004 16:51 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">That is already the default behavior.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Freezerman350</span><br />
      <span class="post-time small text-muted">29th July 2004 16:53 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">....but i got 2 windows the first is in french athe second is in english<br />
      <br />
      and both are showing my program with french in default !!!!<br />
      .... this is my problem !</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Freezerman350</span><br />
      <span class="post-time small text-muted">29th July 2004 17:21 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">please help me !</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
      <span class="post-time small text-muted">29th July 2004 17:43 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Please attach your script(s).<br />
      <br />
      -Stu</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Freezerman350</span><br />
      <span class="post-time small text-muted">29th July 2004 19:30 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">this is my script during the<br />
      oninit<br />
      <br />
      <br />
      ;Demande du language au début<br />
      StrCmp $LANGUAGE ${LANG_ENGLISH} french english<br />
      french:<br />
      StrCpy $R0 "Select your Windows sytem language.$\rChoisissez la langue de votre systeme Windows."<br />
      StrCpy $R1 "Install language / Langue d'installation"<br />
      Goto end<br />
      english:<br />
      StrCpy $R0 "Select your Windows sytem language.$\rChoisissez la langue de votre systeme Windows."<br />
      StrCpy $R1 "Install language / Langue d'installation"<br />
      end:<br />
      !Define MUI_LANGDLL_WINDOWTITLE $R1<br />
      !Define MUI_LANGDLL_INFO $R0<br />
      <br />
      <br />
      <br />
      <br />
      presently i put both language in french and in english...because my if dont wanna work</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
      <span class="post-time small text-muted">30th July 2004 12:20 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Why on earth are you doing it like that?<br />
      That will not work.<br />
      <br />
      Try this:<br /></p>
      <pre>
<code><br />;Demande du language au début<br />StrCmp $LANGUAGE ${LANG_ENGLISH} french english<br />french:<br />StrCpy $R0 "Choisissez la langue de votre systeme Windows."<br />StrCpy $R1 "Langue d'installation"<br />Goto end<br />english:<br />StrCpy $R0 "Select your Windows sytem language."<br />StrCpy $R1 "Install language"<br />end:<br />!Define MUI_LANGDLL_WINDOWTITLE $R1<br />!Define MUI_LANGDLL_INFO $R0<br /></code>
</pre><br />
      <br />
      -Stu
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Freezerman350</span><br />
      <span class="post-time small text-muted">30th July 2004 14:24 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Hey stu, i'm not stupid....so i suppose<br />
      <br />
      <br />
      I try your method and the page is always in english.<br />
      if you change the if by<br />
      --&gt; StrCmp $LANGUAGE ${LANG_FRENCH} french english<br />
      the page will be always in french, no matter the language of the windows<br />
      <br />
      The only reason of WHY I do the stupid thing of putting together french and english on each is because the compagny need the installer for today and they wanna see the message in english and in french<br />
      <br />
      the best solution is depending of the system but, for a time question i put french and english together</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
      <span class="post-time small text-muted">30th July 2004 15:22 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Have you looked at languages.nsi in Examples (or the Modern UI equiv.)<br />
      <br />
      I've never written a multi-linqual installer, but I'll have a go at making a working example.<br />
      <br />
      -Stu</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
      <span class="post-time small text-muted">30th July 2004 15:30 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"></p>
      <pre>
<code>  !include "MUI.nsh"<br />  Name "Modern UI Test 1.70"<br />  OutFile "MultiLanguage.exe"<br /><br />  !insertmacro MUI_PAGE_INSTFILES<br /><br />  !insertmacro MUI_LANGUAGE "English"<br />  !insertmacro MUI_LANGUAGE "French"<br /><br />Section<br />DetailPrint $LANGUAGE<br />DetailPrint ${LANG_ENGLISH}<br />SectionEnd</code>
</pre><br />
      Tried this, and it shows that the $LANGUAGE is ${LANG_ENGLISH}<br />
      <br />
      I don't see why it isn't working for you.<br />
      <br />
      -Stu
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Yathosho</span><br />
      <span class="post-time small text-muted">30th July 2004 15:41 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">have you had a look at this <a href="http://nsis.sourceforge.net/archive/viewpage.php?pageid=278" target="_blank">function</a> from the <a href="http://nsis.sourceforge.net/archive/nsisweb.php" target="_blank">archive</a>?<br />
      <br />
      other than that, you might make the user select the language using <a href="http://nsis.sourceforge.net/Docs/Chapter4.html#4.10.2" target="_blank">LangDLL</a>. as afrow pointed out, you can find it used in the <a href="http://nsis.sourceforge.net/Examples/languages.nsi" target="_blank">languages.nsi</a> example.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Freezerman350</span><br />
      <span class="post-time small text-muted">30th July 2004 15:54 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Lokk at this<br />
      <br />
      this is my problem !<br />
      <br />
      <br />
      <br />
      <a href="http://www.easydeal.qc.ca/test.jpg" target="_blank">http://www.easydeal.qc.ca/test.jpg</a></p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
      <span class="post-time small text-muted">30th July 2004 16:23 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Ahhh....<br />
      Ok. Try the Modern UI example in Examples\Modern UI\MultiLanguage.nsi<br />
      <br />
      That also uses the LangDLL<br />
      <br />
      -Stu</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Freezerman350</span><br />
      <span class="post-time small text-muted">30th July 2004 16:54 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Again !<br />
      <br />
      now in modern IU<br />
      <br />
      <br />
      <a href="http://www.easydeal.qc.ca/test2.jpg" target="_blank">http://www.easydeal.qc.ca/test2.jpg</a></p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
      <span class="post-time small text-muted">30th July 2004 17:05 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Hmm. Ok, open up MultiLanguage.nsi, and replace .onInit function with:<br />
      <br /></p>
      <pre>
<code>Function .onInit<br /><br />  MessageBox MB_OK $LANGUAGE<br />  !insertmacro MUI_LANGDLL_DISPLAY<br /><br />FunctionEnd</code>
</pre><br />
      <br />
      If the message box displays '1033' (English) then there's difinately a problem.<br />
      <br />
      -Stu
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Freezerman350</span><br />
      <span class="post-time small text-muted">30th July 2004 17:08 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">1036</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
      <span class="post-time small text-muted">30th July 2004 17:32 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Ok, in that case it's working fine (1036 == French)<br />
      <br />
      Could you attach your whole script file.<br />
      <br />
      -Stu</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
      <span class="post-time small text-muted">30th July 2004 17:35 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">No. Don't attach your script.<br />
      <br />
      That's how LangDLL works. It displays some text asking for the user to select the language and a combo box with available languages. The text doesn't change according to the currently selected language.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Freezerman350</span><br />
      <span class="post-time small text-muted">30th July 2004 17:39 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Ok but dont pay attention on the oninit ...<br />
      <br />
      PHP Code:</p>
      <hr />
      <code style="white-space:nowrap"><!-- php buffer start --></code><span style="color: #000000"><span style="color: #007700">;</span><span style="color: #0000BB">NSISModernUser</span><span style="color: #007700">Interface</span><span style="color: #0000BB">version1.70<br /></span> <span style="color: #007700">;</span><span style="color: #0000BB">ADNT</span><span style="color: #007700">-</span><span style="color: #0000BB">EASYDEAL<br /></span> <span style="color: #007700">;</span><span style="color: #0000BB">WrittenbyOlivierDuval</span><span style="color: #007700">-</span><span style="color: #0000BB">Montminy<br />
      <br /></span> <span style="color: #007700">;---------------------------------------------------------------------------------------<br />
      ;Include</span><span style="color: #0000BB">ModernUI<br />
      <br /></span> <span style="color: #007700">!include</span><span style="color: #DD0000">"MUI.nsh"<br />
      <br /></span> <span style="color: #007700">;---------------------------------------------------------------------------------------<br />
      ;</span><span style="color: #0000BB">General<br />
      <br /></span> <span style="color: #007700">;</span><span style="color: #0000BB">Name</span><span style="color: #007700">and</span><span style="color: #0000BB">file<br />
      Name</span><span style="color: #DD0000">"EasyDeal"<br /></span> <span style="color: #007700">;</span><span style="color: #0000BB">Icone<br /></span> <span style="color: #007700">!</span><span style="color: #0000BB">defineMUI_ICON</span><span style="color: #DD0000">".\graphics\Icone.ico"<br /></span> <span style="color: #007700">!</span><span style="color: #0000BB">defineMUI_UNICON</span><span style="color: #DD0000">".\graphics\Icone.ico"<br />
      <br />
      <br /></span> <span style="color: #0000BB">OutFile</span><span style="color: #DD0000">"EasyDeal_Installer.exe"<br /></span> <span style="color: #007700">;</span><span style="color: #0000BB">Titrebasdanslespages<br />
      BrandingText</span><span style="color: #007700">/</span><span style="color: #0000BB">TRIMRIGHT</span><span style="color: #DD0000">"PoweredbyA.D.N.T.Inc"<br />
      <br />
      <br /></span> <span style="color: #007700">;Default</span><span style="color: #0000BB">installationfolder<br />
      InstallDir</span><span style="color: #DD0000">"C:\EASYDEAL"<br />
      <br /></span> <span style="color: #007700">;</span><span style="color: #0000BB">Getinstallationfolderfromregistry</span><span style="color: #007700">if</span><span style="color: #0000BB">available<br />
      InstallDirRegKeyHKCU</span><span style="color: #DD0000">"Software\EASYDEAL"""<br />
      <br /></span> <span style="color: #007700">;---------------------------------------------------------------------------------------<br />
      ;Interface</span><span style="color: #0000BB">Configuration<br /></span> <span style="color: #007700">;</span><span style="color: #0000BB">Déclarationdesimagedeheaderetwizard<br /></span> <span style="color: #007700">!</span><span style="color: #0000BB">defineMUI_HEADERIMAGE<br /></span> <span style="color: #007700">!</span><span style="color: #0000BB">defineMUI_HEADERIMAGE_BITMAP</span><span style="color: #DD0000">".\Graphics\header.bmp"<br /></span> <span style="color: #007700">!</span><span style="color: #0000BB">defineMUI_WELCOMEFINISHPAGE_BITMAP</span><span style="color: #DD0000">".\Graphics\arrow.bmp"<br />
      <br /></span> <span style="color: #007700">;---------------------------------------------------------------------------------------<br />
      ;Interface</span><span style="color: #0000BB">Settings<br />
      <br /></span> <span style="color: #007700">;!</span><span style="color: #0000BB">defineMUI_ABORTWARNING<br />
      <br /></span> <span style="color: #007700">;---------------------------------------------------------------------------------------<br />
      ;</span><span style="color: #0000BB">LanguageSelectionDialogSettings<br />
      <br /></span> <span style="color: #007700">;</span><span style="color: #0000BB">Remembertheinstallerlanguage<br /></span> <span style="color: #007700">;!</span><span style="color: #0000BB">defineMUI_LANGDLL_REGISTRY_ROOT</span><span style="color: #DD0000">"HKCU"<br /></span> <span style="color: #007700">;!</span><span style="color: #0000BB">defineMUI_LANGDLL_REGISTRY_KEY</span><span style="color: #DD0000">"Software\EASYDEAL"<br /></span> <span style="color: #007700">;!</span><span style="color: #0000BB">defineMUI_LANGDLL_REGISTRY_VALUENAME</span><span style="color: #DD0000">"InstallerLanguage"<br />
      <br />
      <br />
      <br /></span> <span style="color: #007700">;---------------------------------------------------------------------------------------<br />
      ;</span><span style="color: #0000BB">Pages<br />
      <br /></span> <span style="color: #007700">!</span><span style="color: #0000BB">insertmacroMUI_PAGE_WELCOME<br />
      <br />
      <br />
      <br /></span> <span style="color: #007700">!</span><span style="color: #0000BB">insertmacroMUI_PAGE_LICENSE</span><span style="color: #007700">$(</span><span style="color: #0000BB">License1</span><span style="color: #007700">)<br />
      <br /></span> <span style="color: #0000BB">PagecustomCustomPage1<br />
      <br /></span> <span style="color: #007700">!</span><span style="color: #0000BB">insertmacroMUI_PAGE_COMPONENTS<br />
      <br />
      PagecustomCustomPage2<br />
      <br /></span> <span style="color: #007700">!</span><span style="color: #0000BB">insertmacroMUI_PAGE_INSTFILES<br /></span> <span style="color: #007700">!</span><span style="color: #0000BB">insertmacroMUI_PAGE_FINISH<br />
      <br /></span> <span style="color: #007700">!</span><span style="color: #0000BB">insertmacroMUI_UNPAGE_WELCOME<br /></span> <span style="color: #007700">!</span><span style="color: #0000BB">insertmacroMUI_UNPAGE_CONFIRM<br /></span> <span style="color: #007700">!</span><span style="color: #0000BB">insertmacroMUI_UNPAGE_INSTFILES<br /></span> <span style="color: #007700">!</span><span style="color: #0000BB">insertmacroMUI_UNPAGE_FINISH<br /></span> <span style="color: #007700">;---------------------------------------------------------------------------------------<br />
      ;</span><span style="color: #0000BB">Languages<br /></span> <span style="color: #007700">!</span><span style="color: #0000BB">insertmacroMUI_LANGUAGE</span><span style="color: #DD0000">"English"<br /></span> <span style="color: #007700">!</span><span style="color: #0000BB">insertmacroMUI_LANGUAGE</span><span style="color: #DD0000">"French"<br /></span> <span style="color: #007700">!</span><span style="color: #0000BB">insertmacroMUI_RESERVEFILE_LANGDLL<br />
      LicenseLangStringLicense1</span><span style="color: #007700">${</span><span style="color: #0000BB">LANG_ENGLISH</span><span style="color: #007700">}</span><span style="color: #DD0000">".\licenseA.txt"<br /></span> <span style="color: #0000BB">LicenseLangStringLicense1</span><span style="color: #007700">${</span><span style="color: #0000BB">LANG_FRENCH</span><span style="color: #007700">}</span><span style="color: #DD0000">".\licenseF.txt"<br />
      <br /></span> <span style="color: #007700">;---------------------------------------------------------------------------------------<br />
      ;</span><span style="color: #0000BB">ReserveFiles<br />
      <br /></span> <span style="color: #007700">;</span><span style="color: #0000BB">Thesefilesshouldbeinsertedbeforeotherfilesinthedatablock<br /></span> <span style="color: #007700">;</span><span style="color: #0000BB">KeeptheselinesbeforeanyFilecommand<br /></span> <span style="color: #007700">;</span><span style="color: #0000BB">Only</span><span style="color: #007700">for</span><span style="color: #0000BB">solidcompression</span><span style="color: #007700">(</span><span style="color: #0000BB">by</span><span style="color: #007700">default,</span><span style="color: #0000BB">solidcompressionisenabled</span><span style="color: #007700">for</span><span style="color: #0000BB">BZIP2</span><span style="color: #007700">and</span><span style="color: #0000BB">LZMA</span><span style="color: #007700">)<br />
      <br /></span> <span style="color: #0000BB">ReserveFile</span><span style="color: #DD0000">"OPT.ini"<br /></span> <span style="color: #0000BB">ReserveFile</span><span style="color: #DD0000">"RT.ini"<br />
      <br />
      <br /></span> <span style="color: #007700">;---------------------------------------------------------------------------------------<br />
      ;</span><span style="color: #0000BB">Variables<br />
      <br /></span> <span style="color: #007700">Var</span><span style="color: #0000BB">INI_VALUE<br /></span> <span style="color: #007700">Var</span><span style="color: #0000BB">INI_VALUE1<br />
      <br /></span> <span style="color: #007700">;---------------------------------------------------------------------------------------<br />
      ;</span><span style="color: #0000BB">InstallerSections<br />
      <br />
      Section</span><span style="color: #DD0000">"EasyDeal"</span><span style="color: #0000BB">SecED<br />
      SectionInRO<br />
      <br /></span> <span style="color: #007700">;</span><span style="color: #FF8000">#=#=#=#=#=#=#=#=#=#=#=#==#=#=#=INSTALL#=#=#=#=#=#=#=#=#=#=#=#==#=#=#=<br />
      <br /></span> <span style="color: #007700">;</span><span style="color: #0000BB">ReadavaluefromanInstallOptionsINIfile<br /></span> <span style="color: #007700">!</span><span style="color: #0000BB">insertmacroMUI_INSTALLOPTIONS_READ$INI_VALUE</span><span style="color: #DD0000">"OPT.ini""Field2""State"<br /></span> <span style="color: #007700">!</span><span style="color: #0000BB">insertmacroMUI_INSTALLOPTIONS_READ$INI_VALUE1</span><span style="color: #DD0000">"OPT.ini""Field3""State"<br />
      <br /></span> <span style="color: #007700">;</span><span style="color: #0000BB">SERVERETCLIENT<br />
      SetOutPath</span><span style="color: #DD0000">"$INSTDIR"<br /></span> <span style="color: #007700">;</span><span style="color: #FF8000">##################################fichierinfo##############################<br /></span> <span style="color: #0000BB">GetTempFileName$R0<br />
      File</span><span style="color: #007700">/</span><span style="color: #0000BB">oname</span><span style="color: #007700">=</span><span style="color: #0000BB">$R0</span><span style="color: #DD0000">"info.exe"<br />
      <br />
      <br />
      <br />
      <br /></span> <span style="color: #0000BB">FileOpen</span><span style="color: #007700">$</span><span style="color: #0000BB">3</span><span style="color: #DD0000">"system_info.txt""w"<br /></span> <span style="color: #0000BB">ReadRegStr</span><span style="color: #007700">$</span><span style="color: #0000BB">1HKLM</span><span style="color: #DD0000">"System\CurrentControlSet\control\ComputerName\ComputerName""Computername"<br /></span> <span style="color: #0000BB">FileWrite</span><span style="color: #007700">$</span><span style="color: #0000BB">3</span><span style="color: #DD0000">'Computername:$1$\r$\n$\r$\n$\r$\n'<br /></span> <span style="color: #0000BB">FileWrite</span><span style="color: #007700">$</span><span style="color: #0000BB">3</span><span style="color: #DD0000">'-----------------------------------------------------------$\r$\n$\r$\n'<br /></span> <span style="color: #0000BB">nsExec</span><span style="color: #007700">::</span><span style="color: #0000BB">ExecToStack</span><span style="color: #DD0000">'"$R0"infoos'<br /></span> <span style="color: #0000BB">Pop</span><span style="color: #007700">$</span><span style="color: #0000BB">0</span><span style="color: #FF8000">#returnvalue/error/timeout<br /></span> <span style="color: #0000BB">Pop</span><span style="color: #007700">$</span><span style="color: #0000BB">1</span><span style="color: #FF8000">#printedtext,upto${NSIS_MAX_STRLEN}<br /></span> <span style="color: #0000BB">FileWrite</span><span style="color: #007700">$</span><span style="color: #0000BB">3</span><span style="color: #DD0000">'Someosdetails:$\r$\n$\r$\n'<br /></span> <span style="color: #0000BB">FileWrite</span><span style="color: #007700">$</span><span style="color: #0000BB">3</span><span style="color: #DD0000">'$1$\r$\n$\r$\n$\r$\n'<br /></span> <span style="color: #0000BB">FileWrite</span><span style="color: #007700">$</span><span style="color: #0000BB">3</span><span style="color: #DD0000">'-----------------------------------------------------------$\r$\n$\r$\n'<br />
      <br />
      <br />
      <br /></span> <span style="color: #0000BB">nsExec</span><span style="color: #007700">::</span><span style="color: #0000BB">ExecToStack</span><span style="color: #DD0000">'"$R0"infodisk'<br /></span> <span style="color: #0000BB">Pop</span><span style="color: #007700">$</span><span style="color: #0000BB">0</span><span style="color: #FF8000">#returnvalue/error/timeout<br /></span> <span style="color: #0000BB">Pop</span><span style="color: #007700">$</span><span style="color: #0000BB">1</span><span style="color: #FF8000">#printedtext,upto${NSIS_MAX_STRLEN}<br /></span> <span style="color: #0000BB">FileWrite</span><span style="color: #007700">$</span><span style="color: #0000BB">3</span><span style="color: #DD0000">'Somediskdetails:$\r$\n$\r$\n'<br /></span> <span style="color: #0000BB">FileWrite</span><span style="color: #007700">$</span><span style="color: #0000BB">3</span><span style="color: #DD0000">'$1$\r$\n$\r$\n$\r$\n'<br /></span> <span style="color: #0000BB">FileWrite</span><span style="color: #007700">$</span><span style="color: #0000BB">3</span><span style="color: #DD0000">'-----------------------------------------------------------$\r$\n$\r$\n'<br />
      <br /></span> <span style="color: #0000BB">nsExec</span><span style="color: #007700">::</span><span style="color: #0000BB">ExecToStack</span><span style="color: #DD0000">'"$R0"infocd'<br /></span> <span style="color: #0000BB">Pop</span><span style="color: #007700">$</span><span style="color: #0000BB">0</span><span style="color: #FF8000">#returnvalue/error/timeout<br /></span> <span style="color: #0000BB">Pop</span><span style="color: #007700">$</span><span style="color: #0000BB">1</span><span style="color: #FF8000">#printedtext,upto${NSIS_MAX_STRLEN}<br /></span> <span style="color: #0000BB">FileWrite</span><span style="color: #007700">$</span><span style="color: #0000BB">3</span><span style="color: #DD0000">'SomeCDdetails:$\r$\n$\r$\n'<br /></span> <span style="color: #0000BB">FileWrite</span><span style="color: #007700">$</span><span style="color: #0000BB">3</span><span style="color: #DD0000">'$1$\r$\n$\r$\n$\r$\n'<br />
      <br /></span> <span style="color: #0000BB">FileWrite</span><span style="color: #007700">$</span><span style="color: #0000BB">3</span><span style="color: #DD0000">'-----------------------------------------------------------$\r$\n$\r$\n'<br /></span> <span style="color: #0000BB">nsExec</span><span style="color: #007700">::</span><span style="color: #0000BB">ExecToStack</span><span style="color: #DD0000">'"$R0"infovideo'<br /></span> <span style="color: #0000BB">Pop</span><span style="color: #007700">$</span><span style="color: #0000BB">0</span><span style="color: #FF8000">#returnvalue/error/timeout<br /></span> <span style="color: #0000BB">Pop</span><span style="color: #007700">$</span><span style="color: #0000BB">1</span><span style="color: #FF8000">#printedtext,upto${NSIS_MAX_STRLEN}<br /></span> <span style="color: #0000BB">FileWrite</span><span style="color: #007700">$</span><span style="color: #0000BB">3</span><span style="color: #DD0000">'Somevideodetails:$\r$\n$\r$\n'<br /></span> <span style="color: #0000BB">FileWrite</span><span style="color: #007700">$</span><span style="color: #0000BB">3</span><span style="color: #DD0000">'$1$\r$\n$\r$\n$\r$\n'<br /></span> <span style="color: #0000BB">FileClose</span><span style="color: #007700">$</span><span style="color: #0000BB">3<br />
      <br />
      <br />
      <br />
      GetTempFileName$R1<br />
      <br />
      Delete$R1<br /></span> <span style="color: #007700">;</span><span style="color: #FF8000">##################################fichierinfo##############################<br />
      <br /></span> <span style="color: #0000BB">SetOutPath</span><span style="color: #DD0000">"$SYSDIR"<br />
      <br /></span> <span style="color: #0000BB">File</span><span style="color: #DD0000">"dll\*.*"<br />
      <br />
      <br /></span> <span style="color: #0000BB">SetOutPath</span><span style="color: #DD0000">"$DESKTOP"<br />
      <br /></span> <span style="color: #0000BB">File</span><span style="color: #DD0000">"bureau\*.*"<br />
      <br /></span> <span style="color: #0000BB">SetOutPath</span><span style="color: #DD0000">"$INSTDIR"<br />
      <br /></span> <span style="color: #0000BB">File</span><span style="color: #DD0000">"easydeal\*.*"<br />
      <br /></span> <span style="color: #007700">;</span><span style="color: #0000BB">CLIENT<br /></span> <span style="color: #007700">;</span><span style="color: #0000BB">Displayamessagebox</span><span style="color: #007700">if</span><span style="color: #0000BB">checkboxwaschecked<br />
      StrCmp$INI_VALUE1</span><span style="color: #DD0000">"1"</span><span style="color: #0000BB">ifClient<br />
      File</span><span style="color: #DD0000">"client.txt"<br /></span> <span style="color: #0000BB">ifClient</span><span style="color: #007700">:<br />
      <br />
      ;</span><span style="color: #0000BB">SERVER<br />
      StrCmp$INI_VALUE</span><span style="color: #DD0000">"1"</span><span style="color: #0000BB">ifServer<br />
      <br />
      SetOutPath</span><span style="color: #DD0000">"c:\dataeasydeal"<br /></span> <span style="color: #0000BB">File</span><span style="color: #DD0000">"dataeasydeal\*.*"<br />
      <br /></span> <span style="color: #0000BB">SetOutPath</span><span style="color: #DD0000">"$SMPROGRAMS\Startup"<br /></span> <span style="color: #0000BB">File</span><span style="color: #DD0000">"bureau\*.*"<br />
      <br /></span> <span style="color: #0000BB">SetOutPath</span><span style="color: #DD0000">"$SMPROGRAMS\Démarrage"<br /></span> <span style="color: #0000BB">File</span><span style="color: #DD0000">"bureau\*.*"<br />
      <br /></span> <span style="color: #0000BB">SetOutPath</span><span style="color: #DD0000">"c:\dataeasydeal\AnalyseF"<br /></span> <span style="color: #0000BB">File</span><span style="color: #DD0000">"analyseF\*.*"<br />
      <br /></span> <span style="color: #007700">;==================</span><span style="color: #0000BB">PARTAGEVÉRIFWIN</span><span style="color: #007700">==========================<br /></span> <span style="color: #0000BB">StrCpy</span><span style="color: #007700">$</span><span style="color: #0000BB">1</span><span style="color: #DD0000">"$windir"<br /></span> <span style="color: #0000BB">IfFileExists</span><span style="color: #DD0000">"$1\winver.exe"</span><span style="color: #007700">+</span><span style="color: #0000BB">2<br />
      StrCpy</span><span style="color: #007700">$</span><span style="color: #0000BB">1</span><span style="color: #DD0000">"$sysdir"<br /></span> <span style="color: #0000BB">GetDllVersion</span><span style="color: #DD0000">"$1\winver.exe"</span><span style="color: #0000BB">$R0$R1<br />
      IntOp$R2$R0</span><span style="color: #007700">/</span><span style="color: #0000BB">0x00010000<br />
      IntOp$R3$R0</span><span style="color: #007700">&amp;</span><span style="color: #0000BB">0x0000FFFF<br />
      IntOp$R4$R1</span><span style="color: #007700">/</span><span style="color: #0000BB">0x00010000<br />
      IntOp$R5$R1</span><span style="color: #007700">&amp;</span><span style="color: #0000BB">0x0000FFFF<br />
      StrCpy</span><span style="color: #007700">$</span><span style="color: #0000BB">0</span><span style="color: #DD0000">"$R2.$R3.$R4.$R5"<br />
      <br /></span> <span style="color: #0000BB">StrCmp</span><span style="color: #007700">$</span><span style="color: #0000BB">0</span><span style="color: #DD0000">'5.1.2600.0'</span><span style="color: #0000BB">WinXPNotWinXP<br />
      WinXP</span><span style="color: #007700">:<br /></span> <span style="color: #0000BB">messageboxmb_ok</span><span style="color: #DD0000">"DataEasyDeal--Partagé/Share"<br /></span> <span style="color: #0000BB">nsExec</span><span style="color: #007700">::</span><span style="color: #0000BB">Exec</span><span style="color: #DD0000">'netsharedataeasydeal=c:\dataeasydeal'<br /></span> <span style="color: #0000BB">NotWinXP</span><span style="color: #007700">:<br />
      <br /></span> <span style="color: #0000BB">StrCmp</span><span style="color: #007700">$</span><span style="color: #0000BB">0</span><span style="color: #DD0000">'4.0.1381.336'</span><span style="color: #0000BB">WinNTNotWinNT<br />
      WinNT</span><span style="color: #007700">:<br /></span> <span style="color: #0000BB">messageboxmb_ok</span><span style="color: #DD0000">"DataEasyDeal--nonPartagé/notShare"<br /></span> <span style="color: #0000BB">NotWinNT</span><span style="color: #007700">:<br />
      <br /></span> <span style="color: #0000BB">StrCmp</span><span style="color: #007700">$</span><span style="color: #0000BB">0</span><span style="color: #DD0000">'5.0.2195.6703'</span><span style="color: #0000BB">Win2000NotWin2000<br />
      Win2000</span><span style="color: #007700">:<br /></span> <span style="color: #0000BB">messageboxmb_ok</span><span style="color: #DD0000">"DataEasyDeal--Partagé/Share"<br /></span> <span style="color: #0000BB">nsExec</span><span style="color: #007700">::</span><span style="color: #0000BB">Exec</span><span style="color: #DD0000">'netsharedataeasydeal=c:\dataeasydeal'<br /></span> <span style="color: #0000BB">NotWin2000</span><span style="color: #007700">:<br />
      <br /></span> <span style="color: #0000BB">StrCmp</span><span style="color: #007700">$</span><span style="color: #0000BB">0</span><span style="color: #DD0000">'5.2.3790.0'</span><span style="color: #0000BB">Win2003NotWin2003<br />
      Win2003</span><span style="color: #007700">:<br /></span> <span style="color: #0000BB">messageboxmb_ok</span><span style="color: #DD0000">"DataEasyDeal--Partagé/Share"<br /></span> <span style="color: #0000BB">nsExec</span><span style="color: #007700">::</span><span style="color: #0000BB">Exec</span><span style="color: #DD0000">'netsharedataeasydeal=c:\dataeasydeal'<br /></span> <span style="color: #0000BB">NotWin2003</span><span style="color: #007700">:<br />
      <br /></span> <span style="color: #0000BB">StrCmp</span><span style="color: #007700">$</span><span style="color: #0000BB">0</span><span style="color: #DD0000">'4.10.0.2222'</span><span style="color: #0000BB">Win98NotWin98<br />
      Win98</span><span style="color: #007700">:<br /></span> <span style="color: #0000BB">messageboxmb_ok</span><span style="color: #DD0000">"DataEasyDeal--nonPartagé/notShare"<br /></span> <span style="color: #0000BB">NotWin98</span><span style="color: #007700">:<br />
      <br />
      ;</span><span style="color: #0000BB">2003</span><span style="color: #007700">=</span><span style="color: #0000BB">5.2.3790.0<br /></span> <span style="color: #007700">;</span><span style="color: #0000BB">XP</span><span style="color: #007700">=</span><span style="color: #0000BB">5.1.2600.0<br /></span> <span style="color: #007700">;</span><span style="color: #0000BB">2K</span><span style="color: #007700">=</span><span style="color: #0000BB">5.0.2195.6703<br /></span> <span style="color: #007700">;</span><span style="color: #0000BB">NT</span><span style="color: #007700">=</span><span style="color: #0000BB">4.0.1381.336<br /></span> <span style="color: #007700">;</span><span style="color: #0000BB">ME</span><span style="color: #007700">=</span><span style="color: #0000BB">4.90.0.3000<br /></span> <span style="color: #007700">;</span><span style="color: #0000BB">98SE</span><span style="color: #007700">=</span><span style="color: #0000BB">4.10.0.2222<br /></span> <span style="color: #007700">;</span><span style="color: #0000BB">98</span><span style="color: #007700">=</span><span style="color: #0000BB">4.10.0.1998<br /></span> <span style="color: #007700">;</span><span style="color: #0000BB">95S2</span><span style="color: #007700">=???<br />
      ;</span><span style="color: #0000BB">95</span><span style="color: #007700">=</span><span style="color: #0000BB">4.00.950<br /></span> <span style="color: #007700">;=============================================================<br />
      <br />
      <br /></span> <span style="color: #0000BB">ReadRegStr</span><span style="color: #007700">$</span><span style="color: #0000BB">1HKLM</span><span style="color: #DD0000">"System\CurrentControlSet\control\ComputerName\ComputerName""Computername"<br />
      <br /></span> <span style="color: #0000BB">StrCmp$LANGUAGE</span><span style="color: #007700">${</span><span style="color: #0000BB">LANG_ENGLISH</span><span style="color: #007700">}</span><span style="color: #0000BB">0notEnglish<br />
      MessageBoxMB_OK</span><span style="color: #DD0000">"Servername:$1"<br /></span> <span style="color: #0000BB">notEnglish</span><span style="color: #007700">:<br />
      <br /></span> <span style="color: #0000BB">StrCmp$LANGUAGE</span><span style="color: #007700">${</span><span style="color: #0000BB">LANG_FRENCH</span><span style="color: #007700">}</span><span style="color: #0000BB">0notFrench<br />
      MessageBoxMB_OK</span><span style="color: #DD0000">"Nomduserveur:$1"<br /></span> <span style="color: #0000BB">notFrench</span><span style="color: #007700">:<br /></span> <span style="color: #0000BB">ifServer</span><span style="color: #007700">:<br />
      <br />
      <br />
      ;</span><span style="color: #0000BB">CLIENTSERVER<br />
      <br /></span> <span style="color: #007700">;</span><span style="color: #0000BB">Supressiondelacléderebootàlafindel</span><span style="color: #DD0000">'installationnonéffacersuARTaredémarreravant<br />
      DeleteRegKey/ifemptyHKCU"Software\Microsoft\Windows\CurrentVersion\RunOnce"<br />
      <br />
      <br />
      <br />
      ;Storeinstallationfolderandexepath<br />
      WriteRegStrHKCU"Software\EASYDEAL""dirpath"$EXEDIR<br />
      WriteRegStrHKCU"Software\EASYDEAL""folder"$INSTDIR<br />
      <br />
      <br />
      ;Createuninstaller<br />
      WriteUninstaller"$INSTDIR\Uninstall.exe"<br />
      <br />
      SectionEnd<br />
      ;#=#=#=#=#=#=#=#=#=#=#=#==#=#=#=INSTALL#=#=#=#=#=#=#=#=#=#=#=#==#=#=#=<br />
      ;---------------------------------------------------------------------------------------<br />
      ;InstallerFunctions<br />
      <br />
      Function.onInit<br />
      MessageBoxMB_OK"ATTENTIONAVANTDEPROCÉDERÀL'</span><span style="color: #0000BB">INSTALLATION</span><span style="color: #007700">$</span><span style="color: #0000BB">n</span><span style="color: #007700">$</span><span style="color: #0000BB">r</span><span style="color: #007700">$</span><span style="color: #0000BB">n</span><span style="color: #007700">$</span><span style="color: #0000BB">rVousdevezconfirmersivotresystèmeWindowsestenversionfrançaiseouanglaise</span><span style="color: #007700">,</span><span style="color: #0000BB">pourcefaire</span><span style="color: #007700">,</span><span style="color: #0000BB">vousdevezregarderaubasàgauchedevotreécransileboutonaffiche</span><span style="color: #DD0000">'Démarrer'</span><span style="color: #007700">(</span><span style="color: #0000BB">Versionfrançaise</span><span style="color: #007700">)</span><span style="color: #0000BB">ou</span><span style="color: #DD0000">'Start'</span><span style="color: #007700">(</span><span style="color: #0000BB">Englishversion</span><span style="color: #007700">)$</span><span style="color: #0000BB">n</span><span style="color: #007700">$</span><span style="color: #0000BB">r</span><span style="color: #007700">$</span><span style="color: #0000BB">n</span><span style="color: #007700">$</span><span style="color: #0000BB">r</span><span style="color: #007700">$</span><span style="color: #0000BB">n</span><span style="color: #007700">$</span><span style="color: #0000BB">r</span><span style="color: #007700">$</span><span style="color: #0000BB">n</span><span style="color: #007700">$</span><span style="color: #0000BB">rATTENTIONBEFOREPROCEEDINGWITHINSTALLATION</span><span style="color: #007700">$</span><span style="color: #0000BB">n</span><span style="color: #007700">$</span><span style="color: #0000BB">r</span><span style="color: #007700">$</span><span style="color: #0000BB">n</span><span style="color: #007700">$</span><span style="color: #0000BB">rYoumustvalidateyourWindowslanguagesystem</span><span style="color: #007700">.</span><span style="color: #0000BB">Inorderto</span><span style="color: #007700">do</span><span style="color: #0000BB">so</span><span style="color: #007700">,</span><span style="color: #0000BB">verifyonthebottomleftofyourscreen</span><span style="color: #007700">if</span><span style="color: #0000BB">thebuttonsays</span><span style="color: #DD0000">'Start'</span><span style="color: #007700">(</span><span style="color: #0000BB">Englishversion</span><span style="color: #007700">)or</span><span style="color: #DD0000">'Démarrer'</span><span style="color: #007700">(</span><span style="color: #0000BB">Frenchversion</span><span style="color: #007700">)</span><span style="color: #DD0000">"<br />
      <br />
      <br />
      ;#########################################SPLASH######################################<br />
      #thepluginsdirisautomaticallydeletedwhentheinstallerexits<br />
      InitPluginsDir<br />
      File/oname=$PLUGINSDIR\splash.bmp"</span><span style="color: #007700">.</span><span style="color: #0000BB">Graphicsinstall</span><span style="color: #007700">.</span><span style="color: #0000BB">bmp</span><span style="color: #DD0000">"<br />
      <br />
      advsplash::show1000600400-1$PLUGINSDIR\splash<br />
      <br />
      Pop$0;$0has'1'iftheuserclosedthesplashscreenearly,<br />
      ;'0'ifeverythingclosednormal,and'-1'ifsomeerroroccured.<br />
      ;########################################SPLASH#######################################<br />
      <br />
      <br />
      <br />
      ;Demandedulanguageaudébut<br />
      StrCmp$LANGUAGE${LANG_ENGLISH}frenchenglish<br />
      french:<br />
      StrCpy$R0"</span><span style="color: #0000BB">SelectyourWindowssytemlanguage</span><span style="color: #007700">.$</span><span style="color: #0000BB">rChoisissezlalanguedevotresystemeWindows</span><span style="color: #007700">.</span><span style="color: #DD0000">"<br />
      StrCpy$R1"</span><span style="color: #0000BB">Installlanguage</span><span style="color: #007700">/</span><span style="color: #0000BB">Langued</span><span style="color: #DD0000">'installation"<br />
      Gotoend<br />
      english:<br />
      StrCpy$R0"SelectyourWindowssytemlanguage.$\rChoisissezlalanguedevotresystemeWindows."<br />
      StrCpy$R1"Installlanguage/Langued'</span><span style="color: #0000BB">installation</span><span style="color: #DD0000">"<br />
      end:<br />
      !DefineMUI_LANGDLL_WINDOWTITLE$R1<br />
      !DefineMUI_LANGDLL_INFO$R0<br />
      <br />
      ;Déclarationdesini<br />
      !insertmacroMUI_LANGDLL_DISPLAY<br />
      !insertmacroMUI_INSTALLOPTIONS_EXTRACT"</span><span style="color: #0000BB">RT</span><span style="color: #007700">.</span><span style="color: #0000BB">ini</span><span style="color: #DD0000">"<br />
      !insertmacroMUI_INSTALLOPTIONS_EXTRACT"</span><span style="color: #0000BB">OPT</span><span style="color: #007700">.</span><span style="color: #0000BB">ini</span><span style="color: #DD0000">"<br />
      <br />
      FunctionEnd<br />
      <br />
      ;---------------------------------------------------------------------------------------<br />
      ;Descriptions<br />
      <br />
      ;Languagestringspourl'installation<br />
      LangStringDESC_SecED${LANG_ENGLISH}"</span><span style="color: #0000BB">Thissectionis</span><span style="color: #007700">for</span><span style="color: #0000BB">theEasyDealinstallation</span><span style="color: #007700">.</span><span style="color: #DD0000">"<br />
      LangStringDESC_SecED${LANG_FRENCH}"</span><span style="color: #0000BB">Cettesectionestpourl</span><span style="color: #DD0000">'installationdeEasyDeal."<br />
      <br />
      <br />
      <br />
      ;Assignlanguagestringstosections<br />
      !insertmacroMUI_FUNCTION_DESCRIPTION_BEGIN<br />
      !insertmacroMUI_DESCRIPTION_TEXT${SecED}$(DESC_SecED)<br />
      !insertmacroMUI_FUNCTION_DESCRIPTION_END<br />
      <br />
      <br />
      ;---------------------------------------------------------------------------------------<br />
      ;UninstallerSection<br />
      <br />
      Section"Uninstall"<br />
      <br />
      ;ADDYOUROWNFILESHERE...<br />
      Delete"$INSTDIR\*.*"<br />
      Delete"$INSTDIR\Uninstall.exe"<br />
      Delete"$SMPROGRAMS\Startup\EasyDeal.lnk"<br />
      Delete"$SMPROGRAMS\Démarrage\EasyDeal.lnk"<br />
      Delete"$DESKTOP\EasyDeal.lnk"<br />
      <br />
      ;Clédulanguage<br />
      DeleteRegKey/ifemptyHKCU"Software\EASYDEAL"<br />
      RMDir"$INSTDIR"<br />
      <br />
      <br />
      SectionEnd<br />
      ;---------------------------------------------------------------------------------------<br />
      ;UninstallerFunctions<br />
      <br />
      Functionun.onInit<br />
      <br />
      ;Demandedulanguageaudébut<br />
      StrCmp$LANGUAGE${LANG_ENGLISH}frenchenglish<br />
      french:<br />
      StrCpy$R0"SelectyourWindowssytemlanguage.$\rChoisissezlalanguedevotresystemeWindows."<br />
      StrCpy$R1"Installlanguage/Langued'</span><span style="color: #0000BB">installation</span><span style="color: #DD0000">"<br />
      Gotoend<br />
      english:<br />
      StrCpy$R0"</span><span style="color: #0000BB">SelectyourWindowssytemlanguage</span><span style="color: #007700">.$</span><span style="color: #0000BB">rChoisissezlalanguedevotresystemeWindows</span><span style="color: #007700">.</span><span style="color: #DD0000">"<br />
      StrCpy$R1"</span><span style="color: #0000BB">Installlanguage</span><span style="color: #007700">/</span><span style="color: #0000BB">Langued</span><span style="color: #DD0000">'installation"<br />
      end:<br />
      !DefineMUI_UNLANGDLL_WINDOWTITLE$R1<br />
      !DefineMUI_UNLANGDLL_INFO$R0<br />
      <br />
      !insertmacroMUI_UNGETLANGUAGE<br />
      <br />
      FunctionEnd<br />
      ;------------VoirlelanguagedelapageAccessRTetclient/server-------------------<br />
      LangStringTEXT_IO_TITLE${LANG_ENGLISH}"InstallOptionspage"<br />
      LangStringTEXT_IO_SUBTITLE${LANG_ENGLISH}"ThisisapageisforAccessRT."<br />
      LangStringTEXT_IO_TITLE${LANG_FRENCH}"Paged'</span><span style="color: #0000BB">installation</span><span style="color: #DD0000">"<br />
      LangStringTEXT_IO_SUBTITLE${LANG_FRENCH}"</span><span style="color: #0000BB">CettepageestpourAccessRT</span><span style="color: #007700">.</span><span style="color: #DD0000">"<br />
      <br />
      ;------------VoirlelanguagedelapageInstallationEasyDeal-----------------------<br />
      LangStringTEXT_IO_TITLE1${LANG_ENGLISH}"</span><span style="color: #0000BB">InstallOptionspage</span><span style="color: #DD0000">"<br />
      LangStringTEXT_IO_SUBTITLE1${LANG_ENGLISH}"</span><span style="color: #0000BB">Thisisapageis</span><span style="color: #007700">for</span><span style="color: #0000BB">theEasyDealinstallation</span><span style="color: #007700">.</span><span style="color: #DD0000">"<br />
      LangStringTEXT_IO_TITLE1${LANG_FRENCH}"</span><span style="color: #0000BB">Paged</span><span style="color: #DD0000">'installation"<br />
      LangStringTEXT_IO_SUBTITLE1${LANG_FRENCH}"Cettepageestpourl'</span><span style="color: #0000BB">installationd</span><span style="color: #DD0000">'EasyDeal."<br />
      <br />
      ;--------------------------------------------------------------------------------------<br />
      ;PagedeART<br />
      FunctionCustomPage1<br />
      ;LaLettred'</span><span style="color: #0000BB">oulesetupadémarrer<br />
      <br />
      <br />
      <br /></span> <span style="color: #007700">!</span><span style="color: #0000BB">insertmacroMUI_HEADER_TEXT</span><span style="color: #DD0000">"$(TEXT_IO_TITLE)""$(TEXT_IO_SUBTITLE)"<br /></span> <span style="color: #007700">!</span><span style="color: #0000BB">insertmacroMUI_INSTALLOPTIONS_DISPLAY</span><span style="color: #DD0000">"RT.ini"<br />
      <br />
      <br /></span> <span style="color: #0000BB">IfFileExists</span><span style="color: #DD0000">"c:\runtime\office\MSACCESS.*"</span><span style="color: #0000BB">0NotFileExisted<br />
      Abort<br />
      NotFileExisted</span><span style="color: #007700">:<br />
      <br />
      <br />
      <br />
      ;</span><span style="color: #0000BB">Selonlalangueondémarrel</span><span style="color: #DD0000">'installationdeAccessRTselonlalangue<br />
      <br />
      StrCmp$LANGUAGE${LANG_ENGLISH}0notEnglish<br />
      ;Chemindusetup<br />
      StrCpy$9$EXEDIR<br />
      ;CléderebootdansleRunOnce<br />
      WriteRegStrHKCU"Software\Microsoft\Windows\CurrentVersion\RunOnce""EasyDealIns""$9\EasyDeal_Installer.exe"<br />
      ;StrCpy$9$EXEDIR10<br />
      ;nsExec::Exec"$9\AccessRT-A\setup.exe"<br />
      ExecWait"$9\AccessRT-A\setup.exe/wait"<br />
      notEnglish:<br />
      <br />
      StrCmp$LANGUAGE${LANG_FRENCH}0notFrench<br />
      ;Chemindusetup<br />
      StrCpy$9$EXEDIR<br />
      ;CléderebootdansleRunOnce<br />
      WriteRegStrHKCU"Software\Microsoft\Windows\CurrentVersion\RunOnce""EasyDealIns""$9\EasyDeal_Installer.exe"<br />
      ;StrCpy$9$EXEDIR10<br />
      ;nsExec::Exec"$9\AccessRT\setup.exe"<br />
      ExecWait"$9\AccessRT\setup.exe/wait"<br />
      <br />
      <br />
      notFrench:<br />
      <br />
      FunctionEnd<br />
      <br />
      ;---------------------------------------------------------------------------------------<br />
      FunctionCustomPage2<br />
      <br />
      StrCmp$LANGUAGE${LANG_ENGLISH}english1french1<br />
      <br />
      english1:<br />
      !insertmacroMUI_INSTALLOPTIONS_WRITE"OPT.ini""Field1""text""InstallationType"<br />
      !insertmacroMUI_INSTALLOPTIONS_WRITE"OPT.ini""Field4""text""InstallEasyDealasserver.Thiscomputerwillsharefileswith\r\nalltheothers."<br />
      !insertmacroMUI_INSTALLOPTIONS_WRITE"OPT.ini""Field5""text""InstallEasyDealasclient.Thiscomputerwilltakeinformations\r\nfromtheservertobeabletorun."<br />
      gotoshowpage<br />
      <br />
      french1:<br />
      !insertmacroMUI_INSTALLOPTIONS_WRITE"OPT.ini""Field1""text""Typed'</span><span style="color: #0000BB">installation</span><span style="color: #DD0000">"<br />
      !insertmacroMUI_INSTALLOPTIONS_WRITE"</span><span style="color: #0000BB">OPT</span><span style="color: #007700">.</span><span style="color: #0000BB">ini</span><span style="color: #DD0000">""</span><span style="color: #0000BB">Field4</span><span style="color: #DD0000">""</span><span style="color: #0000BB">text</span><span style="color: #DD0000">""</span><span style="color: #0000BB">Installationdetypeserveur</span><span style="color: #007700">.</span><span style="color: #0000BB">Cetordinateurvapartagerlesrnfichiersauxautresordinateurs</span><span style="color: #007700">.</span><span style="color: #DD0000">"<br />
      !insertmacroMUI_INSTALLOPTIONS_WRITE"</span><span style="color: #0000BB">OPT</span><span style="color: #007700">.</span><span style="color: #0000BB">ini</span><span style="color: #DD0000">""</span><span style="color: #0000BB">Field5</span><span style="color: #DD0000">""</span><span style="color: #0000BB">text</span><span style="color: #DD0000">""</span><span style="color: #0000BB">Installationdetypeclient</span><span style="color: #007700">.</span><span style="color: #0000BB">Cetordinateurprendrasesinformationsrnàpartirduserveur</span><span style="color: #007700">.</span><span style="color: #DD0000">"<br />
      showpage:<br />
      <br />
      <br />
      ;Choixentrel'installationserverouclient<br />
      !insertmacroMUI_HEADER_TEXT"</span><span style="color: #007700">$(</span><span style="color: #0000BB">TEXT_IO_TITLE1</span><span style="color: #007700">)</span><span style="color: #DD0000">""</span><span style="color: #007700">$(</span><span style="color: #0000BB">TEXT_IO_SUBTITLE1</span><span style="color: #007700">)</span><span style="color: #DD0000">"<br />
      !insertmacroMUI_INSTALLOPTIONS_DISPLAY"</span><span style="color: #0000BB">OPT</span><span style="color: #007700">.</span><span style="color: #0000BB">ini</span><span style="color: #DD0000">"<br />
      <br />
      FunctionEnd<br />
      ;----------------------------------------------------------------------------------------<br /></span></span> <!-- php buffer end -->
      <hr />
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
      <span class="post-time small text-muted">30th July 2004 17:39 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">If you wish to change the text displayed, use MUI_LANGDLL_* at the appropriate place, as explained in the MUI readme.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
      <span class="post-time small text-muted">30th July 2004 17:41 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Never mind.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Freezerman350</span><br />
      <span class="post-time small text-muted">30th July 2004 18:50 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">So ?</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">iceman_k</span><br />
      <span class="post-time small text-muted">31st July 2004 05:49 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Your original solution would have never worked- because !define is evaluated at compile time, not runtime.<br />
      The MUI macros also define the LangDLL titles at compile time.<br />
      What you should do is this:<br />
      <br /></p>
      <pre>
<code><br />Function .onInit<br />    StrCmp $LANGUAGE ${LANG_ENGLISH} french english<br />french:<br />    LangDLL::LangDialog "Select your Windows system language." "Install language" 2 English 1033 French 1036<br />    Goto end<br />english:<br />    LangDLL::LangDialog "Choisissez la langue de votre systeme Windows." "Langue d'installation" 2 French 1036 English 1033<br />end:<br />    Pop $LANGUAGE<br />    StrCmp $LANGUAGE "cancel" 0 +2<br />    Abort<br />FunctionEnd<br /></code>
</pre><br />
      <br />
      Create similar code for un.onInit (or save $LANGUAGE in the registry so it can be done automatically).
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
      <span class="post-time small text-muted">31st July 2004 10:54 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">$R0 and $R1, however, are resolved at runtime. It should work, and it does if he fixes his mistake in the first code, as he said himself. The only problem in the first code is that he jumps to the French label if the language is English. Fixing that, as he already mentioned he did, should fix everything and it works in an example I tested.<br />
      <br />
      Seeing as the "attached" (see forum rules) script is so huge, I don't want to dig into it to find out why "the page will be always in french, no matter the language of the windows".</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">iceman_k</span><br />
      <span class="post-time small text-muted">31st July 2004 13:36 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">$R0 and $R1 are evaluated at runtime, but aren't the following lines evaluated at compiletime?<br />
      <br /></p>
      <pre>
<code><br />!Define MUI_LANGDLL_WINDOWTITLE $R1<br />!Define MUI_LANGDLL_INFO $R0<br /></code>
</pre><br />
      <br />
      I think jumping to the French label when the default language is English is correct- he is providing the prompt in English in that case and giving the user the chance to switch to French.<br />
      Similarly, when the default language is French, he prompts the user in French to switch their language.<br />
      <br />
      You could say that his label names are misleading, but the logic is correct.<br />
      <br />
      The solution I provided will work. I tested it with a reduced version of the MUI Multilanguage.nsi example (attached). I switched my Windows region from US to France and tested with French as the default as well.<br />
      <br />
      The only remaining issues I can see are that the LangDLL dialog buttons are still in English and that the MessageBox displayed when you click Cancel on any of the pages also has its buttons in English.
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
      <span class="post-time small text-muted">31st July 2004 13:40 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">The defines are evaluated at compile time and therefore $R0 and $R1 are used as the values. $R0 and $R1 are then evaluated at runtime to get the final value.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">iceman_k</span><br />
      <span class="post-time small text-muted">31st July 2004 13:46 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">OK. I see what you mean.<br />
      So something like this should work for him:<br /></p>
      <pre>
<code><br />Function .onInit<br />    Push $R0<br />    Push $R1<br />    StrCmp $LANGUAGE ${LANG_ENGLISH} french english<br />french:<br />    StrCpy $R0 "Select your Windows system language."<br />    StrCpy $R1 "Install language"<br />Goto end<br />english:<br />    StrCpy $R0 "Choisissez la langue de votre systeme Windows."<br />    StrCpy $R1 "Langue d'installation"<br />end:<br />!Define MUI_LANGDLL_INFO $R0<br />!Define MUI_LANGDLL_WINDOWTITLE $R1<br />  !insertmacro MUI_LANGDLL_DISPLAY<br />    Pop $LANGUAGE<br />    StrCmp $LANGUAGE "cancel" 0 +2<br />    Abort<br />    Pop $R1<br />    Pop $R0<br />FunctionEnd<br /></code>
</pre>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
      <span class="post-time small text-muted">31st July 2004 13:54 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">If you remove:</p>
      <pre>
<code>Pop $LANGUAGE<br />StrCmp $LANGUAGE "cancel" 0 +2<br />Abort</code>
</pre>it should work, assuming he wants to display English text when the system language is French.<br />
      <br />
      If you don't remove the Pop $LANGUAGE instruction, $LANGUAGE will always be set to "" and the user's selection will be ignored. The MUI already pops the value into $LANGUAGE and compares it to "cancel". The extra Pop instruction in your code pops $R1's value pushed on the third line.
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">iceman_k</span><br />
      <span class="post-time small text-muted">31st July 2004 14:50 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Oops- forgot to remove those lines :D .<br />
      Final version should be:<br /></p>
      <pre>
<code><br />Function .onInit<br />    Push $R0<br />    Push $R1<br />    StrCmp $LANGUAGE ${LANG_ENGLISH} english french<br />english:<br />    StrCpy $R0 "Select your Windows system language."<br />    StrCpy $R1 "Install language"<br />Goto end<br />french:<br />    StrCpy $R0 "Choisissez la langue de votre systeme Windows."<br />    StrCpy $R1 "Langue d'installation"<br />end:<br />!Define MUI_LANGDLL_INFO $R0<br />!Define MUI_LANGDLL_WINDOWTITLE $R1<br />  !insertmacro MUI_LANGDLL_DISPLAY<br />    Pop $R1<br />    Pop $R0<br />FunctionEnd<br /></code>
</pre>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Freezerman350</span><br />
      <span class="post-time small text-muted">4th August 2004 20:17 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">So dude, that so logical.. !!!<br />
      <br />
      look.. I pop up my $language on the oninit !<br />
      <br />
      on my french windows 1036 ! Good that my french version so i just have to make a little if and that it !<br />
      <br />
      BUT &lt;-----------------------<br />
      <br />
      I build my "if" ...but i tried it on a english windows version bam...dont work...<br />
      <br />
      PHP Code:</p>
      <hr />
      <code style="white-space:nowrap"><!-- php buffer start --></code><span style="color: #000000"><span style="color: #0000BB">StrCpy</span><span style="color: #007700">$</span><span style="color: #0000BB">0$LANGUAGE<br />
      StrCmp</span><span style="color: #007700">$</span><span style="color: #0000BB">0</span><span style="color: #DD0000">'1036'</span><span style="color: #0000BB">WinFRNotWinFR<br />
      WinFR</span><span style="color: #007700">:<br /></span> <span style="color: #0000BB">StrCpy$R0</span><span style="color: #DD0000">"ChoisissezlalanguedevotresystemeWindows."<br /></span> <span style="color: #0000BB">StrCpy$R1</span><span style="color: #DD0000">"Langued'installation"<br /></span> <span style="color: #0000BB">NotWinFR</span><span style="color: #007700">:<br /></span> <span style="color: #0000BB">StrCmp</span><span style="color: #007700">$</span><span style="color: #0000BB">0</span><span style="color: #DD0000">'1033'</span><span style="color: #0000BB">WinEnNotWinEn<br />
      WinEn</span><span style="color: #007700">:<br /></span> <span style="color: #0000BB">StrCpy$R0</span><span style="color: #DD0000">"SelectyourWindowssytemlanguage"<br /></span> <span style="color: #0000BB">StrCpy$R1</span><span style="color: #DD0000">"Installlanguage"<br /></span> <span style="color: #0000BB">NotWinEn</span><span style="color: #007700">:<br />
      !</span><span style="color: #0000BB">DefineMUI_LANGDLL_WINDOWTITLE$R1<br /></span> <span style="color: #007700">!</span><span style="color: #0000BB">DefineMUI_LANGDLL_INFO$R0<br /></span></span> <!-- php buffer end -->
      <hr />
      <br />
      <br />
      SO wht i can do... nothing work...
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">iceman_k</span><br />
      <span class="post-time small text-muted">4th August 2004 21:36 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">The script I posted worked fine- I tried it with both French &amp; English regional settings.<br />
      Your latest script is missing some gotos.<br />
      I couldn't understand what your exact situation is now.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Freezerman350</span><br />
      <span class="post-time small text-muted">5th August 2004 15:21 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">But another question, if i want to to autodetect the language...<br />
      <br />
      the user have noting to choose<br />
      <br />
      <br />
      how i can do that ??</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Freezerman350</span><br />
      <span class="post-time small text-muted">5th August 2004 15:36 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Mr Iceman... i just try your new version... work great on my french windows<br />
      <br />
      and also work in french on my english windows....<br />
      so... i think Nsis work with maybe the keyboard language or regional language .... maybe this is why all my windows french or english..pup up withthe french version of my installer !</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Freezerman350</span><br />
      <span class="post-time small text-muted">5th August 2004 15:39 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">thx guys ... but the probleme is actually the regional information...<br />
      <br />
      I absolutly need the windows language whatever the regional param</p>
    </div>
    <hr />

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]>
  </script>
</body>
</html>
