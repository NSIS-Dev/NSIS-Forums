<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="description" content="Extension DLL - Windows Service Functions &amp; Is Administrator Check"><title>Extension DLL - Windows Service Functions &amp; Is Administrator Check - NSIS Forums</title><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script><link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css"><link rel="stylesheet" href="../css/style.css" type="text/css"><!--[if lt IE 9]><script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script><script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script><![endif]--></head><body><div class="container"><ol class="breadcrumb"><li><a href="../index.html" class="glyphicon glyphicon-home"></a></li><li><a href="f-65.html">NSIS Discussion</a></li><li class="active">Extension DLL - Windows Service Functions &amp; Is Administrator Check</li></ol><p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=90577">Extension DLL - Windows Service Functions &amp; Is Administrator Check</a></p><br><div class="post"><p class="post-meta"><span class="post-author text-primary">Sunjammer</span><br><span class="post-time small text-muted">10th June 2002 15:16 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>Extension DLL - Windows Service Functions &amp; Is Administrator Check</strong><br>I've no idea if this is the place to post this, feel free to swear at me if I get it wrong (or just for the hell of it :D).<br><br>I started using NSIS about two days ago and it's awesome. I needed a couple of features and being a coder I just wrote them myself using an extension dll, I'm sorry if I've duplicated someone else's effort and am thus wasting your time, but I hope this is useful to someone.<br><br>The code is a little messy. I'll wait to see what people say and incorporate any changes/requests/bug fixes/etc and upload a new version with better docs too (unless people tell me it's crap :p)<br><br>The DLL provides the following functionality :-<br><br>- IsProcessUserAdministrator<br>- HasLogonAsAService<br>- GrantLogonAsAService<br>- RemoveLogonAsAService<br>- IsServiceInstalled<br>- IsServiceRunning<br>- SendServiceCommand [ start | stop | pause | continue | delete ]<br><br>All functions expect arguments on the stack, full docs are in the .zip file provided along with an explanation of who might need the functionality and what it does. Source code included.<br><br>Get it here: <a href="http://www.clantpa.co.uk/nsis/x18servicesV0.0.zip" target="_blank">http://www.clantpa.co.uk/nsis/x18servicesV0.0.zip</a> [ only ~18 kb! ]<br><br>---<br><br>Ximon Eighteen<br>Programmer @ Advent Publishing Systems<br><br>email: <a href="mailto:ximon_eighteen@3b2.com">ximon_eighteen@3b2.com</a><br>&amp; msn: <a href="mailto:ximon_eighteen@hotmail.com">ximon_eighteen@hotmail.com</a></p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">veekee</span><br><span class="post-time small text-muted">10th June 2002 18:30 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Sorry, can't download that file .. zip file seems incompete ... :eek: :(</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Sunjammer</span><br><span class="post-time small text-muted">10th June 2002 19:20 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>D**n</strong><br>D****t. I've just found out that I can't open a load of zipped stuff I made earlier today. At work we use a zip program other than WinZip and I've never had a problem with it before but that's the only reason I can think of for this problem (I uploaded it from work see). The tests I did at work were fine but you are perfectly correct, my home computer can't make head nor tail of the file either.<br><br>I'll see if I can fix the problem tonight (I don't have all of the files I made with me at the mo) if not it will be fixed by about 9.30am tommorow.<br><br>Grrr. I'll post back here once I resolve the problem.<br><br>---<br><br>Ximon Eighteen<br>Advent Publishing Systems<br>email: <a href="mailto:ximon_eighteen@3b2.com">ximon_eighteen@3b2.com</a><br>&amp; msn: <a href="mailto:ximon_eighteen@hotmail.com">ximon_eighteen@hotmail.com</a></p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Sunjammer</span><br><span class="post-time small text-muted">10th June 2002 21:14 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>Humourous happenings</strong><br>I'm very sorry if I have annoyed or upset anyone with my language in the previous post, I have to say that I personally didn't mean what I said in an angry manner and that it was intended to be slightly jokey, hence things like the "grrr". At any rate it was rightly pointed out that it could be taken to be offensive so I apologise for that.<br><br>This seems to be a good day for mistakes huh ;-)<br><br>I've determed what happened to the uploaded file but there's nothing I can do to replace the file until tommorow morning (well I could hack together the old copy I have at home but that would likely just result in a bug-ridden upload so I'll wait until I can get at the version that I spent time polishing up).<br><br>In the meantime (this is jumping the gun a little I know) if anyone has any NT security or other Win32 API stuff that they'd like to see in an extension DLL I can put that kind of thing (and lots of other stuff) together quite quickly and easily so feel free to request stuff and I'll honestly tell you if I can do it or not.<br><br>---<br><br>Ximon Eighteen<br>Advent Publishing Systems<br>email: <a href="mailto:ximon_eighteen@3b2.com">ximon_eighteen@3b2.com</a><br>&amp; msn: <a href="mailto:ximon_eighteen@hotmail.com">ximon_eighteen@hotmail.com</a></p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Sunjammer</span><br><span class="post-time small text-muted">11th June 2002 09:40 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>Fixed</strong><br>I have now uploaded a fixed copy of the zip file (and tested the download, the zip expansion, the use of the included dll and the compilation and use of the source code included).<br><br>I also made another mini dll last night for another thread on this forum. I'll collect any dlls I make and make a web page which will be at <a href="http://www.clantpa.co.uk/nsis/." target="_blank">http://www.clantpa.co.uk/nsis/.</a> If you don't see the web page yet don't worry, it will be up later today.<br><br>The other file was made for a very specific purpose, see this thread if you are interested before the web page containing details is created: <a href="http://forums.winamp.com/showthread.php?s=&amp;threadid=90606" target="_blank">http://forums.winamp.com/showthread....threadid=90606</a><br><br>---<br><br>Ximon Eighteen<br>Programmer @ Advent Publishing Systems<br>email: <a href="mailto:ximon_eighteen@3b2.com">ximon_eighteen@3b2.com</a><br>&amp; msn: <a href="mailto:ximon_eighteen@hotmail.com">ximon_eighteen@hotmail.com</a></p></div><hr><div class="footer"><p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p></div></div><script src="../js/highlight.pack.js" type="text/javascript"></script><script type="text/javascript">//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]></script></body></html>