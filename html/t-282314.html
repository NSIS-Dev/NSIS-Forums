<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="Need help with all users!" />

  <title>Need help with all users! - NSIS Forums</title>
  <script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script>
  <!-- Bootstrap core CSS -->

  <link rel="stylesheet" type="text/css" href="//netdna.bootstrapcdn.com/bootswatch/3.0.1/readable/bootstrap.min.css" />
  <link rel="stylesheet" href="../css/style.css" type="text/css" /><!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!--[if lt IE 9]>
                <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
                <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->
</head>

<body>
  <div class="container">
    <!-- Put navigation bar here -->

    <ol class="breadcrumb">
      <li><a href="../index.html" class="glyphicon glyphicon-home"></a></li>

      <li><a href="f-65.html">NSIS Discussion</a></li>

      <li class="active">Need help with all users!</li>
    </ol>

    <p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=282314">Need help with all users!</a></p><br />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Dexterito</span><br />
      <span class="post-time small text-muted">29th November 2007 08:09 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>Need help with all users!</strong><br />
      Hello!<br />
      <br />
      I'm creating some instalation and i have to copy config file in application data folder for every user. I use propertu<br />
      <i>SetShellVarContext all</i> but then the config file is copied into C:\documents and settings\All users\Application data but not for each user! and if for windows add some new user,then need that config file to copy for the new user too!<br />
      <br />
      Maybe someone have some suggestions?<br />
      <br />
      Dexter</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Anders</span><br />
      <span class="post-time small text-muted">29th November 2007 09:00 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">You could enumerate the users at install time, load their profile and copy to their appdata folder, but that would not solve the new user problem (And users that don't want to use your program get useless files in their profile). Why not store a basic config file in programfiles or common files and add some logic to your program instead that will copy the base config to the users appdata the first time the user runs your program</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">CancerFace</span><br />
      <span class="post-time small text-muted">29th November 2007 09:33 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">If you want new users to get the config file you should also place it in <i>C:\documents and settings\Default User\Application data</i>.<br />
      <br />
      However Anders has a good point, it may be more functional to copy the config file to a user's AppData folder when they execute your program for the first time.<br />
      <br />
      CF</p>
    </div>
    <hr />

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]>
  </script>
</body>
</html>
