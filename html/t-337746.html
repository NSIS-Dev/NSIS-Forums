<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="description" content="problem with uninstall.exe"><title>problem with uninstall.exe - NSIS Forums</title><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script><link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css"><link rel="stylesheet" href="../css/style.css" type="text/css"></head><body><div class="container"><ol class="breadcrumb"><li><a href="../index.html" class="glyphicon glyphicon-home"></a></li><li><a href="f-65.html">NSIS Discussion</a></li><li class="active">problem with uninstall.exe</li></ol><p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=337746">problem with uninstall.exe</a></p><br><div class="post"><p class="post-meta"><span class="post-author text-primary">hanenjom</span><br><span class="post-time small text-muted">18th November 2011 15:47 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>problem with uninstall.exe</strong><br>Hi , plesase can you help me,<br><br>i have a problem with uninstaller.exe :(<br><br>On unistaller, i use a file hwo contain a list of folder and directories to delete, the path of this file is $INSTDIR\unistall.txt.<br><br>when I install the some kit in two diffrent path kit1 on c:\path1; and the file c:\path1\unistall.txt<br>and kit2 on c:\path2, and the file c:\path2\unistall.txt<br><br>when I wany uninstall kit1, i have on unsitalla.exe the path of the second kit, c:\path2\unistall.txt.<br><br>as if it is about to overwrite the new value of $INSTDIR every time I install a kit<br><br>Please help me.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">DrO</span><br><span class="post-time small text-muted">18th November 2011 16:02 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">will you please make sure that you're posting a new thread in the correct part of the forum - is now the second time i've had to move a new thread made by you from the Winamp areas into the NSIS forum.<br><br>-daz</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">hanenjom</span><br><span class="post-time small text-muted">18th November 2011 16:07 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>thx</strong><br>@ DrO ; thx :)</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">demiller9</span><br><span class="post-time small text-muted">18th November 2011 19:54 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">And please check for typos. I can't understand what your issue is.<br><br>hwo - wany - unsitalla.exe</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">hanenjom</span><br><span class="post-time small text-muted">21st November 2011 08:45 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">to uninstall the kit, I use a file "unistall.txt" which contains a list of files and directories to be deleted.<br><br>Section-post SEC0001<br>WriteRegStr HKLM "$ {REGKEYS}" Path $ INSTDIR<br>SetOutPath $ INSTDIR<br>WriteUninstaller $ INSTDIR \ uninstall.exe<br>WriteRegStr HKLM "SOFTWARE \ Microsoft \ Windows \ CurrentVersion \ Uninstall \ $ (^ Name)" DisplayName "$ (^ Name)"<br>WriteRegStr HKLM "SOFTWARE \ Microsoft \ Windows \ CurrentVersion \ Uninstall \ $ (^ Name)" DisplayIcon $ INSTDIR \ uninstall.exe<br>WriteRegStr HKLM "SOFTWARE \ Microsoft \ Windows \ CurrentVersion \ Uninstall \ $ (^ Name)" UninstallString $ INSTDIR \ uninstall.exe<br>WriteRegDWORD HKLM "SOFTWARE \ Microsoft \ Windows \ CurrentVersion \ Uninstall \ $ (^ Name)" 1 NoModify<br>WriteRegDWORD HKLM "SOFTWARE \ Microsoft \ Windows \ CurrentVersion \ Uninstall \ $ (^ Name)" NoRepair 1SectionEnd<br><br>Section "Uninstall"<br>SectionIn RO<br>StrCpy $ line "" FileOpen $ uninstall "$ INSTDIR \ uninstall.txt" r<br>read:<br>FileRead $ uninstall $ line<br>StrCmp $ line "" done<br>StrFilter $ {} $ line "" "" "$ \ r $ \ n" $ line<br>Rmdir / r "$ line"<br>Delete $ line<br>Goto read<br>done:<br>FileClose $ uninstall<br>Delete "$ INSTDIR \ uninstall.txt"<br>DetailPrint "****"<br>SectionEnd<br><br>in the normal case the uninstall worked great, but when I install the kit twice in two different ways, for exmple the first installation in c: \ path1, we will have the file c: \ path1 \ unistall. txt<br>and the second installation in c: \ path2 and the file c: \ path2 \ unistall.txt<br><br>when I run the uninstall kit1 I unsitall.exe on the path of the second kit, c: \ path2 \ unistall.txt.<br><br>it overwrites the first pah and he supports the new path of the second kit, the i will Have a faulty process to uninstall<br><br>Please help me</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">MSG</span><br><span class="post-time small text-muted">21st November 2011 10:01 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Because you are storing the uninstall information in exactly the same place for both installations, of course you cannot have two uninstallation items in your Add/Remove Programs window.<br><br>What you need to do is store the uninstall information in separate locations for both installations.<br><br>For example, in pseudo-code:<br>If uninstall information already exists in registry<br>andif installpath in registry is different from our $instdir<br>then write uninstall information to a different name. For example: "SOFTWARE\Microsoft\Windows\CurrentVersion\Uninstall\$(^Name)1"<br><br>However, if you do this you need to store the new registry name in your uninstaller, otherwise it won't know what registry entries to delete. You can do this with the ReadCustomerData function.</p></div><hr><div class="footer"><p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p></div></div><script src="../js/highlight.pack.js" type="text/javascript"></script><script type="text/javascript">//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]></script></body></html>