<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="What am I doing wrong here? I want to use NSIS but MSI works..." />

  <title>What am I doing wrong here? I want to use NSIS but MSI works... - NSIS Forums</title>
  <script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script>
  <!-- Bootstrap core CSS -->

  <link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css" />
  <link rel="stylesheet" href="../css/style.css" type="text/css" /><!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!--[if lt IE 9]>
                <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
                <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->
</head>

<body>
  <div class="container">
    <!-- Put navigation bar here -->

    <ol class="breadcrumb">
      <li><a href="../index.html" class="glyphicon glyphicon-home"></a></li>

      <li><a href="f-65.html">NSIS Discussion</a></li>

      <li class="active">What am I doing wrong here? I want to use NSIS but MSI works...</li>
    </ol>

    <p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=156158">What am I doing wrong here? I want to use NSIS but MSI works...</a></p><br />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">PURDooM</span><br />
      <span class="post-time small text-muted">14th November 2003 02:31 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>What am I doing wrong here? I want to use NSIS but MSI works...</strong><br />
      Well, basically we have this Visual Basic app named Bottler (<a href="http://www.memelog.com/bottler" target="_blank">www.memelog.com/bottler</a>), and it has worked great with a MSI installer in the past. Recently (september) we have used a NSIS script to install our file, however the installed executable doesn't work well or at all on os's other than english.<br />
      <br />
      More complaining by users can our solutions can be found at (<a href="http://www.memelog.com/bottler/forum/viewtopic.php?p=13843#13843" target="_blank">http://www.memelog.com/bottler/forum...?p=13843#13843</a>)..<br />
      <br />
      Basically I would like it if you had any solutions other than providing english dll's with our distro. We aim at getting every version of 2000 and XP to be compatable with our software under NSIS.<br />
      <br />
      You can find source for our program and the NSIS installer here: <a href="http://www.memelog.com/bottler/Bottler_v3.2.1116_Source.zip" target="_blank">http://www.memelog.com/bottler/Bottl...116_Source.zip</a></p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
      <span class="post-time small text-muted">14th November 2003 11:06 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">I see no reason whatsoever to blame NSIS on this. It's your program that gives the error, your program must have changed too since September and NSIS doesn't even "know" what VB is. Please provide some more details on what made you jump to this conclusion.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">PURDooM</span><br />
      <span class="post-time small text-muted">14th November 2003 14:24 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">I know it's our fault, not NSIS...<br />
      <br />
      I guess what I want to know is how should I handle installing international versions of DLL's. Is there a way to detect the language of the OS or a place to get international DLL's?<br />
      <br />
      In MSI it does this for us, so we are just wondering how to have the same effect in NSIS. We have lots of french, german, and portugese users that don't work because the NSIS script is broken.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
      <span class="post-time small text-muted">14th November 2003 14:41 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Ah, ok, sorry...<br />
      <br />
      I really doubt MSI contains the versions of those DLLs you need to install for every possible language Microsoft supports. That would be huge. I think the problem is here:</p>
      <pre>
<code>SetOutPath $SYSDIR<br />File "C:\WINDOWS\system32\scrrun.dll"<br />File "C:\WINDOWS\system32\mswinsck.OCX"<br />File "C:\WINDOWS\system32\mscomctl.OCX"<br />File "C:\WINDOWS\system32\comct332.OCX"<br />File "C:\WINDOWS\system32\tabctl32.OCX"<br />File "C:\WINDOWS\system32\msflxgrd.OCX"<br />File "C:\WINDOWS\system32\richtx32.OCX"</code>
</pre>It overrides the DLLs without checking if the version you're installing is newer. It also doesn't check if they're in use and copies them after reboot if they are. You should use UpgradeDLL (find it in the Archive or in NSIS 2 documentation) to upgrade system DLLs.
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Joost Verburg</span><br />
      <span class="post-time small text-muted">14th November 2003 16:21 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">You can also find useful information about installing VB6 runtimes in the documentation.</p>
    </div>
    <hr />

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]>
  </script>
</body>
</html>
