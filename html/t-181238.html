<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="variable as shortcut...howto" />

  <title>variable as shortcut...howto - NSIS Forums</title><!-- Bootstrap core CSS -->
  <link rel="stylesheet" type="text/css" href="//netdna.bootstrapcdn.com/bootswatch/3.0.1/readable/bootstrap.min.css" />
  <link rel="stylesheet" href="../css/style.css" type="text/css" /><!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!--[if lt IE 9]>
                <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
                <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->
</head>

<body>
  <div class="container">
    <!-- Put navigation bar here -->

    <ol class="breadcrumb">
      <li><a href="../index.html" class="glyphicon glyphicon-home"></a></li>

      <li><a href="f-65.html">NSIS Discussion</a></li>

      <li class="active">variable as shortcut...howto</li>
    </ol>

    <p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=181238">variable as shortcut...howto</a></p><br />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">razor_x</span><br />
      <span class="post-time small text-muted">26th May 2004 17:34 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>variable as shortcut...howto</strong><br />
      i have an unstaller with several sections all but one are optional.I know i can use getsectionflags to create a specified shortcut,by the section selected.But how would i create a variable named shortcut,based on $INSTDIR?...for example they install to c:\blahblah...i want to make a short cut on the desktop to c:\blahblah c:\whatever.exe.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">zimsms</span><br />
      <span class="post-time small text-muted">26th May 2004 17:40 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Use the CreateShortcut command. For example:<br />
      <br />
      CreateShortCut "$DESKTOP\Shortcut Name.lnk" "$INSTDIR\My.exe"</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">razor_x</span><br />
      <span class="post-time small text-muted">26th May 2004 17:44 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">thanks for the reply..but i cant use...<br />
      <br /></p>

      <blockquote>
        CreateShortCut "$DESKTOP\Shortcut Name.lnk" "$INSTDIR\My.exe"
      </blockquote>as "shortcut name" would have to be a variable defined at run time not compile time.<br />
      <br />
      hence my question....
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">zimsms</span><br />
      <span class="post-time small text-muted">26th May 2004 17:59 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Var "MyVar"<br />
      <br />
      in .OnInit<br />
      StrCpy $MyVar ""<br />
      <br />
      in a section/function/macro<br />
      StrCpy $MyVar "Shortcut Name"<br />
      CreateShortCut "$DESKTOP\$MyVar.lnk" "$INSTDIR\My.exe"</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">razor_x</span><br />
      <span class="post-time small text-muted">27th May 2004 16:19 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">thxz for the reply again.But that wont help me I cant define "shortcut name" i want that to be defined by the user.Somehow have the shortcut be linked to the $INSTDIR by a variable...the exe is always the same but i would like the shortcut named after the folder..anyway to do this?</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">zimsms</span><br />
      <span class="post-time small text-muted">27th May 2004 16:44 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">In my previous post you can specify what the name of the shortcut is by populating the variable; for example:<br />
      <br />
      StrCpy $MyVar "Shortcut Name"<br />
      <br />
      The value within the quotes could be any value specified at runtime or compile time. All you need to do is populate it.<br />
      <br />
      For example; if you wanted to make the shortcut name equal $INSTDIR, then do this:<br />
      <br />
      StrCpy $MyVar "$INSTDIR"<br />
      <br />
      If you want it to hold some value from the registry then do this:<br />
      <br />
      ReadRegStr $0 "HKLM" "SOFTWARE\Microsoft\Windows NT\CurrentVersion" "ProductName"<br />
      StrCpy $MyVar "$0"<br />
      <br />
      If you want to get the value from the user, you will need to use the InstallOptions to define a custom page that populates $MyVar with the value you are trying to obtain.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">evilO</span><br />
      <span class="post-time small text-muted">27th May 2004 16:58 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Hi :)<br />
      <br />
      @zimsms: right, except that a shortcut can't contain special characters, as ':' and '\'.<br />
      <br />
      @razor_x: Assuming your installation directory is at the drive's root, this will remove the first 3 characters and create the shortcut:<br />
      <br />
      StrLen $R0 $INSTDIR<br />
      StrCpy $R1 $INSTDIR $R0 3<br />
      <br />
      CreateShortCut "$DESKTOP\$R1.lnk" "$INSTDIR\My.exe"<br />
      <br />
      <br />
      For instance, if the installation directory is "c:\blahblah", the shortcut will be named "blahblah"<br />
      <br />
      Will that do ??<br />
      <br />
      evilO/Olive</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">zimsms</span><br />
      <span class="post-time small text-muted">27th May 2004 17:12 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">True enough evilO! I didn't want to confuse razor_x with string functions. But that is a valid point. All illegal characters will have to be stripped out of the string.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">razor_x</span><br />
      <span class="post-time small text-muted">27th May 2004 17:15 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">thxz alot guys! got it working and learned a few things in the process...</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">evilO</span><br />
      <span class="post-time small text-muted">27th May 2004 17:35 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Cool, so we all made our day ;) !<br />
      <br />
      evilO/Olive</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">razor_x</span><br />
      <span class="post-time small text-muted">27th May 2004 17:44 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">just one more question if i had to install to other than the root..could it be done some way?<br />
      <br />
      for example c:\blah works well but what about...c:\program files\blah?</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">zimsms</span><br />
      <span class="post-time small text-muted">27th May 2004 18:15 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Yes you could do that, use the reverse string search for "\" or "/" depending on the platform, the resulting value would be the very last folder name. See the string functions in the NSIS Archive.<br />
      <br />
      I believe it was the "Advanced Search in String" function<br />
      <br />
      <a href="http://nsis.sourceforge.net/archive/nsisweb.php?page=122&amp;instances=0,11" target="_blank">Archive:String Functions</a></p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">razor_x</span><br />
      <span class="post-time small text-muted">27th May 2004 18:19 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">thxz again :)</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">zimsms</span><br />
      <span class="post-time small text-muted">27th May 2004 18:20 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Your Welcome!</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">razor_x</span><br />
      <span class="post-time small text-muted">27th May 2004 18:56 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">well i tried advancedstrstr and doesnt work well for me and i'll tell you why...<br />
      <br /></p>

      <blockquote>
        Push 0 ;Loops Quantity (0 for one code execution, only accept positive numbers)
      </blockquote>the amount of "\" must be known for this code to work...<br />
      <br />
      If push

      <blockquote>
        Push 1 ;Loops Quantity
      </blockquote>then C:\blah works fine...<br />
      <br />
      but if c:\program files\blah<br />
      <br />
      does not work.<br />
      <br />
      so again how too define this shortcut as a true variable...with as MANY or FEW backslashes as is inputed...or is there even a way?i'm thinking there is not a way but there should be.
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">razor_x</span><br />
      <span class="post-time small text-muted">28th May 2004 06:30 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">nvm...<br />
      <br />
      found this function in the archive and works great.<br />
      <br />
      <a href="http://nsis.sourceforge.net/archive/nsisweb.php?page=221&amp;instances=0,11,211" target="_blank">get last directory part</a><br />
      <br />
      please excuse my newbness.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">zimsms</span><br />
      <span class="post-time small text-muted">28th May 2004 13:45 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Not a problem, learning something new is always a challenge; especially under deadlines!</p>
    </div>
    <hr />

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]>
  </script>
</body>
</html>
