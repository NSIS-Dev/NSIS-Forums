<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="Desktop Icon with NSIS Zip2Exe" />

  <title>Desktop Icon with NSIS Zip2Exe - NSIS Forums</title>
  <script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script>
  <!-- Bootstrap core CSS -->

  <link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css" />
  <link rel="stylesheet" href="../css/style.css" type="text/css" /><!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!--[if lt IE 9]>
                <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
                <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->
</head>

<body>
  <div class="container">
    <!-- Put navigation bar here -->

    <ol class="breadcrumb">
      <li><a href="../index.html" class="glyphicon glyphicon-home"></a></li>

      <li><a href="f-65.html">NSIS Discussion</a></li>

      <li class="active">Desktop Icon with NSIS Zip2Exe</li>
    </ol>

    <p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=256003">Desktop Icon with NSIS Zip2Exe</a></p><br />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">SCB</span><br />
      <span class="post-time small text-muted">22nd September 2006 21:48 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>Desktop Icon with NSIS Zip2Exe</strong><br />
      Please excuse my stupidity, but I can't seem to figure out how to create an Installer using the NSIS Zip2Exe option.<br />
      <br />
      I last used NSIS Verion 2.07 and don't recall that it was a problem, since I creted four 'Setup' files for four different free downloads from my web site.<br />
      <br />
      I downloaded and installed the latest version of NSIS and expected to do that for my latest free download package by just selecting the Zip2Exe option and filling in the blanks.<br />
      <br />
      I got a 'Installer' that works fine except for the placing an Icon shortcut on the deskstop.<br />
      <br />
      In my previous ones (using 2.07) that is an option for the user to check.<br />
      <br />
      I'm sure I've forgotten something (it's been over a year since I created those first four) and I'm 68, not a programmer and have a poor memory.<br />
      <br />
      Can some one help me out with this situation?<br />
      <br />
      Thanks,</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
      <span class="post-time small text-muted">22nd September 2006 21:51 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">zip2exe's purpose is not building installers, it's only converting zip files into semi-installers. SFX builder, if you wish. It doesn't create shortcuts. It's meant to extract the files in the zip and nothing more.<br />
      <br />
      If you had shortcuts, you must have used a real script and compiled that with makensis or makensisw. If you can't find the .nsi script, write a new one according to the documentation and the examples in the Examples folder.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">SCB</span><br />
      <span class="post-time small text-muted">23rd September 2006 01:47 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Thanks for taking the time to reply.<br />
      <br />
      I must have used a script someone (a programmer) sent to me since I do not know how to write one. It would have been a 'cut &amp; paste' operation, which I don't recall. I've already mentioned my memory.<br />
      <br />
      Prior to posting my 'problem' I tried looking at the files in the Examples folder (and previous posts) and didn't see anything that I recognized as one that would work, but then I really didn't know what one would look like even if I found it. :)<br />
      <br />
      Unlike Confucious, I remember more of what I've heard and seen and not very much of what I've done.<br />
      <br />
      Rock on,</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
      <span class="post-time small text-muted">23rd September 2006 08:31 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">You could try using one of the script <a href="http://nsis.sourceforge.net/mediawiki/index.php?title=Special:Search&amp;ns0=1&amp;ns9=1&amp;ns11=1&amp;redirs=0&amp;searchx=1&amp;search=wizard&amp;limit=50&amp;offset=0" target="_blank">wizards available</a>. They'll create a script for you in no time using GUI alone.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">SCB</span><br />
      <span class="post-time small text-muted">23rd September 2006 17:48 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Thanks but that didn't work (for a number of reasons).<br />
      <br />
      Anyway, I 'found' a script that I could modify and use.<br />
      <br />
      It worked fine except for the section where one indicates the 'put icon on desktop' &lt;Section: "Desktop Shortcut"&gt;, which of course is the reason for this exercise. :)<br />
      <br />
      I have tried four or five different file names for the shortcut (pif) file and I always get this error message.<br />
      <br />
      Error in script "C:\Program Files\SCBSteganography\SteganoScriptFile.nsi" on line 46 -- aborting creation process<br />
      <br />
      Of course line 46 is -- File: "Steganography.pif"<br />
      <br />
      The "Steganography.pif" file is the Windows created shortcut for the program. It's in the folder with all the other files and it works as a shortcut.<br />
      <br />
      Suggestions?</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
      <span class="post-time small text-muted">23rd September 2006 22:52 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">The error itself is stated right above the line stating the error line. According to your post, the problem is that colon after File.<br />
      <br />
      But you shouldn't use File anyway for that. Use CreateShortcut.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">SCB</span><br />
      <span class="post-time small text-muted">24th September 2006 02:30 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">The good news - I changed it to<br />
      <br />
      ================================================<br />
      ; Optional section (can be disabled by the user)<br />
      Section "Desktop Shortcut"<br />
      <br />
      SetOutPath $DESKTOP<br />
      <br />
      CreateShortcut "Shortcut to Steganography.exe" "Steganography.exe"<br />
      ===================================================<br />
      <br />
      and it compiled without an error.<br />
      <br />
      Bad news - it doesn't put the Icon on the desktop when it performs the install (set-up). It puts the shortcut file (Shortcut to Steganography.exe) into the directory with all the other files.<br />
      <br />
      The good news - that shortcut works when you click on it from inside the directory (using Explore).<br />
      <br />
      I think I'm getting close. :)</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
      <span class="post-time small text-muted">24th September 2006 08:42 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Use:</p>
      <pre>
<code>CreateShortcut "$DESKTOP\Shortcut to Steganography.lnk" "Steganography.exe"</code>
</pre>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">SCB</span><br />
      <span class="post-time small text-muted">24th September 2006 18:45 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Hate to be a pain, but I pasted that line into my script file, compiled it (sucessfully) and it not only does not put a shortcut on the desktop, now it is not even creating a shortcut.<br />
      <br />
      It does create a Setup, that when executed offers two options, the second of which is Desktop Shortcut, with a block on the left that is checked. That was the case with my previous script.<br />
      <br />
      Any other suggestions?<br />
      <br />
      Here is my entire script -<br />
      <br />
      =======================================================<br />
      ; The name of the installer<br />
      Name "SecretCodeBreaker"<br />
      <br />
      ; The file to write<br />
      OutFile "Setup.exe"<br />
      <br />
      ; The default installation directory<br />
      InstallDir C:\SCBSteganography<br />
      <br />
      ;--------------------------------<br />
      <br />
      ; Pages<br />
      <br />
      Page components<br />
      Page directory<br />
      Page instfiles<br />
      <br />
      ;--------------------------------<br />
      <br />
      ; The stuff to install<br />
      Section "SecretCodeBreaker Files (required)"<br />
      <br />
      SectionIn RO<br />
      <br />
      ; Set output path to the installation directory.<br />
      SetOutPath $INSTDIR<br />
      <br />
      ; Put file there<br />
      File "Steganography.exe"<br />
      File "Instructions.txt"<br />
      File "Theory_of_Operation.txt"<br />
      File "Example.txt"<br />
      File "Example.bmp"<br />
      File "Exampleb.bmp"<br />
      File "Bitmap1.bmp"<br />
      File "SecretCodeBreaker.bmp"<br />
      File "Steganography.ico"<br />
      File "readme.txt"<br />
      <br />
      SectionEnd<br />
      <br />
      ; Optional section (can be disabled by the user)<br />
      Section "Desktop Shortcut"<br />
      <br />
      SetOutPath $DESKTOP<br />
      <br />
      CreateShortcut "$DESKTOP\Shortcut to Steganography.lnk" "Steganography.exe"<br />
      <br />
      SectionEnd<br />
      ======================================================</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Takhir</span><br />
      <span class="post-time small text-muted">24th September 2006 18:57 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">If exe file exists<br /></p>
      <pre>
<code>SetOutPath "$DESKTOP"<br />CreateShortcut "$DESKTOP\Shortcut to Steganography.lnk" "$INSTDIR\Steganography.exe"</code>
</pre>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">SCB</span><br />
      <span class="post-time small text-muted">24th September 2006 20:26 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Thank you very, very much for fixing my script so that it works!<br />
      <br />
      Works perfectly.<br />
      <br />
      If you are interested, as a token of my appreciation, I'll send you a URL that will give you a copy of the my first book in the Secret Code Breaker series (96 page PDF, plus a small zip of the program files).</p>
    </div>
    <hr />

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]>
  </script>
</body>
</html>
