<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="description" content="Locate plugin"><title>Locate plugin - NSIS Forums</title><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script><link rel="preload" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css" as="style" onload="this.rel='stylesheet'"><link rel="preload" href="../css/style.css" as="style" onload="this.rel='stylesheet'"><noscript><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css"><link rel="stylesheet" href="../css/style.css"></noscript><script>!function(a){"use strict";var b=function(b,c,d){function e(a){return h.body?a():void setTimeout(function(){e(a)})}function f(){i.addEventListener&&i.removeEventListener("load",f),i.media=d||"all"}var g,h=a.document,i=h.createElement("link");if(c)g=c;else{var j=(h.body||h.getElementsByTagName("head")[0]).childNodes;g=j[j.length-1]}var k=h.styleSheets;i.rel="stylesheet",i.href=b,i.media="only x",e(function(){g.parentNode.insertBefore(i,c?g:g.nextSibling)});var l=function(a){for(var b=i.href,c=k.length;c--;)if(k[c].href===b)return a();setTimeout(function(){l(a)})};return i.addEventListener&&i.addEventListener("load",f),i.onloadcssdefined=l,l(f),i};"undefined"!=typeof exports?exports.loadCSS=b:a.loadCSS=b}("undefined"!=typeof global?global:this);!function(a){if(a.loadCSS){var b=loadCSS.relpreload={};if(b.support=function(){try{return a.document.createElement("link").relList.supports("preload")}catch(b){return!1}},b.poly=function(){for(var b=a.document.getElementsByTagName("link"),c=0;c<b.length;c++){var d=b[c];"preload"===d.rel&&"style"===d.getAttribute("as")&&(a.loadCSS(d.href,d,d.getAttribute("media")),d.rel=null)}},!b.support()){b.poly();var c=a.setInterval(b.poly,300);a.addEventListener&&a.addEventListener("load",function(){b.poly(),a.clearInterval(c)}),a.attachEvent&&a.attachEvent("onload",function(){a.clearInterval(c)})}}}(this);</script></head><body><div class="container"><ol class="breadcrumb"><li><a href="../index.html" class="glyphicon glyphicon-home"></a></li><li><a href="f-65.html">NSIS Discussion</a></li><li class="active">Locate plugin</li></ol><p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=224837">Locate plugin</a></p><br><div class="post"><p class="post-meta"><span class="post-author text-primary">Instructor</span><br><span class="post-time small text-muted">30th August 2005 09:09 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>Locate plugin</strong><br><b>Features</b>:<br>1. Search for directories or empty directories and/or files<br>&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;-search with wildcard<br>&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;-search with extensions filter (include/exclude)<br>&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;-search with times filter<br>&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;-search with size filter<br>&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;-search with attributes filter<br>&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;-sort files and/or directories by name, type, size, date (with reverse or not)<br>&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;-output first files or directories<br>&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;-search with subdirectories or not<br>&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;-search with banner support<br>&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;-return path\name<br>&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;-return path<br>&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;-return name<br>&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;-return size of file<br>&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;-return date of file or directory<br>&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;-return attributes of file or directory<br>2. Find the size of a file, files wildcard or directory (locate::GetSize)<br>3. Find the sum of the files, directories and subdirectories (locate::GetSize)<br>4. Remove empty directories and/or subdirectories (locate::RMDirEmpty)<br><br>This plugin is the replacement for Locate and GetSize functions.<br><br><br>"<b>Locate</b>" plugin v1.0</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Instructor</span><br><span class="post-time small text-muted">17th September 2005 14:48 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><b>Changes</b>:<br>-Option /X and /-X - Separated by "|" instead of "," (locate::Open)<br>-New: option /P - Additional paths to "[Path]" (locate::Open)<br>-New: option /-PF - Don't locate in these paths (locate::Open)<br>-New: option /-PN - Don't locate in these directories (locate::Open)<br><br><br>"<b>Locate</b>" plugin v1.1</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Instructor</span><br><span class="post-time small text-muted">17th September 2005 19:23 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><b>Changes</b>:<br>-New: options /N and /-N - names filter (locate::Open)<br>-Readme improvement<br><br><br>"<b>Locate</b>" plugin v1.2</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">mgillespie</span><br><span class="post-time small text-muted">20th November 2005 14:57 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Does anyone have any example ModernUI code that uses this locate plugin?<br><br>I want to locate several files, and present the user with a way of selecing one of them.<br><br>How would I go about doing this?</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Instructor</span><br><span class="post-time small text-muted">21st November 2005 14:34 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Here you go. Script also using Takhir's <a href="http://nsis.sourceforge.net/wiki/Banner_with_Cancel_button" target="_blank">nxs plugin</a></p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">mgillespie</span><br><span class="post-time small text-muted">21st November 2005 19:00 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Perfect. Thanks.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Instructor</span><br><span class="post-time small text-muted">28th November 2005 14:08 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><b>Fixed</b>: Case sensitive sort of files and directories (if used sort by "NAME" or "TYPE"). Now case insensitive.<br><b>Fixed</b>: Accepted only uppercased sort type "NAME|TYPE|SIZE|DATE". Now case insensitive.<br><br><br>"<b>Locate</b>" plugin v1.3</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Instructor</span><br><span class="post-time small text-muted">14th December 2005 08:32 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><b>Fixed</b>: CRT function "tolower" in StrFunc.h didn't return correct national character. "tolower", ("islower", "setlocale" ...) replaced with "CharLower" (user32.dll).<br><br><br>"<b>Locate</b>" plugin v1.4</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Instructor</span><br><span class="post-time small text-muted">24th December 2005 22:21 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><b>Changed</b>: Now plugin is msvcrt.dll independed -&gt; work on Win95 (thanks <b>kichik</b>)<br><b>Updated</b>: "ConvFunc.h" to v1.3<br><br><br>"<b>Locate</b>" plugin v1.5</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Instructor</span><br><span class="post-time small text-muted">9th February 2006 11:06 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Changed: Removed option "/P=", now plugin can accept multi-path in first parameter<br>Updated: "ConvFunc.h" to v1.5<br>Updated: "StrFunc.h" to v1.6<br>Changed: Now plugin used header "Locate.nsh" for custom user variables and<br>&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;better compile errors check.<br><br><b>Update from previous versions:</b><br>&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;- Insert line in script:<br>&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;!include "Locate.nsh"<br>&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;- Replace:<br>&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;locate::Open -&gt; ${locate::Open} ...<br>&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;- Replace:<br>&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;.r0 -&gt; $0, .r1 -&gt; $1 ... .R0 -&gt; $R0, .R1 -&gt; $R1 ...<br><br>"<b>Locate</b>" plugin v1.6</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Instructor</span><br><span class="post-time small text-muted">27th May 2006 11:38 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><b>Fixed:</b> ignore files/directories names which began with "."<br><b>Fixed:</b> error, if file had more then 16 characters extension<br><b>Fixed:</b> "/SF=DATE" &lt;=&gt; "/-SF=DATE"<br><b>Updated:</b> "StrFunc.h" to v1.7<br><b>Updated:</b> "StackFunc.h" to v1.9<br><b>Updated:</b> "ConvFunc.h" to v1.7<br><b>Changed:</b> Now if files has same date or size they sorted by name<br><b>Added:</b> handles for search<br><br>"<b>Locate</b>" plugin v1.7</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">rxs2k5</span><br><span class="post-time small text-muted">28th May 2006 09:58 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Hi instructor,<br><br>How do I use this syntax<br><br>${locate::Find} "[handle]" $var1 $var2 $var3 $var4 $var5 $var6<br><br>1. I need to find the directory or file exist in C:\Program Files\<br>2. I need it to change the InstallDIR or setoutpath to the found dir or file in it.<br><br>could u create a function for me to perform the task.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Instructor</span><br><span class="post-time small text-muted">1st June 2007 14:25 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><b>Fixed:</b> locate::Open failed to open paths ended with backslash<br><b>Updated:</b> "StrFunc.h" to v1.9<br><b>Updated:</b> "StackFunc.h" to v2.0<br><b>Updated:</b> "ConvFunc.h" to v2.0<br><br><br>"<b>Locate</b>" plugin v1.8</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">zeeh3</span><br><span class="post-time small text-muted">2nd March 2010 00:39 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Hi, many of our users are having problems when NSIS uses locate plugin inside windows 7, mainly because msvcr71.dll is natively missing. Can this be fixed (removing this dependency)? Thanks.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Instructor</span><br><span class="post-time small text-muted">2nd March 2010 12:41 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><b>zeeh3</b><br>You are using self-rebuilded dll? You can check with "Dependency Walker" that plugin linked only to kernel32.dll and user32.dll.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">zeeh3</span><br><span class="post-time small text-muted">2nd March 2010 16:25 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Sorry, there was a mistake... my bad :)</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">ivansobaka</span><br><span class="post-time small text-muted">27th May 2010 12:34 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Hi dear Instructor.<br>I have a problem during using 'locate' with Windows7 32bit<br><br>My code is following:<br>${locate::Open} "$0" "/F=0 /G=0" $0<br>StrCmp $0 0 0 loop<br>MessageBox MB_OK "error" IDOK close<br><br>loop:<br>${locate::Find} $0 $1 $2 $3 $4 $5 $6<br>StrCmp $1 "" close 0<br><br>IfFileExists "$1\setup.exe" 0 loop<br>IfFileExists "$1\config.ini" 0 loop<br>; do smth<br>goto loop<br><br>close:<br>${locate::Close} $0 ; at this point application going to hang up<br>${locate::Unload}</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">dean.g</span><br><span class="post-time small text-muted">11th June 2010 16:24 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>endless loop</strong><br>Hi Instructor,<br><br>I am attempting to cycle through all subdirectories in My Documents. I have hidden directories, the first one Locate comes across is "$AVG" (hidden, readonly). This subdirectory has one subdirectory ($AVG/$CHJW) which contains four files (acgch??.dat).<br><br>Following is my open command:<br>${locate::Open} "$DOCUMENTS" "/F=1 /D=0 /M=*-temp-*.ppp|*Recovered*.ppp /A=-HIDDEN /B=1" $0<br><br>The find command seems to find an "endless" number of empty paths\files in the $AVG/$CHJW directory. Adding /-PN=$$AVG stops this behavour but I need this script to run on anyones computer.<br><br>Any assistance appreciated!</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Instructor</span><br><span class="post-time small text-muted">14th June 2010 11:20 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><b>ivansobaka</b><br>Make sure you don't change $0 variable in "; do smth"<br><br><b>dean.g</b><br>I'm out of the active NSIS developing, but you can pack this folder and send me on email I will try to reproduce the bug.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">ivansobaka</span><br><span class="post-time small text-muted">14th June 2010 13:03 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">I dont use $0 variable in "; do smth"<br>But I've changed following string<br><br>${locate::Close} $0<br><br>to<br><br>${locate::Close} $R1<br><br>Now it works right,<br>thank you very much</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">dean.g</span><br><span class="post-time small text-muted">14th June 2010 14:39 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>loop</strong><br>Hi Instructor,<br><br>If you need more information please let me know.<br><br>Cheers!<br>Dean</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">dean.g</span><br><span class="post-time small text-muted">14th June 2010 14:45 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>loop</strong><br>Hi Instructor,<br><br>Please find attached.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Instructor</span><br><span class="post-time small text-muted">14th June 2010 20:29 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">I'm unable to open .odt files. Lets go the other way. Try to locate in "$CHJW"<br></p><pre>
<code>${locate::Open} "$DOCUMENTS\....\$$CHJW" </code>
</pre>If it hang, try to remove by one file. If it not hang try to locate in "$AVG"<br><pre>
<code>${locate::Open} "$DOCUMENTS\....\$$AVG" </code>
</pre>It simply can be file system error, like bad clusters on HDD etc.</div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">dean.g</span><br><span class="post-time small text-muted">14th June 2010 21:15 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>loop</strong><br>Hi Instructor,<br><br>Here is contents of .odt file (open office text file). I was just showing you the directory structor.<br><br>Cheers!</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Instructor</span><br><span class="post-time small text-muted">11th October 2011 13:38 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><b>Added</b>: full unicode support on NSIS Unicode.<br><br><a href="http://nsis.sourceforge.net/Locate_plugin" target="_blank"><b>Locate</b> plugin v2.0</a></p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">mlf176f2</span><br><span class="post-time small text-muted">26th October 2011 23:11 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>Doesn't Locate All Files</strong><br>For some reason this plugin cannot locate files such as<br><br>c:\.Rhistory<br><br>Is there some work-around?</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Instructor</span><br><span class="post-time small text-muted">31st October 2011 15:00 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><b>mlf176f2</b><br>Is not reproduced.<br><br></p><pre>
<code>FILE:"c:\IO.SYS" [110080 b] [Created: 08.06.2000 17:00:00] [-a--]<br>FILE:"c:\.Rhistory" [0 b] [Created: 31.10.2011 19:57:00] [-a--]<br>FILE:"c:\ntldr" [251152 b] [Created: 13.04.2008 18:02:06] [rahs]</code>
</pre>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">tinflute</span><br>
      <span class="post-time small text-muted">3rd May 2012 20:15 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>Locate crashes</strong><br>
      My installer crashes when I run locate. It always crashes when it hits a particular folder (c:\Program Files (x86)\Oracle\). Runniny on windows 7.<br>
      <br></p>
      <pre>
<code>${locate::Open} "C:\" `/F=1 /D=0 /X=exe /-PN="Oracle" /-PF="$WINDIR\System|$WINDIR\System32|$WINDIR\Help" /N=pg_dump.exe /B=1` $0<br>${locate::Find} $0 $1 $2 $3 $4 $5 $6<br>StrCpy $backup $0<br></code>
</pre>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br>
      <span class="post-time small text-muted">3rd May 2012 21:34 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">If it is reproducible how about running it through a debugger. If you are up for installing Visual Studio 2010 Express and the Windows 7 SDK then I will explain how.<br>
      <br>
      Stu</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">tinflute</span><br>
      <span class="post-time small text-muted">4th May 2012 14:59 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">ok thanks. i'll get back to you if i get that installed.<br>
      i'm looking at an another approach looking up exe path through the registry.</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">karlos34</span><br>
      <span class="post-time small text-muted">15th November 2013 12:16 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Hi,<br>
      I have some troubles with ${locate::Open}. I use parametr /-PF=${UpgradeExcludeDirectories} to excluding but my string of excluded files is too long and has been truncated.<br>
      I found two possible reasons:<br>
      1, I found magic constant :) in source code NSIS_MAX_STRLEN. Can you create bigger buffer please?<br>
      2, add parameter which will be able to define excluded files as relative path<br>
      Have you any idea or is exist any way how can i use relative paths for excluded files?<br>
      <br>
      Many thanks guys</p>
    </div>
    <hr>

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]></script></body></html>