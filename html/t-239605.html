<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="description" content="Remove Program Files ShortCut"><title>Remove Program Files ShortCut - NSIS Forums</title><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script><link rel="preload" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css" as="style" onload="this.rel='stylesheet'"><link rel="preload" href="../css/style.css" as="style" onload="this.rel='stylesheet'"><noscript><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css"><link rel="stylesheet" href="../css/style.css"></noscript><script>!function(a){"use strict";var b=function(b,c,d){function e(a){return h.body?a():void setTimeout(function(){e(a)})}function f(){i.addEventListener&&i.removeEventListener("load",f),i.media=d||"all"}var g,h=a.document,i=h.createElement("link");if(c)g=c;else{var j=(h.body||h.getElementsByTagName("head")[0]).childNodes;g=j[j.length-1]}var k=h.styleSheets;i.rel="stylesheet",i.href=b,i.media="only x",e(function(){g.parentNode.insertBefore(i,c?g:g.nextSibling)});var l=function(a){for(var b=i.href,c=k.length;c--;)if(k[c].href===b)return a();setTimeout(function(){l(a)})};return i.addEventListener&&i.addEventListener("load",f),i.onloadcssdefined=l,l(f),i};"undefined"!=typeof exports?exports.loadCSS=b:a.loadCSS=b}("undefined"!=typeof global?global:this);!function(a){if(a.loadCSS){var b=loadCSS.relpreload={};if(b.support=function(){try{return a.document.createElement("link").relList.supports("preload")}catch(b){return!1}},b.poly=function(){for(var b=a.document.getElementsByTagName("link"),c=0;c<b.length;c++){var d=b[c];"preload"===d.rel&&"style"===d.getAttribute("as")&&(a.loadCSS(d.href,d,d.getAttribute("media")),d.rel=null)}},!b.support()){b.poly();var c=a.setInterval(b.poly,300);a.addEventListener&&a.addEventListener("load",function(){b.poly(),a.clearInterval(c)}),a.attachEvent&&a.attachEvent("onload",function(){a.clearInterval(c)})}}}(this);</script></head><body><div class="container"><ol class="breadcrumb"><li><a href="../index.html" class="glyphicon glyphicon-home"></a></li><li><a href="f-65.html">NSIS Discussion</a></li><li class="active">Remove Program Files ShortCut</li></ol><p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=239605">Remove Program Files ShortCut</a></p><br><div class="post"><p class="post-meta"><span class="post-author text-primary">stonkers</span><br><span class="post-time small text-muted">1st March 2006 17:33 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>Remove Program Files ShortCut</strong><br>I'm having problems removing my Program Files shortcut. Here's the add, and then the remove (add in the install section and remove in the uninstall section):<br><br>&lt;!--Add Routine--&gt;<br>; put the app in the program files menu<br>CreateDirectory "$SMPROGRAMS\myApp" ;Put a folder in the program files menu<br>CreateShortCut "$SMPROGRAMS\myApp\myApp.lnk" "$INSTDIR\myApp.exe" "$INSTDIR\myApp.ICO"<br><br><br>&lt;!--Remove Routine--&gt;<br>;Delete from program files menu<br>Delete "$SMPROGRAMS\myApp\myApp.lnk" ;Remove shortcut<br>RMDIR "$SMPROGRAMS\myApp" ;Remove folder in the program files menu<br><br>&lt;!--End Code Snippets--&gt;<br><br>Also, my icon doesn't show up. Is there a icon size restriction (mine is 48x48px)?<br><br>Thanks Much!<br>Eric</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Comperio</span><br><span class="post-time small text-muted">1st March 2006 18:01 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">During remove, are you using the right shell variable context?<br><br>Try using <font color="blue">SetShellVarContext</font> just before you delete. (I'm not sure if you need to be in the user's start menu or the 'all users' start menu. Whichever it is, you can set appropriately for what you need.)<br><br>As far as the icon, are you talking about the install icon, uninstall icon, or both? from the help files:<br></p><blockquote>...Note that if you use an uninstaller, each icon in the icon file must have the same size and color depth as its matching icon in the uninstaller icon file...</blockquote></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">stonkers</span><br><span class="post-time small text-muted">1st March 2006 18:07 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Thanks Comperio, I'll give that a shot.<br><br>The icon I'm talking about is the icon for the shortcut. If I use the icon for the shortcut on the desktop, it works fine, but not in the program files group. It just ends up being an empty box looking thing. I'm guessing the big icon (48x48) is too big for the menu.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Comperio</span><br><span class="post-time small text-muted">1st March 2006 18:18 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">hmm... Could be right. That or you just need to refresh explorer.<br><br>See if you can assign the same icon manually in explorer. If that works, then it's probably the latter.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">stonkers</span><br><span class="post-time small text-muted">1st March 2006 18:19 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">That seems to have been the trick Comperio, thanks!!! One last question.<br><br>In the doc for CreateShortcut, it just says "some command line parameters". I'm looking to set the "Comment" for the shortcut (this is displayed when the mouse is over the icon). Any help?<br><br>Thanks,<br>Eric</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Comperio</span><br><span class="post-time small text-muted">1st March 2006 18:35 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">command line parameters are for command line switches on the EXE. (not what you're looking for.)<br><br>What you need is the 'description' parameter (last parameter).<br><br>example:<br>CreateShortCut "shortcut.lnk" "C:\windows\notepad" "" "" "" SW_SHOWNORMAL "" <font color="blue">"Comment here"</font></p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">stonkers</span><br><span class="post-time small text-muted">1st March 2006 19:02 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Thanks Comperio, All Good!!!</p></div><hr><div class="footer"><p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p></div></div><script src="../js/highlight.pack.js" type="text/javascript"></script><script type="text/javascript">//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]></script></body></html>