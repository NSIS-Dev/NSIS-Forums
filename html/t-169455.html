<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="Changing Images using Install Options" />

  <title>Changing Images using Install Options - NSIS Forums</title>
  <script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script>
  <!-- Bootstrap core CSS -->

  <link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css" />
  <link rel="stylesheet" href="../css/style.css" type="text/css" /><!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!--[if lt IE 9]>
                <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
                <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->
</head>

<body>
  <div class="container">
    <!-- Put navigation bar here -->

    <ol class="breadcrumb">
      <li><a href="../index.html" class="glyphicon glyphicon-home"></a></li>

      <li><a href="f-65.html">NSIS Discussion</a></li>

      <li class="active">Changing Images using Install Options</li>
    </ol>

    <p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=169455">Changing Images using Install Options</a></p><br />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">deguix</span><br />
      <span class="post-time small text-muted">15th February 2004 15:05 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>Install Options Run-Time</strong><br />
      How can I change an image of an image control (the images are the same size) in an Install Options page after selecting a radiobutton with NOTIFY flag? (means in run-time)</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Joost Verburg</span><br />
      <span class="post-time small text-muted">15th February 2004 15:19 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">This page shows you how to use the APIs you need:<br />
      <br />
      <a href="http://nsis.sourceforge.net/archive/viewpage.php?pageid=405" target="_blank">http://nsis.sourceforge.net/archive/...php?pageid=405</a></p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">deguix</span><br />
      <span class="post-time small text-muted">15th February 2004 15:29 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">I'll test that. And just another question, how I can check/uncheck checkboxes in run-time using Install Options?</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Joost Verburg</span><br />
      <span class="post-time small text-muted">15th February 2004 15:30 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">By sending a window message. You can find a reference of all messages in the MSDN library.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">deguix</span><br />
      <span class="post-time small text-muted">15th February 2004 16:05 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">I tried the code but it didn't work (EDIT: The object is not deleted, so continue the same):<br />
      <br /></p>
      <pre>
<code>    System::Call "${sysDeleteObject} (R1) .R2"<br />    MessageBox MB_OK $R2<br />    System::Call '${sysLoadImage} (0, s, ${IMAGE_BITMAP}, 0, 0, ${LR_CREATEDIBSECTION}|${LR_LOADFROMFILE}) .R1' "$0\$1.bmp"<br />    SendMessage $0 ${STM_SETIMAGE} ${IMAGE_BITMAP} $R1</code>
</pre><br />
      <br />
      The MessageBox should show a non-zero result as MSDN says, but I put the right image handle, field 16 (before have only labels, textboxes, checkboxes and groupboxes):<br />
      <br />
      <pre>
<code>[Field 16]<br />Type=Bitmap<br />Text=C:\Games\C-evo\HAL.bmp<br />State="C:\Games\C-evo\HAL.bmp"<br />Left=257<br />Right=300<br />Top=3<br />Bottom=43</code>
</pre><br />
      <br />
      What is wrong?
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Joost Verburg</span><br />
      <span class="post-time small text-muted">15th February 2004 16:12 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Why are you deleting an object before loading the image?<br />
      <br />
      Did you detect the inner window field hwnd correctly (as described in the IO documentation)?<br />
      <br />
      Is that bitmap path correct? Does it return a valid bitmap handle?</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">deguix</span><br />
      <span class="post-time small text-muted">15th February 2004 16:17 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">I fixed it. YEAH, it's working!</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">deguix</span><br />
      <span class="post-time small text-muted">15th February 2004 16:30 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">About the checkbox thing, I know that is BM_SETCHECK, but I don't know its number value. Where I can find it?</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Joost Verburg</span><br />
      <span class="post-time small text-muted">15th February 2004 16:36 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">The value is:<br />
      <br />
      0xF1</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">deguix</span><br />
      <span class="post-time small text-muted">15th February 2004 16:55 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Oh yeah! It works too. If someone wants the code, it is right here:<br />
      <br /></p>
      <pre>
<code>!define BM_SETCHECK 0x00F1 # Message<br /><br />  !define BST_UNCHECKED 0x0000<br />  !define BST_CHECKED 0x0001<br />  !define BST_INDETERMINATE 0x0002<br /><br />  SendMessage $0 ${BM_SETCHECK} ${BST_CHECKED} ""<br /><br />  # Replace ${BST_CHECKED} with one of those "BST_" you want (uncheck, check or gray/check).</code>
</pre><br />
      <br />
      Thanks Joost. NSIS is really the best. :up:
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">deguix</span><br />
      <span class="post-time small text-muted">16th February 2004 13:15 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">The StrCtlColors command supports variable for input? I'm having problems using this command.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Joost Verburg</span><br />
      <span class="post-time small text-muted">16th February 2004 18:55 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">It does not take variables, you should add two commands and run one of them.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">deguix</span><br />
      <span class="post-time small text-muted">17th February 2004 01:06 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Are you planning to add this "variable support" to StrCtlColors soon? If not that soon, have another way to paint controls without StrCtlColors?</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Joost Verburg</span><br />
      <span class="post-time small text-muted">17th February 2004 13:45 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Why do you need variable support? Use StrCmp to check the value of a variable and then run the SetCtlColors commands you need.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">deguix</span><br />
      <span class="post-time small text-muted">18th February 2004 11:43 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Because it depends from the user input from InstallOptions, if I do this the program script size will be gigantic.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Joost Verburg</span><br />
      <span class="post-time small text-muted">18th February 2004 14:00 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">So you want to use to be able to choose every possible color for your installer dialog? That's not currently possible.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">deguix</span><br />
      <span class="post-time small text-muted">18th February 2004 14:15 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Is why that question:<br />
      <br /></p>

      <blockquote>
        Are you planning to add this "variable support" to StrCtlColors soon? If not that soon, have another way to paint controls without StrCtlColors?
      </blockquote>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Joost Verburg</span><br />
      <span class="post-time small text-muted">18th February 2004 17:02 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">You can sumbit a feature request at the project page. There is no other way to set a color.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Comm@nder21</span><br />
      <span class="post-time small text-muted">5th March 2004 17:16 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">the "!define BM_SETCHECK 0x00F1" is mentioned at this thread.<br />
      could that be included in the winmessages.nsh, or isn't that a winmessage?</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Joost Verburg</span><br />
      <span class="post-time small text-muted">5th March 2004 21:19 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Currently WinMessages.nsi only contains the generic window messages, not the messages for all user interface controls.<br />
      <br />
      If anyone wants to extend this header file that would be nice :)</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Comm@nder21</span><br />
      <span class="post-time small text-muted">5th March 2004 22:52 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">i'd do it, but i don't know the messages. :)</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">deguix</span><br />
      <span class="post-time small text-muted">6th March 2004 00:17 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">I was thinking this entire week about that. Including some API's commonly used too.<br />
      <br />
      I've got the SDK and .NET SDK to use "cl.exe" compiler, but I have some problems when compiling NSIS; it gives me errors like files missing from NSIS Source:<br />
      <br />
      "NSIS\Source\exehead\Release-zlib\icon.h"<br />
      <br />
      Is it my problem or NSIS Source problem?<br />
      <br />
      (Target file: "NSIS\Source\exedata.cpp")</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
      <span class="post-time small text-muted">6th March 2004 10:33 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">It means that you didn't compile the exehead project. But what does this have to do with the messages header file?</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">deguix</span><br />
      <span class="post-time small text-muted">7th March 2004 10:59 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">It's my lazyness to post new threads... If want you can move my post to a new thread. (I'll post the file in the next post)</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">deguix</span><br />
      <span class="post-time small text-muted">7th March 2004 11:13 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">I did the work for yesterday's entire morning to include all messages, styles... (defines) in just one file.<br />
      <br />
      To this work, delete all defines in your script for APIs messages (not the APIs themselves!) and include this powerful file.<br />
      <br />
      (just some defines which are the combination of other ones I don't know really how to calculate, and some others those have "L" at end of the number which I don't know what it means)<br />
      <br />
      The file is too big I had to upload it in my site (Size: 105kb):<br />
      <br />
      <a href="http://www.geocities.com/civ_deguix/files/WinMessages.nsh.txt" target="_blank">WinMessages.nsh.txt</a></p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Joost Verburg</span><br />
      <span class="post-time small text-muted">7th March 2004 12:43 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">L means that it is a long number. NSIS won't do anything with it, so it should be removed.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">deguix</span><br />
      <span class="post-time small text-muted">7th March 2004 13:32 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">But when calling System plugin it does:<br />
      <br /></p>
      <pre>
<code>!define HKEY_LOCAL_MACHINE 0x80000002<br /><br />System::Call "Advapi32::RegCreateKeyA(l ${ROOT_KEY}, t 'Software/Test', i.r0) i.r1"</code>
</pre>$1 = 0, means it passed. But replacing "l" with "i" gives error.<br />
      <br />
      The original number was "(( HKEY ) (ULONG_PTR)((LONG)0x80000002) )"<br />
      <br />
      So should be a warning for who uses System plugin.
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Joost Verburg</span><br />
      <span class="post-time small text-muted">7th March 2004 13:42 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Indeed, but the constant itself should not contain a L.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">deguix</span><br />
      <span class="post-time small text-muted">7th March 2004 13:43 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Yep, I'll comment those "L", so they will know about that.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">deguix</span><br />
      <span class="post-time small text-muted">7th March 2004 14:27 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">OK, updated with L's commented, fixed some calculations (combinations with ORs and ANDs) and added Basic Registry (just those ones someone is talking about in another thread). I'll include more tomorrow.<br />
      <br />
      <a href="http://www.geocities.com/civ_deguix/files/WinMessages.nsh.txt" target="_blank">WinMessages.nsh.txt</a> (Size: 109kb)</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Joost Verburg</span><br />
      <span class="post-time small text-muted">7th March 2004 14:47 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Can you split it up in multiple header files?</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">deguix</span><br />
      <span class="post-time small text-muted">8th March 2004 03:06 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">All those were inside WinUser.h, this one is the biggest file of defines on the SDK (I think).<br />
      <br />
      Yes, I can. But by what way do you suggest? I'm putting even more defines from other SDK files now (separated by comments of each file name included)...</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Joost Verburg</span><br />
      <span class="post-time small text-muted">8th March 2004 12:26 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Using such huge files will slow down compilation. It's better to split it up and let people choose.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">deguix</span><br />
      <span class="post-time small text-muted">8th March 2004 22:25 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">I was thinking this way, as every define is from a group of defines, to organize them as they were organizated, like:<br />
      <br />
      All "HKEY_*" defines will be in one group called HKEY.<br />
      All "WM_*" defines will be in one group called WM.<br />
      <br />
      So the compilation will be not so big as before, and you'll use those really you want.<br />
      <br />
      What do you think about this?</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Joost Verburg</span><br />
      <span class="post-time small text-muted">9th March 2004 13:41 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Please test how long it takes to include the files or groups.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">deguix</span><br />
      <span class="post-time small text-muted">9th March 2004 21:36 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">My computer is too fast it compiles the Modern UI examples (for example) in less than 1 second. Including with this huge file. But I didn't finished my work here, I need to add more define, however I didn't split it up yet. I'm working on several things at the same time so don't expect this done to today, nor tomorrow...</p>
    </div>
    <hr />

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]>
  </script>
</body>
</html>
