<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="NSIS for VS.Net 05 and 03" />

  <title>NSIS for VS.Net 05 and 03 - NSIS Forums</title><!-- Bootstrap core CSS -->
  <link rel="stylesheet" type="text/css" href="//netdna.bootstrapcdn.com/bootswatch/3.0.1/readable/bootstrap.min.css" />
  <link rel="stylesheet" href="../css/style.css" type="text/css" /><!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!--[if lt IE 9]>
                <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
                <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->
</head>

<body>
  <div class="container">
    <!-- Put navigation bar here -->

    <ol class="breadcrumb">
      <li><a href="../index.html" class="glyphicon glyphicon-home"></a></li>

      <li><a href="f-65.html">NSIS Discussion</a></li>

      <li class="active">NSIS for VS.Net 05 and 03</li>
    </ol>

    <p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=291420">NSIS for VS.Net 05 and 03</a></p><br />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">DocNard</span><br />
      <span class="post-time small text-muted">7th May 2008 16:38 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>NSIS for VS.Net 05 and 03</strong><br />
      I am currently using .nsi files to build an executable, which contains an .exe and some dlls. (header)<br />
      <br />
      ; NULLsoft Scriptable Install System<br />
      ; make a single file to run<br />
      ; software. Goal is to copy files to<br />
      ; the temp directory, run them, then<br />
      ; clean up completely afterward.<br />
      <br />
      When i us the script for vs03, the .exe created executes perfectly. However, with vs05, the .exe created SUCKS!! The files are unpacked, but immediatley removed from the $Temp.<br />
      <br />
      How do i use this with vs05.<br />
      <br />
      Script in .nsi----<br />
      <br />
      ; NULLsoft Scriptable Install System<br />
      ; make a single file to run<br />
      ; software. Goal is to copy files to<br />
      ; the temp directory, run them, then<br />
      ; clean up completely afterward.<br />
      <br />
      ; use LZMA Solid compression<br />
      SetCompressor /solid lzma<br />
      <br />
      ; name of the installer (doesn't matter/never seen)<br />
      Name "AQS"<br />
      <br />
      ; hide nsis windows<br />
      SilentInstall silent<br />
      <br />
      ; set icon file<br />
      Icon "P:\AQS Projects\@QS Packages\AQS_auto.ico"<br />
      <br />
      ; set a name for the resulting executable<br />
      OutFile "WinFrameTest.exe"<br />
      <br />
      ; the installation directory<br />
      InstallDir "$TEMP\WinFrameTest"<br />
      <br />
      ; copy, run, delete<br />
      Section ""<br />
      <br />
      ; set output path to the installation directory.<br />
      SetOutPath "$INSTDIR"<br />
      <br />
      ; files to unpack<br />
      File "winTestbasic.exe" ; executable<br />
      File "IsummonYou.dll" ; required dll<br />
      File "IsummonMe.dll" ; required dll<br />
      <br />
      ; execute and wait for program to be closed<br />
      ExecWait '"$INSTDIR\WinFrameTest.exe"'<br />
      <br />
      ; change output path so we can delete folder and not just contents<br />
      SetOutPath "$TEMP"<br />
      <br />
      ; Delete unpacked files from hard drive<br />
      RMDir /r "$INSTDIR"<br />
      SectionEnd</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">AaronLS</span><br />
      <span class="post-time small text-muted">7th May 2008 21:42 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">What do you mean by "Use the script for vs03". Do you mean the exe's and dll's were recompiled with VS05? If so, there may be additional dependencies such as DLLs or .NET 2.0 that are not on the machine your are installing on.<br />
      <br />
      To troubleshoot and find the cause I would first comment out the RMDir command so that the installer will leave the files, and then after you install the files will be left where they are and you can then manually execute the *.exe from it's location in the temp dir to see why it might be failing. (I would add a DetailPrint statement in the section that prints out the OUTDIR so you know which temp file location to look in.<br />
      <br />
      I suspect that this is happening:<br />
      1) ExecWait runs your exe<br />
      2) your EXE is throwing an exception or failing in some way<br />
      3) NSI script execution then continues to the RMDir command and deletes the files.<br />
      <br />
      This would cause it to appear that your EXE is not running and the files being deleted immediately.<br />
      <br />
      You could also clear errors before ExecWait and then check for errors afterwards.<br />
      <br />
      Good luck.</p>
    </div>
    <hr />

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]>
  </script>
</body>
</html>
