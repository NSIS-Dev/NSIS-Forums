<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="launch on start up" />

  <title>launch on start up - NSIS Forums</title>
  <script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script>
  <!-- Bootstrap core CSS -->

  <link rel="stylesheet" type="text/css" href="//netdna.bootstrapcdn.com/bootswatch/3.0.1/readable/bootstrap.min.css" />
  <link rel="stylesheet" href="../css/style.css" type="text/css" /><!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!--[if lt IE 9]>
                <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
                <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->
</head>

<body>
  <div class="container">
    <!-- Put navigation bar here -->

    <ol class="breadcrumb">
      <li><a href="../index.html" class="glyphicon glyphicon-home"></a></li>

      <li><a href="f-65.html">NSIS Discussion</a></li>

      <li class="active">launch on start up</li>
    </ol>

    <p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=143474">launch on start up</a></p><br />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">mikemanczur</span><br />
      <span class="post-time small text-muted">24th July 2003 23:01 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>launch on start up</strong><br />
      I amusing the modern UI. How do I add the application to launch at start up. I can not find any examples with the modern UI. Please help. Thanks in advance.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
      <span class="post-time small text-muted">24th July 2003 23:23 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">You mean Windows start up?<br />
      Just place a shortcut to your EXE in the Startup folder in the Windows Start menu &gt; Programs &gt; Startup like so.<br />
      <br />
      Path to it would be:<br />
      "$SMPROGRAMS\Startup"<br />
      <br />
      -Stu</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">mikemanczur</span><br />
      <span class="post-time small text-muted">24th July 2003 23:34 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>let me make sure</strong><br />
      What I want is (on Windows) when the user shuts down or restarts their machine, for the apoplication to start as well. Can you give me the code and place I put it in? I assume I have to put it in the unistaller as well. Here is my code. Thank you.<br />
      <br />
      ; -------------------------------<br />
      ; Start<br />
      <br />
      <br />
      !define MUI_PRODUCT "Alarm Clock"<br />
      !define MUI_FILE "clock"<br />
      !define MUI_VERSION "1.0"<br />
      !define MUI_BRANDINGTEXT "Alarm Clock"<br />
      CRCCheck On<br />
      <br />
      <br />
      !include "${NSISDIR}\Contrib\Modern UI\System.nsh"<br />
      <br />
      ;!define TEMP $R0<br />
      <br />
      <br />
      ;--------------------------------<br />
      ;General<br />
      <br />
      OutFile "Alarm.exe"<br />
      ShowInstDetails "nevershow"<br />
      ShowUninstDetails "nevershow"<br />
      SetCompressor "bzip2"<br />
      <br />
      !define MUI_ICON "pepper.ico"<br />
      !define MUI_UNICON "noPepper3.ico"<br />
      !define MUI_SPECIALBITMAP "alarm.bmp"<br />
      <br />
      <br />
      ;--------------------------------<br />
      ;Folder selection page<br />
      <br />
      InstallDir "$PROGRAMFILES\${MUI_PRODUCT}"<br />
      <br />
      <br />
      ;--------------------------------<br />
      ;Modern UI Configuration<br />
      <br />
      ;!define MUI_CUSTOMPAGECOMMANDS<br />
      !define MUI_WELCOMEPAGE<br />
      !define MUI_LICENSEPAGE<br />
      !define MUI_DIRECTORYPAGE<br />
      !define MUI_ABORTWARNING<br />
      !define MUI_UNINSTALLER<br />
      !define MUI_UNCONFIRMPAGE<br />
      !define MUI_FINISHPAGE<br />
      <br />
      ;--------------------------------<br />
      ;Pages<br />
      <br />
      ;!insertmacro MUI_PAGECOMMAND_WELCOME<br />
      ;Page custom IsFlashInstalled<br />
      ;!insertmacro MUI_PAGECOMMAND_LICENSE<br />
      ;!insertmacro MUI_PAGECOMMAND_DIRECTORY<br />
      ;!insertmacro MUI_PAGECOMMAND_INSTFILES<br />
      <br />
      ;--------------------------------<br />
      ;Language<br />
      <br />
      !insertmacro MUI_LANGUAGE "English"<br />
      <br />
      ;--------------------------------<br />
      ;Language Strings<br />
      <br />
      ;Header<br />
      ;LangString TEXT_IO_TITLE ${LANG_ENGLISH} "InstallOptions Page"<br />
      ;LangString TEXT_IO_SUBTITLE ${LANG_ENGLISH} "Create your own dialog!"<br />
      <br />
      <br />
      ;--------------------------------<br />
      ;Data<br />
      <br />
      LicenseData "Readme.txt"<br />
      <br />
      ;--------------------------------<br />
      ;Reserve Files<br />
      <br />
      ;Things that need to be extracted on first (keep these lines before any File command!)<br />
      ;Only useful for BZIP2 compression<br />
      <br />
      ;ReserveFile "checkFlash.ini"<br />
      ;!insertmacro MUI_RESERVEFILE_INSTALLOPTIONS<br />
      <br />
      ;--------------------------------<br />
      ;Installer Sections<br />
      Section "install" Installation info<br />
      <br />
      ;Add files<br />
      SetOutPath "$INSTDIR"<br />
      <br />
      File "${MUI_FILE}.exe"<br />
      File "Readme.txt"<br />
      <br />
      ;create desktop shortcut<br />
      CreateShortCut "$DESKTOP\${MUI_PRODUCT}.lnk" "$INSTDIR\${MUI_FILE}.exe" ""<br />
      <br />
      ;create start-menu items<br />
      CreateDirectory "$SMPROGRAMS\${MUI_PRODUCT}"<br />
      CreateShortCut "$SMPROGRAMS\${MUI_PRODUCT}\Uninstall.lnk" "$INSTDIR\Uninstall.exe" "" "$INSTDIR\Uninstall.exe" 0<br />
      CreateShortCut "$SMPROGRAMS\${MUI_PRODUCT}\${MUI_PRODUCT}.lnk" "$INSTDIR\${MUI_FILE}.exe" "" "$INSTDIR\${MUI_FILE}.exe" 0<br />
      <br />
      ;write uninstall information to the registry<br />
      WriteRegStr HKLM "Software\Microsoft\Windows\CurrentVersion\Uninstall\${MUI_PRODUCT}" "DisplayName" "${MUI_PRODUCT} (remove only)"<br />
      WriteRegStr HKLM "Software\Microsoft\Windows\CurrentVersion\Uninstall\${MUI_PRODUCT}" "UninstallString" "$INSTDIR\Uninstall.exe"<br />
      <br />
      WriteUninstaller "$INSTDIR\Uninstall.exe"<br />
      <br />
      SectionEnd<br />
      <br />
      <br />
      ;--------------------------------<br />
      ;Uninstaller Section<br />
      Section "Uninstall"<br />
      <br />
      ;Delete Files<br />
      RMDir /r "$INSTDIR\*.*"<br />
      <br />
      ;Remove the installation directory<br />
      RMDir "$INSTDIR"<br />
      <br />
      ;Delete Start Menu Shortcuts<br />
      Delete "$DESKTOP\${MUI_PRODUCT}.lnk"<br />
      Delete "$SMPROGRAMS\${MUI_PRODUCT}\*.*"<br />
      RmDir "$SMPROGRAMS\${MUI_PRODUCT}"<br />
      <br />
      ;Delete Uninstaller And Unistall Registry Entries<br />
      DeleteRegKey HKEY_LOCAL_MACHINE "SOFTWARE\${MUI_PRODUCT}"<br />
      DeleteRegKey HKEY_LOCAL_MACHINE "SOFTWARE\Microsoft\Windows\CurrentVersion\Uninstall\${MUI_PRODUCT}"<br />
      <br />
      SectionEnd<br />
      <br />
      <br />
      ;--------------------------------<br />
      ;MessageBox Section<br />
      <br />
      <br />
      ;Function that calls a messagebox when installation finished correctly<br />
      <br />
      Function .onInstSuccess<br />
      MessageBox MB_OK "You have successfully installed ${MUI_PRODUCT}. Use the desktop icon to start the program."<br />
      FunctionEnd<br />
      <br />
      <br />
      Function un.onUninstSuccess<br />
      MessageBox MB_OK "You have successfully uninstalled ${MUI_PRODUCT}."<br />
      FunctionEnd<br />
      <br />
      Function .onInstSuccess<br />
      MessageBox MB_YESNO|MB_ICONQUESTION "Installation has completed. Launch ${MUI_PRODUCT} now?" IDNO NoLaunch<br />
      ExecShell open "$INSTDIR\${MUI_FILE}.exe"<br />
      NoLaunch:<br />
      FunctionEnd<br />
      <br />
      <br />
      <br />
      ;--------------------------------------<br />
      ;Other function section<br />
      <br />
      Function IsFlashInstalled<br />
      Push $R0<br />
      ClearErrors<br />
      ReadRegStr $R0 HKCR "CLSID\{D27CDB6E-AE6D-11cf-96B8-444553540000}" ""<br />
      IfErrors lbl_na<br />
      StrCpy $R0 1<br />
      MessageBox MB_OK "Flash is installed. Whoopie!"<br />
      Goto lbl_end<br />
      lbl_na:<br />
      StrCpy $R0 0<br />
      MessageBox MB_OK "Flash is not Installed. Please visit macromedia.com and download the latest Flash plugin."<br />
      ;Quit<br />
      lbl_end:<br />
      Exch $R0<br />
      FunctionEnd<br />
      <br />
      ;eof</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Vytautas</span><br />
      <span class="post-time small text-muted">25th July 2003 00:39 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Add this line after the desktop shortcut creation</p>
      <pre>
<code>CreateShortCut "$SMPROGRAMS\Startup\${MUI_PRODUCT}.lnk" "$INSTDIR\${MUI_FILE}.exe" "" </code>
</pre>And this line in the delete shortcuts area of the uninstaller
      <pre>
<code>Delete "$SMPROGRAMS\Startup\${MUI_PRODUCT}.lnk" </code>
</pre><br />
      <br />
      BTW In future could you attach long scripts rather than posting them.<br />
      <br />
      Vytautas
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Joel</span><br />
      <span class="post-time small text-muted">25th July 2003 00:53 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Please attach big script, please :)<br />
      Second Startup folder is different in each Windows OS language.<br />
      First find the folder in the registry:<br /></p>
      <pre>
<code><br />Function ".onInit"<br />ReadRegStr $0 HKCU "Software\Microsoft\Windows\CurrentVersion\Explorer\Shell Folders" "Startup"<br />StrCmp $0 "" +1 +2<br />ReadRegStr $0 HKLM "SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\Shell Folders" "Startup"<br />Messagebox MB_OK $0<br />Quit<br />FunctionEnd<br /></code>
</pre>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">ramon18</span><br />
      <span class="post-time small text-muted">25th July 2003 01:00 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Don't forget:<br />
      <br /></p>

      <blockquote>
        SetShellVarContext current|all<br />
        <br />
        Sets the context of $SMPROGRAMS and other shell folders. If set to 'current' (the default), the current user's shell folders are used. If set to 'all', the 'all users' shell folder is used. The all users folder may not be supported on all OSes. If the all users folder is not found, the current user folder will be used. Please take into consideration that a "normal user" has no rights to write in the all users area. Only admins have full access rights to the all users area. You can check this by using the UserInfo Plugin. See Contrib\UserInfo\UserInfo.nsi for an example.
      </blockquote>Because permissions problems, you shouldn't allow non admins to install your software, btw, other installers like MS installer don't permit. :P<br />
      <br />
      good luck<br />
      Ramon
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
      <span class="post-time small text-muted">25th July 2003 11:01 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">$SMSTARTUP is easier than reading the registry.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Joel</span><br />
      <span class="post-time small text-muted">25th July 2003 16:01 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"></p>

      <blockquote>
        <i>Originally posted by kichik</i><br />
        <b>$SMSTARTUP is easier than reading the registry.</b>
      </blockquote>You right :p. Forgot that :D
    </div>
    <hr />

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]>
  </script>
</body>
</html>
