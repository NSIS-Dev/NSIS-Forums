<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="Causes for Reboot &amp; Manual button get displayed on FinishPage" />

  <title>Causes for Reboot &amp; Manual button get displayed on FinishPage - NSIS Forums</title>
  <script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script>
  <!-- Bootstrap core CSS -->

  <link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css" />
  <link rel="stylesheet" href="../css/style.css" type="text/css" /><!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!--[if lt IE 9]>
                <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
                <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->
</head>

<body>
  <div class="container">
    <!-- Put navigation bar here -->

    <ol class="breadcrumb">
      <li><a href="../index.html" class="glyphicon glyphicon-home"></a></li>

      <li><a href="f-65.html">NSIS Discussion</a></li>

      <li class="active">Causes for Reboot &amp; Manual button get displayed on FinishPage</li>
    </ol>

    <p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=265919">Causes for Reboot &amp; Manual button get displayed on FinishPage</a></p><br />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Swapan Das</span><br />
      <span class="post-time small text-muted">16th February 2007 10:23 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>Causes for the display of Reboot &amp; Manual button on FinishPage</strong><br />
      Hi Folks!<br />
      <br />
      Yes, I'm back! Was not in touch for weeks due official tour and other assignments.<br />
      <br />
      I'm yet to go through the threads started by me in the last 20 days. I'll definitely go through them and will revert to them. But in the meantime,here's one more new issue.<br />
      <br />
      The senior most person from my management have reported that my installer has once worked peculiarly, though he was unable to reproduce the anomaly in front of me.<br />
      <br />
      He is saying that my installer has displayed the option 'Reboot' and 'Manual' in the Finish page of the installation. I'm wondering how can it be, when I've not issued any such command! And the installer was working fine when I left. As per him, at that situation he selected the option 'manual'. And after the installation he run our application and discovered that the application is giving an error as the installer failed to register one of the ocx. This is the whole scenario, tell me why this thing happened for once only and he was unable to recreate this error again as the installer is working fine after that one time blunder.<br />
      <br />
      In my knowledge knowingly, I've not used any commands related to reboot in my installer script. May be the installer is auto-checking the installation and activating this feature! During installation my installer uses the command DELETE and COPY for certain operations. Anything related to, if the operation is unsucessful?<br />
      <br />
      Still these are the commands anything close to reboot in use:<br />
      <br />
      Section "-Install ActiveX controls "<br />
      IfFileExists "$INSTDIR\MyApp.exe" 0 new_installation<br />
      StrCpy $ALREADY_INSTALLED 1<br />
      new_installation:<br />
      !insertmacro InstallLib REGDLL $ALREADY_INSTALLED REBOOT_NOTPROTECTED "AppDLLOCX\comdlg32.ocx" "$SYSDIR\comdlg32.ocx" "$SYSDIR"<br />
      SectionEnd<br />
      <br />
      Section Uninstall<br />
      ; plz. note the following line is commented!<br />
      ; RMDir /r /REBOOTOK $INSTDIR<br />
      <br />
      SectionEnd<br />
      <br />
      Function .onRebootFailed<br />
      MessageBox MB_OK|MB_ICONSTOP "Reboot failed. Please reboot manually." /SD IDOK<br />
      FunctionEnd<br />
      <br />
      <br />
      With regards,<br />
      <br />
      <br />
      <br />
      <br />
      <br />
      <br />
      :)</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">demiller9</span><br />
      <span class="post-time small text-muted">16th February 2007 14:26 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">The RegDll command (or an alternative like UpgradeDll_Func you might use) probably failed and set the RebootFlag TRUE. (See the help 4.9.11.2 SetRebootFlag, and 4.9.4.11 IfRebootFlag)<br />
      <br />
      The Finish page displays the option your boss saw if that flag is set.<br />
      <br />
      The dll might have failed to register because A) it depends upon other dlls that were not installed yet, or B) it needs a path variable that wasn't set yet, or C) another process was active and using an older copy of the dll, so the new one won't get copied into the directory until a reboot.<br />
      <br />
      I struggled with this last week because my dlls needed the vc_redistributable dlls, but I installed those after mine. On the first install on a clean box, it wouldn't register them. second install worked (because the dependency was solved by then).<br />
      <br />
      Don</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Swapan Das</span><br />
      <span class="post-time small text-muted">16th February 2007 14:44 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Thanks Don for the reply. I've to leave office now, will check it tomorrow as per your suggestion. You've correctly deciphered my issue. Your second install worked like my boss's - how the 2nd time it works?</p>
    </div>
    <hr />

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]>
  </script>
</body>
</html>
