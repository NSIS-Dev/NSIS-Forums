<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="Installer skipping over Windows Installer Package" />

  <title>Installer skipping over Windows Installer Package - NSIS Forums</title><!-- Bootstrap core CSS -->
  <link rel="stylesheet" type="text/css" href="//netdna.bootstrapcdn.com/bootswatch/3.0.1/readable/bootstrap.min.css" />
  <link rel="stylesheet" href="../css/style.css" type="text/css" /><!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!--[if lt IE 9]>
                <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
                <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->
</head>

<body>
  <div class="container">
    <!-- Put navigation bar here -->

    <ol class="breadcrumb">
      <li><a href="../index.html" class="glyphicon glyphicon-home"></a></li>

      <li><a href="f-65.html">NSIS Discussion</a></li>

      <li class="active">Installer skipping over Windows Installer Package</li>
    </ol>

    <p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=200280">Installer skipping over Windows Installer Package</a></p><br />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">djskeezmo</span><br />
      <span class="post-time small text-muted">26th November 2004 16:41 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>Installer skipping over Windows Installer Package</strong><br />
      I have about 9 files that I am installing in my installer, and all of the exe files are working fine. But the MYSQL Database installer is an msi file, and it extracts it or says it is, and then skips over it.<br />
      <br />
      Any ideas any one. Does NSIS not permit Windows Installer Packages (.msi)??<br />
      <br />
      Thanks in advance...</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
      <span class="post-time small text-muted">26th November 2004 16:47 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Extracts and then skips over it? What do you mean? Do you mean it doesn't execute it? If you attach your script or a minimal example, it'll be easier to see what the problem is.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">djskeezmo</span><br />
      <span class="post-time small text-muted">26th November 2004 16:51 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">ok. this is the section code:<br />
      <br /></p>
      <pre>
<code>Section "MySQL 4.1" SecDATA<br /> SectionIn RO<br />  SetOutPath "$INSTDIR"<br />  File "..\Examples\MYSQLInstall.msi"<br />  ExecWait '"$INSTDIR\MYSQLInstall.msi"'<br />  SetDetailsPrint textonly<br />  DetailPrint "Installing MySQL Database 4.1..."<br />  SetDetailsPrint listonly<br />  Delete "$INSTDIR\SAMInstall.exe"<br />SectionEnd</code>
</pre><br />
      <br />
      And what it does in the installer is it says Extract MYSQLInstall.msi (Then the PErcentages going up) Then it says Execute MYSQLInstall.msi...Then Installing MYSQL Database 4.1 for a quick second. Then Skips over to the next installer.<br />
      <br />
      I am very confused. I would be happy to post my installer up here, but it is a pretty large file.
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">scrose</span><br />
      <span class="post-time small text-muted">26th November 2004 16:55 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"></p>
      <pre>
<code>ExecWait '"$WINDIR\System32\msiexec.exe" /i "$INSTDIR\MYSQLInstall.msi"'</code>
</pre>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
      <span class="post-time small text-muted">26th November 2004 16:59 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">That's because a MSI installer is not really an executable. You can install it using msiexec.exe which is a real executable.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">djskeezmo</span><br />
      <span class="post-time small text-muted">26th November 2004 17:02 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Thank you so much everybody. It worked.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">scrose</span><br />
      <span class="post-time small text-muted">26th November 2004 17:04 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Of course, this will only work if the Windows Installer is... well... installed. You probably need to check some obscure setting in the registry to determine if it is installed. Microsoft might provide some <a href="http://msdn.microsoft.com/library/en-us/msi/setup/windows_installer_start_page.asp" target="_blank">information</a> about it.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">djskeezmo</span><br />
      <span class="post-time small text-muted">26th November 2004 17:13 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">they should all have it installed considering this installer is only for windows xp. The other programs dont work on anything lower.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">scrose</span><br />
      <span class="post-time small text-muted">26th November 2004 18:38 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">If it is not necessary to have the installer wait, this will also work.</p>
      <pre>
<code>ExecShell "Open" "$INSTDIR\MYSQLInstall.msi"</code>
</pre>
    </div>
    <hr />

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]>
  </script>
</body>
</html>
