<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="description" content="ExecWait, and then wait for 2nd process?"><title>ExecWait, and then wait for 2nd process? - NSIS Forums</title><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script><link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css"><link rel="stylesheet" href="../css/style.css" type="text/css"><!--[if lt IE 9]><script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script><script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script><![endif]--></head><body><div class="container"><ol class="breadcrumb"><li><a href="../index.html" class="glyphicon glyphicon-home"></a></li><li><a href="f-65.html">NSIS Discussion</a></li><li class="active">ExecWait, and then wait for 2nd process?</li></ol><p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=224844">ExecWait, and then wait for 2nd process?</a></p><br><div class="post"><p class="post-meta"><span class="post-author text-primary">ShakerWD</span><br><span class="post-time small text-muted">30th August 2005 12:15 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>ExecWait, and then wait for 2nd process?</strong><br>hi,<br>just begun working with nsis. its really nice to work with, especially with EclipseNSIS. first off all thx for these great tools!<br><br>in my installer i'm checking if acrobat reader is installed.<br>if not, i start the installation with ExecWait. the problem is that the newest acrobat installer launches 2 processes. the first process invoked by me is AcrReader.exe<br>This process ends and the Reader installation is continued with the msiexec.exe process.<br><br>thus my installation continues during the main reader-instalaltion 'cause AcrReader.exe ended.<br><br>how i can observe these 2 processes? nothing found so far.<br>need to wait until the 2nd process returns.<br><br>cheers<br><br>Daniel</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">KenA</span><br><span class="post-time small text-muted">30th August 2005 15:43 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Hi ShakerWD,<br><br>you should be able to monitor msiexec.exe, and any other process for that matter, with the "FindProcDLL" plug-in. Don't remember if it's in standard NSIS install tho.<br><br>Hope this helps,<br><br>KenA</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">OJi</span><br><span class="post-time small text-muted">30th August 2005 19:42 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">when you launch the exe does it begin to decompress acrobat reader ?<br>if yes - unpack it your self and lauch the msi directly.<br><br>hope it helps.<br><br>OJi.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">ShakerWD</span><br><span class="post-time small text-muted">30th August 2005 21:19 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"></p><blockquote>you should be able to monitor msiexec.exe, and any other process for that matter</blockquote>thats what i've already done. the problem with this solution is that adobe starts the msiexec 4!! times. 3 times with the logged in user, the 4th time with an system account. works fine. i'm waiting a well defined time. checking the state of the process. problem is that the 4th msiexec.exe never dies. it will run until the end of windows session. or until killed by hand. so moitoring the process wont give the right solution.<br><br><blockquote>unpack it your self and lauch the msi directly</blockquote>took a while to find the needed files. will try tomorrow if it works. but think execwait will run against the same wall as the aproach above cause the hanging process. will try an older reader version too.<br><br>thx for your replies<br><br>cheers<br><br>Daniel</div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Takhir</span><br><span class="post-time small text-muted">31st August 2005 07:03 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">You can launch Acrobat setup at the end on installation (last section, for example) and finish your installer instead of waiting. NSIS 'finish' page must be omitted this case - see finPre function in the attached script. I did this trick for .NET 1.1 installation because it may require reboot (if replaces 1.0). Attached script is <b>draft only</b>, it searchs $EXEDIR for 2 additional predefined setup files (dotnetfx and 'components' package) and (if any) displays sections page (editor itself not requires sections). Hides itself during 'components' package installation (SEC_2).</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">ShakerWD</span><br><span class="post-time small text-muted">31st August 2005 09:43 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">thx takhir,<br><br>solved it this way. searched the unpacked files.<br>added them to installer.<br><br>starting installation with<br></p><pre>
<code>ExecWait</code><span style="color: #DD0000">"msiexec.exe/i$TEMP\Test\Acrobat\Reader.msi"
</span>
</pre>ExecWait can handle the hanging process. works fine now.<br><br>thx for your replies</div><hr><div class="footer"><p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p></div></div><script src="../js/highlight.pack.js" type="text/javascript"></script><script type="text/javascript">//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]></script></body></html>