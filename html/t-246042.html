<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="description" content="Installing Framework .Net 2.0"><title>Installing Framework .Net 2.0 - NSIS Forums</title><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script><link rel="preload" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css" as="style" onload="this.rel='stylesheet'"><link rel="preload" href="../css/style.css" as="style" onload="this.rel='stylesheet'"><noscript><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css"><link rel="stylesheet" href="../css/style.css"></noscript><script>!function(a){"use strict";var b=function(b,c,d){function e(a){return h.body?a():void setTimeout(function(){e(a)})}function f(){i.addEventListener&&i.removeEventListener("load",f),i.media=d||"all"}var g,h=a.document,i=h.createElement("link");if(c)g=c;else{var j=(h.body||h.getElementsByTagName("head")[0]).childNodes;g=j[j.length-1]}var k=h.styleSheets;i.rel="stylesheet",i.href=b,i.media="only x",e(function(){g.parentNode.insertBefore(i,c?g:g.nextSibling)});var l=function(a){for(var b=i.href,c=k.length;c--;)if(k[c].href===b)return a();setTimeout(function(){l(a)})};return i.addEventListener&&i.addEventListener("load",f),i.onloadcssdefined=l,l(f),i};"undefined"!=typeof exports?exports.loadCSS=b:a.loadCSS=b}("undefined"!=typeof global?global:this);!function(a){if(a.loadCSS){var b=loadCSS.relpreload={};if(b.support=function(){try{return a.document.createElement("link").relList.supports("preload")}catch(b){return!1}},b.poly=function(){for(var b=a.document.getElementsByTagName("link"),c=0;c<b.length;c++){var d=b[c];"preload"===d.rel&&"style"===d.getAttribute("as")&&(a.loadCSS(d.href,d,d.getAttribute("media")),d.rel=null)}},!b.support()){b.poly();var c=a.setInterval(b.poly,300);a.addEventListener&&a.addEventListener("load",function(){b.poly(),a.clearInterval(c)}),a.attachEvent&&a.attachEvent("onload",function(){a.clearInterval(c)})}}}(this);</script></head><body><div class="container"><ol class="breadcrumb"><li><a href="../index.html" class="glyphicon glyphicon-home"></a></li><li><a href="f-65.html">NSIS Discussion</a></li><li class="active">Installing Framework .Net 2.0</li></ol><p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=246042">Installing Framework .Net 2.0</a></p><br><div class="post"><p class="post-meta"><span class="post-author text-primary">roly0022</span><br><span class="post-time small text-muted">12th May 2006 15:06 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>Installing Framework .Net 2.0</strong><br>I need to install de .net framework 2.0, but whitout download it, how can i do? this is my script:<br><br></p><blockquote>; Script generated by the HM NIS Edit Script Wizard.<br><br>; HM NIS Edit Wizard helper defines<br>!define PRODUCT_NAME "Mi aplicación"<br>!define PRODUCT_VERSION "1.0"<br>!define PRODUCT_PUBLISHER "Mi compañía, inc."<br>!define PRODUCT_WEB_SITE "http://www.micompañia.com"<br>!define PRODUCT_DIR_REGKEY "Software\Microsoft\Windows\CurrentVersion\App Paths\ManejoXML.exe"<br>!define PRODUCT_UNINST_KEY "Software\Microsoft\Windows\CurrentVersion\Uninstall\${PRODUCT_NAME}"<br>!define PRODUCT_UNINST_ROOT_KEY "HKLM"<br><br>Name "${PRODUCT_NAME} ${PRODUCT_VERSION}"<br>OutFile "Instalar_nuevo.exe"<br>LoadLanguageFile "${NSISDIR}\Contrib\Language files\Spanish.nlf"<br>InstallDir "$PROGRAMFILES\Mi aplicación"<br>Icon "${NSISDIR}\Contrib\Graphics\Icons\modern-install.ico"<br>UninstallIcon "${NSISDIR}\Contrib\Graphics\Icons\modern-uninstall.ico"<br>InstallDirRegKey HKLM "${PRODUCT_DIR_REGKEY}" ""<br>DirText "Se instalará $(^Name) en el siguiente directorio.$\r$\n$\r$\nPara instalar en un directorio distinto, presione Examinar y seleccione otro directorio"<br>LicenseText "Si acepta todos los términos del acuerdo, seleccione Acepto para continuar. Debe aceptar el acuerdo para instalar $(^Name)."<br>LicenseData "licencia.txt"<br>ShowInstDetails show<br>ShowUnInstDetails show<br><br>Section "Principal" SEC01<br>SetOutPath "$INSTDIR"<br>SetOverwrite on<br>File "Debug\ManejoXML.exe"<br>CreateDirectory "$SMPROGRAMS\Mi aplicación"<br>CreateShortCut "$SMPROGRAMS\Mi aplicación\Mi aplicación.lnk" "$INSTDIR\ManejoXML.exe"<br>CreateShortCut "$DESKTOP\Mi aplicación.lnk" "$INSTDIR\ManejoXML.exe"<br>SectionEnd<br><br>Section -AdditionalIcons<br>WriteIniStr "$INSTDIR\${PRODUCT_NAME}.url" "InternetShortcut" "URL" "${PRODUCT_WEB_SITE}"<br>CreateShortCut "$SMPROGRAMS\Mi aplicación\Website.lnk" "$INSTDIR\${PRODUCT_NAME}.url"<br>CreateShortCut "$SMPROGRAMS\Mi aplicación\Uninstall.lnk" "$INSTDIR\uninst.exe"<br>SectionEnd<br><br>Section -Post<br>WriteUninstaller "$INSTDIR\uninst.exe"<br>WriteRegStr HKLM "${PRODUCT_DIR_REGKEY}" "" "$INSTDIR\ManejoXML.exe"<br>WriteRegStr ${PRODUCT_UNINST_ROOT_KEY} "${PRODUCT_UNINST_KEY}" "DisplayName" "$(^Name)"<br>WriteRegStr ${PRODUCT_UNINST_ROOT_KEY} "${PRODUCT_UNINST_KEY}" "UninstallString" "$INSTDIR\uninst.exe"<br>WriteRegStr ${PRODUCT_UNINST_ROOT_KEY} "${PRODUCT_UNINST_KEY}" "DisplayIcon" "$INSTDIR\ManejoXML.exe"<br>WriteRegStr ${PRODUCT_UNINST_ROOT_KEY} "${PRODUCT_UNINST_KEY}" "DisplayVersion" "${PRODUCT_VERSION}"<br>WriteRegStr ${PRODUCT_UNINST_ROOT_KEY} "${PRODUCT_UNINST_KEY}" "URLInfoAbout" "${PRODUCT_WEB_SITE}"<br>WriteRegStr ${PRODUCT_UNINST_ROOT_KEY} "${PRODUCT_UNINST_KEY}" "Publisher" "${PRODUCT_PUBLISHER}"<br>SectionEnd<br><br><br>Function un.onUninstSuccess<br>HideWindow<br>MessageBox MB_ICONINFORMATION|MB_OK "La desinstalación de $(^Name) finalizó satisfactoriamente."<br>FunctionEnd<br><br>Function un.onInit<br>MessageBox MB_ICONQUESTION|MB_YESNO|MB_DEFBUTTON2 "¿Está completamente seguro que desea desinstalar $(^Name) junto con todos sus componentes?" IDYES +2<br>Abort<br>FunctionEnd<br><br>Section Uninstall<br>Delete "$INSTDIR\${PRODUCT_NAME}.url"<br>Delete "$INSTDIR\uninst.exe"<br>Delete "$INSTDIR\ManejoXML.exe"<br><br>Delete "$SMPROGRAMS\Mi aplicación\Uninstall.lnk"<br>Delete "$SMPROGRAMS\Mi aplicación\Website.lnk"<br>Delete "$DESKTOP\Mi aplicación.lnk"<br>Delete "$SMPROGRAMS\Mi aplicación\Mi aplicación.lnk"<br><br>RMDir "$SMPROGRAMS\Mi aplicación"<br>RMDir "$INSTDIR"<br><br>DeleteRegKey ${PRODUCT_UNINST_ROOT_KEY} "${PRODUCT_UNINST_KEY}"<br>DeleteRegKey HKLM "${PRODUCT_DIR_REGKEY}"<br>SetAutoClose true<br>SectionEnd</blockquote></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">nacamae</span><br><span class="post-time small text-muted">12th May 2006 21:06 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Hi,<br><br>You have to download the .NET Framework Redistributable Pack from MS download page. It´s a file called dotnetfx.exe.<br><br>Then copy this file to $OUTDIR and execute this command inside your script:<br><br>ExecWait "$OUTDIR\dotnetfx.exe /q:a /c:$\"install /q$\""<br><br>This will perform a silent installation of framework.<br><br>I hope this help you.<br><br>Henrique Nacamae</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">roly0022</span><br><span class="post-time small text-muted">19th May 2006 16:05 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">i can't make it work :(, the installation directory have this files:<br><br>instalador.exe<br>dotnetfix.exe<br><br>the script is this, i add the line ExecWait "$OUTDIR\dotnetfx.exe /q:a /c:$\"install /q$\""<br>in Section "Principal" SEC01<br><br>; Script generated by the HM NIS Edit Script Wizard.<br><br>; HM NIS Edit Wizard helper defines<br>!define PRODUCT_NAME "Mi aplicación"<br>!define PRODUCT_VERSION "1.0"<br>!define PRODUCT_PUBLISHER "Mi compañía, inc."<br>!define PRODUCT_WEB_SITE "http://www.micompañia.com"<br>!define PRODUCT_DIR_REGKEY "Software\Microsoft\Windows\CurrentVersion\App Paths\ManejoXML.exe"<br>!define PRODUCT_UNINST_KEY "Software\Microsoft\Windows\CurrentVersion\Uninstall\${PRODUCT_NAME}"<br>!define PRODUCT_UNINST_ROOT_KEY "HKLM"<br><br>Name "${PRODUCT_NAME} ${PRODUCT_VERSION}"<br>OutFile "Instalar_nuevo.exe"<br>LoadLanguageFile "${NSISDIR}\Contrib\Language files\Spanish.nlf"<br>InstallDir "$PROGRAMFILES\Mi aplicación"<br>Icon "${NSISDIR}\Contrib\Graphics\Icons\modern-install.ico"<br>UninstallIcon "${NSISDIR}\Contrib\Graphics\Icons\modern-uninstall.ico"<br>InstallDirRegKey HKLM "${PRODUCT_DIR_REGKEY}" ""<br>DirText "Se instalará $(^Name) en el siguiente directorio.$\r$\n$\r$\nPara instalar en un directorio distinto, presione Examinar y seleccione otro directorio"<br>LicenseText "Si acepta todos los términos del acuerdo, seleccione Acepto para continuar. Debe aceptar el acuerdo para instalar $(^Name)."<br>LicenseData "licencia.txt"<br>ShowInstDetails show<br>ShowUnInstDetails show<br><br>Section "Principal" SEC01<br>SetOutPath "$INSTDIR"<br>SetOverwrite on<br>File "Debug\ManejoXML.exe"<br>ExecWait "$OUTDIR\dotnetfx.exe /q:a /c:$\"install /q$\""<br>CreateDirectory "$SMPROGRAMS\Mi aplicación"<br>CreateShortCut "$SMPROGRAMS\Mi aplicación\Mi aplicación.lnk" "$INSTDIR\ManejoXML.exe"<br>CreateShortCut "$DESKTOP\Mi aplicación.lnk" "$INSTDIR\ManejoXML.exe"<br>SectionEnd<br><br>Section -AdditionalIcons<br>WriteIniStr "$INSTDIR\${PRODUCT_NAME}.url" "InternetShortcut" "URL" "${PRODUCT_WEB_SITE}"<br>CreateShortCut "$SMPROGRAMS\Mi aplicación\Website.lnk" "$INSTDIR\${PRODUCT_NAME}.url"<br>CreateShortCut "$SMPROGRAMS\Mi aplicación\Uninstall.lnk" "$INSTDIR\uninst.exe"<br>SectionEnd<br><br>Section -Post<br>WriteUninstaller "$INSTDIR\uninst.exe"<br>WriteRegStr HKLM "${PRODUCT_DIR_REGKEY}" "" "$INSTDIR\ManejoXML.exe"<br>WriteRegStr ${PRODUCT_UNINST_ROOT_KEY} "${PRODUCT_UNINST_KEY}" "DisplayName" "$(^Name)"<br>WriteRegStr ${PRODUCT_UNINST_ROOT_KEY} "${PRODUCT_UNINST_KEY}" "UninstallString" "$INSTDIR\uninst.exe"<br>WriteRegStr ${PRODUCT_UNINST_ROOT_KEY} "${PRODUCT_UNINST_KEY}" "DisplayIcon" "$INSTDIR\ManejoXML.exe"<br>WriteRegStr ${PRODUCT_UNINST_ROOT_KEY} "${PRODUCT_UNINST_KEY}" "DisplayVersion" "${PRODUCT_VERSION}"<br>WriteRegStr ${PRODUCT_UNINST_ROOT_KEY} "${PRODUCT_UNINST_KEY}" "URLInfoAbout" "${PRODUCT_WEB_SITE}"<br>WriteRegStr ${PRODUCT_UNINST_ROOT_KEY} "${PRODUCT_UNINST_KEY}" "Publisher" "${PRODUCT_PUBLISHER}"<br>SectionEnd<br><br><br>Function un.onUninstSuccess<br>HideWindow<br>MessageBox MB_ICONINFORMATION|MB_OK "La desinstalación de $(^Name) finalizó satisfactoriamente."<br>FunctionEnd<br><br>Function un.onInit<br>MessageBox MB_ICONQUESTION|MB_YESNO|MB_DEFBUTTON2 "¿Está completamente seguro que desea desinstalar $(^Name) junto con todos sus componentes?" IDYES +2<br>Abort<br>FunctionEnd<br><br>Section Uninstall<br>Delete "$INSTDIR\${PRODUCT_NAME}.url"<br>Delete "$INSTDIR\uninst.exe"<br>Delete "$INSTDIR\ManejoXML.exe"<br><br>Delete "$SMPROGRAMS\Mi aplicación\Uninstall.lnk"<br>Delete "$SMPROGRAMS\Mi aplicación\Website.lnk"<br>Delete "$DESKTOP\Mi aplicación.lnk"<br>Delete "$SMPROGRAMS\Mi aplicación\Mi aplicación.lnk"<br><br>RMDir "$SMPROGRAMS\Mi aplicación"<br>RMDir "$INSTDIR"<br><br>DeleteRegKey ${PRODUCT_UNINST_ROOT_KEY} "${PRODUCT_UNINST_KEY}"<br>DeleteRegKey HKLM "${PRODUCT_DIR_REGKEY}"<br>SetAutoClose true<br>SectionEnd</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">nacamae</span><br><span class="post-time small text-muted">19th May 2006 19:54 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">You have to copy dotnetfx.exe to $OUTDIR before execute it.<br><br>;Copy dotnetfx.exe to $OUTDIR<br>File "dotnefx.exe"<br>;install .NET Framework<br>ExecWait "$OUTDIR\dotnetfx.exe /q:a /c:$\"install /q$\""<br>;Delete dotnetx.exe<br>Delete "$OUTDIR\dotnetfx.exe"<br><br>Henrique Nacamae</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Red Wine</span><br><span class="post-time small text-muted">19th May 2006 20:21 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">you have to extract dotnetfx.exe to $pluginsdir and then execute it if you just wish to remove it after installation, or in $instdir if you wish the file to reside along with the other files of your installation.<br>anyway, this redist is a big one, so it might be better if you prompt users to download it from MS server instead of having it with your distribution.<br><br>function .onInit<br>[other code that goes here if needed]<br>initpluginsdir<br>file /oname=$PLUGINSDIR\dotnetfx.exe 'your local dir\dotnetfx.exe'<br>functionend<br><br>section -<br>bla bla bla<br>call InstallDotNetFx<br>bla bla bla<br>sectionend<br><br>function InstallDotNetFx<br>ExecWait '$PLUGINS\dotnetfx.exe /q:a /c:$\"install /q$\"'<br>; you may also want to check for errors<br>functionend</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">roly0022</span><br><span class="post-time small text-muted">22nd May 2006 12:51 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">This application sould work with or without internet, that`s why i need include the framework.<br>This :<br><br>;Copy dotnetfx.exe to $OUTDIR<br>File "dotnefx.exe"<br>;install .NET Framework<br>ExecWait "$OUTDIR\dotnetfx.exe /q:a /c:$\"install /q$\""<br>;Delete dotnetx.exe<br>Delete "$OUTDIR\dotnetfx.exe"<br><br>work`s fine, but always install the framwork, can i detect if is installed and not install?<br><br>Thanks.-</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">nacamae</span><br><span class="post-time small text-muted">22nd May 2006 15:00 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Check the entry "Install" (DWORD) in<br><br>HKLM\SOFTWARE\Microsoft\NET Framework Setup\NDP\v2.0.50727<br><br>If Install==1, then NET is installed.<br><br>Henrique Nacamae</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">roly0022</span><br><span class="post-time small text-muted">22nd May 2006 19:02 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">This is the code, it works fine:<br><br>ReadRegDWORD $0 HKLM 'Software\Microsoft\NET Framework Setup\NDP\v2.0.50727' Install<br>!if !$0<br><br>;Copy dotnetfx.exe to $OUTDIR<br>File "archivos\dotnetfx.exe"<br>;install .NET Framework<br>ExecWait "$OUTDIR\dotnetfx.exe /q:a /c:$\"install /q$\""<br>;Delete dotnetx.exe<br>Delete "$OUTDIR\dotnetfx.exe"<br>!EndIf<br><br>Thanks a lot !!!!</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">JeronimoColon</span><br><span class="post-time small text-muted">22nd May 2006 19:41 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">This may be duplicate effort but, I am working on a Microsoft helper library for MSI and the .NET framework.<br><br>It detects the .NET 2.0 framework and will proceed to install all the necessary dependencies if required.<br>1. Detects if MSI is installed and what version.<br>2. If older than MSI 3.1 installs 3.1 (required by framework for NT based systems).<br>3. Detects if version 2.0 of framework is installed, if not installs it.<br><br>Other (extra) helper macros that are available are:<br>- Repair .NET framework macro. (If something is wrong with the existing installation)<br>- Generic MSI installer helper macro. This can be used to install any MSI based installation you may need to shell out.<br>- Repair MSI installation helper macro. Forces a repair any previously installed MSI (you must have access to the .msi file)<br>- Detects MDAC version macro.<br>- Installs MDAC macro (Currently only 2.8sp1).<br>- Detects Jet version macro.<br>- Installs Jet macro(Currently Jet 4.0 sp8).<br><br>Right now my library is very tied to Windows NT based systems. I need to code to handle Windows 9.x.<br><br>The code is based off of Microsoft documentation and recommendations. When I finally post the library I will include links to the source documentation that I used.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Red Wine</span><br><span class="post-time small text-muted">22nd May 2006 20:08 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"></p><blockquote>It detects the .NET 2.0 framework and will proceed to install all the necessary dependencies if required.<br>1. Detects if MSI is installed and what version.<br>2. If older than MSI 3.1 installs 3.1 (required by framework for NT based systems).<br>3. Detects if version 2.0 of framework is installed, if not installs it.</blockquote>Sounds cool! :-)<br>When you'll be ready, post it on wiki as well, so would be easy for everyone to grab it and use it.<br>regards</div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">n_baua</span><br><span class="post-time small text-muted">17th August 2006 09:36 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>Any luck with the stuff you wanted to share...</strong><br>HI JeronimoColon,<br><br>I am very new to NSIS and had made lot of efforts to detect the .net framework. My script may be not powerful enough to check all the stuff you discussed.<br><br>It will be nice if you post some stuff and newbies like me can use it.<br><br>Thanks in advance.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">devzoo</span><br><span class="post-time small text-muted">17th August 2006 10:17 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>Check .NET version, install 2.0</strong><br>Just wanted to share the code that I use for this. I install C# applications, so it's important that .NET 2.0 is always installed. I include the .NET framework installer file (dotnetfx.exe), and then put this code in my scripts (right after the languages section).<br><br>I can't take credit for this, by the way. Somebody else posted it somewhere, and I just tweaked it.<br><br></p><pre>
<code><font color="darkred"><br>;--------------------------------<br>; .NET Stuff<br><br>        !include WordFunc.nsh<br>        !insertmacro VersionCompare<br>        !include LogicLib.nsh<br><br>        Function <b>.onInit</b><br>                Call GetDotNETVersion<br>                Pop $0<br>                ${If} $0 == "not found"<br>                        MessageBox MB_OK|MB_ICONSTOP ".NET runtime library is not installed. The .NET installer will now run. After .NET has been installed, installion of MY APPLICATION will resume."<br>                        Call InstallDotNET<br>                        Return<br>                ${EndIf}<br>                <br>                StrCpy $0 $0 "" 1 # skip "v"<br>                <br>                ${VersionCompare} $0 "2.0" $1<br>                ${If} $1 == 2<br>                        MessageBox MB_OK|MB_ICONSTOP ".NET runtime library v2.0 or newer is required. You have $0."<br>                        Call InstallDotNET<br>                        Return<br>;               ${Else}<br>;                       MessageBox MB_OK|MB_ICONSTOP "The correct version of the .NET runtime library is installed."<br>                ${EndIf}<br>        FunctionEnd<br><br>        Function <b>GetDotNETVersion</b><br>                Push $0<br>                Push $1<br>                <br>                System::Call "mscoree::GetCORVersion(w .r0, i ${NSIS_MAX_STRLEN}, *i) i .r1"<br>                StrCmp $1 "error" 0 +2<br>                StrCpy $0 "not found"<br>                <br>                Pop $1<br>                Exch $0<br>        FunctionEnd<br><br>        Function <b>InstallDotNET</b><br>                SetOutPath $TEMP<br>                File "dotnetfx.exe"<br>                ExecWait '"$TEMP\dotnetfx.exe"'<br>        FunctionEnd<br></font></code>
</pre><br>
      <br>
      Notice that a couple of lines are commented out. These allow you to display a message if the .NET framework is already installed, but I think this is actually unnecessary.<br>
      <br>
      Hope this helps.<br>
      <br>
      Thanks!
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">sunlight112</span><br>
      <span class="post-time small text-muted">16th October 2006 09:45 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">However, I want to set up my program with multi languages. When I finish to detect .NET framework, I only run one language although my code is made with multi languages if .NET framework is not installed in my program.To .NET framework which is installed in my program, the process is OK.<br>
      Somebody can help me!!!<br>
      <br>
      !define PRODUCT_NAME "Test_Game"<br>
      !define PRODUCT_VERSION "1.4"<br>
      !define PRODUCT_DIR_REGKEY "Software\Microsoft\Windows\CurrentVersion\App Paths\Test_Game.exe"<br>
      !define PRODUCT_UNINST_KEY "Software\Microsoft\Windows\CurrentVersion\Uninstall\${PRODUCT_NAME}"<br>
      !define PRODUCT_UNINST_ROOT_KEY "HKLM"<br>
      <br>
      !include "MUI.nsh"<br>
      <br>
      Var MUI_TEMP<br>
      Var STARTMENU_FOLDER<br>
      <br>
      !define MUI_HEADERIMAGE<br>
      !define MUI_HEADERIMAGE_BITMAP "${NSISDIR}\Contrib\Graphics\Header\nsis.bmp" ; optional<br>
      <br>
      !define MUI_ABORTWARNING<br>
      !define MUI_ICON "${NSISDIR}\Contrib\Graphics\Icons\modern-install.ico"<br>
      !define MUI_UNICON "${NSISDIR}\Contrib\Graphics\Icons\modern-uninstall.ico"<br>
      <br>
      ; Language Selection Dialog Settings<br>
      !define MUI_LANGDLL_REGISTRY_ROOT "${PRODUCT_UNINST_ROOT_KEY}"<br>
      !define MUI_LANGDLL_REGISTRY_KEY "${PRODUCT_UNINST_KEY}"<br>
      !define MUI_LANGDLL_REGISTRY_VALUENAME "NSIS:Language"<br>
      <br>
      ; Welcome page<br>
      !insertmacro MUI_PAGE_WELCOME<br>
      ; License page<br>
      !insertmacro MUI_PAGE_LICENSE $(MUILicense)<br>
      <br>
      ;Start Menu Folder Page Configuration<br>
      !define MUI_STARTMENUPAGE_REGISTRY_ROOT "HKCU"<br>
      !define MUI_STARTMENUPAGE_REGISTRY_KEY "${PRODUCT_UNINST_KEY}"<br>
      !define MUI_STARTMENUPAGE_REGISTRY_VALUENAME "Start Menu Folder"<br>
      <br>
      !insertmacro MUI_PAGE_STARTMENU Application $STARTMENU_FOLDER<br>
      <br>
      ; Directory page<br>
      !insertmacro MUI_PAGE_DIRECTORY<br>
      ; Instfiles page<br>
      !insertmacro MUI_PAGE_INSTFILES<br>
      ; Finish page<br>
      !define MUI_FINISHPAGE_RUN "$INSTDIR\Test_Game.exe"<br>
      !insertmacro MUI_PAGE_FINISH<br>
      <br>
      ; Uninstaller pages<br>
      !insertmacro MUI_UNPAGE_CONFIRM<br>
      !insertmacro MUI_UNPAGE_INSTFILES<br>
      <br>
      ; Language files<br>
      !insertmacro MUI_LANGUAGE "English"<br>
      !insertmacro MUI_LANGUAGE "Japanese"<br>
      !insertmacro MUI_LANGUAGE "Korean"<br>
      !insertmacro MUI_LANGUAGE "Dutch"<br>
      ;--------------------------------<br>
      ;License Language String<br>
      <br>
      !define MUI_LICENSEPAGE_RADIOBUTTONS<br>
      LicenseLangString MUILicense ${LANG_ENGLISH} "E:\Client\Install\Script\en_license.txt"<br>
      LicenseLangString MUILicense ${LANG_JAPANESE} "E:\Client\Install\Script\jpn_license.txt"<br>
      LicenseLangString MUILicense ${LANG_KOREAN} "${NSISDIR}\Docs\Modern UI\License.txt"<br>
      LicenseLangString MUILicense ${LANG_DUTCH} "E:\Client\Install\Script\dutch_license.txt"<br>
      <br>
      !insertmacro MUI_RESERVEFILE_LANGDLL<br>
      <br>
      Name "${PRODUCT_NAME} ${PRODUCT_VERSION}"<br>
      OutFile "E:\Client\Install\Script\EXE\Office Talk.exe"<br>
      InstallDir "$PROGRAMFILES\Office Talk"<br>
      InstallDirRegKey HKLM "${PRODUCT_DIR_REGKEY}" ""<br>
      ShowInstDetails show<br>
      ShowUnInstDetails show<br>
      <br>
      Function .onInit<br>
      !insertmacro MUI_LANGDLL_DISPLAY<br>
      FunctionEnd<br>
      <br>
      Section "Test_Game" SEC01<br>
      SetOutPath "$INSTDIR"<br>
      SetOverwrite ifnewer<br>
      !insertmacro MUI_STARTMENU_WRITE_BEGIN Application<br>
      File "E:\Client\Install\Script\OfficeTalk.exe"<br>
      <br>
      ReadRegDWORD $0 HKLM 'Software\Microsoft\NET Framework Setup\NDP\v2.0.50727' Install<br>
      !if !$0<br>
      ;Copy dotnetfx.exe to $OUTDIR<br>
      File "E:\Client\Install\vcredist_x86.exe"<br>
      ;install .NET Framework<br>
      ExecWait "$OUTDIR\vcredist_x86.exe /q:a /c:$\"install /q$\""<br>
      ;Delete dotnetx.exe<br>
      Delete "$OUTDIR\vcredist_x86.exe"<br>
      !EndIf<br>
      <br>
      CreateDirectory "$SMPROGRAMS\Office Talk"<br>
      CreateShortCut "$SMPROGRAMS\Office Talk\Office Talk.lnk" "$INSTDIR\Test_Game.exe"<br>
      CreateShortCut "$DESKTOP\Test_Game.lnk" "$INSTDIR\OfficeTalk.exe"<br>
      !insertmacro MUI_STARTMENU_WRITE_END<br>
      SectionEnd<br>
      <br>
      Section -AdditionalIcons<br>
      WriteIniStr "$INSTDIR\${PRODUCT_NAME}.url" "InternetShortcut" "URL" "${PRODUCT_WEB_SITE}"<br>
      CreateShortCut "$SMPROGRAMS\Test_Game\Website.lnk" "$INSTDIR\${PRODUCT_NAME}.url"<br>
      CreateShortCut "$SMPROGRAMS\Test_Game\Uninstall.lnk" "$INSTDIR\uninst.exe"<br>
      SectionEnd<br>
      <br>
      Section -Post<br>
      WriteUninstaller "$INSTDIR\uninst.exe"<br>
      WriteRegStr HKLM "${PRODUCT_DIR_REGKEY}" "" "$INSTDIR\Test_Game.exe"<br>
      WriteRegStr ${PRODUCT_UNINST_ROOT_KEY} "${PRODUCT_UNINST_KEY}" "DisplayName" "$(^Name)"<br>
      WriteRegStr ${PRODUCT_UNINST_ROOT_KEY} "${PRODUCT_UNINST_KEY}" "UninstallString" "$INSTDIR\uninst.exe"<br>
      WriteRegStr ${PRODUCT_UNINST_ROOT_KEY} "${PRODUCT_UNINST_KEY}" "DisplayIcon" "$INSTDIR\Test_Game.exe"<br>
      WriteRegStr ${PRODUCT_UNINST_ROOT_KEY} "${PRODUCT_UNINST_KEY}" "DisplayVersion" "${PRODUCT_VERSION}"<br>
      WriteRegStr ${PRODUCT_UNINST_ROOT_KEY} "${PRODUCT_UNINST_KEY}" "URLInfoAbout" "${PRODUCT_WEB_SITE}"<br>
      WriteRegStr ${PRODUCT_UNINST_ROOT_KEY} "${PRODUCT_UNINST_KEY}" "Publisher" "${PRODUCT_PUBLISHER}"<br>
      SectionEnd<br>
      <br>
      <br>
      Function un.onUninstSuccess<br>
      HideWindow<br>
      FunctionEnd<br>
      <br>
      Function un.onInit<br>
      !insertmacro MUI_UNGETLANGUAGE<br>
      FunctionEnd<br>
      <br>
      Section Uninstall<br>
      Delete "$INSTDIR\${PRODUCT_NAME}.url"<br>
      Delete "$INSTDIR\uninst.exe"<br>
      Delete "$INSTDIR\Test_Game.exe"<br>
      <br>
      Delete "$SMPROGRAMS\Test_Game\Uninstall.lnk"<br>
      Delete "$SMPROGRAMS\Test_Game\Website.lnk"<br>
      Delete "$DESKTOP\Test_Game.lnk"<br>
      Delete "$SMPROGRAMS\Test_Game\Test_Game.lnk"<br>
      <br>
      RMDir "$SMPROGRAMS\Test_Game"<br>
      RMDir "$INSTDIR"<br>
      <br>
      !insertmacro MUI_STARTMENU_GETFOLDER Application $MUI_TEMP<br>
      <br>
      Delete "$SMPROGRAMS\$MUI_TEMP\Uninstall.lnk"<br>
      <br>
      ;Delete empty start menu parent diretories<br>
      StrCpy $MUI_TEMP "$SMPROGRAMS\$MUI_TEMP"<br>
      <br>
      startMenuDeleteLoop:<br>
      ClearErrors<br>
      RMDir $MUI_TEMP<br>
      GetFullPathName $MUI_TEMP "$MUI_TEMP\.."<br>
      <br>
      IfErrors startMenuDeleteLoopDone<br>
      <br>
      StrCmp $MUI_TEMP $SMPROGRAMS startMenuDeleteLoopDone startMenuDeleteLoop<br>
      startMenuDeleteLoopDone:<br>
      <br>
      DeleteRegKey ${PRODUCT_UNINST_ROOT_KEY} "${PRODUCT_UNINST_KEY}"<br>
      DeleteRegKey HKLM "${PRODUCT_DIR_REGKEY}"<br>
      SetAutoClose false<br>
      SectionEnd</p>
    </div>
    <hr>

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script type="text/javascript" src="../js/highlight.pack.js" async>
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]></script></body></html>