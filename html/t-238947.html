<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="description" content="NSIS Search function question"><title>NSIS Search function question - NSIS Forums</title><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script><link rel="preload" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css" as="style" onload="this.rel='stylesheet'"><link rel="preload" href="../css/style.css" as="style" onload="this.rel='stylesheet'"><noscript><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css"><link rel="stylesheet" href="../css/style.css"></noscript><script>!function(a){"use strict";var b=function(b,c,d){function e(a){return h.body?a():void setTimeout(function(){e(a)})}function f(){i.addEventListener&&i.removeEventListener("load",f),i.media=d||"all"}var g,h=a.document,i=h.createElement("link");if(c)g=c;else{var j=(h.body||h.getElementsByTagName("head")[0]).childNodes;g=j[j.length-1]}var k=h.styleSheets;i.rel="stylesheet",i.href=b,i.media="only x",e(function(){g.parentNode.insertBefore(i,c?g:g.nextSibling)});var l=function(a){for(var b=i.href,c=k.length;c--;)if(k[c].href===b)return a();setTimeout(function(){l(a)})};return i.addEventListener&&i.addEventListener("load",f),i.onloadcssdefined=l,l(f),i};"undefined"!=typeof exports?exports.loadCSS=b:a.loadCSS=b}("undefined"!=typeof global?global:this);!function(a){if(a.loadCSS){var b=loadCSS.relpreload={};if(b.support=function(){try{return a.document.createElement("link").relList.supports("preload")}catch(b){return!1}},b.poly=function(){for(var b=a.document.getElementsByTagName("link"),c=0;c<b.length;c++){var d=b[c];"preload"===d.rel&&"style"===d.getAttribute("as")&&(a.loadCSS(d.href,d,d.getAttribute("media")),d.rel=null)}},!b.support()){b.poly();var c=a.setInterval(b.poly,300);a.addEventListener&&a.addEventListener("load",function(){b.poly(),a.clearInterval(c)}),a.attachEvent&&a.attachEvent("onload",function(){a.clearInterval(c)})}}}(this);</script></head><body><div class="container"><ol class="breadcrumb"><li><a href="../index.html" class="glyphicon glyphicon-home"></a></li><li><a href="f-65.html">NSIS Discussion</a></li><li class="active">NSIS Search function question</li></ol><p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=238947">NSIS Search function question</a></p><br><div class="post"><p class="post-meta"><span class="post-author text-primary">DBE</span><br><span class="post-time small text-muted">24th February 2006 12:27 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>NSIS Search function question</strong><br>Hi there,<br>I'm wondering if it's possible to create an EXE-file, which can search through a TXT-file for unique numbers?<br><br>And when a number is found, to return the result containing the description of that number, and the price.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br><span class="post-time small text-muted">24th February 2006 12:46 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">There's lots of text file manipulation files on the Wiki:<br><a href="http://nsis.sourceforge.net/Category:Text_Files_Manipulation_Functions" target="_blank">http://nsis.sourceforge.net/Category...tion_Functions</a><br><br>-Stu</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">DBE</span><br><span class="post-time small text-muted">24th February 2006 13:32 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Hi Stu!<br>Thanks for the quick reply.<br><br>I think you misunderstand the question.<br><br>I have a txt file which contains part numbers in the following way:<br><br>Part Number <b>(TAB)</b> Description of Part Number <b>(TAB)</b> Price of the Part<br><br>I would like to make an exe-file, which allows the users of this file to search for a specific part number. Every part number is a unique number.<br><br>When the script finds the number, it has to return the result, as described above:<br>Part number<br>with description<br>and the price of the part<br><br>Later on, the idea would be that the result of the search can be added (by e.g. a button) in some sort of order form, which can be printed and faxed, or e-mailed to a specific address.<br><br>It's hard for me to explain, but if there are any questions, I'll do my best to answer.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Comperio</span><br><span class="post-time small text-muted">24th February 2006 15:01 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Have a look at the functions in the NSIS help, Appendix E. I think the 'LineFind' function should be just what what you are looking for. It would allow you to search for the line in the file. Once you find what you are looking for, you can create a callback function to read the line and parse the results for displaying to the user.<br><br>(If you don't find Appendix E in the help files, you'll need to get the latest build of NSIS.)</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">DBE</span><br><span class="post-time small text-muted">24th February 2006 15:46 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">The problem is, that the users only have to be able to search for the part number. They don't know which part number is on which line.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Comperio</span><br><span class="post-time small text-muted">25th February 2006 03:34 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Sorry... I misread the original post...<br><br>What I'd probably do is use a FileRead to read the parts file line by line. If you consider each line a 'row' of a database, then you can multiple WordFind functions (also in the appendix of the NSIS help) to break each row into a list of 'fields'. Field #1 would be your part number. (Use $/t as your delimiter.)<br><br>If you wanted to store the results in a variable, you could use WordReplace to replace the tabs ($\t) with carriage returns ($\r$\n). Then, just display the results in a message box. (Or in a custom page. but, in a custom page, you'd need to use \r\n instead)<br><br>If you needed to store multiple results, you may need to use the stack or write the output to a file for retrieval later.<br><br>(Hope this makes sense.)</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Instructor</span><br><span class="post-time small text-muted">25th February 2006 06:46 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"></p><pre>
<code>Name "Output"<br>OutFile "Output.exe"<br><br>!include "TextFunc.nsh"<br>!insertmacro LineFind<br>!insertmacro TrimNewLines<br><br>!include "WordFunc.nsh"<br>!insertmacro WordFind<br><br>Var FINDIT_PARTNUMBER<br>Var PARTNUMBER<br>Var DESCRIPTION<br>Var PRICE<br><br>Section<br>        StrCpy $FINDIT_PARTNUMBER '123456'<br><br>        ${LineFind} "C:\a.log" "/NUL" "1:-1" "LineFindCallback"<br><br>        IfErrors 0 +2<br>        MessageBox MB_OK "Error"<br>        MessageBox MB_OK '$$PARTNUMBER={$PARTNUMBER}$\n$$DESCRIPTION={$DESCRIPTION}$\n$$PRICE={$PRICE}'<br>SectionEnd<br><br>Function LineFindCallback<br>        ${TrimNewLines} '$R9' $R9<br>        ${WordFind} '$R9' '$\t' "+1" $1<br>        StrCmp $1 $FINDIT_PARTNUMBER 0 end<br><br>        StrCpy $PARTNUMBER $1<br>        ${WordFind} '$R9' '$\t' "+2" $DESCRIPTION<br>        ${WordFind} '$R9' '$\t' "+3" $PRICE<br>        StrCpy $0 StopLineFind<br><br>        end:<br>        Push $0<br>FunctionEnd</code>
</pre>
    </div>
    <hr>

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]></script></body></html>