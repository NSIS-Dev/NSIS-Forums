<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="description" content="is JAVA installed?"><title>is JAVA installed? - NSIS Forums</title><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script><link rel="preload" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css" as="style" onload="this.rel='stylesheet'"><link rel="preload" href="../css/style.css" as="style" onload="this.rel='stylesheet'"><noscript><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css"><link rel="stylesheet" href="../css/style.css"></noscript><script>!function(a){"use strict";var b=function(b,c,d){function e(a){return h.body?a():void setTimeout(function(){e(a)})}function f(){i.addEventListener&&i.removeEventListener("load",f),i.media=d||"all"}var g,h=a.document,i=h.createElement("link");if(c)g=c;else{var j=(h.body||h.getElementsByTagName("head")[0]).childNodes;g=j[j.length-1]}var k=h.styleSheets;i.rel="stylesheet",i.href=b,i.media="only x",e(function(){g.parentNode.insertBefore(i,c?g:g.nextSibling)});var l=function(a){for(var b=i.href,c=k.length;c--;)if(k[c].href===b)return a();setTimeout(function(){l(a)})};return i.addEventListener&&i.addEventListener("load",f),i.onloadcssdefined=l,l(f),i};"undefined"!=typeof exports?exports.loadCSS=b:a.loadCSS=b}("undefined"!=typeof global?global:this);!function(a){if(a.loadCSS){var b=loadCSS.relpreload={};if(b.support=function(){try{return a.document.createElement("link").relList.supports("preload")}catch(b){return!1}},b.poly=function(){for(var b=a.document.getElementsByTagName("link"),c=0;c<b.length;c++){var d=b[c];"preload"===d.rel&&"style"===d.getAttribute("as")&&(a.loadCSS(d.href,d,d.getAttribute("media")),d.rel=null)}},!b.support()){b.poly();var c=a.setInterval(b.poly,300);a.addEventListener&&a.addEventListener("load",function(){b.poly(),a.clearInterval(c)}),a.attachEvent&&a.attachEvent("onload",function(){a.clearInterval(c)})}}}(this);</script></head><body><div class="container"><ol class="breadcrumb"><li><a href="../index.html" class="glyphicon glyphicon-home"></a></li><li><a href="f-65.html">NSIS Discussion</a></li><li class="active">is JAVA installed?</li></ol><p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=185751">is JAVA installed?</a></p><br><div class="post"><p class="post-meta"><span class="post-author text-primary">TobWen</span><br><span class="post-time small text-muted">7th July 2004 06:03 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>is JAVA installed?</strong><br>&nbsp; Hi there,<br><br>does anybody know, how 2 check, if JAVA is installed and activated or not?<br>Some people deactivated JAVA or some Win98-users didn't install it at all.<br><br>Thanks for help<br>Tobias</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Davion</span><br><span class="post-time small text-muted">7th July 2004 13:09 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">I think you can check this in the registry...<br><br>but I don't know where to search<br><br>try to find the regkey of Java<br>(most simple way is imho to search for the installdir of it)<br><br>and then let your installer check for a value in this key...<br><br>should work<br><br>You may check if its activated somewhere in the regkey of the IE<br><br>but M$ unfortunatly encrypts its damn keys<br><br>just try it, should work as I said, maybe someone here knows where to search for it<br><br>hope this helps Dave</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">TobWen</span><br><span class="post-time small text-muted">7th July 2004 13:11 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">yeah, that's the only way... I thought of it, too.<br>Have to find my Win98se-CD and install it on my old machine.<br><br>I don't know, what key it is in Win98se :-)</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Davion</span><br><span class="post-time small text-muted">7th July 2004 13:14 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">don't know if it's similar on other systems, but on win2k there is a folder: "C:\WINNT\java\trustlib\com\ms\mtx"<br><br>there are a few .class files in it<br><br>if this folder depends on if java is installed or not you could check for some files?<br><br>just an idea...<br><br><br><br>[EDIT]<br>Found a better way:<br>HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Java VM<br><br>I think they ARE depending on an installed Java VM :D<br>[/EDIT]</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">zimsms</span><br><span class="post-time small text-muted">7th July 2004 13:23 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">ReadRegStr $JAVA_VER HKLM "SOFTWARE\JavaSoft\Java Runtime Environment"<br><br><br>or browse the archive, there are at least five answers and examples on doing this there. for example, here's <a href="http://nsis.sourceforge.net/archive/viewpage.php?pageid=457" target="_blank">one</a>.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">TobWen</span><br><span class="post-time small text-muted">7th July 2004 13:36 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">thanks</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">vun</span><br><span class="post-time small text-muted">16th July 2004 07:09 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Hi I have a question regarding the above-mentioned link to the archives. I am a newbie to programming so I hope that these questions are not redundant.<br><br>From: Locate Java Runtime/JRE, ensure correct version, write CLASSPATH, PATH and JAVA_HOME to .bat file.<br><br>-----------------------------------------------------------<br>Section "JRE Locate and Set Path and Classpath Section"<br>JRECheckAndEnvSection<br>Call LocateJVM<br>StrCmp "" $JAVA_INSTALLATION_MSG Success OpenBrowserToGetJava<br><br>Success:<br>Call SetEnv<br>Goto Done<br><br>OpenBrowserToGetJava:<br>Exec '"explorer.exe" ${GET_JAVA_URL}'<br><br>Done:<br>SectionEnd<br>-----------------------------------------------------------<br>For the above code, is the JRECheckAndEnvSection a function?<br><br>and<br><br>-----------------------------------------------------------<br>Function SetEnv<br>Push $3<br>Push $4<br><br>FileOpen $4 "$INSTDIR\setEnv.cmd" w<br>StrCpy $3 "Set<br>CLASSPATH=$JAVA_HOME\jre\lib\rt.jar;$JAVA_HOME\lib\dt.jar;%CLASSPATH%"<br>FileWrite $4 "$3"<br>-----------------------------------------------------------<br>What is the purpose of the "w" on the line of:<br>FIleOpen $4 "$INSTDIR\setEnv.cmd" w<br><br>Thank you!</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">zimsms</span><br><span class="post-time small text-muted">16th July 2004 14:58 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"></p><pre>
<code>
Section "JRE Locate and Set Path and Classpath Section" JRECheckAndEnvSection 
<br>&gt;
</code>
</pre>JRECheckAndEnvSection is the name to use for the section when enabling or disabling the section via the sections.nsh selectivity functions.<br>
      <br>
      <pre>
<code>
FIleOpen $4 "$INSTDIR\setEnv.cmd" w 
<br>&gt;
</code>
</pre>The w stands for opening the file in write mode. It could also be a for append, or r for read only.
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">vun</span><br>
      <span class="post-time small text-muted">19th July 2004 03:23 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Thanks zimsms. But when I compile the script using Make NSISW, it prompts me an error for JRECheckAndEnvSection. The error I get is Invalid Command<br>
      <br>
      Do I have to declare JRECheckAndEnvSection or something? Thanks once again!!</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br>
      <span class="post-time small text-muted">19th July 2004 11:39 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"></p>
      <pre>
<code>Section "JRE Locate and Set Path and Classpath Section" JRECheckAndEnvSection</code>
</pre><br>
      <br>
      There's no new-line in there.<br>
      <br>
      -Stu
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">zimsms</span><br>
      <span class="post-time small text-muted">19th July 2004 13:43 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Afrow UK, Thanks. I take it PHP uses wordwrap, and color where SOURCE uses neither?</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">vun</span><br>
      <span class="post-time small text-muted">20th July 2004 02:19 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Thanks! Really appreciate all your help.</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">vun</span><br>
      <span class="post-time small text-muted">20th July 2004 02:42 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Sorry...it's me again. I have to create an installer that will install and run Apache Tomcat server on the client's pc. I am just wondering if I am looking at the correct example from the archive. The example I am looking at is <a href="http://nsis.sourceforge.net/archive/viewpage.php?pageid=457" target="_blank">here</a></p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">zimsms</span><br>
      <span class="post-time small text-muted">20th July 2004 13:12 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Sorry, I haven't done anything with NSIS and Apache. But <a href="http://nsis.sourceforge.net/archive/viewpage.php?pageid=168" target="_blank">this</a> or <a href="http://nsis.sourceforge.net/archive/viewpage.php?pageid=428" target="_blank">this</a> might help.</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">vun</span><br>
      <span class="post-time small text-muted">21st July 2004 03:39 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Thanks zimsms! Appreciate your help :)</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">vun</span><br>
      <span class="post-time small text-muted">23rd July 2004 05:18 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Hi its me again. I have another question. I have to include in my installer a feature that will automatically update the class path and set the environment variables. I know that there are examples in the archive but I dont really understand them. I already have an example script that I think does this but I am not sure. I just want to know if I am on the right track. Here is the script. Thanks!</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">vun</span><br>
      <span class="post-time small text-muted">2nd August 2004 09:10 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Hi I just wanted to know that if I had to place the script to check the java version together with my main script or place it in a new file or create a batch file for it. My script is attached below. Thanks!</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">vun</span><br>
      <span class="post-time small text-muted">12th August 2004 05:34 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Hi I have another question.<br>
      <br></p>

      <blockquote>
        FileOpen $4 "$INSTDIR\setEnv.cmd" w<br>
        StrCpy $3 "Set CLASSPATH =<br>
        $JAVA_HOME\jre\lib\rt.jar;$JAVA_HOME\lib\dt.jar;%CLASSPATH%"<br>
        FileWrite $4 "$3"
        <hr>
      </blockquote>
    </div>
    <hr>
    What does the rt and the dt in StrCpy $3 "Set CLASSPATH =<br>
    $JAVA_HOME\jre\lib\rt.jar;$JAVA_HOME\lib\dt.jar;%CLASSPATH%" mean. And does this code automatically update the registry string when i run my installer. Thanks!<br>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">vun</span><br>
      <span class="post-time small text-muted">17th August 2004 10:08 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Hey...another question. My installer will have to automatically set the class path and the environment variables while it is extracting the files. The code that i refer to is <a href="http://nsis.sourceforge.net/archive/nsisweb.php?page=216&amp;instances=0,11,211" target="_blank">this</a>. Can someone please be kind enough to tell me if I am looking at the right script because my previous 3 questions have not been answered :cry:. But thats ok cause i managed to find out the answers to the previous 3 questions myself ;). And if I am not looking at the right script can someone pls inform me where i should be looking. This question has been really puzzling me. Thanks so much!<br>
      <br>
      PS: As i mentioned in one of my earlier questions, I only have knowledge in Java and I am a student doing my attachment and have no knowledge on assembly language. So I apologise if this question seems redundant. Thanks again.</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">zimsms</span><br>
      <span class="post-time small text-muted">17th August 2004 14:10 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Use <a href="http://nsis.sourceforge.net/archive/viewpage.php?pageid=137" target="_blank">this</a>.<br>
      <br>
      To append to an existing variable you will first want to read in the current value, append the new value then push that onto the stack.<br>
      <br>
      <br>
      For Example, in this example we will append to the PATH variable.<br></p>
      <pre>
<code><br>Section "Append Env Var"<br>  ReadEnvStr $0 "PATH"<br>  Push "PATH"<br>  Push "$0;c:\Example"<br>  Call WriteEnvStr<br>SectionEnd<br></code>
</pre><br>
      <br>
      To create a new environment variable:<br>
      <br>
      <pre>
<code><br>Section "Add Env Var"<br>  Push "EXAMPLEVAR"<br>  Push "MyExample"<br>  Call WriteEnvStr<br>SectionEnd<br></code>
</pre><br>
      <br>
      <br>
      Cheers!<br>
      <br>
      P.S. Sorry for not replying to the others, I was on vacation.
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">vun</span><br>
      <span class="post-time small text-muted">18th August 2004 05:40 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Hey welcome back zimsms...hope you had a good vacation. Thanks for your help. I'll try it out and see if it works.</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">vun</span><br>
      <span class="post-time small text-muted">19th August 2004 06:00 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Hi...me again. I just want to know if I am on the right track. My installer will have to extract all the files that I am installing on its own. I am looking at the script example from <a href="http://forums.winamp.com/showthread.php?s=&amp;threadid=189493&amp;highlight=extract+files" target="_blank">this</a> forum thread. Does this script do what I think it does i.e. extract the files while the software is being installed?<br>
      <br>
      Thanks in advance!</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">zimsms</span><br>
      <span class="post-time small text-muted">19th August 2004 13:15 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">No, it doesn't do what you think it does. What type of file do you need to extract (.zip, .rar. cab)? If your going to include a compressed file within your install your install will require more disk space (almost triple) in order to install. Why include a compressed file when the installer is going to compress it at compile time anyways.<br>
      <br>
      However, if you want to proceed with installing a compressed file you will have to do the following. (In pseudocode)<br>
      <br>
      ; Reserve the file<br>
      Reservefile blah.cab<br>
      ; in .oninit initialize the plugins folder<br>
      ; in .oninit place the file into the plugins folder<br>
      setoutpath "$pluginsdir"<br>
      file /oname="$pluginsdir\blah.cab" "blah.cab"<br>
      <br>
      ; Then you would need to extract the cab file using the cab.dll plugin. (You can find this and examples on doing this easily by searching the forum. If your not using a cab file then do a search on zip or compression.<br>
      <br>
      ; continue with your install.</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">vun</span><br>
      <span class="post-time small text-muted">20th August 2004 09:45 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Thanks zimsms...I owe you big time for that tip you gave me about the installer compressing my files. I was not aware of that. I will use the default compression that the installer creates for me. Thank you once again for all your help. I really appreciate it!!</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">vun</span><br>
      <span class="post-time small text-muted">31st August 2004 05:33 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Hi. I have hit another brick wall.Here's my problem. Let's say if I were to install Java and the value of Java in the registry is lesser than the one that I am installing, my installer will have to update that value. It will also have to delete that value when I run the uninstaller. I am looking at one of the archive examples but am not sure if it is the right example and does what I need my installer to do. <a href="http://nsis.sourceforge.net/archive/viewpage.php?pageid=91" target="_blank">This</a> is the script that I am looking at. I hope someone would be kind enough to tell me if I am on the right track.<br>
      <br>
      Thanks in advance!</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">zimsms</span><br>
      <span class="post-time small text-muted">31st August 2004 13:39 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">You can have more than one Java runtime or SDK installed at the same time. If you don't find the one you need in the registry, you should either, a) inform the user they need a specific version of the runtime and have them install it before proceeding, or b) install that specific requirement for them.<br>
      <br>
      All that script does that you posted is append a specified string to the PATH environment variable. It's not really that useful in this situation unless you include the specific java runtime as part of your app and pre append the applications path to the PATH environment variable every time you start.<br>
      <br>
      Anyways, I hope that helps.</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">vun</span><br>
      <span class="post-time small text-muted">1st September 2004 03:22 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Hi zimsms..i'm sorry but I did not really understand what your exlpanation in the second paragraph meant.For your understanding, i'll tell you what my installer already does.When the installer runs, it will extract the files and inform the user of the Java version they have in their system. If this version is lesser than j2sdk1.2, the installer will launch the j2sdk installation wizard. It should also update the registry once the installation i scomplete. I also have already placed the code that I took from the archive that I posted in my previous question. I have attached my script below for your reference. I just want to know if what you told me to include in my installer is already in my script and if they're not there, what i am missing. I'm sorry to keep bothering you but i'm really confused and I really appreciate all your help.<br>
      <br>
      Thanks.</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">zimsms</span><br>
      <span class="post-time small text-muted">1st September 2004 13:29 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Quote:</p>
      <hr>

      <div class="post">
        <p class="post-meta"><span class="post-author text-primary">vun</span><br>
        <span class="post-time small text-muted">2nd September 2004 03:00 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

        <p class="post-content">Thanks zimsms! Your help is greately appreciated :D</p>
      </div>
      <hr>

      <div class="footer">
        <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
      </div>

      <table cellpadding="6" cellspacing="0" border="0" width="100%">
        <tr>
          <td class="alt2">
            <hr>
            I just want to know if what you told me to include in my installer is already in my script I looked at your script. Everything you said it was supposed to do is there, as well as, the portion I was talking about in the second paragraph.<br>
            <br>

            <blockquote>
              I'm sorry to keep bothering you but i'm really confused and I really appreciate all your help.
            </blockquote>Not a problem. That's why the forum exists. Besides, if I didn't have time to respond, I probably wouldn't! ;).</td></tr></table></div></div></body></html>