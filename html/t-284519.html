<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="How do I set permissions on a registry key?" />

  <title>How do I set permissions on a registry key? - NSIS Forums</title>
  <script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script>
  <!-- Bootstrap core CSS -->

  <link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css" />
  <link rel="stylesheet" href="../css/style.css" type="text/css" /><!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!--[if lt IE 9]>
                <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
                <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->
</head>

<body>
  <div class="container">
    <!-- Put navigation bar here -->

    <ol class="breadcrumb">
      <li><a href="../index.html" class="glyphicon glyphicon-home"></a></li>

      <li><a href="f-65.html">NSIS Discussion</a></li>

      <li class="active">How do I set permissions on a registry key?</li>
    </ol>

    <p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=284519">How do I set permissions on a registry key?</a></p><br />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">drachs</span><br />
      <span class="post-time small text-muted">7th January 2008 03:38 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>How do I set permissions on a registry key?</strong><br />
      I have been trying the following snippet from the wiki, but it only returns the error message, "Root key name missing", as if the accesscontrol plugin isn't getting my parameters, can anyone help?<br />
      <br />
      Push $0 ; save<br />
      Push "Marker"<br />
      ; Set registry ACL's to let "everyone (S-1-1-0)" access the registry settings<br />
      AccessControl::GrantOnRegKey HKLM "${PRODUCT_DIR_REGKEY}" "everyone" "FullAccess"<br />
      Pop $0 ; get "Marker" or error msg<br />
      StrCmp $0 "Marker" Continue<br />
      MessageBox MB_OK|MB_ICONSTOP "Error setting access control for registry: $0"<br />
      Pop $0 ; pop "Marker"<br />
      Continue:<br />
      Pop $0 ; restore</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Anders</span><br />
      <span class="post-time small text-muted">7th January 2008 03:51 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">IIRC, AccessControl uses HKLM\foo\bar style paths</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">drachs</span><br />
      <span class="post-time small text-muted">7th January 2008 18:07 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">After expanding my variable, my AccessControl line looks like this:<br />
      <br />
      AccessControl::GrantOnRegKey HKLM "Software\Microsoft\Windows\CurrentVersion\App Paths\DerbyAv.exe" "everyone" "FullAccess"<br />
      <br />
      According to all the examples and the code that ships with the package, the HKLM should be separate, I did try them together though, and no luck.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
      <span class="post-time small text-muted">7th January 2008 19:59 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Hello, there was a bug.<br />
      <a href="http://nsis.sourceforge.net/File:AccessControl.zip" target="_blank">http://nsis.sourceforge.net/File:AccessControl.zip</a><br />
      <br />
      Stu</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">drachs</span><br />
      <span class="post-time small text-muted">7th January 2008 22:33 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Thanks Stu, I also found the one liner on my end this afternoon, it's good to know someone is maintaining this.<br />
      <br />
      David</p>
    </div>
    <hr />

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]>
  </script>
</body>
</html>
