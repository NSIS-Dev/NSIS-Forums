<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="description" content="How to close..."><title>How to close... - NSIS Forums</title><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script><link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css"><link rel="stylesheet" href="../css/style.css" type="text/css"><!--[if lt IE 9]><script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script><script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script><![endif]--></head><body><div class="container"><ol class="breadcrumb"><li><a href="../index.html" class="glyphicon glyphicon-home"></a></li><li><a href="f-65.html">NSIS Discussion</a></li><li class="active">How to close...</li></ol><p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=176806">How to close...</a></p><br><div class="post"><p class="post-meta"><span class="post-author text-primary">Ferekikoo</span><br><span class="post-time small text-muted">16th April 2004 00:53 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>How to close...</strong><br>How can i close a running program before i start copying the new files...<br>please put a example with the answer!:D :winamp:</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">deguix</span><br><span class="post-time small text-muted">16th April 2004 03:13 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><b>1)</b></p><pre>
<code>FindWindow$R0</code><span style="color: #DD0000">"ProcessName"
</span>
</pre>And after:<br><br><pre>
<code>SendMessage$R0</code><span style="color: #007700">${</span><span style="color: #0000BB">WM_QUIT</span><span style="color: #007700">}
</span>
</pre>OR<br><br><pre>
<code>SendMessage$R0</code><span style="color: #007700">${</span><span style="color: #0000BB">WM_CLOSE</span><span style="color: #007700">}
</span>
</pre>Replace "ProcessName" with the name of the process to close (with a window as "WM" means "Window Messages").<br><br><b>Note</b>: Sometimes ${WM_CLOSE} has a different effect than ${WM_QUIT}, test both messages to see what happens with the program.<br><br><b>OR</b><br><br><b>2)</b> To follow this way you need the plugin "KillProcDLL" which you can find on the Archive.<br><br><pre>
<code>KillProcDLL</code><span style="color: #007700">::</span><span style="color: #0000BB">KillProc</span><span style="color: #DD0000">"ProgramToClose.exe"
</span>
</pre>Replace "ProgramToClose.exe" with the program you want to close.</div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Ferekikoo</span><br><span class="post-time small text-muted">18th April 2004 23:43 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>Thanx</strong><br>Thanks it work!:D :winamp:</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Ferekikoo</span><br><span class="post-time small text-muted">20th April 2004 19:51 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">When i use this code this error appere in the log<br><br>Code:<br></p><pre>
<code>FindWindow $R0 "ProcessName"<br>SendMessage $R0 ${WM_QUIT}<br></code>
</pre>Error:<br>
      <pre>
<code>SendMessage expects 4-6 parameters, got 2.<br></code>
</pre><br>
      :rolleyes: :rolleyes:
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">deguix</span><br>
      <span class="post-time small text-muted">20th April 2004 20:17 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Whoops:<br>
      <br></p>
      <pre>
<code>SendMessage$R0</code><span style="color: #007700">${</span><span style="color: #0000BB">WM_QUIT</span><span style="color: #007700">}</span><span style="color: #DD0000">""""
</span>
</pre>OR<br>
      <br>
      <pre>
<code>SendMessage$R0</code><span style="color: #007700">${</span><span style="color: #0000BB">WM_CLOSE</span><span style="color: #007700">}</span><span style="color: #DD0000">""""
</span>
</pre>(I thought these were working because you said so...)
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Ferekikoo</span><br>
      <span class="post-time small text-muted">20th April 2004 20:47 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>SORRY...</strong><br>
      i'm sorry i ment the KillProcDLL plugin...<br>
      Thanks again... :up: :up: :up: :D</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Ferekikoo</span><br>
      <span class="post-time small text-muted">21st April 2004 00:47 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>???</strong><br>
      I tried it but nothing happend ??#!$ :cry:</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">deguix</span><br>
      <span class="post-time small text-muted">21st April 2004 03:19 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Process is not a program file, is a space in memory of an aplication running, in this case you need to know the name of the process that the main window of Winamp.exe is identified. In this case, the process name is "BaseWindow_RootWnd".</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Ferekikoo</span><br>
      <span class="post-time small text-muted">21st April 2004 11:15 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">I'm soooooooo sorry but it also didn't work!!!<br>
      if you can please write the nsi file &amp; attach it with the answer.... :( :( :(<br>
      Also please write how to get the process name for any program...</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Ferekikoo</span><br>
      <span class="post-time small text-muted">21st April 2004 11:16 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">I forget the attachment !:D</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Ferekikoo</span><br>
      <span class="post-time small text-muted">21st April 2004 12:14 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">I found this and it works with winamp 5 :up:<br>
      <a href="http://nsis.sourceforge.net/archive/viewpage.php?pageid=86" target="_blank">Close/exit a program</a></p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Takhir</span><br>
      <span class="post-time small text-muted">21st April 2004 12:23 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">FindWindow user_var(hwnd output) windowclass [windowtitle]<br>
      Second parameter is a top level (if [windowparent] parameter was omitted) window class name, not a process name. Looking from my corner, process may have or may have not window. "BaseWindow_RootWnd" looks like class name, but I am not sure - you can get correct class name using Spy++ utility. If you can close running program using Ctrl-Alt-Del, this trick should work with WM_CLOSE from NSIS script.</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">deguix</span><br>
      <span class="post-time small text-muted">21st April 2004 20:44 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Whoops, yeah you're right. I need to relax before answering a question, or I get it wrong...</p>
    </div>
    <hr>

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]></script></body></html>