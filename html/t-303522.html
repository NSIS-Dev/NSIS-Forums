<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="Call Function from DLL witch returns True or False" />

  <title>Call Function from DLL witch returns True or False - NSIS Forums</title>
  <script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script>
  <!-- Bootstrap core CSS -->

  <link rel="stylesheet" type="text/css" href="//netdna.bootstrapcdn.com/bootswatch/3.0.1/readable/bootstrap.min.css" />
  <link rel="stylesheet" href="../css/style.css" type="text/css" /><!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!--[if lt IE 9]>
                <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
                <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->
</head>

<body>
  <div class="container">
    <!-- Put navigation bar here -->

    <ol class="breadcrumb">
      <li><a href="../index.html" class="glyphicon glyphicon-home"></a></li>

      <li><a href="f-65.html">NSIS Discussion</a></li>

      <li class="active">Call Function from DLL witch returns True or False</li>
    </ol>

    <p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=303522">Call Function from DLL witch returns True or False</a></p><br />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">marcel-slip</span><br />
      <span class="post-time small text-muted">26th February 2009 09:36 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>Call Function from DLL witch returns True or False</strong><br />
      Hello,<br />
      <br />
      I have a library. Dll file that has the function of checking the key in the registry. Library returns the value true or false. Can this somehow be supported by NSIS?<br />
      Here is an code with InstallShield:<br />
      <br />
      <br /></p>

      <blockquote>
        prototype BOOL werk.werk();<br />
        prototype NUMBER werk.WriteToReg(POINTER, POINTER, POINTER);<br />
        prototype NUMBER werk.CreateRegKey();<br />
        <br />
        function BOOL VerifySerial()<br />
        STRING szFileName;<br />
        ã€€ã€€NUMBER nResult;<br />
        ã€€ã€€BOOL bVerified;<br />
        beginã€€<br />
        ã€€ szFileName = SUPPORTDIR ^ "some.dll";<br />
        <br />
        ã€€ nResult = UseDLL(szFileName);<br />
        ã€€ if (nResult=0) then<br />
        ã€€ã€€ã€€bVerified = some.some();<br />
        ã€€ elseã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€<br />
        ã€€ ã€€bVerified = FALSE;<br />
        ã€€ ã€€MessageBox(@MSG_DLLERROR, INFORMATION);<br />
        ã€€ endif;<br />
        ã€€ nResult = UnUseDLL(szFileName);<br />
        ã€€<br />
        ã€€ return bVerified;<br />
        end;
      </blockquote>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
      <span class="post-time small text-muted">26th February 2009 11:12 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Call it with the System plug-in.<br />
      <br />
      Edit: Or convert it to an NSIS plug-in.<br />
      Or write the code in NSIS.<br />
      <br />
      Stu</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">marcel-slip</span><br />
      <span class="post-time small text-muted">26th February 2009 12:01 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Thank you for your reply.<br />
      I don't know how to do this. I do not have access to the source libraries and at the worst I have enough time to perform;)<br />
      Any example?</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
      <span class="post-time small text-muted">26th February 2009 12:11 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">There are many many examples of the 3 options I have outlined. You will find them here, on the Wiki and with your NSIS installation.<br />
      <br />
      Stu</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">marcel-slip</span><br />
      <span class="post-time small text-muted">27th February 2009 09:07 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Hello<br />
      <br />
      <br />
      I'm not as good with nsis-a. I tried to do is this:<br />
      <br /></p>

      <blockquote>
        Function some<br />
        SetOutPath c:\temp<br />
        File test.dll<br />
        System::Call 'test.dll::work() b(r0)'<br />
        DetailPrint 'Path: "$0"'<br />
        Dumpstate::debug ;test variable<br />
        FunctionEnd
        <hr />
      </blockquote>
    </div>
    <hr />
    <br />
    I do not see any effect, the variable 0 has no value assigned<br />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Anders</span><br />
      <span class="post-time small text-muted">27th February 2009 09:18 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">there is no such thing as b, you need to read the system plugin readme, you can't just make up types!<br />
      <br />
      the windows BOOL type is 4 bytes, use i<br />
      the c++ bool type is 1 byte</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">marcel-slip</span><br />
      <span class="post-time small text-muted">27th February 2009 10:22 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Thank you very much for your help.<br />
      The following function works:<br />
      Quote:</p>
      <hr />

      <div class="footer">
        <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
      </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
      hljs.initHighlightingOnLoad();
      //]]>
      </script>

      <table cellpadding="6" cellspacing="0" border="0" width="100%">
        <tr>
          <td class="alt2">
            <hr />
            Function werk<br />
            SetOutPath c:\temp<br />
            File test.dll<br />
            System::Call 'test.dll::work() i() .r3'<br />
            FunctionEnd The $3 is the state of 0-folse or 1-true
          </td>
        </tr>
      </table>
    </div>
  </div>
</body>
</html>
