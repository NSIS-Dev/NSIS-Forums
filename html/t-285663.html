<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="description" content="Problem with a Simple LabVIEW Installer using the Nullsoft Install System (NSIS)"><title>Problem with a Simple LabVIEW Installer using the Nullsoft Install System (NSIS) - NSIS Forums</title><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script><link rel="preload" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css" as="style" onload="this.rel='stylesheet'"><link rel="preload" href="../css/style.css" as="style" onload="this.rel='stylesheet'"><noscript><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css"><link rel="stylesheet" href="../css/style.css"></noscript><script>!function(a){"use strict";var b=function(b,c,d){function e(a){return h.body?a():void setTimeout(function(){e(a)})}function f(){i.addEventListener&&i.removeEventListener("load",f),i.media=d||"all"}var g,h=a.document,i=h.createElement("link");if(c)g=c;else{var j=(h.body||h.getElementsByTagName("head")[0]).childNodes;g=j[j.length-1]}var k=h.styleSheets;i.rel="stylesheet",i.href=b,i.media="only x",e(function(){g.parentNode.insertBefore(i,c?g:g.nextSibling)});var l=function(a){for(var b=i.href,c=k.length;c--;)if(k[c].href===b)return a();setTimeout(function(){l(a)})};return i.addEventListener&&i.addEventListener("load",f),i.onloadcssdefined=l,l(f),i};"undefined"!=typeof exports?exports.loadCSS=b:a.loadCSS=b}("undefined"!=typeof global?global:this);!function(a){if(a.loadCSS){var b=loadCSS.relpreload={};if(b.support=function(){try{return a.document.createElement("link").relList.supports("preload")}catch(b){return!1}},b.poly=function(){for(var b=a.document.getElementsByTagName("link"),c=0;c<b.length;c++){var d=b[c];"preload"===d.rel&&"style"===d.getAttribute("as")&&(a.loadCSS(d.href,d,d.getAttribute("media")),d.rel=null)}},!b.support()){b.poly();var c=a.setInterval(b.poly,300);a.addEventListener&&a.addEventListener("load",function(){b.poly(),a.clearInterval(c)}),a.attachEvent&&a.attachEvent("onload",function(){a.clearInterval(c)})}}}(this);</script></head><body><div class="container"><ol class="breadcrumb"><li><a href="../index.html" class="glyphicon glyphicon-home"></a></li><li><a href="f-65.html">NSIS Discussion</a></li><li class="active">Problem with a Simple LabVIEW Installer using the Nullsoft Install System (NSIS)</li></ol><p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=285663">Problem with a Simple LabVIEW Installer using the Nullsoft Install System (NSIS)</a></p><br><div class="post"><p class="post-meta"><span class="post-author text-primary">bonzo3671</span><br><span class="post-time small text-muted">25th January 2008 19:52 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>Problem with a Simple LabVIEW Installer using the Nullsoft Install System (NSIS)</strong><br>Hello there,<br><br>My first posting to this group and my first use of using NSIS in earnest.<br><br>I'm trying to build a simple multiple part installer. I've been through the very through example of merging various installers here:<br><br><a href="http://nsis.sourceforge.net/Embedding_other_installers" target="_blank">http://nsis.sourceforge.net/Embedding_other_installers</a><br><br>The particular installer (setup.exe) I'm having trouble with is built using National Instruments LabVIEW 8.2.1. Their installer is based on MSI. I created my LabVIEW executable, created their MSI wrapper installer and tried to call it with the simple wizard installer created using HM NIS Editor 2.0.3. I'm using NSIS 2.34<br><br>When I run my three part NSIS installer, the first two parts install correctly but the LabVIEW MSI installer bugs out when it trys to run the "setup.exe". The dialog prompts with the following:<br><br>"Fatal Error. Unable to find initialization file.<br><br>.\ConfigInfo.cpp(2642): IInstallerError 11005<br>Fatal Error. Unable to find initialization file.<br>File C:\Program Files\My application\setup.ini not found."<br><br>It seems to be pointing to a setup.ini in the destination directory, I don't reference this in my NSIS installer. In my LabVIEW MSI installer, the setup.exe is paired with two files nidist.id and setup.ini. The nidist.id contains the DistributionGUID and DistPackageGUID. The setup.ini is National Instruments MSI configuration and it makes a requiremetn to have WindowsInstaller-KB893803-v2-x86.exe version 3.0.0.0 installed.<br><br>Here's a snippet of my .nsi script file:<br><br>Section "My NSIS test application" SEC03<br>File "setup.exe"<br>ExecWait "$INSTDIR\setup.exe"<br>; ExecWait '"msiexec" /i "$INSTDIR\setup.exe" /passive'<br>; ExecWait "$INSTDIR\setup.exe /s /v"/qb"<br>SectionEnd<br><br>I've tried changing the ExecWait command to see if this makes the difference (see commented out lines) but to no avail. Which one should I be using for MSI's?<br><br>Can anyway point me in the right direction here?<br><br>Many thanks,<br>Chroma</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">bonzo3671</span><br><span class="post-time small text-muted">25th January 2008 19:54 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">The link seems to have been ommitted:<br><br>nsis.sourceforge.net/Embedding_other_installers</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">kichik</span><br><span class="post-time small text-muted">26th January 2008 20:57 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Maybe you could figure out where it looks for setup.ini using <a href="http://technet.microsoft.com/en-us/sysinternals/bb896642.aspx" target="_blank">FileMon</a> and put it there.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">bonzo3671</span><br><span class="post-time small text-muted">31st January 2008 00:01 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Note sure I understand. I am very familiar with FileMon. When the installer runs it creates a temp dir in my Local settings dir, with the following files:<br><br>modern-wizard.bmp<br>ioSpecial.ini<br>InstallOptions.dll<br><br>It then yields the error as I mentioned previously,<br><br>".\ConfigInfo.cpp(2642): IInstallerError 11005<br>Fatal Error. Unable to find initialization file.<br>File C:\Program Files\Metrosol\setup.ini not found."<br><br>These temp files are then removed.<br><br>The other two installers that I kick off before this installer do not have setup.ini files associated with them. These installers work fine and I based the NSIS installer on the NSIS example link I sighted earlier.<br><br>If I place the third installers setup.ini file in the required destination folder (C:\Program Files\xxx), it yields the following error<br><br>".\ConfigInfo.cpp(2653): IInstallerError 11006<br>Developer Error. The following errors were found in your ini file:<br>1. Specified file not found: [MsiEngine] WinNTPath = supportfiles\WindowsInstaller-KB893803-v2-x86.exe<br><br>Correct the ini file and try again.<br>&lt;No Debug Message&gt;"<br><br>I seem to be no further forward.<br><br>Questions:<br><br>1) Am I missing something with regard to how I am calling ExecWait in the NSIS install script?<br>2) Where is the original error coming from? Is is NSIS or the National Instruments NSI installer?<br>3) Are there any tools I can use to log the NSIS installer as it fires?<br><br>Any help greatly appreciated.<br><br>Many thanks,<br>Chroma</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">kichik</span><br><span class="post-time small text-muted">1st February 2008 13:16 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">The problem here is not with ExecWait, it's with the executed installer. All of these errors are generated by it. It seems like it's missing some files, like setup.ini and a folder called supportfiles. I made that comment about FileMon because I've assumed you've extracted those files in the wrong folder and the installer couldn't find them.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">bonzo3671</span><br><span class="post-time small text-muted">1st February 2008 20:04 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">I have the following folders in my NSIS installer executable directory:<br><br>\MyInstall.exe - my NSIS, named changed to protect innocent!<br>\nidist.id - NI Distribution and DistPackage GUIDs config file<br>\setup.exe - the NI SETUP I'm trying to execute<br>\setup.ini - NI file<br>\supportfiles - NI misc files (dir)<br>\license - NI Released License Agreement (dir)<br>\bin - National Instruments Installer packages (dir)<br>\installers - my other installers (dir)</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">kichik</span><br><span class="post-time small text-muted">1st February 2008 20:17 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">But according to the error, they're looked for in $INSTDIR and not $EXEDIR. Put them there instead.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">bonzo3671</span><br><span class="post-time small text-muted">1st February 2008 20:49 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">I'm not sure I understand. Isn't the installer supposed to dynamically create the output EXE directory? Are you asking me to create this in advance of running the main NSIS installer?<br><br>Perhaps I'm getting the wrong end of the stick here, but which files do you suggest I move around? Please note that I used the NSIS example link, as my template and none of the other installer in that example have a setup.ini<br><br>-Chroma</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">kichik</span><br><span class="post-time small text-muted">1st February 2008 20:56 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">OK, then we'll start from the beginning. Those errors you are getting have nothing to do with your NSIS installer. You're getting them because the installer your installer is executing can't find some files.<br><br>You said all the required files are located right besides your installer, which is $EXEDIR. But you execute the other installer from $INSTDIR.<br><br>Assuming both the other installer and the files it's looking for should be in one place, you only have two options. Either execute the other installer from $EXEDIR or move the files to $INSTDIR.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">bonzo3671</span><br><span class="post-time small text-muted">1st February 2008 21:29 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">I greatly appreciate your patience on this issue!<br><br>Here's currently what I have:<br><br>Section "installer1" SEC01<br>File "installers\installer1.exe"<br>ExecWait "$INSTDIR\installer1.exe"<br>SectionEnd<br>;------------------------------------------------------------------------------------------------------<br>Section "installer2" SEC02<br>File "installers\installer2.exe"<br>ExecWait "$INSTDIR\installer2.exe"<br>SectionEnd<br>;------------------------------------------------------------------------------------------------------<br>Section "My NI LabVIEW App Installer" SEC03<br>File "setup.exe"<br>ExecWait "$INSTDIR\setup.exe"<br><br><br>You're suggesting I change the above script to this:<br><br>Section "installer1" SEC01<br>File "installers\installer1.exe"<br>ExecWait "$INSTDIR\installer1.exe"<br>SectionEnd<br>;------------------------------------------------------------------------------------------------------<br>Section "installer2" SEC02<br>File "installers\installer2.exe"<br>ExecWait "$INSTDIR\installer2.exe"<br>SectionEnd<br>;------------------------------------------------------------------------------------------------------<br>Section "My NI LabVIEW App Installer" SEC03<br>File "setup.exe"<br>ExecWait "$EXEDIR\setup.exe"<br><br>Is this correct?<br><br>-Chroma</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">kichik</span><br><span class="post-time small text-muted">1st February 2008 21:35 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">No, that would not be enough. Executing the installer from $EXEDIR won't work if you still extract it to $INSTDIR. Setting the working directory to $EXEDIR might work though... SetOutPath also sets the working directory. So try extracting the installer to $INSTDIR, setting the working directory to $EXEDIR and executing the installer from $INSTDIR. If that doesn't work, extract the installer to $EXEDIR or just don't compress it.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">bonzo3671</span><br><span class="post-time small text-muted">1st February 2008 22:52 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">I tried the changes you suggested (changing the line ExecWait "$INSTDIR\setup.exe" to ExecWait "$EXEDIR\setup.exe", as shown). This seems to work. For the record, my SetOutPath is "$INSTDIR".<br><br><br>Could you illustrate the two scenarios you suggested in terms of the NSIS script I currently use? I don't won't to make any mistakes, having come so far on this one! Apologies for being a burden here!<br><br>-Chroma</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">kichik</span><br><span class="post-time small text-muted">1st February 2008 22:59 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">I'm not sure I understand what you're asking me to explain and how. The two scenarios I've described are related to the way the other installer (not a NSIS installer) deals with the files it needs.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">bonzo3671</span><br><span class="post-time small text-muted">1st February 2008 23:13 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Yes, I understand what you are saying regarding the other installer (the non-NSIS installer). What I was looking for was the two scenarios explained in terms of the script snippet I described.<br><br>Section "installer1" SEC01<br>File "installers\installer1.exe"<br>ExecWait "$INSTDIR\installer1.exe"<br>SectionEnd<br>;------------------------------------------------------------------------------------------------------<br>Section "installer2" SEC02<br>File "installers\installer2.exe"<br>ExecWait "$INSTDIR\installer2.exe"<br>SectionEnd<br>;------------------------------------------------------------------------------------------------------<br>Section "My NI LabVIEW App Installer" SEC03<br>File "setup.exe"<br>ExecWait "$EXEDIR\setup.exe"<br><br>This seems to work for me, but is this the best practice way of doing an installer of this type (a multi-part mixed installer)?<br><br>-Chroma</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">kichik</span><br><span class="post-time small text-muted">1st February 2008 23:21 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Well, if you have files beside your installer which are not compressed into the installer, I assume you're using a CD distribution or something similar. In that case, it's recommended you don't compress the other installers into your installer. That would only take time compressing and decompressing something that's already compressed. This way, you can also make sure the right directory structure is kept without any scripting.<br><br>There is no one recommended way for an installer that executes other installers. It depends on the end result you're looking for and the executed installers.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">bonzo3671</span><br><span class="post-time small text-muted">2nd February 2008 21:56 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">I think I have enough information to continue developing my application. Thanks for all your assistance and patience, it's greatly appreciated.<br><br>-Chroma</p></div><hr><div class="footer"><p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p></div></div><script src="../js/highlight.pack.js" type="text/javascript"></script><script type="text/javascript">//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]></script></body></html>