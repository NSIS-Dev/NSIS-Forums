<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="Resume installation after reboot" />

  <title>Resume installation after reboot - NSIS Forums</title><!-- Bootstrap core CSS -->
  <link rel="stylesheet" type="text/css" href="//netdna.bootstrapcdn.com/bootswatch/3.0.1/readable/bootstrap.min.css" />
  <link rel="stylesheet" href="../css/style.css" type="text/css" /><!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!--[if lt IE 9]>
                <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
                <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->
</head>

<body>
  <div class="container">
    <!-- Put navigation bar here -->

    <ol class="breadcrumb">
      <li><a href="../index.html" class="glyphicon glyphicon-home"></a></li>

      <li><a href="f-65.html">NSIS Discussion</a></li>

      <li class="active">Resume installation after reboot</li>
    </ol>

    <p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=198950">Resume installation after reboot</a></p><br />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">hafizsohaib</span><br />
      <span class="post-time small text-muted">11th November 2004 10:52 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>Resume installation after reboot</strong><br />
      Resume installation after reboot<br />
      Hi all,<br />
      <br />
      I need the installer to resume the installation process after a system reboot. Is it possible to acheive this using NSIS?<br />
      <br />
      Help appreciated! Thanks!</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">deguix</span><br />
      <span class="post-time small text-muted">11th November 2004 12:34 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Hey, calm down... You never should create new topics based on the same question more than one time.<br />
      <br />
      You can't do it with NSIS naturally, but you can create 2 installers in which one of them will be executed when the computer restarts. You can use the code below to make Windows to execute the second installer when the computer restarts next time:<br />
      <br /></p>
      <pre>
<code>WriteRegStr "HKLM" "SOFTWARE\Microsoft\Windows\CurrentVersion\RunOnce" "Program Name" "C:\Path\To\File.exe"</code>
</pre>(Where "Program Name" is the name of the program, and "C:\Path\To\File.exe" is where the second installer is located)
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">fredtheman</span><br />
      <span class="post-time small text-muted">11th November 2004 13:26 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"></p>

      <blockquote>
        You can't do it with NSIS naturally, but you can create 2 installers in which one of them will be executed when the computer restarts
      </blockquote>... or use only one, and just use some data on the hard disk that tells the installer in which state it is (ie. first pass run, or second pass run after rebooting), and add itself in the Run section of the Registry so that it is run the next time the computer reboots. Just remember to remove this entry after the second pass is over.
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
      <span class="post-time small text-muted">11th November 2004 19:30 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Please don't create multiple threads for the same question. The other threads have been moved.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">TrifonovS</span><br />
      <span class="post-time small text-muted">10th November 2013 21:22 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Hi!<br />
      <br />
      The mechanism to start the installer after reboot in the middle of the installation using RunOnce section in the registry works fine, but I need to continue the installer from the position that it was restarted. I know that I can use a plug-in to jump on the needed state. But before the reboot I have to store some data, needed for the second reboot (for example the page that the installer have to jump, the selected components and so on...). The question is where to store the data? I can write it on the HDD, but where (temp folder???) or in the registry,... What is the typical storage for such information in such case? I don't have experience with this and I need advice what is the best way to do it.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">jpderuiter</span><br />
      <span class="post-time small text-muted">10th November 2013 22:54 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">You can add a commandline switch in the RunOnce entry, and check it with <a href="http://nsis.sourceforge.net/Docs/AppendixE.html#E.1.11" target="_blank">GetParameters</a> and <a href="http://nsis.sourceforge.net/Docs/AppendixE.html#E.1.12" target="_blank">GetOptions</a> on startup of your installer</p>
    </div>
    <hr />

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]>
  </script>
</body>
</html>
