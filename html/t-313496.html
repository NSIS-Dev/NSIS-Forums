<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="Suppress UAC" />

  <title>Suppress UAC - NSIS Forums</title>
  <script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script>
  <!-- Bootstrap core CSS -->

  <link rel="stylesheet" type="text/css" href="//netdna.bootstrapcdn.com/bootswatch/3.0.1/readable/bootstrap.min.css" />
  <link rel="stylesheet" href="../css/style.css" type="text/css" /><!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!--[if lt IE 9]>
                <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
                <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->
</head>

<body>
  <div class="container">
    <!-- Put navigation bar here -->

    <ol class="breadcrumb">
      <li><a href="../index.html" class="glyphicon glyphicon-home"></a></li>

      <li><a href="f-65.html">NSIS Discussion</a></li>

      <li class="active">Suppress UAC</li>
    </ol>

    <p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=313496">Suppress UAC</a></p><br />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">june1212</span><br />
      <span class="post-time small text-muted">7th October 2009 17:27 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>Suppress UAC</strong><br />
      How to suppress UAC in Vista? I need my installer.exe run totally automatically.But if the UAC is on on Vista, it need user elevates.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">MSG</span><br />
      <span class="post-time small text-muted">7th October 2009 17:34 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">requestexecutionlevel user<br />
      <br />
      <a href="http://nsis.sourceforge.net/Docs/Chapter4.html#4.8.1.32" target="_blank">http://nsis.sourceforge.net/Docs/Chapter4.html#4.8.1.32</a><br />
      <br />
      (Of course, this will not grant you administrative access. But that is the whole point of the administrator password.)</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">june1212</span><br />
      <span class="post-time small text-muted">7th October 2009 20:29 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">thanks. Does that mean I must login as a user instead of admin to run the installer?</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">MSG</span><br />
      <span class="post-time small text-muted">7th October 2009 20:35 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">No. It just means that any user running the installer will NOT get the UAC elevation prompt on Win Vista and higher. (Remember, Windows UAC pops up even for Administrator users when they run an admin-only application.)</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Anders</span><br />
      <span class="post-time small text-muted">7th October 2009 20:37 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">admins are members of the user group (normally)<br />
      <br />
      It just means you can't write to programfiles/windir/HKLM etc</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">june1212</span><br />
      <span class="post-time small text-muted">7th October 2009 20:41 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">I tried the user, still have the "Allow/Cancel" prompt. Is that because I have some statements in the script to write to HKLM, and copy files to ProgramFiles?</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Anders</span><br />
      <span class="post-time small text-muted">7th October 2009 20:51 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">did you put "requestexecutionlevel user" in your script?</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">june1212</span><br />
      <span class="post-time small text-muted">7th October 2009 21:00 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">yes, i do<br />
      <br />
      RequestExecutionLevel user /* RequestExecutionLevel REQUIRED! for UAC Plugin*/<br />
      InstallDirRegKey HKLM "${PRODUCT_DIR_REGKEY}" ""<br />
      <br />
      There are other registry writing lines in -Post<br />
      <br />
      Then I log into my Vista as an account in Admin group, and run this installer.exe from %Public%. Still have the "Allow/Cancel" prompt.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">june1212</span><br />
      <span class="post-time small text-muted">7th October 2009 21:02 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">But I also have your UAC plugin in the .onInit<br />
      UAC::RunElevated<br />
      <br />
      Is that causing the prompt?</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Anders</span><br />
      <span class="post-time small text-muted">7th October 2009 21:03 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">um, yes, what do you think RunElevated means?</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">june1212</span><br />
      <span class="post-time small text-muted">7th October 2009 21:10 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"></p>

      <blockquote>
        <i>Originally posted by Anders</i><br />
        <b>um, yes, what do you think RunElevated means?</b>
      </blockquote>Hehe, that is added by a NSIS expert guy from my company:-)<br />
      <br />
      By the way, if I set it run as user, what will be the diff as admin? THis installer copies files to ProgramFiles, add registry for the product, and install a windows service. Can User priviledge aproach that?<br />
      <br />
      Thanks
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">june1212</span><br />
      <span class="post-time small text-muted">7th October 2009 21:24 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">I take out the UAC plugin. But installing windows service has "Access is denied" error. Does that mean, I must use admin in the "RequestExecutionLevel"?</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">MSG</span><br />
      <span class="post-time small text-muted">8th October 2009 07:50 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Yes. Unless you are using the NSIS UAC plugin, which is a special case. In that case, you need to use requestexecutionlevel user.<br />
      <br />
      The point is: If you want your installer to do something that only admins are allowed to do, naturally the installer will need admin access.</p>
    </div>
    <hr />

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]>
  </script>
</body>
</html>
