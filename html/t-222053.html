<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="Newbie need help" />

  <title>Newbie need help - NSIS Forums</title>
  <script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script>
  <!-- Bootstrap core CSS -->

  <link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css" />
  <link rel="stylesheet" href="../css/style.css" type="text/css" /><!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!--[if lt IE 9]>
                <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
                <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->
</head>

<body>
  <div class="container">
    <!-- Put navigation bar here -->

    <ol class="breadcrumb">
      <li><a href="../index.html" class="glyphicon glyphicon-home"></a></li>

      <li><a href="f-65.html">NSIS Discussion</a></li>

      <li class="active">Newbie need help</li>
    </ol>

    <p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=222053">Newbie need help</a></p><br />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">landgrimtham</span><br />
      <span class="post-time small text-muted">21st July 2005 07:52 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>Newbie need help</strong><br />
      hi all a newbie here. and i need some help in solving this problem. Can anyone help me? The program keep prompting me "no files found"<br />
      <br />
      thanks all<br />
      <br />
      <br />
      InstallDir: "$PROGRAMFILES\EngWin"<br />
      Section: "EngWin"<br />
      Call "InstallVBDLLs"<br />
      SetOutPath: "$(WinSysPathSysFile)"<br />
      File: "RICHED32.DLL" -&gt; no files found.<br />
      Usage: File [/nonfatal] [/a] ([/r] filespec [...]|/oname=outfile one_file_only)<br />
      Error in script "C:\Documents and Settings\ptham.ATA\Desktop\IMPT DATELINE END OF SEP\testing.nsi" on line 281 -- aborting creation process</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Yathosho</span><br />
      <span class="post-time small text-muted">21st July 2005 08:38 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">make sure the RICHED32.DLL is in the same directory as your script or specify a path to that file (i.e. File "$SYSDIR\RICHED32.DLL")</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
      <span class="post-time small text-muted">21st July 2005 12:05 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">What's with all the SetOutPath "$INSTDIR/Miscellaneous" and Push $INSTDIR/Miscellaneous\Busy.bmp<br />
      It's \ not / in Windows.<br />
      <br />
      -Stu</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">landgrimtham</span><br />
      <span class="post-time small text-muted">22nd July 2005 06:24 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">thanks bro Yathosho<br />
      <br />
      the code works but now i have another problem while compiling. The upgradedll is giving me a problem. Can anyone help?<br />
      <br />
      <br />
      !define: "UPGRADEDLL_UNIQUE"="2.9"<br />
      SetOverwrite: try<br />
      StrCpy $R4 "$SYSDIR\Asycfilt.dll" () ()<br />
      StrCpy $R5 "$SYSDIR" () ()<br />
      IfFileExists: "$R4" ? 0 : upgradedll.copy_2.9<br />
      ClearErrors<br />
      GetDLLVersionLocal: error reading version info from ".\Asycfilt.dll"<br />
      Error in macro UpgradeDLL on macroline 26<br />
      !include: error in script: "C:\Program Files\NSIS\Include\installVB.nsh" on line 2<br />
      Error in script "C:\Documents and Settings\ptham\Desktop\IMPT DATELINE END OF SEP\testing.nsi" on line 42 -- aborting creation process<br />
      <br />
      Here is the edited version of the nsi script.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">landgrimtham</span><br />
      <span class="post-time small text-muted">22nd July 2005 06:26 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Bro afrow UK,<br />
      <br />
      i'm trying to import the VB setup to a NISI script by using a program that *search 4 vbconvert* i have found here but it seems that i have some bugz that i need to squash before i can use it... :(</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
      <span class="post-time small text-muted">22nd July 2005 13:01 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">GetDLLVersionLocal is failing there. Perhaps Asycfilt.dll in use or something?<br />
      <br />
      -Stu</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">landgrimtham</span><br />
      <span class="post-time small text-muted">25th July 2005 05:12 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"></p>

      <blockquote>
        <i>Originally posted by Afrow UK</i><br />
        <b>GetDLLVersionLocal is failing there. Perhaps Asycfilt.dll in use or something?<br />
        <br />
        -Stu</b>
      </blockquote>how do i check whether the dll is in use which i dont think it is. :igor:
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Comperio</span><br />
      <span class="post-time small text-muted">25th July 2005 05:58 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">usually if a file is 'in use', you can't rename it. You might also get the error if for some reason you don't have permissions to the file. (Are you using the correct path to the DLL?)<br />
      <br />
      I'd first try to make sure that you can access the version info from the file Asycfilt.dll from Windows Explorer. If you can and you know the paths are correct, then try to rename the file. If you can't rename, the file is probably in use. (If it does let you rename, remember to rename it back to what it was!)</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">landgrimtham</span><br />
      <span class="post-time small text-muted">25th July 2005 10:55 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"></p>

      <blockquote>
        <i>Originally posted by Comperio</i><br />
        <b>usually if a file is 'in use', you can't rename it. You might also get the error if for some reason you don't have permissions to the file. (Are you using the correct path to the DLL?)<br />
        <br />
        I'd first try to make sure that you can access the version info from the file Asycfilt.dll from Windows Explorer. If you can and you know the paths are correct, then try to rename the file. If you can't rename, the file is probably in use. (If it does let you rename, remember to rename it back to what it was!)</b>
      </blockquote>Hi comperio,<br />
      <br />
      i have tried the method that u advice and try to rename the file and the file is not "in used" i can rename it whenever i please. So i went to the root problem which is the installvb file.<br />
      <br />
      i tried to directly point to the source but it return me this error when i compile.<br />
      <br />
      Call ":upgradedll.file_2.9"<br />
      Rename: /REBOOTOK $R0-&gt;$R4<br />
      GetTempFileName -&gt; $R0<br />
      File: "C:\Program Files\NSIS\Contrib\Library\RegTool\RegTool.bin" -&gt; no files found.<br />
      Usage: File [/nonfatal] [/a] ([/r] [/x filespec [...]] filespec [...] |<br />
      /oname=outfile one_file_only)<br />
      Error in macro UpgradeDLL on macroline 62<br />
      !include: error in script: "C:\Program Files\NSIS\Include\installVB.nsh" on line 2<br />
      Error in script "C:\Documents and Settings\ptham\Desktop\IMPT DATELINE END OF SEP\testing.nsi" on line 42 -- aborting creation process<br />
      <br />
      is the error that i have be getting becoz of this error? :mad:
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">landgrimtham</span><br />
      <span class="post-time small text-muted">26th July 2005 04:18 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">can it be becoz of my pc setting that is affecting my script? :cry:</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Comperio</span><br />
      <span class="post-time small text-muted">26th July 2005 05:22 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">You seem to be missing a lot of the pieces to make this work. (Has this ever sucessfully compiled on this PC?)<br />
      <br />
      I looked at your 1st and 2nd attachments. They don't quite tell the whole story. In the main script, I can see that asside from the MUI, 3 other files are being included: upgradeDll.nsh, shareddll.nsh, and installvb.nsh.<br />
      <br />
      I can see in the last file (installvb.nsh) that there are several calls being made to the macro named "UpgradeDLL" and to the function named "AddSharedDLL". My best guess would be that the problem lies somewhere on one of these two.<br />
      <br />
      Unfortunately, neither one of these are included in the files you've sent, so I assume that they live in one of the other 2 NSH files (shareddll.nsh or upgradedll.nsh). I'd examine both to see what they are doing--perhaps it will shed some light on what else you might be missing.<br />
      <br />
      Also: you never did mention whether or not you were able obtain the version info from the file Asycfilt.dll from within Windows explorer.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">landgrimtham</span><br />
      <span class="post-time small text-muted">26th July 2005 07:32 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"></p>

      <blockquote>
        <i>Originally posted by Comperio</i><br />
        <b>You seem to be missing a lot of the pieces to make this work. (Has this ever sucessfully compiled on this PC?)<br />
        <br />
        I looked at your 1st and 2nd attachments. They don't quite tell the whole story. In the main script, I can see that asside from the MUI, 3 other files are being included: upgradeDll.nsh, shareddll.nsh, and installvb.nsh.<br />
        <br />
        I can see in the last file (installvb.nsh) that there are several calls being made to the macro named "UpgradeDLL" and to the function named "AddSharedDLL". My best guess would be that the problem lies somewhere on one of these two.<br />
        <br />
        Unfortunately, neither one of these are included in the files you've sent, so I assume that they live in one of the other 2 NSH files (shareddll.nsh or upgradedll.nsh). I'd examine both to see what they are doing--perhaps it will shed some light on what else you might be missing.<br />
        <br />
        Also: you never did mention whether or not you were able obtain the version info from the file Asycfilt.dll from within Windows explorer.</b>
      </blockquote>yeb u r absolutly correct. the problem lies with the installvb and the upgradedll. *havent met with problems on the sharedll yet*<br />
      <br />
      as for the version info. i assume that *4give me* i goto property and click on the version tab to check. if that is so then i did and i can check the version. Renaming is also no problem 4 me. :igor:<br />
      <br />
      thanks again 4 ur help!! :)
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">landgrimtham</span><br />
      <span class="post-time small text-muted">26th July 2005 07:40 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"></p>

      <blockquote>
        <i>Originally posted by Comperio</i><br />
        <b>You seem to be missing a lot of the pieces to make this work. (Has this ever sucessfully compiled on this PC?)<br />
        <br /></b>
      </blockquote>no come to think of it it has not be successful. i have change pc twice and the 1st pc i'm able to compile successful using an older version of NSIS 1yr ago but now after changing pc i cant seem to get it working. I think my OS then was win98 while now i'm using win2k. does this cause a problem of the script?
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Comperio</span><br />
      <span class="post-time small text-muted">27th July 2005 05:23 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">See if this helps:<br />
      Since you install seems to be failing when installing the VB runtimes, I'd start with that.<br />
      <br />
      Looking at your full script, it appears that the script is using some older macros for updating DLLs. This could be part of where it's failing. You may find it easier to rewrite using the newer methods.<br />
      <br />
      I'd suggest reviewing Appendix B of the NSIS help files. It outlines how to use macros contained in library.nsh to install DLL. And there's a section dedicated to VB6 runtimes.<br />
      <br />
      Sorry I couldn't be more help.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">landgrimtham</span><br />
      <span class="post-time small text-muted">27th July 2005 08:28 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"></p>

      <blockquote>
        <i>Originally posted by Comperio</i><br />
        <b>See if this helps:<br />
        Since you install seems to be failing when installing the VB runtimes, I'd start with that.<br />
        <br />
        Looking at your full script, it appears that the script is using some older macros for updating DLLs. This could be part of where it's failing. You may find it easier to rewrite using the newer methods.<br />
        <br />
        I'd suggest reviewing Appendix B of the NSIS help files. It outlines how to use macros contained in library.nsh to install DLL. And there's a section dedicated to VB6 runtimes.<br />
        <br />
        Sorry I couldn't be more help.</b>
      </blockquote>thanks bro :up:
    </div>
    <hr />

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]>
  </script>
</body>
</html>
