<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="description" content="ListBox ListItems State No PreSelect"><title>ListBox ListItems State No PreSelect - NSIS Forums</title><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script><link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css"><link rel="stylesheet" href="../css/style.css" type="text/css"><!--[if lt IE 9]><script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script><script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script><![endif]--></head><body><div class="container"><ol class="breadcrumb"><li><a href="../index.html" class="glyphicon glyphicon-home"></a></li><li><a href="f-65.html">NSIS Discussion</a></li><li class="active">ListBox ListItems State No PreSelect</li></ol><p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=141798">ListBox ListItems State No PreSelect</a></p><br><div class="post"><p class="post-meta"><span class="post-author text-primary">bSecRes</span><br><span class="post-time small text-muted">11th July 2003 00:35 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>ListBox ListItems State No PreSelect</strong><br>I have a list box that I create on-the-fly for a custom page. For several reasons it would be great if I could have a default selection of the items:<br><br>1. I load this list box with potentially hundreds of items. For 99% of the people that will use the app, they'll only care about a couple of the items and won't want to have to dig to find them. Sure I could presort the list with the normal ones at the top but...<br><br>2. Because of the method I have to use to harvest the list, it takes a while to display the listboxes and impatient users will click next before they even see that listboxes are there.<br><br>3. Some people won't know what the options really are and I would like to preselect the safe/normal items for them.<br><br>Please consider adding this to the que or telling me why my idea is flawed. Thanks.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">n0On3</span><br><span class="post-time small text-muted">11th July 2003 04:22 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">I don't understand you. in the subject you say: "No PreSelect" but in the body you say that you want to preselect.<br><br>In case you want to preselect (I asume you are talking of InstallOptions) you can add a "State=selected-item-you-want" in the ini. Is that enough?</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">bSecRes</span><br><span class="post-time small text-muted">11th July 2003 05:44 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>Sorry for the Confusion</strong><br>After reading your answer I went back and tested my code some more it seems you are correct. The problem was that I have multiple ListItems with the same name. Only in the case of a unique name will it select something preloaded in the state field. Makes sense to me, it just so happens that all of the "normal" vaules that are in my list that I wanted to preselect all have duplicates also (Only those have duplicates in fact). Sorry for wasting your time, I spent a lot of time testing this but I never even considered the duplicate bit. Thanks for the help.<br><br>Example of problem:<br>[Field X]<br>Type=ListBox<br>Left=0<br>Right=140<br>Top=11<br>Bottom=100<br>Flags=MultiSelect|EXTENDEDSELCT<br>ListItems=--Nomral--|Jane|Gina|--Everyone--|Jane|Gina|Beth<br>State=Jane|Gina<br><br>The result is nothing shows up selected</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br><span class="post-time small text-muted">11th July 2003 16:41 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">You aren't using it right.<br><br>[Field X]<br>Type=ListBox<br>Left=0<br>Right=140<br>Top=11<br>Bottom=100<br>Flags=MultiSelect|EXTENDEDSELCT<br>ListItems=--Nomral--|Jane|Gina|--Everyone--|Jane|Gina|Beth<br>State=Jane<br><br><br>You had Jane and Gina to be readily selected, but of course, how can you have 2 selected?<br>You can't.<br><br>Edit:<br>Ok with multiselect on, then you should be able to.<br>Is this a bug?<br><br>-Stu</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">bSecRes</span><br><span class="post-time small text-muted">11th July 2003 18:12 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Status now is that I can do it. I don't know if someone fixed it or not, I just downloaded the latest CVS I may have been using an old version, but now it selects the first instance of that name in the list even when there are duplicates.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">kichik</span><br><span class="post-time small text-muted">12th July 2003 13:04 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">There were some code changes to this part since b3. It's possible one of the fixes was this.</p></div><hr><div class="footer"><p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p></div></div><script src="../js/highlight.pack.js" type="text/javascript"></script><script type="text/javascript">//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]></script></body></html>