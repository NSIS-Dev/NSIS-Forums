<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="description" content="Nit: MUI documentation as installed"><title>Nit: MUI documentation as installed - NSIS Forums</title><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script><link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css"><link rel="stylesheet" href="../css/style.css" type="text/css"></head><body><div class="container"><ol class="breadcrumb"><li><a href="../index.html" class="glyphicon glyphicon-home"></a></li><li><a href="f-65.html">NSIS Discussion</a></li><li class="active">Nit: MUI documentation as installed</li></ol><p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=228297">Nit: MUI documentation as installed</a></p><br><div class="post"><p class="post-meta"><span class="post-author text-primary">l_d_allan</span><br><span class="post-time small text-muted">12th October 2005 23:14 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>Nit: MUI documentation as installed</strong><br>When the NSIS documentation is installed locally, I'm encountering a script error when clicking on<br><br>2.5 Modern UI<br>&lt;&lt;Modern UI Examples&gt;&gt;<br><br>I believe this works on the web, but something was perhaps overlooked in the HtmlHelp workshop (.hhp?)<br><br>Or am I doing something wrong?</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">iceman_k</span><br><span class="post-time small text-muted">12th October 2005 23:38 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">I see the same problem. I am guessing that IE places restrictions on what shell open actions can be performed within a CHM file.<br>IMHO, this link needs to be removed from the documentation if it is going to be problematic.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">l_d_allan</span><br><span class="post-time small text-muted">13th October 2005 01:25 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Maybe, but other links work. I've built HtmlHelp .chm files, and the cause is typically something being left out of the .hhp, .hhc, or .hhk file ... if HtmlHelp Workshop or equivalent was used.<br><br>I took a look in CVS for the original (and maybe submit a patch), but didn't find them (may have been looking in all the wrong places.)</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">iceman_k</span><br><span class="post-time small text-muted">13th October 2005 03:21 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">The other links open files. The one that fails opens a folder. What is failing is the shell open call with the folder as the parameter.<br>Nothing was left out from the hhp. The same code is used for both the web as well as the chm help.<br>IMHO, it would be better if that link actually pointed to:<br><b>../Docs/Modern UI/Readme.html#examples</b>.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">kichik</span><br><span class="post-time small text-muted">13th October 2005 12:37 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">What exactly did you do to get this error? It always works for me, even with all security zones set to high level.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">iceman_k</span><br><span class="post-time small text-muted">13th October 2005 13:56 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Open the NSIS.chm file, go to section 2.5 and click on the "Modern UI Examples" link.<br>The attached error is seen.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">kichik</span><br><span class="post-time small text-muted">13th October 2005 14:00 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">That works just fine for me. There's also a try-catch block around that code to make sure this kind of messages don't come up. What might have you done differently? What OS do you use? What version of IE?</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">iceman_k</span><br><span class="post-time small text-muted">13th October 2005 14:17 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Windows XP Pro SP2<br>IE 6.0.2900.2180.xpsp_sp2_gdr.050301-1519<br>128 bit encryption<br>I am not quite sure why the error is being thrown. I debugged it using the MS script debugger and the problem is occurring with the ActiveXObject "Shell.Application".<br>BTW, there is no try catch block around the area where it is failing.<br>This is happening in chmlink.js and the problem line is 84:<br><br></p><pre>
<code><br>  if (FolderExists(lfn))<br>  {<br>    var objShell = new ActiveXObject("Shell.Application");<br>    objShell.Open(lfn);<br>  }<br></code>
</pre><br>
      <br>
      Perhaps you should call TryShellExec instead of directly trying to open the folder?
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br>
      <span class="post-time small text-muted">13th October 2005 14:25 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">I think it didn't work with TryShellExec, but I'm not sure. Want to give it a shot? I still can't reproduce this...</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">iceman_k</span><br>
      <span class="post-time small text-muted">13th October 2005 14:35 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">I will give it a shot.<br>
      And, oh, BTW, clicking on the same link on the NSIS web site help docs results in a 403 error:<br></p>

      <blockquote>
        Forbidden<br>
        You don't have permission to access /Examples/Modern UI/ on this server.<br>
        <br>
        Apache/1.3.33 Server at nsis.sourceforge.net Port 80
      </blockquote>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br>
      <span class="post-time small text-muted">13th October 2005 14:47 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Thanks, fixed.</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">iceman_k</span><br>
      <span class="post-time small text-muted">13th October 2005 14:57 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Well... it kind of works- the folder opens within the CHM browser instead of externally.<br>
      Let me investigate further.</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">iceman_k</span><br>
      <span class="post-time small text-muted">13th October 2005 15:32 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">After some playing around, I can't get it to work.<br>
      I think it may be related to Windows XP SP2 which added more stringent security wrt to scripting.<br>
      However, browsing to <b>file:///../Examples/Modern%20UI</b> does work.<br>
      I still feel that changing the link to<br>
      <b>../Docs/Modern UI/Readme.html#examples</b> would be a better idea, since this would also work on the NSIS web site.<br>
      [edit]<br>
      I see you fixed the web site, so maybe we continue with what we have now, except that you fall back to navigating to the file:/// URL if the shell open fails.<br>
      [/edit]</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br>
      <span class="post-time small text-muted">13th October 2005 15:50 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">I have XP SP2, that's not the problem.<br>
      <br>
      I can live with it falling back to opening the folder in the CHM window.</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">l_d_allan</span><br>
      <span class="post-time small text-muted">13th October 2005 15:58 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">These may be relevant re Local Machine Zone Lockdown:<br>
      <br>
      <a href="http://msdn.microsoft.com/security/productinfo/XPSP2/securebrowsing/locallockdown.aspx" target="_blank">http://msdn.microsoft.com/security/p...llockdown.aspx</a><br>
      <br>
      <a href="http://msdn.microsoft.com/security/productinfo/XPSP2/securebrowsing/lockdown_devimp.aspx" target="_blank">http://msdn.microsoft.com/security/p...wn_devimp.aspx</a><br>
      <br>
      <a href="http://weblogs.asp.net/jgalloway/archive/2004/08/20/218123.aspx" target="_blank">http://weblogs.asp.net/jgalloway/arc...20/218123.aspx</a><br>
      <br>
      I've wondered if HtmlHelp developers may be prone to encounter this hassle. And whether the end-users would experience problems with WinXp-SP2.<br>
      <br>
      There are references to "mark of the web" comments that seems to be a work-around.</p>
    </div>
    <hr>

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]></script></body></html>