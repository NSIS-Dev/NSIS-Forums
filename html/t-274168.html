<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="LockedList plug-in" />

  <title>LockedList plug-in - NSIS Forums</title><!-- Bootstrap core CSS -->
  <link rel="stylesheet" type="text/css" href="//netdna.bootstrapcdn.com/bootswatch/3.0.1/readable/bootstrap.min.css" />
  <link rel="stylesheet" href="../css/style.css" type="text/css" /><!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!--[if lt IE 9]>
                <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
                <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content=" LockedList plug-in" />

  <title>LockedList plug-in - NSIS Forums</title>
  <link rel="stylesheet" type="text/css" href="//netdna.bootstrapcdn.com/bootswatch/3.0.1/readable/bootstrap.min.css" />
  <link rel="stylesheet" href="../css/style.css" type="text/css" />
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content=" LockedList plug-in" />

  <title>LockedList plug-in - NSIS Forums</title>
  <link rel="stylesheet" type="text/css" href="//netdna.bootstrapcdn.com/bootswatch/3.0.1/readable/bootstrap.min.css" />
  <link rel="stylesheet" href="../css/style.css" type="text/css" />
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content=" LockedList plug-in" />

  <title>LockedList plug-in - NSIS Forums</title>
  <link rel="stylesheet" type="text/css" href="//netdna.bootstrapcdn.com/bootswatch/3.0.1/readable/bootstrap.min.css" />
  <link rel="stylesheet" href="../css/style.css" type="text/css" />
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content=" LockedList plug-in" />

  <title>LockedList plug-in - NSIS Forums</title>
  <link rel="stylesheet" type="text/css" href="//netdna.bootstrapcdn.com/bootswatch/3.0.1/readable/bootstrap.min.css" />
  <link rel="stylesheet" href="../css/style.css" type="text/css" />
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content=" LockedList plug-in" />

  <title>LockedList plug-in - NSIS Forums</title>
  <link rel="stylesheet" type="text/css" href="//netdna.bootstrapcdn.com/bootswatch/3.0.1/readable/bootstrap.min.css" />
  <link rel="stylesheet" href="../css/style.css" type="text/css" />
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content=" LockedList plug-in" />

  <title>LockedList plug-in - NSIS Forums</title>
  <link rel="stylesheet" type="text/css" href="//netdna.bootstrapcdn.com/bootswatch/3.0.1/readable/bootstrap.min.css" />
  <link rel="stylesheet" href="../css/style.css" type="text/css" />
</head>

<body>
  <div class="container">
    <!-- Put navigation bar here -->

    <ol class="breadcrumb">
      <li><a href="../index.html" class="glyphicon glyphicon-home"></a></li>

      <li><a href="f-65.html">NSIS Discussion</a></li>

      <li class="active">LockedList plug-in</li>
    </ol>

    <p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=274168">LockedList plug-in</a></p><br />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
      <span class="post-time small text-muted">10th July 2007 23:07 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>LockedList plug-in</strong><br />
      An NSIS plugin to display or get a list of programs that are locking a selection of files that have to be uninstalled or overwritten.<br />
      <br />
      <b><a href="http://nsis.sf.net/File:LockedList.zip" target="_blank">http://nsis.sf.net/File:LockedList.zip</a></b><br />
      <br />
      Stu</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
      <span class="post-time small text-muted">11th July 2007 11:05 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">v0.2 - 11th July 2007<br />
      * Better percent complete indication.<br />
      <br />
      Stu</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">daisywheel</span><br />
      <span class="post-time small text-muted">12th July 2007 07:34 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Hi Afrow UK,<br />
      <br />
      Even simple script<br />
      <br />
      LockedList::AddFile /NOUNLOAD $SYSDIR\kernel32.dll"<br />
      LockedList::Dialog<br />
      <br />
      doesn't work for me.<br />
      <br />
      I get messages "Going to compile test program and then run it"<br />
      then "The file '$TEMP\nsz1325.tmp\Lock' is now locked. It will appear on the LockedList dialog page soon..." some dialog blinks and that's all.<br />
      <br />
      The same result I've got with example provided with plugin.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
      <span class="post-time small text-muted">12th July 2007 12:12 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Firstly, you're missing a quote and secondly that's a module not a file.<br />
      <br />
      How about this script:<br /></p>
      <pre>
<code>Name "LockedList Test"<br />OutFile "LockedListTest.exe"<br /><br />!include MUI.nsh<br /><br />!insertmacro MUI_PAGE_WELCOME<br />Page Custom LockedListShow<br /><br />!insertmacro MUI_LANGUAGE English<br /><br />Function LockedListShow<br />  LockedList::AddModule /NOUNLOAD "$SYSDIR\kernel32.dll"<br />  LockedList::Dialog<br />FunctionEnd<br /><br />Section<br />SectionEnd</code>
</pre><br />
      <br />
      You'll get some garbage for the first program captions. I might be able to fix this.<br />
      <br />
      Stu
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">daisywheel</span><br />
      <span class="post-time small text-muted">12th July 2007 12:30 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Thank you for sample but it also doen't work for me.<br />
      It seems that the problem is exactly in LockedList::Dialog<br />
      <br />
      I modified your sample adding three message boxes<br />
      <br /></p>
      <pre>
<code><br />Name "LockedList Test"<br />OutFile "LockedListTest.exe"<br /><br />!include MUI.nsh<br /><br />!insertmacro MUI_PAGE_WELCOME<br />Page Custom LockedListShow<br /><br />!insertmacro MUI_LANGUAGE English<br /><br />Function LockedListShow<br />  MessageBox MB_OK "test1"<br />  LockedList::AddModule /NOUNLOAD "$SYSDIR\kernel32.dll"<br />  MessageBox MB_OK "test2"<br />  LockedList::Dialog<br />FunctionEnd<br /><br />Section<br /> MessageBox MB_OK "test3"<br />SectionEnd<br /></code>
</pre><br />
      <br />
      and I can see only two of them.
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
      <span class="post-time small text-muted">12th July 2007 13:32 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">You're not going to see the 3rd one because the dialog stops execution of the installer until it is closed.<br />
      What exactly happens? Does the dialog not display?<br />
      <br />
      Edit: Also, what OS are you on?<br />
      <br />
      Stu</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">daisywheel</span><br />
      <span class="post-time small text-muted">12th July 2007 13:50 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">dialog doesn't appear. installer is closed after message box "test2" closed.<br />
      <br />
      OS: WinXP SP2</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
      <span class="post-time small text-muted">12th July 2007 14:03 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">That's interesting. I'm running Win XP SP2 also.<br />
      <br />
      What happens if you don't use any AddFile/AddModules.<br />
      <br />
      Stu</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">daisywheel</span><br />
      <span class="post-time small text-muted">12th July 2007 14:59 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">ok, sorry for delay with answer. I had to deal with something.<br />
      now I'm sure that the problem is in LockedList::Dialog<br />
      <br />
      I have two vesions of script<br /></p>
      <pre>
<code><br />Name "LockedList Test"<br />OutFile "LockedListTest.exe"<br /><br />!include MUI.nsh<br /><b><br />!insertmacro MUI_PAGE_WELCOME<br /><br />!insertmacro MUI_PAGE_INSTFILES<br /><br />Page Custom LockedListShow<br /></b><br />!insertmacro MUI_LANGUAGE English<br /><br />Function LockedListShow<br />  MessageBox MB_OK "test1"<br />  LockedList::AddModule /NOUNLOAD "$SYSDIR\kernel32.dll"<br />  MessageBox MB_OK "test2"<br />  LockedList::Dialog<br />FunctionEnd<br /><br /><br />Section "Install"<br /> MessageBox MB_OK "test3"<br />SectionEnd<br /></code>
</pre><br />
      <br />
      and<br />
      <br />
      <pre>
<code><br />Name "LockedList Test"<br />OutFile "LockedListTest.exe"<br /><br />!include MUI.nsh<br /><b><br />!insertmacro MUI_PAGE_WELCOME<br /><br />Page Custom LockedListShow<br /><br />!insertmacro MUI_PAGE_INSTFILES<br /></b><br /><br />!insertmacro MUI_LANGUAGE English<br /><br />Function LockedListShow<br />  MessageBox MB_OK "test1"<br />  LockedList::AddModule /NOUNLOAD "$SYSDIR\kernel32.dll"<br />  MessageBox MB_OK "test2"<br />  LockedList::Dialog<br />FunctionEnd<br /><br /><br />Section "Install"<br /> MessageBox MB_OK "test3"<br />SectionEnd<br /></code>
</pre><br />
      <br />
      the first one shows message boxes<br />
      "test3"<br />
      "test1"<br />
      "test2"<br />
      <br />
      the second one<br />
      "test1"<br />
      "test2"<br />
      <br />
      diff:<br />
      !insertmacro MUI_PAGE_WELCOME<br />
      !insertmacro MUI_PAGE_INSTFILES<br />
      Page Custom LockedListShow<br />
      <br />
      !insertmacro MUI_PAGE_WELCOME<br />
      Page Custom LockedListShow<br />
      !insertmacro MUI_PAGE_INSTFILES<br />
      <br />
      we contact directly so I can help you debug plugin
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
      <span class="post-time small text-muted">12th July 2007 15:23 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">I'm aware that it is the plugin yes.<br />
      <br />
      My MSN is afrowuk at tiscali dot co dot uk<br />
      <br />
      Stu</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
      <span class="post-time small text-muted">12th July 2007 17:35 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Located the problem thanks to daisywheel :)<br />
      Please be patient while we make sure everything is ok then I shall upload the updated version.<br />
      <br />
      Stu</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
      <span class="post-time small text-muted">12th July 2007 17:54 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Uploaded v0.2 RC2.<br />
      <a href="http://nsis.sf.net/File:LockedList.zip" target="_blank">http://nsis.sf.net/File:LockedList.zip</a><br />
      <br />
      Stu</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">daisywheel</span><br />
      <span class="post-time small text-muted">12th July 2007 20:00 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">LockedList::AddModule /NOUNLOAD "$SYSDIR\module.dll"<br />
      LockedList::AddModule /NOUNLOAD "$SYSDIR\kernel32.dll"<br />
      <br />
      in case file module.dll doesn't exist will result error in functionality - there will no dependencies found<br />
      <br />
      in case we change order<br />
      LockedList::AddModule /NOUNLOAD "$SYSDIR\kernel32.dll"<br />
      LockedList::AddModule /NOUNLOAD "$SYSDIR\module.dll"<br />
      <br />
      plugin will work in another manner. I don't think this is expected behaviour.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
      <span class="post-time small text-muted">12th July 2007 23:44 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Found the problem. It was a bad array pointer. It wasn't the fact of the file not being there it was simply only taking the first file or module added with AddFile/AddModule.<br />
      <br />
      I was also able to fix the captions problem. I noticed captions were being repeated over multiple processes aside from the garbage caption for the first few processes. Just needed a ZeroMemory in there.<br />
      <br />
      Uploaded v0.2 RC3.<br />
      <a href="http://nsis.sf.net/File:LockedList.zip" target="_blank">http://nsis.sf.net/File:LockedList.zip</a><br />
      <br />
      Thanks again :)<br />
      <br />
      Stu</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">daisywheel</span><br />
      <span class="post-time small text-muted">13th July 2007 08:43 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">One more suggestion. I'm not compeltely happy with results.<br />
      For example, I have two browser application run: Internet Explorer and Moxilla Firefox both on page <a href="http://nsis.sourceforge.net/File:LockedList.zip" target="_blank">http://nsis.sourceforge.net/File:LockedList.zip</a><br />
      <br />
      also I use following code in a script<br /></p>
      <pre>
<code><br />LockedList::AddModule /NOUNLOAD "$SYSDIR\kernel32.dll"<br />LockedList::Dialog<br /></code>
</pre><br />
      and as results I've got<br />
      WINAMP.COM | Forums - LockedList plug-in - Moxilla Firefox (firefox.exe)<br />
      for Moxilla Firefox<br />
      and<br />
      AutoSuggest Drop-Down (iexplore.exe)<br />
      for IE
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
      <span class="post-time small text-muted">13th July 2007 11:09 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Currently it grabs the first window caption for that process id by using EnumWindows. I'll look into it. Maybe I can check if the window is a child or not and if it is then skip it.<br />
      <br />
      Stu</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
      <span class="post-time small text-muted">13th July 2007 14:11 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Realised that EnumWindows does not enumerate child windows anyway (that's what EnumChildWindows is for) so instead I'm checking to see if a window has the WS_SYSMENU style set (title bar). Now get the correct caption for Internet Explorer among others.<br />
      <br />
      Uploaded v0.3:<br />
      <a href="http://nsis.sourceforge.net/File:LockedList.zip" target="_blank">http://nsis.sourceforge.net/File:LockedList.zip</a><br />
      <br />
      I also documented the ::Unload function which has to be used to unload the plugin after calling SilentWait /NOUNLOAD /time #. Few other changes in the change log too.<br />
      <br />
      Stu</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">daisywheel</span><br />
      <span class="post-time small text-muted">13th July 2007 14:54 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Another suggestion.<br />
      <br />
      Add horizontal scroll when long name is displayed.<br />
      <br />
      For now horizontal scroll is added only together with vertical one (in some cases even when it's not necessary)<br />
      <br />
      Roman</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
      <span class="post-time small text-muted">13th July 2007 15:24 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">This isn't possible because the list box is actually a list view with a single hidden column set to the width of the box. The NSIS InstFiles page has the same thing. Another option would be to have a tool-tip like the InstFiles page...<br />
      <br />
      Stu</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
      <span class="post-time small text-muted">13th July 2007 15:36 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">You can use ListView_SetColumnWidth with LVSCW_AUTOSIZE, but I think the triple dot looks better. If someone wants to see the entire line, he could just hover over it instead of scrolling and then seeing just the end.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
      <span class="post-time small text-muted">13th July 2007 15:40 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Yeh I agree.<br />
      How does NSIS work out how long the text being displayed is?<br />
      I'm guessing it's not just down to the number of characters...<br />
      <br />
      Stu</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
      <span class="post-time small text-muted">13th July 2007 16:11 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Size of the list view minus the size of a scroll bar. Line 1568 of Source\exehead\ui.c.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
      <span class="post-time small text-muted">13th July 2007 16:17 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Yeh I've got that already... sorry meant the dots, but now I'm guessing that the list view control adds those itself anyway!!<br />
      <br />
      Stu</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
      <span class="post-time small text-muted">13th July 2007 16:22 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">The list view automatically shows the dots, but you need LVS_EX_LABELTIP for it to show the tool tip.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
      <span class="post-time small text-muted">13th July 2007 16:32 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Thanks found that in Ui.c too. Very neat that it's all provided :)<br />
      <br />
      Uploaded v0.3 RC2:<br />
      <a href="http://nsis.sourceforge.net/File:LockedList.zip" target="_blank">http://nsis.sourceforge.net/File:LockedList.zip</a><br />
      <br />
      Edit: Uploaded again as it had the test executable in the Zip (+50000 bytes or so)<br />
      <br />
      Stu</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Wizou</span><br />
      <span class="post-time small text-muted">5th September 2007 09:00 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Nice plugin and sources :)<br />
      <br />
      Thanks !</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kalverson</span><br />
      <span class="post-time small text-muted">10th September 2007 13:06 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">During testing of various locked items, I found a minor quirk. The locking process was detected going away for the exe's, but when I exited explore (brought up inside the target install directory), that was not detected going away. I had to navigate back and then next again to repeat the locked file search to get past it to the install. Also during testing, I ran into an "out of memory" message that appeared in the dialog just before the process name. That only happened once and did not repeat itself during futher testing.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">RobertStrong</span><br />
      <span class="post-time small text-muted">14th September 2007 11:50 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>Paths</strong><br />
      It appears that the plugin doesn't try both short and long paths so both need to be added for files / modules that may be in use with either a long or short path. Might be a nice addition for the plugin to check both behind the scenes.<br />
      <br />
      Better still would be the ability to match files / modules in use by file name and then compare the paths to verify they are the same. This would also cover the unlikely scenario where the path is a combination of both long and short. Also, files / modules names can be short.<br />
      <br />
      Besides that all I can say is wow... this is an extremely useful plugin.<br />
      <br />
      Thanks,<br />
      Robert</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
      <span class="post-time small text-muted">14th September 2007 13:35 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Ah right good find. I'll see what I can do about that when I've got some time.<br />
      <br />
      I plan on adding a 'file name only' lookup for the plug-in as well, and also the ability to simply show windows that have the task bar style set.<br />
      <br />
      Thanks<br />
      <br />
      Stu</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">RobertStrong</span><br />
      <span class="post-time small text-muted">14th September 2007 14:13 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>SilentSearch</strong><br />
      I just noticed that SilentSearch isn't working when the module is in use by another user. This is on Vista with fast user switching. Interestingly enough, LockedList::Dialog is able to find it.<br />
      <br />
      Thanks again,<br />
      Robert</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
      <span class="post-time small text-muted">14th September 2007 17:37 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">I shall see if I can reproduce this on my XP machine soon. I do not have Vista unfortunately. This is interesting though as they are both exactly the same code bases for both functions except one directs output to the stack and one to a list view control!<br />
      <br />
      Stu</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">RobertStrong</span><br />
      <span class="post-time small text-muted">15th September 2007 01:48 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">After a quick peruse of the code it appears that EnableDebugPriv is only called when using the internal ui (e.g. LoadDialog).<br />
      <br />
      *edit* that is the problem</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
      <span class="post-time small text-muted">15th September 2007 10:25 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Oh right woops :S<br />
      <br />
      Stu</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kalverson</span><br />
      <span class="post-time small text-muted">18th September 2007 13:23 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">LockedList Plug-in:<br />
      <br />
      The accelerator keys do not work for the next/back buttons. Only the mouse works.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kalverson</span><br />
      <span class="post-time small text-muted">18th September 2007 13:28 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Our tester has been experiancing an intermitant crash in the LockedList.dll plug-in. The crash happens during initialization (dialog is showing 0% on progress) The image captures is too large to attach. Here is the script used:<br />
      <br />
      ;<br />
      ; This function is called to display any locked files.<br />
      ;<br />
      Function LockedListShow<br />
      <br />
      ;Creator function<br />
      !insertmacro MUI_HEADER_TEXT "$(TEXT_IO_TITLElock)" "$(TEXT_IO_SUBTITLE2)"<br />
      <br />
      LockedList::AddFile /NOUNLOAD "$INSTDIR\${PRODUCT_NAME}"<br />
      LockedList::AddModule /NOUNLOAD "$INSTDIR\${PRODUCT_NAME}\${PRODUCT_LAUNCHER_EXE}"<br />
      LockedList::Dialog<br />
      <br />
      FunctionEnd<br />
      <br />
      Here is the crash information:<br />
      <br />
      LockedList.map<br />
      <br />
      0001:00001891 ?EnumSystemModules@@YGHP6GHUFILE_INFORMATION@@J@ZJ@Z 10002891 f SystemEnum.obj<br />
      0001:00001a97 ?EnumProcessIds@@YGHP6GHKJ@ZJ@Z 10002a97 f SystemEnum.obj<br />
      <br />
      offset from error signature: 000029b5<br />
      base of EnumSystemModules: 2891<br />
      -------------------------------------<br />
      124 relative --&gt; Line 478<br />
      <br />
      SystemEnum.asm<br />
      <br />
      ; 476 :<br />
      ; 477 : // Get the file path of the module.<br />
      ; 478 : if (GetModuleFileNameEx(hProcess, hModules[j], File.FullPath, MAX_PATH))<br />
      <br />
      push 260 ; 00000104H<br />
      mov eax, DWORD PTR [eax]<br />
      mov DWORD PTR _File$54859[ebp], eax<br />
      lea eax, DWORD PTR _File$54859[ebp+4]<br />
      push eax<br />
      mov eax, DWORD PTR -24+[ebp]<br />
      push DWORD PTR [eax]<br />
      push esi<br />
      call DWORD PTR _GetModuleFileNameEx<br />
      test eax, eax<br />
      je SHORT $L54877<br />
      <br />
      <br />
      SystemEnum.cod<br />
      ; Line 478<br />
      00109 68 04 01 00 00 push 260 ; 00000104H<br />
      0010e 8b 00 mov eax, DWORD PTR [eax]<br />
      00110 89 85 40 fd ff<br />
      ff mov DWORD PTR _File$54859[ebp], eax<br />
      00116 8d 85 44 fd ff<br />
      ff lea eax, DWORD PTR _File$54859[ebp+4]<br />
      0011c 50 push eax<br />
      0011d 8b 45 e8 mov eax, DWORD PTR -24+[ebp]<br />
      00120 ff 30 push DWORD PTR [eax]<br />
      00122 56 push esi<br />
      00123 ff 15 00 00 00<br />
      00 call DWORD PTR _GetModuleFileNameEx<br />
      00129 85 c0 test eax, eax<br />
      0012b 74 5c je SHORT $L54877<br />
      ; Line 481</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
      <span class="post-time small text-muted">27th September 2007 14:57 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">New version v0.4:<br />
      <a href="http://nsis.sourceforge.net/File:LockedList.zip" target="_blank">http://nsis.sourceforge.net/File:LockedList.zip</a><br />
      <br /></p>

      <blockquote>
        v0.4 - 27th September 2007<br />
        * Module or file names can now be just the file name as opposed to the full path.<br />
        * Folder paths are converted to full paths (some are short DOS paths) before comparison.<br />
        * Fixed typo in AddModule function (ModulesCount&gt;FilesCount). Thanks kalverson.<br />
        * List view is now scrolled into view while items are added.<br />
        * List changed to multiple columns.<br />
        * Debug privileges were not being set under SilentSearch.<br />
        * Added /ignore switch that prevents the Next button being disabled.<br />
        * Added AddApplications to add all running applications to the list.<br />
        * Added processing mouse cursor.<br />
        * Added right-click context menu with Close and Copy List options.<br />
        * Added progress bar.<br />
        * Added default program icon for processes without an icon.<br />
        * Added code to resize controls for different dialog sizes.
      </blockquote>I cannot reproduce that crash kalverson and by the looks of it it's out of my control, unless the module handle being passed is not valid. I could surround it by a try{} block but I am not keen on that idea.<br />
      <br />
      Stu
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">RobertStrong</span><br />
      <span class="post-time small text-muted">28th September 2007 00:37 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Thank you Stu!</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">jrhutch</span><br />
      <span class="post-time small text-muted">31st March 2008 17:33 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">I have a question about the LockedList plugin. Does AddFile support searching an entire directory? I couldn't find where it specifically said it was supported in the readme. I wanted to know that this is an option, before I go and try to fix my installer problems using this plugin.<br />
      <br />
      Hopefully it does, because this plugin looks awesome and is basically the perfect solution for what I'm trying to do.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
      <span class="post-time small text-muted">31st March 2008 17:54 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">You mean if the file is in a folder or possibly in sub folders?<br />
      <br />
      Stu</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">jrhutch</span><br />
      <span class="post-time small text-muted">31st March 2008 17:58 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Yes, I want it to search my entire application directory to make sure nothing is being used before I go and try to update files. I didn't see anywhere that said wildcards were supported, but if then are, then that is fantastic. Thank you!</p>
    </div>
    <hr />
    <!-- Bootstrap core CSS -->
    <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
                <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
                <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->

    <div class="container">
      <!-- Put navigation bar here -->

      <ol class="breadcrumb">
        <li><a href="../index.html" class="glyphicon glyphicon-home"></a></li>

        <li><a href="f-65.html">NSIS Discussion</a></li>

        <li class="active">LockedList plug-in</li>
      </ol>

      <p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=274168">LockedList plug-in</a></p><br />

      <div class="post">
        <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
        <span class="post-time small text-muted">31st March 2008 18:01 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

        <p class="post-content">Sorry, wild cards are only supported for window classes/captions. If your executable name is unique enough, just use AddModule \File.exe or AddFile \File.txt<br />
        <br />
        The appended \ ensures that it's a file under a folder and not just the end of a file name.<br />
        <br />
        Stu</p>
      </div>
      <hr />

      <div class="post">
        <p class="post-meta"><span class="post-author text-primary">jrhutch</span><br />
        <span class="post-time small text-muted">31st March 2008 19:11 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

        <p class="post-content">Sorry, my question was for adding multiple files, such as AddFile $Drive\SomeDirectory\*.*, or something to that effect.</p>
      </div>
      <hr />

      <div class="post">
        <p class="post-meta"><span class="post-author text-primary">Animaether</span><br />
        <span class="post-time small text-muted">21st April 2009 22:27 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

        <p class="post-content">I'm running into two problems with LockedList...<br />
        <br />
        1. It can't seem to detect that the files I specified are in use.<br />
        I'm using:<br /></p>
        <pre>
<code><br />LockedList::AddModule /NOUNLOAD "$SYSDIR\OurDLL.dll"<br /></code>
</pre><br />
        ( I take it /NOUNLOAD is still required even in the new NSIS handling? )<br />
        But as far as the search is concerned, the file is not locked. Unlocker ( <a href="http://ccollomb.free.fr/unlocker/" target="_blank">http://ccollomb.free.fr/unlocker/</a> ) says otherwise.<br />
        Any tools out there that might help in identifying why LockedList doesn't see it while Unlocker does?<br />
        ( I'd try whouses.exe as well, but I seem to be whouses.exe-less )<br />
        <br />
        <br />
        2. LockedList crashes after parsing two of such modules.<br />
        The search process reaches 93%, usually when it will display that it found no processes using the file(s), and simply crashes.<br />
        <br />
        Stu - if you need a dump for #2 (oh boy, bad puns), just let me know.
      </div>
      <hr />

      <div class="post">
        <p class="post-meta"><span class="post-author text-primary">Animaether</span><br />
        <span class="post-time small text-muted">27th April 2009 21:49 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

        <p class="post-content">well the crashes seem to have magically gone away - #1 remains an issue, however</p>
      </div>
      <hr />

      <div class="post">
        <p class="post-meta"><span class="post-author text-primary">freneticmonkey</span><br />
        <span class="post-time small text-muted">29th June 2009 02:27 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

        <p class="post-content">I have had a look at the source code for the lockedlist plugin and it currently only searches the first 127 modules or files loaded for a process. On my machine Internet Explorer with minimal extensions installed has 150+ modules loaded, which means that searching for ActiveX plugins usually fails.</p>
      </div>
      <hr />

      <div class="post">
        <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
        <span class="post-time small text-muted">29th June 2009 11:57 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

        <p class="post-content">Ah thanks for that. I will be home on Wednesday so will sort then.<br />
        <br />
        Stu</p>
      </div>
      <hr />

      <div class="post">
        <p class="post-meta"><span class="post-author text-primary">Ocrana</span><br />
        <span class="post-time small text-muted">7th July 2009 09:19 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

        <p class="post-content">Is there any problem known that LockedList crashes on XP?<br />
        I have some users with reports that the installer will crash after 60% of searching the running processes.<br />
        Bad Problem: This are users/customers and I do not have access to their computer to debug. ON all my computers and VM builds nothing crash.<br />
        If anyone know possible problems, like AV Scanners or similar things please let me know.<br />
        <br />
        Ocrana</p>
      </div>
      <hr />

      <div class="post">
        <p class="post-meta"><span class="post-author text-primary">Ocrana</span><br />
        <span class="post-time small text-muted">7th July 2009 09:23 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

        <p class="post-content">Hi, just to complete the information:<br />
        Installer will crash and computer will reboot automatic.<br />
        XP Home on a Intel CPU.<br />
        <br />
        Ocrana</p>
      </div>
      <hr />

      <div class="post">
        <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
        <span class="post-time small text-muted">7th July 2009 11:37 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

        <p class="post-content">The plug-in was developed on Windows XP and I never had a crash. Unless I can reproduce there's not much I can do I'm afraid.<br />
        <br />
        Stu</p>
      </div>
      <hr />

      <div class="post">
        <p class="post-meta"><span class="post-author text-primary">Ocrana</span><br />
        <span class="post-time small text-muted">7th July 2009 11:51 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

        <p class="post-content">Yeah, I understand this. I hoped someone had the same problem and a solution. The Problem in all is that a "user" who cannot install the software will not answer to a mail :(<br />
        <br />
        Ocrana</p>
      </div>
      <hr />

      <div class="post">
        <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
        <span class="post-time small text-muted">24th July 2009 15:20 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

        <p class="post-content">I have uploaded a new plugin with array sizes increased from 128 to 256.<br />
        <br />
        Stu</p>
      </div>
      <hr />

      <div class="post">
        <p class="post-meta"><span class="post-author text-primary">Ocrana</span><br />
        <span class="post-time small text-muted">25th July 2009 10:50 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

        <p class="post-content">Hi Afrow,<br />
        I have now 3 people with the reboot problem. On Vista and XP. This are the people who gave me a message, I do not want to know how many people have the same problem without inform us.<br />
        However I will send today a version with the new lockedlist to one of the Users in hope to get a response this time.<br />
        <br />
        But please also think about a version that do a deep logging to a text file. This will help very much to handle those issues.<br />
        <br />
        Ocrana</p>
      </div>
      <hr />

      <div class="post">
        <p class="post-meta"><span class="post-author text-primary">Ocrana</span><br />
        <span class="post-time small text-muted">26th July 2009 10:02 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

        <p class="post-content">Hi,<br />
        I got a feedback from a customer, he wrote: "I tried the new installer. The scan now gets to 70% before it reboots the computer on both XP and Vista 32 bit." before it was around 56%.<br />
        What we can do?<br />
        <br />
        Ocrana</p>
      </div>
      <hr />

      <div class="post">
        <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
        <span class="post-time small text-muted">29th July 2009 01:36 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

        <p class="post-content">Sorry I'm quite busy with work at the moment. If I have time at the weekend I will add some switches for logging and maybe upgrade the plugin to use the new plugin API.<br />
        <br />
        Stu</p>
      </div>
      <hr />

      <div class="post">
        <p class="post-meta"><span class="post-author text-primary">AlexisXu</span><br />
        <span class="post-time small text-muted">4th December 2009 07:34 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

        <p class="post-content">Hi,Afrow UK,I download Lockedlist's code,and it can't be complied.VC reports errors:<br />
        error C2065: 'WM_NOTIFY_OUTER_NEXT' : undeclared identifier<br />
        error C2065: 'NOTIFY_BYE_BYE' : undeclared identifier<br />
        error C2065: 'pushstring' : undeclared identifier<br />
        error C2065: 'popstring' : undeclared identifier<br />
        error C2065: 'WM_NOTIFY_CUSTOM_READY' : undeclared identifier<br />
        error C2061: syntax error : identifier 'stack_t'<br />
        error C2065: 'EXDLL_INIT' : undeclared identifier<br />
        error C2061: syntax error : identifier 'stack_t'<br />
        <br />
        Is there same files missing?</p>
      </div>
      <hr />

      <div class="post">
        <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
        <span class="post-time small text-muted">4th December 2009 10:51 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

        <p class="post-content">You need ExDll.<br />
        <br />
        Stu</p>
      </div>
      <hr />

      <div class="post">
        <p class="post-meta"><span class="post-author text-primary">forbjok</span><br />
        <span class="post-time small text-muted">14th December 2009 10:34 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

        <p class="post-content"><strong>LockedList crashes when no files or modules are added</strong><br />
        I just found that when running a setup that contains no LockedList::AddModule or LockedList::AddFile calls, and calls LockedList:: Dialog, it crashes with "An unhandles win32 exception" (the regular Windows segfault message).<br />
        <br />
        My guess is that LockedList:: Dialog fails to check whether some variables normally set by AddFile or AddModule are set.<br />
        <br />
        In most cases this is not a problem of course, as usually there will be files to check for, but in this case the NSI script is generated, and will contain LockedList:: Dialog regardless of whether any files were actually found during generation that causes AddFile or AddModule calls to be made.<br />
        <br />
        I can (and probably will) change the generator to also add the LockedList:: Dialog only when needed, but it would probably be a good idea to also make LockedList:: Dialog perform the necessary checks to prevent it from crashing regardless.</p>
      </div>
      <hr />

      <div class="post">
        <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
        <span class="post-time small text-muted">10th March 2010 22:31 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

        <p class="post-content">v0.9 is now available. Fixed some bugs (including the one last posted; thanks forbjok), added some features, implemented new NSIS plugin API and included a unicode build.<br />
        <br />
        Stu</p>
      </div>
      <hr />

      <div class="post">
        <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
        <span class="post-time small text-muted">11th March 2010 11:54 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

        <p class="post-content">Had a crash with the Unicode build which has now been fixed (RC3).<br />
        <br />
        Stu</p>
      </div>
      <hr />

      <div class="post">
        <p class="post-meta"><span class="post-author text-primary">Animaether</span><br />
        <span class="post-time small text-muted">11th March 2010 12:58 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

        <p class="post-content">Heya Afrow,<br />
        <br />
        Good to see this plugin still being worked on after all :)<br />
        <br />
        I have no idea if the updates happen to resolve the issue I had earlier - will see eventually in current development, though.<br />
        <br />
        Before upgrading I did run into the crash situation (at 87%, every time) again; it's entirely weird.. changing the compression type, removing a messagebox that displays 2 variables (or changing it so it only displays 1), etc. would make the crash go away; no such crash in the current version as far as I can tell.. but if that sounds indicative of something scary that you'd want to check out anyway, just say the word. The DLL doesn't have version information, buts its date is 2008-02-26.<br />
        <br />
        =====<br />
        <br />
        However, I -am- seeing some garbled output in the dialog list with the new version (edit: non-unicode);<br /></p>
        <pre>
<code><br />!addplugindir ".\Plugins\"<br />OutFile "test.exe"<br /><br />Page Custom customPage<br /><br />Function customPage<br />        LockedList::AddModule /NOUNLOAD "$WINDIR\notepad.exe"<br /><br />        LockedList::Dialog<br />FunctionEnd<br /><br />Section<br />SectionEnd<br /></code>
</pre><br />
        <br />
        Dialog screenshot:<br />
        <a href="http://img31.imageshack.us/img31/8219/lockedlistgarble.png" target="_blank">http://img31.imageshack.us/img31/821...listgarble.png</a><br />
        <br />
        That garbled line goes away once it's done checking.
      </div>
      <hr />

      <div class="post">
        <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
        <span class="post-time small text-muted">11th March 2010 13:36 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

        <p class="post-content">Thanks, I will have a look. Another user is reporting another issue as well (possibly just the Unicode build though).<br />
        <br />
        Stu</p>
      </div>
      <hr />

      <div class="post">
        <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
        <span class="post-time small text-muted">11th March 2010 13:38 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

        <p class="post-content">Seems OK here. What operating system?<br />
        <br />
        Stu</p>
      </div>
      <hr />

      <div class="post">
        <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
        <span class="post-time small text-muted">11th March 2010 13:45 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

        <p class="post-content">OK found it. Added to changelog for next build:<br /></p>
        <pre>
<code>Fixed ZeroMemory call:<br />ZeroMemory(File.ProcessCaption, sizeof(File.ProcessFullPath)); -&gt; ZeroMemory(File.ProcessFullPath, sizeof(File.ProcessFullPath));</code>
</pre><br />
        Stu
      </div>
      <hr />

      <div class="post">
        <p class="post-meta"><span class="post-author text-primary">Animaether</span><br />
        <span class="post-time small text-muted">11th March 2010 14:11 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

        <p class="post-content">XP SP2 32-bit, for the record, but you're way ahead of me :)</p>
      </div>
      <hr />

      <div class="post">
        <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
        <span class="post-time small text-muted">11th March 2010 14:15 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

        <p class="post-content">RC4 uploaded. Hopefully both issues sorted.<br />
        <br />
        Stu</p>
      </div>
      <hr />

      <div class="post">
        <p class="post-meta"><span class="post-author text-primary">Animaether</span><br />
        <span class="post-time small text-muted">11th March 2010 14:22 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

        <p class="post-content">non-unicode again; no such luck here.. although on the first two runs I got this instead:<br />
        <a href="http://img694.imageshack.us/img694/1238/lockedlistgarble2.png" target="_blank">http://img694.imageshack.us/img694/1...istgarble2.png</a></p>
      </div>
      <hr />

      <div class="post">
        <p class="post-meta"><span class="post-author text-primary">Animaether</span><br />
        <span class="post-time small text-muted">13th March 2010 05:01 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

        <p class="post-content">on a different note; from..<br />
        <a href="http://forums.winamp.com/showthread.php?threadid=293513" target="_blank">http://forums.winamp.com/showthread.php?threadid=293513</a><br />
        ..there was a request to add an option to only show the dialog if there were locked files found. Any thoughts on this?<br />
        I don't have a need for it myself as I'm performing a few other tests anyway (check if the target file exists, check if the file I want to install is newer, check if the file can be opened for write mode*) and abort the page display if the file being in a locked state isn't an issue.<br />
        <br />
        * I read the thread with the caveat about 'shared write', but apparently some 'locked' files can happily be renamed just as well. Shared write is highly unlikely for the files I'm dealing with (DLLs), so that's okay.</p>
      </div>
      <hr />

      <div class="post">
        <p class="post-meta"><span class="post-author text-primary">Alfaromeo</span><br />
        <span class="post-time small text-muted">15th March 2010 15:24 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

        <p class="post-content">Yes, showing the daialog only if files are locked is a good suggestion. We don't want this dialog to interfere unless it is necessary. BTW, also possibly giving the search path is also a good option . This will avoid by listing all files individually.<br />
        Can anyone also tell me if this plugin has any compatibility problem with UMUI, since I'm not able to show the dialog in the same. It just skips to the next dialog in the list , instead of showing the locked files.</p>
      </div>
      <hr />

      <div class="post">
        <p class="post-meta"><span class="post-author text-primary">Alfaromeo</span><br />
        <span class="post-time small text-muted">18th March 2010 13:18 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

        <p class="post-content">Moreover, this plugin is depended upon Microsoft.VC90.CRT runtime . This causes crash of the dialog , since on new machines this does not exist. Any solution ?</p>
      </div>
      <hr />

      <div class="post">
        <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
        <span class="post-time small text-muted">18th March 2010 16:47 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

        <p class="post-content">I'm a little busy with University at the moment and there are still some issues with LockedList to be sorted. I'll then see if I can sort the CRT dependency.<br />
        <br />
        Edit: And not showing the dialog is not really an option as obviously the scan takes place while the dialog is visible!!<br />
        <br />
        Stu</p>
      </div>
      <hr />

      <div class="post">
        <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
        <span class="post-time small text-muted">29th March 2010 19:28 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

        <p class="post-content">Uploaded v1.0:<br />
        <br />
        v1.0 - 29th March 2010<br />
        * Fixed CRT dependency.<br />
        * Improved percent complete calculations.<br />
        * Now pushes /next to stack in between stack items.<br />
        * Fixed memory leak in AddItem().<br />
        * Fixed crashes caused by using AddFile plug-in function.<br />
        * General code cleanup.<br />
        <br />
        I had reports of duplicated Window captions and this may be fixed too.<br />
        <br />
        Stu</p>
      </div>
      <hr />

      <div class="post">
        <p class="post-meta"><span class="post-author text-primary">Animaether</span><br />
        <span class="post-time small text-muted">30th March 2010 13:43 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

        <p class="post-content">Sweet - thanks for the update!<br />
        <br />
        Out of curiosity.. what happens with AddModule when supplying 64bit DLLs?<br />
        Or, in the case of AddFile, what happens with regard to the filesystem redirection on $SYSDIR / the use of SysNative?<br />
        <br />
        I've adjusted my installers to use $WINDIR\SysNative if ${AtLeastWinVista} and disable/revert FS redirection on XP64 (can't rely on the hotfix/existence of the folder), but it dawned upon me that I haven't the foggiest how LockedList responds to these things :)<br />
        <br />
        I'll try a few tests myself later - just musing in here.</p>
      </div>
      <hr />

      <div class="post">
        <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
        <span class="post-time small text-muted">30th March 2010 14:39 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

        <p class="post-content"></p>

        <blockquote>
          As NSIS is 32-bit, the plug-in cannot enumerate modules of 64-bit processes (the AddModule plug-in function). This can only be fixed if a 64-bit version of NSIS is developed.
        </blockquote>Disabling redirection will have no effect. It is doing string comparisons only so whatever path you give it is what it will match on. To avoid this issue, you can simply use \subpath\modulename.dll instead of a full path.<br />
        <br />
        Stu
      </div>
      <hr />

      <div class="post">
        <p class="post-meta"><span class="post-author text-primary">Animaether</span><br />
        <span class="post-time small text-muted">30th March 2010 15:35 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

        <p class="post-content">gah - totally missed that rather prominently displayed bit in the readme. Any work-around ideas? I can still detect that I can't open it for writing / can't overwrite it, so i can still detect that -something- has it locked.*<br />
        <br />
        Not using the full path should probably work in this instance, even though it reduces it to just the filename. I suppose that might give issues if, say, one wants to check what application is locking "c:\somedir\somefile.ext" by using "somefile.ext" and another application has "c:\anotherdir\somefile.ext" open.<br />
        Edit: Not that there's any point in doing this in my case - given that they're 64bit DLLs.<br />
        <br />
        * Edit: I suppose I could use LockedList's stack output function for the 32bit parts, my own functions (that don't identify the locking process, of course) for the 64bit parts and populate some manner of list display myself - possibly using an NSDialogs timer to refresh the list periodically (not spotting a hook into the automatic update part of the LockedList dialog - and I'd need the timer for my own function anyway). Hmmm.</p>
      </div>
      <hr />

      <div class="post">
        <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
        <span class="post-time small text-muted">30th March 2010 16:59 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

        <p class="post-content">Unfortunately there isn't a way around this (at least not using EnumProcessModules/EnumProcessModulesEx). I guess one option is to use the AddApplication plug-in function on top of a manual lock check.<br />
        <br />
        Stu</p>
      </div>
      <hr />

      <div class="post">
        <p class="post-meta"><span class="post-author text-primary">Animaether</span><br />
        <span class="post-time small text-muted">30th March 2010 17:23 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

        <p class="post-content">AddApplication? I saw the AddApplication<b>s</b> method (not documented, but in the examples), but figured that was a bit heavy-handed; other (InstallShield, I think) installers claiming every single application must be closed (usually for no good reason) often just tend to annoy me :)<br />
        <br />
        Short of creating a completely custom page - is there any way to add to the LockedList list manually? I suppose through poking at SysListView32 directly, if nothing else. Might be cleaner to add a method to add custom data, but I'm not sure how that would interfere with things like the context menu, automatic clearing of items, etc.</p>
      </div>
      <hr />

      <div class="post">
        <p class="post-meta"><span class="post-author text-primary">Animaether</span><br />
        <span class="post-time small text-muted">30th March 2010 18:05 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

        <p class="post-content">oh, on a rather unrelated note, I'm still getting the odd bits in the top of the list - but the new version at least seems to spit out some useful information; it reports the process ID as 4 (which, according to taskman, is the System process).<br />
        This is from the supplied module/notepad example:<br />
        <a href="http://img225.imageshack.us/img225/9294/lockedlistnotepadexampl.png" target="_blank">http://img225.imageshack.us/img225/9...epadexampl.png</a><br />
        <br />
        I have no idea why it's listing that - notepad certainly isn't running (if it is, it adds a 2nd line listing notepad itself). Windows XP, 32bit, SP2 and any other information you'd need, just say the word :)</p>
      </div>
      <hr />

      <div class="post">
        <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
        <span class="post-time small text-muted">30th March 2010 18:49 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

        <p class="post-content">Sorry should have mentioned that was fixed a few mins after I uploaded. Yeh not sure why I added AddApplications - someone must have asked for it. Probably useful if you are going to be rebooting the system after installation and you don't want people to lose their work. How about AddClass or AddCaption? How would adding custom data work?<br />
        <br />
        If your application is 64-bit, did you try adding the actual executable using AddModule? That should work.<br />
        <br />
        Stu</p>
      </div>
      <hr />

      <div class="post">
        <p class="post-meta"><span class="post-author text-primary">Animaether</span><br />
        <span class="post-time small text-muted">30th March 2010 19:11 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

        <p class="post-content">Ah, I'll have to re-test.<br />
        <br />
        =====<br />
        <br />
        Unfortunately, AddClass, AddCaption, looping over processes etc. wouldn't do much good as I don't have the particulars of the application(s) that might use these libraries. They're basically DLLs that other developers can, and are likely to, make use of.. but I don't think we can dictate "Thou Shalt Useth This Class" :)<br />
        <br />
        Adding (err.. and removing, I suppose) custom data basically just to populate the list and have LockedList realize whether the list is empty or not.<br />
        <br />
        E.g. Let's say I run my own function to at least check if -something- is locking a 64bit file.. I can't tell what is locking it, but at least I can tell the user that something is. Quite possibly, they'll know what's locking it and can then close it.<br />
        <br />
        So having identified that a particular file is locked, say I call:<br />
        LockedList::AddCustomItem "path\filename" ["unknown process"]<br />
        That adds the custom item to the locked list internal list and display list. The display list so that, obviously, it is displayed..and the internal list so that if the other locks that LockedList handled itself are closed, it doesn't immediately report that there's nothing left to close.<br />
        <br />
        This would require a companion function a la...<br />
        LockedList::RemoveCustomItem "path\filename" that would remove the matching item. I'm *presuming* that it wouldn't require some manner of unique ID to be returned from AddCustomItem that would then get fed to RemoveCustomItem, instead just string matching.. but whatever is easier/better/etc.<br />
        This function would get called if my own function determines that said lock is, in fact, gone.<br />
        <br />
        Unfortunately this probably means quite a few other changes - can't just add an nsDialogs timer to your dialog to periodically call my function / add a button to manually refresh / etc. so the plugin would have to call it and so forth and so on.<br />
        <br />
        Hence why I was already thinking that -maybe- it's better I create my own custom page with a list (probably through EmbeddedList), and populate that out of the LockedList stack methods. I'd lose the automatic checking - instead having to re-requery LockedList.. or.. actually I guess I can just check if the process that LockedList reported is still present when I do my refresh.. that should have the same effect?<br />
        <br />
        I'd better check that System process bit first :)</p>
      </div>
      <hr />

      <div class="post">
        <p class="post-meta"><span class="post-author text-primary">Animaether</span><br />
        <span class="post-time small text-muted">30th March 2010 19:12 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

        <p class="post-content">System process being reported has indeed been fixed - thanks! :D</p>
      </div>
      <hr />
      <!-- Bootstrap core CSS -->
      <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
      <!--[if lt IE 9]>
                <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
                <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->

      <div class="container">
        <!-- Put navigation bar here -->

        <ol class="breadcrumb">
          <li><a href="../index.html" class="glyphicon glyphicon-home"></a></li>

          <li><a href="f-65.html">NSIS Discussion</a></li>

          <li class="active">LockedList plug-in</li>
        </ol>

        <p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=274168">LockedList plug-in</a></p><br />

        <div class="post">
          <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
          <span class="post-time small text-muted">30th March 2010 19:32 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

          <p class="post-content">How about this:<br /></p>
          <pre>
<code>AddCustom [/icon path] application process callback</code>
</pre><br />
          Usage:<br />
          <pre>
<code>GetFunctionAddress $R0 IsMyAppRunning<br />LockedList::AddCustom /icon $PLUGINSDIR\icon.ico "My App" "myapp.exe" $R0</code>
</pre>
          <pre>
<code>Function IsMyAppRunning<br />  Pop $R0 ; $R0 = myapp.exe in case you want to know<br />  ${If} [myapp is locking files]<br />    Push true<br />  ${Else}<br />    Push false<br />  ${EndIf}<br />FunctionEnd</code>
</pre>Stu
        </div>
        <hr />

        <div class="post">
          <p class="post-meta"><span class="post-author text-primary">Animaether</span><br />
          <span class="post-time small text-muted">30th March 2010 19:40 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

          <p class="post-content">Yeah, seems like that would work (and be more flexible for general use). How often would the callback be called? Unless it blocks the thread, etc.</p>
        </div>
        <hr />

        <div class="post">
          <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
          <span class="post-time small text-muted">31st March 2010 20:02 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

          <p class="post-content">Uploaded v1.1. The callback is called initially before adding the custom item and then again every second after searching has completed.<br />
          <br />
          Edit: And FYI <a href="http://winprogger.com/?p=26" target="_blank">Why do win32 calls GetModuleFileNameEx, EnumProcessModules, EnumProcessModulesEx fail in Wow64?</a><br />
          Edit 2: LockedList uses GetProcessImageFileName if it exists so LockedList will work for all executables (32-bit or 64-bit) but cannot work for 64-bit modules. One idea (which Process Explorer uses) is to run a secondary 64-bit process which relays information back to the 32-bit process (in this case, the plug-in) but this would be a lot of work.<br />
          <br />
          Stu</p>
        </div>
        <hr />

        <div class="post">
          <p class="post-meta"><span class="post-author text-primary">Animaether</span><br />
          <span class="post-time small text-muted">31st March 2010 21:37 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

          <p class="post-content">Just tried, but the "LockedListCustom.nsi" example goes straight through without invoking the callback function, it seems. I'm using the regular DLL, MD5: 0dd1e0aee3b2aba0483c5d50c4656ba6<br />
          <br />
          Re Edit: yeah, I found similar information a bit after I asked the initial question.. almost makes sense if not for it being something MSFT -could- have addressed if they really wanted to; alas :)<br />
          <br />
          Re Edit 2: Right - I wouldn't delve into that right away :)</p>
        </div>
        <hr />

        <div class="post">
          <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
          <span class="post-time small text-muted">31st March 2010 22:03 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

          <p class="post-content">Thanks, fixed. Reminder for future I must always test release DLL's as well as debug DLL's :)<br />
          <br />
          Stu</p>
        </div>
        <hr />

        <div class="post">
          <p class="post-meta"><span class="post-author text-primary">Animaether</span><br />
          <span class="post-time small text-muted">31st March 2010 22:16 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

          <p class="post-content">Excellent - That is actually a pretty elegant solution to an entirely non-elegant problem.. makes LockedList extremely flexible as a sweet side-effect :)<br />
          <br />
          One question if I may; the Custom example (which is still titled 'Using AddModule and notepad.exe' - btw) seems to use $R0 - the callback function address - 3 times. The docs only specify it once. I commented out the 2nd and 3rd and the example still runs so I suppose they're at least not required - but now I'm curious as to why they're there :D<br />
          <br />
          *goes to hit the actual installer code to try and hook his simplified locked file check into this*</p>
        </div>
        <hr />

        <div class="post">
          <p class="post-meta"><span class="post-author text-primary">Animaether</span><br />
          <span class="post-time small text-muted">31st March 2010 23:03 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

          <p class="post-content">Sweet - as far as I can tell, this will work beautifully.. still have to test it in the wild, but several quick simple tests haven't revealed any particular problems.<br />
          <br />
          So now I have...<br />
          <br />
          ${LockCheck} : a simple locked files checker macro bit that only reports -if- a file is locked (if it exists, and if we care (version number check)), not -what- is locking it..<br />
          <br />
          1. that I feed target/source files into with a single line call for each module<br />
          2. if it is determined none of the files are locked (based on the output of the macro), skip the LockedList dialog, otherwise...<br />
          3. initialize the LockedList dialog with those Module (32bit) or Custom (64bit) items that were determined to be locked, which will report the locking applications (32bit) and my Custom items (64bit)<br />
          4. which will automagically check everything except for the Custom items for which it calls...<br />
          5. a callback which invokes the simple locked files checking macro ${LockCheck} and...<br />
          6. tells lockedlist whether or not the file is unlocked based on its output again.<br />
          <br />
          It's not perfect, but it's much better than going *BOINK* at a user mid-file installation with a can't-overwrite-this-file dialog :)</p>
        </div>
        <hr />

        <div class="post">
          <p class="post-meta"><span class="post-author text-primary">Animaether</span><br />
          <span class="post-time small text-muted">2nd April 2010 02:36 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

          <p class="post-content">I just realized that when the dialog closes, the stack value for the next button is always "next" - which means you can't discern from it whether the user clicked the next (all apps were closed / there was nothing to close to begin with) or the 'ignore' button.<br />
          <br />
          These are one and the same button just with custom captions on them, of course - which also leads to the work-around: grab the text off of the button and compare it to the '/ignore text' flag value you defined. Just thought it might be good if the plugin handled this in the value it pushes to the stack :)</p>
        </div>
        <hr />

        <div class="post">
          <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
          <span class="post-time small text-muted">2nd April 2010 15:17 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

          <p class="post-content">Done. Also added an IsFileLocked utility function. See the changelog for full details.<br />
          <br />
          Stu</p>
        </div>
        <hr />

        <div class="post">
          <p class="post-meta"><span class="post-author text-primary">Animaether</span><br />
          <span class="post-time small text-muted">2nd April 2010 19:17 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

          <p class="post-content">Sweet - seems you're on a roll :o<br />
          If IsFileLocked works well, I can replace the internal (FileOpen "path" "a") test.<br />
          <br />
          At the moment, though, the Pop'ed value seems to be the passed "path" parameter?<br />
          ( I popped a few more time to different vars, they all seem to be null )</p>
        </div>
        <hr />

        <div class="post">
          <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
          <span class="post-time small text-muted">3rd April 2010 12:06 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

          <p class="post-content">That's a bug if it's the first plug-in call (was not initializing global variables such as the stack pointer). If you use it in the callback then it should be fine. Will fix for next version. Someone is reporting a crash but on a window which updates its caption every 100ms (not surprised).<br />
          <br />
          Stu</p>
        </div>
        <hr />

        <div class="post">
          <p class="post-meta"><span class="post-author text-primary">Animaether</span><br />
          <span class="post-time small text-muted">3rd April 2010 12:43 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

          <p class="post-content"></p>

          <blockquote>
            <small>Originally posted by Afrow UK</small><br />
            Someone is reporting a crash but on a window which updates its caption every 100ms (not surprised).
          </blockquote>Yikes...<br />
          yikes #1: why would that crash?<br />
          yikes #2: why on Earth would an application update its caption 10 times per second??<br />
          ( not necessarily in that order )<br />
          <br />
          I've got one that updates its caption every second.. I stick the time in it (taskbar is set to auto-hide, might as well make use of the titlebar screen real estate) ..but 10 times per second? huh.
        </div>
        <hr />

        <div class="post">
          <p class="post-meta"><span class="post-author text-primary">Pawel</span><br />
          <span class="post-time small text-muted">3rd April 2010 13:32 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

          <p class="post-content">This is my application. It change title of <b>other</b> appliaction, to show some useful information. It doeasnt have to be 100ms but now it is. In final build it will be probably 500ms (it can't be &gt;1s)<br />
          I use Stu's plugin in my installer and it crash when it is trying to kill that application with our title (but only unicode build, ansi build works ok...)<br />
          And i think , it is because, in some way Process name in application list is displayed as data from title bar I change every x ms...<br />
          I hope Stu will find way to fix it.<br />
          -Pawel</p>
        </div>
        <hr />

        <div class="post">
          <p class="post-meta"><span class="post-author text-primary">Animaether</span><br />
          <span class="post-time small text-muted">3rd April 2010 17:42 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

          <p class="post-content">hmmm.. as far as I can tell, it only grabs the title once.. must be affecting something deeper down :)</p>
        </div>
        <hr />

        <div class="post">
          <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
          <span class="post-time small text-muted">4th April 2010 13:36 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

          <p class="post-content">Turns out it was just a buffer overflow. I am not sure why because dynamically allocating the buffer instead of statically seems to have fixed it. I have also increased the buffer length to 1024 characters and fixed the IsFileLocked bug.<br />
          <br />
          Stu</p>
        </div>
        <hr />

        <div class="post">
          <p class="post-meta"><span class="post-author text-primary">Pawel</span><br />
          <span class="post-time small text-muted">4th April 2010 17:44 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

          <p class="post-content">Stu,<br />
          Yes, it seems it is finally fixed. I will do more tests later.<br />
          -Pawel</p>
        </div>
        <hr />

        <div class="post">
          <p class="post-meta"><span class="post-author text-primary">Animaether</span><br />
          <span class="post-time small text-muted">4th April 2010 18:04 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

          <p class="post-content">confirming the IsFileLocked bugfix. Unfortunately it doesn't recognize the locked DLL as being locked; I guess that might be a distinction similar to why there is an AddFile and an AddModule?<br />
          <br />
          It correctly recognized a text file I opened a file handle to (with another app), so that part works if nothing else :)</p>
        </div>
        <hr />

        <div class="post">
          <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
          <span class="post-time small text-muted">5th April 2010 12:39 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

          <p class="post-content">Yep it will only work on files that have a handle open on them (DLL's do not when they are locked). And yes using AddFile on DLL will not work.<br />
          <br />
          Stu</p>
        </div>
        <hr />

        <div class="post">
          <p class="post-meta"><span class="post-author text-primary">Animaether</span><br />
          <span class="post-time small text-muted">5th April 2010 15:23 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

          <p class="post-content">Gotcha - makes sense (in that weird and twisted Microsoft-state-of-mind kind of sense) :)</p>
        </div>
        <hr />

        <div class="post">
          <p class="post-meta"><span class="post-author text-primary">Animaether</span><br />
          <span class="post-time small text-muted">6th April 2010 23:49 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

          <p class="post-content">one more minor item request...<br />
          If the list is empty, could the Next button text revert if /ignore is specified? I just noticed that if I specify the /ignore flag, have a locked file, then unlock that file and the list goes empty stating no further programs need to be closed.. the Next button still reads (the /ignore-supplied string) "Ignore".</p>
        </div>
        <hr />

        <div class="post">
          <p class="post-meta"><span class="post-author text-primary">glenncarr</span><br />
          <span class="post-time small text-muted">8th April 2010 16:26 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

          <p class="post-content">Is the source for this plug-in available? If not, have you considered open-sourcing it?</p>
        </div>
        <hr />

        <div class="post">
          <p class="post-meta"><span class="post-author text-primary">glenncarr</span><br />
          <span class="post-time small text-muted">8th April 2010 16:29 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

          <p class="post-content"></p>

          <blockquote>
            <small>Originally posted by glenncarr</small><br />
            Is the source for this plug-in available? If not, have you considered open-sourcing it?
          </blockquote>Sorry, I'm a dolt -- just found it in the package. :igor:
        </div>
        <hr />

        <div class="post">
          <p class="post-meta"><span class="post-author text-primary">glenncarr</span><br />
          <span class="post-time small text-muted">8th April 2010 17:32 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

          <p class="post-content">Quickly compiled and ran a few of the examples on Vista64...<br />
          - After the initial Welcome page, no list was displayed on the second page<br />
          - Back, Next, and Cancel buttons are active, but nothing happens when clicking them<br />
          - Have to force the installer to close (system control menu/buttons don't work)<br />
          <br />
          Any suggestions?</p>
        </div>
        <hr />

        <div class="post">
          <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
          <span class="post-time small text-muted">8th April 2010 18:38 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

          <p class="post-content">Which example causes this? I am running Windows 7 x64 and have not had any issues.<br />
          <br />
          Stu</p>
        </div>
        <hr />

        <div class="post">
          <p class="post-meta"><span class="post-author text-primary">glenncarr</span><br />
          <span class="post-time small text-muted">8th April 2010 19:37 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

          <p class="post-content"></p>

          <blockquote>
            <small>Originally posted by Afrow UK</small><br />
            Which example causes this? I am running Windows 7 x64 and have not had any issues.<br />
            <br />
            Stu
          </blockquote>All of them.
        </div>
        <hr />

        <div class="post">
          <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
          <span class="post-time small text-muted">8th April 2010 20:27 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

          <p class="post-content">I can only assume something such as anti-virus software is blocking it. Does SilentSearch work?<br />
          <br />
          Stu</p>
        </div>
        <hr />

        <div class="post">
          <p class="post-meta"><span class="post-author text-primary">glenncarr</span><br />
          <span class="post-time small text-muted">8th April 2010 20:45 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

          <p class="post-content">Compiling and running LockedListTest.nsi with /S crashes with this info:<br /></p>

          <blockquote>
            Problem signature:<br />
            Problem Event Name: APPCRASH<br />
            Application Name: LockedListTest.exe<br />
            Application Version: 0.0.0.0<br />
            Application Timestamp: 49769baa<br />
            Fault Module Name: StackHash_fd00<br />
            Fault Module Version: 0.0.0.0<br />
            Fault Module Timestamp: 00000000<br />
            Exception Code: c0000005<br />
            Exception Offset: 00000138<br />
            OS Version: 6.0.6002.2.2.0.256.6<br />
            Locale ID: 1033<br />
            Additional Information 1: fd00<br />
            Additional Information 2: ea6f5fe8924aaa756324d57f87834160<br />
            Additional Information 3: fd00<br />
            Additional Information 4: ea6f5fe8924aaa756324d57f87834160
          </blockquote>How do you typically debug this? I've built it in Visual Studio 2008, and I'm trying to attach to my installer exe instance with no luck, so I'm probably missing something obvious. I'd be glad to help if I can.
        </div>
        <hr />

        <div class="post">
          <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
          <span class="post-time small text-muted">9th April 2010 13:47 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

          <p class="post-content">Make sure the source code is in NSIS\Contrib\LockedList then set the build configuration to Debug (or Debug Unicode if you're using Unicode NSIS). After rebuilding the NSIS installer you can then attach VS to it.<br />
          <br />
          Glad you have VS!<br />
          <br />
          Stu</p>
        </div>
        <hr />

        <div class="post">
          <p class="post-meta"><span class="post-author text-primary">Alfaromeo</span><br />
          <span class="post-time small text-muted">13th April 2010 10:39 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

          <p class="post-content">Still have the dependency issue.<br />
          It failed to load the Dialog on a fresh XP PC with the following error in the event viewer.<br />
          <br />
          Resolve partial assembly failed for Microsft.VC90.CRT.Reference error message. The referenced assembly is not installed on your system.<br />
          <br />
          Please let me know</p>
        </div>
        <hr />

        <div class="post">
          <p class="post-meta"><span class="post-author text-primary">MrSpock77</span><br />
          <span class="post-time small text-muted">16th April 2010 14:55 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

          <p class="post-content"></p>

          <blockquote>
            <small>Originally posted by Alfaromeo</small><br />
            Still have the dependency issue.<br />
            It failed to load the Dialog on a fresh XP PC with the following error in the event viewer.<br />
            <br />
            Resolve partial assembly failed for Microsft.VC90.CRT.Reference error message. The referenced assembly is not installed on your system.<br />
            <br />
            Please let me know
          </blockquote>I have the same problem. Our installer does not work in XP with LockedList. Microsoft.VC90.CRT is missing...<br />
          <br />
          Any help is highly appreciated.
        </div>
        <hr />

        <div class="post">
          <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
          <span class="post-time small text-muted">22nd April 2010 13:09 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

          <p class="post-content">Please try v1.4. The DLL had an XML manifest in it defining Microsoft VC90 CRT as a dependency.<br />
          <br />
          Stu</p>
        </div>
        <hr />

        <div class="post">
          <p class="post-meta"><span class="post-author text-primary">ahmett</span><br />
          <span class="post-time small text-muted">22nd April 2010 19:26 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

          <p class="post-content">Tested on fresh XP (no any redistributable package installed!) and it works fine<br />
          <br />
          Thanks</p>
        </div>
        <hr />

        <div class="post">
          <p class="post-meta"><span class="post-author text-primary">MrSpock77</span><br />
          <span class="post-time small text-muted">23rd April 2010 12:39 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

          <p class="post-content"></p>

          <blockquote>
            <small>Originally posted by Afrow UK</small><br />
            Please try v1.4. The DLL had an XML manifest in it defining Microsoft VC90 CRT as a dependency.
          </blockquote>Thanks! It works!
        </div>
        <hr />

        <div class="post">
          <p class="post-meta"><span class="post-author text-primary">Alfaromeo</span><br />
          <span class="post-time small text-muted">26th April 2010 08:45 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

          <p class="post-content">That rocks...Works as expected. Thanks<br />
          A requirement is to make the label control transparent and the list contol a little more small.Sicne I'm using UMUI this covers up all the screen .<br />
          Please advise.</p>
        </div>
        <hr />

        <div class="post">
          <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
          <span class="post-time small text-muted">26th April 2010 09:35 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

          <p class="post-content">You'll need to use SetCtlColors for the transparency and SetWindowPos API for the list (among others). It may be easier to resize the list in the dialog resource in Visual Studio and rebuild.<br />
          <br />
          Stu</p>
        </div>
        <hr />

        <div class="post">
          <p class="post-meta"><span class="post-author text-primary">Alfaromeo</span><br />
          <span class="post-time small text-muted">26th April 2010 14:17 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

          <p class="post-content">I know the file which will is likely yo be locked by our application , hence is there an option to target that file alone with a if condition to detect whether that file is locked or not.<br />
          Check that and show the dialog if necessary.</p>
        </div>
        <hr />

        <div class="post">
          <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
          <span class="post-time small text-muted">26th April 2010 19:41 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

          <p class="post-content">You can use the SilentSearch function for that but be warned the process can take a little time for modules (even on super fast machines) and even longer for file handles. Hence why the search occurs while the screen is visible.<br />
          <br />
          If you just want to make the label transparent the control ID is defined in resource.h.<br />
          You need to use InitDialog and Show plugin calls and InitDialog pushes the window handle onto the stack (just like InstallOptions).<br />
          <br />
          Stu</p>
        </div>
        <hr />

        <div class="post">
          <p class="post-meta"><span class="post-author text-primary">maxwell72</span><br />
          <span class="post-time small text-muted">26th April 2010 23:52 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

          <p class="post-content">/noprograms option for dialog isn't working since v1.2<br />
          text always returns to it's default value.<br />
          just me?<br />
          <br />
          Osman</p>
        </div>
        <hr />

        <div class="post">
          <p class="post-meta"><span class="post-author text-primary">Animaether</span><br />
          <span class="post-time small text-muted">27th April 2010 00:19 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

          <p class="post-content"></p>

          <blockquote>
            <small>Originally posted by maxwell72</small><br />
            /noprograms option for dialog isn't working since v1.2<br />
            text always returns to it's default value.
          </blockquote>I don't use it - but I can confirm the error.<br />
          <br />
          The problem is in the source code; it references PARAM_SEARCHING in the part of the code dealing with the /noprograms flag. Must be a copy/paste-effected regression :)
        </div>
        <hr />

        <div class="post">
          <p class="post-meta"><span class="post-author text-primary">Alfaromeo</span><br />
          <span class="post-time small text-muted">27th April 2010 11:37 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

          <p class="post-content">Was digging the day to display a message when the file is locked.<br />
          <br />
          This is the flow of UI<br />
          <br />
          Welcome<br />
          License Page<br />
          Directory<br />
          Install FIles<br />
          Finish<br />
          <br />
          In the main section I have this code:<br />
          <br />
          LockedList::IsFileLocked "&lt;Path to FIle"&gt;<br />
          <br />
          Pop $R0<br />
          <br />
          I do not want toshow the UI of Locked list , just detect the file<br />
          <br />
          Your expertise is needed</p>
        </div>
        <hr />
        <!-- Bootstrap core CSS -->
        <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
        <!--[if lt IE 9]>
                <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
                <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->

        <div class="container">
          <!-- Put navigation bar here -->

          <ol class="breadcrumb">
            <li><a href="../index.html" class="glyphicon glyphicon-home"></a></li>

            <li><a href="f-65.html">NSIS Discussion</a></li>

            <li class="active">LockedList plug-in</li>
          </ol>

          <p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=274168">LockedList plug-in</a></p><br />

          <div class="post">
            <p class="post-meta"><span class="post-author text-primary">jpderuiter</span><br />
            <span class="post-time small text-muted">27th April 2010 14:18 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

            <p class="post-content"><a href="http://forums.winamp.com/showthread.php?threadid=274495" target="_blank">http://forums.winamp.com/showthread.php?threadid=274495</a></p>
          </div>
          <hr />

          <div class="post">
            <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
            <span class="post-time small text-muted">27th April 2010 14:44 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

            <p class="post-content">LockedList::IsFileLocked doesn't show the UI. It is purely a utility function to avoid having to use FileOpen (it does that internally).<br />
            <br />
            Edit: I will sort that bug/typo later :)<br />
            <br />
            Stu</p>
          </div>
          <hr />

          <div class="post">
            <p class="post-meta"><span class="post-author text-primary">Alfaromeo</span><br />
            <span class="post-time small text-muted">27th April 2010 19:11 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

            <p class="post-content">This is a codec filter binary with extension ".ax" . This codec filter is installed by my application as well as ,it will be shared by some third party applications. Hence the need , to detect whether this is locked or not when I reinstall or upgrade my application .<br />
            I tried the IsFIleLocked function , but it did not appear to sense it was locked.<br />
            Is this a bug as Stu pointed out?</p>
          </div>
          <hr />

          <div class="post">
            <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
            <span class="post-time small text-muted">27th April 2010 19:15 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

            <p class="post-content">You mean IsFileLocked always returns false? Does FileOpen work (follow jpderuiter's link)?<br />
            <br />
            Stu</p>
          </div>
          <hr />

          <div class="post">
            <p class="post-meta"><span class="post-author text-primary">Alfaromeo</span><br />
            <span class="post-time small text-muted">27th April 2010 19:18 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

            <p class="post-content">Yes that is what is happening.<br />
            BTW, this being a binary file will FileOpen work?</p>
          </div>
          <hr />

          <div class="post">
            <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
            <span class="post-time small text-muted">27th April 2010 19:21 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

            <p class="post-content">FileOpen (CreateFile) works on any file. Try it.<br />
            <br />
            Stu</p>
          </div>
          <hr />

          <div class="post">
            <p class="post-meta"><span class="post-author text-primary">Alfaromeo</span><br />
            <span class="post-time small text-muted">28th April 2010 11:03 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

            <p class="post-content">Yes FileOpen code snippet from the other forum worked as expected.<br />
            What is the issue here</p>
          </div>
          <hr />

          <div class="post">
            <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
            <span class="post-time small text-muted">28th April 2010 17:04 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

            <p class="post-content">Show me the LockedList plug-in code you are using. As I said, my plug-in code is the same as using FileOpen so you must be doing something wrong.<br />
            <br />
            Stu</p>
          </div>
          <hr />

          <div class="post">
            <p class="post-meta"><span class="post-author text-primary">Animaether</span><br />
            <span class="post-time small text-muted">28th April 2010 18:51 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

            <p class="post-content"></p>

            <blockquote>
              <small>Originally posted by Afrow UK</small><br />
              My plug-in code is the same as using FileOpen
            </blockquote>I don't think it does, though?<br />
            <br />
            From an earlier discussion (same thread):<br />

            <blockquote>
              <small>Originally posted by Animaether</small><br />
              confirming the IsFileLocked bugfix. Unfortunately it doesn't recognize the locked DLL as being locked
            </blockquote>

            <blockquote>
              <small>Originally posted by Afrow UK</small><br />
              Yep it will only work on files that have a handle open on them (DLL's do not when they are locked)
            </blockquote>So given that...<br />

            <blockquote>
              <small>Originally posted by Alfaromeo</small><br />
              This is a codec filter binary with extension ".ax"
            </blockquote>...wouldn't it be subject to the same difference?<br />
            <br />

            <blockquote>
              <small>Originally posted by Afrow UK</small><br />
              Show me the LockedList plug-in code you are using.
            </blockquote>Just in case there -shouldn't- be a difference after all, the following example should work to demonstrate:<br />
            <br />
            PHP Code:
            <hr />
            <code style="white-space:nowrap"><!-- php buffer start --></code><span style="color: #000000"><span style="color: #007700">!</span><span style="color: #0000BB">addplugindir</span><span style="color: #DD0000">"."<br /></span> <span style="color: #007700">!include</span><span style="color: #DD0000">"nsDialogs.nsh"<br /></span> <span style="color: #0000BB">OutFileLockedListTest</span><span style="color: #007700">.</span><span style="color: #0000BB">exe<br />
            <br />
            Section<br />
            SectionEnd<br />
            <br /></span> <span style="color: #007700">Var</span><span style="color: #0000BB">dialog<br /></span> <span style="color: #007700">Var</span><span style="color: #0000BB">hwnd<br />
            <br />
            PageCustomtest<br />
            <br /></span> <span style="color: #007700">Function.</span><span style="color: #0000BB">onInit<br />
            InitPluginsDir<br />
            FunctionEnd<br />
            <br /></span> <span style="color: #007700">Function</span><span style="color: #0000BB">test<br />
            nsDialogs</span><span style="color: #007700">::</span><span style="color: #0000BB">Create1018<br />
            Pop$dialog<br />
            <br /></span> <span style="color: #007700">${</span><span style="color: #0000BB">NSD_CreateButton</span><span style="color: #007700">}</span><span style="color: #0000BB">00100</span><span style="color: #007700">%</span><span style="color: #0000BB">10</span><span style="color: #007700">%</span><span style="color: #DD0000">"UseLockedList"<br /></span> <span style="color: #0000BB">Pop$hwnd<br /></span> <span style="color: #007700">${</span><span style="color: #0000BB">NSD_OnClick</span><span style="color: #007700">}</span><span style="color: #0000BB">$hwndbutton</span><span style="color: #007700">.</span><span style="color: #0000BB">lockedlist</span><span style="color: #007700">.</span><span style="color: #0000BB">onclick<br />
            <br /></span> <span style="color: #007700">${</span><span style="color: #0000BB">NSD_CreateButton</span><span style="color: #007700">}</span><span style="color: #0000BB">020100</span><span style="color: #007700">%</span><span style="color: #0000BB">10</span><span style="color: #007700">%</span><span style="color: #DD0000">"UseFileOpen"<br /></span> <span style="color: #0000BB">Pop$hwnd<br /></span> <span style="color: #007700">${</span><span style="color: #0000BB">NSD_OnClick</span><span style="color: #007700">}</span><span style="color: #0000BB">$hwndbutton</span><span style="color: #007700">.</span><span style="color: #0000BB">fileopen</span><span style="color: #007700">.</span><span style="color: #0000BB">onclick<br />
            <br />
            nsDialogs</span><span style="color: #007700">::</span><span style="color: #0000BB">Show<br />
            FunctionEnd<br />
            <br /></span> <span style="color: #007700">Function</span><span style="color: #0000BB">button</span><span style="color: #007700">.</span><span style="color: #0000BB">lockedlist</span><span style="color: #007700">.</span><span style="color: #0000BB">onclick<br />
            Pop$hwnd<br />
            LockedList</span><span style="color: #007700">::</span><span style="color: #0000BB">IsFileLocked</span><span style="color: #DD0000">"$PLUGINSDIR\nsDialogs.dll"<br /></span> <span style="color: #0000BB">Pop</span><span style="color: #007700">$</span><span style="color: #0000BB">0<br />
            MessageBoxMB_OK</span><span style="color: #DD0000">"$PLUGINSDIR\nsDialogs.dll$\r$\nLocked:$0"<br /></span> <span style="color: #0000BB">FunctionEnd<br />
            <br /></span> <span style="color: #007700">Function</span><span style="color: #0000BB">button</span><span style="color: #007700">.</span><span style="color: #0000BB">fileopen</span><span style="color: #007700">.</span><span style="color: #0000BB">onclick<br />
            Pop$hwnd<br />
            ClearErrors<br />
            FileOpen$R0</span><span style="color: #DD0000">"$PLUGINSDIR\nsDialogs.dll""a"<br /></span> <span style="color: #0000BB">IfErrors_errors_noerrors<br />
            <br />
            _errors</span><span style="color: #007700">:<br /></span> <span style="color: #0000BB">StrCpy</span><span style="color: #007700">$</span><span style="color: #0000BB">0</span><span style="color: #DD0000">"true"<br /></span> <span style="color: #0000BB">goto_done<br />
            <br />
            _noerrors</span><span style="color: #007700">:<br /></span> <span style="color: #0000BB">StrCpy</span><span style="color: #007700">$</span><span style="color: #0000BB">0</span><span style="color: #DD0000">"false"<br /></span> <span style="color: #0000BB">FileClose$R0<br />
            goto_done<br />
            <br />
            _done</span><span style="color: #007700">:<br />
            <br /></span> <span style="color: #0000BB">MessageBoxMB_OK</span><span style="color: #DD0000">"$PLUGINSDIR\nsDialogs.dll$\r$\nLocked:$0"<br /></span> <span style="color: #0000BB">FunctionEnd<br /></span></span> <!-- php buffer end -->
            <hr />
          </div>
          <hr />

          <div class="post">
            <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
            <span class="post-time small text-muted">28th April 2010 21:56 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

            <p class="post-content">Thanks, both issues should be fixed. For some reason I had omitted GENERIC_WRITE on CreateFile (in IsFileLocked) so I am suprised IsFileLocked ever worked at all.<br />
            <br />
            Stu</p>
          </div>
          <hr />

          <div class="post">
            <p class="post-meta"><span class="post-author text-primary">Animaether</span><br />
            <span class="post-time small text-muted">28th April 2010 23:18 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

            <p class="post-content">yay :)<br />
            <br />
            Any thoughts on that Ignore button bit? (custom Ignore text not getting cleared once list is empty)</p>
          </div>
          <hr />

          <div class="post">
            <p class="post-meta"><span class="post-author text-primary">Alfaromeo</span><br />
            <span class="post-time small text-muted">29th April 2010 10:08 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

            <p class="post-content">It works now. Possible to get a array of processes that is being used by the concerned file if locked. Will be helpful for me to display the same in the MessageBox and take user action.</p>
          </div>
          <hr />

          <div class="post">
            <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
            <span class="post-time small text-muted">29th April 2010 10:11 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

            <p class="post-content">@Animaether<br />
            Ah didn't see that one sorry. There's no code in there to set it back so I will add it when I have time.<br />
            <br />
            Stu</p>
          </div>
          <hr />

          <div class="post">
            <p class="post-meta"><span class="post-author text-primary">Alfaromeo</span><br />
            <span class="post-time small text-muted">29th April 2010 12:49 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

            <p class="post-content">Stu,<br />
            <br />
            I acheived my option , by using the SilentSearch option from the examples listed.<br />
            <br />
            Although I have listed another query sometime back in this forum , was not answered. Is their any option to give search path , instead of individual files. This will ease listing files one by one</p>
          </div>
          <hr />

          <div class="post">
            <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
            <span class="post-time small text-muted">29th April 2010 14:19 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

            <p class="post-content">Currently only files are supported but I will add this when I have time (AddFolder). Got exams coming up so I can't promise anything soon!<br />
            <br />
            Stu</p>
          </div>
          <hr />

          <div class="post">
            <p class="post-meta"><span class="post-author text-primary">Animaether</span><br />
            <span class="post-time small text-muted">29th April 2010 14:20 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

            <p class="post-content"></p>

            <blockquote>
              <small>Originally posted by Afrow UK</small><br />
              There's no code in there to set it back so I will add it when I have time.
            </blockquote>Cool - thanks :)<br />
            <br />

            <blockquote>
              <small>Originally posted by Alfaromeo</small><br />
              Is their any option to give search path , instead of individual files. This will ease listing files one by one
            </blockquote>Nope - I wouldn't recommend this, either.<br />
            <br />
            Let's say you need to overwrite a few files in 'c:\windows\'... would you honestly want to feed LockedList 'c:\windows\*.*' and have it throw up pretty much every locked file.. even though you might only want to overwrite two of them?<br />
            <br />
            I think your best bet is to create a list of the files you want to overwrite - either by A. hardcoding this in the installer by hand or by a pre-installer build-installer or B. extracting your files to a temporary location and use any of the FindFirst / FindNext / bits and pieces - and feed that to LockedList<br />
            <br />
            The 'B' method could be combined with lockedlist directly.<br />
            i.e.<br />
            <pre>
<code><br />for each destination path (<br />  extract the files that go to a certain path to a temporary location<br />  loop over the extacted files, and for each file (<br />    add the 'destination path\filename' to LockedList<br />  )<br />)<br /></code>
</pre><br />
            <br />
            The temporary location can be re-used with e.g. CopyFiles to get the files to the destination path without having to re-extract them from the installer.
          </div>
          <hr />

          <div class="post">
            <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
            <span class="post-time small text-muted">29th April 2010 14:39 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

            <p class="post-content">You're better of generating the LockedList AddFile/AddModule code at compile time using Locate in a specially built NSIS executable that you execute with !system (see <a href="http://nsis.sourceforge.net/Invoking_NSIS_run-time_commands_on_compile-time" target="_blank">http://nsis.sourceforge.net/Invoking...n_compile-time</a>). However, I think AddFolder would be fine when used properly (i.e. your application's path that you may wish to completely remove).<br />
            <br />
            Stu</p>
          </div>
          <hr />

          <div class="post">
            <p class="post-meta"><span class="post-author text-primary">Alfaromeo</span><br />
            <span class="post-time small text-muted">2nd May 2010 16:30 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

            <p class="post-content">@Animather<br />
            <br />
            I understand the complexity involved if AddFolder ( proposed function by Stu) is not used properly. As rightly said , using it on C:\Windows or any system related folders can be an issue. If we know what folders or files that are going to be targeted , this is not an cause of worry .<br />
            <br />
            @Stu<br />
            <br />
            This function if developed can ease my application's perfomance, because the application can cause any of the files in the instalation directory to be locked. Hence looping over and using AddFile is an existing option, but an overhead.</p>
          </div>
          <hr />

          <div class="post">
            <p class="post-meta"><span class="post-author text-primary">Animaether</span><br />
            <span class="post-time small text-muted">2nd May 2010 19:14 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

            <p class="post-content">'AddFolder' true, fair enough for self-contained areas :)</p>
          </div>
          <hr />

          <div class="post">
            <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
            <span class="post-time small text-muted">4th June 2010 12:49 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

            <p class="post-content">Uploaded v1.6.<br />
            <br />
            v1.6 - 4th June 2010<br />
            * Fixed processes getting repeated in the list.<br />
            * Fixed list not auto scrolling to absolute bottom.<br />
            * Next button text restored when using /ignore and no processes are found.<br />
            * Added AddFolder plug-in function.<br />
            * File description displayed for processes without a window caption.<br />
            * Process Id displayed for processes without a window caption or file description.<br />
            <br />
            Stu</p>
          </div>
          <hr />

          <div class="post">
            <p class="post-meta"><span class="post-author text-primary">Pawel</span><br />
            <span class="post-time small text-muted">4th June 2010 12:55 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

            <p class="post-content">Thanks Stu,<br />
            Indeed, processes were repeated in the list. Nice, that this is fixed now.<br />
            I will test new build as soon as possible.<br />
            -Pawel<br />
            <br />
            [Edit]<br />
            Stu, Please add version information to dll, in next build (for Embeddedlists.dll too)</p>
          </div>
          <hr />

          <div class="post">
            <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
            <span class="post-time small text-muted">8th July 2010 13:53 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

            <p class="post-content">v1.7 - 8th July 2010<br />
            * Process file description now retreived by SystemEnum if no process caption found.<br />
            * Added EnumProcesses plug-in function.<br />
            * SilentSearch now uses a callback function instead of the stack.<br />
            * SilentSearch /thread changed to /async.<br />
            * Previously added processes now stored in an array for look up to prevent repetitions rather than looked up in the list view control.<br />
            * Added FindProcess plug-in function.<br />
            * Now gets 64-bit processes (but not modules).<br />
            * RC2: Added version information resource.<br />
            <br />
            Stu</p>
          </div>
          <hr />

          <div class="post">
            <p class="post-meta"><span class="post-author text-primary">Pawel</span><br />
            <span class="post-time small text-muted">13th July 2010 19:22 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

            <p class="post-content">Stu,<br />
            New version 1.7 doeasn't close finded applications (searching is OK, but when I clik Next button, I got message, "Cant close applications...".)<br />
            v1.6 did it correctly.<br />
            -Pawel</p>
          </div>
          <hr />

          <div class="post">
            <p class="post-meta"><span class="post-author text-primary">jiake</span><br />
            <span class="post-time small text-muted">23rd July 2010 06:06 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

            <p class="post-content">It is really a good plugin. But I found that the icons in the listview is not the small one of a executable file but a zoomed one of the big icon (32x32). The zoomed icon doesn't look as good as the original small icon of the executable file. So I modified the source code, using ExtractIconEx function replace with ExtractIcon.<br />
            <br />
            Before:<br />
            <a href="http://forums.winamp.com/attachment.php?attachmentid=47353" target="_blank">http://forums.winamp.com/attachment....chmentid=47353</a><br />
            After:<br />
            <a href="http://forums.winamp.com/attachment.php?attachmentid=47354" target="_blank">http://forums.winamp.com/attachment....chmentid=47354</a><br />
            <br />
            Attachment is the modified source LockedList.cpp.</p>
          </div>
          <hr />

          <div class="post">
            <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
            <span class="post-time small text-muted">23rd July 2010 10:18 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

            <p class="post-content">Nice one. I will update the plug-in.<br />
            <br />
            Stu</p>
          </div>
          <hr />

          <div class="post">
            <p class="post-meta"><span class="post-author text-primary">jiake</span><br />
            <span class="post-time small text-muted">23rd July 2010 11:19 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

            <p class="post-content">Sorry for my poor English, I should say "using ExtractIconEx function to replace ExtractIcon".<br />
            <br />
            Besides, line 1660 was incorrect, I typed a blank in the word "image" by accident when modifying:<br />
            hIma geList = ImageList_Create ...<br />
            <br />
            Expecting your next version.</p>
          </div>
          <hr />

          <div class="post">
            <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
            <span class="post-time small text-muted">23rd July 2010 15:52 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

            <p class="post-content">I have uploaded v1.9. I had a look at your code - there is no need for a global variable.<br />
            <br />
            Stu</p>
          </div>
          <hr />

          <div class="post">
            <p class="post-meta"><span class="post-author text-primary">jiake</span><br />
            <span class="post-time small text-muted">23rd July 2010 16:02 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

            <p class="post-content">Yes, I am so folly, the variable is exactly unnecessary.<br />
            I have downloaded the new version, it is very good!</p>
          </div>
          <hr />

          <div class="post">
            <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
            <span class="post-time small text-muted">23rd July 2010 16:53 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

            <p class="post-content">I have found some unicode build issues while building GetVersion which will likely apply to LockedList (partly due to migrating to VS2010). Will fix and reupload soon.<br />
            <br />
            Stu</p>
          </div>
          <hr />

          <div class="post">
            <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
            <span class="post-time small text-muted">23rd July 2010 17:36 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

            <p class="post-content">Done. Unicode build was indeed faulty.<br />
            <br />
            Stu</p>
          </div>
          <hr />

          <div class="post">
            <p class="post-meta"><span class="post-author text-primary">ukreator</span><br />
            <span class="post-time small text-muted">23rd August 2010 03:47 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

            <p class="post-content"><strong>IsFileLocked issue</strong><br />
            Hi Stu<br />
            <br />
            Thanks for the plugin, it is very good and helpful.<br />
            <br />
            Anyway, while testing it in my installer I've found one bug. It treat file as blocked in the case when this file has non-existent directories within the full path. This can be easily fixed by replacing this piece of code at line 2050 in LockedList.cpp<br />
            <br /></p>
            <pre>
<code><br />      if (GetLastError() != ERROR_FILE_NOT_FOUND)<br />        fLocked = TRUE;<br /></code>
</pre><br />
            <br />
            with<br />
            <br />
            <pre>
<code><br />      if ((err != ERROR_FILE_NOT_FOUND) &amp;&amp; (err != ERROR_PATH_NOT_FOUND))<br />        fLocked = TRUE;<br /></code>
</pre><br />
            <br />
            Also it would be great to replace<br />
            <br />
            <pre>
<code><br />#include "afxres.h"<br /></code>
</pre><br />
            <br />
            to<br />
            <br />
            <pre>
<code><br />#include &lt;windows.h&gt;<br /></code>
</pre><br />
            <br />
            in LockedList.rc to be able to compile with MSVC Express edition.<br />
            <br />
            <font color="DimGray">Dmitry</font>
          </div>
          <hr />

          <div class="post">
            <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
            <span class="post-time small text-muted">23rd August 2010 10:23 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

            <p class="post-content">Thanks I'll put in those mods :)<br />
            <br />
            Stu</p>
          </div>
          <hr />

          <div class="post">
            <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
            <span class="post-time small text-muted">23rd August 2010 14:55 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

            <p class="post-content">v2.0 uploaded.<br />
            <br />
            Stu</p>
          </div>
          <hr />

          <div class="post">
            <p class="post-meta"><span class="post-author text-primary">TheGrudge</span><br />
            <span class="post-time small text-muted">5th October 2010 15:20 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

            <p class="post-content">LockedList plugin doesn't seem to work with x64?<br />
            I added this line in the installer script:<br />
            <br />
            LockedList::AddModule "$INSTDIR\some.dll"<br />
            <br />
            When compiled with w32, the dll is detected and the running program is shown. But when compiled on x64 and running it on the x64-Version of the program that is locking the dll, the file is not shown in the locked list.<br />
            <br />
            Is this a known issue?</p>
          </div>
          <hr />

          <div class="post">
            <p class="post-meta"><span class="post-author text-primary">Animaether</span><br />
            <span class="post-time small text-muted">5th October 2010 17:51 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

            <p class="post-content"></p>

            <blockquote>
              <small>Originally posted by TheGrudge</small><br />
              LockedList plugin doesn't seem to work with x64? [...] Is this a known issue?
            </blockquote>Yes. Because NSIS itself is not 64bit, and thus the LockedList plugin isn't 64bit, it also can't really access 64bit process information that would be required for this.<br />
            <br />
            One thing you can try is testing if the file is locked, rather than the module. For this you might have to use a manual testing method, like trying to open the file for appending. If that fails - the file is locked. There's a few downsides to that method (you touch the file, and you won't know -what- is locking the file), but it's possibly all you've got :)
          </div>
          <hr />

          <div class="post">
            <p class="post-meta"><span class="post-author text-primary">mj_blue</span><br />
            <span class="post-time small text-muted">6th October 2010 14:54 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

            <p class="post-content"><strong>Add Custom not working?</strong><br />
            Hi, I am making an enhancement to our installer to change the horrible "MCI-Command Handling Window" holding open an activex control to be a more sensible message but I can't get the AddCustom work.<br />
            <br />
            I have tried using the example LockedListCustom.nsi and this builds but when I say 'Yes' to the question is myapp running it never show sin the lockedlist window. I get the same behaviour in my own installer.<br />
            <br />
            Details:<br />
            <br />
            lockedlist V2.0<br />
            OS: XP SP3<br />
            NSIS: 2.46<br />
            <br />
            <br /></p>
            <pre>
<code><br />Function Isocxlocked<br />   LockedList::IsFileLocked $INSTDIR\axagp.ocx<br />   Pop $R1<br />   ${If} $R1 == true<br />    MessageBox MB_OK|MB_ICONINFORMATION `$INSTDIR\axagp.ocx IS locked!!??`<br />   ${Else}<br />    MessageBox MB_OK|MB_ICONINFORMATION `$INSTDIR\axagp.ocx is not locked.`<br />   ${EndIf}<br />Push true<br /><br />FunctionEnd<br /><br />Function MyAppCallback<br />  Pop $R0<br /><br />  ; Message box instead of actual logical test...<br />  ${If} ${Cmd} `MessageBox MB_YESNO|MB_ICONQUESTION 'Is $R0 running?' IDYES`<br />    Push true<br />  ${Else}<br />    Push false<br />  ${EndIf}<br /><br />FunctionEnd<br /><br />Function LockedListShow<br />  !insertmacro MUI_HEADER_TEXT `List of open Browsers with myapp in Use` ``<br />  GetFunctionAddress $R1 Isocxlocked<br />  LockedList::AddCustom /icon $INSTDIR\antixgpb.exe 'Internet Explorer' iexplore.exe $R1<br />  GetFunctionAddress $R0 MyAppCallback<br />    LockedList::AddCustom /icon $PLUGINSDIR\myapp.ico `My App v1.0` myapp.exe $R0<br />  LockedList::Dialog /searching "Searching for Browsers in use" /noprograms "No Browsers have Game Player in use" /autoclose<br />FunctionEnd</code>
</pre><br />
            <br />
            I have this running twice in the code above, once detecting if the file is in use (and currently forcing a true return) and once is extracted straight from the demo app.<br />
            <br />
            Any help with how to get this working appreciated.<br />
            <br />
            Thanks<br />
            <br />
            Mark Jones
          </div>
          <hr />

          <div class="post">
            <p class="post-meta"><span class="post-author text-primary">Animaether</span><br />
            <span class="post-time small text-muted">6th October 2010 16:48 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

            <p class="post-content">uh oh... looks like a bug - an older version of LockedList (which we use, haven't done the round of plugin updates yet) does work correctly with the example.</p>
          </div>
          <hr />

          <div class="post">
            <p class="post-meta"><span class="post-author text-primary">mj_blue</span><br />
            <span class="post-time small text-muted">6th October 2010 16:58 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

            <p class="post-content">Hi Animaether,<br />
            <br />
            what version of the plugin are you using? I'll downgrade on my test setup and check that this code does actually work in principle.<br />
            <br />
            Thanks<br />
            <br />
            Mark</p>
          </div>
          <hr />

          <div class="post">
            <p class="post-meta"><span class="post-author text-primary">Animaether</span><br />
            <span class="post-time small text-muted">6th October 2010 18:17 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

            <p class="post-content">My version is not versioned, so I can't say... but the date on the file inside the archive is 2010/Apr/28 - which would make it version 1.5 . Actually, I should have 1.6 in the actual current build as that fixes the Next button text. There's quite a few changes since 1.5/1.6, so I'd wait and see if Afrow knows what the problem might be (I didn't spot anything standing out in the source code, but I'm not a C/C++ programmer) so it can be fixed :)</p>
          </div>
          <hr />

          <div class="post">
            <p class="post-meta"><span class="post-author text-primary">mj_blue</span><br />
            <span class="post-time small text-muted">6th October 2010 21:28 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

            <p class="post-content">Yes, it looks like this bug was introduced in V1.7, this works in V1.6 but when I upgrade to V1.7 then myapp never gets shown using the custom example.<br />
            <br />
            A lot changed between the versions so I can't even see anything obvious to try and help sorry :(<br />
            <br />
            I could only see that it changed from using uiFunctionAddress to iFunctionAddress<br />
            <br />
            Mark</p>
          </div>
          <hr />
          <!-- Bootstrap core CSS -->
          <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
          <!--[if lt IE 9]>
                <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
                <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->

          <div class="container">
            <!-- Put navigation bar here -->

            <ol class="breadcrumb">
              <li><a href="../index.html" class="glyphicon glyphicon-home"></a></li>

              <li><a href="f-65.html">NSIS Discussion</a></li>

              <li class="active">LockedList plug-in</li>
            </ol>

            <p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=274168">LockedList plug-in</a></p><br />

            <div class="post">
              <p class="post-meta"><span class="post-author text-primary">MrSpock77</span><br />
              <span class="post-time small text-muted">11th October 2010 09:50 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

              <p class="post-content">SilentSearch doesn't work as expected in Windows 2000 (SP4). I tried to run LockedListTest.nsi. The callback function is called for every running process, which is not correct. I did also notice that the Path is empty.<br />
              <br /></p>
              <pre>
<code>Testing LockedList without threading, please wait...<br />Id: 8<br />Path: <br />Description: Process Id: 8<br />Id: 160<br />Path: <br />Description: Process Id: 160<br />Id: 188<br />Path: <br />Description: Process Id: 188<br />Id: 208<br />Path: <br />Description: NetDDE Agent<br />Id: 236<br />Path: <br />Description: Process Id: 236<br />Id: 248<br />Path: <br />Description: Process Id: 248<br />Id: 436<br />Path: <br />Description: Process Id: 436<br />Id: 464<br />Path: <br />Description: Process Id: 464<br />Id: 500<br />Path: <br />Description: Process Id: 500<br />Id: 532<br />Path: <br />Description: Process Id: 532<br />Id: 580<br />Path: <br />Description: Process Id: 580<br />Id: 624<br />Path: <br />Description: SYSTEM AGENT COM WINDOW<br />Id: 692<br />Path: <br />Description: Process Id: 692<br />Id: 712<br />Path: <br />Description: Process Id: 712<br />Id: 732<br />Path: <br />Description: Process Id: 732<br />Id: 744<br />Path: <br />Description: Process Id: 744<br />Id: 768<br />Path: <br />Description: Process Id: 768<br />Id: 1232<br />Path: <br />Description: Process Id: 1232<br />Id: 1296<br />Path: <br />Description: ModemDeviceChange<br />Id: 1380<br />Path: <br />Description: Process Id: 1380<br />Id: 1072<br />Path: <br />Description: Process Id: 1072<br />Id: 1156<br />Path: <br />Description: Process Id: 1156<br />Id: 1392<br />Path: <br />Description: Windows Task Manager<br />Id: 704<br />Path: <br />Description: LockedListTest Setup <br />Searching... 100%<br />Completed</code>
</pre>A few of our customers still use Windows 2000, so I would appreciate if this can be fixed.
            </div>
            <hr />

            <div class="post">
              <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
              <span class="post-time small text-muted">11th October 2010 12:04 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

              <p class="post-content">I'm quite busy at the moment with University. When I get some free time I'll take a look at both issues. I don't have a Windows 2000 machine handy though; only Windows XP.<br />
              <br />
              Stu</p>
            </div>
            <hr />

            <div class="post">
              <p class="post-meta"><span class="post-author text-primary">MSG</span><br />
              <span class="post-time small text-muted">11th October 2010 20:48 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

              <p class="post-content">I can test on win2k if you want. You can also poke me in the IRC channel (nick Message).</p>
            </div>
            <hr />

            <div class="post">
              <p class="post-meta"><span class="post-author text-primary">mj_blue</span><br />
              <span class="post-time small text-muted">12th October 2010 09:26 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

              <p class="post-content">Thanks Afrow.. I am looking into getting setup so I can build plugins and will try stepping through it if I ever get setup</p>
            </div>
            <hr />

            <div class="post">
              <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
              <span class="post-time small text-muted">12th October 2010 09:35 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

              <p class="post-content">That would be helpful. You can use Visual Studio Express:<br />
              <a href="http://www.microsoft.com/express/Windows/" target="_blank">http://www.microsoft.com/express/Windows/</a><br />
              Will also need a Windows SDK suitable for Windows 2000.<br />
              <br />
              Stu</p>
            </div>
            <hr />

            <div class="post">
              <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
              <span class="post-time small text-muted">19th October 2010 14:28 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

              <p class="post-content">Uploaded v2.2:<br />
              * Fixed AddCustom not adding items.<br />
              * No longer returns processes with no file path.<br />
              * Added /autonext to automatically go to the next page when no items are found.<br />
              <br />
              Note: The Windows 2000 issue is not fixed (merely avoided). It is likely that this plug-in will not work on Windows 2000 (it may use API only available in XP and above).<br />
              <br />
              Stu</p>
            </div>
            <hr />

            <div class="post">
              <p class="post-meta"><span class="post-author text-primary">mj_blue</span><br />
              <span class="post-time small text-muted">19th October 2010 18:54 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

              <p class="post-content">Custom callbacks now work a treat for me in V2.2, Thanks Afrow. I did look at if I could build this but the solution appeared to be a VS2010 solution and I am setup with VS2008 for work.<br />
              <br />
              Thanks again<br />
              <br />
              Mark</p>
            </div>
            <hr />

            <div class="post">
              <p class="post-meta"><span class="post-author text-primary">MrSpock77</span><br />
              <span class="post-time small text-muted">22nd December 2010 16:07 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

              <p class="post-content">I would like to have another switch to LockedList::Dialog and LockedList::InitDialog which automatically closes the dialog if no running applications were found. I just want to move on to the next page, without having to click Next.</p>
            </div>
            <hr />

            <div class="post">
              <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
              <span class="post-time small text-muted">24th December 2010 15:21 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

              <p class="post-content">Just noticed /autonext is missing from the readme (except under the changelog). Will fix the readme. /autonext is what you want.<br />
              <br />
              Stu</p>
            </div>
            <hr />

            <div class="post">
              <p class="post-meta"><span class="post-author text-primary">Anders</span><br />
              <span class="post-time small text-muted">24th December 2010 16:06 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

              <p class="post-content"></p>

              <blockquote>
                <small>Originally posted by Afrow UK</small><br />
                Note: The Windows 2000 issue is not fixed (merely avoided). It is likely that this plug-in will not work on Windows 2000 (it may use API only available in XP and above).
              </blockquote>I don't see any reason why you can't make this work on 2000 (And probably NT4), but you have some hardcoded constants that are wrong (I just looked at a small part of the source, there are probably more :) )<br />
              <br />
              <pre>
<span style="color: #FF8000">//SkipSystemIdleProcessandSystem.
<br /></span><span style="color: #007700">if(</span><span style="color: #0000BB">file</span><span style="color: #007700">.</span><span style="color: #0000BB">ProcessId</span><span style="color: #007700">==</span><span style="color: #0000BB">0</span><span style="color: #007700">||</span><span style="color: #0000BB">file</span><span style="color: #007700">.</span><span style="color: #0000BB">ProcessId</span><span style="color: #007700">==</span><span style="color: #0000BB">4</span><span style="color: #007700">)
<br />return</span><span style="color: #0000BB">TRUE</span><span style="color: #007700">;
</span>
</pre>System process pid is 8 on 2k and 2 on NT4 IIRC<br />
              <br />
              When getting SystemHandleInformation on &lt;=2003 (no more service packs there) you can check the object type directly without the need for threads (Must skip pipe's IIRC)
            </div>
            <hr />

            <div class="post">
              <p class="post-meta"><span class="post-author text-primary">LoRd_MuldeR</span><br />
              <span class="post-time small text-muted">24th December 2010 16:42 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

              <p class="post-content"></p>

              <blockquote>
                <small>Originally posted by Afrow UK</small><br />
                Just noticed /autonext is missing from the readme (except under the changelog). Will fix the readme. /autonext is what you want.<br />
                <br />
                Stu
              </blockquote>That's something I've been looking for too.<br />
              <br />
              Small request: Would it be possible to proceed automatically, as soon as all conflicting programs have been closed?<br />
              <br />
              Currently it only proceeds automatically if initially no conflicting program was running...
            </div>
            <hr />

            <div class="post">
              <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
              <span class="post-time small text-muted">24th December 2010 17:50 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

              <p class="post-content"></p>

              <blockquote>
                <small>Originally posted by LoRd_MuldeR</small><br />
                Small request: Would it be possible to proceed automatically, as soon as all conflicting programs have been closed?
              </blockquote>This is in for next version. Thanks Anders I will look into that. I used threads because sometimes the func calls never return. Do you mean this should not happen on &lt;= 2003? MuldeR, is there some remoting software you can install on the 2000 VM so that I can access it? I'm not sure if LogMeIn is an option. The other option I guess is I buy and mount a drive to install 2000 on and then create a VirtualBox image from it.<br />
              <br />
              Stu
            </div>
            <hr />

            <div class="post">
              <p class="post-meta"><span class="post-author text-primary">LoRd_MuldeR</span><br />
              <span class="post-time small text-muted">24th December 2010 19:11 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

              <p class="post-content"></p>

              <blockquote>
                <small>Originally posted by Afrow UK</small><br />
                This is in for next version. Thanks Anders I will look into that. I used threads because sometimes the func calls never return. Do you mean this should not happen on &lt;= 2003? MuldeR, is there some remoting software you can install on the 2000 VM so that I can access it? I'm not sure if LogMeIn is an option. The other option I guess is I buy and mount a drive to install 2000 on and then create a VirtualBox image from it.<br />
                <br />
                Stu
              </blockquote>Is TeamViewer okay for you? (see your PM)
            </div>
            <hr />

            <div class="post">
              <p class="post-meta"><span class="post-author text-primary">Anders</span><br />
              <span class="post-time small text-muted">25th December 2010 00:54 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

              <p class="post-content"></p>

              <blockquote>
                <small>Originally posted by Afrow UK</small><br />
                Do you mean this should not happen on &lt;= 2003?<br />
                Stu
              </blockquote>No, I mean the object type constants are known, and only certain object types cause problems when getting their name, so you can filter away based on the type before getting the names of the types you are interested in...
            </div>
            <hr />

            <div class="post">
              <p class="post-meta"><span class="post-author text-primary">LoRd_MuldeR</span><br />
              <span class="post-time small text-muted">26th December 2010 14:48 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

              <p class="post-content"></p>

              <blockquote>
                <small>Originally posted by LoRd_MuldeR</small><br />
                Is TeamViewer okay for you? (see your PM)
              </blockquote>Afrow UK, still interested in Win2k remote access? Got my PM?<br />
              <br />
              I am ready...
            </div>
            <hr />

            <div class="post">
              <p class="post-meta"><span class="post-author text-primary">MrSpock77</span><br />
              <span class="post-time small text-muted">26th December 2010 22:19 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

              <p class="post-content"></p>

              <blockquote>
                <small>Originally posted by Afrow UK</small><br />
                Just noticed /autonext is missing from the readme (except under the changelog). Will fix the readme. /autonext is what you want.<br />
                <br />
                Stu
              </blockquote>Thank you!
            </div>
            <hr />

            <div class="post">
              <p class="post-meta"><span class="post-author text-primary">mrphantuan</span><br />
              <span class="post-time small text-muted">29th December 2010 08:36 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

              <p class="post-content">Currently it grabs the first window caption for that process id by using EnumWindows. I'll look into it. Maybe I can check if the window is a child or not and if it is then skip it.<br />
              <br />
              Stu<br />
              <br />
              <br />
              <br />
              <br />
              <br />
              <br />
              <br />
              ________________<br />
              Chung ti la mt trong nhng cng ty <a href="http://tandaiduong.com.vn" target="_blank">tu van du hoc</a> hang u Vit Nam .Chung ti la ai din cho nhiu tp oan <a href="http://tandaiduong.com.vn" target="_blank">du hoc</a> hang u TG tai Vietnam .Hang nm u co cac xut <a href="http://tandaiduong.com.vn" target="_blank">hoc bong du hoc</a> min phi i vu <a href="http://tandaiduong.com.vn/duhoc-News,at,categories,catid,15.html" target="_blank">du hoc singapore</a>.</p>
            </div>
            <hr />

            <div class="post">
              <p class="post-meta"><span class="post-author text-primary">LoRd_MuldeR</span><br />
              <span class="post-time small text-muted">4th January 2011 22:13 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

              <p class="post-content"></p>

              <blockquote>
                <small>Originally posted by Afrow UK</small><br />
                This is in for next version. Thanks Anders I will look into that. I used threads because sometimes the func calls never return. Do you mean this should not happen on &lt;= 2003? MuldeR, is there some remoting software you can install on the 2000 VM so that I can access it? I'm not sure if LogMeIn is an option. The other option I guess is I buy and mount a drive to install 2000 on and then create a VirtualBox image from it.<br />
                <br />
                Stu
              </blockquote>Sorry for bumping this thread, but are there any news on this? :confused:<br />
              <br />
              (The offer still stands: If I can help by providing access to the Win2k machine, feel free to contact me at any time!)
            </div>
            <hr />

            <div class="post">
              <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
              <span class="post-time small text-muted">7th February 2011 12:53 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

              <p class="post-content">Hi just an update on this. Sorry LoRd_MuldeR I never got to take up your offer on the Windows 2000 VM you had set up. Fortunately I was able to get a copy and use it in VirtualBox. The issue you found is now fixed. I just need to fix up the other small issues that Anders pointed out. Should have a new version out later today.<br />
              <br />
              Stu</p>
            </div>
            <hr />

            <div class="post">
              <p class="post-meta"><span class="post-author text-primary">LoRd_MuldeR</span><br />
              <span class="post-time small text-muted">7th February 2011 14:10 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

              <p class="post-content"></p>

              <blockquote>
                <small>Originally posted by Afrow UK</small><br />
                Hi just an update on this. Sorry LoRd_MuldeR I never got to take up your offer on the Windows 2000 VM you had set up. Fortunately I was able to get a copy and use it in VirtualBox. The issue you found is now fixed. I just need to fix up the other small issues that Anders pointed out. Should have a new version out later today.<br />
                <br />
                Stu
              </blockquote>That's good news :)
            </div>
            <hr />

            <div class="post">
              <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
              <span class="post-time small text-muted">7th February 2011 18:54 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

              <p class="post-content">v2.3 uploaded.<br />
              <br />
              Stu</p>
            </div>
            <hr />

            <div class="post">
              <p class="post-meta"><span class="post-author text-primary">LoRd_MuldeR</span><br />
              <span class="post-time small text-muted">11th February 2011 00:07 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

              <p class="post-content"></p>

              <blockquote>
                <small>Originally posted by Afrow UK</small><br />
                v2.3 uploaded.<br />
                <br />
                Stu
              </blockquote>Thanks. Works for me under Win2k now :)
            </div>
            <hr />

            <div class="post">
              <p class="post-meta"><span class="post-author text-primary">angelblaze</span><br />
              <span class="post-time small text-muted">28th February 2011 12:23 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

              <p class="post-content"><strong>Auto Terminate Patch</strong><br />
              Below is a tiny patch to add auto close/kill without user having to click next/install.<br />
              <br />
              Add new parameter /autoterm to LockedList::Dialog<br />
              <br />
              Only tested for the following invocation<br />
              LockedList::Dialog /autoterm /autonext /autoclosesilent "" ""<br />
              <br />
              probably not best way to do it but it seems to work :-)<br />
              <br /></p>
              <pre>
<code><br />Index: LockedList.cpp<br />===================================================================<br />--- LockedList.cpp      (revision 2134)<br />+++ LockedList.cpp      (working copy)<br />@@ -1598,6 +1598,11 @@<br />     {<br />       g_fAutoNext = TRUE;<br />     }<br />+    // Automatically start to Auto close/kill<br />+    else if (lstrcmpi(pszParam, TEXT("/autoterm")) == 0)<br />+    {<br />+      g_fAutoClosing = TRUE;<br />+    }<br />     // Add new ignore button.<br />     else if (lstrcmpi(pszParam, TEXT("/ignorebtn")) == 0)<br />     {<br /></code>
</pre>
            </div>
            <hr />

            <div class="post">
              <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
              <span class="post-time small text-muted">28th February 2011 13:35 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

              <p class="post-content">That's a bit drastic but OK :p<br />
              <br />
              I will add and test when I get some time.<br />
              <br />
              Stu</p>
            </div>
            <hr />

            <div class="post">
              <p class="post-meta"><span class="post-author text-primary">angelblaze</span><br />
              <span class="post-time small text-muted">28th February 2011 14:04 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

              <p class="post-content">Agreed that closing programs without user interaction isn't a generally good idea. Our reasons are:<br />
              a) the updater needs to be totally passive with no user interaction required<br />
              b) our user base has proven itself incapable of closing programs on their own<br />
              c) other nsis plugins that I tried didn't provide nice feedback so we heard some complains about the updater being unresponsive if it took a long time to close a program.<br />
              <br />
              Thank you for the excellent plugin! :cool:</p>
            </div>
            <hr />

            <div class="post">
              <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
              <span class="post-time small text-muted">2nd July 2011 15:21 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

              <p class="post-content">Small bug fix release v2.4.</p>

              <blockquote>
                * Improved support for Windows x64 - now retrieves 64-bit processes but still cannot enumerate 64-bit modules (this is not possible from a 32-bit process).<br />
                * Fixed infinite loop which sometimes occurred on Cancel button click.
              </blockquote><a href="http://nsis.sourceforge.net/File:LockedList.zip" target="_blank">http://nsis.sourceforge.net/File:LockedList.zip</a><br />
              <br />
              Stu
            </div>
            <hr />

            <div class="post">
              <p class="post-meta"><span class="post-author text-primary">LoRd_MuldeR</span><br />
              <span class="post-time small text-muted">7th July 2011 17:16 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

              <p class="post-content">Hello.<br />
              <br />
              I experience crash with v2.4 on Windows XP (32-Bit), but <i>not</i> on Windows 7 (x64):<br />
              <a href="http://img850.imageshack.us/img850/9316/clipboard49.png" target="_blank">http://img850.imageshack.us/img850/9316/clipboard49.png</a><br />
              <br />
              The code used is:<br />
              <a href="http://pastie.org/2178330" target="_blank">http://pastie.org/2178330</a><br />
              <br />
              BTW: I am using the Unicode version of your plugin-in, if that matters.<br />
              <br />
              (Reverted back to v2.3 and problem is gone)</p>
            </div>
            <hr />

            <div class="post">
              <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
              <span class="post-time small text-muted">11th July 2011 17:44 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

              <p class="post-content"></p>

              <blockquote>
                v2.5 - 11th July 2011<br />
                * Fixed crash on Windows XP 32-bit and below.
              </blockquote>Stu
            </div>
            <hr />

            <div class="post">
              <p class="post-meta"><span class="post-author text-primary">LoRd_MuldeR</span><br />
              <span class="post-time small text-muted">11th July 2011 17:51 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

              <p class="post-content"></p>

              <blockquote>
                <small>Originally posted by Afrow UK</small><br />

                <blockquote>
                  v2.5 - 11th July 2011<br />
                  * Fixed crash on Windows XP 32-bit and below.
                </blockquote>Stu
              </blockquote><a href="http://forum.doom9.org/images/smilies/thanks-t.gif" target="_blank">http://forum.doom9.org/images/smilies/thanks-t.gif</a>
            </div>
            <hr />

            <div class="post">
              <p class="post-meta"><span class="post-author text-primary">Amarynth</span><br />
              <span class="post-time small text-muted">1st August 2011 12:58 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

              <p class="post-content">Hi :)<br />
              <br />
              I wanted to use this plugin to check if someone else in LAN is locking files. But it seems as if the plugin is not able to check this.<br />
              <br />
              Am I doing something wrong or isn't it possible to check if a file in the network is locked my someone else?<br />
              <br />
              <br />
              Ama</p>
            </div>
            <hr />

            <div class="post">
              <p class="post-meta"><span class="post-author text-primary">LoRd_MuldeR</span><br />
              <span class="post-time small text-muted">1st August 2011 13:29 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

              <p class="post-content"></p>

              <blockquote>
                <small>Originally posted by Amarynth</small><br />
                Hi :)<br />
                <br />
                I wanted to use this plugin to check if someone else in LAN is locking files. But it seems as if the plugin is not able to check this.<br />
                <br />
                Am I doing something wrong or isn't it possible to check if a file in the network is locked my someone else?<br />
                <br />
                <br />
                Ama
              </blockquote>i don't think this will work.<br />
              <br />
              LockedList is <i>process</i>-based, i.e. it checks for "local" processes that hold a lock on critical files and thus prevent the installer form continuing. While it might be possible to detect whether a local file is locked by "remote" access (actually the file would then be locked by the "file sharing" service running on the local machine), it won't be possible to tell which process on the "remote" computer holds the lock. There normally is, for good reason, no way to enumerate/analyze the processes on a "remote" machine. You'd have to run some kind of "monitoring service" on the remote machine to make information about running processes available over the network. Needles to say that the communication with the monitoring service should be encrypted and password protected. WMI can probably do that though...<br />
              <br />
              Without additional "monitoring" software running on the "remote" machine, the machine_id + user_id holding the lock on the file is probably all you can get. That's basically what "Shared Folders" -&gt; "Session" shows in the "Computer Manager".
            </div>
            <hr />

            <div class="post">
              <p class="post-meta"><span class="post-author text-primary">LSI_Riedel</span><br />
              <span class="post-time small text-muted">20th September 2011 10:51 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

              <p class="post-content">Hello,<br />
              <br />
              <a href="http://pastebin.com/g8dtbrMz" target="_blank">http://pastebin.com/g8dtbrMz</a><br />
              <br />
              We're using LockedList to search for a running Process (see above part) in the .onInit function.<br />
              On 2.4 and 2.5 the installer simply exit (crashs?) between WelcomeScreen and License Page. On 2.3 it works. The problem occurs only on WinXP 64.<br />
              <br />
              We have just downgrade to 2.3 and hope we got no other problems.<br />
              Is there a way to fix it? Did you need some more information?<br />
              <br />
              <br />
              Thanks<br />
              Mike</p>
            </div>
            <hr />

            <div class="post">
              <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
              <span class="post-time small text-muted">20th September 2011 19:07 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

              <p class="post-content">To fix it one would need to rebuild the plug-in and hook it up to the debugger in Visual Studio on XP 64. Or perhaps you can compare the source code of the different versions to identify what the problem could be.<br />
              <br />
              Stu</p>
            </div>
            <hr />

            <div class="post">
              <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
              <span class="post-time small text-muted">9th January 2012 13:16 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

              <p class="post-content">New version:</p>

              <blockquote>
                v2.6 - 9th January 2012<br />
                * Added missing calls to EnableDebugPriv() in FindProcess and EnumProcesses.
              </blockquote>Stu
            </div>
            <hr />

            <div class="post">
              <p class="post-meta"><span class="post-author text-primary">rumovoice</span><br />
              <span class="post-time small text-muted">29th February 2012 14:14 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

              <p class="post-content">When LockedList is used with basic UI it correctly shows locked file list but when I click next it disables all buttons and clears user interface. So I end up with empty window and can't even close it. How to fix it? I don't want to switch to modern UI because I like minimalistic style and I'm writing an updater with only single page (setup progress).<br />
              <br />
              Here's repro code:<br /></p>
              <pre>
<code>RequestExecutionLevel user<br />SetCompress off<br />XPStyle on<br />OutFile "test.exe"<br />InstallDir "$EXEDIR\inst"<br />Icon "${NSISDIR}\contrib\graphics\icons\orange-install.ico"<br /><br />Section "Main Section" SecMain<br />        SetOutPath "$INSTDIR"<br />        LockedList::AddFolder $INSTDIR<br />        LockedList::Dialog<br />        Pop $R0 <br />        ;MessageBox MB_ICONINFORMATION|MB_OK "$R0"<br />        File "foo.dll"<br />SectionEnd</code>
</pre>
            </div>
            <hr />

            <div class="post">
              <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
              <span class="post-time small text-muted">29th February 2012 18:49 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

              <p class="post-content">You're not using the plug-in correctly. Whether you use MUI or not you can't show a dialog from a Section.<br />
              <br />
              Stu</p>
            </div>
            <hr />

            <div class="post">
              <p class="post-meta"><span class="post-author text-primary">rumovoice</span><br />
              <span class="post-time small text-muted">29th February 2012 18:56 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

              <p class="post-content">Can you please show me simple example how to use it correctly? (I'm new to NSIS and I only found examples for MUI)</p>
            </div>
            <hr />

            <div class="post">
              <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
              <span class="post-time small text-muted">1st March 2012 11:31 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

              <p class="post-content">It is the same for MUI as it is for non MUI. You create a custom page using Page.<br />
              <br />
              Stu</p>
            </div>
            <hr />

            <div class="post">
              <p class="post-meta"><span class="post-author text-primary">SwiftHalf</span><br />
              <span class="post-time small text-muted">2nd March 2012 10:04 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

              <p class="post-content"><strong>64 bit issue</strong><br />
              I just wanted to report a bug on 64 bit machines.<br />
              <br />
              The plug-in calls Wow64DisableWow64FsRedirection but doesn't switch filesystem redirection on afterwards. I found this problem because I was trying to install some dlls to System32, and they ended up in the wrong place!<br />
              <br />
              I worked around the problem by adding the following to my nsi script after the lockedlist plugin had done its stuff:<br />
              <br />
              StrCpy $1 0<br />
              System::Call kernel32::Wow64RevertWow64FsRedirection(i.r0) i.r1</p>
            </div>
            <hr />

            <div class="post">
              <p class="post-meta"><span class="post-author text-primary">stopasking</span><br />
              <span class="post-time small text-muted">16th March 2012 09:27 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

              <p class="post-content">Hi,<br />
              <br />
              the '/autonext' option is not working with the UNICODE plugin (on my Win7 x64 machine - if it is relevant).<br />
              <br />
              When I use 'LockedList::Show' and do a Pop $0 there are different strings in the ANSI and UNICODE plugin when I press the back button. $0 == 'back' (ANSI) and $0 == 'b' (UNICODE). This makes it hard to write compatible NSIS code (or I am using it the wrong way ;) ).</p>
            </div>
            <hr />
            <!-- Bootstrap core CSS -->
            <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
            <!--[if lt IE 9]>
                <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
                <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->

            <div class="container">
              <!-- Put navigation bar here -->

              <ol class="breadcrumb">
                <li><a href="../index.html" class="glyphicon glyphicon-home"></a></li>

                <li><a href="f-65.html">NSIS Discussion</a></li>

                <li class="active">LockedList plug-in</li>
              </ol>

              <p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=274168">LockedList plug-in</a></p><br />

              <div class="post">
                <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
                <span class="post-time small text-muted">16th March 2012 12:01 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                <p class="post-content">You are using the Unicode plug-in with Unicode NSIS right?<br />
                <br />
                Stu</p>
              </div>
              <hr />

              <div class="post">
                <p class="post-meta"><span class="post-author text-primary">stopasking</span><br />
                <span class="post-time small text-muted">16th March 2012 13:08 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                <p class="post-content">Hi, thanks for your quick reply.<br />
                <br />
                No, at the moment I am using the ANSI plugin with NSIS. But, because of some problems with my script I played a lot around with your plugin and also tested the UNICODE version.<br />
                Therefore I discovered these problems/bugs/inconsistencies.<br />
                <br />
                Maybe its no bug then sorry for wasting your time...<br />
                <br />
                Oh, but one other thing: Using the ANSI Plugin / 2.46 NSIS / Win7 X64. Installed on my test system was the AMD catalyst conrol center (sorry, at the moment I don't know which version - but I can receive it when you want to know).<br />
                The problem: while searching for processes it seems your plugin "touches" this running program (the control center) and causing it to crash.<br />
                Maybe the way you gain access to the running programs is the problem? The AMD tool was not in my lockedlist, btw. and it was the only program where I discovered such a behaviour but reproducable :)</p>
              </div>
              <hr />

              <div class="post">
                <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
                <span class="post-time small text-muted">16th March 2012 14:39 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                <p class="post-content">You didn't answer my question. If you want to use the Unicode version of the plug-in you have to use the Unicode version of NSIS as well. Otherwise you experience the kind of 'bugs' you are getting.<br />
                <br />
                Edit: But if you are using the Unicode NSIS build then I will check it out.<br />
                <br />
                Stu</p>
              </div>
              <hr />

              <div class="post">
                <p class="post-meta"><span class="post-author text-primary">stopasking</span><br />
                <span class="post-time small text-muted">16th March 2012 19:39 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                <p class="post-content">You are right - my fault. I did not use the NSIS UNICODE version. I will check it out and if this problem still exists I will come back to you.<br />
                <br />
                Sorry for this and thanks for your help!<br />
                <br />
                But the problem with the crashed catalyst tool while scanning for processes still exists and I used the ANSI plugin...<br />
                <br />
                Anyway, thanks again!!</p>
              </div>
              <hr />

              <div class="post">
                <p class="post-meta"><span class="post-author text-primary">LoRd_MuldeR</span><br />
                <span class="post-time small text-muted">22nd March 2012 02:05 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                <p class="post-content">Hi.<br />
                <br />
                Is sometimes get the problem that the LockedList plug-in will get stuck in the "Cancelling search, please wait..." state.<br />
                <br />
                <a href="http://img163.imageshack.us/img163/1133/lockedlistwin2kerrorv2p.jpg" target="_blank">http://img163.imageshack.us/img163/1...2kerrorv2p.jpg</a><br />
                <br />
                It will go on, as soon as I press some key or move the mouse cursor...<br />
                <br />
                My code looks like this:<br />
                <a href="http://pastie.org/private/bfkzo1mn4adypn2t83xtq" target="_blank">http://pastie.org/private/bfkzo1mn4adypn2t83xtq</a><br />
                <br />
                Thanks in advance for any advice :)</p>
              </div>
              <hr />

              <div class="post">
                <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
                <span class="post-time small text-muted">22nd March 2012 13:57 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                <p class="post-content">Will look into it as soon as I can.<br />
                <br />
                Stu</p>
              </div>
              <hr />

              <div class="post">
                <p class="post-meta"><span class="post-author text-primary">C.R.a.S.H</span><br />
                <span class="post-time small text-muted">22nd March 2012 14:53 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                <p class="post-content">Win7 x64<br />
                <br />
                After click on Copy List menu item, clipboard has only string "1"</p>
              </div>
              <hr />

              <div class="post">
                <p class="post-meta"><span class="post-author text-primary">C.R.a.S.H</span><br />
                <span class="post-time small text-muted">23rd March 2012 07:37 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                <p class="post-content"></p>

                <blockquote>
                  Which version of NSIS are you using?<br />
                  <br />
                  Which version of the LockedList plugin are you using?<br />
                  <br />
                  Does the problem occur in one of the example scripts supplied with the LockedList plugin?
                </blockquote>I'm using last version of NSIS Unicode (nsis-2.46.4-Unicode)<br />
                And last (2.6) or previous (2.5) versions of the LockedList plugin<br />
                <br />
                This problem can reproduce with all LockedList example scripts (ex: LockedListShell32.nsi)
              </div>
              <hr />

              <div class="post">
                <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
                <span class="post-time small text-muted">23rd March 2012 13:41 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                <p class="post-content">New version uploaded:</p>

                <blockquote>
                  2.6.0.1 - 23rd March 2012<br />
                  * Fixed clipboard list copy for the Unicode build.<br />
                  * Fixed crashes and infinite looping after repeatedly going back to the LockedList page.
                </blockquote>Let me know if you find any other issues or issues still remain.<br />
                <br />
                Stu
              </div>
              <hr />

              <div class="post">
                <p class="post-meta"><span class="post-author text-primary">LoRd_MuldeR</span><br />
                <span class="post-time small text-muted">23rd March 2012 13:44 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                <p class="post-content">Thank you for the update!<br />
                <br />
                I will check if it still hangs at "Cancelling search, please wait..." on my Win2k machine as soon as I get home...</p>
              </div>
              <hr />

              <div class="post">
                <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
                <span class="post-time small text-muted">23rd March 2012 13:48 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                <p class="post-content">I wasn't able to get it to hang there exactly but going to and from the page repeatedly resulted in an infinite loop or crash occurring which sounds like it could be the same issue (i.e. occurring on page leave).<br />
                <br />
                Stu</p>
              </div>
              <hr />

              <div class="post">
                <p class="post-meta"><span class="post-author text-primary">LoRd_MuldeR</span><br />
                <span class="post-time small text-muted">23rd March 2012 22:52 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                <p class="post-content"></p>

                <blockquote>
                  <small>Originally posted by Afrow UK</small><br />
                  I wasn't able to get it to hang there exactly but going to and from the page repeatedly resulted in an infinite loop or crash occurring which sounds like it could be the same issue (i.e. occurring on page leave).<br />
                  <br />
                  Stu
                </blockquote>It still happens on my Win2k machine :(
              </div>
              <hr />

              <div class="post">
                <p class="post-meta"><span class="post-author text-primary">C.R.a.S.H</span><br />
                <span class="post-time small text-muted">27th March 2012 11:13 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                <p class="post-content"></p>

                <blockquote>
                  <small>Originally posted by Afrow UK</small><br />
                  New version uploaded:Let me know if you find any other issues or issues still remain.<br />
                  <br />
                  Stu
                </blockquote>Everything ok!<br />
                Thanks.<br />
                <br />
                I found other issue<br />
                In XP SP2 (last NSIS Unicode and last plagin)<br />
                <br />
                <br />
                <br />
                Step to reproduce<br />
                <br />
                <pre>
<code><br />  LockedList::AddClass MozillaUIWindowClass<br />  LockedList::AddClass MozillaWindowClass<br />  LockedList::AddClass Chrome_WidgetWin_0<br />  LockedList::AddClass IEFrame<br />  LockedList::AddClass {1C03B488-D53B-4a81-97F8-754559640193}<br /></code>
</pre><br />
                <br />
                1. Open Google Chrome and Safari<br />
                2. Run Installer<br />
                3. Go to Close programs page<br />
                4. Several times during this step click Back and (from the previous step) Next
              </div>
              <hr />

              <div class="post">
                <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
                <span class="post-time small text-muted">27th March 2012 12:27 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                <p class="post-content">What exactly is the issue? You haven't explained what it is.<br />
                <br />
                Stu</p>
              </div>
              <hr />

              <div class="post">
                <p class="post-meta"><span class="post-author text-primary">LoRd_MuldeR</span><br />
                <span class="post-time small text-muted">7th April 2012 21:41 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                <p class="post-content"></p>

                <blockquote>
                  <small>Originally posted by LoRd_MuldeR</small><br />
                  Hi.<br />
                  <br />
                  Is sometimes get the problem that the LockedList plug-in will get stuck in the "Cancelling search, please wait..." state.<br />
                  <br />
                  <a href="http://img163.imageshack.us/img163/1133/lockedlistwin2kerrorv2p.jpg" target="_blank">http://img163.imageshack.us/img163/1...2kerrorv2p.jpg</a><br />
                  <br />
                  It will go on, as soon as I press some key or move the mouse cursor...<br />
                  <br />
                  My code looks like this:<br />
                  <a href="http://pastie.org/private/bfkzo1mn4adypn2t83xtq" target="_blank">http://pastie.org/private/bfkzo1mn4adypn2t83xtq</a><br />
                  <br />
                  Thanks in advance for any advice :)
                </blockquote><a href="http://img11.imageshack.us/img11/8112/lockedlistwineerror.png" target="_blank">http://img11.imageshack.us/img11/811...twineerror.png</a><br />
                <br />
                I noticed that this doesn't only happen on my Win2k machine, it also happens under Wine (tested under version 1.4).<br />
                <br />
                Seems like it is "hanging" because it is waiting for some message, that, for whatever reason, doesn't arrive on Win2k or Wine.<br />
                <br />
                The WM_MOUSEMOVE message will eventually "unlock" it again, so that the installer can finally proceed...
              </div>
              <hr />

              <div class="post">
                <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
                <span class="post-time small text-muted">22nd April 2012 00:25 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                <p class="post-content">New version:</p>

                <blockquote>
                  2.6.0.2 - 22nd April 2012<br />
                  * Fixed window message loop halting page leave until mouse move on Windows 2000.
                </blockquote>Stu
              </div>
              <hr />

              <div class="post">
                <p class="post-meta"><span class="post-author text-primary">LoRd_MuldeR</span><br />
                <span class="post-time small text-muted">22nd April 2012 00:58 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                <p class="post-content"></p>

                <blockquote>
                  <small>Originally posted by Afrow UK</small><br />
                  New version:Stu
                </blockquote><a href="http://forum.doom9.org/images/smilies/thanks-t.gif" target="_blank">http://forum.doom9.org/images/smilies/thanks-t.gif</a>
              </div>
              <hr />

              <div class="post">
                <p class="post-meta"><span class="post-author text-primary">pocruadhlaoich</span><br />
                <span class="post-time small text-muted">25th April 2012 15:54 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                <p class="post-content">Hi,<br />
                I have a customer who wants to install our software but is being prevented from doing so because they are being asked to close a lot of processes that they do not want to ( please see attached image ).<br />
                The code that I am using is as follows:<br />
                <br />
                PHP Code:</p>
                <hr />
                <code style="white-space:nowrap"><!-- php buffer start --></code><span style="color: #000000"><span style="color: #FF8000">#installerpages<br />
                <br /></span> <span style="color: #007700">!</span><span style="color: #0000BB">insertmacroMUI_PAGE_WELCOME<br /></span> <span style="color: #007700">!</span><span style="color: #0000BB">insertmacroMUI_PAGE_LICENSE</span><span style="color: #DD0000">"${MY_DEPENDENCIES_FOLDER}\installer\License\License.txt"<br /></span> <span style="color: #0000BB">PageCustomLockedListPage<br /></span> <span style="color: #007700">!</span><span style="color: #0000BB">insertmacroMUI_PAGE_DIRECTORY<br /></span> <span style="color: #007700">!</span><span style="color: #0000BB">insertmacroMUI_PAGE_INSTFILES<br /></span> <span style="color: #007700">!</span><span style="color: #0000BB">insertmacroMUI_PAGE_FINISH<br />
                <br /></span> <span style="color: #FF8000">#uninstallerpages<br />
                <br /></span> <span style="color: #007700">!</span><span style="color: #0000BB">insertmacroMUI_UNPAGE_WELCOME<br />
                UninstPageCustomun</span><span style="color: #007700">.</span><span style="color: #0000BB">LockedListPage<br /></span> <span style="color: #007700">!</span><span style="color: #0000BB">insertmacroMUI_UNPAGE_CONFIRM<br /></span> <span style="color: #007700">!</span><span style="color: #0000BB">insertmacroMUI_UNPAGE_INSTFILES<br />
                <br /></span> <span style="color: #007700">Function</span><span style="color: #0000BB">LockedListPage<br /></span> <span style="color: #FF8000">#customdialogshownduringinstallationwhichwillcheckifanyrequiredfilesneedtobeclosed<br />
                <br /></span> <span style="color: #007700">!</span><span style="color: #0000BB">insertmacroMUI_HEADER_TEXT</span><span style="color: #DD0000">"CloseRequiredFiles""Filesthatmustbeclosedsothatsetupcancontinue."<br /></span> <span style="color: #0000BB">LockedList</span><span style="color: #007700">::</span><span style="color: #0000BB">AddFolder$INSTDIR<br />
                LockedList</span><span style="color: #007700">::</span><span style="color: #0000BB">Dialog<br />
                Pop$R0<br />
                FunctionEnd<br />
                <br /></span> <span style="color: #007700">Function</span><span style="color: #0000BB">un</span><span style="color: #007700">.</span><span style="color: #0000BB">LockedListPage<br /></span> <span style="color: #FF8000">#customdialogshownduringuninstallationwhichwillcheckifanyrequiredfilesneedtobeclosed<br />
                <br /></span> <span style="color: #007700">!</span><span style="color: #0000BB">insertmacroMUI_HEADER_TEXT</span><span style="color: #DD0000">"CloseRequiredFiles""Filesthatmustbeclosedsothatsetupcancontinue."<br /></span> <span style="color: #0000BB">LockedList</span><span style="color: #007700">::</span><span style="color: #0000BB">AddFolder$INSTDIR<br />
                LockedList</span><span style="color: #007700">::</span><span style="color: #0000BB">Dialog<br />
                Pop$R0<br />
                FunctionEnd<br /></span></span> <!-- php buffer end -->
                <hr />
                Can you see any reason why it thinks that so many processes need to be stopped? The installer would add .exe's, .dll's and various help files to the computer. Our software has not even been installed onto this computer yet, so I am not sure what to do. Should I call something other than AddFolder?
              </div>
              <hr />

              <div class="post">
                <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
                <span class="post-time small text-muted">25th April 2012 16:22 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                <p class="post-content">What is the value of $INSTDIR? Yeah AddFile/AddFolder may not work properly on Windows 7. I need to retest those probably. I would recommend trying AddModule instead (32-bit binaries only).<br />
                <br />
                Edit: Ignore what I just said. Just fixed it.<br />
                <a href="http://nsis.sourceforge.net/File:LockedList.zip" target="_blank">http://nsis.sourceforge.net/File:LockedList.zip</a><br />
                <br />
                No idea how that was broken for so long with nobody noticing :)</p>

                <blockquote>
                  2.6.1.0 - 25th April 2012<br />
                  * Fixed StartsWith() matching incorrectly for some strings.
                </blockquote>Edit 2: You may still want to look into AddModule though as it is a lot faster than AddFile/AddFolder. Unfortunately it will only work for 32-bit modules as NSIS is 32-bit.<br />
                <br />
                Stu
              </div>
              <hr />

              <div class="post">
                <p class="post-meta"><span class="post-author text-primary">pocruadhlaoich</span><br />
                <span class="post-time small text-muted">25th April 2012 16:56 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                <p class="post-content">Hi Afrow,<br />
                $INSTDIR = "C:\Program Files (x86)\InspecVision\Planar"<br />
                At this time in the install, this would be the default location for where the product would be installed. The customer is trying to install it there for the first time, so given that the directory doesn't exist yet, then it should not be complaining about anything.<br />
                Just to confirm, this is an example of me calling AddFolder under Windows 7 and having problems with it. I will take a look into AddModule now and get back to you with any progress.<br />
                Thanks,<br />
                Patrick</p>
              </div>
              <hr />

              <div class="post">
                <p class="post-meta"><span class="post-author text-primary">pocruadhlaoich</span><br />
                <span class="post-time small text-muted">27th April 2012 09:46 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                <p class="post-content">Hi Afrow,<br />
                I changed my installer to use AddModule and this seems to work much better on my customer's Windows 7 machine. I was able to do a remote connection with them when the installer was using AddFolder and due to their IT environment it was showing about 10 unrelated processes and services ( eg mcafee ) that needed to be closed before installation could continue. Using AddModule all is fine. Thanks for your help :)<br />
                Patrick</p>
              </div>
              <hr />

              <div class="post">
                <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
                <span class="post-time small text-muted">27th April 2012 11:30 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                <p class="post-content">Did you not get my message or see my post edit? I fixed AddFolder - or are you saying that fix is not working?<br />
                <br />
                Stu</p>
              </div>
              <hr />

              <div class="post">
                <p class="post-meta"><span class="post-author text-primary">pocruadhlaoich</span><br />
                <span class="post-time small text-muted">27th April 2012 11:53 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                <p class="post-content">I saw your original message but I hadn't seen the edit to it. This problem is only really repeatable on the customer's machine, so I now that I know that AddModule is working I have already sent him an installer using it. I don't have access to test out your new AddFolder code unfortunately unless the customer comes back with anything else. If they do, I will definitely let you know.</p>
              </div>
              <hr />

              <div class="post">
                <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
                <span class="post-time small text-muted">27th April 2012 12:16 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                <p class="post-content">OK thanks. In my test I used a folder path that didn't exist and had some matches, which sounds like the same issue.<br />
                <br />
                Stu</p>
              </div>
              <hr />

              <div class="post">
                <p class="post-meta"><span class="post-author text-primary">neilsut</span><br />
                <span class="post-time small text-muted">4th May 2012 16:10 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                <p class="post-content">Hi there, I have been trying to get this plugin to work with no luck. I'm sure it must be something simple that I am doing wrong.<br />
                <br />
                I am trying to use it as follows:-<br />
                <br />
                PHP Code:</p>
                <hr />
                <code style="white-space:nowrap"><!-- php buffer start --></code><span style="color: #000000"><span style="color: #007700">Function</span><span style="color: #0000BB">LockedListShow<br /></span> <span style="color: #007700">!</span><span style="color: #0000BB">insertmacroMUI_HEADER_TEXT</span><span style="color: #007700">`</span><span style="color: #0000BB">LockedListTest</span><span style="color: #007700">``</span><span style="color: #0000BB">UsingFindProcess</span><span style="color: #007700">`<br /></span> <span style="color: #0000BB">LockedList</span><span style="color: #007700">::</span><span style="color: #0000BB">FindProcessnotepad</span><span style="color: #007700">.</span><span style="color: #0000BB">exe<br />
                LockedList</span><span style="color: #007700">::</span><span style="color: #0000BB">Dialog</span><span style="color: #007700">/</span><span style="color: #0000BB">autonext<br />
                Pop$R0<br />
                FunctionEnd<br /></span></span> <!-- php buffer end -->
                <hr />
                I'm using notepad here just as a test. When I run it the locked list page appears with the 'No programs that have to be closed are running' message showing, regardless of whether notepad.exe is running or not.<br />
                <br />
                I've also tried the sample lockedlistfindprocess.nsi with no luck either. It does not display any prompts if notepad is running.<br />
                <br />
                I've tried running on XP and 7, 32 and 64 bit, all with the same result.<br />
                <br />
                Any ideas what could be going wrong?<br />
                <br />
                Cheers,<br />
                <br />
                Neil.
              </div>
              <hr />

              <div class="post">
                <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
                <span class="post-time small text-muted">4th May 2012 16:17 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                <p class="post-content">You are not using the plug-in correctly. Look at the example scripts. There is an example script specifically for FindProcess (which is a utility function - LockedListFindProcess.nsi) and one for showing the LockedList dialog with notepad (LockedListNotepad.nsi).<br />
                <br />
                Stu</p>
              </div>
              <hr />

              <div class="post">
                <p class="post-meta"><span class="post-author text-primary">neilsut</span><br />
                <span class="post-time small text-muted">8th May 2012 10:25 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                <p class="post-content">Hi Stu, thanks very much for your help.<br />
                <br />
                It's a shame that I can't use FindProcess with the dialog. However, I've tried both the LockedListFindProcess.nsi and LockedListNotepad.nsi samples, both of which do not detect that notepad is running. I've tried changing the scripts to check for other executables that I have running with the same negative results.<br />
                It makes me wonder if there might be something up with my system that could cause this. Any ideas?<br />
                <br />
                Cheers,<br />
                <br />
                Neil.</p>
              </div>
              <hr />

              <div class="post">
                <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
                <span class="post-time small text-muted">8th May 2012 11:45 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                <p class="post-content">You don't need to use FindProcess - the whole idea is you use the plug-in to detect a locked file, folder or module (dll/exe) and it will display the process(es) that is locking it. If you want to add a process yourself, you can use FindProcess in a custom callback - see the LockedListCustom.nsi example script.<br />
                <br />
                AddModule will not find 64-bit processes because NSIS is 32-bit. If you are running Windows x64 then you must run notepad.exe from SysWOW64 for the Notepad example to work. Yes this is a big drawback to the plug-in but unfortunately this is a limitation imposed by Windows. The readme clearly states this fact too - please read it.<br />
                <br />
                Edit: I do have plans to add an AddProcess method some day which will work on 32bit/64bit Windows (by using WMI).<br />
                <br />
                Stu</p>
              </div>
              <hr />

              <div class="post">
                <p class="post-meta"><span class="post-author text-primary">neilsut</span><br />
                <span class="post-time small text-muted">8th May 2012 12:53 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                <p class="post-content">Yes I have read the readme and was aware of the 64 bit limitation, which is something I need to work around for my application.<br />
                <br />
                I've tried the LockedListCustom.nsi example, and even that is not working. From looking at the script code I would expect to see a message box asking if My App v1.0 is running. However I don't see this, the page just says "No programs that have to be closed are running". So it looks like the callback is not being called?<br />
                <br />
                To give you some background, the problem that I am trying to solve is this. We write add-ins for AutoCAD. These add-ins are locked when AutoCAD is running so I need a way to prompt the user to close it. The complication is that AutoCAD comes in many flavours, languages, versions, plus 32 and 64 bit. The one constant is that its executable is always acad.exe. So I am thinking that my installer should be checking if acad.exe is a running process. However I can't seem to get the lockedlist plugin to do this.<br />
                <br />
                Edit: I've also tried the LockedListEnumProcesses.nsi example, and this too does not seem to work at all. I.e. no processes are listed in the details window.<br />
                <br />
                Any help you can provide would be much appreciated.<br />
                <br />
                Cheers,<br />
                <br />
                Neil.</p>
              </div>
              <hr />

              <div class="post">
                <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
                <span class="post-time small text-muted">8th May 2012 15:44 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                <p class="post-content">If nothing is working then the first thing I would check is if you've extracted the correct plug-in DLL. There's a Unicode version and an ANSI version - if you aren't using Unicode NSIS then you must use the ANSI version. I have just tested those two scripts and they are working fine for me (Windows 7 x64). In fact EnumProcesses is picking up 64-bit processes and their paths too - I'll look into that and see if I can get it to work for AddModule (when giving it an executable file).<br />
                <br />
                Edit: I just tried AddModule again and it does actually work for 64-bit processes after all (I was trying to find notepad.exe when I use notepad2.exe)! What it cannot do is find 64-bit DLL files (the 64-bit processes that are using them). I should update the readme. Either I fixed it myself some point or Microsoft have changed their API's to work for 32-bit processes via a Windows update.<br />
                <br />
                Stu</p>
              </div>
              <hr />

              <div class="post">
                <p class="post-meta"><span class="post-author text-primary">neilsut</span><br />
                <span class="post-time small text-muted">8th May 2012 16:42 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                <p class="post-content">Well it turns out that I was inadvertently trying to use the unicode build with an ansi installer. In my defence, it seems to have been caused by a bug in IZArc which I used to extract the dll from the zip file.<br />
                <br />
                Anyway, it all seems to be working on both 32 and 64 bit now, so thanks very much for your help with this!<br />
                <br />
                Cheers,<br />
                <br />
                Neil.</p>
              </div>
              <hr />

              <div class="post">
                <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
                <span class="post-time small text-muted">3rd June 2012 18:52 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                <p class="post-content">New version.</p>

                <blockquote>
                  2.6.1.1 - 3rd June 2012<br />
                  * Added autoclose code to SilentSearch.<br />
                  * Fixed some bugs in SystemEnum (v1.5).
                </blockquote>This version allows you to close your running programs via a callback function. It is useful if you do not wish to use the UI.<br />
                <br />
                <a href="http://nsis.sourceforge.net/File:LockedList.zip" target="_blank">http://nsis.sourceforge.net/File:LockedList.zip</a><br />
                <br />
                Stu
              </div>
              <hr />

              <div class="post">
                <p class="post-meta"><span class="post-author text-primary">notedible</span><br />
                <span class="post-time small text-muted">29th June 2012 19:51 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                <p class="post-content"><strong>Back button does not work with autonext</strong><br />
                Firstly, thanks for the great plugin!<br />
                <br />
                When using</p>
                <pre>
<code>LockedList::Dialog /autonext</code>
</pre>the back button doesn't work properly and instead takes you to the next page. Not really the desired behaviour since it prevents the user from going back past a certain point in the installer. This is using the latest ANSI plug-in (2.6.1.1).
              </div>
              <hr />

              <div class="post">
                <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
                <span class="post-time small text-muted">29th June 2012 21:02 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                <p class="post-content">I cannot reproduce using the example script (LockedListAutoClose.nsi). Can you attach a full script that reproduces the issue?<br />
                <br />
                Stu</p>
              </div>
              <hr />

              <div class="post">
                <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
                <span class="post-time small text-muted">1st July 2012 23:45 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                <p class="post-content">New version:</p>

                <blockquote>
                  2.6.1.2 - 1st July 2012<br />
                  * Kills processes with no windows when using autoclose with SilentSearch.
                </blockquote>Stu
              </div>
              <hr />

              <div class="post">
                <p class="post-meta"><span class="post-author text-primary">notedible</span><br />
                <span class="post-time small text-muted">2nd July 2012 19:59 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                <p class="post-content"></p>

                <blockquote>
                  <small>Originally posted by Afrow UK</small><br />
                  I cannot reproduce using the example script (LockedListAutoClose.nsi). Can you attach a full script that reproduces the issue?<br />
                  <br />
                  Stu
                </blockquote>It seems the problem is more specific. Also, it is with autonext, not autoclose, that the problem exists. Using LockedListAutoNext.nsi as a base, I can reproduce the problem every time as long as notepad is not running. It seems that the problem occurs when no results are in the list while searching. The behavior is easier to see if AddFolder is used instead of AddModule. For instance, replace:<br />
                <pre>
<code>LockedList::AddModule $SYSDIR\notepad.exe</code>
</pre><br />
                in LockedListAutoNext.nsi with:<br />
                <pre>
<code>LockedList::AddFolder $SYSDIR\some_unused_or_non_existent_dir</code>
</pre><br />
                and you can see the back button behaves like the next button. But if you change the folder to one that must be in use so that you get results, such as:<br />
                <pre>
<code>LockedList::AddFolder $SYSDIR</code>
</pre><br />
                then the back button works correctly (even while search is ongoing).<br />
                <br />
                So again, the problem is only present when the result list is empty during search with /autonext
              </div>
              <hr />

              <div class="post">
                <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
                <span class="post-time small text-muted">2nd July 2012 20:26 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                <p class="post-content">Ah my bad for some reason I read that as autoclose. I need to get more sleep! I will check it out soon.<br />
                <br />
                Stu</p>
              </div>
              <hr />

              <div class="post">
                <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
                <span class="post-time small text-muted">3rd July 2012 22:22 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                <p class="post-content">What you must do is call Abort in your NSIS code if you have clicked Back from the next page, rather than show the LockedList dialog. This can be done by setting and checking a variable - see attached.<br />
                <br />
                Edit: LockedList cannot do this for you as it does not automatically know nor can automatically know (to my knowledge) that you have just clicked the Back button on the next page.<br />
                <br />
                Stu</p>
              </div>
              <hr />

              <div class="post">
                <p class="post-meta"><span class="post-author text-primary">notedible</span><br />
                <span class="post-time small text-muted">10th July 2012 23:38 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                <p class="post-content"></p>

                <blockquote>
                  <small>Originally posted by Afrow UK</small><br />
                  What you must do is call Abort in your NSIS code if you have clicked Back from the next page, rather than show the LockedList dialog. This can be done by setting and checking a variable - see attached.
                </blockquote>But the problem is on the LockedList page itself. The first time the LockedList page shows up, if I click Back (during the scan) then it goes to the next page, but only if there are no results yet. If there are results and the scan is still in progress, the Back button works fine.<br />
                <br />
                In other words:<br />
                <br />
                1. Navigate to a LockedList page<br />
                2. During the scan, click Back<br />
                <br />
                If:<br />
                <br />
                a. there was a partial list of results at the time the Back button was clicked, then it will go back (as expected)<br />
                b. there were no results at the time the Back button was clicked, then it will go to the next page (NOT EXPECTED)<br />
                <br />
                'a' is the desired behavior regardless of whether search has found anything or not. I understand the behavior you mean if the user has already navigated past the LockedList page where we would skip back to the page before the LockedList page, but this behavior should not happen while the LockedList page is visible, and especially not on the first view of the page. I hope this clears up what I'm hoping to fix!
              </div>
              <hr />

              <div class="post">
                <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
                <span class="post-time small text-muted">11th July 2012 00:23 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                <p class="post-content">Sorry I misunderstood what you were saying. But what I thought you were saying is also a valid problem. LockedList will block you from going back once you get to the next page if no programs are running - to fix requires the code I attached. I'll look into this other problem soon.<br />
                <br />
                Stu</p>
              </div>
              <hr />
              <!-- Bootstrap core CSS -->
              <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
              <!--[if lt IE 9]>
                <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
                <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->

              <div class="container">
                <!-- Put navigation bar here -->

                <ol class="breadcrumb">
                  <li><a href="../index.html" class="glyphicon glyphicon-home"></a></li>

                  <li><a href="f-65.html">NSIS Discussion</a></li>

                  <li class="active">LockedList plug-in</li>
                </ol>

                <p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=274168">LockedList plug-in</a></p><br />

                <div class="post">
                  <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
                  <span class="post-time small text-muted">12th July 2012 16:15 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                  <p class="post-content">New version.</p>

                  <blockquote>
                    2.6.1.3 - 12th July 2012<br />
                    * Fixed Back button triggering auto-next during scan when /autonext is used.
                  </blockquote><a href="http://nsis.sourceforge.net/File:LockedList.zip" target="_blank">http://nsis.sourceforge.net/File:LockedList.zip</a><br />
                  <br />
                  Stu
                </div>
                <hr />

                <div class="post">
                  <p class="post-meta"><span class="post-author text-primary">Pawel</span><br />
                  <span class="post-time small text-muted">12th July 2012 18:07 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                  <p class="post-content">Stu,<br />
                  The newest plugin crashes for me<br />
                  LockedList Unicode: 2.6.1.3<br />
                  NSIS Unicode 2.46.5<br />
                  Windows 7 x64 (Language PL)<br />
                  Used syntax:<br /></p>
                  <pre>
<span style="color: #007700">Function</span><span style="color: #0000BB">CreateLockedListPage
<br /><br /></span><span style="color: #007700">${If}${</span><span style="color: #0000BB">AtLeastWinNt4</span><span style="color: #007700">}
<br />!</span><span style="color: #0000BB">insertmacroMUI_HEADER_TEXT</span><span style="color: #DD0000">"Title""Subtitle"
<br /></span><span style="color: #0000BB">LockedList</span><span style="color: #007700">::</span><span style="color: #0000BB">AddModule</span><span style="color: #DD0000">"$INSTDIR\winamp.exe"
<br /></span><span style="color: #0000BB">LockedList</span><span style="color: #007700">::</span><span style="color: #0000BB">Dialog</span><span style="color: #007700">/</span><span style="color: #0000BB">heading</span><span style="color: #DD0000">"Text1"</span><span style="color: #007700">/</span><span style="color: #0000BB">colheadings</span><span style="color: #DD0000">"Text2""Text3"</span><span style="color: #007700">/</span><span style="color: #0000BB">noprograms</span><span style="color: #DD0000">"Text4"</span><span style="color: #007700">/</span><span style="color: #0000BB">searching</span><span style="color: #DD0000">"Text5"</span><span style="color: #007700">/</span><span style="color: #0000BB">endsearch</span><span style="color: #DD0000">"Text6"</span><span style="color: #007700">/</span><span style="color: #0000BB">endmonitor</span><span style="color: #DD0000">"Text7"</span><span style="color: #007700">/</span><span style="color: #0000BB">autoclosesilent</span><span style="color: #DD0000">"Text8"</span><span style="color: #007700">$(^</span><span style="color: #0000BB">NextBtn</span><span style="color: #007700">)/</span><span style="color: #0000BB">menuitems</span><span style="color: #DD0000">"Text9""Text10"
<br /></span><span style="color: #007700">${EndIf}
<br /><br /></span><span style="color: #0000BB">FunctionEnd
<br /></span>

<!-- php buffer end -->
                
                
                
</pre>
                  <hr />
                  <pre>
        
It crashes on the end of searching, when going to next page (Components Page).<br /><br />Edit:<br />Last working build is: 2.6.1.0<br />[Build 2.6.1.1, 2.6.1.2 and 2.6.1.3 crashes]<br /><br />Edit2:<br />ANSI build 2.6.1.3 works OK.<br />However, if I use /autonext option and do:<br />- Welcome Page -&gt; LockedPage (not showed thanks to /autonext) -&gt; Components Page  &lt;-- LockedPage -&gt; I can not go to previous page, as LockedPage is autonext forward...<br />I hope you understand.<br /><br />-Pawel
                
</pre>
                </div>
                <hr />

                <div class="post">
                  <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
                  <span class="post-time small text-muted">12th July 2012 18:26 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                  <p class="post-content">What OS?<br />
                  <br />
                  Edit: Regarding the autonext problem see a few posts back.<br />
                  <br />
                  Stu</p>
                </div>
                <hr />

                <div class="post">
                  <p class="post-meta"><span class="post-author text-primary">Pawel</span><br />
                  <span class="post-time small text-muted">12th July 2012 18:27 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                  <p class="post-content">As I wrote in my first post, Windows 7 x64 with Polish language.</p>
                </div>
                <hr />

                <div class="post">
                  <p class="post-meta"><span class="post-author text-primary">Pawel</span><br />
                  <span class="post-time small text-muted">12th July 2012 18:44 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                  <p class="post-content">OK, thanks.<br />
                  -Pawel</p>
                </div>
                <hr />

                <div class="post">
                  <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
                  <span class="post-time small text-muted">12th July 2012 19:37 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                  <p class="post-content">New version.</p>

                  <blockquote>
                    2.6.1.4 - 12th July 2012<br />
                    * Fixed a crash in SystemEnum (v1.6) for the Unicode build.
                  </blockquote><a href="http://nsis.sourceforge.net/File:LockedList.zip" target="_blank">http://nsis.sourceforge.net/File:LockedList.zip</a><br />
                  <br />
                  Stu
                </div>
                <hr />

                <div class="post">
                  <p class="post-meta"><span class="post-author text-primary">Pawel</span><br />
                  <span class="post-time small text-muted">12th July 2012 19:45 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                  <p class="post-content">Stu, I confirm it is fixed now. Thx.<br />
                  -Pawel</p>
                </div>
                <hr />

                <div class="post">
                  <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
                  <span class="post-time small text-muted">12th July 2012 21:04 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                  <p class="post-content">Great :)<br />
                  <br />
                  Edit: Post 8000 FTW!<br />
                  <br />
                  Stu</p>
                </div>
                <hr />

                <div class="post">
                  <p class="post-meta"><span class="post-author text-primary">SubJunk</span><br />
                  <span class="post-time small text-muted">10th December 2012 22:53 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                  <p class="post-content">This is a great plugin, thanks!<br />
                  Is there a way to use autonext and autoclosesilent? In other words I would like it to skip the page if the file is not locked, but if it is locked then offer an option to close it.</p>
                </div>
                <hr />

                <div class="post">
                  <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
                  <span class="post-time small text-muted">11th December 2012 16:14 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                  <p class="post-content">Does it not work with both switches?<br />
                  <br />
                  Stu</p>
                </div>
                <hr />

                <div class="post">
                  <p class="post-meta"><span class="post-author text-primary">SubJunk</span><br />
                  <span class="post-time small text-muted">11th December 2012 22:27 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                  <p class="post-content">It does, sorry I was using the wrong syntax when I tested. Thanks again for the plugin</p>
                </div>
                <hr />

                <div class="post">
                  <p class="post-meta"><span class="post-author text-primary">PoRtAbLe_StEaLtH</span><br />
                  <span class="post-time small text-muted">30th January 2013 04:50 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                  <p class="post-content"></p>

                  <blockquote>
                    <small>Originally posted by LoRd_MuldeR</small><br />
                    Hi.<br />
                    <br />
                    Is sometimes get the problem that the LockedList plug-in will get stuck in the "Cancelling search, please wait..." state.<br />
                    <br />
                    <a href="http://img163.imageshack.us/img163/1133/lockedlistwin2kerrorv2p.jpg" target="_blank">http://img163.imageshack.us/img163/1...2kerrorv2p.jpg</a><br />
                    <br />
                    It will go on, as soon as I press some key or move the mouse cursor...<br />
                    <br />
                    My code looks like this:<br />
                    <a href="http://pastie.org/private/bfkzo1mn4adypn2t83xtq" target="_blank">http://pastie.org/private/bfkzo1mn4adypn2t83xtq</a><br />
                    <br />
                    Thanks in advance for any advice :)
                    <hr />
                  </blockquote>
                </div>
                <hr />
                <br />
                are you the developer of LameXP?<br />

                <div class="post">
                  <p class="post-meta"><span class="post-author text-primary">LoRd_MuldeR</span><br />
                  <span class="post-time small text-muted">30th January 2013 21:53 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                  <p class="post-content">Quote:</p>
                  <hr />

                  <div class="post">
                    <p class="post-meta"><span class="post-author text-primary">PoRtAbLe_StEaLtH</span><br />
                    <span class="post-time small text-muted">2nd February 2013 05:41 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                    <p class="post-content"></p>

                    <blockquote>
                      <small>Originally posted by LoRd_MuldeR</small><br />
                      Yes<br />
                      <br />
                      (You could have followed the link to my web-site in my profile)
                    </blockquote>duh.. sorry bro..<br />
                    i hardly click on profiles, links, etc ..<br />
                    i come here for info, help, etc ..<br />
                    <br />
                    i use your app all the time.. great stuff man.<br />
                    <br />
                    @ AfrowUK<br />
                    hey i have a question.. before finding your plugin.. i was using batch commands w/ handle.exe.<br />
                    <br />
                    ie.<br />
                    PHP Code:
                    <hr />
                    <code style="white-space:nowrap"><!-- php buffer start --></code><span style="color: #000000"><span style="color: #007700">@echo</span><span style="color: #0000BB">off<br /></span> <span style="color: #007700">for/</span><span style="color: #0000BB">f</span><span style="color: #DD0000">"tokens=3,6delims=:"</span><span style="color: #007700">%%</span><span style="color: #0000BB">ain</span><span style="color: #007700">(</span><span style="color: #DD0000">'handle${FILE}^|find"pid:"'</span><span style="color: #007700">)do(<br /></span> <span style="color: #0000BB">setPID</span><span style="color: #007700">=%%</span><span style="color: #0000BB">a<br />
                    setHandle</span><span style="color: #007700">=%%</span><span style="color: #0000BB">b<br />
                    <br />
                    call</span><span style="color: #007700">:</span><span style="color: #0000BB">Stage2<br /></span> <span style="color: #007700">)<br /></span> <span style="color: #0000BB">gotoend<br />
                    <br /></span> <span style="color: #007700">:</span><span style="color: #0000BB">stage2<br /></span> <span style="color: #007700">for/</span><span style="color: #0000BB">f</span><span style="color: #DD0000">"tokens=1delims=:"</span><span style="color: #007700">%%</span><span style="color: #0000BB">ain</span><span style="color: #007700">(</span><span style="color: #DD0000">"%Handle%"</span><span style="color: #007700">)do</span><span style="color: #0000BB">setHandle</span><span style="color: #007700">=%%</span><span style="color: #0000BB">a<br />
                    <br />
                    REM</span><span style="color: #007700">echo%</span><span style="color: #0000BB">Handle</span><span style="color: #007700">%-%</span><span style="color: #0000BB">PID</span><span style="color: #007700">%<br />
                    echo</span><span style="color: #0000BB">y</span><span style="color: #007700">|</span><span style="color: #0000BB">handle</span><span style="color: #007700">-</span><span style="color: #0000BB">c</span><span style="color: #007700">%</span><span style="color: #0000BB">Handle</span><span style="color: #007700">%-</span><span style="color: #0000BB">p</span><span style="color: #007700">%</span><span style="color: #0000BB">PID</span><span style="color: #007700">%<br /></span> <span style="color: #0000BB">DEL</span><span style="color: #007700">${</span><span style="color: #0000BB">FILE</span><span style="color: #007700">}<br />
                    :</span><span style="color: #0000BB">end<br /></span></span> <!-- php buffer end -->
                    <hr />
                    <br />
                    and it worked at killing the processes required to delete the file.<br />
                    but it required the additional handle.exe, which installs additional registry keys, etc.<br />
                    <br />
                    i noticed your plugin is much faster/easier to use.. ..<br />
                    however.. it kills the process to everyfile in the directory.<br />
                    <br />
                    whereas.. if i used the batch command w/ handle.exe,<br />
                    only the file's process is killed.<br />
                    <br />
                    would you know why?<br />
                    <br />
                    Here's my coding:<br />
                    PHP Code:
                    <hr />
                    <code style="white-space:nowrap"><!-- php buffer start --></code><span style="color: #000000"><span style="color: #0000BB">IfFileExists</span><span style="color: #DD0000">"${FILE}"</span><span style="color: #0000BB">0NotExist_<br />
                    LockedList</span><span style="color: #007700">::</span><span style="color: #0000BB">AddFile</span><span style="color: #DD0000">"${FILE}"<br /></span> <span style="color: #0000BB">GetFunctionAddress$R0SilentSearchCallback<br />
                    LockedList</span><span style="color: #007700">::</span><span style="color: #0000BB">SilentSearch$R0<br />
                    Delete</span><span style="color: #DD0000">"${FILE}"<br /></span> <span style="color: #0000BB">NotExist_</span><span style="color: #007700">:</span> PHP Code:</span>
                    <hr />
                    <code style="white-space:nowrap"><!-- php buffer start --></code><span style="color: #000000"><span style="color: #007700">Function</span><span style="color: #0000BB">SilentSearchCallback<br />
                    Pop$R0<br />
                    Pop$R1<br />
                    Pop$R2<br /></span> <span style="color: #007700">${If}</span><span style="color: #0000BB">$R0</span><span style="color: #007700">!=</span><span style="color: #DD0000">""<br /></span> <span style="color: #0000BB">Pushautoclose<br /></span> <span style="color: #007700">${Else}<br /></span> <span style="color: #0000BB">Pushfalse<br /></span> <span style="color: #007700">${EndIf}<br /></span> <span style="color: #0000BB">FunctionEnd<br /></span></span> <!-- php buffer end -->
                    <hr />
                  </div>
                  <hr />

                  <div class="post">
                    <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
                    <span class="post-time small text-muted">2nd February 2013 11:38 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                    <p class="post-content">It will only kill processes with a handle open on the file. If you can prove otherwise then I will need a sample script. What type of file is it by the way?<br />
                    <br />
                    Stu</p>
                  </div>
                  <hr />

                  <div class="post">
                    <p class="post-meta"><span class="post-author text-primary">Rkuncewicz</span><br />
                    <span class="post-time small text-muted">15th November 2013 18:00 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                    <p class="post-content">Hey Afrow, I recently began to use your LockedList plugin and it works beautifully! It's perfect for exactly what we need, however the only issue I am running into is that the percentage sometimes gets out of whack. At times it works fine going from 0-100%, however other times it goes up to ~55000%. It's very odd behaviour, and was just wondering if there's anything we could be doing wrong?<br />
                    <br />
                    I'm running Windows 7 SP1, if you need anything just ask! Thanks</p>
                  </div>
                  <hr />

                  <div class="post">
                    <p class="post-meta"><span class="post-author text-primary">voidcast</span><br />
                    <span class="post-time small text-muted">21st November 2013 07:59 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                    <p class="post-content">Hi,<br />
                    <br />
                    We are using LockedList in our setups and also been getting the huge %% issue. I investigated and fixed it. Going to clean the code up a bit and suggest my fix to the community very soon.</p>
                  </div>
                  <hr />

                  <div class="post">
                    <p class="post-meta"><span class="post-author text-primary">Rkuncewicz</span><br />
                    <span class="post-time small text-muted">21st November 2013 15:14 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

                    <p class="post-content">Thanks! We were going to look into the issue at some point, but at the moment we are swamped with doing other things :) Glad someone looked into it!</p>
                  </div>
                  <hr />

                  <div class="footer">
                    <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
                  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
                  hljs.initHighlightingOnLoad();
                  //]]>
                  </script>

                  <table cellpadding="6" cellspacing="0" border="0" width="100%">
                    <tr>
                      <td class="alt2">
                        <hr />
                        Originally Posted by <strong>PoRtAbLe_StEaLtH</strong> (Post 2910713) are you the developer of LameXP? Yes<br />
                        <br />
                        (You could have followed the link to my web-site in my profile)
                      </td>
                    </tr>
                  </table>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</body>
</html>
