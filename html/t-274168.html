<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="description" content="LockedList plug-in"><title>LockedList plug-in - NSIS Forums</title><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script><link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css"><link rel="stylesheet" href="../css/style.css" type="text/css"><!--[if lt IE 9]><script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script><script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script><![endif]--></head><body><div class="container"><ol class="breadcrumb"><li><a href="../index.html" class="glyphicon glyphicon-home"></a></li><li><a href="f-65.html">NSIS Discussion</a></li><li class="active">LockedList plug-in</li></ol><p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=274168">LockedList plug-in</a></p><br><div class="post"><p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br><span class="post-time small text-muted">10th July 2007 23:07 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>LockedList plug-in</strong><br>&nbsp; An NSIS plugin to display or get a list of programs that are locking a selection of files that have to be uninstalled or overwritten.<br><br><b><a href="http://nsis.sf.net/File:LockedList.zip" target="_blank">http://nsis.sf.net/File:LockedList.zip</a></b><br><br>Stu</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br><span class="post-time small text-muted">11th July 2007 11:05 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">v0.2 - 11th July 2007<br>* Better percent complete indication.<br><br>Stu</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">daisywheel</span><br><span class="post-time small text-muted">12th July 2007 07:34 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Hi Afrow UK,<br><br>Even simple script<br><br>LockedList::AddFile /NOUNLOAD $SYSDIR\kernel32.dll"<br>LockedList::Dialog<br><br>doesn't work for me.<br><br>I get messages "Going to compile test program and then run it"<br>then "The file '$TEMP\nsz1325.tmp\Lock' is now locked. It will appear on the LockedList dialog page soon..." some dialog blinks and that's all.<br><br>The same result I've got with example provided with plugin.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br><span class="post-time small text-muted">12th July 2007 12:12 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Firstly, you're missing a quote and secondly that's a module not a file.<br><br>How about this script:<br></p><pre>
<code>Name "LockedList Test"<br>OutFile "LockedListTest.exe"<br><br>!include MUI.nsh<br><br>!insertmacro MUI_PAGE_WELCOME<br>Page Custom LockedListShow<br><br>!insertmacro MUI_LANGUAGE English<br><br>Function LockedListShow<br>  LockedList::AddModule /NOUNLOAD "$SYSDIR\kernel32.dll"<br>  LockedList::Dialog<br>FunctionEnd<br><br>Section<br>SectionEnd</code>
</pre><br>
      <br>
      You'll get some garbage for the first program captions. I might be able to fix this.<br>
      <br>
      Stu
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">daisywheel</span><br>
      <span class="post-time small text-muted">12th July 2007 12:30 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Thank you for sample but it also doen't work for me.<br>
      It seems that the problem is exactly in LockedList::Dialog<br>
      <br>
      I modified your sample adding three message boxes<br>
      <br></p>
      <pre>
<code><br>Name "LockedList Test"<br>OutFile "LockedListTest.exe"<br><br>!include MUI.nsh<br><br>!insertmacro MUI_PAGE_WELCOME<br>Page Custom LockedListShow<br><br>!insertmacro MUI_LANGUAGE English<br><br>Function LockedListShow<br>  MessageBox MB_OK "test1"<br>  LockedList::AddModule /NOUNLOAD "$SYSDIR\kernel32.dll"<br>  MessageBox MB_OK "test2"<br>  LockedList::Dialog<br>FunctionEnd<br><br>Section<br> MessageBox MB_OK "test3"<br>SectionEnd<br></code>
</pre><br>
      <br>
      and I can see only two of them.
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br>
      <span class="post-time small text-muted">12th July 2007 13:32 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">You're not going to see the 3rd one because the dialog stops execution of the installer until it is closed.<br>
      What exactly happens? Does the dialog not display?<br>
      <br>
      Edit: Also, what OS are you on?<br>
      <br>
      Stu</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">daisywheel</span><br>
      <span class="post-time small text-muted">12th July 2007 13:50 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">dialog doesn't appear. installer is closed after message box "test2" closed.<br>
      <br>
      OS: WinXP SP2</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br>
      <span class="post-time small text-muted">12th July 2007 14:03 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">That's interesting. I'm running Win XP SP2 also.<br>
      <br>
      What happens if you don't use any AddFile/AddModules.<br>
      <br>
      Stu</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">daisywheel</span><br>
      <span class="post-time small text-muted">12th July 2007 14:59 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">ok, sorry for delay with answer. I had to deal with something.<br>
      now I'm sure that the problem is in LockedList::Dialog<br>
      <br>
      I have two vesions of script<br></p>
      <pre>
<code><br>Name "LockedList Test"<br>OutFile "LockedListTest.exe"<br><br>!include MUI.nsh<br><b><br>!insertmacro MUI_PAGE_WELCOME<br><br>!insertmacro MUI_PAGE_INSTFILES<br><br>Page Custom LockedListShow<br></b><br>!insertmacro MUI_LANGUAGE English<br><br>Function LockedListShow<br>  MessageBox MB_OK "test1"<br>  LockedList::AddModule /NOUNLOAD "$SYSDIR\kernel32.dll"<br>  MessageBox MB_OK "test2"<br>  LockedList::Dialog<br>FunctionEnd<br><br><br>Section "Install"<br> MessageBox MB_OK "test3"<br>SectionEnd<br></code>
</pre><br>
      <br>
      and<br>
      <br>
      <pre>
<code><br>Name "LockedList Test"<br>OutFile "LockedListTest.exe"<br><br>!include MUI.nsh<br><b><br>!insertmacro MUI_PAGE_WELCOME<br><br>Page Custom LockedListShow<br><br>!insertmacro MUI_PAGE_INSTFILES<br></b><br><br>!insertmacro MUI_LANGUAGE English<br><br>Function LockedListShow<br>  MessageBox MB_OK "test1"<br>  LockedList::AddModule /NOUNLOAD "$SYSDIR\kernel32.dll"<br>  MessageBox MB_OK "test2"<br>  LockedList::Dialog<br>FunctionEnd<br><br><br>Section "Install"<br> MessageBox MB_OK "test3"<br>SectionEnd<br></code>
</pre><br>
      <br>
      the first one shows message boxes<br>
      "test3"<br>
      "test1"<br>
      "test2"<br>
      <br>
      the second one<br>
      "test1"<br>
      "test2"<br>
      <br>
      diff:<br>
      !insertmacro MUI_PAGE_WELCOME<br>
      !insertmacro MUI_PAGE_INSTFILES<br>
      Page Custom LockedListShow<br>
      <br>
      !insertmacro MUI_PAGE_WELCOME<br>
      Page Custom LockedListShow<br>
      !insertmacro MUI_PAGE_INSTFILES<br>
      <br>
      we contact directly so I can help you debug plugin
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br>
      <span class="post-time small text-muted">12th July 2007 15:23 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">I'm aware that it is the plugin yes.<br>
      <br>
      My MSN is afrowuk at tiscali dot co dot uk<br>
      <br>
      Stu</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br>
      <span class="post-time small text-muted">12th July 2007 17:35 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Located the problem thanks to daisywheel :)<br>
      Please be patient while we make sure everything is ok then I shall upload the updated version.<br>
      <br>
      Stu</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br>
      <span class="post-time small text-muted">12th July 2007 17:54 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Uploaded v0.2 RC2.<br>
      <a href="http://nsis.sf.net/File:LockedList.zip" target="_blank">http://nsis.sf.net/File:LockedList.zip</a><br>
      <br>
      Stu</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">daisywheel</span><br>
      <span class="post-time small text-muted">12th July 2007 20:00 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">LockedList::AddModule /NOUNLOAD "$SYSDIR\module.dll"<br>
      LockedList::AddModule /NOUNLOAD "$SYSDIR\kernel32.dll"<br>
      <br>
      in case file module.dll doesn't exist will result error in functionality - there will no dependencies found<br>
      <br>
      in case we change order<br>
      LockedList::AddModule /NOUNLOAD "$SYSDIR\kernel32.dll"<br>
      LockedList::AddModule /NOUNLOAD "$SYSDIR\module.dll"<br>
      <br>
      plugin will work in another manner. I don't think this is expected behaviour.</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br>
      <span class="post-time small text-muted">12th July 2007 23:44 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Found the problem. It was a bad array pointer. It wasn't the fact of the file not being there it was simply only taking the first file or module added with AddFile/AddModule.<br>
      <br>
      I was also able to fix the captions problem. I noticed captions were being repeated over multiple processes aside from the garbage caption for the first few processes. Just needed a ZeroMemory in there.<br>
      <br>
      Uploaded v0.2 RC3.<br>
      <a href="http://nsis.sf.net/File:LockedList.zip" target="_blank">http://nsis.sf.net/File:LockedList.zip</a><br>
      <br>
      Thanks again :)<br>
      <br>
      Stu</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">daisywheel</span><br>
      <span class="post-time small text-muted">13th July 2007 08:43 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">One more suggestion. I'm not compeltely happy with results.<br>
      For example, I have two browser application run: Internet Explorer and Moxilla Firefox both on page <a href="http://nsis.sourceforge.net/File:LockedList.zip" target="_blank">http://nsis.sourceforge.net/File:LockedList.zip</a><br>
      <br>
      also I use following code in a script<br></p>
      <pre>
<code><br>LockedList::AddModule /NOUNLOAD "$SYSDIR\kernel32.dll"<br>LockedList::Dialog<br></code>
</pre><br>
      and as results I've got<br>
      WINAMP.COM | Forums - LockedList plug-in - Moxilla Firefox (firefox.exe)<br>
      for Moxilla Firefox<br>
      and<br>
      AutoSuggest Drop-Down (iexplore.exe)<br>
      for IE
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br>
      <span class="post-time small text-muted">13th July 2007 11:09 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Currently it grabs the first window caption for that process id by using EnumWindows. I'll look into it. Maybe I can check if the window is a child or not and if it is then skip it.<br>
      <br>
      Stu</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br>
      <span class="post-time small text-muted">13th July 2007 14:11 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Realised that EnumWindows does not enumerate child windows anyway (that's what EnumChildWindows is for) so instead I'm checking to see if a window has the WS_SYSMENU style set (title bar). Now get the correct caption for Internet Explorer among others.<br>
      <br>
      Uploaded v0.3:<br>
      <a href="http://nsis.sourceforge.net/File:LockedList.zip" target="_blank">http://nsis.sourceforge.net/File:LockedList.zip</a><br>
      <br>
      I also documented the ::Unload function which has to be used to unload the plugin after calling SilentWait /NOUNLOAD /time #. Few other changes in the change log too.<br>
      <br>
      Stu</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">daisywheel</span><br>
      <span class="post-time small text-muted">13th July 2007 14:54 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Another suggestion.<br>
      <br>
      Add horizontal scroll when long name is displayed.<br>
      <br>
      For now horizontal scroll is added only together with vertical one (in some cases even when it's not necessary)<br>
      <br>
      Roman</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br>
      <span class="post-time small text-muted">13th July 2007 15:24 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">This isn't possible because the list box is actually a list view with a single hidden column set to the width of the box. The NSIS InstFiles page has the same thing. Another option would be to have a tool-tip like the InstFiles page...<br>
      <br>
      Stu</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br>
      <span class="post-time small text-muted">13th July 2007 15:36 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">You can use ListView_SetColumnWidth with LVSCW_AUTOSIZE, but I think the triple dot looks better. If someone wants to see the entire line, he could just hover over it instead of scrolling and then seeing just the end.</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br>
      <span class="post-time small text-muted">13th July 2007 15:40 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Yeh I agree.<br>
      How does NSIS work out how long the text being displayed is?<br>
      I'm guessing it's not just down to the number of characters...<br>
      <br>
      Stu</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br>
      <span class="post-time small text-muted">13th July 2007 16:11 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Size of the list view minus the size of a scroll bar. Line 1568 of Source\exehead\ui.c.</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br>
      <span class="post-time small text-muted">13th July 2007 16:17 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Yeh I've got that already... sorry meant the dots, but now I'm guessing that the list view control adds those itself anyway!!<br>
      <br>
      Stu</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br>
      <span class="post-time small text-muted">13th July 2007 16:22 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">The list view automatically shows the dots, but you need LVS_EX_LABELTIP for it to show the tool tip.</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br>
      <span class="post-time small text-muted">13th July 2007 16:32 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Thanks found that in Ui.c too. Very neat that it's all provided :)<br>
      <br>
      Uploaded v0.3 RC2:<br>
      <a href="http://nsis.sourceforge.net/File:LockedList.zip" target="_blank">http://nsis.sourceforge.net/File:LockedList.zip</a><br>
      <br>
      Edit: Uploaded again as it had the test executable in the Zip (+50000 bytes or so)<br>
      <br>
      Stu</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Wizou</span><br>
      <span class="post-time small text-muted">5th September 2007 09:00 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Nice plugin and sources :)<br>
      <br>
      Thanks !</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kalverson</span><br>
      <span class="post-time small text-muted">10th September 2007 13:06 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">During testing of various locked items, I found a minor quirk. The locking process was detected going away for the exe's, but when I exited explore (brought up inside the target install directory), that was not detected going away. I had to navigate back and then next again to repeat the locked file search to get past it to the install. Also during testing, I ran into an "out of memory" message that appeared in the dialog just before the process name. That only happened once and did not repeat itself during futher testing.</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">RobertStrong</span><br>
      <span class="post-time small text-muted">14th September 2007 11:50 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>Paths</strong><br>
      &nbsp; It appears that the plugin doesn't try both short and long paths so both need to be added for files / modules that may be in use with either a long or short path. Might be a nice addition for the plugin to check both behind the scenes.<br>
      <br>
      Better still would be the ability to match files / modules in use by file name and then compare the paths to verify they are the same. This would also cover the unlikely scenario where the path is a combination of both long and short. Also, files / modules names can be short.<br>
      <br>
      Besides that all I can say is wow... this is an extremely useful plugin.<br>
      <br>
      Thanks,<br>
      Robert</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br>
      <span class="post-time small text-muted">14th September 2007 13:35 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Ah right good find. I'll see what I can do about that when I've got some time.<br>
      <br>
      I plan on adding a 'file name only' lookup for the plug-in as well, and also the ability to simply show windows that have the task bar style set.<br>
      <br>
      Thanks<br>
      <br>
      Stu</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">RobertStrong</span><br>
      <span class="post-time small text-muted">14th September 2007 14:13 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>SilentSearch</strong><br>
      &nbsp; I just noticed that SilentSearch isn't working when the module is in use by another user. This is on Vista with fast user switching. Interestingly enough, LockedList::Dialog is able to find it.<br>
      <br>
      Thanks again,<br>
      Robert</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br>
      <span class="post-time small text-muted">14th September 2007 17:37 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">I shall see if I can reproduce this on my XP machine soon. I do not have Vista unfortunately. This is interesting though as they are both exactly the same code bases for both functions except one directs output to the stack and one to a list view control!<br>
      <br>
      Stu</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">RobertStrong</span><br>
      <span class="post-time small text-muted">15th September 2007 01:48 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">After a quick peruse of the code it appears that EnableDebugPriv is only called when using the internal ui (e.g. LoadDialog).<br>
      <br>
      *edit* that is the problem</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br>
      <span class="post-time small text-muted">15th September 2007 10:25 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Oh right woops :S<br>
      <br>
      Stu</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kalverson</span><br>
      <span class="post-time small text-muted">18th September 2007 13:23 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">LockedList Plug-in:<br>
      <br>
      The accelerator keys do not work for the next/back buttons. Only the mouse works.</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kalverson</span><br>
      <span class="post-time small text-muted">18th September 2007 13:28 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Our tester has been experiancing an intermitant crash in the LockedList.dll plug-in. The crash happens during initialization (dialog is showing 0% on progress) The image captures is too large to attach. Here is the script used:<br>
      <br>
      ;<br>
      ; This function is called to display any locked files.<br>
      ;<br>
      Function LockedListShow<br>
      <br>
      ;Creator function<br>
      !insertmacro MUI_HEADER_TEXT "$(TEXT_IO_TITLElock)" "$(TEXT_IO_SUBTITLE2)"<br>
      <br>
      LockedList::AddFile /NOUNLOAD "$INSTDIR\${PRODUCT_NAME}"<br>
      LockedList::AddModule /NOUNLOAD "$INSTDIR\${PRODUCT_NAME}\${PRODUCT_LAUNCHER_EXE}"<br>
      LockedList::Dialog<br>
      <br>
      FunctionEnd<br>
      <br>
      Here is the crash information:<br>
      <br>
      LockedList.map<br>
      <br>
      0001:00001891 ?EnumSystemModules@@YGHP6GHUFILE_INFORMATION@@J@ZJ@Z 10002891 f SystemEnum.obj<br>
      0001:00001a97 ?EnumProcessIds@@YGHP6GHKJ@ZJ@Z 10002a97 f SystemEnum.obj<br>
      <br>
      offset from error signature: 000029b5<br>
      base of EnumSystemModules: 2891<br>
      -------------------------------------<br>
      124 relative --&gt; Line 478<br>
      <br>
      SystemEnum.asm<br>
      <br>
      ; 476 :<br>
      ; 477 : // Get the file path of the module.<br>
      ; 478 : if (GetModuleFileNameEx(hProcess, hModules[j], File.FullPath, MAX_PATH))<br>
      <br>
      push 260 ; 00000104H<br>
      mov eax, DWORD PTR [eax]<br>
      mov DWORD PTR _File$54859[ebp], eax<br>
      lea eax, DWORD PTR _File$54859[ebp+4]<br>
      push eax<br>
      mov eax, DWORD PTR -24+[ebp]<br>
      push DWORD PTR [eax]<br>
      push esi<br>
      call DWORD PTR _GetModuleFileNameEx<br>
      test eax, eax<br>
      je SHORT $L54877<br>
      <br>
      <br>
      SystemEnum.cod<br>
      ; Line 478<br>
      00109 68 04 01 00 00 push 260 ; 00000104H<br>
      0010e 8b 00 mov eax, DWORD PTR [eax]<br>
      00110 89 85 40 fd ff<br>
      ff mov DWORD PTR _File$54859[ebp], eax<br>
      00116 8d 85 44 fd ff<br>
      ff lea eax, DWORD PTR _File$54859[ebp+4]<br>
      0011c 50 push eax<br>
      0011d 8b 45 e8 mov eax, DWORD PTR -24+[ebp]<br>
      00120 ff 30 push DWORD PTR [eax]<br>
      00122 56 push esi<br>
      00123 ff 15 00 00 00<br>
      00 call DWORD PTR _GetModuleFileNameEx<br>
      00129 85 c0 test eax, eax<br>
      0012b 74 5c je SHORT $L54877<br>
      ; Line 481</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br>
      <span class="post-time small text-muted">27th September 2007 14:57 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">New version v0.4:<br>
      <a href="http://nsis.sourceforge.net/File:LockedList.zip" target="_blank">http://nsis.sourceforge.net/File:LockedList.zip</a><br>
      <br></p>

      <blockquote>
        v0.4 - 27th September 2007<br>
        * Module or file names can now be just the file name as opposed to the full path.<br>
        * Folder paths are converted to full paths (some are short DOS paths) before comparison.<br>
        * Fixed typo in AddModule function (ModulesCount&gt;FilesCount). Thanks kalverson.<br>
        * List view is now scrolled into view while items are added.<br>
        * List changed to multiple columns.<br>
        * Debug privileges were not being set under SilentSearch.<br>
        * Added /ignore switch that prevents the Next button being disabled.<br>
        * Added AddApplications to add all running applications to the list.<br>
        * Added processing mouse cursor.<br>
        * Added right-click context menu with Close and Copy List options.<br>
        * Added progress bar.<br>
        * Added default program icon for processes without an icon.<br>
        * Added code to resize controls for different dialog sizes.
      </blockquote>I cannot reproduce that crash kalverson and by the looks of it it's out of my control, unless the module handle being passed is not valid. I could surround it by a try{} block but I am not keen on that idea.<br>
      <br>
      Stu
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">RobertStrong</span><br>
      <span class="post-time small text-muted">28th September 2007 00:37 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Thank you Stu!</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">jrhutch</span><br>
      <span class="post-time small text-muted">31st March 2008 17:33 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">I have a question about the LockedList plugin. Does AddFile support searching an entire directory? I couldn't find where it specifically said it was supported in the readme. I wanted to know that this is an option, before I go and try to fix my installer problems using this plugin.<br>
      <br>
      Hopefully it does, because this plugin looks awesome and is basically the perfect solution for what I'm trying to do.</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br>
      <span class="post-time small text-muted">31st March 2008 17:54 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">You mean if the file is in a folder or possibly in sub folders?<br>
      <br>
      Stu</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">jrhutch</span><br>
      <span class="post-time small text-muted">31st March 2008 17:58 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Yes, I want it to search my entire application directory to make sure nothing is being used before I go and try to update files. I didn't see anywhere that said wildcards were supported, but if then are, then that is fantastic. Thank you!</p>
    </div>
    <hr>

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]></script></body></html>