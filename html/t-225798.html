<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="Nsis and the installation temporary space" />

  <title>Nsis and the installation temporary space - NSIS Forums</title><!-- Bootstrap core CSS -->
  <link rel="stylesheet" type="text/css" href="//netdna.bootstrapcdn.com/bootswatch/3.0.1/readable/bootstrap.min.css" />
  <link rel="stylesheet" href="../css/style.css" type="text/css" /><!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!--[if lt IE 9]>
                <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
                <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->
</head>

<body>
  <div class="container">
    <!-- Put navigation bar here -->

    <ol class="breadcrumb">
      <li><a href="../index.html" class="glyphicon glyphicon-home"></a></li>

      <li><a href="f-65.html">NSIS Discussion</a></li>

      <li class="active">Nsis and the installation temporary space</li>
    </ol>

    <p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=225798">Nsis and the installation temporary space</a></p><br />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">neotwix</span><br />
      <span class="post-time small text-muted">12th September 2005 11:31 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>Nsis and the installation temporary space</strong><br />
      Hi,<br />
      I have a question of how nsis work.<br />
      When I began to work with nsis, I read on the french chm<br />
      help file. (Chap1 introduction)<br />
      "Les installations de NSIS ne vont pas essayer de se décompresser elles-mêmes trois fois, en indiquant à l'utilisateur de "bien vouloir patienter". Elles vont au but, et font leur travail."<br />
      Which could be translated in english: "The intallation made with nsis doesn't try to uncompress her self three times,<br />
      And during this this time, the user only add a wainting message. The installer do only what they need to do."<br />
      <br />
      I interprete that like nsis doesn't need a lot of temporary space to installed it.<br />
      <br />
      I have a big sepup (I think), The archive take 100 MB with<br />
      the LZMA /Solid compressor. The installation took 650 MB on my hard drive, And The installation contain ~12000 files.<br />
      <br />
      I want installed it on the PC with poor available free space.<br />
      <br />
      In my Case 900 MB<br />
      On the panel when I choose the install path, the installer<br />
      accept the path.<br />
      During the installation, I have an extract error.<br />
      If I made the installation on another PC with a lot of available free space, before clic on the finish button,<br />
      I Have 500 MB extra space ( temporary file I hope).<br />
      The space is removed after the clic on the finish button.<br />
      <br />
      So My question....<br />
      How the setup work during the installation ?<br />
      Could it be possible to know the temporary space to<br />
      unaccept drive with poor free space ?<br />
      Maybe I make something wrong in nsi file ....<br />
      <br />
      <br />
      thanks.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">neotwix</span><br />
      <span class="post-time small text-muted">12th September 2005 17:34 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">I continue my investigation,<br />
      and during the installation,<br />
      nsis create a temporary directory, in my case<br />
      C:\Documents and Settings\MyName\Local Settings\Temp\nsv73.tmp<br />
      and a temporary file, in my case:<br />
      C:\Documents and Settings\MyName\Local Settings\Temp\nsv72.tmp<br />
      before the install panel and the real install of files,<br />
      the size of this files is 0K. The directory contain the uncompressed files. My banners, and the plugins used by my setup.<br />
      <br />
      During the installation, the tmp size file increase drasticaly. in my case the file size grow up to 378 Mb.<br />
      I don't know if it's normal. if it's how nsis work or it's a bug.<br />
      I made my setup with setCompressor /solid lzma.<br />
      Maybe it's for that ? Maybe it's due to the solid option ?<br />
      <br />
      Other information, I use NSIS 2.08<br />
      I watch the NSIS 2.09 ChangeLog,and I dont see a fix of this<br />
      type of problem.<br />
      <br />
      <br />
      thanks</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">neotwix</span><br />
      <span class="post-time small text-muted">13th September 2005 11:45 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">note: The bzip2 /solid don't use a temporary file to uncompress files.<br />
      The temporary contain only plugins and bmp.<br />
      <br />
      Is it a specification of LZMA Algorithm ?<br />
      In this case, it's a a de-advantage of the LZMA, if we need the double of place for the installation :(,<br />
      In my case my setup increase from 107 MB in LZMA to 187 MB in BZIP2. I hope it's just a bug, I like so much my setup with<br />
      LZMA :)</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
      <span class="post-time small text-muted">13th September 2005 18:40 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">It's not only for LZMA, it's for all solid installers. Search the forum for the words solid and you should find some threads that explain this. Basically, this file exists so the installer won't have to decompress your entire installer multiple times.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">ImmortAlex</span><br />
      <span class="post-time small text-muted">15th September 2005 04:38 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">When compiler parses your script it found files in this order:<br />
      a, b, c, d, e, f<br />
      and store it into archive.<br />
      But when script executes, it uses files in order, f.e.:<br />
      a, b, f, c, e, d<br />
      When you use solid compression, unpacker need to unpack files "c, d, e" before it unpack file "f".<br />
      So unpacker keeps that files in temp folder for not to return back to unpacking "c" when script reference to it.<br />
      All you need is to carefully place references to files in you script. There is some disscussions in this forum about this, and AFAIR even in documentation.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">neotwix</span><br />
      <span class="post-time small text-muted">15th September 2005 11:37 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">thanks, I try to test without solid option for compressor.<br />
      And I have a error with lzma, I test it with all the other combination (bzip2,; bzip2 /solid, zlib, zlib /solid, and lzma /solid, all work fine)<br />
      but for lzma alone, I have this error:<br />
      File: "myFile" [compress]Error: add_db_data() - compress() failed(initialization failed [-2])<br />
      and it a little file (a makefile 2 or 3 KB....</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">neotwix</span><br />
      <span class="post-time small text-muted">15th September 2005 14:30 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">I think it's the SetCompressorDictSize is maybe too short.<br />
      in my projectFile, I increase to 16MB the dic size.<br />
      And I relaunch my setup generation with makensis.<br />
      The compressor take more files but I have the same message to another files.<br />
      I increase again the Dic Size to 32 Mb, and I the message:<br />
      File: "xxxxx.h" [compress]<br />
      and nothing more. If I made a top, my cpu do absolutly nothing. Another Thing I use nsis 2.09 under Linux.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
      <span class="post-time small text-muted">15th September 2005 19:32 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Please attach a complete example, with all the files needed to reproduce this. Also try upgrading to 2.09.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
      <span class="post-time small text-muted">22nd September 2005 21:21 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Initialization error fixed. It was failing because the threads were not properly cleaned up. It's a good thing pthread_detach is mentioned in the man page for pthread_create.<br />
      <br />
      Patch attached.<br />
      <br />
      Thanks for your report.</p>
    </div>
    <hr />

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]>
  </script>
</body>
</html>
