<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="description" content="VISTA Compatibility"><title>VISTA Compatibility - NSIS Forums</title><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script><link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css"><link rel="stylesheet" href="../css/style.css" type="text/css"></head><body><div class="container"><ol class="breadcrumb"><li><a href="../index.html" class="glyphicon glyphicon-home"></a></li><li><a href="f-65.html">NSIS Discussion</a></li><li class="active">VISTA Compatibility</li></ol><p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=291114">VISTA Compatibility</a></p><br><div class="post"><p class="post-meta"><span class="post-author text-primary">ecaste</span><br><span class="post-time small text-muted">1st May 2008 08:24 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>VISTA Compatibility</strong><br>Dears,<br>I'm facing to a **** problem since I've tested the installation of my script on VISTA with a non administrator account:<br>the installation is perfect but as soon as the user wants to execute my installed program, VISTA is asking for account elevation.<br>It seems that the user needs to be an administrator to run my application.<br><br>I've tested several things, with no success:<br>- When I'm using RequestExecutionLevel user: the installer can't copy files in PROGRAM FILES<br><br>- And unfortunatly, when I'm using RequestExecutionLevel admin: the user needs to be admin to execute the program.<br><br>- When I'm combined both, RequestExecutionLevel user with the UAC_Plugin: the user still needs to be admin to execute the program.<br><br>Today I'm totally stuck, does anybody can help me ?<br><br>Thanks by advance.<br><br>Man'</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Anders</span><br><span class="post-time small text-muted">1st May 2008 09:10 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">you can't have it both ways, if you want to put files in $programfiles, you need to be admin. If you want a non admin installer, put the files in $localappdata or something like that</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">ecaste</span><br><span class="post-time small text-muted">1st May 2008 09:16 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Hi Anders,<br>thanks for you reply, but how can I install my application in Pgrm Files AND let a standard user execute my application (without elevation to admin account) ? Is that possible ?<br><br>Thanks.<br>Man'</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">LordDaimos</span><br><span class="post-time small text-muted">1st May 2008 09:18 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Standard users can execute in Program Files but you can't have your application writing files (such as settings) there. For that there is %appdata%.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">ecaste</span><br><span class="post-time small text-muted">1st May 2008 09:25 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"></p><blockquote><i>Originally posted by LordDaimos</i><br><b>Standard users can execute in Program Files but you can't have your application writing files (such as settings) there. For that there is %appdata%.</b></blockquote>That's my point, I'm totally agree with you in theorie...<br><br>Before NSIS, I was using standard MSI installer to install my application in Program Files directory, and all was working fine:<br>- installation: ok<br>- running the application as a standard user: ok<br><br>But I wanted to move from that MSI installer, and started to learn about nsis, which is perfect for our usage.<br><br>But now, I'm facing on the pb described, problem I didn't have before with the msi installer....:<br>Why should Vista asks everytime for elevation on admin account when I'm trying to run my application...?<br><br>Is it in my application level (strange...) or is it due to my installation procedure...<br><br>Anyway, thanks for help<br><br>Man'</div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">NEHOG</span><br><span class="post-time small text-muted">1st May 2008 20:11 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"></p><blockquote><i>Originally posted by ecaste</i><br>Is it in my application level (strange...) or is it due to my installation procedure...<br><br>Anyway, thanks for help<br><br>Man' [/B]</blockquote>I think you will find that your application's manifest is marked 'requireAdministrator' which is why the user is being prompted. Set the manifest to 'asInvoker' and that problem may go away.</div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Anders</span><br><span class="post-time small text-muted">1st May 2008 20:28 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"></p><blockquote><i>Originally posted by NEHOG</i><br><b>I think you will find that your application's manifest is marked 'requireAdministrator' which is why the user is being prompted. Set the manifest to 'asInvoker' and that problem may go away.</b></blockquote>asInvoker is NEVER the right thing to use, either use admin or user</div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">NEHOG</span><br><span class="post-time small text-muted">1st May 2008 20:42 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"></p><blockquote><i>Originally posted by Anders</i><br><b>asInvoker is NEVER the right thing to use, either use admin or user</b></blockquote>Oh? And what is the right thing to use for a non-administrator program?</div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Anders</span><br><span class="post-time small text-muted">2nd May 2008 06:29 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">sorry, I messed up (the MS names vs. the nsis names for this stuff always confuses me)<br><br>for a non admin app, you want user aka asInvoker, and never highest aka highestAvailable</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">ecaste</span><br><span class="post-time small text-muted">5th May 2008 12:53 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Hi,<br>Thanks guys for your inputs...but unfortunatly I have still my pb: when installed in $PROGRAMFILES using NSIS, myApp.exe has a shield on its icon, and I need to launch it with admmin account!<br><br>I've set the manifest of my application using asInvoker...with no success, but:<br>- if I change the installation repository, for ex. in $APPDATA instead of $PROGRAMFILES, I can set with success the security in the manifest file (either requireAdministrator, or asInvoker).<br>- if I copy manually all needed files in $PROGRAMFILES, I can then run with my standard user account myApp.exe.<br><br>Any idea?<br><br>Because I can of course put all my files in $APPDATA, but it seems that the recommended location for executable files is in $PROGRAMFILES...<br><br>Thanks.<br>Manu.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">MSG</span><br><span class="post-time small text-muted">6th May 2008 08:09 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"></p><blockquote>- When I'm using RequestExecutionLevel user: the installer can't copy files in PROGRAM FILES</blockquote>It looks like you're forgetting ${UAC.I.Elevate.AdminOnly} . Use it, in combination with RequestExecutionLevel user, in .onInit to have Vista ask for the Admin password during install AND run the installed application as a user.<br><br>Hmm... At least, I *think* it runs it as a user in that case... Anders would know, he designed the plugin. Anyway, I don't think this solves the problem of Vista thinking the application needs Admin priviledges, but I just thought I'd mention it.</div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Anders</span><br><span class="post-time small text-muted">6th May 2008 10:27 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">I think we are confusing installer and programs here. If your application has a manifest with asInvoker, if you still have problems, maybe you don't have execute rights or something in $programfiles, try using the AccessControl plugin</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">NEHOG</span><br><span class="post-time small text-muted">7th May 2008 01:10 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"></p><blockquote><i>Originally posted by ecaste</i><br><b>Hi,<br>Thanks guys for your inputs...but unfortunatly I have still my pb: when installed in $PROGRAMFILES using NSIS, myApp.exe has a shield on its icon, and I need to launch it with admmin account!<br></b></blockquote>In this case either your program has a bad name (the name of the executable has either 'setup' or 'install' in it) or your application has a manifest that indicates that administrator privileges are required.<br><br>You can post your manifest file and we can look at that and maybe see the problem...<br><br>IMHO, this has nothing to do with NSIS or installation, but is what your application is configured to do by the building platform. (.NET by chance?)</div><hr><div class="footer"><p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p></div></div><script src="../js/highlight.pack.js" type="text/javascript"></script><script type="text/javascript">//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]></script></body></html>