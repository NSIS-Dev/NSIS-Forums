<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="Invalid installation path on app upgrade" />

  <title>Invalid installation path on app upgrade - NSIS Forums</title>
  <script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script>
  <!-- Bootstrap core CSS -->

  <link rel="stylesheet" type="text/css" href="//netdna.bootstrapcdn.com/bootswatch/3.0.1/readable/bootstrap.min.css" />
  <link rel="stylesheet" href="../css/style.css" type="text/css" /><!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!--[if lt IE 9]>
                <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
                <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->
</head>

<body>
  <div class="container">
    <!-- Put navigation bar here -->

    <ol class="breadcrumb">
      <li><a href="../index.html" class="glyphicon glyphicon-home"></a></li>

      <li><a href="f-65.html">NSIS Discussion</a></li>

      <li class="active">Invalid installation path on app upgrade</li>
    </ol>

    <p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=292166">Invalid installation path on app upgrade</a></p><br />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">pirateking570</span><br />
      <span class="post-time small text-muted">23rd May 2008 10:20 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>Invalid installation path on app upgrade</strong><br />
      Hi,<br />
      <br />
      Did anyone face a problem with incorrect installation path during app upgrade?<br />
      <br />
      I've tried the simple scenario:<br />
      <br />
      1) Created a simple script using HM NIS Edit tool. The script install Notepad to Program Files\App 1.0<br />
      <br />
      2) Then I upgraded the script to version 2.0, e.g. I changed all references to 2.0 and added "ExecWait '$R0 /S _?=$INSTDIR'" to install event handler. The app should now install to Program Files\App 2.0<br />
      <br />
      3) I'm installing v1.0, then I run setup for the v2.0, it detects the previous version, removes it (good) and then it suggests the installation path as Program Files\App 1.0 (bad), note it happens in the installer for v2.0!<br />
      <br />
      Does anyone know why it happens? I've attached those scripts.<br />
      <br />
      Thanks,<br />
      Nick</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">pospec</span><br />
      <span class="post-time small text-muted">23rd May 2008 11:31 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">It is caused by InstallDirRegKey instruction in your test2.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">pirateking570</span><br />
      <span class="post-time small text-muted">23rd May 2008 14:30 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"></p>

      <blockquote>
        <i>Originally posted by pospec</i><br />
        <b>It is caused by InstallDirRegKey instruction in your test2.</b>
      </blockquote>Thank you for your response. But I'm not sure how I can fix that, what would be a solution for my case?<br />
      <br />
      Best regards,<br />
      Nick
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">pospec</span><br />
      <span class="post-time small text-muted">23rd May 2008 14:32 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Delete InstallDirRegKey line in your test2.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">pirateking570</span><br />
      <span class="post-time small text-muted">23rd May 2008 14:40 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"></p>

      <blockquote>
        <i>Originally posted by pospec</i><br />
        <b>Delete InstallDirRegKey line in your test2.</b>
      </blockquote>Thank you very much. It worked for me:)
    </div>
    <hr />

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]>
  </script>
</body>
</html>
