<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="need some help" />

  <title>need some help - NSIS Forums</title>
  <script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script>
  <!-- Bootstrap core CSS -->

  <link rel="stylesheet" type="text/css" href="//netdna.bootstrapcdn.com/bootswatch/3.0.1/readable/bootstrap.min.css" />
  <link rel="stylesheet" href="../css/style.css" type="text/css" /><!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!--[if lt IE 9]>
                <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
                <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->
</head>

<body>
  <div class="container">
    <!-- Put navigation bar here -->

    <ol class="breadcrumb">
      <li><a href="../index.html" class="glyphicon glyphicon-home"></a></li>

      <li><a href="f-65.html">NSIS Discussion</a></li>

      <li class="active">need some help</li>
    </ol>

    <p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=155969">need some help</a></p><br />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">soknin</span><br />
      <span class="post-time small text-muted">12th November 2003 10:06 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>need some help</strong><br />
      hi all ,<br />
      <br />
      I'm using nsis latest csv version(2.04b) and i have a few general problems.<br />
      <br />
      1. In some of my installers i'm using ini file (that use the INSTALLOPTIONS plugin) , the first thing is : how can i verify the install dir ? now i know how to use the leave function on the custom page , and i've wrote function that can go over all the directories in the ini , but the verify is not complete .<br />
      first using MUI_PAGE_DIRECTORY (for example) verify the directory in a callback (what causes the 'next' button to be enabled on verify) , can i use a callback ?<br />
      second the i can't seem to be able to write somthing to verify 'blabla' for example as a folder , how can i do it ? where can i found the source code (i have the source but can't find the function) ?<br />
      <br />
      b.t.w i think there is a bug with the original verify function , try using as a directory for the install a file without ext.<br />
      <br />
      2. nice work with 2.04b about RTL , but what about the DirRequest RTL , i've been able to RTL them but only on xp :<br />
      <br />
      strcpy $1 0<br />
      strcpy $4 0<br />
      <br />
      StartAlign:<br />
      intop $1 $1 + 1<br />
      !insertmacro MUI_INSTALLOPTIONS_READ $2 "$R0" "Field $1" "Type"<br />
      strcmp $2 "" EndAlign<br />
      strcmp $2 "DirRequest" 0 StartAlign<br />
      intop $3 1200 + $1<br />
      intop $3 $3 - 1<br />
      intop $3 $3 + $4<br />
      GetDlgItem $2 $0 $3<br />
      strcmp $2 0 EndAlign<br />
      !insertmacro SetWindowAlignment $2 3 ; aligns the control<br />
      intop $4 $4 + 1<br />
      goto StartAlign<br />
      EndAlign:<br />
      <br />
      Any ideas ?<br />
      <br />
      b.t.w , i have a similer problem using kernel32::CreateMutexA - don't work on xp .<br />
      <br />
      3. writing to ini file (using WriteINIStr) fails if the ini is on the network , is it a bug ?<br />
      <br />
      <br />
      thx ,<br />
      sharon oknin</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Vytautas</span><br />
      <span class="post-time small text-muted">12th November 2003 11:18 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Are you sure that you are using the Mutex Function correctly cos I used it in several of my installers and it works fine in ALL versions of windows including XP. Check out my archive page for an example.<br />
      <br />
      Vytautas :D</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
      <span class="post-time small text-muted">12th November 2003 16:55 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"></p>

      <ol style="list-style-type: decimal">
        <li>You can not disable or enable the next button on custom pages dynamically, yet. The best solution would be using multiple directory pages, at least in your case.

          <blockquote>
            b.t.w i think there is a bug with the original verify function , try using as a directory for the install a file without ext.
          </blockquote>Please provide an example script. I do not understand what you mean.
        </li>

        <li>You don't need that script in the latest CVS version. All you need is RTL=1 in Settings in the INI. The MUI adds that automatically if you extract the INI using its macros.</li>

        <li>Writing to INI files on network drives work fine for me. Please provide more details.</li>
      </ol>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">soknin</span><br />
      <span class="post-time small text-muted">13th November 2003 08:05 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Hi ,<br />
      <br />
      thx for your reaplays .<br />
      first , my bad on the Mutex function , works fine .<br />
      <br />
      1. ok , can you direct me to the location of the verify function in the source code ?<br />
      <br />
      "Please provide an example script. I do not understand what you mean."<br />
      Here is an example , lets say you want to install to c:\sharon and on c:\ you got a file name sharon(with no extansion!) , the installer will let you install , but it can't be done , i used :<br />
      strcpy $1 "Good"<br />
      IfFileExists "$0\*.*" Good 0<br />
      IfFileExists "$0" 0 Good<br />
      strcpy $1 "Bad"<br />
      Good:<br />
      to correct this .<br />
      2. That's true for all controls but not for DirRequest , the text in the DirRequest aligns to the left , it should be to the right (i think).<br />
      <br />
      3. I'm using Novell network , here an example :<br />
      clearerrors<br />
      WriteINIStr "$INSTDIR\network.ini" "install" "Instver" "123"<br />
      * the error flag is set and it did'nt write to the ini<br />
      for now i'm using writing to $TEMP and copying the ini to the net .<br />
      <br />
      sharon oknin</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Joost Verburg</span><br />
      <span class="post-time small text-muted">13th November 2003 11:23 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">2. Directories are still English. Does Windows align them to the right?</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
      <span class="post-time small text-muted">13th November 2003 12:36 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"></p>

      <ol style="list-style-type: decimal">
        <li>OK, I see what you mean now. Will be fixed, thanks.<br />
        The code is in Source\exehead\Ui.c line 807 in the latest CVS version.</li>

        <li>According to MSDN, the only system it's not supposed to work in is Windows 95/NT4.0. Even then, as Joost said, paths are still English so it should be left anyway.</li>

        <li>Must be a Novell issue then, it works fine for me. All NSIS does it call Windows' WritePrivateProfileString. MSDN says nothing about problems with network writing, so it must be something about Novell.</li>
      </ol>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">soknin</span><br />
      <span class="post-time small text-muted">13th November 2003 12:37 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Hi Joost Verburg ,<br />
      Thx for replaying , Yep , windows align them to the right .<br />
      It can happen only if you make a custom page with a DirRequest(in the MUI the align is correct) and using RTL . all other controls are O.K . it's looks like all the controls change directions , but DirRequest should stay aligned to the left .</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Joost Verburg</span><br />
      <span class="post-time small text-muted">13th November 2003 13:58 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Can you post a screenshot of Windows aligning paths?</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
      <span class="post-time small text-muted">15th November 2003 13:09 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Latest CVS version will not let you choose a file as an installation directory. There is no compiled version yet.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">soknin</span><br />
      <span class="post-time small text-muted">16th November 2003 08:26 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">kichik , thx for the fix , is it possible to create a callback .onVerifyInstDir for ini files ?<br />
      if not how about :<br />
      <br />
      Function VerifyIniDirs<br />
      <br />
      Exch $R0<br />
      push $0<br />
      push $1<br />
      push $2<br />
      push $3<br />
      <br />
      <br />
      strcpy $0 0<br />
      strcpy $3 "Pass"<br />
      <br />
      StartTesting:<br />
      intop $0 $0 + 1<br />
      !insertmacro MUI_INSTALLOPTIONS_READ $1 "$R0" "Field $0" "Type"<br />
      strcmp $1 "" EndTesting 0<br />
      strcmp $1 "DirRequest" 0 StartTesting<br />
      !insertmacro MUI_INSTALLOPTIONS_READ $1 "$R0" "Field $0" "State"<br />
      !insertmacro MUI_INSTALLOPTIONS_READ $2 "$R0" "Field $0" "ValidateText"<br />
      push $1<br />
      push $2<br />
      call VerifyDir<br />
      pop $3<br />
      strcmp $3 "Fail" EndTesting StartTesting<br />
      EndTesting:<br />
      <br />
      strcpy $R0 $3<br />
      <br />
      pop $3<br />
      pop $2<br />
      pop $1<br />
      pop $0<br />
      Exch $R0<br />
      <br />
      FunctionEnd<br />
      <br />
      <br />
      Joost Verburg , i'll post a screen next replay showing the aligment<br />
      <br />
      sharon oknin</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">soknin</span><br />
      <span class="post-time small text-muted">16th November 2003 08:29 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>alignment</strong><br />
      attached file contains requested aligment information<br />
      <br />
      sharon oknin</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
      <span class="post-time small text-muted">16th November 2003 11:42 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">You can't create .onVerifyInstDir for an InstsallOptions page. The best you can do is show a message box in the leave function and call Abort to force the user to stay on the current page.<br />
      <br />
      As for the alignment, I have tested it on XP and both DirRequest and the built-in directory selection page show on the right, as should. Are you sure you are using the latest CVS version? Try <a href="http://forums.winamp.com/showthread.php?s=&amp;threadid=156288" target="_blank">RC1</a>.<br />
      <br />
      BTW, you can use two directory pages instead of adding another custom InstallOptions page. In that page you can use .onVerifyInstDir.</p>
    </div>
    <hr />

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]>
  </script>
</body>
</html>
