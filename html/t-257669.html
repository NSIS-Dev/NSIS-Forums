<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="description" content="Actualize the Icon Classes_Root in Registry"><title>Actualize the Icon Classes_Root in Registry - NSIS Forums</title><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script><link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css"><link rel="stylesheet" href="../css/style.css" type="text/css"></head><body><div class="container"><ol class="breadcrumb"><li><a href="../index.html" class="glyphicon glyphicon-home"></a></li><li><a href="f-65.html">NSIS Discussion</a></li><li class="active">Actualize the Icon Classes_Root in Registry</li></ol><p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=257669">Actualize the Icon Classes_Root in Registry</a></p><br><div class="post"><p class="post-meta"><span class="post-author text-primary">Defcon0</span><br><span class="post-time small text-muted">16th October 2006 16:58 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>Actualize the Icon Classes_Root in Registry</strong><br>Hello,<br><br>in my installer I set some icons and descriptions for 2 types of files .mzt and .mzt2. For this I write the key .mzt in the HKEY_CLASSES_ROOT dir in the registry.<br>This works just fine. But only after a reboot.<br>With InstallShield which I used before the (much better :)) NSIS the icons were instantly connected with the file types.<br><br>Is this also possible with NSIS ?<br><br>Thanks.<br><br>Bye Defcon0</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">kichik</span><br><span class="post-time small text-muted">16th October 2006 17:04 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Use <a href="http://nsis.sourceforge.net/Refresh_shell_icons" target="_blank">RefreshShellIcons</a>.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Defcon0</span><br><span class="post-time small text-muted">16th October 2006 17:12 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Thanks a lot.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Defcon0</span><br><span class="post-time small text-muted">16th October 2006 17:14 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Oh it doesn't work, I see now:<br></p><blockquote>[...]<br>Processed 1 file, writing output:<br>Adding plug-ins initializing function... Done!<br>Error: resolving install function "RefreshShellIcons" in install section "ZusÃ¤tzliche Dateien" (1)<br>Note: uninstall functions must begin with "un.", and install functions must not<br>Error - aborting creation process</blockquote></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">kichik</span><br><span class="post-time small text-muted">16th October 2006 17:19 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Create a copy of the function with the "un." prefix for the uninstaller.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Defcon0</span><br><span class="post-time small text-muted">16th October 2006 17:24 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">No, I think this not the point.<br>I don't use this for uninstall. In the documentation is written:<br></p><blockquote>Syntax:<br><br>${RefreshShellIcons}<br>Example:<br><br>Section<br>WriteRegStr HKCR "Winamp.File\DefaultIcon" "" "$PROGRAMFILES\Winamp\WINAMP.EXE,2"<br><br>${RefreshShellIcons}<br>SectionEnd</blockquote>But when I type it in (means ${RefreshShellIcons}) there's the error:<br><blockquote>Invalid command: ${RefreshShellIcons}<br>Error in script "C:\Documents and Settings\Administrator\Desktop\Setup\Setup.nsi" on line 164 -- aborting creation process</blockquote></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">kichik</span><br><span class="post-time small text-muted">16th October 2006 17:31 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">That's a totally different error and function than the last one. Of course it's not the point.<br><br>To use the last RefreshShellIcons you mentioned, you must first include the appropriate header file - FileFuncs.nsh, and then insert the function macro. Only then you can use the function. If you wish to use it in the uninstaller, insert the macro prefixed with "un." and use accordingly.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Defcon0</span><br><span class="post-time small text-muted">16th October 2006 17:45 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">ok. I included the FileFunc.nsh.<br></p><blockquote>.. and then insert the function macro</blockquote>How do I do it ? Sorry I'm really new to NSIS.<br>Is it !insertmacro ... ? If so, what's "..." ?</div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">kichik</span><br><span class="post-time small text-muted">16th October 2006 17:48 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">It's all in the <a href="http://nsis.sourceforge.net/Docs/AppendixE.html#E.1.21" target="_blank">documentation</a>.</p><pre>
<code>!include FileFuncs.nsh<br>!insertmacro RefreshShellIcons<br>!insertmacro un.RefreshShellIcons<br><br>Section something<br>${RefreshShellIcons}<br>SectionEnd<br><br>Section uninstall<br>${un.RefreshShellIcons}<br>SectionEnd</code>
</pre>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Defcon0</span><br>
      <span class="post-time small text-muted">16th October 2006 17:56 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Yo. Thanks !</p>
    </div>
    <hr>

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]></script></body></html>