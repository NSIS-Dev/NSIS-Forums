<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="Deferring Delete of DLLs at end of install" />

  <title>Deferring Delete of DLLs at end of install - NSIS Forums</title>
  <script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script>
  <!-- Bootstrap core CSS -->

  <link rel="stylesheet" type="text/css" href="//netdna.bootstrapcdn.com/bootswatch/3.0.1/readable/bootstrap.min.css" />
  <link rel="stylesheet" href="../css/style.css" type="text/css" /><!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!--[if lt IE 9]>
                <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
                <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->
</head>

<body>
  <div class="container">
    <!-- Put navigation bar here -->

    <ol class="breadcrumb">
      <li><a href="../index.html" class="glyphicon glyphicon-home"></a></li>

      <li><a href="f-65.html">NSIS Discussion</a></li>

      <li class="active">Deferring Delete of DLLs at end of install</li>
    </ol>

    <p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=269388">Deferring Delete of DLLs at end of install</a></p><br />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">dantemw</span><br />
      <span class="post-time small text-muted">12th April 2007 00:27 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>Deferring Delete of DLLs at end of install</strong><br />
      At the end of an NSIS install there seems to be a cleanup phase that deletes DLLs used by the installer such as "nsExec.dll" and "System.dll". However if one of these DLLs is in use at the time of delete it gets marked for delete on Reboot.<br />
      <br />
      Is it possible to modify this cleanup behavior to either:<br />
      1. Not delete on reboot<br />
      2. Be invoked by calling into the installer with a command-line rather than automatically happening at the end of the script?<br />
      <br />
      Thank You,<br />
      Michael</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">dantemw</span><br />
      <span class="post-time small text-muted">12th April 2007 00:33 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Nevermind. I discovered that it was the NSISArray DLL that was marked for delete on reboot. I just added:<br />
      Function .onGUIEnd<br />
      NSISArray::Unload<br />
      FunctionEnd<br />
      <br />
      And all is well.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Brummelchen</span><br />
      <span class="post-time small text-muted">12th April 2007 13:54 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">System::Call 'bla'<br />
      ...<br />
      System::free 0<br />
      <br />
      NSISArray<br />
      ${myarray-&gt;Delete}<br />
      <br />
      <b>RTFM</b> :mad:</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">dantemw</span><br />
      <span class="post-time small text-muted">12th April 2007 20:03 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Thank you for your reply angry face. Your tip has helped me a great deal, and I will continue to RTFM as I have in the past.<br />
      <br />
      --<br />
      Michael</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Brummelchen</span><br />
      <span class="post-time small text-muted">12th April 2007 20:42 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">nm...<br />
      <br />
      sometimes i ask also stupid questions where i know the<br />
      answer after a couple of minutes while try&amp;error or reading<br />
      over and over the faq.<br />
      <br />
      well - idd - i made same error with nsisarray - the key<br />
      for reboots is in registry and called "pending operations"<br />
      i have my own tool to clear those mistakes.</p>
    </div>
    <hr />

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]>
  </script>
</body>
</html>
