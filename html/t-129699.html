<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="Uninstall check" />

  <title>Uninstall check - NSIS Forums</title>
  <script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script>
  <!-- Bootstrap core CSS -->

  <link rel="stylesheet" type="text/css" href="//netdna.bootstrapcdn.com/bootswatch/3.0.1/readable/bootstrap.min.css" />
  <link rel="stylesheet" href="../css/style.css" type="text/css" /><!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!--[if lt IE 9]>
                <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
                <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->
</head>

<body>
  <div class="container">
    <!-- Put navigation bar here -->

    <ol class="breadcrumb">
      <li><a href="../index.html" class="glyphicon glyphicon-home"></a></li>

      <li><a href="f-65.html">NSIS Discussion</a></li>

      <li class="active">Uninstall check</li>
    </ol>

    <p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=129699">Uninstall check</a></p><br />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">DVDK</span><br />
      <span class="post-time small text-muted">25th March 2003 12:36 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>Uninstall check</strong><br />
      &nbsp; I have made a modern installer, and now have a question about the uninstall section.<br />
      <br />
      Lets say that my installer includes 3 different sections. The user only installs one of the 3 sections, because he has the needed files that are located in the other 2 sections.<br />
      <br />
      When the user wants to uninstall, then all sections are being uninstalled, but I only want the section he installed with my installer to be uninstalled. How do I do that?</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Joost Verburg</span><br />
      <span class="post-time small text-muted">25th March 2003 13:36 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Use InstallOptions to create a custom page.<br />
      <br />
      A components page for the uninstaller is on the TODO list.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
      <span class="post-time small text-muted">25th March 2003 21:18 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Or save in the registry, an INI file or in a regular file what sections have been selected. To do so just write a certain value at the end of each section and read it in the uninstaller.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Joel</span><br />
      <span class="post-time small text-muted">25th March 2003 21:23 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">I'll have the same thing, but<br />
      When I called the uninstaller, it<br />
      delete all the files... installed and NOT installed<br />
      and it doesn't return in error ...<br />
      so maybe you want like the old fashion way...<br />
      Delete all the files ... installed and not installed<br />
      <br />
      Just my opinion :D</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">DVDK</span><br />
      <span class="post-time small text-muted">25th March 2003 22:40 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>Uninstall check</strong><br />
      &nbsp; Yup, also having big trouble still, but also very hard to understand when english is second languges fro me.<br />
      <br />
      But I have maneced to solve the problem meanwhile with som CMD files which are being executed upon uninstall instead. In that way I can control it, but far from optimal.<br />
      <br />
      Its very easy to understand when you read faqs, but the problem sneaks in when all those foreign words comes along. :igor:</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
      <span class="post-time small text-muted">26th March 2003 13:39 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">I am sorry but I don't understand how CMD files help you in uninstalling more then one component... What exactly are you trying to do?</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">DVDK</span><br />
      <span class="post-time small text-muted">26th March 2003 15:06 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>CMD</strong><br />
      &nbsp; Its because I have made some CMD files for each component, which are being executed after each other upon uninstall.<br />
      <br />
      I want the uninstall section to uninstall the things that where installed by my installer. Lets say that my installer includes:<br />
      <br />
      something.txt<br />
      something.exe<br />
      someotherthing.exe<br />
      <br />
      Lets say that the user already has someotherthing.exe. He will offcause not install this component again since there is no reason to. But when he execute the uninstaller, will the someotherthing.exe also be uninstalled and I do not want this, since it was not included in the installation.<br />
      <br />
      So the thing I want is that my uninstall section only will uninstall the things the user has included. But I dont know how to make this custom page, since the words are very hard to understand. :igor: Do someone have an example of this, since this will make it easier for me to understand.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
      <span class="post-time small text-muted">26th March 2003 15:17 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">You don't need a custom page for this. All you need to do is remember what the user have installed. You can do this by writing the installed sections into an INI file, the registry or a regular file. Lets take the INI file for example. In the installer you'll have:<br />
      <br /></p>
      <pre>
<code>
Section 1
<br />  #install section 1 stuff
<br /> WriteIniStr $INSTDIRuninstall.ini comps section1 yes
<br />SectionEnd
<br /><br />Section 2
<br />  #install section 2 stuff
<br /> WriteIniStr $INSTDIRuninstall.ini comps section2 yes
<br />SectionEnd 
<br />&gt;
</code>
</pre>In the uninstaller:<br />
      <br />
      <pre>
<code>
Section uninstall
<br />  ReadIniStr$0 $INSTDIRuninstall.ini comps section1
<br />  StrCmp$0 "yes" 0 dontUninstallSection1
<br />    # uninstall section1
<br /> dontUninstallSection1:
<br /><br /> ReadIniStr $0 $INSTDIRuninstall.ini comps section2
<br />  StrCmp$0 "yes" 0 dontUninstallSection2
<br />    # uninstall section2
<br /> dontUninstallSection2:
<br />&gt;SectionEnd 
<br />&gt;
</code>
</pre>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">DVDK</span><br />
      <span class="post-time small text-muted">26th March 2003 15:41 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>Nice</strong><br />
      &nbsp; Thanks alot. Just what I was looking for. Real easy actually. :up:</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kukymann</span><br />
      <span class="post-time small text-muted">30th July 2003 11:42 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Hi, my question is little different.<br />
      A user installed section1, section2 and section3. But, what if he wants uninstall only section1 and section3. I thought about Custom page in Uninstall procces, where he selects what section he wants uninstall. It's possible? Or i must wait for A components page?</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">pengyou</span><br />
      <span class="post-time small text-muted">30th July 2003 12:22 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">kukymann, the NSIS Archive has something that seems to do what you want:<br />
      <br />
      "This example demonstrates how to implement Add/Remove functionality in the installer. It operates similar to MS Office installer for example. Unlike conventional NSIS installer it does not only install (upgrade) selected components but also removes unselected components."<br />
      <br />
      <a href="http://nsis.sourceforge.net/archive/viewpage.php?pageid=298" target="_blank">http://nsis.sourceforge.net/archive/...php?pageid=298</a><br />
      <br />
      An example is included so you can see how the idea works.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kukymann</span><br />
      <span class="post-time small text-muted">30th July 2003 12:40 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">thx, it's useful :o]</p>
    </div>
    <hr />

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]>
  </script>
</body>
</html>