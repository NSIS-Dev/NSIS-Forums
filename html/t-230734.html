<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="description" content="How to extract a .rar file and copy it to a diff. folder??"><title>How to extract a .rar file and copy it to a diff. folder?? - NSIS Forums</title><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script><link rel="preload" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css" as="style" onload="this.rel='stylesheet'"><link rel="preload" href="../css/style.css" as="style" onload="this.rel='stylesheet'"><noscript><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css"><link rel="stylesheet" href="../css/style.css"></noscript><script>!function(a){"use strict";var b=function(b,c,d){function e(a){return h.body?a():void setTimeout(function(){e(a)})}function f(){i.addEventListener&&i.removeEventListener("load",f),i.media=d||"all"}var g,h=a.document,i=h.createElement("link");if(c)g=c;else{var j=(h.body||h.getElementsByTagName("head")[0]).childNodes;g=j[j.length-1]}var k=h.styleSheets;i.rel="stylesheet",i.href=b,i.media="only x",e(function(){g.parentNode.insertBefore(i,c?g:g.nextSibling)});var l=function(a){for(var b=i.href,c=k.length;c--;)if(k[c].href===b)return a();setTimeout(function(){l(a)})};return i.addEventListener&&i.addEventListener("load",f),i.onloadcssdefined=l,l(f),i};"undefined"!=typeof exports?exports.loadCSS=b:a.loadCSS=b}("undefined"!=typeof global?global:this);!function(a){if(a.loadCSS){var b=loadCSS.relpreload={};if(b.support=function(){try{return a.document.createElement("link").relList.supports("preload")}catch(b){return!1}},b.poly=function(){for(var b=a.document.getElementsByTagName("link"),c=0;c<b.length;c++){var d=b[c];"preload"===d.rel&&"style"===d.getAttribute("as")&&(a.loadCSS(d.href,d,d.getAttribute("media")),d.rel=null)}},!b.support()){b.poly();var c=a.setInterval(b.poly,300);a.addEventListener&&a.addEventListener("load",function(){b.poly(),a.clearInterval(c)}),a.attachEvent&&a.attachEvent("onload",function(){a.clearInterval(c)})}}}(this);</script></head><body><div class="container"><ol class="breadcrumb"><li><a href="../index.html" class="glyphicon glyphicon-home"></a></li><li><a href="f-65.html">NSIS Discussion</a></li><li class="active">How to extract a .rar file and copy it to a diff. folder??</li></ol><p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=230734">How to extract a .rar file and copy it to a diff. folder??</a></p><br><div class="post"><p class="post-meta"><span class="post-author text-primary">cirerita</span><br><span class="post-time small text-muted">11th November 2005 19:26 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>How to extract a .rar file and copy it to a diff. folder??</strong><br>Hi,<br>I made a search and found that the nsExec command apparently can be used to extract .rar files together with Unrar, or so I understood.<br><br>I've been trying to use it in my installer to no avail. Mind you, I'm a 99% newbie, so that's normal, I guess.<br>Here's the basic script:<br><br>SetOutPath "$INSTDIR"<br>File "..\MediaAutoGraph.rar"<br>nsExec::unrar '"$INSTDIR\MediaAutoGraph.rar"'<br><br>I've been switching the " here and there, but I always get some sort of error. I just want to extract the .rar file (it will create a folder with a lot of files) and then I want to copy the extracted folder to a different location and overwrite an existing one.<br><br>any idea? thanks a lot...</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">kichik</span><br><span class="post-time small text-muted">11th November 2005 19:31 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">nsExec can be used to run unrar.exe. It can't extract files from RAR archives on its own. Extract unrar.exe along with the RAR archive and use something like:</p><pre>
<code>nsExec::ExecToLog '"C:\path\to\unrar.exe" "$INSTDIR\MediaAutoGraph.rar"'</code>
</pre>unrar.exe might require some more information on the command line, so this example will probably not work as is.</div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">cirerita</span><br><span class="post-time small text-muted">11th November 2005 19:37 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Is there any other way to extract files on the fly from a rar archive?</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">kichik</span><br><span class="post-time small text-muted">11th November 2005 19:43 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">7-zip's command line utility might be able to extract RAR archives as well.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">cirerita</span><br><span class="post-time small text-muted">11th November 2005 19:50 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Ok, I tried your command line and extracting also UnRAR.exe together with the rar archive. Obviously, UnRAR needs some extra parameters to extract the archive.<br><br>This is what i get in the log window:<br><br>Extract: UnRAR.exe... 100%<br>Extract: MediaAutoGraph.rar... 100%<br><br>UNRAR 3.51 freeware Copyright (c) 1993-2005 Alexander Roshal<br><br>Usage: unrar &lt;command&gt; -&lt;switch 1&gt; -&lt;switch N&gt; &lt;archive&gt; &lt;files...&gt;<br>&lt;@listfiles...&gt; &lt;path_to_extract\&gt;<br><br>&lt;Commands&gt;<br>e Extract files to current directory<br>l[t,b] List archive [technical, bare]<br>p Print file to stdout<br>t Test archive files<br>v[t,b] Verbosely list archive [technical,bare]<br>x Extract files with full path<br><br>&lt;Switches&gt;<br>- Stop switches scanning<br>ac Clear Archive attribute after compression or extraction<br>ad Append archive name to destination path<br>ap&lt;path&gt; Set path inside archive<br>av- Disable authenticity verification check<br>c- Disable comments show<br>cfg- Disable read configuration<br>cl Convert names to lower case<br>cu Convert names to upper case<br>dh Open shared files<br>ep Exclude paths from names<br>ep3 Expand paths to full including the drive letter<br>f Freshen files<br>id[c,d,p,q] Disable messages<br>ierr Send all messages to stderr<br>inul Disable all messages<br>ioff Turn PC off after completing an operation<br>kb Keep broken extracted files<br>n&lt;file&gt; Include only specified file<br>n@ Read file names to include from stdin<br>n@&lt;list&gt; Include files in specified list file<br>o+ Overwrite existing files<br>o- Do not overwrite existing files<br>oc Set NTFS Compressed attribute<br>ow Save or restore file owner and group<br>p[password] Set password<br>p- Do not query password<br>r Recurse subdirectories<br>ri&lt;P&gt;[:&lt;S&gt;] Set priority (0-default,1-min..15-max) and sleep time in ms<br>ta&lt;date&gt; Process files modified after &lt;date&gt; in YYYYMMDDHHMMSS format<br>tb&lt;date&gt; Process files modified before &lt;date&gt; in YYYYMMDDHHMMSS format<br>tn&lt;time&gt; Process files newer than &lt;time&gt;<br>to&lt;time&gt; Process files older than &lt;time&gt;<br>ts&lt;m,c,a&gt;[N] Save or restore file time (modification, creation, access)<br>u Update files<br>v List all volumes<br>ver[n] File version control<br>vp Pause before each volume<br>x&lt;file&gt; Exclude specified file<br>x@ Read file names to exclude from stdin<br>x@&lt;list&gt; Exclude files in specified list file<br>y Assume Yes on all queries</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">cirerita</span><br><span class="post-time small text-muted">11th November 2005 20:24 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">I tried this, but no luck:<br><br>File "..\UnRAR.exe"<br>File "..\MediaAutoGraph.rar"<br>nsExec::ExecToLog '"$INSTDIR\UnRAR.exe e" "MediaAutoGraph.rar"'<br><br>also tried using 7z:<br>File "..\7z.exe"<br>File "..\MediaAutoGraph.rar"<br>nsExec::ExecToLog '"$INSTDIR\7z.exe e" "MediaAutoGraph.rar"'</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">kichik</span><br><span class="post-time small text-muted">11th November 2005 20:25 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Get the 'e' out of the quotes. The first quotes should surround just the path to the executable.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Comm@nder21</span><br><span class="post-time small text-muted">11th November 2005 20:26 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">code:<br><br><br>also tried using 7z:<br>File "..\7z.exe"<br>File "..\MediaAutoGraph.rar"<br>nsExec::ExecToLog '"$INSTDIR\7z.exe" e MediaAutoGraph.rar'</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">cirerita</span><br><span class="post-time small text-muted">11th November 2005 20:40 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">thanks guys, got it working:<br><br>nsExec::ExecToLog '"$INSTDIR\7z.exe" e MediaAutoGraph.rar -oc:\downloads\test"'<br><br>it copies the content of the rar archive to the downloads\test folder.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br><span class="post-time small text-muted">12th November 2005 09:25 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">I think you've got one to many quotes there.<br>nsExec::ExecToLog '"$INSTDIR\7z.exe" e MediaAutoGraph.rar -o"c:\downloads\test"'<br><br>-Stu</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">cirerita</span><br><span class="post-time small text-muted">12th November 2005 09:35 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">it'w weird, beucause it does work this way:<br>nsExec::ExecToLog '"$INSTDIR\7z.exe" e MediaAutoGraph.rar -aoa -oc:\downloads\test"' [aoa command overwrites without asking first]<br><br>i'll try your way now...<br><br>well, well, well, it works both ways.<br>nsExec::ExecToLog '"$INSTDIR\7z.exe" e MediaAutoGraph.rar -aoa -oc:\downloads\test"'<br><br>and<br><br>nsExec::ExecToLog '"$INSTDIR\7z.exe" e MediaAutoGraph.rar -aoa -o"c:\downloads\test"'<br><br>it seems that the right way should be the second one, but the first one also works. weird, huh?</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">AlexV</span><br><span class="post-time small text-muted">24th November 2006 16:22 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">It's probably worth pointing out at this point that 7z.exe will only work if 7zip is installed. If you just ship 7z.exe and the target system has not got 7zip installed, it won't be able to extract anything.<br><br>There is a standalone .exe provided by 7zip called 7za.exe, but unfortunately that does not extract from rar files. I'm trying to be able to extract rar's, zip's and 7z's in my installer, and the only solution I have found so far is to ship both 7za.exe and unrar.exe, for a whopping total of 686k.<br><br>If anyone knows of a more lightweight solution with zip, 7z, and rar capability, I'd love to hear of it.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">vitoco</span><br><span class="post-time small text-muted">24th November 2006 17:08 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">BTW, why to use NSIS to extract a temporary archive file like a RAR or ZIP (and it's uncompressor utility) and then extract final files from the archive?<br><br>NSIS can drop final files just like an archiver. You only need to uncompress your files locally and add them (or the directory containing them) to your NSI script, then compile.<br><br>File /r and it's other options are enougth. I can't think about a situation where a simple archiver is required as an intermediate step.<br><br>At least for me, NSIS's solid lzma compress a lot more than WinRAR with the maximum compression option.<br><br>++Vitoco</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">erundil</span><br><span class="post-time small text-muted">22nd April 2011 02:36 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"></p><blockquote><small>Originally posted by vitoco</small><br>BTW, why to use NSIS to extract a temporary archive file like a RAR or ZIP (and it's uncompressor utility) and then extract final files from the archive?</blockquote>We dont speak of something like this:<br>File archive.rar<br>Unpack archive.rar<br><br>We speak about using installer to unpack an archive which already exists (on same CD maybe).<br>What is more - NSIS have it's limitations - it's 2GB per file. If you want to distribute some more, u need to pack data into separate archives.</div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">MSG</span><br><span class="post-time small text-muted">22nd April 2011 06:20 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Please don't reply to a discussion that's been closed for five(!) years.</p></div><hr><div class="footer"><p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p></div></div><script src="../js/highlight.pack.js" type="text/javascript"></script><script type="text/javascript">//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]></script></body></html>