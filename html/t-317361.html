<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="description" content="How to open a folder"><title>How to open a folder - NSIS Forums</title><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script><link rel="preload" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css" as="style" onload="this.rel='stylesheet'"><link rel="preload" href="../css/style.css" as="style" onload="this.rel='stylesheet'"><noscript><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css"><link rel="stylesheet" href="../css/style.css"></noscript><script>!function(a){"use strict";var b=function(b,c,d){function e(a){return h.body?a():void setTimeout(function(){e(a)})}function f(){i.addEventListener&&i.removeEventListener("load",f),i.media=d||"all"}var g,h=a.document,i=h.createElement("link");if(c)g=c;else{var j=(h.body||h.getElementsByTagName("head")[0]).childNodes;g=j[j.length-1]}var k=h.styleSheets;i.rel="stylesheet",i.href=b,i.media="only x",e(function(){g.parentNode.insertBefore(i,c?g:g.nextSibling)});var l=function(a){for(var b=i.href,c=k.length;c--;)if(k[c].href===b)return a();setTimeout(function(){l(a)})};return i.addEventListener&&i.addEventListener("load",f),i.onloadcssdefined=l,l(f),i};"undefined"!=typeof exports?exports.loadCSS=b:a.loadCSS=b}("undefined"!=typeof global?global:this);!function(a){if(a.loadCSS){var b=loadCSS.relpreload={};if(b.support=function(){try{return a.document.createElement("link").relList.supports("preload")}catch(b){return!1}},b.poly=function(){for(var b=a.document.getElementsByTagName("link"),c=0;c<b.length;c++){var d=b[c];"preload"===d.rel&&"style"===d.getAttribute("as")&&(a.loadCSS(d.href,d,d.getAttribute("media")),d.rel=null)}},!b.support()){b.poly();var c=a.setInterval(b.poly,300);a.addEventListener&&a.addEventListener("load",function(){b.poly(),a.clearInterval(c)}),a.attachEvent&&a.attachEvent("onload",function(){a.clearInterval(c)})}}}(this);</script></head><body><div class="container"><ol class="breadcrumb"><li><a href="../index.html" class="glyphicon glyphicon-home"></a></li><li><a href="f-65.html">NSIS Discussion</a></li><li class="active">How to open a folder</li></ol><p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=317361">How to open a folder</a></p><br><div class="post"><p class="post-meta"><span class="post-author text-primary">SteveRussell</span><br><span class="post-time small text-muted">27th February 2010 20:46 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>How to open a folder</strong><br>Is there something like MUI_FINISHPAGE_RUN that I can use to simply open a folder? Or what else would you suggest?</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">pengyou</span><br><span class="post-time small text-muted">27th February 2010 21:15 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">One of my installers has an option to display a folder using this command</p><pre>
<code>ExecShell "open" "$PLUGINSDIR\source"</code>
</pre></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">SteveRussell</span><br><span class="post-time small text-muted">27th February 2010 22:25 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Thank you. I will keep that in mind. Since I am wanting to open the folder from the finish page, it looks like I need to use MUI_FINISHPAGE_RUN_FUNCTION, as demonstrated at <a href="http://nsis.sourceforge.net/Run_an_application_shortcut_after_an_install." target="_blank">http://nsis.sourceforge.net/Run_an_a...er_an_install.</a></p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">SteveRussell</span><br><span class="post-time small text-muted">27th February 2010 23:45 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Now that I have the folder opening with<br><br>Function LaunchLink<br>ExecShell "" "$SMPROGRAMS\${PRODUCT_FAMILY}\${PRODUCT_NAME}\${PRODUCT_NAME}.lnk"<br>FunctionEnd<br><br>I am failing to associate my icon with the desktop shortcut. Is there anything wrong with the following syntax?<br><br>CreateShortCut "$DESKTOP\${DESKTOP_NAME}.lnk" "$INSTDIR\${PRODUCT_NAME}" "C:\Hand in Hand\Room 101\res\Install_Icon.ico"</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">SteveRussell</span><br><span class="post-time small text-muted">27th February 2010 23:52 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">My target is displaying:<br><br>"C:\Program Files\Max and Max Spanish\On the Go Spanish General Set 1" C:\Hand in Hand\Room 101\res\Install_Icon.ico</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Anders</span><br><span class="post-time small text-muted">27th February 2010 23:59 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">you forgot the parameter (use "") (how is CreateShortCut supposed to guess that C:\Hand in Hand\... is a icon and not a parameter? You can't leave things out, the order must be correct)</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">SteveRussell</span><br><span class="post-time small text-muted">28th February 2010 00:06 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Would you mind being more specific? I am looking at the docs and web samples, but something just isn't clicking.<br><br>Thanks!</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">SteveRussell</span><br><span class="post-time small text-muted">28th February 2010 00:09 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Okay, I got it. Thanks!</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">SteveRussell</span><br><span class="post-time small text-muted">28th February 2010 00:20 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Now why won't that desktop shortcut open when I double-click on it, without asking me what application to use?<br><br>If I manually enter a "\" at the end of the path in the Target textbox of the shortcut's dialog, apply the change and then try the double-click on the desktop icon again, it opens the folder correctly. Yet including the slash in the code has no effect.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Anders</span><br><span class="post-time small text-muted">28th February 2010 01:38 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">I'm not sure if NSIS or windows is stripping it off but<br></p><pre>
<code><br>push $outdir<br>setoutpath ""<br>createshortcut "$temp\test.lnk" "$documents"<br>pop $outdir<br></code>
</pre>seems to work<br>
      <br>
      The NSIS installer used to create a directory shortcut a couple of versions ago, you could check and see how it does it
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">SteveRussell</span><br>
      <span class="post-time small text-muted">28th February 2010 03:12 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">No, NSIS installer is not stripping out the slash, but the slash should not be needed. And even the actual desktop shortcut removes the manually entered slash, yet it then behaves as expected.<br>
      <br>
      I appreciate your workaround, but if this is a bug, I want to know it. There doesn't seem to be a parameter to indicate a directory versus a file either, so I am not sure what to think about this situation.<br>
      <br>
      Thank you for all of your help tonight.</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Anders</span><br>
      <span class="post-time small text-muted">28th February 2010 04:22 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">From what I can tell, when the target folder and .lnk are on the same partition, IShellLink will automatically add a relative path (.lnk has SLDF_HAS_RELPATH flag)<br>
      <br>
      If I call psl-&gt;SetRelativePath("",0); before ppf-&gt;Save(...) the .lnk does not include a relative path.<br>
      <br>
      It should be noted that when drag&amp;drop'ing "my documents" folder to create a shortcut on the same partition, the .lnk created by explorer also has a relative path.<br>
      <br>
      SLDF_HAS_RELPATH might not matter at all (But my initial test spanned drives so I had no relative paths, and that is why I investigated that flag)<br>
      <br>
      On my system right now, no matter what I do, I can't seem to create a broken shortcut.<br>
      <br></p>
      <pre>
<code>setoutpath $appdata ;"random" outdir<br>createshortcut "$temp\nsistest2.lnk" "$programfiles\Internet Explorer"<br>execshell "" "$temp\nsistest2.lnk"<br></code>
</pre>works just fine (When I first responded to your post, I just got the "open with" dialog, maybe a shell bug or something, who knows)
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">SteveRussell</span><br>
      <span class="post-time small text-muted">28th February 2010 05:08 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">I see now that we are describing two different situations. Yes, your code opens a window immediately. But I am talking about the application desktop item.<br>
      <br>
      Still the shortcut wants a program to be specified before opening. And again, if I open the shortcut, edit it in any manner and close it, it works fine.<br>
      <br>
      Section "MainSection" SEC01<br>
      MessageBox MB_YESNO "Would you like to have a shortcut on your desktop?" IDNO +2<br>
      Call DesktopShortcut<br>
      <br>
      Function DesktopShortcut<br>
      SetOutPath $appdata ;"random" outdir<br>
      CreateShortCut "$DESKTOP\${DESKTOP_NAME}.lnk" "$INSTDIR\${PRODUCT_NAME}" "" "${MUI_ICON}"<br>
      FunctionEnd</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Anders</span><br>
      <span class="post-time small text-muted">28th February 2010 06:29 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">well, its not like I can tell when you don't show us your defines. Its still not clear to me if you want to open a folder or an application (.exe or whatever)<br>
      <br>
      MUI_ICON makes no sense for example since it is normally a .ico on the machine you BUILD on, not the end users machine<br>
      <br></p>
      <pre>
<code>!define MUI_ICON "$windir\regedit.exe" <br>!define DESKTOP_NAME "nsislnktest"<br>!define PRODUCT_NAME "Internet Explorer" ;"Internet Explorer\iexplore.exe" also works fine to start an app<br>InstallDir $programfiles<br>Section "MainSection" SEC01<br>MessageBox MB_YESNO "Would you like to have a shortcut on your desktop?" IDNO +2<br>Call DesktopShortcut<br>ExecShell "" "$DESKTOP\${DESKTOP_NAME}.lnk"<br>Delete "$DESKTOP\${DESKTOP_NAME}.lnk"<br>SectionEnd<br><br>Function DesktopShortcut<br>SetOutPath $appdata ;"random" outdir<br>CreateShortCut "$DESKTOP\${DESKTOP_NAME}.lnk" "$INSTDIR\${PRODUCT_NAME}" "" "${MUI_ICON}"<br>FunctionEnd</code>
</pre>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">SteveRussell</span><br>
      <span class="post-time small text-muted">28th February 2010 12:15 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">In this case, the product being installed is simply a folder containing mp3 files. There is no exe for the user to run. They just need to be able to view the mp3's. I do have the folder open from the finish page, which you helped me to figure out. And apparently, since the shortcut that is installed on the desktop (if they choose YES on the messagebox) is not an exe, I have to specify the icon; otherwise the desktop shortcut uses a generic image.</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">pengyou</span><br>
      <span class="post-time small text-muted">28th February 2010 13:47 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">I cannot get it to go wrong on my Window 7 system. As Anders has already said, without seeing your code it is hard to see where it is going wrong.<br>
      <br>
      Which version of NSIS are you using? Which version of MUI are you using for your installer: "Modern UI" or "Modern UI 2"? Are you remembering to INSTALL the icon you want to use for the shortcut?</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">SteveRussell</span><br>
      <span class="post-time small text-muted">28th February 2010 14:18 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">I just updated to NSIS 2.46.<br>
      <br>
      ; Script generated by the HM NIS Edit Script Wizard.<br>
      <br>
      ; for Vista<br>
      RequestExecutionLevel highest<br>
      <br>
      Name "OTG Product Set 1" "OTG Product Set 1"<br>
      Caption "OTG Product Set 1"<br>
      <br>
      ; HM NIS Edit Wizard helper defines<br>
      !define PRODUCT_NAME "OTG Product Set 1"<br>
      !define SPELLED_OUT_PRODUCT_NAME "OurName OTG Product Set 1"<br>
      !define DESKTOP_NAME "OTG Product Set 1"<br>
      !define PRODUCT_FAMILY "OurName Language"<br>
      !define PRODUCT_VERSION "1.0"<br>
      !define PRODUCT_PUBLISHER "OurName Language Software, LLC"<br>
      !define PRODUCT_WEB_SITE "http://www.OurSite.com"<br>
      !define PRODUCT_DIR_REGKEY "Software\Microsoft\Windows\CurrentVersion\App Paths\${PRODUCT_FAMILY}\${PRODUCT_NAME}"<br>
      !define PRODUCT_UNINST_KEY "Software\Microsoft\Windows\CurrentVersion\Uninstall\${PRODUCT_NAME}"<br>
      !define PRODUCT_UNINST_ROOT_KEY "HKLM"<br>
      !define DEM "OurName Language 1 Demo"<br>
      <br>
      BGGradient on<br>
      BGGradient 000064 7A7ADE notext<br>
      <br>
      ; MUI 1.67 compatible ------<br>
      !include "MUI2.nsh"<br>
      !include LogicLib.nsh<br>
      !include FileFunc.nsh<br>
      !insertmacro un.GetParent<br>
      <br>
      ;--------------------------------<br>
      ;Interface Configuration<br>
      !define MUI_HEADERIMAGE<br>
      !define MUI_HEADERIMAGE_BITMAP "C:\Hand in Hand\Installers\Header Bitmap.bmp"<br>
      <br>
      ;--------------------------------<br>
      ; MUI Settings<br>
      !define MUI_ABORTWARNING<br>
      !define MUI_ICON "C:\Hand in Hand\Room 101\res\OTG_test.ico"<br>
      !define MUI_UNICON "C:\Hand in Hand\Room 101\res\OTG_UNxx.ico"<br>
      !define MUI_WELCOMEFINISHPAGE_BITMAP "C:\Hand in Hand\Installers\WelcomeFinish.bmp"<br>
      <br>
      ; Instfiles page preparations; must be placed early on this page, not in the install page section<br>
      !define MUI_INSTFILESPAGE_COLORS "${MUI_TEXT_COLOR} ${MUI_BGCOLOR}"<br>
      !define MUI_INSTFILESPAGE_PROGRESSBAR "smooth"<br>
      <br>
      ;try this for custom welcome<br>
      !define MUI_WELCOMEPAGE_TITLE "${SPELLED_OUT_PRODUCT_NAME} is ready to be installed. Click Next to get going!"<br>
      !define MUI_WELCOMEPAGE_TITLE_3LINES<br>
      !define MUI_WELCOMEPAGE_TEXT ''<br>
      <br>
      ; Welcome page<br>
      !insertmacro MUI_PAGE_WELCOME<br>
      <br>
      ; License page<br>
      !define MUI_LICENSEPAGE_CHECKBOX<br>
      !define MUI_LICENSEPAGE_TEXT_TOP ""<br>
      !define MUI_LICENSEPAGE_TEXT_BOTTOM "If you accept the terms of the Agreement, click the checkbox below."<br>
      !insertmacro MUI_PAGE_LICENSE "c:\Hand in Hand\Data\Software License.txt"<br>
      <br>
      ;try this for custom directory<br>
      !define MUI_PAGE_HEADER_TEXT "Recommended installation directory"<br>
      !define MUI_PAGE_HEADER_SUBTEXT " "<br>
      !define MUI_DIRECTORYPAGE_TEXT_TOP '$\nSetup will install ${SPELLED_OUT_PRODUCT_NAME} in the folder below.$\n$\n(If you prefer a different location, click Browse and make your choice.)$\n$\nClick Install to continue.'<br>
      !define MUI_DIRECTORYPAGE_TEXT 'text on the page'<br>
      <br>
      ; Directory page<br>
      !insertmacro MUI_PAGE_DIRECTORY<br>
      <br>
      ; Instfiles page<br>
      !insertmacro MUI_PAGE_INSTFILES<br>
      <br>
      ; Finish page<br>
      !define MUI_FINISHPAGE_TITLE '${SPELLED_OUT_PRODUCT_NAME} has been installed. Are your speakers turned on?'<br>
      !define MUI_FINISHPAGE_TEXT "Click Finish and be on your way!"<br>
      !define MUI_FINISHPAGE_TEXT_LARGE<br>
      !define MUI_FINISHPAGE_TITLE_3LINES ;'${DAPRODUCT_NAME} has been installed. ARE YOUR SPEAKERS TURNED ON?'<br>
      !define MUI_FINISHPAGE_RUN<br>
      !define MUI_FINISHPAGE_RUN_TEXT "Open your ${PRODUCT_NAME} folder."<br>
      !define MUI_FINISHPAGE_RUN_FUNCTION "LaunchLink"<br>
      !define MUI_FINISHPAGE_LINK_COLOR FF0000<br>
      !insertmacro MUI_PAGE_FINISH<br>
      <br>
      ; Uninstaller pages<br>
      !insertmacro MUI_UNPAGE_INSTFILES<br>
      <br>
      ; Language files<br>
      !insertmacro MUI_LANGUAGE "English"<br>
      <br>
      ; MUI end ------<br>
      <br>
      OutFile "MMOtGSpGen1Setup.exe"<br>
      InstallDir "$PROGRAMFILES\${PRODUCT_FAMILY}"<br>
      InstallDirRegKey HKLM "${PRODUCT_DIR_REGKEY}" ""<br>
      ShowInstDetails show<br>
      ShowUnInstDetails show<br>
      <br>
      Section "MainSection" SEC01<br>
      MessageBox MB_YESNO "Would you like to have a shortcut on your desktop?" IDNO +2<br>
      Call DesktopShortcut<br>
      <br>
      CreateDirectory "$INSTDIR\${PRODUCT_NAME}"<br>
      CreateDirectory "$SMPROGRAMS\${PRODUCT_FAMILY}"<br>
      CreateDirectory "$SMPROGRAMS\${PRODUCT_FAMILY}\${PRODUCT_NAME}"<br>
      CreateShortCut "$SMPROGRAMS\${PRODUCT_FAMILY}\${PRODUCT_NAME}\${PRODUCT_NAME}.lnk" "$INSTDIR\${PRODUCT_NAME}" "" "${MUI_ICON}"<br>
      <br>
      ; CreateDirectory "$INSTDIR\${PRODUCT_NAME}"<br>
      SetOutPath "$INSTDIR\${PRODUCT_NAME}"<br>
      SetOverwrite ifnewer<br>
      File /nonfatal /r "c:\Hand in Hand\otg\*.*"<br>
      SectionEnd<br>
      <br>
      Section -AdditionalIcons<br>
      WriteIniStr "$INSTDIR\${PRODUCT_FAMILY}.url" "InternetShortcut" "URL" "${PRODUCT_WEB_SITE}"<br>
      CreateShortCut "$SMPROGRAMS\${PRODUCT_FAMILY}\Website.lnk" "$INSTDIR\${PRODUCT_FAMILY}.url"<br>
      CreateShortCut "$SMPROGRAMS\${PRODUCT_FAMILY}\${PRODUCT_NAME}\Uninstall.lnk" "$INSTDIR\${PRODUCT_NAME}\uninst.exe"<br>
      SectionEnd<br>
      <br>
      Section -Post<br>
      WriteUninstaller "$INSTDIR\${PRODUCT_NAME}\uninst.exe"<br>
      WriteRegStr HKLM "${PRODUCT_DIR_REGKEY}" "" "$INSTDIR\${PRODUCT_NAME}"<br>
      WriteRegStr ${PRODUCT_UNINST_ROOT_KEY} "${PRODUCT_UNINST_KEY}" "DisplayName" "$(^Name)"<br>
      WriteRegStr ${PRODUCT_UNINST_ROOT_KEY} "${PRODUCT_UNINST_KEY}" "UninstallString" "$INSTDIR\${PRODUCT_NAME}\uninst.exe"<br>
      WriteRegStr ${PRODUCT_UNINST_ROOT_KEY} "${PRODUCT_UNINST_KEY}" "DisplayIcon" "$INSTDIR\${PRODUCT_NAME}"<br>
      WriteRegStr ${PRODUCT_UNINST_ROOT_KEY} "${PRODUCT_UNINST_KEY}" "DisplayVersion" "${PRODUCT_VERSION}"<br>
      WriteRegStr ${PRODUCT_UNINST_ROOT_KEY} "${PRODUCT_UNINST_KEY}" "URLInfoAbout" "${PRODUCT_WEB_SITE}"<br>
      WriteRegStr ${PRODUCT_UNINST_ROOT_KEY} "${PRODUCT_UNINST_KEY}" "Publisher" "${PRODUCT_PUBLISHER}"<br>
      SectionEnd<br>
      <br>
      Function un.onUninstSuccess<br>
      HideWindow<br>
      MessageBox MB_ICONINFORMATION|MB_OK "$(^Name) was successfully removed from your computer."<br>
      FunctionEnd<br>
      <br>
      Function un.onInit<br>
      MessageBox MB_ICONQUESTION|MB_YESNO|MB_DEFBUTTON2 "Are you sure you want to completely remove $(^Name) and all of its components?" IDYES +2<br>
      Abort<br>
      FunctionEnd<br>
      <br>
      Section Uninstall<br>
      ${un.GetParent} "$INSTDIR" $R0<br>
      <br>
      Delete "$SMPROGRAMS\${PRODUCT_FAMILY}\${PRODUCT_NAME}\Uninstall.lnk"<br>
      Delete "$SMPROGRAMS\${PRODUCT_FAMILY}\${PRODUCT_NAME}\${PRODUCT_NAME}.lnk"<br>
      Delete "$DESKTOP\${DESKTOP_NAME}.lnk"<br>
      Delete "$DESKTOP\${PRODUCT_NAME}.lnk" ; in case this exists from an earlier installation<br>
      Delete "$R0\${PRODUCT_NAME}"<br>
      RMDir /r "$INSTDIR"<br>
      RMDir "$SMPROGRAMS\${PRODUCT_FAMILY}\${PRODUCT_NAME}"<br>
      <br>
      DeleteRegKey ${PRODUCT_UNINST_ROOT_KEY} "${PRODUCT_UNINST_KEY}"<br>
      DeleteRegKey HKLM "${PRODUCT_DIR_REGKEY}"<br>
      SetAutoClose true<br>
      SectionEnd<br>
      <br>
      Function LaunchLink<br>
      ExecShell "" "$SMPROGRAMS\${PRODUCT_FAMILY}\${PRODUCT_NAME}\${PRODUCT_NAME}.lnk"<br>
      FunctionEnd<br>
      <br>
      Function DesktopShortcut<br>
      SetOutPath $appdata ;"random" outdir<br>
      CreateShortCut "$DESKTOP\${DESKTOP_NAME}.lnk" "$INSTDIR\${PRODUCT_NAME}" "" "${MUI_ICON}"<br>
      ; execshell "" "$DESKTOP\${DESKTOP_NAME}.lnk"<br>
      FunctionEnd</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">SteveRussell</span><br>
      <span class="post-time small text-muted">28th February 2010 17:12 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">I have found that, after the initial installation, this installer is producing an install directory that reflects the last installation, i.e. "$INSTDIR\${PRODUCT_NAME}", next "$INSTDIR\${PRODUCT_NAME}\${PRODUCT_NAME}"<br>
      and so forth, burying the install deeper and deeper, rather than rewriting.<br>
      <br>
      Whereas I expect "$PROGRAMFILES\${PRODUCT_FAMILY}".<br>
      <br>
      This is the first time I have treated a folder, instead of an exe, as a product, and it seems to be causing me new challenges.</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">SteveRussell</span><br>
      <span class="post-time small text-muted">28th February 2010 19:57 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Adding a trailing backslash seems to have solved the install directory problem:<br>
      <br>
      InstallDir "$PROGRAMFILES\${PRODUCT_FAMILY}/"<br>
      InstallDirRegKey HKLM "${PRODUCT_DIR_REGKEY}/" ""<br>
      <br>
      As for the desktop shortcut that fails to be associated with a program, if I reinstall without unistalling, it works fine. So what is causing/fixing this problem?</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Anders</span><br>
      <span class="post-time small text-muted">1st March 2010 14:18 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">You create the shortcut before the destination exists, DON'T DO THAT (That is why see a broken icon also probably)</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">SteveRussell</span><br>
      <span class="post-time small text-muted">1st March 2010 23:30 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">You're right! Fixed. Thanks, Anders, for hanging in there with me on this.</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">SteveRussell</span><br>
      <span class="post-time small text-muted">6th March 2010 16:09 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">And how can I set attributes/details in this folder (that is opened at the conclusion of installation)? I.e. Title, Track number and column widths?<br>
      <br>
      CreateDirectory "$INSTDIR\${PRODUCT_NAME}"<br>
      . . .<br>
      !define MUI_FINISHPAGE_RUN_TEXT "Open your ${PRODUCT_NAME} folder."<br>
      !define MUI_FINISHPAGE_RUN_FUNCTION "LaunchLink"<br>
      . . .<br>
      Function LaunchLink<br>
      ExecShell "" "$SMPROGRAMS\${PRODUCT_FAMILY}\${PRODUCT_NAME}\${PRODUCT_NAME}.lnk"<br>
      FunctionEnd</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Anders</span><br>
      <span class="post-time small text-muted">6th March 2010 16:50 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">If you were to open this folder using COM automation, you _might_ be able to add/remove columns. But the format of stored info for closed folders are undocumented (IIRC search for "shell bag" in the registry)</p>
    </div>
    <hr>

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]></script></body></html>