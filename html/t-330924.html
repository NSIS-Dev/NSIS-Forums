<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="description" content="Wow6432Node Issue"><title>Wow6432Node Issue - NSIS Forums</title><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script><link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css"><link rel="stylesheet" href="../css/style.css" type="text/css"><!--[if lt IE 9]><script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script><script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script><![endif]--></head><body><div class="container"><ol class="breadcrumb"><li><a href="../index.html" class="glyphicon glyphicon-home"></a></li><li><a href="f-65.html">NSIS Discussion</a></li><li class="active">Wow6432Node Issue</li></ol><p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=330924">Wow6432Node Issue</a></p><br><div class="post"><p class="post-meta"><span class="post-author text-primary">dc_dweller</span><br><span class="post-time small text-muted">25th May 2011 19:21 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>Wow6432Node Issue</strong><br>Hi all,<br><br>My installer is supposed to write something to HKEY_LOCAL_MACHINE\Software\... if this is a 32-bit Windows, and to HKEY_LOCAL_MACHINE\Software\Wow6432Node\... if it is a 64-bit machine, so I have this code:<br><br>${If} ${RunningX64}<br>WriteRegStr HKLM "Software\Wow6432Node\blahblah" "Path" $INSTDIR<br>${Else}<br>WriteRegStr HKLM "Software\blahblah" "Path" $INSTDIR<br>${EndIf}<br><br>This works **most of the time** but not always. Sometimes, when I run it on a 64-bit machine, it creates an additional level:<br><br>HKEY_LOCAL_MACHINE\Software\Wow6432Node\Wow6432Node\blahblah.<br><br>Can someone shed some light on this?<br><br>Thanks.<br><br>-- DC Dweller</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br><span class="post-time small text-muted">25th May 2011 19:34 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">You don't need to specify both registry keys. This is enough for both 32-bit and 64-bit:</p><pre>
<code>WriteRegStr HKLM "Software\blahblah" "Path" $INSTDIR</code>
</pre>Windows handles the redirection for you (try it). If you don't want to write to Wow6432Node then you use SetRegView 64, but otherwise it will always write to Wow6432Node on Windows 64 (because NSIS installers are 32-bit).<br><br>Stu</div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">dc_dweller</span><br><span class="post-time small text-muted">25th May 2011 21:08 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Thanks for replying. You are right, and I ended up doing just that.<br><br>I did notice one thing which implies a bug in NSIS:<br><br>If the registry key HKEY_LOCAL_MACHINE\Software\Wow6432Node\BlahBlah already exists, then the command<br><br>WriteRegStr HKLM "Software\Wow6432Node\blahblah" "Path" $INSTDIR<br><br>works properly, but if it does not exist, then this command writes to<br><br>HKEY_LOCAL_MACHINE\Software\Wow6432Node\Wow6432Node\blahblah</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Anders</span><br><span class="post-time small text-muted">25th May 2011 21:17 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">NSIS just passes the string to the registry API, this redirection is probably by design, you are not really supposed to hardcode the Wow6432 key anywhere. If you are only doing 32bit stuff, don't think about x64 redirection at all and everything should be fine...</p></div><hr><div class="footer"><p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p></div></div><script src="../js/highlight.pack.js" type="text/javascript"></script><script type="text/javascript">//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]></script></body></html>