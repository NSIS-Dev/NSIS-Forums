<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="x64 system - InstallLib problem" />

  <title>x64 system - InstallLib problem - NSIS Forums</title><!-- Bootstrap core CSS -->
  <link rel="stylesheet" type="text/css" href="//netdna.bootstrapcdn.com/bootswatch/3.0.1/readable/bootstrap.min.css" />
  <link rel="stylesheet" href="../css/style.css" type="text/css" /><!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!--[if lt IE 9]>
                <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
                <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->
</head>

<body>
  <div class="container">
    <!-- Put navigation bar here -->

    <ol class="breadcrumb">
      <li><a href="../index.html" class="glyphicon glyphicon-home"></a></li>

      <li><a href="f-65.html">NSIS Discussion</a></li>

      <li class="active">x64 system - InstallLib problem</li>
    </ol>

    <p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=297168">x64 system - InstallLib problem</a></p><br />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">zanz</span><br />
      <span class="post-time small text-muted">10th September 2008 18:40 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>x64 system - InstallLib problem</strong><br />
      Using InstallLib, I'm trying to register a few DLLs on a x64 system. But the DLLs do not get registered. However, instead of InstallLib, if I use RegDLL, the dlls register fine. Also, the same syntex works fine on a 32 bit system.<br />
      <br />
      Here's how I setup my script:<br />
      1) !define LIBRARY_X64 is defined at the beginning of the script.<br />
      2) SetRegView 64 is also set.<br />
      3) !insertmacro InstallLib REGDLL SHARED REBOOT_NOTPROTECTED "${SOURCE_DIR}\my.dll" "$COMMONFILES64\myDLLFolder\my.dll" $COMMONFILES64 is the syntex to register the DLL (it works fine on a 32 bit system, just doesn't work on 64 bit system).<br />
      <br />
      <br />
      It'll be a great help if someone can point out what am I missing here? Why it's not working on 64 bit system? Since it's a shared DLL, my concern is that it might be in use when the installer is updating the DLL, and might throw an error. Therefore, InstallLib is the solution I need, but I can't get it to work. Please help!</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
      <span class="post-time small text-muted">10th September 2008 21:43 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Something doesn't make sense here. How does RegDLL work if it's a x64 DLL? The installer is always 32-bit and can therefore never load x64 DLL. You're probably using a 32-bit DLL and should therefore not define LIBRARY_X64.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">zanz</span><br />
      <span class="post-time small text-muted">10th September 2008 22:36 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Thanks for your reply kichik. I have been trying a lot things to make this work.<br />
      It doesn't make any difference if I define LIBRARY_X64 or not. InstallLib cannot register the DLL. I've tested it both ways. The DLL i have is compatible with both 32 and 64 bit systems, but needs to be installed and registered at Common Files path.<br />
      Any other hints?</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">zanz</span><br />
      <span class="post-time small text-muted">10th September 2008 23:25 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">I can also register the DLL successfully by calling, ExecWait '"$SYSDIR\regsvr32.exe" /s "DLL_Path\MyDll.dll"'<br />
      <br />
      It's just that InstallLib REGDLL isn't working :-(</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
      <span class="post-time small text-muted">12th September 2008 20:41 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">I suggest you debug the registration process by inserting a break point into your DllRegisterServer and see what happens there.</p>
    </div>
    <hr />

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]>
  </script>
</body>
</html>
