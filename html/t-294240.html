<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="description" content="NSISList: Simple List Plugin"><title>NSISList: Simple List Plugin - NSIS Forums</title><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script><link rel="preload" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css" as="style" onload="this.rel='stylesheet'"><link rel="preload" href="../css/style.css" as="style" onload="this.rel='stylesheet'"><noscript><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css"><link rel="stylesheet" href="../css/style.css"></noscript><script>!function(a){"use strict";var b=function(b,c,d){function e(a){return h.body?a():void setTimeout(function(){e(a)})}function f(){i.addEventListener&&i.removeEventListener("load",f),i.media=d||"all"}var g,h=a.document,i=h.createElement("link");if(c)g=c;else{var j=(h.body||h.getElementsByTagName("head")[0]).childNodes;g=j[j.length-1]}var k=h.styleSheets;i.rel="stylesheet",i.href=b,i.media="only x",e(function(){g.parentNode.insertBefore(i,c?g:g.nextSibling)});var l=function(a){for(var b=i.href,c=k.length;c--;)if(k[c].href===b)return a();setTimeout(function(){l(a)})};return i.addEventListener&&i.addEventListener("load",f),i.onloadcssdefined=l,l(f),i};"undefined"!=typeof exports?exports.loadCSS=b:a.loadCSS=b}("undefined"!=typeof global?global:this);!function(a){if(a.loadCSS){var b=loadCSS.relpreload={};if(b.support=function(){try{return a.document.createElement("link").relList.supports("preload")}catch(b){return!1}},b.poly=function(){for(var b=a.document.getElementsByTagName("link"),c=0;c<b.length;c++){var d=b[c];"preload"===d.rel&&"style"===d.getAttribute("as")&&(a.loadCSS(d.href,d,d.getAttribute("media")),d.rel=null)}},!b.support()){b.poly();var c=a.setInterval(b.poly,300);a.addEventListener&&a.addEventListener("load",function(){b.poly(),a.clearInterval(c)}),a.attachEvent&&a.attachEvent("onload",function(){a.clearInterval(c)})}}}(this);</script></head><body><div class="container"><ol class="breadcrumb"><li><a href="../index.html" class="glyphicon glyphicon-home"></a></li><li><a href="f-65.html">NSIS Discussion</a></li><li class="active">NSISList: Simple List Plugin</li></ol><p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=294240">NSISList: Simple List Plugin</a></p><br><div class="post"><p class="post-meta"><span class="post-author text-primary">LoRd_MuldeR</span><br><span class="post-time small text-muted">10th July 2008 02:53 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>NSISList: Simple List Plugin</strong><br>Hello :)<br><br>I have created a very simple List plugin, namely NSISList.<br><br>Well, I know there already is NSISArray, but find it a bit complex to use.<br>Also coding myself makes more fun than using existing plugins :D<br><br>Currently only one instance (one list at a time) is supported.<br>And it's not documented yet, although the example should be self-explaining.<br><br>Bug reports welcome...<br><br>Edit (Afrow UK):<br>Attachment removed. Download from <a href="http://nsis.sourceforge.net/NSISList_plug-in#Download." target="_blank">http://nsis.sourceforge.net/NSISList_plug-in#Download.</a></p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">pospec</span><br><span class="post-time small text-muted">10th July 2008 06:23 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Why do we need another plugin as there is NSISArray?</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Red Wine</span><br><span class="post-time small text-muted">10th July 2008 09:16 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">As far I can say, this appears pretty different than nsis array, but even if there's not noticeable difference I prefer to have more than one options.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">dbach</span><br><span class="post-time small text-muted">10th July 2008 14:32 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">@LoRd_MuldeR<br><br>Call it Alpha as long as it isn't feature complete. ;)</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">LoRd_MuldeR</span><br><span class="post-time small text-muted">10th July 2008 15:11 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Okay, I have added support for multiple lists. You can now create as many lists as you like. Each list is created with a (unique) name and you can use this name to access the list later. Also the missing "Insert" operation has been added, so you can insert items at a specified position now...<br><br>Edit (Afrow UK):<br>Attachment removed. Download from <a href="http://nsis.sourceforge.net/NSISList_plug-in#Download." target="_blank">http://nsis.sourceforge.net/NSISList_plug-in#Download.</a></p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">LoRd_MuldeR</span><br><span class="post-time small text-muted">10th July 2008 15:35 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Sorry, just found a bug in the "Insert" operation. Inserting with an improper index could cause the installer to crash! Now the index will be clipped to the bounds of the list, so inserting with an invalid index won't cause crash anymore.<br><br>See the example for details...</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Red Wine</span><br><span class="post-time small text-muted">10th July 2008 16:39 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">That's an absolutely interesting plugin my Lord ;) and it's getting better as I can see.<br><br>When I'll have time, I will try to implement it with<br><a href="http://nsis.sourceforge.net/Advanced_Uninstall_Log_NSIS_Header" target="_blank">Advanced Uninstall Log</a>, it seems it would eliminate the disadvantage of throwing the list several times.<br><br>Nice job whatsoever :)</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">LoRd_MuldeR</span><br><span class="post-time small text-muted">10th July 2008 17:15 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Thanks for your reply :)<br><br>1. Added "Index" command to return the index of an item<br>2. Added "AllRev" command to push all items onto the stack, in reverse order<br>3. Moved the includes to a separate file<br>4. Added a "Torture Test" for NSISList</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">LoRd_MuldeR</span><br><span class="post-time small text-muted">10th July 2008 19:16 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Added "Load" and "Save" to load/save a list directly from a plain text file.<br>See the example installer...</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">LoRd_MuldeR</span><br><span class="post-time small text-muted">10th July 2008 22:02 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Right another update: I re-enabled single instance support. So if you don't want to mess around with several lists, you can simply use the "default" list now. This list is identified with an empty string "", it doesn't need to be created and it cannot be destroyed. The default list will be created implicitly when then plugin is loaded and it will be destroyed automatically when the plugin is unloaded.<br><br>See the example installer, as always...</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">LoRd_MuldeR</span><br><span class="post-time small text-muted">11th July 2008 14:56 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">I think it should be feature complete now: Added "Set" (change value of existing item), "Exch" (exchange two items by their indexes) and "Move" (move item by it's index). Also some code clean-up was done. In case no major bugs are discovered, I'd call that one finished. Writing some docs now...</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">LoRd_MuldeR</span><br><span class="post-time small text-muted">11th July 2008 15:58 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">First attempt to create some docs ;)</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">LoRd_MuldeR</span><br><span class="post-time small text-muted">12th July 2008 19:45 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><b>Final version has been released on the Wiki page:</b><br><a href="http://nsis.sourceforge.net/NSISList_plug-in" target="_blank">http://nsis.sourceforge.net/NSISList_plug-in</a><br><br>Have fun :)</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Red Wine</span><br><span class="post-time small text-muted">12th July 2008 19:59 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Nice job LoRd_MuldeR, and the docs too. Would be somehow possible to decrease the dll size?<br><br>edit: sorry, I forgot the obvious :) THANKS!</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">LoRd_MuldeR</span><br><span class="post-time small text-muted">12th July 2008 20:16 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"></p><blockquote><i>Originally posted by Red Wine</i><br><b>Would be somehow possible to decrease the dll size?</b></blockquote>Nope. The DLL is created with Delphi and internally I use a TStringList to store all the strings. This means I need to include the "Classes" Unit, which contains the TStringList type. I tried to copy and paste the TStringList code to my own file, so I don't need to include the entire "Classes" Unit and all of it's dependencies. But TStringList is derived from TStrings which again is derived from some other Object I cannot remember now. Also a lot of other Types are involved at different locations, which I'd need to copy as well. So in the end I'd end up with a copy of "Classes" in my own file. That makes no sens and it makes the code ugly and hard to maintain. Since TStringList is very powerful and my entire plugin depends on it, I think I'll keep it the way it is. You can of course pack the plugin DLL with UPX to make it smaller. But then your installer might actually become bigger, because "packed" files compress worse...<br><br>BTW: Is there any way to overcome the 100 KB upload limit?<br><br><br>[EDIT]<br><br>If anybody owns a newer (or older) version of Delphi than mine, that is Delphi 7 Professional, he/she could try to compile my sources and see if that makes the DLL any bigger/smaller. Also Lazarus might be worth a try...</div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">LoRd_MuldeR</span><br><span class="post-time small text-muted">12th July 2008 20:25 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Uhm, Lazarus fails at one of the NSIS API functions :cry:<br><br>Error message is "project1.lpr(61,25) Error: Illegal qualifier"<br><br></p><pre>
<code>function PopString(): string;<br>var<br>  th: pstack_t;<br>begin<br>  if integer(g_stacktop^) &lt;&gt; 0 then begin<br>    th := g_stacktop^;<br>    Result := PChar(@th.text); // &lt;- ERROR HERE !!!<br>    g_stacktop^ := th.next;<br>    GlobalFree(HGLOBAL(th));<br>  end;<br>end;</code>
</pre><br>
      <br>
      Any idea how I could fix this?<br>
      <br>
      This is not my own code, it's from the NSIS plugin example code for Delphi...
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Red Wine</span><br>
      <span class="post-time small text-muted">12th July 2008 20:29 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Okay!<br>
      I guess you may overcome the 100 kb limit if you split your package ;)<br>
      I'm testing the examples right now... I'd say you should change the name to Advanced List Plugin to get closer ;)</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">LoRd_MuldeR</span><br>
      <span class="post-time small text-muted">12th July 2008 20:36 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">I just tinkered with the code and I actually made it compile with Lazarus. The resulting DLL was more than 1 MB in size! Either my Lazarus compiler settings are completely wrong or it creates even bigger binaries than Delphi. Also the DLL crashed with my example installer. That most probably is because I modified the API code wrongly...<br>
      <br>
      <br>
      Splitting a 200 KB file :weird:<br>
      <br>
      I'll keep on an external mirror then ;)</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">LoRd_MuldeR</span><br>
      <span class="post-time small text-muted">12th July 2008 21:39 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Removed the <i>compiled</i> examples from the download, now it's 61 KB in size ;)<br>
      <a href="http://nsis.sourceforge.net/NSISList_plug-in#Download" target="_blank">http://nsis.sourceforge.net/NSISList_plug-in#Download</a></p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">LoRd_MuldeR</span><br>
      <span class="post-time small text-muted">16th July 2008 12:45 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><b>NSISList Plugin (2008-07-16)</b><br>
      This update adds <a href="http://en.wikipedia.org/wiki/Associative_array" target="_blank">Map</a> support to the NSISList plugin :)<br>
      <br>
      The map is implemented in the header file, using only <i>native</i> List functions.<br>
      See the "Examples\NSISList\NSISList_Map.nsi" for info!<br>
      <br>
      <a href="http://nsis.sourceforge.net/NSISList_plug-in#Download" target="_blank">http://nsis.sourceforge.net/NSISList_plug-in#Download</a></p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">pospec</span><br>
      <span class="post-time small text-muted">16th July 2008 12:57 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Just curious - why do you use Lazarus? Isn't Delphi more "windows native"?</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">LoRd_MuldeR</span><br>
      <span class="post-time small text-muted">16th July 2008 13:01 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"></p>

      <blockquote>
        <i>Originally posted by pospec</i><br>
        <b>Just curious - why do you use Lazarus? Isn't Delphi more "windows native"?</b>
      </blockquote>I don't use Lazarus ;)<br>
      <br>
      In fact I own a copy of Delphi 7 Professional and I use it for all my projects.<br>
      One problem with Delphi is, that it creates huge DLL/EXE files, compared to plain C.<br>
      Well, Delphi's standard library is really nice, but it's not "lightweight" at all.<br>
      <br>
      I tried Lazarus in the hope it will produce a smaller DLL, but the opposite was the case!<br>
      It produced a file bigger than 1 MB, Delphi's DLL was only ~100 KB in size.<br>
      <br>
      On the one hand, 100 KB still is pretty big for such a simple plugin!<br>
      On the other hand, we live in the Mircosoft.NET time now :igor:
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">LoRd_MuldeR</span><br>
      <span class="post-time small text-muted">17th July 2008 01:39 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Okay, if I strip the Lazarus DLL then it's only 150 KB in size :D<br>
      Well, that's still bigger than Delphi's DLL so I'll stick to Delphi for compiling!<br>
      <br>
      Nevertheless the sources for Lanczos are included in the download.<br>
      Hopefully somebody can fix them to work...<br>
      <br>
      Having an alternative compiler can never be wrong ;)</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">pospec</span><br>
      <span class="post-time small text-muted">10th December 2008 10:53 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Hi LoRd_MuldeR again!<br>
      <br>
      Map implemetation is nice. However, I'd like to have more functions (simillar to List object - e.g. Count, First, Last and so on).<br>
      <br>
      Do you think that you'll add these functionalities or should I DIY?</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">pospec</span><br>
      <span class="post-time small text-muted">10th December 2008 12:06 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Another question - documentation reads following:<br>
      <i>${List.Unload} (...) This function will unload the NSISList plugin, destroy ALL lists including all of their items and release all memory used by NSISList.</i><br>
      <br>
      Do I have to call List.Destroy then? It seems that calling List.Unload once for an instance is enough.</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">mattm591</span><br>
      <span class="post-time small text-muted">27th May 2009 15:33 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Thanks for this plugin, the map support is very useful.<br>
      <br>
      I just have a couple of queries/requests.<br>
      <br>
      Firstly, is there a way I can get this plugin to send error messages to a variable instead of displaying a message box.<br>
      <br>
      Secondly, is there a way I can test to see if a map is already created. I create one in a function that needs to be available in other functions, but if a page is returned to it tries to recreate the map which causes an error box to appear.<br>
      <br>
      If there is a way to do the first thing I guess that would solve the second thing as I could just check the error message after calling create.</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">LoRd_MuldeR</span><br>
      <span class="post-time small text-muted">28th May 2009 19:08 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"></p>

      <blockquote>
        <i>Originally posted by pospec</i><br>
        <b>Hi LoRd_MuldeR again!<br>
        <br>
        Map implemetation is nice. However, I'd like to have more functions (simillar to List object - e.g. Count, First, Last and so on).<br>
        <br>
        Do you think that you'll add these functionalities or should I DIY?</b>
      </blockquote>A map is an unordered data structure. Elements are referenced via their keys. There is no "first" or "last" element.<br>
      Internally a map consists of two (ordered) lists, but you should not rely on that (internal) implementation!<br>
      <br>

      <blockquote>
        <i>Originally posted by pospec</i><br>
        <b>Another question - documentation reads following:<br>
        <i>${List.Unload} (...) This function will unload the NSISList plugin, destroy ALL lists including all of their items and release all memory used by NSISList.</i><br>
        <br>
        Do I have to call List.Destroy then? It seems that calling List.Unload once for an instance is enough.</b>
      </blockquote>Calling it once is sufficient. ALL your lists (and maps) will be gone.<br>
      <br>
      <br>

      <blockquote>
        <i>Originally posted by mattm591</i><br>
        <b>Thanks for this plugin, the map support is very useful.<br>
        <br>
        I just have a couple of queries/requests.<br>
        <br>
        Firstly, is there a way I can get this plugin to send error messages to a variable instead of displaying a message box.</b>
      </blockquote>This is not implemented. But when using the Plugin properly, you should not encounter any error messages.<br>
      The error messages are intended to indicate serious problems to NSIS developers...<br>
      <br>

      <blockquote>
        <i>Originally posted by mattm591</i><br>
        <b>Thanks for this plugin, the map support is very useful.<br>
        <br>
        Secondly, is there a way I can test to see if a map is already created. I create one in a function that needs to be available in other functions, but if a page is returned to it tries to recreate the map which causes an error box to appear.<br>
        <br>
        If there is a way to do the first thing I guess that would solve the second thing as I could just check the error message after calling create.</b>
      </blockquote>No you can't. Make sure you create the map only once!<br>
      <br>
      For example use the .onInit function to create all lists/maps that are referenced on the global scope.<br>
      You can also use a global var to check whether the map was already created...
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">valentin.istrate</span><br>
      <span class="post-time small text-muted">20th March 2013 11:25 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>NSISList Unicode</strong><br>
      Hello,<br>
      <br>
      I created a new NSISList DLL which works with NSIS Unicode. I needed NSISList it for one of my projects but I saw that it doesn't work with Unicode strings.<br>
      <br>
      The attachment contains the source code and DLL. The project is compiled using Delphi 2007 Professional. I didn't change the Lazarus sources.</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">MSG</span><br>
      <span class="post-time small text-muted">20th March 2013 12:18 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Thanks for sharing! Could you add it to the wiki page, too?</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">valentin.istrate</span><br>
      <span class="post-time small text-muted">20th March 2013 12:25 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">If LoRd_MuldeR agrees, I will do that. I'm waiting for a PM reply</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">MSG</span><br>
      <span class="post-time small text-muted">20th March 2013 13:49 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">The wiki is for everyone, please add it. As long as you don't claim credit for the original work, there's no reason not to.</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">LoRd_MuldeR</span><br>
      <span class="post-time small text-muted">20th March 2013 16:07 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"></p>

      <blockquote>
        <small>Originally posted by valentin.istrate</small><br>
        If LoRd_MuldeR agrees, I will do that. I'm waiting for a PM reply
      </blockquote>Sure. Thanks for making a Unicode version!<br>
      <br>
      I could not make a Unicode version, because I only own a license for Delphi 7.0, which is a lost case for Unicode support (yeah, there is a WideString type, but almost all VCL classes don't support it, so you'd have to re-write the complete VCL).
    </div>
    <hr>

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script type="text/javascript" src="../js/highlight.pack.js" async>
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]></script></body></html>