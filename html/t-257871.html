<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="Howto add Timestamp to outfile?" />

  <title>Howto add Timestamp to outfile? - NSIS Forums</title>
  <script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script>
  <!-- Bootstrap core CSS -->

  <link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css" />
  <link rel="stylesheet" href="../css/style.css" type="text/css" /><!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!--[if lt IE 9]>
                <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
                <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->
</head>

<body>
  <div class="container">
    <!-- Put navigation bar here -->

    <ol class="breadcrumb">
      <li><a href="../index.html" class="glyphicon glyphicon-home"></a></li>

      <li><a href="f-65.html">NSIS Discussion</a></li>

      <li class="active">Howto add Timestamp to outfile?</li>
    </ol>

    <p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=257871">Howto add Timestamp to outfile?</a></p><br />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">helios73</span><br />
      <span class="post-time small text-muted">19th October 2006 10:13 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>Howto add Timestamp to outfile?</strong><br />
      Hello,<br />
      <br />
      I want to generate the outfile more dynamically by adding a timestamp like MMDDYY_HHMM.<br />
      <br />
      Searching the doc I found __DATE__, __TIME__ and __TIMESTAMP__. __DATE__ works but if I add the __TIME__ information the filename is not writeable because of the ':' char.<br />
      <br />
      Can someone give me some code for this task?<br />
      <br />
      Regards,<br />
      <br />
      Michael</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
      <span class="post-time small text-muted">20th October 2006 10:32 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">You can create a program that'd create a file with a date in it. Execute this program using !system and then !include the file it creates.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">helios73</span><br />
      <span class="post-time small text-muted">20th October 2006 11:10 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Thanks kichik, but that is not what I'm looking for. I already have some time information inside the NSIS archive but I want to distinct the generated NSIS archives by their names and therefore I need something like a timestamp in the filename.<br />
      <br />
      Regards,<br />
      <br />
      Michael</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
      <span class="post-time small text-muted">20th October 2006 11:24 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">The generated file can have something like:</p>
      <pre>
<code>!define MYTIMESTAMP "something smoething"</code>
</pre>You can then use that define with OutFile:
      <pre>
<code>OutFile "my-setup-${MYTIMESTAMP}.exe"</code>
</pre>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">helios73</span><br />
      <span class="post-time small text-muted">22nd October 2006 17:23 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Thank you kichik for the hint.<br />
      <br />
      I added the following code to my ant build script:<br />
      <br />
      ...<br />
      &lt;tstamp/&gt;<br />
      &lt;echo file="${nsis.dir}\OutfileTimestamp.nsh" append="false"&gt;!define MYTIMESTAMP "${DSTAMP}_${TSTAMP}"<br />
      &lt;/echo&gt;<br />
      ...<br />
      <br />
      <br />
      and to the nsi script I added:<br />
      <br />
      ...<br />
      !include OutfileTimestamp.nsh<br />
      OutFile "setup_${PRODUCT_NAME}_${PRODUCT_VERSION}_${MYTIMESTAMP}.exe"<br />
      ...<br />
      <br />
      Regards,<br />
      <br />
      Michael</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">mutantbc</span><br />
      <span class="post-time small text-muted">27th February 2007 02:17 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Hi,<br />
      <br />
      I am having problem when renaming the file to output a filename with datetime.<br />
      <br />
      1.) i was able to create a file without datetime e.g. myfile.dat<br />
      2.) i was able to rename myfile.dat to myfile-101109 27 Feb, 2007.dat<br />
      3.) i cant rename the myfile.dat anymore, why?<br />
      <br />
      !define /date DATE "%H:%M:%S %d %b, %Y"<br />
      <br />
      IfFileExists $MyFilePath lbl_backupFile lbl_end<br />
      lbl_backupFile:<br />
      Rename $MyFiletPath "$R9\backup\myfile-${DATE}.dat"<br />
      lbl_end:<br />
      ...exit the program</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">pengyou</span><br />
      <span class="post-time small text-muted">27th February 2007 10:49 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"></p>

      <blockquote>
        i cant rename the myfile.dat anymore, why?
      </blockquote>Your code is trying to use an invalid name when it renames the file.<br />
      <br />
      Instead of using a name like "myfile-101109 27 Feb, 2007.dat", your code tries to rename the file to something like "myfile-10:38:36 27 Feb, 2007.dat"<br />
      <br />
      Try changing<br />
      <br />
      !define /date DATE "%H:%M:%S %d %b, %Y"<br />
      <br />
      to<br />
      <br />
      !define /date DATE "%H-%M-%S %d %b, %Y"<br />
      <br />
      so your code will rename the file to something like "myfile-10-42-06 27 Feb, 2007.dat"
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">mutantbc</span><br />
      <span class="post-time small text-muted">28th February 2007 00:53 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">I have tried that, but still step 3 doesnt work. I dont know why, step 1 and 2 are working ok.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">mutantbc</span><br />
      <span class="post-time small text-muted">1st March 2007 08:03 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">any help on this one?</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
      <span class="post-time small text-muted">1st March 2007 19:23 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Are you sure that's really what you want to do? DATE will contain the date when you compiled the installer and not the current date on the user's machine... You should get the date at runtime using one of the <a href="http://nsis.sourceforge.net/Special:Search?search=date" target="_blank">available functions</a>.<br />
      <br />
      As for the renaming issue, did you create the backup folder first?</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">ChrisMorton75</span><br />
      <span class="post-time small text-muted">21st March 2007 20:09 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>syntax information</strong><br />
      It's hard to search for special characters for an explanation of how they are used.<br />
      Can someone explain the use of the forward-slash in<br />
      !define /date DATE "%H:%M:%S"<br />
      <br />
      Is /date calling an NSIS command or an OS command (and if so why isn't "!system" used ) ?</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
      <span class="post-time small text-muted">21st March 2007 20:58 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">/date is a switch for the !define command.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Red Wine</span><br />
      <span class="post-time small text-muted">21st March 2007 20:58 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><a href="http://nsis.sourceforge.net/Docs/Chapter5.html#5.4.1" target="_blank">http://nsis.sourceforge.net/Docs/Chapter5.html#5.4.1</a></p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">ChrisMorton75</span><br />
      <span class="post-time small text-muted">21st March 2007 21:03 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">thanks for the information</p>
    </div>
    <hr />

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]>
  </script>
</body>
</html>
