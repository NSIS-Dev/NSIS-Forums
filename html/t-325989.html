<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="Help with RequestExecutionLevel" />

  <title>Help with RequestExecutionLevel - NSIS Forums</title>
  <script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script>
  <!-- Bootstrap core CSS -->

  <link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css" />
  <link rel="stylesheet" href="../css/style.css" type="text/css" /><!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!--[if lt IE 9]>
                <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
                <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->
</head>

<body>
  <div class="container">
    <!-- Put navigation bar here -->

    <ol class="breadcrumb">
      <li><a href="../index.html" class="glyphicon glyphicon-home"></a></li>

      <li><a href="f-65.html">NSIS Discussion</a></li>

      <li class="active">Help with RequestExecutionLevel</li>
    </ol>

    <p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=325989">Help with RequestExecutionLevel</a></p><br />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">beaglelander</span><br />
      <span class="post-time small text-muted">15th January 2011 10:05 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>Help with RequestExecutionLevel</strong><br />
      Hi, I was hoping someone might be able to assist with a query I have relating to the RequestExecutionLevel command...<br />
      <br />
      To summarise, I have a NSIS .exe which is used to launch a Java application which accesses data in a MS Access database. Currently I have it set to RequestExecutionLevel admin, but users are complaining that they get the "Do you want to allow the following program to make changes to this computer" UAC security message every time they run the application, which I can understand will get annoying after a while. So, what I've done is set it to 'RequestExecutionLevel user', and this has worked in that it has got rid of the security message, but something weird then happens; it seem when the program is run for the first time with the 'user' right, the MS Access database is copied from the c:\program files folder to C:\users\John Doe\AppData\Local\VirtualStore\Program Files\MyApp\<br />
      <br />
      I'm kinda split on whether this is good or not; it's good because it means every user that is setup on that computer will have their own settings. However, I can forsee that a problem will occur if the user buys a license and enters the key only for their user version and no one elses because the Access DB is no longer shared, when really I'd want all user's version to be regsitered. Our license key can only be used once you see.<br />
      <br />
      So I guess my question is, is there a way of getting rid of the "Do you want to allow the following program to make changes to this computer" message, but not using the logged in user's VirtualStore, and instead just using the one in c:\program files\ edition of the data?<br />
      <br />
      Many thanks,<br />
      <br />
      BL</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">MSG</span><br />
      <span class="post-time small text-muted">15th January 2011 11:56 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"></p>

      <blockquote>
        <small>Originally posted by beaglelander</small><br />
        So I guess my question is, is there a way of getting rid of the "Do you want to allow the following program to make changes to this computer" message, but not using the logged in user's VirtualStore, and instead just using the one in c:\program files\ edition of the data?
      </blockquote>Short answer: No. If you want to do something for all users, you must require admin access.<br />
      <br />
      Long answer: You can use the accesscontrol plugin to give write access to all users, but you should not do this. Write-protected folders are protected for a reason.
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">beaglelander</span><br />
      <span class="post-time small text-muted">15th January 2011 13:20 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">hmmmm, not the answer i was hoping for. I guess I need to weigh things up.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">MSG</span><br />
      <span class="post-time small text-muted">15th January 2011 14:00 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">About the registration thing, you could make your application start a new process as admin, and have that process write the registration info. This means that your app can only be registered by admins, but at least people can use the software without admin access.</p>
    </div>
    <hr />

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]>
  </script>
</body>
</html>
