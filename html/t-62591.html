<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="Net Based?" />

  <title>Net Based? - NSIS Forums</title><!-- Bootstrap core CSS -->
  <link rel="stylesheet" type="text/css" href="//netdna.bootstrapcdn.com/bootswatch/3.0.1/readable/bootstrap.min.css" />
  <link rel="stylesheet" href="../css/style.css" type="text/css" /><!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!--[if lt IE 9]>
                <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
                <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->
</head>

<body>
  <div class="container">
    <!-- Put navigation bar here -->

    <ol class="breadcrumb">
      <li><a href="../index.html" class="glyphicon glyphicon-home"></a></li>

      <li><a href="f-65.html">NSIS Discussion</a></li>

      <li class="active">Net Based?</li>
    </ol>

    <p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=62591">Net Based?</a></p><br />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">phre0n</span><br />
      <span class="post-time small text-muted">14th October 2001 20:27 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>Net Based?</strong><br />
      Ok bare with me.<br />
      <br />
      Is there anyway or is there ever going to be a way to do web based install.<br />
      <br />
      Example<br />
      create the installer with some sort or ftp command built in.<br />
      <br />
      I would like it to connect to my server with an already set name and passwrd then copy all the contents of the folder and maby know if there is anything new in the folder.<br />
      <br />
      I am not that great with c\c++. Or I would add it myself if it doesn't already exist.<br />
      <br />
      But I think that would be a great feature.<br />
      <br />
      Another good one would be passwrd required for install like a registration number.<br />
      <br />
      Thank you for baring with me.<br />
      <br />
      Please reply with anything that would help including how to add the source code my self to make the thing do what I would like.<br />
      <br />
      phre0n<br />
      <a href="http://linux.ppp0.com" target="_blank">http://linux.ppp0.com</a> &lt;-Curently down</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">DuaneJeffers</span><br />
      <span class="post-time small text-muted">14th October 2001 22:43 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">I wanted to create something like this, with an IDE, and it would be able to have "live updating" or patch updating. But Who knows.<br />
      <br />
      <br />
      -Duane</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">prodangle</span><br />
      <span class="post-time small text-muted">15th October 2001 00:26 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Edgewize has made something which helps do the job. It's at <a href="http://scorpius.spaceports.com/~edgewize/" target="_blank">http://scorpius.spaceports.com/~edgewize/</a><br />
      <br />
      It's impossible to do version checks on dlls on the web without downloading them first (so you can't only download DLL's if neccessary) - but if that's not what you'll be using it for then i'd say it's tip top.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">phre0n</span><br />
      <span class="post-time small text-muted">15th October 2001 00:43 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">That should work but I think i will modify it some.<br />
      <br />
      One more how do you force a reboot.<br />
      i tried C:\windows\rundll.exe user.exe,exitwindowsexec doesn't work in ME<br />
      C:\windows\rundll.exe user.exe,exitwindows does shut it down but not what i want<br />
      <br />
      thanks for the help.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">pjw62</span><br />
      <span class="post-time small text-muted">15th October 2001 18:42 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">You could have the program check the last modified stamp in the HTTP header when downloading.. or download a preliminary text file with the version numbers in. I personally hate installers like 'Wise' that you download once and then have to connect to the internet to download the install files. It is extrememly frustrating when the internet is unavailable at later times for whatever reason.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">prodangle</span><br />
      <span class="post-time small text-muted">15th October 2001 18:58 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"></p>

      <blockquote>
        <i>Originally posted by pjw62</i><br />
        <b>You could have the program check the last modified stamp in the HTTP header when downloading.. or download a preliminary text file with the version numbers in. I personally hate installers like 'Wise' that you download once and then have to connect to the internet to download the install files. It is extrememly frustrating when the internet is unavailable at later times for whatever reason.</b>
      </blockquote>It would need to get the version number of the component, as the last modified stamp doesn't really mean anything. According to Edgewize it's damn difficult to compare the version number of DLL's on your system to numbers specified in a script (saying which DLLs should be there, and downloading if neccessary) so that's why his component doesn't do it.<br />
      <br />
      If this could be made to work, downloading only the parts of programs the user hasn't already got could save most folks a lot of download time though.
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">phre0n</span><br />
      <span class="post-time small text-muted">15th October 2001 19:11 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">That is the effect I am going for. Just to get the newer parts to something they may already have. I made one that used the reading and writing of ini files. I made an ini in the folder and put the version numbers and downloads they may need in it. Then had it get the ini first then compare to the one they already have. Then download it if it was different. My NSI is a cluster f*ck that way but it seems to be doing fine. Thanks for all the help. But I still can't figure how to force a reboot.<br />
      <br />
      Also has anyone thought of making NSIS cross platform that would be nice for linux users like myself.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">pjw62</span><br />
      <span class="post-time small text-muted">15th October 2001 19:13 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">well ermm, what about writing a PERL/PHP/C proggy that the user can install on their webserver that returns the version of a given dll ? (From the version section of the pe).<br />
      <br />
      it was only a suggestion :)</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Pomflain</span><br />
      <span class="post-time small text-muted">15th October 2001 19:23 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>Will it do the following?</strong><br />
      Does it allow you to do an easy check for the file and then give you the option to update? For example, when you run the installer, it will check the specified URL for a filename and then return the filesize and timestamp so you can comare it to the current installer. Something like that, then you can inform the user about the new version if it is detected.<br />
      <br />
      If not does anyone have some scripting that will do that? I think it would be kind of cool.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">liquidmotion</span><br />
      <span class="post-time small text-muted">16th October 2001 20:48 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">you can always have the installer download a .txt file with the dll versions in it, check the file, then download if necessary.<br />
      <br />
      bye,</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Pomflain</span><br />
      <span class="post-time small text-muted">17th October 2001 23:21 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>There's no dll versions...</strong><br />
      I want to be able to check a file on the site, the actual installer itself.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">phre0n</span><br />
      <span class="post-time small text-muted">17th October 2001 23:28 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">That is what i had to do with the ini file.<br />
      make an ini that goes with the program.<br />
      make it look something like this<br />
      <br />
      [program_name]<br />
      version=1.1<br />
      <br />
      then make a section called update.<br />
      have it down load the ini<br />
      compare version's string with the ini that is already with it.<br />
      if diferent have it download<br />
      there you have it.<br />
      <br />
      if some one really wants i am good with perl i will right a script to check dll versions and have it where you could run it via cgi.<br />
      <br />
      thanks<br />
      phre0n<br />
      <br />
      <a href="http://linux.ppp0.com" target="_blank">http://linux.ppp0.com</a> &lt;- Still down</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">prodangle</span><br />
      <span class="post-time small text-muted">18th October 2001 01:58 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">According to Edgewise, the problem comes with having NSIS compare a DLL version already on the user's system to a given number. Apparently it's easy to compare 2 DLLs on the system against each other, but not one against a version number. In his words (I'm sure he won't mind me posting this),<br /></p>

      <blockquote>
        Right now, there is no simple way to check DLL versions against a number or string that you would put in a script. The version-resource API was designed from the ground up to frustrate programmers, it seems, and its a little trickier than I'd like it to be. So the short answer for you is, no there's no way to do this now.
      </blockquote>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Edgewize</span><br />
      <span class="post-time small text-muted">18th October 2001 08:11 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Hrm, I must correct myself here. What I was expressing before was a combination of frustrations with the Win32 API, Justin's EXEHEAD script parsing, and the CompareDLLVersions command. With the new numeric variables, this should be quite feasable.<br />
      <br />
      But since Justin is on the upside of another manic NSIS swing, I'm leaving the code alone until he cools down a bit ;)</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">justin</span><br />
      <span class="post-time small text-muted">18th October 2001 08:37 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"></p>

      <blockquote>
        <i>Originally posted by Edgewize</i><br />
        <b>Hrm, I must correct myself here. What I was expressing before was a combination of frustrations with the Win32 API, Justin's EXEHEAD script parsing, and the CompareDLLVersions command. With the new numeric variables, this should be quite feasable.<br />
        <br />
        But since Justin is on the upside of another manic NSIS swing, I'm leaving the code alone until he cools down a bit ;)</b>
      </blockquote>Heh I am so obsessive. Here's what's coming in 1.60 (due this weekend):<br />

      <ul>
        <li>Improved CopyFiles some (added /SILENT option)</li>

        <li>Added FindFirst, FindNext, FindClose.</li>

        <li>Added FileOpen, FileClose, FileSeek, FileRead, FileWrite (text file manipulation yay)</li>

        <li>Improved GCC compatibility (using some of Nels' suggestions)</li>

        <li>Made config.h options more granular.</li>

        <li>Cleaned up lots of code.</li>

        <li>Broke lots of code, I'm sure.</li>
      </ul><br />
      Right now with all features enabled, the exehead is exactly 36kb. Having the file i/o and directory scanning code is nice, too.<br />
      There will probably be more suprises as well.<br />
      <br />
      -Justin
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">spanky</span><br />
      <span class="post-time small text-muted">18th October 2001 08:48 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">ahem. not to sound gay or anything but..<br />
      Justin, I love you.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">prodangle</span><br />
      <span class="post-time small text-muted">18th October 2001 09:04 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"></p>

      <blockquote>
        <i>What I was expressing before was a combination of frustrations with the Win32 API, Justin's EXEHEAD script parsing, and the CompareDLLVersions command. With the new numeric variables, this should be quite feasable.<br />
        <br />
        But since Justin is on the upside of another manic NSIS swing, I'm leaving the code alone until he cools down a bit ;)</i>
      </blockquote>Oh... sorry folks :D :D
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">phre0n</span><br />
      <span class="post-time small text-muted">18th October 2001 23:31 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">I am looking forward to the text file manipulation that will be nice. And help a bunch in my work. keep up the good work justin.<br />
      <br />
      thanks,<br />
      Michael Garcia<br />
      <br />
      <a href="http://linux.ppp0.com" target="_blank">http://linux.ppp0.com</a> &lt;-- Damn thing is still down.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Someonebutnotme</span><br />
      <span class="post-time small text-muted">19th October 2001 21:07 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">heh, Justin's on a role with nsis updates again. its nice.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">prodangle</span><br />
      <span class="post-time small text-muted">20th October 2001 15:54 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Now this looks exciting:<br />
      <br />
      from NSIS 1.60 beta whatsnew-<br />
      ...<br />
      Added FileOpen, FileClose, FileSeek, FileRead, FileWrite (text file manipulation yay)<br />
      ...<br />
      Removed CompareDLLVersions, CompareFileTimes, added GetDLLVersion, GetFileTime, GetDLLVersionLocal, GetFileTimeLocal, and IntCmpU.<br />
      ...</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Edgewize</span><br />
      <span class="post-time small text-muted">20th October 2001 21:39 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>Edgewize</strong><br />
      Well that solves the DLL version-test problem for good, I think :)<br />
      <br />
      GetDLLVersion on the downloaded file, GetDLLVersion on the Windows\System file, compare with IntCmpU, and replace as necessary.<br />
      <br />
      I like the direction NSIS scripting is headed :D</p>
    </div>
    <hr />

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]>
  </script>
</body>
</html>
