<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="Copying some files from the installation directory to SysWow64 or system32" />

  <title>Copying some files from the installation directory to SysWow64 or system32 - NSIS Forums</title>
  <script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script>
  <!-- Bootstrap core CSS -->

  <link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css" />
  <link rel="stylesheet" href="../css/style.css" type="text/css" /><!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!--[if lt IE 9]>
                <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
                <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->
</head>

<body>
  <div class="container">
    <!-- Put navigation bar here -->

    <ol class="breadcrumb">
      <li><a href="../index.html" class="glyphicon glyphicon-home"></a></li>

      <li><a href="f-65.html">NSIS Discussion</a></li>

      <li class="active">Copying some files from the installation directory to SysWow64 or system32</li>
    </ol>

    <p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=341810">Copying some files from the installation directory to SysWow64 or system32</a></p><br />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">noemig</span><br />
      <span class="post-time small text-muted">6th February 2012 20:43 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>Copying some files from the installation directory to SysWow64 or system32</strong><br />
      Hello,<br />
      <br />
      I am trying to copy some files from the installation directory to SysWow64 or system32, depending is the OS is 32 or 64.<br />
      <br />
      The code is written as :<br />
      <br />
      Section "DLL"<br />
      <br />
      ${If} ${RunningX64}<br />
      <br />
      SetOutPath "$WINDIR\SysWOW64"<br />
      DetailPrint "Installer running on 64-bit host"<br />
      File /r "DFORMD.DLL"<br />
      File /r "DFORRT.DLL"<br />
      File /r "Expsrv.dll"<br />
      File /r JETCOMP.exe<br />
      <br />
      ${Else}<br />
      <br />
      SetOutPath "$WINDIR\System32"<br />
      File /r "DFORMD.DLL"<br />
      File /r "DFORRT.DLL"<br />
      File /r "Expsrv.dll"<br />
      File /r "JETCOMP.exe"<br />
      <br />
      ${EndIf}<br />
      <br />
      <br />
      SectionEnd<br />
      <br />
      The installer is copying the entire folder that contains those DLL from the installation directory to SYSWOW64 or System32.<br />
      <br />
      Can somebody give me a clue on how to solve this ?<br />
      <br />
      Thanks.<br />
      <br />
      noemig</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">msroboto</span><br />
      <span class="post-time small text-muted">6th February 2012 21:33 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Are you resetting the outputpath after doing this?<br />
      If not whatever files you lay down will go there.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">noemig</span><br />
      <span class="post-time small text-muted">6th February 2012 22:36 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>Copying some files from the installation directory to SysWow64 or system32</strong><br />
      Yes, I am resetting the outhpath using the instruction SetOutPath .<br />
      <br />
      The issue that I am facing is is that instead of copying the dll from the installation directory to the indicated folder. The installer is copying the entire folder where the dll files are located to the indicated folder ($WINDIR\SysWOW64 or $WINDIR\System32).<br />
      <br />
      Thanks for your reply.<br />
      <br />
      noemig</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">demiller9</span><br />
      <span class="post-time small text-muted">6th February 2012 23:08 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Why do you use the /r switch?</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">noemig</span><br />
      <span class="post-time small text-muted">6th February 2012 23:23 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">The installer have to find the files between the folders directories.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Anders</span><br />
      <span class="post-time small text-muted">7th February 2012 00:34 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Installing files in %windir% is evil, don't do it please!<br />
      <br />
      If you always want to install files in the 32bit system32 folder you can just pretend that x64 does not exist and just install in $sysdir and the windows filesystem redirection will take care of the rest...</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">noemig</span><br />
      <span class="post-time small text-muted">7th February 2012 01:58 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>Copying some files from the installation directory to SysWow64 or system32</strong><br />
      Thank you, I will try to install them on the $sysdir. Can you give me a hint why the installer is copying the entire folder instead of the corresponding files?</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">MSG</span><br />
      <span class="post-time small text-muted">7th February 2012 08:23 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"></p>

      <blockquote>
        <small>Originally posted by noemig</small><br />
        Thank you, I will try to install them on the $sysdir. Can you give me a hint why the installer is copying the entire folder instead of the corresponding files?
      </blockquote>This is because you're using the /r switch. You can read about it here: <a href="http://nsis.sourceforge.net/Docs/Chapter4.html#4.9.1.5" target="_blank">http://nsis.sourceforge.net/Docs/Chapter4.html#4.9.1.5</a>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">noemig</span><br />
      <span class="post-time small text-muted">7th February 2012 17:01 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>Copying some files from the installation directory to SysWow64 or system32</strong><br />
      Now I understand. Thank you for your reply</p>
    </div>
    <hr />

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]>
  </script>
</body>
</html>
