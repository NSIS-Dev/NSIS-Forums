<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="description" content="Q: Does NSIS support RunAs credentials and Silent installs?"><title>Q: Does NSIS support RunAs credentials and Silent installs? - NSIS Forums</title><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script><link rel="preload" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css" as="style" onload="this.rel='stylesheet'"><link rel="preload" href="../css/style.css" as="style" onload="this.rel='stylesheet'"><noscript><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css"><link rel="stylesheet" href="../css/style.css"></noscript><script>!function(a){"use strict";var b=function(b,c,d){function e(a){return h.body?a():void setTimeout(function(){e(a)})}function f(){i.addEventListener&&i.removeEventListener("load",f),i.media=d||"all"}var g,h=a.document,i=h.createElement("link");if(c)g=c;else{var j=(h.body||h.getElementsByTagName("head")[0]).childNodes;g=j[j.length-1]}var k=h.styleSheets;i.rel="stylesheet",i.href=b,i.media="only x",e(function(){g.parentNode.insertBefore(i,c?g:g.nextSibling)});var l=function(a){for(var b=i.href,c=k.length;c--;)if(k[c].href===b)return a();setTimeout(function(){l(a)})};return i.addEventListener&&i.addEventListener("load",f),i.onloadcssdefined=l,l(f),i};"undefined"!=typeof exports?exports.loadCSS=b:a.loadCSS=b}("undefined"!=typeof global?global:this);!function(a){if(a.loadCSS){var b=loadCSS.relpreload={};if(b.support=function(){try{return a.document.createElement("link").relList.supports("preload")}catch(b){return!1}},b.poly=function(){for(var b=a.document.getElementsByTagName("link"),c=0;c<b.length;c++){var d=b[c];"preload"===d.rel&&"style"===d.getAttribute("as")&&(a.loadCSS(d.href,d,d.getAttribute("media")),d.rel=null)}},!b.support()){b.poly();var c=a.setInterval(b.poly,300);a.addEventListener&&a.addEventListener("load",function(){b.poly(),a.clearInterval(c)}),a.attachEvent&&a.attachEvent("onload",function(){a.clearInterval(c)})}}}(this);</script></head><body><div class="container"><ol class="breadcrumb"><li><a href="../index.html" class="glyphicon glyphicon-home"></a></li><li><a href="f-65.html">NSIS Discussion</a></li><li class="active">Q: Does NSIS support RunAs credentials and Silent installs?</li></ol><p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=208497">Q: Does NSIS support RunAs credentials and Silent installs?</a></p><br><div class="post"><p class="post-meta"><span class="post-author text-primary">masken</span><br><span class="post-time small text-muted">22nd February 2005 09:22 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>Q: Does NSIS support RunAs credentials and Silent installs?</strong><br>Network admins (as me) working in MS domain environments almost always have users that aren't local administrators (for obvious reasons).<br><br>We normally handle installations and patch management through Active Directory or some other solution (SMS for example), with MSI/MSP packages.<br><br>Sometimes though, it is desired to have standalone installers that can be distributed with CD's etc. Since the users doesn't have local admin rights, does the NSIS support RunAs? Ie, can a designated user account be coded into the NSIS package so that it runs with a different accounts? And if so, how well is the provided credentials encrypted?<br><br>Also, can the installer be made totally silent, so it only displays a progress bar after a double-click?</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">kichik</span><br><span class="post-time small text-muted">22nd February 2005 18:25 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">There is no built-in support for such credentials. Personally, I think the risks of giving administrator access with one breakpoint by far exceed the gain of not having to type the password yourself. The only way I see of avoiding this problem is having a service ran by the system user which will verify the installer. I guess that's what MSIs with credentials do.<br><br>To run an installer silently, use the /S command line switch or the SilentInstall command in the script. To make it just show the progress bar, simply remove the unrequired pages from the script. You can also add a command line control switch that will cause every page pre function to call Abort to skip the page.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">masken</span><br><span class="post-time small text-muted">22nd February 2005 22:04 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Agreed, providing credentials with a file isn't the safest way, even if encrypted.<br><br>But there are options to minimize the effects of this, for example, you can specify a domain account that times out after the installation, or a local account with administrative purposes (which you could centrally script the creation of for example). You can then have your own code within the script to delete that accout once done with the installation.<br><br>Most important is to have the <i>option</i> there ;) Almost every company - small as well as large - has come to terms with the fact that you shouldn't run your Windows-based PC with administrative rights unless you're installing software that requires elevated permissions (and not even then - use RunAs). Even many talented home-users have realized this fact. This realizes the need for installers that supports running under specified credentials :)</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">kichik</span><br><span class="post-time small text-muted">24th February 2005 18:51 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">The effect of giving a user administrative access, even if temporarily, is too destructive. You are not only giving the user the option to control a fully granted process, you are also giving away the user name and the password. Even if you encrypt the user and the password, the key will have to be contained in the installer along with the encrypted data. It doesn't matter if the installer might be set to delete that user when it's done as the user doesn't even need to run the installer.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">masken</span><br><span class="post-time small text-muted">25th February 2005 23:40 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">yes yes, I've already answered that. There's ways to control this fairly good, wtih time-limited, logon-count limited accounts for example. Main point is to have the option there. This is something wanted by thousands of network admins, and something only available in expensive packagers as WISE etc...<br><br>In other words, a really useful and wanted feature.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">kichik</span><br><span class="post-time small text-muted">25th February 2005 23:43 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">I have no intention of implementing such a flawed method. If you have a better idea, I'll consider it. But saving the user name and the password in the installer is unaccepted.<br><br>If you're willing to put up with the flaws, you can create a batch file that will execute runas.exe.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">fredhof</span><br><span class="post-time small text-muted">12th October 2005 15:57 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>RunAs</strong><br>There is always the application TQCrunas from the Quimeras Company (<a href="http://www.quimeras.com" target="_blank">http://www.quimeras.com</a>)...<br><br>However, we're having some challenges in getting it to work in a multi-installer package...</p></div><hr><div class="footer"><p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p></div></div><script type="text/javascript" src="../js/highlight.pack.js" async></script><script type="text/javascript">//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]></script></body></html>