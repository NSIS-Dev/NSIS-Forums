<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="description" content="ExecWait with a BitRock uninstaller"><title>ExecWait with a BitRock uninstaller - NSIS Forums</title><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script><link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css"><link rel="stylesheet" href="../css/style.css" type="text/css"></head><body><div class="container"><ol class="breadcrumb"><li><a href="../index.html" class="glyphicon glyphicon-home"></a></li><li><a href="f-65.html">NSIS Discussion</a></li><li class="active">ExecWait with a BitRock uninstaller</li></ol><p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=323879">ExecWait with a BitRock uninstaller</a></p><br><div class="post"><p class="post-meta"><span class="post-author text-primary">Keabard</span><br><span class="post-time small text-muted">8th November 2010 13:16 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>ExecWait with a BitRock uninstaller</strong><br>Hi,<br><br>I've read several posts on these forums about the ExecWait instruction in the "Uninstall" section. Unfortunately, the uninstall.exe I try to launch with ExecWait is not on this list :<br><br><a href="http://unattended.sourceforge.net/installers.php" target="_blank">http://unattended.sourceforge.net/installers.php</a><br><br>As you may have guessed, in my "Uninstall" section, I try to run an uninstaller made with BitRock :<br><br>ExecWait '"$INSTDIR\uninstall.exe" --mode unattended'<br><br>The "--mode unattended" makes the uninstaller not prompting a "Yes/No" question, and pops several DOS consoles in the background that do their jobs.<br><br>However, ExecWait does not wait, the next instructions are being executed while the DOS consoles do their jobs too.<br><br>What could I do ?<br><br>Thank you,</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Anders</span><br><span class="post-time small text-muted">8th November 2010 13:29 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">ExecWait ALWAYS waits for its child process.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Animaether</span><br><span class="post-time small text-muted">8th November 2010 13:35 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Unfortunately if ExecWait doesn't appear to actually wait, it's usually because the program you launched, launched another process itself. This applies to NSIS as well; <a href="http://nsis.sourceforge.net/When_I_use_ExecWait_uninstaller.exe_it_doesn%27t_wait_for_the_uninstaller" target="_blank">http://nsis.sourceforge.net/When_I_u...he_uninstaller</a><br><br>As you can see from that page.. NSIS has an option in place to disable this mechanism. I skipped the BitRock FAQ, but didn't see anything similar in there.. but you could have a look around or ask the developers.<br><br>If there isn't a built-in option, and the actual author didn't include an option either, you're usually left with rather hacky solutions. E.g. if you know what process it spawns, you could try checking for that process and only continue once that process is gone... or if you know the uninstaller removes a certain file last (having determined this by running the uninstaller and watching what it does with e.g. Process Monitor), then your uninstaller could check whether that file has been removed and only continue once it has been.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Keabard</span><br><span class="post-time small text-muted">17th November 2010 16:42 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">thanks for your answers.<br><br>Unfortunately, it seems i'm obliged to use hacky solutions. I do think i'm going to use the "CheckIfFileIsDeleted" one.<br><br>However... how can I tell my script to stop and to continue only once a certain file/directory is deleted ? I did not manage to find this info.<br><br>Thank you,</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br><span class="post-time small text-muted">17th November 2010 19:13 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"></p><pre>
<code>${DoWhile} ${FileExists} [path]<br>  Sleep 1000<br>${Loop}</code>
</pre>Or:
      <pre>
<code>${For} $R0 1 60<br>  Sleep 1000<br>  ${IfNot} ${FileExists} [path]<br>    ${Break}<br>  ${EndIf}<br>${Next}<br>${If} $R0 == 61<br>; oops, timeout<br>${EndIf}</code>
</pre>Stu
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Keabard</span><br>
      <span class="post-time small text-muted">18th November 2010 08:37 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Thank you Stu</p>
    </div>
    <hr>

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]></script></body></html>