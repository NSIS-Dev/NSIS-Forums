<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="description" content="NSIS run as admin!!!"><title>NSIS run as admin!!! - NSIS Forums</title><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script><link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css"><link rel="stylesheet" href="../css/style.css" type="text/css"></head><body><div class="container"><ol class="breadcrumb"><li><a href="../index.html" class="glyphicon glyphicon-home"></a></li><li><a href="f-65.html">NSIS Discussion</a></li><li class="active">NSIS run as admin!!!</li></ol><p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=323216">NSIS run as admin!!!</a></p><br><div class="post"><p class="post-meta"><span class="post-author text-primary">floydmovie</span><br><span class="post-time small text-muted">18th October 2010 13:49 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>NSIS run as admin!!!</strong><br>I need help by my NSIS project.<br><br>Is it possible for NSIS to be executed automatically as admin.<br><br>The problem is on Windows 7 and Vista, there is an error.<br><br>For my clients it is too complicated to run as Admin.<br><br><br>Thanks...<br><br><br>Grz Floydmovie</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">jpderuiter</span><br><span class="post-time small text-muted">18th October 2010 14:04 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><a href="http://lmgtfy.com/?q=NSIS+run+as+admin" target="_blank">NSIS run as admin</a></p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Wizou</span><br><span class="post-time small text-muted">18th October 2010 14:10 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">mmh in this case, Google doesn't give the first trivial answer to floydmovie's question:<br><br>Just use <b>RequestExecutionLevel admin</b> in your script and your users will be automatically prompted to let your installer run as admin.<br>No need of plugins for this.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">floydmovie</span><br><span class="post-time small text-muted">18th October 2010 14:34 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Thanks for the quick reply.<br><br>Can you do me a small example?</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Anders</span><br><span class="post-time small text-muted">18th October 2010 14:48 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"></p><blockquote><small>Originally posted by Wizou</small><br>Just use <b>RequestExecutionLevel admin</b> in your script and your users will be automatically prompted to let your installer run as admin.<br>No need of plugins for this.</blockquote>Sadly this is not true, RequestExecutionLevel is only half the job<br><br>See <a href="http://nsis.pastebin.com/63tS3AS2" target="_blank">http://nsis.pastebin.com/63tS3AS2</a> for a proper example.</div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Wizou</span><br><span class="post-time small text-muted">18th October 2010 16:42 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Oh, I thought floydmovie expected his installer to be run only on Windows 7 &amp; Vista. My bad.<br><br>Of course there can be problems with non-admin accounts on prior version of Windows, but floydmovie said he didn't have any problem on prior versions...<br><br>This is probably because 90% of users of these older versions of Windows have admin accounts.<br>If you want to deal with the 10% users left, you can use the link given by Anders for a solution.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Anders</span><br><span class="post-time small text-muted">18th October 2010 17:15 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"></p><blockquote><small>Originally posted by Wizou</small><br>Oh, I thought floydmovie expected his installer to be run only on Windows 7 &amp; Vista. My bad.<br><br>Of course there can be problems with non-admin accounts on prior version of Windows, but floydmovie said he didn't have any problem on prior versions...<br><br>This is probably because 90% of users of these older versions of Windows have admin accounts.<br>If you want to deal with the 10% users left, you can use the link given by Anders for a solution.</blockquote>Wrong again! On vista when UAC is off, RequestExecutionLevel has no effect!</div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Wizou</span><br><span class="post-time small text-muted">18th October 2010 17:57 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"></p><blockquote><small>Originally posted by Anders</small><br>Wrong again! On vista when UAC is off, RequestExecutionLevel has no effect!</blockquote>Ok, when UAC is off, and your account is non-admin, there is not much you can do anyway.. and the user probably already knows he can't install programs..<br>I have faced this case, and there is no possibility for an installer to obtain admin rights, even asking for a admin account.<br>So NSIS will fail anyway, sooner or later.<br>If you want to be nice, all you can do is detect this case and display a MessageBox saying "you're screwed!"<br><br><br>PS: Of course I'm not talking about programs that can be installed completely using user-only folder/registry</div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">MSG</span><br><span class="post-time small text-muted">18th October 2010 21:34 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"></p><blockquote><small>Originally posted by Wizou</small><br>If you want to be nice, all you can do is detect this case and display a MessageBox saying "you're screwed!"</blockquote>And that is exactly what you have to do, because otherwise the installer will fail halfway when trying to do something restricted to admin users, and the user will come complaining that your installer is broken.<br><br>Anders is absolute correct in his statements.</div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Wizou</span><br><span class="post-time small text-muted">20th October 2010 03:32 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Sure, and that's what I personally do in my own installers..<br>But I just don't expect every NSIS users to be ready to go to this extent of covering every cases, especially this (rare in my opinion) case of a non-admin users trying to install a program while UAC is disabled.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Anders</span><br><span class="post-time small text-muted">20th October 2010 12:06 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"></p><blockquote><small>Originally posted by Wizou</small><br>But I just don't expect every NSIS users to be ready to go to this extent of covering every cases, especially this (rare in my opinion) case of a non-admin users trying to install a program while UAC is disabled.</blockquote>They will if we tell them the correct way from the start.<br><br>Besides, the number of users still on XP is pretty high. Even if the first post only talks about Vista/7, you can assume that the same problem exists on NT4+ and that they have just not tested as non admins.</div><hr><div class="footer"><p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p></div></div><script src="../js/highlight.pack.js" type="text/javascript"></script><script type="text/javascript">//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]></script></body></html>