<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="description" content="Integrating NSIS with Visual Studio/MSBuild"><title>Integrating NSIS with Visual Studio/MSBuild - NSIS Forums</title><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script><link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css"><link rel="stylesheet" href="../css/style.css" type="text/css"></head><body><div class="container"><ol class="breadcrumb"><li><a href="../index.html" class="glyphicon glyphicon-home"></a></li><li><a href="f-65.html">NSIS Discussion</a></li><li class="active">Integrating NSIS with Visual Studio/MSBuild</li></ol><p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=325536">Integrating NSIS with Visual Studio/MSBuild</a></p><br><div class="post"><p class="post-meta"><span class="post-author text-primary">insertjokehere</span><br><span class="post-time small text-muted">5th January 2011 01:21 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>Integrating NSIS with Visual Studio/MSBuild</strong><br>Hi Guys,<br><br>Ive seen a few people asking about building NSIS installers with Visual Studio (MSBuild), so i whipped up a custom MSBuild task that should let you accomplish this.<br><br>Full source and an example is included in the attachment below, as well as a template for adding this to your own solution. just open template.vbproj, and edit as needed<br><br>NOTE: This took me about an hour to do. It hasnt been tested very thoroughly. It probably meets most definitions of the term "Dirty Hack". YMMV.<br><br>i will be happy to answer any questions/problems/feature requests/feedback etc<br><br>Thanks,<br><br>-&gt;InsertJokeHere&lt;-</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">T.Slappy</span><br><span class="post-time small text-muted">5th January 2011 07:57 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Hi<br>Your idea looks great but I got a lot of errors when I tried to compile your project.<br><br>I am using Visual Studio 2008 and your project is for VS 2010, so I downgraded .sln and related stuff.<br>Then I got lot of error for Microsoft.Build.Utilities.v4.0 which you are using, because I use Microsoft.Build.Utilities.v3.5.<br>Quote:</p><hr>All this errors are related to .net Framewrok - in your version [4.0] everything is present, but not in 3.5 which I use.<br>So is there possibility for you to create a lower version? I mean target framework should be 3.5.<table cellpadding="6" cellspacing="0" border="0" width="100%"><tr><td class="alt2"><hr>Error 1 'GeneratedCodeAttribute' is ambiguous in the namespace 'System.CodeDom.Compiler'.<br>Error 2 'EditorBrowsableAttribute' is ambiguous in the namespace 'System.ComponentModel'.<br>Error 3 'EditorBrowsableAttribute' is ambiguous in the namespace 'System.ComponentModel'.<br>Error 4 'GeneratedCodeAttribute' is ambiguous in the namespace 'System.CodeDom.Compiler'.<br>Error 5 'EditorBrowsableAttribute' is ambiguous in the namespace 'System.ComponentModel'.<br>Error 6 'ApplicationSettingsBase' is ambiguous in the namespace 'System.Configuration'.<br>Error 7 'ApplicationSettingsBase' is ambiguous in the namespace 'System.Configuration'.<br>Error 8 'HelpKeywordAttribute' is ambiguous in the namespace 'System.ComponentModel.Design'.<br>Error 9 Name 'NSISEngine' is not declared.<br>Error 10 Name 'NSISEngine' is not declared.<br>Error 11 'Process' is ambiguous in the namespace 'System.Diagnostics'.<br>Error 12 Property without a 'ReadOnly' or 'WriteOnly' specifier must provide both a 'Get' and a 'Set'.<br>Error 13 Statement cannot appear within a property body. End of property assumed.<br>Error 14 Property missing 'End Property'.<hr></td></tr></table><br><div class="post"><p class="post-meta"><span class="post-author text-primary">insertjokehere</span><br><span class="post-time small text-muted">5th January 2011 08:58 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Couldnt figure out how to edit my original post, so i will just make another one.<br><br>Attached is a zip containing both visual studio 2010 and visual studio 2008 version (.net 4 and .net 3.5 respectively). they should behave exactly the same. The visual studio 2008 version may give you a security warning about custom tasks (because it contains custom tasks), but this can be safely ignored</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">T.Slappy</span><br><span class="post-time small text-muted">10th January 2011 09:24 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">It is much better, Thanks!</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">AC_Sherway</span><br><span class="post-time small text-muted">18th September 2012 17:21 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">hey, i don't know if you still follow this, but i am interested in making this work, but i am kind of noob when it comes to these extra features of visual studio.<br><br>how do i make my existing project into an NSIS installer package using this?<br><br>i have NSIS installed and i downloaded the VS2010 zip file you attached, but i don't know where to fit the pieces :|</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">insertjokehere</span><br><span class="post-time small text-muted">18th September 2012 23:51 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">1. Grab the zip in my second post, and extract it somewhere<br>2. Pick the appropriate folder for the visual studio version you are using<br>3. move the NSISCTask folder into the folder for your visual studio solution<br>4. add the project for that folder as a project in your solution inside visual studio<br>5. edit template/template.vbproj with a text editor<br>6. set the &lt;Compile Include="..." /&gt; line to have the name of your .nsi file<br>7. if you have any .nsh files, add them as &lt;Header&gt; entries, otherwiser remove that whole ItemGroup<br>8. set NSISEngine to point to your makensis.exe (either in C:\Program Files\.... or C:\Program Files (x86)\...)<br>9. add template.vbproj as a project in your solution<br><br>you should now be able to build a .nsi from within visual studio by right clicking on this project and selecting build, or if you use some kind of continuous integration by invoking msbuild</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">T.Slappy</span><br><span class="post-time small text-muted">19th September 2012 10:02 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Hey AC_Sherway<br><br>I appreciate <b>insertjokehere</b>'s tool but it is a really "hardcore solution".<br><br>It is a long time since this tool was published: it was great in those times but there were some problems and lack of functionality so I decided to develop my own solution called "Visual &amp; Installer".<br>It is an extension for developing NSIS project directly in Visual Studio and it is really easy to use it.<br>Check my signature if you are interested in it, you can download it for free (Trial).<br><br>Sorry for self promotion :cool:</p></div><hr><div class="footer"><p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p></div></div><script src="../js/highlight.pack.js" type="text/javascript"></script><script type="text/javascript">//<![CDATA[
    hljs.initHighlightingOnLoad();
    //]]></script></div></body></html>