<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="New Checkbox modifying components checkbox state" />

  <title>New Checkbox modifying components checkbox state - NSIS Forums</title><!-- Bootstrap core CSS -->
  <link rel="stylesheet" type="text/css" href="//netdna.bootstrapcdn.com/bootswatch/3.0.1/readable/bootstrap.min.css" />
  <link rel="stylesheet" href="../css/style.css" type="text/css" /><!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!--[if lt IE 9]>
                <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
                <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->
</head>

<body>
  <div class="container">
    <!-- Put navigation bar here -->

    <ol class="breadcrumb">
      <li><a href="../index.html" class="glyphicon glyphicon-home"></a></li>

      <li><a href="f-65.html">NSIS Discussion</a></li>

      <li class="active">New Checkbox modifying components checkbox state</li>
    </ol>

    <p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=275145">New Checkbox modifying components checkbox state</a></p><br />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">luthar</span><br />
      <span class="post-time small text-muted">30th July 2007 20:12 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>New Checkbox modifying components checkbox state</strong><br />
      Hello,<br />
      <br />
      I hope my subject is clear.<br />
      <br />
      Basicly, I want to be able to add a new checkbox to the Modern UI components page. To do this, I will go with the extract/write in ini files.<br />
      <br />
      My main problem is that I want to be able to modify the state of the components checkbox (basicly gray/ungray them).<br />
      <br />
      I saw a couple of threads about similar things but I can't seem to find a way to do it.<br />
      <br />
      Here are the solutions I tought, yet none are imho nicely programmed:<br />
      - Use the checkbox as a *next* button. Use the MUI_PAGE_CUSTOMFUNCTION_LEAVE macro to call a function that will SetSectionFlags. Reload the page (can this be done?!)<br />
      <br />
      - Use the checkbox as a *next* button. Create two components page, one with checkbox grayed and other one not grayed. Use the MUI_PAGE_CUSTOMFUNCTION_LEAVE to switch from one page to another. When the real next button is pressed, jump to Directory page.<br />
      <br />
      Any ideas on this? If so, any references to examples/code/eetc...</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Red Wine</span><br />
      <span class="post-time small text-muted">30th July 2007 21:18 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">The .OnSelChange callback might be useful,<br />
      <br />
      <a href="http://nsis.sourceforge.net/Docs/Chapter4.html#4.7.2.1.8" target="_blank">http://nsis.sourceforge.net/Docs/Cha...html#4.7.2.1.8</a></p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">luthar</span><br />
      <span class="post-time small text-muted">30th July 2007 22:28 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">So what have I done so far...Any tips would be welcomed..<br />
      <br />
      Hacked the UI to add a checkbox control...to Dialog 104 (Components)<br />
      PHP Code:</p>
      <hr />
      <code style="white-space:nowrap"><!-- php buffer start --></code><span style="color: #000000"><span style="color: #0000BB">CONTROL</span><span style="color: #DD0000">""</span><span style="color: #007700">,</span><span style="color: #0000BB">1044</span><span style="color: #007700">,</span><span style="color: #0000BB">BUTTON</span><span style="color: #007700">,</span><span style="color: #0000BB">BS_CHECKBOX</span><span style="color: #007700">|</span><span style="color: #0000BB">WS_CHILD</span><span style="color: #007700">|</span><span style="color: #0000BB">WS_VISIBLE</span><span style="color: #007700">,</span><span style="color: #0000BB">0</span><span style="color: #007700">,</span><span style="color: #0000BB">68</span><span style="color: #007700">,</span><span style="color: #0000BB">90</span><span style="color: #007700">,</span><span style="color: #0000BB">18<br /></span></span> <!-- php buffer end -->
      <hr />
      <br />
      I added the following lines to create the Components page...<br />
      PHP Code:
      <hr />
      <code style="white-space:nowrap"><!-- php buffer start --></code><span style="color: #000000"><span style="color: #007700">!</span><span style="color: #0000BB">defineMUI_PAGE_CUSTOMFUNCTION_PREComponent_pre<br /></span> <span style="color: #007700">!</span><span style="color: #0000BB">defineMUI_PAGE_CUSTOMFUNCTION_LEAVEComponent_leave<br /></span> <span style="color: #007700">!</span><span style="color: #0000BB">insertmacroMUI_PAGE_COMPONENTS<br /></span></span> <!-- php buffer end -->
      <hr />
      Made the following functions:<br />
      PHP Code:
      <hr />
      <code style="white-space:nowrap"><!-- php buffer start --></code><span style="color: #000000"><span style="color: #007700">Function</span><span style="color: #0000BB">Component_pre<br />
      FindWindow</span><span style="color: #007700">$</span><span style="color: #0000BB">0</span><span style="color: #DD0000">"#32770"""</span><span style="color: #0000BB">$HWNDPARENT<br />
      GetDlgItem</span><span style="color: #007700">$</span><span style="color: #0000BB">1</span><span style="color: #007700">$</span><span style="color: #0000BB">01044<br />
      SendMessage</span><span style="color: #007700">$</span><span style="color: #0000BB">1</span><span style="color: #007700">${</span><span style="color: #0000BB">WM_SETTEXT</span><span style="color: #007700">}</span><span style="color: #0000BB">0</span><span style="color: #DD0000">"TESTING123"<br />
      <br />
      <br /></span> <span style="color: #0000BB">FunctionEnd<br />
      <br />
      <br /></span> <span style="color: #007700">Function</span><span style="color: #0000BB">Component_leave<br /></span> <span style="color: #FF8000">#<br />
      #MissingcodetogettheCheckBoxId(Iknowitsreferenceto1044buthowtogettheeventthatcalledthisfunction?<br /></span> <span style="color: #007700">${If}......<br />
      ${if}$</span><span style="color: #0000BB">0</span><span style="color: #007700">==</span><span style="color: #DD0000">"0"<br /></span> <span style="color: #FF8000">#defaultdisablesonoRO<br />
      <br /></span> <span style="color: #0000BB">SectionGetFlags</span><span style="color: #007700">${</span><span style="color: #0000BB">SECMatlab</span><span style="color: #007700">}$</span><span style="color: #0000BB">3<br />
      IntOp</span><span style="color: #007700">$</span><span style="color: #0000BB">3</span><span style="color: #007700">${</span><span style="color: #0000BB">SF_SELECTED</span><span style="color: #007700">}|${</span><span style="color: #0000BB">SF_RO</span><span style="color: #007700">}<br /></span> <span style="color: #0000BB">SectionSetFlags</span><span style="color: #007700">${</span><span style="color: #0000BB">SECMatlab</span><span style="color: #007700">}$</span><span style="color: #0000BB">3<br />
      <br />
      SectionGetFlags</span><span style="color: #007700">${</span><span style="color: #0000BB">SECDotNet</span><span style="color: #007700">}$</span><span style="color: #0000BB">3<br />
      IntOp</span><span style="color: #007700">$</span><span style="color: #0000BB">3</span><span style="color: #007700">$</span><span style="color: #0000BB">3</span><span style="color: #007700">|${</span><span style="color: #0000BB">SF_RO</span><span style="color: #007700">}<br /></span> <span style="color: #0000BB">SectionSetFlags</span><span style="color: #007700">${</span><span style="color: #0000BB">SECDotNet</span><span style="color: #007700">}$</span><span style="color: #0000BB">3<br />
      <br /></span> <span style="color: #007700">${else}<br /></span> <span style="color: #0000BB">SectionGetFlags</span><span style="color: #007700">${</span><span style="color: #0000BB">SECMatlab</span><span style="color: #007700">}$</span><span style="color: #0000BB">3<br />
      IntOp</span><span style="color: #007700">$</span><span style="color: #0000BB">3</span><span style="color: #007700">$</span><span style="color: #0000BB">3</span><span style="color: #007700">|${</span><span style="color: #0000BB">SF_RO</span><span style="color: #007700">}<br /></span> <span style="color: #0000BB">SectionSetFlags</span><span style="color: #007700">${</span><span style="color: #0000BB">SECMatlab</span><span style="color: #007700">}$</span><span style="color: #0000BB">3<br />
      <br />
      SectionGetFlags</span><span style="color: #007700">${</span><span style="color: #0000BB">SECDotNet</span><span style="color: #007700">}$</span><span style="color: #0000BB">3<br />
      IntOp</span><span style="color: #007700">$</span><span style="color: #0000BB">3</span><span style="color: #007700">$</span><span style="color: #0000BB">3</span><span style="color: #007700">|${</span><span style="color: #0000BB">SF_RO</span><span style="color: #007700">}<br /></span> <span style="color: #0000BB">SectionSetFlags</span><span style="color: #007700">${</span><span style="color: #0000BB">SECDotNet</span><span style="color: #007700">}$</span><span style="color: #0000BB">3<br />
      <br /></span> <span style="color: #007700">${endif}<br /></span> <span style="color: #0000BB">abort<br /></span> <span style="color: #007700">${EndIf}<br /></span> <span style="color: #0000BB">FunctionEnd<br /></span></span> <!-- php buffer end -->
      <hr />
      The new checkbox added does not respond to any click events (it doesn't show the checkmark when clicked )
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
      <span class="post-time small text-muted">30th July 2007 22:40 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Do check boxes send the BN_CLICKED notification? If so, you can use the ButtonEvent plug-in.<br />
      <br />
      Stu</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">luthar</span><br />
      <span class="post-time small text-muted">30th July 2007 23:47 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Everything worked perfectly with the ButtonEvent.<br />
      <br />
      I still have a problem tought...<br />
      <br />
      When in a section I put SectionIn RO, the components becomes greyed...<br />
      <br />
      Yet with the code below it doesn't get grayed and the clear doesn't seem to work.<br />
      <br />
      PHP Code:</p>
      <hr />
      <code style="white-space:nowrap"><!-- php buffer start --></code><span style="color: #000000"><span style="color: #007700">Function</span><span style="color: #0000BB">Component_Modification<br />
      <br /></span> <span style="color: #FF8000">#SwapValuesofCheckbox<br /></span> <span style="color: #007700">${If}</span><span style="color: #0000BB">$DefaultCheckBox</span><span style="color: #007700">==</span><span style="color: #0000BB">1<br />
      Strcpy$DefaultCheckBox</span><span style="color: #DD0000">"0"<br /></span> <span style="color: #007700">${Else}<br /></span> <span style="color: #0000BB">StrCpy$DefaultCheckBox</span><span style="color: #DD0000">"1"<br /></span> <span style="color: #007700">${EndIf}<br />
      <br /></span> <span style="color: #FF8000">#Hasusercheckedthecheckbox?<br /></span> <span style="color: #0000BB">FindWindow$R0</span><span style="color: #DD0000">"#32770"""</span><span style="color: #0000BB">$HWNDPARENT<br />
      GetDlgItem$R1$R01200<br />
      <br />
      SendMessage$R1</span><span style="color: #007700">${</span><span style="color: #0000BB">BM_SETCHECK</span><span style="color: #007700">}</span><span style="color: #0000BB">$DefaultCheckBox0<br />
      <br />
      <br /></span> <span style="color: #007700">${If}</span><span style="color: #0000BB">$DefaultCheckBox</span><span style="color: #007700">!=</span><span style="color: #0000BB">1</span><span style="color: #FF8000">#Userhasnotcheckedcheckbox.<br /></span> <span style="color: #007700">;default</span><span style="color: #0000BB">disablesonoRO</span><span style="color: #007700">and</span><span style="color: #0000BB">mustturngrey<br />
      <br />
      SectionGetFlags</span><span style="color: #007700">${</span><span style="color: #0000BB">SECMatlab</span><span style="color: #007700">}$</span><span style="color: #0000BB">3<br /></span> <span style="color: #007700">!</span><span style="color: #0000BB">insertmacroClearSectionFlag</span><span style="color: #007700">$</span><span style="color: #0000BB">3</span><span style="color: #007700">${</span><span style="color: #0000BB">SF_RO</span><span style="color: #007700">}<br /></span> <span style="color: #0000BB">SectionSetFlags</span><span style="color: #007700">${</span><span style="color: #0000BB">SECMatlab</span><span style="color: #007700">}$</span><span style="color: #0000BB">3<br />
      <br />
      SectionGetFlags</span><span style="color: #007700">${</span><span style="color: #0000BB">SECDotNet</span><span style="color: #007700">}$</span><span style="color: #0000BB">3<br /></span> <span style="color: #007700">!</span><span style="color: #0000BB">insertmacroClearSectionFlag</span><span style="color: #007700">$</span><span style="color: #0000BB">3</span><span style="color: #007700">${</span><span style="color: #0000BB">SF_RO</span><span style="color: #007700">}<br /></span> <span style="color: #0000BB">SectionSetFlags</span><span style="color: #007700">${</span><span style="color: #0000BB">SECDotNet</span><span style="color: #007700">}$</span><span style="color: #0000BB">3<br /></span> <span style="color: #007700">${else}<br /></span> <span style="color: #0000BB">SectionGetFlags</span><span style="color: #007700">${</span><span style="color: #0000BB">SECMatlab</span><span style="color: #007700">}$</span><span style="color: #0000BB">3<br />
      IntOp</span><span style="color: #007700">$</span><span style="color: #0000BB">3</span><span style="color: #007700">$</span><span style="color: #0000BB">3</span><span style="color: #007700">|${</span><span style="color: #0000BB">SF_RO</span><span style="color: #007700">}<br /></span> <span style="color: #0000BB">SectionSetFlags</span><span style="color: #007700">${</span><span style="color: #0000BB">SECMatlab</span><span style="color: #007700">}$</span><span style="color: #0000BB">3<br />
      <br />
      SectionGetFlags</span><span style="color: #007700">${</span><span style="color: #0000BB">SECDotNet</span><span style="color: #007700">}$</span><span style="color: #0000BB">3<br />
      IntOp</span><span style="color: #007700">$</span><span style="color: #0000BB">3</span><span style="color: #007700">$</span><span style="color: #0000BB">3</span><span style="color: #007700">|${</span><span style="color: #0000BB">SF_RO</span><span style="color: #007700">}<br /></span> <span style="color: #0000BB">SectionSetFlags</span><span style="color: #007700">${</span><span style="color: #0000BB">SECDotNet</span><span style="color: #007700">}$</span><span style="color: #0000BB">3<br />
      <br />
      <br /></span> <span style="color: #007700">${EndIf}<br />
      <br />
      <br /></span> <span style="color: #0000BB">FunctionEnd<br /></span></span> <!-- php buffer end -->
      <hr />
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">luthar</span><br />
      <span class="post-time small text-muted">30th July 2007 23:53 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Is it possible to put the section checkbox to gray, I would need to send the BM_SETSTATE message.<br />
      <br />
      If so, is there anyway to get access to the CheckBox from the section?</p>
    </div>
    <hr />

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]>
  </script>
</body>
</html>
