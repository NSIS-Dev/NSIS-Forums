<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="Variable output file" />

  <title>Variable output file - NSIS Forums</title>
  <script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script>
  <!-- Bootstrap core CSS -->

  <link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css" />
  <link rel="stylesheet" href="../css/style.css" type="text/css" /><!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!--[if lt IE 9]>
                <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
                <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->
</head>

<body>
  <div class="container">
    <!-- Put navigation bar here -->

    <ol class="breadcrumb">
      <li><a href="../index.html" class="glyphicon glyphicon-home"></a></li>

      <li><a href="f-65.html">NSIS Discussion</a></li>

      <li class="active">Variable output file</li>
    </ol>

    <p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=93943">Variable output file</a></p><br />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">toopriddy</span><br />
      <span class="post-time small text-muted">9th July 2002 19:01 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>Variable output file</strong><br />
      I am working on a cross platform project and would like NSIS to generate an output file like d-builder-0.0.4.exe where the 0.0.4 is the current version number. This version number is in a file all by itself for me to compile into my code<br />
      <br />
      I have tried to come up with a script to make NSIS read this file to get the version number and create an output file with that version number in it<br />
      <br />
      like:<br />
      <br />
      FileOpen $8 ../version r<br />
      FileRead $8 $9<br />
      FileClose $8<br />
      <br />
      OutFile "d-builder-$8.exe"<br />
      <br />
      <br />
      but File* commands have to be in a section and the OutFile is not valid in a section...<br />
      <br />
      Any suggestions?</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">veekee</span><br />
      <span class="post-time small text-muted">9th July 2002 19:09 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">NSIS installation script uses defines !<br />
      <br />
      !define VER_MAJOR 1<br />
      !define VER_MINOR 98<br />
      nsis${VER_MAJOR}${VER_MINOR}_fr.exe<br />
      <br />
      :D</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">rainwater</span><br />
      <span class="post-time small text-muted">9th July 2002 22:01 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>Re: Variable output file</strong><br /></p>

      <blockquote>
        <i>Originally posted by toopriddy</i><br />
        <b><br />
        FileOpen $8 ../version r<br />
        FileRead $8 $9<br />
        FileClose $8<br />
        <br />
        OutFile "d-builder-$8.exe"<br /></b>
      </blockquote>The FileRead does not occur when you compile the script, but when you run the installer. The easiest way, is to write a stub installer that reads the file, and then calls makensis with the define values on the command line. Then the script can read the define values to get the OutFile name.
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">toopriddy</span><br />
      <span class="post-time small text-muted">10th July 2002 18:41 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>part deaux</strong><br />
      ok, i can live with that, but when i run the comand line version with the define in the command line... it still does not use the define (it will use the define if i explicitly put the define in the script, but that is not what i want)<br />
      <br />
      command line:<br />
      "C:\Program Files\NSIS\makensis.exe" /V4 /CD d-builder.nsi /DDBUILDERVERSION=0.0.4<br />
      <br />
      <br />
      script:<br />
      <br />
      Name "Distributed Builder"<br />
      OutFile "d-builder-${DBUILDERVERSION}.exe"<br />
      <br />
      <br />
      it notices my command line define, but does not substitute the variable for the value<br />
      <br />
      I tried just putting a !define DBUILDERVERSION "0.0.4" above the OutFile and it works fine, so the problem it just the command line define</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Smile2Me</span><br />
      <span class="post-time small text-muted">10th July 2002 21:23 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Uservariables and defines only get their value <b>at runtime</b>. When you <b>compile</b>, the variables will not have a value yet and that's why you can't use them in compiling commands like OutFile and File.<br />
      <br />
      -Hendri.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
      <span class="post-time small text-muted">10th July 2002 22:11 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Your command line define doesn't work because you specify it after the name of the script to compile. Don't ask me why, but this is how it is...</p>
    </div>
    <hr />

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]>
  </script>
</body>
</html>
