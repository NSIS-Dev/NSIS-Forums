<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="description" content="Silent install without /S"><title>Silent install without /S - NSIS Forums</title><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script><link rel="preload" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css" as="style" onload="this.rel='stylesheet'"><link rel="preload" href="../css/style.css" as="style" onload="this.rel='stylesheet'"><noscript><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css"><link rel="stylesheet" href="../css/style.css"></noscript><script>!function(a){"use strict";var b=function(b,c,d){function e(a){return h.body?a():void setTimeout(function(){e(a)})}function f(){i.addEventListener&&i.removeEventListener("load",f),i.media=d||"all"}var g,h=a.document,i=h.createElement("link");if(c)g=c;else{var j=(h.body||h.getElementsByTagName("head")[0]).childNodes;g=j[j.length-1]}var k=h.styleSheets;i.rel="stylesheet",i.href=b,i.media="only x",e(function(){g.parentNode.insertBefore(i,c?g:g.nextSibling)});var l=function(a){for(var b=i.href,c=k.length;c--;)if(k[c].href===b)return a();setTimeout(function(){l(a)})};return i.addEventListener&&i.addEventListener("load",f),i.onloadcssdefined=l,l(f),i};"undefined"!=typeof exports?exports.loadCSS=b:a.loadCSS=b}("undefined"!=typeof global?global:this);!function(a){if(a.loadCSS){var b=loadCSS.relpreload={};if(b.support=function(){try{return a.document.createElement("link").relList.supports("preload")}catch(b){return!1}},b.poly=function(){for(var b=a.document.getElementsByTagName("link"),c=0;c<b.length;c++){var d=b[c];"preload"===d.rel&&"style"===d.getAttribute("as")&&(a.loadCSS(d.href,d,d.getAttribute("media")),d.rel=null)}},!b.support()){b.poly();var c=a.setInterval(b.poly,300);a.addEventListener&&a.addEventListener("load",function(){b.poly(),a.clearInterval(c)}),a.attachEvent&&a.attachEvent("onload",function(){a.clearInterval(c)})}}}(this);</script></head><body><div class="container"><ol class="breadcrumb"><li><a href="../index.html" class="glyphicon glyphicon-home"></a></li><li><a href="f-65.html">NSIS Discussion</a></li><li class="active">Silent install without /S</li></ol><p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=90164">Silent install without /S</a></p><br><div class="post"><p class="post-meta"><span class="post-author text-primary">HeadlessRider</span><br><span class="post-time small text-muted">6th June 2002 13:05 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>Silent install without /S</strong><br>Hi,<br><br>I'm a user of the great NSIS and I need make installation, whitch run silently for empty command line and with dialogs for same switches on the command line. I don't know how to join SilentInstall setting with functions or sections.<br><br>Thanks for help,<br>HlR.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Smile2Me</span><br><span class="post-time small text-muted">6th June 2002 13:12 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Maybe it's my problem, but I do not understand what you want to do. Please specify some more.<br><br>You want a SilentInstall and still dialogs and ComponentsPage? In my opinion, this is the contrary of a SilentInstall. But maybe I do not understand you.<br><br>Please explain!<br><br>-Hendri.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">HeadlessRider</span><br><span class="post-time small text-muted">6th June 2002 13:25 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>Silent install without /S</strong><br>When I run my install package (made by NSIS) without command line, so I need the same behaviour as run it with /S.<br><br>In *.nsi script I need some like that (meta language :-)):<br><br>if length of $CMDLINE is 0 then<br>SilentInstall silent<br>else<br>SilentInstall normal<br><br>Section "" ; (default section)<br>SetOutPath "$INSTDIR"<br>...etc...<br><br>Am I clear now? :-)</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Smile2Me</span><br><span class="post-time small text-muted">6th June 2002 13:40 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">If /S is specified, the installation will be silent. We do not need to program that. Apart from MessageBoxes, you will see nothing.<br><br>When you just specify "SilentInstall silent" it will be silent always, no matter what command line.<br><br>Does this answer the question?<br><br>-Hendri.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">HeadlessRider</span><br><span class="post-time small text-muted">6th June 2002 13:50 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Sorry, but it isn't the answer for my problem :-(<br><br>When command line will be empty, then installation must be silent. This is my aim.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Smile2Me</span><br><span class="post-time small text-muted">6th June 2002 14:02 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">From the docs:<br></p><blockquote>SilentInstall normal|<br>silent|<br>silentlog Specifies whether or not the installer should be silent. If it is 'silent' or 'silentlog', all sections are installed quietly, with no screen output from the installer itself (MessageBoxes are still displayed on error, and the script can still display whatever it wants). Note that if this is set to 'normal' and the user runs the installer with /S on the command line, it will behave as if SilentInstall 'silent' was used. Note: see also LogSet.</blockquote>From my previous reply:<br><blockquote>When you just specify "SilentInstall silent" it will be silent always, no matter what command line.</blockquote>I do not see the missing part. Just try it and you will see. When "silent" is specified, it will <b>always</b> be silent, no matter how the commandline looks like.<br><br>-Hendri.</div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">HeadlessRider</span><br><span class="post-time small text-muted">6th June 2002 14:17 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Sorry, its my fault. I mean: If and only if the command line is empty, instalation must be silent. If I run, for example<br><br>my_setup.exe /show<br><br>then the installation must not be silent. So, I must set SilentInstall whit dependency on the command line.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Smile2Me</span><br><span class="post-time small text-muted">6th June 2002 14:38 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Isn't this strange? Why not use the integrated possibilities of NSIS and just use /S to make it silent. So instead of making this:<br><br>silent if CMDLINE is empty, normal else.<br><br>make this:<br><br>silent if /S, normal else.<br><br>/S is already supported and you don't need to program anymore.<br><br>You could check using GetParameters if /S is selected and depending on that display messageboxes or not.<br><br>-Hendri.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">HeadlessRider</span><br><span class="post-time small text-muted">7th June 2002 06:43 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Uff :-) Yes, it's strange, but I need this functionality. I need silent install when command line is empty and non silent when command line contain my flag (or any flag), for example /a (so, I need the opposite funtionality to default behaviour).<br><br>So, I need use same function for parse command line, for example GetParameters. If command line will be equal to the string "/a" then I must set<br>SilentInstall silent<br>or<br>DirShow hide<br><br>When I set first<br>SilentInstall normal<br>and command line will be contain any flag, then I must set<br>SilentInstall silent.<br><br>But this is the problem, because this attributes can be set only out of the functions and sections and on the other hand: functions must be called from the sections.<br><br>So, this problem hasn't the solution?</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Smile2Me</span><br><span class="post-time small text-muted">7th June 2002 07:29 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Indeed: conditioning SilentInstall is not possible. Solution: change the process outside the installer. Now this process requires the installer to be silent when no commandline has been specified. ry to change this behavior so it will use the /S option. No other possibilities (except from changing the source of NSIS!).<br><br>-Hendri.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">HeadlessRider</span><br><span class="post-time small text-muted">7th June 2002 12:23 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Hmm, I heard, that InstallShield can solve my problem. It's sad, but I will have to buy InstallShield software instead of I like the NSIS :-(</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Smile2Me</span><br><span class="post-time small text-muted">7th June 2002 12:44 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Do you want to spend money on that?<br><br>Maybe we could help you change the outside process that requires an installer to be run silently if it doesn't get a commandline and normally if it does get a commandline argument.<br><br>If you could alter these requirements, you could use /S.<br><br>Hey, an idea, maybe create an additional installer that turns around the commandlines and calls the true installer with the right commandline arguments (/S). This additional installer should be run silently of course.<br><br>That should work, good luck,<br>-Hendri.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">HeadlessRider</span><br><span class="post-time small text-muted">7th June 2002 13:12 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Yes!, I had the same idea and this is my solution:<br><br>OutFile "My_Install_Package.exe"<br>SilentInstall normal<br><br>Function .onInit<br>Call GetParameters<br>Pop $0<br>StrCmp $0 "/S" end_function<br>StrCmp $0 "/a" end_function<br>Exec "My_Install_Package.exe /S"<br>Abort<br>end_function:<br>FunctionEnd<br><br>:-))) Everything is OK :-)))<br><br>Thanks for your patient,<br><br>HlR</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Smile2Me</span><br><span class="post-time small text-muted">7th June 2002 13:28 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Great, no InstallShield needed here :D<br><br>Greetz,<br>-Hendri.</p></div><hr><div class="footer"><p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p></div></div><script type="text/javascript" src="../js/highlight.pack.js" async></script><script type="text/javascript">//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]></script></body></html>