<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="UAC plugin, return value from process" />

  <title>UAC plugin, return value from process - NSIS Forums</title>
  <script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script>
  <!-- Bootstrap core CSS -->

  <link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css" />
  <link rel="stylesheet" href="../css/style.css" type="text/css" /><!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!--[if lt IE 9]>
                <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
                <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->
</head>

<body>
  <div class="container">
    <!-- Put navigation bar here -->

    <ol class="breadcrumb">
      <li><a href="../index.html" class="glyphicon glyphicon-home"></a></li>

      <li><a href="f-65.html">NSIS Discussion</a></li>

      <li class="active">UAC plugin, return value from process</li>
    </ol>

    <p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=329850">UAC plugin, return value from process</a></p><br />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">darasan</span><br />
      <span class="post-time small text-muted">20th April 2011 11:11 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>UAC plugin, return value from process</strong><br />
      Hi,<br />
      <br />
      I searched the forums about this but couldnt find any information.<br />
      <br />
      I am using the UAC plugin with my NSIS script.<br />
      To install the Visual Studio 2010 Redistributable, I call this function:<br />
      <br />
      !insertmacro UAC_AsUser_ExecShell "" "vcredist_x86.exe" "" "" ""<br />
      <br />
      I want to be able to check the return value of this exe. I looked at the macro itself and it<br />
      calls ExecShell, but I want it to call ExecWait instead and return the value to my script.<br />
      I tried to modify it to do this, but I can't get it to work.<br />
      <br />
      Has anybody tried this before?<br />
      <br />
      Thanks,<br />
      <br />
      Daire</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">MSG</span><br />
      <span class="post-time small text-muted">20th April 2011 17:34 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Try making a function that execwaits, and call that function as user. (Note that variables like $TEMP might be different between the inner and outer processes.)</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Anders</span><br />
      <span class="post-time small text-muted">20th April 2011 19:07 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Um, don't you have to be admin to run vcredist_x86.exe?</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">MSG</span><br />
      <span class="post-time small text-muted">20th April 2011 21:02 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Hahaha, good point, that. :)</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">darasan</span><br />
      <span class="post-time small text-muted">27th April 2011 10:55 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Hi, thanks for your replies.<br />
      <br /></p>

      <blockquote>
        Try making a function that execwaits, and call that function as user. (Note that variables like $TEMP might be different between the inner and outer processes.)
      </blockquote>So you mean to just call a function, containing an ExecWait command, in the usual NSIS way? Not using any of the UAC plug-in macros? Doesn't this defeat the purpose of using the plug-in?<br />
      <br />
      And if I need to be admin to install the vcredist package, what command should I use?<br />
      I can only see a macro for UAC_AsUser_ExecShell...<br />
      <br />
      Sorry for my lack of understanding, I can't find any documentation on this?<br />
      Many thanks for your help!
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Anders</span><br />
      <span class="post-time small text-muted">27th April 2011 12:01 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">The UAC plugin is not for running things as admin. Use <a href="http://pastebin.com/EvMkyLLt" target="_blank">http://pastebin.com/EvMkyLLt</a></p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">darasan</span><br />
      <span class="post-time small text-muted">28th April 2011 11:09 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">OK, so I've misunderstood the purpose of this plugin.<br />
      The main page description says:<br />
      <br />
      "For example, you can have an admin level installer launch another process at a user level. Or you can have an admin level installer create shortcuts at a user level."<br />
      <br />
      Why would I want to do this? Why not run everything at the admin level (using RequestExecutionLevel admin), when installing?<br />
      <br />
      Would that make un-installing more difficult? Thanks!</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Anders</span><br />
      <span class="post-time small text-muted">28th April 2011 11:24 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">First off, I did not write the wiki page so I can't really comment on its content.<br />
      <br />
      The only real purpose of the UAC plugin is to handle the run checkbox on the finish page. People use it for other things, and yes, it makes it harder to uninstall if you do that...</p>
    </div>
    <hr />

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]>
  </script>
</body>
</html>
