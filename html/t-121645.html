<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="Section control using flags" />

  <title>Section control using flags - NSIS Forums</title>
  <script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script>
  <!-- Bootstrap core CSS -->

  <link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css" />
  <link rel="stylesheet" href="../css/style.css" type="text/css" /><!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!--[if lt IE 9]>
                <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
                <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->
</head>

<body>
  <div class="container">
    <!-- Put navigation bar here -->

    <ol class="breadcrumb">
      <li><a href="../index.html" class="glyphicon glyphicon-home"></a></li>

      <li><a href="f-65.html">NSIS Discussion</a></li>

      <li class="active">Section control using flags</li>
    </ol>

    <p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=121645">Section control using flags</a></p><br />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">cosmic66</span><br />
      <span class="post-time small text-muted">16th January 2003 12:02 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>Section control using flags</strong><br />
      &nbsp; Hi!<br />
      <br />
      I'm new to NSIS and try to achieve the following:<br />
      I have two sections (s0 and s1) and their state (selection ON|OFF) should be dependend on each other:<br />
      <br />
      When section s0 is deselcted, section s1 should be deselcted.<br />
      When section s1 is selected, section s0 should be deselcted.<br />
      <br />
      I have followed the procedure described in previous postings and in<br />
      example "one-selection".<br />
      <br />
      I have attached my NSI-file to this posting,<br />
      Setting the flags doesn't have an effect and s1 is not interactive in<br />
      the installer after its flag has been written.<br />
      <br />
      I'm using NSIS v2.0b0.<br />
      <br />
      Thanks for any hints on how to solve this problem!</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">cosmic66</span><br />
      <span class="post-time small text-muted">16th January 2003 12:09 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>Re: Section control using flags</strong><br />
      &nbsp;</p>

      <blockquote>
        <i>Originally posted by cosmic66</i><br />
        [...]<br />
        When section s0 is deselcted, section s1 should be deselcted.<br />
        When section s1 is selected, section s0 should be deselcted.<br />
        [...]<br />
        [/B]
      </blockquote>Sorry, there was a mistake,<br />
      the correction is:<br />
      <br />
      <br />
      When section s0 is deselcted, section s1 should be deselcted.<br />
      When section s1 is selected, section s0 should be <font color="orangered">selected</font>.
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">virtlink</span><br />
      <span class="post-time small text-muted">16th January 2003 19:13 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">That's where the Edit button is for :).</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
      <span class="post-time small text-muted">17th January 2003 11:26 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Have you tried settings the initial value for $R0 and $R1? Set it in .onInit.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">cosmic66</span><br />
      <span class="post-time small text-muted">17th January 2003 12:04 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"></p>

      <blockquote>
        <i>Originally posted by kichik</i><br />
        <b>Have you tried settings the initial value for $R0 and $R1? Set it in .onInit.</b>
      </blockquote>Thanks for your quick answer.<br />
      Setting the initial value for $R0 and $R1 doesn't make a difference.<br />
      <br />
      <br />
      But still I was able to solve the problem :D<br />
      I had a mistake in my flow (in which case to jump to which label) and I was using the wrong operation when setting the flag to being deselcted.<br />
      <br />
      In case someone is interested, the working skript is attached to this posting.
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">japheth</span><br />
      <span class="post-time small text-muted">17th January 2003 20:11 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">I'm looking to do something similar, but not quite.<br />
      <br />
      Here's what I need to do:<br />
      <br />
      There are 4 components.<br />
      <br />
      I need components 1 and 3 to be co-dependent upon one another. So, if a user selects component 1 and component 3 is selected, component 3 becomes unselected. Similarly, if a user selects component 3 and component 1 is selected, component 3 becomes unselected.<br />
      <br />
      I've looked at one-section.nsi and at the script posted on this thread, and I sort of get it, however, it's not the kind of programming logic I'm used to coding in.<br />
      <br />
      Any help is appreciated.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
      <span class="post-time small text-muted">18th January 2003 11:17 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">I don't understand, if you got it to work what's the problem?</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">japheth</span><br />
      <span class="post-time small text-muted">18th January 2003 17:13 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Sorry, I guess I should of explained myself better.<br />
      <br />
      I don't have it working at all. And actually, instead of co-dependent, I should of said mutually exclusive.<br />
      <br />
      one-section.nsi is *almost* what I need. The only thing is, in one-section.nsi, at least one section is required. I need something similar to that, except that no section will be required, the user just can't have component 3 selected if component 1 is selected and visa-versa.<br />
      <br />
      <br />
      Hopefully that clears things up. ;)</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
      <span class="post-time small text-muted">18th January 2003 19:15 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">OK, then lets think of a script logic for that.<br />
      <br />
      What you need to do is initially select only one of them to make the initial state valid. Do this in .onInit. Remember what section you initially selected. Then in .onSelChange check to see if the section that wasn't remembered is selected. If it is, remember it and uncheck the one that was remembered earlier. That's all you need to do. It should cover all cases.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">virtlink</span><br />
      <span class="post-time small text-muted">18th January 2003 21:18 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">I think he has come up with that idea too, but didn't find the right words for it. What code should he use?</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">japheth</span><br />
      <span class="post-time small text-muted">19th January 2003 07:29 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Yeah, virtlink hit the proverbial nail on the head.<br />
      <br />
      I know the logic that's required, it's just that I'm pretty bad with NSIS's programming logic.<br />
      <br />
      I hate being hand-held just as much as the next person, but I've been farting around with this for the past couple of days with no results.<br />
      <br />
      If someone could come up with a small snippet of code, I'd be much appreciative. ;)<br />
      <br />
      Perhaps it could even be included in the examples as mutual-excluseive.nsi or something. I'm sure someone else will want to do something similar to this in the future. :)</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
      <span class="post-time small text-muted">19th January 2003 15:52 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Enjoy:<br />
      <br />
      <a href="http://nsis.sourceforge.net/archive/nsisweb.php?page=85&amp;instances=0,64" target="_blank">http://nsis.sourceforge.net/archive/...instances=0,64</a></p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">japheth</span><br />
      <span class="post-time small text-muted">20th January 2003 00:02 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Thanks a lot kichik. :)</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">tkm2007</span><br />
      <span class="post-time small text-muted">25th October 2007 10:00 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Hello everyone!<br />
      <br />
      I am trying to create an installer with 2 sections which cannot be both selected at once, exactly as japheth. I saw the example kichik posted, but I would like to ask how I can have the second section selected by default, and not the first one as shown in the example.<br />
      <br />
      Thank you!</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">pospec</span><br />
      <span class="post-time small text-muted">25th October 2007 10:13 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">I didn't see kichik's example but I'll give you my. I hope it is what you need.<br /></p>
      <pre>
<code>
name 'example'
<br /><br />&gt;outfile 'example.exe'
<br /><br />&gt;!include 'sections.nsh'
<br /><br />&gt;page components
<br />page instfiles
<br /><br />showinstdetails show
<br /><br />&gt;var sec_var
<br /><br />section/o 'first' sec_1
<br />  detailprint 'first section'
<br />&gt;sectionend
<br /><br />section'second' sec_2
<br />  detailprint 'second section'
<br />&gt;sectionend
<br /><br />&gt;function .onselchange
<br /> !insertmacro startradiobuttons $sec_var
<br />   !insertmacro radiobutton ${sec_1}
<br />    !</code>insertmacro radiobutton ${sec_2}
<br />  !insertmacro endradiobuttons
<br />functionend 
<br />&gt;

</pre>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">tkm2007</span><br />
      <span class="post-time small text-muted">25th October 2007 10:17 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Thank you pospec for your quick reply. I have already found this way in the web, but it doesn't give me the option to have no section selected as kichik's example does. Thank you anyway!</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">pospec</span><br />
      <span class="post-time small text-muted">25th October 2007 10:24 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">I see. If you like his example then you can modify it for your purposes. Just change <font face="courier new">IntOp $0 $0 &amp; ${SECTION_OFF}</font> with <font face="courier new">IntOp $0 $0 | ${SF_SELECTED}</font> and vice versa in <font face="courier new">.onInit</font> ;)</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">pospec</span><br />
      <span class="post-time small text-muted">25th October 2007 10:31 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">I missed one thing - remember <font face="courier new">${sec2}</font> in <font face="courier new">$R9</font> on init.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">tkm2007</span><br />
      <span class="post-time small text-muted">25th October 2007 10:32 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"></p>

      <blockquote>
        <i>Originally posted by pospec</i><br />
        <b>I see. If you like his example then you can modify it for your purposes. Just change <font face="courier new">IntOp $0 $0 &amp; ${SECTION_OFF}</font> with <font face="courier new">IntOp $0 $0 | ${SF_SELECTED}</font> and vice versa in <font face="courier new">.onInit</font> ;)</b>
      </blockquote>Thank you very much pospec for your time! It workd! :) :)
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">sr164w</span><br />
      <span class="post-time small text-muted">15th February 2012 05:45 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">I need same kind of mutual exclusion wrt " Main " section. I am using Main section of nsi file only to copy few files. i need to achieve to copy few files when some variable set to true.<br />
      if i put only File command to copy files when variable set to flase also installer is trying to copy those files and giving me error. If i use /nonfatal with File command then installer gives warning.<br />
      what exactly i want achieve is installer should only try to copy if variable set to true. if variable is false then there File command should not get executed.<br />
      Any help would be highly appreciated!</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
      <span class="post-time small text-muted">15th February 2012 11:22 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><a href="http://forums.winamp.com/showthread.php?t=341517" target="_blank">http://forums.winamp.com/showthread.php?t=341517</a><br />
      <br />
      Stu</p>
    </div>
    <hr />

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]>
  </script>
</body>
</html>