<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="description" content="Drag and drop &quot;Delete on Reboot&quot; widget"><title>Drag and drop "Delete on Reboot" widget - NSIS Forums</title><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script><link rel="preload" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css" as="style" onload="this.rel='stylesheet'"><link rel="preload" href="../css/style.css" as="style" onload="this.rel='stylesheet'"><noscript><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css"><link rel="stylesheet" href="../css/style.css"></noscript><script>!function(a){"use strict";var b=function(b,c,d){function e(a){return h.body?a():void setTimeout(function(){e(a)})}function f(){i.addEventListener&&i.removeEventListener("load",f),i.media=d||"all"}var g,h=a.document,i=h.createElement("link");if(c)g=c;else{var j=(h.body||h.getElementsByTagName("head")[0]).childNodes;g=j[j.length-1]}var k=h.styleSheets;i.rel="stylesheet",i.href=b,i.media="only x",e(function(){g.parentNode.insertBefore(i,c?g:g.nextSibling)});var l=function(a){for(var b=i.href,c=k.length;c--;)if(k[c].href===b)return a();setTimeout(function(){l(a)})};return i.addEventListener&&i.addEventListener("load",f),i.onloadcssdefined=l,l(f),i};"undefined"!=typeof exports?exports.loadCSS=b:a.loadCSS=b}("undefined"!=typeof global?global:this);!function(a){if(a.loadCSS){var b=loadCSS.relpreload={};if(b.support=function(){try{return a.document.createElement("link").relList.supports("preload")}catch(b){return!1}},b.poly=function(){for(var b=a.document.getElementsByTagName("link"),c=0;c<b.length;c++){var d=b[c];"preload"===d.rel&&"style"===d.getAttribute("as")&&(a.loadCSS(d.href,d,d.getAttribute("media")),d.rel=null)}},!b.support()){b.poly();var c=a.setInterval(b.poly,300);a.addEventListener&&a.addEventListener("load",function(){b.poly(),a.clearInterval(c)}),a.attachEvent&&a.attachEvent("onload",function(){a.clearInterval(c)})}}}(this);</script></head><body><div class="container"><ol class="breadcrumb"><li><a href="../index.html" class="glyphicon glyphicon-home"></a></li><li><a href="f-65.html">NSIS Discussion</a></li><li class="active">Drag and drop "Delete on Reboot" widget</li></ol><p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=215410">Drag and drop "Delete on Reboot" widget</a></p><br><div class="post"><p class="post-meta"><span class="post-author text-primary">SenseiSimpleton</span><br><span class="post-time small text-muted">8th May 2005 22:25 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>Drag and drop "Delete on Reboot" widget</strong><br>This is kinda going off the context of using NSIS for installers, but it has so many useful features that it can be used for so many other things.<br><br>i want to make a simple app that deletes files that windows has locked, on reboot, in the following ways:<br><br>1. Accepts files dragged onto the exe icon<br>&gt; a large group of files or single file.. this runs the program and the programs tries to delete all the files using the /REBOOTOK switch.<br><br>2. when you open the EXE, there is a small square drag-drop target window to which you can drag and drop files in the same way as above.<br><br>3. Add a context menu item to all files (this part is easy enough) which lets you right click a stuck file and say "delete on reboot" (or simply "Delete") and it takes the appropriate action (delete or delete on reboot).<br><br>It's easy enough to just hardcode in the file to be deleted but how could it accept dragged files and translate that into their paths and subsequently loop through all the files and run the delete or take the command from context menu and get the file name of the file to be deleted?<br><br>i havent been able to find anything about dragging and dropping onto an install (with good reason, i dont know why anyone would need that under normal circumstances.<br><br>This is justa small personal project but any help would be much appreciated.. i'm sure many people would find this simple app very useful since windows has that nasty habit of keeping files which are no longer running locked, sometimes indefinitely.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">kichik</span><br><span class="post-time small text-muted">10th May 2005 21:16 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">The paths of files that are dragged onto an executable icon are passed on the command line. You should parse $CMDLINE to get them.<br><br>Making the installer window itself a drop target would require a plug-in. See <a href="http://msdn.microsoft.com/library/en-us/shellcc/platform/shell/programmersguide/shell_basics/shell_basics_programming/transferring/transfer.asp" target="_blank">this MSDN page</a> for more information.</p></div><hr><div class="footer"><p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p></div></div><script type="text/javascript" src="../js/highlight.pack.js" async></script><script type="text/javascript">//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]></script></body></html>