<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="description" content="Re:Onclick Installer"><title>Re:Onclick Installer - NSIS Forums</title><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script><link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css"><link rel="stylesheet" href="../css/style.css" type="text/css"><!--[if lt IE 9]><script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script><script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script><![endif]--></head><body><div class="container"><ol class="breadcrumb"><li><a href="../index.html" class="glyphicon glyphicon-home"></a></li><li><a href="f-65.html">NSIS Discussion</a></li><li class="active">Re:Onclick Installer</li></ol><p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=262198">Re:Onclick Installer</a></p><br><div class="post"><p class="post-meta"><span class="post-author text-primary">hnmurugan</span><br><span class="post-time small text-muted">21st December 2006 09:46 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>Re:Onclick Installer</strong><br>Dear All,<br><br>Just wondering whether my below request can be done using NSIS.<br><br>I am working in a computer DIY hardware shop and most of the time my job always requires me install same softwares like flash player,java,adobe reader,video lan, realplayer and antiirus softwares.<br><br>I am sick of click next buttons and i have to wait for softwares to be installed before start installing other softwares due some softwares don't allow.<br><br>But i have seen those application recovery cd's from HP and it will let you choose the softwares and it will install automatically using silent switches.<br><br>Is it possible to write a NSIS script that can hdo the same job as application recovery cd does?<br><br>Your inputs in this matter is greately appreciated.<br><br>Rgds/Hari</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Red Wine</span><br><span class="post-time small text-muted">21st December 2006 12:35 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">It's possible and easy with NSIS.<br>All you have to do is to associate sections with applications that you wish to install (in my thought one section for every application). Find every application's command line switch for sillent installation and add it like this:<br><a href="http://nsis.sourceforge.net/Docs/Chapter4.html#4.9.1" target="_blank">ExecWait</a> '"$EXEDIR\app_setup.exe" silent_parameters'.<br>Compile and burn the installer and all needed applications to the root of a removable media.<br>Last but not least execute the installer from that media and from components page select the applications that you want to install according to the target machine and take your coffee time :-)<br><br>related:<br><br><a href="http://nsis.sourceforge.net/Docs/Chapter4.html#4.9" target="_blank">Instructions</a><br><br><a href="http://nsis.sourceforge.net/Docs/Chapter4.html#4.6" target="_blank">Sections</a><br><br><a href="http://nsis.sourceforge.net/Docs/Chapter4.html#4.5" target="_blank">Pages</a><br><br><a href="http://nsis.sourceforge.net/Docs/Chapter2.html#2.5" target="_blank">Modern UI</a></p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">hnmurugan</span><br><span class="post-time small text-muted">22nd December 2006 01:15 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">thanks for your time and effort.I will try this during weekend .<br>Rgds/Hari</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">hnmurugan</span><br><span class="post-time small text-muted">24th December 2006 19:33 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Dear Red Wine,<br><br>I have managed to get my first installer work successfully. Thanks for your help again.Here is my script below<br><br>Name "${PRODUCT_NAME} ${PRODUCT_VERSION}"<br>OutFile "Setup.exe"<br>InstallDir "$PROGRAMFILES"<br><br>Section "Java" SEC01<br>ExecWait '"Java\Java.exe" /qr'<br>SectionEnd<br><br>Section "Flash" SEC02<br>ExecWait "Flash\Flash.msi"<br>SectionEnd<br><br>Could you please answer below questions?<br><br>1.If you notice, section 2 got msi file and it does not execute. How do i call msiexec to execute this?<br><br>2.For the status message, it is displaying executing Java\Java.exe. Instead is it possible to replace with installing Java?<br><br>3.Another improvement - How do i compile my install file in to setup.exe and extract to $tmp then start the install from temp, after delete it.<br><br>Sorry to ask too much.<br><br>Rgds</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Red Wine</span><br><span class="post-time small text-muted">24th December 2006 20:11 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">You're welcome!<br></p><blockquote>1.If you notice, section 2 got msi file and it does not execute. How do i call msiexec to execute this?</blockquote>Use ExecShell open 'path_to_file\Flash.msi'<br><br><br><blockquote>2.For the status message, it is displaying executing Java\Java.exe. Instead is it possible to replace with installing Java?</blockquote>See NSIS documentation 4.9.14.3 DetailPrint, 4.9.14.14 SetDetailsPrint etc.<br><br><br><blockquote>3.Another improvement - How do i compile my install file in to setup.exe and extract to $tmp then start the install from temp, after delete it.</blockquote>Function .onInit<br>InitPluginsDir<br>File /oname=$PLUGINSDIR\Java.exe 'Local_path\java.exe'<br>...<br>...<br>FunctionEnd<br><br>Section "Java" SEC01<br>ExecWait '"$PLUGINSDIR\Java\Java.exe" /qr'<br>...<br>...<br>SectionEnd<br><br>$PLUGINSDIR removed once the installer is terminated.<br>See NSIS documentation 4.2.3 Constants and search the forum for examples.<br>Also don't forget wiki! <a href="http://nsis.sourceforge.net" target="_blank">http://nsis.sourceforge.net</a><br><br>Happy Holidays!</div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Red Wine</span><br><span class="post-time small text-muted">25th December 2006 08:25 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">I was not able to add these corrections to my other post above, so I put them here:<br></p><blockquote>1.If you notice, section 2 got msi file and it does not execute. How do i call msiexec to execute this?</blockquote>If you want to WAIT for the proccess to terminate before continue then use:<br>ExecWait 'msiexec.exe /options "path_to_file\file.msi"'<br><br><blockquote>Section "Java" SEC01<br>ExecWait '"$PLUGINSDIR\<font color="red">Java</font>\Java.exe" /qr'<br>...<br>...<br>SectionEnd</blockquote>ExecWait '"$PLUGINSDIR\Java.exe" /qr'</div><hr><div class="footer"><p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p></div></div><script src="../js/highlight.pack.js" type="text/javascript"></script><script type="text/javascript">//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]></script></body></html>