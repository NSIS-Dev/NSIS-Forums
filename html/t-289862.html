<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="Deleting a previously installed version of my software?" />

  <title>Deleting a previously installed version of my software? - NSIS Forums</title><!-- Bootstrap core CSS -->
  <link rel="stylesheet" type="text/css" href="//netdna.bootstrapcdn.com/bootswatch/3.0.1/readable/bootstrap.min.css" />
  <link rel="stylesheet" href="../css/style.css" type="text/css" /><!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!--[if lt IE 9]>
                <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
                <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->
</head>

<body>
  <div class="container">
    <!-- Put navigation bar here -->

    <ol class="breadcrumb">
      <li><a href="../index.html" class="glyphicon glyphicon-home"></a></li>

      <li><a href="f-65.html">NSIS Discussion</a></li>

      <li class="active">Deleting a previously installed version of my software?</li>
    </ol>

    <p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=289862">Deleting a previously installed version of my software?</a></p><br />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kook04</span><br />
      <span class="post-time small text-muted">8th April 2008 15:08 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>Deleting a previously installed version of my software?</strong><br />
      My install script currently writes a value to the registry which points the uninstall.exe file that get created during the install process. The line looks like this:<br />
      <br />
      <br />
      WriteRegStr ${UNINSTALL_ROOT_KEY} "${UNINSTALL_KEY}" "UninstallString" "$INSTDIR\uninstall.exe"<br />
      <br />
      <br />
      I would like to add logic to the beginning of my script that would check for the existence of this registry value, and if it exists, remove the previous version of my software by calling that uninstall.exe file.<br />
      <br />
      Does anyone currently do this? The pseudo-logic would look like this:<br />
      <br />
      if (registry_key.exists)<br />
      {<br />
      Variable x = registry_value;<br />
      Execute(x);<br />
      }<br />
      <br />
      I'm not exactly sure how to check for the existance of a specific registry key, and then get the value for that key. Also, I then need execute the .exe file that is pointed to by that value.<br />
      <br />
      <br />
      Thank You,<br />
      <br />
      Kennedy</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Anders</span><br />
      <span class="post-time small text-muted">8th April 2008 16:22 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">ReadRegStr (returns "" and sets the error flag if not found)<br />
      also remember to use the _? trick if you need the uninstaller to wait (ExecWait '"$INSTDIR\uninstall.exe" _?=$INSTDIR')</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kook04</span><br />
      <span class="post-time small text-muted">8th April 2008 16:40 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Anders,<br />
      <br />
      That is very helpful. ReadRegStr is just what I needed.<br />
      <br />
      Thanks.</p>
    </div>
    <hr />

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]>
  </script>
</body>
</html>
