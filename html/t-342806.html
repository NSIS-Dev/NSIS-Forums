<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="description" content="Rare problem with Windows 7"><title>Rare problem with Windows 7 - NSIS Forums</title><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script><link rel="preload" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css" as="style" onload="this.rel='stylesheet'"><link rel="preload" href="../css/style.css" as="style" onload="this.rel='stylesheet'"><noscript><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css"><link rel="stylesheet" href="../css/style.css"></noscript><script>!function(a){"use strict";var b=function(b,c,d){function e(a){return h.body?a():void setTimeout(function(){e(a)})}function f(){i.addEventListener&&i.removeEventListener("load",f),i.media=d||"all"}var g,h=a.document,i=h.createElement("link");if(c)g=c;else{var j=(h.body||h.getElementsByTagName("head")[0]).childNodes;g=j[j.length-1]}var k=h.styleSheets;i.rel="stylesheet",i.href=b,i.media="only x",e(function(){g.parentNode.insertBefore(i,c?g:g.nextSibling)});var l=function(a){for(var b=i.href,c=k.length;c--;)if(k[c].href===b)return a();setTimeout(function(){l(a)})};return i.addEventListener&&i.addEventListener("load",f),i.onloadcssdefined=l,l(f),i};"undefined"!=typeof exports?exports.loadCSS=b:a.loadCSS=b}("undefined"!=typeof global?global:this);!function(a){if(a.loadCSS){var b=loadCSS.relpreload={};if(b.support=function(){try{return a.document.createElement("link").relList.supports("preload")}catch(b){return!1}},b.poly=function(){for(var b=a.document.getElementsByTagName("link"),c=0;c<b.length;c++){var d=b[c];"preload"===d.rel&&"style"===d.getAttribute("as")&&(a.loadCSS(d.href,d,d.getAttribute("media")),d.rel=null)}},!b.support()){b.poly();var c=a.setInterval(b.poly,300);a.addEventListener&&a.addEventListener("load",function(){b.poly(),a.clearInterval(c)}),a.attachEvent&&a.attachEvent("onload",function(){a.clearInterval(c)})}}}(this);</script></head><body><div class="container"><ol class="breadcrumb"><li><a href="../index.html" class="glyphicon glyphicon-home"></a></li><li><a href="f-65.html">NSIS Discussion</a></li><li class="active">Rare problem with Windows 7</li></ol><p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=342806">Rare problem with Windows 7</a></p><br><div class="post"><p class="post-meta"><span class="post-author text-primary">preuter</span><br><span class="post-time small text-muted">2nd March 2012 12:39 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>Rare problem with Windows 7</strong><br>We are distributing a Java application with a packaged JRE. Very occasionally, the installed application can not access some jar files and will not run properly. This only happens to a small fraction of users for a given release, and so far only on Windows 7 machines.<br><br>Reinstalling from the same installer.exe does not fix the problem, although a freshly generated installer from identical source code will usually work.<br><br>Copying the program directory to another location fixes this problem, and it can also be copied back to the original install location and then run without problems.<br><br>This makes me suspect shenanigans with ownership/permissions, although what could cause this is a mystery to me.<br><br>Any ideas on the cause, or possible fixes?</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">MSG</span><br><span class="post-time small text-muted">2nd March 2012 14:06 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Given the information you supplied, I don't think permissions can be the cause. I'm more thinking of a file-in-use issue. You should make a debug build of your software and give that to your client. See what error is returned when attempting to open the jar file.<br><br>This does not seem to be an installer issue. If the problem is java-related, you should ask in a java-specific forum. Else, you could try the msdn forums.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">T.Slappy</span><br><span class="post-time small text-muted">5th March 2012 07:24 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Maybe you should create a list of processes which must be terminated before launching your installer.<br>If they are running ask the user to kill them [using KillProc plugin].</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">preuter</span><br><span class="post-time small text-muted">12th March 2012 00:19 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Thank you for the suggestions. I hadn't thought of file-in-use issues, since the error does show up even after installing/executing after a reboot.<br><br>I have added some addititonal diagnostics to the code that will hopefully give us some more data, but so far, the problem hasn't cropped up again (not unusual, it pops up every few weeks at most).</p></div><hr><div class="footer"><p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p></div></div><script src="../js/highlight.pack.js" type="text/javascript"></script><script type="text/javascript">//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]></script></body></html>