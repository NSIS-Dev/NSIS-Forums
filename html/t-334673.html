<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="description" content="Error opening File for writing:"><title>Error opening File for writing: - NSIS Forums</title><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script><link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css"><link rel="stylesheet" href="../css/style.css" type="text/css"><!--[if lt IE 9]><script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script><script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script><![endif]--></head><body><div class="container"><ol class="breadcrumb"><li><a href="../index.html" class="glyphicon glyphicon-home"></a></li><li><a href="f-65.html">NSIS Discussion</a></li><li class="active">Error opening File for writing:</li></ol><p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=334673">Error opening File for writing:</a></p><br><div class="post"><p class="post-meta"><span class="post-author text-primary">kalverson</span><br><span class="post-time small text-muted">12th September 2011 14:18 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>Error opening File for writing:</strong><br>Hello,<br><br>I am having a strange issue with this error message from a customer. The customer is installing on many systems and only has trouble on three of the systems. There is one specific file (A windows service exe file) that can not be overwritten by the Nullsoft installer. I have checked all the usual things; i.e. - Install is running on an Administrative account. The file is writable and the Administrator account has write permissions. I can rename the file just fine. The service is stopped and not running. Yet, still the install issues the error. The odd thing is it is only for that one exe file. All other files get written if the customer clicks Ignore button. The other thing that is strange, is it is the same file three systems that he is having this issue with. The systems are VM's; could the issue be with the VM software? I am at a lose to figure this one out.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Anders</span><br><span class="post-time small text-muted">12th September 2011 14:29 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Try running Process Monitor from Microsoft/Sysinternals and see what the error is...</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">kalverson</span><br><span class="post-time small text-muted">12th September 2011 18:26 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Thank you for your timely suggestion. After downloading the tool and doing some experimentation, I think this will work to find out what is wrong at the customer site. I just need to come up with a procedure that the customer can use to get and return the information now.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Anders</span><br><span class="post-time small text-muted">12th September 2011 19:17 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">It has some kind of logging IIRC so they just record and you can view the log later (Check the docs for command line parameters and just give them a batch file to execute or something)</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">kalverson</span><br><span class="post-time small text-muted">14th September 2011 19:51 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Our customer used link <a href="http://live.sysinternals.com" target="_blank">http://live.sysinternals.com</a> to get and use procexp.exe instead. He did a Process Explore Search for Handle or DLL substrings using the path to our service exe. He did get a match. It was Microsoft program wmiprvse.exe that appears to have a lock. However, my lock detection was not detecting that lock. It also turns out that another person has run into a similar situation during an install and renaming the file was the work around. That also works here for our customer. I could try implementing the lockedlist.zip plugin again, but I am not 100% sure that would catch it either if the exe can be manually renamed. My alternate oninit.nsh check of renaming the product install folder behind the scenes is passing; i.e. the rename works so no locked files detected.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">kalverson</span><br><span class="post-time small text-muted">16th September 2011 15:44 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Our customer was able to remove the lock on our file by stopping 5 services; the last one was Window Management Instrumentation. There was third party update software involve that was causing the issue. The customer is happy with the solution his windows network administrator provided to remove the lock. Also, thanks to Anders for suggesting the sysinternals tools. The customer also really liked the tool and thinks it will be handy going forward.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">MSG</span><br><span class="post-time small text-muted">16th September 2011 18:22 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Stopping services just because they're hogging a file... I wouldn't be happy if an uninstaller did that on my system! I strongly recommend reconsidering such a nazi apporach.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">kalverson</span><br><span class="post-time small text-muted">21st September 2011 15:43 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">I think you misunderstood, the customer was trying to update our software not uninstall our software. We do not stop any services that are not ours in our install or uninstall process.</p></div><hr><div class="footer"><p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p></div></div><script src="../js/highlight.pack.js" type="text/javascript"></script><script type="text/javascript">//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]></script></body></html>