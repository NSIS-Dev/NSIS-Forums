<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="description" content="Build NSIS problem"><title>Build NSIS problem - NSIS Forums</title><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script><link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css"><link rel="stylesheet" href="../css/style.css" type="text/css"></head><body><div class="container"><ol class="breadcrumb"><li><a href="../index.html" class="glyphicon glyphicon-home"></a></li><li><a href="f-65.html">NSIS Discussion</a></li><li class="active">Build NSIS problem</li></ol><p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=221872">Build NSIS problem</a></p><br><div class="post"><p class="post-meta"><span class="post-author text-primary">bluenet</span><br><span class="post-time small text-muted">19th July 2005 15:35 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>Build NSIS problem</strong><br>I have download source from CVS and installed Python and SCons, but when I open a console in source and type scons<br>I got a error: scons<br>not a command. What wrong for me?</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">kichik</span><br><span class="post-time small text-muted">19th July 2005 19:07 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Make sure scons.bat is in the path.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">bluenet</span><br><span class="post-time small text-muted">20th July 2005 01:21 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">I had add to path environment but got another error:<br><br>scons: *** No SConstruct file found.<br>File "G:\Python24\scons\SCons\Script\Main.py", line 891, in _main<br><br>I make sure SConscript is in currently path.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">kichik</span><br><span class="post-time small text-muted">21st July 2005 18:10 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Change the working directory to the directory where you put the NSIS source code. Make sure it contains a SConstruct file.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">bluenet</span><br><span class="post-time small text-muted">22nd July 2005 03:03 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Thanks kichik, I can rebuild NSIS.<br>These is another problem: I changed #define NSIS_MAX_STRLEN 1024 to #define NSIS_MAX_STRLEN 8192 and building NSIS, when I using this makensis.exe to compile a NSIS script I have found that all components missing only leave one. Is it a bug?</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">kichik</span><br><span class="post-time small text-muted">22nd July 2005 09:30 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">I don't understand. What component is missing?</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">bluenet</span><br><span class="post-time small text-muted">23rd July 2005 01:34 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">I have 3 section, if #define NSIS_MAX_STRLEN 1024, when build makensis.exe and then compile script, and running the installer, all section display in component page. But if #define NSIS_MAX_STRLEN 8192, the component page only display section 1.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">kichik</span><br><span class="post-time small text-muted">23rd July 2005 08:57 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">You must have forgot to install the stubs. The compiler created section structs with 8192 bytes for the name, but the stub reads them as 1024 and so misses the real two last sections. Don't copy anything from the build folder. Use 'scons PREFIX="C:\..." install' or 'scons dist' as instructed in Appendix G.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">JasonFriday13</span><br><span class="post-time small text-muted">27th July 2005 06:12 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">I have the same problem but different :weird:. I have followed the steps above but when it starts to compile it throws many errors. It says it is using mstoolkit but all I have is visual studio 6 pro edition. Then it has several commands following that, that have six or seven commands calling the resources (gdi32 and others) and after each command (there are about seven), it says 'bad command or filename' which is the error shown when the system can't find the program being called. Then there are several more errors, then it shows a dialog saying: 'this program has executed an invalid instruction. Click ok to end this program' or similar message. Any thoughts?</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">kichik</span><br><span class="post-time small text-muted">28th July 2005 18:59 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">How exactly does it say it's using MSTOOLKIT? It shouldn't be using it unless you pass MSTOOLKIT=yes on the command line.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">freeberm</span><br><span class="post-time small text-muted">28th July 2005 19:37 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>Another build problem...</strong><br>I have another build issue...<br><br>I downloaded the source for 2.08, downloaded python 2.4 and the latest version of SCons. When I attempt a build I get the following errors (seems like I am missing a header file?):<br>-------------------------<br>scons: Building targets ...<br>cl /nologo /O1 /W3 /c Contrib\AdvSplash\advsplash.c /Fobuild\release\AdvSplash\a<br>dvsplash.obj<br>advsplash.c<br>Contrib\AdvSplash\advsplash.c(214) : error C2065: 'LWA_ALPHA' : undeclared ident<br>ifier<br>Contrib\AdvSplash\advsplash.c(214) : error C2065: 'LWA_COLORKEY' : undeclared id<br>entifier<br>Contrib\AdvSplash\advsplash.c(244) : error C2065: 'WS_EX_LAYERED' : undeclared i<br>dentifier<br>Contrib\AdvSplash\advsplash.c(270) : error C2065: 'DWORD_PTR' : undeclared ident<br>ifier<br>Contrib\AdvSplash\advsplash.c(270) : error C2146: syntax error : missing ')' bef<br>ore identifier 'myWnd'<br>Contrib\AdvSplash\advsplash.c(270) : error C2198: 'timeSetEvent' : too few actua<br>l parameters<br>Contrib\AdvSplash\advsplash.c(270) : error C2059: syntax error : ')'<br>scons: *** [build\release\AdvSplash\advsplash.obj] Error 2<br>scons: building terminated because of errors.<br>-------------------------<br><br>If I attempt to skip the advsplash.c file, I get more errors further down the line on other files (another missing header file?):<br>-------------------<br>Creating library build\release\Library\TypeLib\TypeLib.lib and object build\r<br>elease\Library\TypeLib\TypeLib.exp<br>cl /nologo /O1 /W3 /TP /c Contrib\MakeLangId\MakeLangId.cpp /Fobuild\release\Mak<br>eLangId\MakeLangId.obj<br>MakeLangId.cpp<br>Contrib\MakeLangId\MakeLangId.cpp(13) : error C2065: 'LANG_INVARIANT' : undeclar<br>ed identifier<br>Contrib\MakeLangId\MakeLangId.cpp(29) : error C2065: 'LANG_DIVEHI' : undeclared<br>identifier<br>Contrib\MakeLangId\MakeLangId.cpp(37) : error C2065: 'LANG_GALICIAN' : undeclare<br>d identifier<br>Contrib\MakeLangId\MakeLangId.cpp(54) : error C2065: 'LANG_KYRGYZ' : undeclared<br>identifier<br>Contrib\MakeLangId\MakeLangId.cpp(62) : error C2065: 'LANG_MONGOLIAN' : undeclar<br>ed identifier<br>Contrib\MakeLangId\MakeLangId.cpp(79) : error C2065: 'LANG_SYRIAC' : undeclared<br>identifier<br>scons: *** [build\release\MakeLangId\MakeLangId.obj] Error 2<br>scons: building terminated because of errors.<br>--------------------<br><br>Any thoughts?</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">kichik</span><br><span class="post-time small text-muted">28th July 2005 20:04 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">You're missing the latest <a href="http://www.microsoft.com/downloads/details.aspx?FamilyId=A55B6B43-E24F-4EA3-A93E-40C0EC4F68E5&amp;displaylang=en" target="_blank">Platform SDK</a>.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">freeberm</span><br><span class="post-time small text-muted">28th July 2005 20:26 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">It doesn't look like I can install that since I am still using visual studio 6.0.<br><br>Thanks for your help... I'll just have to do without the LogSet option for now.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Joost Verburg</span><br><span class="post-time small text-muted">28th July 2005 22:16 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">You can use the Platform SDK with Visual Studio 6.0.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">freeberm</span><br><span class="post-time small text-muted">28th July 2005 23:10 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">According to the Microsoft site:<br>This SDK does not support working with Microsoft Visual C/C++Â®, 6.0 as support for VC 6.0 has ended. The last SDK that will work with VC 6.0 is the February 2003 Edition, you can order a CD on the fulfillment site. Side by side installations are not supported.<br>-------------------<br>They at least claim that you can't with the current version. Are you sure installing that won't screw things up?<br><br><br>BTW... thanks for the reply Joost!</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">kichik</span><br><span class="post-time small text-muted">29th July 2005 11:30 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Wow, that's nice of them. You can use the <a href="http://msdn.microsoft.com/visualc/vctoolkit2003/" target="_blank">Visual C++</a> toolkit instead. You'll still be able to work with Visual C++ 6 after installing it.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">freeberm</span><br><span class="post-time small text-muted">29th July 2005 13:04 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Thanks for finding this kichik! This site (forum, tools, and WinAmp for that matter...) rocks!<br><br>-------------------<br>I have Visual Studio or Visual C++. Do I need the Visual C++ Toolkit?<br>The Visual C++ Toolkit will work fine alongside installed versions of Visual Studio and Visual C++. If you already use Visual Studio .NET 2003, you do not need the Visual C++ Toolkit, unless you want to see the included samples. Everything else included in the Toolkit is included with Visual Studio .NET 2003.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">freeberm</span><br><span class="post-time small text-muted">29th July 2005 14:15 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Slight problem still...<br><br>I installed the VC++ toolkit without any conflicts. However it still doesn't work.<br><br>If I try to use the command 'scons MSTOOLKIT=yes' then I get an error that it can't find the platform SDK. This is due to the check in the mstoolkit.py file:<br>-------------------<br># look for platform sdk<br>if os.environ.has_key('MSSdk'):<br>PlatformSDKDir = os.path.normpath(os.environ['MSSdk'])<br>else:<br>try:<br>PlatformSDKDir = SCons.Util.RegGetValue(SCons.Util.HKEY_LOCAL_MACHINE, r'SOFTWARE\Microsoft\MicrosoftSDK\Directories\Install Dir')[0]<br>PlatformSDKDir = str(PlatformSDKDir)<br>except SCons.Util.RegError:<br>try:<br>PlatformSDKDir = SCons.Util.RegGetValue(SCons.Util.HKEY_LOCAL_MACHINE, r'SOFTWARE\Microsoft\MicrosoftSDK\InstalledSDKs\8F9E5EF3-A9A5-491B-A889-C58EFFECE8B3\Install Dir')[0]<br>PlatformSDKDir = str(PlatformSDKDir)<br>except SCons.Util.RegError:<br>raise SCons.Errors.InternalError, "The Platform SDK directory was not found in the registry or in the `MSSdk` environment variable."<br>------------------------<br><br>So I tried to fool the file by adding an environmental variable MSSdk that points to the C++ Toolkit installation, and I am back to the original errors.<br><br>Are you sure that this is due to the missing platform SDK? And if so, I guess the VC++ Toolkit isn't enough.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">kichik</span><br><span class="post-time small text-muted">29th July 2005 14:18 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">The VC Toolkit doesn't replace the Platform SDK, only VC 6. You still need the Platform SDK.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">freeberm</span><br><span class="post-time small text-muted">29th July 2005 21:51 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>still won't work... same errors</strong><br>So I went to another machine, installed Python, SCONS, and the 2003 platform SDK. I tried 'scons MSTOOLKIT=yes' and got an error saying it couldn't fine VC++ toolkit. So I installed that and tried again. Now it seems to pick up the toolkit, but I am back to the same errors I started with. Are you sure there isn't something missing from the source? One of the files even seems to have a syntax error according to the error messages... (see attached file)</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">kichik</span><br><span class="post-time small text-muted">30th July 2005 09:14 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">I'm sure nothing is missing from the source. Those errors are caused because of outdated header files. The updated header files are in the Platform SDK. Do you have the MSSDK environment variable defined properly? Notice that it fails to find basic libraries like gdi32, user32, etc. It seems something with the Platform SDK isn't configured or detected properly. Can you attach config.log?</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">freeberm</span><br><span class="post-time small text-muted">1st August 2005 14:41 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Thank you for all of your help Kichik. After I manually created a MSSdk environmental variable, it appears to compile correctly.<br><br>Sorry for all of the trouble... should have checked that myself after the install.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">JasonFriday13</span><br><span class="post-time small text-muted">2nd August 2005 01:57 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">This will probably make things even more bad. I have windows millenium edition (tumble-weed passes by). I have visited the microsoft site and found out that the ms toolkit and the platform sdk require windows xp (more tumble-weed passes by). Looks like I will have to stick with the binary for forever and a day.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">kichik</span><br><span class="post-time small text-muted">2nd August 2005 20:55 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Or upgrade to a real OS ;)</p></div><hr><div class="footer"><p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p></div></div><script src="../js/highlight.pack.js" type="text/javascript"></script><script type="text/javascript">//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]></script></body></html>