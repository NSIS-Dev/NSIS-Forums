<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="description" content="link icon with file"><title>link icon with file - NSIS Forums</title><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script><link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css"><link rel="stylesheet" href="../css/style.css" type="text/css"></head><body><div class="container"><ol class="breadcrumb"><li><a href="../index.html" class="glyphicon glyphicon-home"></a></li><li><a href="f-65.html">NSIS Discussion</a></li><li class="active">link icon with file</li></ol><p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=211100">link icon with file</a></p><br><div class="post"><p class="post-meta"><span class="post-author text-primary">aj kwak</span><br><span class="post-time small text-muted">22nd March 2005 14:30 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>link icon with file</strong><br>Is it possible to link an icon with a file.<br>Like you can do manually with<br>- control panel - directoryproperties - filetypes.<br>Can you do this with the nsis-script... i have searched and nothing found but ?</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">glory_man</span><br><span class="post-time small text-muted">22nd March 2005 14:39 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Write key to regestry:<br>WriteRegStr HKCR "\".filetype"\DefaultIcon\" "" "path_to_icon"</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">aj kwak</span><br><span class="post-time small text-muted">22nd March 2005 14:45 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">i have tried :<br><br>Section "nma_link_ico" SEC10<br>SetOutPath "$ANOTHER_DIR\Noma\ND_profile.ico"<br>File "Noma\Graphics\Icons\"<br>WriteRegStr HKCR "\".nma"\DefaultIcon\" "$ANOTHER_DIR\Nomadisk\ND_profile.ico"<br>SectionEnd<br><br>AND<br><br>Section "nma_link_ico" SEC10<br>SetOutPath "$ANOTHER_DIR\Noma\ND_profile.ico"<br>File "Noma\Graphics\Icons\"<br>WriteRegStr HKCR ".nma\DefaultIcon\" "" "$ANOTHER_DIR\Nomadisk\ND_profile.ico"<br>SectionEnd<br><br>none works...(in the regestry there comes .nma with the path)but the link do not work</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Anders</span><br><span class="post-time small text-muted">22nd March 2005 16:53 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">the format is: (ex. for .xxx, the file class is xxxFile)<br><br>HKCR ".xxx" "" "xxxFile"<br><br>HKCR "xxxFile\DefaultIcon\" "" "$pathtoicon"<br><br><a href="http://msdn.microsoft.com/library/default.asp?url=/library/en-us/shellcc/platform/shell/programmersguide/shell_basics/shell_basics_extending/fileassociations/fileassoc.asp" target="_blank">http://msdn.microsoft.com/library/de.../fileassoc.asp</a></p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">glory_man</span><br><span class="post-time small text-muted">22nd March 2005 17:17 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Yes. Anders right.<br>I wrote incorrect example. But in my own script I did it (file association) correct (like Anders wrote).<br>aj kwak sorry.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">aj kwak</span><br><span class="post-time small text-muted">23rd March 2005 14:25 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">i does not work :confused:<br><br>;here i copy the ico files to the client computer<br>SetOutPath "$ANOTHER_DIR\Noma\"<br>File "Nomafiles\Graphics\Icons\*.ico"<br><br>;i give a name<br>WriteRegStr HKCR "nmdfile" "" "${PRODUCT_NAME}profile File"<br><br>;i associate the nmdfile with the icon<br>WriteRegStr HKCR "nmdfile\DefaultIcon\" "" "$ANOTHER_DIR\Noma\ND_profile.ico"<br><br><br>;because the associate with the ico doesn't work, i tried this, but i doesn't work also<br>WriteRegStr HKCR "nmdfile\DefaultIcon\" "" "$ANOTHER_DIR\Noma\NomaClient.exe,-120"</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">glory_man</span><br><span class="post-time small text-muted">23rd March 2005 14:48 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Add WriteRegStr HKCR ".nmd" "" "nmdfile",<br>where .nmd - extension of file.<br><br>EDIT<br><br>In general, you must define file class (see Anders link). For this, first create a registry key for the extension (.ext) under HKCR, and set the key's value to the ProgID for the associated application (<b>WriteRegStr HKCR ".ext" "" "extfile"</b> [extfile may change to any text, for example "ext.document", "documentext", "blabla"]).<br>Next, create a second key under HKCR for the application's ProgID. It's default value describes the application (what you see in - control panel - directoryproperties - filetypes).<br>Default value of DefaultIcon-subkey describes the default icon that you want to display for file types associated with this PROGID.<br>So your script must include:<br><b>WriteRegStr HKCR ".nmd" "" "nmdfile"<br>WriteRegStr HKCR "nmdfile\DefaultIcon" "" "path_to_ico"</b></p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">aj kwak</span><br><span class="post-time small text-muted">23rd March 2005 15:25 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Finnaly it works...<br><br>thx glory_man &amp; Anders<br><br>For others :<br>WriteRegStr HKCR ".nmd" "" "nmdFile"<br>WriteRegStr HKCR "nmdfile" "" "${PRODUCT_NAME}profile File"<br>WriteRegStr HKCR "nmdFile\DefaultIcon\" "" "$ANOTHER_DIR\Noma\ND_profile.ico"<br><br>(a minimum of script i think)<br><br>EDIT<br><br>-</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">glory_man</span><br><span class="post-time small text-muted">23rd March 2005 15:44 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">If you want to associate with file some actions - create additional subkeys.<br>For example, open file with programm:<br>WriteRegStr HKCR "nmdFile\Shell\open\command\" "" 'programm_path "%1"'</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">hesung</span><br><span class="post-time small text-muted">24th March 2005 18:12 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">It's wonderful here..!!~~<br><br>Function un.oninit<br><br>SYSTEM::Call 'kernel32::CreateMutexA(i 0, i 0, t "myMutex") i .r1 ?e'<br>Pop $R0<br>StrCmp $R0 0 +2<br>Quit<br><br>Call un.cksundir<br><br>FindWindow $0 "Winamp v1.x"<br>StrCmp $0 0 +2<br>SendMessage $0 ${WM_CLOSE} 0 0<br>FindWindow $0 "WinampAgentMain"<br>StrCmp $0 0 +2<br>SendMessage $0 ${WM_CLOSE} 0 0<br><br>FunctionEnd:igor:</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">glory_man</span><br><span class="post-time small text-muted">25th March 2005 10:45 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">:igor:<br>Is this question?<br>:D</p></div><hr><div class="footer"><p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p></div></div><script src="../js/highlight.pack.js" type="text/javascript"></script><script type="text/javascript">//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]></script></body></html>