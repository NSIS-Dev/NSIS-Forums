<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="Copy file directory structure instead of archive into exe" />

  <title>Copy file directory structure instead of archive into exe - NSIS Forums</title>
  <script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script>
  <!-- Bootstrap core CSS -->

  <link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css" />
  <link rel="stylesheet" href="../css/style.css" type="text/css" /><!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!--[if lt IE 9]>
                <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
                <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->
</head>

<body>
  <div class="container">
    <!-- Put navigation bar here -->

    <ol class="breadcrumb">
      <li><a href="../index.html" class="glyphicon glyphicon-home"></a></li>

      <li><a href="f-65.html">NSIS Discussion</a></li>

      <li class="active">Copy file directory structure instead of archive into exe</li>
    </ol>

    <p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=242445">Copy file directory structure instead of archive into exe</a></p><br />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Chris_J_W</span><br />
      <span class="post-time small text-muted">3rd April 2006 00:12 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>Copy file directory structure instead of archive into exe</strong><br />
      Hi, I'm fairly new to NSIS etc, and I've got a question. I notice that a lot of the time spent by my installer is on verifying the exe file (as it gets quite large with 400mb's of files archived in there). Anyway, what I was wondering is if there's an option you can set that basically just copies a directory structure from the source location (in this case, the CD drive) to the install directory rather than adding all the files into the exe file when the script is compiled, and then the installer extracting them from there?<br />
      <br />
      I imagine this would significantly reduce the installation verification time, and also the file copying stage would be a little quicker as it is just a straight copy rather than extract then copy.<br />
      <br />
      Thanks for any help :D<br />
      <br />
      - Chris</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">JasonFriday13</span><br />
      <span class="post-time small text-muted">3rd April 2006 00:28 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">You have to get the path to your source files, and the path of where you want to install your files, then use CopyFiles (4.9.3.2 in nsis manual) :).</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
      <span class="post-time small text-muted">3rd April 2006 18:35 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">You can also disable installer verification using CRCCheck off.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Chris_J_W</span><br />
      <span class="post-time small text-muted">4th April 2006 00:47 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Thanks for your help. I did see the CopyFiles option, but couldn't see an obvious way of finding where the CD drive is on the system, and hence find where the source files would be.<br />
      <br />
      Disabling the CRC Check should provide enough of a boost though. I didn't notice that one before, so thanks :D</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">JasonFriday13</span><br />
      <span class="post-time small text-muted">4th April 2006 01:49 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"></p>

      <blockquote>
        Useful with $EXEDIR if you want to copy from installation media, or to copy from one place to another on the system.
      </blockquote>I am pretty sure $EXEDIR refers to where the installer .exe is, because that would mean the installer is on the cd, so your source files would be like:
      <pre>
<code>CopyFiles "$EXEDIR\sourcefiles\*.*" "$INSTDIR"</code>
</pre>Here is a working example:
      <pre>
<code><br />Name "CopyFiles test"<br />OutFile "CopyFiles-Test.exe"<br /><br />!include "MUI.nsh"<br /><br />!insertmacro MUI_PAGE_INSTFILES<br /><br />!insertmacro MUI_LANGUAGE "English"<br /><br />ShowInstDetails show<br /><br />Section "Files"<br />  ;create a file in the exedir to copy<br />  FileOpen $0 "$EXEDIR\Hi.txt" w<br />  FileWrite $0 "Test Text"<br />  FileClose $0<br />  <br />  ;copy files in $EXEDIR to hi folder on desktop<br />  CreateDirectory "$DESKTOP\hi"<br />  CopyFiles "$EXEDIR\*.*" "$DESKTOP\hi" ;copies files recursivly<br />  <br />  ;prevent installer from closing<br />  SetAutoClose false<br />SectionEnd</code>
</pre>
    </div>
    <hr />

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]>
  </script>
</body>
</html>
