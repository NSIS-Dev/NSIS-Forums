<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="description" content="NSIS Newbie: a couple of questions"><title>NSIS Newbie: a couple of questions - NSIS Forums</title><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script><link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css"><link rel="stylesheet" href="../css/style.css" type="text/css"></head><body><div class="container"><ol class="breadcrumb"><li><a href="../index.html" class="glyphicon glyphicon-home"></a></li><li><a href="f-65.html">NSIS Discussion</a></li><li class="active">NSIS Newbie: a couple of questions</li></ol><p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=322855">NSIS Newbie: a couple of questions</a></p><br><div class="post"><p class="post-meta"><span class="post-author text-primary">mabian</span><br><span class="post-time small text-muted">1st October 2010 17:52 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>NSIS Newbie: a couple of questions</strong><br>Hello,<br><br>I'm starting with my first NSIS script, reading docs and looking at examples.<br><br>Two questions:<br><br>I have something like this:<br><br></p><pre>
<code>!define C_VERSION "1.0.0"<br>!define C_APPNAME "MYTEST"<br><br>Var P_ServiceName<br>Var P_FullName<br><br>Function .onInit<br>    ReadEnvStr $P_ServiceName EMS_SERVICEID<br>    StrCpy $P_FullName "${C_APPNAME}_$P_ServiceName"<br><br>   MessageBox MB_YESNO "This will install $P_FullName. Continue?" IDYES NoAbort<br>     Abort ; causes installer to quit.<br><br>   NoAbort:<br>FunctionEnd</code>
</pre><br>
      <br>
      The messagebox shows $P_FullName doesn't include the value set for the EMS_SERVICEID environment variable (through $P_ServiceName). Am I missing something?<br>
      <br>
      Another question: is it possible to supply a string as parameter to the install program and have the installer get and use the string for building the default install path name etc?<br>
      <br>
      Thanks a lot,<br>
      Mario
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Animaether</span><br>
      <span class="post-time small text-muted">1st October 2010 17:58 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">1. Are you sure the env string -is- in $P_ServiceName after the ReadEnvStr call? Might want to double-check with a MessageBox.<br>
      2. Yes - See the documentation: E.1.11 GetParameters</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">MSG</span><br>
      <span class="post-time small text-muted">1st October 2010 17:59 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"></p>

      <blockquote>
        <small>Originally posted by mabian</small><br>
        The messagebox shows $P_FullName doesn't include the value set for the EMS_SERVICEID environment variable (through $P_ServiceName). Am I missing something?
      </blockquote>Try MessageBoxing the return value of your ReadEnvStr command.<br>
      <br>

      <blockquote>
        <small>Originally posted by mabian</small><br>
        Another question: is it possible to supply a string as parameter to the install program and have the installer get and use the string for building the default install path name etc?
      </blockquote>Yes, there is a standard command line parameter for this. I don't know from memory, but I'm sure google can help you there.<br>
      <br>
      <br>
      Edit: Drats. Foiled again! &gt;_&gt;
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">mabian</span><br>
      <span class="post-time small text-muted">1st October 2010 18:07 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"></p>

      <blockquote>
        <small>Originally posted by Animaether</small><br>
        1. Are you sure the env string -is- in $P_ServiceName after the ReadEnvStr call? Might want to double-check with a MessageBox.<br>
        2. Yes - See the documentation: E.1.11 GetParameters
      </blockquote>1. Indeed, $P_ServiceName is empty, but why? If I open a command prompt and type SET, the env string is not empty<br>
      2. Ok, do I need to do manual parsing of the parameter string?<br>
      <br>
      Thank you!<br>
      <br>
      - Mario
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Animaether</span><br>
      <span class="post-time small text-muted">1st October 2010 18:10 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">1. No idea - but keep in mind that if you set an evironment variable outside of your installer, your installer may not be aware of that environment variable as it wasn't present when your installer started.<br>
      <br>
      2. The very next bit in the documentation - E.1.12 GetOptions - should help you ;) Depending on what you want to do, there may be some manual parsing of values involved, though.</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">mabian</span><br>
      <span class="post-time small text-muted">1st October 2010 18:16 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Ok, dunno about the environment variable, but I needed a way to pass a string to the installer, and getparameters + getoptions made it in a breeze.<br>
      <br>
      Problem solved.<br>
      <br>
      Thank you!<br>
      <br>
      - Mario</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Animaether</span><br>
      <span class="post-time small text-muted">1st October 2010 18:23 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">oi.. yes, command line parameters are infinitely preferable to environment variables :)</p>
    </div>
    <hr>

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]></script></body></html>