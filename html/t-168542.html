<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="Adding Reg Keys From .reg File?" />

  <title>Adding Reg Keys From .reg File? - NSIS Forums</title><!-- Bootstrap core CSS -->
  <link rel="stylesheet" type="text/css" href="//netdna.bootstrapcdn.com/bootswatch/3.0.1/readable/bootstrap.min.css" />
  <link rel="stylesheet" href="../css/style.css" type="text/css" /><!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!--[if lt IE 9]>
                <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
                <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->
</head>

<body>
  <div class="container">
    <!-- Put navigation bar here -->

    <ol class="breadcrumb">
      <li><a href="../index.html" class="glyphicon glyphicon-home"></a></li>

      <li><a href="f-65.html">NSIS Discussion</a></li>

      <li class="active">Adding Reg Keys From .reg File?</li>
    </ol>

    <p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=168542">Adding Reg Keys From .reg File?</a></p><br />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Shea</span><br />
      <span class="post-time small text-muted">8th February 2004 06:07 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>Adding Reg Keys From .reg File?</strong><br />
      Is it possible to have NSIS download a .reg file from a server and then add the keys in it to the registry?</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">deguix</span><br />
      <span class="post-time small text-muted">8th February 2004 10:44 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">EDIT: See this Archive page <a href="http://nsis.sourceforge.net/archive/viewpage.php?pageid=296" target="_blank">Reg2Nsis - convert registry info into NSIS commands</a><br />
      <br />
      But I never used it. And it's big (164 kb).</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">VegetaSan</span><br />
      <span class="post-time small text-muted">8th February 2004 11:18 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">I dont know that register part but what I do know is<br />
      how to donwload a file :<br />
      ;----------------------------------------------------------<br />
      <br />
      EXAMPLE :<br />
      file = bla.exe<br />
      directory = $PROGRAMFILES<br />
      ; the name and directory you want<br />
      StrCpy $2 "$PROGRAMFILES\bla.extension"<br />
      ; the url (dont set " between the url)<br />
      NSISdl::download URL://....... $2<br />
      Pop $0<br />
      ; if you want to open the file<br />
      ExecWait "$PROGRAMFILES\bla.exe"<br />
      <br />
      ;----------------------------------------------------------<br />
      <br />
      NOTE : MUST BE IN A SECTION</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Vytautas</span><br />
      <span class="post-time small text-muted">8th February 2004 11:48 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">You could also use the ExecShell command to import the registry file, however you will get an extra dialogs asking if you want to import the specified file and saying that the import was sucessfull. Unless there is an option to make regedit run in silent mode?<br />
      <br />
      Vytautas</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Joost Verburg</span><br />
      <span class="post-time small text-muted">8th February 2004 11:52 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">It's not a good idea to rely on external applications like regedit.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Vytautas</span><br />
      <span class="post-time small text-muted">8th February 2004 11:58 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">I know that is the case in general, but I do not see any harm in relying on regedit, it is available in all windows version.<br />
      <br />
      Especially since, from my understanding of the original question, the info in the .reg file is not available at the compile time and thus cannot be converted into an NSIS script. Therefore you have two options. One is to rely on an external program, regedit, or two to get your NSIS script to manually phrase the downloaded .reg file and then run equivalent NSIS commands.<br />
      <br />
      Personally I think that the first option would be more efficient and less error prone.<br />
      <br />
      Vytautas</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">deguix</span><br />
      <span class="post-time small text-muted">8th February 2004 14:46 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">.reg files are like .ini files... so have a way to do that with functions. Am I right? (the difference is that .reg files have a starting word to indentify if it's a .reg file)</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Shea</span><br />
      <span class="post-time small text-muted">8th February 2004 16:52 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">There is a Batch file command to import reg keys silently, but then you get the batch dialog.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Breepee</span><br />
      <span class="post-time small text-muted">8th February 2004 19:51 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"></p>

      <blockquote>
        <i>Originally posted by deguix</i><br />
        <b>EDIT: See this Archive page <a href="http://nsis.sourceforge.net/archive/viewpage.php?pageid=296" target="_blank">Reg2Nsis - convert registry info into NSIS commands</a><br />
        <br />
        But I never used it. And it's big (164 kb).</b>
      </blockquote>That's neat! Thanks!
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">deguix</span><br />
      <span class="post-time small text-muted">9th February 2004 02:43 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"></p>

      <blockquote>
        There is a Batch file command to import reg keys silently, but then you get the batch dialog.
      </blockquote>But in this case have the nsExec plugin to just get the output.
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Shea</span><br />
      <span class="post-time small text-muted">9th February 2004 14:05 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Ok I have an idea:<br />
      <br />
      Have nsDl download the reg file from the net into the Temp folder<br />
      Make a batch file with the lines regedit.exe /s C:\Windows\Temp\TheRegFile.reg which tells the batch not to show the Are you sure dialog.<br />
      Then we have nsExec execute the batch without the dialog and everything goes well.<br />
      <br />
      Do you think that would work?</p>
    </div>
    <hr />

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]>
  </script>
</body>
</html>
