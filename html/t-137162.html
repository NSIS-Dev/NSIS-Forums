<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="Help! Writing to files from a Message Box" />

  <title>Help! Writing to files from a Message Box - NSIS Forums</title><!-- Bootstrap core CSS -->
  <link rel="stylesheet" type="text/css" href="//netdna.bootstrapcdn.com/bootswatch/3.0.1/readable/bootstrap.min.css" />
  <link rel="stylesheet" href="../css/style.css" type="text/css" /><!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!--[if lt IE 9]>
                <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
                <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->
</head>

<body>
  <div class="container">
    <!-- Put navigation bar here -->

    <ol class="breadcrumb">
      <li><a href="../index.html" class="glyphicon glyphicon-home"></a></li>

      <li><a href="f-65.html">NSIS Discussion</a></li>

      <li class="active">Help! Writing to files from a Message Box</li>
    </ol>

    <p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=137162">Help! Writing to files from a Message Box</a></p><br />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">nilpo</span><br />
      <span class="post-time small text-muted">30th May 2003 15:39 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>Help! Writing to files from a Message Box</strong><br />
      I am creating an installer that will write to a text file with the results from a message box.<br />
      <br />
      I have an INF file that I am installing. However one line must be changed on each install to reflect a model number provided by the user upon installation.<br />
      <br />
      I have broken the file into two parts:<br />
      <br />
      file1.dat (the portion before the edited line)<br />
      file2.dat (the portion following the edited line)<br />
      <br />
      I want the message box to request that the user enter a model number. Then I want to store that information so that I can write it to a file later in the form:<br />
      <br />
      model=<b><i>user info here</i></b><br />
      <br />
      Finally I would like to add the contents of the first dat file, then the line we created above, and finally the contents of the second dat file to create one INF file. All of the files mentioned can be treated as standard text files.<br />
      <br />
      Is there a way to do this?<br />
      <br />
      Any help is appreciated.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
      <span class="post-time small text-muted">30th May 2003 16:11 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">See the text file manipulation section on the NSIS archive:<br />
      <br />
      <a href="http://nsis.sourceforge.net/archive/nsisweb.php?page=311&amp;instances=0,11" target="_blank">http://nsis.sourceforge.net/archive/...instances=0,11</a><br />
      <br />
      For<br />
      model=user info here<br />
      use WriteINIStr<br />
      which will write e.g.<br />
      [model]<br />
      model=user info here<br />
      <br />
      -Stu</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">nilpo</span><br />
      <span class="post-time small text-muted">30th May 2003 16:20 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Sry I'm a newbie.<br />
      <br />
      I understand what you are saying to write to the file.<br />
      <br />
      But how can I create a message box (or some sort of text input) in the installer so that the user can enter the value to be used?</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
      <span class="post-time small text-muted">30th May 2003 17:19 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">You need to make a custom page using InstallOptions.<br />
      See Contrib\InstallOptions\Reamde.html for documentation.<br />
      <br />
      -Stu</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">nilpo</span><br />
      <span class="post-time small text-muted">30th May 2003 17:46 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Okay now I can create the INI file to display the prompt screen and I can type the returned information to my INF file.<br />
      <br />
      Still stuck though.<br />
      <br />
      How do I instruct my installer to load the INI file, and how do I call the return from the prompt (assign it to a variable for example)?<br />
      <br />
      <br />
      Maybe these questions are answered in the documentation, but I must be missing something.<br />
      <br />
      Thanks for the help so far.<br />
      <br />
      Also, is there a way to determine the dimensions of the installer window from within the script so that I can center my prompt in the window?</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
      <span class="post-time small text-muted">30th May 2003 17:53 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">The examples in Contrib\InstallOptions\test.nsi and Examples\Modern UI\InstallOptions.nsi show you how to show the page, and read the user input.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">nilpo</span><br />
      <span class="post-time small text-muted">30th May 2003 17:54 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Sorry. I found the info on how to implement the INI file and how to call up the returned value in my script in the Install Options documentation.<br />
      <br />
      I'm assuming that the InstallOptions dll will also have to be included in the installer.<br />
      <br />
      Thanks for all your help.<br />
      <br />
      :)</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
      <span class="post-time small text-muted">30th May 2003 17:56 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Once you use a line such as:<br />
      <br />
      InstallOptions::show<br />
      <br />
      NSIS automatically includes the plug-in into the installer.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">nilpo</span><br />
      <span class="post-time small text-muted">30th May 2003 18:34 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>Thanks</strong><br />
      Thanks for all the help. I think I can probably figure it out now.<br />
      <br />
      I appreciate it.<br />
      <br />
      :)</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
      <span class="post-time small text-muted">30th May 2003 20:01 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">No problem.<br />
      <br />
      -Stu</p>
    </div>
    <hr />

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]>
  </script>
</body>
</html>
