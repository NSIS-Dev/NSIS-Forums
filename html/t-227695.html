<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="Library.nsh" />

  <title>Library.nsh - NSIS Forums</title><!-- Bootstrap core CSS -->
  <link rel="stylesheet" type="text/css" href="//netdna.bootstrapcdn.com/bootswatch/3.0.1/readable/bootstrap.min.css" />
  <link rel="stylesheet" href="../css/style.css" type="text/css" /><!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!--[if lt IE 9]>
                <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
                <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->
</head>

<body>
  <div class="container">
    <!-- Put navigation bar here -->

    <ol class="breadcrumb">
      <li><a href="../index.html" class="glyphicon glyphicon-home"></a></li>

      <li><a href="f-65.html">NSIS Discussion</a></li>

      <li class="active">Library.nsh</li>
    </ol>

    <p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=227695">Library.nsh</a></p><br />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">pabs</span><br />
      <span class="post-time small text-muted">5th October 2005 10:00 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>Library.nsh</strong><br />
      In Include/Library.nsh, I see several lines like this:</p>

      <blockquote>
        !include "${NSISDIR}\Bin\LibraryLocal.nsh"
      </blockquote>If the user isn't logged in as an Administrator, then this won't work because they won't be able to edit/create files in ${NSISDIR}\Bin\. This is in version 2.10 BTW.
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
      <span class="post-time small text-muted">7th October 2005 14:43 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Thanks, fixed.<br />
      <br />
      I've added !tempfile and !delfile, modified LibraryLocal to accept an output file on the command line and updated Library.nsh to use it.<br />
      <br />
      !tempfile uses mkstemp on *nix and !delfile simply uses unlink. They can be used to fix the portability issues in LogicLib.nsh. However, there's still a problem with the quoting in the !system call.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">pabs</span><br />
      <span class="post-time small text-muted">8th October 2005 11:17 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Excellent news, thanks! Should be able to fix the !system quoting in a cross-platform way - IIRC, cmd.exe can use "quoted text", and probably command.com too.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
      <span class="post-time small text-muted">8th October 2005 12:34 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">It can use quoted text, but echo itself takes the line as is. Using:</p>
      <pre>
<code>echo "asd"</code>
</pre>will output:
      <pre>
<code>"asd"</code>
</pre>Even if there's a switch for cmd.exe or command.com to treat the quotes otherwise, how can you call cmd.exe with the switch in a portable method?
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">pabs</span><br />
      <span class="post-time small text-muted">9th October 2005 12:04 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Hmm. I see 2 options:<br />
      <br />
      Set an environment variable or registry item to enable the correct quoting on Windows. Not sure if this is available.<br />
      <br />
      Instead of using echo, would it be possible to create file writing functions like !fileopen, !fileread, !filewrite and !fileclose? These would be build-time functions.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
      <span class="post-time small text-muted">9th October 2005 13:56 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">I was actually thinking of adding !fileappend and !filereadline while I was at it. But I didn't want to bloat it too much. But I guess I'll add it anyway, unless someone has a better idea for this.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Comm@nder21</span><br />
      <span class="post-time small text-muted">9th October 2005 14:13 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">when you add more build functions ...<br />
      why not simply remove all and replace them by:<br />
      !compiletime<br />
      !compiletimeend<br />
      <br />
      every plain nsis code between those lines then will be run immediatly. :D<br />
      just an idea ...</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
      <span class="post-time small text-muted">9th October 2005 14:55 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">That'd require a weird merger between the exehead code and the compiler code. How would you handle defines? How will !ifdef be done? It'd also not work on POSIX because the exehead code is very Windows specific.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Comm@nder21</span><br />
      <span class="post-time small text-muted">9th October 2005 19:15 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">hey, this has been more or less a fun posting :D</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
      <span class="post-time small text-muted">12th October 2005 16:33 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">I've added !appendfile.</p>
    </div>
    <hr />

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]>
  </script>
</body>
</html>
