<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="description" content="Using Variables in the uninstall section"><title>Using Variables in the uninstall section - NSIS Forums</title><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script><link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css"><link rel="stylesheet" href="../css/style.css" type="text/css"></head><body><div class="container"><ol class="breadcrumb"><li><a href="../index.html" class="glyphicon glyphicon-home"></a></li><li><a href="f-65.html">NSIS Discussion</a></li><li class="active">Using Variables in the uninstall section</li></ol><p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=111247">Using Variables in the uninstall section</a></p><br><div class="post"><p class="post-meta"><span class="post-author text-primary">Paul_Hammons</span><br><span class="post-time small text-muted">24th October 2002 15:26 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>Using Variables in the uninstall section</strong><br>I am using install options to have a user enter a information that I am tagging onto the end of a filename and creating a custom directory. The install works just fine, but it appears that the uninstaller is not being created with the variable information. When I view the detail in during an uninstall, where the variables are located in the script, there is a blank space in the uninstall detail.<br><br>Examples below:<br>Install line:<br>CopyFiles /Silent /Filesonly "$EXEDIR\eSecureTail.exe" "$WINDIR\$R2.exe" 58<br><br>Uninstall line:<br>Delete "$WINDIR\$R2.exe"<br><br>and<br><br>UninstallText "This will uninstall $R2 from your system"<br><br>In the uninstall text, it displays "$R2" in the text, it doesn't convert it to the value of the variable.<br><br>Any help would be greatly appreciated.<br>-Paul</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Joost Verburg</span><br><span class="post-time small text-muted">24th October 2002 15:41 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">How would the uninstaller know the value of $R2?<br><br>You have to save that variable somewhere (for example, in the registry) and read it in the uninstaller.<br><br>UninstallText is an installer atribute, so you cannot use a variable in it:<br><br></p><blockquote>The commands below all adjust attributes of the installer. These attributes control how the installer looks and functions, including which pages are present in the installer, as what text is displayed in each part of each page, how the installer is named, what icon the installer uses, the default installation directory, what file it writes out, and more. Note that these attributes can be set anywhere in the file except in a Section or Function. With the exception of InstallDir, none of these attributes allow use of Variables other than $\r and $\n in their strings.</blockquote></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Paul_Hammons</span><br><span class="post-time small text-muted">24th October 2002 16:24 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">I understand the installdir text part, but what is confusing me is that the uninstaller knows $INSTDIR and $WINDIR. I would assume that these values are expanded into the uninstaller command lines when the uninstaller is created.<br><br>The uninstaller also gets this line correct....<br>DeleteRegKey HKEY_LOCAL_MACHINE "SOFTWARE\e-Security\eSecureTail\$R2"<br><br>and<br><br>Delete "$INSTDIR\$R2\uninst.exe"<br><br>But not this.....<br><br>ExecWait "net stop $R2"<br><br>It seems like in some cases the variable is converted to the value when it creates the uninstaller and sometimes not.....<br><br>Is there a way to get user input when uninstalling? Maybe use install options in the uninstall section?</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Joost Verburg</span><br><span class="post-time small text-muted">24th October 2002 16:40 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">$INSTDIR and $WINDIR are automatically set by the uninstaller ($INSTDIR is the directory where the uninstaller is located, $WINDIR can be retrieved using an API function).<br><br>$R2 is a normal general purpose variable. It's just in the memory when the installer runs, but it will not be saved to the disk. The uninstaller is a separate application which does not know anything about the installer variables.<br><br>$R2 in the uninstaller is empty by default. If you want to use the user input in the uninstaller, you should save this value to the disk.<br><br>Installer &gt; Write $R2 to registry<br>Uninstaller &gt; Get $R2 from registry</p></div><hr><div class="footer"><p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p></div></div><script src="../js/highlight.pack.js" type="text/javascript"></script><script type="text/javascript">//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]></script></body></html>