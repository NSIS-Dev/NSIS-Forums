<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="description" content="Start Menu Folder Problem"><title>Start Menu Folder Problem - NSIS Forums</title><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script><link rel="preload" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css" as="style" onload="this.rel='stylesheet'"><link rel="preload" href="../css/style.css" as="style" onload="this.rel='stylesheet'"><noscript><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css"><link rel="stylesheet" href="../css/style.css"></noscript><script>!function(a){"use strict";var b=function(b,c,d){function e(a){return h.body?a():void setTimeout(function(){e(a)})}function f(){i.addEventListener&&i.removeEventListener("load",f),i.media=d||"all"}var g,h=a.document,i=h.createElement("link");if(c)g=c;else{var j=(h.body||h.getElementsByTagName("head")[0]).childNodes;g=j[j.length-1]}var k=h.styleSheets;i.rel="stylesheet",i.href=b,i.media="only x",e(function(){g.parentNode.insertBefore(i,c?g:g.nextSibling)});var l=function(a){for(var b=i.href,c=k.length;c--;)if(k[c].href===b)return a();setTimeout(function(){l(a)})};return i.addEventListener&&i.addEventListener("load",f),i.onloadcssdefined=l,l(f),i};"undefined"!=typeof exports?exports.loadCSS=b:a.loadCSS=b}("undefined"!=typeof global?global:this);!function(a){if(a.loadCSS){var b=loadCSS.relpreload={};if(b.support=function(){try{return a.document.createElement("link").relList.supports("preload")}catch(b){return!1}},b.poly=function(){for(var b=a.document.getElementsByTagName("link"),c=0;c<b.length;c++){var d=b[c];"preload"===d.rel&&"style"===d.getAttribute("as")&&(a.loadCSS(d.href,d,d.getAttribute("media")),d.rel=null)}},!b.support()){b.poly();var c=a.setInterval(b.poly,300);a.addEventListener&&a.addEventListener("load",function(){b.poly(),a.clearInterval(c)}),a.attachEvent&&a.attachEvent("onload",function(){a.clearInterval(c)})}}}(this);</script></head><body><div class="container"><ol class="breadcrumb"><li><a href="../index.html" class="glyphicon glyphicon-home"></a></li><li><a href="f-65.html">NSIS Discussion</a></li><li class="active">Start Menu Folder Problem</li></ol><p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=157912">Start Menu Folder Problem</a></p><br><div class="post"><p class="post-meta"><span class="post-author text-primary">alan93</span><br><span class="post-time small text-muted">28th November 2003 18:47 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>Start Menu Folder Problem</strong><br>The first version of my program was 1.0.0<br><br>So I did this:<br><br>!define VERSION "1.0.0"<br><br>This writes<br>MyProgramName 1.0 to the following key<br>HKEY_LOCAL_MACHINE\SOFTWARE\MyProgramName<br>string: Start Menu Folder<br>value: MyProgramName 1.0<br><br>Now when I change to this<br>!define VERSION "1.1.0"<br><br>All the install dialogs say 1.1.0 except<br>the "Choose Start Menu Folder" dialog. It still displays<br>MyProgramName 1.0<br><br>from the first install<br><br>Do I have to change this registry entry on every install(update)?<br>If so how?<br><br>or another option</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">alan93</span><br><span class="post-time small text-muted">28th November 2003 18:51 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>this too</strong><br>Here's what I have for the pages<br><br>;Start Menu Folder Page Configuration<br>!define MUI_STARTMENUPAGE_REGISTRY_ROOT "HKLM"<br>!define MUI_STARTMENUPAGE_REGISTRY_KEY "Software\MyProgramName"<br>!define MUI_STARTMENUPAGE_REGISTRY_VALUENAME "Start Menu Folder"<br><br>I'm not even sure why or how the version number shows up in this registry entry, because the shortcuts don't show it.<br><br>?</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Joost Verburg</span><br><span class="post-time small text-muted">28th November 2003 19:59 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">You have configured the Start Menu Folder Page to remember the last used Start Menu Folder. I recommend you not to add a version number to the folder name.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">alan93</span><br><span class="post-time small text-muted">28th November 2003 21:07 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">where am I adding a version to the folder name?<br>or do you mean program name?<br><br>Becauase I do have this:<br><br>;Configuration<br><br>;General<br>!define VERSION "1.1.0"<br>Name "MyProgramName ${VERSION}"</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">alan93</span><br><span class="post-time small text-muted">28th November 2003 21:18 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>Man How do I get rid of this!</strong><br>I am trying to delete that first install version number on subsequent installs but can't even delete it using:<br><br>;Start Menu Folder - this can be removed later<br>WriteRegStr HKLM "SOFTWARE\MyProgramName "Start Menu Folder" "MyProgramName" //instead of "MyProgramName 1.0"</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">alan93</span><br><span class="post-time small text-muted">28th November 2003 21:38 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>Totally lost now</strong><br>I have deleted the key manually<br><br>DeleteRegKey HKLM "SOFTWARE\MyProgramName" //which had MyProgramName 1.0<br><br>and it still shows up in "Chose Start Menu Folder" !!!????<br><br>I have searched the registry for this and can't find it! Where is it getting it from?</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Joost Verburg</span><br><span class="post-time small text-muted">28th November 2003 21:41 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">It really gets it from the key you have set in your script.<br><br>If you have not set MUI_STARTMENUPAGE_DEFAULTFOLDER it will use the name.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">alan93</span><br><span class="post-time small text-muted">28th November 2003 21:44 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">But I don't have version or 1.0 used anywhere in the script.<br><br>??<br><br><br>So its not in the script and its not in the registry.<br><br>??</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">alan93</span><br><span class="post-time small text-muted">28th November 2003 21:47 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Should I change it to this?<br><br>;Start Menu Folder Page Configuration<br>!define MUI_STARTMENUPAGE_DEFAULTFOLDER<br>;!define MUI_STARTMENUPAGE_REGISTRY_ROOT "HKLM"<br>;!define MUI_STARTMENUPAGE_REGISTRY_KEY "Software\MyProgramName"<br>;!define MUI_STARTMENUPAGE_REGISTRY_VALUENAME "Start Menu Folder"<br><br><br>but then there would be no option on a first time install right?</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Joost Verburg</span><br><span class="post-time small text-muted">28th November 2003 21:52 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Really, it does not make up that name itself :) It uses the key you have defined in your script.<br><br>If you want your installer to remember the last folder, you should keep the registry settings.<br><br>By default, the default folder uses the name set using the Name command. You have added a version number to that one, so you will have to use MUI_STARTMENUPAGE_DEFAULTFOLDER if you don't want the version number.<br><br>So you should use these settings:<br>!define MUI_STARTMENUPAGE_DEFAULTFOLDER "MyProgramName"<br>!define MUI_STARTMENUPAGE_REGISTRY_ROOT "HKLM"<br>!define MUI_STARTMENUPAGE_REGISTRY_KEY "Software\MyProgramName"<br>!define MUI_STARTMENUPAGE_REGISTRY_VALUENAME "Start Menu Folder"</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">alan93</span><br><span class="post-time small text-muted">28th November 2003 22:04 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>OK back to square one now</strong><br>I tried that and it doesn't remove the version number even when I removed the version number from the name. How do I remove the version number (or update it to newer one) for the "Choose start menu folder" dialog on subsequent installs?<br><br>Or there is really no way to remove this value on installs after the original one?<br><br>Unless it is uninstalled and then the corrected one (your example) is installed later?<br><br>Another thing I mentioned earlier that I don't understand is why does the start menu not have the 1.0 on mine like Microsoft Visual Studio 6.0 has its version number on the menu? It just shows up in the install "Chose Start Menu Folder" dialog.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Joost Verburg</span><br><span class="post-time small text-muted">28th November 2003 22:08 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">It uses the default name if there is no name in the registry key. After you have completed an installation with a new folder name, it will use that name<br><br>If you always want a version number and you don't want it to remember anything, you don't have to use these settings.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">alan93</span><br><span class="post-time small text-muted">28th November 2003 22:19 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>Not in my world</strong><br>Lets strike your first sentence and say its moot because perhaps 200 people have installed my 1.0.0 version program<br><br>Now, I put the example you gave me in 1.1.0<br>and remove the version from the program name.<br><br>The first time that 1.1.0 is installed, I get:<br>"Chose Start Menu Folder" MyProgramName 1.0<br><br>The second time I install it I STILL get:<br>"Chose Start Menu Folder" MyProgramName 1.0<br><br>Why isn't your second sentence true regarding my above example?<br>Or am I misunderstanding again?<br><br>How do change the installer to get this:<br>"Chose Start Menu Folder" MyProgramName.<br><br>?</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Joost Verburg</span><br><span class="post-time small text-muted">28th November 2003 22:23 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">If you remove the registry setting, it will never use the registry name anymore.<br><br>If you have set a registry key, it will always use the last value. If you have changed the name and completed the installation, it will use the new name.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">alan93</span><br><span class="post-time small text-muted">28th November 2003 22:28 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>Going in circles now I think</strong><br>I tried to delete it, that was one of my previous questions........<br><br>I put this in a section:<br>DeleteRegKey HKLM "SOFTWARE\MyProgramName"<br><br>This has the "Start Menu Folder" string with data "MyProgramName 1.0"<br><br>after the 1.1.0 install is run, This key is gone. yea!<br><br>the second time the 1.1.0 insatll is run, it puts it back in somehow<br>when I am NOT using the version as part of the Name and the text "1.0" is no where in my script! no where.<br><br>so where is it getting it from now?</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Joost Verburg</span><br><span class="post-time small text-muted">28th November 2003 22:29 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Remove MUI_STARTMENUPAGE_REGISTRY_ROOT etc. and it will never remember a folder name.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">alan93</span><br><span class="post-time small text-muted">28th November 2003 22:34 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">strange, interesting, and it gets the result i need. !! yea<br><br>but i would have thought that leaving in the surrounding defs:<br>MUI_STARTMENUPAGE_DEFAULTFOLDER and MUI_STARTMENUPAGE_REGISTRY_KEY<br>would cause problems.<br><br>I still don't understand how anyone would ever update a Start Menu Folder with a version number.<br><br>But at least my problem of showing the old incorrect one on new installs is solved.<br><br>Thanks for the persistant help.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Joost Verburg</span><br><span class="post-time small text-muted">28th November 2003 23:26 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">You don't seem to get the point of using the registry setting.<br><br>You only need MUI_STARTMENUPAGE_REGISTRY_KEY if you want it to remember the previous preference. For example, if the user wants to put your shortcuts in AAA instead YourApp and runs the installer again, AAA will still be the default setting.<br><br>It shows the previous number because that was the stored folder. You could add some string parsing that will increase the stored version number, but that will give some problems, since the user can choose any format (like "My App 1.0 - Second Install", "1.0 My App" etc.).</p></div><hr><div class="footer"><p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p></div></div><script src="../js/highlight.pack.js" type="text/javascript"></script><script type="text/javascript">//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]></script></body></html>