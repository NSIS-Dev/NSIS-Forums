<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="description" content="CreateShortCut on NT 4.0 &amp; 95"><title>CreateShortCut on NT 4.0 &amp; 95 - NSIS Forums</title><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script><link rel="preload" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css" as="style" onload="this.rel='stylesheet'"><link rel="preload" href="../css/style.css" as="style" onload="this.rel='stylesheet'"><noscript><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css"><link rel="stylesheet" href="../css/style.css"></noscript><script>!function(a){"use strict";var b=function(b,c,d){function e(a){return h.body?a():void setTimeout(function(){e(a)})}function f(){i.addEventListener&&i.removeEventListener("load",f),i.media=d||"all"}var g,h=a.document,i=h.createElement("link");if(c)g=c;else{var j=(h.body||h.getElementsByTagName("head")[0]).childNodes;g=j[j.length-1]}var k=h.styleSheets;i.rel="stylesheet",i.href=b,i.media="only x",e(function(){g.parentNode.insertBefore(i,c?g:g.nextSibling)});var l=function(a){for(var b=i.href,c=k.length;c--;)if(k[c].href===b)return a();setTimeout(function(){l(a)})};return i.addEventListener&&i.addEventListener("load",f),i.onloadcssdefined=l,l(f),i};"undefined"!=typeof exports?exports.loadCSS=b:a.loadCSS=b}("undefined"!=typeof global?global:this);!function(a){if(a.loadCSS){var b=loadCSS.relpreload={};if(b.support=function(){try{return a.document.createElement("link").relList.supports("preload")}catch(b){return!1}},b.poly=function(){for(var b=a.document.getElementsByTagName("link"),c=0;c<b.length;c++){var d=b[c];"preload"===d.rel&&"style"===d.getAttribute("as")&&(a.loadCSS(d.href,d,d.getAttribute("media")),d.rel=null)}},!b.support()){b.poly();var c=a.setInterval(b.poly,300);a.addEventListener&&a.addEventListener("load",function(){b.poly(),a.clearInterval(c)}),a.attachEvent&&a.attachEvent("onload",function(){a.clearInterval(c)})}}}(this);</script></head><body><div class="container"><ol class="breadcrumb"><li><a href="../index.html" class="glyphicon glyphicon-home"></a></li><li><a href="f-65.html">NSIS Discussion</a></li><li class="active">CreateShortCut on NT 4.0 &amp; 95</li></ol><p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=82912">CreateShortCut on NT 4.0 &amp; 95</a></p><br><div class="post"><p class="post-meta"><span class="post-author text-primary">Pomflain</span><br><span class="post-time small text-muted">30th March 2002 00:44 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>CreateShortCut on NT 4.0 &amp; 95</strong><br>On NT 4.0, when I create a shortcut that is a URL, the shortcut ends up being mangled in an unusual way.<br><br>Take this for example:<br><br>!define URL "http://www.gamefaqs.com/index.html"<br><br>CreateShortCut "$SMPROGRAMS\${PROGNAME}\HTML_Test\View GF.lnk" "${URL}" "" "" 0 SW_SHOWMAXIMIZED<br><br><br>When I try and run the shortcut, NT 4.0 says:<br><br>"Problem with shortcut"<br>"The file or folder 'index.html' that this shortcut refers to cannot be found"<br><br>When I actually go and look at the think, this is what has been entered for the commandline:<br><br>C:\http:/\<a href="http://www.gamefaqs.com/index.html" target="_blank">www.gamefaqs.com\index.html</a><br><br>No quotes on there either.<br><br>I've tried a few different ways, but it always seems to add that in there.<br><br>If I go to run and enter in the commandline, it works right, but the shortcut seems to get managled like that and I cant do much about it.<br><br>Strange, I just manually created a new shortcut, and pasted in the URL and it made the right link.<br><br>Just checked and the same problem exists on 95, but not on 98, ME, 2K or XP, links work fine on there.<br><br>I'll take a look at the source and see if I notice anything.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">superrock</span><br><span class="post-time small text-muted">1st April 2002 08:30 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>Use without http</strong><br>Hi,<br><br>Did you try to open it without "http://...", because http is the<br>default protocol ?<br><br>e.g. directly with "www.gamefaqs.com/index.html"<br><br>Maybe then it works.<br>If not :<br><br>1. Create a small Nsis installer, which is using the<br>"ExecShell" and create a link to this installer.<br><br>ExecShell "open" "http://www.gamefaqs.com/index.html" SW_SHOWMAXIMIZED<br><br><br>or<br>2. Read the link connection to extension .html and start the<br>connected explorer over a CreateShortCut link.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">justin</span><br><span class="post-time small text-muted">1st April 2002 08:47 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Hmm for creating shortcuts to URLs, use WriteINIString to create a .url file ..<br><br>-Justin</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Pomflain</span><br><span class="post-time small text-muted">1st April 2002 16:40 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>Very interesting.</strong><br>Never thought about it that way...geez I suck.<br><br>I'm still curious about the odd behavior on those OSes, though.<br><br>Thanks for providing your typical clairvoyance.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Pomflain</span><br><span class="post-time small text-muted">1st April 2002 17:15 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>Fun follow up.</strong><br>Ok, did just like you said and create the url file, tested it on my 2k base system and it worked. So I installed it on `95, I got to the start menu and click on it and nothing happens. So I try it again, same thing. So I go explore in the directory and click on the file and it opens fine. So I go and rename the file to something short and without spaces, and then it works fine. So it appears there's something wrong with the 8.3 &amp; LFN conversions. Oh well, I'll play around with it a bit more and see if I can get it to work right.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Pomflain</span><br><span class="post-time small text-muted">1st April 2002 17:18 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>Hmm...</strong><br>Ok, so I uninstalled and tried it again and now it works. Oh well, guess I'll chalk it up to system error at the time, not really sure why it wouldn't work there at the time.</p></div><hr><div class="footer"><p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p></div></div><script type="text/javascript" src="../js/highlight.pack.js" async></script><script type="text/javascript">//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]></script></body></html>