<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="NSJSON formatting issue" />

  <title>NSJSON formatting issue - NSIS Forums</title>
  <script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script>
  <!-- Bootstrap core CSS -->

  <link rel="stylesheet" type="text/css" href="//netdna.bootstrapcdn.com/bootswatch/3.0.1/readable/bootstrap.min.css" />
  <link rel="stylesheet" href="../css/style.css" type="text/css" /><!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!--[if lt IE 9]>
                <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
                <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->
</head>

<body>
  <div class="container">
    <!-- Put navigation bar here -->

    <ol class="breadcrumb">
      <li><a href="../index.html" class="glyphicon glyphicon-home"></a></li>

      <li><a href="f-65.html">NSIS Discussion</a></li>

      <li class="active">NSJSON formatting issue</li>
    </ol>

    <p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=360405">NSJSON formatting issue</a></p><br />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">miraz.zaidi</span><br />
      <span class="post-time small text-muted">30th April 2013 08:58 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>NSJSON formatting issue</strong><br />
      Hi,<br />
      <br />
      I am using nsjson plugin to modify Google chrome's preferences file.<br />
      <br />
      I want to add a new field (urls_to_restore_on_startup) in the session node if it is not already present. But the new node added has faulty format which is corrupting the preferences file.<br />
      I am doing this:<br /></p>
      <pre>
<code> nsJSON::Set "session" "urls_to_restore_on_startup" /index 0 /Value '"http://www.nsis.sourceforge.net"' ;changing start page<br /></code>
</pre><br />
      <br />
      It should result like this<br />
      <br />
      <pre>
<code><br />Preferences.json<br />.<br />.<br />"session": {<br />      "restore_on_startup": 4,<br />      "restore_on_startup_migrated": true,<br />      "urls_to_restore_on_startup": [ "http://www.nsis.sourceforge.net" ]<br />   }<br /></code>
</pre><br />
      But instead it is like this : -<br />
      <pre>
<code><br />Preferences.bad<br />.<br />.<br />"session": {<br />      "restore_on_startup": 4,<br />      "restore_on_startup_migrated": true,<br />      "urls_to_restore_on_startup":{<br />                        "http://www.nsis.sourceforge.net"<br />                }<br />   }<br /></code>
</pre><br />
      <br />
      The curly braces are added here which are ruining everything.<br />
      <br />
      How to get the right format ??
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
      <span class="post-time small text-muted">30th April 2013 10:09 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">The value is itself parsed as JSON. If you want the value to be an array (i.e. in square brackets) then put square brackets in your value string. Also you don't need /index 0 in there (that is creating a new sub-node, hence the curly brackets).<br />
      <br />
      I.e.</p>
      <pre>
<code>nsJSON::Set "session" "urls_to_restore_on_startup" /value '["http://www.nsis.sourceforge.net"]'</code>
</pre>The example script demonstrates this and all other usage.<br />
      <br />
      Stu
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">miraz.zaidi</span><br />
      <span class="post-time small text-muted">30th April 2013 13:26 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Oh great. This fixed it. Thanks. :)</p>
    </div>
    <hr />

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]>
  </script>
</body>
</html>
