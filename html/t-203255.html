<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="Loop Help" />

  <title>Loop Help - NSIS Forums</title>
  <script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script>
  <!-- Bootstrap core CSS -->

  <link rel="stylesheet" type="text/css" href="//netdna.bootstrapcdn.com/bootswatch/3.0.1/readable/bootstrap.min.css" />
  <link rel="stylesheet" href="../css/style.css" type="text/css" /><!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!--[if lt IE 9]>
                <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
                <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->
</head>

<body>
  <div class="container">
    <!-- Put navigation bar here -->

    <ol class="breadcrumb">
      <li><a href="../index.html" class="glyphicon glyphicon-home"></a></li>

      <li><a href="f-65.html">NSIS Discussion</a></li>

      <li class="active">Loop Help</li>
    </ol>

    <p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=203255">Loop Help</a></p><br />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Trestkon</span><br />
      <span class="post-time small text-muted">28th December 2004 17:58 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>Loop Help</strong><br />
      I have some code that find a specific line in a file and and adds in several other lines directly after it. The loop works great (someone on this forum helped me with it) but I'm wondering how I might add add some more code into the loop to add several other lines to a *different* section of the file.<br />
      <br />
      The code and problem is outlined here:<br />
      <br />
      <a href="http://www.offtopicproductions.com/temp/nsishelp.txt" target="_blank">http://www.offtopicproductions.com/temp/nsishelp.txt</a><br />
      <br />
      Thanks:-)</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Trestkon</span><br />
      <span class="post-time small text-muted">28th December 2004 18:23 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">After reading up on FileRead I've modified the code a bit and I think it's almost how I want it. The problem seems to be (I think) that when it gets to the second loop it's already at the bottom of the file and so reads nothing and sets the error flag. I think I just need a way to return it to the top of the file before the second loop.<br />
      <br />
      <a href="http://www.offtopicproductions.com/temp/nsishelp2.txt" target="_blank">http://www.offtopicproductions.com/temp/nsishelp2.txt</a></p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Instructor</span><br />
      <span class="post-time small text-muted">28th December 2004 18:55 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">"adds in several other lines directly after it"<br />
      <br /></p>
      <pre>
<code><br />        FileOpen $4 "$INSTDIR\TNM\System\TNM.ini" "r"<br />        GetTempFileName $R1<br />        FileOpen $5 $R1 "w"<br /><br />        loop:<br />        FileRead $4 $6<br />        IfErrors done<br /><br />        FileWrite $5 $6<br />        StrCmp $6 "CacheExt=.uxx$\r$\n" 0 +3<br />        FileWrite $5 "...$\r$\n"<br />        FileWrite $5 "...$\r$\n"<br /><br />        StrCmp $6 "EditPackages=IpServer$\r$\n" 0 loop<br />        FileWrite $5 "...$\r$\n"<br />        FileWrite $5 "...$\r$\n"<br />        Goto loop<br /><br />        done:<br />        FileClose $4<br />        FileClose $5<br /></code>
</pre>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Trestkon</span><br />
      <span class="post-time small text-muted">28th December 2004 19:40 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Awesome! Thanks a lot:D<br />
      <br />
      Now I better decipher exactly what everything does so I can do it myself next time:-)</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Instructor</span><br />
      <span class="post-time small text-muted">28th December 2004 19:53 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">You are welcome.</p>
    </div>
    <hr />

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]>
  </script>
</body>
</html>
