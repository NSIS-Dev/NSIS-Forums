<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="description" content="NSIS - Control folder location in Start-Menu"><title>NSIS - Control folder location in Start-Menu - NSIS Forums</title><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script><link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css"><link rel="stylesheet" href="../css/style.css" type="text/css"></head><body><div class="container"><ol class="breadcrumb"><li><a href="../index.html" class="glyphicon glyphicon-home"></a></li><li><a href="f-65.html">NSIS Discussion</a></li><li class="active">NSIS - Control folder location in Start-Menu</li></ol><p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=359441">NSIS - Control folder location in Start-Menu</a></p><br><div class="post"><p class="post-meta"><span class="post-author text-primary">Carolus</span><br><span class="post-time small text-muted">15th April 2013 10:21 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>NSIS - Control folder location in Start-Menu</strong><br>Hi,<br><br>I have done NSIS script that performs silent installations on several setup files (.exe).<br><br>They end up on different default locations/folders in the Start menu, since I have not specified where to place them, and I don't know how.<br><br>The reason is that some of these installed programs are pointless to have as stand-alone programs, as they depend on the "Main" installed program to run.<br><br>So, what I want to do is to control, in the NSIS script, that some of the program folders are placed inside/under the "MAIN"-program folder in the Start-menu.<br><br>How do I do this? Is it possible?<br><br>BR<br>Carolus</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br><span class="post-time small text-muted">15th April 2013 11:24 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">You can either just delete those short cuts and then create your own after running the silent installers, or just move them using Rename. You can just move the entire folders under your own.<br><br>Stu</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Carolus</span><br><span class="post-time small text-muted">15th April 2013 13:03 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Hi,<br><br>Thanks for your reply.<br><br>Could you please show an example of this?<br><br>I tried to 'move' som program folders using createshortcut, but that doesn't work.<br><br>BR,<br>Carolus</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br><span class="post-time small text-muted">15th April 2013 13:11 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">As I said, use the Rename instruction. You can move files and folders using it.<br><br>Stu</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Carolus</span><br><span class="post-time small text-muted">16th April 2013 13:25 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Hi,<br><br>Thanks.<br><br>I am of course doing somehting wrong, it doesn't work.<br><br>I tried, after the silent installation calls (ExecWait....) on one of the 'sub-apps' with this:<br><br>; There is a space in MikTex 2.9 folder name<br>Rename "$SMPROGRAMS\MikTex 2.9" "$SMPROGRAMS\doxygen\MikTex 2.9"<br><br>; Also tried to remove the directory entirely<br>RMDir /r "$SMPROGRAMS\MikTex 2.9"<br><br>The creation of the installation .exe works and the installation goes through, but the folder is NOT moved, or deleted in the latter case.<br><br>BR,<br>Carolus</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">MSG</span><br><span class="post-time small text-muted">16th April 2013 13:56 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Are you sure you're in the proper user context? SetShellvarContext all or current? Also, if current, are you at the proper access level (elevated/admin vs userlevel)?<br><br>Put a MessageBox MB_OK "$SMPROGRAMS" in front of your delete command to see which path you're actually trying to delete.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Carolus</span><br><span class="post-time small text-muted">16th April 2013 14:54 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Hi,<br><br>Thanks.<br><br>You are abolutely right. I have only tried the delete command so far.<br><br>I copy-pasted the path in the delete command:<br>RMDir /r "C:\ProgramData\Microsoft\Windows\Start Menu\Programs\MikTex 2.9"<br><br>And that worked. But that does not look very elegant though. How should it be if I want to use some pre-defined path constant and delete the same directory, in the correct context?<br><br>BR,<br>Carolus</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br><span class="post-time small text-muted">16th April 2013 14:56 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">As MSG said you need to use SetShellvarContext all to change the context of the path constants (that path is for all users, so use all).<br><br>Stu</p></div><hr><div class="footer"><p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p></div></div><script src="../js/highlight.pack.js" type="text/javascript"></script><script type="text/javascript">//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]></script></body></html>