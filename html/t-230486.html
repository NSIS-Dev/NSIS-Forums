<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="Install/reinstall/uninstall" />

  <title>Install/reinstall/uninstall - NSIS Forums</title><!-- Bootstrap core CSS -->
  <link rel="stylesheet" type="text/css" href="//netdna.bootstrapcdn.com/bootswatch/3.0.1/readable/bootstrap.min.css" />
  <link rel="stylesheet" href="../css/style.css" type="text/css" /><!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!--[if lt IE 9]>
                <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
                <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->
</head>

<body>
  <div class="container">
    <!-- Put navigation bar here -->

    <ol class="breadcrumb">
      <li><a href="../index.html" class="glyphicon glyphicon-home"></a></li>

      <li><a href="f-65.html">NSIS Discussion</a></li>

      <li class="active">Install/reinstall/uninstall</li>
    </ol>

    <p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=230486">Install/reinstall/uninstall</a></p><br />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">PETER&amp;BRENT</span><br />
      <span class="post-time small text-muted">8th November 2005 22:22 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>Install/reinstall/uninstall</strong><br />
      Hello kichik,<br />
      <br />
      can you pleas help me with my code.<br />
      I heave serious problem with my code, can you pleas check te code and repair where neccecary.<br />
      The programm must control if the programm is alraedy installed, if yes then reinstalling or quit.<br />
      Thanks in advance<br />
      Peter.BE, sorry for the Engl.<br />
      <br />
      ; Script generated by the HM NIS Edit Script Wizard.<br />
      <br />
      ; HM NIS Edit Wizard helper defines<br />
      !define PRODUCT_NAME "RapportBasis"<br />
      !define PRODUCT_VERSION "versie 1.5"<br />
      !define PRODUCT_PUBLISHER "De Beroepsschool Aalst"<br />
      !define PRODUCT_WEB_SITE "http://schoolweb.argo.be/ibso/aalst/start.htm"<br />
      !define PRODUCT_UNINST_KEY "Software\Microsoft\Windows\CurrentVersion\Uninstall\${PRODUCT_NAME}"<br />
      !define PRODUCT_UNINST_ROOT_KEY "HKLM"<br />
      !define PRODUCT_STARTMENU_REGVAL "NSIS:StartMenuDir"<br />
      <br />
      ; MUI 1.67 compatible ------<br />
      !include "MUI.nsh"<br />
      !include "Sections.nsh"<br />
      <br />
      InstType "/NOCUSTOM"<br />
      <br />
      ; MUI Settings<br />
      !define MUI_ABORTWARNING<br />
      !define MUI_HEADERIMAGE<br />
      !define MUI_HEADERIMAGE_BITMAP "${NSISDIR}\Contrib\Graphics\Header\962.bmp" ; optional<br />
      !define MUI_ICON "${NSISDIR}\Contrib\Graphics\Icons\modern-install.ico"<br />
      !define MUI_UNICON "${NSISDIR}\Contrib\Graphics\Icons\modern-uninstall.ico"<br />
      <br />
      ; Welcome page<br />
      !insertmacro MUI_PAGE_WELCOME<br />
      <br />
      ; Components page<br />
      !insertmacro MUI_PAGE_COMPONENTS<br />
      ; Start menu page<br />
      var ICONS_GROUP<br />
      !define MUI_STARTMENUPAGE_NODISABLE<br />
      !define MUI_STARTMENUPAGE_DEFAULTFOLDER "${PRODUCT_NAME}"<br />
      !define MUI_STARTMENUPAGE_REGISTRY_ROOT "${PRODUCT_UNINST_ROOT_KEY}"<br />
      !define MUI_STARTMENUPAGE_REGISTRY_KEY "${PRODUCT_UNINST_KEY}"<br />
      !define MUI_STARTMENUPAGE_REGISTRY_VALUENAME "${PRODUCT_STARTMENU_REGVAL}"<br />
      !insertmacro MUI_PAGE_STARTMENU Application $ICONS_GROUP<br />
      ; Directory page<br />
      !insertmacro MUI_PAGE_DIRECTORY<br />
      ; Instfiles page<br />
      !insertmacro MUI_PAGE_INSTFILES<br />
      ; Finish page<br />
      !insertmacro MUI_PAGE_FINISH<br />
      <br />
      ; Uninstaller pages<br />
      !insertmacro MUI_UNPAGE_INSTFILES<br />
      <br />
      ; Language files<br />
      !insertmacro MUI_LANGUAGE "Dutch"<br />
      <br />
      ; MUI end ------<br />
      <br />
      Name "${PRODUCT_NAME} ${PRODUCT_VERSION}"<br />
      OutFile "${PRODUCT_NAME}.exe"<br />
      BRANDINGTEXT "Rapportenbeheer voor de leerlingen van De Beroepsschool/ De Horizon, Aalst."<br />
      InstallDir "C:\${PRODUCT_NAME}"<br />
      ShowInstDetails show<br />
      ShowUnInstDetails show<br />
      <br />
      ;--------------------------------<br />
      Function .onVerifyInstDir<br />
      IfFileExists "$INSTDIR" Ask_Question<br />
      Goto UNINSTALL<br />
      <br />
      Ask_Question:<br />
      MessageBox MB_YESNO "${PRODUCT_NAME} is al geïnstalleerd. \<br />
      Wil u het eerst verwjderen en vervolgens opnieuw installeren? \<br />
      Als u op Nee klikt moet u de installatie \<br />
      volledig annuleren en van de cd-rom een ander \<br />
      setup bestand selecteren dat nog \<br />
      niet is geïnstalleerd." \<br />
      IDYES UNINSTALL IDNO INSTALL<br />
      <br />
      INSTALL:<br />
      QUIT<br />
      UNINSTALL:<br />
      <br />
      ExecWait '"$INSTDIR\uninstall.exe"'<br />
      ExecWait '"$INSTDIR\Verwijderen.exe"'<br />
      <br />
      <br />
      <br />
      <br />
      FunctionEnd<br />
      <br />
      <br />
      ;--------------------------------<br />
      <br />
      Section "RAPPORTEN" SEC01<br />
      SetOutPath "$INSTDIR"<br />
      SetOverwrite off<br />
      File "C:\RapportBasis11\Nieuwe map\Rapporten.xls"<br />
      File "C:\RapportBasis11\Nieuwe map\Rapport.ico"<br />
      File "C:\RapportBasis11\Nieuwe map\Explorer.ico"<br />
      <br />
      ; Shortcuts<br />
      !insertmacro MUI_STARTMENU_WRITE_BEGIN Application<br />
      SetOverwrite off<br />
      CreateDirectory "$SMPROGRAMS\${PRODUCT_NAME}"<br />
      CreateShortCut "$SMPROGRAMS\${PRODUCT_NAME}\Start ${PRODUCT_NAME}.lnk" "$INSTDIR\Rapporten.xls" "" "$INSTDIR\Rapport.ico"<br />
      CreateShortCut "$DESKTOP\Start ${PRODUCT_NAME}.lnk" "$INSTDIR\Rapporten.xls" "" "$INSTDIR\Rapport.ico"<br />
      CreateShortCut "$QUICKLAUNCH\Start ${PRODUCT_NAME}.lnk" "$INSTDIR\Rapporten.xls" "" "$INSTDIR\Rapport.ico"<br />
      !insertmacro MUI_STARTMENU_WRITE_END<br />
      SectionEnd<br />
      <br />
      Section "HANDLEIDING" SEC02<br />
      SetOutPath "$INSTDIR"<br />
      SetOverwrite off<br />
      File "C:\RapportBasis11\Nieuwe map\Handleiding1.doc"<br />
      File "C:\RapportBasis11\Nieuwe map\Book.ico"<br />
      <br />
      ; Shortcuts<br />
      !insertmacro MUI_STARTMENU_WRITE_BEGIN Application<br />
      SetOverwrite off<br />
      CreateDirectory "$SMPROGRAMS\${PRODUCT_NAME}"<br />
      CreateShortCut "$SMPROGRAMS\${PRODUCT_NAME}\Handleiding1.lnk" "$INSTDIR\Handleiding1.doc" "" "$INSTDIR\Book.ico"<br />
      !insertmacro MUI_STARTMENU_WRITE_END<br />
      SectionEnd<br />
      <br />
      Section -AdditionalIcons<br />
      !insertmacro MUI_STARTMENU_WRITE_BEGIN Application<br />
      SetOverwrite off<br />
      WriteIniStr "$INSTDIR\${PRODUCT_NAME}.url" "InternetShortcut" "URL" "${PRODUCT_WEB_SITE}"<br />
      CreateDirectory "$SMPROGRAMS\${PRODUCT_NAME}"<br />
      CreateShortCut "$SMPROGRAMS\${PRODUCT_NAME}\${PRODUCT_NAME}.lnk" "$INSTDIR\${PRODUCT_NAME}.url"<br />
      CreateShortCut "$SMPROGRAMS\${PRODUCT_NAME}\Verkennen.lnk" "$INSTDIR\" "" "$INSTDIR\Explorer.ico"<br />
      CreateShortCut "$SMPROGRAMS\${PRODUCT_NAME}\Verwijderen.lnk" "$INSTDIR\Verwijderen.exe"<br />
      !insertmacro MUI_STARTMENU_WRITE_END<br />
      SectionEnd<br />
      <br />
      Section -Post<br />
      SetOverwrite off<br />
      WriteUninstaller "$INSTDIR\Verwijderen.exe"<br />
      WriteRegStr ${PRODUCT_UNINST_ROOT_KEY} "${PRODUCT_UNINST_KEY}" "DisplayName" "$(^Name)"<br />
      WriteRegStr ${PRODUCT_UNINST_ROOT_KEY} "${PRODUCT_UNINST_KEY}" "UninstallString" "$INSTDIR\Verwijderen.exe"<br />
      WriteRegStr ${PRODUCT_UNINST_ROOT_KEY} "${PRODUCT_UNINST_KEY}" "DisplayVersion" "${PRODUCT_VERSION}"<br />
      WriteRegStr ${PRODUCT_UNINST_ROOT_KEY} "${PRODUCT_UNINST_KEY}" "URLInfoAbout" "${PRODUCT_WEB_SITE}"<br />
      WriteRegStr ${PRODUCT_UNINST_ROOT_KEY} "${PRODUCT_UNINST_KEY}" "Publisher" "${PRODUCT_PUBLISHER}"<br />
      SectionEnd<br />
      <br />
      ; Section descriptions<br />
      !insertmacro MUI_FUNCTION_DESCRIPTION_BEGIN<br />
      !insertmacro MUI_DESCRIPTION_TEXT ${SEC01} "Installeerd het ${PRODUCT_NAME} programma met alle koppelingen: bureaublad, werkbalk snelstarten, menu Start, Programma's. Deze installatieoptie kan niet uitgeschakeld worden."<br />
      !insertmacro MUI_DESCRIPTION_TEXT ${SEC02} "Installeerd een beknopte handleiding met de nodige koppeling in het menu Start, Programma's. Deze installatieoptie kan niet uitgeschakeld worden."<br />
      !insertmacro MUI_FUNCTION_DESCRIPTION_END<br />
      <br />
      <br />
      Function un.onUninstSuccess<br />
      HideWindow<br />
      MessageBox MB_ICONINFORMATION|MB_OK "$(^Name) is met succes verwijderd van uw computer."<br />
      FunctionEnd<br />
      <br />
      Function un.onInit<br />
      MessageBox MB_ICONQUESTION|MB_YESNO|MB_DEFBUTTON2 "Ben je zeker dat je alles wilt verwijderen van $(^Name)?" IDYES +2<br />
      Abort<br />
      FunctionEnd<br />
      <br />
      Section Uninstall<br />
      Delete "$INSTDIR\Verwijderen.exe"<br />
      Delete "$INSTDIR\Handleiding1.doc"<br />
      Delete "$INSTDIR\Rapporten.xls"<br />
      Delete "$INSTDIR\Rapport.ico"<br />
      Delete "$INSTDIR\Book.ico"<br />
      Delete "$INSTDIR\Explorer.ico"<br />
      Delete "$INSTDIR\${PRODUCT_NAME}.url"<br />
      <br />
      <br />
      Delete "$SMPROGRAMS\${PRODUCT_NAME}\Verwijderen.lnk"<br />
      Delete "$SMPROGRAMS\${PRODUCT_NAME}\Handleiding1.lnk"<br />
      Delete "$SMPROGRAMS\${PRODUCT_NAME}\Start ${PRODUCT_NAME}.lnk"<br />
      Delete "$SMPROGRAMS\${PRODUCT_NAME}\Verkennen.lnk"<br />
      Delete "$SMPROGRAMS\${PRODUCT_NAME}\${PRODUCT_NAME}.lnk"<br />
      Delete "$DESKTOP\Start ${PRODUCT_NAME}.lnk"<br />
      Delete "$QUICKLAUNCH\Start ${PRODUCT_NAME}.lnk"<br />
      <br />
      RMDir "$SMPROGRAMS\${PRODUCT_NAME}"<br />
      RMDir "$INSTDIR"<br />
      <br />
      DeleteRegKey ${PRODUCT_UNINST_ROOT_KEY} "${PRODUCT_UNINST_KEY}"<br />
      SetAutoClose true<br />
      SectionEnd</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">onad</span><br />
      <span class="post-time small text-muted">9th November 2005 00:06 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">I see the urge to solve your problem, really. But please do not post a request to someone specific.<br />
      <br />
      Make it a general request to everyone who can help.<br />
      <br />
      This way you also do not restrict yourself to one person to expect an answer from.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">PETER&amp;BRENT</span><br />
      <span class="post-time small text-muted">9th November 2005 00:33 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">@onad.<br />
      <br />
      Sorry onad, it's also a general request to everyone.<br />
      Can You help onad?<br />
      <br />
      Peter,BE</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">NHOCSUNG</span><br />
      <span class="post-time small text-muted">10th November 2005 15:47 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Peter,BE you need to take a look at my page<br />
      <br />
      <a href="http://nsis.sourceforge.net/SectionsFlags" target="_blank">http://nsis.sourceforge.net/SectionsFlags</a></p>
    </div>
    <hr />

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]>
  </script>
</body>
</html>
