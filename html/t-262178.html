<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="Finish page runs the executable multiple times" />

  <title>Finish page runs the executable multiple times - NSIS Forums</title><!-- Bootstrap core CSS -->
  <link rel="stylesheet" type="text/css" href="//netdna.bootstrapcdn.com/bootswatch/3.0.1/readable/bootstrap.min.css" />
  <link rel="stylesheet" href="../css/style.css" type="text/css" /><!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!--[if lt IE 9]>
                <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
                <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->
</head>

<body>
  <div class="container">
    <!-- Put navigation bar here -->

    <ol class="breadcrumb">
      <li><a href="../index.html" class="glyphicon glyphicon-home"></a></li>

      <li><a href="f-65.html">NSIS Discussion</a></li>

      <li class="active">Finish page runs the executable multiple times</li>
    </ol>

    <p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=262178">Finish page runs the executable multiple times</a></p><br />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">soundken</span><br />
      <span class="post-time small text-muted">21st December 2006 00:46 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>Finish page runs the executable multiple times</strong><br />
      I have the following code for the finish page:<br />
      <br />
      ; Finish page<br />
      !define MUI_PAGE_CUSTOMFUNCTION_PRE checkForAbort<br />
      !define MUI_PAGE_CUSTOMFUNCTION_SHOW postStage<br />
      !define MUI_FINISHPAGE_RUN "$INSTDIR\MyApp.exe"<br />
      !insertmacro MUI_PAGE_FINISH<br />
      <br />
      If by accident you click twice on the next button on the components page, when you get to the Finish page, it executes MyApp.exe but still shows the Finish page. When you click on Finish it runs MyApp.exe a second time.<br />
      <br />
      I've been able to get 3 MyApp.exe's running at the same time while still seeing the Finish page.<br />
      <br />
      This seems like a bug in NSIS, is there a way to prevent this?<br />
      <br />
      And MyApp already detects that another copy is running and shuts down, but I have to show a dialog box to the user that says another copy is running. So I get multiple dialog boxes open.<br />
      <br />
      Thanks.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Red Wine</span><br />
      <span class="post-time small text-muted">21st December 2006 09:29 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>Re: Finish page runs the executable multiple times</strong><br />
      What is the purpose of that "!define MUI_PAGE_CUSTOMFUNCTION_SHOW postStage" ?</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">soundken</span><br />
      <span class="post-time small text-muted">21st December 2006 17:57 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">It does an InetLoad::load /SILENT /POST of a message to log that the user got to the finish page. Just because you mentioned it, I got rid of the define and I didn't get the duplicate run problem. So I changed to the LEAVE function and it seems to be working OK now.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Red Wine</span><br />
      <span class="post-time small text-muted">21st December 2006 18:34 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Well done!<br />
      That's why I've asked about. The custom function show halts the dialog thus should have strange behaviour if it's not used for a few specific reasons.</p>
    </div>
    <hr />

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]>
  </script>
</body>
</html>
