<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="File Access on Limited Accounts..." />

  <title>File Access on Limited Accounts... - NSIS Forums</title>
  <script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script>
  <!-- Bootstrap core CSS -->

  <link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css" />
  <link rel="stylesheet" href="../css/style.css" type="text/css" /><!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!--[if lt IE 9]>
                <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
                <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->
</head>

<body>
  <div class="container">
    <!-- Put navigation bar here -->

    <ol class="breadcrumb">
      <li><a href="../index.html" class="glyphicon glyphicon-home"></a></li>

      <li><a href="f-65.html">NSIS Discussion</a></li>

      <li class="active">File Access on Limited Accounts...</li>
    </ol>

    <p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=243131">File Access on Limited Accounts...</a></p><br />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Nuzzi</span><br />
      <span class="post-time small text-muted">10th April 2006 20:57 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>File Access on Limited Accounts...</strong><br />
      Hello,<br />
      <br />
      I have a question about changing access rights to files I install through NSIS. Our software has a few ini files that get accessed and changed with every use of the different programs. When I install these ini files through NSIS they have some initial default settings. What happens is the software always gets installed through an Administrator account and these files get added. But when a user with a limited account uses the software it will not allow the ini files to be updated, throwing an error about "unable to write to...." Is there a means of giving these files the proper permissions on install so anybody can change them?<br />
      <br />
      I apologize if this is easy one (it seems it might be), but after looking and searching for a while, I haven't come up with the solution.<br />
      <br />
      Thanks in advance for your help...<br />
      <br />
      NUZZI</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Nuzzi</span><br />
      <span class="post-time small text-muted">10th April 2006 22:06 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>Scratch that...</strong><br />
      I figured out a way by shelling to cacls on installation success. It seems to work nicely. However, if there is a more elegant solution, I wouldn't mind using it.<br />
      <br />
      Thanks,<br />
      <br />
      NUZZI</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">dienjd</span><br />
      <span class="post-time small text-muted">11th April 2006 00:04 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Seems like you have it working, but creating a directory for your app in $APPDATA (with SetShellVarContext set to 'all') and putting the ini files there should allow any user to modify them.</p>
    </div>
    <hr />

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]>
  </script>
</body>
</html>
