<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="Dialogs.dll: My new plugin." />

  <title>Dialogs.dll: My new plugin. - NSIS Forums</title><!-- Bootstrap core CSS -->
  <link rel="stylesheet" type="text/css" href="//netdna.bootstrapcdn.com/bootswatch/3.0.1/readable/bootstrap.min.css" />
  <link rel="stylesheet" href="../css/style.css" type="text/css" /><!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!--[if lt IE 9]>
                <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
                <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content=" Dialogs.dll: My new plugin." />

  <title>Dialogs.dll: My new plugin. - NSIS Forums</title>
  <link rel="stylesheet" type="text/css" href="//netdna.bootstrapcdn.com/bootswatch/3.0.1/readable/bootstrap.min.css" />
  <link rel="stylesheet" href="../css/style.css" type="text/css" />
</head>

<body>
  <div class="container">
    <!-- Put navigation bar here -->

    <ol class="breadcrumb">
      <li><a href="../index.html" class="glyphicon glyphicon-home"></a></li>

      <li><a href="f-65.html">NSIS Discussion</a></li>

      <li class="active">Dialogs.dll: My new plugin.</li>
    </ol>

    <p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=171833">Dialogs.dll: My new plugin.</a></p><br />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Joel</span><br />
      <span class="post-time small text-muted">3rd March 2004 00:00 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>Dialogs.dll: My new plugin.</strong><br />
      Hello dudes!<br />
      <br />
      I just create <b>Dialogs.dll</b>. A plugin for call the Open and Folder browse dialogs.<br />
      <br />
      Test it. Please post your opinions.<br />
      Thanks ;)<br />
      <br />
      PS: See the readme file for details!</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">deguix</span><br />
      <span class="post-time small text-muted">3rd March 2004 02:55 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Yeah, basically it works, but how about adding more options, like to add support to appear the "Save File" dialog for example...<br />
      <br />
      But I'll continue to try the System way, I'm planning to make a new header file using all the codes with System plugin... Now, about the Open dialog for my program, I'll use your plugin. Thanks.<br />
      <br />
      Your DLL size is too small I think you just used 2 API for dialogs, am I right?</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Joel</span><br />
      <span class="post-time small text-muted">3rd March 2004 14:52 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">I use like 10 APIs, but mostly...yeah... for those two.<br />
      I could add the "Save" dialog.... ;) is not hard...<br />
      <br />
      *Add it in the TODO list.<br />
      <br />
      Thanks</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Joel</span><br />
      <span class="post-time small text-muted">3rd March 2004 15:25 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Updated to versions 1.1:<br />
      Add it the "Save" dialog.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">KirillKr</span><br />
      <span class="post-time small text-muted">4th March 2004 23:27 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">2Lobo Lunar<br />
      Did you add source and binary of your plugin in nsis development snapshot?</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Joel</span><br />
      <span class="post-time small text-muted">4th March 2004 23:38 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>Lobo Lunar is in "da house"</strong><br />
      Done it!<br />
      Now you can add you custom filter as many you want. :D<br />
      Updated to version 1.2:</p>

      <ul>
        <li>Change syntax.</li>

        <li>Added the custom Index filter.</li>

        <li>Added the multiple filter for both Open and Save Dialogs.</li>

        <li>Added "Create Folfer" button on Folder Dialog.</li>

        <li>Remove the current selection folder label in Folder Browse (maybe I'll put it back).</li>
      </ul>Please see the readme file for the updated syntax.<br />
      Comments, please!!! Specially from users with Win95/Win98/NT<br />
      <br />
      @KirillKr: No. This is my personal work. If the dev's want it, sure.... why not :)
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">KirillKr</span><br />
      <span class="post-time small text-muted">4th March 2004 23:52 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">&gt;&gt; No. This is my personal work. If the dev's want it, sure.... why not<br />
      Yes. I meant this too.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Joel</span><br />
      <span class="post-time small text-muted">6th March 2004 15:30 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">So... no comments? Than later today I'll put it in the Archive...</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Brummelchen</span><br />
      <span class="post-time small text-muted">7th March 2004 17:36 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">&gt;&gt; So... no comments?<br />
      <br />
      Sorry, no app for that moment now...<br />
      Maybe in my experimental when i finished current update..</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">benchetrit</span><br />
      <span class="post-time small text-muted">8th March 2004 07:50 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">A comment :<br />
      I have used your dll for folder with success. It help me to remove the Page Directory that can not be executed inside the sections. Now my installation is more user friendly.<br />
      <br />
      A feature request :<br />
      Could you had the possibility to select a disk only after selection of a file or a folder.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Joel</span><br />
      <span class="post-time small text-muted">8th March 2004 14:56 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">And know...<br />
      You can get it from the <a href="http://nsis.sourceforge.net/archive/viewpage.php?pageid=454" target="_blank">Web Archive</a>. :cool:<br />
      Thanks to all the members that test the plugin. Thanks :)<br />
      <br />
      @benchetrit: I didn't quite understand. Do you want to select a Drive unit?</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">benchetrit</span><br />
      <span class="post-time small text-muted">8th March 2004 15:05 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Exactly, I want the user will be able to select a drive unit only. Moreover, if you could had some filters or exclusion list, it will be great. For instance, exclude a list like "C,D". Filters to exclude or include like : exclude "cdrom,networkdrive" or include "localdisk,removabledisk,floppy".</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Joel</span><br />
      <span class="post-time small text-muted">8th March 2004 16:23 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Ok, now I understand... However I think that will be adding another dialog, I have in mind "Drive Dialog".<br />
      And yeah, maybe some filters too, although I don't know how do that, yet :igor:.<br />
      <br />
      I'll work in that tonight :)</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">benchetrit</span><br />
      <span class="post-time small text-muted">9th March 2004 14:03 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">@lobo lunar<br />
      <br />
      If you continue in that direction, I will appreciate to have a string dialog for asking the user for a string, and a selection list for asking a user to select a (and why not multiple) value.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Joel</span><br />
      <span class="post-time small text-muted">9th March 2004 14:54 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Hi benchetrit!<br />
      <br />
      I try the Drive list, and there's isn't like a special dialog for units. There's an API for detect the phisical installed drives, but It can be done using system plugin. The code for this is simple, or I can point you in the right direction (and API).<br />
      <br />
      Now, I can make the "asking" string dialog but, whay kind of values the users will select? Maybe some example of it will be handy...<br />
      <br />
      TODO:<br />
      I will make a dialog-style like those InputBoxes that come with Visual Basic. This will be handy if you'd like to password protect your installer without the INI thing. :)<br />
      <br />
      Good luck to me! :D</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">benchetrit</span><br />
      <span class="post-time small text-muted">9th March 2004 17:25 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">When I tell string dialog I mean input text.<br />
      <br />
      I have a question concerning Open. Is it possible to select the list of the files to display in the file selector. For instance, if I put *.txt, *.txt will be in the file name input, and only *.txt file and obviously folders of the initial folder wil be displayed for selection.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Joel</span><br />
      <span class="post-time small text-muted">9th March 2004 23:22 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">oh, do you mean multiple selection files?<br />
      Is possible! :)<br />
      <br />
      [edit]<br />
      I try a simple code snipet and NSIS doesn't give more features in looping and string manipulation. I should try another way to make NSIS outputing the multiple selection.<br />
      [/edit]</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">deguix</span><br />
      <span class="post-time small text-muted">10th March 2004 00:51 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">There is a little thing called "Callback Function", it loops everytime when a result is returned, but to return to the original function, you have to end pushing something to stack to the original function know you want to continue...<br />
      <br />
      Have some examples like "Detect Drives" Archive page (see my signature) of that.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Joel</span><br />
      <span class="post-time small text-muted">10th March 2004 02:03 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Well...that little thing is the easy part, dude ;)<br />
      The plugin have the callback function for the user selected outputvar.<br />
      That's not important, the important is get out the files since all are store in one var. Is not the "loop", is the handle for each file. I need separator, is not a typical "String function" or "Callback function", a separator to get path of the file in some place.<br />
      Nsis, as my begin question <a href="http://forums.winamp.com/showthread.php?s=&amp;threadid=171638" target="_blank">here</a> is very limited. :(<br />
      Yes, there some ways to get that! I just need time. :rolleyes:</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">deguix</span><br />
      <span class="post-time small text-muted">10th March 2004 03:05 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">If I understood right:<br />
      <br /></p>

      <blockquote>
        the important is get out the files since all are store in one var.
      </blockquote>Has a function called "StrTok" inside "StrFunc.nsh" in the include directory, it returns the string you want to be returned from a complex string. Like "Text" from string "Number|Variable|Text|GUID". It is not included on Archive (that is my AdvStrTok).
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">benchetrit</span><br />
      <span class="post-time small text-muted">10th March 2004 09:49 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Hi Lobo Lunar<br />
      <br />
      I do not want multiple selection for files, I just wants that the dialog Open only displays the files that respect a string for instance *.nsi, like the standard Open File dialog do.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">deguix</span><br />
      <span class="post-time small text-muted">10th March 2004 10:06 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Maybe you should say "Files Filter".</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Joel</span><br />
      <span class="post-time small text-muted">10th March 2004 14:14 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">lol :D<br />
      Yeah! Filtering....<br /></p>
      <pre>
<code><br />Dialogs::Open $HWNDPARENT "Nsis Files (*.nsi)|*.nsi|" "1" "Choose a file from the list" "$EXEDIR" .r0<br /></code>
</pre><br />
      Like this?
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">benchetrit</span><br />
      <span class="post-time small text-muted">10th March 2004 14:38 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Yes like this.<br />
      <br />
      If fact I am sorry I have made a mistake, I did not understood your examples. Now it works.<br />
      <br />
      Bad code :<br />
      Dialogs::Open $HWNDPARENT "SYD Licence (*.syd)|" "1" "Select Licence File" "t:\" .r0<br />
      <br />
      Right code :<br />
      Dialogs::Open $HWNDPARENT "SYD Licence (*.syd)|*.syd|" "1" "Select Licence File" "t:\" .r0<br />
      <br />
      Thank you. And tell me when I could have a dialog for asking a string to the user.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Joel</span><br />
      <span class="post-time small text-muted">10th March 2004 14:45 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">lol! :)<br />
      <br />
      No problem.<br />
      And about that dialog, is in progress now ;)</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Joel</span><br />
      <span class="post-time small text-muted">11th March 2004 01:41 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Updated to version 1.3 :cool:<br />
      <br />
      what's new:<br />
      Added the InputBox with password support. Great to password-protect your installer.<br />
      <br />
      <a href="http://nsis.sourceforge.net/archive/viewpage.php?pageid=454" target="_blank">Web Archive</a><br />
      <br />
      Comments, please! :)</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Joel</span><br />
      <span class="post-time small text-muted">17th March 2004 14:37 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Updated to version 2.0.<br />
      <br />
      What's new?<br />
      1. New CHM help file.<br />
      2. New output syntax style (see examples)<br />
      3. Some minor bugs.<br />
      <br />
      The <a href="http://nsis.sourceforge.net/archive/viewpage.php?pageid=454" target="_blank">Web Archive</a>.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">celli</span><br />
      <span class="post-time small text-muted">25th May 2004 19:30 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Lobo Lunar,<br />
      I like what you did -<br />
      But when I drag the .nsi file into the compiler of the NSIS Application -<br />
      I keep getting a compile error. Am I doing something wrong ?<br />
      This is my first time using the NSIS Application.<br />
      -<br />
      Thanks.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">celli</span><br />
      <span class="post-time small text-muted">25th May 2004 20:28 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Lobo.<br />
      Got it to work.<br />
      -<br />
      How can I specify a specific file that<br />
      I want users to save ?<br />
      -<br />
      This setUp will launch from another .EXE living on a CD-Rom<br />
      and the file that I will want to save lives on the CD-Rom as well. Can I use this to perform this task ?<br />
      -<br />
      I feel like I'm close.<br />
      -<br />
      Thanks</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Joel</span><br />
      <span class="post-time small text-muted">25th May 2004 22:17 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"></p>

      <blockquote>
        How can I specify a specific file that<br />
        I want users to save ?
      </blockquote>I have to change the source code, or you can use the filter telling the user wich one he/she have to use (see Save parameters).<br />

      <blockquote>
        This setUp will launch from another .EXE living on a CD-Rom<br />
        and the file that I will want to save lives on the CD-Rom as well. Can I use this to perform this task ?
      </blockquote>Since the Installer (EXE) and file (to run) is in the same folder, you can use <b>$EXEDIR</b> with Exec functions from NSIS to execute the file.
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Joel</span><br />
      <span class="post-time small text-muted">9th November 2004 16:00 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Updated to version 2.3<br />
      <br />
      New:<br />
      New algorithm in the InputRegCode.<br />
      <a href="http://nsis.sourceforge.net/archive/viewpage.php?pageid=454" target="_blank">Web archive</a></p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Joel</span><br />
      <span class="post-time small text-muted">30th December 2004 15:19 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">no major update, just add the password flag in InputRegCode<br />
      <br />
      <a href="http://nsis.sourceforge.net/archive/viewpage.php?pageid=454" target="_blank">Web Archive</a></p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Comperio</span><br />
      <span class="post-time small text-muted">10th April 2005 06:54 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">I had finally come across a situation where I needed an InputBox and found your plugin. EVERYTHING WORKS GREAT!<br />
      <br />
      But just in case you get "bored", I though I'd throw a few suggestions your way. ;)<br />
      <br />
      <br />
      1. It would be nice to be able to specify a default button on the InputBox to allow the user to simply press "ENTER" and have it accept the answers.<br />
      <br />
      2. Another nice option would be limit to the number of characters the user would be allowed to type.<br />
      <br />
      I know that I could use a StrLen operation AFTER the InputBox is closed, but I was thinking perhaps the InputBox could me made to just not accept any more characters after x number that you specified. This would then eliminate the need for the extra error checks in the NSIS code. (Of course, it would then be up to the NSIS developer to explain this to the user in the InputBox text promt.)<br />
      <br />
      3. (perhaps more of a challenge) the open/save dialogs have the standard shortcuts for "history" "my Documents", etc. Is there any way to change this and allow a user to specify his/her own icon and folder? I know you're probalby using a standard Windows control which may not have this ability, but I'd thought I'd throw it out there anyway for you to ponder. (I've always thought this might be a useful feature in other applications as well...)<br />
      <br />
      Keep up the great work!<br />
      :up:</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Joel</span><br />
      <span class="post-time small text-muted">10th April 2005 18:43 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Hi Comperio :)<br />
      <br />
      Thanks for your post...<br />
      <br />
      1. In my TODO list will be an option to press enter and continue the installation :up:<br />
      <br />
      2. Yes, I can... but than again... will be increasing the parameters procedure....but ok, added in my TODO list :D<br />
      <br />
      3. I don't know... I'll have to check that...</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">RobGrant</span><br />
      <span class="post-time small text-muted">28th April 2006 11:59 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Heya, just come across this excellent plugin.<br />
      <br />
      I am trying to recreate the behaviour of the built-in file select control (a text box and a browse button) with this plugin, so I can have a custom dialog, and thought I could use this.<br />
      <br />
      2 questions:<br />
      1) The save dialog takes a variable (e.g. ${VAR_5}) to be used as an output. Do I need to push this before I call and pop it twice (once to get the data, the other to restore the stack) to make my function "clean" in terms of stack management?<br />
      <br />
      2) Can I suppress the automatic messagebox which asks if I want to replace the file? I check this later, on page exit, as this catches filename clashes if the user enters the file in the textbox themselves, as well.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Joel</span><br />
      <span class="post-time small text-muted">28th April 2006 20:54 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Hi there:<br />
      <br />
      1) No, you don't.<br />
      <br />
      2) No, is a flag that it might come handy if the file is already there. But If you want to overwrite w/o warnings try FileOpen from nsis.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">rxs2k5</span><br />
      <span class="post-time small text-muted">29th April 2006 05:32 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Hi Joel,<br />
      <br />
      I test some examples especially the inputregcode.nsi<br />
      <br />
      Could u increase the examples details on how to add multiple ones and where does the username and key and serial be placed to allow a successful entry</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Joel</span><br />
      <span class="post-time small text-muted">29th April 2006 17:08 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">I could...I'll try to work it on this weekend, but those features will be enabled on dialogsEx</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">rxs2k5</span><br />
      <span class="post-time small text-muted">30th April 2006 05:48 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Your plugins are interesting especially the nsweb so does this but more details on each example to how can one add more users into it.<br />
      <br />
      Thanks for trying your best</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">RobGrant</span><br />
      <span class="post-time small text-muted">2nd May 2006 08:45 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Hm ok thanks, I literally didn't want the word "Open" - I wanted "save". Oh well, I found a (memory-sucking) way of doing it involving an extra global variable.<br />
      <br />
      Thanks for the reply and the plugin!</p>
    </div>
    <hr />
    <!-- Bootstrap core CSS -->
    <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
                <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
                <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->

    <div class="container">
      <!-- Put navigation bar here -->

      <ol class="breadcrumb">
        <li><a href="../index.html" class="glyphicon glyphicon-home"></a></li>

        <li><a href="f-65.html">NSIS Discussion</a></li>

        <li class="active">Dialogs.dll: My new plugin.</li>
      </ol>

      <p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=171833">Dialogs.dll: My new plugin.</a></p><br />

      <div class="post">
        <p class="post-meta"><span class="post-author text-primary">Joel</span><br />
        <span class="post-time small text-muted">3rd May 2006 01:01 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

        <p class="post-content">dialogsEx can customize that Open file dialog</p>
      </div>
      <hr />

      <div class="post">
        <p class="post-meta"><span class="post-author text-primary">Joel</span><br />
        <span class="post-time small text-muted">13th July 2006 21:14 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

        <p class="post-content">Update this plugin:<br />
        <br />
        -Changes:<br />
        Just bug fix on keygen.</p>
      </div>
      <hr />

      <div class="post">
        <p class="post-meta"><span class="post-author text-primary">mileski</span><br />
        <span class="post-time small text-muted">4th October 2006 18:39 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

        <p class="post-content"><strong>Proposed file name in Save Dialog</strong><br />
        Hi Joel,<br />
        <br />
        I just want to ask you about the adding the possibility of the Dialogs::save control, to be able to give a proposed file name in the File Name textbox? This is very good, because the users sometimes do not know which file name to use for the program, and they can mix the things up.<br />
        <br />
        Or you can post your source code of the control here, so we can try to enhcance it ?<br />
        <br />
        <br />
        Thanks,<br />
        Robert</p>
      </div>
      <hr />

      <div class="post">
        <p class="post-meta"><span class="post-author text-primary">rxs2k5</span><br />
        <span class="post-time small text-muted">23rd January 2007 10:38 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

        <p class="post-content">Hi lobo lunar<br />
        <br />
        Does your plugins inputpass.nsi allow the follow<br /></p>

        <blockquote>
          Loop:<br />
          Dialogs::InputBox "Application Protecter" "Application Password Required.$\r$\nPlease enter the correct password:" "OK" "Cancel" "2" ${VAR_5}<br />
          <br />
          ## Get MD5 string for password<br />
          MD5DLL::GetMD5String $5<br />
          Pop $5<br />
          ;nsis is the password:<br />
          StrCmp $5 '${Password1MD5}' OK WRONG<br />
          StrCmp $5 '${Password2MD5}' OK WRONG<br />
          <br />
          ;Is wrong!<br />
          WRONG:<br />
          Messagebox MB_YESNO|MB_ICONSTOP "Bad password. $\r$\nDo you want to try it again?" IDYES Loop<br />
          goto Exit<br />
          <br />
          ;Is correct!<br />
          OK:<br />
          <br />
          Exit:<br />
          Quit
        </blockquote>I am trying to use ur plugin to make a multiple password...<br />
        1. it will check StrCmp $5 for to see if user type password correctly.<br />
        <br />
        2. if password wrong it will loop back to Loop:<br />
        <br />
        3. if password exist in the list it will carry on the next thing.
      </div>
      <hr />

      <div class="post">
        <p class="post-meta"><span class="post-author text-primary">Joel</span><br />
        <span class="post-time small text-muted">24th January 2007 15:44 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

        <p class="post-content">Yes! Right now I don't have the time I want to make more examples, but try a Loop and use the array plugin if you want more than one serials or passwords.</p>
      </div>
      <hr />

      <div class="post">
        <p class="post-meta"><span class="post-author text-primary">rxs2k5</span><br />
        <span class="post-time small text-muted">25th January 2007 14:02 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

        <p class="post-content">I see, well I not familiar with the arraysplugin though I had gone throught most of the examples. I do not know how to implement it to merge with ur plugin.<br />
        <br />
        but thanks for taking time to reply</p>
      </div>
      <hr />

      <div class="post">
        <p class="post-meta"><span class="post-author text-primary">jbaylor</span><br />
        <span class="post-time small text-muted">21st February 2007 17:17 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

        <p class="post-content">Joel,<br />
        <br />
        Forgive me is this is answered elsewhere in the forum. I have been using NSIS for a few years now and have a regularly used installer that implements your Dialogs.dll. It has had over 4k installs without an NSIS related problem until yesterday. A user tried to install on a WinXP box with admin privileges and got the message:<br />
        <br />
        Could not load: C:\DOKUME~1\&lt;...snip...&gt;\Dialogs.dll<br />
        No folder was selected by the user.<br />
        <br />
        Do you have any suggestions?<br />
        <br />
        Thanks,<br />
        Jeff</p>
      </div>
      <hr />

      <div class="post">
        <p class="post-meta"><span class="post-author text-primary">Joel</span><br />
        <span class="post-time small text-muted">21st February 2007 19:13 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

        <p class="post-content">Any chances to post the code used?</p>
      </div>
      <hr />

      <div class="post">
        <p class="post-meta"><span class="post-author text-primary">jbaylor</span><br />
        <span class="post-time small text-muted">21st February 2007 19:47 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

        <p class="post-content">Here is the snippet that pertains to the Dialogs:<br />
        ===================================================<br />
        Start:<br />
        Dialogs::Folder "Working directory" "Choose a working directory:" $EXEDIR ${VAR_1}<br />
        StrCmp $1 "" Cancel Ok<br />
        Cancel:<br />
        DetailPrint "No folder was selected by the user"<br />
        MessageBox MB_YESNO|MB_ICONEXCLAMATION \<br />
        " No folder was selected by the user. $\n$\n \<br />
        Are you sure you want to quit the installation?" \<br />
        IDNO Start<br />
        quit<br />
        Ok:<br />
        DetailPrint "User selected working folder: $1"<br />
        goto Exit<br />
        Exit:<br />
        ===================================================<br />
        <br />
        The user is using WinXP Pro SP2. Also, the same installer worked on one of his machines (personal) but not the other (work). He says he has the same permissions on both.<br />
        <br />
        The installer was build with NSIS version 2.21<br />
        The Dialogs.dll is dated 7/13/06<br />
        <br />
        Thanks,<br />
        Jeff</p>
      </div>
      <hr />

      <div class="post">
        <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
        <span class="post-time small text-muted">22nd February 2007 00:05 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

        <p class="post-content">Does his work computer have a %TEMP% folder?<br />
        Ask him to open Windows Explorer and put %TEMP% in the path and hit enter (or enter "explorer %TEMP%" in start&gt;run. If he does this while the installer is running, he should find a nsXXX.tmp folder in there. If it's not there, then I'd assume his temp folder is missing some permissions.<br />
        <br />
        -Stu</p>
      </div>
      <hr />

      <div class="post">
        <p class="post-meta"><span class="post-author text-primary">jbaylor</span><br />
        <span class="post-time small text-muted">22nd February 2007 14:25 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

        <p class="post-content">Stu,<br />
        <br />
        Thank you for your suggestion. I asked the user to monitor %TEMP% while the installer was running. He reported seeing a nsXXX.tmp folder as well as a file. I also asked him to check the space available and there were 50 GB free.<br />
        <br />
        Thanks,<br />
        Jeff</p>
      </div>
      <hr />

      <div class="post">
        <p class="post-meta"><span class="post-author text-primary">Joel</span><br />
        <span class="post-time small text-muted">22nd February 2007 14:43 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

        <p class="post-content">I <b>re-test</b> in few xp machines and everything works as should be. I don't understand why in that machine doesn't.<br />
        Did you use <i>InitPluginsDir</i> on you ".onInit" function? The error "couldn't load" is because nsis wasn't enable to load the plugin. Something is wrong there.</p>
      </div>
      <hr />

      <div class="post">
        <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br />
        <span class="post-time small text-muted">22nd February 2007 14:58 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

        <p class="post-content">The next step would be for him to open the nsXXX.tmp folder after the dialogs.dll plugin should have been executed (i.e. when the error is displayed) to see if the plugin is in there.<br />
        <br />
        -Stu</p>
      </div>
      <hr />

      <div class="post">
        <p class="post-meta"><span class="post-author text-primary">jbaylor</span><br />
        <span class="post-time small text-muted">22nd February 2007 15:11 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

        <p class="post-content">I am not calling InitPluginsDir in the ".oninit". Does it need to be called if I am not accessing the $PLUGINSDIR directly?<br />
        <br />
        I have tested on multiple WinXP Pro SP2 systems like the userâ€™s. Of the many installs to date, probably the majority of them have been on WinXP. The user tested the installer successfully on his home machine with the same OS, so I do not think it an OS specific problem.<br />
        <br />
        I just emailed the user to check for the dialogs.dll in the %TEMP% folder.<br />
        <br />
        Thanks,<br />
        Jeff</p>
      </div>
      <hr />

      <div class="post">
        <p class="post-meta"><span class="post-author text-primary">jbaylor</span><br />
        <span class="post-time small text-muted">23rd February 2007 17:55 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

        <p class="post-content">The user sent me the following information regarding the state of %TEMP% during the installation:<br />
        <br />
        the folder nsXXX.tmp contains follows files:<br />
        - Dialogs.dll (12kb)<br />
        - ioSpecial.ini (1kb)<br />
        - modern-header.bmp (30kb)<br />
        - modern-wizard.bmp (155kb)<br />
        - Splash.dll (4kb)<br />
        <br />
        The file nsXXX.tmp in the temp-folder has 0 kb<br />
        This temp-folder is on the local drive c:\</p>
      </div>
      <hr />

      <div class="post">
        <p class="post-meta"><span class="post-author text-primary">Joel</span><br />
        <span class="post-time small text-muted">23rd February 2007 18:32 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

        <p class="post-content">Well...I'm sure in not the plugin.<br />
        As I said, something is wrong there.<br />
        :(</p>
      </div>
      <hr />

      <div class="post">
        <p class="post-meta"><span class="post-author text-primary">jbaylor</span><br />
        <span class="post-time small text-muted">26th February 2007 17:08 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

        <p class="post-content">I updated to the latest release of NSIS and added exception handling around the call to Dialogs.dll. If there is an error I default the directory value to $DOCUMENTS (I am looking for a working directory for the application). This enabled the user to install.<br />
        <br />
        I apologize for adding the exception handling and not testing the latest release for the error by itself. I did not want the user to loose patience.<br />
        <br />
        Thank you for all of your suggestions and help.<br />
        <br />
        Best regards,<br />
        Jeff</p>
      </div>
      <hr />

      <div class="post">
        <p class="post-meta"><span class="post-author text-primary">Brummelchen</span><br />
        <span class="post-time small text-muted">3rd March 2007 06:40 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

        <p class="post-content"><font color="red">i cant get dialogsex working</font> - <font color="green">only dialog</font>...<br />
        dialogsex always returns an empty string (samples SAVE/OPEN dont work)<br />
        <br />
        any hints?<br />
        <br />
        XP SP2, NSIS 2.21</p>
      </div>
      <hr />

      <div class="post">
        <p class="post-meta"><span class="post-author text-primary">Comperio</span><br />
        <span class="post-time small text-muted">3rd March 2007 23:12 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

        <p class="post-content">It's probably the same as my last post on the <a href="http://forums.winamp.com/showthread.php?threadid=214694" target="_blank">DialogsEX</a> thread... :(<br />
        <br />
        Maybe Joel can give us some feedback.</p>
      </div>
      <hr />

      <div class="post">
        <p class="post-meta"><span class="post-author text-primary">Joel</span><br />
        <span class="post-time small text-muted">5th March 2007 20:52 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

        <p class="post-content">Is I said, is strange...all my examples were tested in Win2k, WinXP and Win2003.</p>
      </div>
      <hr />

      <div class="footer">
        <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
      </div>
    </div><script src="../js/highlight.pack.js" type="text/javascript">
</script> <script type="text/javascript">
//<![CDATA[
    hljs.initHighlightingOnLoad();
    //]]>
    </script>
  </div>
</body>
</html>
