<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="description" content="How do you Enumerate Sections in a subsection???"><title>How do you Enumerate Sections in a subsection??? - NSIS Forums</title><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script><link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css"><link rel="stylesheet" href="../css/style.css" type="text/css"></head><body><div class="container"><ol class="breadcrumb"><li><a href="../index.html" class="glyphicon glyphicon-home"></a></li><li><a href="f-65.html">NSIS Discussion</a></li><li class="active">How do you Enumerate Sections in a subsection???</li></ol><p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=140287">How do you Enumerate Sections in a subsection???</a></p><br><div class="post"><p class="post-meta"><span class="post-author text-primary">mhollander</span><br><span class="post-time small text-muted">27th June 2003 10:44 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>How do you Enumerate Sections in a subsection???</strong><br>This portion of code works<br><br>SubSection /E "Supporting Files" SPF<br>Section "Internet Explorer 6.0 With SP1" IE6<br>...<br>SectionEnd<br>Section "Microsoft .Net Framework" DOTNET<br>...<br>SectionEnd<br>SubSectionEnd<br><br>if not ie6 then<br>SectionSetText ${ie6} ""<br>endif<br>if not DotNet then<br>SectionSetText ${DOTNET} ""<br>endif<br><br>This is what I would like to achieve<br><br>if ${SPF}.Count = 0 then<br>SectionSetText ${SPF} ""<br>endif<br><br>Any suggestions would be appreciated<br>:)</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br><span class="post-time small text-muted">27th June 2003 10:46 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">StrCmp ${SPF} 0 If0 NotIf0<br>If0:<br>...<br>NotIf0:<br>...<br><br>-Stu</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">mhollander</span><br><span class="post-time small text-muted">27th June 2003 10:56 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Tried it and thought it work at first, but other code changed that.<br><br>Sorry but it does not work I f ahve tried the following variations<br><br>StrCmp ${SPF} 0 Disable CheckComplete<br>Disable:<br>SectionSetText ${SPF} ""<br>Goto CheckComplete<br>CheckComplete:<br><br>StrCmp ${SPF} "0" Disable CheckComplete<br>Disable:<br>SectionSetText ${SPF} ""<br>Goto CheckComplete<br>CheckComplete:<br><br>IntCmp ${SPF} 0 Disable CheckComplete<br>Disable:<br>SectionSetText ${SPF} ""<br>Goto CheckComplete<br>CheckComplete:<br><br><br>;)</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">mhollander</span><br><span class="post-time small text-muted">27th June 2003 11:11 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">My most humble apologies.<br><br>There was code that was executing that intefered and caused the<br>routine not to be called.<br><br>:hang:<br><br>This product Rocks</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br><span class="post-time small text-muted">27th June 2003 11:18 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">I agree with you very much!<br><br>Check this out:<br><a href="http://dynamic.gamespy.com/~dday/ib3/ikonboard.cgi?s=3efc1ab6099dffff;act=ST;f=2;t=983" target="_blank">http://dynamic.gamespy.com/~dday/ib3...t=ST;f=2;t=983</a><br><br>Check the source too ;)<br><br>-Stu</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">kichik</span><br><span class="post-time small text-muted">27th June 2003 12:57 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Are you sure that code works? It seemed that you wanted to tell how many sections that are in the subsection "Supporting Files" are selected. Your code checks if the id number of the subsection is zero or not.<br><br>To check if a section is selected or not you should use this code:<br><br>!include Sections.nsh<br><br>SectionGetFlags ${sectionid} $0<br>IntOp $0 $0 &amp; ${SF_SELECTED}<br>StrCmp $0 ${SF_SELECTED} selected not_selected<br><br>If you wish to enumerate use something like this:<br><br>StrCpy $0 ${SPF}<br>StrCpy $3 0<br>loop:<br>IntOp $0 $0 + 1<br>SectionGetFlags $1 $0<br>IntOp $2 $1 &amp; ${SF_SUBSECEND}<br>StrCmp $2 ${SF_SUBSECEND} done<br>IntOp $2 $1 &amp; ${SF_SELECTED}<br>StrCmp $2 ${SF_SELECTED} loop<br>IntOp $3 $3 + 1<br>Goto loop<br>done:<br>DetailPrint '$3 sections selected under "Supporting Files"'</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">mhollander</span><br><span class="post-time small text-muted">28th June 2003 10:39 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">StrCmp ${SPF} 0 Disable CheckComplete<br><br>does work for the implementation that I wanted.<br>The prolem was when there was no sub items defined I still had the parent tree node. So if there where no child nodes I did not want to display the parent node.<br><br>The code that you have supplied will go into my code library as I will be needing it in the near future.<br><br>Thanks.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">kichik</span><br><span class="post-time small text-muted">28th June 2003 11:50 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Do you mind explaining a little more please? ${SPF} is a constant number that holds the id of the subsection "Supporting Files". Why do you compare it with 0?</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">mhollander</span><br><span class="post-time small text-muted">28th June 2003 21:39 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">The problem is as follows :<br><br>SubSection /E "Supporting Files" SPF<br>Section "ABC" ABC<br>EndSection<br><br>Section "DEF" DEF<br>EndSection<br><br>Section "GHI" GHI<br>EndSection<br>EndSubSection<br><br>Later on in the script we get the following<br><br>SectionSetText ${ABC} ""<br>SectionSetText ${DEF} ""<br>SectionSetText ${GHI} ""<br><br>But now we have "Supporting Files" and no sub nodes.<br>The idea is if ${SPF} = 0 nodes then<br>SectionSetText ${SPF} = ""<br>so that it does not display "Supporting files" as an option, but if<br>there is one or<br>more subsections then I want to display "Supporting files".<br><br>this "StrCmp ${SPF} 0 Disable CheckComplete" appears to change if<br>the ${SPF} has nodes defined beneath it.<br><br>In Short it seems to work.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">kichik</span><br><span class="post-time small text-muted">29th June 2003 11:05 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">But SPF is just a constant which contains the id of the subsection which is its serial id. If it is the first [sub]section created it will be numbered 0, second - 1, etc. Your comparison is meaningless. SPF will only be 0 if it's the first section created, not if there are nodes beneath it and will never change on runtime.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">mhollander</span><br><span class="post-time small text-muted">9th July 2003 16:36 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">I have tried your code, but the code runs into a continuous loop and I cannot seem to figure out why.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Joost Verburg</span><br><span class="post-time small text-muted">9th July 2003 16:54 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Isn't it way easier to create something like this:<br><br>If Not IE6 And Not DOTNET Then<br>SectionSetText ${SPF} ""<br>EndIf</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">mhollander</span><br><span class="post-time small text-muted">9th July 2003 16:59 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">That is what I ultimately would like to do but the Subsections are my variables. Does NSIS support If ... Endif. Have not come across it in my documentation.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Joost Verburg</span><br><span class="post-time small text-muted">9th July 2003 20:26 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Yep, it does support conditional operations. In NSIS code it would be something like:<br><br>;$R0 = "1" if IE is installed<br>;$R1 = "1" if DOTNET is installed<br><br>StrCmp $R0 "1" done<br>StrCmp $R1 "1" done<br><br>SectionSetText ${SPF} ""<br><br>done:</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">kichik</span><br><span class="post-time small text-muted">10th July 2003 13:48 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">This one has been tested and should work:<br><br>StrCpy $0 ${SPF}<br>StrCpy $3 0<br>loop:<br>IntOp $0 $0 + 1<br>SectionGetFlags $0 $1<br>IfErrors done<br>IntOp $2 $1 &amp; ${SF_SUBSECEND}<br>StrCmp $2 ${SF_SUBSECEND} done<br>IntOp $2 $1 &amp; ${SF_SELECTED}<br>StrCmp $2 ${SF_SELECTED} 0 loop<br>IntOp $3 $3 + 1<br>Goto loop<br>done:<br>DetailPrint '$3 sections selected under "Supporting Files"'</p></div><hr><div class="footer"><p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p></div></div><script src="../js/highlight.pack.js" type="text/javascript"></script><script type="text/javascript">//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]></script></body></html>