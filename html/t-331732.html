<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="finishpage cancel button not funtioning" />

  <title>finishpage cancel button not funtioning - NSIS Forums</title>
  <script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script>
  <!-- Bootstrap core CSS -->

  <link rel="stylesheet" type="text/css" href="//netdna.bootstrapcdn.com/bootswatch/3.0.1/readable/bootstrap.min.css" />
  <link rel="stylesheet" href="../css/style.css" type="text/css" /><!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!--[if lt IE 9]>
                <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
                <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->
</head>

<body>
  <div class="container">
    <!-- Put navigation bar here -->

    <ol class="breadcrumb">
      <li><a href="../index.html" class="glyphicon glyphicon-home"></a></li>

      <li><a href="f-65.html">NSIS Discussion</a></li>

      <li class="active">finishpage cancel button not funtioning</li>
    </ol>

    <p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=331732">finishpage cancel button not funtioning</a></p><br />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">tubecharger</span><br />
      <span class="post-time small text-muted">20th June 2011 23:32 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>finishpage cancel button not funtioning</strong><br />
      Using mui2, and<br />
      !define MUI_FINISHPAGE_RUN $UserDir\myProg.exe<br />
      !define MUI_FINISHPAGE_CANCEL_ENABLED<br />
      <br />
      My finish page is displayed correctly with the Cancel button enabled, but when I click on it nothing happens. Do I need to implement code behind the Cancel button or should it just automatically cancel/exit without running the defined executable?</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">MSG</span><br />
      <span class="post-time small text-muted">21st June 2011 06:37 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">The "Run myprog" option on the finish page is a checkbox. If you leave it unchecked and click Finish, the installer will exit. If you check it and click Finish, the installer will exit and myprog will be started. What more functionality do you need?</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">tubecharger</span><br />
      <span class="post-time small text-muted">21st June 2011 13:56 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>single click exit</strong><br />
      Trying to streamline so that only one click is needed if the optional run is not desired. The question however, is why the Cancel doesn't do anything when it is enabled.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Anders</span><br />
      <span class="post-time small text-muted">21st June 2011 14:50 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">You can't cancel the install, you already completed the install, there is nothing to cancel</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">MSG</span><br />
      <span class="post-time small text-muted">21st June 2011 15:40 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"></p>

      <blockquote>
        <small>Originally posted by tubecharger</small><br />
        Trying to streamline so that only one click is needed if the optional run is not desired.
      </blockquote>!define MUI_FINISHPAGE_RUN_NOTCHECKED<br />
      <br />
      <br />
      It's all in the manual. Or, in this case, in the MUI2 readme: <a href="http://nsis.sourceforge.net/Docs/Modern%20UI%202/Readme.html" target="_blank">http://nsis.sourceforge.net/Docs/Mod...02/Readme.html</a>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">tubecharger</span><br />
      <span class="post-time small text-muted">21st June 2011 18:22 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>finishpage cancel button not functioning</strong><br />
      Directly from the manual:<br />
      <b>MUI_FINISHPAGE_CANCEL_ENABLED<br />
      Enable the Cancel button so the user can skip any options displayed on the finish page.<br /></b><br />
      This is exactly what I want to do and what I currently have implemented in my code. But when I click on the Cancel button which is not grayed out, nothing happens. Is this the correct behavior? Comparing the behavior to the explanation from the manual, it does not appear to be correct. Is there something else that I need to do to get the cancel button to "skip any options displayed on the finish page" and exit. I don't need it to roll back. I just want to exit without running the myProg.exe.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Anders</span><br />
      <span class="post-time small text-muted">21st June 2011 19:59 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"></p>

      <blockquote>
        <small>Originally posted by tubecharger</small><br />
        Directly from the manual:<br />
        <b>MUI_FINISHPAGE_CANCEL_ENABLED<br />
        Enable the Cancel button so the user can skip any options displayed on the finish page.<br /></b><br />
        This is exactly what I want to do and what I currently have implemented in my code. But when I click on the Cancel button which is not grayed out, nothing happens. Is this the correct behavior? Comparing the behavior to the explanation from the manual, it does not appear to be correct. Is there something else that I need to do to get the cancel button to "skip any options displayed on the finish page" and exit. I don't need it to roll back. I just want to exit without running the myProg.exe.
      </blockquote>It works fine in MUI1, probably a bug in MUI2 or nsDialogs.<br />
      <br />
      Try this workaround:<br />
      <br />

      <blockquote>
        !include MUI2.nsh<br />
        !insertmacro MUI_PAGE_WELCOME<br />
        !insertmacro MUI_PAGE_INSTFILES<br />
        #Do NOT use MUI_FINISHPAGE_CANCEL_ENABLED<br />
        !define MUI_FINISHPAGE_RUN "$windir\explorer.exe"<br />
        !define MUI_PAGE_CUSTOMFUNCTION_SHOW NSIS2d46_MUI2_CancelEnabledFix<br />
        !insertmacro MUI_PAGE_FINISH<br />
        !insertmacro MUI_LANGUAGE "English"<br />
        <br />
        !ifndef SC_CLOSE<br />
        !define SC_CLOSE 0xF060<br />
        !endif<br />
        Function NSIS2d46_MUI2_CancelEnabledFix<br />
        EnableWindow $mui.Button.Cancel 1<br />
        System::Call 'USER32::GetSystemMenu(i $hwndparent,i0)i.s'<br />
        System::Call 'USER32::EnableMenuItem(is,i${SC_CLOSE},i0)'<br />
        FunctionEnd
      </blockquote>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">tubecharger</span><br />
      <span class="post-time small text-muted">21st June 2011 20:25 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Thanks very much Anders. That worked!</p>
    </div>
    <hr />

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]>
  </script>
</body>
</html>
