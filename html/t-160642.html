<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="Using NSIS to reinstall missing dependencies when starting up?" />

  <title>Using NSIS to reinstall missing dependencies when starting up? - NSIS Forums</title>
  <script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script>
  <!-- Bootstrap core CSS -->

  <link rel="stylesheet" type="text/css" href="//netdna.bootstrapcdn.com/bootswatch/3.0.1/readable/bootstrap.min.css" />
  <link rel="stylesheet" href="../css/style.css" type="text/css" /><!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!--[if lt IE 9]>
                <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
                <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->
</head>

<body>
  <div class="container">
    <!-- Put navigation bar here -->

    <ol class="breadcrumb">
      <li><a href="../index.html" class="glyphicon glyphicon-home"></a></li>

      <li><a href="f-65.html">NSIS Discussion</a></li>

      <li class="active">Using NSIS to reinstall missing dependencies when starting up?</li>
    </ol>

    <p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=160642">Using NSIS to reinstall missing dependencies when starting up?</a></p><br />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">janedoe2003</span><br />
      <span class="post-time small text-muted">18th December 2003 21:36 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content"><strong>Using NSIS to reinstall missing dependencies when starting up?</strong><br />
      Hi,<br />
      <br />
      I went through the tutorial and FAQ on NSIS' site, and read the few threads here that dealt with VB... but I didn't find what I'm looking for, namely how to check that all the app's OCX's are still there when running Main(), and fetch and reinstall them from the Net if any dependency has been replaced by a different version since the original install.<br />
      <br />
      Based on documents I read here and there, DependencyWalker's help file among them, checking an EXE's dependencies is error-prone, but at the very least, I'd like to write a routine that goes through the usual suspects in Main() before going any further.<br />
      <br />
      How do you VB guys handle this issue, to avoid the dreaded Errs 429 or (God forbid) 50003?<br />
      <br />
      Thank you<br />
      JD.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Joost Verburg</span><br />
      <span class="post-time small text-muted">18th December 2003 21:40 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">The UpgradeDLL macro only installs the files if an older version is currently installed.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kichik</span><br />
      <span class="post-time small text-muted">18th December 2003 21:44 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">As for the dependency check, I think you'd better ask this in a VB forum instead of here. NSIS is not an installer just for VB so you might find the answer faster in a VB oriented forum.<br />
      <br />
      As for downloading and installing a new version, you can do that using the NSISdl plug-in (see Contrib\NSISdl) and the UpgradeDLL macro (see docs). You'd also probably need to process the command line a bit using $CMDLINE and some functions that are available in the Archive for this purpose.</p>
    </div>
    <hr />

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Joost Verburg</span><br />
      <span class="post-time small text-muted">18th December 2003 21:54 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">It's quite easy to detect which files are required by your VB application.<br />
      <br />
      You always have to install the VB runtime files (see NSIS documentation for details) and other controls or DLLs you are using for your project (see controls and references in the VB IDE).</p>
    </div>
    <hr />

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]>
  </script>
</body>
</html>
