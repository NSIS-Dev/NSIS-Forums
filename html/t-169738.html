<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="description" content="Plugin help needed"><title>Plugin help needed - NSIS Forums</title><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script><link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css"><link rel="stylesheet" href="../css/style.css" type="text/css"></head><body><div class="container"><ol class="breadcrumb"><li><a href="../index.html" class="glyphicon glyphicon-home"></a></li><li><a href="f-65.html">NSIS Discussion</a></li><li class="active">Plugin help needed</li></ol><p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=169738">Plugin help needed</a></p><br><div class="post"><p class="post-meta"><span class="post-author text-primary">Vytautas</span><br><span class="post-time small text-muted">17th February 2004 11:43 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>Plugin help needed</strong><br>I'm working on a new plugin for NSIS and have a couple of questions.<br><br>First, is there a way to convert a handle into a string so it can be passed to NSIS and then back into a handle when needed? I'm using c/c++ to program this plugin.<br><br>Or alternatively is there a way to create a *global* variable that different instances of the dll can access, e.g. normal global vars don't work when you call the plugin the second time the variable is reinitialized.<br><br>And finally, this is not really important but would be usefull none the less, is there a way for the plugin <b>itself</b> to specify that it should not be unloaded and then maybe have a special function which unloads the dll.<br><br>Vytautas</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Joel</span><br><span class="post-time small text-muted">17th February 2004 15:23 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">okay, I'll try to help you:<br><b>convert a handle into a string</b>. Yeah, Nsis only accept Strings (Char) to be used in <i>popstring</i>. When I need to input a number, I inputed like string, for example "512". Since "512" is a string, you can easy use it with popstring to use it in the code, then I use <b>my_atoi</b> function (you can get it in system plugin source code) to convert the string-&gt;number</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Joost Verburg</span><br><span class="post-time small text-muted">17th February 2004 16:48 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">I think he is talking about C. You should read a tutorial that explains you how to work with pointers. A single Google search will help.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Vytautas</span><br><span class="post-time small text-muted">17th February 2004 23:20 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">I found the functions to pop/push integer to the stack in the system dll source code. :D<br><br>However I found the the definition of a HANDLE is a 'pointer to void' and not a 'pointer to int'. This does not make sence to me as a always assumed that void is just that 'nothing'. :weird:<br><br>So any ideas of what I should use to convert a HANDLE to int or string and then back again?<br><br>Vytautas</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Joel</span><br><span class="post-time small text-muted">17th February 2004 23:50 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">HANDLE to string try <a href="http://www.cplusplus.com/ref/cstdio/sprintf.html" target="_blank">sprintf</a> ;)</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Vytautas</span><br><span class="post-time small text-muted">18th February 2004 01:56 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Thanks Lobo Lunar this line worked great</p><pre>
<code>sprintf(sThread, "%u", hThread);</code>
</pre>However how do I convert that value back into HANDLE when I pop it again later in another call to the plugin. Either from int or char?<br><br>Vytautas</div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">eccles</span><br><span class="post-time small text-muted">18th February 2004 13:34 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">For a smaller .DLL, use <b>w</b>sprintf.<br><br>To convert the other way, find and use my_atoi, as mentioned earlier.</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">kichik</span><br><span class="post-time small text-muted">20th February 2004 11:28 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">It is possible to create global variables using shared DLL sections. There is an article on CodeProject I think.<br><br>To force the DLL not to unload, load it yourself again using LoadLibrary. You'll probably have to add some more code than that, but it should be possible with some research.</p></div><hr><div class="footer"><p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p></div></div><script src="../js/highlight.pack.js" type="text/javascript"></script><script type="text/javascript">//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]></script></body></html>