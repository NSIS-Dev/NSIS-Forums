<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="description" content="Yet another problem with 2nd location directory page"><title>Yet another problem with 2nd location directory page - NSIS Forums</title><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-53539506-8','auto');ga('send','pageview');</script><link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css"><link rel="stylesheet" href="../css/style.css" type="text/css"></head><body><div class="container"><ol class="breadcrumb"><li><a href="../index.html" class="glyphicon glyphicon-home"></a></li><li><a href="f-65.html">NSIS Discussion</a></li><li class="active">Yet another problem with 2nd location directory page</li></ol><p class="lead text-muted">Archive: <a title="Try the Internet Archive" target="_blank" href="http://web.archive.org/web/*/forums.winamp.com/showthread.php?t=306591">Yet another problem with 2nd location directory page</a></p><br><div class="post"><p class="post-meta"><span class="post-author text-primary">kamikaze09</span><br><span class="post-time small text-muted">21st May 2009 09:35 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content"><strong>Yet another problem with 2nd location directory page</strong><br>Hello all,<br><br>I'm a bit new with NSIS. I'm having some trobule with my nsi script and trying to set a 2nd directory page to install program data.<br><br>I attach my original nsi script (with only 1 directory page, the typical), I also attach the new code where I try to code the second directory.<br><br>I've followed the example : <a href="http://nsis.sourceforge.net/Setting_Default_Location_for_2nd_" target="_blank">http://nsis.sourceforge.net/Setting_...ation_for_2nd_</a>(Data)_Directory_Page<br>and I've also searched the forum but there is no code for a newbie like me.<br><br>When I compile my code it says that :<br><br>install function "DirectoryShow" not reference - zeroing code<br>install function "DirectoryLeave" not reference - zeroing code<br><br>I'm sure that I'm missing something stupid, but I need some help.<br><br>Could anyone point me what i'm doing wrong?<br><br>Thank you all in advance</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br><span class="post-time small text-muted">21st May 2009 12:24 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">That page is very outdated. You no longer use !define MUI_DIRECTORYPAGE, and the MUI_CUSTOMFUNCTION_DIRECTORY_* defines are no longer valid. Check the MUI2 documentation on custom functions.<br><br>Edit: Also note that the defines have to be placed before the !insertmacro of the page that they need to apply to.<br><br>Stu</p></div><hr><div class="post"><p class="post-meta"><span class="post-author text-primary">kamikaze09</span><br><span class="post-time small text-muted">21st May 2009 15:57 <abbr title="Coordinated Universal Time">UTC</abbr></span></p><p class="post-content">Hello Afrow<br><br>Thank you very much for your fast response.<br><br>I've done some corrections to my code:<br><br>- I started using mui2.nsh<br>- I deleted the: !define MUI_DIRECTORYPAGE since it is not longer needed<br>- I changed all MUI_CUSTOMFUNTION_DIRECTORY_* to:<br><br></p><pre>
<code><br>!define MUI_DIRECTORY_CUSTOMFUNCTION_PRE FucntionPre<br>!define MUI_DIRECTORY_CUSTOMFUNCTION_SHOW FucntionShow<br>!define MUI_DIRECTORY_CUSTOMFUNCTION_LEAVE FucntionLeave<br></code>
</pre><br>
      <br>
      (that is what I understand from the manual <a href="http://nsis.sourceforge.net/Docs/Modern%20UI/Readme.html" target="_blank">http://nsis.sourceforge.net/Docs/Mod...UI/Readme.html</a> )<br>
      <br>
      After that i do this:<br>
      <br>
      <pre>
<code><br>!insertmacro MUI_PAGE_WELCOME<br>!insertmacro MUI_PAGE_LICENSE<br>!insertmacro MUI_PAGE_COMPONENTS<br>Page custom DIRECTORY   &lt;---- This is wrong but i dont know how to write it<br>!insertmacro MUI_PAGE_INSTFILES<br>!insertmacro MUI_PAGE_FINISH<br></code>
</pre><br>
      <br>
      <br>
      And later, i have the 3 functions<br>
      <pre>
<code><br>Function FucntionPre<br>....<br>FunctionEnd<br><br>Function FucntionLeave<br>....<br>FunctionEnd<br><br><br><br>Function FucntionShow<br>  StrCmp $9 "0" AppDirectoryPage<br>  StrCmp $9 "1" DataDirectoryPage<br> <br>AppDirectoryPage:<br>  StrCpy $9 "1"<br>  !insertmacro MUI_INNERDIALOG_TEXT 1041 "Destination Folder"<br>  !insertmacro MUI_INNERDIALOG_TEXT 1019 "$PROGRAMFILES\${MUI_PRODUCT}\"<br>  !insertmacro MUI_INNERDIALOG_TEXT 1006 "Setup will install ${MUI_PRODUCT} in the following folder.$\r$\n$\r$\nTo install in a different folder, click Browse and select another folder. Click Next to continue."<br>  Goto EndDirectoryShow<br> ....                           <br>FunctionEnd<br></code>
</pre><br>
      <br>
      However MUI_INNERDIALOG_TEXT is not found.<br>
      <br>
      I've been working on this all day but no way to understand it how to make it work, and there is no example at all in the new MUI2 tutorial about this, neither in the forum.<br>
      <br>
      I would be very pleased if you or someone could help me with the code. I'm absolutely desperated.<br>
      <br>
      Thank you very much in advance
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">Afrow UK</span><br>
      <span class="post-time small text-muted">21st May 2009 17:04 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">As with all other MUI pages, it's !insertmacro MUI_PAGE_DIRECTORY. To have more than one page, you insert it twice then use !define MUI_DIRECTORYPAGE_VARIABLE for the second one to specify a custom variable to use instead of INSTDIR for it.<br>
      <br>
      All this is in the MUI2 readme if you read it.<br>
      <br>
      Stu</p>
    </div>
    <hr>

    <div class="post">
      <p class="post-meta"><span class="post-author text-primary">kamikaze09</span><br>
      <span class="post-time small text-muted">23rd May 2009 20:52 <abbr title="Coordinated Universal Time">UTC</abbr></span></p>

      <p class="post-content">Hello Afrow UK,<br>
      <br>
      I've tested what you told me and now it is working fine. Now i do not have the code right here, but i will write it here on monday and maybe it will be useful to someone.<br>
      <br>
      Thank you very much for your help</p>
    </div>
    <hr>

    <div class="footer">
      <p class="text-muted small">Fork me on <a href="https://github.com/nsis-dev/NSIS-Forums/">GitHub</a></p>
    </div>
  </div><script src="../js/highlight.pack.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[
  hljs.initHighlightingOnLoad();
  //]]></script></body></html>